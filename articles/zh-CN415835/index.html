<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ ğŸ“» ğŸ¤°ğŸ½ æˆ‘ä»¬å°†GUIç¼–å†™ä¸º1C RACï¼Œæˆ–è€…å†æ¬¡å†™ä¸ºTcl / Tk ğŸ ğŸš â£ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å½“æˆ‘æ·±å…¥ç ”ç©¶åœ¨Linuxä¸­ä½¿ç”¨1Cäº§å“çš„ä¸»é¢˜æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªç¼ºç‚¹-ç¼ºä¹ç”¨äºç®¡ç†1CæœåŠ¡å™¨ç¾¤é›†çš„ä¾¿æ·çš„å›¾å½¢åŒ–å¤šå¹³å°å·¥å…·ã€‚ å¹¶ä¸”å†³å®šé€šè¿‡ä¸ºæ§åˆ¶å°å®ç”¨ç¨‹åºracç¼–å†™GUIæ¥è§£å†³æ­¤ç¼ºé™·ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œé€‰æ‹©tcl / tkä½œä¸ºå¼€å‘è¯­è¨€æ˜¯æœ€é€‚åˆæ­¤ä»»åŠ¡çš„ã€‚ ç°åœ¨ï¼Œæˆ‘æƒ³åœ¨æœ¬ææ–™ä¸­ä»‹ç»è¯¥è§£å†³æ–¹æ¡ˆçš„ä¸€äº›æœ‰è¶£æ–¹é¢ã€‚ 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬å°†GUIç¼–å†™ä¸º1C RACï¼Œæˆ–è€…å†æ¬¡å†™ä¸ºTcl / Tk</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415835/"> å½“æˆ‘æ·±å…¥ç ”ç©¶åœ¨Linuxä¸­ä½¿ç”¨1Cäº§å“çš„ä¸»é¢˜æ—¶ï¼Œæˆ‘å‘ç°äº†ä¸€ä¸ªç¼ºç‚¹-ç¼ºä¹ç”¨äºç®¡ç†1CæœåŠ¡å™¨ç¾¤é›†çš„ä¾¿æ·çš„å›¾å½¢åŒ–å¤šå¹³å°å·¥å…·ã€‚ å¹¶ä¸”å†³å®šé€šè¿‡ä¸ºæ§åˆ¶å°å®ç”¨ç¨‹åºracç¼–å†™GUIæ¥è§£å†³æ­¤ç¼ºé™·ã€‚ åœ¨æˆ‘çœ‹æ¥ï¼Œé€‰æ‹©tcl / tkä½œä¸ºå¼€å‘è¯­è¨€æ˜¯æœ€é€‚åˆæ­¤ä»»åŠ¡çš„ã€‚ ç°åœ¨ï¼Œæˆ‘æƒ³åœ¨æœ¬ææ–™ä¸­ä»‹ç»è¯¥è§£å†³æ–¹æ¡ˆçš„ä¸€äº›æœ‰è¶£æ–¹é¢ã€‚ <br><a name="habracut"></a><br> å¯¹äºå·¥ä½œï¼Œæ‚¨éœ€è¦tcl / tkå’Œ1Cå‘è¡Œç‰ˆã€‚ ç”±äºæˆ‘å†³å®šåœ¨ä¸ä½¿ç”¨ç¬¬ä¸‰æ–¹è½¯ä»¶åŒ…çš„æƒ…å†µä¸‹ï¼Œå……åˆ†åˆ©ç”¨åŸºæœ¬tcl / tkäº¤ä»˜çš„åŠŸèƒ½ï¼Œå› æ­¤æˆ‘éœ€è¦ç‰ˆæœ¬8.6.7ï¼Œå…¶ä¸­åŒ…æ‹¬ttk-ä¸€ä¸ªå¸¦æœ‰å…¶ä»–å›¾å½¢å…ƒç´ çš„è½¯ä»¶åŒ…ï¼Œæˆ‘ä»¬ä¸»è¦éœ€è¦ttk :: TreeViewï¼Œå®ƒå…è®¸ä»¥æ ‘ç»“æ„å½¢å¼å’Œè¡¨ï¼ˆåˆ—è¡¨ï¼‰å½¢å¼æ˜¾ç¤ºæ•°æ®ã€‚ å¦å¤–ï¼Œåœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œå·²é‡åšäº†ä¾‹å¤–å¤„ç†ï¼ˆtryå‘½ä»¤ï¼Œåœ¨è¿è¡Œå¤–éƒ¨å‘½ä»¤æ—¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼‰ã€‚ <br><br> ä¸€ä¸ªé¡¹ç›®åŒ…å«å‡ ä¸ªæ–‡ä»¶ï¼ˆå°½ç®¡æ²¡æœ‰ä»€ä¹ˆå¯ä»¥é˜»æ­¢ä¸€ä¸ªæ–‡ä»¶å®Œæˆæ‰€æœ‰æ“ä½œï¼‰ï¼š <br><br>  rac_gui.cfg-é»˜è®¤é…ç½® <br>  rac_gui.tcl-ä¸»è¦å¯åŠ¨è„šæœ¬ <br>  libç›®å½•åŒ…å«åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½çš„æ–‡ä»¶ï¼š <br>  function.tcl-å…·æœ‰è¿‡ç¨‹çš„æ–‡ä»¶ <br>  gui.tcl-ä¸»GUI <br>  images.tcl-base64ä¸­çš„å›¾åƒåº“ <br><br> å®é™…ä¸Šï¼Œrac_gui.tclæ–‡ä»¶ä¼šå¯åŠ¨è§£é‡Šå™¨ï¼Œåˆå§‹åŒ–å˜é‡ï¼ŒåŠ è½½æ¨¡å—ï¼Œé…ç½®ç­‰ã€‚ å¸¦æœ‰æ³¨é‡Šçš„æ–‡ä»¶å†…å®¹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">rac_gui.tcl</b> <div class="spoiler_text"><pre><code class="hljs mel">#!/bin/sh <span class="hljs-keyword"><span class="hljs-keyword">exec</span></span> wish <span class="hljs-string"><span class="hljs-string">"$0"</span></span> -- <span class="hljs-string"><span class="hljs-string">"$@"</span></span> #    set dir(root) [<span class="hljs-keyword"><span class="hljs-keyword">pwd</span></span>] #   ,      set dir(work) [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $env(HOME) .rac_gui] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $dir(work)] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> mkdir $dir(work) } #    set dir(lib) <span class="hljs-string"><span class="hljs-string">"[file join $dir(root) lib]"</span></span> #   ,   ,    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg]] ==<span class="hljs-number"><span class="hljs-number">0</span></span>} { <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> copy [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join [<span class="hljs-keyword"><span class="hljs-keyword">pwd</span></span>] rac_gui.cfg] [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg] } <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg] #    rac       #             #         <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $rac_cmd] == <span class="hljs-number"><span class="hljs-number">0</span></span>} { set rac_cmd [tk_getOpenFile -initialdir $env(HOME) -<span class="hljs-keyword"><span class="hljs-keyword">parent</span></span> . -title <span class="hljs-string"><span class="hljs-string">"   rac"</span></span> -initialfile rac] <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> copy [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg] [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg.bak] set orig_file [open [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg.bak] <span class="hljs-string"><span class="hljs-string">"r"</span></span>] set <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> [open [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg] <span class="hljs-string"><span class="hljs-string">"w"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> {[gets $orig_file line] &gt;=<span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> <span class="hljs-string"><span class="hljs-string">"set rac_cmd*"</span></span> $line]} { puts $file <span class="hljs-string"><span class="hljs-string">"set rac_cmd $rac_cmd"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { puts $file $line } } close $file close $orig_file #<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"$host:$port"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) <span class="hljs-number"><span class="hljs-number">1</span></span>c_srv.cfg.bak] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { puts <span class="hljs-string"><span class="hljs-string">"Found $rac_cmd"</span></span> } set cluster_user <span class="hljs-string"><span class="hljs-string">""</span></span> set cluster_pwd <span class="hljs-string"><span class="hljs-string">""</span></span> set agent_user <span class="hljs-string"><span class="hljs-string">""</span></span> set agent_pwd <span class="hljs-string"><span class="hljs-string">""</span></span> ## LOAD FILE ## #    gui.tcl       foreach modFile [lsort [glob -nocomplain [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(lib) *.tcl]]] { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> tail $modFile] ne <span class="hljs-string"><span class="hljs-string">"gui.tcl"</span></span>} { <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> $modFile puts <span class="hljs-string"><span class="hljs-string">"Loaded module $modFile"</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(lib) gui.tcl] <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) rac_gui.cfg] #      <span class="hljs-number"><span class="hljs-number">1</span></span> #     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) <span class="hljs-number"><span class="hljs-number">1</span></span>c_srv.cfg]] { set f [open [<span class="hljs-keyword"><span class="hljs-keyword">file</span></span> join $dir(work) <span class="hljs-number"><span class="hljs-number">1</span></span>c_srv.cfg] <span class="hljs-string"><span class="hljs-string">"RDONLY"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> {[gets $f line] &gt;=<span class="hljs-number"><span class="hljs-number">0</span></span>} { .frm_tree.tree insert {} end -id <span class="hljs-string"><span class="hljs-string">"server::$line"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"$line"</span></span> -values <span class="hljs-string"><span class="hljs-string">"$line"</span></span> } }</code> </pre> <br></div></div><br> ä¸‹è½½æ‰€éœ€çš„æ‰€æœ‰å†…å®¹å¹¶æ£€æŸ¥racå®ç”¨ç¨‹åºçš„å¯ç”¨æ€§ä¹‹åï¼Œå°†å¯åŠ¨å›¾å½¢çª—å£ã€‚ ç¨‹åºç•Œé¢åŒ…å«ä¸‰ä¸ªå…ƒç´ ï¼š <br><br> å·¥å…·æ ï¼Œæ ‘å’Œåˆ—è¡¨ <br><br> æˆ‘ä½¿â€œæ ‘â€çš„å†…å®¹å°½å¯èƒ½ç±»ä¼¼äº1Cä¸­çš„æ ‡å‡†Windowså¿«ç…§ã€‚ <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/6f4/b8c/d33/6f4b8cd334ab0d6d74650a41a073d599.png" alt="å›¾ç‰‡"></a> <br><br> æ„æˆè¯¥çª—å£çš„ä¸»è¦ä»£ç åŒ…å«åœ¨æ–‡ä»¶ä¸­ <br><div class="spoiler">  <b class="spoiler_title">lib / gui.tcl</b> <div class="spoiler_text"><pre> <code class="hljs mel">#       #     topLevelGeometry    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[info <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> topLevelGeometry]} { wm geometry . $topLevelGeometry } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { wm geometry . <span class="hljs-number"><span class="hljs-number">1024</span></span>x768 } #   wm title . <span class="hljs-string"><span class="hljs-string">"1C Rac GUI"</span></span> wm iconname . <span class="hljs-string"><span class="hljs-string">"1C Rac Gui"</span></span> #   (   lib/imges.tcl) wm iconphoto . tcl wm protocol . WM_DELETE_WINDOW Quit wm overrideredirect . <span class="hljs-number"><span class="hljs-number">0</span></span> wm positionfrom . user ttk::style theme use clam #   set frm_tool [frame .frm_tool] pack $frm_tool -side left -fill y ttk::panedwindow .<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> -orient horizontal -style TPanedwindow pack .<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> -expand true -fill both pack propagate .<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> false ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_tool.btn_add -command Add -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> add_grey_32 ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_tool.btn_del -command Del -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> del_grey_32 ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_tool.btn_edit -command Edit -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> edit_grey_32 ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_tool.btn_quit -command Quit -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> quit_grey_32 pack $frm_tool.btn_add $frm_tool.btn_del $frm_tool.btn_edit -side top -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> pack $frm_tool.btn_quit -side bottom -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> #     set frm_tree [frame .frm_tree] ttk::scrollbar $frm_tree.hsb1 -orient horizontal -command [list $frm_tree.tree xview] ttk::scrollbar $frm_tree.vsb1 -orient vertical -command [list $frm_tree.tree yview] set tree [ttk::treeview $frm_tree.tree -show tree \ -xscrollcommand [list $frm_tree.hsb1 set] -yscrollcommand [list $frm_tree.vsb1 set]] <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $tree -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm_tree.vsb1 -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm_tree.hsb1 -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> columnconfigure $frm_tree <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> rowconfigure $frm_tree <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> #      bind $frm_tree.tree &lt;ButtonRelease&gt; <span class="hljs-string"><span class="hljs-string">"TreePress $frm_tree.tree"</span></span> #    () set frm_work [frame .frm_work] ttk::scrollbar $frm_work.hsb -orient horizontal -command [list $frm_work.tree_work xview] ttk::scrollbar $frm_work.vsb -orient vertical -command [list $frm_work.tree_work yview] set tree_work [ ttk::treeview $frm_work.tree_work \ -show headings -columns <span class="hljs-string"><span class="hljs-string">"par val"</span></span> -displaycolumns <span class="hljs-string"><span class="hljs-string">"par val"</span></span>\ -xscrollcommand [list $frm_work.hsb set] \ -yscrollcommand [list $frm_work.vsb set] ] #       $tree_work tag configure dark -background $color(dark_table_bg) $tree_work tag configure light -background $color(light_table_bg) #     <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $tree_work -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm_work.vsb -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm_work.hsb -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nsew <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> columnconfigure $frm_work <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> rowconfigure $frm_work <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> pack $frm_tree $frm_work -side left -expand true -fill both #.<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> add $frm_tool -weight <span class="hljs-number"><span class="hljs-number">1</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> add $frm_tree -weight <span class="hljs-number"><span class="hljs-number">1</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">panel</span></span> add $frm_work -weight <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br></div></div><br> ä½¿ç”¨è¯¥ç¨‹åºçš„ç®—æ³•å¦‚ä¸‹ï¼š <br><br>  1.é¦–å…ˆï¼Œæ‚¨éœ€è¦æ·»åŠ ä¸»é›†ç¾¤æœåŠ¡å™¨ï¼ˆå³é›†ç¾¤ç®¡ç†æœåŠ¡å™¨ï¼ˆåœ¨Linuxä¸­ï¼Œè¯¥å‘½ä»¤ä»¥å‘½ä»¤â€œ /opt/1C/v8.3/x86_64/ras cluster --daemonâ€å¯åŠ¨ï¼‰ï¼‰ <br><br> ä¸ºæ­¤ï¼Œè¯·å•å‡»â€œ +â€æŒ‰é’®ï¼Œç„¶ååœ¨æ‰“å¼€çš„çª—å£ä¸­è¾“å…¥æœåŠ¡å™¨åœ°å€å’Œç«¯å£ï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/797/a05/385/797a05385f32c2155465159783107292.png" alt="å›¾ç‰‡"><br><br> ä¹‹åï¼Œæˆ‘ä»¬çš„æœåŠ¡å™¨é€šè¿‡å•å‡»å‡ºç°åœ¨æ ‘ä¸­ï¼Œç„¶åæ‰“å¼€é›†ç¾¤åˆ—è¡¨æˆ–æ˜¾ç¤ºè¿æ¥é”™è¯¯ã€‚ <br><br>  2.å•å‡»ç¾¤é›†åç§°ï¼Œå°†æ‰“å¼€ä¸€ä¸ªå¯ç”¨åŠŸèƒ½åˆ—è¡¨ã€‚ <br><br>  3. ... <br><br> ç­‰ç­‰ï¼Œå³ è¦æ·»åŠ æ–°é›†ç¾¤ï¼Œè¯·åœ¨åˆ—è¡¨ä¸­é€‰æ‹©ä»»ä½•å¯ç”¨é›†ç¾¤ï¼Œç„¶åæŒ‰å·¥å…·æ ä¸­çš„+æŒ‰é’®ï¼Œå°†æ˜¾ç¤ºç”¨äºæ·»åŠ æ–°é›†ç¾¤çš„å¯¹è¯æ¡†ï¼š <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/beb/9b9/1a6/beb9b91a676ff556da29256fb37b78b3.png" alt="å›¾ç‰‡"></a> <br><br> å·¥å…·æ ä¸Šçš„æŒ‰é’®æ ¹æ®ä¸Šä¸‹æ–‡æ‰§è¡ŒåŠŸèƒ½ï¼Œå³ ä»æ ‘æˆ–åˆ—è¡¨çš„å“ªä¸ªå…ƒç´ ä¸­é€‰æ‹©ï¼Œå°†æ‰§è¡Œæ­¤è¿‡ç¨‹ã€‚ <br><br> ä»¥æ·»åŠ æŒ‰é’®ï¼ˆâ€œ +â€ï¼‰ä¸ºä¾‹ï¼š <br><br> æŒ‰é’®ç”Ÿæˆä»£ç ï¼š <br><br><pre> <code class="hljs mel">ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_tool.btn_add -command Add -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> add_grey_32</code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œå°†æ‰§è¡ŒAddè¿‡ç¨‹åŠå…¶ä»£ç ï¼š <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> Add {} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> active_cluster host #     set id [.frm_tree.tree selection] #     set values [.frm_tree.tree item [.frm_tree.tree selection] -values] set key [lindex [split $id <span class="hljs-string"><span class="hljs-string">"::"</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span>] #           <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$key eq <span class="hljs-string"><span class="hljs-string">""</span></span> || $key eq <span class="hljs-string"><span class="hljs-string">"server"</span></span>} { set host [ Add::server ] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } Add::$key .frm_tree.tree $host $values }</code> </pre> <br> å› æ­¤ï¼ŒæŒ ç—’ç—’çš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯æ˜¾è€Œæ˜“è§çš„-æ‚¨å¯ä»¥å°†å˜é‡çš„å€¼ä½œä¸ºè¿‡ç¨‹çš„åç§°ä¼ é€’ï¼š <br><br><pre> <code class="hljs ruby">Add::$key .frm_tree.tree $host $values</code> </pre> <br> ä¹Ÿå°±æ˜¯è¯´ï¼Œä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä¸»æœåŠ¡å™¨ä¸Šæˆ³å¹¶æŒ‰â€œ +â€ï¼Œåˆ™å°†å¯åŠ¨Add ::æœåŠ¡å™¨è¿‡ç¨‹ï¼Œå¦‚æœé›†ç¾¤æ˜¯Add :: clusterç­‰ï¼ˆæˆ‘ä¼šå†™ä¸€äº›å…³äºå¿…è¦çš„â€œé”®â€æ¥è‡ªä½•å¤„çš„ä¿¡æ¯ï¼‰ã€‚ä¸‹é¢ï¼‰ï¼Œåˆ—å‡ºçš„è¿‡ç¨‹å°†ç»˜åˆ¶é€‚åˆäºä¸Šä¸‹æ–‡çš„å›¾å½¢å…ƒç´ ã€‚ <br><br> æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œè¡¨å•çš„æ ·å¼ç›¸ä¼¼-è¿™å¹¶ä¸å¥‡æ€ªï¼Œå› ä¸ºå®ƒä»¬æ˜¾ç¤ºåœ¨ä¸€ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ›´ç¡®åˆ‡åœ°è¯´æ˜¯è¡¨å•çš„ä¸»æ¡†æ¶ï¼ˆçª—å£ï¼ŒæŒ‰é’®ï¼Œå›¾åƒï¼Œæ ‡ç­¾ï¼‰ï¼Œè¿‡ç¨‹çš„åç§° <div class="spoiler">  <b class="spoiler_title">AddTopLevel</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> AddToplevel {lbl img {win_name .add}} { set cmd <span class="hljs-string"><span class="hljs-string">"destroy $win_name"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [winfo <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $win_name] {destroy $win_name} toplevel $win_name wm title $win_name $lbl wm iconphoto $win_name tcl #    ttk::label $win_name.lbl -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> $img #     set frm [ttk::labelframe $win_name.frm -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> $lbl -labelanchor nw] <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> columnconfigure $frm <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> rowconfigure $frm <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> #    set frm_btn [frame $win_name.frm_btn -border <span class="hljs-number"><span class="hljs-number">0</span></span>] ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_btn.btn_ok -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> ok_grey_24 -command { } ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_btn.btn_cancel -command $cmd -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> quit_grey_24 <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $win_name.lbl -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm_btn -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky se -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> pack $frm_btn.btn_cancel -side right pack $frm_btn.btn_ok -side right -padx <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $frm }</code> </pre><br></div></div><br> è°ƒç”¨å‚æ•°ï¼šæ ‡é¢˜ï¼Œåº“ä¸­å›¾æ ‡çš„å›¾åƒåç§°ï¼ˆlib / images.tclï¼‰å’Œå¯é€‰çš„çª—å£åç§°å‚æ•°ï¼ˆé»˜è®¤.addï¼‰ã€‚ å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬é‡‡ç”¨ä¸Šè¿°ç¤ºä¾‹æ·»åŠ ä¸»æœåŠ¡å™¨å’Œé›†ç¾¤ï¼Œåˆ™è°ƒç”¨å°†ç›¸åº”åœ°ä¸ºï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">AddToplevel</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span> server_grey_64</code> </pre> <br> æˆ– <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">AddToplevel</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> cluster_grey_64</code> </pre> <br> å¥½äº†ï¼Œç»§ç»­è¿™äº›ç¤ºä¾‹ï¼Œæˆ‘å°†å±•ç¤ºæ˜¾ç¤ºæœåŠ¡å™¨æˆ–é›†ç¾¤çš„æ·»åŠ å¯¹è¯æ¡†çš„è¿‡ç¨‹ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ·»åŠ ::æœåŠ¡å™¨</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> Add::server {} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> #    set frm [AddToplevel <span class="hljs-string"><span class="hljs-string">"  "</span></span> server_grey_64] #         label $frm.lbl_host -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> entry $frm.ent_host label $frm.lbl_port -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> entry $frm.ent_port $frm.ent_port insert end $default(port) <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_host -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_host -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_port -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_port -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> columnconfigure $frm <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> rowconfigure $frm <span class="hljs-number"><span class="hljs-number">0</span></span> -weight <span class="hljs-number"><span class="hljs-number">1</span></span> #set frm_btn [frame .add.frm_btn -border <span class="hljs-number"><span class="hljs-number">0</span></span>] #     .add.frm_btn.btn_ok configure -command { set host [SaveMainServer [.add.frm.ent_host get] [.add.frm.ent_port get]] .frm_tree.tree insert {} end -id <span class="hljs-string"><span class="hljs-string">"server::$host"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"$host"</span></span> -values <span class="hljs-string"><span class="hljs-string">"$host"</span></span> destroy .add <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $host } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $frm }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">æ·»åŠ ::é›†ç¾¤</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> Add::<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span> {tree host values} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> lifetime_limit expiration_timeout session_fault_tolerance_level <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> max_memory_size max_memory_time_limit errors_count_threshold security_level <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> load_balancing_mode kill_problem_processes \ agent_user agent_pwd cluster_user cluster_pwd auth_agent <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$agent_user ne <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; $agent_pwd ne <span class="hljs-string"><span class="hljs-string">""</span></span>} { set auth_agent <span class="hljs-string"><span class="hljs-string">"--agent-user=$agent_user --agent-pwd=$agent_pwd"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set auth_agent <span class="hljs-string"><span class="hljs-string">""</span></span> } #    () set lifetime_limit $default(lifetime_limit) set expiration_timeout $default(expiration_timeout) set session_fault_tolerance_level $default(session_fault_tolerance_level) set max_memory_size $default(max_memory_size) set max_memory_time_limit $default(max_memory_time_limit) set errors_count_threshold $default(errors_count_threshold) set security_level [lindex $default(security_level) <span class="hljs-number"><span class="hljs-number">0</span></span>] set load_balancing_mode [lindex $default(load_balancing_mode) <span class="hljs-number"><span class="hljs-number">0</span></span>] set frm [AddToplevel <span class="hljs-string"><span class="hljs-string">" "</span></span> cluster_grey_64] label $frm.lbl_host -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span> entry $frm.ent_host label $frm.lbl_port -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> entry $frm.ent_port $frm.ent_port insert end $default(port) label $frm.lbl_name -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> entry $frm.ent_name label $frm.lbl_secure_connect -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> ttk::combobox $frm.cb_security_level -textvariable security_level -values $default(security_level) label $frm.lbl_expiration_timeout -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"   :"</span></span> entry $frm.ent_expiration_timeout -textvariable expiration_timeout label $frm.lbl_session_fault_tolerance_level -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> entry $frm.ent_session_fault_tolerance_level -textvariable session_fault_tolerance_level label $frm.lbl_load_balancing_mode -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"  "</span></span> ttk::combobox $frm.cb_load_balancing_mode -textvariable load_balancing_mode \ -values $default(load_balancing_mode) label $frm.lbl_errors_count_threshold -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"    , %"</span></span> entry $frm.ent_errors_count_threshold -textvariable errors_count_threshold label $frm.lbl_processes -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" :"</span></span> label $frm.lbl_lifetime_limit -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" , ."</span></span> entry $frm.ent_lifetime_limit -textvariable lifetime_limit label $frm.lbl_max_memory_size -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"  , "</span></span> entry $frm.ent_max_memory_size -textvariable max_memory_size label $frm.lbl_max_memory_time_limit -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"    , ."</span></span> entry $frm.ent_max_memory_time_limit -textvariable max_memory_time_limit label $frm.lbl_kill_problem_processes -justify left -anchor nw -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"   "</span></span> checkbutton $frm.check_kill_problem_processes -variable kill_problem_processes -onvalue yes -offvalue no <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_host -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_host -row <span class="hljs-number"><span class="hljs-number">0</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_port -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_port -row <span class="hljs-number"><span class="hljs-number">1</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_name -row <span class="hljs-number"><span class="hljs-number">2</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_name -row <span class="hljs-number"><span class="hljs-number">2</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_secure_connect -row <span class="hljs-number"><span class="hljs-number">3</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.cb_security_level -row <span class="hljs-number"><span class="hljs-number">3</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_expiration_timeout -row <span class="hljs-number"><span class="hljs-number">4</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_expiration_timeout -row <span class="hljs-number"><span class="hljs-number">4</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_session_fault_tolerance_level -row <span class="hljs-number"><span class="hljs-number">5</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_session_fault_tolerance_level -row <span class="hljs-number"><span class="hljs-number">5</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_load_balancing_mode -row <span class="hljs-number"><span class="hljs-number">6</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.cb_load_balancing_mode -row <span class="hljs-number"><span class="hljs-number">6</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_errors_count_threshold -row <span class="hljs-number"><span class="hljs-number">7</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_errors_count_threshold -row <span class="hljs-number"><span class="hljs-number">7</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_processes -row <span class="hljs-number"><span class="hljs-number">8</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_lifetime_limit -row <span class="hljs-number"><span class="hljs-number">9</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_lifetime_limit -row <span class="hljs-number"><span class="hljs-number">9</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_max_memory_size -row <span class="hljs-number"><span class="hljs-number">10</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_max_memory_size -row <span class="hljs-number"><span class="hljs-number">10</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_max_memory_time_limit -row <span class="hljs-number"><span class="hljs-number">11</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.ent_max_memory_time_limit -row <span class="hljs-number"><span class="hljs-number">11</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nsew -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.lbl_kill_problem_processes -row <span class="hljs-number"><span class="hljs-number">12</span></span> -column <span class="hljs-number"><span class="hljs-number">0</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> $frm.check_kill_problem_processes -row <span class="hljs-number"><span class="hljs-number">12</span></span> -column <span class="hljs-number"><span class="hljs-number">1</span></span> -sticky nw -padx <span class="hljs-number"><span class="hljs-number">5</span></span> -pady <span class="hljs-number"><span class="hljs-number">5</span></span> #   .add.frm_btn.btn_ok configure -command { RunCommand <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"cluster insert \ --host=[.add.frm.ent_host get] \ --port=[.add.frm.ent_port get] \ --name=[.add.frm.ent_name get] \ --expiration-timeout=$expiration_timeout \ --lifetime-limit=$lifetime_limit \ --max-memory-size=$max_memory_size \ --max-memory-time-limit=$max_memory_time_limit \ --security-level=$security_level \ --session-fault-tolerance-level=$session_fault_tolerance_level \ --load-balancing-mode=$load_balancing_mode \ --errors-count-threshold=$errors_count_threshold \ --kill-problem-processes=$kill_problem_processes \ $auth_agent $host"</span></span> Run::server $tree $host <span class="hljs-string"><span class="hljs-string">""</span></span> destroy .add } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $frm }</code> </pre> <br></div></div><br> æ¯”è¾ƒè¿™äº›è¿‡ç¨‹çš„ä»£ç æ—¶ï¼Œè‚‰çœ¼å¯ä»¥çœ‹åˆ°å·®å¼‚ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»â€œç¡®å®šâ€æŒ‰é’®çš„å¤„ç†ç¨‹åºã€‚ åœ¨Tkä¸­ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶ä½¿ç”¨<i>configure</i>é€‰é¡¹é‡æ–°å®šä¹‰å›¾å½¢å…ƒç´ çš„å±æ€§ã€‚ ä¾‹å¦‚ï¼Œåˆå§‹æŒ‰é’®è¾“å‡ºå‘½ä»¤ï¼š <br><br><pre> <code class="hljs mel">ttk::<span class="hljs-keyword"><span class="hljs-keyword">button</span></span> $frm_btn.btn_ok -<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> ok_grey_24 -command { }</code> </pre> <br> ä½†æ˜¯åœ¨æˆ‘ä»¬çš„è¡¨å•ä¸­ï¼Œå‘½ä»¤å–å†³äºæ‰€éœ€çš„åŠŸèƒ½ï¼š <br><br><pre> <code class="hljs bash"> .add.frm_btn.btn_ok configure -<span class="hljs-built_in"><span class="hljs-built_in">command</span></span> { RunCommand <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"cluster insert \ --host=[.add.frm.ent_host get] \ --port=[.add.frm.ent_port get] \ --name=[.add.frm.ent_name get] \ --expiration-timeout=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$expiration_timeout</span></span></span><span class="hljs-string"> \ --lifetime-limit=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$lifetime_limit</span></span></span><span class="hljs-string"> \ --max-memory-size=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$max_memory_size</span></span></span><span class="hljs-string"> \ --max-memory-time-limit=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$max_memory_time_limit</span></span></span><span class="hljs-string"> \ --security-level=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$security_level</span></span></span><span class="hljs-string"> \ --session-fault-tolerance-level=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$session_fault_tolerance_level</span></span></span><span class="hljs-string"> \ --load-balancing-mode=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$load_balancing_mode</span></span></span><span class="hljs-string"> \ --errors-count-threshold=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$errors_count_threshold</span></span></span><span class="hljs-string"> \ --kill-problem-processes=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$kill_problem_processes</span></span></span><span class="hljs-string"> \ </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$auth_agent</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$host</span></span></span><span class="hljs-string">"</span></span> Run::server <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-variable"><span class="hljs-variable">$host</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> destroy .add }</code> </pre><br> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œâ€œå·²é˜»å¡â€æŒ‰é’®å¼€å§‹æ·»åŠ ç¾¤é›†çš„è¿‡ç¨‹ã€‚ <br><br> åœ¨è¿™é‡Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨Tkä¸­ä½¿ç”¨å›¾å½¢å…ƒç´ -å¯¹äºå„ç§æ•°æ®è¾“å…¥å…ƒç´ ï¼ˆè¾“å…¥ï¼Œç»„åˆæ¡†ï¼Œå¤é€‰æŒ‰é’®ç­‰ï¼‰ï¼Œå¼•å…¥äº†è¯¸å¦‚æ–‡æœ¬å˜é‡ï¼ˆtextvariableï¼‰ä¹‹ç±»çš„å‚æ•°ï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">entry</span></span> <span class="hljs-variable"><span class="hljs-variable">$frm</span></span>.ent_lifetime_limit -textvariable lifetime_limit</code> </pre> <br> æ­¤å˜é‡åœ¨å…¨å±€åç§°ç©ºé—´ä¸­å®šä¹‰ï¼Œå¹¶åŒ…å«è¾“å…¥çš„å½“å‰å€¼ã€‚ å³ ä¸ºäº†ä»å­—æ®µä¸­è·å–è¾“å…¥çš„æ–‡æœ¬ï¼Œæ‚¨åªéœ€è¦è¯»å–å¯¹åº”äºå˜é‡çš„å€¼ï¼ˆå½“ç„¶ï¼Œåªè¦åœ¨åˆ›å»ºå…ƒç´ æ—¶å·²å®šä¹‰è¯¥å€¼å³å¯ï¼‰ã€‚ <br><br> è·å–è¾“å…¥çš„æ–‡æœ¬ï¼ˆç”¨äºç±»å‹ä¸ºentryçš„å…ƒç´ ï¼‰çš„ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨getå‘½ä»¤ï¼š <br><br><pre> <code class="hljs css"><span class="hljs-selector-class"><span class="hljs-selector-class">.add</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.frm</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.ent_name</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">get</span></span></code> </pre> <br> è¿™ä¸¤ç§æ–¹æ³•éƒ½å¯ä»¥åœ¨ä¸Šé¢çš„ä»£ç ä¸­çœ‹åˆ°ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå•å‡»æ­¤æŒ‰é’®å°†ä½¿ç”¨ç”Ÿæˆçš„å‘½ä»¤è¡Œå¯åŠ¨RunCommandè¿‡ç¨‹ï¼Œä»¥æŒ‰ç…§racçš„æ–¹å¼æ·»åŠ é›†ç¾¤ï¼š <br><br><pre> <code class="bash hljs">/opt/1C/v8.3/x86_64/rac cluster insert --host=localhost --port=1540 --name=dsdsds --expiration-timeout=0 --lifetime-limit=0 --max-memory-size=0 --max-memory-time-limit=0 --security-level=0 --session-fault-tolerance-level=0 --load-balancing-mode=performance --errors-count-threshold=0 --<span class="hljs-built_in"><span class="hljs-built_in">kill</span></span>-problem-processes=no localhost:1545</code> </pre> <br> å› æ­¤ï¼Œæˆ‘ä»¬æ¥åˆ°äº†ä¸»å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨æ‰€éœ€çš„å‚æ•°æ§åˆ¶racçš„å¯åŠ¨ï¼Œè¿˜å°†å‘½ä»¤çš„è¾“å‡ºè§£æä¸ºåˆ—è¡¨ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿”å›ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">è¿è¡Œå‘½ä»¤</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> RunCommand {root par} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> dir rac_cmd <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span> work_list_row_count agent_user agent_pwd cluster_user cluster_pwd puts <span class="hljs-string"><span class="hljs-string">"$rac_cmd $par"</span></span> set work_list_row_count <span class="hljs-number"><span class="hljs-number">0</span></span> #      # $rac -     # $par -      set pipe [open <span class="hljs-string"><span class="hljs-string">"|$rac_cmd $par"</span></span> <span class="hljs-string"><span class="hljs-string">"r"</span></span>] try { set lst <span class="hljs-string"><span class="hljs-string">""</span></span> set l <span class="hljs-string"><span class="hljs-string">""</span></span> #       <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> {[gets $pipe line]&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span>} { #puts $line <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$line eq <span class="hljs-string"><span class="hljs-string">""</span></span>} { lappend l $lst set lst <span class="hljs-string"><span class="hljs-string">""</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { lappend lst [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $line] } } close $pipe <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $l } on <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> {result options} { #    ErrorParcing $result $options <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> } }</code> </pre> <br></div></div><br> è¾“å…¥ä¸»æœåŠ¡å™¨çš„æ•°æ®åï¼Œå®ƒå°†è¢«æ·»åŠ åˆ°æ ‘ä¸­ï¼Œä¸ºæ­¤ï¼Œåœ¨ä¸Šé¢çš„â€œæ·»åŠ ï¼šæœåŠ¡å™¨â€è¿‡ç¨‹ä¸­ï¼Œä»¥ä¸‹ä»£ç è´Ÿè´£ï¼š <br><br><pre> <code class="hljs powershell">.frm_tree.tree insert {} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"server::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$host</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$host</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$host</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br> ç°åœ¨ï¼Œå•å‡»æ ‘ä¸­çš„æœåŠ¡å™¨åç§°ï¼Œæˆ‘ä»¬å°†è·å¾—è¯¥æœåŠ¡å™¨ç®¡ç†çš„é›†ç¾¤çš„åˆ—è¡¨ï¼Œç„¶åå•å‡»é›†ç¾¤ï¼Œå°†è·å¾—é›†ç¾¤å…ƒç´ ï¼ˆæœåŠ¡å™¨ï¼Œä¿¡æ¯åº“ç­‰ï¼‰çš„åˆ—è¡¨ã€‚ è¿™æ˜¯åœ¨TreePressè¿‡ç¨‹ï¼ˆæ–‡ä»¶lib / function.tclï¼‰ä¸­å®ç°çš„ï¼š <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> TreePress {tree} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> host server active_cluster infobase #    set id [$tree selection] #     SetGlobalVarFromTreeItems $tree $id #    , ..     set values [$tree item $id -values] set key [lindex [split $id <span class="hljs-string"><span class="hljs-string">"::"</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span>] #            #    Run Run::$key $tree $host $values }</code> </pre> <br> å› æ­¤ï¼Œå°†ä¸ºä¸»æœåŠ¡å™¨å¯åŠ¨Run ::æœåŠ¡å™¨ï¼ˆå¯¹äºç¾¤é›†ï¼Œå°†å¯åŠ¨Run ::é›†ç¾¤ï¼Œå¯¹äºç”Ÿäº§æœåŠ¡å™¨ï¼Œå°†è¿è¡ŒRun :: work_serverç­‰ï¼‰ã€‚ å³  $é”®å˜é‡çš„å€¼æ˜¯<i>-id</i>é€‰é¡¹æŒ‡å®šçš„æ ‘å…ƒç´ åç§°çš„ä¸€éƒ¨åˆ†ã€‚ <br><br> æ³¨æ„ç¨‹åº <br><br><div class="spoiler">  <b class="spoiler_title">è¿è¡Œ::æœåŠ¡å™¨</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> Run::server {tree host values} { #      set lst [RunCommand server::$host <span class="hljs-string"><span class="hljs-string">"cluster list $host"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$lst eq <span class="hljs-string"><span class="hljs-string">""</span></span>} {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>} set l [lindex $lst <span class="hljs-number"><span class="hljs-number">0</span></span>] #puts $lst #     .frm_work.tree_work <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> [ .frm_work.tree_work children {}] #   foreach cluster_list $lst { #     InsertItemsWorkList $cluster_list #   ()      foreach i $cluster_list { #puts $i set cluster_list [split $i <span class="hljs-string"><span class="hljs-string">":"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> [lindex $cluster_list <span class="hljs-number"><span class="hljs-number">0</span></span>]] eq <span class="hljs-string"><span class="hljs-string">"cluster"</span></span>} { set cluster_id [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> [lindex $cluster_list <span class="hljs-number"><span class="hljs-number">1</span></span>]] lappend <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>($cluster_id) $cluster_id } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> [lindex $cluster_list <span class="hljs-number"><span class="hljs-number">0</span></span>]] eq <span class="hljs-string"><span class="hljs-string">"name"</span></span>} { lappend <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>($cluster_id) [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> [lindex $cluster_list <span class="hljs-number"><span class="hljs-number">1</span></span>]] } } } #     foreach x [array names <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>] { set id [lindex $cluster($x) <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [$tree <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> <span class="hljs-string"><span class="hljs-string">"cluster::$id"</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { $tree insert <span class="hljs-string"><span class="hljs-string">"server::$host"</span></span> end -id <span class="hljs-string"><span class="hljs-string">"cluster::$id"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">"[lindex $cluster($x) 1]"</span></span> -values <span class="hljs-string"><span class="hljs-string">"$id"</span></span> #     InsertClusterItems $tree $id } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [$tree <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> <span class="hljs-string"><span class="hljs-string">"agent_admins::$id"</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { $tree insert <span class="hljs-string"><span class="hljs-string">"server::$host"</span></span> end -id <span class="hljs-string"><span class="hljs-string">"agent_admins::$id"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> -values <span class="hljs-string"><span class="hljs-string">"$id"</span></span> #InsertClusterItems $tree $id } }</code> </pre> <br></div></div><br> æ­¤è¿‡ç¨‹å¤„ç†é€šè¿‡RunCommandå‘½ä»¤ä»æœåŠ¡å™¨æ”¶åˆ°çš„å†…å®¹ï¼Œå¹¶å°†å„ç§å†…å®¹æ·»åŠ åˆ°æ ‘ä¸­-ç¾¤é›†ï¼Œå„ç§æ ¹å…ƒç´ ï¼ˆæ•°æ®åº“ï¼Œç”Ÿäº§æœåŠ¡å™¨ï¼Œä¼šè¯ç­‰ï¼‰ã€‚ å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œæ‚¨ä¼šåœ¨å†…éƒ¨æ³¨æ„åˆ°å¯¹InsertItemsWorkListè¿‡ç¨‹çš„è°ƒç”¨ã€‚ å®ƒç”¨äºå°†å…ƒç´ æ·»åŠ åˆ°å›¾å½¢åˆ—è¡¨ä¸­ï¼Œå¤„ç†æ§åˆ¶å°å®ç”¨ç¨‹åºracçš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºä»¥å‰ä½œä¸ºåˆ—è¡¨è¿”å›ç»™å˜é‡$ lstã€‚ è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å«ç”¨å†’å·åˆ†éš”çš„æˆå¯¹å…ƒç´ ã€‚ <br><br> ä¾‹å¦‚ï¼Œç¾¤é›†è¿æ¥åˆ—è¡¨ï¼š <br><br><pre> <code class="hljs powershell">svk@svk ~]<span class="hljs-variable"><span class="hljs-variable">$</span></span> /opt/<span class="hljs-number"><span class="hljs-number">1</span></span>C/v8.<span class="hljs-number"><span class="hljs-number">3</span></span>/x86_64/rac connection list -<span class="hljs-literal"><span class="hljs-literal">-cluster</span></span>=<span class="hljs-number"><span class="hljs-number">783</span></span>d2170<span class="hljs-literal"><span class="hljs-literal">-56c3</span></span><span class="hljs-literal"><span class="hljs-literal">-11e8</span></span><span class="hljs-literal"><span class="hljs-literal">-c586</span></span><span class="hljs-literal"><span class="hljs-literal">-fc75165efbb2</span></span> localhost:<span class="hljs-number"><span class="hljs-number">1545</span></span> connection : dcf5991c<span class="hljs-literal"><span class="hljs-literal">-7d24</span></span><span class="hljs-literal"><span class="hljs-literal">-11e8</span></span><span class="hljs-literal"><span class="hljs-literal">-1690</span></span><span class="hljs-literal"><span class="hljs-literal">-fc75165efbb2</span></span> conn<span class="hljs-literal"><span class="hljs-literal">-id</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> host : svk.home <span class="hljs-keyword"><span class="hljs-keyword">process</span></span> : <span class="hljs-number"><span class="hljs-number">79</span></span>de2e16<span class="hljs-literal"><span class="hljs-literal">-56c3</span></span><span class="hljs-literal"><span class="hljs-literal">-11e8</span></span><span class="hljs-literal"><span class="hljs-literal">-c586</span></span><span class="hljs-literal"><span class="hljs-literal">-fc75165efbb2</span></span> infobase : <span class="hljs-number"><span class="hljs-number">00000000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-000000000000</span></span> application : <span class="hljs-string"><span class="hljs-string">"JobScheduler"</span></span> connected<span class="hljs-literal"><span class="hljs-literal">-at</span></span> : <span class="hljs-number"><span class="hljs-number">2018</span></span><span class="hljs-literal"><span class="hljs-literal">-07</span></span><span class="hljs-literal"><span class="hljs-literal">-01T14</span></span>:<span class="hljs-number"><span class="hljs-number">49</span></span>:<span class="hljs-number"><span class="hljs-number">51</span></span> session<span class="hljs-literal"><span class="hljs-literal">-number</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> blocked<span class="hljs-literal"><span class="hljs-literal">-by</span></span><span class="hljs-literal"><span class="hljs-literal">-ls</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> connection : b993293a<span class="hljs-literal"><span class="hljs-literal">-7d24</span></span><span class="hljs-literal"><span class="hljs-literal">-11e8</span></span><span class="hljs-literal"><span class="hljs-literal">-1690</span></span><span class="hljs-literal"><span class="hljs-literal">-fc75165efbb2</span></span> conn<span class="hljs-literal"><span class="hljs-literal">-id</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> host : svk.home <span class="hljs-keyword"><span class="hljs-keyword">process</span></span> : <span class="hljs-number"><span class="hljs-number">79</span></span>de2e16<span class="hljs-literal"><span class="hljs-literal">-56c3</span></span><span class="hljs-literal"><span class="hljs-literal">-11e8</span></span><span class="hljs-literal"><span class="hljs-literal">-c586</span></span><span class="hljs-literal"><span class="hljs-literal">-fc75165efbb2</span></span> infobase : <span class="hljs-number"><span class="hljs-number">00000000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-0000</span></span><span class="hljs-literal"><span class="hljs-literal">-000000000000</span></span> application : <span class="hljs-string"><span class="hljs-string">"JobScheduler"</span></span> connected<span class="hljs-literal"><span class="hljs-literal">-at</span></span> : <span class="hljs-number"><span class="hljs-number">2018</span></span><span class="hljs-literal"><span class="hljs-literal">-07</span></span><span class="hljs-literal"><span class="hljs-literal">-01T14</span></span>:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">52</span></span> session<span class="hljs-literal"><span class="hljs-literal">-number</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> blocked<span class="hljs-literal"><span class="hljs-literal">-by</span></span><span class="hljs-literal"><span class="hljs-literal">-ls</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br> åœ¨å›¾å½¢å½¢å¼ä¸‹ï¼Œå®ƒå°†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/664/71d/737/66471d73799b3fa2801e751afe1bf6c2.png" alt="å›¾ç‰‡"></a> <br><br> ä¸Šé¢çš„è¿‡ç¨‹å°†æ ‡è¯†æ ‡é¢˜å…ƒç´ çš„åç§°ä»¥åŠå¡«å……è¡¨çš„æ•°æ®ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">InsertItemsWorkList</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> InsertItemsWorkList {lst} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> work_list_row_count #      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [expr $work_list_row_count % <span class="hljs-number"><span class="hljs-number">2</span></span>] { set tag dark } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set tag light } #      -  foreach i $lst { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [regexp -nocase -all -- {(\D+)(\s*?|)(:)(\s*?|)(.*)} $i <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> param v2 v3 v4 value] { lappend column_list [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $param] lappend value_list [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $value] } } #   .frm_work.tree_work configure -columns $column_list -displaycolumns $column_list .frm_work.tree_work insert {} end -values $value_list -tags $tag .frm_work.tree_work column #<span class="hljs-number"><span class="hljs-number">0</span></span> -stretch #   foreach j $column_list { .frm_work.tree_work heading $j -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> $j } incr work_list_row_count }</code> </pre> <br></div></div><br> åœ¨è¿™é‡Œï¼Œè€Œä¸æ˜¯ç®€å•çš„å‘½ä»¤[split $ strâ€œï¼šâ€]ï¼Œè¯¥å‘½ä»¤å°†å­—ç¬¦ä¸²åˆ†æˆç”±â€œï¼šâ€åˆ†éš”çš„å…ƒç´ å¹¶è¿”å›åˆ—è¡¨ï¼Œè€Œæ˜¯åº”ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œå› ä¸ºæŸäº›å…ƒç´ è¿˜åŒ…å«å†’å·ã€‚ <br><br>  InsertClusterItemsè¿‡ç¨‹ï¼ˆå‡ ä¸ªç±»ä¼¼çš„è¿‡ç¨‹ä¹‹ä¸€ï¼‰ä»…å°†å¸¦æœ‰ç›¸åº”æ ‡è¯†ç¬¦çš„å­å…ƒç´ åˆ—è¡¨æ·»åŠ åˆ°æ ‘ä¸­æ‰€éœ€çš„é›†ç¾¤å…ƒç´ ä¸Š <br><div class="spoiler">  <b class="spoiler_title">InsertClusterItems</b> <div class="spoiler_text"><pre> <code class="hljs powershell">proc InsertClusterItems {tree id} { set parent <span class="hljs-string"><span class="hljs-string">"cluster::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"infobases::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"servers::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"admins::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"managers::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-variable"><span class="hljs-variable">$id</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"processes::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"workprocess-all"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"sessions::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"sessions-all"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"locks::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"blocks-all"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"connections::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"connections-all"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"profiles::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-variable"><span class="hljs-variable">$id</span></span> }</code> </pre><br></div></div><br> æ‚¨å¯ä»¥è€ƒè™‘ä½¿ç”¨ä¸¤ä¸ªä»¥ä¸Šçš„é€‰é¡¹æ¥å®ç°æ­¤è¿‡ç¨‹ï¼Œå…¶ä¸­å°†æ¸…æ™°å¯è§å¦‚ä½•ä¼˜åŒ–å¹¶æ¶ˆé™¤é‡å¤çš„å‘½ä»¤ï¼š <br><br> åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ·»åŠ å’Œæ£€æŸ¥åœ¨é¢å¤´ä¸Šå¾—åˆ°è§£å†³ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">InsertBaseItems</b> <div class="spoiler_text"><pre> <code class="hljs powershell">proc InsertBaseItems {tree id} { set parent <span class="hljs-string"><span class="hljs-string">"infobase::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">exists</span></span> <span class="hljs-string"><span class="hljs-string">"sessions::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"sessions::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">exists</span></span> <span class="hljs-string"><span class="hljs-string">"locks::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"locks::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">exists</span></span> <span class="hljs-string"><span class="hljs-string">"connections::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-string"><span class="hljs-string">"connections::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> } }</code> </pre><br></div></div><br> è¿™é‡Œçš„æ–¹æ³•æ›´æ­£ç¡®ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">InsertProfileItems</b> <div class="spoiler_text"><pre> <code class="hljs powershell">proc InsertProfileItems {tree id} { set parent <span class="hljs-string"><span class="hljs-string">"profile::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> set lst { {dir <span class="hljs-string"><span class="hljs-string">" "</span></span>} {com <span class="hljs-string"><span class="hljs-string">" COM-"</span></span>} {addin <span class="hljs-string"><span class="hljs-string">" "</span></span>} {module <span class="hljs-string"><span class="hljs-string">"   "</span></span>} {app <span class="hljs-string"><span class="hljs-string">" "</span></span>} {inet <span class="hljs-string"><span class="hljs-string">" "</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> i <span class="hljs-variable"><span class="hljs-variable">$lst</span></span> { append item [<span class="hljs-type"><span class="hljs-type">lindex</span></span> <span class="hljs-variable"><span class="hljs-variable">$i</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-string"><span class="hljs-string">"::</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> { [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">exists</span></span> <span class="hljs-variable"><span class="hljs-variable">$item</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span> } { <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> insert <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-literal"><span class="hljs-literal">-id</span></span> <span class="hljs-variable"><span class="hljs-variable">$item</span></span> <span class="hljs-literal"><span class="hljs-literal">-text</span></span> [<span class="hljs-type"><span class="hljs-type">lindex</span></span> <span class="hljs-variable"><span class="hljs-variable">$i</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-literal"><span class="hljs-literal">-values</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$id</span></span></span><span class="hljs-string">"</span></span> } unset item } }</code> </pre> <br></div></div><br> å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä½¿ç”¨æ‰§è¡Œé‡å¤å‘½ä»¤çš„å‘¨æœŸã€‚ å¼€å‘äººå‘˜å¯ä»¥è‡ªè¡Œå†³å®šä½¿ç”¨å“ªç§æ–¹æ³•ã€‚ <br><br> æˆ‘ä»¬è€ƒè™‘è¿‡æ·»åŠ å…ƒç´ å¹¶æ¥æ”¶æ•°æ®ï¼›ç°åœ¨è¯¥åœæ­¢ç¼–è¾‘äº†ã€‚ ç”±äºåŸºæœ¬ä¸Šä½¿ç”¨ç›¸åŒçš„å‚æ•°è¿›è¡Œç¼–è¾‘å’Œæ·»åŠ ï¼ˆä¿¡æ¯åº“é™¤å¤–ï¼‰ï¼Œå› æ­¤å¯¹è¯æ¡†å½¢å¼ç›¸åŒã€‚ æ·»åŠ çš„è¿‡ç¨‹è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br>  <i>æ·»åŠ :: $ key-&gt; AddToplevel</i> <br><br> å¯¹äºè¿™æ ·çš„ç¼–è¾‘ï¼š <br><br>  <i>ç¼–è¾‘:: $ key-&gt;æ·»åŠ :: $ key-&gt; AddTopLevel</i> <br><br> ä¾‹å¦‚ï¼Œç¼–è¾‘ä¸€ä¸ªç¾¤é›†ï¼Œå³ é€šè¿‡å•å‡»æ ‘ä¸­çš„é›†ç¾¤åç§°ï¼ŒæŒ‰å·¥å…·æ ä¸­çš„ç¼–è¾‘æŒ‰é’®ï¼ˆé“…ç¬”ï¼‰ï¼Œå°†æ˜¾ç¤ºç›¸åº”çš„è¡¨å•ï¼š <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2bc/7c7/42b/2bc7c742bc0d7edfb9286002c6740d38.png" alt="å›¾ç‰‡"><br><div class="spoiler">  <b class="spoiler_title">ç¼–è¾‘::é›†ç¾¤</b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> Edit::<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span> {tree host values} { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> lifetime_limit expiration_timeout session_fault_tolerance_level <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> max_memory_size max_memory_time_limit errors_count_threshold security_level <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> load_balancing_mode kill_problem_processes active_cluster \ agent_user agent_pwd cluster_user cluster_pwd auth <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$cluster_user ne <span class="hljs-string"><span class="hljs-string">""</span></span> &amp;&amp; $cluster_pwd ne <span class="hljs-string"><span class="hljs-string">""</span></span>} { set auth <span class="hljs-string"><span class="hljs-string">"--cluster-user=$cluster_user --cluster-pwd=$cluster_pwd"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set auth <span class="hljs-string"><span class="hljs-string">""</span></span> } #     set frm [Add::<span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span> $tree $host $values] #     $frm configure -<span class="hljs-keyword"><span class="hljs-keyword">text</span></span> <span class="hljs-string"><span class="hljs-string">" "</span></span> set active_cluster $values #      set lst [RunCommand <span class="hljs-keyword"><span class="hljs-keyword">cluster</span></span>::$values <span class="hljs-string"><span class="hljs-string">"cluster info --cluster=$active_cluster $host"</span></span>] #   FormFieldsDataInsert $frm $lst #  ,    $frm.ent_host configure -state <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span> $frm.ent_port configure -state <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span> #   .add.frm_btn.btn_ok configure -command { RunCommand <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-string"><span class="hljs-string">"cluster update \ --cluster=$active_cluster $auth \ --name=[.add.frm.ent_name get] \ --expiration-timeout=$expiration_timeout \ --lifetime-limit=$lifetime_limit \ --max-memory-size=$max_memory_size \ --max-memory-time-limit=$max_memory_time_limit \ --security-level=$security_level \ --session-fault-tolerance-level=$session_fault_tolerance_level \ --load-balancing-mode=$load_balancing_mode \ --errors-count-threshold=$errors_count_threshold \ --kill-problem-processes=$kill_problem_processes \ $auth $host"</span></span> $tree <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-string"><span class="hljs-string">"cluster::$active_cluster"</span></span> Run::server $tree $host <span class="hljs-string"><span class="hljs-string">""</span></span> destroy .add } }</code> </pre> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ ¹æ®ä»£ç ä¸­çš„æ³¨é‡Šï¼Œä»åŸç†ä¸Šè®²ï¼Œæ‰€æœ‰å†…å®¹éƒ½å¾ˆæ¸…æ¥šï¼Œåªæ˜¯é‡æ–°å®šä¹‰äº†æŒ‰é’®å¤„ç†ç¨‹åºä»£ç ï¼Œå¹¶ä¸”å­˜åœ¨FormFieldsDataInsertè¿‡ç¨‹ï¼Œè¯¥è¿‡ç¨‹ç”¨æ•°æ®å¡«å……å­—æ®µå¹¶åˆå§‹åŒ–å˜é‡ï¼š </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FormFieldsDataInsert</font></font></b> <div class="spoiler_text"><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> FormFieldsDataInsert {frm lst} { foreach i [lindex $lst <span class="hljs-number"><span class="hljs-number">0</span></span>] { #      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [regexp -nocase -all -- {(\D+)(\s*?|)(:)(\s*?|)(.*)} $i <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> param v2 v3 v4 value] { #   regsub -all -- <span class="hljs-string"><span class="hljs-string">"-"</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $param] <span class="hljs-string"><span class="hljs-string">"_"</span></span> entry_name #   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [winfo <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $frm.ent_$entry_name] { $frm.ent_$entry_name <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> end $frm.ent_$entry_name insert end [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $value <span class="hljs-string"><span class="hljs-string">"\""</span></span>] } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [winfo <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $frm.cb_$entry_name] { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $entry_name set $entry_name [<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trim</span></span> $value <span class="hljs-string"><span class="hljs-string">"\""</span></span>] } #     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [winfo <span class="hljs-keyword"><span class="hljs-keyword">exists</span></span> $frm.check_$entry_name] { <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $entry_name <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {$value eq <span class="hljs-string"><span class="hljs-string">"0"</span></span>} { set $entry_name no } elseif {$value eq <span class="hljs-string"><span class="hljs-string">"1"</span></span>} { set $entry_name yes } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { set $entry_name $value } } } } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†å¦ä¸€ä¸ªåŠ å·tcl-å°†å…¶ä»–å˜é‡çš„å€¼æ›¿æ¢ä¸ºå˜é‡åã€‚ </font></font>å³<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†è‡ªåŠ¨å¡«å†™è¡¨æ ¼å’Œåˆå§‹åŒ–å˜é‡ï¼Œå­—æ®µå’Œå˜é‡çš„åç§°ä¸racå®ç”¨ç¨‹åºçš„å‘½ä»¤è¡Œå¼€å…³ç›¸å¯¹åº”ï¼Œå¹¶ä¸”å‘½ä»¤çš„è¾“å‡ºå‚æ•°çš„åç§°ä¸æŸäº›ä¾‹å¤–ï¼ˆç ´æŠ˜å·ç”±ä¸‹åˆ’çº¿ä»£æ›¿ï¼‰ç›¸å¯¹åº”ã€‚ä¾‹å¦‚ï¼Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schedule-jobs-deny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯¹åº”äº</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ent_scheduled_jobs_deny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å­—æ®µ</font><font style="vertical-align: inherit;">å’Œ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schedule_jobs_deny</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å˜é‡</font><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ å’Œç¼–è¾‘çš„å½¢å¼å¯èƒ½åœ¨å­—æ®µçš„ç»„æˆæ–¹é¢æœ‰æ‰€ä¸åŒï¼Œä¾‹å¦‚ï¼Œä½¿ç”¨ä¿¡æ¯åº“ï¼š</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ IB </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/473/f5c/beb/473f5cbeb4815916e0e8988bc97b873f.png" alt="å›¾ç‰‡"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¼–è¾‘IB </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9d/3d9/ff5/e9d3d9ff549d90d5bd783bbbe8f25f57.png" alt="å›¾ç‰‡"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨Edit ::ä¿¡æ¯åº“ç¼–è¾‘è¿‡ç¨‹ä¸­ï¼Œå¿…å¡«å­—æ®µè¢«æ·»åŠ åˆ°äº†è¡¨å•ä¸­ï¼Œå› æ­¤æˆ‘æ²¡æœ‰ä¸ºæ­¤æä¾›ä»£ç ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»¥æ­¤ç±»æ¨ï¼Œå®ç°äº†å…¶ä»–å…ƒç´ çš„æ·»åŠ ï¼Œç¼–è¾‘ï¼Œåˆ é™¤è¿‡ç¨‹ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±äºè¯¥å®ç”¨ç¨‹åºæ¶‰åŠæ— é™æ•°é‡çš„æœåŠ¡å™¨ï¼Œç¾¤é›†ï¼Œä¿¡æ¯åº“ç­‰ï¼Œä»¥ç¡®å®šæœåŠ¡å™¨æˆ–ä¿¡æ¯å®‰å…¨æ€§å±äºå“ªä¸ªç¾¤é›†ï¼Œå› æ­¤å·²è¾“å…¥å‡ ä¸ªå…¨å±€å˜é‡ï¼Œæ¯æ¬¡å•å‡»æ ‘å…ƒç´ æ—¶éƒ½å°†è®¾ç½®å…¶å€¼ã€‚</font></font>å³<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯¥è¿‡ç¨‹ä»¥é€’å½’æ–¹å¼éå†æ‰€æœ‰çˆ¶å…ƒç´ å¹¶è®¾ç½®å˜é‡ï¼š </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SetGlobalVarFromTreeItems</font></font></b> <div class="spoiler_text"><pre> <code class="hljs powershell">proc SetGlobalVarFromTreeItems {tree id} { global host server active_cluster infobase set parent [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">parent</span></span> <span class="hljs-variable"><span class="hljs-variable">$id</span></span>] set values [<span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-type"><span class="hljs-type">item</span></span> <span class="hljs-variable"><span class="hljs-variable">$id</span></span> -<span class="hljs-type"><span class="hljs-type">values</span></span>] set key [<span class="hljs-type"><span class="hljs-type">lindex</span></span> [<span class="hljs-type"><span class="hljs-type">split</span></span> <span class="hljs-variable"><span class="hljs-variable">$id</span></span> <span class="hljs-string"><span class="hljs-string">"::"</span></span>] <span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> -- <span class="hljs-variable"><span class="hljs-variable">$key</span></span> { server {set host <span class="hljs-variable"><span class="hljs-variable">$values</span></span>} work_server {set server <span class="hljs-variable"><span class="hljs-variable">$values</span></span>} cluster {set active_cluster <span class="hljs-variable"><span class="hljs-variable">$values</span></span>} infobase {set infobase <span class="hljs-variable"><span class="hljs-variable">$values</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> {<span class="hljs-variable"><span class="hljs-variable">$parent</span></span> eq <span class="hljs-string"><span class="hljs-string">""</span></span>} { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { SetGlobalVarFromTreeItems <span class="hljs-variable"><span class="hljs-variable">$tree</span></span> <span class="hljs-variable"><span class="hljs-variable">$parent</span></span> } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1Cç¾¤é›†å¯è®©æ‚¨ä½¿ç”¨æˆ–ä¸ä½¿ç”¨æˆæƒã€‚</font><font style="vertical-align: inherit;">æœ‰ä¸¤ç§ç±»å‹çš„ç®¡ç†å‘˜-ç¾¤é›†ä»£ç†ç®¡ç†å‘˜å’Œç¾¤é›†ç®¡ç†å‘˜ã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œä¸ºäº†è¿›è¡Œæ­£ç¡®çš„æ“ä½œï¼Œå¼•å…¥äº†å¦å¤–4ä¸ªå…¨å±€å˜é‡ï¼Œå…¶ä¸­åŒ…å«ç®¡ç†å‘˜ç™»å½•åå’Œå¯†ç ã€‚</font></font>å³<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¦‚æœç¾¤é›†ä¸­å­˜åœ¨ç®¡ç†å‘˜å¸æˆ·ï¼Œå°†æ˜¾ç¤ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œç”¨äºè¾“å…¥ç™»å½•åå’Œå¯†ç ï¼Œæ•°æ®å°†å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå¹¶æ’å…¥åˆ°ç›¸åº”ç¾¤é›†çš„æ¯ä¸ªå‘½ä»¤ä¸­ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é”™è¯¯å¤„ç†è¿‡ç¨‹å¯¹æ­¤è´Ÿè´£ã€‚</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é”™è¯¯é…å¯¹</font></font></b> <div class="spoiler_text"><pre> <code class="hljs vbscript">proc ErrorParcing {<span class="hljs-built_in"><span class="hljs-built_in">err</span></span> opt} { global cluster_user cluster_pwd agent_user agent_pwd switch -<span class="hljs-built_in"><span class="hljs-built_in">regexp</span></span> -- $<span class="hljs-built_in"><span class="hljs-built_in">err</span></span> { <span class="hljs-string"><span class="hljs-string">"Cluster administrator is not authenticated"</span></span> { AuthorisationDialog <span class="hljs-string"><span class="hljs-string">" "</span></span> .auth_win.frm_btn.btn_ok configure -command { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cluster_user [.auth_win.frm.ent_name <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cluster_pwd [.auth_win.frm.ent_pwd <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] destroy .auth_win } #RunCommand $root $par } <span class="hljs-string"><span class="hljs-string">"Central server administrator is not authenticated"</span></span> { AuthorisationDialog <span class="hljs-string"><span class="hljs-string">"  "</span></span> .auth_win.frm_btn.btn_ok configure -command { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> agent_user [.auth_win.frm.ent_name <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> agent_pwd [.auth_win.frm.ent_pwd <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] destroy .auth_win } } <span class="hljs-string"><span class="hljs-string">"   "</span></span> { AuthorisationDialog <span class="hljs-string"><span class="hljs-string">" "</span></span> .auth_win.frm_btn.btn_ok configure -command { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cluster_user [.auth_win.frm.ent_name <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cluster_pwd [.auth_win.frm.ent_pwd <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] destroy .auth_win } #RunCommand $root $par } <span class="hljs-string"><span class="hljs-string">"    "</span></span> { AuthorisationDialog <span class="hljs-string"><span class="hljs-string">"  "</span></span> .auth_win.frm_btn.btn_ok configure -command { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> agent_user [.auth_win.frm.ent_name <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> agent_pwd [.auth_win.frm.ent_pwd <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>] destroy .auth_win } } (.+) { tk_messageBox -type ok -icon <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> -message <span class="hljs-string"><span class="hljs-string">"$err"</span></span> } } }</code> </pre> <br></div></div><br> å³<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ ¹æ®å‘½ä»¤è¿”å›çš„å†…å®¹ï¼Œä¼šæœ‰ç›¸åº”çš„ååº”ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›®å‰ï¼Œå·²ç»æœ‰95ï¼…çš„åŠŸèƒ½å·²å®ç°ï¼Œä½†ä»éœ€è¦ä½¿ç”¨å®‰å…¨é…ç½®æ–‡ä»¶å’Œtest =ï¼‰æ¥å®ç°ã€‚</font><font style="vertical-align: inherit;">ä»…æ­¤è€Œå·²ã€‚</font><font style="vertical-align: inherit;">å¯¹äºæŠ±æ­‰çš„æ—ç™½ï¼Œæˆ‘æ·±è¡¨æ­‰æ„ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯¥ä»£ç ä¼ ç»Ÿä¸Šå¯</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æ­¤å¤„è·å¾—</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°ï¼šå®‰å…¨é…ç½®æ–‡ä»¶å·²å®Œæˆã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œè¯¥åŠŸèƒ½å·²100ï¼…å®ç°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ–°2ï¼šæ·»åŠ äº†è‹±è¯­å’Œä¿„è¯­çš„æœ¬åœ°åŒ–ï¼Œæ£€æŸ¥äº†win7ä¸­çš„å·¥ä½œ</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/282/7b1/bdb/2827b1bdb698d0cc7341985b139981a6.png" alt="å›¾ç‰‡"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN415835/">https://habr.com/ru/post/zh-CN415835/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN415821/index.html">ç”¨å°½å¯èƒ½å¹¿æ³›çš„ç”µæ°”æ§åˆ¶æ¥ç»„ç»‡â€œæ™ºèƒ½â€æˆ¿å±‹çš„æ–¹æ³•</a></li>
<li><a href="../zh-CN415823/index.html">FindFaceä»…å› å‡¡äººè€Œå…³é—­</a></li>
<li><a href="../zh-CN415829/index.html">æ•°æ®ç±»ç®€ä»‹</a></li>
<li><a href="../zh-CN415831/index.html">ç½—æ–¯ç§‘è«æ–¯çš„æ–°åè¯«</a></li>
<li><a href="../zh-CN415833/index.html">Xamarinçš„ä¼˜ç¼ºç‚¹</a></li>
<li><a href="../zh-CN415837/index.html">å¤ªé˜³èƒ½ç¯ç¬¼çš„æ¦‚è¿°</a></li>
<li><a href="../zh-CN415839/index.html">259å·ç§»åŠ¨å¼€å‘äººå‘˜çš„æœ‰è¶£ææ–™æ‘˜è¦ï¼ˆ6æœˆ25æ—¥-7æœˆ1æ—¥ï¼‰</a></li>
<li><a href="../zh-CN415841/index.html">æˆ‘ä»¬å¦‚ä½•å­¦ä¹ å°†1000rçš„ä¸­å›½ç›¸æœºè¿æ¥åˆ°äº‘ã€‚ æ²¡æœ‰è®°å½•å™¨å’ŒçŸ­ä¿¡ï¼ˆèŠ‚çœäº†æ•°ç™¾ä¸‡ç¾å…ƒï¼‰</a></li>
<li><a href="../zh-CN415843/index.html">315å¹´çš„ç§‘å­¦å®éªŒ</a></li>
<li><a href="../zh-CN415845/index.html">é—®ä¼Šæ£®ï¼šæˆ‘ä»¬å¦‚ä½•çŸ¥é“å¤ªé˜³ç³»çš„å¹´é¾„ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>