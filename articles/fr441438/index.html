<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçü§ù‚Äçüë©üèª ‚òÅÔ∏è üî§ Services unifi√©s goszakup.gov.kz - Version 2 ü§° üëäüèº ü§æüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je travaille en tant que d√©veloppeur au sein de la soci√©t√© Center for Electronic Finance JSC. 
 L'un de nos projets est le Portail des march√©s publics...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Services unifi√©s goszakup.gov.kz - Version 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441438/"> Je travaille en tant que d√©veloppeur au sein de la soci√©t√© Center for Electronic Finance JSC. <br>  L'un de nos projets est le Portail des march√©s publics de la R√©publique du Kazakhstan - goszakup.gov.kz. <br><br>  Il y a un an, nous avons lanc√© un grand projet - Unified Services (OpenData). <br>  Pour la mise en ≈ìuvre, la m√©thodologie RestAPI a √©t√© utilis√©e. <br><br>  Aujourd'hui, je vais parler de la nouvelle version de nos services et de la nouvelle interface pour travailler avec eux. <br><br><img src="https://habrastorage.org/webt/pt/bj/mx/ptbjmxtr9jqrdj0suzdnoztmabu.png"><br><a name="habracut"></a><br>  Nous avons d√©velopp√© et lanc√© 6 services Open Data: <br><br><ul><li>  Registre des participants </li><li>  Registre des fournisseurs sans scrupules </li><li>  Registre des plans annuels </li><li>  Annonces d'√âtat.  approvisionnement </li><li>  Registre des lots </li><li>  Registre des contrats </li></ul><br>  De nombreuses entreprises au Kazakhstan se connectent et re√ßoivent d√©j√† des donn√©es sur ces services. <br>  Le lancement d'Open Data nous a permis de r√©duire la charge de la base de donn√©es d'environ 40% du fait que les entreprises n'ont pas besoin d'√©crire diff√©rents analyseurs pour collecter des donn√©es sur les march√©s publics.  Il suffit de passer par une qu√™te difficile :) <br><br><ol><li>  √©crire une demande de jeton d'acc√®s </li><li>  lire la documentation des services sur notre portail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">goszakup.gov.kz/ru/developer/ows</a> </li><li>  √©crire votre client RestAPI </li></ol><br><h4>  Services unifi√©s - une nouvelle approche </h4><br>  RestAPI permet d'obtenir des donn√©es plus facilement et plus rapidement que l'analyse d'un site, mais le RestAPI standard ne donne pas de flexibilit√© aux entreprises et pour √©tablir une connexion avec des objets, vous devez d'abord obtenir toutes les donn√©es et ensuite seulement cr√©er les liens entre eux. <br>  Pour recevoir des donn√©es sur une annonce, il est n√©cessaire par RestAPI de demander d'abord le registre des annonces, puis le registre des lots et enfin le registre des plans.  Cela signifie que pour recevoir une annonce, il est n√©cessaire de remplir au moins 3 demandes, et si vous avez besoin de recevoir des donn√©es sur 50 annonces, vous aurez besoin d'au moins 101 demandes √† RestAPI, √† condition que chaque annonce contienne 1 lot (1 pour recevoir 50 annonces, 50 pour recevoir des lots, 50 √† r√©ception des points du plan). <br><br>  Nous avons trouv√© un moyen de r√©duire ce montant √† une seule demande! <br><br>  Nous lan√ßons la 2e version des services unifi√©s - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ows.goszakup.gov.kz/v2</a> . <br>  En plus d'√©tendre les ensembles de donn√©es, nous √©largissons la capacit√© de travailler avec notre API. <br><br>  Maintenant, les donn√©es peuvent √™tre obtenues via RestAPI et la nouvelle interface - GraphQL. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ows.goszakup.gov.kz/v2/graphql</a> <br><br><img src="https://habrastorage.org/webt/jm/q-/tb/jmq-tbqg_fuph_g2mvshivb-gas.png"><br><br>  Je ne d√©crirai pas ce qu'est GraphQL, pour cela vous pouvez lire l'article d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">aliksend</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Qu'est-ce que GraphQL?</a> <br><br>  Je vais vous dire quels avantages nous avons obtenus apr√®s le d√©marrage de GraphQL: <br><br><ul><li>  Demander de la flexibilit√©; </li><li>  Obtenir des objets associ√©s; </li><li>  Dactylographie compl√®te des demandes et des r√©ponses; </li><li>  Nouvelle interface de recherche de donn√©es. </li></ul><br><h4>  Demander de la flexibilit√© </h4><br>  Avec une simple demande RestAPI, vous obtenez le format de donn√©es qui a √©t√© d√©fini √† l'avance. <br>  Lorsque vous interrogez GraphQL, vous obtenez les donn√©es au format dont vous avez besoin. <br><br>  Lorsque vous demandez des donn√©es, vous d√©terminez vous-m√™me le format des donn√©es dont vous avez besoin, par exemple l'ID et <br><br>  Num√©ro de contrat <br><br><pre><code class="javascript hljs">{ contract { id contract_number_sys } }</code> </pre> <br>  En r√©ponse, nous obtenons uniquement ces donn√©es: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"contract"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"contract_number_sys"</span></span>: <span class="hljs-string"><span class="hljs-string">"_"</span></span> } ] } }</code> </pre><br>  Eh bien, ces requ√™tes sont les plus faciles √† impl√©menter GraphQL.  Les entreprises ont la possibilit√© de choisir les donn√©es qu'elles souhaitent recevoir, alors que nous n'avons pas besoin de faire des ajustements comme si c'√©tait le cas avec RestAPI.  Vous obtenez uniquement l'ensemble des champs n√©cessaires. <br><br><img src="https://habrastorage.org/webt/95/cr/jw/95crjwjr7wikz8fhajv-lh6w9iq.gif"><br><br><h4>  R√©cup√©ration des objets associ√©s </h4><br>  Nous ne nous sommes pas content√©s de r√©p√©ter les fonctionnalit√©s de RestAPI simplement en permettant de s√©lectionner partiellement des donn√©es. <br><br>  Nous avons impl√©ment√© la 2√®me fonctionnalit√© de GraphQL - relations d'objets. <br><br>  Si vous recevez des donn√©es selon RestAPI, afin de recevoir des donn√©es sur le contrat et sur l'entreprise, le client dans le contrat devra d'abord obtenir des donn√©es du <b>registre des participants</b> , puis seulement recevoir des donn√©es du <b>registre des contrats</b> et √©tablir la connexion entre les objets eux-m√™mes. <br><br>  D√©sormais, lorsque vous travaillez avec GraphQL, vous n'avez pas besoin de recevoir enti√®rement les donn√©es du Registre des participants, il vous suffit de demander des donn√©es au format qui vous int√©resse: <br><br><pre> <code class="javascript hljs">{ contract { id contract_number_sys customer { name_ru } } }</code> </pre><br>  Ainsi, avec une seule demande, nous obtenons √† la fois les donn√©es du contrat et les donn√©es de l'entreprise pour le client: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"data"</span></span>: { <span class="hljs-string"><span class="hljs-string">"contract"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"contract_number_sys"</span></span>: <span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-string"><span class="hljs-string">"customer"</span></span> : { <span class="hljs-string"><span class="hljs-string">"name_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> } } ] } }</code> </pre><br><img src="https://habrastorage.org/webt/9t/q6/_i/9tq6_ixwkyzzqnplhf2gpdfjd2e.gif"><br><br>  Et de nombreuses relations de ce type ont √©t√© mises en place. D√©sormais, les entreprises qui re√ßoivent des donn√©es auront besoin de beaucoup moins de demandes pour recevoir des donn√©es.  Dans le m√™me temps, il n'est plus n√©cessaire de deviner exactement comment les objets sont li√©s les uns aux autres, pour recevoir des ensembles de donn√©es complets afin de les connecter les uns aux autres. <br><br>  J'ai essay√© de d√©montrer partiellement la structure de connexion que j'ai r√©ussi √† atteindre. <br><br><img src="https://habrastorage.org/webt/iv/db/sw/ivdbsw9gyxmh7cugosffdj6wcjy.png"><br><br><h4>  Saisir des demandes et des r√©ponses </h4><br>  De nombreux partisans des demandes SOAP ont toujours mis le plus important - le typage des donn√©es. <br>  RestAPI, contrairement √† SOAP, n'a pas de description de sa structure et vous ne savez pas √† l'avance quel type de donn√©es.  Mais GraphQL change tout. <br><br>  Vous pouvez maintenant demander des donn√©es √† GraphQL tout au long du sch√©ma de donn√©es et vous recevrez: <br><br><ul><li>  Description compl√®te de la structure des donn√©es; </li><li>  Description du champ qui a un type de donn√©es (Int, String, Boolean); </li><li>  Description des objets imbriqu√©s et structure des champs des objets imbriqu√©s; </li><li>  Description d√©taill√©e, par exemple, en russe pour chaque domaine; </li><li>  Recevez une notification indiquant qu'un champ a re√ßu l'indicateur Obsol√®te avec une description. </li></ul><br>  J'utilise le programme Insomnia REST Client - insomnia.rest pour travailler avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GraphQL</a> <br>  Lorsque vous travaillez avec GraphQL, il re√ßoit la structure enti√®re des objets et des invites lors de la construction d'une requ√™te. <br><br>  Je vais donner quelques captures d'√©cran √† titre d'exemple. <br><br>  1. Aide √† la cr√©ation de requ√™tes depuis  le programme a re√ßu une structure compl√®te d'objets <br><br><img src="https://habrastorage.org/webt/xl/jj/fb/xljjfbpgh2j1xata_orj0aurhqi.png"><br><br>  2. Astuce pour la description de chaque champ avec son type de donn√©es et sa description <br><br><img src="https://habrastorage.org/webt/6v/ep/93/6vep93hfz0ynsplgm9_kraaktky.png"><br><br>  3. Indication si un champ a re√ßu un indicateur - Obsol√®te <br><br><img src="https://habrastorage.org/webt/vg/rx/lt/vgrxlti7nowou4kqq1gsr6ov138.png"><br><br>  Et cette fonctionnalit√© de GraphQL vous permet d'avoir une image compl√®te des champs et objets avec lesquels vous travaillez. <br><br><img src="https://habrastorage.org/webt/4f/lg/ux/4flguxg9ruc1mgbvyif7ffcwr9e.gif"><br><br><h4>  Nouvelle interface de r√©cup√©ration de donn√©es </h4><br>  Et j'ai laiss√© le plus int√©ressant au final. <br><br>  Tout semble cool, il est possible de construire sa propre structure de donn√©es, il y a une connexion avec d'autres objets, toutes les donn√©es sont tap√©es.  Mais il manque encore quelque chose ... <br><br>  Il n'y a pas assez de possibilit√© de rechercher sur ces donn√©es. <br><br>  D√®s le d√©but, un format de recherche a √©t√© impl√©ment√© avec les param√®tres dans la requ√™te elle-m√™me: <br><br><pre> <code class="javascript hljs">{ trd_buy(ref_buy_status_id: <span class="hljs-number"><span class="hljs-number">1</span></span>) { name_kz name_ru } }</code> </pre><br>  Mais ici, j'ai rencontr√© un certain nombre de probl√®mes: <br><br><ol><li>  avec un grand nombre de crit√®res de recherche, la requ√™te devient tout simplement illisible; </li><li>  il est impossible de d√©terminer le tableau lors de la recherche de donn√©es pour rechercher plusieurs variantes du m√™me champ. </li></ol><br>  Pour simplifier la construction des requ√™tes et √©tendre la capacit√© de recherche, j'ai impl√©ment√© des objets imbriqu√©s pour filtrer les donn√©es. <br><br>  Nous d√©finissons une variable dans la requ√™te indiquant l'objet filtrant. <br><br><pre> <code class="javascript hljs">query($filter: TrdBuyFiltersInput){ trd_buy(filters: $filter) { name_kz name_ru } }</code> </pre><br>  Nous d√©crivons les param√®tres de recherche de donn√©es eux-m√™mes: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"filter"</span></span>: { <span class="hljs-string"><span class="hljs-string">"ref_buy_status_id"</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>] } }</code> </pre><br>  Et par cons√©quent, nous recevrons toutes les annonces ayant les statuts 1 et 2. <br><br>  Dans la demande elle-m√™me, nous n'indiquons que la structure des donn√©es, et tous les param√®tres de recherche entrent dans la transmission des param√®tres o√π nous pouvons d√©j√† transf√©rer des tableaux de donn√©es pour le filtrage selon plusieurs crit√®res. <br><br><img src="https://habrastorage.org/webt/cl/gl/di/clgldijd6pe0y7evhlw0k37eawg.gif"><br><br>  De plus, dans le sch√©ma GraphQL lui-m√™me, nous avons √©galement tous une description d'un tel objet de recherche: <br><br><img src="https://habrastorage.org/webt/t5/ns/i1/t5nsi1rf4yy4ubvk3cxakvmqmci.png"><br><br><h4>  Services unifi√©s - Version 2.0: </h4><br>  Les services fonctionnent: <br><br><ul><li>  Registre des participants </li><li>  Registre des annonces </li><li>  Registre des contrats </li><li>  Registre des actes </li><li>  Registre des lots </li><li>  Registre des plans annuels </li><li>  Registre des fournisseurs sans scrupules </li></ul><br>  Nous avons lanc√© une nouvelle fonctionnalit√© qui simplifie consid√©rablement le travail avec notre API, a une structure de requ√™te flexible et la possibilit√© de rechercher des donn√©es selon des crit√®res sp√©cifi√©s. <br><br>  Nous n'avons pas perdu dans la vitesse d'obtention des donn√©es, mais ne faisons que r√©duire de ce fait le nombre de demandes n√©cessaires pour obtenir les donn√©es. <br><br>  Nous avons pu avertir dans le sch√©ma de donn√©es les champs d√©sactiv√©s ou renomm√©s. <br><br>  Nous pr√©voyons de d√©velopper davantage l'API et de permettre √©galement la recherche morphologique des donn√©es sur les services. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr441438/">https://habr.com/ru/post/fr441438/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr441424/index.html">Comment vous prot√©ger des trolls de marque</a></li>
<li><a href="../fr441426/index.html">Le plus haut responsable d'Apple a √©t√© accus√© de d√©lit d'initi√©. Il devait la combattre</a></li>
<li><a href="../fr441428/index.html">Principes de base de PowerShell: d√©finition de la fin d'une ligne avec un caract√®re sp√©cifique</a></li>
<li><a href="../fr441430/index.html">La premi√®re fois que nous essayons App Center et racontons notre exp√©rience</a></li>
<li><a href="../fr441436/index.html">Les scientifiques ont d√©velopp√© des cellules souches universelles en utilisant l'ing√©nierie CRISPR</a></li>
<li><a href="../fr441442/index.html">YouTube a d√©sactiv√© les publicit√©s anti-vaccin</a></li>
<li><a href="../fr441444/index.html">Sur les doigts: les types associ√©s dans Rust et quelle est leur diff√©rence avec les arguments de type</a></li>
<li><a href="../fr441446/index.html">Apprendre √† l'ordinateur: comment acqu√©rir une nouvelle comp√©tence</a></li>
<li><a href="../fr441448/index.html">Pan impossible et autres victoires de tuiles Penrose</a></li>
<li><a href="../fr441450/index.html">Pentesting Azure - R√©flexions sur la s√©curit√© dans le cloud computing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>