<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>↗️ 🛸 🎂 Tombol Ajaib untuk LED pada ATtiny4 👏🏽 🙏🏻 👲🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SESAM 


 Saya pernah memiliki waktu yang lama lalu saklar ajaib sensitif sentuhan SESAM . Saya sangat menyukainya. Tetapi waktu terus berubah, tidak ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tombol Ajaib untuk LED pada ATtiny4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/411263/"><h4 id="sezam">  SESAM </h4><br><p> Saya pernah memiliki waktu yang lama lalu saklar ajaib sensitif sentuhan <em>SESAM</em> .  Saya sangat menyukainya.  Tetapi waktu terus berubah, tidak lagi cocok dengan interior, dan kemudian benar-benar tidak dirancang untuk bekerja dengan semua jenis lampu hemat energi yang modis.  Saya menyukai prinsip manajemen di dalamnya.  Sentuhan singkat sensor menyalakan / mematikan lampu, dan yang panjang menyesuaikan kecerahan.  Siapa yang <em>peduli</em> - pemutus sirkuit adalah <em>K145AP2</em> , analog dari <em>Siemens S576B</em> (K145AP2 masih dijual). </p><br><p>  Di bawah cut, versi saya meniru operasi chip ini. </p><a name="habracut"></a><br><p>  Belum lama ini, saya membuat lampu strip LED di profil aluminium dengan diffuser di atas meja untuk saya sendiri dan muncul pertanyaan tentang sakelar.  Menempatkan siap entah bagaimana merepotkan.  Sehingga menggantung di kawat - itu tidak indah, untuk meletakkan saklar biasa - merusak pemandangan, dan benar-benar tidak ada tempat untuk pergi. </p><br><p>  Saya memutuskan untuk membangun sebuah saklar, dan untuk satu dan redup, di ujung chipboard 16mm.  Menyentuhnya, tutup dengan stiker, yang dibaut oleh pembuat mebel. </p><br><h4 id="zhelezo">  Besi </h4><br><p>  Dimulai dengan sensor.  Saya mencoba prinsip transfer biaya ke <em>ATtiny13A</em> .  Opsi ini berfungsi, tetapi saya terlalu malas untuk repot dengan parameter penyetelan otomatis, dll.  Dia juga tidak mengambil yang sudah jadi. </p><br><p>  Kemudian saya memutuskan untuk mencoba menerapkan sensor pada perpustakaan <em>QTouch</em> .  Sebagai sensor <em>ATtiny10</em> .  Ada utilitas siap pakai yang mengubah <em>ATtiny10</em> menjadi tombol sentuh dengan semua <em>barangnya</em> .  Tetapi pada output, biner sulit untuk menambahkan kode Anda di sana.  Saya berpikir tentang apa yang harus dilakukan, menjelajahi Internet dan kemudian saya <em>menemukan</em> penyebutan <em>TTP223</em> - pengontrol satu tombol sentuh.  Opsi ini sangat cocok untuk saya. </p><br><p>  Sebagai MK, pilihan jatuh pada <em>ATtiny4</em> .  <em>Sekecil TTP223</em> , timer 16-bit.  Ya, dan untuk waktu yang lama saya ingin melakukan sesuatu yang berguna pada tinki ini. </p><br><p>  Sebagai kunci - <em>P3055LD</em> dari motherboard lama. </p><br><h4 id="pechatnaya-plata">  Papan sirkuit </h4><br><p>  Ketika mengembangkan papan sirkuit tercetak, saya melanjutkan dari kenyataan bahwa lubang di ujung chipboard membutuhkan seminimal mungkin, saya memutuskan bahwa diameter 7 mm akan cukup.  Papan ternyata 7x28mm, dua lapisan. </p><br><p>  Kemudian, ketika papan disolder, menjadi jelas bahwa papan tidak akan masuk ke dalam lubang 7mm, setidaknya 9mm - itu tidak memperhitungkan ketinggian elemen.  Gagasan dengan stiker entah bagaimana juga tidak lagi suka.  Dan kemudian sebuah rintisan furnitur menarik perhatian saya!  Dirancang untuk lubang 10mm, dan diameter dalam persis 7mm!  Semuanya bertepatan! </p><br><p>  Sensor menempelkan dirinya pada syal terpisah yang disolder ke ujung utama.  Dalam gambar Anda bisa melihat. </p><br><div class="spoiler">  <b class="spoiler_title">Gambar</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/geektimes/post_images/c90/811/124/c908111247ab756b2667c342f63910ef.jpg" alt="gambar keren"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/8e7/bb2/c17/8e7bb2c177c2f1f1940cc7a9edf1d7c6.jpg" alt="gambar keren"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/626/916/1bb/6269161bb3a78aa01bd7f6b77119af5d.jpg" alt="gambar keren"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e14/976/8f0/e149768f0a162a2598003f83d5741e4a.jpg" alt="gambar keren"></p></div></div><br><h4 id="programma">  Programnya </h4><br><p>  Program kontrol ditulis dalam assembler.  Setiap 32ms (Pengawas Waktu) sensor disurvei.  Bergantung pada kondisi saat ini dan durasi penekanan, tindakan tertentu dilakukan.  Logika kerja sedikit berbeda dari prototipe <em>K145AP2</em> </p><br><p>  Jika lampu mati (keadaan setelah dihidupkan): </p><br><ul><li>  Pers singkat menyalakan lampu pada tingkat yang sama dengan saat dimatikan.  Saat dihidupkan untuk pertama kalinya pada kecerahan maksimum </li><li>  Tekan lama menyalakan lampu pada tingkat maksimum. </li></ul><br><p>  Jika lampu menyala: </p><br><ul><li>  Tekan sebentar mematikan lampu </li><li>  Pers yang lama mengubah kecerahan.  Arah perubahan kecerahan berubah dengan tekan lama berulang </li></ul><br><p>  Tekanan terlalu pendek (gangguan) oleh program diabaikan.  Kecerahan diatur oleh koefisien PWM (16 bit).  Frekuensi PWM sekitar 122 Hz (8.000.000 Hz / 2 <sup>16</sup> ≈ 122 Hz) </p><br><p>  <strong>Untuk mengimbangi persepsi psikofisiologis dari kecerahan pencahayaan dari kecerahan yang sebenarnya, perubahan yang terakhir terjadi di sepanjang bagian parabola kubik</strong> .  Biasanya tabel digunakan untuk ini, tetapi dalam versi saya koefisien dihitung.  Koefisien bervariasi dengan frekuensi PWM, yaitu, ketika kecerahan berubah, setiap pulsa diperoleh dengan durasinya sendiri.  Nilai PWM minimum terbatas pada perangkat lunak. </p><br><p>  Sebagian besar waktu MK tidur dan mengkonsumsi sekitar 16 microamps bersama dengan <em>TTP223</em> .  Artinya, rangkaian ini cukup cocok untuk perangkat dengan kekuatan otonom. </p><br><p>  <em>ATtiny4 memiliki</em> enam pin.  Dua untuk daya, satu default untuk reset.  Saya sudah melibatkan dua.  Hanya satu yang tersisa.  Saya pikir bagaimana menggunakannya.  Dan kemudian saya teringat laptop teman baru dengan trackpad Force Touch.  Sebagai percobaan, saya memutuskan untuk melakukan hal serupa.  Saya tidak memerlukan banyak keandalan respon, dan ada banyak vibromotors dari ponsel lama.  Akibatnya, saya menerapkan fungsi seperti itu dalam program sehingga impuls pendek muncul pada output gratis, ketika batas penyesuaian tercapai.  Dalam <em>K145AP2,</em> ketika batas penyesuaian tercapai, arah penyesuaian berubah.  Oleh karena itu, beberapa keterampilan diperlukan untuk melepaskan tangan dari sensor secara maksimal atau minimum.  Dalam implementasi saya, ketika perbatasan tercapai, penyesuaian berhenti.  Total waktu penyesuaian dari satu batas ke batas yang lain adalah sekitar 4 detik. </p><br><p>  Kode Tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" title="Dorong!">GitHub</a> </p><br><h4 id="tpi-cherez-arduinu">  TPI via Arduino </h4><br><p>  Secara terpisah, saya perhatikan pemrograman MK.  <em>JTAGICE3</em> saya tidak mendukung antarmuka pemrograman TPI.  Tapi, untungnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">orang-orang baik menulis sketsa tentang Arduin</a> untuk memprogram hal kecil ini.  Tidak segera, tetapi semuanya bekerja untuk saya, firmware dibanjiri dan semuanya berfungsi.  Selain arduins, 4 resistor diperlukan.  Seluruh proses dilukis dalam sketsa. </p><br><h4 id="itog">  Ringkasan </h4><br><p>  Tombol ajaib dipasang dan berfungsi sebagaimana mestinya.  Konsumsi dan dimensi saat ini memungkinkannya tertanam di perangkat dengan daya otonom. </p><br><p>  Saya tidak mendapatkan efek yang diharapkan dari getaran.  Di sini rupanya percobaan dengan situs instalasi diperlukan. </p><br><p>  Dalam prototipe <em>K145AP2</em> dan analog <em>Siemens S576B</em> ada kesimpulan "Tidur".  Ini adalah mode di mana kecerahan turun sangat lambat sampai benar-benar dimatikan.  Seperti yang direncanakan oleh pabrikan, untuk ini sensor tambahan dipasang di dekat kepala tempat tidur.  16 bit timer PWM mengaktifkan mode ini. </p><br><p>  Ini dari ide untuk masa depan. </p><br><div class="spoiler">  <b class="spoiler_title">Tombol di tempat</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/getpro/geektimes/post_images/757/2da/2b5/7572da2b50cf61fc18aef6e609b80650.jpg" alt="gambar keren"></p></div></div><br><p>  Suka semuanya. </p><br><p>  Terima kasih semuanya! </p><br><p>  UPD: Seperti yang dijanjikan, saya menaikkan frekuensi PWM ke hampir 1kHz.  Kode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" title="Dorong!">Github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id411263/">https://habr.com/ru/post/id411263/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id411253/index.html">Penggabungan bintang-bintang neutron mengakhiri alternatif materi gelap dan energi gelap</a></li>
<li><a href="../id411255/index.html">Aplikasi terdesentralisasi untuk jutaan pengguna di Ethereum</a></li>
<li><a href="../id411257/index.html">Di AS, mereka menciptakan sistem laser yang akan menakuti musuh dengan suara</a></li>
<li><a href="../id411259/index.html">Kami menghubungkan meteran air ke rumah pintar</a></li>
<li><a href="../id411261/index.html">Respons getaran pada prostesis: cara baru untuk meningkatkan kontrol anggota gerak bionik</a></li>
<li><a href="../id411265/index.html">Kasing Mata (Bagian 3)</a></li>
<li><a href="../id411267/index.html">Siapa yang benar-benar di belakang smartphone baru bermerek Nokia?</a></li>
<li><a href="../id411269/index.html">Tiga komponen "LOAD"</a></li>
<li><a href="../id411271/index.html">Mobil listrik Tesla Autopilot terjerat di ruas-ruas jalan yang sulit</a></li>
<li><a href="../id411273/index.html">Studi pertama tentang daya tarik robolits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>