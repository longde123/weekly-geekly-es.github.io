<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëäüèª üéÅ üß£ Aplikasi GUI lebih kecil dari 1 kb üôãüèΩ üë©üèº‚Äçüî¨ üñåÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Di waktu luang, saya bertanya pada diri saya kemungkinan membuat aplikasi dengan persyaratan berikut: 



- setidaknya beberapa fungsi aplikasi yang b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aplikasi GUI lebih kecil dari 1 kb</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416135/">  Di waktu luang, saya bertanya pada diri saya kemungkinan membuat aplikasi dengan persyaratan berikut: <br><br><ul><li>  setidaknya beberapa fungsi aplikasi yang berguna (yaitu, bukan tiruan) </li><li>  kehadiran antarmuka jendela </li><li>  ukuran kurang dari 1 Kb </li></ul><a name="habracut"></a><br>  Secara umum, standar aplikasi dengan ukuran hingga 1 Kb adalah 1k intro, yang merupakan jenis demoscene.  Paling sering, ini adalah inisialisasi OpenGL yang ditulis dalam assembler, diikuti dengan memberi makan shader, yang melakukan pekerjaan utama (menggambar beberapa fraktal berwarna).  Plus semua ini menuai oleh packer (misalnya crinkler). <br>  Aplikasi ini secara harfiah dijilat ke byte, pengembangannya membutuhkan waktu berminggu-minggu bahkan berbulan-bulan. <br><br>  Pendekatan ini terlalu keras, saya memutuskan untuk tidak melampaui pemrograman aplikasi yang biasa pada WinAPI. <br><br>  Pada saat ini, penjualan musim panas dimulai di Steam, di mana orang dewasa diundang untuk mengibas alien dengan bijaksana dengan mouse di browser (ya, Valve lagi membuat game, seperti yang dijanjikan Gabe). <br>  Ini menyinggung perasaan saya, dan saya memutuskan untuk mencoba menerapkan autoclicker paling sederhana dengan pengaturan minimal. <br><br>  Diperlukan untuk dapat dalam 1 KB: <br><br><ul><li>  pembuatan dan inisialisasi antarmuka </li><li>  fungsi jendela dengan penangan acara </li><li>  logika aplikasi utama (dibangun di atas fungsi GetAsyncKeyState dan SendInput) </li></ul><br>  Aplikasi ini akan dibuat dalam MSVC dalam C murni tanpa assembler dan SMS, dan kemudian dikompres dengan packer crinkler.  Perlu dicatat bahwa crinkler memampatkan data (terutama yang dijernihkan) jauh lebih efisien daripada kode (sekitar dua kali).  Karena itu, kami akan mencoba mentransfer fungsionalitas maksimal ke dalam data. <br><br>  Dimulai dengan CreateWindow klasik untuk setiap elemen jendela, saya menyadari bahwa saya tidak dapat masuk ke dalam ukuran yang diperlukan. <br><br>  Saya harus mencari alternatif.  Dan dia menjadi fungsi CreateDialogIndirect, menciptakan dialog dari struktur DLGTEMPLATE yang diisi (terdiri dari heap DLGITEMTEMPLATE) <br><br>  Untuk pembuatan dan pengisian struktur yang nyaman, saya memulai beberapa makro seperti ini: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NUMCHARS(p) (sizeof(p)/sizeof((p)[0])) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DLGCTL(a) struct{DWORD style; DWORD exStyle; short x; short y; short cx; short cy; WORD id; WORD sysClass; WORD idClass; WCHAR wszTitle[NUMCHARS(a)]; WORD cbCreationData;} #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> RADIO(x,y,cx,cy,id,title) {WS_VISIBLE|WS_CHILD|BS_RADIOBUTTON, 0, (x)/2, (y)/2,\n (cx)/2,(cy)/2, id, 0xFFFF, 0x0080, title, 0}</span></span></code> </pre> <br>  Sekarang Anda dapat mendeklarasikan dan mengisi struktur dengan elemen-elemen jendela masa depan: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> DWORD style; DWORD dwExtendedStyle; WORD ccontrols; <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> y; <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> cx; <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> cy; WORD menu; WORD windowClass; DLGCTL(LBL_BTN_LEFT) button_left; DLGCTL(LBL_BTN_MIDDLE) button_middle; DLGCTL(LBL_BTN_RIGHT) button_right; } Dlg = { WS_VISIBLE|WS_POPUP|WS_BORDER, <span class="hljs-number"><span class="hljs-number">0</span></span>, TOTAL_CONTROLS, <span class="hljs-number"><span class="hljs-number">50</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>/<span class="hljs-number"><span class="hljs-number">2</span></span>, WND_CX/<span class="hljs-number"><span class="hljs-number">2</span></span>, WND_CY/<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, RADIO(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, IDC_BTN_LEFT, LBL_BTN_LEFT), RADIO(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, IDC_BTN_MIDDLE, LBL_BTN_MIDDLE), RADIO(<span class="hljs-number"><span class="hljs-number">190</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">68</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, IDC_BTN_RIGHT, LBL_BTN_RIGHT), };</code> </pre> <br>  Kami memberi makan struktur fungsi CreateDialogIndirect, dan inilah jendela yang dihasilkan: <br><br><img src="https://habrastorage.org/webt/kv/9m/ku/kv9mkudchovqwxsd21kaivxc20k.png"><br><br>  Karena kami cocok dalam 1 kb, kami tidak memiliki manifes, seperti yang lainnya, dan karenanya tidak ada gaya visual juga.  Semuanya abu-abu dan persegi, seperti di masa muda. <br><br>  Tapi kami masih mengelak, menarik manifes dari shell32.dll dan menerapkan konteks berdasarkan itu ke aplikasi kami: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> ACTCTX actCtx = {<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(ACTCTX), ACTCTX_FLAG_RESOURCE_NAME_VALID|ACTCTX_FLAG_SET_PROCESS_DEFAULT|ACTCTX_FLAG_ASSEMBLY_DIRECTORY_VALID, <span class="hljs-string"><span class="hljs-string">"shell32.dll"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, tmp, (LPCTSTR)<span class="hljs-number"><span class="hljs-number">124</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}; GetSystemDirectory(tmp,<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(tmp)); LoadLibrary(<span class="hljs-string"><span class="hljs-string">"shell32.dll"</span></span>); ActivateActCtx(CreateActCtx(&amp;actCtx),(ULONG_PTR*)&amp;tmp);</code> </pre> <br>  Sudah bergaya, modis: <br><br><img src="https://habrastorage.org/webt/ro/ih/zt/roihztcwjhaesfzx4ykt9od2zlm.png"><br><br>  Kami berhasil mengecilkan fungsi jendela menjadi lebih ringkas: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(msg) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> WM_COMMAND: <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(LOWORD(wParam)) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_LEFT: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_MIDDLE: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_RIGHT: input[<span class="hljs-number"><span class="hljs-number">0</span></span>].mi.dwFlags = wParam; input[<span class="hljs-number"><span class="hljs-number">1</span></span>].mi.dwFlags = (wParam&lt;&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>); CheckRadioButton(hWnd,IDC_BTN_LEFT,IDC_BTN_MIDDLE,wParam); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_HOLD: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_TRIGGER: trigger_mode = (wParam==IDC_BTN_TRIGGER); CheckRadioButton(hWnd,IDC_BTN_HOLD,IDC_BTN_TRIGGER,wParam); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_EDIT_PERIOD: period = GetDlgItemInt(hWnd,IDC_EDIT_PERIOD,(BOOL*)&amp;tmp[<span class="hljs-number"><span class="hljs-number">0</span></span>],<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> IDC_BTN_EXIT: <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DefWindowProc(hWnd,msg,wParam,lParam);</code> </pre><br>  Dan kemudian saya berpikir bahwa akan lebih baik untuk menambahkan pemrosesan argumen baris perintah sehingga pengguna memiliki kesempatan untuk memulai dengan pengaturan yang diperlukan. <br><br>  Sebagai contoh: <br><br> <code>input.exe /L /T /P:20 /K:9 -      20 ,  /  Tab</code> <br> <br>  Pindahkan bagian dari fungsi di dalam data dan dapatkan sesuatu seperti: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arg_to_cmd[] = {IDC_BTN_HOLD, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, IDC_EDIT_KEY, IDC_BTN_LEFT, IDC_BTN_MIDDLE, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, IDC_EDIT_PERIOD, <span class="hljs-number"><span class="hljs-number">0</span></span>, IDC_BTN_RIGHT, <span class="hljs-number"><span class="hljs-number">0</span></span>, IDC_BTN_TRIGGER}; i = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>*)GetCommandLine(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(*i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*(i++)==<span class="hljs-string"><span class="hljs-string">'/'</span></span>)<span class="hljs-comment"><span class="hljs-comment">//looking for argument switch(*i) { case 'L': case 'M': case 'R': case 'H': case 'T': SendMessage(hWnd,WM_COMMAND,arg_to_cmd[*i-'H'],0);//send button command break; case 'P': case 'K': t = atoi(i+2); SetDlgItemInt(hWnd,arg_to_cmd[*i-'H'],t,0); if(*i=='P') period = t; else key = t; break; } }</span></span></code> </pre> <br>  Pawang keluar sangat kecil.  Secara alami, tidak ada pemeriksaan dan perlindungan terhadap input yang salah, hanya minimum yang diperlukan. <br><br>  Sekarang fungsi utama (saya taruh di aliran terpisah): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) { key_state = (GetAsyncKeyState(key)&gt;&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trigger_mode) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((key_state)&amp;&amp;(key_state!=prev_key_state)) active^= <span class="hljs-number"><span class="hljs-number">1</span></span>; prev_key_state = key_state; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> active = key_state; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (active) SendInput(<span class="hljs-number"><span class="hljs-number">2</span></span>,(LPINPUT)&amp;input,<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(INPUT)); Sleep(period); }</code> </pre> <br><br>  Kami menekan objek-file yang dihasilkan crinkler'om - outputnya adalah 973 byte. <br><br>  Dari jumlah tersebut, data menempati 163 byte (rasio kompresi 33,1%), kode - 517 byte (rasio kompresi 68,9%). <br><br>  Dimungkinkan untuk menyusut dan lebih kuat (50 byte lainnya), tetapi tujuannya telah tercapai.  Bahkan 51 byte cadangan tetap ada. <br><br>  Persyaratan awal sepanjang jalan ditambahkan: <br><br><ul><li>  memproses argumen baris perintah </li><li>  menampilkan jendela dengan gaya visual </li></ul><br>  Di beberapa tempat kode terlihat sangat bengkok.  Ini karena saya menulisnya dengan bengkok.  Dan di beberapa tempat ini memungkinkan untuk menghemat ruang. <br><br>  Tentunya Anda dapat menemukan beberapa cara untuk mengurangi ukuran aplikasi, tetapi tidak secara dramatis (saya pikir byte adalah 50). <br><br>  Hasil: <br><br>  <s>Sekarang Anda dapat memanggil alien dalam mode otomatis dengan kerusakan liar per detik.</s> <br><br>  Dimungkinkan untuk membuat aplikasi ultra-kompak dengan fungsi bermanfaat yang sebenarnya digunakan dan antarmuka jendela. <br><br>  Kebaruan: <br>  Nol  Saya mengumpulkan banyak teknik / perkembangan. <br><br>  Kemanfaatan: <br>  Tidak berguna, menyenangkan untuk. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kode sumber</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Biner</a> <br><br>  Kritik, harapan, saran, kekaguman, kemarahan yang diterima. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id416135/">https://habr.com/ru/post/id416135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id416125/index.html">Instalasi, pengaturan sistem dan kontrol untuk kamera</a></li>
<li><a href="../id416127/index.html">CUDA dan Remote GPU</a></li>
<li><a href="../id416129/index.html">Bagaimana AI belajar menghasilkan gambar kucing</a></li>
<li><a href="../id416131/index.html">Bagaimana menangani PD di Federasi Rusia dan tidak melanggar hukum</a></li>
<li><a href="../id416133/index.html">Pusat Data di Luar Negeri: Equinix LD8</a></li>
<li><a href="../id416137/index.html">Zabbix sebagai pemindai keamanan</a></li>
<li><a href="../id416139/index.html">Otentikasi kuat sebagai bagian dari strategi GDPR</a></li>
<li><a href="../id416143/index.html">Buku "Otopsi akan ditampilkan!" Analisis malware praktis ¬ª</a></li>
<li><a href="../id416147/index.html">Organisasi navigasi di iOS-aplikasi menggunakan Root Controller</a></li>
<li><a href="../id416149/index.html">Pertanyaan dan Jawaban Energi Terbarukan, Bagian 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>