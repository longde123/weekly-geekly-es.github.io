<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🍓 🐫 Réduction des tailles de bundle avec Webpack Analyzer et React Lazy / Suspense 🍮 🚖 🧖🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="À mesure que la complexité des applications client augmente, la taille de leurs bundles devient de plus en plus. Dans cette situation, les personnes s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Réduction des tailles de bundle avec Webpack Analyzer et React Lazy / Suspense</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/468225/">  À mesure que la complexité des applications client augmente, la taille de leurs bundles devient de plus en plus.  Dans cette situation, les personnes souffrent le plus, obligées, pour diverses raisons, d'utiliser des connexions Internet lentes.  De plus, chaque jour, cela ne fait qu'empirer. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/yp/wc/u-/ypwcu-trdbiswrdeltqb677yqxk.jpeg"></a> <br><br>  L'auteur de l'article, dont nous publions aujourd'hui la traduction, travaille sous Wix.  Il veut expliquer comment il a pu réduire la taille d'un paquet d'environ 80%, en utilisant Webpack Analyzer et React Lazy / Suspense. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">À quelle heure commence l'optimisation?</font> </h2><br>  Si vous venez de commencer à travailler sur votre nouvelle application Web, vous essayez probablement de vous concentrer sur sa création, pour ainsi dire, «décoller», en essayant de la faire fonctionner.  Vous ne prêtez probablement pas beaucoup d'attention aux performances ou à la taille du bundle.  Je peux comprendre ça.  Cependant, mon expérience suggère que les performances et la taille des bundles doivent être prises en compte dès le début.  Une bonne architecture d'application et une «réflexion sur l'avenir du projet» en temps opportun vous permettront de gagner du temps et de ne pas accumuler de dettes techniques importantes.  De toute évidence, il est difficile de «tout prévoir» à l'avance, mais vous devez vous efforcer de tout faire dès le premier jour de travail sur le projet. <br><br>  Voici quelques excellents outils qui, je pense, devraient être utilisés dès le départ.  Ces outils vous aideront à reconnaître les packages NPM «problématiques» avant même qu'ils n'occupent une place importante dans l'application. <br><br><h3>  <font color="#3AC1EF">UndBundlephobia</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bundlephobia</a> est un site qui vous permet de savoir dans quelle mesure un certain package NPM augmentera la taille d'un bundle.  Il s'agit d'un excellent outil pour aider le programmeur à prendre les bonnes décisions concernant le choix des packages tiers dont il peut avoir besoin.  Bundlephobia aide à concevoir l'architecture de l'application afin que sa taille ne se révèle pas trop grande.  La figure suivante montre les résultats de la vérification d'une bibliothèque populaire pour travailler avec le temps, appelé moment.  Vous pouvez voir que cette bibliothèque est assez grande - près de 66 Ko sous forme compressée.  Pour de nombreux utilisateurs travaillant sur Internet haut débit, ce n'est rien.  Cependant, il convient de prêter attention à la durée de téléchargement de ce package dans les réseaux 2G / 3G.  Elle est respectivement de 2,2 et 1,32 seconde.  Et, faites attention, nous ne parlons que de ce seul paquet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c1/298/eed/1c1298eed8992918c5314e651ea04032.png"></div><br>  <i><font color="#999999">Résultats de l'analyse du paquet de moment Bundlephobia</font></i> <br><br><h3>  <font color="#3AC1EF">▍ Coût d'importation</font> </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Import Cost</a> est une extension très intéressante pour de nombreux éditeurs de code populaires (il compte plus d'un million de téléchargements pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VS Code</a> ).  Il peut montrer le "coût" des colis importés.  Je l'aime particulièrement car cela aide à identifier les zones problématiques de l'application tout en y travaillant.  La figure suivante (tirée de la page Import Cost GitHub) montre un excellent exemple de l'impact sur les dimensions du projet d'une approche différente de l'importation d'entités.  Ainsi, l'importation de la seule propriété <code>uniqueId</code> partir de Lodash entraîne l'importation de la bibliothèque entière dans le projet (70 Ko).  Et si vous importez directement la fonction <code>uniqueId</code> , alors seulement 2 Ko seront ajoutés à la taille du projet.  En savoir plus sur le coût d'importation <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8d1/488/bbb/8d1488bbb04afc1739a0a94967f74c2b.gif"></div><br>  <i><font color="#999999">Le "coût" de l'importation de la bibliothèque Lodash entière dans le projet et d'une seule fonction spécifique de cette bibliothèque</font></i> <br><br><h2>  <font color="#3AC1EF">Le cas des paquets déraisonnablement grands</font> </h2><br>  Ainsi, vous avez créé votre merveilleuse application.  Il fonctionne très bien sur votre Internet haut débit et sur votre ordinateur le plus puissant, plein de RAM.  Vous l'avez sorti dans le monde réel.  Après un certain temps, des plaintes ont commencé à émaner de vous ou de vos propres analystes.  Ces plaintes concernaient les temps de chargement des applications.  Quelque chose de similaire m'est arrivé récemment lorsque nous, chez Wix, avons dévoilé une nouvelle fonctionnalité sur laquelle je travaillais. <br><br>  Afin de vous mettre un peu au courant, parlons de cette nouvelle opportunité.  Il s'agit d'une nouvelle barre de progression située en haut du panneau latéral de l'interface des paramètres du site utilisateur.  Le but de ce mécanisme est d'attirer l'attention de l'utilisateur sur les différentes étapes qu'il doit effectuer pour que son projet d'entreprise ait de meilleures chances de réussite (connexion SEO, ajout de régions dans lesquelles les marchandises sont livrées, ajout du premier produit , etc.). <br><br>  La barre de progression est mise à jour automatiquement en se connectant au serveur à l'aide de sockets Web.  Lorsque l'utilisateur a terminé toutes les étapes recommandées, une fenêtre contextuelle s'affiche avec des félicitations.  Une fois cette fenêtre fermée, la barre de progression est masquée et ne s'affiche plus jamais lorsque vous travaillez avec le site dans lequel vous l'avez utilisé.  C'est ce dont nous venons de parler. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2eb/b42/282/2ebb4228298df39e9b83358aaa7ebaac.gif"></div><br>  <i><font color="#999999">Barre de progression et fenêtre de félicitations</font></i> <br><br>  Que s'est-il passé?  Pourquoi nos analystes se plaignent-ils que le temps de chargement des pages a augmenté?  Lorsque j'ai examiné la situation à l'aide de l'onglet Réseau des outils de développement Chrome, il est immédiatement devenu clair pour moi que mon ensemble était assez gros.  A savoir, sa taille était de 190 Kb. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f13/0ce/631/f130ce631ea4399322aa95583c7b2fa5.png"></div><br>  <i><font color="#999999">Taille de l'ensemble trouvée à l'aide des outils de développement Chrome</font></i> <br><br>  "Pourquoi cette petite chose a-t-elle besoin d'un paquet relativement grand?" J'ai alors pensé.  Mais la vérité - pourquoi? <br><br><h3>  <font color="#3AC1EF">▍Rechercher les points problématiques dans le bundle</font> </h3><br>  Après avoir réalisé que la taille du paquet est trop grande, il est temps de découvrir la raison de cela.  C'est là que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Webpack Bundle Analyzer a</a> été utile - un excellent outil pour identifier les zones problématiques des bundles.  Il ouvre un nouvel onglet de navigateur et affiche des informations de dépendance. <br><br>  C'est ce qui s'est passé après avoir analysé le bundle avec cet outil. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f17/465/f5f/f17465f5f21c29bbbb57f37373b0c92e.png"></div><br>  <i><font color="#999999">Résultats de Webpack Bundle Analyzer</font></i> <br><br>  Avec l'aide de l'analyseur, j'ai pu détecter le "criminel".  Le package lottie-web a été utilisé ici, ce qui a ajouté 61,45 Ko à la taille du bundle.  Lottie est une très belle bibliothèque JavaScript qui permet d'utiliser des outils de navigation standard pour produire des animations créées dans Adobe After Effect.  Dans mon cas, c'était pour que notre designer ait besoin d'une belle animation, qui a été réalisée lorsque la fenêtre de félicitations est apparue.  Il a créé cette animation et me l'a donnée sous la forme d'un fichier JSON, que j'ai transféré dans le package Lottie et obtenu une belle animation.  En plus du package lottie-web, j'avais également un fichier JSON avec des descriptions d'animation.  La taille de ce fichier était de 26 Kb.  En conséquence, la bibliothèque Lottie, le fichier JSON, ainsi que certaines petites dépendances auxiliaires me "coûtent" environ 94 Ko.  Et ce n'est qu'une animation de la fenêtre avec des félicitations à l'utilisateur.  L'utilisateur, quand il a vu ces félicitations, aurait dû être content.  Tout cela m'a rendu triste. <br><br><h2>  <font color="#3AC1EF">La technologie React Lazy / Suspense vient à la rescousse</font> </h2><br>  Après avoir découvert la cause du problème, il est temps de résoudre ce problème.  Il était clair qu'il n'était pas nécessaire de charger au tout début du travail tout ce qui était nécessaire pour l'animation.  En fait, il y avait une chance considérable qu'au cours de la session en cours de l'utilisateur, il n'ait pas à afficher une fenêtre de félicitations.  Ensuite, je me suis familiarisé avec les technologies React Lazy / Suspense récemment apparues et j'ai pensé que maintenant j'avais probablement une bonne occasion de les tester. <br><br>  Si vous n'êtes pas familier avec le concept de composants "paresseux" (paresseux), sachez que leur signification est de diviser l'application en petits morceaux de code.  Le téléchargement de ces fragments n'est effectué que lorsqu'ils sont nécessaires.  Dans mon cas, cela s'est exprimé dans le fait que je devais sélectionner dans la fonction principale de la barre de progression le composant qui était responsable de montrer les félicitations.  Il était nécessaire de charger ce composant uniquement lorsque l'utilisateur a terminé la séquence d'étapes recommandée. <br><br>  React 16.6.0 (et les versions plus récentes) possède une API simple conçue pour rendre les composants paresseux.  Ce sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">React.lazy et React.Suspense</a> .  Prenons un exemple: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> OtherComponent = React.lazy(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./OtherComponent'</span></span>)); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fallback</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Loading...</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">}&gt;        </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">OtherComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">      </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">React.Suspense</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  ); }</span></span></code> </pre> <br>  Nous avons un composant qui affiche l'élément <code>&lt;div&gt;</code> , et il <code>OtherComponent</code> un composant <code>Suspense</code> qui enveloppe le composant <code>OtherComponent</code> .  Si vous regardez la première ligne de cet exemple, vous pouvez voir que <code>OtherComponent</code> pas importé directement dans le code.  En règle générale, une importation comme celle-ci ressemble à l' <code>import OtherComponent from './OtherComponent';</code>  . <br><br>  Au lieu de cela, la commande d'importation est encadrée comme une fonction qui prend un chemin de fichier.  Ce mécanisme fonctionne car Webpack dispose d'outils de séparation de code intégrés.  Lorsqu'une construction similaire est présente dans le code, une promesse est retournée, qui, après avoir téléchargé le fichier, est résolue avec le contenu de ce fichier.  Notre équipe d'importation est enveloppée dans une fonction <code>React.lazy</code> . <br><br>  Dans les matériaux de rendu renvoyés par <code>MyComponent</code> , <code>OtherComponent</code> dans un composant <code>React.Suspense</code> qui a une propriété de <code>fallback</code> .  Dans notre cas, il s'avère que lorsque le rendu atteint <code>OtherComponent</code> , le chargement du composant correspondant commence.  En attendant, ce qui est écrit dans la propriété de <code>fallback</code> est rendu.  Dans cet exemple, il s'agit du texte <code>Loading…</code>  En fait, c'est tout.  Ces mécanismes font tout simplement leur travail. <br><br>  Il est vrai que vous devez prendre en compte quelques fonctionnalités lorsque vous travaillez avec Lazy / Suspense. <br><br><ol><li>  Un composant importé de manière "paresseuse" doit contenir l'exportation par défaut, qui sera le point d'entrée du composant.  Les exportations nommées ne peuvent pas être utilisées ici. </li><li>  Vous devez <code>React.lazy</code> le composant importé à l'aide de la fonction <code>React.lazy</code> dans le composant <code>React.Suspense</code> .  Le composant <code>React.Suspense</code> fournir la propriété de <code>fallback</code> .  Sinon, une erreur se produira.  Cependant, si vous ne voulez tout simplement pas rendre quoi que ce soit tant que le composant n'a pas terminé le chargement paresseux, vous pouvez simplement écrire <code>null</code> en <code>fallback</code> sans essayer de contourner la nécessité d'écrire quelque chose dans cette propriété de manière délicate. </li></ol><br><h2>  <font color="#3AC1EF">L'utilisation de React Lazy / Suspense m'a-t-elle aidé?</font> </h2><br>  Oui, ça a aidé!  Le fractionnement de code a fonctionné de manière incroyable.  Jetons un coup d'œil aux résultats de l'analyse du nouveau bundle à l'aide de Webpack. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21e/502/fff/21e502fffa9544e33a750a8d23c33ede.png"></div><br>  <i><font color="#999999">Résultats de Webpack Bundle Analyzer après la division du code</font></i> <br><br>  Comme vous pouvez le voir, la taille de mon bundle a diminué d'environ 50% - à 96 Ko.  Super! <br><br>  Alors quoi, maintenant le problème est résolu?  Non, malheureusement.  Quand j'ai regardé la page, il s'est avéré que la fenêtre contextuelle avec félicitations a perdu son positionnement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3b9/4a0/25d/3b94a025d8577c55a2d973928acf7c5f.png"></div><br>  <i><font color="#999999">La fenêtre de félicitations n'apparaît pas là où vous en avez besoin</font></i> <br><br>  Le problème était que j'ai «demandé» à la fenêtre de s'ouvrir en changeant l'état du composant React.  Pendant ce temps, j'ai déjà rendu <code>null</code> (c'est-à-dire que je n'ai rien rendu) en utilisant le composant <code>React.Suspense</code> .  Après le chargement paresseux des données nécessaires, les documents pertinents ont été ajoutés au DOM.  Cependant, le positionnement du popup a déjà été fait.  Par conséquent, du fait que les propriétés du composant correspondant n'ont pas changé, ce composant «ne savait pas» qu'il devait résoudre le problème de positionnement.  Si je modifiais la taille de la fenêtre du navigateur, la fenêtre contextuelle apparaissait au bon endroit car le composant correspondant observait les changements de propriétés et les événements de redimensionnement de la fenêtre, initiant, si nécessaire, un repositionnement. <br><br>  Comment résoudre ce problème?  La solution était d'éliminer «l'intermédiaire». <br><br>  J'ai dû d'abord charger le composant "paresseux", et ensuite seulement écrire à l'état qui dirait à la fenêtre avec des félicitations qu'elle doit s'ouvrir.  J'ai pu le faire en utilisant les mêmes mécanismes de partage de code Webpack, mais maintenant - sans implémenter les importations en utilisant <code>React.lazy</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> loadAndSetHappyMoment() {  <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> component = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(    <span class="hljs-string"><span class="hljs-string">'../SidebarHappyMoment/SidebarHappyMoment.component'</span></span>  );  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.SidebarHappyMoment = component.SidebarHappyMoment;  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({    <span class="hljs-attr"><span class="hljs-attr">tooltipLevel</span></span>: TooltipLevel.happyMoment,  }); }</code> </pre> <br>  Cette fonction est appelée après que mon composant, via le mécanisme des sockets Web, soit informé qu'il doit afficher une fenêtre avec félicitations.  J'ai utilisé la fonction d' <code>import</code> Webpack (deuxième ligne de code).  Si vous vous souvenez, j'ai dit ci-dessus que cette fonction renvoie une promesse, en conséquence j'ai pu utiliser la construction <code>async/await</code> . <br><br>  Une fois le chargement du composant terminé, je l'écris dans l'instance de mon composant (avec la commande <code>this.SidebarHappyMoment = component.SidebarHappyMoment;</code> ).  Cela me donne l'opportunité de l'utiliser plus tard lors du rendu.  Veuillez noter que je peux maintenant utiliser des exportations nommées.  Dans mon cas, j'ai utilisé, dans la ligne ci-dessus, le nom <code>SidebarHappyMoment</code> .  Et enfin, et ce n'est pas moins important que tout le reste, j'informe la fenêtre qu'elle doit s'ouvrir, en changeant son état en conséquence une fois que je sais que le composant est prêt à fonctionner. <br><br>  Par conséquent, le code de rendu ressemble maintenant à ceci: <br><br><pre> <code class="javascript hljs">renderTooltip() {  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.tooltipLevel === TooltipLevel.happyMoment) {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">this.SidebarHappyMoment</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">;  }  // ... }</span></span></code> </pre> <br>  Notez que la commande <code>return &lt;this.SidebarHappyMoment /&gt;;</code>  renvoie <code>this.SidebarHappyMoment</code> - ce que j'ai écrit précédemment à l'instance de mon composant.  Il s'agit maintenant d'une fonction de rendu synchrone normale, identique à celles que vous avez utilisées un million de fois.  Et maintenant, la fenêtre de félicitations s'affiche exactement à l'endroit où elle doit être affichée.  Et le fait est qu'il ne s'ouvre que lorsque son contenu est prêt à l'emploi. <br><br><h2>  <font color="#3AC1EF">Le produit définit l'architecture</font> </h2><br>  Si l'idée dans le titre de cette section a soulevé un point d'interrogation important dans votre imagination, sachez que c'est le cas.  Le produit définit l'architecture. <br><br>  Il s'agit du fait que le produit définit ce qui doit être visible et interactif lors du premier rendu du composant.  Cela aide le développeur à comprendre exactement ce qu'il peut séparer du code principal et charger plus tard, si nécessaire.  J'ai réfléchi à la situation et je me suis souvenu qu'après que l'utilisateur a terminé les étapes recommandées pour configurer le site, ou s'il n'est pas l'administrateur du site, je n'ai pas besoin de lui montrer la barre de progression et le contenu connecté.  Maintenant, en utilisant ces informations, j'ai pu continuer à partager le bundle.  Voilà ce que j'ai. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36f/5f2/eb9/36f5f2eb91ead3a7188f5d5162d75b3e.png"></div><br>  <i><font color="#999999">La séparation continue du paquet</font></i> <br><br>  Après cela, la taille du paquet n'était plus que de 38 Ko.  Et je vous rappelle que nous avons commencé avec 190 Ko.  Il y a une réduction de 80% de la taille du paquet.  Et en passant, je vois déjà d'autres possibilités de séparation de code.  J'ai hâte de continuer à optimiser le bundle. <br><br><h2>  <font color="#3AC1EF">Résumé</font> </h2><br>  Les développeurs ont la possibilité de s'efforcer de rester dans leur «zone de confort» et de ne pas se plonger dans autre chose que l'appareil du code lui-même et sa fonctionnalité.  Cependant, un programmeur qui utilise les outils décrits ci-dessus, réfléchit de manière créative et travaille en étroite collaboration avec d'autres spécialistes, peut être en mesure d'améliorer les performances de son application en réduisant considérablement la taille du bundle contenant ce qui est nécessaire pour commencer à travailler avec cette application. <br><br>  <b>Chers lecteurs!</b>  Utilisez-vous le fractionnement de code pour accélérer le chargement de vos applications Web? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/it/t5/3p/itt53pns2iucwylb3bwn1fmmtnu.png"></a> </div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468225/">https://habr.com/ru/post/fr468225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468211/index.html">«Je voulais juste faire une blague, mais personne n'a compris» ou comment ne pas m'enterrer lors de la présentation du projet</a></li>
<li><a href="../fr468213/index.html">tinc-boot - réseau maillé sans douleur</a></li>
<li><a href="../fr468217/index.html">Dr. Jekyll et M. Hyde Culture d'entreprise</a></li>
<li><a href="../fr468219/index.html">Mécanismes d'extensibilité extensible en JavaScript</a></li>
<li><a href="../fr468223/index.html">Habr Weekly # 19 / BT-porte pour le chat, pourquoi l'IA triche, que demander au futur employeur, une journée avec iPhone 11 Pro</a></li>
<li><a href="../fr468227/index.html">Accélération instagram.com. partie 1</a></li>
<li><a href="../fr468229/index.html">Une note sur void en JavaScript et TypeScript</a></li>
<li><a href="../fr468231/index.html">La sécurité dans AEM est-elle un problème de plate-forme ou d'implémentation?</a></li>
<li><a href="../fr468233/index.html">La façon de taper la vérification de 4 millions de lignes de code Python. partie 1</a></li>
<li><a href="../fr468235/index.html">La façon de taper la vérification de 4 millions de lignes de code Python. 2e partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>