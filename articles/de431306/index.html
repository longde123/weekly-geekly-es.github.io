<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîê üê§ üòä So erstellen Sie eine Pyramide im Trunk oder in testgesteuerten Entwicklungsanwendungen auf Spring Boot üé¥ üìè üò¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Spring Framework wird h√§ufig als Beispiel f√ºr das Cloud Native Framework angef√ºhrt, das f√ºr die Arbeit in der Cloud, die Entwicklung von Zw√∂lf-Fak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So erstellen Sie eine Pyramide im Trunk oder in testgesteuerten Entwicklungsanwendungen auf Spring Boot</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431306/"><p> <em>Das Spring Framework wird</em> h√§ufig als Beispiel f√ºr das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud Native</a> Framework angef√ºhrt, das f√ºr die Arbeit in der Cloud, die Entwicklung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zw√∂lf-Faktor-Anwendungen</a> , Microservices und eines der stabilsten, aber gleichzeitig innovativsten Produkte entwickelt wurde.  Aber in diesem Artikel m√∂chte ich auf eine weitere starke Seite des Fr√ºhlings eingehen: Es ist seine <em>Entwicklungsunterst√ºtzung durch Testen</em> (TDD-F√§higkeit?).  Trotz TDD-Konnektivit√§t habe ich oft bemerkt, dass Spring-Projekte entweder einige bew√§hrte Methoden zum Testen ignorieren, ihre eigenen Motorr√§der erfinden oder √ºberhaupt keine Tests schreiben, weil sie "langsam" oder "unzuverl√§ssig" sind.  Und ich werde Ihnen genau sagen, wie Sie <strong>schnelle</strong> und <strong>zuverl√§ssige</strong> Tests f√ºr Anwendungen auf dem Spring Framework schreiben und die Entwicklung durch Testen durchf√ºhren.  Wenn Sie also Spring verwenden (oder starten m√∂chten), verstehen, was Tests im Allgemeinen sind (oder verstehen m√∂chten) oder denken, dass <code>contextLoads</code> die notwendige und ausreichende Stufe f√ºr Integrationstests ist - das wird interessant sein! </p><a name="habracut"></a><br><p>  Die "TDD" -Funktion ist sehr vieldeutig und schlecht messbar. Dennoch hat Spring viele Dinge, die von Natur aus dazu beitragen, Integrations- und Komponententests mit minimalem Aufwand zu schreiben.  Zum Beispiel: </p><br><ul><li>  Integrationstests - Sie k√∂nnen die Anwendung einfach starten, Komponenten sperren, Parameter neu definieren usw. </li><li>  Fokusintegrationstests - nur Zugriff auf Daten, nur Web usw. </li><li>  Sofort einsatzbereite Unterst√ºtzung - speicherinterne Datenbanken, Nachrichtenwarteschlangen, Authentifizierung und Autorisierung in Tests </li><li>  Testen durch Vertr√§ge (Spring Cloud Contract) </li><li>  Unterst√ºtzung f√ºr das Testen der Web-Benutzeroberfl√§che mit HtmlUnit </li><li>  Flexibilit√§t der Anwendungskonfiguration - Profile, Testkonfigurationen, Komponenten usw. </li><li>  Und vieles mehr </li></ul><br><p>  Zun√§chst eine kleine, aber notwendige Einf√ºhrung in TDD und das Testen im Allgemeinen. </p><br><h1 id="test-driven-development">  Testgetriebene Entwicklung </h1><br><p>  TDD basiert auf einer sehr einfachen Idee: Wir schreiben Tests, <strong>bevor</strong> wir Code schreiben.  Theoretisch klingt es be√§ngstigend, aber nach einiger Zeit kommt ein Verst√§ndnis f√ºr Praktiken und Techniken, und die M√∂glichkeit, Tests <em>danach</em> zu schreiben, verursacht sp√ºrbare Beschwerden.  Eine der Schl√ºsselpraktiken ist die <em>Iteration</em> , d.h.  Machen Sie alles zu kleinen, fokussierten Iterationen, von denen jede als <strong>Rot-Gr√ºn-Refaktor bezeichnet wird</strong> . </p><br><p>  In der <strong>roten</strong> Phase schreiben wir einen Falltest, und es ist sehr wichtig, dass er mit einem klaren, verst√§ndlichen Grund und einer klaren Beschreibung f√§llt und dass der Test selbst vollst√§ndig ist und bestanden wird, wenn der Code geschrieben wird.  Der Test sollte das <em>Verhalten</em> √ºberpr√ºfen, nicht die <em>Implementierung</em> , d. H.  Folgen Sie dem Black-Box-Ansatz, dann werde ich erkl√§ren, warum. </p><br><p>  In der <strong>gr√ºnen</strong> Phase schreiben wir den <em>minimal erforderlichen Code</em> , um den Test zu bestehen.  Manchmal ist es interessant zu √ºben und es so verr√ºckt wie m√∂glich zu machen (obwohl es besser ist, sich nicht mitrei√üen zu lassen), und wenn eine Funktion je nach Zustand des Systems einen Booleschen Wert zur√ºckgibt, kann der erste "Durchgang" einfach <code>return true</code> . </p><br><p>  In der <strong>Refactoring-</strong> Phase, die <em>nur</em> gestartet werden kann, <em>wenn alle Tests gr√ºn sind</em> , werden wir den Code refactorisieren und in den richtigen Zustand bringen.  Es ist nicht einmal f√ºr einen Code erforderlich, den wir geschrieben haben. Daher ist es wichtig, mit dem Refactoring auf einem stabilen System zu beginnen.  Der ‚ÄûBlack Box‚Äú -Ansatz hilft nur beim Refactoring, beim √Ñndern der Implementierung, aber nicht beim Ber√ºhren des Verhaltens. </p><br><p>  Ich werde in Zukunft √ºber verschiedene Aspekte von TDD sprechen, schlie√ülich ist dies die Idee einer Reihe von Artikeln, daher werde ich mich jetzt nicht besonders mit den Details befassen.  Bevor ich jedoch auf Standard-TDD-Kritik reagiere, werde ich einige Mythen erw√§hnen, die ich oft h√∂re. </p><br><ul><li>  <em>"TDD deckt den Code zu 100% ab, gibt jedoch keine Garantie"</em> - die Entwicklung durch Tests hat √ºberhaupt keinen Bezug zur 100% igen Abdeckung.  In vielen Teams, in denen ich gearbeitet habe, wurde diese Metrik nicht einmal gemessen und als Eitelkeitsmetrik klassifiziert.  Und ja, 100% Testabdeckung bedeutet nichts. </li><li>  <em>"TDD funktioniert nur f√ºr einfache Funktionen, eine echte Anwendung mit einer Datenbank und ein schwieriger Zustand kann damit nicht erstellt werden"</em> ist eine sehr beliebte Ausrede, die normalerweise erg√§nzt wird durch "Wir haben eine so komplizierte Anwendung, dass wir √ºberhaupt keine Tests schreiben, Sie k√∂nnen es √ºberhaupt nicht tun."  Ich sah einen funktionierenden TDD-Ansatz f√ºr v√∂llig unterschiedliche Anwendungen - Web (mit und ohne SPA), Mobile, API, Microservices, Monolithen, komplexe Bankensysteme, Cloud-Plattformen, Frameworks, Einzelhandelsplattformen, die in verschiedenen Sprachen und Technologien geschrieben wurden.  Der popul√§re Mythos ‚ÄûWir sind einzigartig, alles ist anders‚Äú ist meistens eine Ausrede, keinen Aufwand und kein Geld in Tests zu investieren, aber kein wirklicher Grund (obwohl es auch echte Gr√ºnde geben kann). </li><li>  <em>"Es wird immer noch Fehler mit TDD geben"</em> - nat√ºrlich wie bei jeder anderen Software.  Bei TDD geht es nicht um Fehler oder deren Abwesenheit, sondern um ein Entwicklungswerkzeug.  Wie das Debuggen.  Wie eine IDE.  Wie die Dokumentation.  Keines dieser Tools garantiert das Fehlen von Fehlern, sondern hilft nur, die zunehmende Komplexit√§t des Systems zu bew√§ltigen. </li></ul><br><blockquote>  Das Hauptziel von TDD und allgemeinen Tests besteht darin, dem Team das <strong>Vertrauen</strong> zu geben <strong>,</strong> dass das System stabil funktioniert.  Daher bestimmt keine der Testpraktiken, wie viele und welche Tests geschrieben werden sollen.  Schreiben Sie, wie viel Sie f√ºr notwendig halten, wie viel Sie ben√∂tigen, um sicherzugehen, dass der Code jetzt <em>in Produktion gehen kann und funktioniert</em> .  Es gibt Leute, die schnelle Integrationstests als eine ultimative Black Box betrachten, die notwendig und ausreichend ist, und Unit-Tests optional.  Jemand sagt, dass e2e-Tests mit der M√∂glichkeit eines schnellen Rollbacks auf die vorherige Version und dem Vorhandensein kanarischer Versionen nicht so kritisch sind.  Wie viele Teams - so viele Ans√§tze, es ist wichtig, eigene zu finden. </blockquote><p>  Eines meiner Ziele ist es, mich vom Format <em>‚ÄûEntwicklung durch Testen einer Funktion, die zwei Zahlen hinzuf√ºgt‚Äú</em> in der TDD-Story zu entfernen und eine reale Anwendung zu betrachten, eine Art Testpraxis, die auf eine minimale Anwendung reduziert wurde und in realen Projekten gesammelt wurde.  Als solches semi-reales Beispiel werde ich eine kleine Webanwendung verwenden, die ich selbst f√ºr abstrakt erfunden habe <del>  Fabriken </del>  B√§ckerei - <strong>Kuchenfabrik</strong> .  Ich habe vor, kleine Artikel zu schreiben, die sich jedes Mal auf eine separate Anwendungsfunktionalit√§t konzentrieren und durch TDD zeigen, dass Sie APIs und die interne Struktur der Anwendung entwerfen und ein konstantes Refactoring beibehalten k√∂nnen. </p><br><p>  Ein Beispielplan f√ºr eine Reihe von Artikeln, wie ich ihn derzeit sehe, lautet: </p><br><ol><li>  Laufskelett - Anwendungsframework, in dem Sie den Rot-Gr√ºn-Refaktor-Zyklus ausf√ºhren k√∂nnen </li><li>  UI-Tests und verhaltensgesteuertes Design </li><li>  Datenzugriffstests (Federdaten) </li><li>  Autorisierungs- und Authentifizierungstests (Spring Security) </li><li>  Jet Stack (WebFlux + Projektreaktor) </li><li>  Interoperabilit√§t von (Mikro-) Diensten und Vertr√§gen (Spring Cloud) </li><li>  Testen der Nachrichtenwarteschlange (Spring Cloud) </li></ol><br><p>  In diesem Einf√ºhrungsartikel geht es um die Punkte 1 und 2 - Ich werde ein Anwendungsframework und einen grundlegenden UI-Test unter Verwendung des BDD- oder <strong>verhaltensgesteuerten Entwicklungsansatzes</strong> erstellen.  Jeder Artikel beginnt mit einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">User Story</a> , aber ich werde nicht √ºber den Teil ‚ÄûProdukt‚Äú sprechen, um Zeit zu sparen.  Die User Story wird in englischer Sprache verfasst, es wird bald klar, warum.  Alle Codebeispiele finden Sie auf GitHub, daher werde ich nicht den gesamten Code analysieren, sondern nur die wichtigen Teile. </p><br><blockquote>  User Story ist eine Beschreibung einer Funktion einer Anwendung in nat√ºrlicher Sprache, die normalerweise im Auftrag eines Benutzers des Systems geschrieben wird. </blockquote><br><h1 id="user-story-1-polzovatel-vidit-stranicu-privetstviya">  User Story 1: Benutzer sieht Begr√º√üungsseite </h1><br><blockquote>  <strong>Als</strong> Alice ein neuer Benutzer <br>  <strong>Ich m√∂chte</strong> eine Begr√º√üungsseite sehen, wenn <strong>ich die</strong> Cake Factory-Website besuche <br>  <strong>Damit</strong> ich wei√ü, wann Cake Factory startet <br><br>  Akzeptanzkriterien: <br>  Szenario: Ein Benutzer, der die Website besucht, besucht sie vor dem Startdatum <br>  Vorausgesetzt, ich bin ein neuer Benutzer <br>  Wenn ich die Cake Factory-Website besuche <br>  Dann sehe ich eine Nachricht 'Danke f√ºr Ihr Interesse' <br>  Und ich sehe eine Nachricht 'Die Website kommt bald ...' </blockquote><p>  Es wird Wissen erfordern: Was ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verhaltensgesteuerte Entwicklung</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gurke</a> , die Grundlagen des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spring Boot-Testens</a> . </p><br><p>  Die erste User Story ist recht einfach, aber das Ziel liegt noch nicht in der Komplexit√§t, sondern in der Erstellung eines Laufskeletts - eine minimale Anwendung zum Starten des <strong>TDD-Zyklus</strong> . </p><br><p>  Nachdem ich ein neues Projekt auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spring Initializr</a> mit Web- und Moustache-Modulen erstellt habe, ben√∂tige ich zun√§chst einige weitere √Ñnderungen an <code>build.gradle</code> : </p><br><ul><li>  F√ºgen Sie <code>testImplementation('net.sourceforge.htmlunit:htmlunit')</code> testImplementation <code>testImplementation('net.sourceforge.htmlunit:htmlunit')</code> .  Sie m√ºssen die Version nicht angeben. Das Spring Boot-Abh√§ngigkeitsverwaltungs-Plugin f√ºr Gradle w√§hlt automatisch die erforderliche und kompatible Version aus </li><li>  ein Projekt von JUnit 4 auf JUnit 5 migrieren (da 2018 auf dem Hof ‚Äã‚Äãliegt) </li><li>  F√ºgen Sie Cucumber Abh√§ngigkeiten hinzu - eine Bibliothek, mit der ich BDD-Spezifikationen schreiben werde </li><li>  Entfernen Sie standardm√§√üig erstellte <code>CakeFactoryApplicationTests</code> mit unvermeidlichen <code>contextLoads</code> </li></ul><br><p>  Im Gro√üen und Ganzen ist dies das grundlegende "Grundger√ºst" der Anwendung, Sie k√∂nnen bereits den ersten Test schreiben. </p><br><p>  Um die Navigation im Code zu vereinfachen, werde ich kurz auf die verwendeten Technologien eingehen. </p><br><h2 id="cucumber">  Gurke </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cucumber</a> ist ein <strong>verhaltensgesteuertes Entwicklungsframework</strong> , mit dessen Hilfe "ausf√ºhrbare Spezifikationen" erstellt werden k√∂nnen, d. H.  F√ºhren Sie Tests (Spezifikationen) in nat√ºrlicher Sprache durch.  Das Cucumber-Plugin analysiert den Quellcode in Java (und vielen anderen Sprachen) und verwendet <em>Schrittdefinitionen</em> , um echten Code auszuf√ºhren.  <code>@Given</code> sind <code>@When</code> , die mit <code>@Given</code> , <code>@When</code> , <code>@Then</code> und anderen Annotationen versehen sind. </p><br><h2 id="htmlunit">  Htmlunit </h2><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die</a> Projekthomepage nennt HtmlUnit "einen GUI-freien Browser f√ºr Java-Anwendungen".  Im Gegensatz zu Selenium startet HtmlUnit keinen echten Browser und rendert die Seite vor allem √ºberhaupt nicht, da es direkt mit dem DOM arbeitet.  JavaScript wird von der Mozilla Rhino Engine unterst√ºtzt.  HtmlUnit eignet sich gut f√ºr klassische Anwendungen, ist jedoch f√ºr Single Page Apps nicht sehr geeignet.  Zun√§chst wird es ausreichen, und dann werde ich versuchen zu zeigen, dass auch solche Dinge wie ein Testframework Teil der Implementierung und nicht die Grundlage der Anwendung sein k√∂nnen. </p><br><h1 id="pervyy-test">  Erster Test </h1><br><p>  Jetzt wird mir eine auf Englisch geschriebene User Story n√ºtzlich sein.  Der beste Ausl√∂ser f√ºr den Start der n√§chsten TDD-Iteration sind Akzeptanzkriterien, die so geschrieben sind, dass sie mit einem Minimum an Gesten in eine ausf√ºhrbare Spezifikation umgewandelt werden k√∂nnen. </p><br><blockquote>  Im Idealfall sollten User Stories so geschrieben werden, dass sie einfach in die BDD-Spezifikation kopiert und ausgef√ºhrt werden k√∂nnen.  Dies ist alles andere als immer einfach und nicht immer m√∂glich, aber dies sollte das Ziel des Produktbesitzers und des gesamten Teams sein, wenn auch nicht immer erreichbar. </blockquote><p>  Also mein erstes Feature. </p><br><pre> <code class="plaintext hljs">Feature: Welcome page Scenario: a user visiting the web-site visit before the launch date Given a new user, Alice When she visits Cake Factory web-site Then she sees a message 'Thank you for your interest' And she sees a message 'The web-site is coming in December!'</code> </pre> <br><p>  Wenn Sie Schrittbeschreibungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen</a> (das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Intellij IDEA-Plugin</a> unterst√ºtzt Gherkin sehr) und den Test ausf√ºhren, ist er nat√ºrlich gr√ºn - es wird noch nichts getestet.  Und hier kommt die wichtige Phase der Arbeit am Test - <em>Sie m√ºssen einen Test schreiben, als ob der Hauptcode geschrieben worden w√§re</em> . </p><br><p>  F√ºr diejenigen, die anfangen, TDD zu verbannen, setzt hier oft eine Bet√§ubung ein - es ist schwierig, die Algorithmen und die Logik von etwas, das nicht existiert, in den Kopf zu bekommen.  Daher ist es sehr wichtig, m√∂glichst <em>kleine und fokussierte Iterationen</em> zu haben, angefangen von der User Story bis hin zur Integrations- und Einheitenebene.  Es ist wichtig, sich <strong>auf jeweils einen Test zu konzentrieren</strong> und zu versuchen, nass zu werden und Abh√§ngigkeiten zu ignorieren, die noch nicht wichtig sind.  Manchmal ist mir aufgefallen, wie leicht Leute beiseite gehen - eine Schnittstelle oder Klasse f√ºr eine Abh√§ngigkeit erstellen, sofort eine leere Testklasse daf√ºr generieren, dort eine weitere Abh√§ngigkeit hinzuf√ºgen, eine weitere Schnittstelle erstellen und so weiter. </p><br><blockquote>  Wenn die Geschichte lautet "Es w√§re notwendig, den Status beim Speichern zu aktualisieren", ist es sehr schwierig, sie zu automatisieren und zu formalisieren.  In meinem Beispiel kann jeder Schritt in einer Abfolge von Schritten klar angeordnet werden, die durch Code beschrieben werden k√∂nnen.  Es ist klar, dass dies das einfachste Beispiel ist und nicht viel zeigt, aber ich hoffe, dass es mit zunehmender Komplexit√§t interessanter wird. </blockquote><br><h2 id="red">  Rot </h2><br><p>  Daher habe ich f√ºr mein erstes Feature die folgenden Schrittbeschreibungen erstellt: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SpringBootTest</span></span>(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WelcomePage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WebClient webClient; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HtmlPage page; <span class="hljs-meta"><span class="hljs-meta">@LocalServerPort</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> port; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String baseUrl; <span class="hljs-meta"><span class="hljs-meta">@Before</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ webClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebClient(); baseUrl = <span class="hljs-string"><span class="hljs-string">"http://localhost:"</span></span> + port; } <span class="hljs-meta"><span class="hljs-meta">@Given</span></span>(<span class="hljs-string"><span class="hljs-string">"a new user, Alice"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aNewUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// nothing here, every user is new by default } @When("she visits Cake Factory web-site") public void sheVisitsCakeFactoryWebSite() throws IOException { page = webClient.getPage(baseUrl); } @Then("she sees a message {string}") public void sheSeesAMessageThanksForYourInterest(String expectedMessage) { assertThat(page.getBody().asText()).contains(expectedMessage); } }</span></span></code> </pre> <br><p>  Einige Punkte, die Sie beachten sollten: </p><br><ul><li>  Features werden von einer anderen Datei, <code>Features.java</code> mit <code>RunWith</code> Annotation von JUnit 4 gestartet. Cucumber unterst√ºtzt leider keine Version 5 </li><li>  <code>@SpringBootTest</code> Annotation <code>@SpringBootTest</code> wird zur Beschreibung der Schritte hinzugef√ºgt, <code>cucumber-spring</code> nimmt sie von dort auf und konfiguriert den <code>@SpringBootTest</code> (d. H. Startet die Anwendung). </li><li>  Die Spring-Anwendung f√ºr den Test beginnt mit <code>webEnvironment = RANDOM_PORT</code> und dieser zuf√§llige Port wird mit <code>@LocalServerPort</code> an den Test <code>@LocalServerPort</code> . Spring findet diese Anmerkung und setzt den <code>@LocalServerPort</code> auf den Server-Port </li></ul><br><p>  Und der Test st√ºrzt erwartungsgem√§√ü mit dem Fehler <code>404 for http://localhost:51517</code> . </p><br><blockquote>  Die Fehler, mit denen der Test abst√ºrzt, sind unglaublich wichtig, insbesondere bei Unit- oder Integrationstests. Diese Fehler sind Teil der API.  Wenn der Test mit einer <code>NullPointerException</code> dies nicht allzu gut, aber die <code>BaseUrl configuration property is not set</code> - viel besser. </blockquote><br><h2 id="green">  Gr√ºn </h2><br><p>  Um den Test gr√ºn zu machen, habe ich einen Basis-Controller und eine Ansicht mit minimalem HTML-Code hinzugef√ºgt: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Controller</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IndexController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GetMapping</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"index"</span></span>; } }</code> </pre> <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Cake Factory<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Thank you for your interest<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>The web-site is coming in December!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Der Test ist gr√ºn, die Anwendung funktioniert, obwohl er in der Tradition des strengen Konstruktionsdesigns hergestellt wird. </p><br><blockquote>  Bei einem echten Projekt und in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ausgeglichenen Team</a> w√ºrde ich mich nat√ºrlich mit dem Designer zusammensetzen und wir w√ºrden das blo√üe HTML in etwas viel Sch√∂neres verwandeln.  Aber im Rahmen des Artikels wird kein Wunder geschehen, die Prinzessin wird ein Frosch bleiben. </blockquote><p>  Die Frage ‚ÄûWas f√ºr ein Teil von TDD ist Design?‚Äú Ist nicht so einfach.  Eine der Methoden, die ich als n√ºtzlich empfunden habe, besteht darin, zun√§chst gar nicht auf die Benutzeroberfl√§che zu schauen (nicht einmal die Anwendung auszuf√ºhren, um Ihre Nerven zu schonen), einen Test zu schreiben, ihn gr√ºn zu machen - und dann mit einer stabilen Grundlage am Front-End zu arbeiten und die Tests st√§ndig neu zu starten . </p><br><h2 id="refactor">  Refactor </h2><br><p>  In der ersten Iteration gibt es kein bestimmtes Refactoring, aber obwohl ich die letzten 10 Minuten damit verbracht habe, eine Vorlage f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bulma auszuw√§hlen</a> , die als Refactoring gez√§hlt werden kann! </p><br><h1 id="v-zaklyuchenie">  Abschlie√üend </h1><br><p>  W√§hrend die Anwendung weder √ºber Sicherheitsarbeit noch √ºber eine Datenbank oder eine API verf√ºgt, sehen Tests und TDDs recht einfach aus.  Und im Allgemeinen habe ich von der Testpyramide nur die Spitze ber√ºhrt, den UI-Test.  Aber zum Teil besteht das Geheimnis des Lean-Ansatzes darin, alles in kleinen Iterationen zu erledigen, eine Komponente nach der anderen.  Dies hilft, sich auf die Tests zu konzentrieren, sie zu vereinfachen und die Qualit√§t des Codes zu kontrollieren.  Ich hoffe, dass es in den folgenden Artikeln interessanter wird. </p><br><h1 id="ssylki">  Referenzen </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub-</a> Projekt </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Concourse ci</a> </li></ul><br><p>  <em>PS Der Titel des Artikels ist nicht so verr√ºckt, wie es am Anfang scheinen mag, ich denke, viele haben es bereits erraten.</em>  <em>"Wie man eine Pyramide in den Kofferraum baut" bezieht sich auf die Testpyramide (dazu sp√§ter mehr) und Spring Boot, wobei "Boot" im britischen Englisch auch "Kofferraum" bedeutet.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de431306/">https://habr.com/ru/post/de431306/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de431296/index.html">Emotionale Rollen in Spielen. Kompetente Erz√§hlung und Beteiligung am Fluss</a></li>
<li><a href="../de431298/index.html">Echte Eindeutigkeitsvalidierung</a></li>
<li><a href="../de431300/index.html">Drei Jahre Zertifizierung ohne F√ºhrer - normaler Flug</a></li>
<li><a href="../de431302/index.html">Aus dem M√ºll eine einfache Sonarantenne machen</a></li>
<li><a href="../de431304/index.html">Auf der Suche nach vielversprechenden Schatten f√ºr Roguelike</a></li>
<li><a href="../de431308/index.html">Innotrans 2018: Welche Art von Schienenverkehr wird morgen sein?</a></li>
<li><a href="../de431310/index.html">Konfigurieren Sie Firefox / Chrome f√ºr sehr langsames und begrenztes Internet</a></li>
<li><a href="../de431312/index.html">DeezLoader + PlexMediaServer. Ein Home-Musikportal erstellen</a></li>
<li><a href="../de431316/index.html">Abstimmung √ºber die zweite Beta des √ºberarbeiteten 7-Berichts zum algorithmischen Sprachschema (gro√üe Sprache)</a></li>
<li><a href="../de431318/index.html">Python-Transpilerkette ‚Üí 11l ‚Üí C ++ [um Python-Code und mehr zu beschleunigen]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>