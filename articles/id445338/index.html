<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôå üïµÔ∏è üì≤ DHCP + server Mysql dengan Python üïó ‚ôÄÔ∏è üí´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tujuan dari proyek ini adalah: 



- Mempelajari DHCP melalui Jaringan IPv4 
- Belajar Python (sedikit lebih banyak dari awal;)) 
- mengganti server D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DHCP + server Mysql dengan Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445338/"><img src="https://habrastorage.org/webt/ju/n4/fb/jun4fbrj-eabxfgou112uxc5lac.png"><br><br>  Tujuan dari proyek ini adalah: <br><br><ul><li>  Mempelajari DHCP melalui Jaringan IPv4 </li><li>  Belajar Python (sedikit lebih banyak dari awal;)) </li><li>  mengganti server <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">DB2DHCP</a> (garpu saya), yang asli di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , yang lebih sulit dan lebih sulit untuk dirakit di bawah OS baru.  Ya, dan saya tidak suka biner itu, yang tidak mungkin untuk "berubah sekarang" </li><li>  mendapatkan server DHCP yang berfungsi dengan kemampuan untuk memilih alamat IP pelanggan oleh mac pelanggan atau sekelompok switch mac + port (Opsi 82) </li><li>  menulis sepeda lain (Oh! ini hobi favorit saya) </li><li>  mendapatkan luli tentang juling Anda di Habrahabr (atau undangan yang lebih baik);) </li></ul><br>  Hasil: berfungsi;) Diuji pada FreeBSD dan OS Ubuntu.  Secara teoritis, kode dapat diminta untuk bekerja di bawah OS apa pun, karena  tidak ada ikatan khusus dalam kode. <br>  Perhatian  Lebih jauh. <br><a name="habracut"></a><br>  Tautan ke repositori untuk penggemar untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"menyentuh hidup-hidup</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"</a> <br><br>  Proses menginstal, mengkonfigurasi, dan menggunakan hasil "studi perangkat keras" jauh lebih rendah, dan kemudian sedikit teori tentang protokol DHCP.  Untuk diriku sendiri  Dan untuk ceritanya;) <br><br><h1>  Sedikit teori </h1><br><h2>  Apa itu DHCP? </h2><br>  Ini adalah protokol jaringan yang memungkinkan perangkat untuk mengetahui alamat IP-nya (well, parameter lain seperti gateway, DNS, dll.) Dari server DHCP.  Paket dipertukarkan melalui UDP.  Prinsip umum pengoperasian perangkat saat meminta parameter jaringan adalah sebagai berikut: <br><br><ol><li>  Perangkat (klien) mengirimkan permintaan siaran UDP (DHCPDISCOVER) di seluruh jaringan dengan permintaan, "Baiklah, seseorang, beri saya alamat IP."  Dan biasanya (tetapi tidak selalu) permintaan dari port 68 (sumber), dan tujuannya adalah port 67 (tujuan).  Beberapa perangkat juga mengirim paket dari port 67.  Di dalam paket DHCPDISCOVER, alamat MAC perangkat klien disertakan. </li><li>  Semua server DHCP yang terletak di jaringan (dan mungkin ada beberapa) formulir untuk perangkat yang mengirim DHCPDISCOVER kalimat DHCPOFFER dengan pengaturan jaringan, dan juga menyiarkannya melalui jaringan.  Identifikasi kepada siapa paket ini dimaksudkan pergi ke alamat MAC dari klien yang diberikan sebelumnya dalam permintaan DHCPDISCOVER. </li><li>  Klien menerima paket dengan penawaran pengaturan jaringan, memilih yang paling menarik (kriteria dapat berbeda, misalnya, pada saat pengiriman paket, jumlah rute perantara), dan membuat server DHCP "secara resmi meminta" DHCPREQUEST dengan pengaturan jaringan.  Dalam hal ini, paket tersebut menuju ke server DHCP tertentu. </li><li>  Server yang menerima DHCPREQUEST mengirimkan paket DHCPACK di mana ia sekali lagi mencantumkan pengaturan jaringan untuk klien ini </li></ol><br><img src="https://habrastorage.org/webt/ki/vj/cn/kivjcno-qcqpx8jgqxra1rnspvi.png"><br><br>  Selain itu, ada paket DHCPINFORM yang berasal dari klien, dan tujuannya adalah untuk memberi tahu server DHCP bahwa "klien masih hidup" dan menggunakan pengaturan jaringan yang dikeluarkan.  Dalam implementasi server ini, paket-paket ini diabaikan. <br><br><h2>  Format paket </h2><br><br>  Secara umum, frame paket Ethernet terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/x6/uj/n0/x6ujn0ood0nch96zosj6ldkjt4s.png"><br><br>  Dalam kasus kami, kami hanya akan mempertimbangkan data secara langsung dari isi paket UDP, tanpa header protokol layer OSI, yaitu struktur DHCP: <br><br><h3>  DHCPDISCOVER </h3><br>  Jadi, proses mendapatkan alamat IP untuk perangkat dimulai dengan fakta bahwa klien DHCP mengirim permintaan siaran dari port 68 ke 255.255.255.255:255.  Dalam paket ini, klien menyertakan alamat MAC-nya, serta apa yang ingin diterima dari server DHCP.  Struktur paket dijelaskan dalam tabel di bawah ini. <br><br><div class="spoiler">  <b class="spoiler_title">Tabel struktur paket DHCPDISCOVER</b> <div class="spoiler_text"><table border="1"><tbody><tr><td align="left">  Posisi Paket </td><td align="left">  Nama Nilai </td><td align="right">  Contoh </td><td align="center">  Kiriman </td><td align="center">  Byte </td><td align="left">  Penjelasan </td></tr><tr><td align="right">  1 </td><td align="left">  Permintaan boot </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis pesan.  1 - permintaan dari klien ke server, 2 - respons dari server ke klien </td></tr><tr><td align="right">  2 </td><td align="left">  Jenis perangkat keras </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis alamat perangkat keras, dalam protokol ini 1 - MAC </td></tr><tr><td align="right">  3 </td><td align="left">  Panjang alamat perangkat keras </td><td align="right">  6 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Panjang Alamat MAC Perangkat </td></tr><tr><td align="right">  4 </td><td align="left">  Hop </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jumlah rute perantara </td></tr><tr><td align="right">  5 </td><td align="left">  ID transaksi </td><td align="right">  23: cf: de: 1d </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Pengidentifikasi Transaksi Unik.  Dihasilkan oleh klien pada awal operasi permintaan </td></tr><tr><td align="right">  7 </td><td align="left">  Kedua berlalu </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Waktu dalam detik sejak awal proses mendapatkan alamat </td></tr><tr><td align="right">  9 </td><td align="left">  Bendera bootp </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  2 </td><td align="left">  Beberapa flag yang dapat diatur sebagai indikasi parameter protokol </td></tr><tr><td align="right">  11 </td><td align="left">  Alamat IP klien </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP klien (jika ada) </td></tr><tr><td align="right">  15 </td><td align="left">  Alamat IP klien Anda </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP yang diajukan oleh server (jika ada) </td></tr><tr><td align="right">  19 </td><td align="left">  Alamat IP server berikutnya </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP server (jika diketahui) </td></tr><tr><td align="right">  23 </td><td align="left">  Relay alamat IP agen </td><td align="right">  172.16.114.41 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Relay alamat IP agen (misalnya, switch) </td></tr><tr><td align="right">  27 </td><td align="left">  Alamat MAC klien </td><td align="right">  14: d6: 4d: a7: c9: 55 </td><td align="center">  Hex </td><td align="right">  6 </td><td align="left">  Alamat MAC dari pengirim paket (klien) </td></tr><tr><td align="right">  31 </td><td align="left">  Padding alamat perangkat keras klien </td><td align="right"></td><td align="center">  Hex </td><td align="right">  10 </td><td align="left">  Tempat yang dipesan.  Biasanya nol </td></tr><tr><td align="right">  41 </td><td align="left">  Nama host server </td><td align="right"></td><td align="center">  Tali </td><td align="right">  64 </td><td align="left">  Nama server DHCP.  Biasanya tidak ditransmisikan </td></tr><tr><td align="right">  105 </td><td align="left">  Nama file boot </td><td align="right"></td><td align="center">  Tali </td><td align="right">  128 </td><td align="left">  Nama file di server yang digunakan oleh stasiun tanpa disk saat boot </td></tr><tr><td align="right">  235 </td><td align="left">  Cookie ajaib </td><td align="right">  63: 82: 53: 63 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Angka "ajaib", dimana termasuk  Anda dapat menentukan bahwa paket ini milik protokol DHCP </td></tr><tr><td colspan="7" align="center">  Opsi DHCP.  Bisa masuk dalam urutan apa pun </td></tr><tr><td align="right">  236 </td><td align="left">  Nomor opsi </td><td align="right">  53 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi 53 menentukan jenis paket DHCP <br><br>  1 - DHCPDISCOVER <br>  3 - DHCPREQUEST <br>  2 - DHCPOFFER <br>  5 - DHCPACK <br>  8 - DHCPINFORM </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  50 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Alamat IP apa yang ingin diterima oleh klien </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  172.16.134.61 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  55 </td><td align="center"></td><td align="right">  1 </td><td rowspan="3" align="left">  Parameter jaringan yang diminta oleh klien.  Komposisi mungkin berbeda <br><br>  01 - Netmask <br>  03 - Gateway <br>  06 - DNS <br>  oc - nama host <br>  0f - nama domain jaringan <br>  1c - alamat permintaan siaran (Siaran) <br>  42 - Nama server TFTP <br>  79 - Rute Statis Tanpa Kelas </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  8 </td><td align="center"></td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01: 03: 06: 0c: 0f: 1c: 42: 79 </td><td align="center"></td><td align="right">  8 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  82 </td><td align="center">  Desember </td><td align="left"></td><td rowspan="3" align="left">  Opsi 82, di mana alamat MAC perangkat repeater dan beberapa nilai tambahan dikirimkan. <br><br>  Paling sering, port switch di mana DHCP end client berjalan. Opsi tambahan adalah "tertanam" dalam opsi ini. Byte pertama adalah nomor dari "suboption", yang kedua adalah panjangnya, dan kemudian nilainya. <br><br>  Dalam hal ini, dalam opsi 82, suboplikasi bersarang: <br>  ID Sirkuit Agen = 00: 04: 00: 01: 00: 04, dengan dua byte terakhir adalah port klien DHCP dari mana permintaan tersebut berasal <br><br>  ID Remote Agen = 00: 06: c8: be: 19: 93: 11: 48 - Alamat MAC pada perangkat relai DHCP </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  18 </td><td align="center">  Desember </td><td align="left"></td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01:06 <br>  00: 00: 00: 01: 00: 04 <br>  02:08 <br>  00: 06: c8: menjadi: 19: 93: 11: 48 </td><td align="center">  Hex </td><td align="left"></td></tr><tr><td align="left"></td><td align="left">  Paket akhir </td><td align="right">  255 </td><td align="center">  Desember </td><td align="right">  1 </td><td align="left">  255 melambangkan akhir paket </td></tr></tbody></table><br></div></div><br><h3>  DHCPOFFER </h3><br>  Segera setelah server menerima paket DHCPDISCOVER dan jika ia melihat bahwa ia dapat menawarkan sesuatu kepada klien dari yang diminta, maka ia membentuk respons untuknya - DHCPOFFER.  Jawabannya dikirim ke port "dari tempat asalnya", Siaran, karena  pada saat ini, klien belum memiliki alamat IP, oleh karena itu, ia dapat menerima paket hanya jika dikirim siaran.  Klien mengakui bahwa itu adalah paket untuknya oleh MAC di alamatnya di dalam paket, serta nomor transaksi yang ia hasilkan pada saat pembuatan paket pertama. <br><br><div class="spoiler">  <b class="spoiler_title">Tabel struktur paket DHCPOFFER</b> <div class="spoiler_text"><table border="1"><tbody><tr><td align="left">  Posisi Paket </td><td align="left">  Nama nilai (umum) </td><td align="right">  Contoh </td><td align="center">  Kiriman </td><td align="center">  Byte </td><td align="left">  Penjelasan </td></tr><tr><td align="right">  1 </td><td align="left">  Permintaan boot </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis pesan.  1 - permintaan dari klien ke server, 2 - respons dari server ke klien </td></tr><tr><td align="right">  2 </td><td align="left">  Jenis perangkat keras </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis alamat perangkat keras, dalam protokol ini 1 - MAC </td></tr><tr><td align="right">  3 </td><td align="left">  Panjang alamat perangkat keras </td><td align="right">  6 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Panjang Alamat MAC Perangkat </td></tr><tr><td align="right">  4 </td><td align="left">  Hop </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jumlah rute perantara </td></tr><tr><td align="right">  5 </td><td align="left">  ID transaksi </td><td align="right">  23: cf: de: 1d </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Pengidentifikasi Transaksi Unik.  Dihasilkan oleh klien pada awal operasi permintaan </td></tr><tr><td align="right">  7 </td><td align="left">  Kedua berlalu </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Waktu dalam detik sejak awal proses mendapatkan alamat </td></tr><tr><td align="right">  9 </td><td align="left">  Bendera bootp </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  2 </td><td align="left">  Beberapa flag yang dapat diatur sebagai indikasi parameter protokol.  Dalam hal ini, 0 berarti jenis permintaan Unicast </td></tr><tr><td align="right">  11 </td><td align="left">  Alamat IP klien </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP klien (jika ada) </td></tr><tr><td align="right">  15 </td><td align="left">  Alamat IP klien Anda </td><td align="right">  172.16.134.61 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP yang diajukan oleh server (jika ada) </td></tr><tr><td align="right">  19 </td><td align="left">  Alamat IP server berikutnya </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP server (jika diketahui) </td></tr><tr><td align="right">  23 </td><td align="left">  Relay alamat IP agen </td><td align="right">  172.16.114.41 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Relay alamat IP agen (misalnya, switch) </td></tr><tr><td align="right">  27 </td><td align="left">  Alamat MAC klien </td><td align="right">  14: d6: 4d: a7: c9: 55 </td><td align="center">  Hex </td><td align="right">  6 </td><td align="left">  Alamat MAC dari pengirim paket (klien) </td></tr><tr><td align="right">  31 </td><td align="left">  Padding alamat perangkat keras klien </td><td align="right"></td><td align="center">  Hex </td><td align="right">  10 </td><td align="left">  Tempat yang dipesan.  Biasanya nol </td></tr><tr><td align="right">  41 </td><td align="left">  Nama host server </td><td align="right"></td><td align="center">  Tali </td><td align="right">  64 </td><td align="left">  Nama server DHCP.  Biasanya tidak ditransmisikan </td></tr><tr><td align="right">  105 </td><td align="left">  Nama file boot </td><td align="right"></td><td align="center">  Tali </td><td align="right">  128 </td><td align="left">  Nama file di server yang digunakan oleh stasiun tanpa disk saat boot </td></tr><tr><td align="right">  235 </td><td align="left">  Cookie ajaib </td><td align="right">  63: 82: 53: 63 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Angka "ajaib", dimana termasuk  Anda dapat menentukan bahwa paket ini milik protokol DHCP </td></tr><tr><td colspan="6" align="center">  Opsi DHCP.  Bisa masuk dalam urutan apa pun </td></tr><tr><td align="right">  236 </td><td align="left">  Nomor opsi </td><td align="right">  53 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi 53 menentukan jenis paket DHCP 2 - DHCPOFFER </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  2 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi menawarkan topeng jaringan klien DHCP </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  255.255.224.0 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  3 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi menawarkan gateway default klien DHCP </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  172.16.12.1 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  6 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi yang menawarkan DHCP ke klien DNS </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  8.8.8.8 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  51 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Masa pakai parameter jaringan yang dikeluarkan dalam hitungan detik, setelah itu klien DHCP harus memintanya lagi </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  86400 </td><td align="center">  Desember </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  82 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi 82, ulangi apa yang datang di DHCPDISCOVER </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  18 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01:00: 00: 06: 00 <br>  01: 00: 00: 00: 01 <br>  02: 00: 00: 03: 0f <br>  26: 4d: ec </td><td align="center">  Desember </td><td align="right">  18 </td></tr><tr><td align="left"></td><td align="left">  Paket akhir </td><td align="right">  255 </td><td align="center">  Desember </td><td align="right">  1 </td><td align="left">  255 melambangkan akhir paket </td></tr></tbody></table><br></div></div><br><h3>  DHCPREQUEST </h3><br>  Setelah klien menerima DHCPOFFER, ia membentuk sebuah paket dengan permintaan parameter jaringan tidak untuk semua server DHCP di jaringan, tetapi hanya untuk satu server tertentu, yang proposal DHCPOFFER-nya paling ‚Äúdisukai‚Äù.  Kriteria untuk "suka" bisa berbeda dan tergantung pada implementasi klien DHCP.  Penerima permintaan ditunjukkan menggunakan alamat MAC dari server DHCP.  Juga, paket DHCPREQUEST dapat dikirim oleh klien tanpa membentuk DHCPDISCOVER sebelumnya, jika alamat IP server sebelumnya diterima sebelumnya. <br><br><div class="spoiler">  <b class="spoiler_title">Tabel struktur paket DHCPREQUEST</b> <div class="spoiler_text"><table border="1"><tbody><tr><td align="left">  Posisi Paket </td><td align="left">  Nama nilai (umum) </td><td align="right">  Contoh </td><td align="center">  Kiriman </td><td align="center">  Byte </td><td align="left">  Penjelasan </td></tr><tr><td align="right">  1 </td><td align="left">  Permintaan boot </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis pesan.  1 - permintaan dari klien ke server, 2 - respons dari server ke klien </td></tr><tr><td align="right">  2 </td><td align="left">  Jenis perangkat keras </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis alamat perangkat keras, dalam protokol ini 1 - MAC </td></tr><tr><td align="right">  3 </td><td align="left">  Panjang alamat perangkat keras </td><td align="right">  6 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Panjang Alamat MAC Perangkat </td></tr><tr><td align="right">  4 </td><td align="left">  Hop </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jumlah rute perantara </td></tr><tr><td align="right">  5 </td><td align="left">  ID transaksi </td><td align="right">  23: cf: de: 1d </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Pengidentifikasi Transaksi Unik.  Dihasilkan oleh klien pada awal operasi permintaan </td></tr><tr><td align="right">  7 </td><td align="left">  Kedua berlalu </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Waktu dalam detik sejak dimulainya proses </td></tr><tr><td align="right">  9 </td><td align="left">  Bendera bootp </td><td align="right">  8000 </td><td align="center">  Hex </td><td align="right">  2 </td><td align="left">  Beberapa flag yang dapat diatur sebagai indikasi parameter protokol.  Dalam hal ini, "Siaran" </td></tr><tr><td align="right">  11 </td><td align="left">  Alamat IP klien </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP klien (jika ada) </td></tr><tr><td align="right">  15 </td><td align="left">  Alamat IP klien Anda </td><td align="right">  172.16.134.61 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP yang diajukan oleh server (jika ada) </td></tr><tr><td align="right">  19 </td><td align="left">  Alamat IP server berikutnya </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP server (jika diketahui) </td></tr><tr><td align="right">  23 </td><td align="left">  Relay alamat IP agen </td><td align="right">  172.16.114.41 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Relay alamat IP agen (misalnya, switch) </td></tr><tr><td align="right">  27 </td><td align="left">  Alamat MAC klien </td><td align="right">  14: d6: 4d: a7: c9: 55 </td><td align="center">  Hex </td><td align="right">  6 </td><td align="left">  Alamat MAC dari pengirim paket (klien) </td></tr><tr><td align="right">  31 </td><td align="left">  Padding alamat perangkat keras klien </td><td align="right"></td><td align="center">  Hex </td><td align="right">  10 </td><td align="left">  Tempat yang dipesan.  Biasanya nol </td></tr><tr><td align="right">  41 </td><td align="left">  Nama host server </td><td align="right"></td><td align="center">  Tali </td><td align="right">  64 </td><td align="left">  Nama server DHCP.  Biasanya tidak ditransmisikan </td></tr><tr><td align="right">  105 </td><td align="left">  Nama file boot </td><td align="right"></td><td align="center">  Tali </td><td align="right">  128 </td><td align="left">  Nama file di server yang digunakan oleh stasiun tanpa disk saat boot </td></tr><tr><td align="right">  235 </td><td align="left">  Cookie ajaib </td><td align="right">  63: 82: 53: 63 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Angka "ajaib", dimana termasuk  Anda dapat menentukan bahwa paket ini milik protokol DHCP </td></tr><tr><td colspan="6" align="center">  Opsi DHCP.  Bisa masuk dalam urutan apa pun </td></tr><tr><td align="right">  236 </td><td align="left">  Nomor opsi </td><td align="right">  53 </td><td align="center">  Desember </td><td align="right">  3 </td><td rowspan="3" align="left">  Opsi 53 menentukan jenis paket DHCP 3 - DHCPREQUEST </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  3 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  61 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  ID Klien: 01 (untuk Ehernet) + alamat MAC klien </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  7 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01: 2c: ab: 25: ff: 72: a6 </td><td align="center">  Hex </td><td align="right">  7 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  60 </td><td align="center">  Desember </td><td align="left"></td><td rowspan="3" align="left">  "Pengidentifikasi kelas vendor."  Dalam kasus saya, versi klien DHCP dilaporkan.  Mungkin perangkat lain mengembalikan sesuatu yang lain.  Windows misalnya melaporkan MSFT 5.0 </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  11 </td><td align="center">  Desember </td><td align="left"></td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  udhcp 0.9.8 </td><td align="center">  Tali </td><td align="left"></td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  55 </td><td align="center"></td><td align="right">  1 </td><td rowspan="3" align="left">  Parameter jaringan yang diminta oleh klien.  Komposisi mungkin berbeda <br><br>  01 - Netmask <br>  03 - Gateway <br>  06 - DNS <br>  oc - nama host <br>  0f - nama domain jaringan <br>  1c - alamat permintaan siaran (Siaran) <br>  42 - Nama server TFTP <br>  79 - Rute Statis Tanpa Kelas </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  8 </td><td align="center"></td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01: 03: 06: 0c: 0f: 1c: 42: 79 </td><td align="center"></td><td align="right">  8 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  82 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi 82, ulangi apa yang datang di DHCPDISCOVER </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  18 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01:00: 00: 06: 00 <br>  01: 00: 00: 00: 01 <br>  02: 00: 00: 03: 0f <br>  26: 4d: ec </td><td align="center">  Desember </td><td align="right">  18 </td></tr><tr><td align="left"></td><td align="left">  Paket akhir </td><td align="right">  255 </td><td align="center">  Desember </td><td align="right">  1 </td><td align="left">  255 melambangkan akhir paket </td></tr></tbody></table><br></div></div><br><h3>  DHCPACK </h3><br>  Sebagai konfirmasi fakta bahwa "ya, itu adalah alamat IP Anda, dan saya tidak akan memberikannya kepada orang lain" dari server DHCP, ada paket dalam format DHCPACK dari server ke klien.  Itu sama dengan sisa paket yang dikirim siaran.  Meskipun, dalam kode di bawah ini server DHCP diimplementasikan dalam Python, untuk berjaga-jaga, saya menduplikasi permintaan siaran dengan mengirimkan paket ke IP klien tertentu, jika sudah diketahui.  Selain itu, server DHCP tidak peduli sama sekali apakah paket DHCPACK telah mencapai klien.  Jika klien tidak menerima DHCPACK, maka setelah beberapa saat ia hanya mengulangi DHCPREQUEST <br><br><div class="spoiler">  <b class="spoiler_title">Tabel Struktur Paket DHCPACK</b> <div class="spoiler_text"><table border="1"><tbody><tr><td align="left">  Posisi Paket </td><td align="left">  Nama nilai (umum) </td><td align="right">  Contoh </td><td align="center">  Kiriman </td><td align="center">  Byte </td><td align="left">  Penjelasan </td></tr><tr><td align="right">  1 </td><td align="left">  Permintaan boot </td><td align="right">  2 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis pesan.  1 - permintaan dari klien ke server, 2 - respons dari server ke klien </td></tr><tr><td align="right">  2 </td><td align="left">  Jenis perangkat keras </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jenis alamat perangkat keras, dalam protokol ini 1 - MAC </td></tr><tr><td align="right">  3 </td><td align="left">  Panjang alamat perangkat keras </td><td align="right">  6 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Panjang Alamat MAC Perangkat </td></tr><tr><td align="right">  4 </td><td align="left">  Hop </td><td align="right">  1 </td><td align="center">  Hex </td><td align="right">  1 </td><td align="left">  Jumlah rute perantara </td></tr><tr><td align="right">  5 </td><td align="left">  ID transaksi </td><td align="right">  23: cf: de: 1d </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Pengidentifikasi Transaksi Unik.  Dihasilkan oleh klien pada awal operasi permintaan </td></tr><tr><td align="right">  7 </td><td align="left">  Kedua berlalu </td><td align="right">  0 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Waktu dalam detik sejak awal proses mendapatkan alamat </td></tr><tr><td align="right">  9 </td><td align="left">  Bendera bootp </td><td align="right">  8000 </td><td align="center">  Hex </td><td align="right">  2 </td><td align="left">  Beberapa flag yang dapat diatur sebagai indikasi parameter protokol.  Dalam hal ini, "Siaran" </td></tr><tr><td align="right">  11 </td><td align="left">  Alamat IP klien </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP klien (jika ada) </td></tr><tr><td align="right">  15 </td><td align="left">  Alamat IP klien Anda </td><td align="right">  172.16.134.61 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP yang diajukan oleh server (jika ada) </td></tr><tr><td align="right">  19 </td><td align="left">  Alamat IP server berikutnya </td><td align="right">  0.0.0.0 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Alamat IP server (jika diketahui) </td></tr><tr><td align="right">  23 </td><td align="left">  Relay alamat IP agen </td><td align="right">  172.16.114.41 </td><td align="center">  Tali </td><td align="right">  4 </td><td align="left">  Relay alamat IP agen (misalnya, switch) </td></tr><tr><td align="right">  27 </td><td align="left">  Alamat MAC klien </td><td align="right">  14: d6: 4d: a7: c9: 55 </td><td align="center">  Hex </td><td align="right">  6 </td><td align="left">  Alamat MAC dari pengirim paket (klien) </td></tr><tr><td align="right">  31 </td><td align="left">  Padding alamat perangkat keras klien </td><td align="right"></td><td align="center">  Hex </td><td align="right">  10 </td><td align="left">  Tempat yang dipesan.  Biasanya nol </td></tr><tr><td align="right">  41 </td><td align="left">  Nama host server </td><td align="right"></td><td align="center">  Tali </td><td align="right">  64 </td><td align="left">  Nama server DHCP.  Biasanya tidak ditransmisikan </td></tr><tr><td align="right">  105 </td><td align="left">  Nama file boot </td><td align="right"></td><td align="center">  Tali </td><td align="right">  128 </td><td align="left">  Nama file di server yang digunakan oleh stasiun tanpa disk saat boot </td></tr><tr><td align="right">  235 </td><td align="left">  Cookie ajaib </td><td align="right">  63: 82: 53: 63 </td><td align="center">  Hex </td><td align="right">  4 </td><td align="left">  Angka "ajaib", dimana termasuk  Anda dapat menentukan bahwa paket ini milik protokol DHCP </td></tr><tr><td colspan="6" align="center">  Opsi DHCP.  Bisa masuk dalam urutan apa pun </td></tr><tr><td align="right">  236 </td><td align="left">  Nomor opsi </td><td align="right">  53 </td><td align="center">  Desember </td><td align="right">  3 </td><td rowspan="3" align="left">  Opsi 53 menentukan paket DHCP tipe 5 - DHCPACK </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  5 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  1 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi menawarkan topeng jaringan klien DHCP </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  255.255.224.0 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  3 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi menawarkan gateway default klien DHCP </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  172.16.12.1 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  6 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi yang menawarkan DHCP ke klien DNS </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  8.8.8.8 </td><td align="center">  Tali </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  51 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Masa pakai parameter jaringan yang dikeluarkan dalam hitungan detik, setelah itu klien DHCP harus memintanya lagi </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  4 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  86400 </td><td align="center">  Desember </td><td align="right">  4 </td></tr><tr><td align="left"></td><td align="left">  Nomor opsi </td><td align="right">  82 </td><td align="center">  Desember </td><td align="right">  1 </td><td rowspan="3" align="left">  Opsi 82, ulangi apa yang datang di DHCPDISCOVER </td></tr><tr><td align="left"></td><td align="left">  Panjang opsi </td><td align="right">  18 </td><td align="center">  Desember </td><td align="right">  1 </td></tr><tr><td align="left"></td><td align="left">  Nilai opsi </td><td align="right">  01:00: 00: 06: 00 <br>  01: 00: 00: 00: 01 <br>  02: 00: 00: 03: 0f <br>  26: 4d: ec </td><td align="center">  Desember </td><td align="right">  18 </td></tr><tr><td align="left"></td><td align="left">  Paket akhir </td><td align="right">  255 </td><td align="center">  Desember </td><td align="right">  1 </td><td align="left">  255 melambangkan akhir paket </td></tr></tbody></table><br></div></div><br><br><h1>  Instalasi </h1><br>  Instalasi sebenarnya terdiri dari pemasangan modul python yang diperlukan untuk pekerjaan itu.  Diasumsikan bahwa MySQL sudah diinstal dan dikonfigurasi. <br><br><h2>  Freebsd </h2><br><pre>  pkg instal python3
 python3 -m ensurepip
 pip3 instal mysql-connector </pre><br><h2>  Ubuntu </h2><br><pre>  sudo apt-get install python3
 sudo apt-get install pip3
 sudo pip3 instal mysql-connector </pre><br>  Kami membuat database MySQL, mengisi pydhcp.sql dump, mengkonfigurasi file konfigurasi. <br><br><h1>  Konfigurasi </h1><br>  Semua pengaturan server dalam format file xml.  File referensi: <br><br><pre>  &lt;? xml version = "1.0"?&gt;
 &lt;config&gt;
     &lt;dhcpserver&gt;
	 &lt;host&gt; 0.0.0.0 &lt;/host&gt;
         &lt;broadcast&gt; 255.255.255.255 &lt;/broadcast&gt;
         &lt;DHCPServer&gt; 192.168.0.71 &lt;/DHCPServer&gt;
	 &lt;LeaseTime&gt; 8600 &lt;/LeaseTime&gt;
	 &lt;ThreadLimit&gt; 1 &lt;/ThreadLimit&gt;
         &lt;defaultMask&gt; 255.255.255.0 &lt;/defaultMask&gt;
         &lt;defaultRouter&gt; 192.168.0.1 &lt;/defaultRouter&gt;
         &lt;defaultDNS&gt; 8.8.8.8 &lt;/defaultDNS&gt;
     &lt;/dhcpserver&gt;
     &lt;mysql&gt;
         &lt;host&gt; localhost &lt;/host&gt;
	 &lt;username&gt; test &lt;/username&gt;
	 &lt;password&gt; test &lt;/password&gt;
	 &lt;basename&gt; pydhcp &lt;/basename&gt;
     &lt;/mysql&gt;
     &lt;options&gt;
        &lt;option&gt; option_82_hex: sw_port1: 20:22 &lt;/option&gt;       
        &lt;option&gt; option_82_hex: sw_port2: 16:18 &lt;/option&gt;       
        &lt;option&gt; option_82_hex: sw_mac: 26: 40 &lt;/option&gt;
     &lt;/options&gt;    
     &lt;query&gt;
         &lt;offer_count&gt; 3 &lt;/offer_count&gt;
	 &lt;offer_1&gt; pilih ip, mask, router, dns dari pengguna di mana atas (mac) = atas ('{option_82_AgentRemoteId_hex}') dan atas (port) = atas ('{option_82_AgentCircuitId_port_hex}') &lt;/offer_1&gt;
         &lt;offer_2&gt; pilih ip, mask, router, dns dari pengguna di mana atas (mac) = atas ('{sw_mac}') dan atas (port) = atas ('{sw_port2}') &lt;/offer_2&gt;
         &lt;offer_3&gt; pilih ip, mask, router, dns dari pengguna di mana atas (mac) = atas ('{ClientMacAddress}') &lt;/offer_3&gt;
	 &lt;history_sql&gt; masukkan nilai history (id, dt, mac, ip, comment) (null, now (), '{ClientMacAddress}', '{RequestedIpAddress}', 'DHCPACK / INFORM') &lt;/history_sql&gt;
     &lt;/query&gt;
 &lt;/config&gt; </pre><br>  Sekarang dengan lebih detail pada tag: <br><br>  Bagian dhcpserver menjelaskan pengaturan dasar untuk memulai server, yaitu: <br><ul><li>  host - alamat ip yang didengarkan server pada port 67 </li><li>  broadcast - ip mana yang merupakan Broadcast untuk DHCPOFFER dan DHCPACK </li><li>  DHCPServer - apa ip dari server DHCP </li><li>  Waktu sewa LeaseTime dari alamat ip yang dikeluarkan </li><li>  ThreadLimit - berapa banyak utas yang secara bersamaan berjalan untuk memproses paket UDP yang masuk pada port 67. Diasumsikan bahwa ini akan membantu proyek yang sangat dimuat;) </li><li>  defaultMask, defaultRouter, defaultDNS - apa yang ditawarkan kepada pelanggan secara default jika IP ditemukan dalam database, tetapi tidak ada parameter tambahan yang ditentukan untuknya </li></ul><br>  Bagian Mysql: <br><br>  host, nama pengguna, kata sandi, nama kecil - semuanya berbicara sendiri.  Contoh struktur basis data yang diposting di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> <br><br>  Bagian Permintaan: Bagian ini menjelaskan permintaan untuk PENAWARAN / ACK: <br><br><ul><li>  offer_count - jumlah baris dengan permintaan yang mengembalikan hasil dari form ip, mask, router, dns </li><li>  offer_n adalah string kueri.  Jika pengembalian kosong, maka permintaan penawaran berikut dijalankan </li><li>  history_sql - permintaan penulisan, misalnya, ke "riwayat otorisasi" oleh pelanggan </li></ul><br>  Setiap variabel dari bagian opsi atau opsi dari protokol DHCP dapat berpartisipasi dalam permintaan. <br><br>  Opsi bagian.  Ini dia sudah lebih menarik.  Di sini kita bisa membuat variabel yang bisa kita gunakan nanti di bagian permintaan. <br><br>  Sebagai contoh: <br><br><pre><code class="plaintext hljs">option_82_hex:sw_port1:20:22</code> </pre> <br>  , baris ini adalah perintah untuk mengambil seluruh baris yang datang dalam permintaan DHCP dari opsi 82, dalam format hex, dalam kisaran dari 20 hingga 22 byte, termasuk dan memasukkannya ke dalam variabel baru sw_port1 (port switch tempat permintaan itu berasal) <br><br><pre> <code class="plaintext hljs">option_82_hex:sw_mac:26:40</code> </pre> <br>  , tentukan variabel sw_mac, ambil hex dari kisaran 26:40 <br><br>  Anda bisa melihat semua opsi yang memungkinkan yang bisa digunakan dalam kueri dengan memulai server dengan saklar -d.  Kami akan melihat sesuatu seperti log ini: <br><br><pre>  - paket DHCPINFORM datang pada port 67, dari 0025224ad764, b '\ x91 \ xa5 \ xe0 \ xa3 \ xa5 \ xa9- \ x8f \ x8a', ('172.30.114.25', 68)
 {'ClientMacAddress': '0025224ad764',
  'ClientMacAddressByte': b '\ x00% "J \ xd7d',
  'HType': 'Ethernet',
  'HostName': b '\ x91 \ xa5 \ xe0 \ xa3 \ xa5 \ xa9- \ x8f \ x8a',
  'ReqListDNS': Benar,
  'ReqListDomainName': Benar,
  'ReqListPerfowmRouterDiscover': Benar,
  'ReqListRouter': Benar,
  'ReqListStaticRoute': Benar,
  'ReqListSubnetMask': Benar,
  'ReqListVendorSpecInfo': 43,
  'RequestedIpAddress': '0.0.0.0',
  'Vendor': b'MSFT 5.0 ',
  'chaddr': '0025224ad764',
  'ciaddr': '172.30.128.13',
  'flags': b '\ x00 \ x00',
  'giaddr': '172.30.114.25',
  'gpoz': 308,
  'hlen': 6,
  'hop': 1,
  'htype': 'MAC',
  'magic_cookie': b'c \ x82Sc ',
  'op': 'DHCPINFORM',
  'option12': 12,
  'option53': 53,
  'option55': 55,
  'option60': 60,
  'option61': 61,
  'option82': 82,
  'option_82_byte': b '\ x12 \ x01 \ x06 \ x00 \ x04 \ x00 \ x01 \ x00 \ x06 \ x02 \ x08 \ x00'
                    b '\ x06 \ x00 \ x1eX \ x9e \ xb2 \ xad',
  'option_82_hex': '12010600040001000602080006001e589eb2ad',
  'option_82_len': 18,
  'option_82_str': "b '\\ x12 \\ x01 \\ x06 \\ x00 \\ x04 \\ x00 \\ x01 \\ x00 \\ x06 \\ x02 \\ x08 \\ x00 \\ x06 \\ x00 \ \ x1eX \\ x9e \\ xb2 \\ xad '",
  'hasil': Salah,
  'dtk': 768,
  'siaddr': '0.0.0.0',
  'sw_mac': '001e589eb2ad',
  'sw_port1': '06',
  'xidbyte': b '&lt;\ x89} \ x8c',
  'xidhex': '3c897d8c',
  'yiaddr': '0.0.0.0'} </pre><br>  Karenanya, kita dapat membungkus variabel apa pun dalam {} dan itu akan digunakan dalam kueri SQL. <br><br>  Mari kita tinjau riwayat bahwa klien menerima alamat IP: <br><br><img src="https://habrastorage.org/webt/mc/le/bu/mclebuj5du2u4mjtlaf9-a2ibo0.png"><br><br><img src="https://habrastorage.org/webt/eo/1q/lt/eo1qltnt_1ewtf0uwkenwywme3m.png"><br><br><h1>  Server mulai </h1><br>  ./pydhcpdb.py -d -c config.xml <br><br>  - Mode keluaran d ke konsol DEBUG <br>  - file konfigurasi c &lt;file_name&gt; <br><br><h1>  Tanya jawab </h1><br>  Dan sekarang lebih pada implementasi server dengan Python.  Ini menyakitkan.  Python dipelajari dengan cepat.  Banyak momen dibuat dengan gaya: "wow, aku entah bagaimana melakukan apa yang berhasil."  Tidak dioptimalkan sama sekali, dan dibiarkan dalam bentuk ini terutama karena pengalaman kecil pengembangan python.  Saya akan mengingat saat-saat paling menarik dari implementasi server dalam "kode". <br><br><h2>  Pengurai file konfigurasi XML </h2><br>  Modul Python standar xml.dom digunakan.  Tampaknya sederhana, tetapi selama implementasi ada kurangnya dokumentasi dan contoh yang masuk akal di jaringan menggunakan modul ini. <br><br><pre>  tree = minidom.parse (gconfig ["config_file"])
     mconfig = tree.getElementsByTagName ("mysql")
     untuk elem di mconfig:        
         gconfig ["mysql_host"] = elem.getElementsByTagName ("host") [0] .firstChild.data      
         gconfig ["mysql_username"] = elem.getElementsByTagName ("username") [0] .firstChild.data      
         gconfig ["mysql_password"] = elem.getElementsByTagName ("password") [0] .firstChild.data      
         gconfig ["mysql_basename"] = elem.getElementsByTagName ("basename") [0] .firstChild.data      
     dconfig = tree.getElementsByTagName ("dhcpserver")
     untuk elem di dconfig:        
         gconfig ["broadcast"] = elem.getElementsByTagName ("broadcast") [0] .firstChild.data      
         gconfig ["dhcp_host"] = elem.getElementsByTagName ("host") [0] .firstChild.data      
         gconfig ["dhcp_LeaseTime"] = elem.getElementsByTagName ("LeaseTime") [0] .firstChild.data      
         gconfig ["dhcp_ThreadLimit"] = int (elem.getElementsByTagName ("ThreadLimit") [0] .firstChild.data)              
         gconfig ["dhcp_Server"] = elem.getElementsByTagName ("DHCPServer") [0] .firstChild.data              
         gconfig ["dhcp_defaultMask"] = elem.getElementsByTagName ("defaultMask") [0] .firstChild.data              
         gconfig ["dhcp_defaultRouter"] = elem.getElementsByTagName ("defaultRouter") [0] .firstChild.data              
         gconfig ["dhcp_defaultDNS"] = elem.getElementsByTagName ("defaultDNS") [0] .firstChild.data              
     qconfig = tree.getElementsByTagName ("permintaan")
     untuk elem di qconfig:  
         gconfig ["offer_count"] = elem.getElementsByTagName ("offer_count") [0] .firstChild.data                          
         untuk num dalam kisaran (int (gconfig ["offer_count"])):
             gconfig ["offer _" + str (num + 1)] = elem.getElementsByTagName ("offer _" + str (num + 1)) [0] .firstChild.data      
         gconfig ["history_sql"] = elem.getElementsByTagName ("history_sql") [0] .firstChild.data                          
     options = tree.getElementsByTagName ("options")       
     untuk opsi elem:          
         simpul = elem.getElementsByTagName ("option")
         untuk opsi di simpul:
             optionsMod.append (options.firstChild.data) </pre><br><h2>  Multithreading </h2><br>  Anehnya, multithreading dengan Python diimplementasikan dengan sangat jelas dan sederhana. <br><br><pre>  def PacketWork (data, addr): 
 ...
 # Implementasi analisis paket yang diterima, dan jawabannya
 ...


 sementara Benar:
     data, addr = udp_socket.recvfrom (1024) # tunggu paket UDP
     utas = threading.Thread (target = PacketWork, args = (data, addr,)). start () # ketika datang - jalankan fungsi PacketWork yang ditentukan sebelumnya di latar belakang dengan parameter
     saat threading.active_count ()&gt; gconfig ["dhcp_ThreadLimit"]:
        time.sleep (1) # jika jumlah utas yang sudah berjalan lebih besar dari pada pengaturan, tunggu sampai menjadi kurang </pre><br><br><h2>  Terima / kirim paket DHCP </h2><br>  Untuk mencegat paket UDP yang datang melalui kartu jaringan, Anda perlu "menaikkan" soket: <br><pre>  udp_socket = socket.socket (socket.AF_INET, socket.SOCK_DGRAM, socket.IPPROTO_UDP)
 udp_socket.bind ((gconfig ["dhcp_host"], 67)) </pre><br>  di mana bendera berada: <br><br><ul><li>  AF_INET - artinya format alamat adalah IP: port.  Mungkin AF_UNIX - di mana alamatnya diberikan oleh nama file. </li><li>  SOCK_DGRAM - berarti kami menerima bukan "paket mentah", tetapi sudah melewati firewall, dan dengan paket yang terpotong sebagian.  Yaitu  kita hanya mendapatkan paket UDP tanpa komponen "fisik" dari bungkus paket UDP.  Jika Anda menggunakan bendera SOCK_RAW, Anda masih harus mengurai "pembungkus" ini juga. </li></ul><br>  Mengirim paket bisa seperti Siaran: <br><br><pre>  udp_socket.setsockopt (socket.SOL_SOCKET, socket.SO_BROADCAST, 1) # alihkan soket ke mode Broadcast
                     rz = udp_socket.sendto (packetack, (gconfig ["broadcast"], 68)) </pre><br>  , dan ke alamat, "dari mana paket itu berasal": <br><pre>  udp_socket.setsockopt (socket.SOL_SOCKET, socket.SO_REUSEADDR, 1) # alihkan soket ke mode "banyak pendengar"
                         rz = udp_socket.sendto (paket, addr) </pre><br>  di mana SOL_SOCKET berarti "tingkat protokol" untuk opsi pengaturan, <br><br>  Opsi SO_BROADCAST adalah paket helm Siaran <br><br>  Opsi SO_REUSEADDR mengalihkan soket ke mode multi-pendengar.  Secara teori, tidak perlu dalam kasus ini, tetapi pada salah satu server FreeBSD yang saya uji, kode tidak berfungsi tanpa opsi ini. <br><br><h2>  Penguraian paket DHCP </h2><br>  Di sinilah saya sangat menyukai Python.  Ternyata dari "kotak" itu memungkinkan Anda untuk dengan mudah menangani bytecode.  Mengizinkannya menjadi sangat sederhana untuk diterjemahkan ke nilai desimal, string, dan hex - yaitu.  apa yang sebenarnya kita butuhkan untuk memahami struktur paket.  Jadi misalnya, Anda bisa mendapatkan rentang byte dalam HEX dan hanya byte: <br><br><pre>  res ["xidhex"] = data [4: 8] .hex ()
     res ["xidbyte"] = data [4: 8] </pre><br>  , kemas byte ke dalam struktur: <br><br><pre>  res ["flags"] = pak ('BB', data [10], data [11]) </pre><br>  Dapatkan IP dari struktur: <br><br><pre>  res ["ciaddr"] = socket.inet_ntoa (paket ('BBBB', data [12], data [13], data [14], data [15])); </pre><br><br>  Dan sebaliknya: <br><br><pre>  res = res + socket.inet_pton (socket.AF_INET, gconfig ["dhcp_Server"]) </pre><br>  Itu saja;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id445338/">https://habr.com/ru/post/id445338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id445326/index.html">Otomatisasi kejam. Cut Direktur</a></li>
<li><a href="../id445328/index.html">Memikirkan Kembali Robotika Anak</a></li>
<li><a href="../id445330/index.html">Kriptografi di Jawa. Kelas tanda tangan</a></li>
<li><a href="../id445334/index.html">Kami memiliki DevOps. Mari kita memecat semua penguji</a></li>
<li><a href="../id445336/index.html">FlexiRemap¬Æ vs RAID</a></li>
<li><a href="../id445340/index.html">Tingkatkan keamanan jaringan dengan menggunakan cloud analyzer</a></li>
<li><a href="../id445344/index.html">OpenVox Unified Communications Platform</a></li>
<li><a href="../id445346/index.html">Cara menulis API yang buruk</a></li>
<li><a href="../id445348/index.html">SNA Hackathon 2019: Menyederhanakan Arsitektur - Menyederhanakan Fitur</a></li>
<li><a href="../id445350/index.html">Sonata - server penyedia SIP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>