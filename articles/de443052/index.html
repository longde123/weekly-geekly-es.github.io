<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🔧 🍄 👨🏽‍⚕️ Schöne genaue Uhr von einem alten Smartphone 🤚🏿 👩🏾 🤰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Artikel konzentriert sich darauf, wie man ein altes unnötiges Mobiltelefon in exzellenten Wanduhren mit großen Zahlen, immer genauer Zeit und Nots...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schöne genaue Uhr von einem alten Smartphone</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443052/"><img src="https://habrastorage.org/webt/v3/zb/xe/v3zbxe4oreekk9jb1bdtkraqdcu.jpeg"><br><br>  Der Artikel konzentriert sich darauf, wie man ein altes unnötiges Mobiltelefon in exzellenten Wanduhren mit großen Zahlen, immer genauer Zeit und Notstromversorgung neu herstellt. <br><br>  Ich werde über einige der geklärten Funktionen der Zeitsynchronisation im Android-Betriebssystem sowie über verschiedene elektrische Tricks im Stromversorgungssystem des Smartphones sprechen.  Ich werde ein Beispiel für eine Schaltung mit einfachen analogen Komponenten beschreiben, die eine automatische Notstromversorgung bereitstellt.  Und natürlich werden wir über den Software-Teil von Android sprechen - wie und mit welcher Hilfe Sie eine schöne Uhr für jeden Geschmack von Ihrem Smartphone aus erstellen können. <br><a name="habracut"></a><br>  ( <i>traditioneller Haftungsausschluss - alle genannten Marken, Marken usw. sind keine Werbung, ich hoffe, dies ist klar.</i> ) <br><br><h4>  Das zweite Leben eines alten Smartphones </h4><br>  Mein alter Philips Xenium W732 lag lange im Leerlauf.  Voll funktionsfähig, mit Vollbild.  Ich beschloss, ihm ein zweites Leben zu geben - mich in eine Wanduhr zu verwandeln.  Meine alte Hausuhr, immer noch sowjetisch, mit flackernden kleinen Zahlen, war aus ein paar Metern Entfernung sehr schwer zu sehen.  Außerdem blieben sie furchtbar zurück, sie mussten hin und wieder enttäuscht werden, mit jedem Stromausfall im Haus wurden sie vollständig zunichte gemacht und erforderten ein mühsames Verfahren, Knöpfe zu drücken und die Zeit erneut einzustellen.  All dies hatte ich lange Zeit satt und ich beschloss, aus dem alten Mobiltelefon eine gute „intelligente“ Uhr zu machen, ohne all diese Mängel. <br><br><h4>  Was ich brauchte </h4><br><ol><li>  Große klare Zahlen jeder gewünschten Farbe, Schriftart und Helligkeit. </li><li>  Maximale Genauigkeit und Stabilität ohne mein Eingreifen von außen. </li><li>  Nichtflüchtigkeit, d.h.  Die Uhr sollte bei vorübergehenden Stromausfällen weiter funktionieren. </li><li>  Völlig autonome Arbeit im Sinne von - ohne Verwendung von kostenpflichtigen Datennetzen, SIM-Karten, Betreibern usw. </li><li>  Maximale Einhaltung des Prinzips „gemacht, eingeschaltet und vergessen“.  Das heißt, ein Gerät sollte niemals eine Wartung oder eine andere Art von Interaktion erfordern. </li></ol><br><h4>  Wir bieten Android genaue Zeit. </h4><br>  Das erste, was Sie tun mussten, war, eine konstant genaue Weltzeit auf Ihrem Smartphone zu erhalten.  Das Konzept "genau" passt für mich in 1 ... 2 Sekunden Abweichung von der Welt. <br><br>  Es ist klar, dass der eigene System-Timer des Mobiltelefons keine solche Stabilität bietet, er wird von ihm nicht benötigt.  Daher kann eine garantierte Einhaltung der Weltzeit nur durch regelmäßige externe Synchronisation erreicht werden. <br><br>  Im einfachsten Fall in Android kann es mit der "Netzwerk" -Methode konfiguriert werden.  Darüber hinaus wird auch ein Mobilfunknetz mit unvermeidlichen SIM-Karten und Tarifzahlungen nicht benötigt.  Es reicht aus, WLAN zu Hause auf das Smartphone zu verteilen und den Router so zu konfigurieren, dass die Zeit vom Internetprovider oder NTP-Server synchronisiert wird. <br><br>  Es gibt jedoch eine zweite Methode zur Synchronisation - für GPS-Satelliten, die ich persönlich für besser halte. <br><br>  Von den Profis - Sie können überall auf der Welt synchronisieren, wo der Himmel sichtbar ist.  Absolute Zeitgenauigkeit, da GPS selbst darauf basiert.  Das Fehlen zusätzlicher zusätzlicher Funkkanäle und Emissionen. <br><br>  Von den Mängeln des GPS sollte das Gerät mindestens einen kleinen offenen Himmel sehen.  Höchstwahrscheinlich wird nichts an einer beliebigen Stelle im hinteren Teil des Raums gefangen, insbesondere wenn das Gerät einen alten und unempfindlichen Chip hat.  Und da sich meine Uhr genau vom Fenster entfernt befand, brauchte ich eine entfernte GPS-Antenne ... <br><br><h4>  Die einfachste externe Antenne für den GPS-Empfang </h4><br>  Im Internet stellte sich heraus, dass bei diesem Thema alles ziemlich eng war.  Mir wurde sofort klar, dass ich eine solche Antenne nicht selbst herstellen konnte - so wurden überall aufwändige, sperrige Designs mit einigen komplizierten, komplizierten Berechnungen angeboten.  Ich habe versucht, einen Kauf zu finden - mir hat auch nicht alles gefallen.  Einige sind alle groß, umständlich, erfordern externe Stromversorgung, verfügen über eine Reihe unnötiger Funktionen und sind gleichzeitig unzureichend teuer. <br><br>  Die Lösung wurde zufällig gefunden - ich sah irgendwie eine Beschreibung einer Antenne vom Typ "Halbwellendipol".  In seiner einfachsten Form ist es einfach ein gerades Stück Draht mit einer Länge, die der halben Wellenlänge des gewünschten Signals entspricht.  Diese „Komplexität“ der Konstruktion war für mich sehr gut geeignet, deshalb habe ich gerade das erste Koaxialkabel mit beliebiger Wellenimpedanz genommen und es vorsichtig mit den entsprechenden Kontakten der GPS-Patchantenne auf das Smartphone gelötet. <br><br><div class="spoiler">  <b class="spoiler_title">Foto der Kontakte der GPS-Antenne auf der W732-Karte</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/nn/em/ci/nnemci1spx4laynkv4kd_fe_syy.jpeg"><br>  <i>Das Geflecht und der zentrale Kern des Koaxials sind mit diesen Kontakten verlötet</i> <br></div></div><br>  Ich habe gerade das andere Ende des Kabels vom Bildschirmgeflecht befreit, so dass ein zentraler Kern von 95 mm Länge übrig blieb - dies ist die Hälfte der Wellenlänge bei der L1-Frequenz des Standard-GPS-Signals (1575,42 MHz). <br><br><div class="spoiler">  <b class="spoiler_title">Die einfachste GPS-Antenne.</b>  <b class="spoiler_title">Halbwellendipol</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/as/a2/yk/asa2yk0mwvmd034n7maxcwsexkq.jpeg"><br>  <i>Diese Antenne sollte so nah wie möglich am Fenster platziert werden.</i> <i><br></i>  <i>Ich habe es mit Klebeband auf das Glas geklebt.</i> <i><br></i> </div></div><br>  Das Telefon nahm es vom Fenster weg, und andererseits brachte das 95 mm abisolierte Ende des Kabels es zum Fenster, damit es mehr vom Himmel sehen konnte. <br><br>  Und so - Philips hat bald seine ehrlichen 5 ... 7 Satelliten gefangen und repariert!  Die Antenne funktioniert! <br><br>  Und ich war immer noch besorgt über die Koordination der Wellenimpedanzen von Kabel, Antenne und Empfänger, die angeblich in solchen Fällen notwendig war, mit denen ich im Internet in Antennenforen mit Gehirnen bestäubt wurde.  Später fand ich heraus, dass eine solche Koordination der Widerstände notwendig ist, um einfach den maximalen Wirkungsgrad der Übertragungsleitung zu erreichen (fehlende Endreflexionen und übermäßige Dämpfung).  Und wenn die Leitung wie meine nur 2 ... 3 Meter lang ist und die Aufgabe darin besteht, einfach mindestens einen Teil des Signals an den Empfänger zu liefern, sollten Sie überhaupt nicht über diese Koordination nachdenken - alles funktioniert mit jedem Koaxialkabel. <br><br><h4>  Funktionen des GPS-Synchronisationsprozesses </h4><br>  Nachdem ich ein funktionierendes GPS erhalten habe, habe ich natürlich sofort die Zeitsynchronisationsmethode "auf GPS-Satelliten" in den Android-Einstellungen eingestellt und das Telefon zur Überprüfung in diesem Zustand belassen.  Was war meine Überraschung, als sich einige Stunden später die Zeit am Telefon erheblich von der Steueruhr auf dem Computer "trennte" (wo Windows ntp-synchronisiert ist).  Ich begann den Grund herauszufinden ... Es stellte sich heraus, dass der Android, der für die Synchronisation der Zeit über GPS konfiguriert ist, diese Synchronisation tatsächlich nur <i>einmal durchführt - zum Zeitpunkt der Festlegung der Koordinaten</i> . <br>  Und obwohl das Smartphone weiterhin kontinuierlich Satelliten überwacht, wird seine Systemzeit immer noch nur vom internen Generator bestimmt, dh es findet überhaupt keine Synchronisation statt!  Zumindest in meinem Philips Android 4.0.3 passiert alles so. <br><br>  Für mich war es eine unangenehme Überraschung.  Ich werde das GPS nicht immer manuell ziehen, um die genaue Zeit zu aktualisieren ... <br><br>  Die Lösung wurde Software gefunden.  Ich verwende das Locus-Programm der Asamm-Software für die Navigation, bei dem es möglich ist, nicht die konstante GPS-Wartung im aktiven Zustand zu konfigurieren, sondern regelmäßige einmalige Koordinatenkorrekturen in bestimmten Intervallen, genau das, was ich brauchte.  Ich habe das Intervall auf 15 Minuten eingestellt und das Problem ist sicher verschwunden - die Zeit im Handy stimmt seitdem immer klar mit der Welt überein!  15 Minuten lang sammelt der System-Timer eines normalen Smartphones keinen Zeitfehler von mehr als 1 ... 2 Sekunden, was perfekt zu mir passt.  Wenn Sie möchten, können Sie bei heißem Wetter mindestens alle zehn Sekunden reparieren. <br><br><h4>  Catering für ein stationäres Smartphone </h4><br>  Nachdem die genaue Zeit angegeben worden war, war es an der Zeit, eine kompetente Diät für meine Uhr zu machen. <br><br>  Wie bereits erwähnt, musste die Uhr bei kurzfristigen Stromausfällen im Haus nicht ausgeschaltet und nicht auf Null gestellt werden, was zwar selten, aber dennoch der Fall ist. <br><br>  Die erste, ungeschickteste Lösung besteht darin, das Smartphone dumm an eine Steckdose anzuschließen und so zu belassen.  Gleichzeitig ist das Problem der Stromausfälle perfekt gelöst - das Mobiltelefon wechselt einfach zu einem Akku, der immer voll aufgeladen und einsatzbereit ist.  Kaum gesagt als getan.  Verbunden ... Eine Woche verging, die zweite - ich begann mich bereits zu freuen ... Und am dritten, an einem schönen Tag, klatschte es, und die Batterie flog freudig aus dem Telefon in die Mitte des Raumes, aufgeblasen durch inneren Druck auf den Zustand des Balls. <br><br><div class="spoiler">  <b class="spoiler_title">Phillips Standardbatterie</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/p7/e6/oj/p7e6ojfzrl_xu9egovxblz_l6mi.jpeg"><br>  <i>Dies ist sein normaler Zustand.</i>  <i>Flach und hart ...</i> <i><br></i> </div></div><br>  Wie Sie wissen, hatte ich sogar das Glück, dass die Nähte des Batteriegehäuses nicht standhalten konnten und nicht geöffnet worden wären, sonst hätte ich ein Lithiumfeuer, Rauch, Gestank und verdorbenes Linoleum vermeiden können. <br><br>  Es gibt nur eine Schlussfolgerung: Sie können <i>ein Smartphone nicht monatelang und jahrelang mit konstanter Ladung verwenden</i> .  Das Telefon hat in einem solchen Szenario nicht verbessert.  Die Hauptaufgabe besteht darin, den Akku korrekt auf das Maximum aufzuladen, ohne dass Spannung und Temperatur überschritten werden.  Und dann soll die Entladung noch sein.  Wenn das Gerät niemals von der Wandsteckdose getrennt wird, beginnt der Controller normalerweise mit der Einhaltung eines Sägezahn-Ladeplans - zuerst bis zu 100% einstellen, dann den Strom abschalten und auf eine Entladung von etwa 90 Prozent warten. Und wieder auf 100% tanken.  Und das ist ein noch mehr oder weniger fürsorglicher Ansatz.  Und viele alte Telefone können einfach dumm immer die maximale Spannung am Akku halten. <br><br>  Es ist bekannt, dass je höher die Spannung an einer Lithium-Ionen-Zelle ist, desto schneller altert und verschlechtert sie.  Einige Smartphones füllen ihre Batterien im Allgemeinen sogar über 4,2 V, um die Batterielebensdauer zu maximieren.  Es gibt jedoch nur ein Ergebnis: Wenn die Batterie ständig auf maximaler Spannung steht, verschlechtert sie sich viel schneller.  Wenn es auch alt ist, ist es nicht weit von der allmählichen Entwicklung mikroskopischer interner Schaltkreise, thermischer Beschleunigung und Explosion entfernt, wie es mir passiert ist. <br><br>  Nach dem Vorfall mit der explodierten Batterie dachte ich: Wie kann ich gleichzeitig Notstrom haben und verhindern, dass die Batterie ständig unter voller Spannung steht? <br><br>  Ich habe viele verschiedene Szenarien durchlaufen und mich schließlich für Folgendes entschieden. <br><br>  Im normalen Modus wird das Telefon immer über eine Steckdose mit Strom versorgt, dh 5 V über einen USB-Anschluss. <br><br>  Mit einem einfachen zusätzlichen Stromkreis wird die Pufferbatterie automatisch und gleichzeitig auf ihr normales Maximum von 4,2 V aufgeladen. Danach wird sie <i>vollständig von der Ladung getrennt</i> .  Außerdem wird der Akku durch Selbstentladung einfach leise entladen und nirgendwo angeschlossen.  In diesem Fall überwacht die Schaltung ständig ihre Spannung und schaltet die Einzelladung nur dann wieder auf 4,2 ein, wenn die Zellenspannung unter ein bestimmtes vorbestimmtes Minimum fällt (ich habe 3,6 V genommen).  Und so weiter ist alles vollautomatisch.  Die Echtzeit zwischen diesen Aufladungen beträgt Jahre, in denen sich die Batterie langsam selbst entlädt, aber dennoch durchaus in der Lage ist, die Last jederzeit zu versorgen, auch wenn sie nicht über ihre volle Kapazität verfügt. <br><br>  Bei einem Stromausfall aus der Steckdose sollte der Akku sofort automatisch an das Smartphone angeschlossen werden (wie bei unterbrechungsfreien Stromversorgungen). Danach arbeitet das System autonom weiter, bis die Stromversorgung wiederhergestellt ist oder der Akku vollständig entladen (und ausgeschaltet) ist. <br><br>  Bei diesem Ansatz wird die Lithiumzelle in einem sparsameren Modus betrieben, als wenn die maximale Spannung konstant an ihr gehalten wird.  Und es wird bestimmt nicht explodieren! <br><br><h4>  Elektrische Tricks für Smartphones </h4><br>  Nun zur Implementierung all dieser Schaltkreise. <br><br>  Die Sache hier wird durch die Tatsache kompliziert, dass es im Smartphone nicht so einfach war, sich im Stromnetz zu organisieren. <br><br>  Ohne Akku lässt sich das Telefon beispielsweise nicht einschalten, selbst wenn 5 V über USB anliegen. <br><br>  Wenn Sie den Akku während der Verwendung von USB entfernen, wird auch sofort alles leer.  Obwohl die Stromversorgung offensichtlich gleichzeitig nur über den USB-Anschluss erfolgt! <br><br>  Zunächst gab es ein Problem mit dem dritten Kontakt der Batterie.  Ich wollte nicht an einen normalen Philips Akku gebunden sein und wollte herausfinden, was passiert, wenn ich das dritte Kontaktterminal überhaupt nicht angeschlossen lasse?  Es stellte sich heraus, dass sich das Smartphone nicht gleichzeitig einschalten ließ ... Ich begann sogar zu befürchten, dass ein hochentwickelter digitaler Bus wie i2c nicht nur verschiedene technische Telemetrie, sondern auch alle Arten von Werkscodes im "Freund oder Feind" -Stil an das Telefon überträgt.  Dies würde bedeuten, dass ich für immer an meinen nativen Philips-Akku gebunden war, da ich definitiv nicht vorhatte, hier irgendwelche täuschenden digitalen Schnittstellen einzurichten (ich erinnere mich, dass ich eine ähnliche Überraschung hatte, als ich mit Camcorder-Akkus eines weltberühmten und angesehenen japanischen Unternehmens arbeitete). <br><br>  Ich schaute auf das Oszilloskop, was beim dritten Kontakt geschah.  Zum Glück erwies sich der Philips W732 als sehr einfach!  Es zeigt die übliche konstante Spannung vom internen Batterietemperatursensor an.  Der Eingang des dritten Kontakts im Smartphone ist hochohmig. <br><br>  Ich baute einen einfachen Tuning-Teiler zusammen und legte verschiedene Spannungen an den mittleren Kontakt an. Ich nahm mehrere Punkte der Abhängigkeit der vom Android angezeigten Batterietemperatur von der Spannung am dritten Kontakt. <br><br><div class="spoiler">  <b class="spoiler_title">Diagramm der angezeigten Batterietemperatur auf der Spannung des 3. Kontakts</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dc/-g/gd/dc-ggdncroj-gfw1mrxyiltj530.png"><br></div></div><br>  Es stellte sich heraus, dass bei einer dritten Spannung von weniger als 153 mV Vollbildwarnungen vor Überhitzung des Akkus ausgelöst werden und das Telefon nach einigen Sekunden normal ausgeschaltet wird.  Bei Spannungen über 630 mV beginnt der Android zu glauben, dass sein Akku auf Minustemperatur gefroren ist, aber weiterhin funktioniert (und sogar lautlos!).  Ich musste nicht mehr experimentieren - ich habe gerade festgestellt, dass es elementar ist, den dritten Kontakt zu täuschen - legen Sie dort einfach ein Potential zwischen 155 und 600 mV an. <br><br>  Als Ergebnis habe ich Form 2 Kriterien angenommen, ohne die das Smartphone überhaupt nicht funktioniert: <br><br>  <b>1.</b> Obligatorische Spannung am Pluspol der Batterie (trotz der Tatsache, dass das System über einen USB-Anschluss mit Strom versorgt wird) <br><br>  Und dies sollte keine gefälschte potenzielle Täuschung sein, nur damit das Telefon denkt, dass ein Akku eingelegt ist.  Es erfordert eine <i>vollwertige niederohmige</i> Spannungsquelle mit einem Strom von mindestens dem Betriebsstrom des Smartphones. <br><br>  <b>2.</b> Das Vorhandensein einer konstanten Spannung am dritten Kontakt des Akkus im Bereich von 155 ... 600 mV.  Es gibt bereits genug einfache High-Potential-Potential-Blende. <br><br><hr><br>  Übrigens verstehe ich immer noch nicht, warum der Android eine so hohe Abschaltschwelle (3,4 V) hat, während eine Standard-Lithiumzelle leicht bis zu 3 und sogar 2,8 V entladen kann!  Das einzige, was mir in den Sinn kommt, ist die Präsenz interner Verbraucher mit 3,3 V in Smartphones, die eine Stromversorgung für ihre Buck-Konverter benötigen.  Aber Sie können SEPIC einsetzen und den Akku besser nutzen!  Oder denkt in der Moderne niemand darüber nach? <br><hr><br>  Als nächstes musste ein einfaches Hilfsschema entwickelt werden, das all dies überwacht und automatisch steuert.  Ich entschied sofort, dass ich keine Mikrocontroller verwenden würde, obwohl ich mit ihnen arbeiten kann.  In diesem Fall musste man nur ein wenig nachdenken, alles gründlich optimieren und alle Funktionen wurden auf einfachen analogen Komponenten implementiert.  Alles funktioniert und friert nie ein. <br><br>  Der Backup-Clock-Akku muss regelmäßig von etwas aufgeladen werden.  Zuerst habe ich mich entschieden, dies direkt über den Akku plus des Smartphones zu tun, weil ich naiv geglaubt habe, dass es ehrliche und unveränderliche 4,2 V hat.  Mit Hilfe eines Oszilloskops schaute ich mir an, was dort wirklich vor sich ging.  Es stellte sich heraus, dass es nicht nach konstanten Niveaus riecht! <br><br>  Erstens, wenn nichts an den Pluspol der Batterie angeschlossen ist, schläft der Laderegler immer noch nicht und „prüft“ ihn regelmäßig mit Überprüfungen. <br><br><div class="spoiler">  <b class="spoiler_title">Spannungsverlauf am Pluspol der Batterie</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bi/hc/kq/bihckq8fd_wy5kabjuultdy7oai.png"><br>  ( <i>Rekonstruktion einer realen Wellenform</i> ) <br></div></div><br>  Sie sehen - nach etwa allen 45 Millisekunden gibt das Telefon eine Leiter aus aufeinanderfolgenden "Abtastungen" - erschien die externe Spannung am Batteriekontakt?  Und zwischen diesen Überprüfungen wird ein bestimmter konstanter Pegel von 4,05 V gehalten. <br><br>  Wenn Sie den Akku anschließen, erkennt das System ihn und beginnt dort regelmäßig mit dem Auffüllen des Stroms.  Aber auch hier nicht ständig, sondern in Zeiträumen von 10 Sekunden.  Nach jeder dieser 10 Sekunden des Ladevorgangs enthält das Smartphone für 2 Sekunden einen vollen <i>Rückstrom</i> , d.h.  Es nimmt Strom von der Batterie und mit anständiger Leistung (ich habe nicht die genauen numerischen Werte aller dieser Parameter gemessen, ich war an dem Prinzip interessiert).  Während dieser kurzfristigen Stromabtastung misst das Smartphone die Akkuladung unter Last und erhält so ehrliche Zahlen in Prozent und Spannung.  Es war deutlich zu erkennen, wie genau nach dieser Umkehrung im Android die Werte aller Batterieparameter aktualisiert werden. <br><br>  All dieser knifflige Lademechanismus passte überhaupt nicht zu mir und störte mich sogar, weil ich beabsichtigte, die Logik der Ladekreise auf der Grundlage einer kontinuierlichen analogen Spannungsregelung am Messshunt aufzubauen.  Schalten Sie die Ladung automatisch aus, wenn der Abfall am Shunt auf ein vorbestimmtes Minimum abfällt, was darauf hinweist, dass der Ladestrom die letzte Ladestufe erreicht hat.  Und dann hat diese Umkehrung alles völlig verdorben ... Zuerst habe ich versucht, es irgendwie zu umgehen oder zu täuschen, aber als Ergebnis wurde mir klar, dass es einfacher ist, eine externe Quelle für eine Referenzladespannung zu verwenden.  Es wird sowohl zuverlässiger als auch transparenter für das weitere Verständnis sein. <br><br>  Ich habe einen externen integrierten Stabilisator (normal, linear) installiert, mit dem ich genaue und <i>temperaturstabile</i> 4,2 V von einem schlecht stabilisierten 5 ... 6 V USB-Ladegerät erhalten habe.  Mit ihnen versorgte ich das Smartphone zunächst mit einem positiven Batteriepol, so dass er immer dachte, er hätte einen 100% aufgeladenen Akku und sendete nie etwas vollständig auf diesem Bildschirm.  Und zweitens funktioniert das Backup-Batterieladesystem von diesem Bus aus. <br><br>  Unterwegs stieß ich auf eine merkwürdige Beobachtung.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es stellt sich heraus, dass </font><font style="vertical-align: inherit;">der Android </font><font style="vertical-align: inherit;">, wenn Sie die Stromversorgung über USB abschalten und eine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konstante Spannung</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von einer stabilisierten Quelle anlegen, die sich niemals an den </font><font style="vertical-align: inherit;">Akku </font><font style="vertical-align: inherit;">des </font><font style="vertical-align: inherit;">Smartphones </font><font style="vertical-align: inherit;">ändert, dauerhaft eine geneigte, fallende Grafik des Ladeprozentsatzes zeichnet! </font><font style="vertical-align: inherit;">Anscheinend ist eine Art Gleichung zur Berechnung dieser Prozentsätze in das Android-Batterieüberwachungsprogramm eingebettet, das nicht nur die tatsächliche Zellenspannung, sondern auch den Stromverbrauch des Geräts berücksichtigt. </font><font style="vertical-align: inherit;">Ich habe speziell Experimente durchgeführt und die Hintergrundbeleuchtung des Bildschirms ein- und ausgeschaltet, als einer der unersättlichsten Stromverbraucher. </font><font style="vertical-align: inherit;">Hier sind die pro Tag gesammelten Statistiken:</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also zeichnete Android ein Diagramm der "Batterieentladung"</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/m-/_j/dc/m-_jdcx_h9vkganwg0-nuci6fdc.jpeg"><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b7/y_/vv/b7y_vvrfjlfd_5teazjmiksc8bi.jpeg"></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie sehen, als der Bildschirm funktionierte und der Strom vom Batteriepol spürbar wurde, zeichnete der Android eine gute Steigung, etwa 5% weniger pro Stunde. Dann schaltete ich die Hintergrundbeleuchtung aus und das Smartphone schlief ein, der Strom fiel auf einige kleine Standby-Werte und die Grafik ging fast horizontal. Er schaltete den Bildschirm wieder ein - und wieder die Rampe. Beachten Sie, dass die Spannung am Pluspol der Batterie immer streng </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konstant war</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Der Android berechnete seinen Ladungsprozentsatz also nur anhand des gemessenen Stroms. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sobald die Ladung jedoch 15% erreicht (hier warnt das Telefon vor einem entladenen Akku), nimmt die Grafik nicht mehr ab und geht dann horizontal um 15% weiter und weiter ... Hier ist der Trick (oder die Panne).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gab noch eine andere Funktion. Es stellte sich heraus, dass </font><font style="vertical-align: inherit;">das Smartphone </font><font style="vertical-align: inherit;">, wenn Sie gleichzeitig USB-Strom und stabilisierten externen Strom an den Batteriepol liefern, jedoch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">weniger als 4,2 V</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , zuerst und für lange Zeit ehrlich einen unvollständigen Prozentsatz der Ladung </font><i><font style="vertical-align: inherit;">anzeigt</font></i><font style="vertical-align: inherit;"> und dann plötzlich anfängt zu schimpfen, im Stil von „ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do you etwas mit einer Batterie! Der Ladevorgang dauert zu lange!</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " Und natürlich alles noch einmal im Vollbildmodus und auf meiner Uhr! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie mehr als 4,2 V anlegen, schwört er irgendwo um die 4,3 V herum über den gefährlichen Überschuss der Batteriespannung. Dies ist verständlich. Daher ist der "Ruhebereich" hier ziemlich eng - nur 0,1V.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und nur, wenn er über den Batteriepol mit 5 V USB-Strom versorgt und die exakten 4,2 V vollständig emuliert wurde - nur dann schaltet der Android glücklich ab und glaubt, dass er seinen Akku ehrlich auf das Maximum aufgeladen hat. </font><font style="vertical-align: inherit;">Und mehr noch, Gott sei Dank, beschwert er sich nie über irgendetwas!</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich werde sofort diejenigen beruhigen, die gedacht haben, dass ich es sehr schlecht gemacht habe, indem ich zwei inkonsistente niederohmige Spannungsquellen übereinander geladen habe (dh einen externen 4,2-V-Stabilisator und einen positiven Batteriepol, der selbst ebenfalls „speist“). . </font><font style="vertical-align: inherit;">Tatsache ist, dass mein externer Stabilisator ein gewöhnlicher linearer LDO ist und aufgrund seiner Schaltung keinen </font><font style="vertical-align: inherit;">Strom </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umleiten kann</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nur scheitern. </font><font style="vertical-align: inherit;">Daher treten hier keine elektrischen Konflikte auf, wie dies beispielsweise passieren kann, wenn mehrere verschiedene Batterien parallel geschaltet sind.</font></font><hr><br><br><h4>  Schema </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als die TK endgültig festgelegt war, konnte mit der Entwicklung eines spezifischen Schemas begonnen werden. </font><font style="vertical-align: inherit;">Trotz der scheinbaren Einfachheit der Aufgabe habe ich vor allem daran herumgebastelt! </font><font style="vertical-align: inherit;">Ich musste mehr als ein Dutzend verschiedene Optionen erfinden und dann ablehnen, von unanständig einfach bis sperrig.</font></font> Hier ist das Ergebnis: <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Energieplan</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5p/av/_r/5pav_ru8mahbacmdyz4xxr6covo.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trotz der offensichtlichen Redundanz ist das Schema einfach. </font><font style="vertical-align: inherit;">Dank SMD passt ein 35 x 22 mm großer Schal problemlos in das Fach einer entfernten normalen Batterie. </font><font style="vertical-align: inherit;">Als Pufferbatterie habe ich ein normales Lithium-Ionen-Modell 18650 verwendet, das auf einem Uhrenständer montiert ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Schaltung bietet folgende Funktionen:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Hauptkonstante 5V Stromversorgung aus der Steckdose über den USB-Anschluss. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Übertragen Sie das Smartphone bei einem Stromausfall von USB automatisch auf einen Backup-Akku. </font></font></li><li>   4,2     (    ). </li><li>       (   ). </li><li>            . </li><li>     ,   . </li><li>         . </li><li>        . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nun kurz, wie die Schaltung funktioniert. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um stabile und temperaturunabhängige 4,2 V zu erhalten, habe ich den wunderbaren integrierten LDO ADM7172 von Analog Devices verwendet. Es gibt mir die gewünschte und vollkommen gleichmäßige Spannung von 4,22 V bis zu 2 A Last. Ich stecke es in mein Smartphone auf das Plus des Batterieanschlusses (VBAT) und lade damit auch die Pufferbatterie des Systems auf. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Spannungsemulationsschaltung für den dritten Batteriekontakt (TEMP) besteht aus einer einfachen Diode D2, die von einem mageren Hintergrundstrom gespeist wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Q4 P-Kanal Mosfet verbindet sofort einen Backup-Akku mit dem Smartphone, sobald die Spannung am + 5V USB-Hauptbus verschwindet. LED2 wurde hier nur mit dem Ziel eingestellt, das Niveau zu verschieben, um das Öffnen von Q4 während des Durchhängens des Reifens leicht zu beschleunigen. Es ist Infrarot und scheint nirgendwo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Rest der Details machte den Ladekreis. Die Pufferbatterie BT1 wird über den Q3-Mosfet und den Begrenzungswiderstand R9R10 aufgeladen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Arbeit von YOU U2 ist hier interessant. Es ist hier so enthalten, dass es sowohl die Kontrolle sowohl des Entladungsgrades als auch des Ladungsgrades ermöglicht. Der Operationsverstärker arbeitet hier im Komparatormodus, und ein positives Betriebssystem für ihn wird aufgrund der Prozesse in den von ihm gesteuerten Schaltungen von selbst erhalten.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So funktioniert es: Wenn alles in Ordnung ist - es gibt +5 V USB-Strom und der Pufferakku wird bis zu einer Spannung aufgeladen, die höher ist als die vom Teilerpunkt R4R5R6 eingestellte -, gibt der Operationsverstärker das Potenzial eines 4,2-Volt-Busses (von dem er mit Strom versorgt wird) und das Laden aus Mosfet Q3 ist geschlossen. Wenn sich der Akku aus dem einen oder anderen Grund unterhalb dieses Punktes entlädt (+3,63 V im Diagramm), löst sich der Operationsverstärkerausgang allmählich vom Plus und öffnet dadurch den Q3-Lademosfet. Es fließt Strom in die Batterie, die Spannung an der Zelle steigt sofort um mindestens einige Millivolt (aufgrund des Innenwiderstands ungleich Null) und dies dient als zuverlässiger POS für den Operationsverstärker. Hier können Sie einen echten Komparator mit eigener Hysterese anwenden, aber in Wirklichkeit ist das Schalten des Verstärkers zuverlässig und schnell, es gibt keine rasselnden Abweichungen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Batterieladung erfolgt über den Widerstand R9R10 (er ist zusammengesetzt, um die Verlustleistung zu erhöhen). Erstens wird der Ladestrom begrenzt, der hier unbedingt erforderlich ist, da sonst selbst ein 2-Ampere-Ladegerät einfach nicht zurechtkommt und durchhängt. Zweitens bestimmt die Schaltung gemäß dem Spannungsabfall an diesem Widerstand den Moment, in dem die Ladung ausgeschaltet werden muss.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies geschieht wie folgt: Sobald die Ladung eingeschaltet wird, öffnet sich gleichzeitig der Hilfsmosfet Q2, der den Steuerteiler R4R5R6 für den invertierten Eingang des Operationsverstärkers neu aufbaut, und somit beginnt der Operationsverstärker, die am Ladewiderstand freigesetzte Spannung zu überwachen. Zu Beginn des Ladevorgangs, wenn der Akku vollständig entladen ist, fallen am R9R10 etwa 0,5 V ab, wodurch der Operationsverstärker im Lademodus zuverlässig unsymmetrisch wird. Und erst wenn die Batterie allmählich vollständig aufgeladen ist, schwächt sich der Strom durch den Steuerwiderstand auf einen bestimmten Wert (ca. 20 mA) ab, werden die Potentiale der Operationsverstärkereingänge ausgeglichen, wonach sie durch denselben externen POS-Mechanismus in den entgegengesetzten Zustand (plus am Ausgang) übertragen werden und die Q2-Mosfets und ausschalten Q3 und Stoppen der Ladung. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Was das resultierende solche Schema betrifft</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ladeprofil </font><i><font style="vertical-align: inherit;">eines</font></i><font style="vertical-align: inherit;"> Lithium-Ionen-Akkus, der Widerstand R9R10 implementiert hier automatisch eine einfache Ladefunktion mit einem maximalen Anfangsstrom, dessen automatische allmähliche Abnahme und Annäherung an Null.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ladefunktionsdiagramm</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yx/6o/cx/yx6ocxkusa2pis2406l_y9jqvrq.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Die Batteriehersteller empfehlen wiederum das folgende bekannte Ladeprofil mit Stabilisierungsabschnitten für Strom und Spannung: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Typisches empfohlenes Ladungsprofil für Li-Ionen</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rt/o0/ab/rto0abfgdgab_tlfpkkwdhx2cdu.jpeg"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In meinem Fall wird weder die Spannung noch der Strom an der Zelle jemals spezifisch stabilisiert, aber die Spannung an der Zelle wird niemals die Sicherheitsgrenzen überschreiten. Daher halte ich eine solche vereinfachte Lademethode für durchaus praktikabel und effektiv. In der Praxis funktioniert es hervorragend und benötigt gleichzeitig nur einen Widerstand. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosfet Q1 wird verwendet, damit bei der Arbeit mit einer Pufferbatterie kein Strom verschwendet werden muss, um den Rest des Stromkreises mit Strom zu versorgen. Wenn die Steckdose ausfällt, schließt Q1 und trennt alle nicht verwendeten Teile des Stromkreises vom gemeinsamen Kabel. Dank dessen sinkt der Eigenverbrauch der gesamten Struktur auf vernachlässigbare 3 ... 5 Mikroampere, und dies verhindert automatisch eine tiefe Entladung der Batterie, falls Sie das stromlose System für längere Zeit vergessen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Schottky-Diode D1 am Eingang des Stabilisators U1 erfüllt eine Doppelfunktion: Sie blockiert den Rückstrom durch U1 (im ADM7172 gibt es keine solche Blockierung) und entlädt die kleine Stabilisator-Mikroschaltung von übermäßiger Verlustleistung. </font><font style="vertical-align: inherit;">Gleich zu Beginn der Batterieladung erreicht der Ladestrom 1A, und wenn die gesamte Spannung von 1 Volt vom + 5V USB-Bus auf den winzigen 3x3 mm ADM7172 gelegt wird, ist er trotz des auf die Platine gelöteten Wärmeleitpads sehr heiß. </font><font style="vertical-align: inherit;">Daher wird ein Teil der Eingangsspannung an der Sperrdiode D1 erfolgreich gelöscht, und infolgedessen werden diese beiden Teile gleichmäßiger und weniger stark erwärmt.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Über gebrauchte Komponenten </font></font></h4><br>  Als Eingangsstabilisator habe ich ein ausgezeichnetes LDO mit einem wirklich geringen minimalen Durchgangsabfall verwendet, obwohl an dieser Stelle die Spannung daran niemals unter 0,4 V fallen wird.  Ich mag den ADM7172 für viele seiner Spezifikationen.  Und so können Sie hier fast jeden Mikroschaltkreis für Linearstabilisatoren einsetzen. Hauptsache, er liefert zuverlässige Volt, die nicht auf der Temperatur schweben, und mindestens 1,5 A Strom. <br><br>  Von Mosfets brauchte ich hier minimalen Open-Channel-Widerstand (RdsON).  Dies gilt insbesondere für den Bit-P-Kanal-Schlüssel Q4.  Dort habe ich eine großartige Toshibov TPH1R712MD-Probe platziert - die beste, die der Kanalwiderstand in einem kleinen flachen Gehäuse gefunden hat.  Im geöffneten Zustand hat es echte 1,3mOhm, was bei einem Arbeitsstrom eines Smartphones von 200 ... 300mA Transitverluste wertvoller Batteriespannung bei vernachlässigbaren 0,4mV ergibt! <br><br>  Es ist auch wünschenswert, einen niedrigen RdsON für Q1 zu haben, um das Potential des gemeinsamen Drahtes genauer zu verbinden.  Auch die FDMC8010-Mosfets von Fairchild machen das gut.  Es gibt mehr niederohmige Proben, aber bei dieser Konstruktion waren mir auch die kleinen Abmessungen der Teile wichtig. <br><br>  Der Rest der Mosfets kann beliebig sein, es ist nur wünschenswert, dass sie eine niedrigere Schwellenspannung der Öffnung haben. <br><br>  Als U2-Komparator habe ich den Micropower Microchip MCP6V11 IOW verwendet, den ich mit seiner hervorragenden Effizienz mochte - nur 7 Mikroampere im Hintergrund.  Richtig, im Vergleich zu herkömmlichem YOW ist es als Schildkröte sicherlich langsam (GBW 80 kHz und Anstiegsrate von nur 0,03 V / μs).  Aber hier funktioniert es trotzdem großartig.  Übrigens habe ich versucht, hier einen echten Komparator mit eingebauter Hysterese zu platzieren.  Ich habe ein exzellentes Beispiel MCP6541 gefunden, das nur 600 Nanoampere (!) Im Hintergrund verbraucht. Wenn es ausgelöst wird, kann es den Ausgang mit einer Leistung von bis zu 30 mA ziehen.  Es stellte sich heraus, dass der MCP6541 so schnell schaltet, dass die Hochgeschwindigkeitsfront seines Impulses leicht durch die Gateelektrodenkapazität Q2 in die Schaltung des Steuerteilers R4R5R6 eindringt und zu seinem eigenen invertierenden Eingang gelangt.  Es stellt sich eine solche dynamische Rückkopplung heraus, und der Komparator schaltet nicht, sondern beginnt zu erzeugen. <br>  Das Problem wird durch einfaches Hinzufügen eines hochohmigen Widerstands zwischen dem Ausgang des Komparators und dem Q2-Gate behoben, aber ich hatte bereits eine Platine, auf der selbst für einen zusätzlichen kleinen SMD-Widerstand absolut kein Platz war, also habe ich den MCP6V11 einfach hier gelassen. <br><br>  LED1 wird nur benötigt, um anzuzeigen, wann eine Ladung in den Akku fließt.  Auf eine gute Weise sollte dies alle paar Jahre geschehen ... Sie können absolut jede Farbe verwenden, oder Sie können es überhaupt nicht setzen. <br><br>  Widerstände und Kondensatoren sind die gebräuchlichsten SMDs, es gibt keine Anforderungen für sie, außer für die geringe Größe.  Ich habe in 7343H-Fällen Tantalkondensatoren mit niedrigem ESR verwendet, aber jeder passt, nur um in das Batteriefach mit der Platine zu passen (für den W732 Philips ist er 55 x 60 x 8 mm groß). <br><br>  Während des Ladevorgangs erwärmt sich die gesamte Platine in den ersten Stunden anständig auf bis zu 60 Grad. Da im Fach noch genügend Platz vorhanden war, habe ich die Fläche der Platine absichtlich vergrößert und die Heizteile weiter darauf verteilt, damit sie sich und ihre anderen Nachbarn nicht umsonst überhitzen. <br><br><div class="spoiler">  <b class="spoiler_title">Energieverwaltungskarte im Batteriefach</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bt/bf/jy/btbfjybybqxy0ope5aikbng-efw.jpeg"><br></div></div><br>  Von Hand gefertigt, Fotolack.  Die FR-Methode macht es einfach, einen 0,15-mm-Prozess zu erhalten, aber aus irgendeinem Grund habe ich den gesamten Textolithen von so schlechter Qualität, dass dünne Straßen beim Verzinnen abfallen ... Wenn jemand weiß, wo man einen hochwertigen Textolithen mit Garantie kaufen kann, schreibe in die Kommentare ! <br><br>  Das Smartphone ist also endlich richtig mit Strom versorgt und funktioniert in jeder Hinsicht „wie eine Uhr“!  Das stabile Einschalten sowohl mit Strom aus der Steckdose als auch aus der Batterie funktioniert lautlos.  Wenn das Ladegerät angeschlossen ist, wird immer 100% Ladung angezeigt.  Wenn Sie es aus der Steckdose ziehen, arbeitet es weiterhin leise aus der Pufferbatterie und zeigt bald die tatsächliche Spannung an.  Bei der Wiederherstellung der Netzversorgung wird wieder lautlos und ruhig eine 100% ige Ladung angezeigt.  Alles ist wie es sollte! <br><br>  Im Prinzip können Sie über eine ähnliche Schaltung jedes Mobiltelefon mit Strom versorgen, das über den dritten Kontakt des Akkus eine einfache konstante Spannung erhält. <br><br><h4>  Digitaluhr für Android </h4><br>  Damit war die Sache mit Eisen abgeschlossen.  Es ist Zeit für Software-Toppings.  Es war nämlich notwendig, eine große Digitaluhr auf dem Smartphone-Bildschirm zu bekommen. <br><br>  Folgendes brauchte ich: <br><br><ol><li>  Die größtmögliche Anzahl!  Ich mag es nicht, die kleinen Dinge aus der Ferne zu betrachten. </li><li>  Möglichkeit, eine beliebige Schriftart in einer beliebigen Farbe zu platzieren.  Die Lesbarkeit hängt auch davon ab. </li><li>  Die Exklusivität der Anzeige der Uhr auf dem Bildschirm - nichts als Zeitziffern sollten nicht vorhanden sein.  Keine Wettervorhersagen, Warnungen, Meldungen, Statusleisten und anderer Unsinn - <i>sollten niemals</i> erscheinen. </li><li>  Es ist klar, dass der Bildschirm des Smartphones von sich aus niemals schwarz werden sollte. </li><li>  Ordnungsgemäß funktionierende automatische Helligkeitsfunktion des Bildschirms. </li><li>  Maximale Zuverlässigkeit (ich lebe immer noch auf dieser Uhr).  Kommt drauf an, Friese - das alles ist ausgeschlossen. </li></ol><br>  Ich begann damit, das Telefon anzuschließen und den Müll, den ich erreichen konnte, gnadenlos auszurotten.  Alle Arten von Gapps, Blotware und alles, was für das normale Laden nicht erforderlich ist, flogen in den Korb.  Dazu gehören eine Reihe von Systemanwendungen, verschiedene Dienstprogramme für die Arbeit mit SIM-Karten, Dialern, SMS, Browsern, Kalendern, Hintergrundbildern und anderem Unsinn.  Ich bin sogar ein paar Mal zu weit gegangen - das Telefon wurde durch Fehler geloopt.  Aber ich habe alles restauriert und wieder geklärt. <br><br>  Dann suchte ich lange im Internet nach einem normalen Programm von Vollbild-Digitaluhren für Android.  Trotz eines Berges ähnlicher Programme passte fast keines zu mir!  Alle Entwickler versuchen ausnahmslos, eine Menge unnötiger Dinge in ihre Produkte zu stopfen - angefangen von einem lustigen Hintergrund (nicht trennbar) bis hin zu Wettervorhersagen, Nachrichten, Kalendern und ähnlichem Müll.  Ich schweige im Allgemeinen über die Popup-Anzeigen, die bereits alle erreicht haben ... Ich brauchte nur Zeit von der Uhr! <br><br>  Das universelle Merkmal von Überwachungsprogrammen und Widgets ist die völlig unwirtschaftliche Nutzung des Bildschirmbereichs.  Die Zahlen sind überall klein und die Ränder von den Rändern des Bildschirms sind riesig.  Mein Philips, und so ist der Bildschirm nicht der größte - nur 4,3 ". <br><br>  Kurz gesagt, ich habe fast das einzig geeignete Programm gefunden - Big Digital Clock 1.1.1. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot Große Digitaluhr</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/i7/lw/eq/i7lweqe_tgvvqwiqqzdmjo_sk9q.png"><br></div></div><br>  Sie hat die größten Zahlen.  Und dennoch sind sie noch weit von der vollen Nutzung des Matrixbereichs entfernt.  Zu den Vorteilen des Programms zählen die Möglichkeit, bis auf die Zeit alles vom Bildschirm zu entfernen, eine beliebige Farbe, ein 24-Stunden-Format, einen nicht blinkenden Doppelpunkt, eine beliebige Bildschirmausrichtung und die automatische Wartung der nicht verblassenden Hintergrundbeleuchtung.  Von den Mängeln - eine eng genähte Schrift, die ein typisches Siebensegment nachahmt. <br><br>  Liefert es und begann den täglichen Gebrauch.  Zuerst war alles in Ordnung - die Zahlen scheinen groß zu sein, sie sind normal sichtbar und nach meinen alten Stunden - im Allgemeinen Himmel und Erde!  Aber jetzt, nach ungefähr einem Monat ununterbrochener Arbeit, bemerkte ich plötzlich, dass die Zeit auf ihnen <i>gefroren war und sich nicht änderte!</i>  Was für ein Unsinn !?  Ich habe mich entschlossen zu überprüfen - dies ist eine einmalige Panne oder "Funktion" des Programms. <br><br>  Starten Sie die Uhr neu und nach ein paar Wochen wurde der Fries wiederholt.  Die Zeit hört einfach auf zu aktualisieren.  Stattdessen sackt das Programm zufällig alle 7 ... 10 Minuten ab, aktualisiert die Uhr und gerät erneut in einen Stupor.  Es ist klar, dass eine solche "Zuverlässigkeit" nicht zu mir passte. <br><br><h4>  Android-Automatoren und ihre "Chips" </h4><br>  Da dies praktisch das einzig geeignete Programm war, musste ich anfangen, Krücken dafür zu erfinden.  Ich entschied, dass ich eine Art Android-Automatisierungstool installieren muss, damit es das fehlerhafte Uhrprogramm regelmäßig neu startet, bevor es überhaupt Zeit zum Einfrieren hat.  Setzen Sie Tasker.  Er war beschäftigt, hat es geklärt - aber etwas, das mir nicht gefallen hat ... Ich habe es in Automagic geändert.  Wer weiß nicht - dieses Automatisierungstool verwendet Skripte basierend auf visuellen Flussdiagrammen.  Und diese Eigenschaft von ihm hat mich wirklich angezogen! <br><br><div class="spoiler">  <b class="spoiler_title">Stellen Sie Automagic Automation-Szenarien dar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dl/pr/ki/dlprki-84b4sgbvlax3ao2wm9kw.jpeg"><br></div></div><br>  Die Funktion, mein Buggy-Watch-Programm regelmäßig neu zu starten, habe ich fast sofort implementiert.  Und dann setzte er Automagic auf sein Haupt-Smartphone und hing eine Woche lang in interessanten Experimenten damit.  Infolgedessen habe ich auf meinem Handy viel für den Alltag nützlich gemacht. <br><br>  Aber das war nicht die Hauptsache.  Ich bin in Automagic-Eigenschaften auf einem Chip wie Custom Widgets gestoßen.  Und dann stellte sich heraus, dass Sie mit seiner Hilfe praktisch <i>jedes hausgemachte Widget</i> zeichnen und "wiederbeleben" <i>können</i> , das nur die Vorstellungskraft und Funktionalität des Programms besitzt!  Dann wurde mir klar, dass ich mir eine solche Uhr zeichnen konnte, die nur mein Herz begehrt!  Darüber hinaus hat die Programmhilfe gerade ein Beispiel für die Erstellung eines Uhr-Widgets beschrieben. <br><br>  Nach ein paar Tagen war alles bestens fertig!  Dank des Nova-Lanzers kann ich Widgets sogar bis an die Ränder der Matrix strecken.  Ich habe auch die Dock-Leiste und die Statusleiste ausgeblendet, um den Bildschirm von allen Elementen der Benutzeroberfläche zu befreien.  Und hier ist das Ergebnis - wirklich große Zahlen in Bezug auf die Grenzen des Displays ... Endlich glücklich !!! <br><br><div class="spoiler">  <b class="spoiler_title">Schließlich nehmen die Zahlen die gesamte Bildschirmbreite ein!</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5k/xv/9s/5kxv9sdud2mssdnn7xm1iuo8k5m.jpeg"><br></div></div><br>  Durch die Verwendung von Automagic konnte ich alle meine Anforderungen erfüllen.  Sie können eine beliebige .ttf- oder .otf-Schriftart eingeben.  Sie können Zeichen in einem beliebigen Verhältnis zeichnen und strecken, um sie perfekt auf den Bildschirm zu bringen.  Schließlich können Sie nur das haben, was Sie brauchen!  Ich habe nicht einmal einen Doppelpunkt in die Uhr gezeichnet - mit einem einfachen Leerzeichen ist alles perfekt lesbar.  Bei der Anwendung von externen Programmen und Krücken sofort nicht mehr benötigt. <br><br>  Außerdem brauchte ich jetzt nicht einmal Locus, um regelmäßig GPS-Koordinaten für die Zeitsynchronisation festzulegen.  All dies kann von jedem Automatisierungstool perfekt ausgeführt werden.  In einem Steuerungsszenario können Sie fast alles implementieren, was Sie benötigen.  Beispiel: Halten Sie den Bildschirm in einem nicht verblassenden Zustand. <br><br>  Weiterhin gingen im Allgemeinen Probleme mit verschiedenen Polituren des Aussehens.  Und warum nicht, wenn dies alles einfach umzusetzen ist? <br><br>  Wenn Sie beispielsweise die Schriftgröße und den Faktor auswählen, müssen Sie von einem 4-stelligen Zeitformat (XX: XX) ausgehen.  In der Zeit von 0:00 bis 9:59 werden jedoch nur drei Ziffern auf dem Bildschirm angezeigt, sie nehmen eine kleinere Breite als vier ein und verwenden daher die Matrix nicht vollständig.  Eine Kleinigkeit, aber hässlich.  Mit Automagic lässt sich der Fall mit ein paar zusätzlichen Befehlen leicht lösen.  Es hat eine Funktion, mit der Sie fast jeden Parameter eines benutzerdefinierten Widgets <i>im</i> laufenden Betrieb ändern können.  In diesem Fall ist dies der Faktor für die Breite (Abflachung) der Schriftzeichen, den ich durch den Auslöser der oben genannten Zeitintervalle ändern möchte.  Es funktioniert! <br><br><div class="spoiler">  <b class="spoiler_title">Drei und vier Zeichen passen in dieselbe Bildschirmgröße</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/9t/ns/5r/9tns5rg_kbtelwl0fixwluearic.jpeg"><br>  <i>Der Schriftbreitenfaktor ändert sich "on the fly" mit dem Übergang von 9:59 auf 10:00</i> <i><br></i>  <i>und zurück von 23:59 bis 0:00</i> <br></div></div><br>  Zuerst hatte ich Zweifel an dem <i>Moment, in dem</i> die <i>Uhrwerte</i> jede Minute <i>aktualisiert wurden</i> .  Ich befürchtete, dass Automagic es nicht synchron mit der Änderung der Minuten der Systemuhr des Smartphones aktualisieren würde, sondern willkürlich, wodurch ein zufälliger Fehler für eine Minute eingeführt würde.  Ich begann zu überprüfen ... <br><br>  In Automagic gibt es zwei verschiedene Möglichkeiten, die Zeit in einem benutzerdefinierten Widget zu implementieren.  Sie können numerische Werte durch ein externes Aktionsereignis an ein normales Textfeld eines Widgets senden.  Für jedes dieser Ereignisse gibt es nur eine spezielle Option „Zur festen Zeit“. Dies bedeutet, dass Sie sie genau synchron mit dem Zeitpunkt senden müssen, zu dem sich die Systemzeit ändert. <br><br>  Die zweite Methode ist einfacher: Sie verwendet keine externen Skripte und besteht darin, eine Systemaufruffunktion des Typs direkt in das gewünschte Textfeld des Widgets zu schreiben <br><br><pre><code class="plaintext hljs">{getDate(),dateFormat,HH:mm}</code> </pre> <br>  Es gibt jedoch keine solche Option "Zur festen Zeit".  Das Widget wird einfach auf "Automatisch aktualisieren" gesetzt und auf "Aktualisierungsintervall" genau eine Minute eingestellt.  Und hier befürchtete ich genau, dass dieses Intervall der Selbsterneuerung des Widgets in einer Minute willkürlich relativ zum Zeitraster der Änderung der Minuten der Systemzeit gezählt werden kann.  Ich habe ein paar Experimente gemacht, aber zu meiner Freude stellte sich heraus, dass alles in Ordnung war.  Das Widget aktualisiert sich sofort deutlich, sobald sich die Minuten der Systemuhr ändern! <br><br>  Egal zu welchem ​​Zeitpunkt das Widget zu arbeiten begann. <br><br><h4>  Bildschirm für automatische Helligkeit </h4><br>  Das nächste, was ich tun wollte, war eine gute, klare automatische Helligkeit des Bildschirms.  Die eingebaute automatische Helligkeit meines alten Philips hat furchtbar funktioniert.  Zuckend, unzureichend und mit einem sehr engen Bereich.  Hier habe ich mich nicht darum gekümmert und eines der vielen Auto-Helligkeitsprogramme eingestellt.  Zuerst habe ich Lux ausprobiert, aber einige nicht intuitive Tinkturen und komplizierte Profile haben mir nicht gefallen.  Geändert zu Velis, und dies stellte sich als das heraus, was wir brauchen.  Was mir besonders gut gefallen hat - Velis ermöglicht es, eine reale Kurve der Helligkeitsabhängigkeit von den Messwerten des Luxometers zu zeichnen und zeigt in Echtzeit in dieser Grafik, wie das Smartphone die Helligkeit entsprechend anpasst.  Sie können jedes o-sehr glatte Gesetz der Helligkeitsänderung und natürlich jeden Wert davon bis zu 1% konfigurieren, wenn der Bildschirm fast unsichtbar ist.  Es ist sehr praktisch in der Nacht, wenn die Zahlen kaum leuchten sollten. <br><br>  Während ich um die neue Uhr herumlief, bemerkte ich, dass die Smartphone-Matrix selbst mit einem vollständig schwarzen Bildschirmhintergrund immer noch anständig leuchtet, wenn die Hintergrundbeleuchtung durch sie hindurchfällt.  Dies macht sich besonders bei völliger Dunkelheit bemerkbar - das Rechteck des Bildschirms ist deutlich in Form eines grauen Hintergrunds sichtbar, so etwas wie ein Glüheffekt.  Ich beschloss, es mit einem externen Filter zu beheben.  Die Farbe der Ziffern der Uhr habe ich rot gewählt, weil  Die rote Farbe sehe ich am deutlichsten aus der Ferne. <br><br>  Ich habe den ersten Filter manuell gemacht - ich habe eine feste rote Füllung auf einem Tintenstrahldrucker auf einen transparenten Film gedruckt und zwei noch rohe Drucke mit Tinte zueinander gefaltet.  Die Filme haften fest und es wird ein gutes transparentes "Glas" von dicker roter Farbe erhalten.  Übrigens, jetzt funktioniert ein solcher Life-Hack nicht mehr, er ist kitschig, weil bei meiner Arbeit absolut alle Tintenstrahldrucker durch modische Laser-MFPs ersetzt wurden.  Sie drucken perfekt auf Papier, aber es ist unmöglich, mit ihrer Hilfe eine transparente Farbfüllung auf den Film zu bringen - es entsteht eine verrauschte matte Schicht, durch die nichts sichtbar ist. <br><br>  Aber hier bin ich irgendwie für Bleistifte nach Komus gegangen und habe versehentlich so etwas gesehen: <br><br><div class="spoiler">  <b class="spoiler_title">Foto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/of/e8/pw/ofe8pwoxfgo5hvkmvhul5evpync.jpeg"><br></div></div><br>  Dies ist ein gewöhnliches Büropapierfach, aber sehen Sie, woraus es besteht.  Entweder Plexiglas oder transparenter Kunststoff, aber er hat dieselbe Farbe und Lichtdurchlässigkeit, die ich für den Filter benötige.  Ich kaufte es, schnitt vorsichtig einen Teller heraus, um ihn an den Bildschirm anzupassen, und passte ihn an.  Schönheit! <br><br><div class="spoiler">  <b class="spoiler_title">Mit rotem Filter</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/oq/oh/dr/oqohdrcoghynsiygiugq_egez_0.jpeg"><br></div></div><br><h4>  Feinschliff </h4><br>  Grundsätzlich kann dabei die Umwandlung eines alten unnötigen Mobiltelefons in exzellente schöne Uhren als abgeschlossen angesehen werden. <br><br>  Es stimmt, schon vor dem Haufen war ich verwirrt darüber, dass ich im Schrifteditor die .otf-Schrift ein wenig geändert habe, damit die Zeichen bis in die kleinsten Biegungen so waren, wie ich es wollte.  Eine Kleinigkeit, aber schön!  Es war auch notwendig, die Schrift monospaced zu machen, damit beim Ändern der Zeichen die Linie nicht nach außen verschoben und über die Anzeige hinaus gekrochen wird.  Verwendet einen der Open Source-Schrifteditoren, Glyphr Studio. <br><br>  Nun, am Ende bleibt nur die gesamte Struktur auf einem Regal in der Ecke des Raumes zu befestigen.  Es gibt viel Raum für Kreativität.  Ich bog einfach den L-förmigen Aluminiumstreifen und schraubte vorsichtig die hintere Abdeckung des Smartphones mit Schrauben fest.  Schrauben Sie das andere Ende an das Regal.  Sie können drehen, indem Sie einen beliebigen Betrachtungswinkel einstellen.  Und ein wenig Aluminium, das den Winkel vertikal einstellt.  Tatsächlich habe ich im Allgemeinen alles installiert, sodass ich es nicht mehr anfasse. <br><br>  Die Pufferbatterie hat sich an der Biegung der Montagestreifen angepasst.  Hier habe ich auf ein exquisites Design verzichtet, von hinten ist nichts zu sehen.  Ich habe mich auch nicht um Anschlussbehälter für die Batterie gekümmert, sondern einfach sorgfältig direkt an den Stellen, die nicht an den internen Inhalt der Batterie angrenzten, direkt an das 18650-Metallgehäuse gelötet, um sie nicht mit einem Lötkolben zu überhitzen. <br><br>  Alle Verbindungen werden durch normale Verkabelung hergestellt, die durch die gebohrten Löcher in der hinteren Abdeckung des Smartphones geworfen wird.  Und drinnen entdeckte ich direkt die Details und Spuren des Smartphone-Boards. <br><br>  Insgesamt stammen zwei externe Kabel aus dem Design: 5 V Stromversorgung über das Netzladegerät und ein GPS-Antennenkabel, das zum Fenster führt und mit Klebeband auf das Glas geklebt wird. <br><br>  Seit fast einem Jahr begeistern mich Uhren mit großen, schönen Stückzahlen, präzisem Lauf und ununterbrochenem, zuverlässigem Betrieb. <br><br>  Und zum Spaß habe ich ein zweites Uhr-Widget gezeichnet - für die vertikale Position des Smartphones. <br><br><div class="spoiler">  <b class="spoiler_title">Horizontale und vertikale Uhren im gleichen Maßstab</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hr/_b/o6/hr_bo6oelso-e2dyzglvbvnf9qa.jpeg"><br></div></div><br>  Ich begann es zu erfinden, weil die Zahlen mit einer solchen unkonventionellen Anordnung noch größer gemacht werden können, dh die nützliche Nutzung des Bildschirmbereichs sich als maximal möglich herausstellt.  Außerdem verschwindet in diesem Fall die Notwendigkeit, den Zeichenbreitenfaktor jedes Mal zu ändern, wenn vom Zeitformat X: XX zu XX: XX und umgekehrt gewechselt wird, da immer alles automatisch einbricht. <br><br>  Es stimmt, fast jeder, dem ich eine solche nicht standardmäßige vertikale Uhr zeigte, sagte: „Fuu, horizontal ist besser!“.  Nun, das ist eine Amateursache, ich persönlich mag beide. <br><br>  Das ist alles  Vielen Dank an alle, die gelesen haben! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443052/">https://habr.com/ru/post/de443052/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443038/index.html">Wenn Sekundenkleber ins Auge gelangt</a></li>
<li><a href="../de443040/index.html">7 Hauptgründe, warum Anwendungen in Google Play und AppStore blockiert werden</a></li>
<li><a href="../de443042/index.html">Start von 619.000 Tetris auf GLSL, deren Rendering und einem einfachen Bot</a></li>
<li><a href="../de443046/index.html">Wie Sicherheitsforscher auf geschützte Websites mit iOS-Code zugreifen</a></li>
<li><a href="../de443050/index.html">Die einfachste Erklärung, wie symmetrische Verschlüsselungsalgorithmen heute funktionieren</a></li>
<li><a href="../de443054/index.html">Eine Auswahl von Dienstprogrammen für einen Programmierer unter Linux</a></li>
<li><a href="../de443056/index.html">Zweiter HIV-Patient erreicht Remission</a></li>
<li><a href="../de443058/index.html">Saubere Architektur. Teil I - Einführung</a></li>
<li><a href="../de443060/index.html">Wird das Raumschiff den Mars erreichen?</a></li>
<li><a href="../de443062/index.html">Wie ich Recycle erstellt habe! VR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>