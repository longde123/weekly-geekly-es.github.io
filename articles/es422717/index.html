<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí± üà∫ üòº Desarrollo de un bot de chat con una personalidad determinada. Conferencia en Yandex üß£ üßù üß¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Una caracter√≠stica importante de las tareas de aprendizaje autom√°tico es que se pueden lograr resultados igualmente buenos utilizando diferentes m√©tod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de un bot de chat con una personalidad determinada. Conferencia en Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/422717/">  Una caracter√≠stica importante de las tareas de aprendizaje autom√°tico es que se pueden lograr resultados igualmente buenos utilizando diferentes m√©todos.  Esto da emoci√≥n a los concursos de ML: incluso teniendo otras competencias que un oponente obviamente fuerte, a√∫n puedes ganar.  Los equipos de Tensorborne y Neurobotics ten√≠an casi las mismas posibilidades de ganar el hackathon DeepHack y finalmente tomaron los primeros dos lugares.  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entrenamiento de Yandex, los</a> representantes de ambos equipos hicieron un voluminoso informe.  En la decodificaci√≥n, encontrar√° an√°lisis detallados de soluciones y consejos para competidores principiantes. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qSehSTWMXaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  Y, por supuesto, tomar unas vacaciones de hackathon.  Cuando participas en un hackathon semanal y tambi√©n trabajas al mismo tiempo, es malo.  Llegas a las 7 pm, despu√©s de haber trabajado un poco, si√©ntate y compila Docker con TensorFlow, Keras, para que todo esto comience en algunos servidores remotos a los que ni siquiera tienes acceso.  En alg√∫n lugar en dos noches se contrae la catarsis, y funciona para ti, sin Docker, sin todo, porque entendiste que es posible y as√≠. </blockquote><br><a name="habracut"></a>  Vitaly Davydov: <br>  - Hola a todos!  Deber√≠amos haber tenido dos informes, pero decidimos combinarlos en uno grande, porque estamos hablando del primer y segundo lugar en la competencia DeepHack.  Representamos a dos equipos.  Nuestro equipo Tensorborne ocup√≥ el segundo lugar y el equipo de Gregory Neurobotics, el primero. <br><br><img src="https://habrastorage.org/webt/hp/da/wx/hpdawx6cghpeiebf6nkmnxwieno.jpeg"><br>  El informe constar√° de tres partes principales.  En la introducci√≥n, hablar√© sobre la historia de DeepHack, qu√© es, cu√°les fueron las m√©tricas, etc. A continuaci√≥n, los chicos hablar√°n sobre soluciones, sobre qu√© problemas, ejemplos, etc. <br><br>  Antes de hablar sobre DeepHack, debe tenerse en cuenta que es un peque√±o subconjunto de otra competencia global muy grande, ConvAI2, que lanz√≥ Facebook el a√±o pasado.  Este a√±o es la segunda iteraci√≥n.  En alg√∫n momento, Facebook patrocin√≥ el Instituto de F√≠sica y Tecnolog√≠a de Mosc√∫, y la competencia DeepHack se cre√≥ sobre la base del laboratorio PhysTech. <br><br><img src="https://habrastorage.org/webt/k7/de/a-/k7dea-py5v-x3gr47seesnhpfge.jpeg"><br>  Lea m√°s sobre ConvAI en s√≠.  ¬øQu√© problema est√° tratando de resolver?  Se especializa en sistemas interactivos.  El problema con los sistemas de di√°logo es que no existe una herramienta de evaluaci√≥n √∫nica, una herramienta de evaluaci√≥n, para comprender la calidad de los di√°logos.  Esto es muy subjetivo de persona a persona: a alguien le puede gustar la conversaci√≥n, a alguien no.  La tarea global general de ConvAI es crear una m√©trica unificada com√∫n para evaluar di√°logos, que a√∫n no est√° disponible.  Premio: $ 20,000 para AWS Mechanical Turk.  Estos no son pr√©stamos a Amazon, son pr√©stamos solo a Mechanical Turk, que de hecho es un an√°logo de Yandex.Tolki.  Este es un servicio de crowdsourcing que le permite realizar un marcado en los datos. <br><br>  La tarea, que se basa en ConvAI, es construir un chit-chat-bot con el que puedas entablar alg√∫n tipo de di√°logo.  Eligieron tres m√©tricas: Perplejidad, Hits @ 1 y F1.  A continuaci√≥n, mostrar√© la tabla que estaba en el momento de nuestra presentaci√≥n. <br><br>  La evaluaci√≥n por la cual intentaron hacer esto pas√≥ por tres etapas.  La primera etapa son las m√©tricas autom√°ticas, luego la evaluaci√≥n de AWS Mechanical Turk y luego el chat en vivo con voluntarios. <br><br>  Como ConvAI est√° patrocinado por Facebook, est√° promoviendo activamente su biblioteca para crear sistemas de conversaci√≥n ParlAI.  Es bastante complicado, pero creo que todos los participantes usaron esta biblioteca.  Lo tratamos durante bastante tiempo, no es compatible con Python 3.6, por ejemplo, y hay varios problemas con √©l. <br><br><img src="https://habrastorage.org/webt/yp/xk/ew/ypxkewtucztkiznh_vqrienqxoe.jpeg"><br><br>  En estas pocas l√≠neas puede ver qu√© puestos ocupamos en el momento de la presentaci√≥n.  En general, ConvAI est√° extra√±amente organizado en el sentido de que hay tres m√©tricas y no est√° muy claro c√≥mo va la clasificaci√≥n en esta tabla.  Se puede ver que para algunas m√©tricas, algunos equipos son m√°s altos y otros m√°s bajos.  La organizaci√≥n de todo el ConvAI fue un poco extra√±a. <br><br>  Pero hay tres l√≠neas de base b√°sicas.  Para calificar para DeepHack, era necesario romper esta l√≠nea de base, y los 10 mejores mejores equipos llegaron a la final.  En secreto, dir√© que solo 8 equipos enviaron decisiones, y todos llegaron a la final.  No fue muy dif√≠cil. <br><br><img src="https://habrastorage.org/webt/vb/ra/mg/vbramgip1a-tkhp33opnd0nxiic.jpeg"><br><br>  La tarea de DeepHack fue un poco m√°s comprensible y directa.  Tuvimos que volver a construir un robot hablador, pero que emular√≠a cierta personalidad.  Es decir, al robot se le dio una descripci√≥n de una persona en la entrada, y durante una conversaci√≥n con √©l tuvo que revelarlo.  El premio fue bastante interesante: un viaje a los NIPS este oto√±o, que est√° totalmente patrocinado. <br><br>  La m√©trica, a diferencia de ConvAI, ya era diferente.  Hubo dos m√©tricas, y la m√©trica total se pondera entre las dos.  La primera m√©trica es la calidad general, una evaluaci√≥n de qu√© tan adecuadamente respondi√≥ el bot, qu√© tan interesante fue comunicarse con √©l, si estaba escribiendo basura, etc. La segunda m√©trica es el juego de roles, ya sea 0 o 1. Significa ¬øEl bot entr√≥ en la descripci√≥n que le dieron?  La persona que se comunica con el bot no ve la descripci√≥n.  La evaluaci√≥n tuvo lugar en Telegram, es decir, hab√≠a un solo bot de Telegram, y cuando el usuario comenz√≥ a comunicarse con √©l, lleg√≥ a alg√∫n bot aleatorio de todas las presentaciones, para ser honesto.  Yandex y MIPT, al parecer, vertieron un poco de tr√°fico all√≠, y hubo alrededor de 10 mil di√°logos, por lo que recuerdo. <br><br>  Ya dije sobre la ronda de clasificaci√≥n.  La final fue a tiempo completo.  Tuvo lugar durante siete d√≠as de trabajo en el Instituto de F√≠sica y Tecnolog√≠a de Mosc√∫, se proporcion√≥ un grupo, un lugar, nos sentamos y trabajamos all√≠.  De hecho, la evaluaci√≥n se realiz√≥ todos los d√≠as, y el puntaje final, la calificaci√≥n del bot al final, se calcul√≥ de esta manera.  La competencia comenz√≥ el lunes, la primera presentaci√≥n fue el martes y la evaluaci√≥n tuvo lugar al d√≠a siguiente.  La soluci√≥n que public√≥ el martes fue evaluada el mi√©rcoles con un peso de 1.5.  Lo que envi√≥ el mi√©rcoles, con un peso de 1.4, etc. <br><br><img src="https://habrastorage.org/webt/1x/4m/mc/1x4mmcu5p_2jo49ppvjceah0yhc.jpeg"><br><br>  Sobre el conjunto de datos que Facebook dio para capacitaci√≥n.  Se llama Persona-Chat y es una descripci√≥n de dos personalidades y un conjunto de di√°logos.  Hay una descripci√≥n de la primera persona y la segunda.  En el proceso de describir el di√°logo, intentan revelarse mutuamente.  Eso es todo lo que se ha dado.  Sin embargo, como siempre, en la competencia no estaba prohibido usar otros conjuntos de datos de terceros. <br><br><img src="https://habrastorage.org/webt/my/jx/hn/myjxhn7rt6krkci69o_vqwtpguq.jpeg"><br><br>  Un ejemplo del di√°logo de nuestro equipo.  Si lees detenidamente, est√° claro que el bot resultante funciona de manera bastante adecuada y responde de manera bastante correcta. <br><br>  Gregory hablar√° sobre el primer lugar. <br><br>  Grigory Rashkov: <br>  - Me gustar√≠a hablar sobre nuestra experiencia en participar en la competencia, nuestra estrategia y nuestra decisi√≥n. <br><br><img src="https://habrastorage.org/webt/rc/an/5v/rcan5v9ajugvnsojkpgrgactbv4.jpeg"><br><br>  En primer lugar, la peculiaridad de la competencia es que es de larga duraci√≥n, no ten√≠amos dos d√≠as, como en un hackat√≥n ordinario, sino cinco d√≠as, para los cuales podr√≠amos tomar muchas decisiones. <br><br><img src="https://habrastorage.org/webt/v_/t7/4_/v_t74_uw45cd7shzhtaog-frdnu.jpeg"><br><br>  Evaluaciones muy subjetivas, porque personas completamente diferentes con sus criterios evaluados, en particular, el organizador del hackathon Mikhail Bubtsev dijo que si incluso adivinaba de qu√© perfil estaba hablando, pero el robot en alg√∫n momento contradec√≠a su perfil, respond√≠a la pregunta no tanto , como est√° escrito, eligi√≥ un perfil diferente, incluso si sab√≠a de qu√© se trataba. <br><br>  Y el tercero es la falta de validaci√≥n.  Los participantes no pudieron hacer un peque√±o cambio e inmediatamente recibieron comentarios. <br><br>  Como en todas las pel√≠culas de terror, nuestro equipo al principio decidi√≥ separarse.  El primer grupo particip√≥ en nuestra soluci√≥n principal basada en la WAN de Wasserstein, el segundo grupo particip√≥ en el bot, el panel de administraci√≥n del bot basado en la l√≠nea de base.  Porque tuvimos que enviar algo el primer y segundo d√≠a. <br><br><img src="https://habrastorage.org/webt/za/ij/6e/zaij6evz4_vpbuepprwokz1pylq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace desde la diapositiva</a></sup></sub> </h5><br>  Brevemente sobre la l√≠nea base: Seq2Seq m√°s atenci√≥n, que est√° ligeramente adaptada para esta tarea espec√≠fica.  Como exactamente  Se env√≠a una frase a la entrada, la incrustaci√≥n se toma de GloVe, pero luego se considera m√°s la presentaci√≥n de cada frase como una incrustaci√≥n ponderada.  Los pesos se seleccionan en funci√≥n de la frecuencia inversa de la palabra.  Cuanto m√°s rara vez aparece una palabra, m√°s peso trae. <br><br><img src="https://habrastorage.org/webt/t_/go/g_/t_gog_ke6ovdcl7sblmigcnxdcm.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace desde la diapositiva</a></sup></sub> </h5><br>  Esto es necesario para reflejar la singularidad de estas caracter√≠sticas.  Todo iba a un conjunto, una matriz, se construy√≥ una m√°scara sobre la base de este conjunto y un estado oculto, luego esta m√°scara se superpuso en el conjunto, se obtuvo un contexto y luego se conect√≥, a trav√©s de la no linealidad, se aliment√≥ a la entrada de los decodificadores. <br><br><img src="https://habrastorage.org/webt/en/x-/ht/enx-htbfplt1is1kptc43ir_jh8.jpeg"><br><br>  Para el primer d√≠a, a√∫n no hemos escrito nuestra decisi√≥n, tuvimos que enviar algo, as√≠ que escribimos un agente basado en la l√≠nea de base, pero nos propusimos destacar de alguna manera entre la masa gris de agentes.  Para hacer esto, usamos heur√≠stica simple, nuestro bot fue el primero en iniciar un di√°logo y us√≥ una sonrisa en esta frase.  Y funcion√≥. <br><br><img src="https://habrastorage.org/webt/iv/om/qv/ivomqvl3tvsedmrb0bnj7dyqg40.jpeg"><br>  Naturalmente, al d√≠a siguiente, todos los bots comenzaron a fabricarse primero, y todos ten√≠an emoticones.  El segundo d√≠a, los residentes de Vilabaggio continuaron trabajando con la GAN, los residentes de Vilaribo probaron otras heur√≠sticas. <br><br><img src="https://habrastorage.org/webt/qe/pw/w-/qepww-mi4akk5qpehjzs2lmxjn4.jpeg"><br><br>  Como resultado, la puntuaci√≥n en la calidad del di√°logo mejor√≥ ligeramente, pero la persona nos super√≥.  Estos son los resultados del tercer d√≠a, solo quedaban dos d√≠as.  Entendimos que no tenemos suficiente tiempo para escribir un GAN y probarlo normalmente, porque ha estado estudiando durante mucho tiempo, mucho, tenemos que seleccionar muchos hiperpar√°metros.  As√≠ que decidimos cambiar a la l√≠nea de base, porque funciona muy bien. <br><br><img src="https://habrastorage.org/webt/a3/m5/cw/a3m5cw5nw_wfsgc9tk9kaxskxi4.jpeg"><br>  Nuestra tarea era mejorar el reconocimiento del perfil del usuario.  Propusimos tal heur√≠stica.  Cual era el problema  El usuario habl√≥ felizmente con el bot, pregunt√°ndole qu√© tipo de trabajo ten√≠a, pasatiempos, qu√© tipo de autom√≥vil maneja, el bot respondi√≥ a todo esto bien, porque el bot generalmente respondi√≥ bien.  Como resultado, al final del di√°logo, el usuario vio dos perfiles que no ten√≠an nada que ver con lo que estaba en el di√°logo, simplemente porque all√≠ se indicaban otras cosas que las que el usuario preguntaba.  Por lo tanto, decidimos que era necesario de alguna manera dar informaci√≥n del perfil. <br><br>  ¬øC√≥mo hacer esto de la manera m√°s l√≥gica?  Si una persona tiene alg√∫n inter√©s, probablemente hablar√° de ellos, busque intereses comunes.  Por lo tanto, decidimos que el bot en algunos puntos har√° preguntas en funci√≥n de su perfil.  Hubo un efecto interesante de que el generador, que se escribi√≥ simplemente de acuerdo con las reglas ling√º√≠sticas de G, utiliza alg√∫n hecho A del perfil, como resultado, G (A) se ingresa en el di√°logo, todo esto se env√≠a a la memoria del bot, y la pr√≥xima vez que el modelo genera informaci√≥n, procediendo tanto del perfil como de este di√°logo, es decir, con mayor probabilidad dir√° algo relacionado con el perfil. <br><br><img src="https://habrastorage.org/webt/t0/vu/xu/t0vuxufzqe-c-whihwkby1isxpe.jpeg"><br><br>  ¬øC√≥mo se ve√≠a en realidad?  El bot en el perfil dice que est√° encantado con la poes√≠a, luego, durante la conversaci√≥n, me pregunta si me gusta la poes√≠a.  Yo digo que s√≠, y m√°s all√° de su modelo, no el generador que construimos de acuerdo con las reglas, dice que le gusta escribir poes√≠a.  Por lo tanto, el bot se centr√≥ en su perfil y funcion√≥. <br><br><img src="https://habrastorage.org/webt/ls/tt/ku/lsttkui4jcn6v60olkqym-vbnvy.jpeg"><br><br>  Regresamos al primer lugar nuevamente.  El √∫ltimo d√≠a qued√≥.  Notamos que, sin embargo, estamos perdiendo como di√°logo. <br><br><img src="https://habrastorage.org/webt/cz/yz/wl/czyzwlynpgq0fl-k5e_ntgwzhbo.jpeg"><br>  Aprovechamos varias soluciones m√°s.  En primer lugar, usaron par√°frasis, analizaron lo que dijeron otras personas, porque los organizadores presentaron esta base de datos y notaron que muchas personas se comunican con el bot no es del todo correcto. <br><br><img src="https://habrastorage.org/webt/qy/tn/j-/qytnj-tpdkh8tsrza2iwwjpydgq.jpeg"><br><h5>  <sub><sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace desde la diapositiva</a></sup></sub> </h5><br>  Hay un m√≠nimo local interesante en el bot: responde muy bien a cualquier insulto, est√° de acuerdo con ellos, y para solucionarlo, decidimos usar la competencia de Kaggle para el analizador de comentarios t√≥xicos, escribimos un clasificador muy simple, tambi√©n con atenci√≥n de RNN.  En ese conjunto de datos hab√≠a las siguientes clases, superpuestas: insultos, amenazas ... Decidimos no estudiar el modelo por separado, qui√©n hablar√°, porque tal problema se encontr√≥, pero no fue muy frecuente.  Por lo tanto, acabamos de escribir una especie de mordaza que el bot respondi√≥, y todos estaban contentos. <br><br><img src="https://habrastorage.org/webt/gc/vh/by/gcvhbyftcrlzu-f3sqzmkdenews.jpeg"><br>  Adem√°s, utilizamos par√°frasis para enriquecer el discurso de nuestro bot.  Esto tampoco fue muy dif√≠cil, reemplazamos las palabras de la frase por sin√≥nimos, observamos los n-gramos resultantes en la frase, de modo que no difer√≠an mucho de los que eran originalmente, y luego elegimos la combinaci√≥n m√°s adecuada para la frase con la mayor probabilidad. <br><br><img src="https://habrastorage.org/webt/of/je/dm/ofjedmtylm9iyyx76jwudzg6zxw.jpeg"><br><br>  Como ejemplo de lo que sucedi√≥, el bot aqu√≠ dice que le gusta escuchar m√∫sica, dice disfrutar en el perfil, ha sido reemplazado por me gusta con nosotros.  No estamos seguros de si el modelo en s√≠ o nuestro Paraphraser lo gener√≥, pero esto pas√≥.  Otro comentario de que era imposible enviar solo datos del perfil.  Los pentagramas se compararon all√≠.  Si los pentagramas coincidieron con su comentario y su perfil, entonces simplemente esta frase no pas√≥, los organizadores lo organizaron.  Adem√°s, entre otras cosas, agregamos un diccionario sonriente. <br><br><img src="https://habrastorage.org/webt/xk/5z/tx/xk5ztxz1m61eiqhjk0cm9tgcef4.jpeg"><br><br>  El segundo ejemplo, tenemos muchas sonrisas.  Luego hubo heur√≠sticas, cuando el bot reaccion√≥ a su comportamiento que no le escribi√≥ durante mucho tiempo.  Parafraser tambi√©n trabaj√≥ aqu√≠, y dio un buen resultado. <br><img src="https://habrastorage.org/webt/hk/sg/uj/hksgujdi_dp2pt0uny6qhme2saw.jpeg"><br>  La calidad del di√°logo fue la mejor, la calidad de representar el papel tambi√©n. <br><br>  Intentamos que el modelo generara un conjunto de opciones, y las comparamos con el perfil.  Pero me pareci√≥ que en este caso el bot funciona peor, no pudimos realizar la validaci√≥n, solo evaluaciones subjetivas en dos o tres conversaciones.  Por lo tanto, decidieron no poner tal cosa, porque el perfil ya estaba bien reconocido. <br><br>  Luego escribimos una soluci√≥n al problema inverso, el segundo modelo, que seleccion√≥ el perfil deseado del di√°logo.  Planeamos usarlo inicialmente para el entrenamiento, con el fin de leer la funci√≥n de p√©rdida y distribuirlo a√∫n m√°s en la cuadr√≠cula.  Pero esto podr√≠a empeorar al hablador en s√≠ mismo, por lo que decidieron no decirlo as√≠.  Tambi√©n pensamos usar esto para el comportamiento del bot, pero no tuvimos tiempo para probarlo todo, y decidimos rechazarlo.  Adem√°s, decidimos poner emoticones basados ‚Äã‚Äãen el color emocional de la frase, escribimos un modelo, pero no encontramos un conjunto de datos adecuado, y los que se usaron no eran un poco acerca de eso. <br><br><img src="https://habrastorage.org/webt/-l/yu/xq/-lyuxqic47g_15ubzyeedifcwza.jpeg"><br>  Nuestro equipo <br><br>  Incluso si su modelo principal, que est√° esperando, no puede escribirlo o da un mal resultado, no se rinda de inmediato, debe intentar algunas cosas m√°s simples, lo cual es bastante natural.  Y lo segundo, a veces vale la pena ver lo que le falta a su modelo y pensar en tareas espec√≠ficas, descomponerlas y resolver problemas espec√≠ficos, lo cual hicimos.  Gracias por su atencion <br><br>  Sergey Kolesnikov: <br>  - Mi nombre es Sergey Kolesnikov, representar√© la decisi√≥n de Tensorborne. <br><br><img src="https://habrastorage.org/webt/0t/mb/o8/0tmbo89jriohlxqgahftrd4zi2y.jpeg"><br><br>  Se nos ocurri√≥ un nombre hermoso, fuimos al concurso, se nos ocurrieron muchas piezas diferentes para lanzar dos art√≠culos despu√©s de eso, pero no ganamos el hackathon.  Por lo tanto, se llamar√°: "C√≥mo no ganar el hackathon, pero a√∫n as√≠ publicar los dos malditos art√≠culos".  Acad√©micos, se√±or. <br><br>  Las caracter√≠sticas de la competencia en la que participamos excedieron nuestra motivaci√≥n.  Debido al hecho de que la evaluaci√≥n se llev√≥ a cabo diariamente, los paquetes tambi√©n tuvieron que hacerse a diario, y la recompensa final se determin√≥, como nos gusta en RL, mediante la suma de descuento.  Todo esto se convirti√≥ en el hecho de que ten√≠amos que enviar al menos algo todos los d√≠as para que funcionara, y obtuvimos al menos alg√∫n tipo de puntaje.  Como resultado, realmente se convirti√≥ en lo que quieres: no quieres, pero ten√≠as que remar. <br><br><img src="https://habrastorage.org/webt/4l/uf/qk/4lufqkldav6-3iemerr1lxqd8rk.jpeg"><br><br>  Que tuvimos  Vista previa para toda la semana. <br><br>  A pesar de que el hackathon dijo que era semanal, todo se decidi√≥ en cuatro d√≠as, lo que parece no ser suficiente para esta tarea ConvAI. <br><br>  Inicialmente, √©ramos cinco, todos buenos graduados acad√©micos m√°s o menos Fiztekh, as√≠ que el lunes vinimos y lanzamos muchas sugerencias, ideas que puedes probar, qu√© modelos de aprendizaje profundo probar.  Es cierto que no experimentamos con GAN, porque ya experimentamos con ellos para textos y esto no funciona, por lo que tomamos algo m√°s simple, adem√°s, hab√≠a competencias muy similares y ten√≠amos modelos de preentrenamiento.  El martes, incluso pudimos lanzar algo sobre aprendizaje profundo, ML fue siempre que fue posible, lanzamos maravillosos acopladores con soporte de GPU y otras cosas para Tensorflow y Keras, tenemos que dar una medalla por separado, ya que esto no es tan trivial como me gustaria <br><br>  Seg√∫n los resultados del martes, fueron prometedores, y decidimos mejorar ligeramente nuestro ML con peque√±as heur√≠sticas y similares, y fallamos en el s√©ptimo lugar.  Pero gracias a nuestros compa√±eros de equipo, alguien encontr√≥ ElasticSearch y lo intent√≥.  Hubo un momento muy inc√≥modo cuando ElasticSearch funcion√≥ bien, y los modelos DL y ML, etc., fueron un poco menos robustos.  El final del concurso estaba cerca.  Y como se√±al√≥ el orador anterior, decidimos remar en la direcci√≥n que funciona.  Tomamos ElasticSearch, peque√±as heur√≠sticas y pensamos que era lo suficientemente bueno, y realmente bueno, porque ocupamos el segundo lugar. <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>  M√°s detalles  En realidad, hab√≠a varias soluciones DL.  La primera soluci√≥n DL fue bastante simple.  Qui√©n recuerda, el a√±o anterior al a√±o pasado, hubo un concurso de detecci√≥n de par√°frasis de Quora, y este a√±o hubo un concurso de Yandex para que Alice construyera di√°logos y m√°s.  Puede notar que las tareas all√≠ son muy cercanas.  En el primero era necesario decir si estas dos frases eran par√°frasis, y en el segundo era necesario continuar el di√°logo.  Pensamos que ya que estamos desarrollando sistemas de di√°logo, sigamos tambi√©n el di√°logo bien.  Y funcion√≥ perfectamente, el di√°logo con Quora fue muy personal. <br><br>  B√°sicamente, parec√≠a que ten√≠amos un codificador, generalmente todos entrenamos en nuestros RNN habituales, y preferiblemente LSTM con atenci√≥n y otras cosas.  Y luego usamos de manera est√°ndar la p√©rdida de incrustaci√≥n de Cosaine presentada en la diapositiva a continuaci√≥n, u otra p√©rdida de incrustaci√≥n del tipo de p√©rdida de Tripler, o algo m√°s que incorpora par√°frasis o respuestas a un di√°logo espec√≠fico, y no retrasos de par√°frasis, etc.  Esta fue la primera soluci√≥n, estaba en Tensorflow, Keras, estaba lista, la probamos y fue bastante buena. <br><br>  Otra soluci√≥n naci√≥ en un d√≠a dos hackatones por las tardes.  Hay un tipo maravilloso, Jeremy Howard, √©l promueve DL y ML para todos, tiene dos cursos maravillosos que le presentan el curso de este negocio y otras cosas, y para este curso escribi√≥ su FastAI.  Todo esto funciona en PyTorch, y en muchos sentidos, incluso reescribe PyTorch, este es uno de los inconvenientes de esta lib.  Pero por las ventajas, Jeremy tiene poco que ver con la PNL, este a√±o en marzo publicaron un art√≠culo con otro estudiante donde entrenaron a LSTM en todas las mejores pr√°cticas en el maravilloso FastAI, con muchos trucos que promueve en su curso, y obtuvieron pr√°cticamente SOTA para todo <br><br>  Como soy un peque√±o evangelista de PyTorch, todav√≠a pude arrancar de ra√≠z este modelo de FastAI, incluirlo, ya se puede decir, en mi marco de PyTorch, e incluso entrenarlo todo para esta tarea.  B√°sicamente, ten√≠amos un cierto contexto de di√°logo, de hecho, incluso si ten√≠amos varias oraciones, simplemente lo concatena en una oraci√≥n fuerte.      answer,  .          FastAI,  Universal Language Model ‚Äî    ‚Äî Encoder. <br><br>     , , ,   1   ,     seq2seq.        .           ,     ,     FastAI ‚Äî Concat poolling.   ?         seq2seq,    attention.   maxpool  minpool     ,         ,      . <br><br>   ,      ,       ,     ,     maxpool  minpool,   .     ,     ‚Äî    H, Hc  Ha.       ,   feedforward ,    .  ,     ,   ,  ,  metric learning.         ‚Äî CosineEmbedding Loss,    PyTorch. <br><br>           ,  loss         .   ,  contrastive loss,    ,       .     ,        . <br><br>   DL-. ElasticSearch,   . <br><br><img src="https://habrastorage.org/webt/yf/4p/2a/yf4p2avf9hrxd-dyy3bkgely3a0.jpeg"><br><br>    ?   ,   -  ElasticSearch  . -         - Persona Dataset  ,   ,   Facebook,  ,   ,    - .      -    .        ,     ,  ,  ,        ,  Persona Dataset      ,      Amazon Mechanical Turk     ,   . <br><br>         ElasticSearch,            ,    .  ,   Persona Dataset    ,   , 10 . ,        . , , ,   ,     . <br><br>   - .        ,    Persona     ,  ,     ,  ,    ,    evaluation.    heuristic solutions. <br><br> ,   ,   ,          ,   .    .    ,  ,   ,     ,    ,     .    . <br><br>       ‚Äî    .        ,        ‚Äî    -,      -,   ,   . <br><br>      dirty hack.    ,         ,        .       .   ‚Äî    ,       . <br><br><img src="https://habrastorage.org/webt/yy/9p/fw/yy9pfw8lc-tssoygftcrfsatfxy.jpeg"><br><br>  ?        ,   -DL-       ,   DL,    .   ,    ,    ,   .          .  ,   -,     ,  ,   .  ,   ,     .     .  ,  ,    .    DL        ,  ElasticSearch  . <br><br>  ,     personality score.  ,  -,     0,25‚Äì0,3 ,       .   ,    ,   -    . <br><br><img src="https://habrastorage.org/webt/av/rt/t7/avrtt73yerc1ckh6tyv3swowuzk.jpeg"><br><br> .     ‚Äî           ,   ,  ,       Docker ElasticSearch,       .   ,  .  .     .     Also, try to guess‚Ä¶  ,    ‚Äî , funny you.  ,     general,  .    ,     ,    . <br><br> ,  ,       .            . ,          ‚Äî    ,         ,  .  ,     Docker,      . <br><br><img src="https://habrastorage.org/webt/jj/zy/9r/jjzy9r5zcnzogxejadhvfhehoyg.jpeg"><br><br>         ? ConvAI   ,     NIPS,       -  . <br><br> -, ElasticSearch   . ,    ,   .   ,      ,  ElasticSearch   . ,   DL. <br><br> -,     DL-. :       ,     ,     ,     .    ,  , , ,    . <br><br>    ,     .   ,        .     ,      .    ‚Äî    pre-trained- ( ‚Äî . .), .  . <br><br> ,   proposals   ,    RL bandits     .     ,  .     ‚Äî      .  ,    . ,    ,        ,  ,     toxic-     .   . <br><br>         ‚Äî   .         ,       DeepHacks    .   NLP,    DeepHack    , , ¬´ ¬ª.  ,  .     .      , , ,   ,         ,     . <br><br>   ‚Äî       .        distributed-       ,       .   ,       DeepHack.     -   .   .  ,     ,    ,        ,     . <br><br>   ! .      pre-trained-.   , , . <br><br>  ,    .           ,  .    7 ,  ,    Docker  TensorFlow, Keras,      -  ,       . -      ,      ‚Äî  Docker,  ,    ,    . <br><br> ,       ,  -      ,       ,  .   .  Gracias </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422717/">https://habr.com/ru/post/es422717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422705/index.html">El libro sobre "P√°rrafo" sobre Habr√©. Un nuevo cap√≠tulo trata sobre programadores cooperativos: Beta</a></li>
<li><a href="../es422709/index.html">Los cient√≠ficos han encontrado una secci√≥n del cerebro humano que es responsable del tono de nuestro discurso</a></li>
<li><a href="../es422711/index.html">Lectura de fin de semana: recursos de infraestructura de nube y TI</a></li>
<li><a href="../es422713/index.html">El resumen de materiales interesantes para el desarrollador m√≥vil # 269 (del 3 al 9 de septiembre)</a></li>
<li><a href="../es422715/index.html">La no discriminaci√≥n es el valor central del c√≥digo abierto</a></li>
<li><a href="../es422719/index.html">Los atacantes comprometieron a miles de enrutadores MikroTik para crear una botnet</a></li>
<li><a href="../es422721/index.html">KivyMD - la vida contin√∫a</a></li>
<li><a href="../es422723/index.html">GAN ense√±√≥ a crear caras con textura y geometr√≠a realistas</a></li>
<li><a href="../es422725/index.html">390k. sitios web con carpeta abierta .git</a></li>
<li><a href="../es422729/index.html">¬øC√≥mo puede un proveedor de la nube administrar licencias de software y qu√© soluciones blockchain pueden proporcionar aqu√≠?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>