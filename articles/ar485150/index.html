<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ฟโโ๏ธ ๐ ๐คณ ุงูููุฒูุงุก ููุทูู ุงููุงุฑ PvP ุงููุญููู ุ ุฃู ููู ูููู ุจุฅุนุงุฏุฉ ุชุดููู ูุนุจุฉ ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ ุฅูู ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ๐๐ฟ ๐ ๐ฉ๐ฟโ๐คโ๐จ๐พ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ููุงู ุณุงุจู ุ ุชุญุฏุซ ุฒูููู ุนู ููููุฉ ุงุณุชุฎุฏุงููุง ููุญุฑู ุงูููุฒูุงุก ุซูุงุฆู ุงูุฃุจุนุงุฏ ูู ูุนุจุฉ ุฅุทูุงู ุงููุงุฑ ุนูู ุงููุงุนุจูู ุงููุชุนุฏุฏูู. ูุงูุขู ุฃุฑูุฏ ุฃู ุฃุดุงุฑู ููู ุฃููููุง ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูููุฒูุงุก ููุทูู ุงููุงุฑ PvP ุงููุญููู ุ ุฃู ููู ูููู ุจุฅุนุงุฏุฉ ุชุดููู ูุนุจุฉ ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ ุฅูู ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pixonic/blog/485150/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fo/if/az/foifazxdmxh_smqsswnkxhn0ww4.png"><br><br>  ูู <a href="https://habr.com/ru/company/pixonic/blog/481880/">ููุงู ุณุงุจู ุ</a> ุชุญุฏุซ ุฒูููู ุนู ููููุฉ ุงุณุชุฎุฏุงููุง ููุญุฑู ุงูููุฒูุงุก ุซูุงุฆู ุงูุฃุจุนุงุฏ ูู ูุนุจุฉ ุฅุทูุงู ุงููุงุฑ ุนูู ุงููุงุนุจูู ุงููุชุนุฏุฏูู.  ูุงูุขู ุฃุฑูุฏ ุฃู ุฃุดุงุฑู ููู ุฃููููุง ูู ุดูุก ูุนููุงู ูู ูุจู ูุจุฏุฃูุง ูู ููุทุฉ ุงูุตูุฑ - ูุจุนุจุงุฑุฉ ุฃุฎุฑู ุ ููู ููููุง ูุนุจุชูุง ูู ุงูุนุงูู ุซูุงุฆู ุงูุฃุจุนุงุฏ ุฅูู ุซูุงุซู ุงูุฃุจุนุงุฏ. <br><a name="habracut"></a><br>  ุจุฏุฃ ูู ุดูุก ุจุญูููุฉ ุฃูู ุจูุฌุฑุฏ ูุตูู ููุชุฌ ููุตูู ุฑุงุฆุฏ ููุนุจุฉ ุฅูู ูุณู ุงููุจุฑูุฌูู ูุฏููุง ููุถุนูุง ุฃูุงู ุชุญุฏู: ุชู ุฅุทูุงู ูุทูู ุงููุงุฑ ุงููุญููู PvP Top-Down ูุน ุฅุทูุงู ุงููุงุฑ ูู ุงููุณุงุญุงุช ุงูุถููุฉ ุฅูู ุดุฎุต ุซุงูุซ ูููู ุจุฅุทูุงู ุงููุงุฑ ูู ููุงุทู ููุชูุญุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงููุณุชุญุณู ุฃูุง ุชุจุฏู ุงูุจุทุงูุฉ ููุง ููู: <br><br><img src="https://habrastorage.org/webt/he/j3/2p/hej32pvogui5sukjz842wjpyqry.png"><br><br>  ู ููุฐุง: <br><br><img src="https://habrastorage.org/webt/n8/25/xw/n825xwkx_jsgqgoemkcor-r4ti0.jpeg"><br><br>  ุงููุชุทูุจุงุช ุงููููุฉ ูุงูุช ููุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญุฌู ุงูุฎุฑูุทุฉ - 100 ร 100 ูุชุฑ ุ </li><li style=";text-align:right;direction:rtl">  ูุฑู ุงูุงุฑุชูุงุน - 40 ูุชุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุฏุนู ุงูุฃููุงู ูุงูุฌุณูุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุฅุทูุงู ุงููุงุฑ ุนูู ุฃูุฏุงู ุนูู ุงุฑุชูุงุนุงุช ูุฎุชููุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุชุตุงุฏูุงุช ูุน ุงูููุฏุณุฉ ุงูุซุงุจุชุฉ (ููุณ ูุฏููุง ุชุตุงุฏูุงุช ูุน ุดุฎุตูุงุช ุฃุฎุฑู ูู ุงููุนุจุฉ) ุ </li><li style=";text-align:right;direction:rtl">  ููุฒูุงุก ุงูุณููุท ุงูุญุฑ ุ </li><li style=";text-align:right;direction:rtl">  ููุจูุฉ ุฑูู ุงูููุฒูุงุก. </li></ul><br>  ุจุงููุธุฑ ุฅูู ุงููุณุชูุจู ุ ุฃุณุชุทูุน ุฃู ุฃููู ุฅู ูุนุจุชูุง ูู ุชุดุจู ููุทุฉ ุงูุดุงุดุฉ ุงูุฃุฎูุฑุฉ: ููุฏ ุชุจูู ุฃููุง ุชูุงุทุน ุจูู ุงูุฎูุงุฑูู ุงูุฃูู ูุงูุซุงูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑ ุงูุฃูู: ูููู ุงูุทุจูุงุช </h2><br>  ุชู ุงูุชุฑุงุญ ุงูููุฑุฉ ุงูุฃููู ุจุนุฏู ุชุบููุฑ ูุญุฑู ุงูููุฒูุงุก ุ ูููู ุจุจุณุงุทุฉ ูุฅุถุงูุฉ ุนุฏุฉ ุทุจูุงุช ูู ูุณุชููุงุช "ุนุฏุฏ ุงูุทูุงุจู".  ุงุชุถุญ ุดูุก ูู ุฎุทุท ุงููููุฉ ูู ุงููุจูู: <br><br><img src="https://habrastorage.org/webt/lz/dy/oq/lzdyoquthw76ajisyvgqcn7zc_i.jpeg"><br><br>  ูุน ูุฐุง ุงูููุฌ ุ ูู ููู ุจุญุงุฌุฉ ุฅูู ุฅุนุงุฏุฉ ุชุทุจูู ุงูุนููู ุฃู ุงูุฎุงุฏู ุจุดูู ุฌุฐุฑู ุ ูุจุตูุฉ ุนุงูุฉ ุ ูุจุฏู ุฃูู ุจูุฐู ุงูุทุฑููุฉ ุชู ุญู ุงููููุฉ ุจุจุณุงุทุฉ ุดุฏูุฏุฉ.  ููุน ุฐูู ุ ุนูุฏ ูุญุงููุฉ ุชูููุฐู ุ ูุงุฌููุง ุงูุนุฏูุฏ ูู ุงููุดุงูู ุงูุญุฑุฌุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุชูุถูุญ ุงูุชูุงุตูู ูุน ูุตููู ุงููุณุชููุงุช ุ ุชูุตููุง ุฅูู ุงุณุชูุชุงุฌ ููุงุฏู ุฃู ุนุฏุฏ "ุงูุทูุงุจู" ูู ูุซู ูุฐุง ุงููุฎุทุท ูููู ุฃู ูููู ูุซูุฑูุง ููุฅุนุฌุงุจ: ุจุนุถ ุงูุฎุฑุงุฆุท ุชูุน ูู ููุทูุฉ ููุชูุญุฉ ุฐุงุช ููุญุฏุฑุงุช ูุชูุงู ูุทููุฉ. </li><li style=";text-align:right;direction:rtl">  ุฃุตุจุญ ุญุณุงุจ ุงูุฒูุงุฑุงุช ุนูุฏ ุฅุทูุงู ุงููุงุฑ ูู ุทุจูุฉ ุฅูู ุฃุฎุฑู ูููุฉ ุบูุฑ ุชุงููุฉ.  ููุถุญ ุงูุดูู ุงูุชุงูู ูุซุงูุงู ุนู ูุดููุฉ ูุง: ููุง ูููู ููุงุนุจ 1 ุงูุฏุฎูู ุฅูู ุงููุงุนุจ 3 ุ ูููุณ ุงููุงุนุจ 2 ุ ูุธุฑูุง ูุฃู ุทุจูุฉ ูุณุงุฑ ุงูุงูุชูุงุท ุชุณุงูู 2 ุ ุนูู ุงูุฑุบู ูู ูุฌูุฏ ูู ูู ุงููุงุนุจ 2 ูุงููุงุนุจ 3 ูู ููุณ ุงูุทุจูุฉ. </li></ol><br><img src="https://habrastorage.org/webt/be/rg/be/bergbenv9gtcjzpkci26w_jmsik.png"><br><br>  ุจุงุฎุชุตุงุฑ ุ ููุฏ ุชุฎูููุง ุนู ููุฑุฉ ุชูุณูู ุงููุถุงุก ุฅูู ุทุจูุงุช ุซูุงุฆูุฉ ุงูุฃุจุนุงุฏ - ููุฑุฑูุง ุฃู ูุชุตุฑู ูู ุฎูุงู ุงุณุชุจุฏุงู ุงููุญุฑู ุงููุนูู ุชูุงููุง. <br><br>  ููุง ุฃุฏู ุจูุง ุฅูู ุถุฑูุฑุฉ ุงุฎุชูุงุฑ ูุฐุง ุงููุญุฑู ุจุงูุฐุงุช ูุจูุงุฆู ูู ุชุทุจููุงุช ุงูุนููู ูุงูุฎุงุฏู ุงูุญุงููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑ ุงูุซุงูู: ุญุฏุฏ ููุชุจุฉ ุฌุงูุฒุฉ </h2><br>  ูุธุฑูุง ูุฃู ุนููู ุงููุนุจุฉ ููุชูุจ ูู Unity ุ ููุฏ ูุฑุฑูุง ุงููุธุฑ ูู ุฅููุงููุฉ ุงุณุชุฎุฏุงู ุงููุญุฑู ุงููุนูู ุงููุฏูุฌ ูู Unity ุงูุชุฑุงุถููุง - PhysX.  ุจุดูู ุนุงู ุ ุงุณุชููู ูุชุทูุจุงุช ูุตููู ุงูุฃูุนุงุจ ูุฏููุง ุชูุงููุง ูุฏุนู ุงูููุฒูุงุก ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ูู ุงููุนุจุฉ ุ ูููู ูุง ุชุฒุงู ููุงู ูุดููุฉ ูุจูุฑุฉ.  ูุชุฃููุช ูู ุญูููุฉ ุฃู ุชุทุจูู ุงูุฎุงุฏู ุงูุฎุงุต ุจูุง ูุฏ ูุชุจ ูู C # ุฏูู ุงุณุชุฎุฏุงู Unity. <br><br>  ูุงู ููุงู ุฎูุงุฑ ูุงุณุชุฎุฏุงู ููุชุจุฉ C ++ ุนูู ุฎุงุฏู - ุนูู ุณุจูู ุงููุซุงู ุ ููุณ PhysX - ููููุง ูู ูุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุจุดูู ุฌุฏู: ุจุณุจุจ ุงุณุชุฎุฏุงู ุงูููุฏ ุงูุฃุตูู ุ ูุงู ููุงู ุงุญุชูุงู ูุจูุฑ ูุชุนุทู ุงูุฎุงุฏู ูุน ูุฐุง ุงูููุฌ.  ุชุดุนุฑ ุจุงูุญุฑุฌ ุฃูุถูุง ุจุณุจุจ ุงูุฎูุงุถ ุฅูุชุงุฌูุฉ ุนูููุงุช Interop ูุชูุฑุฏ ูุฌููุนุฉ PhysX ูู ุธู ูุญุฏุฉ Unity ุ ุจุงุณุชุซูุงุก ุงุณุชุฎุฏุงููุง ูู ุจูุฆุฉ ุฃุฎุฑู. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ูุญุงููุฉ ูุชูููุฐ ูุฐู ุงูููุฑุฉ ุ ุชู ุงูุชุดุงู ูุดุงูู ุฃุฎุฑู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนุฏู ูุฌูุฏ ุฏุนู ูุจูุงุก Unity ูุน IL2CPP ุนูู Linux ุ ูุงูุฐู ุงุชุถุญ ุฃูู ุฃูุฑ ุจุงูุบ ุงูุฃูููุฉ ุ ูุฃููุง ูู ุฃุญุฏ ุฃุญุฏุซ ุงูุฅุตุฏุงุฑุงุช ูููุง ุจุชุจุฏูู ุฎูุงุฏู ุงูุฃูุนุงุจ ุงูุฎุงุตุฉ ุจูุง ุฅูู .Net Core 2.1 ููุดุฑูุง ุนูู ุฃุฌูุฒุฉ Linux ุ </li><li style=";text-align:right;direction:rtl">  ุนุฏู ูุฌูุฏ ุฃุฏูุงุช ููุงุฆูุฉ ูููููุงุช ูููุงุช ุงูุชุนุฑูู ุนูู ุงููุญุฏุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุฃุฏุงุก ููุฎูุถ ูุชุทุจูู Unity: ููุง ุจุญุงุฌุฉ ููุท ุฅูู ูุญุฑู ูุนูู ุ ูููุณ ูู ุงููุธุงุฆู ุงููุชุงุญุฉ ูู Unity. </li></ul><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุจุงูุชูุงุฒู ูุน ูุดุฑูุนูุง ุ ูุงูุช ุงูุดุฑูุฉ ุชููู ุจุชุทููุฑ ูุนุจุฉ PvP ูุชุนุฏุฏุฉ ุงูููุงุฐุฌ ุฃุฎุฑู.  ุงุณุชุฎุฏู ูุทูุฑููุง ุฎูุงุฏู ุงููุญุฏุฉ ุ ูุญุตููุง ุนูู ุงููุซูุฑ ูู ุฑุฏูุฏ ุงููุนู ุงูุณูุจูุฉ ุจุดุฃู ุงูููุฌ ุงูููุชุฑุญ.  ุนูู ูุฌู ุงูุฎุตูุต ุ ูุงูุช ุฅุญุฏู ุงูุดูุงูู ุฃู ุฎูุงุฏู ุงููุญุฏุฉ ูุงูุช "ูุชุฏููุฉ" ุฌุฏูุง ููุงู ูุฌุจ ุฅุนุงุฏุฉ ุชุดุบูููุง ูู ุจุถุน ุณุงุนุงุช. <br><br>  ูุฒูุฌ ูู ูุฐู ุงููุดุงูู ุฌุนูุชูุง ูุชุฎูู ุนู ูุฐู ุงูููุฑุฉ ุฃูุถุง.  ุซู ูุฑุฑูุง ุชุฑู ุฎูุงุฏู ุงููุนุจุฉ ุนูู .Net Core 2.1 ูุงุฎุชูุงุฑ ุจุฏูุงู ูู VolatilePhysics ุ ูุงูุชู ุงุณุชุฎุฏููุงูุง ุณุงุจููุง ุ ูุญุฑู ูุงุฏู ุขุฎุฑ ููุชูุญ ููุชูุจ ุจูุบุฉ C #.  ุฃู ุฃููุง ููุง ุจุญุงุฌุฉ ุฅูู ูุญุฑู C # ุ ูุฃููุง ููุง ุฎุงุฆููู ูู ุญูุงุฏุซ ุบูุฑ ูุชููุนุฉ ุนูุฏ ุงุณุชุฎุฏุงู ูุญุฑูุงุช ููุชูุจุฉ ูู C ++. <br><br>  ูุชูุฌุฉ ูุฐูู ุ ุชู ุงุฎุชูุงุฑ ุงููุญุฑูุงุช ุงูุชุงููุฉ ููุงุฎุชุจุงุฑุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://github.com/bepu/bepuphysics1">Bepu Physic v1</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://github.com/bepu/bepuphysics2">Bepu Physic v2ุ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://github.com/mattleibow/jitterphysics">ุบุถุจ ุงูููุฒูุงุก.</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://github.com/ValtoLibraries/BulletSharp">BulletSharp</a> . </li></ul><br>  ูุงูุช ุงููุนุงููุฑ ุงูุฑุฆูุณูุฉ ุจุงููุณุจุฉ ููุง ูู ุฃุฏุงุก ุงููุญุฑู ุ ูุฅููุงููุฉ ุงูุฏูุงุฌู ูู ุงููุญุฏุฉ ูุฏุนูู: ูุง ููุจุบู ุงูุชุฎูู ุนูู ูู ุญุงู ูุฌุฏูุง ุฃู ุฃุฎุทุงุก ููู. <br><br>  ูุฐูู ุ ูููุง ุจุงุฎุชุจุงุฑ ูุญุฑูุงุช Bepu Physics v1 ู Bepu Physics v2 ู Jitter Physics ูู ุฃุฌู ุงูุฃุฏุงุก ุ ููู ุจูููุง Bepu Physics v2 ุฃุซุจุชุช ุฃููุง ุงูุฃูุซุฑ ุฅูุชุงุฌูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููู ุงููุญูุฏ ูู ุจูู ูุคูุงุก ุงูุซูุงุซุฉ ุงูุฐูู ููุงุตููู ุงูุชุทููุฑ ุจูุดุงุท. <br><br>  ููุน ุฐูู ุ ูู ุชูู Bepu Physics v2 ุจูุนุงููุฑ ุงูุชูุงูู ุงููุชุจููุฉ ุงูุฃุฎูุฑุฉ ูุน Unity: ุชุณุชุฎุฏู ูุฐู ุงูููุชุจุฉ ุนูููุงุช SIMD ู System.Numerics ุ ูุจูุง ุฃูู ูุง ููุฌุฏ ุฏุนู SIMD ูู ุงูุชุฌููุนุงุช ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ ูุน IL2CPP ุ ููุฏ ุชู ููุฏ ุฌููุน ููุงุฆุฏ ุชุญุณููุงุช Bepu.  ูุงู ุงููุดูุฏ ุงูุชุฌุฑูุจู ูู ุงูุฅูุดุงุก ุนูู iOS ุนูู iPhone 5S ุจุทูุฆูุง ููุบุงูุฉ.  ูู ูุชููู ูู ุงุณุชุฎุฏุงู ูุฐุง ุงูุญู ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ. <br><br>  ููุง ูุฌุจ ุชูุถูุญ ุณุจุจ ุงูุชูุงููุง ุจุดูู ุนุงู ุจุงุณุชุฎุฏุงู ูุญุฑู ูุงุฏู.  ูู ุฃุญุฏ ููุงูุงุชู ุงูุณุงุจูุฉ <a href="https://habr.com/ru/company/pixonic/blog/415959/">ุ</a> ุชุญุฏุซุช ุนู ููููุฉ ุชุทุจูููุง ูุฌุฒุก ุงูุดุจูุฉ ูู ุงููุนุจุฉ ูููู ูุนูู ุงูุชูุจุค ุงููุญูู ุจุชุตุฑูุงุช ุงููุงุนุจ.  ุจุงุฎุชุตุงุฑ ุ ูุชู ุชูููุฐ ููุณ ุงูุฑูุฒ ุนูู ุงูุนููู ูุงูุฎุงุฏู - ูุธุงู ECS.  ูุณุชุฌูุจ ุงูุนููู ูุฅุฌุฑุงุกุงุช ุงููุงุนุจ ููุฑูุง ุ ุฏูู ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู - ูุญุฏุซ ุงูุชูุจุค ุงููุฒุนูู.  ุนูุฏูุง ุชุฃุชู ุงุณุชุฌุงุจุฉ ูู ุงูุฎุงุฏู ุ ูููู ุงูุนููู ุจูุญุต ุงูุญุงูุฉ ุงููุชููุนุฉ ูู ุงูุนุงูู ุจุงูุญุงูุฉ ุงููุณุชููุฉ ุ ูุฅุฐุง ูู ุชุชุทุงุจู (ุณูุก ุงูุชูุฏูุฑ) ุ ูุจูุงุกู ุนูู ุงุณุชุฌุงุจุฉ ุงูุฎุงุฏู ุ ูุชู ุฅุฌุฑุงุก ุชุตุญูุญ (ุชุณููุฉ) ููุง ูุฑุงู ุงููุงุนุจ. <br><br>  ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ูู ุฃููุง ูููุฐ ููุณ ุงูููุฏ ุนูู ููู ูู ุงูุนููู ูุงูุฎุงุฏู ุ ูุฃู ุญุงูุงุช ุณูุก ุงูุชูุฏูุฑ ูุงุฏุฑุฉ ููุบุงูุฉ.  ููุน ุฐูู ุ ูู ุชุญูู ุฃู ูู ูุญุฑูุงุช C # ุงููุนููุฉ ุงูุชู ูุฌุฏูุงูุง ูุชุทูุจุงุชูุง ุนูุฏ ุงูุนูู ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ: ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูููููุง ุชูููุฑ 30 ุฅุทุงุฑูุง ูู ุงูุซุงููุฉ ุซุงุจุชูุง ุนูู iPhone 5S. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎูุงุฑ ุงูุซุงูุซ ุ ุงูููุงุฆู: ูุญุฑูุงู ูุฎุชููุงู </h2><br>  ุซู ูุฑุฑูุง ุชุฌุฑุจุฉ: ุงุณุชุฎุฏุงู ุงุซููู ูู ุงููุญุฑูุงุช ุงููุงุฏูุฉ ุงููุฎุชููุฉ ุนูู ุงูุนููู ูุงูุฎุงุฏู.  ููุฏ ุงุนุชูุฏูุง ุฃูู ูู ุญุงูุชูุง ูุฐุง ูููู ุฃู ููุฌุญ: ูุฏููุง ููุฒูุงุก ุชุตุงุฏู ุจุณูุทุฉ ุฅูู ุญุฏ ูุง ูู ูุนุจุชูุง ุ ุนูุงูุฉ ุนูู ุฐูู ุ ุชู ุชูููุฐูุง ูู ูุจููุง ููุธุงู ECS ูููุตู ููู ููู ุฌุฒุกูุง ูู ุงููุญุฑู ุงููุงุฏู.  ูุงู ูู ูุง ูุญุชุงุฌู ูู ุงููุญุฑู ุงููุงุฏู ูู ุงููุฏุฑุฉ ุนูู ุฌุนู reykast ู sweepcasts ูู ูุณุงุญุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ. <br><br>  ูุชูุฌุฉ ูุฐูู ุ ูุฑุฑูุง ุงุณุชุฎุฏุงู ุงููุญุฏุฉ ุงูููุฒูุงุฆูุฉ ุงููุฏูุฌุฉ - PhysX - ุนูู ุงูุนููู ู Bepu Physics v2 ุนูู ุงูุฎุงุฏู. <br><br>  ุฃููุงู ููุจู ูู ุดูุก ุ ููุฏ ุฃุจุฑุฒูุง ูุงุฌูุฉ ุงุณุชุฎุฏุงู ุงููุญุฑู ุงููุนูู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุงูููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Numerics; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Prototype.Common.Physics</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IPhysicsWorld</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HasBody</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetCurrentSimulationTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tick</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>; <span class="hljs-function"><span class="hljs-function">RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RayCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, CollisionLayer layer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ticksBehind = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-function">RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SphereCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, CollisionLayer layer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ticksBehind = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-function">RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CapsuleCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, CollisionLayer layer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ticksBehind = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CapsuleOverlap</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, BodyMobilityField bodyMobilityField, CollisionLayer layer, List&lt;Overlap&gt; overlaps, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ticksBehind = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveOrphanedDynamicBodies</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WorldState.TableSet currentWorld</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateBody</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, Vector3 position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> angle</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateStaticCapsule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDynamicCapsule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateStaticBox</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, Vector3 size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDynamicBox</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, Vector3 size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span>; } }</code> </pre> <br></div></div><br>  ูุงูุช ููุงู ุชุทุจููุงุช ูุฎุชููุฉ ููุฐู ุงููุงุฌูุฉ ุนูู ุงูุนููู ูุงูุฎุงุฏู: ููุง ุณุจู ุฐูุฑู ุ ุนูู ุงูุฎุงุฏู ุงุณุชุฎุฏููุง ุงูุชุทุจูู ูุน Bepu ุ ูุนูู ุงูุนููู - ุงููุญุฏุฉ. <br><br>  ููุง ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุงููุฑูู ุงูุฏูููุฉ ููุนูู ูุน ุงูููุฒูุงุก ูุฏููุง ุนูู ุงูุฎุงุฏู. <br><br>  ูุธุฑูุง ูุญูููุฉ ุฃู ุงูุนููู ูุชููู ุชุญุฏูุซุงุช ุงูุนุงูู ูู ุงูุฎุงุฏู ูุน ุชุฃุฎูุฑ (ุชุฃุฎุฑ) ุ ูุฑู ุงููุงุนุจ ุงูุนุงูู ูุฎุชูููุง ุชูุงููุง ุนูุง ูุฑุงู ุนูู ุงูุฎุงุฏู: ุฅูู ูุฑู ููุณู ูู ุงูููุช ุงูุญุงุถุฑ ุ ูุจููุฉ ุงูุนุงูู ูู ุงููุงุถู.  ููุฐุง ุงูุณุจุจ ุ ุงุชุถุญ ุฃู ุงููุงุนุจ ูุทูู ุงููุงุฑ ูุญูููุง ุนูู ูุฏู ููุฌูุฏ ุนูู ุงูุฎุงุฏู ูู ููุงู ุขุฎุฑ.  ูุฐูู ุ ูุธุฑูุง ูุฃููุง ูุณุชุฎุฏู ูุธุงู ุงูุชูุจุค ุจุฅุฌุฑุงุกุงุช ุงููุงุนุจ ุงููุญูู ุ ูุญุชุงุฌ ุฅูู ุงูุชุนููุถ ุนู ุงูุชุฃุฎุฑ ุนูุฏ ุงูุชุตููุฑ ุนูู ุงูุฎุงุฏู. <br><br><img src="https://habrastorage.org/webt/h5/gy/k3/h5gyk3svohmmd61k-xll9wq8zps.png"><br><br>  ูู ุฃุฌู ุชุนููุถูู ุ ูุญุชุงุฌ ุฅูู ุชุฎุฒูู ุชุงุฑูุฎ ุงูุนุงูู ุนูู ุงูุฎุงุฏู ูุขุฎุฑ N ูููู ุซุงููุฉ ุ ููุฐูู ููููู ูุงุฏุฑูู ุนูู ุงูุนูู ูุน ูุงุฆูุงุช ูู ุงูุชุงุฑูุฎ ุ ุจูุง ูู ุฐูู ุงูููุฒูุงุก ุงูุฎุงุตุฉ ุจูู.  ููุฐุง ูุนูู ุฃู ูุธุงููุง ูุฌุจ ุฃู ูููู ูุงุฏุฑูุง ุนูู ุญุณุงุจ ุงูุชุตุงุฏูุงุช ูุงูุจุซ ุงููุจุงุดุฑ ูุงูุจุซ ุงููุจุงุดุฑ "ูู ุงููุงุถู".  ูููุงุนุฏุฉ ุนุงูุฉ ุ ูุง ุชุนุฑู ุงููุญุฑูุงุช ุงูููุฒูุงุฆูุฉ ููููุฉ ุงูููุงู ุจุฐูู ุ ูููุณ Bepu ูุน PhysX ุงุณุชุซูุงุกู.  ูุฐูู ุ ูุงู ุนูููุง ุฃู ูููุฐ ูุฐู ุงููุธููุฉ ููุญุฏูุง. <br><br>  ูุธุฑูุง ูุฃููุง ูููุง ุจูุญุงูุงุฉ ุงููุนุจุฉ ุจุชุฑุฏุฏ ุซุงุจุช ูุฏุฑู 30 ุนูุงูุฉ ูู ุงูุซุงููุฉ ุงููุงุญุฏุฉ ุ ูุงู ุนูููุง ุญูุธ ุจูุงูุงุช ุงูุนุงูู ุงููุงุฏู ููู ุนูุงูุฉ.  ูุงูุช ุงูููุฑุฉ ูู ุนุฏู ุฅูุดุงุก ูุซูู ูุงุญุฏ ูู ุงููุญุงูุงุฉ ูู ุงููุญุฑู ุงููุนูู ุ ูููู N - ููู ุนูุงูุฉ ุชู ุชุฎุฒูููุง ูู ุงูุณุฌู - ูุงุณุชุฎุฏุงู ุงููุฎุฒู ุงููุคูุช ุงูุฏูุฑู ููุฐู ุงููุญุงูุงุฉ ูุชุฎุฒูููุง ูู ุงูุชุงุฑูุฎ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> SimulationSlice[] _simulationHistory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimulationSlice[PhysicsConfigs.HistoryLength]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BepupPhysicsWorld</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { _currentSimulationTick = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; PhysicsConfigs.HistoryLength; i++) { _simulationHistory[i] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimulationSlice(_bufferPool); } }</code> </pre> <br>  ูู ECS ูุฏููุง ุ ููุงู ุนุฏุฏ ูู ุฃูุธูุฉ ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุงูุชู ุชุนูู ูุน ุงูููุฒูุงุก: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  InitPhysicsWorldSystem. </li><li style=";text-align:right;direction:rtl">  SpawnPhysicsDynamicsBodiesSystem. </li><li style=";text-align:right;direction:rtl">  DestroyPhysicsDynamicsBodiesSystem. </li><li style=";text-align:right;direction:rtl">  UpdatePhysicsTransformsSystem. </li><li style=";text-align:right;direction:rtl">  MovePhysicsSystemุ </li></ul><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุนุฏุฏ ูู ุฃูุธูุฉ ุงููุฑุงุกุฉ ููุท ุ ูุซู ูุธุงู ูุญุณุงุจ ุงูุฒูุงุฑุงุช ูู ุงูุทููุงุช ูุงูุงููุฌุงุฑุงุช ูู ุงูููุงุจู ุงููุฏููุฉ ุ ุฅูุฎ. <br><br>  ูู ูู ุนูุงูุฉ ูู ุนูุงูุงุช ูุญุงูุงุฉ ุงูุนุงูู ุ ูุชู ุชูููุฐ InitPhysicsWorldSystem ุฃููุงู ุ ูุงูุฐู ูููู ุจุชุนููู ุฑูู ุงูุชุฌุฒุฆุฉ ุงูุญุงูู (SimulationSlice) ุนูู ุงููุญุฑู ุงููุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetCurrentSimulationTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tick</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oldTick = tick - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newSlice = _simulationHistory[tick % PhysicsConfigs.HistoryLength]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oldSlice = _simulationHistory[oldTick % PhysicsConfigs.HistoryLength]; newSlice.RestoreBodiesFromPreviousTick(oldSlice); _currentSimulationTick = tick; }</code> </pre> <br>  ุชุณุชุนูุฏ ุทุฑููุฉ RestoreBodiesFrom PreviousTick ููุถุน ุงููุงุฆูุงุช ูู ุงููุญุฑู ุงููุนูู ูู ููุช ุงูุนูุงูุฉ ุงูุณุงุจูุฉ ูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูู ุงูุณุฌู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุงูููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RestoreBodiesFromPreviousTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SimulationSlice previous</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oldStaticCount = previous._staticIds.Count; <span class="hljs-comment"><span class="hljs-comment">// add created static objects for (int i = 0; i &lt; oldStaticCount; i++) { var oldId = previous._staticIds[i]; if (!_staticIds.Contains(oldId)) { var oldHandler = previous._staticIdToHandler[oldId]; var oldBody = previous._staticHandlerToBody[oldHandler]; if (oldBody.IsCapsule) { var handler = CreateStatic(oldBody.Capsule, oldBody.Description.Pose, true, oldId, oldBody.CollisionLayer); var body = _staticHandlerToBody[handler]; body.Capsule = oldBody.Capsule; _staticHandlerToBody[handler] = body; } else { var handler = CreateStatic(oldBody.Box, oldBody.Description.Pose, false, oldId, oldBody.CollisionLayer); var body = _staticHandlerToBody[handler]; body.Box = oldBody.Box; _staticHandlerToBody[handler] = body; } } } // delete not existing dynamic objects var newDynamicCount = _dynamicIds.Count; var idsToDel = stackalloc uint[_dynamicIds.Count]; int delIndex = 0; for (int i = 0; i &lt; newDynamicCount; i++) { var newId = _dynamicIds[i]; if (!previous._dynamicIds.Contains(newId)) { idsToDel[delIndex] = newId; delIndex++; } } for (int i = 0; i &lt; delIndex; i++) { var id = idsToDel[i]; var handler = _dynamicIdToHandler[id]; _simulation.Bodies.Remove(handler); _dynamicHandlerToBody.Remove(handler); _dynamicIds.Remove(id); _dynamicIdToHandler.Remove(id); } // add created dynamic objects var oldDynamicCount = previous._dynamicIds.Count; for (int i = 0; i &lt; oldDynamicCount; i++) { var oldId = previous._dynamicIds[i]; if (!_dynamicIds.Contains(oldId)) { var oldHandler = previous._dynamicIdToHandler[oldId]; var oldBody = previous._dynamicHandlerToBody[oldHandler]; if (oldBody.IsCapsule) { var handler = CreateDynamic(oldBody.Capsule, oldBody.BodyReference.Pose, true, oldId, oldBody.CollisionLayer); var body = _dynamicHandlerToBody[handler]; body.Capsule = oldBody.Capsule; _dynamicHandlerToBody[handler] = body; } else { var handler = CreateDynamic(oldBody.Box, oldBody.BodyReference.Pose, false, oldId, oldBody.CollisionLayer); var body = _dynamicHandlerToBody[handler]; body.Box = oldBody.Box; _dynamicHandlerToBody[handler] = body; } } } }</span></span></code> </pre> <br></div></div><br>  ุจุนุฏ ุฐูู ุ ุชููู ุฃูุธูุฉ SpawnPhysicsDynamicsBodiesSystem ู DestroyPhysicsDynamicsBodiesSystem ุจุฅูุดุงุก ุฃู ุญุฐู ูุงุฆูุงุช ูู ุงููุญุฑู ุงููุนูู ููููุง ูููููุฉ ุชุบููุฑูุง ูู ุนูุงูุฉ ECS ุงูุฃุฎูุฑุฉ.  ุซู ูููู UpdatePhysicsTransformsSystem ุจุชุญุฏูุซ ููุถุน ุฌููุน ุงูููุฆุงุช ุงูุฏููุงููููุฉ ููููุง ููุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ECS. <br><br>  ุจูุฌุฑุฏ ุฃู ุชุชู ูุฒุงููุฉ ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ECS ููุญุฑู ุงูููุฒูุงุก ุ ูุญุณุจ ุญุฑูุฉ ุงููุงุฆูุงุช.  ุนูุฏ ุงูุงูุชูุงุก ูู ุฌููุน ุนูููุงุช ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุ ูุชู ุชุดุบูู ุฃูุธูุฉ ูููุฑุงุกุฉ ููุท ูุญุณุงุจ ููุทู ุงููุนุจุฉ (ุงูููุทุงุช ูุงูุงููุฌุงุฑุงุช ูุถุจุงุจ ุงูุญุฑุจ ...). <br><br>  ุฑูุฒ ุชูููุฐ SimulationSlice ุงููุงูู ูููุฒูุงุก Bepu: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุงูููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Numerics; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> BepuPhysics; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> BepuPhysics.Collidables; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> BepuUtilities.Memory; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Quaternion = BepuUtilities.Quaternion; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Prototype.Physics</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BepupPhysicsWorld</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SimulationSlice</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, StaticBody&gt; _staticHandlerToBody = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, StaticBody&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, DynamicBody&gt; _dynamicHandlerToBody = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, DynamicBody&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; _staticIdToHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; _dynamicIdToHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>&gt; _staticIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>&gt; _dynamicIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> BufferPool _bufferPool; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Simulation _simulation; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SimulationSlice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BufferPool bufferPool</span></span></span><span class="hljs-function">)</span></span> { _bufferPool = bufferPool; _simulation = Simulation.Create(_bufferPool, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NarrowPhaseCallbacks(), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PoseIntegratorCallbacks(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-9.81f</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RayCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, CollisionLayer layer, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds=</span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { direction = direction.Normalized(); BepupRayCastHitHandler handler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BepupRayCastHitHandler(_staticHandlerToBody, _dynamicHandlerToBody, layer, ignoreIds); _simulation.RayCast(origin, direction, distance, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> handler); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = handler.RayCastHit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collidableReference = handler.CollidableReference; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (handler.CollidableReference.Mobility == CollidableMobility.Static) { _simulation.Statics.GetDescription(collidableReference.Handle, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> description); result.HitEntityId = _staticHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = description.Pose.Position; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _simulation.Bodies.GetDescription(collidableReference.Handle, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> description); result.HitEntityId = _dynamicHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = description.Pose.Position; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SphereCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, CollisionLayer layer, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { direction = direction.Normalized(); SweepCastHitHandler handler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SweepCastHitHandler(_staticHandlerToBody, _dynamicHandlerToBody, layer, ignoreIds); _simulation.Sweep(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sphere(radius), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose(origin, Quaternion.Identity), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyVelocity(direction.Normalized()), distance, _bufferPool, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> handler); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = handler.RayCastHit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collidableReference = handler.CollidableReference; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (handler.CollidableReference.Mobility == CollidableMobility.Static) { _simulation.Statics.GetDescription(collidableReference.Handle, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> description); result.HitEntityId = _staticHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = description.Pose.Position; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reference = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyReference(collidableReference.Handle, _simulation.Bodies); result.HitEntityId = _dynamicHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = reference.Pose.Position; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RayCastHit </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CapsuleCast</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Vector3 direction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> distance, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, CollisionLayer layer, List&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; ignoreIds = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span> { direction = direction.Normalized(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = height - <span class="hljs-number"><span class="hljs-number">2</span></span> * radius; SweepCastHitHandler handler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SweepCastHitHandler(_staticHandlerToBody, _dynamicHandlerToBody, layer, ignoreIds); _simulation.Sweep(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Capsule(radius, length), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose(origin, Quaternion.Identity), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyVelocity(direction.Normalized()), distance, _bufferPool, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> handler); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = handler.RayCastHit; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.IsValid) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collidableReference = handler.CollidableReference; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (handler.CollidableReference.Mobility == CollidableMobility.Static) { _simulation.Statics.GetDescription(collidableReference.Handle, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> description); result.HitEntityId = _staticHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = description.Pose.Position; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reference = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyReference(collidableReference.Handle, _simulation.Bodies); result.HitEntityId = _dynamicHandlerToBody[collidableReference.Handle].Id; result.CollidableCenter = reference.Pose.Position; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CapsuleOverlap</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, BodyMobilityField bodyMobilityField, CollisionLayer layer, List&lt;Overlap&gt; overlaps</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = height - <span class="hljs-number"><span class="hljs-number">2</span></span> * radius; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BepupOverlapHitHandler( bodyMobilityField, layer, _staticHandlerToBody, _dynamicHandlerToBody, overlaps); _simulation.Sweep( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Capsule(radius, length), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose(origin, Quaternion.Identity), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyVelocity(Vector3.Zero), <span class="hljs-number"><span class="hljs-number">0</span></span>, _bufferPool, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> handler); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDynamicBox</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, Vector3 size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box(size.X, size.Y, size.Z); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pose = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose() { Position = origin, Orientation = rotation }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = CreateDynamic(shape, pose, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, id, layer); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body = _dynamicHandlerToBody[handler]; body.Box = shape; _dynamicHandlerToBody[handler] = body; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateStaticBox</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, Vector3 size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Box(size.X, size.Y, size.Z); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pose = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose() { Position = origin, Orientation = rotation }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler =CreateStatic(shape, pose, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, id, layer); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body = _staticHandlerToBody[handler]; body.Box = shape; _staticHandlerToBody[handler] = body; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateStaticCapsule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = height - <span class="hljs-number"><span class="hljs-number">2</span></span> * radius; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Capsule(radius, length); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pose = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose() { Position = origin, Orientation = rotation }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler =CreateStatic(shape, pose, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, id, layer); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body = _staticHandlerToBody[handler]; body.Capsule = shape; _staticHandlerToBody[handler] = body; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateDynamicCapsule</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Vector3 origin, Quaternion rotation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, CollisionLayer layer</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = height - <span class="hljs-number"><span class="hljs-number">2</span></span> * radius; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shape = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Capsule(radius, length); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pose = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RigidPose() { Position = origin, Orientation = rotation }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = CreateDynamic(shape, pose, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, id, layer); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body = _dynamicHandlerToBody[handler]; body.Capsule = shape; _dynamicHandlerToBody[handler] = body; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CreateDynamic&lt;TShape&gt;(TShape shape, RigidPose pose, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isCapsule, <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> id, CollisionLayer collisionLayer) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> TShape : <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span>, IShape { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activity = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyActivityDescription() { SleepThreshold = <span class="hljs-number"><span class="hljs-number">-1</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collidable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CollidableDescription() { Shape = _simulation.Shapes.Add(shape), SpeculativeMargin = <span class="hljs-number"><span class="hljs-number">0.1f</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> capsuleDescription = BodyDescription.CreateKinematic(pose, collidable, activity); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = _simulation.Bodies.Add(capsuleDescription); _dynamicIds.Add(id); _dynamicIdToHandler.Add(id, handler); _dynamicHandlerToBody.Add(handler, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DynamicBody { BodyReference = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BodyReference(handler, _simulation.Bodies), Id = id, IsCapsule = isCapsule, CollisionLayer = collisionLayer }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> handler; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> CreateStatic&lt;TShape&gt;(TShape shape, RigidPose pose, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isCapsule, <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> id, CollisionLayer collisionLayer) <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> TShape : <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span>, IShape { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> capsuleDescription = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StaticDescription() { Pose = pose, Collidable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CollidableDescription() { Shape = _simulation.Shapes.Add(shape), SpeculativeMargin = <span class="hljs-number"><span class="hljs-number">0.1f</span></span>, } }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = _simulation.Statics.Add(capsuleDescription); _staticIds.Add(id); _staticIdToHandler.Add(id, handler); _staticHandlerToBody.Add(handler, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StaticBody { Description = capsuleDescription, Id = id, IsCapsule = isCapsule, CollisionLayer = collisionLayer }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> handler; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RemoveOrphanedDynamicBodies</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TableSet currentWorld</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toDel = <span class="hljs-keyword"><span class="hljs-keyword">stackalloc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>[_dynamicIds.Count]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toDelIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> _dynamicIdToHandler) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentWorld.DynamicPhysicsBody.HasCmp(i.Key)) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } toDel[toDelIndex] = i.Key; toDelIndex++; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; toDelIndex; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = toDel[i]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handler = _dynamicIdToHandler[id]; _simulation.Bodies.Remove(handler); _dynamicHandlerToBody.Remove(handler); _dynamicIds.Remove(id); _dynamicIdToHandler.Remove(id); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HasBody</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _staticIdToHandler.ContainsKey(id) || _dynamicIdToHandler.ContainsKey(id); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RestoreBodiesFromPreviousTick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SimulationSlice previous</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> oldStaticCount = previous._staticIds.Count; <span class="hljs-comment"><span class="hljs-comment">// add created static objects for (int i = 0; i &lt; oldStaticCount; i++) { var oldId = previous._staticIds[i]; if (!_staticIds.Contains(oldId)) { var oldHandler = previous._staticIdToHandler[oldId]; var oldBody = previous._staticHandlerToBody[oldHandler]; if (oldBody.IsCapsule) { var handler = CreateStatic(oldBody.Capsule, oldBody.Description.Pose, true, oldId, oldBody.CollisionLayer); var body = _staticHandlerToBody[handler]; body.Capsule = oldBody.Capsule; _staticHandlerToBody[handler] = body; } else { var handler = CreateStatic(oldBody.Box, oldBody.Description.Pose, false, oldId, oldBody.CollisionLayer); var body = _staticHandlerToBody[handler]; body.Box = oldBody.Box; _staticHandlerToBody[handler] = body; } } } // delete not existing dynamic objects var newDynamicCount = _dynamicIds.Count; var idsToDel = stackalloc uint[_dynamicIds.Count]; int delIndex = 0; for (int i = 0; i &lt; newDynamicCount; i++) { var newId = _dynamicIds[i]; if (!previous._dynamicIds.Contains(newId)) { idsToDel[delIndex] = newId; delIndex++; } } for (int i = 0; i &lt; delIndex; i++) { var id = idsToDel[i]; var handler = _dynamicIdToHandler[id]; _simulation.Bodies.Remove(handler); _dynamicHandlerToBody.Remove(handler); _dynamicIds.Remove(id); _dynamicIdToHandler.Remove(id); } // add created dynamic objects var oldDynamicCount = previous._dynamicIds.Count; for (int i = 0; i &lt; oldDynamicCount; i++) { var oldId = previous._dynamicIds[i]; if (!_dynamicIds.Contains(oldId)) { var oldHandler = previous._dynamicIdToHandler[oldId]; var oldBody = previous._dynamicHandlerToBody[oldHandler]; if (oldBody.IsCapsule) { var handler = CreateDynamic(oldBody.Capsule, oldBody.BodyReference.Pose, true, oldId, oldBody.CollisionLayer); var body = _dynamicHandlerToBody[handler]; body.Capsule = oldBody.Capsule; _dynamicHandlerToBody[handler] = body; } else { var handler = CreateDynamic(oldBody.Box, oldBody.BodyReference.Pose, false, oldId, oldBody.CollisionLayer); var body = _dynamicHandlerToBody[handler]; body.Box = oldBody.Box; _dynamicHandlerToBody[handler] = body; } } } } public void Update() { _simulation.Timestep(GameState.TickDurationSec); } public void UpdateBody(uint id, Vector3 position, float angle) { if (_staticIdToHandler.TryGetValue(id, out var handler)) { _simulation.Statics.GetDescription(handler, out var staticDescription); staticDescription.Pose.Position = position; staticDescription.Pose.Orientation = Quaternion.CreateFromAxisAngle(new Vector3(0, 1, 0), angle); _simulation.Statics.ApplyDescription(handler, staticDescription); } else if(_dynamicIdToHandler.TryGetValue(id, out handler)) { BodyReference reference = new BodyReference(handler, _simulation.Bodies); reference.Pose.Position = position; reference.Pose.Orientation = Quaternion.CreateFromAxisAngle(new Vector3(0, 1, 0), angle); } } public void Dispose() { _simulation.Clear(); } } public void Dispose() { _bufferPool.Clear(); } } }</span></span></code> </pre> <br></div></div><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุชูููุฐ ุงูุณุฌู ุนูู ุงูุฎุงุฏู ุ ูุญุชุงุฌ ุฅูู ุชุทุจูู ุชุงุฑูุฎ ุงูููุฒูุงุก ุนูู ุงูุนููู.  ูุฏู ุนููู ุงููุญุฏุฉ ูุฏููุง ูุถุน ูุญุงูุงุฉ ููุฎุงุฏู - ูุณูููุง ุงููุญุงูุงุฉ ุงููุญููุฉ - ุญูุซ ูุชู ุชุดุบูู ุฑูุฒ ุงูุฎุงุฏู ูุน ุงูุนููู.  ูุญู ูุณุชุฎุฏู ูุฐุง ุงููุถุน ูููุงุฐุฌ ุฃูููุฉ ุณุฑูุนุฉ ูููุฒุงุช ุงููุนุจุฉ. <br><br>  ูุซู Bepu ุ PhysX ูุง ููุฌุฏ ูุฏูู ุฏุนู ุงูุชุงุฑูุฎ.  ููุง ุงุณุชุฎุฏููุง ููุณ ุงูููุฑุฉ ุจุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุนูููุงุช ุงููุญุงูุงุฉ ุงููุงุฏูุฉ ููู ุนูุงูุฉ ูู ุงูุชุงุฑูุฎ ููุง ูู ุงูุฎุงุฏู.  ููุน ุฐูู ุ ุชูุฑุถ ุงููุญุฏุฉ ุชูุงุตูููุง ุงูุฎุงุตุฉ ุนูู ุงูุนูู ูุน ุงููุญุฑูุงุช ุงููุงุฏูุฉ.  ููุน ุฐูู ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ููุง ุฅูู ุฃู ูุดุฑูุนูุง ูุฏ ุชู ุชุทููุฑู ุนูู Unity 2018.4 (LTS) ุ ูุฃู ุจุนุถ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฏ ุชุชุบูุฑ ูู ุงูุฅุตุฏุงุฑุงุช ุงูุฃุญุฏุซ ุ ูุฐูู ูู ุชููู ููุงู ูุดุงูู ูุซููุง. <br><br>  ูุงูุช ุงููุดููุฉ ุฃู ุงููุญุฏุฉ ูู ุชุณูุญ ุจุฅูุดุงุก ูุญุงูุงุฉ ูุงุฏูุฉ ูููุตูุฉ (ุฃู ุ ูู ูุตุทูุญุงุช PhysX ุ ูุดูุฏ) ุ ูุฐูู ูููุง ุจุชูููุฐ ูู ุนูุงูุฉ ูู ุชุงุฑูุฎ ุงูููุฒูุงุก ุนูู ุงููุญุฏุฉ ููุดูุฏ ูููุตู. <br><br>  ุชูุช ูุชุงุจุฉ ูุฆุฉ ุบูุงู ุนูู ูุซู ูุฐู ุงููุดุงูุฏ - UnityPhysicsHistorySlice: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnityPhysicsHistorySlice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SphereCastDelegate sphereCastDelegate, OverlapSphereNonAlloc overlapSphere, CapsuleCastDelegate capsuleCast, OverlapCapsuleNonAlloc overlapCapsule, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name</span></span></span><span class="hljs-function">)</span></span> { _scene = SceneManager.CreateScene(name, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CreateSceneParameters() { localPhysicsMode = LocalPhysicsMode.Physics3D }); _physicsScene = _scene.GetPhysicsScene(); _sphereCast = sphereCastDelegate; _capsuleCast = capsuleCast; _overlapSphere = overlapSphere; _overlapCapsule = overlapCapsule; _boxPool = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PhysicsSceneObjectsPool&lt;BoxCollider&gt;(_scene, <span class="hljs-string"><span class="hljs-string">"box"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); _capsulePool = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PhysicsSceneObjectsPool&lt;UnityEngine.CapsuleCollider&gt;(_scene, <span class="hljs-string"><span class="hljs-string">"sphere"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); }</code> </pre> <br>  ุงููุดููุฉ ุงูุซุงููุฉ ูู Unity ูู ุฃู ูู ุงูุนูู ูุน ุงูููุฒูุงุก ูุชู ูู ุฎูุงู ูุฆุฉ Physics ุงูุณุงููุฉ ุ ูุงูุชู ูุง ุชุณูุญ ูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุงูุฎุงุตุฉ ุจูุง ุจุชูููุฐ ุจุฑุงูุฌ rakecasts ูุนูููุงุช ุงููุณุญ ูู ูุดูุฏ ูุนูู.  ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฐู ุชุนูู ููุท ูุน ูุดูุฏ ูุดุท ูุงุญุฏ.  ููุน ุฐูู ุ ูุณูุญ ูู ูุญุฑู PhysX ุจุงูุนูู ูุน ุงูุนุฏูุฏ ูู ุงููุดุงูุฏ ูู ููุณ ุงูููุช ุ ูุง ุนููู ุณูู ุงุณุชุฏุนุงุก ุงูุทุฑู ุงูุตุญูุญุฉ.  ูุญุณู ุงูุญุธ ุ ูุงูุช ุงููุญุฏุฉ ุจุฅุฎูุงุก ูุซู ูุฐู ุงูุฃุณุงููุจ ุฎูู ูุงุฌูุฉ ูุฆุฉ Physics.cs ุ ููุงู ูู ูุง ุชุจูู ูู ุงููุตูู ุฅูููุง.  ููุฏ ูุนููุง ุฐูู ูุซู ูุฐุง: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุงูููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">MethodInfo raycastMethod = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Physics).GetMethod(<span class="hljs-string"><span class="hljs-string">"Internal_SphereCast"</span></span>, BindingFlags.NonPublic | BindingFlags.Static); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sphereCast = (SphereCastDelegate) Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(SphereCastDelegate), raycastMethod); MethodInfo overlapSphereMethod = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Physics).GetMethod(<span class="hljs-string"><span class="hljs-string">"OverlapSphereNonAlloc_Internal"</span></span>, BindingFlags.NonPublic | BindingFlags.Static); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> overlapSphere = (OverlapSphereNonAlloc) Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(OverlapSphereNonAlloc), overlapSphereMethod); MethodInfo capsuleCastMethod = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Physics).GetMethod(<span class="hljs-string"><span class="hljs-string">"Internal_CapsuleCast"</span></span>, BindingFlags.NonPublic | BindingFlags.Static); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> capsuleCast = (CapsuleCastDelegate) Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(CapsuleCastDelegate), capsuleCastMethod); MethodInfo overlapCapsuleMethod = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Physics).GetMethod(<span class="hljs-string"><span class="hljs-string">"OverlapCapsuleNonAlloc_Internal"</span></span>, BindingFlags.NonPublic | BindingFlags.Static); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> overlapCapsule = (OverlapCapsuleNonAlloc) Delegate.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(OverlapCapsuleNonAlloc), overlapCapsuleMethod);</code> </pre> <br></div></div><br>  ุฎูุงู ุฐูู ุ ูู ููู ุฑูุฒ ุชุทุจูู UnityPhysicsHistorySlice ูุฎุชูููุง ูุซูุฑูุง ุนูุง ูุงู ุนููู ูู BepuSimulationSlice. <br><br>  ูุจุงูุชุงูู ุ ุญุตููุง ุนูู ุชุทุจูููู ูููุฒูุงุก ุงููุนุจุฉ: ุนูู ุงูุนููู ูุนูู ุงูุฎุงุฏู. <br><br>  ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุงูุงุฎุชุจุงุฑ. <br><br>  ุฃุญุฏ ุฃูู ูุคุดุฑุงุช "ุตุญุฉ" ุนููููุง ูู ูุนููุฉ ุนุฏุฏ ุงูุฃููุงุฑ ุงูุฎุงุทุฆุฉ ูุน ุงูุฎุงุฏู.  ูุจู ุงูุชุจุฏูู ุฅูู ูุญุฑูุงุช ูุนููุฉ ูุฎุชููุฉ ุ ุชุจุงูู ูุฐุง ุงููุคุดุฑ ุฎูุงู 1-2ูช - ุฃู ุฃูู ุฎูุงู ูุนุฑูุฉ ุงุณุชูุฑุช 9000 ุนูุงูุฉ (ุฃู 5 ุฏูุงุฆู) ุ ููุง ูุฎุทุฆูู ูู ุนูุงูุงุช ูุญุงูุงุฉ 90-180.  ููุฏ ุญุตููุง ุนูู ูุฐู ุงููุชุงุฆุฌ ูู ุงูุนุฏูุฏ ูู ุฅุตุฏุงุฑุงุช ุงููุนุจุฉ ูู ุงูุตุงูุฉ ุงููุงุนูุฉ.  ุจุนุฏ ุงูุชุญูู ุฅูู ูุญุฑูุงุช ูุฎุชููุฉ ุ ุชููุนูุง ูููุงู ูููุงู ููุฐุง ุงููุคุดุฑ - ุฑุจูุง ุนุฏุฉ ูุฑุงุช - ุจุนุฏ ูู ุดูุก ุ ูููุง ุงูุขู ุจุชูููุฐ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุฎุชููุฉ ุนูู ุงูุนููู ูุงูุฎุงุฏู ุ ูุจุฏุง ูู ุงูููุทูู ุฃู ุงูุฃุฎุทุงุก ูู ุงูุญุณุงุจุงุช ุจูุงุณุทุฉ ุฎูุงุฑุฒููุงุช ูุฎุชููุฉ ุณุชุชุฑุงูู ุจุณุฑุนุฉ.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุงุชุถุญ ุฃู ูุนุงูู ุงูุชุจุงูู ููุง ููุท 0.2-0.5 ูช ูุจูุบ ูุชูุณุท โโ2-2.5 ูช ููู ูุนุฑูุฉ ุ ูุงูุชู ุชูุงุณุจูุง ุชูุงูุง. <br><br>  ุชุณุชุฎุฏู ูุนุธู ุงููุญุฑูุงุช ูุงูุชูููุงุช ุงูุชู ุจุญุซูุงูุง ููุณ ุงูููุฏ ุนูู ูู ูู ุงูุนููู ูุงูุฎุงุฏู.  ููุน ุฐูู ุ ุชู ุชุฃููุฏ ูุฑุถูุชูุง ูุน ุฅููุงููุฉ ุงุณุชุฎุฏุงู ุงููุญุฑูุงุช ุงูููุฒูุงุฆูุฉ ุงููุฎุชููุฉ.  ุงูุณุจุจ ุงูุฑุฆูุณู ูุฑุงุก ุงุฑุชูุงุน ูุนุฏู ุงูุชุจุงูู ุจุดูู ุทููู ูู ุฃููุง ูุญุณุจ ุญุฑูุฉ ุงูุฃุฌุณุงู ูู ุงููุถุงุก ูุชุตุงุฏูุงุช ุฃุญุฏ ุฃูุธูุฉ ECS ุงูุฎุงุตุฉ ุจูุง.  ูุฐุง ุงูุฑูุฒ ูู ููุณู ุนูู ูู ูู ุงูุนููู ูุนูู ุงูุฎุงุฏู.  ูู ุงููุญุฑู ุงููุนูู ุ ููุง ุจุญุงุฌุฉ ุฅูู ุญุณุงุจ ุณุฑูุน ูุจุฑุงูุฌ rakecasts ู sweepcasts ุ ููู ุชุฎุชูู ูุชุงุฆุฌ ูุฐู ุงูุนูููุงุช ูู ุงููุงูุน ุนู ุงุซููู ูู ูุญุฑูุงุชูุง. <br><br><h2 style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุฑุฃ </h2><br>  ูู ุงูุฎุชุงู ุ ูุงูุนุงุฏุฉ ุ ุฅููู ุจุนุถ ุงูุฑูุงุจุท ุฐุงุช ุงูุตูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/pixonic/blog/481880/">ุงูููุฒูุงุก ููุทูู ุงููุงุฑ ุญูุงูุฉ ุงูุฃุตูุงู ุงููุจุงุชูุฉ ุงููุญููู ุ ุงูุฌุฒุก 1</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/pixonic/blog/415959/">ุฑูุฒ ุงูุดุจูุฉ ููุทูู ุงููุงุฑ ุญูุงูุฉ ุงูุฃุตูุงู ุงููุจุงุชูุฉ ุงููุญููู</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://gafferongames.com/">ูุฏููุฉ ุบููู ููุฏูุฑ ุญูู ููููุฉ ูุชุงุจุฉ ุฑูุฒ ุงูุดุจูุฉ ูู ุงูุฃูุนุงุจ</a> ุ </li><li style=";text-align:right;direction:rtl">  <a href="https://www.gdcvault.com/play/1026322/Back-to-the-Future-Working">ูุญุงูุงุฉ ุญุชููุฉ ูุฑูุฒ ุงูุดุจูุฉ ูู For Honor</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar485150/">https://habr.com/ru/post/ar485150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar485128/index.html">ุงููุงุฐ ุนูู ุชุฑุงุฎูุต Mikrotik CHR</a></li>
<li><a href="../ar485132/index.html">ุงูุถู ุฅูู Google Play Indie Games Festival</a></li>
<li><a href="../ar485136/index.html">ุชุชุจุน Istio ูุงูุฑุตุฏ: Microservices ููุจุฏุฃ ุนุฏู ุงููููู</a></li>
<li><a href="../ar485144/index.html">ููู ุฃุตูุญุช ูุงุนุฏุฉ ููุณูุฑุฉ ููุง ุฌุงุก ูููุง</a></li>
<li><a href="../ar485148/index.html">ูุฐุง ุฑุงุฆุนุชูู ููููููุฏ</a></li>
<li><a href="../ar485152/index.html">ุฑุจูุน ุงูุชุฏุฑูุจ ููุทูุฑู ุงููุญููู ูู Redmadrobot</a></li>
<li><a href="../ar485154/index.html">ููููุฉ ุฌุนู ุงููููุณ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ ูู ุงููุทูุฑ: ูุธุงู ุชุญููุฒ ุงููุจุฑูุฌ</a></li>
<li><a href="../ar485156/index.html">ููู ุชููู ุชูููู ุฌูุงุนู ูุญูู (ุงูุฌุฒุก ุงูุฃูู)</a></li>
<li><a href="../ar485158/index.html">ูููููุงู ูุงููููู. ุงูุฑุฌู ุงูุฐู ุฃุฑุงุฏ ุฅุทุนุงู ุงูุนุงูู ููู ูุชููู ุฌูุนุง ูู ุฒูุฒุงูุฉ ุงูุณุฌู</a></li>
<li><a href="../ar485160/index.html">ูุง ูู ุฃูุง ูู ุญูุถ ุฃู ูุฌูุฉ ูุธุฑ ูุฎุชููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>