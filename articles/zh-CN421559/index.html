<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤¸ğŸ¿ ğŸ¤¾ ğŸ‘©ğŸ¿â€ğŸ’» iOSåº”ç”¨ç¨‹åºä¸­çš„ç»„ä»¶UIæ¶æ„ ğŸ”™ ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ½ ğŸ‘©ğŸ»â€ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ 

 æˆ‘å«Valeraï¼Œä½œä¸ºBadooå›¢é˜Ÿçš„ä¸€å‘˜ï¼Œä¸¤å¹´æ¥æˆ‘ä¸€ç›´åœ¨å¼€å‘iOSåº”ç”¨ç¨‹åºã€‚ æˆ‘ä»¬çš„ä¼˜å…ˆäº‹é¡¹ä¹‹ä¸€æ˜¯æ˜“äºç»´æŠ¤ä»£ç ã€‚ ç”±äºæ¯å‘¨éƒ½ä¼šä½¿ç”¨å¤§é‡æ–°åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é¦–å…ˆè€ƒè™‘åº”ç”¨ç¨‹åºçš„ä½“ç³»ç»“æ„ï¼Œå¦åˆ™å¾ˆéš¾åœ¨ä¸ç ´åç°æœ‰åŠŸèƒ½çš„æƒ…å†µä¸‹å‘äº§å“æ·»åŠ æ–°åŠŸèƒ½ã€‚ æ˜¾ç„¶ï¼Œè¿™ä¹Ÿé€‚ç”¨äºç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰çš„å®ç°ï¼Œè€Œä¸ç®¡è¿™...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>iOSåº”ç”¨ç¨‹åºä¸­çš„ç»„ä»¶UIæ¶æ„</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/421559/"><img src="https://habrastorage.org/webt/x8/bs/so/x8bsso8hy3rdfn3ostzyohesvyc.jpeg"><br><br> å“ˆHaï¼ <br><br> æˆ‘å«Valeraï¼Œä½œä¸ºBadooå›¢é˜Ÿçš„ä¸€å‘˜ï¼Œä¸¤å¹´æ¥æˆ‘ä¸€ç›´åœ¨å¼€å‘iOSåº”ç”¨ç¨‹åºã€‚ æˆ‘ä»¬çš„ä¼˜å…ˆäº‹é¡¹ä¹‹ä¸€æ˜¯æ˜“äºç»´æŠ¤ä»£ç ã€‚ ç”±äºæ¯å‘¨éƒ½ä¼šä½¿ç”¨å¤§é‡æ–°åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é¦–å…ˆè€ƒè™‘åº”ç”¨ç¨‹åºçš„ä½“ç³»ç»“æ„ï¼Œå¦åˆ™å¾ˆéš¾åœ¨ä¸ç ´åç°æœ‰åŠŸèƒ½çš„æƒ…å†µä¸‹å‘äº§å“æ·»åŠ æ–°åŠŸèƒ½ã€‚ æ˜¾ç„¶ï¼Œè¿™ä¹Ÿé€‚ç”¨äºç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰çš„å®ç°ï¼Œè€Œä¸ç®¡è¿™æ˜¯ä½¿ç”¨ä»£ç ï¼ŒXcodeï¼ˆXIBï¼‰è¿˜æ˜¯æ··åˆæ–¹æ³•å®Œæˆçš„ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä»‹ç»ä¸€äº›UIå®ç°æŠ€æœ¯ï¼Œè¿™äº›æŠ€æœ¯ä½¿æˆ‘ä»¬èƒ½å¤Ÿç®€åŒ–ç”¨æˆ·ç•Œé¢çš„å¼€å‘ï¼Œä½¿å…¶çµæ´»ï¼Œæ–¹ä¾¿åœ°è¿›è¡Œæµ‹è¯•ã€‚ æœ¬æ–‡è¿˜æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‹±æ–‡ç‰ˆ</a> ã€‚ <br><br><h2> å¼€å§‹ä¹‹å‰... </h2><br> æˆ‘å°†ä½¿ç”¨Swiftç¼–å†™çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºè€ƒè™‘ç”¨æˆ·ç•Œé¢å®ç°æŠ€æœ¯ã€‚ å•å‡»æŒ‰é’®çš„åº”ç”¨ç¨‹åºå°†æ˜¾ç¤ºä¸€ä¸ªæœ‹å‹åˆ—è¡¨ã€‚ <br><br> å®ƒåŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼š <br><br><ol><li>  <b>ç»„ä»¶</b>æ˜¯è‡ªå®šä¹‰UIç»„ä»¶ï¼Œå³ä»…ä¸ç”¨æˆ·ç•Œé¢ç›¸å…³çš„ä»£ç ã€‚ </li><li>  <b>æ¼”ç¤ºåº”ç”¨ç¨‹åº</b> -æ¼”ç¤ºè§†å›¾æ¨¡å‹å’Œå…¶ä»–ä»…å…·æœ‰UIä¾èµ–é¡¹çš„ç”¨æˆ·ç•Œé¢å®ä½“ã€‚ </li><li>  <b>çœŸæ­£çš„åº”ç”¨</b>æ˜¯è§†å›¾æ¨¡å‹å’Œå…¶ä»–å¯èƒ½åŒ…å«ç‰¹å®šä¾èµ–å…³ç³»å’Œé€»è¾‘çš„å®ä½“ã€‚ </li></ol><br> ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„åˆ†ç¦»ï¼Ÿ æˆ‘å°†åœ¨ä¸‹é¢å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œä½†ç°åœ¨ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬åº”ç”¨ç¨‹åºçš„ç”¨æˆ·ç•Œé¢ï¼š <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nr/vt/gl/nrvtglcxbhadi2ag4ohcuazdhqk.gif" height="600"></div><br> è¿™æ˜¯ä¸€ä¸ªå¼¹å‡ºè§†å›¾ï¼Œå…¶å†…å®¹ä½äºå¦ä¸€ä¸ªå…¨å±è§†å›¾çš„é¡¶éƒ¨ã€‚ ä¸€åˆ‡éƒ½å¾ˆç®€å•ã€‚ <br><br> è¯¥é¡¹ç›®çš„å®Œæ•´æºä»£ç å¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a>ä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰¾åˆ°</a> ã€‚ <br><br> åœ¨ç ”ç©¶UIä»£ç ä¹‹å‰ï¼Œæˆ‘æƒ³å‘æ‚¨ä»‹ç»è¿™é‡Œä½¿ç”¨çš„è¾…åŠ©ç±»Observableã€‚ å…¶ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre><code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value: <span class="hljs-type"><span class="hljs-type">T</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">observe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> closure: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"> old: T, </span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"> new: T)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">ObserverProtocol</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">observeNewAndCall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> closure: @escaping </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">(</span></span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-params"> new: T)</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Void</span></span>) -&gt; <span class="hljs-type"><span class="hljs-type">ObserverProtocol</span></span></code> </pre> <br> å®ƒåªæ˜¯å°†æ‰€æœ‰æ›´æ”¹é€šçŸ¥æ‰€æœ‰å…ˆå‰ç­¾ç½²çš„è§‚å¯Ÿè€…ï¼Œå› æ­¤è¿™æ˜¯KVOï¼ˆé”®å€¼è§‚å¯Ÿï¼‰çš„ä¸€ç§æ›¿ä»£æ–¹æ³•ï¼Œæˆ–è€…ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œè¿˜å¯ä»¥é‡‡ç”¨ååº”å¼ç¼–ç¨‹ã€‚ è¿™æ˜¯ä¸€ä¸ªç”¨æ³•ç¤ºä¾‹ï¼š <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.observers.append(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewModel.items.observe { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] (_, newItems) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.state = newItems.isEmpty ? .zeroCase(type: .empty) : .normal   <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.collectionView.reloadSections(IndexSet(integer: <span class="hljs-number"><span class="hljs-number">0</span></span>)) })</code> </pre> <br> æ§åˆ¶å™¨å°†æ›´æ”¹è®¢é˜…<code>self.viewModel.items</code>å±æ€§ï¼Œå¹¶ä¸”å½“æ›´æ”¹å‘ç”Ÿæ—¶ï¼Œå¤„ç†ç¨‹åºå°†æ‰§è¡Œä¸šåŠ¡é€»è¾‘ã€‚ ä¾‹å¦‚ï¼Œå®ƒæ›´æ–°è§†å›¾çŠ¶æ€å¹¶ç”¨æ–°é¡¹ç›®é‡æ–°åŠ è½½é›†åˆè§†å›¾ã€‚ <br><br> æ‚¨å°†åœ¨ä¸‹é¢çœ‹åˆ°æ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚ <br><br><h2> æ–¹æ³•è®º </h2><br> åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†è®¨è®ºBadooä¸­ä½¿ç”¨çš„å››ç§UIå¼€å‘æŠ€æœ¯ï¼š <br><br>  1.ç”¨ä»£ç å®ç°ç”¨æˆ·ç•Œé¢ã€‚ <br><br>  2.ä½¿ç”¨å¸ƒå±€é”šç‚¹ã€‚ <br><br>  3.ç»„æˆéƒ¨åˆ†-åˆ†è€Œæ²»ä¹‹ã€‚ <br><br>  4.ç”¨æˆ·ç•Œé¢å’Œé€»è¾‘çš„åˆ†ç¦»ã€‚ <br><br><h3>  ï¼ƒ1ï¼šåœ¨ä»£ç ä¸­å®ç°ç”¨æˆ·ç•Œé¢ </h3><br> åœ¨Badooä¸­ï¼Œå¤§å¤šæ•°ç”¨æˆ·å…´è¶£æ˜¯é€šè¿‡ä»£ç å®ç°çš„ã€‚ æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ä½¿ç”¨XIBæˆ–æƒ…èŠ‚æè¦ï¼Ÿ å…¬å¹³çš„é—®é¢˜ã€‚ ä¸»è¦åŸå› æ˜¯ä¸ºä¸­å‹å›¢é˜Ÿç»´æŠ¤ä»£ç çš„ä¾¿åˆ©æ€§ï¼Œå³ï¼š <br><br><ul><li> ä»£ç ä¸­çš„æ›´æ”¹æ¸…æ™°å¯è§ï¼Œè¿™æ„å‘³ç€æ— éœ€è§£æXMLæ•…äº‹æ¿/ XIBæ–‡ä»¶å³å¯æŸ¥æ‰¾åŒäº‹æ‰€åšçš„æ›´æ”¹ï¼› <br></li><li> ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ï¼ŒGitï¼‰æ¯”ä½¿ç”¨â€œå¤§é‡â€ XLMæ–‡ä»¶æ›´å®¹æ˜“ä½¿ç”¨ä»£ç ï¼Œå°¤å…¶æ˜¯åœ¨ä¸­ç­‰å†²çªæ—¶ï¼› è¿˜åº”è€ƒè™‘åˆ°ï¼Œå³ä½¿ç•Œé¢æ²¡æœ‰æ›´æ”¹ï¼ŒXIB /æƒ…èŠ‚æè¦æ–‡ä»¶çš„å†…å®¹ä¹Ÿä¼šåœ¨æ¯æ¬¡ä¿å­˜æ—¶æ›´æ”¹ï¼ˆå°½ç®¡æˆ‘å¬è¯´åœ¨Xcode 9ä¸­è¯¥é—®é¢˜å·²å¾—åˆ°è§£å†³ï¼‰ï¼› <br></li><li> åœ¨å­è§†å›¾ï¼ˆå¸ƒå±€å­è§†å›¾ï¼‰çš„é‡æ–°å¸ƒå±€è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½å¾ˆéš¾åœ¨Interface Builderï¼ˆIBï¼‰ä¸­ä¿®æ”¹å’Œç»´æŠ¤æŸäº›å±æ€§ï¼Œä¾‹å¦‚CALayerå±æ€§ï¼Œè¿™å¯èƒ½å¯¼è‡´è§†å›¾çŠ¶æ€çš„å¤šä¸ªäº‹å®æ¥æºï¼› <br></li><li>  Interface Builderä¸æ˜¯æœ€å¿«çš„å·¥å…·ï¼Œæœ‰æ—¶ç›´æ¥ä½¿ç”¨ä»£ç ä¼šæ›´å¿«ã€‚ <br></li></ul><br> çœ‹ä¸€ä¸‹ä»¥ä¸‹æ§åˆ¶å™¨ï¼ˆFriendsListViewControllerï¼‰ï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> backgroundColor: <span class="hljs-type"><span class="hljs-type">UIColor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cornerRadius: <span class="hljs-type"><span class="hljs-type">CGFloat</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> infoView: <span class="hljs-type"><span class="hljs-type">FriendsListView!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewModel: <span class="hljs-type"><span class="hljs-type">FriendsListViewModelProtocol</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewConfig: <span class="hljs-type"><span class="hljs-type">ViewConfig</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(viewModel: <span class="hljs-type"><span class="hljs-type">FriendsListViewModelProtocol</span></span>, viewConfig: <span class="hljs-type"><span class="hljs-type">ViewConfig</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewModel = viewModel <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewConfig = viewConfig <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(nibName: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, bundle: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">required</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(coder aDecoder: <span class="hljs-type"><span class="hljs-type">NSCoder</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"init(coder:) has not been implemented"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.setupContainerView() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupContainerView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.backgroundColor = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewConfig.backgroundColor <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> infoView = <span class="hljs-type"><span class="hljs-type">FriendsListView</span></span>( frame: .zero, viewModel: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewModel, viewConfig: .defaultConfig) infoView.backgroundColor = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.viewConfig.backgroundColor <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.addSubview(infoView) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.infoView = infoView infoView.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> infoView.leadingAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.leadingAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.trailingAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.trailingAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.topAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.topAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.bottomAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.bottomAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-comment"><span class="hljs-comment">// â€¦. }</span></span></code> </pre> <br> æœ¬ç¤ºä¾‹è¯´æ˜æ‚¨åªèƒ½é€šè¿‡æä¾›è§†å›¾æ¨¡å‹å’Œè§†å›¾é…ç½®æ¥åˆ›å»ºè§†å›¾æ§åˆ¶å™¨ã€‚ æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³è¡¨ç¤ºæ¨¡å‹çš„æ›´å¤šä¿¡æ¯ï¼Œå³MVVMè®¾è®¡æ¨¡å‹ï¼ˆModel-View-ViewModelï¼‰ã€‚ ç”±äºè§†å›¾é…ç½®æ˜¯å®šä¹‰è§†å›¾çš„å¸ƒå±€å’Œæ ·å¼ï¼ˆå³ç¼©è¿›ï¼Œå¤§å°ï¼Œé¢œè‰²ï¼Œå­—ä½“ç­‰ï¼‰çš„ç®€å•ç»“æ„å®ä½“ï¼Œå› æ­¤æˆ‘è®¤ä¸ºæä¾›è¿™æ ·çš„æ ‡å‡†é…ç½®æ˜¯åˆé€‚çš„ï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListViewController</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewConfig</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> defaultConfig: <span class="hljs-type"><span class="hljs-type">FriendsListViewController</span></span>.<span class="hljs-type"><span class="hljs-type">ViewConfig</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">FriendsListViewController</span></span>.<span class="hljs-type"><span class="hljs-type">ViewConfig</span></span>(backgroundColor: .white,                                                   cornerRadius: <span class="hljs-number"><span class="hljs-number">16</span></span>)   } }</code> </pre> <br> æ‰€æœ‰è§†å›¾åˆå§‹åŒ–éƒ½åœ¨<code>setupContainerView</code>æ–¹æ³•ä¸­è¿›è¡Œï¼Œå½“å·²ç»åˆ›å»ºå¹¶åŠ è½½è§†å›¾ä½†å°šæœªåœ¨å±å¹•ä¸Šç»˜åˆ¶è§†å›¾æ—¶ï¼Œä»…ä»viewDidLoadè°ƒç”¨ä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰å¿…è¦çš„å…ƒç´ ï¼ˆå­è§†å›¾ï¼‰éƒ½ç®€å•åœ°æ·»åŠ åˆ°è§†å›¾å±‚æ¬¡ç»“æ„ä¸­ï¼Œç„¶ååº”ç”¨æ ‡è®°ï¼ˆå¸ƒå±€ï¼‰å’Œæ ·å¼ã€‚ <br><br> è¿™æ˜¯è§†å›¾æ§åˆ¶å™¨ç°åœ¨çš„æ ·å­ï¼š <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListPresenter</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">FriendsListPresenterProtocol {   // â€¦   func presentFriendsList</span></span></span></span>(from presentingViewController: UIViewController) {       let controller = Class.createFriendsListViewController( presentingViewController: presentingViewController,           headerViewModel: self.headerViewModel,           contentViewModel: self.contentViewModel)       controller.modalPresentationStyle = .overCurrentContext       controller.modalTransitionStyle = .crossDissolve       presentingViewController.present(controller, animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, completion: nil)   }   <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">func</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">createFriendsListViewController</span></span></span></span>( presentingViewController: UIViewController, headerViewModel: FriendsListHeaderViewModelProtocol,       contentViewModel: FriendsListContentViewModelProtocol) -&gt; FriendsListContainerViewController {      let dismissViewControllerBlock: VoidBlock = { [weak presentingViewController] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>           presentingViewController?.dismiss(animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, completion: nil)       }       let infoViewModel = FriendsListViewModel( headerViewModel: headerViewModel,           contentViewModel: contentViewModel)       let containerViewModel = FriendsListContainerViewModel(onOutsideContentTapAction: dismissViewControllerBlock)       let friendsListViewController = FriendsListViewController( viewModel: infoViewModel, viewConfig: .defaultConfig)       let controller = FriendsListContainerViewController( contentViewController: friendsListViewController,           viewModel: containerViewModel,           viewConfig: .defaultConfig)       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> controller   } }</code> </pre> <br> æ‚¨å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">èŒè´£åˆ†å·¥</a> ï¼Œè¿™ä¸ªæ¦‚å¿µå¹¶ä¸æ¯”åœ¨æ•…äº‹æ¿ä¸Šè°ƒç”¨segueå¤æ‚å¾—å¤šã€‚ <br><br> é‰´äºæˆ‘ä»¬æ‹¥æœ‰æ¨¡å‹ï¼Œå› æ­¤åˆ›å»ºè§†å›¾æ§åˆ¶å™¨éå¸¸ç®€å•ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°ä½¿ç”¨æ ‡å‡†è§†å›¾é…ç½®ï¼š <br><br><pre> <code class="hljs lisp">let friendsListViewController = FriendsListViewController( <span class="hljs-name"><span class="hljs-name">viewModel</span></span>: infoViewModel, viewConfig: .defaultConfig)</code> </pre><br><h3>  ï¼ƒ2ï¼šä½¿ç”¨å¸ƒå±€é”šç‚¹ </h3><br> è¿™æ˜¯å¸ƒå±€ä»£ç ï¼š <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.addSubview(infoView) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.infoView = infoView infoView.translatesAutoresizingMaskIntoConstraints = <span class="hljs-literal"><span class="hljs-literal">false</span></span> infoView.leadingAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.leadingAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.trailingAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.trailingAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.topAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.topAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span> infoView.bottomAnchor.constraint(equalTo: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view.bottomAnchor).isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre><br> ç®€è€Œè¨€ä¹‹ï¼Œæ­¤ä»£ç å°†<code>infoView</code>ç½®äºçˆ¶è§†å›¾ï¼ˆ <code>infoView</code>è§†å›¾ï¼‰çš„å†…éƒ¨ï¼Œç›¸å¯¹äº<code>infoView</code>è§†å›¾çš„åŸå§‹å¤§å°ä½äºåæ ‡ï¼ˆ0ï¼Œ0ï¼‰å¤„ã€‚ <br><br> ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å¸ƒå±€é”šç‚¹ï¼Ÿ å¿«é€Ÿç®€ä¾¿ã€‚ å½“ç„¶ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨è®¾ç½®UIView.frameå¹¶å³æ—¶è®¡ç®—æ‰€æœ‰ä½ç½®å’Œå¤§å°ï¼Œä½†æ˜¯æœ‰æ—¶å®ƒå¯èƒ½ä¼šå˜å¾—è¿‡äºæ··ä¹±å’Œ/æˆ–ä»£ç è¿‡äºåºå¤§ã€‚ <br><br> æ‚¨è¿˜å¯ä»¥ä½¿ç”¨æ–‡æœ¬æ ¼å¼è¿›è¡Œæ ‡è®°ï¼Œå¦‚æ­¤å¤„æ‰€è¿°ï¼Œä½†è¿™ç»å¸¸ä¼šå¯¼è‡´é”™è¯¯ï¼Œå› ä¸ºæ‚¨éœ€è¦ä¸¥æ ¼éµå¾ªæ ¼å¼ï¼Œå¹¶ä¸”Xcodeåœ¨ç¼–å†™/ç¼–è¯‘ä»£ç é˜¶æ®µä¸ä¼šæ£€æŸ¥æ ‡è®°æè¿°æ–‡æœ¬ï¼Œå¹¶ä¸”æ‚¨ä¸èƒ½ä½¿ç”¨ã€Šå®‰å…¨åŒºåŸŸå¸ƒå±€æŒ‡å—ã€‹ï¼š <br><br><pre> <code class="hljs perl">NSLayoutConstraint.constraints( withVisualFormat: <span class="hljs-string"><span class="hljs-string">"V:|-(\(topSpace))-[headerView(headerHeight@200)]-[collectionView(collectionViewHeight@990)]|"</span></span>,   options: [],   metrics: metrics,   views: views)</code> </pre><br> åœ¨å®šä¹‰æ ‡è®°çš„æ–‡æœ¬å­—ç¬¦ä¸²ä¸­çŠ¯é”™è¯¯æˆ–é”™å­—å¾ˆå®¹æ˜“ï¼Œå¯¹å§ï¼Ÿ <br><br><h3>  ï¼ƒ3ï¼šç»„ä»¶-åˆ†è€Œæ²»ä¹‹ </h3><br> æˆ‘ä»¬çš„ç¤ºä¾‹ç”¨æˆ·ç•Œé¢åˆ†ä¸ºå¤šä¸ªç»„ä»¶ï¼Œæ¯ä¸ªç»„ä»¶ä»…æ‰§è¡Œä¸€é¡¹ç‰¹å®šåŠŸèƒ½ã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><ol><li>  <code>FriendsListHeaderView</code>æ˜¾ç¤ºæœ‰å…³æœ‹å‹çš„ä¿¡æ¯å’Œâ€œå…³é—­â€æŒ‰é’®ã€‚ </li><li>  <code>FriendsListContentView</code>æ˜¾ç¤ºå…·æœ‰å¯å•å‡»å•å…ƒæ ¼çš„æœ‹å‹åˆ—è¡¨ï¼Œåˆ°è¾¾åˆ—è¡¨æœ«å°¾æ—¶å°†åŠ¨æ€åŠ è½½å†…å®¹ã€‚ </li><li>  <code>FriendsListView</code>å…ˆå‰ä¸¤ä¸ªè§†å›¾çš„å®¹å™¨ã€‚ </li></ol><br> å¦‚å‰æ‰€è¿°ï¼Œå½“æ¯ä¸ªç»„ä»¶è´Ÿè´£ä¸€ä¸ªå•ç‹¬çš„åŠŸèƒ½æ—¶ï¼ŒBadooæˆ‘ä»¬å–œæ¬¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å”¯ä¸€è´Ÿè´£</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸåˆ™</a> ã€‚ è¿™ä¸ä»…åœ¨é”™è¯¯ä¿®å¤è¿‡ç¨‹ä¸­ï¼ˆè¿™å¯èƒ½ä¸æ˜¯iOSå¼€å‘äººå‘˜å·¥ä½œä¸­æœ€æœ‰è¶£çš„éƒ¨åˆ†ï¼‰æœ‰æ‰€å¸®åŠ©ï¼Œè€Œä¸”åœ¨å¼€å‘æ–°åŠŸèƒ½æœŸé—´ä¹Ÿæœ‰å¸®åŠ©ï¼Œå› ä¸ºè¿™ç§æ–¹æ³•æå¤§åœ°æ‰©å±•äº†å°†æ¥é‡ç”¨ä»£ç çš„å¯èƒ½æ€§ã€‚ <br><br><h3>  ï¼ƒ4ï¼šåˆ†ç¦»ç”¨æˆ·ç•Œé¢å’Œé€»è¾‘ </h3><br> æœ€åä½†åŒæ ·é‡è¦çš„ä¸€ç‚¹æ˜¯ç”¨æˆ·ç•Œé¢å’Œé€»è¾‘çš„åˆ†ç¦»ã€‚ ä¸€ç§å¯ä»¥ä¸ºæ‚¨çš„å›¢é˜ŸèŠ‚çœæ—¶é—´å’Œç¥ç»çš„æŠ€æœ¯ã€‚ ä»å­—é¢ä¸Šçœ‹ï¼šä¸€ä¸ªç”¨äºç”¨æˆ·ç•Œé¢çš„é¡¹ç›®å’Œä¸€ä¸ªç”¨äºä¸šåŠ¡é€»è¾‘çš„é¡¹ç›®ã€‚ <br><br> è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„ä¾‹å­ã€‚ æ‚¨è¿˜è®°å¾—ï¼Œæ¼”ç¤ºæ–‡ç¨¿ï¼ˆpresenterï¼‰çš„æœ¬è´¨å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentFriendsList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(from presentingViewController: UIViewController)</span></span></span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> controller = <span class="hljs-type"><span class="hljs-type">Class</span></span>.createFriendsListViewController( presentingViewController: presentingViewController,       headerViewModel: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.headerViewModel,       contentViewModel: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.contentViewModel)   controller.modalPresentationStyle = .overCurrentContext   controller.modalTransitionStyle = .crossDissolve   presentingViewController.present(controller, animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, completion: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) }</code> </pre> <br> æ‚¨åªéœ€è¦æä¾›æ ‡é¢˜å’Œå†…å®¹çš„è§†å›¾æ¨¡å‹ã€‚ å…¶ä½™éƒ¨åˆ†éšè—åœ¨UIç»„ä»¶çš„ä¸Šè¿°å®ç°ä¸­ã€‚ <br><br> æ ‡å¤´è§†å›¾æ¨¡å‹åè®®å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListHeaderViewModelProtocol</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> friendsCountIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> }   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> closeButtonIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> }   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> friendsCount: <span class="hljs-type"><span class="hljs-type">Observable</span></span>&lt;<span class="hljs-type"><span class="hljs-type">String</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> }   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onCloseAction: <span class="hljs-type"><span class="hljs-type">VoidBlock?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> } }</code> </pre> <br> ç°åœ¨ï¼Œå‡è®¾æ‚¨è¦ä¸ºUIæ·»åŠ è§†è§‰æµ‹è¯•-å°±åƒä¸ºUIç»„ä»¶ä¼ é€’å­˜æ ¹æ¨¡å‹ä¸€æ ·ç®€å•ã€‚ <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListHeaderDemoViewModel</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListHeaderViewModelProtocol</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> friendsCountIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span> = <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: <span class="hljs-string"><span class="hljs-string">"ic_friends_count"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> closeButtonIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span> = <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: <span class="hljs-string"><span class="hljs-string">"ic_close_cross"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> friendsCount: <span class="hljs-type"><span class="hljs-type">Observable</span></span>&lt;<span class="hljs-type"><span class="hljs-type">String</span></span>&gt;   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onCloseAction: <span class="hljs-type"><span class="hljs-type">VoidBlock?</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>() {       <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> friendsCountString = <span class="hljs-string"><span class="hljs-string">"\(Int.random(min: 1, max: 5000))"</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.friendsCount = <span class="hljs-type"><span class="hljs-type">Observable</span></span>(friendsCountString)   } }</code> </pre> <br> çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³å‘åº”ç”¨ç¨‹åºçš„ç»„ä»¶ä¸­æ·»åŠ ä¸šåŠ¡é€»è¾‘ï¼Œè¿™å¯èƒ½éœ€è¦æ•°æ®æä¾›è€…ï¼Œæ•°æ®æ¨¡å‹ç­‰ï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListHeaderViewModel</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FriendsListHeaderViewModelProtocol</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> friendsCountIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> closeButtonIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> friendsCount: <span class="hljs-type"><span class="hljs-type">Observable</span></span>&lt;<span class="hljs-type"><span class="hljs-type">String</span></span>&gt; = <span class="hljs-type"><span class="hljs-type">Observable</span></span>(<span class="hljs-string"><span class="hljs-string">"0"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onCloseAction: <span class="hljs-type"><span class="hljs-type">VoidBlock?</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dataProvider: <span class="hljs-type"><span class="hljs-type">FriendsListDataProviderProtocol</span></span>   <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> observers: [<span class="hljs-type"><span class="hljs-type">ObserverProtocol</span></span>] = []   <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(dataProvider: <span class="hljs-type"><span class="hljs-type">FriendsListDataProviderProtocol</span></span>,        friendsCountIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span>,        closeButtonIcon: <span class="hljs-type"><span class="hljs-type">UIImage?</span></span>) {       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.dataProvider = dataProvider       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.friendsCountIcon = friendsCountIcon       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.closeButtonIcon = closeButtonIcon       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.setupDataObservers()   }   <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupDataObservers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.observers.append(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.dataProvider.totalItemsCount.observeNewAndCall { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] (newCount) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>           <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.friendsCount.value = <span class="hljs-string"><span class="hljs-string">"\(newCount)"</span></span>       })   } }</code> </pre> <br> æœ‰ä»€ä¹ˆä¼šæ›´å®¹æ˜“ï¼Ÿ åªéœ€å®ç°æ•°æ®æä¾›ç¨‹åº-é‚£å°±å¼€å§‹å§ï¼ <br><br> å†…å®¹æ¨¡å‹çš„å®ç°çœ‹èµ·æ¥æœ‰äº›å¤æ‚ï¼Œä½†æ˜¯èŒè´£åˆ†ç¦»ä»ç„¶å¤§å¤§ç®€åŒ–äº†ç”Ÿæ´»ã€‚ è¿™æ˜¯ä¸€ä¸ªå¦‚ä½•åœ¨å•å‡»æŒ‰é’®æ—¶å®ä¾‹åŒ–å¹¶æ˜¾ç¤ºæœ‹å‹åˆ—è¡¨çš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentRealFriendsList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sender: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> avatarPlaceholderImage = <span class="hljs-type"><span class="hljs-type">UIImage</span></span>(named: <span class="hljs-string"><span class="hljs-string">"avatar-placeholder"</span></span>)   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> itemFactory = <span class="hljs-type"><span class="hljs-type">FriendsListItemFactory</span></span>(avatarPlaceholderImage: avatarPlaceholderImage)   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dataProvider = <span class="hljs-type"><span class="hljs-type">FriendsListDataProvider</span></span>(itemFactory: itemFactory)   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> viewModelFactory = <span class="hljs-type"><span class="hljs-type">FriendsListViewModelFactory</span></span>(dataProvider: dataProvider)   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> headerViewModel = viewModelFactory.makeHeaderViewModel()   headerViewModel.onCloseAction = { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.dismiss(animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, completion: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)   }   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> contentViewModel = viewModelFactory.makeContentViewModel()   <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> presenter = <span class="hljs-type"><span class="hljs-type">FriendsListPresenter</span></span>( headerViewModel: headerViewModel,       contentViewModel: contentViewModel)   presenter.presentFriendsList(from: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) }</code> </pre> <br> æ­¤æŠ€æœ¯æœ‰åŠ©äºå°†ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡é€»è¾‘éš”ç¦»ã€‚ æ­¤å¤–ï¼Œè¿™ä½¿æ‚¨å¯ä»¥é€šè¿‡å¯è§†åŒ–æµ‹è¯•è¦†ç›–æ•´ä¸ªUIï¼Œå¹¶å°†æµ‹è¯•æ•°æ®ä¼ é€’ç»™ç»„ä»¶ï¼ å› æ­¤ï¼Œæ— è®ºæ˜¯å¯åŠ¨äº§å“è¿˜æ˜¯å·²ç»å®Œæˆçš„äº§å“ï¼Œç”¨æˆ·ç•Œé¢å’Œç›¸å…³ä¸šåŠ¡é€»è¾‘çš„åˆ†ç¦»å¯¹äºé¡¹ç›®çš„æˆåŠŸè‡³å…³é‡è¦ã€‚ <br><br><h2> ç»“è®º </h2><br> å½“ç„¶ï¼Œè¿™äº›åªæ˜¯Badooä¸­ä½¿ç”¨çš„ä¸€äº›æŠ€æœ¯ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æƒ…å†µä¸‹çš„é€šç”¨è§£å†³æ–¹æ¡ˆã€‚ å› æ­¤ï¼Œè¯·åœ¨è¯„ä¼°å®ƒä»¬æ˜¯å¦é€‚åˆæ‚¨å’Œæ‚¨çš„é¡¹ç›®åä½¿ç”¨å®ƒä»¬ã€‚ <br><br> è¿˜æœ‰å…¶ä»–æ–¹æ³•ï¼Œä¾‹å¦‚ä½¿ç”¨Interface Builderçš„XIBå¯é…ç½®UIç»„ä»¶ï¼ˆåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬çš„</a>å¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç¯‡æ–‡ç« </a>ä¸­è¿›è¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†ä»‹ç»</a> ï¼‰ï¼Œä½†æ˜¯ç”±äºå„ç§åŸå› ï¼Œå®ƒä»¬åœ¨Badooä¸­æ²¡æœ‰ä½¿ç”¨ã€‚ è¯·è®°ä½ï¼Œæ¯ä¸ªäººå¯¹å…¨å±€éƒ½æœ‰è‡ªå·±çš„çœ‹æ³•å’Œè¿œè§ï¼Œå› æ­¤ï¼Œä¸ºäº†å¼€å‘æˆåŠŸçš„é¡¹ç›®ï¼Œæ‚¨åº”è¯¥åœ¨å›¢é˜Ÿä¸­è¾¾æˆå…±è¯†ï¼Œå¹¶é€‰æ‹©æœ€é€‚åˆå¤§å¤šæ•°æƒ…å†µçš„æ–¹æ³•ã€‚ <br><br> æ„¿æ–¯å¨å¤«ç‰¹å’Œä½ åœ¨ä¸€èµ·ï¼ <br><br> èµ„æ–™æ¥æº <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHubä¸Šçš„</a>å®Œæ•´é¡¹ç›®ä»£ç  <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬æ–‡è‹±æ–‡ç‰ˆ</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ›å»ºè‡ªå®šä¹‰UIç»„ä»¶</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å»ºç­‘iOSæ¨¡æ¿</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Swiftä¸­çš„å»ºæ¨¡çŠ¶æ€</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Swiftä¸­çš„SOLIDåŸç†</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NSLayoutAnchor</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºçº¦æŸ</a> <br></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421559/">https://habr.com/ru/post/zh-CN421559/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421549/index.html">æˆ‘ä»¬æ­£åœ¨ç¼–å†™æŠ€æœ¯æ–‡æ¡£ï¼šå¤–è¡ŒæŒ‡å—</a></li>
<li><a href="../zh-CN421551/index.html">ç²¾é€šVuex-ä»é›¶åˆ°è‹±é›„</a></li>
<li><a href="../zh-CN421553/index.html">æˆ‘ä»¬å…±äº«æŠ€æœ¯å†…å®¹ï¼šæˆ‘ä»¬åœ¨ä¸€ä¸ªç«™ç‚¹ä¸Šæ”¶é›†äº†æ‰€æœ‰ææ–™</a></li>
<li><a href="../zh-CN421555/index.html">WideNESé¡¹ç›®-è¶…è¶ŠNESå±å¹•çš„è¾¹ç•Œ</a></li>
<li><a href="../zh-CN421557/index.html">å…¬å¼€è¯¾â€œ Javaå¼‚æ­¥ç¼–ç¨‹â€</a></li>
<li><a href="../zh-CN421563/index.html">æ‚¨å¯èƒ½éœ€è¦æ”¹åä»¥æ‘†è„±èƒŒéƒ¨ç–¼ç—›ã€‚</a></li>
<li><a href="../zh-CN421565/index.html">ç²—é²çš„ç±»äººæœºå™¨äººå¦‚ä½•æ¬ºéª—æ‚¨</a></li>
<li><a href="../zh-CN421567/index.html">è®¨è®ºï¼šä¸å¯»å¸¸çš„ä¾¿æºå¼éŸ³å“-è·‘è½¦ï¼Œå¤å¤æ”¶éŸ³æœºå’Œâ€œéŸ³å“é´â€</a></li>
<li><a href="../zh-CN421569/index.html">æœ€é‡è¦çš„æ˜¯Gamescom 2018-Nvidia RTXï¼ŒCyberâ€‹â€‹punk 2077ï¼ŒMetro Exodus</a></li>
<li><a href="../zh-CN421571/index.html">åŸºç»´ Xamarin ååº”æœ¬æœºã€‚ ä¸‰ä¸ªæ¡†æ¶-ä¸€ä¸ªå®éªŒï¼ˆç¬¬3éƒ¨åˆ†ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>