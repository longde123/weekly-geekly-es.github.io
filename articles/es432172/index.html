<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚ÄçüöÄ üéüÔ∏è üíµ Invitaci√≥n peligrosa, o c√≥mo funciona la carga de combate para un correo electr√≥nico de phishing üôà üò´ üèûÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recientemente, los especialistas de PT ESC descubrieron un documento en formato Publisher llamado "Invitaci√≥n 29-30 de noviembre de 2018.pub" (1edd5b6...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Invitaci√≥n peligrosa, o c√≥mo funciona la carga de combate para un correo electr√≥nico de phishing</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432172/"><img src="https://habrastorage.org/webt/hh/mj/f1/hhmjf18rranoihy6liikn8gvlq0.jpeg"><br><br>  Recientemente, los especialistas de PT ESC descubrieron un documento en formato Publisher llamado "Invitaci√≥n 29-30 de noviembre de 2018.pub" (1edd5b6a02ec82cec381c1a1ec74a67e).  En este art√≠culo, le diremos c√≥mo un documento de aspecto ordinario se convierte en un troyano, lo que permite a un atacante capturar im√°genes de c√°maras web, grabar sonido por comando o cuando se detecta una ventana de Skype, ejecutar scripts de PowerShell, tomar capturas de pantalla, copiar archivos de dispositivos multimedia. <a name="habracut"></a><br><br>  Entonces, cuando abre el documento, aparece una ventana con un borr√≥n de documento borroso y una solicitud para incluir el script de Microsoft Publisher. <br><br><img src="https://habrastorage.org/webt/6z/gx/0e/6zgx0evgnzve3k9tdrjtlkqhvhe.png"><br><br>  Despu√©s de que el usuario lo enciende, el script integrado en el documento se ejecuta en JavaScript.  Se ve as√≠: <br><br><img src="https://habrastorage.org/webt/wt/ig/pt/wtigptknnjdcp4noozibkmcisci.png"><br><br>  El resultado del script ser√° la decodificaci√≥n de dos archivos, PDF y EXE, de Base64.  Ambos archivos se escribir√°n en C: \ Users \ {Nombre de usuario} \ AppData \ Roaming \ DBFUpdate.  En consecuencia, ambos archivos se ejecutar√°n y el usuario ver√° dicho trozo en la pantalla del documento: <br><br><img src="https://habrastorage.org/webt/oc/az/v_/ocazv_kws7t4hvkhq4r5jpqw6xi.png"><br><br><h2>  RAT del cazador de tesoros </h2><br>  Los atacantes usan una RAT de m√∫ltiples m√≥dulos con un gran conjunto de funciones que proporciona acceso completo a la m√°quina infectada. <br><br>  Caracter√≠sticas del c√≥digo: <br><br><ol><li>  Completamente escrito en C ++ con una gran cantidad de construcciones STL que se usan internamente. </li><li>  Aplicaci√≥n de la biblioteca boost, en particular JSON y Archive. </li><li>  Funciones de depuraci√≥n (m√°s en la secci√≥n sobre stager). </li></ol><br><h2>  Troyano principal </h2><br>  El troyano principal se fija en la m√°quina de la v√≠ctima y es una plataforma en la que se cargan m√≥dulos maliciosos desde C2. <br><br>  Primero, stager inicializa el directorio de trabajo, que posteriormente almacenar√° la informaci√≥n recopilada por los m√≥dulos, las utilidades necesarias para que los m√≥dulos funcionen, etc. <br><br><img src="https://habrastorage.org/webt/_h/qg/ba/_hqgbarp_rsej6ubiv1v8zuy32c.png"><br><br>  A continuaci√≥n se muestra la inicializaci√≥n de las rutas para crear el directorio de trabajo: <br><br><img src="https://habrastorage.org/webt/78/tg/ot/78tgotzxv4jl_vrucszwktoaef4.png"><br><br>  Una vez que se han creado los directorios necesarios, el troyano principal recopila informaci√≥n sobre la m√°quina infectada y la env√≠a al servidor de control. <br><br>  Troyan est√° interesado en tales datos: <br><br><ul><li>  identificador de la versi√≥n del sistema operativo en el que se ejecuta el troyano principal; </li><li>  El idioma predeterminado de la interfaz </li><li>  El n√∫mero de versi√≥n principal del Service Pack OS; </li><li>  nombre de la computadora e identificador de la m√°quina (para obtener detalles sobre c√≥mo obtener un identificador de la m√°quina, consulte la secci√≥n sobre el protocolo de red). </li></ul><br>  As√≠ es como se recopila la informaci√≥n sobre la m√°quina infectada: <br><br><img src="https://habrastorage.org/webt/0n/rn/xn/0nrnxnxdov8bp85g6dmlwzzvwzs.png"><br><br>  A continuaci√≥n, el troyano principal se repara en la m√°quina infectada mediante la modificaci√≥n del valor en el registro en HKCU \ Environment \ UserInitMprLogonScript.  Aqu√≠ se escribe el nombre del archivo ejecutable que se asign√≥ durante la inicializaci√≥n del directorio de trabajo, en este caso es igual a "DCTHOST.exe".  Este m√©todo se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">describe en el blog Hexacorn</a> , y tambi√©n fue utilizado por APT28 y el grupo Cobalt en su ComDLLDroper. <br><br><img src="https://habrastorage.org/webt/j3/tl/0g/j3tl0gm0n3zb3vzxfpps_abdgq0.png"><br><br>  Y el √∫ltimo paso para inicializar el troyano principal es copiar el archivo ejecutable desde su ubicaci√≥n actual al directorio de trabajo con el mismo nombre que se seleccion√≥ cuando se inicializ√≥ el directorio de trabajo. <br><br>  Despu√©s de inicializar el troyano principal, se lleva a cabo la preparaci√≥n para recibir comandos.  El m√≥dulo Core se agrega a la lista de m√≥dulos en ejecuci√≥n, que es el troyano principal.  A continuaci√≥n, se inicia un comando desde el m√≥dulo Core con el identificador 0. No hay implementaci√≥n de este comando en el m√≥dulo principal; en cambio, es solo un c√≥digo auxiliar.  El constructor del objeto del m√≥dulo Core se presenta a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/mi/hy/us/mihyuspzzqd5fwesqr1em7jyiqu.png"><br><br>  Al final, comienzan dos hilos.  Uno de los subprocesos inicia un temporizador, que se activa por defecto cada segundo e intenta solicitar un comando de C2. <br><br><img src="https://habrastorage.org/webt/o9/53/um/o953um8yermaycyqre2jugxbzly.png"><br><br>  La segunda secuencia carga bibliotecas adicionales y m√≥dulos est√°ndar.  Las bibliotecas, como los m√≥dulos, tienen un identificador, pero a diferencia de los m√≥dulos, los identificadores de la biblioteca son negativos, comienzan en -1, crecen hacia n√∫meros m√°s bajos.  A continuaci√≥n se muestra una lista de bibliotecas descargadas de C2. <br><br><img src="https://habrastorage.org/webt/8n/bl/pj/8nblpjayad6etstkkqxvwtaplts.png"><br><br><h2>  Funciones de depuraci√≥n del troyano principal </h2><br>  Al comienzo de su trabajo, inmediatamente despu√©s de la inicializaci√≥n, el troyano principal establece un controlador de excepciones a trav√©s de SetUnhandledExceptionFilter, que contiene funcionalidades interesantes.  Cuando se producen excepciones, caen en el controlador, que escribe el minivolcado de la aplicaci√≥n, al tiempo que guarda informaci√≥n sobre la excepci√≥n.  Luego se reinicia solo.  En la pantalla, creando un minivolcado: <br><br><img src="https://habrastorage.org/webt/1w/sw/3j/1wsw3jy1hd8wpgcvfw0yliwt_yy.png"><br><br><h2>  Protocolo de red </h2><br>  El intercambio entre el software y C2 se lleva a cabo utilizando un protocolo binario auto-escrito.  Cada mensaje se describe usando BinPackage (nombre tomado de RTTI).  Cada BinPackage es esencialmente un contenedor sobre std :: vector, que almacena el conjunto PackageRecord (se inventa el nombre).  PackageRecord es la unidad m√≠nima para almacenar datos. <br><br><pre><code class="bash hljs">struct PackageRecord { _DWORD dataId; _DWORD datatype; _DWORD szData; char[] data; };</code> </pre> <br>  M√°s sobre los campos de esta estructura: <br><br><ul><li>  <b>dataId</b> : indica el tipo de registro.  O la entrada es un identificador de m√≥dulo, o un identificador de comando, o una carga √∫til. </li><li>  <b>szData</b> : el tama√±o de los datos almacenados en el registro. </li><li>  <b>tipo de datos</b> es un tipo de datos. </li></ul><br>  En total, se registr√≥ el uso de tres tipos de datos: <br><ul><li>  Un valor de "0" significa que los datos almacenados en el registro deben interpretarse como DWORD. </li><li>  El valor "1": los datos almacenados en el registro deben interpretarse como una cadena ASCIIZ. </li><li>  El valor "2": los datos almacenados en el registro deben interpretarse como datos cifrados / almacenamiento intermedio sin procesar. </li></ul><br><br>  Al enviar BinPackage al servidor de control, se le agrega el identificador de la m√°quina.  El identificador es el GUID de la secci√≥n de la que se cortan todos los caracteres especiales.  En la figura, obteniendo el identificador de la m√°quina: <br><br><img src="https://habrastorage.org/webt/iw/kn/le/iwknleyhgrfk7tfu2fxiggdx_7w.png"><br><br>  Antes de enviar, todos los registros almacenados en BinPackage se recopilan secuencialmente en un √∫nico b√∫fer y se cifran.  Para el cifrado, se <a href="">utiliza la</a> biblioteca <a href="">WinAES</a> , espec√≠ficamente AES-128-CBC. <br><br>  Usando Windows CryptoAPI, se generan dos matrices pseudoaleatorias de 16 bytes.  Uno para IV, el otro para la llave.  Se realiza el cifrado y los datos cifrados se vuelven a agregar a BinPackage, que contiene el paquete cifrado y consta de tres entradas: <br><br><ul><li>  registro con ID 0x777: contiene la clave utilizada para el cifrado; </li><li>  registro con ID 0x555: contiene el IV utilizado para el cifrado; </li><li>  registro con ID 0x999: contiene datos cifrados (en general, un registro con este ID indica una carga √∫til y se usa no solo para almacenar datos cifrados). </li></ul><br>  Despu√©s del final del proceso de encriptaci√≥n, el BinPackage generado nuevamente se recopila en un √∫nico b√∫fer y se env√≠a a trav√©s de una solicitud HTTP POST al servidor de gesti√≥n 151.80.237.222. <br><br><img src="https://habrastorage.org/webt/zj/8b/dd/zj8bdd1d7hlb1ozmxarkmmkf60q.png"><br><br>  A continuaci√≥n se muestra un ejemplo de un paquete que contiene informaci√≥n de la m√°quina: <br><br><img src="https://habrastorage.org/webt/ma/gu/du/magudufvut9bwna3qk9g8atebju.png"><br><br>  Y este es un ejemplo de un paquete cifrado con informaci√≥n del sistema: <br><br><img src="https://habrastorage.org/webt/tv/rm/0s/tvrm0sniivu5dxahli4lfnsnfwa.png"><br><br><h2>  M√≥dulos </h2><br>  Cada m√≥dulo, con la excepci√≥n de Core, se carga desde el servidor de control.  Todos los m√≥dulos se pueden dividir en dos categor√≠as: m√≥dulos que se cargan autom√°ticamente y m√≥dulos que se cargan a pedido del servidor de control. <br><br>  Un ejemplo de un paquete que solicita un m√≥dulo: <br><br><img src="https://habrastorage.org/webt/zw/_o/mw/zw_omw8mqjoa74a0gouuylkgnk8.png"><br><br>  Respuesta a la solicitud del m√≥dulo: <br><br><img src="https://habrastorage.org/webt/9u/2g/qc/9u2gqcvb1mhw4kuky3fl6f1zljq.png"><br><br>  Cada m√≥dulo tiene una interfaz simple que consta de tres funciones: llamada al cargar el m√≥dulo Init, llamada al completar fini, y una funci√≥n que cambia la configuraci√≥n del m√≥dulo.  Cada m√≥dulo tambi√©n tiene una exportaci√≥n llamada GetModule, que crea un objeto que representa este m√≥dulo y lo devuelve al troyano principal.  Todos los m√≥dulos que descubrimos se lanzan en la memoria mediante carga reflexiva. <br><br><img src="https://habrastorage.org/webt/p7/rz/qk/p7rzqkvwrfbybtduak7hfttchgy.png"><br><br>  Adem√°s, los nombres de los m√≥dulos se dan en la forma en que est√°n presentes en RTTI como nombres de clase. <br><br><h2>  M√≥dulo CCore </h2><br>  Este m√≥dulo representa la funcionalidad b√°sica y est√° integrado directamente en el troyano principal.  Su constructor se puede ver en la tabla a continuaci√≥n: <br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="6">  0 0 </td><td>  0 0 </td><td>  B√°sicamente, un troyano en lugar de un comando es un trozo, y su prop√≥sito exacto no se pudo establecer </td></tr><tr><td>  1 </td><td>  Modificar la configuraci√≥n del m√≥dulo </td></tr><tr><td>  2 </td><td>  Solicitar informaci√≥n de la computadora </td></tr><tr><td>  3 </td><td>  Descargue la utilidad desde el servidor de control </td></tr><tr><td>  4 4 </td><td>  Solicitar listado de un directorio que contiene utilidades </td></tr><tr><td>  5 5 </td><td>  Descargue el m√≥dulo y ejec√∫telo </td></tr></tbody></table><br><h2>  M√≥dulo CShell </h2><br>  Este m√≥dulo proporciona un shell remoto a una m√°quina infectada.  Cuando se inicializa el m√≥dulo, se crea el proceso cmd.exe, al que se conectan dos canalizaciones: una para entrada est√°ndar y otra para salida est√°ndar, a trav√©s de la cual se reciben y transmiten comandos desde el servidor de control y viceversa.  Tambi√©n en este momento, se inicia un subproceso, que toma autom√°ticamente toda la salida y la env√≠a al servidor de control.  La figura muestra la inicializaci√≥n del m√≥dulo CShell. <br><br><img src="https://habrastorage.org/webt/73/g3/6v/73g36vgr-tbimku5nrr-x1r8l1u.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="4">  2 </td><td>  0 0 </td><td>  Enviar comando a shell </td></tr><tr><td>  1 </td><td>  Imprime el archivo.  Se lee un archivo, la ruta a la cual se transmite desde el servidor de control, y el contenido de este archivo se carga en el servidor de control </td></tr><tr><td>  2 </td><td>  Obtenga una lista de todos los discos existentes en el sistema.  Los datos se env√≠an al servidor de control en formato JSON </td></tr><tr><td>  3 </td><td>  Descargue el archivo del servidor de control.  La ruta donde guardar el archivo y los datos se reciben del servidor de control </td></tr></tbody></table><br><h2>  M√≥dulo CFileSystemBrowser </h2><br>  Este es un m√≥dulo pasivo, que a pedido le permite recibir informaci√≥n sobre la estructura del sistema de archivos.  As√≠ es como ocurre la inicializaci√≥n del m√≥dulo CFileSystemBrowser: <br><br><img src="https://habrastorage.org/webt/sm/as/pn/smaspn0xpx9jmukbwfsupllke88.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="4">  3 </td><td>  0 0 </td><td>  Obtenga una lista de todos los discos existentes en el sistema.  Los datos se env√≠an a C2 en formato JSON </td></tr><tr><td>  1 </td><td>  Obtener listado de directorio.  El listado se genera en formato JSON </td></tr><tr><td>  2 </td><td>  Imprime el archivo.  Se lee un archivo, la ruta a la cual se transfiere desde C2 y el contenido de este archivo se carga en C2 </td></tr><tr><td>  3 </td><td>  Eliminar archivo  La ruta al archivo se transfiere desde C2 </td></tr></tbody></table><br><h2>  M√≥dulo CScreenShot </h2><br>  Este m√≥dulo le permite tomar capturas de pantalla o capturar im√°genes desde una c√°mara web.  Puede hacerlo tanto a pedido como con un per√≠odo espec√≠fico en el temporizador. <br><img src="https://habrastorage.org/webt/nw/km/qg/nwkmqgynrgbuywc05kwjrvkq1ye.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="4">  4 4 </td><td>  0 0 </td><td>  Tome una captura de pantalla y env√≠ela al servidor de control </td></tr><tr><td>  1 </td><td>  Ejecute un temporizador, despu√©s del cual se toma una captura de pantalla de la pantalla de la m√°quina.  Las capturas de pantalla resultantes se empaquetan en BinPackage y se guardan en la carpeta de registros.  Los nombres de los archivos se generan utilizando la API GetTempFileName con el prefijo "MS_". </td></tr><tr><td>  2 </td><td>  Obtenga videos de dispositivos disponibles en una m√°quina infectada </td></tr><tr><td>  3 </td><td>  Capture un marco de la c√°mara web y env√≠elo al servidor de control </td></tr></tbody></table><br><h2>  M√≥dulo CSender </h2><br>  Este m√≥dulo no est√° activado inicialmente.  Sube el contenido de la carpeta de registros al servidor de control.  Se activa cuando llega una solicitud para cambiar la configuraci√≥n, que contiene el per√≠odo de verificaci√≥n. <br><br><img src="https://habrastorage.org/webt/wd/64/0e/wd640e65m5umn66eyqrg1vuwolu.png"><br><br><h2>  M√≥dulo CKeylogger </h2><br>  Este m√≥dulo tampoco est√° activado inicialmente.  Se activa cuando llega una solicitud de cambio de configuraci√≥n que contiene el tama√±o del b√∫fer en el que se almacena el registro.  La interceptaci√≥n de entrada se lleva a cabo a trav√©s de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rawinput</a> .  Adem√°s, el keylogger monitorea la ventana en la cual el usuario ingresa y registra su t√≠tulo. <br><br><img src="https://habrastorage.org/webt/wu/ek/r6/wuekr6dftcwhuubqmce3h5n49vg.png"><br><br><h2>  M√≥dulo CDictaphone </h2><br>  Este m√≥dulo graba el sonido por comando o al detectar una ventana de Skype.  Cuando se inicia, inicia un subproceso que enumera todas las ventanas y sus ventanas secundarias en el sistema y busca la ventana entre las clases cuyo nombre de clase es TLiveConversation o TCallMonitorControl.  Si se encuentra dicha ventana, comienza la grabaci√≥n.  A continuaci√≥n se muestra la inicializaci√≥n del m√≥dulo CDictaphone: <br><br><img src="https://habrastorage.org/webt/y7/kq/e0/y7kqe0xqb1lytearyqn--ojslpu.png"><br><br>  Y la ventana de b√∫squeda de Skype <br><br><img src="https://habrastorage.org/webt/6j/49/br/6j49brec889qzpw8hqqd0mjo-5g.png"><br><br>  La grabaci√≥n se realiza a trav√©s del MCI enviando comandos especiales.  As√≠ es como se ve el ciclo de escritura del m√≥dulo CDictaphone: <br><br><img src="https://habrastorage.org/webt/nh/ef/zk/nhefzkr0smgjs0xpnabh9oglqzy.png"><br><br>  Despu√©s de cerrar la ventana o de recibir un comando para completar la grabaci√≥n, los datos recibidos se guardan en una carpeta temporal, despu√©s de lo cual se codifica mediante el codificador de MP3 cojo (se considera una utilidad y ya deber√≠a estar cargado, no fue posible obtenerlo del servidor de control).  El archivo codificado se guarda en la carpeta de registros.  Generar un nombre de carpeta es similar a generar nombres para capturas de pantalla. <br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="3">  7 7 </td><td>  0 0 </td><td>  Comience a grabar y compl√©telo despu√©s de 15 minutos. </td></tr><tr><td>  1 </td><td>  Dejar de grabar </td></tr><tr><td>  2 </td><td>  Verificar estado: est√° grabando en progreso </td></tr></tbody></table><br><h2>  M√≥dulo CProcessesManager </h2><br>  Este es un m√≥dulo pasivo, capaz de devolver una lista de procesos a pedido o finalizar por el PID que se le pasa. <br><br><img src="https://habrastorage.org/webt/us/if/sf/usifsfffgu9i_sfbbus6xc5_ch4.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="2">  8 </td><td>  0 0 </td><td>  Devuelve una lista de procesos: sus nombres, PID y el nombre del usuario propietario del proceso. </td></tr><tr><td>  1 </td><td>  Finalizaci√≥n del proceso PID </td></tr></tbody></table><br><h2>  M√≥dulo de CDownloader </h2><br>  El m√≥dulo est√° dise√±ado para cargar archivos grandes al servidor de control.  Realiza la transmisi√≥n de datos por fragmentos, cuyo tama√±o se establece por su configuraci√≥n.  El m√≥dulo lee datos de un archivo, la ruta a la que recibe del servidor de control, y empaqueta trozos en BinPackage.  Para cada BinPackage que contiene el fragmento, se agrega una entrada con el identificador 0x888, que incluye la ruta al archivo.  Despu√©s de pasar cada trozo, el sue√±o se realiza durante 5 segundos. <br><img src="https://habrastorage.org/webt/ch/-1/wj/ch-1wjtsdqiwbglodlmf25cp3om.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td rowspan="3">  9 9 </td><td>  0 0 </td><td>  Trozo, no se pudo establecer el valor exacto </td></tr><tr><td>  1 </td><td>  Realiza la transferencia de una gran cantidad de datos (0x500000 bytes), despu√©s de lo cual mide el tiempo dedicado a la transferencia y env√≠a este valor a C2 </td></tr><tr><td>  2 </td><td>  Descargar un archivo de una m√°quina </td></tr></tbody></table><br><h2>  M√≥dulo CPS </h2><br>  Este m√≥dulo le permite ejecutar scripts de PowerShell. <br><br><img src="https://habrastorage.org/webt/ua/nn/vn/uannvn5wtvk7p2jnfaz6exur2ia.png"><br><table><tbody><tr><th width="100">  ID del m√≥dulo </th><th width="100">  ID del equipo </th><th>  Descripci√≥n </th></tr><tr><td>  10 </td><td>  0 0 </td><td>  Recibe un script de PowerShell de C2 y lo ejecuta </td></tr></tbody></table><br><h2>  M√≥dulo CDeviceMonitor </h2><br>  Un m√≥dulo pasivo que monitorea los dispositivos multimedia conectados y copia archivos de ellos.  Utiliza mensajes de difusi√≥n WM_DEVICECHANGE para detectar la conectividad del dispositivo.  Despu√©s de conectar el dispositivo al servidor de control, se env√≠a informaci√≥n sobre cu√°ndo se conect√≥ el dispositivo, su etiqueta de volumen y la ruta al dispositivo.  El c√≥digo utilizado para obtener la ruta al dispositivo es muy similar a este.  Todos los archivos se copian en la carpeta de registros.  Los nombres se generan de la misma manera que para las capturas de pantalla.  El archivo fsIndex.dat se crea por separado, en el que se encuentra el diccionario serializado con boost :: archive.  Este diccionario almacena las rutas originales a los archivos que se copiaron y sus hash MD5.  A continuaci√≥n se muestra el recibo de DevicePath: <br><br><img src="https://habrastorage.org/webt/3y/k0/ap/3yk0apdk8elf3rhhjqnsako0zne.png"><br><br>  Como ep√≠logo, varias recomendaciones: <br><br><ul><li>  No es necesario abrir archivos adjuntos en cartas de destinatarios desconocidos, y mucho menos incluir un script de Microsoft Publisher. </li><li>  No es menos peligroso hacer clic en los enlaces de las cartas de remitentes desconocidos.  El sitio donde va puede alojar malware que se descargar√° autom√°ticamente a su PC. </li><li>  Debe actualizar regularmente el software, especialmente Microsoft Windows y Microsoft Office, que cerrar√° el acceso a una amplia gama de malware. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es432172/">https://habr.com/ru/post/es432172/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432160/index.html">Video de Android Kolesa Mobile: sobre desarrollo modular, interfaz de usuario basada en backend e integraci√≥n continua</a></li>
<li><a href="../es432162/index.html">"Tratamos de dar historias de la vida real": sobre el programa Heisenbug 2018 Mosc√∫</a></li>
<li><a href="../es432166/index.html">Apache NiFi: qu√© es y una breve descripci√≥n de las caracter√≠sticas</a></li>
<li><a href="../es432168/index.html">Las autoridades chinas recopilan informaci√≥n de veh√≠culos el√©ctricos de ciudadanos del pa√≠s.</a></li>
<li><a href="../es432170/index.html">Transporta un centro de datos en 14,400 segundos</a></li>
<li><a href="../es432174/index.html">C√≥mo desarrollar de manera competente y efectiva un producto de software</a></li>
<li><a href="../es432176/index.html">C√≥mo duplicamos la velocidad de trabajo con Float en Mono</a></li>
<li><a href="../es432178/index.html">... y una garant√≠a para proyectores - aumento</a></li>
<li><a href="../es432180/index.html">C√≥mo impulsar tu carrera a trav√©s de GitHub</a></li>
<li><a href="../es432182/index.html">Recogemos correo sin sms ni registro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>