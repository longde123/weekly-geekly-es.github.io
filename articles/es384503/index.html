<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíñ üéí üéø M√°quina de cubos de Rubik basada en FAC üìá üèùÔ∏è ü§≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No hace mucho tiempo, junto con Wilbert Swinkels, terminamos de trabajar en una m√°quina que recoge el cubo de Rubik. Escribieron sobre nosotros en el ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√°quina de cubos de Rubik basada en FAC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384503/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No hace mucho tiempo, junto con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wilbert Swinkels,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terminamos de trabajar en una m√°quina que recoge el cubo de Rubik. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escribieron</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre nosotros </font><font style="vertical-align: inherit;">en el blog oficial de Raspberry Pi y recibimos muchas cr√≠ticas muy favorables. </font><font style="vertical-align: inherit;">Sin embargo, en el segmento ruso de la red, el proyecto de alguna manera pas√≥ desapercibido. </font><font style="vertical-align: inherit;">As√≠ que decid√≠ corregir esta omisi√≥n publicando aqu√≠ una versi√≥n traducida y aumentada de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicaci√≥n original</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/vpAKfSYueMI%3Ffeature%3Doembed&amp;usg=ALkJrhgPrv6Ay556oaU5oxW56q8IwALlYQ" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bajo el corte, hablaremos (principalmente) sobre la parte del software de esta m√°quina, la parte mec√°nica se puede leer en la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina oficial del</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proyecto (s√≠, sabemos que es una peque√±a "vieja escuela")</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL; DR</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para los impacientes, algunos enlaces:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P√°gina oficial del proyecto</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Implementaciones del algoritmo de dos fases de Kotsemba (Python y C)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otras obras de Wilbert</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sitio web de Wilbert FAC</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sitio oficial del sistema FAC</font></font></a></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introducci√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todo comenz√≥ con el hecho de que en mayo de este a√±o, conoc√≠ accidentalmente a Wilbert Swinkels. Simplemente me sorprend√≠ cuando vi sus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">creaciones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : cada uno de estos mecanismos, de peque√±o a grande, se puede llamar con seguridad una obra de arte. Y cuanto m√°s miras su dispositivo, m√°s te sorprende su belleza. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por supuesto, cuando Wilbert me invit√≥ a ayudarlo con la m√°quina de ensamblar cubos de Rubik, no dud√© ni un segundo, especialmente porque para entonces ya hab√≠a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descubierto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> una pasi√≥n por los cubos de colores. En ese momento, ya hab√≠a estado trabajando en la m√°quina durante m√°s de 4 (!) A√±os, pero la parte del software a√∫n no se hab√≠a escrito.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No ten√≠a experiencia con la programaci√≥n para Raspberry Pi y Arduino, pero en general la tarea me pareci√≥ bastante simple. </font><font style="vertical-align: inherit;">Por supuesto, me equivoqu√© :)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hardware</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La m√°quina en s√≠ est√° construida con un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sistema modular FAC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esto es algo as√≠ como un dise√±ador sovi√©tico, pero creado para crear prototipos de mecanismos serios y complejos. </font><font style="vertical-align: inherit;">En la segunda mitad del siglo pasado, se utiliz√≥ muy activamente en los laboratorios de Philips y otras empresas y universidades. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cuando conoc√≠ a Wilbert, ya hab√≠a intentado dos veces "revivir" el auto. </font><font style="vertical-align: inherit;">En ambas ocasiones, los estudiantes de la Universidad de Amsterdam tomaron el caso y, desafortunadamente, en ambas ocasiones perdieron inter√©s en el proyecto despu√©s de varios intentos fallidos. </font><font style="vertical-align: inherit;">Uno de ellos incluso defendi√≥ un diploma de licenciatura en este tema, a pesar de que, como resultado, la m√°quina no pudo recoger el cubo (levante la mano a los que se reconocen aqu√≠).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontrolador</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En primer lugar, decidimos usar Raspberry Pi en lugar de Arduino. </font><font style="vertical-align: inherit;">Esto se debe principalmente al hecho de que los algoritmos "inteligentes" para resolver el Cubo de Rubik requieren una cantidad significativa de memoria y potencia de procesador. </font><font style="vertical-align: inherit;">En intentos anteriores, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se us√≥ un algoritmo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primitivo de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">tres capas</font></a><font style="vertical-align: inherit;"> , pero esta vez decidimos usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el algoritmo de Kotsemba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Adem√°s, realmente no quer√≠a escribir todo en C (aunque en parte ten√≠a que hacerlo). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/53b/142/5d4/53b1425d42fca6feb8f98819c3f4ff39.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versi√≥n est√°ndar de Raspberry Pi, no ten√≠amos suficientes pines para conectar todos los motores disponibles, por lo que pedimos el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kit de desarrollo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por cierto, recomiendo encarecidamente: no solo m√°s pines, sino que, en mi opini√≥n, son m√°s l√≥gicos aparte. </font><font style="vertical-align: inherit;">Adem√°s, esta placa tiene dos conectores para la c√°mara en lugar de uno.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La primera versi√≥n del esc√°ner.</font></font></h3><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/465/d0e/05d/465d0e05d87cd5c11a732f3d448ac6b4.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para leer la configuraci√≥n inicial del cubo, se necesitaba un dispositivo de escaneo. La idea es muy simple: a su vez, iluminamos la superficie del cubo con tres LED: rojo, verde y azul. Cada vez que medimos la luz reflejada usando una resistencia fotosensible. Te√≥ricamente, deber√≠amos obtener valores RGB que puedan usarse para reconocer el color del cuadrado. De los programadores anteriores, todav√≠a tenemos c√≥digo de prueba de concepto para Arduino, que, al parecer, incluso funcion√≥ bajo ciertas condiciones.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primer problema que encontramos fue un desajuste de voltaje. Como saben, la unidad l√≥gica en los pines Arduino es de 5V, mientras que la Raspberry Pi es de 3.3V. Afortunadamente, los controladores de controlador de motor paso a paso que utilizamos continuaron funcionando a pesar de cambiar la amplitud de los pulsos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Result√≥ ser mucho m√°s cr√≠tico que Raspberry Pi no tenga entradas anal√≥gicas. Debido a esto, la Raspberry no puede simplemente tomar y leer el voltaje en el fotorresistor. Esto es probablemente obvio para aquellos que al menos una vez se encontraron con esto, pero al principio ni siquiera lo pens√©. Buscando en la red una soluci√≥n, nos topamos con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este art√≠culo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En pocas palabras, agregamos un condensador al circuito y medimos el tiempo durante el cual se cargar√° desde cero a una unidad l√≥gica (podemos detectar esto usando un pin digital). </font><font style="vertical-align: inherit;">El tiempo de carga ser√° proporcional a la resistencia de la fotorresistencia, por lo que podemos juzgar la cantidad de luz. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/40a/8d9/d2b/40a8d9d2b30365e9e4fd4c3cf3615798.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este enfoque no solo es terriblemente poco confiable (tomarse un tiempo en un script Python Python en Linux con un mont√≥n de procesos en segundo plano es algo desagradecido), sino que tambi√©n es imposible prolongarlo. </font><font style="vertical-align: inherit;">Para suavizar las desviaciones aleatorias en las lecturas, tuvimos que leer varias veces, eliminar los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valores at√≠picos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y promediar los valores restantes. </font><font style="vertical-align: inherit;">Sin embargo, todav√≠a logramos que este esc√°ner funcione:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://www.youtube.com/embed/z4iJ0hNQulo%3Ffeature%3Doembed&amp;usg=ALkJrhjCP-I3EUM0VXl8aVmp03Ilwke3bQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La segunda versi√≥n (final) del esc√°ner</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El esc√°ner de condensadores funcion√≥ bastante bien, pero fue muy lento. Tom√≥ alrededor de dos minutos escanear todo el Cubo de Rubik, y para cuando se complet√≥ el escaneo, el espectador hab√≠a perdido todo inter√©s. Por lo tanto, decidimos regresar al Arduino y compramos un Arduino Mini peque√±o espec√≠ficamente para controlar el esc√°ner. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/21a/9e5/775/21a9e5775f5e15affb6792ae5f67b984.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hacer que Arduino se hiciera amigo de Raspberry Pi result√≥ ser incre√≠blemente simple: dos cables, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un convertidor de voltaje</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entre ellos y listo, tenemos una interfaz en serie. Y si atornillas un protocolo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Min</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simple </font><font style="vertical-align: inherit;">, entonces programar este negocio es un placer.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Transfer√≠ toda la l√≥gica de control del esc√°ner al Arduino. </font><font style="vertical-align: inherit;">La velocidad de escaneo ha aumentado significativamente. </font><font style="vertical-align: inherit;">Gracias a las entradas anal√≥gicas, podemos leer el voltaje directamente de los fotoresistores, y estos valores son muy precisos. </font><font style="vertical-align: inherit;">Adem√°s, dado que el Arduino est√° montado directamente en el esc√°ner, ¬°necesitamos muchos menos cables del esc√°ner a la Raspberry Pi!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Construir algoritmo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Montar el cubo de Rubik desde un punto de vista matem√°tico es una </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tarea</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bastante </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">laboriosa</font></a><font style="vertical-align: inherit;"> . Por supuesto, estamos hablando de encontrar la soluci√≥n √≥ptima, y ‚Äã‚Äãno "alguna". Me sorprend√≠ cuando descubr√≠ que el n√∫mero de Dios (el l√≠mite inferior exacto para el n√∫mero de movimientos necesarios para resolver un cubo arbitrario) se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">encontr√≥ solo en 2010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En este proyecto, quer√≠amos reducir el tiempo total requerido para calcular la soluci√≥n y el ensamblaje, por lo tanto, ni un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algoritmo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simple de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">tres capas</font></a><font style="vertical-align: inherit;"> se nos acerc√≥ </font><font style="vertical-align: inherit;">(funciona r√°pidamente, pero da soluciones de cien movimientos de largo), ni un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algoritmo √≥ptimo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (las soluciones son cortas, pero el proceso de renderizado en Raspberry Pi tomar√≠a una eternidad). Como resultado, nos decidimos por el magn√≠fico </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algoritmo de "dos fases"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El matem√°tico alem√°n Herbert Kociemba. Es capaz de emitir decisiones sub√≥ptimas (un promedio de 20 movimientos), mientras se mantiene dentro de un tiempo razonable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En el sitio del autor puede encontrar la implementaci√≥n del algoritmo en Java. Lo primero que hice fue traducir este c√≥digo a Python. No fue del todo dif√≠cil, ya que la mayor parte del programa son operaciones matem√°ticas y enumeraci√≥n de opciones. Sin embargo, no tom√© en cuenta que el algoritmo </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realmente</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> requiere </font><i><b><font style="vertical-align: inherit;">muchos</font></b></i><font style="vertical-align: inherit;"> recursos. Encontrar una soluci√≥n en el primer lanzamiento tard√≥ m√°s de un minuto (!) En mi computadora port√°til. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bajo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pypy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con JIT habilitado, la soluci√≥n tard√≥ 1 segundo en la computadora port√°til, pero en la Raspberry Pi a√∫n tard√≥ aproximadamente un minuto. </font><font style="vertical-align: inherit;">Despu√©s de varios intentos de acelerar el trabajo del programa Python (numpy, multiprocesamiento), decid√≠ volver a escribir el algoritmo en C. Sin embargo, la soluci√≥n ahora toma 1-2 segundos, incluso para Raspberry. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publiqu√© ambas implementaciones del algoritmo en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control de maquina</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El siguiente paso fue escribir un programa que controlara la parte mec√°nica: mover los motores, teniendo en cuenta las relaciones de transmisi√≥n y las limitaciones del mecanismo (por ejemplo, los soportes laterales solo se pueden girar cuando la parte inferior est√° en una posici√≥n determinada, de lo contrario interferir√°). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/b89/c9b/3e0/b89c9b3e0780fae3e7dd5b28a8aa209d.png" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adem√°s del programa principal, hice un shell interactivo que me ahorr√≥ mucho tiempo al depurar. </font><font style="vertical-align: inherit;">En general, esta parte no era inusual en t√©rminos de programaci√≥n. </font><font style="vertical-align: inherit;">Para depurar el escaneo, gener√© los resultados como im√°genes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escaneo y reconocimiento de color</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hasta este punto, todo era interesante, pero no dif√≠cil. </font><font style="vertical-align: inherit;">Dos semanas despu√©s del comienzo del trabajo, la m√°quina ya podr√≠a recoger un cubo de un estado determinado. </font><font style="vertical-align: inherit;">Solo quedaba aprender a leer la configuraci√≥n inicial del cubo usando un esc√°ner. </font><font style="vertical-align: inherit;">Ya ten√≠amos un programa de "trabajo" para Arduino, por lo que no esper√°bamos sorpresas. </font><font style="vertical-align: inherit;">Sin embargo, esta parte del proyecto result√≥ ser la m√°s dif√≠cil y nos llev√≥ otros 2 meses de trabajo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indicaciones de fotoresistencia</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como escrib√≠ anteriormente, comenzamos con un circuito de esc√°ner con condensadores. El error de este enfoque fue horrible, por lo que para obtener valores utilizables, tuve que tomar medidas varias veces y luego eliminar las emisiones. Despu√©s de eso, obtuvimos algo como esto (este es el resultado de escanear el cubo ensamblado en una habitaci√≥n oscura): </font></font><br>
<br>
<img src="https://habrastorage.org/files/d0d/0eb/467/d0d0eb4676f54a8c9319882658278664.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como puede ver, el resultado est√° lejos de ser ideal. En primer lugar, los valores para el mismo color son diferentes en diferentes posiciones, ya que los fotoresistores y los LED "miran" en direcciones ligeramente diferentes. En segundo lugar, algunos colores est√°n muy cerca uno del otro en el espacio de color y, a veces, los rangos de valores se superponen (por ejemplo, el naranja y el rojo a veces dan el mismo valor). Y finalmente, las lecturas dependen mucho de la iluminaci√≥n externa.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Visualmente, el error del esc√°ner en los condensadores se puede ver en el siguiente diagrama (en general, hay </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">una versi√≥n interactiva aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<br>
<img src="https://habrastorage.org/files/8a6/489/4fd/8a64894fd9a249a1a297ac2743930120.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mirando hacia atr√°s, me pregunto c√≥mo logramos que el escaneo funcione con tales resultados, aunque esto requiri√≥ una calibraci√≥n cuidadosa y complicada de los valores en cuesti√≥n ir√° un poco m√°s abajo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como dije, el esc√°ner de condensadores funcionaba, pero era muy lento. </font><font style="vertical-align: inherit;">Cuando lo reemplazamos con otro, con el Arduino incorporado, las lecturas se volvieron mucho m√°s "abarrotadas" (la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi√≥n interactiva est√° aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<img src="https://habrastorage.org/files/c6e/0a8/8b5/c6e0a88b595747aa87ef2c35bdf634fe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calibraci√≥n y agrupamiento de lecturas</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora que ten√≠amos las lecturas de RGB sin procesar de los fotorresistores, tuvimos que identificar los colores nosotros mismos para alimentar la configuraci√≥n del cubo al algoritmo de construcci√≥n. Aqu√≠ se sugirieron inmediatamente dos enfoques diferentes: el uso de intervalos de color y el algoritmo de agrupamiento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El primer enfoque es una soluci√≥n "frontal": fue posible determinar experimentalmente los intervalos de valores para cada lado del cubo (de hecho, dividir el espacio de color en √°reas disjuntas), y luego simplemente combinar los valores de acuerdo con su pertenencia a un determinado intervalo. En este caso, cada una de las 9 posiciones posibles en el borde del cubo debe considerarse por separado. Este m√©todo es muy f√°cil de programar, pero tiene dos inconvenientes importantes. En primer lugar, nos une a colores espec√≠ficos, lo que significa que solo podemos recolectar un cubo de Rubik estrictamente definido. Y en segundo lugar, los intervalos de valores posibles dependen mucho de la iluminaci√≥n externa. Adem√°s, descubrimos que, dependiendo de la luz ambiental, la misma lectura puede corresponder a diferentes colores.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El segundo enfoque requiere una calibraci√≥n preliminar de los valores para que el mismo color d√© los mismos resultados en las 9 posiciones en el borde del cubo. </font><font style="vertical-align: inherit;">En este caso, podemos usar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el algoritmo de agrupamiento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para combinar los valores en 6 grupos. </font><font style="vertical-align: inherit;">Al mismo tiempo, no importa en qu√© colores est√° pintado el cubo, si solo son diferentes. </font><font style="vertical-align: inherit;">Desafortunadamente, este m√©todo tambi√©n tuvo que ser "rechazado" debido a la naturaleza probabil√≠stica de los algoritmos de agrupamiento: pueden producir un "buen" resultado, pero no garantizan su precisi√≥n. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ambos enfoques tienen sus pros y sus contras, por lo que utilizamos algo intermedio:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En primer lugar, hacemos una calibraci√≥n artificial de las lecturas del esc√°ner para normalizar los valores. </font><font style="vertical-align: inherit;">Los coeficientes se obtienen experimentalmente.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">convertir los valores RGB resultantes a HSV</font></font></li>
<li>   ,    S ()</li>
<li>     </li>
<li>    ,     .</li>
</ol><br>
<br>
<h3>   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Incluso con un buen algoritmo de agrupamiento, el escaneo a menudo fallaba debido a las condiciones ambientales. </font><font style="vertical-align: inherit;">El algoritmo, calibrado en una habitaci√≥n oscura, no pudo hacer frente a la tarea en condiciones diurnas, y viceversa. </font><font style="vertical-align: inherit;">Adem√°s, si la iluminaci√≥n externa era muy brillante (luz solar directa), el esc√°ner generalmente dejaba de funcionar, ya que la influencia de los LED apenas se notaba. </font><font style="vertical-align: inherit;">Wilbert hizo un trabajo muy minucioso al aislar el esc√°ner de la luz ambiental. </font><font style="vertical-align: inherit;">Tuve que pasar por 3 iteraciones: cada vez que pens√°bamos que ser√≠a suficiente, y cada vez que encontramos otra brecha a trav√©s de la cual la iluminaci√≥n externa cay√≥ sobre la fotorresistencia.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/d4c/a1e/795/d4ca1e795ba1c28d27a3fa8ebbc8c5cb.jpg" alt="imagen"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusi√≥n</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trabajar en este proyecto fue incre√≠blemente emocionante. Es genial ver c√≥mo el coche cobra vida ante tus ojos, y es especialmente genial ver c√≥mo funciona, justificando todos tus esfuerzos. Sin embargo, esto no se puede comparar con la reserva de conocimiento que logramos obtener en el proceso. No podr√≠a haber imaginado que tendr√≠a que estudiar un mont√≥n de materiales sobre electr√≥nica, mec√°nica, √°lgebra e incluso estad√≠stica matem√°tica, y en el camino encontrar una docena de utilidades y bibliotecas √∫tiles. Por eso estoy tan feliz de haber tenido la oportunidad de trabajar en este proyecto.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/238/e22/a67/238e22a6758025d7fbda1f52441b75a2.jpg" alt="imagen"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sea como fuere, este autom√≥vil es solo un prototipo. </font><font style="vertical-align: inherit;">No nos propusimos el objetivo de romper el r√©cord de velocidad, y ciertamente no nos dimos cuenta del potencial total de las partes mec√°nicas. </font><font style="vertical-align: inherit;">Pero definitivamente intentaremos hacer esto en la pr√≥xima versi√≥n de la m√°quina, en la que ya hemos comenzado a trabajar. </font><font style="vertical-align: inherit;">All√≠ vamos a usar la c√°mara para escanear, y el dise√±o de los manipuladores ha sufrido cambios significativos. </font><font style="vertical-align: inherit;">Y, por supuesto, si tiene alguna pregunta, sugerencia o sugerencia, me complacer√° escucharla en los comentarios.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es384503/">https://habr.com/ru/post/es384503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es384489/index.html">Nueva unidad de estado s√≥lido m√°s r√°pida del fabricante coreano: Samsung 950 Pro</a></li>
<li><a href="../es384491/index.html">Los robots se estacionan mejor que los humanos</a></li>
<li><a href="../es384493/index.html">Reloj electr√≥nico estilo Qlocktwo</a></li>
<li><a href="../es384499/index.html">Acer Revo One: una computadora en miniatura con un amplio espectro de acci√≥n</a></li>
<li><a href="../es384501/index.html">Sonido en su bolsillo por 500 000r: Astell & Kern AK380 + Astell & Kern Layla</a></li>
<li><a href="../es384505/index.html">Auriculares con tecnolog√≠a de conducci√≥n √≥sea: qu√© son, por qu√© son necesarios y d√≥nde comprarlos.</a></li>
<li><a href="../es384507/index.html">–ü—Ä–æ—Å—Ç–æ–π –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞ Amazon –ø–æ–≤–ª–µ–∫ –∑–∞ —Å–æ–±–æ–π —Å–±–æ–π –≤ —Ä–∞–±–æ—Ç–µ Netflix, Heroku –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤</a></li>
<li><a href="../es384509/index.html">NVIDIA instalar√° su tarjeta gr√°fica integrada para computadora port√°til GeForce GTX 980</a></li>
<li><a href="../es384511/index.html">Rastrillo inicial: c√≥mo abrimos el patio de recreo</a></li>
<li><a href="../es384513/index.html">Estaciones de gas solares m√≥viles EV ARC - realidades y perspectivas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>