<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôàÔ∏è üé≥ ‚è´ Comment contr√¥ler simplement l'√©tat du site üë´ üë©üèº‚Äçüé® üßòüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour surveiller √† distance les performances des serveurs, les professionnels utilisent des syst√®mes logiciels sp√©ciaux, tels que Zabbix ou Icinga . Ma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment contr√¥ler simplement l'√©tat du site</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439894/"> Pour surveiller √† distance les performances des serveurs, les professionnels utilisent des syst√®mes logiciels sp√©ciaux, tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zabbix</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Icinga</a> .  Mais, si vous √™tes propri√©taire ou administrateur novice d'un ou deux sites Web avec une petite charge, il n'est pas n√©cessaire d'avoir de grands syst√®mes de surveillance.  Le param√®tre principal est de savoir si le site sert rapidement les utilisateurs.  Par cons√©quent, vous pouvez surveiller le travail du site √† l'aide d'un simple programme √† partir de n'importe quel ordinateur connect√© √† Internet. <br><br><img src="https://habrastorage.org/webt/qx/fj/tq/qxfjtqd07g37gx2eq8ksz80wtfm.jpeg" alt="Photo de Mikhail Vasiliev, Unsplash.Com" title="Photo de Mikhail Vasiliev, Unsplash.Com"><br><br>  √âcrivons ce script maintenant - la surveillance la plus simple de la disponibilit√© et de la vitesse du site.  Ce programme peut √™tre ex√©cut√© sur un ordinateur personnel, un smartphone, etc.  Le programme n'a que deux fonctions: <br><br><ul><li>  affiche √† l'√©cran le temps pendant lequel votre site donne des pages aux utilisateurs, </li><li>  en cas de r√©ponses lentes du site ou d'erreurs, le programme √©crit des donn√©es dans un fichier (un ¬´log¬ª, ou un fichier log).  Ces donn√©es m√©ritent d'√™tre v√©rifi√©es de temps en temps pour r√©soudre les probl√®mes au tout d√©but.  Par cons√©quent, nous prendrons soin d'enregistrer ces journaux sous une forme claire et pratique pour une visualisation rapide. </li></ul><br>  Je d√©crirai chaque √©tape en d√©tail afin que m√™me un d√©butant qui ne conna√Æt que peu l'√©criture de fichiers batch (bat et cmd sur DOS et Windows, sh sur des syst√®mes comme UNIX) puisse le comprendre sans aucun probl√®me et √™tre capable d'adapter le script √† ses besoins.  <b>Mais je vous demande de ne pas utiliser ce script sans r√©fl√©chir, car s'il n'est pas utilis√© correctement, il peut ne pas donner de r√©sultats appropri√©s et, en outre, engloutir beaucoup de trafic</b> . <br><br>  Je vais d√©crire un script pour un syst√®me d'exploitation tel que Linux et son utilisation sur un ordinateur personnel.  Selon les m√™mes principes, cela peut se faire sur d'autres plateformes.  Et pour ceux qui ne font que regarder les possibilit√©s de Linux, un autre exemple peut √™tre int√©ressant: quel outil simple et puissant sont ses scripts. <br><a name="habracut"></a><br><h3>  1. L'organisation d'abord </h3><br>  Nous allons cr√©er un dossier s√©par√© pour ce programme et y cr√©er 3 fichiers.  Par exemple, j'ai ce dossier / home / me / Progs / iNet / monitor (ici moi est le nom de mon utilisateur, Progs / iNet est mon dossier pour les programmes li√©s √† Internet, et monitor est le nom de ce programme, du mot moniteur, c.-√†-d. √âtant donn√© que je suis le seul utilisateur de cet ordinateur, je conserve ces fichiers dans mes dossiers personnels (/ home) dans une section distincte du disque, ce qui me permet de les enregistrer lors de la r√©installation du syst√®me).  Dans ce dossier, il y aura des fichiers: <br><br><ul><li>  README.txt - voici une description (en cas de scl√©rose): quel type de programme, informations de base, etc. </li><li>  mon.sh - il y aura un programme qui interroge le site. </li><li>  server.log - ici, il enregistrera les indicateurs d'√©tat du site.  Dans notre cas, il s'agit simplement de la date, de l'heure et de la dur√©e de la r√©ponse du site (plus des informations suppl√©mentaires si le serveur r√©pond avec une erreur √† notre demande). </li></ul><br>  (Pour faciliter l'√©dition et, le cas √©ch√©ant, la restauration de fichiers, vous pouvez inclure ce dossier dans le syst√®me de contr√¥le de version de Git; ici, je ne le d√©crirai pas). <br><br><h3>  2. Toujours et d√©tendu </h3><br>  Nous ex√©cuterons le fichier mon.sh avec un petit intervalle r√©gulier, par exemple, 60 secondes.  J'ai utilis√© l'outil standard fourni par le syst√®me d'exploitation (plus pr√©cis√©ment, l'environnement de bureau). <br><br>  Mon environnement de bureau est Xfce.  C'est l'une des options les plus populaires pour Linux.  J'aime Xfce car il vous permet de personnaliser presque compl√®tement l'environnement entier - comme vous le souhaitez.  Dans le m√™me temps, Xfce est un peu plus compact et plus rapide que deux autres syst√®mes bien connus - Gnome et KDE.  (D'autres options sont √©galement int√©ressantes - par exemple, l'environnement LXDE est encore plus rapide et plus facile que Xfce, mais jusqu'√† pr√©sent pas si riche en fonctionnalit√©s). <br><br>  L'outil dont nous avons besoin, dans le cas de Xfce, est un plug-in pour le panneau de travail Generic Monitor.  Habituellement, il est d√©j√† install√©, mais sinon, l'installateur le trouvera facilement: ¬´Genmon¬ª (description: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">xfce4-genmon-plugin</a> ).  Il s'agit d'un plugin qui peut √™tre ajout√© au panneau et d√©fini dans les param√®tres: (1) la commande √† ex√©cuter et (2) la fr√©quence de son ex√©cution en secondes.  Dans mon cas, la commande: <br><br>  /home/me/Progs/iNet/monitor/mon.sh <br><br>  (ou, de mani√®re √©quivalente, ~ / Progs / iNet / monitor / mon.sh). <br><br><img src="https://habrastorage.org/webt/2w/pc/sz/2wpcszhqlfhyao4_qg6bpkrillw.png" alt="Genmon" title="Genmon"><br><br><h3>  3. Lorsque le programme n'est pas encore termin√©, il y a d√©j√† des erreurs </h3><br>  Si vous avez maintenant termin√© toutes ces √©tapes - cr√©√© des fichiers et lanc√© le plug-in dans le panneau - alors vous voyez le r√©sultat du lancement de notre programme l√†-bas (message d'erreur: le fichier mon.sh n'est pas un programme).  Ensuite, pour rendre le fichier ex√©cutable, acc√©dez √† notre dossier et d√©finissez-lui l'autorisation d'ex√©cuter - <ul><li>  ou gestionnaire de fichiers: Propri√©t√©s - Autorisations - Autoriser l'ex√©cution de ce fichier en tant que programme; </li><li>  ou une commande du terminal: <b>chmod 755 mon.sh</b> </li></ul><br>  Et dans le fichier lui-m√™me, nous √©crivons les premi√®res lignes: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # Monitor server responses (run this every 60 seconds): # info=$(curl -I -o /dev/stdout -w '%{time_total}' --url https://example.ru/ -m 9 -s) errr=$(echo $?)</span></span></code> </pre> <br>  Au lieu de "example.ru", remplacez le nom de votre site, dont vous observerez l'√©tat.  Et si cela fonctionne sur http, mettez http au lieu de https.  La ligne #! / Bin / bash signifie qu'il s'agit d'un script √† lancer par le programme Bash ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bash</a> est probablement le plus courant pour ex√©cuter des scripts sous Linux).  Pour travailler √† travers un autre shell, il est indiqu√© √† la place de Bash.  Les lignes restantes avec un pointu au d√©but sont des commentaires.  La premi√®re ligne de code elle-m√™me est <b>info = $ ()</b> et dans ces crochets se trouve la commande curl avec param√®tres.  Une telle construction - quelque chose = $ (quelque chose) - signifie "ex√©cuter la commande entre crochets et affecter le r√©sultat √† la variable de gauche".  Dans ce cas, j'ai nomm√© la variable ¬´info¬ª.  Cette commande entre parenth√®ses - curl (dans le jargon d√©sign√© par certains comme ¬´Kurl¬ª) - envoie une requ√™te au r√©seau √† l'adresse sp√©cifi√©e et nous renvoie la r√©ponse du serveur.  (Ma connaissance a dit, expliquant: "Comment la grue grogne - et re√ßoit une r√©ponse d'une autre grue dans le ciel.")  Consid√©rez les options: <br><br><pre> <code class="bash hljs">curl -I -o /dev/stdout -w <span class="hljs-string"><span class="hljs-string">'%{time_total}'</span></span> --url https://example.ru/ -m 9 -s</code> </pre><br>  <b>-Je</b> signifie que nous ne demandons pas la page enti√®re, mais seulement ses "en-t√™tes HTTP".  Chaque fois que nous n'avons pas besoin du texte entier de la page pour nous assurer que le site fonctionne.  √âtant donn√© que nous v√©rifierons souvent le site, il est important de r√©duire au maximum la taille des donn√©es transmises.  Cela permet d'√©conomiser du trafic, de l'√©lectricit√© et de la charge sur le serveur - et de la faune. <br><br>  Soit dit en passant, faites attention √† la quantit√© de trafic disponible (non utilis√© par mois) sur l'h√©bergement.  Ci-dessous, vous verrez combien de donn√©es sont transmises et vous pouvez calculer si vous avez suffisamment de r√©serves;  le cas √©ch√©ant, la p√©riode de v√©rification du site peut √™tre augment√©e √† 5, 10 ou m√™me 30 √† 60 minutes.  Bien que dans ce cas, l'image ne sera pas aussi compl√®te - et des interruptions mineures peuvent passer inaper√ßues;  mais, en g√©n√©ral, lors de la surveillance d'un site, il est plus important de d√©tecter les probl√®mes √† long terme qu'une seule interruption.  De plus, quel trafic pouvez-vous vous permettre sur l'ordinateur appelant?  Dans mon cas - un ordinateur de bureau avec un trafic illimit√© - ce n'est pas si important;  mais pour un appareil mobile ou un tarif avec des limites, cela vaut la peine de calculer et, √©ventuellement, d'augmenter les intervalles d'inspection. <br><br><h3>  4. L'√©tape suit l'√©tape sauf la premi√®re √©tape </h3><br>  Allons plus loin: <b>-o / dev / stdout</b> signifie "envoyer la r√©ponse re√ßue par Kurl du serveur vers tel ou tel fichier".  Et dans ce cas, ce n'est pas un fichier sur le disque, mais / dev / stdout - P√©riph√©rique de sortie standard.  Habituellement, le ¬´p√©riph√©rique de sortie standard¬ª est notre √©cran o√π nous pouvons voir les r√©sultats du programme.  Mais dans le script, nous dirigeons souvent cette ¬´sortie standard¬ª pour un traitement ult√©rieur (maintenant - enregistrez-la dans la variable info).  Et ensuite, le plus souvent, nous enverrons les r√©sultats des √©quipes √† des variables ou les transmettrons aux √©quipes suivantes d'une cha√Æne.  Pour cr√©er des cha√Ænes √† partir de commandes, utilisez l'op√©rateur de tuyau ("Pipe"), affich√© sous la forme d'une barre verticale ("|"). <br><br>  <b>-w '% {time_total} eyayu'</b> : ici -w signifie "formater et donner telle ou telle information suppl√©mentaire √† un p√©riph√©rique de sortie standard."  Plus pr√©cis√©ment, nous sommes int√©ress√©s par time_total - combien de temps la transmission de la demande-r√©ponse entre nous et le serveur a pris.  Vous savez probablement qu'il existe une commande plus simple, ping, pour demander rapidement un serveur et en obtenir une r√©ponse, pong.  Mais Ping v√©rifie seulement que le serveur d'h√©bergement est vivant, et le signal va et vient pendant tant de temps.  Cela montre la vitesse maximale d'acc√®s, mais ne nous dit toujours rien sur la rapidit√© avec laquelle le site produit du contenu r√©el.  Ping peut fonctionner rapidement et, en m√™me temps, le site peut ralentir ou ne pas fonctionner du tout - en raison d'une charge √©lev√©e ou de certains probl√®mes internes.  Par cons√©quent, nous utilisons exactement Kurla et obtenons l'heure r√©elle √† laquelle le serveur affiche notre contenu. <br><br>  (Et par ce param√®tre, vous pouvez juger si le serveur fonctionne efficacement pour vos t√¢ches, si son temps de r√©ponse typique est pratique pour les utilisateurs. Y a-t-il des probl√®mes - par exemple, mes sites sur de nombreux sites d'h√©bergement ont ralenti au fil du temps, et j'ai d√ª chercher un autre h√©bergement). <br><br>  Avez-vous remarqu√© les √©tranges lettres "eyu" apr√®s {time_total}?  Je les ai ajout√©s en tant qu‚Äô√©tiquette unique, qui ne figurera probablement pas dans les en-t√™tes qui nous sont envoy√©s depuis le serveur (bien que en supposant que les utilisateurs de vos programmes seront et ne seront pas mauvais et la route vers l‚Äôab√Æme. Ne faites pas √ßa! .. Ou, quand vous le faites , au moins avoir honte de vous).  Gr√¢ce √† cette √©tiquette (j'esp√®re), nous pouvons alors facilement extraire les informations dont nous avons besoin de tout un tas de lignes dans la variable info.  Donc, <b>curl -w '% {time_total} ehayu'</b> (avec les param√®tres restants corrects) nous donnera quelque chose comme: <br><br>  0,215238eyayu <br><br>  C'est le nombre de secondes qu'il a fallu pour acc√©der au site, plus notre √©tiquette.  (En plus de ce param√®tre, dans la variable info, nous serons principalement int√©ress√©s par le ¬´Code d'√©tat¬ª - le code d'√©tat, ou, simplement, le code de r√©ponse du serveur. Habituellement, lorsque le serveur √©met le fichier demand√©, le code est ¬´200¬ª. Lorsque la page est introuvable , c'est le fameux 404. Quand il y a des erreurs sur le serveur, c'est le plus souvent 500 avec quelque chose). <br><br><img src="https://habrastorage.org/webt/ka/rc/nk/karcnk8ggbptl5raex3j67k_aea.jpeg" alt="404" title="404"><br><br><h3>  5. Cr√©ativit√© - le p√®re de l'auto-test </h3><br>  Les param√®tres restants de notre boucle sont les suivants: <br><br><pre> <code class="bash hljs">--url https://example.ru/ -m 9 -s</code> </pre> <br>  ce que cela signifie: demander telle ou telle adresse;  le temps de r√©ponse maximum est de 9 secondes (vous pouvez d√©finir moins, car un utilisateur rare attendra une r√©ponse du site pendant si longtemps qu'il trouvera rapidement le site ne fonctionne pas).  Et "-s" signifie silencieux, c'est-√†-dire que curl ne nous dira pas de d√©tails inutiles. <br><br>  Soit dit en passant, il n'y a g√©n√©ralement pas beaucoup d'espace sur le panneau du bureau, par cons√©quent, pour d√©boguer un script, il est pr√©f√©rable de l'ex√©cuter √† partir du terminal (dans son dossier √† l'aide de la commande ./mon.sh).  Et pour notre plugin de panel, nous mettrons une longue pause entre les lancements de la commande - disons, 3600 secondes. <br><br>  Pour le d√©bogage, nous pouvons ex√©cuter cette boucle sans encadrer les crochets et voir ce qu'elle produit.  (√Ä partir de cela et calculer la consommation de trafic).  Nous verrons principalement un ensemble d'en-t√™tes HTTP, tels que: <br><br><pre> <code class="plaintext hljs">HTTP/1.1 302 Found Server: QRATOR Date: Sun, 11 Feb 2019 08:06:57 GMT Content-Type: text/html; charset=UTF-8 Connection: keep-alive Keep-Alive: timeout=15 X-Powered-By: PHP/7.2.14-1+ubuntu16.04.1+deb.sury.org+1 Location: https://habr.com/ru/ X-Frame-Options: SAMEORIGIN X-Content-Type-Options: nosniff Strict-Transport-Security: max-age=63072000; includeSubDomains; preload X-Cache-Status: HIT 0.033113</code> </pre><br>  La premi√®re ligne ici, nous voyons ¬´HTTP / 1.1 302 Found¬ª - ce qui signifie: le protocole de transfert de donn√©es est ¬´HTTP / 1.1¬ª, le code de r√©ponse du serveur est ¬´302 Found¬ª.  Lorsque vous demandez une autre page, il peut s'agir du code ¬´301 d√©plac√© en permanence¬ª, etc.  Dans un autre exemple, la r√©ponse normale de mon serveur est ¬´HTTP / 2 200¬ª.  Si votre serveur r√©pond normalement diff√©remment, remplacez-le par cette r√©ponse au lieu de ¬´HTTP / 2 200¬ª dans ce script. <br><br>  La derni√®re ligne, comme nous le voyons, Kurl donne, en combien de secondes nous avons re√ßu la r√©ponse du serveur, avec notre √©tiquette attribu√©e. <br><br>  Int√©ressant: nous pouvons configurer le site pour qu'il rende compte de nos demandes (et uniquement sur elles!) Des informations suppl√©mentaires sur son √©tat - par exemple, dans l'en-t√™te HTTP "fait maison".  Disons quelle est la charge des processeurs du site, combien de m√©moire libre et d'espace disque il a, et √† quelle vitesse la base de donn√©es fonctionne.  (Bien s√ªr, pour cela, le site doit √™tre dynamique, c'est-√†-dire que les demandes doivent √™tre trait√©es par le programme - en PHP, Node.JS, etc. Une autre option consiste √† utiliser un logiciel sp√©cial sur le serveur).  Mais peut-√™tre que nous n'avons pas encore vraiment besoin de ces d√©tails.  Le but de ce script est simplement de surveiller r√©guli√®rement les performances globales du site.  En cas de probl√®me - nous traiterons d√©j√† le diagnostic par d'autres moyens.  Par cons√©quent, nous √©crivons maintenant le script le plus simple qui fonctionnera pour n'importe quel site, m√™me statique, et sans param√®tres suppl√©mentaires sur le serveur.  √Ä l'avenir, si vous le souhaitez, il sera possible d'√©tendre les capacit√©s du script;  en attendant, faites la base. <br><br>  La cha√Æne <b>errr = $ (echo $?)</b> Signifie: √©crire le r√©sultat de la commande "echo $?" Dans la variable errr.  La commande echo signifie imprimer du texte sur le p√©riph√©rique de sortie standard (stdout) et les caract√®res "$?"  - Il s'agit du code d'erreur actuel (restant de la commande pr√©c√©dente).  Donc, si notre boucle ne peut soudainement pas atteindre le serveur, elle donnera un code d'erreur diff√©rent de z√©ro, et nous le d√©couvrirons en v√©rifiant la variable errr. <br><br><h3>  6. Opportunit√© </h3><br>  Ici, je veux faire une petite digression des questions techniques pour rendre la lecture du texte plus int√©ressante.  (Si vous n'√™tes pas d'accord, sautez trois paragraphes).  Je dirai que toute activit√© humaine est appropri√©e √† sa mani√®re.  M√™me lorsqu'une personne frappe intentionnellement son front contre un mur (ou sur le sol ... sur le clavier ...), cela a sa propre opportunit√©.  Par exemple, il fournit un d√©bouch√© pour l'√©nergie √©motionnelle - peut-√™tre pas de la ¬´meilleure¬ª mani√®re, mais comment cela peut.  (Oui, et le concept m√™me de "meilleur" est inutile du point de vue de <i>ce moment dans cet endroit</i> - parce que le meilleur et le pire ne sont possibles qu'en comparaison avec autre chose). <br><br>  J'√©cris ce texte maintenant, au lieu de cas apparemment plus importants pour moi - pourquoi?  Tout d'abord, afin de faire le point, de passer en revue et de trier en interne ce que j'ai appris en √©crivant des scripts au cours de ces deux jours ... Retirez-le de la RAM et stockez-le.  Deuxi√®mement, de cette fa√ßon, je me repose un peu ... Troisi√®mement, j'esp√®re que cette explication m√¢ch√©e sera utile √† quelqu'un d'autre (et √† moi-m√™me, peut-√™tre un jour).  Comment, peu importe s'il s'agit du meilleur rappel, mais distinct au sujet des scripts et des demandes de serveur. <br><br>  Quelqu'un me corrigera peut-√™tre quelque chose et le r√©sultat deviendra encore meilleur.  Quelqu'un recevra une information utile.  Est-ce appropri√©?  Peut-√™tre ... c'est ce que je peux faire maintenant et je le fais.  Demain, je vais peut-√™tre me r√©veiller et r√©√©valuer les actions en cours ... mais cette r√©√©valuation fournira √©galement quelque chose d'utile pour la vie future. <br><br>  Ainsi, une fois la demande satisfaite, nous avons deux donn√©es: <br><br><ul><li>  le bloc principal d'informations provenant du serveur (si, bien s√ªr, la r√©ponse du serveur est venue), nous l'avons √©crit dans la variable info; </li><li>  code d'erreur de la commande curl (0, si aucune erreur) - √©crit dans la variable errr. </li></ul><br>  Pr√©cis√©ment parce que les deux totaux - √† la fois des informations et un code d'erreur - sont n√©cessaires, je les ai √©crits dans des variables et je n'ai pas imm√©diatement transmis les totaux de Kurl √† d'autres √©quipes via le canal.  Mais maintenant, dans ce script, il est temps de grimper les tuyaux: <br><br><pre> <code class="bash hljs">code=$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$info</span></span></span><span class="hljs-string">"</span></span> | grep HTTP | grep -v <span class="hljs-string"><span class="hljs-string">'HTTP/2 200'</span></span>) date=$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$info</span></span></span><span class="hljs-string">"</span></span> | grep -i <span class="hljs-string"><span class="hljs-string">'date:'</span></span>) dlay=$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$info</span></span></span><span class="hljs-string">"</span></span> | grep  | sed -e <span class="hljs-string"><span class="hljs-string">'s///'</span></span>)</code> </pre><br>  Dans chacune de ces lignes, nous √©crivons une autre variable - nous enregistrons les r√©sultats de l'ex√©cution des commandes.  Et dans chaque cas, ce n'est pas une √©quipe, mais une cha√Æne;  le premier lien est le m√™me partout: <b>echo "$ info"</b> - renvoie au flux du p√©riph√©rique de sortie standard (stdout) le bloc d'informations que nous avons enregistr√©, re√ßu de curl.  Plus loin dans le tuyau, ce flux est transmis √† la commande grep.  Grep s√©lectionne parmi toutes les lignes uniquement celles dans lesquelles il correspond au motif.  (L'option -i signifie "insensible √† la casse").  Comme vous pouvez le voir, dans le premier cas, nous s√©lectionnons la ligne contenant "HTTP".  Cette ligne, tir√©e du tas du reste, est transmise par le canal √† la commande <b>grep -v 'HTTP / 2 200'</b> .  Ici, l' <b>option -v</b> est l'oppos√© de l'option <b>-e</b> , elle filtre les lignes o√π se trouve un tel mod√®le.  Total, dans la variable de code, il y aura une ligne avec le code de r√©ponse du serveur (tel que ¬´HTTP / 1.1 302 trouv√©¬ª), mais uniquement s'il ne s'agit pas de ¬´HTTP / 2 200¬ª.  Je filtre donc les lignes que mon site envoie dans le cas normal, et ne sauvegarde que les r√©ponses "anormales".  (Si vous avez une r√©ponse normale du serveur, remplacez-la ici). <br><br>  De m√™me, dans la date variable, nous √©crivons la ligne dans laquelle le serveur a publi√© sa date et son heure actuelles.  C'est quelque chose comme " <b>date: dim, 11 f√©v 2019 08:06:57 GMT</b> " (g√©n√©ralement dans le fuseau horaire GMT, alias UTC).  Nous devons √©crire la date (mais seulement une fois par jour!) Dans notre fichier journal ("journal d'√©tat du serveur") - server.log.  Et en m√™me temps, nous afficherons cette fois sur l'√©cran.  Vous pouvez √©crire une date-heure dans le journal depuis votre ordinateur, mais pour plus de commodit√©, nous les prenons, car le serveur les a quand m√™me envoy√©es. <br><br>  Il en va de m√™me pour notre troisi√®me variable, dlay (du mot anglais delay - delay).  Nous s√©lectionnons la ligne dans notre √©tiquette d'appel d'offres "eeyu" dans laquelle nous avons gard√© la dur√©e d'attente d'une r√©ponse du serveur.  Nous supprimons cette √©tiquette, qui n'est plus n√©cessaire, √† l'aide de la commande <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sed</a> - et enregistrons le r√©sultat. <br><br>  Maintenant, si nous imprimons ces variables pour v√©rification - par exemple, en ajoutant les lignes √† notre script: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'errr: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$errr</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'code: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$code</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$date</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'dlay: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span></code> </pre><br>  vous devriez obtenir quelque chose comme: <br><br><pre> <code class="plaintext hljs">errr: 0 code: date: Mon, 11 Feb 2019 12:46:18 GMT dlay: 0.236549</code> </pre><br>  Total: le code d'erreur de curl est z√©ro (ce qui signifie qu'il a bien fonctionn√©).  Code d'√©tat du serveur - non enregistr√© (comme c'√©tait normal).  Date et heure.  La dur√©e de la r√©ponse.  Il reste √† afficher correctement ce dont vous avez besoin √† l'√©cran et, si n√©cessaire, √† √©crire dans un fichier. <br><br>  C'est le plus int√©ressant: quoi, dans quelles conditions et comment enregistrer? <br><br><h3>  7. Conclusions d√©licates </h3><br>  Afin de ne pas vous ennuyer avec plus de d√©tails, je vais vous le dire bri√®vement (et il y a suffisamment de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bons r√©pertoires</a> sur toutes ces commandes sur Internet).  Soit dit en passant, la bri√®vet√© est l'un des principaux objectifs que nous atteindrons en √©crivant dans ce journal.  Ensuite, il sera pratique pour la visualisation et ne prendra jamais beaucoup d'espace disque (contrairement aux autres journaux qui augmentent en m√©gaoctets par jour). <br><br>  Premi√®rement: nous nous assurons d'√©crire la date dans le journal une seule fois, et non sur chaque ligne.  Pour ce faire, s√©lectionnez individuellement dans notre date variable la date actuelle (curr) et l'heure (time): <br><br><pre> <code class="bash hljs">curr=$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$date</span></span></span><span class="hljs-string">"</span></span> | sed -e <span class="hljs-string"><span class="hljs-string">'s/\(20[0-9][0-9]\).*$/\1/'</span></span>) time=$(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$date</span></span></span><span class="hljs-string">"</span></span> | sed -e <span class="hljs-string"><span class="hljs-string">'s/^.*\ \([0-9][0-9]:.*\)\ GMT\r$/\1/'</span></span>)</code> </pre><br>  Et nous consid√©rons √©galement les lignes avec les dates du fichier journal et prenons la derni√®re date (pr√©c√©dent): <br><br><pre> <code class="bash hljs">prev=$(cat /home/me/Progs/iNet/monitor/site.log | grep -e <span class="hljs-string"><span class="hljs-string">'date:'</span></span> | tail -1)</code> </pre><br>  Si notre date actuelle (curr) n'est pas √©gale √† la pr√©c√©dente (du fichier, prev), alors un nouveau jour est venu (ou, disons, le fichier journal √©tait vide);  puis √©crivez la nouvelle date dans le fichier: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ <span class="hljs-variable"><span class="hljs-variable">$curr</span></span> != <span class="hljs-variable"><span class="hljs-variable">$prev</span></span> ]]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$curr</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s %s %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$code</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log</code> </pre><br>  ... et en m√™me temps nous enregistrons les informations actuelles: heure, d√©lai de r√©ception d'une r√©ponse du site, code de r√©ponse du site (si ce n'est pas ordinaire): <br><br><pre> <code class="bash hljs"> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s %s %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$code</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log</code> </pre><br>  Cela vous aidera √† naviguer: telle ou telle journ√©e a commenc√© avec telle ou telle vitesse du site.  Dans d'autres cas, n'encombrons pas le fichier avec des entr√©es inutiles.  Bien s√ªr, nous l'√©crirons si nous obtenons un code d'√©tat de serveur inhabituel: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> [[ -n <span class="hljs-variable"><span class="hljs-variable">$code</span></span> ]]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s %s %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$code</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log</code> </pre><br>  Et aussi √©crire si le temps de r√©ponse du serveur est plus long que d'habitude.  Mon site √©tait g√©n√©ralement responsable de 0,23 √† 0,25 seconde, donc j'enregistre les r√©ponses qui ont pris plus de 0,3 seconde: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> (( $(<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string"> &gt; 0.3"</span></span> | bc -l) )); <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log</code> </pre><br>  Enfin, une fois par heure, j'enregistre simplement l'heure re√ßue du serveur - comme signe qu'il est vivant, et en m√™me temps comme une sorte de balisage du fichier: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> | grep -e :00: | cat &gt;&gt;/home/me/Progs/iNet/monitor/site.log <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br>  Nous obtenons le contenu du fichier o√π le balisage avec les enregistrements horaires aide visuellement, sans lire, pour voir quand la charge est sup√©rieure ou inf√©rieure (plus d'enregistrements par heure): <br><br><pre> <code class="plaintext hljs">19:42:28 0.461214 19:53:29 0.443956 20:00:29 20:09:30 2.156462 20:10:29 0.358294 20:45:29 0.313378 20:51:30 0.563886 20:54:30 0.307219 21:00:30 0.722343 21:01:30 0.310284 21:09:30 0.379662 21:10:31 1.305779 21:12:35 5.799455 21:23:31 1.054537 21:24:31 1.230391 21:40:31 0.461266 21:42:37 7.140093 22:00:31 22:12:37 5.724768 22:14:31 0.303500 22:42:37 5.735173 23:00:32 23:10:32 0.318207 date: Mon, 11 Feb 2019 00:00:34 0.235298 00:01:33 0.315093 01:00:34 01:37:41 5.741847 02:00:36 02:48:37 0.343234 02:56:37 0.647698 02:57:38 1.670538 02:58:39 2.327980 02:59:37 0.663547 03:00:37 03:40:38 0.331613 04:00:38 04:11:38 0.217022 04:50:39 0.313566 04:55:45 5.719911 05:00:39</code> </pre><br>  Et enfin, nous affichons des informations sur l'√©cran.  Et aussi, si curl a √©chou√©, nous affichons et √©crivons un message √† ce sujet (et en m√™me temps ex√©cutons Ping et connectez-vous pour v√©rifier si le serveur est vivant): <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'%s\n%s\n%s'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$dlay</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$code</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (( <span class="hljs-variable"><span class="hljs-variable">$errr</span></span> != 0 )); <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> date &gt;&gt;/home/me/Progs/iNet/monitor/site.log date <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'CURL Request failed. Error: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$errr</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'CURL Request failed. Error: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$errr</span></span></span><span class="hljs-string">"</span></span> pung=$(ping -c 1 178.248.237.68) <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'Ping: %s\n----\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pung</span></span></span><span class="hljs-string">"</span></span> &gt;&gt;/home/me/Progs/iNet/monitor/site.log <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">'Ping: %s\n'</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$pung</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br>  Remplacez l'adresse IP dans la cha√Æne de ping par la v√©ritable adresse IP de votre site. <br><br><h3>  8. Postface </h3><br>  Le r√©sultat du travail: <br><br><img src="https://habrastorage.org/webt/hk/zs/v-/hkzsv-3j9g-cv-wqklt2szu37hk.jpeg" alt="Le moniteur de site Web le plus simple" title="Le moniteur de site web le plus simple"><br><br>  Sur la gauche du panneau, vous pouvez voir l'heure en UTC et la r√©activit√© actuelle du site.  A droite se trouve le journal: il est visible au rallye, m√™me avec un d√©filement rapide, pendant quelles heures la charge √©tait plus ou moins.  Vous pouvez √©galement remarquer des r√©ponses anormalement lentes (pics; bien qu'il ne soit pas encore clair d'o√π ils viennent). <br><br>  C‚Äôest tout.  Le script s'est av√©r√© √™tre simple, ch√™ne, et il peut √™tre am√©lior√©: travail sur l'optimisation, la portabilit√©, l'am√©lioration des notifications et des affichages, en tenant compte du proxy et du cache ... <br><br>  Mais d√©j√† dans ce type de programme, il peut probablement donner une id√©e de l'√©tat de votre site.  Et que ce soit un site judicieusement appropri√©, utile aux gens et √† toutes les cr√©atures! <br><br><div class="spoiler">  <b class="spoiler_title">Texte int√©gral du script avec commentaires.</b>  <b class="spoiler_title">N'oubliez pas de faire les changements n√©cessaires!</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # Monitor server responses (run this every 60 seconds): info=$(curl -I -o /dev/stdout -w '%{time_total}' --url https://example.ru/ -m 9 -s) errr=$(echo $?) # errr = CURL error code https://curl.haxx.se/libcurl/c/libcurl-errors.html code=$(echo "$info" | grep HTTP | grep -v 'HTTP/2 200') date=$(echo "$info" | grep -i 'date:') dlay=$(echo "$info" | grep  | sed -e 's///') # code = Response code = 200? # =&gt; empty, otherwise response code string # # date = from HTTP Header of the server responded, like: # Date: Sun, 10 Feb 2019 05:01:50 GMT # # dlay = Response delay ("time_total") from CURL, like: # 0.25321 #printf 'errr: %s\n' "$errr" #printf 'code: %s\n' "$code" #printf '%s\n' "$date" #printf 'dlay: %s\n' "$dlay" curr=$(echo "$date" | sed -e 's/\(20[0-9][0-9]\).*$/\1/') time=$(echo "$date" | sed -e 's/^.*\ \([0-9][0-9]:.*\)\ GMT\r$/\1/') prev=$(cat /home/me/Progs/iNet/monitor/site.log | grep -e 'date:' | tail -1) # = Previously logged date, like: # date: Sun, 10 Feb 2019 # Day logged before vs day returned by the server; usually the same if [[ $curr != $prev ]]; then # Write date etc., at the beginning of every day: printf '%s\n' "$curr" &gt;&gt;/home/me/Progs/iNet/monitor/site.log printf '%s %s %s\n' "$time" "$dlay" "$code" &gt;&gt;/home/me/Progs/iNet/monitor/site.log elif [[ -n $code ]]; then # If the response had HTTP error code - log it: printf '%s %s ? %s\n' "$time" "$dlay" "$code" &gt;&gt;/home/me/Progs/iNet/monitor/site.log elif (( $(echo "$dlay &gt; 0.3" | bc -l) )); then # If the response delay was large - log it: printf '%s %s %s\n' "$time" "$dlay" "$code" &gt;&gt;/home/me/Progs/iNet/monitor/site.log else # If it's the start of an hour - just log the time echo "$time" | grep -e :00: | cat &gt;&gt;/home/me/Progs/iNet/monitor/site.log fi # To screen: printf '%s\n%s\n%s' "$time" "$dlay" "$code" # On CURL error: if (( $errr != 0 )); then date &gt;&gt;/home/me/Progs/iNet/monitor/site.log date printf 'CURL Request failed. Error: %s\n' "$errr" &gt;&gt;/home/me/Progs/iNet/monitor/site.log printf 'CURL Request failed. Error: %s\n' "$errr" pung=$(ping -c 1 178.248.237.68) printf 'Ping: %s\n----\n' "$pung" &gt;&gt;/home/me/Progs/iNet/monitor/site.log printf 'Ping: %s\n' "$pung" fi</span></span></code> </pre><br></div></div><br><br>  <b>PS.</b>  <b>Suite √† la discussion</b> (le 02/12/2019): <br><br>  Comme je l'esp√©rais, les experts ont √©crit de nombreux commentaires int√©ressants. <br><br>  Apr√®s y avoir r√©fl√©chi, je peux r√©pondre √† la question <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">rsashka</a> , quel est l'avantage de ce script. <br><br>  D'autres outils, tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NetData</a> (merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">tchspprt</a> pour l'astuce!), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Fournissent</a> un large √©ventail de donn√©es qui ne seront pas stock√©es longtemps.  NetData est un bon outil lorsque vous travaillez tous les jours, entretenez des sites Web de mani√®re professionnelle.  Bon pour diagnostiquer les probl√®mes actuels. <br><br>  Un script comme le mien est de garder un ≈ìil sur tout en faisant d'autres choses.  Le script ne n√©cessite pas d'√©tude et de param√®tres sp√©ciaux.  Ce n'est pas mauvais pour les la√Øcs.  Et ses journaux prennent si peu de place qu'ils ne peuvent pas √™tre effac√©s du tout.  Ils peuvent s'accumuler au fil des ann√©es, et au cours des ann√©es N + 1, vous pouvez voir: "Wow, en 2019, mon temps de r√©ponse √©tait une fois et demie plus bas! .." <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, une telle solution a sa propre niche - principalement pour les administrateurs non-syst√®me en permanence. (Comme le dit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tchspprt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : "Il s'agit de comment nourrir le chat d'un voisin en vacances"). </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">andreymal a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conseill√© une mani√®re int√©ressante de prendre en compte puis de visualiser la charge du site, sans fonds suppl√©mentaires, simplement via les journaux d'acc√®s sur le site. Et vous pouvez y cr√©er de superbes graphismes. Je vais probablement essayer cette option et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Github</font></a><font style="vertical-align: inherit;"> ce qui s'est pass√©. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unforgiven a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conseill√© une autre solution int√©ressante - probablement une solution simple (installez prometheus, blackbox et alermanager via docker composer). Sur mon VPS simple et bon march√© ne suffit pas pour cette m√©moire; et Linux avec un ancien noyau - Docker ne d√©marre pas. Mais merci pour l'option! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre conseil</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tchspprt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Graphite + Prom√©th√©e + Grafana. </font><font style="vertical-align: inherit;">Ou fournissez au script de superbes graphismes (gnuplot ou rrdtool). </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mcalexvrn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recommande un outil simple: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uptimerobot</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Je vous remercie! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je remercie tout le monde pour un tel √©ventail d'informations! </font><font style="vertical-align: inherit;">Qu'il soit utile aux gens ...</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439894/">https://habr.com/ru/post/fr439894/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439882/index.html">Aventure avec ptrace (2)</a></li>
<li><a href="../fr439884/index.html">Comment refuser des newsletters inutiles avec un seul bouton. Exp√©rience de l'√©quipe Yandex.Mail</a></li>
<li><a href="../fr439886/index.html">Comment j'ai enseign√© √† un r√©seau de neurones √† impl√©menter la fonction d'√©valuation de position lors du Russian AI Cup CodeBall 2018</a></li>
<li><a href="../fr439890/index.html">Les comp√©tences sont de 100% ou moins.</a></li>
<li><a href="../fr439892/index.html">Comment planifier pour un an. Etude de cas d'une entreprise informatique 120 personnes et deux cabinets pour petites √©quipes</a></li>
<li><a href="../fr439896/index.html">√âthique des contributions automatiques</a></li>
<li><a href="../fr439898/index.html">VBA et Python pour Excel et MS Office Automation</a></li>
<li><a href="../fr439900/index.html">Julia et la m√©thode de descente de coordonn√©es</a></li>
<li><a href="../fr439902/index.html">Explication de la nature physique du ph√©nom√®ne de ¬´Lift Force of the Wing¬ª sans utiliser l'√©quation de Bernoulli. 2e partie</a></li>
<li><a href="../fr439906/index.html">Vuln√©rabilit√© critique dans les produits antivirus Zemana et plus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>