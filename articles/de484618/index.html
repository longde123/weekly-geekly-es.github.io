<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë©‚Äçüëß üåò üíè Angular 9 und Ivy: Faulen Laden von Komponenten üå¶Ô∏è üë¢ üîë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lazy Component Loading in Angular? Vielleicht sprechen wir √ºber Lazy Loading-Module mit dem Angular-Router? Nein, wir sprechen √ºber die Komponenten. D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Angular 9 und Ivy: Faulen Laden von Komponenten</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/484618/">  Lazy Component Loading in Angular?  Vielleicht sprechen wir √ºber Lazy Loading-Module mit dem Angular-Router?  Nein, wir sprechen √ºber die Komponenten.  Die aktuelle Version von Angular unterst√ºtzt nur das verz√∂gerte Laden von Modulen.  Ivy bietet dem Entwickler jedoch neue M√∂glichkeiten bei der Arbeit mit Komponenten. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/484618/"><img src="https://habrastorage.org/webt/ox/8d/ub/ox8dubshhrdlijoson4_gyjtarw.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Die faulen Lasten, die wir bisher benutzt haben: Routen</font> </h2><br>  Lazy Loading ist ein gro√üartiger Mechanismus.  In Angular k√∂nnen Sie diesen Mechanismus ohne gro√üen Aufwand verwenden, indem Sie Routen deklarieren, die das langsame Laden unterst√ºtzen.  Hier ist ein Beispiel aus der Angular- <a href="https://angular.io/guide/lazy-loading-ngmodules">Dokumentation</a> , das dies demonstriert: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> routes: Routes = [     { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'customer-list'</span></span>,       <span class="hljs-attr"><span class="hljs-attr">loadChildren</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./customers/customers.module'</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">m</span></span></span><span class="hljs-function"> =&gt;</span></span> m.CustomersModule) }     ];</code> </pre> <br>  Dank des obigen Codes wird ein separates Fragment f√ºr <code>customers.module</code> erstellt, das geladen wird, wenn der Benutzer entlang der <code>customer-list</code> navigiert. <br><br>  Dies ist eine sehr gute M√∂glichkeit, um das Hauptpaket des Projekts zu verkleinern und das erstmalige Laden der Anwendung zu beschleunigen. <br><br>  Aber w√§re es nicht sch√∂n, das langsame Laden genauer steuern zu k√∂nnen?  Was w√§re zum Beispiel, wenn wir das verz√∂gerte Laden einzelner Komponenten organisieren k√∂nnten? <br><br>  Bisher war dies nicht m√∂glich.  Aber mit dem Aufkommen von Ivy √§nderte sich alles. <br><br><h2>  <font color="#3AC1EF">Efeu und das Konzept der "Lokalit√§t"</font> </h2><br>  Module sind das Grundkonzept und der Grundbaustein jeder Angular-Anwendung.  Die Module deklarieren Komponenten, Richtlinien, Rohre, Dienste. <br><br>  Eine moderne Angular-Anwendung kann ohne Module nicht existieren.  Ein Grund daf√ºr ist die Tatsache, dass ViewEngine den Modulen alle erforderlichen Metadaten hinzuf√ºgt. <br><br>  Ivy geht dagegen anders vor.  In Ivy kann eine Komponente ohne Modul existieren.  Dies ist dank des Konzepts der Lokalit√§t m√∂glich.  Das Wesentliche ist, dass alle Metadaten f√ºr die Komponente lokal sind. <br><br>  Lassen Sie uns dies erkl√§ren, indem wir das mit Ivy generierte Paket es2015 analysieren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/775/370/02b7753703a0599491c3f9076527168f.png"></div><br>  <i><font color="#999999">Es2015-Bundle generiert mit Ivy</font></i> <br><br>  Im Abschnitt <code>Component code</code> k√∂nnen Sie sehen, dass das Ivy-System den Komponentencode gespeichert hat.  Hier gibt es nichts Besonderes.  Aber dann f√ºgt Ivy dem Code einige Metadaten hinzu. <br><br>  Das erste St√ºck Metadaten ist in der Abbildung als <code>Component factory</code> .  Die Fabrik wei√ü, wie eine Komponente instanziiert wird.  Im Abschnitt <code>Component metadata</code> Ivy zus√§tzliche Attribute wie <code>type</code> und <code>selectors</code> , <code>selectors</code> alles, was die Komponente w√§hrend der Programmausf√ºhrung ben√∂tigt. <br><br>  Erw√§hnenswert ist, dass Ivy hier die <code>template</code> Funktion hinzuf√ºgt.  Es wird in der <code>Compiled version of your template</code> angezeigt.  Lassen Sie uns auf diese interessante Tatsache n√§her eingehen. <br><br>  Die <code>template</code> Funktion ist eine kompilierte Version unseres HTML-Codes.  Sie folgt den Anweisungen von Ivy, um ein DOM zu erstellen.  Dies unterscheidet sich von der Funktionsweise von ViewEngine. <br><br>  Das ViewEngine-System nimmt den Code und umgeht ihn.  Angular f√ºhrt den Code dann aus, wenn wir ihn verwenden. <br><br>  Und mit dem von Ivy verwendeten Ansatz ist die Komponente, die die Angular-Befehle aufruft, f√ºr alles verantwortlich.  Durch diese √Ñnderung k√∂nnen Komponenten unabh√§ngig voneinander existieren. Dies f√ºhrt dazu, dass der Tree-Shake-Algorithmus auf den Angular-Basiscode angewendet werden kann. <br><br><h2>  <font color="#3AC1EF">Ein echtes Beispiel f√ºr das langsame Laden von Komponenten</font> </h2><br>  Jetzt, da wir wissen, dass ein verz√∂gertes Laden von Komponenten m√∂glich ist, betrachten wir dies anhand eines konkreten Beispiels.  Wir werden n√§mlich eine Quizanwendung erstellen, die den Benutzern Fragen mit Antwortoptionen stellt. <br><br>  Die Anwendung zeigt ein Bild der Stadt und Optionen an, aus denen Sie den Namen dieser Stadt ausw√§hlen m√ºssen.  Sobald der Benutzer eine Option durch Klicken auf die entsprechende Schaltfl√§che ausw√§hlt, √§ndert sich diese Schaltfl√§che sofort und zeigt an, ob die Antwort richtig oder falsch war.  Wenn der Hintergrund der Schaltfl√§che gr√ºn wird, war die Antwort korrekt.  Wenn der Hintergrund rot wird, war die Antwort falsch. <br><br>  Nachdem die Antwort auf die aktuelle Frage eingegangen ist, zeigt das Programm die folgende Frage an.  So sieht es aus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fc/768/ece/2fc768ecebd5c52399030c0d2dc47c66.gif"></div><br>  <i><font color="#999999">Quiz Demo</font></i> <br><br>  Die Fragen, die das Programm dem Benutzer stellt, werden von der Komponente <code>QuizCardComponent</code> . <br><br><h2>  <font color="#3AC1EF">Lazy Komponentenladekonzept</font> </h2><br>  Lassen Sie uns zun√§chst die allgemeine Idee des verz√∂gerten Ladens der <code>QuizCardComponent</code> Komponente <code>QuizCardComponent</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/45a/b2b/4ab45ab2b677ce0d886d2f26a5645edb.png"></div><br>  <i><font color="#999999">Der QuizCardComponent-Komponentenprozess</font></i> <br><br>  Nachdem der Benutzer das Quiz durch Klicken auf die Schaltfl√§che <code>Start quiz</code> starten gestartet hat, wird das verz√∂gerte Laden der Komponente gestartet.  Nachdem das Bauteil zu unserer Verf√ºgung steht, legen wir es in einen Beh√§lter. <br><br>  Wir reagieren auf <code>questionAnsvered</code> Ereignisse einer ‚Äûfaulen‚Äú Komponente genauso wie auf Ereignisse einer regul√§ren Komponente.  Nach dem Eintreten des Ereignisses zeigen wir die n√§chste Karte mit der Frage auf dem Bildschirm an. <br><br><h2>  <font color="#3AC1EF">Code-Analyse</font> </h2><br>  Um zu verstehen, was beim verz√∂gerten Laden einer Komponente passiert, beginnen wir mit einer vereinfachten Version von <code>QuizCardComponent</code> , in der die Eigenschaften der Frage <code>QuizCardComponent</code> . <br><br>  Dann werden wir diese Komponente mit Winkelmaterialkomponenten erweitern.  Und am Ende werden wir die Reaktion auf die von der Komponente erzeugten Ereignisse anpassen. <br><br>  Lassen Sie uns das verz√∂gerte Laden einer vereinfachten Version der <code>QuizCardComponent</code> Komponente mit der folgenden Vorlage organisieren: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Here's the question<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Image: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.image }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Possible selections: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.possibleSelections.toString() }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Correct answer: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.correctAnswer }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Der erste Schritt besteht darin, ein Containerelement zu erstellen.  Dazu k√∂nnen wir entweder ein reales Element wie <code>&lt;div&gt;</code> oder - auf <code>ng-container</code> zur√ºckgreifen, wodurch wir auf eine zus√§tzliche HTML-Code-Ebene verzichten k√∂nnen.  So sieht die Deklaration des Container-Elements aus, in das wir die ‚ÄûLazy‚Äú -Komponente einf√ºgen: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-toolbar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>City quiz<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-toolbar</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngIf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"!quizStarted"</span></span></span><span class="hljs-tag">        </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-raised-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">        </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-quiz-button"</span></span></span><span class="hljs-tag">        (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"startQuiz()"</span></span></span><span class="hljs-tag">&gt;</span></span>Start quiz<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-container</span></span></span><span class="hljs-tag"> #</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">quizContainer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-card-container"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-container</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  In der Komponente m√ºssen Sie auf den Container zugreifen.  Dazu verwenden wir die Annotation <code>@ViewChild</code> und <code>@ViewChild</code> uns mit, dass <code>ViewContainerRef</code> gelesen werden <code>ViewContainerRef</code> . <br><br>  Beachten Sie, dass in Angular 9 die <code>static</code> Eigenschaft in der Annotation <code>@ViewChild</code> standardm√§√üig auf <code>false</code> ist: <br><br><pre> <code class="javascript hljs">@ViewChild(<span class="hljs-string"><span class="hljs-string">'quizContainer'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">read</span></span>: ViewContainerRef}) quizContainer: ViewContainerRef;</code> </pre> <br>  Jetzt haben wir einen Container, in dem wir die "Lazy" -Komponente hinzuf√ºgen m√∂chten.  Als n√§chstes ben√∂tigen wir <code>ComponentFactoryResolver</code> und <code>Injector</code> .  Beide k√∂nnen durch R√ºckgriff auf die Methode der Abh√§ngigkeitsinjektion erworben werden. <br><br>  Die <code>ComponentFactoryResolver</code> Entit√§t ist eine einfache Registrierung, mit der die Beziehungen zwischen Komponenten und automatisch generierten <code>ComponentFactory</code> Klassen festgelegt werden, mit denen Komponenten instanziiert werden k√∂nnen: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private quizservice: QuizService,            private cfr: ComponentFactoryResolver,            private injector: Injector) { }</code> </pre> <br>  Jetzt haben wir alles, was n√∂tig ist, um das Ziel zu erreichen.  <code>startQuiz</code> den Inhalt der <code>startQuiz</code> Methode <code>startQuiz</code> und das verz√∂gerte Laden der Komponente organisieren: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {QuizCardComponent} = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./quiz-card/quiz-card.component'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> quizCardFactory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cfr.resolveComponentFactory(QuizCardComponent); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {instance} = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.quizContainer.createComponent(quizCardFactory, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.injector); instance.question = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.quizservice.getNextQuestion();</code> </pre> <br>  Wir k√∂nnen den Befehl <code>import</code> ECMAScript verwenden, um das verz√∂gerte Laden von <code>QuizCardComponent</code> zu organisieren.  Ein Import-Ausdruck gibt ein Versprechen zur√ºck.  Sie k√∂nnen damit entweder mit dem Konstrukt <code>async/await</code> oder mit dem Handler <code>.then</code> .  Nachdem wir das Versprechen gel√∂st haben, verwenden wir die Destrukturierung, um eine Instanz der Komponente zu erstellen. <br><br>  In diesen Tagen m√ºssen Sie <code>ComponentFactory</code> , um die Abw√§rtskompatibilit√§t zu gew√§hrleisten.  Zuk√ºnftig wird die entsprechende Leitung nicht mehr ben√∂tigt, da wir direkt mit dem Bauteil arbeiten k√∂nnen. <br><br>  Die <code>ComponentFactory</code> Factory gibt uns <code>componentRef</code> .  Wir √ºbergeben <code>componentRef</code> und <code>Injector</code> an die <code>createComponent</code> Methode des Containers. <br><br>  Die <code>createComponent</code> Methode gibt ein <code>ComponentRef</code> in dem die Komponenteninstanz enthalten ist.  Wir √ºbergeben mit <code>instance</code> die <code>@Input</code> der Komponente <code>@Input</code> . <br><br>  In Zukunft kann dies wahrscheinlich mit der Angular <code>renderComponent</code> Methode erfolgen.  Diese Methode ist noch experimentell.  Es ist jedoch sehr wahrscheinlich, dass es sich um eine regul√§re Angular-Methode handelt.  <a href="https://github.com/LayZeeDK/ivy-dynamic-rendering">Hier finden Sie</a> hilfreiche Materialien zu diesem Thema. <br><br>  Dies ist alles, was ben√∂tigt wird, um das verz√∂gerte Laden einer Komponente zu organisieren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d4/2bd/4bc/2d42bd4bc38ee01c427c94286e060cbb.png"></div><br>  <i><font color="#999999">Lazy Component Loading</font></i> <br><br>  Nachdem Sie auf die Schaltfl√§che <code>Start quiz</code> geklickt haben, beginnt das verz√∂gerte Laden der Komponente.  Wenn Sie die Registerkarte " <code>Network</code> der Entwicklertools √∂ffnen, k√∂nnen Sie sehen, wie Sie das Codefragment, das in der Datei " <code>quiz-card-quiz-card-component.js</code> dargestellt wird, tr√§ge laden.  Nach dem Laden und Bearbeiten der Komponente wird dem Benutzer eine Fragekarte angezeigt. <br><br><h2>  <font color="#3AC1EF">Komponentenerweiterung</font> </h2><br>  Wir laden gerade die <code>QuizCardComponent</code> Komponente.  Es ist sehr gut.  Unsere Anwendung ist jedoch noch nicht besonders funktionsf√§hig. <br><br>  Lassen Sie uns das beheben, indem Sie zus√§tzliche Features und Komponenten von Angular Material hinzuf√ºgen: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-card"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-header</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-card-avatar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-header-image"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-title</span></span></span><span class="hljs-tag">&gt;</span></span>Which city is this?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-title</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-subtitle</span></span></span><span class="hljs-tag">&gt;</span></span>Click on the correct answer below<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-subtitle</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-header</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-card-image</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"'assets/' + question.image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Photo of a Shiba Inu"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-actions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answer-section"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answeredCorrectly !== undefined"</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"let selection of question.possibleSelections"</span></span></span><span class="hljs-tag">            </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-stroked-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">            [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngClass</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{              'correct': answeredCorrectly &amp;&amp; selection === question.correctAnswer,              'wrong': answeredCorrectly === false &amp;&amp; selection === question.correctAnswer             }"</span></span></span><span class="hljs-tag">            (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answer(selection)"</span></span></span><span class="hljs-tag">&gt;</span></span>      {{selection}}    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-actions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Wir haben einige sch√∂ne Materialkomponenten in die Komponente aufgenommen.  Was ist mit den entsprechenden Modulen? <br><br>  Sie k√∂nnen nat√ºrlich zum <code>AppModule</code> hinzugef√ºgt werden.  Dies bedeutet jedoch, dass diese Module im "gierigen" Modus geladen werden.  Und das ist keine gute Idee.  Dar√ºber hinaus schl√§gt die Montage des Projekts mit der folgenden Meldung fehl: <br><br><pre> <code class="javascript hljs">ERROR <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> src/app/quiz-card/quiz-card.component.html:<span class="hljs-number"><span class="hljs-number">9</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> - error TS<span class="hljs-number"><span class="hljs-number">-998001</span></span>: <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is not a known element: <span class="hljs-number"><span class="hljs-number">1.</span></span> If <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is an Angular component, then verify that it is part <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>. <span class="hljs-number"><span class="hljs-number">2.</span></span> If <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is a Web Component then add <span class="hljs-string"><span class="hljs-string">'CUSTOM_ELEMENTS_SCHEMA'</span></span> to the <span class="hljs-string"><span class="hljs-string">'@NgModule.schemas'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> component to suppress <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> message.</code> </pre> <br>  Was zu tun ist?  Wie Sie wahrscheinlich bereits verstanden haben, ist dieses Problem vollst√§ndig l√∂sbar.  Dies kann mit Hilfe von Modulen erfolgen. <br><br>  Aber dieses Mal werden wir sie ein wenig anders als zuvor verwenden.  Wir werden der gleichen Datei wie <code>QuizCardComponent</code> ein kleines Modul <code>QuizCardComponent</code> (in der Datei <code>quizcard.component.ts</code> ): <br><br><pre> <code class="javascript hljs">@NgModule({  <span class="hljs-attr"><span class="hljs-attr">declarations</span></span>: [QuizCardComponent],  <span class="hljs-attr"><span class="hljs-attr">imports</span></span>: [CommonModule, MatCardModule, MatButtonModule] }) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuizCardModule</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br>  Beachten Sie, dass es keine <code>export</code> . <br><br>  Diese Modulspezifikation geh√∂rt ausschlie√ülich zu unserer Komponente und wird im Lazy Mode geladen.  Folglich ist die einzige Komponente, die im Modul deklariert ist, <code>QuizCardComponent</code> .  Der <code>import</code> nur die Module, die unsere Komponente ben√∂tigt. <br><br>  Das neue Modul wird nicht exportiert, sodass im Greedy-Modus geladene Module es nicht importieren k√∂nnen. <br><br>  Starten Sie die Anwendung neu und √ºberpr√ºfen Sie, wie sie sich verh√§lt, wenn Sie auf die <code> Start quiz</code> klicken. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc5/4bf/c60/bc54bfc6057cc6707e4f01a5bf871de9.png"></div><br>  <i><font color="#999999">Ge√§nderte Anwendungsanalyse</font></i> <br><br>  Gro√üartig!  Die <code>QuizCardComponent</code> Komponente <code>QuizCardComponent</code> im Lazy-Modus geladen und dem <code>ViewContainer</code> hinzugef√ºgt.  Alle notwendigen Abh√§ngigkeiten werden damit geladen. <br><br>  Wir werden das Anwendungspaket mit dem <code>webpack-bundle-analyze</code> Tool <code>webpack-bundle-analyze</code> , das vom entsprechenden npm-Modul bereitgestellt wird.  Sie k√∂nnen den Inhalt der von Webpack erstellten Dateien visualisieren und das resultierende Schema untersuchen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d2a/a5a/2aa/d2aa5a2aae380755aca3872db6d068f9.png"></div><br>  <i><font color="#999999">Analyse der Anwendungspakete</font></i> <br><br>  Die Gr√∂√üe des Hauptpakets der Anwendung betr√§gt ungef√§hr 260 KB.  Wenn wir die <code>QuizCardComponent</code> Komponente zusammen mit ihr herunterladen, <code>QuizCardComponent</code> die Gr√∂√üe der heruntergeladenen Daten ungef√§hr 270 KB.  Es stellte sich heraus, dass wir die Gr√∂√üe des Hauptpakets um 10 KB reduzieren konnten, indem wir nur eine Komponente im Lazy-Modus geladen haben.  Gutes Ergebnis! <br><br>  Der Code von <code>QuizCardComponent</code> nach dem Zusammenbau in eine separate Datei √ºbertragen.  Wenn Sie den Inhalt dieser Datei analysieren, stellt sich heraus, dass nicht nur der <code>QuizCardComponent</code> Code, sondern auch die in dieser Komponente verwendeten Materialmodule vorhanden sind. <br><br>  Obwohl <code>QuizCardComponent</code> <code>MatButtonModule</code> und <code>MatCardModule</code> , <code>MatCardModule</code> nur <code>MatCardModule</code> in die fertige <code>MatCardModule</code> .  Der Grund daf√ºr ist, dass wir das <code>MatButtonModule</code> im <code>AppModule</code> und die Schaltfl√§che <code>Start quiz</code> anzeigen.  Infolgedessen f√§llt der entsprechende Code in ein anderes Fragment des B√ºndels. <br><br>  Jetzt haben wir das faule Laden von <code>QuizCardComponent</code> .  Diese Komponente zeigt eine Karte im Materialstil an, die ein Bild, eine Frage und Schaltfl√§chen mit Antwortoptionen enth√§lt.  Was passiert jetzt, wenn Sie auf eine dieser Schaltfl√§chen klicken? <br><br>  Die Schaltfl√§che wird, je nachdem, ob sie die richtige oder die falsche Antwort enth√§lt, beim Dr√ºcken gr√ºn oder rot.  Was ist sonst noch los?  Nichts  Und wir brauchen, dass nach Beantwortung einer Frage eine Karte einer anderen Frage angezeigt wird.  Repariere es. <br><br><h2>  <font color="#3AC1EF">Ereignisbehandlung</font> </h2><br>  Die Anwendung zeigt keine neue Fragekarte an, wenn Sie auf die Antwortschaltfl√§che klicken, da wir noch keine Mechanismen zum Reagieren auf Ereignisse von Komponenten eingerichtet haben, die im verz√∂gerten Modus geladen wurden.  Wir wissen bereits, dass die <code>QuizCardComponent</code> Komponente mithilfe von <code>EventEmitter</code> Ereignisse <code>EventEmitter</code> .  Wenn Sie sich die Definition der <code>EventEmitter</code> Klasse <code>EventEmitter</code> , k√∂nnen Sie feststellen, dass es sich um einen Nachkommen der <code>Subject</code> Klasse handelt: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> declare <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventEmitter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Subject</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  Dies bedeutet, dass <code>EventEmitter</code> √ºber eine <code>subscribe</code> , mit der Sie die Reaktion des Systems auf auftretende Ereignisse konfigurieren k√∂nnen: <br><br><pre> <code class="javascript hljs">instance.questionAnswered.pipe(    takeUntil(instance.destroy$) ).subscribe(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showNewQuestion());</code> </pre> <br>  Hier abonnieren wir den <code>questionAnswered</code> Stream und rufen die <code>showNextQuestion</code> Methode auf, die die <code>lazyLoadQuizCard</code> Logik ausf√ºhrt: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> showNewQuestion() {  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lazyLoadQuizCard(); }</code> </pre> <br>  Das <code>takeUntil(instance.destroy$)</code> wird ben√∂tigt, um die Subskription zu l√∂schen, die ausgef√ºhrt wird, nachdem die Komponente zerst√∂rt wurde.  Wenn der Hook <code>ngOnDestroy</code> Komponentenlebenszyklus von <code>ngOnDestroy</code> aufgerufen wird, wird <code>destroy$</code> mit <code>next</code> und <code>complete</code> aufgerufen. <br><br>  Da die Komponente bereits geladen ist, f√ºhrt das System keine zus√§tzliche HTTP-Anforderung durch.  Wir verwenden den Inhalt des bereits vorhandenen Codefragments, erstellen eine neue Komponente und legen sie in den Container. <br><br><h2>  <font color="#3AC1EF">Haken f√ºr den Komponentenlebenszyklus</font> </h2><br>  Nahezu alle Komponenten-Lifecycle-Hooks werden automatisch aufgerufen, wenn mit der <code>QuizCardComponent</code> Komponente mithilfe der Lazy-Loading-Technik gearbeitet wird.  Aber ein Haken reicht nicht aus.  Kannst du welche verstehen? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/4f7/b2a/ceb4f7b2a34bbed6ced31f69713e4f68.png"></div><br>  <i><font color="#999999">Haken f√ºr den Komponentenlebenszyklus</font></i> <br><br>  Dies ist der wichtigste Haken von <code>ngOnChanges</code> .  Da wir die Eingabeeigenschaften der Komponenteninstanz selbst aktualisieren, sind wir auch daf√ºr verantwortlich, den Lifecycle-Hook <code>ngOnChanges</code> . <br><br>  Um den Hook <code>ngOnChanges</code> der <code>ngOnChanges</code> , m√ºssen Sie selbst ein <code>SimpleChange</code> Objekt <code>SimpleChange</code> : <br><br><pre> <code class="javascript hljs">(instance <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> any).ngOnChanges({    <span class="hljs-attr"><span class="hljs-attr">question</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleChange(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, instance.question, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) });</code> </pre> <br>  Wir rufen <code>ngOnChanges</code> Komponenteninstanz <code>ngOnChanges</code> manuell auf und √ºbergeben ihr ein <code>SimpleChange</code> Objekt.  Dieses Objekt gibt an, dass diese √Ñnderung die erste ist, dass der vorherige Wert <code>null</code> ist und dass der aktuelle Wert eine Frage ist. <br><br>  Gro√üartig!  Wir haben die Komponente mit Modulen von Drittanbietern geladen, auf die von ihr erzeugten Ereignisse reagiert und den Aufruf der erforderlichen Hooks des Komponentenlebenszyklus eingerichtet. <br><br>  <a href="https://github.com/kreuzerk/city-quiz">Hier ist der</a> Quellcode f√ºr das fertige Projekt, an dem wir hier gearbeitet haben. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Das langsame Laden von Komponenten bietet Angular-Entwicklern hervorragende M√∂glichkeiten zur Optimierung der Anwendungsleistung.  Ihm stehen die Werkzeuge zur Verf√ºgung, um die Zusammensetzung von Materialien, die im Lazy Mode geladen werden, sehr fein abzustimmen.  Fr√ºher, als es m√∂glich war, nur Routen im Lazy-Modus zu laden, hatten wir keine solche Genauigkeit. <br><br>  Wenn wir Module von Drittanbietern in der Komponente verwenden, m√ºssen wir uns leider auch um die Module k√ºmmern.  Es sei jedoch daran erinnert, dass sich dies in Zukunft √§ndern kann. <br><br>  Die Ivy-Engine f√ºhrte das Konzept der Lokalit√§t ein, dank derer Komponenten unabh√§ngig voneinander existieren k√∂nnen.  Diese Ver√§nderung ist die Grundlage f√ºr die Zukunft von Angular. <br><br>  <b>Sehr geehrte Leser!</b>  Planen Sie, in Ihren Angular-Projekten die Lazy-Component-Loading-Technik zu verwenden? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484618/">https://habr.com/ru/post/de484618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484604/index.html">Neues Jahr, neuer Browser: Microsoft Edge ist noch nicht fertig und kann jetzt heruntergeladen werden</a></li>
<li><a href="../de484610/index.html">Auf Wiedersehen sauberer Code</a></li>
<li><a href="../de484612/index.html">Optimierung der Projekterstellungszeit</a></li>
<li><a href="../de484614/index.html">6 Empfehlungen f√ºr die Entwicklung sicherer Go-Anwendungen</a></li>
<li><a href="../de484616/index.html">6 Erkenntnisse aus Node.js Erfahrung in der Optimierung der Serviceleistung</a></li>
<li><a href="../de484620/index.html">Neuer PS1-Grafik-Renderer f√ºr Omega Red Emulator</a></li>
<li><a href="../de484624/index.html">Intervall-Fasten und Lebensverl√§ngerungsmuster</a></li>
<li><a href="../de484628/index.html">Eric Ciaramella als Beispiel f√ºr Zensur bei Wikipedia / Google</a></li>
<li><a href="../de484630/index.html">CES 2020: Zeit zu √ºberraschen</a></li>
<li><a href="../de484634/index.html">Node.js VS Python: Was ist besser?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>