<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçü§ù‚Äçüë®üèº ‚ö´Ô∏è üîí Acerca de los gr√°ficos 3D en palabras simples üëâüèΩ üë©‚Äçüåæ üå∂Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parte 1. Introducci√≥n 
 Hola mi nombre es baldurk He estado trabajando como programador de gr√°ficos durante varios a√±os, por lo que aunque de ninguna ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Acerca de los gr√°ficos 3D en palabras simples</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430930/"><h2>  Parte 1. Introducci√≥n </h2><br>  Hola mi nombre es baldurk  He estado trabajando como programador de gr√°ficos durante varios a√±os, por lo que aunque de ninguna manera soy un experto, parece que ya entiendo mucho sobre todo lo relacionado con el trabajo con gr√°ficos. <br><br>  La idea de esta serie de publicaciones ha estado flotando en alg√∫n lugar en la periferia de mi mente, y surgi√≥ nuevamente despu√©s de leer un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo interesante con un an√°lisis del √∫ltimo Deus Ex</a> . <br><br>  Me parece que los gr√°ficos, y especialmente la complejidad que logra en los juegos modernos, es un tema interesante.  Muy pocas personas sienten curiosidad por profundizar en todos sus detalles, pero creo que hay temas que interesan a todos.  Creo que la mayor√≠a de las personas que jugaban a juegos ten√≠an curiosidad acerca de c√≥mo se obten√≠an estos o esos efectos, o con qu√© tecnolog√≠a lograron crear gr√°ficos tan sorprendentes en alg√∫n juego nuevo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c8/3b9/2ad/4c83b92ad325af58966fc3742aa85a10.jpg"></div><br>  <em>Hay muchos componentes necesarios para crear incluso un juego 3D simple, sin mencionar un proyecto como Watch Dogs.</em> <br><br>  Solo tengo una idea general de lo que debe considerarse en este art√≠culo, pero depender√° de qu√© temas causen inter√©s.  Sin embargo, la idea principal es crear una descripci√≥n general de lo que est√° sucediendo dentro del juego moderno sin asustar a ninguno de los lectores. Asumir√© que no tienes conocimiento de matem√°ticas y programaci√≥n.  Si conoce la diferencia entre la CPU y la tarjeta gr√°fica, y distingue la RAM del disco duro, esto ser√° suficiente, y explicar√© el resto. <br><a name="habracut"></a><br>  Este art√≠culo se desarrollar√° de acuerdo con su video <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tutorial Chip &amp; Ironicus Let's Play of Watch Dogs</a> , para estructurar ligeramente la presentaci√≥n.  El juego es bien conocido por sus gr√°ficos (y las opiniones al respecto pueden ser completamente opuestas), y hay muchos aspectos que se pueden considerar con ejemplos separados.  Quiz√°s hablar√© sobre otros juegos. <br><br>  Comenzar√© explicando los conceptos b√°sicos que son m√°s o menos los mismos para cada juego, pero tambi√©n analizar√© algunas de las t√©cnicas y efectos visuales de Watch Dogs. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Usar√©</a> una herramienta llamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RenderDoc</a> , que escrib√≠ en mi tiempo libre.  Se utiliza para depurar problemas con gr√°ficos: la herramienta le permite descomponer un marco gr√°fico en partes, y gracias a esto veremos c√≥mo se junta. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//OBaA9JD/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Esta animaci√≥n muestra parte de un marco que se est√° creando gradualmente en el proceso de renderizarlo con una tarjeta gr√°fica.</em> <br><br>  La mayor√≠a de la gente sabe que los gr√°ficos por computadora (y los gr√°ficos de cualquier otro video) consisten en una serie de cuadros fijos, cada uno de los cuales se muestra durante una cierta fracci√≥n de segundo.  En el cine, tradicionalmente usado 24 cuadros por segundo (cuadros por segundo, FPS), en televisi√≥n la frecuencia es aproximadamente la misma, aproximadamente 24-30 cuadros.  En los juegos, los FPS pueden ser cambiables porque se hace mucho trabajo en cada cuadro.  Una ca√≠da de frecuencia por debajo de 30 no es deseable, aunque ocurre con bastante frecuencia.  Por lo general, el l√≠mite superior para juegos de consola es de 60 FPS.  Los desarrolladores buscan implementar una frecuencia de 30 o 60, que depende de los objetivos del juego.  En una PC, con una pantalla con una alta velocidad de cuadros, puede alcanzar 90, 120 o incluso m√°s.  La raz√≥n de estos n√∫meros espec√≠ficos es la sincronizaci√≥n vertical (vsync), que discutiremos a continuaci√≥n. <br><br>  Mentalmente, podemos ver esta tarea desde el lado opuesto: en lugar de ver qu√© tan <em>alta es la</em> frecuencia de FPS, observamos el <em>poco</em> tiempo asignado a cada cuadro.  Si queremos que el juego funcione con una frecuencia de 30 FPS, entonces solo tenemos 33 milisegundos para completar todo el trabajo necesario para el marco.  A 60 FPS, el tiempo es la mitad, unos 17 milisegundos.  Incluso para una computadora, este per√≠odo de tiempo no es muy grande, dada la cantidad de trabajo que hay que hacer.  Para darle una idea de las cantidades, entonces, seg√∫n estimaciones aproximadas, la bala se mueve aproximadamente 1 metro por milisegundo. <br><br>  Hablaremos principalmente de PC porque esta plataforma est√° abierta, y no puedo hablar de consolas sin temor a violar los acuerdos de confidencialidad (NDA).  De todos modos, b√°sicamente hablar√© sobre lo que no es muy diferente en las consolas, pero si algo a√∫n difiere, lo enfatizar√©.  Para plataformas m√≥viles, la mayor√≠a de las diferencias entre el hardware / consolas de PC y el hardware m√≥vil no son relevantes para el tema de mi art√≠culo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8a/414/db8/d8a414db8e56c45fae566b8da11316e2.jpg"></div><br>  <em>Honestamente, puse esta imagen aqu√≠ para que entiendan que el art√≠culo no solo tendr√° texto.</em> <br><br>  Es esta tarea la que nos interesa: no nos preocuparemos de c√≥mo se realizan todos sus c√°lculos de IA o de c√≥mo se realiza la simulaci√≥n f√≠sica para mover objetos.  Los l√≠mites de la disciplina llamada "programaci√≥n de gr√°ficos" son bastante borrosos, pero dir√© que la programaci√≥n de gr√°ficos comienza cuando tenemos toda la informaci√≥n necesaria para construir un marco: sabemos lo que sucede, todas las texturas y modelos est√°n en la memoria (no en el disco ), las animaciones ya est√°n animadas, se cuenta la f√≠sica y solo tenemos que dibujar un cuadro terminado para mostrarlo en la pantalla. <br><br>  Agrego que considerar√© un juego en 3D con una representaci√≥n bastante tradicional, como Watch Dogs: muchos de los principios b√°sicos se aplican a los juegos en 2D, pero es un poco m√°s dif√≠cil demostrar conceptos sobre ellos.  Tambi√©n explicar√© (especialmente a los programadores gr√°ficos) que me esfuerzo principalmente por comprender, por lo tanto, tal vez, usar√© explicaciones bastante dudosas si me permiten alcanzar mi objetivo. <br><br><h2>  Parte 2. En qu√© consiste el marco </h2><br>  La mayor√≠a de las veces miraremos solo un cuadro y hablaremos sobre los bloques de construcci√≥n que el juego usa para crear un cuadro terminado.  Tambi√©n en esta parte habr√° varias nuevas fotos hermosas. <br><br>  Hay varias formas de ensamblar un marco a partir de bloques de construcci√≥n.  La imagen final que ve el jugador no se representa instant√°neamente.  Se dibuj√≥ de inmediato hace muchos a√±os, pero los motores gr√°ficos modernos casi siempre usan alg√∫n tipo de preprocesamiento.  Antes de mostrar el cuadro terminado en la pantalla, el motor de gr√°ficos dibuja muchas im√°genes intermedias de varios tipos que ayudan a calcular la imagen final. <br><br>  Estas im√°genes dependen en gran medida del tipo de motor y de las t√©cnicas que el programador de gr√°ficos necesita aplicar.  Por ejemplo, si quiere que la luz del sol cree las sombras correctas, entonces se necesitar√° un tipo de imagen para las sombras.  Tambi√©n puede necesitar los reflejos correctos en el autom√≥vil conducido por el jugador, y para esto, tambi√©n, necesita otra imagen con reflejos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/874/47d/95e/87447d95ee62161dc63df6e3dd2406f5.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/9ec/b69/a3b9ecb6984a5aae18fd57d8c2f4a9f2.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e6/bd2/ff7/1e6bd2ff7c49373dc337d20c0fe2a66a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/5cb/65d/fa45cb65dfcb2042ecfd06ef6c463022.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3d9/4ed/937/3d94ed937c68dd821ab21c4a1a1cf4fb.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a57/360/2e8/a573602e8f7b69fa3868df93eebc776f.jpg"></div><br>  <em>Varios ejemplos de im√°genes intermedias utilizadas en la construcci√≥n del cuadro Watch Dogs.</em> <br><br>  En este art√≠culo, no considerar√© cada una de las im√°genes utilizadas en el marco de Watch Dogs, sino solo las b√°sicas, para que pueda aprender algo.  Esta es un √°rea en la que la investigaci√≥n gr√°fica se realiza constantemente y surgen nuevas t√©cnicas.  Las innovaciones tambi√©n surgen en niveles m√°s peque√±os, pero cuando el marketing le informa sobre alguna nueva funci√≥n gr√°fica, generalmente se refiere a tales mejoras. <br><br><hr><br>  Cada una de estas im√°genes intermedias tambi√©n est√° construida a partir de fragmentos a√∫n m√°s peque√±os.  Cada objeto en la escena o un grupo de objetos relacionados se crea por separado como un <em>modelo con textura</em> .  Al desarrollar un juego, los artistas construyen estos modelos en un editor 3D y crean todos los recursos necesarios para ellos.  Luego, estos modelos se colocan en el mundo usando el editor de niveles y gradualmente se construye una ciudad virtual a partir de ellos. <br><br>  Probablemente, casi todo el mundo lo sabe, y si ha visto el desarrollo de gr√°ficos 3D en tiempo real en los √∫ltimos 20 a√±os, sabe cu√°nto m√°s complejos se han convertido hoy en d√≠a.  En las primeras etapas de la formaci√≥n de gr√°ficos, el mapeo de texturas era un proceso costoso y, si era posible, se eliminaba pintando objetos con el mismo color.  Las texturas se dejaron solo para elementos como ojos o caras que realmente necesitaban detalles. <br><br>  El modelo 3D consiste completamente en tri√°ngulos interconectados que forman la forma del objeto.  Cada tri√°ngulo tiene tres puntos llamados v√©rtices, y dado que los tri√°ngulos est√°n conectados entre s√≠, los v√©rtices pueden ser compartidos por varios tri√°ngulos.  Volveremos a esto m√°s tarde porque los v√©rtices y los tri√°ngulos son lo suficientemente importantes.  Tambi√©n vale la pena recordar que algunos objetos, por ejemplo, personajes o √°rboles, deben estar animados antes de renderizar.  El modelo se crea en forma est√°tica est√°ndar y se aplican animaciones en cada cuadro.  Volveremos a esto tambi√©n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>Este es un modelo 3D de la cabeza de Aiden Pierce despu√©s de la animaci√≥n.</em>  <em>Los tri√°ngulos son visibles porque est√°n dibujados planos y no suavizados, como suele ser el caso.</em> <br><br>  Para agregar m√°s detalles al modelo 3D, las texturas se superponen.  Las texturas son archivos de imagen plana regulares, generalmente de tama√±o cuadrado o simple, como rect√°ngulos con una proporci√≥n de 2: 1.  Las texturas se superponen en el modelo 3D mediante un proceso m√°s complejo, que analizar√© con m√°s detalle a continuaci√≥n, pero conceptualmente es similar al proceso de envolver un regalo.  En lugar de un simple patr√≥n repetitivo de envoltorios de papel, la imagen coincide exactamente con el tama√±o del envoltorio.  Si vio modelos de papel para ensamblar con pegamento, entonces el principio es el mismo. <br><br>  Esta analog√≠a es m√°s apropiada de lo que piensas, porque estas texturas generalmente se crean al "desenrollar" un modelo 3D en un espacio en blanco plano, como se hace con un modelo de papel, despu√©s de lo cual se dibuja una textura sobre √©l.  Esta implementaci√≥n a menudo se realiza autom√°ticamente, pero en el caso de objetos particularmente complejos se puede hacer manualmente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b9f/1f7/cf0/b9f1f7cf0d34680c8f313ad11691656f.jpg"></div><br>  <em>Esta es la textura correspondiente al modelo de cabeza de Aiden Pierce que se muestra arriba.</em>  <em>Hay partes para dientes y lengua.</em>  <em>Tenga en cuenta que el √°rea sobre su frente no tiene textura porque est√° permanentemente cubierta por la gorra de b√©isbol legendaria Aiden Pearce ‚Ñ¢.</em> <br><br><blockquote><h4>  Nota </h4><br>  Al desplegarse, algunas partes del objeto que requieren m√°s detalles aumentan, mientras que otras disminuyen. </blockquote><br>  Muy a menudo hablan de varias "m√°scaras" de modelos, especialmente en el caso de personajes personalizables.  Hoy, lo que se llama una "piel" generalmente se refiere a peque√±os cambios en el modelo, un nuevo cintur√≥n o un sombrero diferente, pero inicialmente este t√©rmino surgi√≥ porque se utiliz√≥ el mismo modelo, pero la textura cambi√≥ (o "piel", literalmente se traduce como "Skin") para crear un personaje que se vea diferente.  Incluso hoy, con la ayuda de tales texturas, puede crear una gran variabilidad de NPC u objetos, lo que ahorra tiempo y dinero; no necesita crear muchos modelos 3D √∫nicos.  La ropa diferente que Aiden puede usar a menudo son texturas diferentes del mismo modelo. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//8ItIFRj/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Aqu√≠ hay un breve fragmento de la rotaci√≥n de la cabeza del modelo 3D.</em>  <em>Superpuesta solo textura, y nada m√°s.</em> <br><br>  En el marco que estamos considerando, hay aproximadamente 1700 objetos renderizados en la parte principal de renderizado.  Algunos de ellos ser√°n los mismos modelos: objetos como flores en macetas y botes de basura nunca se crean por separado, este es un modelo o varios modelos colocados en diferentes lugares.  Sin embargo, la cantidad aproximada de objetos dibujados para completar el marco es cercana a <strong>4700</strong> ; esto nos da una idea de cu√°nto trabajo adicional se necesita hacer adem√°s de renderizar todos estos modelos. <br><br>  Veamos otro ejemplo de un objeto: una gorra de b√©isbol que usa Aiden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa2/1ce/636/aa21ce63666b4636b76ebe062f7536ca.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f7/4d3/b93/0f74d3b9305c6ed4572a5bc55d178a11.jpg"></div><br>  <em>Este es un modelo de gorra de b√©isbol con textura y textura.</em>  <em>Se puede ver que la textura est√° construida de partes separadas que est√°n conectadas al modelo.</em> <br><br><blockquote><h4>  Nota </h4><br>  La visera y la parte principal de la gorra de b√©isbol en la textura no se tocan, porque el escaneo puede ser bastante complicado y, si es necesario, puede realizarse en varias partes diferentes.  A veces, texturizar un modelo de forma compleja sin problemas visibles y costuras requiere una buena cantidad de habilidad. </blockquote><br>  Los mismos principios que vimos con la cabeza de Aiden se aplican a la gorra.  De hecho, si ignoramos la textura espec√≠fica y los n√∫meros necesarios para realizar el desenvolvimiento, entonces el principio es siempre el mismo. <br><br>  Para mostrar qu√© puede salir mal durante el desarrollo y demostrar c√≥mo puede divertirse al programar gr√°ficos, podemos realizar un peque√±o experimento.  Dado que la mayor√≠a de las texturas tienen un tama√±o cuadrado est√°ndar, y el m√©todo de envolver y desplegar texturas en el modelo tambi√©n es el mismo, ¬øpor qu√© no jugar un poco con ellas?  ¬øQu√© sucede si aplicamos la textura de la cabeza de Aiden a un modelo de gorra de b√©isbol? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/212/1b1/5c7/2121b15c7f8355575864f9333c9eeab0.jpg"></div><br>  <em>Ya no es muy similar a la gorra de b√©isbol legendaria de Aiden Pierce.</em> <br><br>  Donde hab√≠a un logotipo en la textura de la gorra de b√©isbol, la oreja y los dientes se encuentran en la textura de la cabeza.  Donde hab√≠a una visera, solo hab√≠a cabello en la textura de la cabeza.  La superposici√≥n es exactamente la misma, pero se usa una textura diferente.  Por supuesto, este ejemplo ser√° un error en el juego, pero piense en lo que se puede hacer si anima la textura o la hace parpadear; en los juegos, estas cosas se usan para varios efectos que ahora puede notar.  En particular, el juego Saint's Row 4 utiliza similares para efectos especiales de "simulaci√≥n". <br><br>  Tambi√©n ser√° √∫til pensar en las consecuencias de esto: los juegos combinan muy cuidadosamente pares de modelos y texturas, es decir, los modelos m√°s √∫nicos deben coincidir con sus propias texturas √∫nicas. <br><br>  Por supuesto, esta regla no es absoluta: en algunos casos, para ahorrar espacio, la textura es un patr√≥n repetitivo est√°ndar que se puede usar para muchos objetos.  Conjuntos de objetos vinculados, por ejemplo, quioscos de prensa, pueden usar la misma textura para diferentes peri√≥dicos, y cada peri√≥dico ocupa una peque√±a fracci√≥n de la textura. <br><br>  Sin embargo, esto significa que para construir la imagen final, todos los bloques de construcci√≥n deben estar presentes, es decir, como resultado, se pueden obtener muchos modelos y texturas requeridos.  En la siguiente parte, hablaremos sobre por qu√© algunos aspectos, como la reflexi√≥n, son muy dif√≠ciles de implementar correctamente.  Tambi√©n hablar√© sobre c√≥mo los juegos usan peque√±os trucos para ahorrar tiempo y recursos. <br><br><h2>  Parte 3. Lo que no necesitas dibujar </h2><br>  A menudo, la programaci√≥n de gr√°ficos es la tarea de equilibrar una docena de restricciones diferentes para obtener el compromiso perfecto.  En la √∫ltima parte, vimos que cada vez que se dibuja una escena, se ensambla a partir de muchos bloques de construcci√≥n peque√±os: personas, autom√≥viles, se√±ales de tr√°fico, edificios.  Todo lo que est√° en la pantalla est√° formado por componentes individuales que deben dibujarse.  Hay varias operaciones de equilibrio sutiles que discutiremos aqu√≠. <br><br>  El procesador central y la tarjeta gr√°fica trabajan juntos para representar el marco.  El resto del juego se ejecuta en la CPU, por lo que decide qu√© objetos se deben dibujar en el marco actual, d√≥nde est√° mirando la c√°mara y qu√© animaciones se juegan.  Una tarjeta gr√°fica es un "caballo de batalla" que realiza todo el trabajo complejo involucrado en la representaci√≥n de p√≠xeles, raz√≥n por la cual es un dispositivo especializado separado. <br><br>  Resulta que tanto la CPU como la tarjeta gr√°fica tienen limitaciones en la velocidad o cantidad de c√°lculos, pero estos son diferentes tipos de restricciones. <br><br>  En general, la CPU est√° m√°s interesada en su propia parte del trabajo: ¬øcu√°ntos objetos necesitamos dibujar en total?  ¬øQu√© tan <i>diferentes son</i> estos objetos? ¬ø <i>Son</i> 100 luces id√©nticas o 100 arbustos / plantas / √°rboles?  ¬øEst√°n animados estos objetos, se mueven din√°micamente y cu√°les de ellos son est√°ticos o inm√≥viles? <br><br>  Lo primero que hacemos para reducir la carga tanto como sea posible es dibujar solo lo que es visible en la pantalla.  Esto parece obvio, pero la implementaci√≥n requiere un trabajo cuidadoso.  No olvide que construimos cada cuadro desde cero, por lo que <i>en cada cuadro</i> debemos mirar cada objeto y determinar si es visible o no.  Esto significa que en cada juego hay un vac√≠o negro en todas partes que sigue al jugador, y cuando no mira objetos y personas, dejan de existir. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//bmSqTLe/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>En esta animaci√≥n, giramos la c√°mara, mostrando el vac√≠o detr√°s del jugador.</em>  <em>Los espectadores atentos notar√°n que no est√° completamente vac√≠o ...</em> <br><br>  Es dif√≠cil desarrollar reglas pr√°cticas en este caso, pero en general, puede dibujar alrededor de 1000 objetos en la escena sin preocuparse por la falta de espacio.  Sin embargo, si necesita renderizar 5,000 objetos, entonces deber√≠a pensar en usar trucos.  No olvides que en la mayor√≠a de los juegos donde el jugador puede controlar la c√°mara, no podemos saber en qu√© √°ngulo se ver√°, por lo que debes ahorrar espacio para maniobrar. <br><br>  Resulta que hay muchos trucos que te permiten usar casi por completo un recurso v√°lido, y son especialmente importantes en juegos como Watch Dogs.  Cuanto m√°s te acerques a los bordes y m√°s calidad visual puedas obtener del mismo n√∫mero de objetos, mejor se ver√° el juego. <br><br>  Incluso si miras lo que est√° frente a ti en la escena, esto no significa que sea necesario dibujar toda la ciudad.  Si hay un gran edificio a la izquierda o a la derecha, todo lo que est√° detr√°s se vuelve invisible, por lo que no puede dibujarlo.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Del mismo modo, algunos objetos en la distancia se vuelven muy peque√±os, por lo que no debemos preocuparnos por dibujar peque√±as plantas y arbustos en la distancia. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//auvvQ67/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta animaci√≥n muestra que si vas por la calle m√°s all√° de lo que vemos, entonces no hay nada en las calles laterales, pero a gran distancia los detalles se vuelven m√°s peque√±os. </font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De hecho, todav√≠a hay muchos objetos en esta escena que resultar√°n invisibles como resultado. </font><font style="vertical-align: inherit;">Queda mucho por explorar en esta √°rea y se deben aplicar varias t√©cnicas sofisticadas. </font><font style="vertical-align: inherit;">Siempre tiene que hacer compromisos, pero si puede pasar un poco de tiempo o encontrar una forma muy inteligente de evitar renderizar 100 objetos sin casi ning√∫n esfuerzo adicional, entonces podemos hacer que la escena sea a√∫n m√°s compleja o m√°s densa.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, hay otro peque√±o problema. En algunos casos, tenemos que dibujar un edificio que apenas es visible en la pantalla y que va mucho m√°s all√°. Malgasta recursos. Siempre podemos dividir estos objetos en varias partes, luego cada parte se puede dibujar u omitir, es decir, habr√° menos desperdicio. Sin embargo, ahora hemos aumentado el n√∫mero total de objetos dibujados cuando </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√°n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en la pantalla, ¬°y </font><font style="vertical-align: inherit;">hemos </font><font style="vertical-align: inherit;">creado el problema opuesto! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este ejemplo es uno de los cientos, pero es f√°cil explicar en √©l qu√© decisiones deben tomarse y qu√© experimentos realizar para encontrar el punto de equilibrio perfecto para cada juego.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dado que la acci√≥n de nuestra toma de Watch Dogs tiene lugar en la ciudad, podemos verla desde arriba para comprender aproximadamente qu√© se est√° dibujando exactamente. </font><font style="vertical-align: inherit;">En esta imagen est√°tica, es especialmente notable que Watch Dogs hace el trabajo trimestralmente.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//My8bi1m/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora nos alejamos para mostrar el √°rea visible frente a la c√°mara (perd√≥n por la instalaci√≥n para ahorrar tiempo).</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/719/960/135/7199601359a0d421147d9f632061bfaf.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un √°rea aproximada de visibilidad de la c√°mara se superpone a la imagen. </font><font style="vertical-align: inherit;">El ancho de este tri√°ngulo depende del campo de visi√≥n; a veces, en los juegos, esta es una opci√≥n personalizada, a veces un valor constante.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccf/5ff/d45/ccf5ffd455dccf7098393602c9944139.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ hay una pantalla de alambre de la escena, el campo de visi√≥n de la c√°mara est√° limitado al blanco.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algunos de ustedes ya podr√≠an pensar en un peque√±o truco que les permitir√≠a sortear la restricci√≥n de representar un cierto n√∫mero de objetos: ¬øpor qu√© no hacer que los objetos sean una combinaci√≥n muy compleja de todo en un √°rea peque√±a, hasta hojas individuales? Entonces dibujar 1000 objetos ser√° m√°s que suficiente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero aqu√≠ nos enfrentamos a un conjunto completamente diferente de restricciones: las tarjetas gr√°ficas tienen un rendimiento limitado, y cuanto m√°s complejo sea el objeto, m√°s tiempo tomar√° dibujar. Es decir, incluso un objeto, si es bastante complejo, puede reducir la velocidad de fotogramas del juego a 20 FPS. Incluyendo esta es la raz√≥n por la que dije que el l√≠mite en el n√∫mero de objetos es bastante confuso.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La cantidad de tiempo dedicado a un objeto depende de la complejidad y el detalle de los modelos y texturas, as√≠ como de la sofisticaci√≥n de la iluminaci√≥n y las sombras. Esta es tambi√©n la raz√≥n por la cual los juegos que intentan implementar gr√°ficos m√°s complejos o sofisticados tienden a usar escenas menos complejas y detalladas: el equilibrio cambia las escalas en una direcci√≥n u otra, para que pueda proporcionarse m√°s espacio para maniobrar, sacrificando lo que no es tan importante para el juego .</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45f/2d5/233/45f2d5233fe8bd806ab2fbf18baa038d.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este es un tipo de mapa de calor, que muestra en qu√© partes de la escena hay modelos especialmente complejos. Observe cu√°ntos problemas pueden causar los √°rboles y la vegetaci√≥n.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hay otro conjunto de t√©cnicas llamado "nivel de detalle" (LOD), que est√° espec√≠ficamente dise√±ado para resolver tales problemas. Similar al hecho de que podemos optimizar el n√∫mero de objetos, cortando todo lo innecesario, podemos aumentar el suministro de "complejidad", eliminando lo innecesario. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uno de los trucos es realmente conocido: esto est√° cambiando la resoluci√≥n de las texturas. Este tema generalmente se cruza con muchos otros, por lo que tratar√© de explicarlo de manera accesible.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las texturas en los juegos generalmente son rect√°ngulos con tama√±os iguales a la potencia de dos: 512, 1024, 2048, 4096. Hay muchas razones para esto, pero una de las ventajas de esto es que puedes tomar una textura de tama√±o 1024x1024 y crear f√°cilmente una versi√≥n m√°s peque√±a con un tama√±o de 512x512 . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por las razones que analizar√© a continuaci√≥n, siempre es necesario que la textura tenga todo tipo de versiones m√°s peque√±as. Es decir, una textura con un tama√±o de 1024x1024 tendr√° versiones m√°s peque√±as de 512x512, 256x256, 128x128, 64x64, 32x32, 16x16, 8x8, 4x4, 2x2 y 1x1. Sin embargo, una de las ventajas de esto es que si los objetos distantes tienen un tama√±o peque√±o en la pantalla, aplicarles una textura de 1024x1024 significa desperdiciar recursos. Podemos ahorrar usando versiones m√°s peque√±as de la misma textura.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Del mismo modo, incluso los objetos cercanos pueden considerarse poco significativos y utilizar texturas m√°s peque√±as para ellos. </font></font><br><br><blockquote><h4>  Nota </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo general, cuando un jugador se acerca a un objeto, se usa la textura m√°s grande, pero como la mayor√≠a de la gente ha visto en un juego en particular, esto no siempre sucede y las texturas se ven demasiado borrosas antes de cargar. </font><font style="vertical-align: inherit;">Esto suele suceder porque las texturas no se pueden cargar desde un DVD o disco duro directamente en la memoria de la tarjeta gr√°fica para renderizar. </font><font style="vertical-align: inherit;">La mayor√≠a de las veces esto sucede cuando un jugador cambia abruptamente su posici√≥n, por ejemplo, durante la reaparici√≥n, cargando un nuevo nivel o un movimiento muy r√°pido. </font><font style="vertical-align: inherit;">En todos los dem√°s casos, las texturas generalmente se cargan gradualmente, en el proceso de mover al jugador alrededor del mundo.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambi√©n puede aplicar este proceso de simplificaci√≥n a los modelos utilizados en el juego, aunque es mucho m√°s dif√≠cil de hacer. Al crear versiones simplificadas de objetos complejos, puede asegurarse de que a gran distancia no se coman parte de un suministro limitado de complejidad. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias a los objetos simplificados y los modelos recortados, puedes ahorrar mucho dinero y tienes que usar este enfoque en cualquier juego como Watch Dogs. Pero al mismo tiempo, puede ser una gran p√©rdida de recursos. Es necesario tomar una decisi√≥n muy reflexiva y equilibrada sobre cu√°ntas versiones simplificadas de modelos se requieren. Si hay muy pocos de ellos, entonces no podr√° ahorrar demasiado, o habr√° saltos notables en la calidad al cambiarlos. Si hay demasiados, desperdiciar√° la memoria y pasar√° las horas hombre necesarias para crear objetos.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/801/f01/9ed/801f019ed8c365cfebbbeea2320bf3d7.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As√≠ es como los objetos y personajes complejos se ven a distancia cuando no se pueden distinguir de sus versiones altamente detalladas.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Espero que ahora tenga una idea de los problemas que los programadores gr√°ficos, artistas y dise√±adores de niveles est√°n tratando de combinar los gr√°ficos de la m√°s alta calidad con alta velocidad. </font><font style="vertical-align: inherit;">En consolas, esta ecuaci√≥n es un poco m√°s f√°cil de resolver que en PC, porque el equipo es constante.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En la parte anterior, dije que hablar√© sobre por qu√© es muy dif√≠cil implementar correctamente reflexiones y otras cosas similares. La raz√≥n es bastante simple: las reservas de productividad y recursos de las que constantemente hablo no cambian dependiendo de si tienes una reflexi√≥n o no. Si desea crear una reflexi√≥n que pueda mostrar nuevamente toda la escena, debe rehacer todo el trabajo del que habl√©. Adem√°s, los reflejos dependen en gran medida del √°ngulo en que los miremos, por lo que para obtener reflejos precisos para cada objeto reflectante, ¬°deben ser los suyos!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esto puede salirse de control muy r√°pidamente, y generalmente los juegos en los que hay reflexiones se permiten ciertas libertades o suposiciones. Los juegos rara vez crean reflejos en entornos complejos, lo m√°ximo que puede ser es un espejo en el ba√±o, donde no hay tantos objetos, la complejidad de la escena es peque√±a y, por lo tanto, puede pagar gastos adicionales. Quiz√°s los verdaderos reflejos en el juego solo estar√°n en superficies irregulares u onduladas del agua, de modo que incluso una escena muy √°spera y poco detallada es suficiente para crear reflejos convincentes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo general, es dif√≠cil evitar por completo las superficies reflectantes, por lo que los juegos usan im√°genes pre-renderizadas del entorno inmediato, lo que da un resultado "razonablemente bueno". Pero no resisten un escrutinio cercano, y si observa de cerca los reflejos, ver√° que esto es una imitaci√≥n. Existen t√©cnicas modernas que ayudan a crear reflexiones en ciertas condiciones, y tal vez m√°s adelante hablar√© de ellas, pero a√∫n se necesitan im√°genes pre-renderizadas ("pre-renderizadas").</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06c/9bd/b94/06c9bdb94b41c1a83b7d574cdf90f449.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta imagen renderizada se llama "mapa de cubo". No es del todo exacto con respecto al lugar donde se encuentra Aiden, pero est√° lo suficientemente cerca de √©l.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Watch Dogs hace reflexiones en tiempo real. No investig√© este problema en detalle, pero creo que siempre se representan cuando el personaje est√° en la calle, y se utilizan principalmente para obtener sus reflejos exactos en el autom√≥vil en el que est√° sentado, para mejorar la imagen y darle una ligera sensaci√≥n de realidad. . Dado que el jugador siempre est√° enfocado en su autom√≥vil y su entorno inmediato, el hecho de una reflexi√≥n incorrecta sobre otros autom√≥viles es apenas perceptible.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay muchas aproximaciones disponibles para acelerar la representaci√≥n de estas reflexiones. Por ejemplo, se representan muchos menos objetos en el reflejo que en la escena real, unos 350 en total, y muchos de ellos est√°n muy simplificados en comparaci√≥n con las versiones completas. Sospecho que los objetos complejos, como las personas, se descartan por completo, independientemente de la distancia, pero no he probado esta teor√≠a. Adem√°s, no hay sombras en estos objetos, y la iluminaci√≥n es muy simple: solo la que proviene del sol y el cielo. Los reflejos se representan desde el suelo como en una lente "ojo de pez", es decir, los reflejos de la tierra en s√≠ son imposibles, y lo que est√° al lado tiene muy pocos detalles.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pero incluso con todas estas simplificaciones, las reflexiones solo hacen frente a lo que se pretend√≠a. </font><font style="vertical-align: inherit;">Si conduce por debajo de los rieles, puede obtener el reflejo correcto con una vista sobre el autom√≥vil, que en la pr√°ctica no funcionar√≠a. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta decisi√≥n fue intencional y no f√°cil de tomar. </font><font style="vertical-align: inherit;">El stock es un valor constante, por lo que si deja espacio para estas reflexiones, debe sacrificar algo m√°s.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab1/cda/fcd/ab1cdafcde2ca5c15111ca30f5b6bb5f.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ hay una vista muy "sospechosa" de la escena alrededor de Aiden con una vista inferior, hecha para reflexiones. </font><font style="vertical-align: inherit;">Puede navegar a lo largo de las dos luces y rieles del tren.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay otra parte del trabajo que quiero mencionar aqu√≠: las sombras. M√°s tarde planeo hablar sobre c√≥mo funcionan las sombras, porque este es un tema interesante, pero ahora lo m√°s importante es recordar que las sombras son muy similares a los reflejos. Cada fuente de luz que proyecta una sombra deber√≠a representar una imagen de escena desde su punto de vista. Esta vez no hay muchas formas de simplificar el trabajo: para el c√°lculo correcto de las sombras, cada fuente de luz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debe</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tener esta imagen.</font></font><br><br><blockquote><h4>  Nota </h4><br>      ,    .           ,      ¬´¬ª  ,             .         ,  ,        . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fuente m√°s obvia y m√°s importante de iluminaci√≥n que da sombra es el sol (o la luna, si sucede de noche). </font><font style="vertical-align: inherit;">Como el sol es enorme, generalmente se representan de 3 a 5 im√°genes, y no una, como en el caso de los faros o una linterna. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desafortunadamente, este es uno de los casos en que Watch Dogs no puede servir como un buen ejemplo. </font><font style="vertical-align: inherit;">El c√°lculo de las sombras en el juego es bastante complicado y, me parece, est√° especialmente optimizado para el caso de proyectar sombras en la ciudad. </font><font style="vertical-align: inherit;">Por lo tanto, ser√° mejor que cambie a Far Cry 4 y considere el c√°lculo de las sombras en el ejemplo de un cuadro de este juego.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/4a4/ae6/21c4a4ae665924ba44245b8e18249f8b.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ hay una escena de Far Cry 4 que estoy usando como ejemplo.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/502/26c/7ae50226c3cc0c40c916c58f26ba27f3.jpg"></div><br>  <em>Aqu√≠ hay una imagen con informaci√≥n sobre las sombras de esta escena: cada una de ellas requiere una representaci√≥n completamente nueva de la escena.</em> <br><br>  Por lo tanto, cuando necesitemos agregar sombras a la fuente de luz, tendremos que renderizar la escena una vez m√°s.  Aqu√≠, tambi√©n puede utilizar algunas de las aproximaciones utilizadas en el caso de los reflejos, solo que son mucho m√°s peque√±os.  Puede omitir objetos peque√±os o distantes, pero tenga en cuenta que estos objetos no parecer√°n proyectar sombras.  Puede hacer que la imagen sea muy peque√±a, pero las sombras ser√°n granuladas y con pocos detalles.  Por lo general, no es posible usar una versi√≥n muy simplificada del objeto, porque entonces parecer√° que el objeto proyecta una sombra sobre s√≠ mismo, o aparecen espacios entre el objeto y su sombra. <br><br>  Otra consecuencia que es muy f√°cil de perder es la necesidad de crear im√°genes sombreadas para cada fuente de luz.  En muchos casos, es posible simplificar las fuentes de iluminaci√≥n combin√°ndolas; en Watch Dogs esto sucede con los faros de los autom√≥viles. <br><br>  Cuando ambas luces est√°n encendidas, solo se dibuja una fuente de luz, pero tiene una forma especial, por lo que parece dos rayos.  Si los faros tienen sombras, entonces esto no es tan f√°cil de hacer, y ser√° mucho m√°s notable: cuando el jugador pasa por delante del autom√≥vil, entonces la luz saldr√° de alg√∫n lugar entre los dos faros.  Quiz√°s entonces tendr√° que separar los faros, pero al mismo tiempo, no solo habr√° costos adicionales para calcular las sombras, sino que tambi√©n tendr√° que dibujar una nueva iluminaci√≥n. <br><br><hr><br>  Lo principal que quer√≠a enfatizar con todo esto era el compromiso.  Ciertamente podemos deshacernos de todas estas aproximaciones, pero tendremos que gastar nuestras reservas de recursos en esto, es decir, sacrificar algo m√°s.  Cada desarrollador de juegos debe decidir en qu√© es importante concentrarse en el juego y qu√© es lo que m√°s impresionar√° o molestar√° m√°s al jugador. <br><br><h2>  Parte 4. Moviendo los picos </h2><br>  En esta parte, hablar√© m√°s sobre los detalles t√©cnicos de la animaci√≥n de objetos en la escena. <br><br>  Los programadores gr√°ficos a menudo hablan de la "tuber√≠a gr√°fica".  Los gr√°ficos 3D son un poco como una l√≠nea de ensamblaje con un movimiento claramente definido de una etapa a otra, pero no funciona con un solo objeto a la vez. <br><br>  Todas las tarjetas gr√°ficas modernas tienen aproximadamente la misma cinta transportadora, tienen equipos y software especiales que se flashean directamente "en silicio" para maximizar la velocidad de la cinta transportadora.  Por supuesto, hay muchas variaciones entre diferentes fabricantes y familias de tarjetas gr√°ficas, pero generalmente no tenemos que preocuparnos de <em>c√≥mo</em> funcionan a este nivel. <br><br><blockquote><h4>  Nota </h4><br>  Si est√° interesado en c√≥mo funciona todo en un nivel de hardware abstracto, le recomiendo una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">serie de art√≠culos de Fabian Giesen sobre la cartera de gr√°ficos</a> .  Esta serie de art√≠culos es <em>mucho</em> m√°s detallada y requiere mucha m√°s comprensi√≥n que mi publicaci√≥n. </blockquote><br>  Me saltear√© muchos detalles para explicar principios interesantes e importantes.  En esta parte, veremos la primera parte de la tuber√≠a, que se llama <strong>Vertex Shader</strong> . <br><br>  Los sombreadores se generalizaron hace unos 16 a√±os, despu√©s del lanzamiento de DirectX 9, en el que aparec√≠an los sombreadores de v√©rtices y p√≠xeles.  Para explicar qu√© son los sombreadores y compararlos con lo que sol√≠an ser, hablar√© sobre el trabajo que hacen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>La cabeza esquel√©tica de Aiden est√° con nosotros otra vez.</em> <br><br>  Perm√≠teme recordarte que en la parte 2, examinamos los modelos a partir de los cuales se crea el mundo del juego.  Estos patrones est√°n formados por puntos individuales llamados v√©rtices que est√°n conectados en tri√°ngulos.  Dije que te contar√© m√°s sobre ellos m√°s tarde, y ahora cumplo mi promesa. <br><br>  Dado que todo en el mundo del juego consiste en v√©rtices, todo lo que debe hacerse con estos modelos debe realizarse con v√©rtices.  Cuando se trata de la tarjeta gr√°fica, todo lo que ve es una larga lista de v√©rtices.  Para ella, no existen cosas como ejecutar animaciones, o balancear hojas de √°rboles, o cualquier otro concepto abstracto. <br><br>  Veamos un ejemplo simple de lo que tenemos que hacer: mover y colocar objetos en el mundo.  Para empezar, tomemos un caso simple, no un personaje. <br><br>  Al crear objetos en editores 3D como Maya y 3D Studio Max, los artistas siempre construyen desde su propio mundo.  Estos objetos no se crean inmediatamente en el entorno de Chicago, sino que sus alrededores se ven como una "habitaci√≥n blanca vac√≠a" de Matrix.  Cada objeto est√° ubicado en el centro del vac√≠o absoluto. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd0/a55/a3c/bd0a55a3c96f5fefc237bdf22194e009.png"></div><br>  <em>Aqu√≠ hay un sem√°foro en el juego en alg√∫n lugar debajo de los rieles, y se encuentra en su propio mundo.</em> <br><br>  Al guardar en el disco, el modelo no tiene idea de d√≥nde estar√° en el mundo y cu√°ndo se descargar√° y transferir√° a la tarjeta gr√°fica.  Esto significa que cuando llega el momento de dibujar objetos, necesitamos moverlo de nuestro propio mundo a la escena que dibujamos.  Esto sucede con cada objeto dibujado, e incluso los objetos inm√≥viles como edificios y puentes tambi√©n se mueven de su propio mundo a la escena en cada cuadro. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d65/21d/673/d6521d67344753566d0d2b4ff3b4fbf9.png"></div><br>  <em>Aqu√≠ vemos varios sem√°foros ya colocados en una escena final parcialmente construida.</em> <br><br>  Como mencion√© anteriormente, las √∫nicas cosas con las que podemos trabajar son los picos.  No podemos simplemente decirle a la tarjeta gr√°fica: "¬øPuedes poner este sem√°foro debajo del puente?  ¬øY luego poner otro un poco m√°s lejos?  ¬°Genial! <br><br>  Por lo tanto, en lugar de decirle a la tarjeta gr√°fica qu√© debe hacer con el objeto en s√≠, debemos decir qu√© hacer con todos sus v√©rtices.  Resulta que en este caso todo se vuelve muy simple.  Si cambiamos todos los v√©rtices exactamente de la misma manera y permanecen inm√≥viles entre s√≠, entonces esto es similar a mover un objeto como un todo.  Todo lo que necesitamos hacer es descubrir qu√© "cambio" se llama transformaci√≥n. <br><br><blockquote><h4>  Nota </h4><br>  Los c√°lculos matem√°ticos de todo esto no son particularmente complicados, pero est√°n m√°s all√° del alcance del art√≠culo.  Si ya ha estudiado √°lgebra lineal, probablemente sepa todo lo que necesita, b√°sicamente todo se reduce a la multiplicaci√≥n matricial de vectores. </blockquote><br>  Antes de la aparici√≥n de sombreadores de v√©rtices, las posibles opciones para transformar v√©rtices en la tarjeta gr√°fica eran muy limitadas.  Los objetos disponibles estaban en movimiento y girando, as√≠ como algunas otras operaciones, pero nada particularmente redundante o complicado. <br><br>  Los sombreadores de v√©rtices son peque√±os programas de computadora que se ejecutan en una tarjeta gr√°fica.  Toman un v√©rtice, realizan <em>las acciones necesarias</em> con √©l y emiten un v√©rtice de salida.  No solo pueden moverlo, sino que tambi√©n los hacen saltar hacia arriba y hacia abajo, alejarse del pico m√°s cercano, balancearse seg√∫n el viento, animarse y mucho m√°s. <br><br>  Tom√© uno de los sombreadores de v√©rtices que se usan en Watch Dogs y experiment√© un poco para mostrar lo que hace.  Este es un trabajo bastante arduo, pero logr√© encontrar el sombreador de v√©rtices utilizado para los personajes y cambiarlo.  Hay otro sombreador de v√©rtices utilizado para la piel, por ejemplo, para caras y manos, pero comprender√° r√°pidamente el principio. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wqyv7B8/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Hice un cambio muy simple que agrega un doblez al modelo de personaje, pero todo lo dem√°s se usa como de costumbre.</em> <br><br>  La animaci√≥n de arriba muestra que los personajes est√°n de alguna manera extra√±amente distorsionados.  Esto nos lleva de vuelta al principio "si mueve cada v√©rtice, entonces esto es similar a mover todo el objeto".  El cambio realizado en el sombreador de v√©rtices solo funciona para un v√©rtice a la vez, pero dado que todos funcionan con la misma distorsi√≥n, el efecto se aplica a todo el objeto. <br><br>  Tambi√©n puedes hacer cambios en la parte de la transformaci√≥n, que es responsable de "simplemente moverse a su lugar", para que en lugar de colocar al personaje en el lugar correcto, ella lo levante por encima del suelo.  Esto no se simula con la ayuda de la f√≠sica, por lo tanto, no tiene nada que ver con la gravedad o las colisiones con otros objetos; si queremos, podemos hacer que todos se disparen en el aire. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//tktCaw4/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>En esta animaci√≥n, hicimos que el sombreador de v√©rtices subiera y bajara gradualmente el objeto.</em> <br><br>  Obviamente, todo esto no es muy constructivo, pero nos da una idea general de c√≥mo funcionan los sombreadores de v√©rtices: si ahora quisi√©ramos animar las hojas de los √°rboles para que se balanceen, har√≠amos lo mismo.  Solo que en lugar de subir y bajar, girar√≠an en la direcci√≥n del viento.  Entonces podemos cambiar la fuerza del viento para que los √°rboles se balanceen m√°s o menos. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//5Sl1uhw/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Aqu√≠ vemos lo que sucede cuando todo aumenta unas siete veces.</em> <br><br>  Simplifico un poco, pero b√°sicamente la tarea de la mayor√≠a de los sombreadores de v√©rtices es "mover objetos a su lugar".  La excepci√≥n son todos los objetos animados: personas, animales, as√≠ como objetos como cuerdas que se balancean, ropa que agita, etc. <br><br><hr><br>  Animar a las personas est√° relacionado con la idea de usar un esqueleto y una "piel".  Un esqueleto es una descripci√≥n simple de un personaje en movimiento.  En esta etapa, no nos preocupan las hebillas, los sombreros o los jeans que no est√°n animados, solo los movimientos importantes que son m√°s apropiados para el esqueleto humano son importantes para nosotros. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/bf2/ce7/f0fbf2ce7c1a0d3d287f8cc4b04b41f2.png"></div><br>  <em>Aqu√≠ se muestra un esqueleto simple de una figura humana.</em>  <em>No fue tomado de Watch Dogs, porque el esqueleto es dif√≠cil de visualizar fuera del editor 3D.</em> <br><br>  <em>Imagen autorizada por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Attribution-ShareAlike CC BY-SA</a> ¬© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MakeHuman team</a> 2001-2014</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//nXYWZOr/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Esta es una pose instant√°nea o pose en T que demuestra c√≥mo se ve un personaje sin usar animaciones.</em> <br><br>  Las animaciones (correr, caminar, saltar) se aplican solo a este esqueleto.  Esto hace que todo el proceso sea muy simple, porque necesitamos considerar solo alrededor de cien huesos en lugar de miles y miles de v√©rtices. <br><br>  Despu√©s de crear el esqueleto, cada v√©rtice se une a uno o m√°s huesos en esta postura est√°tica, y esta conexi√≥n se llama "desollado".  En el momento de Half-Life 1, cuando esta tecnolog√≠a comenz√≥ a usarse, cada v√©rtice se asoci√≥ con un solo hueso.  Hoy en d√≠a, incluso pueden unir cuatro huesos, mientras que a cada hueso se le da peso, de lo que depende el grado de influencia del hueso sobre el √°pice.  Gracias a esto, puede obtener una animaci√≥n m√°s suave, permitiendo que los huesos se crucen en diferentes √°reas sin crear √°ngulos agudos al mover brazos o piernas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e5/af5/e31/7e5af5e314bf44d7f9098941be6eacbc.png"></div><br>  <em>Este es el esqueleto que se muestra arriba con el hueso del muslo girado.</em>  <em>Los colores muestran el peso del hueso de la cadera en relaci√≥n con la parte superior del modelo.</em> <br><br>  <em>Imagen autorizada por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Attribution-ShareAlike CC BY-SA</a> ¬© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MakeHuman team</a> 2001-2014</em> <br><br>  Esta tecnolog√≠a tiene sus limitaciones, especialmente en lugares donde la ropa y la piel se comprimen o estiran en bisagras, por ejemplo, en los codos y los hombros.  Esta es una forma imperfecta, pero muy efectiva de animar.  La limitaci√≥n m√°s grave es que es muy dif√≠cil crear animaciones faciales convincentes de esta manera.  Puede crear muchos huesos "falsos" en su cara, por ejemplo para las cejas y alrededor de la boca, pero esto ser√° solo una aproximaci√≥n aproximada de los m√∫sculos y la piel. <br><br>  Otra caracter√≠stica importante de esta t√©cnica es que la comparaci√≥n de v√©rtices y huesos es muy espec√≠fica y est√° relacionada con la forma en que se realiza esta comparaci√≥n.  Es posible usar animaciones para varios modelos diferentes, pero cada modelo individual en el que desea usar el esqueleto debe estar asociado con los huesos.  La raz√≥n es que las animaciones mueven los v√©rtices de su posici√≥n original en relaci√≥n con sus esqueletos.  Si los v√©rtices no est√°n en las posiciones esperadas, surgir√°n problemas. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//JdJEwEW/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Si el modelo no coincide con el esqueleto utilizado por ella, las animaciones ser√°n <u>completamente</u> incorrectas.</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wt5PSQY/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Si hacemos que el personaje sea dos veces m√°s ancho, obtenemos un efecto similar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las "donas que comen en exceso" de Drake</a> , pero es notable que las animaciones m√°s cercanas a los pinceles se vuelven incorrectas, porque aqu√≠ es donde est√°n m√°s lejos de sus posiciones originales.</em> <br><br>  La primera animaci√≥n puede parecerle extra√±a: tales animaciones de falla ocurren en los juegos con mucha frecuencia.  Por lo general, son causadas por animaciones incorrectas aplicadas al esqueleto, o el modelo usa el esqueleto incorrecto.  Como en el caso de las texturas y los modelos, el esqueleto, el dise√±o y el modelo deben compararse con mucho cuidado, de lo contrario, los resultados ser√°n tristes r√°pidamente. <br><br>  Espero que tengas alguna idea sobre el prop√≥sito de los sombreadores de v√©rtices y entiendas c√≥mo se usan las animaciones para convertir un modelo est√°tico en un personaje vivo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es430930/">https://habr.com/ru/post/es430930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es430918/index.html">Sobre Flutter, en resumen: conceptos b√°sicos</a></li>
<li><a href="../es430922/index.html">Ejemplo de c√°lculo para centralita</a></li>
<li><a href="../es430924/index.html">Programaci√≥n Ada</a></li>
<li><a href="../es430926/index.html">El tiempo est√° fragmentado; un poco sobre la similitud de los sistemas distribuidos y un modelo de memoria d√©bil</a></li>
<li><a href="../es430928/index.html">Sobre la "casa inteligente": c√≥mo hacer una luz de fondo "inteligente"</a></li>
<li><a href="../es430932/index.html">Los hackers robaron m√°s de 21 millones de rublos de un banco ruso</a></li>
<li><a href="../es430934/index.html">Asterisk dialplan extension generador de m√°scara</a></li>
<li><a href="../es430936/index.html">DEFCON 21. La conferencia DNS puede ser peligrosa para su salud. Parte 2</a></li>
<li><a href="../es430938/index.html">C√≥mo obtener los primeros pedidos en dise√±o cuando no hay cartera ni experiencia</a></li>
<li><a href="../es430940/index.html">¬°SDK para ti, SDK para m√≠, SDK para todos! C√≥mo hacer un SDK y por qu√© es necesario</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>