<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœ‹ğŸ¼ ğŸ‘¨â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨ ğŸï¸ Construction et exploitation d'un rÃ©seau anycast tolÃ©rant aux pannes ğŸ™‰ ğŸ¤¦ğŸ» ğŸ’¹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Ce qui suit est une transcription du rapport d'Evgeny error2407 Bogomazov (ingÃ©nieur R&D rÃ©seau) et Dmitry h8r Shemonaev (chef du CNO) ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construction et exploitation d'un rÃ©seau anycast tolÃ©rant aux pannes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/qrator/blog/457446/">  Bonjour, Habr!  Ce qui suit est une transcription du rapport d'Evgeny <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">error2407</a> Bogomazov (ingÃ©nieur R&amp;D rÃ©seau) et Dmitry <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">h8r</a> Shemonaev (chef du CNO) du passÃ© UPTIMEDAY.  VidÃ©o Ã  la fin du post. <br><br><img src="https://habrastorage.org/webt/h2/kk/hf/h2kkhfbh4bzqqwtsh2x1_vsxjrk.png"><br><blockquote>  Aujourd'hui, nous aimerions parler des problÃ¨mes qui se posent lors de la construction d'un rÃ©seau anycast.  Pourquoi nous sommes-nous embarquÃ©s dans ce dossier et que faisons-nous lÃ -bas. </blockquote><a name="habracut"></a><br><img src="https://habrastorage.org/webt/_f/pb/lr/_fpblrppj9--llxvsztbw-nrzpy.png"><br>  Chez Qrator Labs, nous construisons notre propre rÃ©seau anycast pour rÃ©soudre des problÃ¨mes spÃ©ciaux qui diffÃ¨rent de ceux des opÃ©rateurs de tÃ©lÃ©communications Â«ordinairesÂ».  En consÃ©quence, nous avons des points de prÃ©sence dans ces rÃ©gions - nous avons juste oubliÃ© d'ajouter la Russie ici.  Et cela signifie que nous avons de nombreuses histoires sur la faÃ§on de faire et de ne pas le faire.  Aujourd'hui, nous partagerons avec vous certains d'entre eux. <br><br><img src="https://habrastorage.org/webt/ga/ai/xk/gaaixkdwusnkgwqc4h4wt_6kake.png"><br>  Qu'allons-nous dire, Ã©tant donnÃ© que le sujet est initialement volumineux?  Au dÃ©but, nous voulions seulement faire des questions / rÃ©ponses (questions et rÃ©ponses), mais on nous demandait toujours de lire le rapport.  Par consÃ©quent, si nous ne disons rien, mais nous n'avons certainement pas le temps, rattrapez-nous aprÃ¨s, en marge. <br><br>  Dans le cadre de la planification, nous allons essayer de parler de la diffÃ©rence entre l'Ã©quilibrage Ã  l'aide de DNS et BGP.  Comment choisir de nouveaux sites et ce Ã  quoi vous devez faire attention afin d'Ã©viter des douleurs ultÃ©rieures.  Comment soutenir tout cela et Ã  quel point cette tÃ¢che difficile Dmitry dira. <br><img src="https://habrastorage.org/webt/ai/so/3s/aiso3sgur0rj7nwml4w5zjzilhe.png"><br>  Pour commencer, dÃ©terminons dans quelle mesure vous connaissez le sujet. <br>  - Combien savent ce qu'est anycast et pourquoi il est nÃ©cessaire?  (environ un tiers des mains se lÃ¨vent dans le hall) <br>  - Et qui connaÃ®t le DNS et a configurÃ© le serveur?  (environ le mÃªme nombre de mains) <br>  - Et BGP (deux mains dans le cadre) <br><br>  Encore beaucoup. <br><br>  - Eh bien, la derniÃ¨re question - qui connaÃ®t NOC?  Qui a eu des problÃ¨mes avec les fournisseurs et qui a essayÃ© de les rÃ©soudre?  (la main de l'administrateur systÃ¨me Habr est visible dans le cadre) <br><br>  Super.  Dans ce cas, j'espÃ¨re que ce que nous allons vous dire arrivera. <br><img src="https://habrastorage.org/webt/ei/zh/dc/eizhdckf0att6kbopdgn49ngwji.png"><br>  Avant de passer Ã  anycast, voyons pourquoi cela est nÃ©cessaire.  Vous disposez d'une application avec laquelle vous souhaitez traiter les demandes des clients.  Vous Ãªtes hÃ©bergÃ© quelque part - alors que vous n'y pensez pas particuliÃ¨rement.  Achetez le nom DNS, rÃ©solvez-le, etc.  Ensuite, signez le certificat, car HTTPS.  Votre application grandit. <br><img src="https://habrastorage.org/webt/yx/z8/kt/yxz8ktime7shqpt5sesf60mtw5k.png"><br>  Tout d'abord, vous devez gÃ©rer la charge.  Si votre application "tire" en mÃªme temps, c'est-Ã -dire qu'elle devient trÃ¨s populaire, beaucoup plus d'utilisateurs viennent Ã  vous.  Vous devez acheter du fer et Ã©quilibrer la charge. <br><br>  De plus, des clients particuliÃ¨rement exigeants peuvent surgir avec les mots: "Les gars, vous devriez Ãªtre disponible toujours et partout pour ce genre d'argent!"  Ce qui conduit au fait que vous posez la redondance des ressources informatiques non seulement pour le traitement des pics de charge, mais simplement comme rÃ©serve. <br><br>  De plus, aujourd'hui, il a dÃ©jÃ  Ã©tÃ© mentionnÃ© dans d'autres apparences, vous ne pouvez pas placer les glandes dans un centre de donnÃ©es - une catastrophe naturelle peut se produire, ce qui signifie que l'application se mettra en arrÃªt, ce qui entraÃ®nera des pertes financiÃ¨res et autres.  Par consÃ©quent, si votre application s'est suffisamment dÃ©veloppÃ©e, vous devriez dÃ©jÃ  Ãªtre situÃ© dans plusieurs centres de donnÃ©es, sinon ce sera mauvais. <br><img src="https://habrastorage.org/webt/ak/ml/9l/akml9ljdopye_n4kf1u6lqrlq20.png"><br>  Le problÃ¨me a un revers: si votre application est sensible au temps, comme en analyse financiÃ¨re ou en trading, il est important que vous envoyiez des demandes Ã  vos utilisateurs le plus rapidement possible.  La latence notoire avec laquelle deux points sont connectÃ©s.  La premiÃ¨re - si vous souhaitez envoyer une demande le plus rapidement possible, alors pour cela, le nombre de demandes et de rÃ©ponses doit Ãªtre aussi petit que possible.  Encore une fois, le fait est que lorsque l'utilisateur se connecte Ã  vous pour la premiÃ¨re fois - tout ne fonctionne pas et il est obligÃ© de traverser tous les cercles de l'enfer.  Le deuxiÃ¨me point est la vitesse de la lumiÃ¨re.  Un paquet de l'Europe occidentale Ã  la Russie ne peut pas aller plus vite qu'un certain nombre de millisecondes, il n'y a rien Ã  faire. <br><img src="https://habrastorage.org/webt/rv/8b/f0/rv8bf0jfbctzabai0cuqh6q18ni.png"><br>  Il est nÃ©cessaire d'Ãªtre situÃ© dans plusieurs centres de donnÃ©es car nous voulons la redondance et nous devons nous rapprocher des clients potentiels.  Si, par exemple, votre principale rÃ©gion cliente est l'AmÃ©rique, vous y placerez votre Ã©quipement afin que le trafic ne passe pas par d'autres pays et parties du monde. <br><br>  Il s'avÃ¨re qu'Ã  partir d'un moment donnÃ©, vous devrez Ãªtre prÃ©sent dans toutes les rÃ©gions du monde sur diffÃ©rents sites.  Et ce n'est toujours pas diffusÃ©. <br><img src="https://habrastorage.org/webt/ko/uv/q2/kouvq2rg2extkysj5rffo8btofe.png"><br>  Vous avez donc besoin de quelques sites.  D'une maniÃ¨re ou d'une autre, vous devez les choisir, tous deux initialement nouveaux, et comprendre leur capacitÃ© Ã  Ã©voluer - pendant une surcharge, vous devrez acheter du matÃ©riel supplÃ©mentaire. <br><br>  Si vous avez dÃ©jÃ  plusieurs sites, vous devez apprendre Ã  rÃ©partir les utilisateurs entre eux.  Il y a deux chaises: BGP et DNS. <br><img src="https://habrastorage.org/webt/ve/zp/aj/vezpajk-xzaj4g0_rohgo3ouhqi.png"><br>  Ã€ partir de deux points, nous commencerons par le dernier.  Et encore deux approches principales.  Dans le premier, vous avez diffÃ©rents sites avec diffÃ©rentes adresses IP et, par consÃ©quent, lorsqu'un utilisateur prÃ©sente une demande - il obtient l'IP d'un site spÃ©cifique et les mappe dessus. <br><br>  Que dÃ©cidons-nous ici?  Nous voulons qu'un utilisateur d'une certaine rÃ©gion accÃ¨de Ã  un site situÃ© dans la mÃªme rÃ©gion.  La solution la plus simple et la plus stupide consiste Ã  utiliser GeoDNS.  Vous comprenez les rÃ©gions dans lesquelles se trouvent les prÃ©fixes - vous prenez ces donnÃ©es, les transfÃ©rez dans un serveur DNS, mappez les utilisateurs en consÃ©quence, si l'IP source provient du bon prÃ©fixe, vers le bon site.  Mais il y a un problÃ¨me - les rÃ©solveurs.  Et environ 15 Ã  20% des demandes proviennent de rÃ©solveurs - c'est-Ã -dire que l'IP source sera 8.8.8.8.  OÃ¹ mettre Ã§a? <br><br>  Pour ce faire, il existe EDNS, qui permet dans le cadre de la demande de transfÃ©rer le sous-rÃ©seau client d'origine d'oÃ¹ il provient.  Comme vous le savez, le 1er fÃ©vrier 2019, le jour du drapeau DNS s'est produit - Ã  partir de ce jour, tous les serveurs DNS doivent prendre en charge cette extension. <br><br>  Dans cet exemple, vous pouvez avoir un ou plusieurs sites oÃ¹ se trouvent des serveurs DNS qui mappent les utilisateurs - et les serveurs eux-mÃªmes peuvent Ãªtre distribuÃ©s dans le monde entier.  Et dÃ©jÃ  dans le cadre du DNS, il est possible d'utiliser anycast - nous en parlerons un peu plus tard. <br><br>  Dans le schÃ©ma gÃ©nÃ©ral, vous mappez l'utilisateur vers le site le plus proche de lui, en donnant l'adresse de ce site particulier.  Il est utilisÃ© moins frÃ©quemment. <br><br>  La troisiÃ¨me approche est liÃ©e au fait que mÃªme si l'utilisateur vient de la mÃªme rÃ©gion oÃ¹ se trouve le site, cela ne signifie pas que le problÃ¨me des retards soit rÃ©solu.  Il peut Ãªtre encore plus rentable de transfÃ©rer l'utilisateur vers un autre site, car la rÃ©gion peut Ãªtre surchargÃ©e si des itinÃ©raires alternatifs sont disponibles.  Serait-il agrÃ©able de l'utiliser?  Malheureusement, il n'y a presque pas de solutions actuelles pour faire quelque chose de similaire.  Facebook a montrÃ© en quelque sorte qu'il avait fait cela - mais il n'y a pas de boÃ®te, tout devra Ãªtre fait de vos propres mains. <br><img src="https://habrastorage.org/webt/6a/m1/qp/6am1qpmydhm7ztcbihnlxg9uxn4.png"><br>  Qu'avons-nous avec DNS? <br><br>  Les avantages sont que diffÃ©rents utilisateurs peuvent recevoir des adresses diffÃ©rentes et qu'un utilisateur spÃ©cifique peut Ãªtre envoyÃ© vers un site strictement dÃ©fini - c'est-Ã -dire que vous pouvez travailler avec des utilisateurs individuels.  Eh bien, le DNS est facile Ã  configurer. <br><br>  Quels sont les inconvÃ©nients?  Si vous effectuez un ajustement granulaire, la configuration se dÃ©veloppe assez rapidement, ce qui est impossible Ã  supporter avec vos mains.  Besoin d'automatisation.  Et si l'automatisation est mal effectuÃ©e, alors tout tombera en panne - si le DNS se trouve, alors l'application est inaccessible. <br><br>  D'un autre cÃ´tÃ©, si vous effectuez un Ã©quilibrage DNS, l'utilisateur mappera vers un site spÃ©cifique et son IP deviendra vulnÃ©rable.  C'est la raison pour laquelle nous n'utilisons pas d'Ã©quilibrage DNS Ã  la maison, car dans ce cas, tout le trafic de l'attaque peut circuler exactement en un point, le dÃ©sactivant. <br><br>  Et comme dÃ©jÃ  mentionnÃ©, DNS ne prend pas en charge l'Ã©quilibrage de latence prÃªt Ã  l'emploi.  Et le faire vous-mÃªme est trÃ¨s difficile. <br><img src="https://habrastorage.org/webt/9k/on/ng/9konngtwrxyf4kmhqlj-gjytbnw.png"><br>  Venons-en enfin aux choses plus fines, Ã  savoir BGP anycast. <br><br>  C'est exactement notre cas.  Ã€ quoi Ã§a sert?  Tous les sites ont la mÃªme IP, ou plutÃ´t, ils annoncent le mÃªme prÃ©fixe.  L'utilisateur mappe vers le site "le plus proche" de celui-ci.  Â«Le plus procheÂ» du point de vue de BGP - un tel prÃ©fixe est annoncÃ© en utilisant diffÃ©rentes routes, et si l'opÃ©rateur a plusieurs routes vers le site annoncÃ©, il choisira le plus souvent la plus courte.  Toujours du point de vue de BGP.  BientÃ´t, nous expliquerons pourquoi c'est mauvais. <br><br>  BGP fonctionne Ã©galement avec la disponibilitÃ© des prÃ©fixes, donc vous opÃ©rez toujours sur un sous-rÃ©seau et ne pouvez pas manipuler des IP individuelles. <br><br>  En consÃ©quence, comme le mÃªme prÃ©fixe est annoncÃ© sur tous les sites, tous les utilisateurs d'une mÃªme rÃ©gion seront dirigÃ©s vers le mÃªme site.  L'attaquant n'a aucun moyen de transfÃ©rer la charge d'une rÃ©gion Ã  une autre, vous devez donc gagner autant de puissance Ã  chacun des endroits que l'opÃ©rateur qui a choisi cette route le voulait.  MÃªme si vous ne marquez pas, il peut toujours Ãªtre protÃ©gÃ©. <br><br>  Le mÃªme prÃ©fixe est annoncÃ© - quoi de plus simple?  Mais il y a aussi des problÃ¨mes. <br>  La premiÃ¨re est qu'en raison de la nÃ©cessitÃ© d'annoncer le mÃªme prÃ©fixe dans le monde, vous Ãªtes obligÃ© d'acheter des adresses indÃ©pendantes du fournisseur, qui sont plusieurs fois plus chÃ¨res. <br><br>  La seconde se rÃ©sume au fait que les utilisateurs d'une rÃ©gion ne peuvent pas simplement Ãªtre jetÃ©s dans une autre, si soudainement certains d'entre eux sont illÃ©gitimes ou dans le but de diversifier le trafic d'attaque en utilisant d'autres sites, parce que certains font mal.  Il n'y a pas de tels stylos. <br><br>  Le troisiÃ¨me problÃ¨me est que dans le cadre de BGP, il est trÃ¨s facile de choisir le "mauvais" site et les "mauvais" fournisseurs.  Il vous semblera que vous avez une redondance et une disponibilitÃ©, mais en rÃ©alitÃ© il n'y aura ni l'un ni l'autre. <br><img src="https://habrastorage.org/webt/mo/bq/tt/mobqttqpsg2o2yhh9yzydelt008.png"><br>  Vous avez plusieurs sites entre lesquels vous souhaitez disperser les utilisateurs.  Quelles sont les poignÃ©es pour restreindre une certaine rÃ©gion, attirer les utilisateurs vers un site spÃ©cifique? <br><br>  Il y a Geo Community.  Pourquoi le sont-ils?  Permettez-moi de vous rappeler - vous choisissez l'itinÃ©raire le plus proche du point de vue de BGP.  Et vous avez un opÃ©rateur de niveau 1, par exemple Level3, qui a son propre tronc dans le monde.  Le client Level3, si vous y Ãªtes directement connectÃ©, se trouve Ã  deux espoirs de vous.  Et un opÃ©rateur local - sur trois.  En consÃ©quence, un opÃ©rateur amÃ©ricain sera plus proche de vous qu'un opÃ©rateur russe ou europÃ©en, car du point de vue de BGP, il en est ainsi. <br><br>  En utilisant Geo Community, vous pouvez limiter la rÃ©gion dans laquelle un opÃ©rateur aussi important et international annoncera votre itinÃ©raire.  Le problÃ¨me est Ã©galement qu'ils ne sont pas toujours disponibles (Geo Community). <br><br>  Nous avons plusieurs cas en ce qui nous concerne.  Dim? <br><br>  (Dmitry Shemonaev prend la parole) <br><img src="https://habrastorage.org/webt/no/w0/6i/now06iptknl3uf_utkuguxmotn0.png"><br><br>  Hors de la boÃ®te, de nombreux opÃ©rateurs ne fournissent pas cela et disent que, disent-ils, nous ne restreindrons rien pour la neutralitÃ© du rÃ©seau, la libertÃ©, etc.  Nous devons expliquer aux opÃ©rateurs depuis longtemps et qui nous sommes, pourquoi nous le voulons et pourquoi c'est si important pour nous, et aussi expliquer pourquoi cela ne s'applique pas Ã  la neutralitÃ© qu'ils ont en tÃªte.  Parfois, cela fonctionne - et parfois non, et nous refusons simplement de coopÃ©rer avec des opÃ©rateurs potentiellement intÃ©ressants car une telle coopÃ©ration entraÃ®nera de nouvelles douleurs dans le fonctionnement de notre service. <br><br>  De plus, nous rencontrons souvent le fait qu'il existe un certain nombre d'opÃ©rateurs qu'Eugene a dÃ©jÃ  mentionnÃ©s - ce sont des Tier-1, qui n'achÃ¨tent du trafic Ã  personne et n'Ã©changent que du trafic entre eux.  Mais, Ã  cÃ´tÃ© d'eux, il y a au moins une douzaine d'opÃ©rateurs qui ne sont pas de niveau 1 - ils achÃ¨tent du trafic, mais en mÃªme temps, ils ont Ã©galement des rÃ©seaux dÃ©ployÃ©s dans le monde entier.  Vous n'avez pas besoin d'aller loin - du plus proche de nous, c'est Rostelecom ou ReTN, un peu plus loin il y a les merveilleux tÃ©lÃ©coms de Taipei, China Unicom, Singtel et ainsi de suite. <br><br>  Et en Asie nous sommes assez souvent confrontÃ©s Ã  une telle situation que, semble-t-il, nous avons plusieurs points de prÃ©sence en Asie, nous sommes connectÃ©s Ã  plusieurs opÃ©rateurs assez importants, du point de vue de cette rÃ©gion.  Cependant, nous sommes constamment confrontÃ©s au fait que le trafic en provenance d'Asie va vers notre site via l'Europe ou effectue un voyage transatlantique.  Du point de vue de BGP, c'est tout Ã  fait normal, car il ne prend pas en compte la latence.  Mais l'application souffre dans de telles conditions, ses utilisateurs aussi - en gÃ©nÃ©ral, tout le monde souffre, mais du point de vue de BGP, tout va bien. <br><br>  Et vous devez faire quelques changements avec vos mains, faire de l'ingÃ©nierie inverse sur la faÃ§on dont l'acheminement de tel ou tel opÃ©rateur est organisÃ©, parfois nÃ©gocier, demander, mendier, s'agenouiller.  En gÃ©nÃ©ral, faites n'importe quoi pour rÃ©soudre ces problÃ¨mes.  Avec cela, notre CNO est confrontÃ© Ã  une rÃ©gularitÃ© enviable. <br><br>  En rÃ¨gle gÃ©nÃ©rale, les opÃ©rateurs rÃ©pondent Ã  leurs besoins et, dans certains cas, sont prÃªts Ã  fournir un certain ensemble ... Mais en gÃ©nÃ©ral, ceux qui ont travaillÃ© avec BGP au niveau communautaire peuvent-ils lever la main?  (Sourires) GÃ©nial!  Autrement dit, les opÃ©rateurs sont prÃªts Ã  fournir un ensemble de gestionnaires de communautÃ© afin, par exemple, de rÃ©duire les prÃ©fÃ©rences locales dans une certaine rÃ©gion, ou d'ajouter des prÃ©fixes, ou de ne pas bien annoncer ou autre chose. <br><br>  Par consÃ©quent, il existe deux faÃ§ons d'Ã©quilibrer la charge dans BGP.  Le premier est de savoir comment il est Ã©crit sur la diapositive, le soi-disant  se prÃ©pare.  Nous pouvons imaginer le chemin vers BGP comme une petite ligne rÃ©pertoriant les systÃ¨mes autonomes par lesquels passe le chemin du paquet de l'expÃ©diteur au destinataire.  Vous pouvez ajouter un niÃ¨me nombre de systÃ¨mes autonomes Ã  ce chemin, et par consÃ©quent, le chemin sera Ã©tendu et ne deviendra pas trÃ¨s prioritaire.  Il s'agit d'une mÃ©thode frontale et elle ne fonctionne pas pour tout - si vous ajoutez du prÃ©fixe, il n'est pas granulaire, c'est-Ã -dire que tout le monde le verra dans le cÃ´ne de l'opÃ©rateur dans lequel vous effectuez cette manipulation. <br><br>  D'autre part, il y a aussi la communautÃ© BGP, qui en marque, pour comprendre d'oÃ¹ vient tel ou tel prÃ©fixe, dont il s'agit par rapport Ã  l'opÃ©rateur - c'est-Ã -dire une fÃªte, un client ou en amont, et aussi Ã  quel endroit il est pris et ainsi de suite.  Et il y a des gestionnaires de communautÃ© qui vont au routeur vers l'opÃ©rateur et il prend certaines actions avec ce prÃ©fixe. <br><br>  La plupart des opÃ©rateurs ont des communautÃ©s restrictives.  Prenons par exemple l'opÃ©rateur russe abstrait, qui est connectÃ© Ã  un certain nombre d'opÃ©rateurs russes dans le vide.  Certains d'entre eux ont des relations d'Ã©gal Ã  Ã©gal, ce qui implique un Ã©change paritaire du trafic, et certains les achÃ¨tent.  En consÃ©quence, ils fournissent la communautÃ© afin de faire des prÃ©fixes dans cette direction, en Ã©tendant le chemin AS, ou de ne pas annoncer ou changer de prÃ©f local.  Si vous travaillez avec BGP - regardez la communautÃ© et dÃ©couvrez ce que le demandeur peut faire pour devenir votre fournisseur.  Parfois, les communautÃ©s sont cachÃ©es et vous devez communiquer soit avec les gestionnaires des opÃ©rateurs, soit avec des experts techniques afin de nous montrer un certain ensemble pris en charge. <br><br>  Par dÃ©faut, la communautÃ©, dans le cas de la rÃ©gion europÃ©enne, est dÃ©crite dans RIPE DB.  Autrement dit, vous faites une demande de whois les numÃ©ros du systÃ¨me autonome et le champ Remarques indique gÃ©nÃ©ralement ce que l'opÃ©rateur a en termes de marquage et de gestion de la communautÃ©.  Tout le monde ne l'a pas, il faut donc souvent chercher diffÃ©rents endroits intÃ©ressants. <br><br>  DÃ¨s que vous commencez Ã  utiliser BGP, vous dites essentiellement que le rÃ©seau fait partie de votre application et non quelque chose d'abstrait, vous devez donc tenir compte des risques. <br><br>  Par exemple, nous avons eu un cas avec une institution financiÃ¨re lettone, dont le prÃ©fixe, s'il Ã©tait inclus dans notre rÃ©seau, est devenu indisponible dans environ la moitiÃ© de la Lettonie.  Bien qu'il semble que rien n'a changÃ© - le mÃªme prÃ©fixe que nous annonÃ§ons chez les opÃ©rateurs de niveau 1, en Europe, il semblerait que tout y soit, y compris la redondance.  Mais nous ne pouvions mÃªme pas imaginer qu'environ la moitiÃ© des opÃ©rateurs lettons avaient comme pÃ©riphÃ©riques frontaliers qu'ils ne pouvaient pas digÃ©rer le volume complet de la vue complÃ¨te (la table de routage BGP entiÃ¨re), qui Ã  l'Ã©poque Ã©tait d'environ 650 000 prÃ©fixes.  Ils se tenaient lÃ , eh bien, si quelqu'un sait ce qu'est le Catalyst 3550, c'est exactement lÃ  qu'il se trouvait, il ne pouvait que 12 000 prÃ©fixes.  Eh bien, ils ont obtenu un certain nombre de prÃ©fixes de IX'a, sur lesquels, bien sÃ»r, il n'y avait pas de dÃ©faut.  ParallÃ¨lement Ã  cela, d'un autre opÃ©rateur - la tÃ©lÃ©vision lettone, dont le prÃ©fixe dans le IXÃ¨me n'Ã©tait pas / 24, mais / 22 dans lequel se trouvait ce / 24. <br><br>  En consÃ©quence, il est allÃ© dans un endroit oÃ¹ il ne savait pas oÃ¹ l'acheminer et tout a volÃ© dans le tuyau.  Pour rÃ©soudre ce problÃ¨me, il nous a fallu environ deux jours et une correspondance persistante avec les opÃ©rateurs lettons jusqu'Ã  ce qu'ils nous montrent la sortie de leur pÃ©riphÃ©rique frontalier et nous n'avons remarquÃ© que le nom d'hÃ´te lÃ -bas.  Bonjour Ã  tous, c'est tellement amusant parfois. <br><br>  Il existe de nombreux opÃ©rateurs avec du vieux fer.  Il existe de nombreux opÃ©rateurs avec une Ã©trange comprÃ©hension du fonctionnement du rÃ©seau.  Et maintenant c'est aussi votre problÃ¨me si vous allez jouer avec BGP.  Eh bien, en fin de compte, de nombreux opÃ©rateurs sont unijambistes (un fournisseur de connectivitÃ© supÃ©rieur), ils ont donc leurs propres jeux de bÃ©quilles. <br><img src="https://habrastorage.org/webt/89/zx/is/89zxisdottw3dfx4cxkca1o1xt4.png"><br><br>  (Evgeny Bogomazov continue) <br><br><img src="https://habrastorage.org/webt/l-/dd/wa/l-ddwaj2uwwteduh5wupbhygz1i.png"><br><br>  Comme vous pouvez le voir, mÃªme ce sujet peut Ãªtre dÃ©veloppÃ© pendant longtemps et il est difficile de le garder dans les 40 minutes. <br><br>  Donc, vous avez des stylos avec lesquels vous voulez limiter la rÃ©gion.  Voyons maintenant ce que vous devez regarder et ce qui est important Ã  considÃ©rer lorsque vous souhaitez hÃ©berger sur un nouveau site. <br><br>  Le meilleur cas n'est pas d'acheter votre matÃ©riel, mais d'accepter un cloud sur l'hÃ©bergement.  Alors dÃ©jÃ , il sera possible de convenir avec lui que vous vous connecterez indÃ©pendamment Ã  certains prestataires. <br><br>  D'un autre cÃ´tÃ©, si vous avez quand mÃªme empruntÃ© ce chemin, vous devez comprendre approximativement quelle rÃ©gion, avec ou sans poignÃ©es, sera rapprochÃ©e de ce site.  Pour ce faire, vous avez besoin d'une modÃ©lisation, ou plutÃ´t, vous devez comprendre que s'il existe plusieurs itinÃ©raires Ã  partir de sites diffÃ©rents, lequel sera choisi comme le meilleur.  Pour ce faire, vous devez avoir une idÃ©e du fonctionnement de BGP et de la circulation des itinÃ©raires dans la situation actuelle. <br><br>  Deux points principaux sont la longueur du chemin, influencÃ©e par les prÃ©fixes et la prÃ©fÃ©rence locale, qui dit que les itinÃ©raires des clients sont prÃ©fÃ©rables aux itinÃ©raires d'ailleurs.  En principe, ces deux points suffisent pour comprendre quelle rÃ©gion sera rapprochÃ©e et oÃ¹ se lever. <br><br>  ,     ,   â€”     ,   ,        (Â« Â»)        Tier-1   ,       . <br><br>          ,    IPv4  IPv6  ,     . <br><img src="https://habrastorage.org/webt/5w/1o/mo/5w1omookjlxi8nlba_jya-k0p-g.png"><br>       .   : Â« ?Â»    .        â€”    IX          .   ,  ,  ,     ,   ,      ,    IX'      .       ,       IX' ,  ,         â€”      . <br><br>       â€”     ,      .  â€”  ,           ,              ,    IX'. <br><br>  ,    , , ? <br><br> (   ) <br><br> .  ,            .      -   ,     ,      ,  BGP anycast â€”   . <br><br> ,     ,        RTT   ,    . , ,         ,   , RTT ,  .  â€” . <br><br>        ,        ,       â€” . <br>  ,   â€”       Â«Â»,        . ,         ,      â€”             ,    IGP     ,  ,         .  ,    â€”    ,       ,         . <br><br>   ,   Â«Â»  ,    SDN      ,    .            .     ,   SDN-,          (CenturyLink)              . -   . NOC         . -  . <br><br>       â€”    . <br><br>  , ,  â€”            .  â€”  Â«Â»,   â€”  Â«Â» (  ).                  ,     ,     Â«Â».  ,             ,     .        ,     ,    ,  -,   ,       .       - . <br><br>       .     community,     NOC.    ,        ,  ,      -             -        - DE-CIX  .      blackhole community. <br><br>            , ,  .    ,     ,        , - ,  -           ,    .  , .      ,    â€” NOC    ,      NOC           ,     .      .   . <br><img src="https://habrastorage.org/webt/y9/tl/j7/y9tlj7bpbxs6ftkb8bq-d4vnvww.png"><br>   NOC'. Network Operations Center â€”   ,    ,    ,      .    ,   .    ?  -           .   .        . <br><img src="https://habrastorage.org/webt/kc/6y/vq/kc6yvqtrzauok7myxr58bvlyces.png"><br>      ,  Â« - Â»      ,       .    ,   â€”    , .        NOC'  ,       .   ,     ,    â€”    RIPE Atlas   .  ,   .    ,      . <br><br>         community             ,   .     : ,   . ,         ,        .   ,     ,  -   community,   .   ,    -  â€” community .      community,      . , , .    community   ,     .  Qu'est-ce que cela signifie?             latency      â€”     .      - ,      ,    . <br><br>      â€”   10   ,     ,  Ansible, Chef, Puppet,      .   ?     BGP      : Â«      BGP-,           Â».           . <br><br>     ,      ,      ,        .         â€” -         .        ,    .  ,   ,     â€”   ,     : Â«  -!Â»    â€”   ,      (   ) â€”    .       ,    ,        .  â€”      . <br><br>  , . <br><img src="https://habrastorage.org/webt/_d/0b/v6/_d0bv6jjg1dic2gjmj9rdbp-azw.png"><br> (  ) <br><br>       .   anycast'   ,      , , . <br><img src="https://habrastorage.org/webt/_n/ve/jn/_nvejncgp1tspvfwgu8nvozas8e.png"><br>  ,   .  ,       â€”    ,        .    ,        ,      ,    .   RTT   . <br><br>   ,        ,          â€”   .     ,   anycast ,       â€”    . <br><br>              -  â€”  -  ,      ,       .      .         anycast       ,           â€”   -   ,      . <br><br> ,     - ,                   ,   ,    . -   ,  - - ,  , ,  â€”       . <br><img src="https://habrastorage.org/webt/ec/lq/mf/eclqmf8bbilulb74g7y9cmrhajs.png"><br>     ,      â€”     .         â€”      ,  â€”   . ,      ,   BGP   .  , -   ,  ,    . <br><br>      ,          .     â€”     ,  DNS â€”   .   SDN'        -  ,   ,     ,    . <br><img src="https://habrastorage.org/webt/sc/nf/2g/scnf2gqwejhemq6z5xfdolrn1ki.png"><br>   â€”  DNS.   Dyn   â€”   ,  2016      ,                . DNS   ,        . DNS- , ,      IETF   ,      ,      DNS-. <br><br>   ,    DNS.   ,     ,      .        RTT,     ,     DNS-    ,           , -    .        â€”     DNS. <br><br>   anycast     DNS    ,          DNS-    . <br><img src="https://habrastorage.org/webt/cs/gk/dd/csgkddm43z94n7u_mbvf-cvqamu.png"><br>     ? , latency, , . <br>    ,   .   -      .    ,     . <br><br>      .      ,      .    -  â€”  ,        . <br><br>  90% .    10% â€”      .       .  Â«Â»    ?    ,         ,         . ,     ,    . <br><img src="https://habrastorage.org/webt/x9/ii/bx/x9iibxwaeelggpxuhoteepdhxhy.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est donc prÃ©fÃ©rable de dÃ©lÃ©guer que dâ€™acheter votre propre matÃ©riel. </font><font style="vertical-align: inherit;">MÃªme une partie des fonctionnalitÃ©s que nous avons dÃ©crites aujourd'hui dans le cadre d'anycast et les problÃ¨mes qui se posent sont faciles Ã  rÃ©soudre de maniÃ¨re incorrecte. </font><font style="vertical-align: inherit;">Donc, s'il est possible de ne pas rÃ©soudre ces problÃ¨mes et de les transfÃ©rer Ã  des Ã©trangers, cela vaut probablement la peine. </font><font style="vertical-align: inherit;">Sinon, vous devez rÃ©pondre avec prÃ©cision Ã  la question de savoir pourquoi vous devez implÃ©menter tout cela. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eh bien, en cas d'attaque, tournez-vous vers les nuages â€‹â€‹qui se spÃ©cialisent dans la rÃ©solution de tels problÃ¨mes. </font><font style="vertical-align: inherit;">Eh bien, ou vous pouvez toujours discuter avec nous.</font></font><br><br>  Je vous remercie!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Des questions? </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/htUvHjaNwvA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457446/">https://habr.com/ru/post/fr457446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457436/index.html">Golang Meetup vol. 4 - 27 juin, Nizhny Novgorod</a></li>
<li><a href="../fr457438/index.html">TÃ©lÃ©chargez l'audio VKontakte via le client js ou l'extension de fichier .m3u8</a></li>
<li><a href="../fr457440/index.html">ServiceLoader: un framework DI intÃ©grÃ© dont vous n'avez peut-Ãªtre jamais entendu parler</a></li>
<li><a href="../fr457442/index.html">Projet Salmon: comment rÃ©sister efficacement Ã  la censure d'Internet avec des procurations avec des niveaux de confiance des utilisateurs</a></li>
<li><a href="../fr457444/index.html">Lunettes AR en action. Cas rÃ©els de la faÃ§on dont la rÃ©alitÃ© augmentÃ©e a trouvÃ© une application dans une grande variÃ©tÃ© de domaines d'activitÃ©</a></li>
<li><a href="../fr457450/index.html">Gartner: les 10 meilleures tendances technologiques en matiÃ¨re de traitement et d'analyse des donnÃ©es en 2019</a></li>
<li><a href="../fr457458/index.html">Support mobile pour machines-outils chinoises. Ou comment les placer dans un appartement</a></li>
<li><a href="../fr457460/index.html">Carte de sÃ©curitÃ© du noyau Linux</a></li>
<li><a href="../fr457462/index.html">Uber: PrÃ©sentation des algorithmes de gestion de plate-forme clÃ©s</a></li>
<li><a href="../fr457464/index.html">DÃ©duplication des annonces sur Yandex.Immobilier</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>