<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜‡ ğŸ•ºğŸ» â„¢ï¸ Kami sedang melakukan proyek pembelajaran mesin dengan Python. Bagian 1 ğŸ¥ ğŸ¯ âš“ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terjemahan dari Proyek Pembelajaran Mesin Lengkap Walk-Through dengan Python: Bagian Satu . 

 Ketika Anda membaca buku atau mendengarkan kursus pelat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kami sedang melakukan proyek pembelajaran mesin dengan Python. Bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nix/blog/425253/"><img src="https://habrastorage.org/getpro/habr/post_images/5de/fed/62e/5defed62ea348f6e02365e283415b2fb.png"><br><br>  <i>Terjemahan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proyek Pembelajaran Mesin Lengkap Walk-Through dengan Python: Bagian Satu</a> .</i> <br><br>  Ketika Anda membaca buku atau mendengarkan kursus pelatihan tentang analisis data, Anda sering merasa bahwa Anda menghadapi beberapa bagian terpisah dari gambar yang tidak dapat disatukan.  Anda mungkin takut dengan prospek mengambil langkah berikutnya dan menyelesaikan masalah sepenuhnya dengan bantuan pembelajaran mesin, tetapi dengan bantuan seri artikel ini Anda akan mendapatkan kepercayaan pada kemampuan untuk memecahkan masalah apa pun di bidang ilmu data. <br><br>  Agar Anda akhirnya memiliki gambaran lengkap di kepala Anda, kami menyarankan untuk menganalisis dari awal hingga akhir proyek menggunakan pembelajaran mesin menggunakan data nyata. <br><a name="habracut"></a><br>  Ikuti langkah-langkahnya: <br><br><ol><li>  Membersihkan dan memformat data. </li><li>  Analisis data eksplorasi. </li><li>  Desain dan pemilihan fitur. </li><li>  Perbandingan metrik beberapa model pembelajaran mesin. </li><li>  Tuning hyperparametric model terbaik. </li><li>  Evaluasi model terbaik pada set data uji. </li><li>  Interpretasi hasil model. </li><li>  Kesimpulan dan bekerja dengan dokumen. </li></ol><br>  Anda akan belajar bagaimana tahapan berjalan satu sama lain dan bagaimana mengimplementasikannya dengan Python.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Seluruh proyek</a> tersedia di GitHub, bagian pertama ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini.</a>  Pada artikel ini kita akan membahas tiga tahap pertama. <br><br><h2>  Deskripsi tugas </h2><br>  Sebelum menulis kode, Anda harus memahami masalah yang sedang dipecahkan dan data yang tersedia.  Dalam proyek ini, kami akan bekerja dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">data efisiensi energi yang</a> tersedia untuk umum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">untuk bangunan</a> di New York. <br><br>  Tujuan kami: untuk menggunakan data yang tersedia untuk membangun model yang memprediksi jumlah Skor Bintang Energi untuk bangunan tertentu, dan menafsirkan hasilnya untuk menemukan faktor-faktor yang mempengaruhi skor akhir. <br><br>  Data sudah termasuk Skor Energy Star yang ditugaskan, jadi tugas kami adalah pembelajaran mesin dengan regresi terkontrol: <br><br><ul><li>  Dibimbing: Kami tahu tanda dan tujuan, dan tugas kami adalah melatih model yang dapat membandingkan yang pertama dengan yang kedua. </li><li>  Regresi: Skor Bintang Energi adalah variabel kontinu. </li></ul><br>  Model kami harus akurat - sehingga dapat memprediksi nilai Skor Bintang Energi mendekati benar - dan dapat ditafsirkan - sehingga kami dapat memahami prediksi tersebut.  Mengetahui data target, kita dapat menggunakannya ketika membuat keputusan saat kita masuk lebih dalam ke data dan membuat model. <br><br><h2>  Pembersihan data </h2><br>  Tidak setiap set data adalah set pengamatan yang sangat cocok, tanpa anomali dan nilai yang hilang (sedikit dari data <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mtcars</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">iris</a> ).  Dalam data nyata, ada sedikit pesanan, jadi sebelum Anda memulai analisis, Anda perlu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menghapusnya dan membawanya</a> ke format yang dapat diterima.  Pembersihan data adalah prosedur yang tidak menyenangkan tetapi wajib dalam menyelesaikan sebagian besar tugas analisis data. <br><br>  Pertama, Anda dapat memuat data dalam bentuk kerangka data Pandas dan memeriksanya: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np # <span class="hljs-keyword"><span class="hljs-keyword">Read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> a dataframe data = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/Energy_and_Water_Data_Disclosure_for_Local_Law_84_2017__Data_for_Calendar_Year_2016_.csv'</span></span>) # Display top <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> dataframe data.head()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/4ac/637/b86/4ac637b8682b2fcacddd155004681a0d.png"><br>  <i>Beginilah tampilan data nyata.</i> <br><br>  Ini adalah fragmen dari tabel 60 kolom.  Bahkan di sini, beberapa masalah terlihat: kita perlu memprediksi <code>Energy Star Score</code> , tetapi kita tidak tahu apa arti semua kolom ini.  Meskipun ini belum tentu menjadi masalah, karena Anda sering dapat membuat model yang akurat tanpa mengetahui apa pun tentang variabel sama sekali.  Tetapi interpretabilitas penting bagi kami, jadi kami perlu mencari tahu arti dari setidaknya beberapa kolom. <br><br>  Ketika kami menerima data ini, kami tidak bertanya tentang nilai-nilai, tetapi melihat nama file: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a86/c00/ab2/a86c00ab2d64629e644e7186c78724f7.png"><br><br>  dan memutuskan untuk mencari "Hukum Lokal 84".  Kami menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">halaman ini</a> , yang mengatakan bahwa itu adalah undang-undang New York, yang menurutnya pemilik semua bangunan dengan ukuran tertentu harus melaporkan konsumsi energi.  Pencarian lebih lanjut membantu menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">semua nilai kolom</a> .  Jadi jangan abaikan nama file, itu bisa menjadi titik awal yang baik.  Selain itu, ini adalah pengingat agar Anda tidak tergesa-gesa dan tidak ketinggalan sesuatu yang penting! <br><br>  Kami tidak akan mempelajari semua kolom, tetapi kami pasti akan berurusan dengan Skor Bintang Energi, yang digambarkan sebagai berikut: <br><br><blockquote>  Peringkat persentil adalah dari 1 hingga 100, yang dihitung berdasarkan laporan tahunan tentang konsumsi energi oleh pemilik bangunan itu sendiri.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Skor Energy Star</a> adalah ukuran relatif yang digunakan untuk membandingkan kinerja energi bangunan. </blockquote><br>  Masalah pertama diselesaikan, tetapi yang kedua tetap - nilai yang hilang, ditandai sebagai "Tidak Tersedia".  Ini adalah nilai string dalam Python, yang berarti bahwa bahkan string dengan angka akan disimpan sebagai tipe data <code>object</code> , karena jika ada string dalam kolom, Pandas mengubahnya menjadi kolom yang seluruhnya terdiri dari string.  Jenis data kolom dapat ditemukan menggunakan metode <code>dataframe.info()</code> : <br><br><pre> <code class="hljs pgsql"># See the <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> non-missing <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> data.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>()</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/db3/b4d/013/db3b4d013ca25d7e5ac483f0c24fa1e4.png"><br><br>  Tentunya beberapa kolom yang secara eksplisit berisi angka (seperti ftÂ²) disimpan sebagai objek.  Kami tidak dapat menerapkan analisis numerik ke nilai string, jadi kami mengonversinya menjadi tipe data numerik (terutama <code>float</code> )! <br><br>  Kode ini pertama-tama menggantikan semua â€œTidak Tersediaâ€ dengan <i>bukan angka</i> ( <code>np.nan</code> ), yang dapat diartikan sebagai angka, dan kemudian mengonversi konten kolom tertentu ke tipe <code>float</code> : <br><br><pre> <code class="hljs pgsql"># Replace <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> occurrences <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> Available <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> a number data = data.replace({<span class="hljs-string"><span class="hljs-string">'Not Available'</span></span>: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # Iterate through the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> list(data.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>): # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> that should be <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'ftÂ²'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kBtu'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Metric Tons CO2e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'kWh'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'therms'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'gal'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">'Score'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col): # Convert the data <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-type"><span class="hljs-type">float</span></span> data[col] = data[col].astype(<span class="hljs-type"><span class="hljs-type">float</span></span>)</code> </pre> <br>  Ketika nilai-nilai di kolom yang sesuai dengan kami menjadi angka, kita dapat mulai memeriksa data. <br><br><h4>  Data tidak ada dan tidak normal </h4><br>  Seiring dengan tipe data yang salah, salah satu masalah yang paling umum adalah nilai yang hilang.  Mereka mungkin absen karena berbagai alasan, dan sebelum melatih model, nilai-nilai ini harus diisi atau dihapus.  Pertama, mari kita cari tahu berapa banyak nilai yang kita miliki di setiap kolom ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kode ada di sini</a> ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b0/5da/a40/0b05daa40ba77acca25ed859856759f2.png"><br>  <i>Untuk membuat tabel, fungsi dari cabang di <u>StackOverflow digunakan</u> .</i> <br><br>  Informasi harus selalu dihapus dengan hati-hati, dan jika ada banyak nilai di kolom, maka itu mungkin tidak akan menguntungkan model kita.  Ambang batas setelah itu lebih baik membuang kolom tergantung pada tugas Anda (di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini adalah diskusi</a> ), dan dalam proyek kami, kami akan menghapus kolom yang lebih dari setengah kosong. <br><br>  Juga pada tahap ini lebih baik untuk menghapus nilai abnormal.  Mereka dapat terjadi karena kesalahan ketik saat memasukkan data atau karena kesalahan dalam unit pengukuran, atau mereka bisa benar, tetapi nilai ekstrim.  Dalam hal ini, kami akan menghapus nilai "ekstra", dipandu oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">definisi anomali ekstrim</a> : <br><br><ul><li>  Di bawah kuartil pertama adalah rentang interkuartil 3.. </li><li>  Di atas kuartil ketiga + 3 range rentang interkuartil. </li></ul><br>  Kode yang menghilangkan kolom dan anomali tercantum pada Notepad di Github.  Setelah menyelesaikan proses pembersihan data dan menghilangkan anomali, kami memiliki lebih dari 11.000 bangunan dan 49 tanda. <br><br><h2>  Analisis data eksplorasi </h2><br>  Tahap pembersihan data yang membosankan namun perlu, Anda bisa pergi ke ruang belajar!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Analisis data eksplorasi</a> (RAD) adalah proses waktu tanpa batas di mana kami menghitung statistik dan mencari tren, anomali, pola, atau hubungan dalam data. <br><br>  Singkatnya, RAD adalah upaya untuk mencari tahu data apa yang dapat memberi tahu kami.  Biasanya, analisis dimulai dengan ulasan yang dangkal, kemudian kami menemukan fragmen yang menarik dan menganalisisnya secara lebih rinci.  Temuan mungkin menarik dalam hak mereka sendiri, atau mereka dapat berkontribusi pada pilihan model, membantu memutuskan fitur mana yang akan kita gunakan. <br><br><h4>  Grafik variabel tunggal </h4><br>  Tujuan kami adalah untuk memprediksi nilai Skor Bintang Energi (diubah namanya menjadi <code>score</code> kami di data kami), jadi masuk akal untuk memulai dengan memeriksa distribusi variabel ini.  Histogram adalah cara sederhana namun efektif untuk memvisualisasikan distribusi variabel tunggal, dan dapat dengan mudah dibangun menggunakan <code>matplotlib</code> . <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt # Histogram <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the Energy Star Score plt.style.use(<span class="hljs-string"><span class="hljs-string">'fivethirtyeight'</span></span>) plt.hist(data[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), bins = <span class="hljs-number"><span class="hljs-number">100</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'k'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Score'</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Number of Buildings'</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Energy Star Score Distribution'</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/f82/bf3/84a/f82bf384af1bd0c407f1e680d0b47263.png"><br><br>  Terlihat mencurigakan!  Skor Energy Star adalah persentil, jadi Anda harus mengharapkan distribusi yang seragam ketika setiap titik ditugaskan ke jumlah gedung yang sama.  Namun, sejumlah besar bangunan secara tidak proporsional menerima hasil tertinggi dan terendah (untuk Skor Energy Star, semakin besar semakin baik). <br><br>  Jika kita kembali melihat definisi skor ini, kita akan melihat bahwa itu dihitung berdasarkan "laporan yang diisi secara independen oleh pemilik bangunan," yang mungkin menjelaskan kelebihan nilai yang sangat besar.  Meminta pemilik gedung untuk melaporkan konsumsi energi mereka seperti meminta siswa untuk melaporkan nilai mereka dalam ujian.  Jadi ini mungkin bukan kriteria yang paling objektif untuk menilai efisiensi energi real estat. <br><br>  Jika kita memiliki persediaan waktu yang tidak terbatas, kita dapat mengetahui mengapa begitu banyak bangunan mendapat poin yang sangat tinggi dan sangat rendah.  Untuk melakukan ini, kita harus memilih bangunan yang sesuai dan menganalisisnya dengan cermat.  Tetapi kita hanya perlu belajar bagaimana memprediksi skor, dan tidak mengembangkan metode penilaian yang lebih akurat.  Anda dapat menandai diri sendiri bahwa poin memiliki distribusi yang mencurigakan, tetapi kami akan fokus pada perkiraan. <br><br><h4>  Pencarian hubungan </h4><br>  Bagian utama dari AHFR adalah pencarian hubungan antara tanda dan tujuan kita.  Variabel yang berhubungan dengannya berguna untuk digunakan dalam model, karena mereka dapat digunakan untuk peramalan.  Salah satu cara untuk mempelajari pengaruh variabel kategorikal (yang hanya mengambil satu set nilai terbatas) pada tujuannya adalah dengan memplot kepadatan menggunakan perpustakaan Seaborn. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Grafik kerapatan dapat dianggap sebagai histogram yang dihaluskan</a> karena menunjukkan distribusi variabel tunggal.  Anda bisa memberi warna pada masing-masing kelas pada grafik untuk melihat bagaimana variabel kategori mengubah distribusi.  Kode ini memplot grafik kerapatan Skor Bintang Energi, diwarnai sesuai dengan jenis bangunan (untuk daftar bangunan dengan lebih dari 100 dimensi): <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> a list <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> buildings <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> more than <span class="hljs-number"><span class="hljs-number">100</span></span> measurements <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = data.dropna(subset=[<span class="hljs-string"><span class="hljs-string">'score'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>].value_counts() <span class="hljs-keyword"><span class="hljs-keyword">types</span></span> = list(<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> &gt; <span class="hljs-number"><span class="hljs-number">100</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> distribution <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> scores <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building categories figsize(<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) # Plot <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> building <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> b_type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">types</span></span>: # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the building <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> subset = data[data[<span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>] == b_type] # Density plot <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Energy Star Scores sns.kdeplot(subset[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].dropna(), label = b_type, shade = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.8</span></span>); # label the plot plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Energy Star Score'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Density'</span></span>, size = <span class="hljs-number"><span class="hljs-number">20</span></span>); plt.title(<span class="hljs-string"><span class="hljs-string">'Density Plot of Energy Star Scores by Building Type'</span></span>, size = <span class="hljs-number"><span class="hljs-number">28</span></span>);</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/23a/718/fd3/23a718fd3139123b609e2521ffe46e3c.png"><br><br>  Seperti yang Anda lihat, jenis bangunan sangat mempengaruhi jumlah titik.  Bangunan kantor biasanya memiliki skor lebih tinggi dan hotel lebih rendah.  Jadi, Anda perlu memasukkan jenis bangunan dalam model, karena tanda ini memengaruhi tujuan kami.  Sebagai variabel kategori, kita harus melakukan pengkodean satu-panas dari tipe bangunan. <br><br>  Grafik serupa dapat digunakan untuk memperkirakan Skor Bintang Energi berdasarkan distrik kota: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/224/c69/820/224c69820a5c0362f804e37ae7d5de55.png"><br><br>  Area tidak mempengaruhi skor sebanyak jenis bangunan.  Namun demikian, kami akan memasukkannya dalam model, karena ada sedikit perbedaan antara daerah. <br><br>  Untuk menghitung hubungan antar variabel, Anda dapat menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">koefisien korelasi Pearson</a> .  Ini adalah ukuran intensitas dan arah hubungan linear antara dua variabel.  Nilai +1 berarti hubungan positif linear sempurna, dan -1 berarti hubungan negatif linear sempurna.  Berikut adalah beberapa contoh nilai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">koefisien korelasi Pearson</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0b3/455/654/0b34556548ab206112024fb0e8f69c01.png"><br><br>  Meskipun koefisien ini tidak dapat mencerminkan ketergantungan nonlinier, dimungkinkan untuk mulai dengan itu untuk mengevaluasi hubungan variabel.  Di Pandas, Anda dapat dengan mudah menghitung korelasi antara kolom apa pun dalam bingkai data: <br><br><pre> <code class="hljs pgsql"># Find <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> correlations <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the score <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> sort correlations_data = data.corr()[<span class="hljs-string"><span class="hljs-string">'score'</span></span>].sort_values()</code> </pre> <br>  Korelasi paling negatif dengan tujuan: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b62/181/178/b62181178669962fccf7caa472d9e2e8.png"><br><br>  dan yang paling positif: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/598/47f/14a/59847f14a4d8afe1ce8ff237c5d3fa36.png"><br><br>  Ada beberapa korelasi negatif yang kuat antara atribut dan tujuan, dan yang terbesar dari mereka termasuk dalam kategori EUI yang berbeda (metode untuk menghitung indikator ini sedikit berbeda).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">EUI (Energy Use Intensity</a> ) adalah jumlah energi yang dikonsumsi oleh bangunan dibagi dengan luas kaki persegi.  Nilai spesifik ini digunakan untuk mengevaluasi efisiensi energi, dan semakin kecil, semakin baik.  Logika menunjukkan bahwa korelasi ini dibenarkan: jika EUI meningkat, maka Skor Bintang Energi akan menurun. <br><br><h4>  Grafik dua variabel </h4><br>  Kami menggunakan plot pencar untuk memvisualisasikan hubungan antara dua variabel kontinu.  Anda dapat menambahkan informasi tambahan ke warna titik-titik, misalnya, variabel kategori.  Hubungan antara Skor Bintang Energi dan EUI ditunjukkan di bawah ini, warna menunjukkan berbagai jenis bangunan: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/974/204/7de/9742047ded29c74a9a8e6df9bf6396d1.png"><br><br>  Grafik ini memungkinkan Anda untuk memvisualisasikan koefisien korelasi -0,7.  Ketika EUI berkurang, Skor Energy Star meningkat, hubungan ini diamati pada berbagai jenis bangunan. <br><br>  Bagan penelitian terbaru kami disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pairs Plot</a> .  Ini adalah alat yang hebat untuk melihat hubungan antara pasangan variabel yang berbeda dan distribusi variabel tunggal.  Kami akan menggunakan perpustakaan Seaborn dan fungsi PairGrid untuk membuat bagan pasangan dengan bagan sebar di segitiga atas, dengan histogram diagonal, bagan kerapatan inti dua dimensi dan koefisien korelasi di segitiga bawah. <br><br><pre> <code class="hljs pgsql"># Extract the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> plot plot_data = features[[<span class="hljs-string"><span class="hljs-string">'score'</span></span>, <span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ftÂ²)'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ftÂ²)'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>]] # Replace the inf <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nan</span></span> plot_data = plot_data.replace({np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>, -np.inf: np.<span class="hljs-keyword"><span class="hljs-keyword">nan</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Rename</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> plot_data = plot_data.<span class="hljs-keyword"><span class="hljs-keyword">rename</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> = {<span class="hljs-string"><span class="hljs-string">'Site EUI (kBtu/ftÂ²)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Site EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'Weather Normalized Source EUI (kBtu/ftÂ²)'</span></span>: <span class="hljs-string"><span class="hljs-string">'Weather Norm EUI'</span></span>, <span class="hljs-string"><span class="hljs-string">'log_Total GHG Emissions (Metric Tons CO2e)'</span></span>: <span class="hljs-string"><span class="hljs-string">'log GHG Emissions'</span></span>}) # <span class="hljs-keyword"><span class="hljs-keyword">Drop</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> plot_data = plot_data.dropna() # <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate correlation coefficient <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> two <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> def corr_func(x, y, **kwargs): r = np.corrcoef(x, y)[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>] ax = plt.gca() ax.annotate("r = {:.2f}".format(r), xy=(<span class="hljs-number"><span class="hljs-number">.2</span></span>, <span class="hljs-number"><span class="hljs-number">.8</span></span>), xycoords=ax.transAxes, size = <span class="hljs-number"><span class="hljs-number">20</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> the pairgrid <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> grid = sns.PairGrid(data = plot_data, size = <span class="hljs-number"><span class="hljs-number">3</span></span>) # Upper <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a scatter plot grid.map_upper(plt.scatter, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0.6</span></span>) # Diagonal <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a histogram grid.map_diag(plt.hist, color = <span class="hljs-string"><span class="hljs-string">'red'</span></span>, edgecolor = <span class="hljs-string"><span class="hljs-string">'black'</span></span>) # Bottom <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> correlation <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> density plot grid.map_lower(corr_func); grid.map_lower(sns.kdeplot, cmap = plt.cm.Reds) # Title <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> entire plot plt.suptitle(<span class="hljs-string"><span class="hljs-string">'Pairs Plot of Energy Data'</span></span>, size = <span class="hljs-number"><span class="hljs-number">36</span></span>, y = <span class="hljs-number"><span class="hljs-number">1.02</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/4cc/94f/5fa4cc94f9b91df5ad4fda37aa3ae1f0.png"><br><br>  Untuk melihat hubungan variabel, cari persimpangan baris dan kolom.  Misalkan Anda ingin melihat korelasi antara <code>Weather Norm EUI</code> dan <code>score</code> , maka kami mencari seri <code>Weather Norm EUI</code> dan kolom <code>score</code> , di persimpangan di mana terdapat koefisien korelasi -0,67.  Grafik ini tidak hanya terlihat keren, tetapi juga membantu memilih variabel untuk model. <br><br><h2>  Desain dan pemilihan fitur </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Merancang dan memilih fitur</a> sering kali menghasilkan keuntungan terbesar dalam hal waktu yang dihabiskan untuk pembelajaran mesin.  Pertama, kami memberikan definisi: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Konstruksi karakter:</a> Proses mengekstraksi atau membuat karakteristik baru dari data mentah.  Untuk menggunakan variabel dalam model, Anda mungkin harus mentransformasikannya, katakanlah, ambil logaritma natural, atau ekstrak akar kuadrat, atau terapkan satu-hot coding dari variabel kategori.  Desain karakteristik dapat dianggap sebagai menciptakan fitur tambahan dari data mentah. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pemilihan Fitur:</a> Proses pemilihan fitur yang paling relevan dari data, di mana kami menghapus beberapa fitur untuk membantu model menggeneralisasikan data baru dengan lebih baik untuk mendapatkan model yang lebih dapat ditafsirkan.  Pilihan tanda dapat dianggap sebagai penghilangan "berlebihan" sehingga hanya yang paling penting yang tersisa. </li></ul><br>  Model pembelajaran mesin hanya dapat belajar dari data yang kami sediakan, sehingga sangat penting untuk memastikan bahwa kami menyertakan semua informasi yang relevan dengan tugas kami.  Jika Anda tidak memberikan model dengan data yang benar, model tidak akan dapat belajar dan tidak akan menghasilkan perkiraan yang akurat! <br><br>  Kami akan melakukan hal berikut: <br><br><ul><li>  Berlaku untuk variabel kategori (seperempat dan jenis kepemilikan), one-hot coding. </li><li>  Tambahkan logaritma natural dari semua variabel numerik. </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengodean satu-panas</a> diperlukan untuk memasukkan variabel kategori dalam model.  Algoritma pembelajaran mesin tidak akan dapat memahami jenis "kantor", jadi jika bangunan itu adalah kantor, kami akan memberinya tanda 1, dan jika bukan kantor, maka 0. <br><br>  Menambahkan fitur yang diubah akan membantu model belajar tentang hubungan nonlinear dalam data.  Dalam analisis data, adalah praktik normal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">untuk mengekstrak akar kuadrat, mengambil logaritma alami atau mengubah tanda-tanda</a> , tergantung pada tugas khusus atau pengetahuan Anda tentang teknik terbaik.  Dalam hal ini, kami akan menambahkan logaritma natural dari semua tanda numerik. <br><br>  Kode ini memilih tanda-tanda numerik, menghitung logaritma mereka, memilih dua tanda kategori, menerapkan pengkodean satu-panas untuk mereka, dan menggabungkan kedua set menjadi satu.  Dilihat dari uraiannya, masih banyak pekerjaan yang harus dilakukan, tetapi di Panda semuanya sangat sederhana! <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Copy</span></span> the original data features = data.<span class="hljs-keyword"><span class="hljs-keyword">copy</span></span>() # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> numeric_subset = data.select_dtypes(<span class="hljs-string"><span class="hljs-string">'number'</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">numeric</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> numeric_subset.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>: # Skip the Energy Star Score <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col == <span class="hljs-string"><span class="hljs-string">'score'</span></span>: next <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: numeric_subset[<span class="hljs-string"><span class="hljs-string">'log_'</span></span> + col] = np.log(numeric_subset[col]) # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> the categorical <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> categorical_subset = data[[<span class="hljs-string"><span class="hljs-string">'Borough'</span></span>, <span class="hljs-string"><span class="hljs-string">'Largest Property Use Type'</span></span>]] # One hot encode categorical_subset = pd.get_dummies(categorical_subset) # <span class="hljs-keyword"><span class="hljs-keyword">Join</span></span> the two dataframes <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> concat # Make sure <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use axis = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">perform</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> bind features = pd.concat([numeric_subset, categorical_subset], axis = <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Sekarang kami memiliki lebih dari 11.000 pengamatan (bangunan) dengan 110 kolom (tag).  Tidak semua tanda akan berguna untuk memprediksi Skor Bintang Energi, jadi kami akan mengambil pilihan tanda dan menghapus beberapa variabel. <br><br><h4>  Pemilihan Fitur </h4><br>  Banyak dari 110 tanda yang tersedia berlebihan karena mereka sangat berkorelasi satu sama lain.  Misalnya, berikut adalah grafik EUI dan Weather Normalized Site EUI, dengan koefisien korelasi 0,997. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ab/c4f/ad8/4abc4fad887ef202d8d40961a8b02c34.png"><br><br>  Tanda-tanda yang sangat berkorelasi satu sama lain disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">collinear</a> .  Menghapus satu variabel dalam pasangan atribut semacam itu sering membantu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">model untuk menggeneralisasi dan menjadi lebih dapat ditafsirkan</a> .  Harap dicatat bahwa kita berbicara tentang korelasi beberapa tanda dengan yang lain, dan bukan tentang korelasi dengan tujuan, yang hanya akan membantu model kita! <br><br>  Ada sejumlah metode untuk menghitung collinearity fitur, dan salah satu yang paling populer adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">variance inflation factor</a> .  Kami akan menggunakan koefisien korelasi untuk mencari dan menghapus fitur collinear.  Kami membuang satu pasang tanda jika koefisien korelasi di antara mereka lebih dari 0,6.  Kode ada di notepad (dan sebagai respons terhadap <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Stack Overflow</a> ). <br><br>  Nilai ini terlihat sewenang-wenang, tetapi sebenarnya saya mencoba ambang yang berbeda, dan di atas memungkinkan saya untuk membuat model terbaik.  Pembelajaran mesin bersifat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">empiris</a> , dan seringkali harus bereksperimen untuk menemukan solusi terbaik.  Setelah seleksi, kami memiliki 64 atribut dan satu tujuan. <br><br><pre> <code class="hljs pgsql"># Remove <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> na <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> features = features.dropna(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>, how = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) print(features.shape) (<span class="hljs-number"><span class="hljs-number">11319</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span>)</code> </pre> <br><h2>  Pilih level dasar </h2><br>  Kami membersihkan data, melakukan analisis eksplorasi, dan membangun tanda-tanda.  Dan sebelum melanjutkan ke pembuatan model, Anda harus memilih level dasar awal (garis dasar naif) - semacam asumsi yang akan kami bandingkan dengan hasil model.  Jika mereka jatuh di bawah tingkat dasar, kami akan menganggap bahwa pembelajaran mesin tidak berlaku untuk tugas ini, atau bahwa pendekatan yang berbeda harus dicoba. <br><br>  Untuk tugas-tugas regresi, sebagai level dasar, masuk akal untuk menebak nilai median tujuan pada set pelatihan untuk semua contoh dalam set tes.  Kit ini menetapkan penghalang yang relatif rendah untuk model apa pun. <br><br>  Sebagai metrik, kami mengambil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kesalahan absolut rata</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rata (mae)</a> dalam perkiraan.  Ada banyak metrik lain untuk regresi, tetapi saya suka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saran</a> untuk memilih satu metrik dan menggunakannya untuk mengevaluasi model.  Dan kesalahan absolut rata-rata mudah untuk dihitung dan ditafsirkan. <br><br>  Sebelum menghitung level dasar, Anda perlu membagi data ke dalam set pelatihan dan tes: <br><br><ol><li>  Serangkaian pelatihan atribut adalah apa yang kami berikan model kami bersama dengan jawaban selama pelatihan.  Model harus belajar untuk mencocokkan karakteristik tujuan. </li><li>  Set fitur uji digunakan untuk mengevaluasi model yang dilatih.  Ketika dia memproses suite tes, dia tidak melihat jawaban yang benar dan harus memprediksi berdasarkan fitur yang tersedia saja.  Kami tahu jawaban untuk data pengujian dan dapat membandingkan hasil perkiraan dengan mereka. </li></ol><br>  Untuk pelatihan, kami menggunakan 70% dari data, dan untuk pengujian - 30%: <br><br><pre> <code class="hljs pgsql"># Split <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> <span class="hljs-number"><span class="hljs-number">70</span></span>% training <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span>% testing <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> X, X_test, y, y_test = train_test_split(features, targets, test_size = <span class="hljs-number"><span class="hljs-number">0.3</span></span>, random_state = <span class="hljs-number"><span class="hljs-number">42</span></span>)</code> </pre> <br>  Sekarang kita menghitung indikator untuk level dasar awal: <br><br><pre> <code class="hljs vhdl"># <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> calculate mean absolute <span class="hljs-literal"><span class="hljs-literal">error</span></span> def mae(y_true, y_pred): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.mean(<span class="hljs-keyword"><span class="hljs-keyword">abs</span></span>(y_true - y_pred)) baseline_guess = np.median(y) print(<span class="hljs-symbol"><span class="hljs-symbol">'The</span></span> baseline guess <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a score <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> %<span class="hljs-number"><span class="hljs-number">0.2</span></span>f' % baseline_guess) print(<span class="hljs-string"><span class="hljs-string">"Baseline Performance on the test set: MAE = %0.4f"</span></span> % mae(y_test, baseline_guess))</code> </pre> <br>  <b>Tebakan dasar adalah skor 66,00</b> <b><br></b>  <b>Kinerja Dasar pada set tes: MAE = 24.5164</b> <br><br>  Kesalahan absolut rata-rata pada set tes adalah sekitar 25 poin.  Karena kami mengevaluasi dalam kisaran dari 1 hingga 100, kesalahannya adalah 25% - penghalang yang agak rendah untuk model! <br><br><h2>  Kesimpulan </h2><br>  Anda di artikel ini, kami telah melalui tiga tahap pertama dalam menyelesaikan masalah menggunakan pembelajaran mesin.  Setelah mengatur tugas, kami: <br><br><ol><li>  Data mentah yang dihapus dan diformat. </li><li>  Melakukan analisis eksplorasi untuk mempelajari data yang tersedia. </li><li>  Kami mengembangkan serangkaian fitur yang akan kami gunakan untuk model kami. </li></ol><br> ,    ,       . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> </a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Scikit-Learn</a>    ,        . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id425253/">https://habr.com/ru/post/id425253/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id425243/index.html">Buku pegangan john willis</a></li>
<li><a href="../id425245/index.html">Pengumuman RamblerFront & # 6</a></li>
<li><a href="../id425247/index.html">Crowdsourcing dalam pengujian</a></li>
<li><a href="../id425249/index.html">Bagaimana berkenalan dengan LLP di ITMO University: kursus "Pemrograman Tingkat Rendah"</a></li>
<li><a href="../id425251/index.html">LoJax: rootkit UEFI pertama yang diketahui digunakan dalam kampanye jahat</a></li>
<li><a href="../id425255/index.html">Algoritma kompresi lossless dan delta coding Broo, perbandingan dengan Xdelta3. Pengembangan proyek rumah</a></li>
<li><a href="../id425259/index.html">Mencadangkan situs Anda menggunakan git dan Makefile</a></li>
<li><a href="../id425261/index.html">Sertifikat EV sudah mati</a></li>
<li><a href="../id425263/index.html">Festival iFEST akan diadakan di Nizhny Novgorod</a></li>
<li><a href="../id425265/index.html">Aturan pengembangan di Yandex.Health</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>