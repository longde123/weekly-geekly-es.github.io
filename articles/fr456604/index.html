<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèª üï¶ üë©üèº‚Äç‚öñÔ∏è Comment nous avons automatis√© une grande boutique en ligne et commenc√© √† faire correspondre automatiquement les produits üçÅ üòè üí¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'article est plus technique que sur les affaires, mais nous tirerons √©galement quelques conclusions du point de vue des affaires. La plus grande atte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons automatis√© une grande boutique en ligne et commenc√© √† faire correspondre automatiquement les produits</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456604/"><img src="https://habrastorage.org/webt/vm/sf/by/vmsfbyuh4sqwgsjidvjpzleydcu.jpeg" alt="image"><br><br>  L'article est plus technique que sur les affaires, mais nous tirerons √©galement quelques conclusions du point de vue des affaires.  La plus grande attention sera accord√©e √† la comparaison automatique des marchandises provenant de diff√©rentes sources. <br><br>  Le travail de la boutique en ligne se compose d'un nombre assez important de composants.  Et quel que soit le plan, pour r√©aliser un profit d√®s maintenant, ou pour cro√Ætre et rechercher des investisseurs, ou, par exemple, pour d√©velopper des domaines connexes, au moins vous devez fermer ces questions: <br><br><ul><li>  Travailler avec les fournisseurs.  Pour vendre quelque chose d'inutile, vous devez d'abord acheter quelque chose d'inutile. </li><li>  Gestion d'annuaire.  Quelqu'un a une sp√©cialisation √©troite, tandis que quelqu'un vend des centaines de milliers de produits diff√©rents. </li><li>  Gestion des prix de d√©tail.  Ici, vous devrez tenir compte des prix des fournisseurs, des prix des concurrents et des instruments financiers abordables. </li><li>  Travaillez avec l'entrep√¥t.  En principe, il est possible de ne pas avoir son propre entrep√¥t, mais de prendre les marchandises dans les entrep√¥ts des partenaires, mais d'une mani√®re ou d'une autre la question est. </li><li>  Marketing.  Ici, le site est rempli de contenu, de placement sur des sites, de publicit√© (en ligne et hors ligne), de promotions et bien plus encore. </li><li>  R√©ception et traitement des commandes.  Centre d'appels, panier sur le site, commandes via messagerie instantan√©e, commandes via plateformes et marketplaces. </li><li>  Livraison. </li><li>  Comptabilit√© et autres syst√®mes internes. </li></ul><br>  Le magasin, dont nous parlerons, n'a pas une sp√©cialisation √©troite, mais offre un tas de tout, des cosm√©tiques au mini-tracteur.  Je vais vous dire comment nous travaillons avec les fournisseurs, le suivi des concurrents, la gestion des catalogues et les prix (gros et d√©tail), le travail avec les clients grossistes.  Une petite touche sur le sujet de l'entrep√¥t. <br><br>  Pour mieux comprendre certaines des solutions techniques, il ne sera pas superflu de savoir qu‚Äôen <br>  √† un moment donn√©, nous avons d√©cid√© que les choses technologiques, si possible, seraient faites non pas pour nous-m√™mes, mais universelles.  Et, peut-√™tre, apr√®s plusieurs tentatives, il en ressortira pour d√©velopper une nouvelle entreprise.  Il s'av√®re, conditionnellement, une startup au sein de l'entreprise. <br><br>  Nous envisageons donc un syst√®me s√©par√©, plus ou moins universel, avec lequel le reste de l'infrastructure de l'entreprise est int√©gr√©. <br><a name="habracut"></a><br><h2>  Quel est le probl√®me de travailler avec les fournisseurs? </h2><br>  Et il y en a beaucoup, en fait.  Juste pour en donner: <br><br><ul><li>  Il existe de nombreux fournisseurs en soi.  Nous en avons environ 400. Tout le monde doit prendre un peu de temps. </li><li>  Il n'y a pas de moyen unique d'obtenir des offres des fournisseurs.  Quelqu'un envoie le courrier dans les d√©lais, quelqu'un sur demande, quelqu'un t√©l√©charge sur l'h√©bergement de fichiers, quelqu'un place sur le site.  Il existe de nombreuses fa√ßons, jusqu'√† l'envoi du fichier via skype. </li><li>  Il n'y a pas de format de donn√©es unique.  J'ai m√™me fait un dessin sur ce sujet (il est plus bas, les tableaux symbolisent diff√©rents formats). </li><li>  Il y a le concept de prix de d√©tail minimum et de prix de gros minimum qui doivent √™tre respect√©s afin de continuer √† travailler avec le fournisseur.  Ils sont souvent fournis dans leur propre format. </li><li>  La nomenclature de chaque fournisseur est diff√©rente.  Par cons√©quent, le m√™me produit est appel√© diff√©remment et il n'y a pas de cl√© unique permettant de le comparer facilement.  Par cons√©quent, nous le comparons difficile. </li><li>  Le syst√®me de commande aupr√®s du fournisseur n'est pas automatis√©.  Nous commandons √† quelqu'un sur Skype, √† quelqu'un de votre compte, √† quelqu'un √† qui nous envoyons un fichier exel tous les soirs avec une liste de commandes. </li></ul><br><img src="https://habrastorage.org/webt/84/x_/0c/84x_0cekqji4tmiu6j8fw3470ko.png" alt="image"><br><br>  Nous avons appris √† faire face √† ces probl√®mes.  En plus de ce dernier, les travaux sur ce dernier sont en cours.  Maintenant, il y aura des d√©tails techniques, puis consid√©rez la liste suivante. <br><br><h2>  Collecte de donn√©es </h2><br><h3>  Comme c'√©tait </h3><br>  Les fichiers des fournisseurs ont √©t√© collect√©s manuellement √† partir de diverses sources et pr√©par√©s.  La pr√©paration comprenait le changement de nom selon un mod√®le sp√©cifique et la modification du contenu.  Selon le fichier, il √©tait n√©cessaire de supprimer les marchandises non standard, les marchandises qui ne sont pas en stock, de renommer les colonnes ou de convertir des devises, de collecter des donn√©es √† partir de diff√©rents onglets sur un seul. <br><br><h3>  Comment </h3><br>  Tout d'abord, nous avons appris √† v√©rifier le courrier et √† r√©cup√©rer des lettres avec des pi√®ces jointes √† partir de l√†.  Ils ont ensuite automatis√© le travail avec des liens directs et des liens vers des lecteurs Yandex et Google.  Cela a r√©solu le probl√®me de la r√©ception d'offres d'environ 75% de nos fournisseurs.  Nous avons √©galement remarqu√© que c'est √† travers ces canaux que les offres sont le plus souvent mises √† jour, de sorte que le pourcentage r√©el d'automatisation est plus √©lev√©.  Nous obtenons toujours des prix dans les messagers. <br><br>  Deuxi√®mement, nous ne traitons plus les fichiers manuellement.  Pour ce faire, nous avons entr√© des profils de fournisseur, o√π vous pouvez sp√©cifier la colonne et l'onglet √† utiliser, comment d√©terminer la devise et la disponibilit√©, le d√©lai de livraison et le calendrier de travail du fournisseur. <br><br>  Cela s'est av√©r√© flexible.  Naturellement, nous n'avons pas tout pris en compte la premi√®re fois, mais maintenant il y a suffisamment de flexibilit√© pour configurer le traitement des 400 fournisseurs, √©tant donn√© que tout le monde a des formats de fichiers diff√©rents. <br><br>  Quant aux formats de fichiers, nous comprenons xls, xlsx, csv, xml (yml).  Dans notre cas, c'√©tait suffisant. <br><br>  Ils ont √©galement compris comment filtrer les enregistrements.  Nous avons fait une liste de mots vides et si l'offre du fournisseur en contient, nous ne la traitons pas.  Les d√©tails techniques sont les suivants: sur une petite liste, vous pouvez et encore mieux ¬´de face¬ª, sur de grandes listes, un filtre Bloom plus rapide.  Nous avons fait des exp√©riences avec lui et avons tout laiss√© tel quel, car le gain est ressenti sur la liste d'un ordre de grandeur plus grand que le n√¥tre. <br><br>  Une autre chose importante est le calendrier de travail du fournisseur.  Nos fournisseurs travaillent selon des horaires diff√©rents, en plus, ils sont situ√©s dans diff√©rents pays, sur lesquels les week-ends ne co√Øncident pas.  Et le d√©lai de livraison est g√©n√©ralement indiqu√© sous forme de nombre ou de plage de nombres en jours ouvrables.  Lorsque nous √©tablissons les prix de d√©tail et de gros, nous devrons en quelque sorte √©valuer le moment o√π nous pouvons livrer les marchandises au client.  Pour ce faire, nous avons cr√©√© des calendriers configurables et dans les param√®tres de chaque fournisseur, vous pouvez sp√©cifier sur quels calendriers il fonctionne. <br><br>  J'ai d√ª faire une configuration de remises et de marges en fonction de la cat√©gorie et du fabricant.  Il arrive que le fournisseur ait un dossier commun √† tous les partenaires, mais il existe des accords de remise avec certains partenaires.  Gr√¢ce √† cela, il √©tait encore possible d'ajouter ou de soustraire la TVA si n√©cessaire. <br><br>  Soit dit en passant, la configuration des r√®gles de remise et de majoration nous am√®ne au sujet suivant.  Apr√®s tout, avant de les utiliser, vous devez savoir de quel type de produit il s'agit. <br><br><h2>  Fonctionnement de la cartographie </h2><br>  Un petit exemple de la fa√ßon dont le m√™me produit peut √™tre appel√© de diff√©rents fournisseurs, pour comprendre avec quoi vous devez travailler: <br><blockquote>  Moniteur LG LCD 22MP48D-P <br>  21,5 "LG 22MP48D-P Black (16: 9, 1920x1080, IPS, 60 Hz, DVI + D-Sub (VGA)) <br>  COMP - P√©riph√©riques informatiques - Moniteurs LG 22MP48D-P <br>  jusqu'√† 22 "moniteur LG inclus LG 22MP48D-P (21,5", noir, IPS LED 5ms 16: 9 DVI mat 250cd 1920x1080 D-Sub FHD) 22MP48D-P <br>  Moniteurs LG 22 "LG 22MP48D-P Glossy-Black (IPS, LED, 1920x1080, 5 ms, 178 ¬∞ / 178 ¬∞, 250 cd / m, 100M: 1, + DVI) <br>  Moniteurs LCD LG LCD Monitor 22 "IPS 22MP48D-P LG 22MP48D-P <br>  Moniteur LG 21,5 "LG 22MP48D-P gl.Black IPS, 1920x1080, 5ms, 250 cd / m2, 1000: 1 (Mega DCR), D-Sub, DVI-D (HDCP), vesa 22MP48D-P.ARUZ <br>  Moniteur LG LG 22MP48D-P Noir 22MP48D-P.ARUZ <br>  Moniteur LG 22MP48D-P 22MP48D-P <br>  Moniteurs LG 22MP48D-P Glossy-Black 22MP48D-P <br>  Moniteur 21,5 "LG Flatron 22MP48D-P gl.Black (IPS, 1920x1080, 16: 9, 178/178, 250cd / m2, 1000: 1, 5ms, D-Sub, DVI-D) (22MP48D-P) 22MP48D-P <br>  Moniteur 22 "LG 22MP48D-P <br>  LG 22MP48D-P IPS DVI <br>  LG LG 21.5 "22MP48D-P IPS LED, 1920x1080, 5ms, 250cd / m2, 5Mln: 1, 178 ¬∞ / 178 ¬∞, D-Sub, DVI, Tilt, VESA, Glossy Black 22MP48D-P <br>  LG 21,5 "22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P <br>  Moniteur 21,5 '' LG 22MP48D-P Noir <br>  LG MONITOR 21.5 "LG 22MP48D-P Glossy-Black (IPS, LED, 1920x1080, 5 ms, 178 ¬∞ / 178 ¬∞, 250 cd / m, 100M: 1, + DVI) 22MP48D-P <br>  Moniteur LCD LG 21,5 '' [16: 9] 1920x1080 (FHD) IPS, non GLARE, 250cd / m2, H178 ¬∞ / V178 ¬∞, 1000: 1, 16.7M Color, 5ms, VGA, DVI, Tilt, 2Y, Black OK 22MP48D -P <br>  LCD LG 21,5 "22MP48D-P noir {IPS LED 1920x1080 5ms 16: 9 250cd 178 ¬∞ / 178 ¬∞ DVI D-Sub} 22MP48D-P.ARUZ <br>  IDS_Monitors LG LG 22 "LCD 22MP48D 22MP48D-P <br>  Moniteur LG 21,5 "16x9 LG 21,5" 22MP48D-P noir IPS LED 5ms 16: 9 DVI mat 250cd 1920x1080 D-Sub FHD 2,7kg 22MP48D-P.ARUZ <br>  Moniteur 21,5 "LG 22MP48D-P [Noir]; 5 ms; 1920x1080, DVI, IPS </blockquote><h3>  Comme c'√©tait </h3><br>  La comparaison portait sur 1C (module tiers pay√©).  C√¥t√© commodit√© / rapidit√© / pr√©cision, un tel syst√®me a permis de maintenir un catalogue de 60 000 produits disponibles √† ce niveau par 6 personnes.  Autrement dit, chaque jour, d√©pass√© et disparu des offres des fournisseurs, autant de produits assortis que de nouveaux ont √©t√© cr√©√©s.  Tr√®s approximativement - 0,5% de la taille du catalogue, soit  300 produits. <br><br><h3>  Comment elle est devenue: une description g√©n√©rale de l'approche </h3><br>  Un peu plus haut, j'ai donn√© un exemple de ce que nous devons faire correspondre.  En explorant le sujet de l'appariement, j'ai √©t√© un peu surpris qu'ElasticSearch soit populaire pour la t√¢che d'appariement, √† mon avis, il a des limites conceptuelles.  Quant √† notre pile technologique, nous utilisons MS SQL Server pour le stockage de donn√©es, mais la comparaison fonctionne sur notre propre infrastructure, et comme il y a beaucoup de donn√©es et que nous devons les traiter rapidement, nous utilisons des structures de donn√©es optimis√©es pour une t√¢che sp√©cifique et essayons de ne pas acc√©der au disque ou √† la base de donn√©es sans avoir besoin et d'autres syst√®mes lents. <br><br>  De toute √©vidence, le probl√®me de comparaison peut √™tre r√©solu de plusieurs fa√ßons, et √©videmment, aucun ne donnera une pr√©cision absolue.  Par cons√©quent, l'id√©e principale est d'essayer de combiner ces m√©thodes, de les classer par pr√©cision et vitesse et de les appliquer par ordre d√©croissant de pr√©cision, en tenant compte de la vitesse. <br><br>  Le plan d'ex√©cution de chacun de nos algorithmes (avec une r√©serve sur les cas d√©g√©n√©r√©s) peut √™tre bri√®vement repr√©sent√© par la s√©quence g√©n√©rale suivante: <br><br>  Tokenisation  Nous divisons la ligne source en quelque chose de significatif et ind√©pendant.  Cela peut √™tre fait une fois de plus et utilis√© dans tous les algorithmes. <br><br>  Normalisation des jetons.  Dans le bon sens, vous devez amener les mots de la langue naturelle au nombre g√©n√©ral et √† la d√©clinaison, et des identifiants comme ¬´ABC15MX¬ª (c'est du cyrillique, si quelque chose) pour convertir en latin.  Et mettez tout dans le m√™me registre. <br><br>  Cat√©gorisation des jetons.  Essayer de comprendre ce que signifie chaque partie.  Par exemple, vous pouvez s√©lectionner une cat√©gorie, un fabricant, une couleur, etc. <br><br>  Recherchez le meilleur candidat pour un match. <br><br>  Une estimation de la probabilit√© que la ligne d'origine et le meilleur candidat indiquent le m√™me produit. <br><br>  Les deux premiers points sont communs √† tous les algorithmes actuellement disponibles, puis les improvisations commencent. <br><br>  Tokenisation  Ici, nous l'avons fait, nous s√©parons la ligne en parties en fonction de caract√®res sp√©ciaux tels que l'espace, la barre oblique, etc.  Le jeu de caract√®res au fil du temps s'est av√©r√© important, mais nous n'avons utilis√© rien de compliqu√© dans l'algorithme lui-m√™me. <br><br>  Ensuite, nous devons normaliser les jetons.  Convertissez-les en minuscules.  Au lieu de tout mener au cas nominatif, nous avons simplement coup√© les fins.  Nous avons √©galement un petit dictionnaire et nous traduisons nos jetons en anglais.  Entre autres choses, la traduction nous sauve de synonymes, de sens similaire, les mots russes sont traduits en anglais de la m√™me mani√®re.  L√† o√π nous n'avons pas r√©ussi √† traduire, nous changeons les caract√®res cyrilliques orthographiques en alphabet latin.  (Ce n'est pas du tout superflu, comme il s'est av√©r√©. M√™me l√† o√π vous ne vous attendez pas √† un sale tour, par exemple, dans la ligne "Samsung U43NU7100U", le cyrillique E peut tout √† fait se rencontrer). <br><br><img src="https://habrastorage.org/webt/j2/wv/2s/j2wv2spiz0vsmlp2iycrtnu8y4w.png" alt="image"><br><br>  Cat√©gorisation des jetons.  Nous pouvons mettre en √©vidence la cat√©gorie, le fabricant, le mod√®le, l'article, l'EAN, la couleur.  Nous avons un r√©pertoire o√π les donn√©es sont structur√©es.  Nous avons des donn√©es sur les concurrents que les plateformes de trading nous fournissent.  Lors de leur traitement, lorsque cela est possible, nous structurons les donn√©es.  Nous pouvons corriger les erreurs ou les fautes de frappe, par exemple, le fabricant ou la couleur, qui ne se produisent qu'une seule fois dans toutes nos sources, sans tenir compte du fabricant et de la couleur, respectivement.  En cons√©quence, nous avons un grand dictionnaire de fabricants, mod√®les, articles, couleurs et la cat√©gorisation de jetons possibles n'est qu'une recherche par dictionnaire pour O (1).  Th√©oriquement, vous pouvez avoir une liste ouverte de cat√©gories et une sorte d'algorithme de classification intelligent, mais notre approche de base fonctionne bien et la cat√©gorisation n'est pas un goulot d'√©tranglement. <br><br>  Il convient de noter que parfois le fournisseur fournit des donn√©es d√©j√† structur√©es, par exemple, l'article est dans une cellule distincte du tableau, ou le fournisseur fait une remise sur la vente au d√©tail en gros et les prix de d√©tail peuvent √™tre obtenus au format yml (xml).  Ensuite, nous enregistrons la structure des donn√©es et divisons heuristiquement les jetons en cat√©gories uniquement √† partir de donn√©es non structur√©es. <br><br>  Et maintenant sur quels algorithmes et dans quel ordre nous utilisons. <br><br><h3>  Correspondances exactes et presque exactes </h3><br>  Le cas le plus simple.  Les lignes √©taient divis√©es en jetons, elles les menaient √† une seule forme.  Ensuite, ils ont propos√© une fonction de hachage qui n'est pas sensible √† l'ordre des jetons.  De plus, en faisant correspondre par hachage, nous pouvons conserver toutes les donn√©es en m√©moire, nous pouvons nous permettre 16 m√©gaoctets par dictionnaire avec un million de cl√©s.  En pratique, l'algorithme fonctionne mieux que les simples comparaisons de cha√Ænes. <br><br>  Quant au hachage, l'utilisation de "exclusif ou" se sugg√®re, et une fonction comme celle-ci: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLongHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; tokens</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> hash = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tokens.Distinct()) { hash ^= GetLongHashCode(token); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hash; }</code> </pre> <br>  La chose la plus int√©ressante √† ce stade est d'obtenir un hachage d'une seule ligne.  En pratique, il s'est av√©r√© que 32 bits sont petits, beaucoup de collisions sont obtenues.  Et aussi - que vous ne pouvez pas simplement extraire le code source de la fonction du framework et changer le type de la valeur de retour, il y a moins de collisions pour les lignes individuelles, mais apr√®s le "exclusif ou" elles se produisent toujours, nous avons donc √©crit le n√¥tre.  En fait, ils ont simplement ajout√© √† la fonction du cadre de non-lin√©arit√© des donn√©es d'entr√©e.  C'√©tait d√©finitivement mieux, avec la nouvelle fonction avec collision, nous ne nous sommes rencontr√©s qu'une seule fois sur nos millions d'enregistrements, enregistr√©s et report√©s jusqu'√† des temps meilleurs. <br><br>  Ainsi, nous recherchons des correspondances sans tenir compte de l'ordre des mots et de leur forme.  Une telle recherche fonctionne pour O (1). <br><br>  Malheureusement, rarement, mais cela arrive aussi: ¬´ABC 42 Type 16¬ª et ¬´ABC 16 Type 42¬ª, et ce sont deux produits diff√©rents.  Nous avons √©galement appris √† faire face √† de telles choses, mais plus √† ce sujet plus tard. <br><br><h3>  Produits humains confirm√©s assortis </h3><br>  Nous avons des produits qui sont appari√©s manuellement (le plus souvent, ce sont des produits qui sont appari√©s automatiquement, mais qui ont √©t√© v√©rifi√©s manuellement).  En fait, nous faisons la m√™me chose dans ce cas, seulement maintenant nous avons ajout√© un dictionnaire de hachages correspondants, dont la recherche n'a pas chang√© la complexit√© temporelle de l'algorithme. <br><br>  Les lignes appari√©es manuellement se trouvent simplement dans la base de donn√©es, juste au cas o√π de telles donn√©es brutes vous permettront de modifier l'algorithme de hachage √† l'avenir, de tout recalculer et de ne rien perdre. <br><br><h3>  Mappage d'attributs </h3><br>  Les deux premiers algorithmes sont rapides et pr√©cis, mais pas suffisants.  Ensuite, nous appliquons la correspondance d'attributs. <br><br>  Auparavant, nous avions d√©j√† pr√©sent√© les donn√©es sous forme de jetons normalis√©s et les avions m√™me tri√©s en cat√©gories.  Dans ce chapitre, j'appelle des attributs de cat√©gories de jetons. <br><br>  L'attribut le plus fiable est EAN (https://ru.wikipedia.org/wiki/European_Article_Number).  Les correspondances EAN vous garantissent presque 100% qu'il s'agit du m√™me produit.  La non-concordance des EAN, cependant, ne dit rien, car un produit peut avoir des EAN diff√©rents.  Tout irait bien, mais dans nos donn√©es l'EAN est rare, donc son influence sur la comparaison au niveau d'erreur. <br><br>  L'article est moins fiable.  Quelque chose d'√©trange provient souvent directement des donn√©es structur√©es du fournisseur, mais en tout cas √† ce stade, nous l'utilisons. <br><br>  Comme √† la derni√®re √©tape, nous utilisons ici des dictionnaires (recherche de O (1)), et le hachage de (fabricant + mod√®le + article) est utilis√© comme cl√©.  Le hachage vous permet d'effectuer toutes les op√©rations en m√©moire.  Dans ce cas, nous prenons √©galement en compte la couleur, si elle correspond ou n'existe pas, nous pensons que les marchandises ont co√Øncid√©. <br><br><h3>  Rechercher la meilleure correspondance </h3><br>  Les √©tapes pr√©c√©dentes √©taient simples, rapides et assez fiables, mais malheureusement elles couvrent moins de la moiti√© des comparaisons. <br><br>  Dans la recherche de la meilleure correspondance, il y a une id√©e simple: la co√Øncidence des jetons rares a un poids important, la co√Øncidence des jetons fr√©quents est petite.  Les jetons contenant des nombres ont plus de valeur que les jetons de lettres.  Les jetons qui correspondent dans le m√™me ordre sont plus valoris√©s que les jetons r√©organis√©s.  Les matchs longs sont meilleurs que les matchs courts. <br><br>  Il reste maintenant √† proposer une structure de donn√©es rapide qui peut prendre tout cela en compte en m√™me temps et s'inscrit dans la m√©moire d'un r√©pertoire de quelques millions d'enregistrements. <br><br>  Nous avons eu l'id√©e de pr√©senter notre catalogue sous la forme d'un dictionnaire de dictionnaires, au premier niveau, la cl√© sera un hachage du fabricant (les donn√©es du catalogue sont structur√©es, nous connaissons le fabricant), la valeur est le dictionnaire.  Maintenant, le deuxi√®me niveau.  La cl√© au deuxi√®me niveau sera le hachage du jeton, la valeur est la liste des √©l√©ments d'identification du catalogue o√π ce jeton est trouv√©.  Et dans ce cas, nous utilisons notamment des combinaisons de jetons dans l'ordre dans lequel ils apparaissent dans notre catalogue.  Nous d√©cidons quoi utiliser en combinaison, et ce qui ne l'est pas, selon le nombre de jetons, leur longueur, etc., c'est un compromis entre vitesse, pr√©cision et m√©moire requise.  Dans la figure, j'ai simplifi√© cette structure, sans hachage et sans normalisation. <br><br><img src="https://habrastorage.org/webt/kl/wu/k8/klwuk8-3nkyfo8db2schr5nt2mk.png" alt="image"><br><br>  Si en moyenne 20 jetons sont utilis√©s pour chaque produit, alors dans nos listes, qui ont les valeurs du dictionnaire ci-joint, un lien vers le produit appara√Ætra en moyenne 20 fois.  Il n'y aura pas plus de 20 jetons diff√©rents que les marchandises du catalogue.  Approximativement, vous pouvez calculer la m√©moire requise pour un catalogue d'un million d'enregistrements: 20 millions de cl√©s, 4 octets chacun, 20 millions d'identifiant de produit 4 octets chacun, surcharge pour l'organisation des dictionnaires et des listes (l'ordre est le m√™me, mais √©tant donn√© la taille des listes et des dictionnaires nous ne savons pas √† l'avance, mais augmentez sur la route, multipliez par deux).  Total - 480 m√©gaoctets.  En r√©alit√©, il s'est av√©r√© un peu plus de jetons pour les marchandises, et nous avons besoin de jusqu'√† 800 m√©gaoctets par catalogue pour un million de marchandises.  Ce qui est acceptable, les capacit√©s du fer moderne vous permettent de stocker simultan√©ment en m√©moire plus d'une centaine de r√©pertoires de cette taille. <br><br>  Revenons √† l'algorithme.  Ayant une cha√Æne que nous devons faire correspondre, nous pouvons d√©terminer le fabricant (nous avons un algorithme de cat√©gorisation), puis obtenir des jetons en utilisant le m√™me algorithme que pour les marchandises du catalogue.  Ici, je veux dire, y compris les combinaisons de jetons. <br><br>  Alors tout est relativement simple.  Pour chaque jeton, nous pouvons trouver rapidement tous les produits dans lesquels il se trouve, estimer le poids de chaque correspondance, en tenant compte de tout ce dont nous avons parl√© plus t√¥t - longueur, fr√©quence, pr√©sence de chiffres ou de caract√®res sp√©ciaux, et √©valuer la ¬´similitude¬ª de tous les candidats trouv√©s.  En r√©alit√©, il y a aussi des optimisations ici, nous ne consid√©rons pas tous les candidats, nous cr√©ons d'abord une petite liste de correspondances de jetons avec un poids √©lev√©, et nous n'appliquons pas de correspondances de jetons avec un poids faible √† tous les produits, mais uniquement √† cette liste. <br><br>  Nous s√©lectionnons la meilleure correspondance, examinons la co√Øncidence des jetons qui se sont av√©r√©s √™tre class√©s et consid√©rons le score de comparaison.  De plus, nous avons deux valeurs de seuil P1 et P2, P1 &lt;P2.  Si l'√©valuation s'est av√©r√©e √™tre sup√©rieure √† la valeur seuil P2 - la participation humaine n'est pas requise, tout se passe automatiquement.  Si entre deux valeurs - nous vous proposons de voir la comparaison manuellement, avant cela, il ne participera pas au prix.  Si moins de P1 - tr√®s probablement, un tel produit n'est pas dans le catalogue, nous ne retournons rien. <br><br>  Revenons aux lignes ¬´ABC 42 Type 16¬ª et ¬´ABC 16 Type 42¬ª.  La solution est √©tonnamment simple - si plusieurs produits ont les m√™mes hachages, nous ne les faisons pas correspondre par hachage.  Et le dernier algorithme prendra en compte l'ordre des jetons.  Th√©oriquement, de telles lignes dans la liste de prix du fournisseur ne peuvent pas √™tre mises en correspondance avec quelque chose d‚Äôarbitraire, o√π les nombres 16 et 42 ne se produisent pas du tout.  En fait, nous n'avons pas rencontr√© un tel besoin. <br><br><h3>  Vitesse et pr√©cision </h3><br>  Maintenant, pour la vitesse de tout cela.  Le temps n√©cessaire √† la pr√©paration lin√©aire des dictionnaires d√©pend de la taille du catalogue.  Le temps n√©cessaire directement √† la comparaison d√©pend lin√©airement du nombre de marchandises √† comparer.  Toutes les structures de donn√©es impliqu√©es dans la recherche ne sont pas modifi√©es apr√®s la cr√©ation.  Cela nous donne la possibilit√© d'utiliser le multithreading au stade de l'appariement.  Le travail pr√©paratoire pour le catalogue d'un million d'enregistrements prend environ 40 √† 80 secondes.  La comparaison fonctionne √† une vitesse de 20 √† 40 000 enregistrements par seconde et ne d√©pend pas de la taille du r√©pertoire.  Ensuite, cependant, vous devez enregistrer les r√©sultats.  L'approche choisie est g√©n√©ralement b√©n√©fique pour les gros volumes, mais un fichier avec une dizaine d'enregistrements sera disproportionnellement long.  Par cons√©quent, nous utilisons le cache et recomptons nos structures de recherche toutes les 15 minutes. <br><br>  Certes, les donn√©es de comparaison doivent √™tre lues quelque part (le plus souvent, il s'agit d'un fichier Excel), et les phrases correspondantes doivent √™tre enregistr√©es quelque part, ce qui prend √©galement du temps.  Le nombre total est donc de 2 √† 4 000 enregistrements par seconde. <br><br>  Afin d'√©valuer la pr√©cision, nous avons pr√©par√© une suite de tests d'environ 20 000 comparaisons v√©rifi√©es manuellement de diff√©rents fournisseurs de diff√©rentes cat√©gories.  Apr√®s chaque modification, l'algorithme a √©t√© test√© sur ces donn√©es.  Les r√©sultats sont les suivants: <br><br><ul><li>  les marchandises sont dans le catalogue et ont √©t√© compar√©es correctement - 84% </li><li>  le produit est dans le catalogue, mais n'a pas √©t√© appari√©, l'appariement manuel est requis - 16% </li><li>  les marchandises sont dans le catalogue et ont √©t√© mal compar√©es - 0,2% </li><li>  le produit n'est pas dans le catalogue et le programme l'a correctement identifi√© - 98,5% </li><li>  le produit n'est pas dans le catalogue, mais le programme l'a associ√© √† l'un des produits - 1,5% </li></ul><br>  Dans 80% des cas o√π le produit a √©t√© appari√©, une confirmation manuelle n'est pas requise (nous confirmons automatiquement la comparaison), parmi ces offres confirm√©es automatiquement, il y a 0,1% d'erreurs. <br><br>  Soit dit en passant, 0,1% d'erreurs, c'est beaucoup, il s'av√®re.  Pour un million d'enregistrements appari√©s, c'est un millier d'enregistrements appari√©s incorrectement.  Et c'est beaucoup parce que les acheteurs trouvent le mieux ces enregistrements.  Eh bien, comment ne pas commander un tracteur pour le prix des phares de ce tracteur.  Cependant, ce millier d'erreurs est au d√©but des travaux sur un million de propositions, elles ont √©t√© progressivement corrig√©es.  La mise en quarantaine des prix suspects, qui cl√¥t ce probl√®me, est apparue plus tard, les premiers mois o√π nous avons travaill√© sans. <br><br>  Il existe une autre cat√©gorie d'erreurs qui n'est pas li√©e √† la comparaison: ce sont les mauvais prix de nos fournisseurs.  C'est en partie pourquoi nous ne prenons pas en compte le prix en comparaison.  Nous avons d√©cid√© que puisque nous avons des informations suppl√©mentaires sous forme de prix, nous les utiliserons pour essayer de d√©terminer non seulement nos propres erreurs, mais aussi celles des autres. <br><br><h3>  Rechercher les mauvais prix </h3><br>  C'est la partie sur laquelle nous exp√©rimentons activement.  La version de base est, et elle ne vous permet pas de vendre le t√©l√©phone au prix d'un √©tui, mais j'ai le sentiment que c'est mieux. <br><br>  Pour chaque produit, nous trouvons les limites des prix fournisseurs acceptables.  En fonction des donn√©es disponibles, nous prenons en compte les prix des fournisseurs de ce produit, les prix des concurrents, les prix des fournisseurs de biens de ce fabricant dans cette cat√©gorie.  Les prix qui ne tombent pas √† l'int√©rieur des fronti√®res sont mis en quarantaine et ignor√©s dans tous nos algorithmes.  Manuellement, vous pouvez marquer un prix aussi suspect comme normal, puis nous nous en souvenons pour ce produit et recomptons les limites des prix acceptables. <br><br>  L'algorithme direct de calcul des prix maximum et minimum acceptables √©tant en constante √©volution, nous recherchons un compromis entre le nombre de faux positifs et le nombre de prix incorrects d√©tect√©s. <br><br>  Nous utilisons des valeurs m√©dianes dans les calculs (les moyennes donnent le pire r√©sultat) et nous n'analysons pas encore la forme de distribution.  L'analyse de la forme de distribution est juste l'endroit o√π, il me semble, l'algorithme peut √™tre am√©lior√©. <br><br><h3>  Travailler avec la base de donn√©es </h3><br>  De tout ce qui pr√©c√®de, nous pouvons conclure que nous mettons √† jour les donn√©es sur les fournisseurs et les concurrents souvent et de nombreuses mani√®res, et travailler avec la base de donn√©es peut devenir un goulot d'√©tranglement.  En principe, nous avons d'abord attir√© l'attention sur ce point et essay√© d'obtenir des performances maximales.  Lorsque vous travaillez avec un grand nombre d'enregistrements, nous proc√©dons comme suit: <br><br><ul><li>  nous supprimons les index de la table avec laquelle nous travaillons </li><li>  d√©sactiver l'indexation de texte int√©gral sur ce tableau </li><li>  supprimer tous les enregistrements avec une certaine condition (par exemple, toutes les offres de fournisseurs sp√©cifiques que nous traitons actuellement) </li><li>  ins√©rer de nouveaux enregistrements avec BULK COPY </li><li>  recr√©er des index </li><li>  activer l'indexation de texte int√©gral </li></ul><br><br>  La copie en bloc fonctionne √† une vitesse de 10 √† 40 000 enregistrements par seconde, pourquoi une telle propagation reste √† voir, mais elle est tellement acceptable. <br><br>  La suppression d'enregistrements prend environ le m√™me temps que l'insertion.  Il faut encore du temps pour recr√©er les index. <br><br>  Soit dit en passant, pour chaque r√©pertoire, nous avons une base de donn√©es distincte.  Nous les cr√©ons √† la vol√©e.  Et maintenant, je vais vous dire pourquoi nous avons plus d'un catalogue. <br><br><h2>  Quel est le probl√®me du catalogage </h2><br>  Et il y en a aussi beaucoup.  Maintenant, nous allons lister: <br><br><ul><li>  Le catalogue contient environ 400 000 produits de cat√©gories compl√®tement diff√©rentes.  Il est impossible de comprendre professionnellement chacune des cat√©gories. </li><li>  Vous devez suivre un certain style, suivre les r√®gles g√©n√©rales pour le nom du catalogue, nommer les sous-cat√©gories, etc.  Ainsi, nous essayons de r√©aliser une structure de r√©pertoires coh√©rente et logique. </li><li>  Vous pouvez cr√©er plusieurs fois le m√™me produit, ce qui pose probl√®me.  Sans outil qui analyse des noms similaires, des doublons sont constamment cr√©√©s. </li><li>  Il est raisonnable d'ajouter au catalogue les marchandises que les fournisseurs ont en stock.  Dans ce cas, vous devez avoir des priorit√©s pour les cat√©gories de produits. </li><li>  Nous avons besoin de plusieurs r√©pertoires.  L'un des n√¥tres, nous le r√©alisons nous-m√™mes, l'autre - le catalogue des agr√©gateurs, nous le mettons √† jour par api.  Le sens du deuxi√®me catalogue est que la plate-forme d'agr√©gation fonctionne uniquement avec son propre catalogue et, par cons√©quent, accepte les offres dans sa nomenclature.  C'est un autre endroit o√π il s'est av√©r√© que vous aviez besoin d'une comparaison. </li></ul><br>  Nous avons pens√© qu'il √©tait logique et correct de conserver un r√©pertoire au m√™me endroit o√π les comparaisons sont effectu√©es.  Ainsi, nous pouvons dire aux utilisateurs qui g√®rent l'annuaire ce que le fournisseur a, mais pas dans l'annuaire. <br><br><h2>  Comment tenons-nous un catalogue </h2><br>  Il s'agira du catalogue sans caract√©ristiques d√©taill√©es, les caract√©ristiques sont une grande histoire distincte, √† ce sujet une autre fois. <br><br>  Comme propri√©t√©s de base, nous avons choisi les √©l√©ments suivants: <br><br><ul><li>  producteur </li><li>  cat√©gorie </li><li>  le mod√®le </li><li>  num√©ro d'article </li><li>  couleur </li><li>  Ean </li></ul><br>  Tout d'abord, nous avons cr√©√© une API pour obtenir le catalogue √† partir d'une source externe, puis nous avons travaill√© sur la commodit√© de cr√©er, modifier et supprimer des enregistrements. <br><br><h3>  Fonctionnement de la recherche </h3><br>  La commodit√© de la gestion d'un catalogue, tout d'abord, est la possibilit√© de trouver rapidement un produit dans un catalogue ou une offre de fournisseur, et il y a des nuances.  Par exemple, vous devez pouvoir rechercher la ligne ¬´LG 21.5¬ª 22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P ¬ªpour¬´ 2MP48 ¬ª. <br><br>  Une recherche de serveur SQL en texte int√©gral hors de la bo√Æte ne convient pas, car elle ne sait pas comment le faire, et la recherche avec LIKE '% 2MP48%' est trop lente. <br><br>  Notre solution est assez standard, nous utilisons des N-grammes.  Plus pr√©cis√©ment, puis trigrammes.  Et d√©j√† par trigrammes, nous construisons un index de texte int√©gral et effectuons une recherche de texte int√©gral.  Je ne suis pas s√ªr que nous utilisons l'espace de mani√®re tr√®s rationnelle dans ce cas, mais en termes de vitesse, cette solution est apparue, selon la demande, elle fonctionne de 50 √† 500 millisecondes, parfois jusqu'√† une seconde sur un tableau de trois millions d'enregistrements. <br><br>  Je m'explique, la ligne ¬´LG 21.5¬ª 22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P ¬ªest convertie en la ligne¬´ lg2 g21 215 152 522 22m 2mp mp4 p48 48d 8dp dp1 p16 169 69i 9ip ips psv svg vga gad gad adv dvi vi2 i22 ‚Äù, qui est stock√© dans un champ s√©par√© qui participe √† l'index de texte int√©gral. <br><br>  Soit dit en passant, les trigrammes nous sont toujours utiles. <br><br><h3>  Cr√©er un nouveau produit </h3><br>  Pour la plupart, les produits du catalogue sont cr√©√©s √† la suggestion du fournisseur.  Autrement dit, nous avons d√©j√† des informations que le fournisseur propose "LG LCD Monitor 21.5 '' [16: 9] 1920x1080 (FHD) IPS, non GLARE, 250cd / m2, H178 ¬∞ / V178 ¬∞, 1000: 1, 16.7M Color, 5ms, VGA, DVI, Tilt, 2Y, Black OK 22MP48D-P ‚Äùau prix de 120 $, et il a 5 √† 10 unit√©s en stock. <br><br>  Lors de la cr√©ation d'un produit, tout d'abord, nous devons nous assurer qu'un tel produit n'a pas encore √©t√© cr√©√© dans le catalogue.  Nous r√©solvons ce probl√®me en quatre √©tapes. <br><br>  Premi√®rement, si nous avons un produit dans le catalogue, il est tr√®s probable que la proposition du fournisseur correspondra automatiquement √† ce produit. <br><br>  Deuxi√®mement, avant de montrer √† l'utilisateur le formulaire de cr√©ation d'un nouveau produit, nous effectuerons une recherche par trigrammes et afficherons les r√©sultats les plus pertinents.  (techniquement, cela se fait en utilisant CONTAINSTABLE). <br><br>  Troisi√®mement, lorsque nous remplissons les champs d'un nouveau produit, nous afficherons des produits existants similaires.  Cela r√©sout deux probl√®mes: cela permet d'√©viter les doublons et de conserver le style dans les noms, des produits similaires peuvent √™tre utilis√©s comme mod√®le. <br><br>  Et quatri√®mement, rappelez-vous, nous avons cass√© les lignes en jetons, les normalis√©, compt√© les hachages?  Nous ferons de m√™me et ne laisserons tout simplement pas cr√©er des marchandises avec les m√™mes hachages. <br><br>  √Ä ce stade, nous essayons d'aider l'utilisateur.  Par la ligne qui est dans la liste de prix, nous essaierons de d√©terminer le fabricant, la cat√©gorie, l'article, l'EAN et la couleur des marchandises.  Tout d'abord, par jetons (nous pouvons les diviser en cat√©gories), puis, si cela ne fonctionne pas, nous trouverons le produit le plus similaire par trigrammes.  Et, s'il est assez similaire, indiquez le fabricant et la cat√©gorie. <br><br>  L'√©dition des produits fonctionne presque de la m√™me mani√®re, mais tout n'est pas applicable. <br><br><h2>  Comment nous fixons nos prix </h2><br>  La t√¢che est la suivante: maintenir un √©quilibre entre la quantit√© et la marge des ventes, en fait - pour r√©aliser un profit maximum.  Tous les autres aspects du travail du magasin sont √©galement li√©s √† cela, mais ce qui se passe exactement au stade de la tarification a le plus grand impact. <br><br>  Au minimum, nous aurons besoin d'informations sur les offres des fournisseurs et concurrents.  Il convient √©galement de tenir compte des prix de d√©tail et de gros et des frais de livraison minimaux, ainsi que des instruments financiers - pr√™ts et versements. <br><br><h3>  Nous collectons les prix des concurrents </h3><br>  Pour commencer, nous avons de nombreux profils de nos propres prix.  Il existe un profil pour le commerce de d√©tail, il y en a plusieurs pour les clients grossistes.  Tous sont cr√©√©s et configur√©s dans notre syst√®me. <br><br>  En cons√©quence, les concurrents pour chaque profil sont diff√©rents.  Dans le commerce de d√©tail - autres magasins de d√©tail, dans les ventes en gros - nos m√™mes fournisseurs. <br><br>  Tout est clair avec les fournisseurs, mais pour la vente au d√©tail, nous collectons les donn√©es des concurrents de plusieurs mani√®res.  Premi√®rement, certains agr√©gateurs fournissent des informations sur tous les prix de toutes les marchandises pr√©sentes sur le site.  Dans notre propre nomenclature, mais nous pouvons faire correspondre les produits, donc cela fonctionne automatiquement.  Et c'est presque suffisant pour l'instant.  Deuxi√®mement, nous avons des analyseurs concurrents.  Puisqu'elles ne sont pas encore automatis√©es et existent sous forme d'applications console (qui plantent parfois), nous les utilisons rarement. <br><br><h3>  Personnalisez votre profil </h3><br>  Dans le profil, nous avons la possibilit√© de configurer diff√©rentes gammes de marges en fonction du prix des marchandises du fournisseur, cat√©gorie, fabricant, fournisseur.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est toujours possible d'indiquer avec quels fournisseurs dans quelle cat√©gorie ou fabricant nous travaillons, et avec quels - et non, quels concurrents envisageons-nous. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ensuite, nous mettons en place des instruments financiers, indiquons quels versements sont disponibles et combien la banque prendra pour elle-m√™me. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et d√©j√† dans les marges des marges, nous formons nos propres prix, essayant de maintenir le m√™me √©quilibre en premier lieu et de faire en sorte que nos marchandises d'entrep√¥t se vendent mieux en deuxi√®me lieu. </font><font style="vertical-align: inherit;">Il en est ainsi en r√©sum√©, mais en fait je ne pr√©tends pas expliquer en termes simples ce qui se passe l√†-bas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je peux vous dire ce qui ne se passe pas. </font><font style="vertical-align: inherit;">Malheureusement, nous ne savons pas encore comment pr√©voir la demande et prendre en compte le co√ªt de stockage des marchandises dans un entrep√¥t.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Int√©gration avec des syst√®mes tiers </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une partie importante d'un point de vue commercial, mais sans int√©r√™t d'un point de vue technique. </font><font style="vertical-align: inherit;">En r√©sum√©, je dirai que nous pouvons envoyer des donn√©es √† des syst√®mes tiers (y compris des syst√®mes incr√©mentiels, c'est-√†-dire que nous comprenons ce qui a chang√© depuis le dernier √©change) et que nous pouvons cr√©er des listes de diffusion. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les newsletters sont personnalisables, donc (et pas seulement) nous livrons nos offres aux clients grossistes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une autre fa√ßon de travailler avec les clients grossistes est le portail b2b. </font><font style="vertical-align: inherit;">Il est toujours en d√©veloppement actif, il fonctionnera litt√©ralement dans un mois.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comptes, modification de la journalisation </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une autre question sans int√©r√™t d'un point de vue technique. </font><font style="vertical-align: inherit;">Chaque utilisateur a un compte. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En bref, on peut dire ce qui suit: si ORM est utilis√©, alors il a un m√©canisme int√©gr√© de suivi des modifications. </font><font style="vertical-align: inherit;">Si vous y entrez (et dans notre cas, c'est EF Core et il y a m√™me une API l√†-bas), vous pouvez obtenir la journalisation sur pr√®s de deux lignes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour l'historique des modifications, nous avons cr√©√© une interface, et vous pouvez maintenant suivre qui a chang√© quoi dans les param√®tres syst√®me, qui a √©dit√© ou compar√© certains produits, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selon les journaux, des statistiques peuvent √™tre consid√©r√©es, ce que nous faisons. </font><font style="vertical-align: inherit;">Nous savons qui a cr√©√© ou √©dit√© combien de produits, combien de comparaisons ont √©t√© confirm√©es manuellement et combien ont √©t√© rejet√©es, vous pouvez voir chaque changement.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un peu sur la structure g√©n√©rale du syst√®me </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons une base de donn√©es pour les comptes et les √©l√©ments ind√©pendants du catalogue, une base de donn√©es pour les journaux et une base de donn√©es pour chaque r√©pertoire. Cela facilite les requ√™tes dans les r√©pertoires et l'analyse des donn√©es est plus facile, et le code est plus compr√©hensible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en passant, le syst√®me de journalisation est auto-√©crit, nous avons vraiment besoin de regrouper les journaux li√©s √† une demande ou √† une t√¢che lourde, en outre, nous avons besoin de fonctionnalit√©s de base pour les analyser. Avec les solutions cl√© en main, cela s'est av√©r√© difficile, et c'est une autre d√©pendance qui doit √™tre prise en charge. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'interface Web est r√©alis√©e sur ASP.NET Core et bootstrap, et les op√©rations lourdes sont effectu√©es par le service Windows.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une autre caract√©ristique qui a profit√© au projet, √† mon avis, est diff√©rents mod√®les de lecture et d'√©criture de donn√©es. Nous n'avons pas mis en ≈ìuvre le CQRS √† part enti√®re, mais nous avons pris l'un des concepts √† partir de l√†. Nous √©crivons dans la base de donn√©es via les r√©f√©rentiels, mais les objets utilis√©s pour l'enregistrement ne quittent jamais les m√©thodes de mise √† jour / cr√©ation / suppression. La mise √† jour en masse se fait via BULK COPY. Un mod√®le et une couche d'acc√®s aux donn√©es distincts ont √©t√© cr√©√©s pour la lecture, nous ne lisons donc que ce dont nous avons besoin √† un moment particulier. Il s'est av√©r√© que vous pouvez utiliser ORM, et en m√™me temps √©viter les requ√™tes lourdes, l'acc√®s √† la base de donn√©es √† des moments incertains (comme avec le chargement paresseux), les probl√®mes N + 1. Et nous utilisons √©galement le mod√®le pour la lecture en tant que DTO.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parmi les principales d√©pendances, nous avons ASP.NET Core, plusieurs packages de nuget tiers et MS SQL Server. </font><font style="vertical-align: inherit;">Bien que cela soit possible, nous essayons de ne pas d√©pendre de nombreux syst√®mes tiers. </font><font style="vertical-align: inherit;">Afin de d√©ployer compl√®tement le projet localement, installez simplement SQL Server, r√©cup√©rez le code source du syst√®me de contr√¥le de version et g√©n√©rez le projet. </font><font style="vertical-align: inherit;">Les bases de donn√©es n√©cessaires seront cr√©√©es automatiquement, mais rien d'autre n'est n√©cessaire. </font><font style="vertical-align: inherit;">Vous devrez peut-√™tre modifier une ou deux lignes dans la configuration.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ce qui n'a pas </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous n'avons pas encore r√©alis√© de syst√®me de connaissance de projet. </font><font style="vertical-align: inherit;">Nous voulons faire des wikis et des conseils en place. </font><font style="vertical-align: inherit;">Ils n'ont pas fait une simple interface intuitive, celle qui n'est pas mauvaise, mais un peu confuse pour une personne non pr√©par√©e. </font><font style="vertical-align: inherit;">CI / CD jusqu'√† pr√©sent uniquement dans les plans. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'a pas trait√© les caract√©ristiques d√©taill√©es des marchandises. </font><font style="vertical-align: inherit;">Nous pr√©voyons √©galement, mais il n'y a pas encore de date limite pr√©cise.</font></font><br><br><img src="https://habrastorage.org/webt/dm/9t/jo/dm9tjobx0gdp9te5pb_uatrndli.jpeg" alt="image"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©sum√© de l'activit√© </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Du d√©but du d√©veloppement actif jusqu'au lancement en production, deux personnes ont travaill√© sur le projet pendant 7 mois. Au d√©but, nous avions fait fabriquer un prototype pendant notre temps libre. L'int√©gration la plus difficile a √©t√© donn√©e aux syst√®mes existants. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pendant les trois mois o√π nous sommes en production, le nombre de marchandises disponibles pour les clients grossistes est pass√© de 70 000 √† 230 000, le nombre de marchandises sur le site - de 60 000 √† 140 000. Le site est toujours en retard car il a besoin de fonctionnalit√©s, d'images, de descriptions de produits. Nous d√©chargeons 106 000 offres sur l'agr√©gateur au lieu de 40 000 il y a trois mois. Le nombre de personnes travaillant avec le catalogue n'a pas chang√©.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous travaillons avec 425 fournisseurs, ce nombre a presque doubl√© en trois mois. Nous suivons les prix de plus d'un millier de concurrents. Eh bien, pendant que nous le suivons - nous avons un syst√®me d'analyse, mais dans la plupart des cas, nous prenons des donn√©es toutes faites de ceux qui les fournissent r√©guli√®rement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malheureusement, je ne peux pas vous parler des ventes, je ne dispose pas moi-m√™me de donn√©es fiables. La demande est saisonni√®re et il est impossible de comparer directement le mois au mois pr√©c√©dent. Et en un an, trop de choses se sont pass√©es pour mettre en √©vidence l'influence de notre syst√®me de tous les facteurs. Une croissance du catalogue tr√®s, tr√®s conditionnelle, plus ou moins un kilom√®tre, des prix plus flexibles et comp√©titifs et la croissance des ventes associ√©e ont d√©j√† pay√© le d√©veloppement et la mise en ≈ìuvre.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autre r√©sultat - nous avons obtenu un projet qui n'est essentiellement pas li√© √† l'infrastructure d'un magasin particulier, et vous pouvez en faire un service public. Il a √©t√© con√ßu d√®s le d√©but et ce plan a presque fonctionn√©. Malheureusement, la solution en bo√Æte a √©chou√©. Pour offrir un projet en tant que service o√π vous pouvez vous inscrire, cochez la case ¬´J'accepte¬ª, et qui fonctionne ¬´tel quel¬ª, sans s'adapter au client, vous devez repenser l'interface, ajouter de la flexibilit√© et cr√©er un wiki. Et pour rendre l'infrastructure facilement √©volutive et √©liminer un seul point de d√©faillance. Maintenant, nous n'avons que des sauvegardes r√©guli√®res pour garantir la fiabilit√©. En tant que solution d'entreprise, je pense que nous sommes pr√™ts √† r√©soudre les probl√®mes commerciaux. La petite entreprise est de trouver une entreprise.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soit dit en passant, nous avons d√©j√† attir√© un client tiers, disposant des fonctionnalit√©s les plus √©l√©mentaires. </font><font style="vertical-align: inherit;">Les gars avaient besoin d'un outil pour comparer les marchandises, et les inconv√©nients associ√©s au d√©veloppement actif ne les effrayaient pas.</font></font><br><br><img src="https://habrastorage.org/webt/z7/7-/uo/z77-uo8184l_r3fbdrginrvtyik.png" alt="image"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456604/">https://habr.com/ru/post/fr456604/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456588/index.html">√âtudier l'injection de d√©pendance</a></li>
<li><a href="../fr456592/index.html">Les distorsions cognitives dans le d√©veloppement des ¬´temps¬ª de la langue anglaise, ou Qui interf√®re avec nous nous aidera</a></li>
<li><a href="../fr456596/index.html">Microbiota. Comment fonctionne le test?</a></li>
<li><a href="../fr456600/index.html">Recettes Nginx: autorisation LDAP avec captcha</a></li>
<li><a href="../fr456602/index.html">Guide de mise en ≈ìuvre des abonnements auto-renouvelables dans les applications iOS</a></li>
<li><a href="../fr456606/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 464 (04/04/2019 - 06/10/2019)</a></li>
<li><a href="../fr456608/index.html">Southbridge √† Chelyabinsk et Bitrix √† Kubernetes</a></li>
<li><a href="../fr456610/index.html">N'appuyez pas et n'approuvez pas</a></li>
<li><a href="../fr456612/index.html">L'une des centaines de fa√ßons de publier plusieurs projets de production sur un seul serveur</a></li>
<li><a href="../fr456614/index.html">How A Plague Tale: Innocence Frame Renders</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>