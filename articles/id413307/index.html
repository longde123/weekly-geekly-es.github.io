<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🤝‍👨🏼 🚵🏾 ❕ ESET menemukan bankir BackSwap menggunakan metode manipulasi browser baru 👩🏼‍🚒 🤰🏽 🙏🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Trojans Perbankan dalam beberapa tahun terakhir telah kehilangan popularitas di kalangan penjahat cyber. Salah satu alasannya adalah pengembangan tekn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESET menemukan bankir BackSwap menggunakan metode manipulasi browser baru</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/413307/"> Trojans Perbankan dalam beberapa tahun terakhir telah kehilangan popularitas di kalangan penjahat cyber.  Salah satu alasannya adalah pengembangan teknologi perlindungan untuk vendor antivirus dan pengembang browser web.  Sulit untuk melakukan serangan dengan bantuan seorang bankir, itulah sebabnya banyak penulis virus beralih ke alat yang lebih sederhana dan lebih menguntungkan: enkripsi, penambang, dan perangkat lunak untuk mencuri mata uang digital. <br><br>  Banyak, tetapi tidak semua.  Kami telah menemukan keluarga bankir baru menggunakan teknik baru untuk memanipulasi browser.  Alih-alih secara rumit memasukkan kode ke dalam proses browser untuk memantau aktivitasnya, malware menangkap peristiwa Windows dalam siklus tunggu pesan untuk memeriksa nilai-nilai objek yang terkait dengan operasi perbankan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tt/a8/ap/tta8apossnqrthcj3zzu208kur8.jpeg"></div><br>  Setelah ditemukan bekerja dengan perbankan online, malware menyuntikkan JavaScript jahat ke halaman web - melalui konsol pengembang di browser, atau langsung ke bilah alamat.  Operasi dilakukan tanpa sepengetahuan dan partisipasi pengguna.  Sekilas, skema sederhana memungkinkan Anda memintas mekanisme canggih untuk melindungi browser dari serangan kompleks. <br><br><a name="habracut"></a><h3>  Pendahuluan </h3><br>  Kami pertama kali memperhatikan cybergroup ini pada Januari 2018, ketika ia membagikan perkembangan awal - misalnya, sebuah program untuk mencuri mata uang kripto dengan mengubah alamat dompet di clipboard.  Grup ini terlibat dalam cryptocurrency selama beberapa bulan, setelah itu merilis versi pertama bankir - mulai 13 Maret, produk antivirus ESET akan mendeteksinya sebagai Win32 / BackSwap.A. <br><br>  Pada grafik di bawah ini, Anda dapat melihat lonjakan tajam dalam pendeteksian dibandingkan dengan proyek sebelumnya, menurut statistik kami.  Penulis meningkatkan bankir dan merilis versi baru hampir setiap hari (dengan istirahat untuk akhir pekan). <br><img src="https://habrastorage.org/webt/2o/m5/bt/2om5btzr06r004jfujqpqlw7bqu.png"><br>  <i>Gambar 1. Temukan Win32 / BackSwap.A dan proyek-proyek sebelumnya yang terkait</i> <br><br><h3>  Distribusi dan eksekusi </h3><br>  Win32 / BackSwap.A didistribusikan dalam email spam yang berisi pemuat JavaScript yang dikaburkan dari keluarga Nemucod dalam lampiran.  Saat ini, buletin ini ditargetkan untuk pengguna dari Polandia. <br><br>  Kami sering menemukan pada mesin korban <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lain</a> Win32 / TrojanDownloader.Nymaim bootloader terkenal, mungkin menyebar dengan cara yang sama.  Saat ini, kami tidak tahu apakah kebetulan atau keluarga ini saling terkait. <br><br>  Muatan dikirim sebagai versi modifikasi dari aplikasi yang sah, sebagian ditulis ulang oleh komponen jahat.  Aplikasi yang digunakan untuk perubahan modifikasi secara teratur - kami mengamati TPVCGateway, SQLMon, DbgView, WinRAR Uninstaller, 7Zip, OllyDbg, dan FileZilla Server dalam kualitas ini. <br><br>  Aplikasi ini dimodifikasi sedemikian rupa sehingga beralih ke kode berbahaya setelah inisialisasi.  Untuk melakukan ini, penulis menambahkan pointer ke komponen berbahaya dalam tabel fungsi <code>_initterm()</code> , bagian dalam runtime library C, yang menginisialisasi variabel global dan bagian lain dari program sebelum memanggil fungsi main (). <br><br><img src="https://habrastorage.org/webt/dh/by/ew/dhbyewz8xxhig_uyb8hg7hghk04.png"><br>  <i>Gambar 2. Array pointer _initterm dari aplikasi yang sah, di mana ditambahkan pointer ke bankcode shellcode</i> <br><br>  Metode ini menyerupai trojanisasi;  perbedaannya adalah bahwa dalam kasus kami aplikasi asli berhenti berfungsi setelah menginisialisasi malvari.  Tujuan dari metode ini tidak menutupi dari pengguna, tetapi lebih menangkal deteksi dan penelitian.  Analis merasa lebih sulit untuk mendeteksi bankir ini, karena banyak alat teknik terbalik, seperti IDA Pro, menunjukkan fungsi main () asli sebagai permulaan yang sah dari kode aplikasi.  Bukan fakta bahwa analis pada pandangan pertama akan melihat sesuatu yang mencurigakan. <br><br>  Payload adalah objek kode biner posisi-independen dengan data tertanam.  String karakter disimpan dalam teks biasa, yang memungkinkan Anda untuk mengganti jejak yang sudah halus, karena semua API Windows yang diperlukan dicari dengan hashing.  Pada awal pekerjaan, malware menyediakan ketekunan dengan menyalin sendiri ke folder startup, setelah itu ia beralih ke fungsi bankir. <br><br><h3>  Metode injeksi tradisional </h3><br>  Seorang bankir biasa yang mencuri dana dari akun korban melalui antarmuka perbankan online memperkenalkan dirinya atau modul khusus ke dalam ruang alamat dari proses browser.  Untuk sejumlah alasan, ini bukanlah tugas yang mudah.  Pertama-tama, injeksi dapat dicegat oleh produk antivirus.  Selain itu, kedalaman bit dari modul yang diterapkan harus bertepatan dengan kedalaman bit browser - modul 32-bit tidak boleh tertanam dalam proses 64-bit dan sebaliknya.  Akibatnya, serangan memerlukan dua versi modul yang sama - 32- / 64-bit. <br><br>  Setelah injeksi berhasil, modul perbankan harus mendeteksi fungsi yang terkait dengan browser dan mencegatnya.  Dia membutuhkan fungsi yang bertanggung jawab untuk mengirim dan menerima permintaan HTTP dalam format teks biasa sebelum enkripsi dan setelah dekripsi, masing-masing.  Kompleksitas menemukan fitur bervariasi dari browser ke browser.  Di Mozilla Firefox, mereka diekspor oleh perpustakaan nss3.dll, dan alamat mereka mudah ditemukan dengan nama terkenal mereka.  Google Chrome dan browser berbasis Chromium lainnya menyembunyikan fitur ini.  Ini memaksa penulis virus untuk membuat skema khusus yang ditujukan untuk versi browser tertentu dan mengubah taktik ketika versi baru dirilis. <br><br>  Jika fungsi ditemukan dan intersepsi dibuat (dan solusi antivirus tidak mendeteksi itu), bankir dapat mengubah lalu lintas HTTP atau mengarahkan korban ke situs yang mensimulasikan sumber daya perbankan online yang sah, memalsukan sertifikat.  Metode serupa digunakan oleh Trojans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dridex</a> perbankan terkenal, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ursnif, Zbot, Trickbot, Qbot</a> dan banyak lainnya. <br><br><h3>  Metode manipulasi browser baru </h3><br>  Win32 / BackSwap.A mengimplementasikan pendekatan yang sama sekali berbeda.  Bunker menggunakan elemen shell grafis Windows dan meniru input pengguna.  Metode ini mungkin tampak sepele, tetapi efektif karena memungkinkan Anda untuk memecahkan masalah injeksi tradisional yang diketahui.  Pertama, malware tidak berinteraksi dengan browser di tingkat proses.  Berkat ini, tidak perlu hak istimewa khusus dan melewati antivirus yang melindungi terhadap injeksi konvensional.  Keuntungan kedua bagi penyerang adalah bahwa bankir tidak bergantung pada arsitektur browser atau versinya;  Satu kode berfungsi untuk semua orang. <br><br>  Malware melacak URL halaman yang dikunjungi dengan menyetel kait acara untuk serangkaian peristiwa relevan tertentu yang tersedia melalui loop tunggu pesan Windows, seperti EVENT_OBJECT_FOCUS, EVENT_OBJECT_SELECTION, EVENT_OBJECT_NAMECHANGE dan beberapa lainnya.  Pawang mencari nilai URL dengan mencari objek string yang dimulai dengan HTTP yang diperoleh dengan memanggil metode <code>get_accValue</code> dari antarmuka peristiwa <code>IAccessible</code> . <br><br><img src="https://habrastorage.org/webt/kn/ig/xa/knigxazoteqnbwtvih3ytf5p7t0.png"><br>  <i>Gambar 3. Penerimaan yang digunakan untuk mendapatkan URL halaman saat ini di browser.</i>  <i>Alamat-alamat ini diperoleh dengan memeriksa substring [ht] tp [s] (disorot dengan warna merah)</i> <br><br>  Kemudian Win32 / BackSwap. Mencari alamat yang terkait dengan bank dan header jendela browser yang menunjukkan bahwa pengguna sedang mempersiapkan transfer uang. <br><br><img src="https://habrastorage.org/webt/y5/hq/on/y5hqonykzenyxfnjubhtdp7dwh4.png"><br>  <i>Gambar 4. Bankir mencari garis kode yang terkait dengan bank tertentu.</i>  <i>Baris pertama adalah judul jendela, yang kedua adalah bagian URL</i> <br><br>  Setelah menemukan yang diinginkan, bankir mengunduh JavaScript jahat yang sesuai dengan bank tertentu dan menyuntikkannya ke browser.  Injeksi dilakukan dengan cara yang sederhana namun efektif. <br><br>  Dalam sampel yang lebih lama, Win32 / BackSwap.A menyisipkan skrip berbahaya ke clipboard dan mensimulasikan keystroke untuk membuka konsol pengembang (CTRL + SHIFT + J di Google Chrome, CTRL + SHIFT + K di Mozilla Firefox), lalu tempelkan konten buffer (CTRL + V) dan tekan ENTER untuk menjalankan konten konsol.  Malware kemudian mengulangi kombinasi tombol untuk menutup konsol.  Pada saat ini, jendela peramban menjadi tidak terlihat - pengguna biasa kemungkinan besar akan berpikir bahwa peramban akan membeku selama beberapa detik. <br><br>  Dalam versi baru, sirkuit ditingkatkan.  Alih-alih berinteraksi dengan konsol pengembang, skrip berbahaya dieksekusi langsung dari bilah alamat melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">protokol JavaScript khusus</a> , fungsi yang kurang dimanfaatkan yang didukung sebagian besar browser.  Bankir meniru menekan CTRL + L untuk memilih bilah alamat, HAPUS untuk menghapus bidang, "memasukkan" karakter dalam "javascript" melalui panggilan ke SendMessageA dalam satu lingkaran, dan kemudian menyisipkan skrip berbahaya menggunakan kombinasi CTRL + V.  Script dieksekusi setelah "menekan" ENTER.  Di akhir proses, bilah alamat dihapus untuk menghapus jejak kompromi. <br><br>  Pada Gambar 5, Anda dapat melihat bagian dari kode yang disuntikkan di konsol.  Pertama, Win32 / BackSwap.A mendefinisikan browser dengan memeriksa nama kelas dari jendela yang dipilih (ditandai dengan warna biru).  JavaScript berbahaya disalin ke buffer (ditandai dengan warna merah).  Kemudian nilai transparansi jendela browser diubah menjadi "3", yang membuatnya tidak terlihat (ditandai dengan warna ungu).  Bagian yang terkait dengan fungsi <code>ToggleBrowserConsole</code> , yang menghidupkan dan mematikan konsol, <code>ToggleBrowserConsole</code> . <br><br><img src="https://habrastorage.org/webt/j2/5n/ro/j25nrotyjbfbbr0f517jfadihjo.png"><br>  <i>Gambar 5. Injeksi Skrip</i> <br><br>  Win32 / BackSwap. Mendukung serangan pada Google Chrome dan Mozilla Firefox, dukungan Internet Explorer telah ditambahkan dalam versi terbaru.  Metode ini cocok untuk sebagian besar browser dengan konsol pengembang atau kemampuan untuk mengeksekusi kode JavaScript dari bilah alamat (fungsi browser standar). <br><br>  Tiga browser yang disusupi memiliki <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fitur keamanan</a> menarik yang dirancang untuk mencegah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">serangan Self-XSS</a> : ketika pengguna mencoba menempelkan teks yang disalin mulai dengan "javascript:" ke bilah alamat, awalan protokol dihapus dan harus secara manual dimasukkan lagi untuk menjalankan skrip.  Win32 / BackSwap.A melewati rintangan ini dengan mensimulasikan input karakter awalan di bilah alamat sebelum menempelkan skrip berbahaya yang disalin. <br><br>  Alat keamanan lain diterapkan di Mozilla Firefox.  Peramban secara default melarang penyalinan skrip ke konsol;  alih-alih, ini menampilkan pemberitahuan tentang kemungkinan risiko dan memaksa pengguna untuk terlebih dahulu memasukkan frasa “izinkan tempel” untuk memungkinkan penyisipan karakter yang disalin.  Untuk memintas langkah keamanan ini, Win32 / BackSwap.A menyediakan untuk eksekusi perintah shell (Gambar 6), yang membuat perubahan pada <code>prefs.js</code> konfigurasi <code>prefs.js</code> dan menghapus perlindungan ini. <br><br><img src="https://habrastorage.org/webt/1t/xb/cn/1txbcnnebubsm5ss93tmdgdugqu.png"><br>  <i>Gambar 6. Perintah shell yang menghilangkan perlindungan dari memasukkan skrip ke konsol Firefox</i> <br><br><h3>  Kode berbahaya JavaScript </h3><br>  Win32 / BackSwap.A menggunakan skrip khusus untuk masing-masing bank target.  Karena semua bank memiliki situs yang berbeda, kodenya berbeda dan memiliki variabel yang berbeda.  Naskah disuntikkan ke halaman di mana, menurut bankir, persiapan transfer uang dilakukan.  Script yang diimplementasikan diam-diam mengganti nomor akun penerima dengan yang lain, dan ketika korban mengirim transfer, uang akan masuk ke akun penyerang.  Penanggulangan terhadap transfer yang tidak sah (otentikasi dua faktor) tidak berdaya, karena pemegang akun mengonfirmasi pengiriman dana. <br><br>  Para penulis Win32 / BackSwap.A menulis skrip untuk bekerja dengan lima bank Polandia: PKO Bank Polski, Bank Zachodni WBK SA, mBank, ING, dan Pekao.  Operator menghapus beberapa bank dari daftar sasaran - di sebagian besar versi baru ada tiga bank yang tersisa: PKO BP, mBank dan ING.  Dalam versi yang lebih lama, penyerang mengirim nomor akun penerima dari server C&amp;C di situs WordPress yang diretas.  Dalam versi baru, angka-angka itu sendiri disimpan dalam skrip berbahaya  Akun sering berubah - nomor akun baru digunakan di hampir setiap kampanye baru. <br><br>  Bankir tertarik pada transfer dalam kisaran tertentu - biasanya dari 10.000 hingga 20.000 zlotys Polandia (168.000–337.000 rubel).  Skrip tidak hanya menggantikan nomor akun penerima, tetapi juga mengganti bidang input dengan yang palsu - pengguna melihat nomor yang benar dan tidak mencurigai apa pun. <br><br><img src="https://habrastorage.org/webt/ch/c_/c3/chc_c3eos--kxjcany8nd6hhj6a.png"><br>  <i>Gambar 7. Bagian dari kode JavaScript berbahaya.</i>  <i>Situs yang ditandai dengan warna merah bertanggung jawab untuk memeriksa jumlah transfer dan mengganti nomor akun penerima</i> <br><br><h3>  Kesimpulan </h3><br>  Win32 / BackSwap.A membuktikan bahwa konfrontasi antara industri keamanan dan penulis virus tidak selalu memerlukan teknik dan taktik canggih yang baru.  Browser meningkatkan perlindungan terhadap injeksi kode, sehingga penulis malware beralih ke metode serangan lainnya, dan hanya satu yang diterapkan di Win32 / BackSwap.A. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Produk</a> antivirus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ESET</a> mendeteksi ancaman seperti Win32 / BackSwap.A. <br><br>  Spesialis ESET memberi tahu pengembang tentang browser yang dikompromikan tentang metode serangan baru. <br><br><h3>  IoCs </h3><br> <code>9BC4C1D5403DDD90712CE87225490A21D1EDC516 JS/Nemucod.EAN trojan <br> CF5A74C268661501156663F74CD5E20603B0F261 Win32/BackSwap.A trojan <br> 6251F9AD0E5F551AC4A6B918EF366E86C4CCFDC4 Win32/BackSwap.A trojan <br> 2DC9760A7C6E9D261C73EFB7B2604840734BC058 Win32/BackSwap.A trojan <br> A68901D0D8C1247FF280F9453E3AE45687C57566 Win32/BackSwap.A trojan (JavaScript)</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id413307/">https://habr.com/ru/post/id413307/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id413291/index.html">Buku "Deep Learning in Python"</a></li>
<li><a href="../id413293/index.html">Eksodus hebat dari industri video game</a></li>
<li><a href="../id413297/index.html">Font web variabel</a></li>
<li><a href="../id413303/index.html">Kisah Masalah: Memoizer JavaScript Terpendek</a></li>
<li><a href="../id413305/index.html">Baterai, Gigafactory, Northvolt, dan Siemens. Orang Luar T</a></li>
<li><a href="../id413309/index.html">Sisi gelap lincah</a></li>
<li><a href="../id413311/index.html">Porting aplikasi web Anda dari JavaScript murni ke Vue.js</a></li>
<li><a href="../id413315/index.html">Sistem iklim di apartemen dengan tangan Anda sendiri - bagian 2</a></li>
<li><a href="../id413317/index.html">Siapa yang mengajar siapa? Perbedaan antara kata kerja mengajar, belajar dan belajar</a></li>
<li><a href="../id413319/index.html">RIT ++ 2018. Moskow, Skolkovo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>