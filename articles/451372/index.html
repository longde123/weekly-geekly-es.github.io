<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>   Mejoras de diagn贸stico en .NET Core 3.0   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En .NET Core 3.0, presentamos un conjunto de herramientas que aprovechan las nuevas caracter铆sticas del entorno de tiempo de ejecuci贸n .NET que simpli...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mejoras de diagn贸stico en .NET Core 3.0</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451372/">  En .NET Core 3.0, presentamos un conjunto de herramientas que aprovechan las nuevas caracter铆sticas del entorno de tiempo de ejecuci贸n .NET que simplifican el diagn贸stico y la resoluci贸n de problemas de rendimiento. <br><br>  Estas caracter铆sticas lo ayudar谩n a responder algunas preguntas de diagn贸stico comunes que pueda tener: <br><br><ol><li>  驴Mi aplicaci贸n est谩 operativa? </li><li>  驴Por qu茅 mi aplicaci贸n tiene un comportamiento anormal? </li><li>  驴Por qu茅 se bloquea mi aplicaci贸n? </li></ol><br><img src="https://habrastorage.org/webt/yp/ro/hb/yprohbmrpvd1jnemcll_ywlp1ti.png"><br><a name="habracut"></a><br><h2>  驴Mi aplicaci贸n est谩 operativa? </h2><br>  Con el tiempo, puede producirse una p茅rdida de memoria en la aplicaci贸n, que finalmente conduce a una excepci贸n OutOfMemoryException.  En otros casos, un c贸digo problem谩tico puede provocar un salto en la carga del procesador.  Estos son solo algunos de los problemas que puede identificar activamente con las <b>m茅tricas</b> . <br><br><h3>  M茅tricas </h3><br>  Las m茅tricas son datos de medici贸n durante un per铆odo de tiempo.  Estas m茅tricas le permiten monitorear el estado de su sistema a un alto nivel.  A diferencia de .NET Framework en Windows, .NET Core no genera contadores de rendimiento.  En su lugar, presentamos una nueva forma de generar m茅tricas en .NET Core a trav茅s de la API <a href="">EventCounter</a> . <br><br>  EventCounters ofrece una mejora sobre los contadores de rendimiento de Windows, ya que ahora se utilizan en todos los sistemas operativos que admiten .NET Core.  Adem谩s, a diferencia de los contadores de rendimiento, tambi茅n se pueden usar en entornos de bajos privilegios (por ejemplo, al implementar xcopy).  Desafortunadamente, la falta de una herramienta como el Monitor de rendimiento (perfmon) dificulta la visualizaci贸n de estos indicadores en tiempo real. <br><br>  <b>contadores dotnet</b> <br>  En 3.0-preview5, presentamos una nueva herramienta de l铆nea de comandos para monitorear las m茅tricas generadas por las aplicaciones .NET Core en tiempo real. <br><br>  Puede instalar esta herramienta ejecutando el siguiente comando <br><br><pre><code class="bash hljs">dotnet tool install --global dotnet-counters --version 1.0.3-preview5.19251.2</code> </pre> <br>  En el siguiente ejemplo, vemos que la carga de CPU y la memoria de nuestra aplicaci贸n aumentan cuando comenzamos a cargar en nuestra aplicaci贸n web. <br><br><img src="https://habrastorage.org/webt/lp/oe/xy/lpoexyq5fbqc9psloyvfbdrae54.gif"><br><br>  Para obtener instrucciones detalladas sobre c贸mo usar esta herramienta, consulte el <a href="">archivo L茅ame en el proyecto con dotnet-counters</a> .  Para conocer las limitaciones conocidas de los contadores dotnet, observe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">los problemas abiertos en GitHub</a> . <br><br><h2>  驴Por qu茅 mi aplicaci贸n tiene un comportamiento anormal? </h2><br>  Si bien las m茅tricas ayudan a identificar la aparici贸n de un comportamiento anormal, ofrecen poca comprensi贸n de lo que sali贸 mal.  Para responder a la pregunta de por qu茅 su aplicaci贸n tiene un comportamiento anormal, debe recopilar informaci贸n adicional a trav茅s de rastreos.  Por ejemplo, los perfiles de CPU recopilados mediante trazas pueden ayudarlo a determinar la ruta activa en su c贸digo. <br><br><h3>  Traza </h3><br>  Los rastreos son registros de eventos discretos con fecha y hora fijos.  Las trazas contienen un contexto local que le permite determinar mejor el destino del sistema.  Tradicionalmente, .NET Framework (y marcos como ASP.NET) generaban rastros de diagn贸stico sobre sus componentes internos mediante Event Tracing for Windows (ETW).  En .NET Core, estos rastros se registraron en ETW para Windows y LTTng para Linux. <br><br>  <b>dotnet-trace</b> <br><br>  En la versi贸n 3.0-preview5, cada aplicaci贸n .NET Core abre un canal d煤plex llamado EventPipe (un socket de dominio Unix en * nix o una canalizaci贸n con nombre en Windows) a trav茅s del cual puede enviar eventos.  Mientras todav铆a estamos trabajando en el protocolo del controlador, dotnet-trace implementa una versi贸n preliminar de este protocolo. <br><br>  Puede instalar esta herramienta ejecutando el siguiente comando <br><br><pre> <code class="bash hljs">dotnet tool install --global dotnet-trace--version 1.0.3-preview5.19251.2</code> </pre> <br><img src="https://habrastorage.org/webt/vn/ae/t6/vnaet6y9j8n-asiepjkgetqk5ac.gif"><br><br>  En el ejemplo anterior, ejecuto un seguimiento de dotnet con un perfil predeterminado que incluye eventos de perfil de CPU y eventos de tiempo de ejecuci贸n .NET. <br><br>  Adem谩s de los eventos predeterminados, puede habilitar <a href="">proveedores adicionales en</a> funci贸n del estudio que est谩 intentando realizar. <br><br>  Como resultado de ejecutar dotnet trace, obtienes un archivo .netperf.  Este archivo contiene eventos de recuperaci贸n de pila de CPU y tiempo de ejecuci贸n que se pueden visualizar en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">perfview</a> .  La pr贸xima actualizaci贸n de Visual Studio (16.1) tambi茅n agregar谩 soporte para visualizar estos rastros. <br><br><img src="https://habrastorage.org/webt/jl/p0/aq/jlp0aqplvgxj8zmdrpu77zzce3i.png"><br><br>  Si est谩 ejecutando OS X o Linux, puede convertir archivos .netperf a archivos .speedscope.json que se pueden representar con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Veloccope.app</a> al grabar trazas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">.</a> <br>  Puede convertir una traza existente ejecutando el siguiente comando: <br><br><pre> <code class="bash hljs">dotnet trace convert &lt;input-netperf-file&gt;</code> </pre> <br>  La imagen a continuaci贸n muestra un diagrama que visualiza el rastro que acabamos de recibir. <br><br><img src="https://habrastorage.org/webt/lr/zf/ty/lrzftyv06lfg9kged2gqjy-_3-c.png"><br><br>  Para obtener instrucciones detalladas sobre c贸mo usar esta herramienta, consulte el <a href="">archivo L茅ame</a> .  Para conocer las limitaciones conocidas de dotnet-trace, observe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">los problemas abiertos en GitHub</a> . <br><br><h2>  驴Por qu茅 se bloquea mi aplicaci贸n? </h2><br>  En algunos casos, no es posible establecer la causa del comportamiento anormal simplemente monitoreando el proceso.  En el caso de una falla del proceso o situaciones en las que necesitemos informaci贸n adicional, como el acceso a todo el mont贸n del proceso, un volcado del proceso puede ser m谩s adecuado para el an谩lisis. <br><br><h3>  An谩lisis de volcado </h3><br>  Un volcado es un registro del estado de la memoria virtual de trabajo de un proceso, generalmente capturado cuando finaliz贸 inesperadamente.  Los diagn贸sticos de volcado del kernel se usan com煤nmente para identificar las causas de los bloqueos de la aplicaci贸n o el comportamiento inesperado. <br><br>  Tradicionalmente, confiaba en su sistema operativo para recibir un volcado cuando una aplicaci贸n se bloqueaba (por ejemplo, informes de error de Windows) o utilizaba una herramienta como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">procdump</a> para capturar un volcado cuando se cumpl铆an ciertos criterios de inicio. <br><br>  Hasta ahora, el problema con el volcado de volcado usando .NET en Linux ha sido que el volcado de volcado usando gcore o el depurador ha llevado a volcados muy grandes, porque las herramientas existentes no sab铆an qu茅 p谩ginas de memoria virtual recortar en el proceso .NET Core. <br><br>  Adem谩s, fue dif铆cil analizar estos volcados incluso despu茅s de haberlos recopilado, porque ten铆a que comprar un depurador y configurarlo para cargar sos, una extensi贸n del depurador para .NET. <br><br>  <b>dotnet-dump</b> <br><br>  En 3.0.0-preview5, presentamos una nueva herramienta que le permite recopilar y analizar volcados de procesos tanto en Windows como en Linux. <br><br>  dotnet-dump todav铆a est谩 en desarrollo activo, y la tabla a continuaci贸n muestra qu茅 caracter铆sticas son compatibles actualmente en qu茅 sistemas operativos. <br><br><img src="https://habrastorage.org/webt/mq/fc/1s/mqfc1sd9rec8zrlunrbguwonh9a.png"><br><br>  Puede instalar esta herramienta ejecutando el siguiente comando <br><br><pre> <code class="bash hljs">dotnet tool install --global dotnet-dump --version 1.0.3-preview5.19251.2</code> </pre> <br>  Despu茅s de haber instalado dotnet-dump, puede capturar el volcado del proceso ejecutando el siguiente comando <br><br><pre> <code class="bash hljs">sudo <span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.dotnet/tools/dotnet-dump collect -p &lt;pid&gt;</code> </pre> <br>  En Linux, el volcado resultante se puede analizar cargando el volcado resultante con el siguiente comando <br><br><pre> <code class="bash hljs">dotnet dump analyze &lt;dump-name&gt;</code> </pre> <br>  En el siguiente ejemplo, estoy tratando de definir un volcado de ASP.NET Core Hosting Environment <br><br><img src="https://habrastorage.org/webt/6p/kb/c6/6pkbc6a904l_4b9rubkjirsrybq.gif"><br><br>  Para obtener instrucciones detalladas sobre c贸mo usar esta herramienta, consulte el <a href="">archivo L茅ame.</a>  Para conocer las limitaciones conocidas con dotnet-dump, observe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">los problemas abiertos en GitHub</a> . <br><br><h2>  Conclusi贸n </h2><br>  Gracias por probar las nuevas herramientas de diagn贸stico en .NET Core 3.0.  Contin煤a envi谩ndonos comentarios, ya sea en los comentarios o en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GitHub</a> .  Escuchamos atentamente y haremos cambios basados en sus comentarios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451372/">https://habr.com/ru/post/451372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451356/index.html">C贸mo funciona la compresi贸n en una arquitectura de memoria orientada a objetos</a></li>
<li><a href="../451358/index.html">Par谩metros impl铆citos y conversiones en Scala</a></li>
<li><a href="../451360/index.html">Amenazas de SMS ocultas: el operador de telefon铆a m贸vil sabe demasiado</a></li>
<li><a href="../451366/index.html">Escribe menos c贸digo</a></li>
<li><a href="../451370/index.html">SaaS vs on-premise, mitos y realidad. Dejar de holivarit</a></li>
<li><a href="../451378/index.html">Likbez de memoria: lo que sucede y lo que nos da</a></li>
<li><a href="../451380/index.html">Tuve una visi贸n ... Revelaciones del nuevo Nostradamus</a></li>
<li><a href="../451382/index.html">Dos en uno: Intel Optane Memory H10 (Parte 1)</a></li>
<li><a href="../451384/index.html">Parte 5. Programador de carrera. Medio La crisis Primer lanzamiento</a></li>
<li><a href="../451386/index.html">Dos en uno: Intel Optane Memory H10 (parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>