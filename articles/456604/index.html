<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßôüèæ üë©üèº‚Äçüöí üåö C√≥mo automatizamos una gran tienda en l√≠nea y comenzamos a combinar productos autom√°ticamente ‚ú≥Ô∏è üéöÔ∏è üßîüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El art√≠culo es m√°s t√©cnico que sobre negocios, pero tambi√©n sacaremos algunas conclusiones desde el punto de vista de los negocios. Se prestar√° mayor ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo automatizamos una gran tienda en l√≠nea y comenzamos a combinar productos autom√°ticamente</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456604/"><img src="https://habrastorage.org/webt/vm/sf/by/vmsfbyuh4sqwgsjidvjpzleydcu.jpeg" alt="imagen"><br><br>  El art√≠culo es m√°s t√©cnico que sobre negocios, pero tambi√©n sacaremos algunas conclusiones desde el punto de vista de los negocios.  Se prestar√° mayor atenci√≥n a la comparaci√≥n autom√°tica de productos de diferentes fuentes. <br><br>  El trabajo de la tienda en l√≠nea consiste en un n√∫mero bastante grande de componentes.  Y no importa cu√°l sea el plan, para obtener ganancias en este momento, o para crecer y buscar inversores, o, por ejemplo, para desarrollar √°reas relacionadas, al menos tendr√° que cerrar estas preguntas: <br><br><ul><li>  Trabajar con proveedores.  Para vender algo innecesario, primero debe comprar algo innecesario. </li><li>  Gesti√≥n de directorios.  Alguien tiene una especializaci√≥n estrecha, mientras que alguien vende cientos de miles de productos diferentes. </li><li>  Gesti√≥n de precios minoristas.  Aqu√≠ deber√° tener en cuenta los precios de los proveedores, los precios de los competidores y los instrumentos financieros asequibles. </li><li>  Trabaja con el almac√©n.  En principio, es posible no tener su propio almac√©n, sino tomar los productos de los almacenes de los socios, pero de una forma u otra la pregunta es. </li><li>  Comercializaci√≥n  Aqu√≠ el sitio est√° lleno de contenido, ubicaci√≥n en sitios, publicidad (en l√≠nea y fuera de l√≠nea), promociones y mucho m√°s. </li><li>  Recepci√≥n y tramitaci√≥n de pedidos.  Centro de atenci√≥n telef√≥nica, canasta en el sitio, pedidos a trav√©s de mensajer√≠a instant√°nea, pedidos a trav√©s de plataformas y mercados. </li><li>  Entrega </li><li>  Contabilidad y otros sistemas internos. </li></ul><br>  La tienda, de la que hablaremos, no tiene una especializaci√≥n limitada, pero ofrece un mont√≥n de todo, desde cosm√©ticos hasta un mini tractor.  Le dir√© c√≥mo trabajamos con proveedores, monitoreando competidores, gesti√≥n de cat√°logos y precios (mayoristas y minoristas), trabajando con clientes mayoristas.  Un peque√±o toque sobre el tema del almac√©n. <br><br>  Para comprender mejor algunas de las soluciones t√©cnicas, no ser√° superfluo saber que en <br>  en alg√∫n momento decidimos que las cosas tecnol√≥gicas, si es posible, se har√≠an no por nosotros mismos, sino de manera universal.  Y, tal vez, despu√©s de varios intentos, saldr√° a desarrollar un nuevo negocio.  Resulta, condicionalmente, una startup dentro de la empresa. <br><br>  Por lo tanto, estamos considerando un sistema separado, m√°s o menos universal, con el que se integra el resto de la infraestructura de la compa√±√≠a. <br><a name="habracut"></a><br><h2>  ¬øCu√°l es el problema de trabajar con proveedores? </h2><br>  Y hay muchos de ellos, de hecho.  Solo para dar algunos: <br><br><ul><li>  Hay muchos proveedores per se.  Tenemos alrededor de 400. Todos deben tomarse un tiempo. </li><li>  No hay una √∫nica forma de obtener ofertas de los proveedores.  Alguien env√≠a al correo seg√∫n lo programado, alguien que lo solicita, alguien lo sube al alojamiento de archivos, alguien lo coloca en el sitio.  Hay muchas formas, hasta enviar el archivo a trav√©s de Skype. </li><li>  No hay un formato de datos √∫nico.  Incluso hice un dibujo sobre este tema (es m√°s bajo, las tablas simbolizan diferentes formatos). </li><li>  Existe el concepto de precios minoristas m√≠nimos y precios minoristas m√≠nimos que deben observarse para continuar trabajando con el proveedor.  A menudo se proporcionan en su propio formato. </li><li>  La nomenclatura de cada proveedor es diferente.  Como resultado, el mismo producto se llama de manera diferente y no existe una clave √∫nica por la cual puedan compararse f√°cilmente.  Por lo tanto, lo comparamos dif√≠cil. </li><li>  El sistema de realizar un pedido con el proveedor no est√° automatizado.  Hacemos pedidos de alguien en Skype, de alguien en su cuenta, a alguien a quien le enviamos un archivo exel todas las noches con una lista de pedidos. </li></ul><br><img src="https://habrastorage.org/webt/84/x_/0c/84x_0cekqji4tmiu6j8fw3470ko.png" alt="imagen"><br><br>  Hemos aprendido a hacer frente a estos problemas.  Adem√°s de esto √∫ltimo, se est√° trabajando en esto √∫ltimo.  Ahora habr√° detalles t√©cnicos, y luego considere la siguiente lista. <br><br><h2>  Recolectando datos </h2><br><h3>  Como era </h3><br>  Los archivos de proveedores se recopilaron manualmente de varias fuentes y se prepararon.  La preparaci√≥n incluy√≥ renombrar seg√∫n una plantilla espec√≠fica y editar contenido.  Dependiendo del archivo, era necesario eliminar bienes no est√°ndar, bienes que no est√°n en stock, renombrar columnas o convertir divisas, recopilar datos de diferentes pesta√±as en uno. <br><br><h3>  Como </h3><br>  En primer lugar, aprendimos a revisar el correo y recoger cartas con archivos adjuntos desde all√≠.  Luego automatizaron el trabajo con enlaces directos y enlaces a unidades Yandex y Google.  Esto resolvi√≥ el problema de recibir ofertas de aproximadamente el 75% de nuestros proveedores.  Tambi√©n notamos que es a trav√©s de estos canales que las ofertas se actualizan con mayor frecuencia, por lo que el porcentaje real de automatizaci√≥n es mayor.  Todav√≠a tenemos algunos precios en mensajeros. <br><br>  En segundo lugar, ya no procesamos archivos manualmente.  Para hacer esto, hemos ingresado perfiles de proveedores, donde puede especificar qu√© columna y pesta√±a usar, c√≥mo determinar la moneda y la disponibilidad, el tiempo de entrega y el horario de trabajo del proveedor. <br><br>  Result√≥ flexiblemente.  Naturalmente, no tomamos todo en cuenta la primera vez, pero ahora hay suficiente flexibilidad para configurar el procesamiento de los 400 proveedores, dado que todos tienen diferentes formatos de archivo. <br><br>  En cuanto a los formatos de archivo, entendemos xls, xlsx, csv, xml (yml).  En nuestro caso, esto fue suficiente. <br><br>  Tambi√©n descubrieron c√≥mo filtrar registros.  Hicimos una lista de palabras vac√≠as, y si la oferta del proveedor la contiene, entonces no la procesamos.  Los detalles t√©cnicos son los siguientes: en una lista peque√±a puede y a√∫n mejor "de frente", en listas grandes filtro Bloom m√°s r√°pido.  Experimentamos con √©l y dejamos todo como est√°, porque la ganancia se siente en la lista en un orden de magnitud mayor que el nuestro. <br><br>  Otra cosa importante es el horario de trabajo del proveedor.  Nuestros proveedores trabajan en diferentes horarios, adem√°s, est√°n ubicados en diferentes pa√≠ses, en los cuales los fines de semana no coinciden.  Y el tiempo de entrega generalmente se indica como un n√∫mero o un rango de n√∫meros en d√≠as h√°biles.  Cuando formemos los precios minoristas y mayoristas, tendremos que evaluar de alguna manera el momento en que podemos entregar los productos al cliente.  Para hacer esto, creamos calendarios configurables, y en la configuraci√≥n de cada proveedor puede especificar en qu√© calendarios funciona. <br><br>  Tuve que hacer una configuraci√≥n de descuentos y m√°rgenes seg√∫n la categor√≠a y el fabricante.  Sucede que el proveedor tiene un archivo com√∫n para todos los socios, pero existen acuerdos de descuento con algunos socios.  Gracias a esto, todav√≠a era posible agregar o restar IVA si fuera necesario. <br><br>  Por cierto, la configuraci√≥n de las reglas de descuento y marcado nos lleva al siguiente tema.  Despu√©s de todo, antes de usarlos, debe averiguar qu√© tipo de producto es. <br><br><h2>  C√≥mo funciona el mapeo </h2><br>  Un peque√±o ejemplo de c√≥mo se puede llamar al mismo producto desde diferentes proveedores, para comprender con qu√© tiene que trabajar: <br><blockquote>  Monitor LG LCD 22MP48D-P <br>  21.5 "LG 22MP48D-P Negro (16: 9, 1920x1080, IPS, 60 Hz, DVI + D-Sub (VGA)) <br>  COMP - Perif√©ricos inform√°ticos - Monitores LG 22MP48D-P <br>  Monitor LG de hasta 22 "incluido LG 22MP48D-P (21.5", negro, IPS LED 5ms 16: 9 DVI mate 250cd 1920x1080 D-Sub FHD) 22MP48D-P <br>  Monitores LG 22 "LG 22MP48D-P Negro brillante (IPS, LED, 1920x1080, 5 ms, 178 ¬∞ / 178 ¬∞, 250 cd / m, 100M: 1, + DVI) Monitor <br>  Monitores LCD Monitor LCD LG 22 "IPS 22MP48D-P LG 22MP48D-P <br>  Monitor LG 21.5 "LG 22MP48D-P gl. Negro IPS, 1920x1080, 5ms, 250 cd / m2, 1000: 1 (Mega DCR), D-Sub, DVI-D (HDCP), vesa 22MP48D-P.ARUZ <br>  Monitor LG LG 22MP48D-P Negro 22MP48D-P.ARUZ <br>  Monitor LG 22MP48D-P 22MP48D-P <br>  Monitores LG 22MP48D-P Negro brillante 22MP48D-P <br>  Monitor 21.5 "LG Flatron 22MP48D-P gl. Negro (IPS, 1920x1080, 16: 9, 178/178, 250cd / m2, 1000: 1, 5ms, D-Sub, DVI-D) (22MP48D-P) 22MP48D-P <br>  Monitor 22 "LG 22MP48D-P <br>  LG 22MP48D-P IPS DVI <br>  LG LG 21.5 "22MP48D-P IPS LED, 1920x1080, 5ms, 250cd / m2, 5Mln: 1, 178 ¬∞ / 178 ¬∞, D-Sub, DVI, Inclinaci√≥n, VESA, Negro brillante 22MP48D-P <br>  LG 21.5 "22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P <br>  Monitor 21.5 '' LG 22MP48D-P Negro <br>  LG MONITOR 21.5 "LG 22MP48D-P Negro brillante (IPS, LED, 1920x1080, 5 ms, 178 ¬∞ / 178 ¬∞, 250 cd / m, 100M: 1, + DVI) 22MP48D-P <br>  Monitor LCD LG 21.5 '' [16: 9] 1920x1080 (FHD) IPS, no GLARE, 250cd / m2, H178 ¬∞ / V178 ¬∞, 1000: 1, 16.7M Color, 5ms, VGA, DVI, Inclinaci√≥n, 2Y, Negro OK 22MP48D -P <br>  LCD LG 21.5 "22MP48D-P negro {IPS LED 1920x1080 5ms 16: 9 250cd 178 ¬∞ / 178 ¬∞ DVI D-Sub} 22MP48D-P.ARUZ <br>  IDS_Monitores LG LG 22 "LCD 22MP48D 22MP48D-P <br>  Monitor LG 21.5 "16x9 LG 21.5" 22MP48D-P negro IPS LED 5ms 16: 9 DVI mate 250cd 1920x1080 D-Sub FHD 2.7kg 22MP48D-P.ARUZ <br>  Monitor 21.5 "LG 22MP48D-P [Negro]; 5 ms; 1920x1080, DVI, IPS </blockquote><h3>  Como era </h3><br>  La comparaci√≥n incluy√≥ 1C (m√≥dulo de pago de terceros).  En cuanto a la conveniencia / velocidad / precisi√≥n, dicho sistema permiti√≥ mantener un cat√°logo con 60 mil productos disponibles en este nivel por 6 personas.  Es decir, todos los d√≠as, obsoletos y desaparecidos de las ofertas de los proveedores, se crearon tantos productos coincidentes como nuevos.  Muy aproximadamente - 0.5% del tama√±o del cat√°logo, es decir  300 productos <br><br><h3>  C√≥mo se convirti√≥: una descripci√≥n general del enfoque </h3><br>  Un poco m√°s arriba, di un ejemplo de lo que necesitamos hacer coincidir.  Al explorar el tema de la coincidencia, me sorprendi√≥ un poco que ElasticSearch sea popular para la tarea de la coincidencia, en mi opini√≥n, tiene limitaciones conceptuales.  En cuanto a nuestra pila de tecnolog√≠a, usamos MS SQL Server para el almacenamiento de datos, pero la comparaci√≥n funciona en nuestra propia infraestructura, y dado que hay muchos datos y necesitamos procesarlos r√°pidamente, usamos estructuras de datos optimizadas para una tarea espec√≠fica e intentamos no acceder al disco o la base de datos sin la necesidad y otros sistemas lentos. <br><br>  Obviamente, el problema de comparaci√≥n se puede resolver de muchas maneras, y obviamente, ninguno de ellos dar√° una precisi√≥n absoluta.  Por lo tanto, la idea principal es intentar combinar estos m√©todos, clasificarlos por precisi√≥n y velocidad y aplicarlos en orden descendente de precisi√≥n, teniendo en cuenta la velocidad. <br><br>  El plan de ejecuci√≥n para cada uno de nuestros algoritmos (con una reserva sobre casos degenerados) puede representarse brevemente mediante la siguiente secuencia general: <br><br>  Tokenizaci√≥n  Rompemos la l√≠nea de origen en partes independientes significativas.  Se puede hacer una vez y seguir utiliz√°ndose en todos los algoritmos. <br><br>  Normalizaci√≥n de tokens.  En el buen sentido, debe llevar las palabras del lenguaje natural al n√∫mero general y la declinaci√≥n, y los identificadores como "ABC15MX" (esto es cir√≠lico, si es que) deber√≠an convertirse al lat√≠n.  Y trae todo al mismo registro. <br><br>  Categorizaci√≥n de tokens.  Tratando de entender lo que significa cada parte.  Por ejemplo, puede seleccionar una categor√≠a, fabricante, color, etc. <br><br>  Busca el mejor candidato para un partido. <br><br>  Una estimaci√≥n de la probabilidad de que la l√≠nea original y el mejor candidato indiquen el mismo producto. <br><br>  Los primeros dos puntos son comunes para todos los algoritmos que est√°n disponibles actualmente, y luego comienzan las improvisaciones. <br><br>  Tokenizaci√≥n  Aqu√≠ hicimos exactamente eso, dividimos la l√≠nea en partes de acuerdo con caracteres especiales como espacio, barra diagonal, etc.  El conjunto de caracteres a lo largo del tiempo result√≥ ser significativo, pero no utilizamos nada complicado en el algoritmo mismo. <br><br>  Entonces necesitamos normalizar los tokens.  Convi√©rtalos a min√∫sculas.  En lugar de llevar todo al caso nominativo, simplemente cortamos los finales.  Tambi√©n tenemos un peque√±o diccionario y traducimos nuestros tokens al ingl√©s.  Entre otras cosas, la traducci√≥n nos salva de sin√≥nimos, de significado similar, las palabras rusas se traducen al ingl√©s de la misma manera.  Cuando no logramos traducir, cambiamos los caracteres cir√≠licos similares en escritura al lat√≠n.  (No result√≥ en absoluto superfluo, como result√≥. Incluso donde no esperes un truco sucio, por ejemplo, en la l√≠nea "Samsung UE43NU7100U", podr√≠a ocurrir un cir√≠lico E). <br><br><img src="https://habrastorage.org/webt/j2/wv/2s/j2wv2spiz0vsmlp2iycrtnu8y4w.png" alt="imagen"><br><br>  Categorizaci√≥n de tokens.  Podemos destacar la categor√≠a, fabricante, modelo, art√≠culo, EAN, color.  Tenemos un directorio donde se estructuran los datos.  Tenemos datos sobre competidores que nos proporcionan las plataformas de negociaci√≥n.  Cuando los procesamos, cuando es posible, estructuramos los datos.  Podemos corregir errores o errores tipogr√°ficos, por ejemplo, el fabricante o el color, que ocurren solo una vez en todas nuestras fuentes, sin tener en cuenta el fabricante y el color, respectivamente.  Como resultado, tenemos un gran diccionario de posibles fabricantes, modelos, art√≠culos, colores y la categorizaci√≥n de tokens es solo una b√∫squeda de diccionario para O (1).  Te√≥ricamente, puede tener una lista abierta de categor√≠as y alg√∫n tipo de algoritmo de clasificaci√≥n inteligente, pero nuestro enfoque b√°sico funciona bien y la categorizaci√≥n no es un cuello de botella. <br><br>  Cabe se√±alar que a veces el proveedor proporciona datos ya estructurados, por ejemplo, el art√≠culo est√° en una celda separada en la tabla, o el proveedor hace un descuento en la venta minorista en las ventas mayoristas, y los precios minoristas se pueden obtener en formato yml (xml).  Luego guardamos la estructura de datos y dividimos heur√≠sticamente los tokens en categor√≠as solo de datos no estructurados. <br><br>  Y ahora sobre qu√© algoritmos y en qu√© orden usamos. <br><br><h3>  Coincidencias exactas y casi exactas </h3><br>  El caso m√°s simple.  Las l√≠neas se dividieron en fichas, las llevaron a una forma.  Luego se les ocurri√≥ una funci√≥n hash que no es sensible al orden de los tokens.  Adem√°s, al hacer coincidir por hash, podemos mantener todos los datos en la memoria, podemos permitirnos los 16 megabytes condicionales por diccionario con un mill√≥n de claves.  En la pr√°ctica, el algoritmo funcion√≥ mejor que las simples comparaciones de cadenas. <br><br>  En cuanto al hashing, el uso de "exclusivo o" se sugiere, y una funci√≥n como esta: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetLongHashCode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IEnumerable&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; tokens</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> hash = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tokens.Distinct()) { hash ^= GetLongHashCode(token); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hash; }</code> </pre> <br>  Lo m√°s interesante en esta etapa es obtener un hash de una sola l√≠nea.  En la pr√°ctica, result√≥ que 32 bits son peque√±os, se obtienen muchas colisiones.  Y tambi√©n, que no puede simplemente tomar el c√≥digo fuente de la funci√≥n del marco y cambiar el tipo del valor de retorno, hay menos colisiones para l√≠neas individuales, pero despu√©s de la "exclusiva o" todav√≠a ocurren, as√≠ que escribimos el nuestro.  De hecho, simplemente agregaron a la funci√≥n desde el marco de no linealidad de los datos de entrada.  Definitivamente fue mejor, con la nueva funci√≥n con una colisi√≥n, nos encontramos solo una vez en nuestros millones de registros, grabados y pospuestos hasta tiempos mejores. <br><br>  Por lo tanto, estamos buscando coincidencias sin tener en cuenta el orden de las palabras y su forma.  Tal b√∫squeda funciona para O (1). <br><br>  Desafortunadamente, rara vez, pero tambi√©n sucede: "ABC 42 Tipo 16" y "ABC 16 Tipo 42", y estos son dos productos diferentes.  Tambi√©n aprendimos a lidiar con tales cosas, pero m√°s sobre eso m√°s adelante. <br><br><h3>  Productos confirmados humanos a juego </h3><br>  Tenemos productos que se hacen coincidir manualmente (la mayor√≠a de las veces son productos que se hacen coincidir autom√°ticamente, pero que se han verificado manualmente).  De hecho, estamos haciendo lo mismo en este caso, solo que ahora hemos agregado un diccionario de hashes coincidentes, cuya b√∫squeda no cambi√≥ la complejidad temporal del algoritmo. <br><br>  Las l√≠neas coincidentes manuales simplemente se encuentran en la base de datos, por si acaso, dichos datos sin procesar le permitir√°n cambiar el algoritmo de hash en el futuro, volver a calcular todo y no perder nada. <br><br><h3>  Mapeo de atributos </h3><br>  Los dos primeros algoritmos son r√°pidos y precisos, pero no suficientes.  A continuaci√≥n, aplicamos la coincidencia de atributos. <br><br>  Anteriormente, ya presentamos los datos en forma de tokens normalizados e incluso los clasificamos en categor√≠as.  En este cap√≠tulo, llamo atributos de categor√≠as de tokens. <br><br>  El atributo m√°s confiable es EAN (https://ru.wikipedia.org/wiki/European_Article_Number).  Las coincidencias EAN le brindan casi una garant√≠a del 100% de que son el mismo producto.  Sin embargo, el desajuste de EAN no dice nada, porque un producto puede tener diferentes EAN.  Todo estar√≠a bien, pero en nuestros datos el EAN es raro, por lo tanto, su influencia en la comparaci√≥n a nivel de error. <br><br>  El art√≠culo es menos confiable.  Algo extra√±o a menudo se obtiene directamente de los datos estructurados del proveedor, pero en cualquier caso en esta etapa lo usamos. <br><br>  Como en la √∫ltima etapa, aqu√≠ usamos diccionarios (busca O (1)), y el hash de (fabricante + modelo + art√≠culo) se usa como clave.  Hashing le permite realizar todas las operaciones en la memoria.  En este caso, tambi√©n tenemos en cuenta el color, si coincide o no existe, creemos que los productos coincidieron. <br><br><h3>  Busca el mejor partido </h3><br>  Los pasos anteriores fueron simples, r√°pidos y bastante confiables, pero desafortunadamente cubren menos de la mitad de las comparaciones. <br><br>  En la b√∫squeda de la mejor coincidencia, hay una idea simple: la coincidencia de tokens raros tiene un gran peso, la coincidencia de tokens frecuentes es peque√±a.  Los tokens que contienen n√∫meros se valoran m√°s que los tokens de letras.  Los tokens que coinciden en el mismo orden se valoran m√°s que los tokens que se reorganizan.  Los partidos largos son mejores que los cortos. <br><br>  Ahora queda por llegar una estructura de datos r√°pida que pueda tener todo esto en cuenta al mismo tiempo y se ajuste a la memoria de un directorio de un par de millones de registros. <br><br>  Se nos ocurri√≥ la idea de presentar nuestro cat√°logo en forma de diccionario de diccionarios, en el primer nivel, la clave ser√° un hash del fabricante (los datos en el cat√°logo est√°n estructurados, conocemos al fabricante), el valor es el diccionario.  Ahora el segundo nivel.  La clave en el segundo nivel ser√° el hash del token, el valor es la lista de elementos de identificaci√≥n del cat√°logo donde se encuentra este token.  Y en este caso, utilizamos la inclusi√≥n de combinaciones de tokens en el orden en que aparecen en nuestro cat√°logo.  Decidimos qu√© usar como combinaci√≥n y qu√© no, dependiendo del n√∫mero de tokens, su longitud, etc., esto es un compromiso entre la velocidad, la precisi√≥n y la memoria requerida.  En la figura, simplifiqu√© esta estructura, sin hashes y sin normalizaci√≥n. <br><br><img src="https://habrastorage.org/webt/kl/wu/k8/klwuk8-3nkyfo8db2schr5nt2mk.png" alt="imagen"><br><br>  Si en promedio se usan 20 tokens para cada producto, entonces en nuestras listas, que tienen los valores del diccionario adjunto, se producir√° un enlace al producto en promedio 20 veces.  No habr√° m√°s de 20 veces diferentes tokens que productos en el cat√°logo.  Aproximadamente, puede calcular la memoria requerida para un cat√°logo de un mill√≥n de registros: 20 millones de claves, 4 bytes cada uno, 20 millones de identificaci√≥n del producto, 4 bytes cada uno, gastos generales para organizar diccionarios y listas (el orden es el mismo, pero dado que el tama√±o de las listas y los diccionarios No sabemos de antemano, pero aumenta sobre la marcha, multiplicar por dos).  Total: 480 megabytes.  En realidad, result√≥ un poco m√°s de tokens para productos, y necesitamos hasta 800 megabytes por cat√°logo en un mill√≥n de productos.  Lo que es aceptable, las capacidades del hierro moderno le permiten almacenar simult√°neamente en la memoria m√°s de cien directorios de este tama√±o. <br><br>  De vuelta al algoritmo.  Al tener una cadena que necesitamos hacer coincidir, podemos determinar el fabricante (tenemos un algoritmo de categorizaci√≥n) y luego obtener tokens usando el mismo algoritmo que para los productos del cat√°logo.  Aqu√≠ quiero decir, incluyendo combinaciones de tokens. <br><br>  Entonces todo es relativamente simple.  Para cada ficha, podemos encontrar r√°pidamente todos los productos en los que se encuentra, estimar el peso de cada coincidencia, teniendo en cuenta todo lo que hablamos anteriormente: longitud, frecuencia, presencia de n√∫meros o caracteres especiales, y evaluar la "similitud" de todos los candidatos encontrados.  En realidad, tambi√©n hay optimizaciones aqu√≠, no consideramos a todos los candidatos, primero creamos una peque√±a lista de coincidencias de tokens con un gran peso, y no aplicamos coincidencias de tokens con un bajo peso a todos los productos, sino solo a esta lista. <br><br>  Seleccionamos la mejor coincidencia, observamos la coincidencia de los tokens que se clasificaron y consideramos el puntaje de comparaci√≥n.  Adem√°s, tenemos dos valores de umbral P1 y P2, P1 &lt;P2.  Si la evaluaci√≥n result√≥ ser mayor que el valor umbral P2: no se requiere la participaci√≥n humana, todo sucede autom√°ticamente.  Si est√° entre dos valores, ofrecemos ver la comparaci√≥n manualmente, antes de eso no participar√° en la fijaci√≥n de precios.  Si es menor que P1, lo m√°s probable es que dicho producto no est√© en el cat√°logo, no devolvemos nada. <br><br>  Volver a las l√≠neas "ABC 42 Tipo 16" y "ABC 16 Tipo 42".  La soluci√≥n es sorprendentemente simple: si varios productos tienen los mismos hash, entonces no los igualamos por hash.  Y el √∫ltimo algoritmo tendr√° en cuenta el orden de los tokens.  Te√≥ricamente, tales l√≠neas en la lista de precios del proveedor no pueden coincidir con nada arbitrario, donde los n√∫meros 16 y 42 no aparecen en absoluto.  De hecho, no encontramos tal necesidad. <br><br><h3>  Velocidad y precisi√≥n </h3><br>  Ahora por la velocidad de todo.  El tiempo requerido para preparar los diccionarios linealmente depende del tama√±o del cat√°logo.  El tiempo requerido directamente para la comparaci√≥n depende linealmente del n√∫mero de bienes que se comparan.  Todas las estructuras de datos involucradas en la b√∫squeda no cambian despu√©s de la creaci√≥n.  Esto nos da la oportunidad de usar multihilo en la etapa de coincidencia.  El trabajo preparatorio para el cat√°logo de un mill√≥n de registros lleva entre 40 y 80 segundos.  La comparaci√≥n funciona a una velocidad de 20-40 mil registros por segundo y no depende del tama√±o del directorio.  Entonces, sin embargo, debe guardar los resultados.  El enfoque elegido es generalmente beneficioso para grandes vol√∫menes, pero un archivo con una docena de registros ser√° desproporcionadamente largo.  Por lo tanto, usamos el cach√© y contamos nuestras estructuras de b√∫squeda una vez cada 15 minutos. <br><br>  Es cierto que los datos para la comparaci√≥n deben leerse en alguna parte (la mayor√≠a de las veces es un archivo de Excel), y las oraciones coincidentes deben guardarse en alguna parte, y esto tambi√©n lleva tiempo.  Entonces, el n√∫mero total es de 2-4 mil registros por segundo. <br><br>  Para evaluar la precisi√≥n, preparamos un conjunto de pruebas de aproximadamente 20,000 comparaciones verificadas manualmente de diferentes proveedores de diferentes categor√≠as.  Despu√©s de cada cambio, el algoritmo se prob√≥ con estos datos.  Los resultados son los siguientes: <br><br><ul><li>  los productos est√°n en el cat√°logo y se compararon correctamente - 84% </li><li>  el producto est√° en el cat√°logo, pero no ha sido igualado, se requiere coincidencia manual - 16% </li><li>  los productos est√°n en el cat√°logo y se compararon incorrectamente - 0.2% </li><li>  el producto no est√° en el cat√°logo y el programa lo identific√≥ correctamente: 98.5% </li><li>  el producto no est√° en el cat√°logo, pero el programa lo compar√≥ con uno de los productos: 1.5% </li></ul><br>  En el 80% de los casos en que el producto fue emparejado, no se requiere confirmaci√≥n manual (confirmamos autom√°ticamente la comparaci√≥n), entre las ofertas confirmadas autom√°ticamente se encuentra el 0.1% de los errores. <br><br>  Por cierto, resulta que el 0.1% de los errores es mucho.  Para un mill√≥n de registros coincidentes, esto es mil registros coincidentes incorrectamente.  Y esto es mucho porque los compradores encuentran exactamente esos registros mejores.  Bueno, c√≥mo no pedir un tractor por el precio de los faros de este tractor.  Sin embargo, estos mil errores est√°n al comienzo del trabajo en un mill√≥n de propuestas, se corrigieron gradualmente.  La cuarentena de precios sospechosos, que cierra este problema, apareci√≥ m√°s tarde, los primeros meses que trabajamos sin ella. <br><br>  Hay otra categor√≠a de errores que no est√° relacionada con la comparaci√≥n; estos son los precios incorrectos de nuestros proveedores.  Esto es en parte por qu√© no tenemos en cuenta el precio en comparaci√≥n.  Decidimos que, dado que tenemos informaci√≥n adicional en forma de precio, la usaremos para tratar de determinar no solo nuestros propios errores, sino tambi√©n los de los dem√°s. <br><br><h3>  Busca los precios equivocados </h3><br>  Esta es la parte en la que estamos experimentando activamente.  La versi√≥n b√°sica es, y no le permite vender el tel√©fono al precio de un estuche, pero tengo la sensaci√≥n de que es mejor. <br><br>  Para cada producto encontramos los l√≠mites de los precios aceptables de los proveedores.  Dependiendo de los datos disponibles, tenemos en cuenta los precios de los proveedores de este producto, los precios de los competidores, los precios de los proveedores de bienes de este fabricante en esta categor√≠a.  Aquellos precios que no caen dentro de las fronteras est√°n en cuarentena e ignorados en todos nuestros algoritmos.  Manualmente, puede marcar un precio tan sospechoso como normal, luego lo recordamos para este producto y contamos los l√≠mites de los precios aceptables. <br><br>  El algoritmo directo para calcular los precios m√°ximos y m√≠nimos aceptables ahora cambia constantemente, estamos buscando un compromiso entre la cantidad de falsos positivos y la cantidad de precios incorrectos detectados. <br><br>  Usamos valores medios en los c√°lculos (los promedios dan el peor resultado) y todav√≠a no analizamos la forma de distribuci√≥n.  El an√°lisis de la forma de distribuci√≥n es solo el lugar donde, me parece, el algoritmo puede mejorarse. <br><br><h3>  Trabajar con la base de datos </h3><br>  De todo lo anterior, podemos concluir que actualizamos los datos sobre proveedores y competidores a menudo y de muchas maneras, y trabajar con la base de datos puede convertirse en un cuello de botella.  En principio, inicialmente llamamos la atenci√≥n sobre esto e intentamos lograr el m√°ximo rendimiento.  Cuando trabajamos con una gran cantidad de registros, hacemos lo siguiente: <br><br><ul><li>  eliminamos √≠ndices de la tabla con la que trabajamos </li><li>  deshabilitar la indexaci√≥n de texto completo en esta tabla </li><li>  eliminar todos los registros con una determinada condici√≥n (por ejemplo, todas las ofertas de proveedores espec√≠ficos que estamos procesando actualmente) </li><li>  inserte nuevos registros con BULK COPY </li><li>  recrear √≠ndices </li><li>  habilitar la indexaci√≥n de texto completo </li></ul><br><br>  La copia masiva funciona a una velocidad de 10-40 mil registros por segundo, por lo que queda por ver una extensi√≥n tan grande, pero es tan aceptable. <br><br>  La eliminaci√≥n de registros lleva aproximadamente el mismo tiempo que la inserci√≥n.  Todav√≠a se necesita tiempo para recrear los √≠ndices. <br><br>  Por cierto, para cada directorio tenemos una base de datos separada.  Los creamos sobre la marcha.  Y ahora te dir√© por qu√© tenemos m√°s de un cat√°logo. <br><br><h2>  ¬øCu√°l es el problema de la catalogaci√≥n? </h2><br>  Y hay muchos de ellos tambi√©n.  Ahora enumeraremos: <br><br><ul><li>  El cat√°logo contiene alrededor de 400 mil productos de categor√≠as completamente diferentes.  Es imposible comprender profesionalmente cada una de las categor√≠as. </li><li>  Debe seguir un cierto estilo, seguir las reglas generales para el nombre del cat√°logo, nombrar subcategor√≠as, etc.  Por lo tanto, estamos tratando de lograr una estructura de directorio coherente y l√≥gica. </li><li>  Puede crear el mismo producto varias veces, y esto es un problema.  Sin una herramienta que analice nombres similares, constantemente se crean duplicados. </li><li>  Es razonable agregar al cat√°logo aquellos bienes que los proveedores tienen en stock.  En este caso, debe tener prioridades para las categor√≠as de productos. </li><li>  Necesitamos varios directorios.  Uno de los nuestros, lo llevamos a cabo nosotros mismos, el otro: el cat√°logo de agregadores, lo actualizamos por api.  El significado del segundo cat√°logo es que la plataforma del agregador funciona solo con su propio cat√°logo y, en consecuencia, acepta ofertas en su nomenclatura.  Este es otro lugar donde result√≥ que necesita una comparaci√≥n. </li></ul><br>  Pensamos que era l√≥gico y correcto mantener un directorio en el mismo lugar donde se hacen las comparaciones.  Entonces podemos decir a los usuarios que administran el directorio lo que tiene el proveedor, pero no en el directorio. <br><br><h2>  ¬øC√≥mo mantenemos un cat√°logo? </h2><br>  Se tratar√° del cat√°logo sin caracter√≠sticas detalladas, las caracter√≠sticas son una gran historia separada, sobre eso en otro momento. <br><br>  Como propiedades b√°sicas, elegimos lo siguiente: <br><br><ul><li>  productor </li><li>  categor√≠a </li><li>  el modelo </li><li>  n√∫mero de art√≠culo </li><li>  color </li><li>  Ean </li></ul><br>  Primero, hicimos una API para obtener el cat√°logo de una fuente externa, y luego trabajamos en la conveniencia de crear, editar y eliminar registros. <br><br><h3>  C√≥mo funciona la b√∫squeda </h3><br>  La conveniencia de administrar un cat√°logo, en primer lugar, es la capacidad de encontrar r√°pidamente un producto en un cat√°logo o la oferta de un proveedor, y existen matices.  Por ejemplo, debe poder buscar la l√≠nea ‚ÄúLG 21.5‚Äù 22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P ‚Äùpara‚Äú 2MP48 ‚Äù. <br><br>  Una b√∫squeda de servidor sql de texto completo fuera de la caja no es adecuada, porque no sabe c√≥mo hacerlo, y la b√∫squeda con LIKE '% 2MP48%' es demasiado lenta. <br><br>  Nuestra soluci√≥n es bastante est√°ndar, utilizamos N-gramos.  M√°s precisamente, luego trigramas.  Y ya por trigramas construimos un √≠ndice de texto completo y realizamos una b√∫squeda de texto completo.  No estoy seguro de que usemos el espacio de manera muy racional en este caso, pero en t√©rminos de velocidad, esta soluci√≥n surgi√≥, dependiendo de la solicitud, funciona de 50 a 500 milisegundos, a veces hasta un segundo en una matriz de tres millones de registros. <br><br>  Perm√≠tanme explicar, la l√≠nea "LG 21.5" 22MP48D-P (16: 9, IPS, VGA, DVI) 22MP48D-P "se convierte en la l√≠nea" lg2 g21 21515521522 22m 2mp mp4 p48 48d 8dp dp1 p16 169 69i 9ip ips psv svg vga gad adv dvi vi2 i22 ‚Äù, que se almacena en un campo separado que participa en el √≠ndice de texto completo. <br><br>  Por cierto, los trigramas siguen siendo √∫tiles para nosotros. <br><br><h3>  Crea un nuevo producto </h3><br>  En su mayor parte, los productos en el cat√°logo se crean por sugerencia del proveedor.  Es decir, ya tenemos informaci√≥n de que el proveedor ofrece ‚ÄúLG LCD Monitor 21.5 '' [16: 9] 1920x1080 (FHD) IPS, no GLARE, 250cd / m2, H178 ¬∞ / V178 ¬∞, 1000: 1, 16.7M Color, 5 ms, VGA, DVI, inclinaci√≥n, 2 a√±os, negro OK 22MP48D-P ‚Äùa un precio de $ 120, y tiene de 5 a 10 unidades en stock. <br><br>  Al crear un producto, antes que nada, debemos asegurarnos de que dicho producto a√∫n no se haya creado en el cat√°logo.  Resolvemos este problema en cuatro etapas. <br><br>  En primer lugar, si tenemos un producto en el cat√°logo, es muy probable que la propuesta del proveedor coincida con este producto autom√°ticamente. <br><br>  En segundo lugar, antes de mostrarle al usuario el formulario para crear un nuevo producto, realizaremos una b√∫squeda por trigramas y mostraremos los resultados m√°s relevantes.  (t√©cnicamente esto se hace usando CONTAINSTABLE). <br><br>  En tercer lugar, a medida que completemos los campos para un nuevo producto, mostraremos productos existentes similares.  Esto resuelve dos problemas: ayuda a evitar duplicados y mantener el estilo en los nombres, se pueden usar productos similares como modelo. <br><br>  Y cuarto, recuerda, ¬ødividimos las l√≠neas en fichas, las normalizamos, contamos hashes?  Haremos lo mismo y simplemente no dejaremos crear productos con los mismos hashes. <br><br>  En esta etapa, tratamos de ayudar al usuario.  Por la l√≠nea que est√° en la lista de precios, intentaremos determinar el fabricante, la categor√≠a, el art√≠culo, el EAN y el color de los productos.  Primero, por tokens (podemos dividirlos en categor√≠as), luego, si no funciona, encontraremos el producto m√°s similar por trigramas.  Y, si es lo suficientemente similar, complete el fabricante y la categor√≠a. <br><br>  La edici√≥n del producto funciona casi igual, pero no todo es aplicable. <br><br><h2>  C√≥mo establecemos nuestros precios </h2><br>  La tarea es esta: mantener un equilibrio entre la cantidad y el margen de ventas, de hecho, para lograr el m√°ximo beneficio.  Todos los dem√°s aspectos del trabajo de la tienda tambi√©n se refieren a esto, pero lo que sucede exactamente en la etapa de fijaci√≥n de precios tiene el mayor impacto. <br><br>  Como m√≠nimo, necesitaremos informaci√≥n sobre ofertas de proveedores y competidores.  Tambi√©n vale la pena considerar los precios m√≠nimos minoristas y mayoristas y los costos de entrega, as√≠ como los instrumentos financieros: pr√©stamos y cuotas. <br><br><h3>  Recopilamos precios de la competencia. </h3><br>  Para empezar, tenemos muchos perfiles de nuestros propios precios.  Hay un perfil para minoristas, hay varios para clientes mayoristas.  Todos ellos son creados y configurados en nuestro sistema. <br><br>  En consecuencia, los competidores para cada perfil son diferentes.  En el comercio minorista - otras tiendas minoristas, en ventas mayoristas - nuestros mismos proveedores. <br><br>  Todo est√° claro con los proveedores, pero para el comercio minorista recopilamos datos de la competencia de varias maneras.  En primer lugar, algunos agregadores proporcionan informaci√≥n sobre todos los precios de todos los productos que se encuentran en el sitio.  En nuestra propia nomenclatura, pero podemos combinar productos, por lo que funciona autom√°ticamente.  Y esto es casi suficiente por ahora.  En segundo lugar, tenemos analizadores de la competencia.  Como todav√≠a no est√°n automatizados y existen en forma de aplicaciones de consola (que a veces se bloquean), rara vez las usamos. <br><br><h3>  Personaliza tu perfil </h3><br>  En el perfil, tenemos la oportunidad de configurar diferentes rangos de m√°rgenes dependiendo del precio de los bienes del proveedor, categor√≠a, fabricante, proveedor.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todav√≠a es posible indicar con qu√© proveedores en qu√© categor√≠a o fabricante estamos trabajando, y con cu√°les, no con qu√© competidores, tenemos en cuenta. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Luego establecemos instrumentos financieros, indicamos qu√© cuotas hay disponibles y cu√°nto tomar√° el banco para s√≠ mismo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y ya dentro de los m√°rgenes de los m√°rgenes, formamos nuestros propios precios, tratando de mantener el mismo equilibrio en primer lugar, y hacer que nuestros productos de almac√©n se vendan mejor en segundo lugar. </font><font style="vertical-align: inherit;">Esto es as√≠ en pocas palabras, pero de hecho no pretendo explicar con palabras simples lo que est√° sucediendo all√≠. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Te puedo decir lo que no est√° sucediendo. </font><font style="vertical-align: inherit;">Desafortunadamente, todav√≠a no sabemos c√≥mo pronosticar la demanda y tener en cuenta el costo de almacenar productos en un almac√©n.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Integraci√≥n con sistemas de terceros. </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una parte importante desde el punto de vista comercial, pero poco interesante desde un punto de vista t√©cnico. </font><font style="vertical-align: inherit;">En pocas palabras, dir√© que podemos enviar datos a sistemas de terceros (incluidos los incrementales, es decir, entendemos lo que ha cambiado desde el √∫ltimo intercambio) y podemos hacer listas de correo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los boletines son personalizables, por lo que (y no solo eso) entregamos nuestras ofertas a clientes mayoristas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra forma de trabajar con clientes mayoristas es el portal b2b. </font><font style="vertical-align: inherit;">Todav√≠a est√° en desarrollo activo, funcionar√° literalmente en un mes.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cuentas, cambio de registro </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra pregunta poco interesante desde un punto de vista t√©cnico. </font><font style="vertical-align: inherit;">Cada usuario tiene una cuenta. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En resumen, se puede decir lo siguiente: si se usa ORM, entonces tiene un mecanismo de seguimiento de cambios incorporado. </font><font style="vertical-align: inherit;">Si ingresa (y en nuestro caso es EF Core e incluso hay una API all√≠), puede iniciar sesi√≥n en casi dos l√≠neas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para el historial de cambios, creamos una interfaz, y ahora puede rastrear qui√©n cambi√≥ qu√© en la configuraci√≥n del sistema, qui√©n edit√≥ o compar√≥ ciertos productos, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seg√∫n los registros, se pueden considerar las estad√≠sticas, que es lo que estamos haciendo. </font><font style="vertical-align: inherit;">Sabemos qui√©n cre√≥ o edit√≥ cu√°ntos productos, cu√°ntas comparaciones se confirmaron manualmente y cu√°ntos se rechazaron, puede ver cada cambio.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un poco sobre el dispositivo del sistema general </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenemos una base de datos para cuentas y elementos independientes del cat√°logo, una base de datos para registros y una base de datos para cada directorio. Esto facilita las consultas de directorio, y el an√°lisis de datos es m√°s f√°cil, y el c√≥digo es m√°s comprensible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por cierto, el sistema de registro es auto-escrito, realmente necesitamos agrupar los registros relacionados con una solicitud o una tarea pesada, adem√°s, necesitamos una funcionalidad b√°sica para analizarlos. Con soluciones llave en mano, esto result√≥ ser dif√≠cil, adem√°s de que esta es otra dependencia que necesita ser soportada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La interfaz web est√° hecha en ASP.NET Core y bootstrap, y el servicio de Windows realiza operaciones pesadas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra caracter√≠stica que ha beneficiado al proyecto, en mi opini√≥n, son los diferentes modelos para leer y escribir datos. No implementamos CQRS completo, pero tomamos uno de los conceptos a partir de ah√≠. Escribimos en la base de datos a trav√©s de los repositorios, pero los objetos que se usan para grabar nunca dejan los m√©todos de actualizaci√≥n / creaci√≥n / eliminaci√≥n. La actualizaci√≥n masiva se realiza a trav√©s de BULK COPY. Se hicieron un modelo separado y una capa separada de acceso a datos para la lectura, por lo que solo leemos lo que necesitamos en un momento particular. Result√≥ que puede usar ORM, evitando consultas pesadas, accediendo a la base de datos en momentos inciertos (como con carga diferida), problemas N + 1. Y tambi√©n usamos el modelo para leer como DTO.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De las principales dependencias, tenemos ASP.NET Core, varios paquetes nuget de terceros y MS SQL Server. </font><font style="vertical-align: inherit;">Si bien es posible, tratamos de no depender de muchos sistemas de terceros. </font><font style="vertical-align: inherit;">Para implementar completamente el proyecto localmente, simplemente instale SQL Server, tome el c√≥digo fuente del sistema de control de versiones y cree el proyecto. </font><font style="vertical-align: inherit;">Las bases de datos necesarias se crear√°n autom√°ticamente, pero no se necesita nada m√°s. </font><font style="vertical-align: inherit;">Puede que tenga que cambiar una o dos l√≠neas en la configuraci√≥n.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lo que no </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todav√≠a no hemos hecho un sistema de conocimiento del proyecto. </font><font style="vertical-align: inherit;">Queremos hacer wikis y consejos en su lugar. </font><font style="vertical-align: inherit;">No crearon una interfaz intuitiva simple, la que no est√° mal, pero un poco confundida para una persona no preparada. </font><font style="vertical-align: inherit;">CI / CD hasta ahora solo en los planes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No manej√≥ las caracter√≠sticas detalladas de los bienes. </font><font style="vertical-align: inherit;">Tambi√©n planeamos, pero a√∫n no hay una fecha l√≠mite espec√≠fica.</font></font><br><br><img src="https://habrastorage.org/webt/dm/9t/jo/dm9tjobx0gdp9te5pb_uatrndli.jpeg" alt="imagen"><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resumen comercial </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desde el comienzo del desarrollo activo hasta el lanzamiento en producci√≥n, dos personas trabajaron en el proyecto durante 7 meses. Al principio, ten√≠amos un prototipo hecho en nuestro tiempo libre. La integraci√≥n m√°s dif√≠cil se dio a los sistemas existentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Durante los tres meses que estamos en producci√≥n, el n√∫mero de bienes disponibles para clientes mayoristas ha crecido de 70 mil a 230 mil, el n√∫mero de bienes en el sitio, de 60 mil a 140 mil. El sitio siempre llega tarde porque necesita caracter√≠sticas, im√°genes, descripciones de productos. Descargamos 106 mil ofertas en el agregador en lugar de 40 mil hace tres meses. El n√∫mero de personas que trabajan con el cat√°logo no ha cambiado.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trabajamos con 425 proveedores, este n√∫mero casi se ha duplicado en tres meses. Rastreamos precios de m√°s de mil competidores. Bueno, a medida que lo rastreamos, tenemos un sistema para analizar, pero en la mayor√≠a de los casos tomamos datos ya preparados de quienes nos los proporcionan regularmente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lamentablemente, no puedo informarle sobre ventas, yo mismo no tengo datos confiables. La demanda es estacional, y es imposible comparar directamente el mes con el mes anterior. Y en un a√±o ha pasado demasiado para resaltar la influencia de nuestro sistema de todos los factores. Muy, muy condicional, m√°s o menos un kil√≥metro, el crecimiento del cat√°logo, los precios m√°s flexibles y competitivos y el crecimiento de las ventas asociadas ya han pagado el desarrollo y la implementaci√≥n.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otro resultado: obtuvimos un proyecto que esencialmente no est√° relacionado con la infraestructura de una tienda en particular, y usted puede hacer un servicio p√∫blico. Fue concebido desde el principio, y este plan casi funcion√≥. Desafortunadamente, la soluci√≥n en caja ha fallado. Para ofrecer un proyecto como un servicio en el que pueda registrarse, marque la casilla "Acepto" y que funcione "tal cual", sin adaptarse al cliente, debe redise√±ar la interfaz, agregar flexibilidad y crear un wiki. Y para hacer que la infraestructura sea f√°cilmente escalable y eliminar un solo punto de falla. Ahora solo tenemos copias de seguridad peri√≥dicas de los medios para garantizar la fiabilidad. Como soluci√≥n empresarial, creo que estamos listos para resolver problemas comerciales. La peque√±a empresa es encontrar un negocio.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por cierto, ya hemos atra√≠do a un cliente externo, que tiene la funcionalidad m√°s b√°sica. </font><font style="vertical-align: inherit;">Los chicos necesitaban una herramienta para comparar bienes, y los inconvenientes asociados con el desarrollo activo no los asustaron.</font></font><br><br><img src="https://habrastorage.org/webt/z7/7-/uo/z77-uo8184l_r3fbdrginrvtyik.png" alt="imagen"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/456604/">https://habr.com/ru/post/456604/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456588/index.html">Estudiar la inyecci√≥n de dependencia</a></li>
<li><a href="../456594/index.html">2 minutos con Webpack sacudiendo √°rboles y reexportando</a></li>
<li><a href="../456596/index.html">Microbiota ¬øC√≥mo funcionan las pruebas?</a></li>
<li><a href="../456600/index.html">Recetas Nginx: autorizaci√≥n LDAP con captcha</a></li>
<li><a href="../456602/index.html">Gu√≠a para implementar suscripciones de renovaci√≥n autom√°tica en aplicaciones iOS</a></li>
<li><a href="../456606/index.html">Noticias del mundo de OpenStreetMap No. 464 (04/04/2019 - 06/10/2019)</a></li>
<li><a href="../456608/index.html">Southbridge en Chelyabinsk y Bitrix en Kubernetes</a></li>
<li><a href="../456610/index.html">No presione y no apruebe</a></li>
<li><a href="../456612/index.html">Una de las cientos de formas de publicar m√∫ltiples proyectos de producci√≥n en un servidor</a></li>
<li><a href="../456614/index.html">C√≥mo se desarrolla un cuento de peste: el marco de la inocencia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>