<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöÜ üì∑ üë©‚Äçüè´ Vous-m√™me fournisseur VDS üìå üå®Ô∏è ü¶Ö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous voulez profiter du VDS et en m√™me temps vous prot√©ger contre un survol sans scrupules, lorsque le fournisseur obstrue le n≈ìud aux globes ocula...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vous-m√™me fournisseur VDS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/first/blog/414741/"><img src="https://habrastorage.org/webt/lb/xe/q6/lbxeq6q_bjkeqi_lnwqv4wkrdkk.jpeg"><br><br>  Si vous voulez profiter du VDS et en m√™me temps vous prot√©ger contre un survol sans scrupules, lorsque le fournisseur obstrue le n≈ìud aux globes oculaires et n'√©quilibre pas la charge, il y a deux fa√ßons. <br><br>  Vous pouvez trouver votre h√©bergeur VDS fiable.  Ou tuez tous les Sith vous-m√™me et cr√©ez votre propre √©toile de la mort (n≈ìud) - commandez un serveur d√©di√© et transf√©rez-y tous vos VDS.  Apr√®s tout, nous saurons alors avec certitude que toutes les ressources ne sont que les n√¥tres et seront toujours disponibles.  Oui, et nous pouvons installer n'importe quel syst√®me d'exploitation que nous voulons, n'importe quel logiciel qui est impatient, et Bitrix ravira les perroquets en raison de la fr√©quence √©lev√©e du processeur.  Qui sait, peut-√™tre m√™me que les patrons deviendront plus g√©n√©reux et √©criront un bonus.  C'est parti! <a name="habracut"></a><br><br><h2>  Nous consid√©rons combien nous avons de midichlorien </h2><br>  Vous devez d'abord conna√Ætre le co√ªt total de la location d'un parc VDS et la consommation r√©elle des ressources du processeur, de la RAM / m√©moire permanente, du nombre d'adresses IP.  D√©couvrez la fr√©quence du processeur allou√©e par votre VDS.  Ici, tous les h√©bergeurs individuellement - nous regardons les horaires, nous consid√©rons les prix. <br><br><h2>  Choisir le bon corps </h2><br>  Maintenant que nous connaissons les besoins actuels en ressources, nous s√©lectionnons le serveur d√©di√© appropri√©. <br><br><h4>  CPU </h4><br>  Lors du choix d'un processeur, il est important de prendre en compte - la fr√©quence du c≈ìur peut √™tre consid√©rablement plus √©lev√©e que sur le VDS actuel.  S'il est deux fois plus √©lev√©, vous pouvez envisager un noyau Dedic pour deux noyaux VDS.  Il peut y avoir une temp√™te d'indignation, mais vous devez comprendre: tous les projets sont diff√©rents, et c'est la fa√ßon la plus simple de choisir un processeur.  En g√©n√©ral, nous prenons le nombre de c≈ìurs r√©ellement utilis√©s par les anciens VDS, si la fr√©quence du c≈ìur d'environ 2 Ghz est divis√©e par deux. <br>  La valeur r√©sultante est le nombre minimum de noyaux dedica requis. <br><br><h4>  La m√©moire </h4><br>  Avec la RAM et un disque dur, tout est simple.  Nous r√©sumons les ressources VDS, ajoutons 1 Go de RAM et ~ 10 Go de disque dur.  Ces ressources suppl√©mentaires sont n√©cessaires au fonctionnement du syst√®me d'exploitation et du panneau de commande de l'hyperviseur.  Si vous allez augmenter la quantit√© de contenu - mettez une r√©serve de ressources pour la croissance du projet. <br><br><h4>  Adresses IP </h4><br>  Comme dans le cas de la m√©moire, nous prenons le m√™me nombre d'adresses que sur VDS-kah + 1 pour Dedik lui-m√™me. <br><br>  Nous commandons un serveur qui r√©pond √† nos besoins et en tenant compte des nuances mentionn√©es.  Nous choisissons Debian 9 comme OS, c'est sous cet OS qu'ils font un panneau de contr√¥le Proxmox adapt√©. <br><br><h2>  R√©veillez le pouvoir </h2><br>  Apr√®s un certain temps, nous aurons un acc√®s root au tout nouveau Dedik. <br>  Il est temps de dire quelques mots sur le panneau de commande de l'hyperviseur Proxmox chaud, √† tube et gratuit.  Oui, le panneau lui-m√™me est gratuit - les d√©veloppeurs gagnent avec un abonnement.  Les abonn√©s, √† leur tour, obtiennent une version plus stable du panneau et la possibilit√© d'ajouter plus de n≈ìuds en mode cluster.  Mais pour notre objectif, la version gratuite suffit. <br><br>  Relativement r√©cemment, le panneau a √©t√© consid√©rablement mis √† jour; il a maintenant l'air tr√®s moderne et fonctionnel.  Il prend en charge la virtualisation KVM et LXC, vous permet d'organiser votre cloud ceph, prend en charge la sauvegarde, en un mot, il sait tout ce dont un utilisateur ordinaire d'un h√©bergement VDS peut avoir besoin. <br><br><h4>  Prise en main de l'installation de Proxmox </h4><br>  Nous nous connectons au serveur via ssh en utilisant putty ou un autre client ssh et ex√©cutons les commandes suivantes s√©quentiellement: <br><br><pre><code class="hljs powershell">echo <span class="hljs-string"><span class="hljs-string">"deb http://download.proxmox.com/debian/pve stretch pve-no-subscription"</span></span> &gt; /etc/apt/sources.list.d/pve<span class="hljs-literal"><span class="hljs-literal">-install</span></span><span class="hljs-literal"><span class="hljs-literal">-repo</span></span>.list wget http://download.proxmox.com/debian/proxmox<span class="hljs-literal"><span class="hljs-literal">-ve</span></span><span class="hljs-literal"><span class="hljs-literal">-release</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span>.x.gpg <span class="hljs-literal"><span class="hljs-literal">-O</span></span> /etc/apt/trusted.gpg.d/proxmox<span class="hljs-literal"><span class="hljs-literal">-ve</span></span><span class="hljs-literal"><span class="hljs-literal">-release</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span>.x.gpg apt update &amp;&amp; apt dist<span class="hljs-literal"><span class="hljs-literal">-upgrade</span></span> apt install <span class="hljs-literal"><span class="hljs-literal">-y</span></span> proxmox<span class="hljs-literal"><span class="hljs-literal">-ve</span></span> postfix <span class="hljs-built_in"><span class="hljs-built_in">open-iscsi</span></span> apt remove <span class="hljs-literal"><span class="hljs-literal">-y</span></span> os<span class="hljs-literal"><span class="hljs-literal">-prober</span></span></code> </pre> <br>  Une fois l'installation termin√©e, acc√©dez √† Proxmox, pour l'autorisation, utilisez le navigateur sur le port 8006 du dedica <code>https://IP-:8006</code> <br><br><img src="https://habrastorage.org/webt/mh/_p/t1/mh_pt1drekhxeglfhg3fnch7rdw.png"><br><br>  Nous nous connectons √©galement en tant que root, l'interface est assez bien traduite en grand et puissant - vous pouvez l'utiliser en toute s√©curit√©. <br><br>  D√®s que vous vous connectez, vous verrez un message avec un indice d'abonnement.  Ce n'est pas n√©cessaire - le panneau n'arr√™tera pas de fonctionner, comme c'est le cas avec les versions d'essai des programmes. <br><br><img src="https://habrastorage.org/webt/a-/uv/j2/a-uvj2-6ephahggkfxrba8igeyc.png"><br><br>  Avant de cr√©er le premier VDS sur le nouveau serveur, vous devez configurer le pont r√©seau afin que tout soit comme √† l'adulte.  √Ä ce stade, vous pouvez avoir besoin de KVM ou ipmi-kvm (en cas de probl√®me, et vous devez restaurer la disponibilit√© de Dedic sur le r√©seau). <br><br>  Nous revenons √† ssh et √©ditons la configuration / etc / network / interfaces en utilisant le nano pl√©b√©ien ou le vim orthodoxe.  Nous apportons une config √† ce type: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">source</span></span> /etc/network/interfaces.d/* <span class="hljs-comment"><span class="hljs-comment"># The loopback network interface auto lo iface lo inet loopback auto vmbr0 iface vmbr0 inet static address IP- netmask - gateway  bridge_ports ens3 //  ,      .   ,  ,  IP     ¬´ip a¬ª. bridge_stp off bridge_fd 0 bridge_maxwait 0</span></span></code> </pre><br>  Apr√®s avoir enregistr√© la configuration modifi√©e, nous envoyons Dedik pour red√©marrer.  Outre la configuration du r√©seau, il chargera √©galement le nouveau noyau. <br><br>  Apr√®s avoir d√©marr√© le serveur, nous nous tournons √† nouveau vers SSH pour t√©l√©charger les images ISO des OS pour les futurs VDS, ainsi que l'image sysrescuecd.  Les images doivent √™tre plac√©es dans le r√©pertoire / var / lib / vz / template / iso <br>  Pour le t√©l√©chargement, nous utilisons wget et des liens directs.  Vous ne pouvez pas t√©l√©charger d'images syst√®me si vous souhaitez simplement transf√©rer des VDS existants vers Dedic.  Mais l'image sysrescuecd peut √™tre n√©cessaire pour entretenir VDS, nous vous recommandons donc vivement de la t√©l√©charger imm√©diatement. <br><br><h2>  Va conqu√©rir une galaxie lointaine </h2><br>  Il est temps de cr√©er des VDS sur notre Dedic: appuyez sur le bouton "Cr√©er une VM" dans le coin sup√©rieur droit du panneau Proxmox, remplissez les champs de tous les onglets en utilisant les donn√©es de n'importe quel ancien VDS.  Le format d'image est s√©lectionn√© qcow2. <br><br><img src="https://habrastorage.org/webt/bi/q3/z1/biq3z14ds14z_ilhroqytbiqjda.png"><br><br>  Les images disque seront cr√©√©es le long du chemin / var / lib / vz / images / [voici l'ID du nouveau VDS]. <br><br>  Nous demandons des images au format qcow2 √† l'h√©bergeur VDS et les chargeons √† la place des images pr√©c√©demment cr√©√©es.  S√©lectionnez VDS dans la liste de gauche et d√©marrez-le avec le bouton "D√©marrer".  Maintenant que nous avons notre serveur virtuel avec tous les projets, il ne reste plus qu'√† corriger les param√®tres r√©seau dans le VDS lui-m√™me et changer le DNS en IP de la nouvelle machine virtuelle.  Vous pouvez d√©finir ces param√®tres via VNC, qui est disponible en cliquant sur le bouton Console. <br><br><h4>  Suivi </h4><br>  Apr√®s avoir termin√© le transfert et chang√© le DNS, nous commen√ßons √† surveiller les indicateurs de charge.  Ce n'est pas n√©cessaire, mais utile.  Pour une telle surveillance, vous pouvez afficher le r√©sum√© g√©n√©ral du cluster. <br><br><img src="https://habrastorage.org/webt/iq/bj/ob/iqbjobj-21dpilq18qec995ppk4.png"><br><br>  Le r√©sum√© du n≈ìud a plus de d√©tails: <br><br><img src="https://habrastorage.org/webt/pw/0o/6e/pw0o6e60se3f58bhk-7cz3uryb8.png"><br><br>  S'il s'av√®re soudainement que certaines ressources de noeud s'√©puisent, √† partir des r√©sum√©s VDS, vous pouvez d√©terminer laquelle consomme beaucoup de ressources et optimiser les services du probl√®me VDS.  Lorsque les projets d√©passent le serveur actuel, pour passer √† un mat√©riel plus productif, il suffit de r√©organiser les disques d'un serveur √† un autre.  Un tel travail prend environ 15 minutes - beaucoup plus rapide que la migration de VDS entre les n≈ìuds. <br><br>  Dedik a √©galement des inconv√©nients, bien s√ªr, mais Proxmox aide √† les niveler.  La premi√®re est que si Dedik se couche, tous les VDS tomberont.  Le probl√®me est r√©solu par la redondance, mais davantage de d√©dicaces sont n√©cessaires.  M√™me lorsque vous utilisez un serveur d√©di√©, vous devez configurer le raid 1 et surveiller l'√©tat des disques √† l'aide de smartd (et c'est ce que Proxmox peut faire).  Dans le cas de VDS, le m√™me probl√®me est r√©solu en commandant des machines virtuelles √† plusieurs fournisseurs, mais ce n'est pas tr√®s pratique. <br><br>  Le passage √† un serveur d√©di√© est une √©tape raisonnable lorsque le co√ªt du VDS lou√© est comparable au prix d'un serveur d√©di√©.  Vous pouvez choisir une configuration pr√™te √† l'emploi ou cr√©er votre propre Dedic sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">FirstDEDIC</a> .  Si vous voulez que les projets volent, choisissez des disques NVMe haute vitesse (2 √† 3 fois plus rapides que les SSD). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414741/">https://habr.com/ru/post/fr414741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414731/index.html">ngCinimex - Meetup Angular Moscow (07/02/2018)</a></li>
<li><a href="../fr414733/index.html">Dans le top dix: une histoire personnelle sur la fa√ßon de devenir un RHCA et ce que vous pouvez en tirer</a></li>
<li><a href="../fr414735/index.html">Marque informatique. De quoi parler avec les gens lors de conf√©rences</a></li>
<li><a href="../fr414737/index.html">"Ils n'ont pas attendu d'o√π": Yahoo sera condamn√© √† une amende de 250 000 ¬£ pour avoir enfreint les anciennes r√®gles de travail avec PD</a></li>
<li><a href="../fr414739/index.html">go-critique: l'analyseur statique le plus t√™tu pour Go</a></li>
<li><a href="../fr414743/index.html">Localisation: Case Slack</a></li>
<li><a href="../fr414745/index.html">#BigGun. Le chronographe "frame" le plus simple sur Arduino (mesure de la vitesse des balles)</a></li>
<li><a href="../fr414747/index.html">CNS, drogue et rock and roll: l'histoire d'un appareil qui nous a fait boire, pas dormir, ni cligner des yeux</a></li>
<li><a href="../fr414749/index.html">Gentleman sysadmin set</a></li>
<li><a href="../fr414751/index.html">Apprivoiser WSUS avec Ansible et plus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>