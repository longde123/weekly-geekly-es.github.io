<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèõÔ∏è üíó üë©üèæ‚Äçüíº Construire un syst√®me de reconnaissance faciale bas√© sur Golang et OpenCV üí° üëú üë©üèæ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="OpenCV est une biblioth√®que con√ßue pour les projets de vision par ordinateur. Elle a d√©j√† environ 20 ans. Je l'ai utilis√© √† l'universit√© et je l'utili...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construire un syst√®me de reconnaissance faciale bas√© sur Golang et OpenCV</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/462159/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d54/9aa/ccd/d549aaccd055ce9a0a5c233c5882cada.png"></div><br>  OpenCV est une biblioth√®que con√ßue pour les projets de vision par ordinateur.  Elle a d√©j√† environ 20 ans.  Je l'ai utilis√© √† l'universit√© et je l'utilise toujours pour mes projets en C ++ et Python, car il supporte bien ces langages. <br><br>  Mais quand j'ai commenc√© √† apprendre et √† utiliser Go, je me suis demand√© si OpenCV pouvait √™tre utilis√© pour travailler avec ce langage.  A cette √©poque, il y avait d√©j√† des exemples et des tutoriels sur l'int√©gration, mais il me semblait qu'ils √©taient trop compliqu√©s.  Un peu plus tard, je suis tomb√© sur un wrapper cr√©√© par l'√©quipe de The Hybrid Group.  Dans cet article, je vais vous montrer comment d√©marrer avec GoCV en d√©veloppant un syst√®me de reconnaissance faciale simple avec Haar Cascades. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox recommande:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le cours pratique de Python Developer from scratch</a> . <br><br>  <b>Nous vous rappelons:</b> <i>pour tous les lecteurs de ¬´Habr¬ª - une remise de 10 000 roubles lors de l'inscription √† un cours Skillbox en utilisant le code promo ¬´Habr¬ª.</i> <br></blockquote><br>  <b>Ce qui est requis:</b> <br><ul><li>  Allez; </li><li>  OpenCV (liens d'installation ci-dessous); </li><li>  Web ou cam√©scope conventionnel. </li></ul><br>  <b>L'installation</b> <br><br><ul><li>  Linux: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gocv.io/getting-started/linux</a> </li><li>  macOS: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gocv.io/getting-started/macos</a> </li><li>  Windows: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gocv.io/getting-started/windows</a> </li></ul><br><h3>  Exemple 1 </h3><br>  Dans le premier exemple, nous allons essayer de cr√©er une application qui ouvre une fen√™tre avec une d√©monstration du flux vid√©o de la cam√©ra. <br><br>  Vous devez d'abord importer les biblioth√®ques dont vous avez besoin pour travailler. <br><br>  <i>importer (</i> <i><br></i>  <i>¬´Journal¬ª</i> <i><br></i>  <i>"Gocv.io/x/gocv"</i> <i><br></i>  <i>)</i> <br><br>  Apr√®s cela, vous devez cr√©er un objet VideoCapture √† l'aide de la fonction VideoCaptureDevice.  Ce dernier permet de capturer le flux vid√©o √† l'aide de la cam√©ra.  La fonction utilise un entier comme param√®tre (il repr√©sente l'ID du p√©riph√©rique). <br><br><pre><code class="go hljs">webcam, err := gocv.VideoCaptureDevice(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatalf(‚Äúerror opening web cam: %v‚Äù, err) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> webcam.Close()</code> </pre> <br>  Vous devez maintenant cr√©er une matrice √† n dimensions.  Il stockera les images lues sur l'appareil photo. <br><br><pre> <code class="go hljs">img := gocv.NewMat() <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> img.Close()</code> </pre> <br>  Pour afficher le flux vid√©o, vous devez cr√©er une fen√™tre - cela peut √™tre fait en utilisant la fonction NewWindow. <br><br><pre> <code class="go hljs">window := gocv.NewWindow(‚Äúwebcamwindow‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> window.Close()</code> </pre> <br>  Passons maintenant √† la partie la plus int√©ressante. <br><br>  √âtant donn√© que la vid√©o est un flux continu d'images, nous devrons cr√©er une boucle sans fin pour lire le flux vid√©o de la cam√©ra √† l'infini.  Pour ce faire, vous avez besoin de la m√©thode Read de type VideoCapture.  Il attendra le type Mat (la matrice que nous avons cr√©√©e ci-dessus), renvoyant une valeur bool√©enne indiquant si l'image de VideoCapture a √©t√© lue avec succ√®s ou non. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ok := webcam.Read(&amp;img); !ok || img.Empty( { log.Println(‚ÄúUnable to read from the webcam‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } . . . }</code> </pre> <br>  Vous devez maintenant afficher le cadre dans la fen√™tre cr√©√©e.  Pause pour passer √† l'image suivante - 50 ms. <br><br>  <i>window.IMShow (img)</i> <i><br></i>  <i>window.WaitKey (50)</i> <br><br>  Apr√®s avoir d√©marr√© l'application, une fen√™tre avec un flux vid√©o de la cam√©ra s'ouvrira. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a25/2e8/15e/a252e815e5e8627147512749e1f63699.png"><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"gocv.io/x/gocv"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { webcam, err := gocv.VideoCaptureDevice(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatalf(<span class="hljs-string"><span class="hljs-string">"error opening device: %v"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> webcam.Close() img := gocv.NewMat() <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> img.Close() window := gocv.NewWindow(<span class="hljs-string"><span class="hljs-string">"webcamwindow"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> window.Close() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ok := webcam.Read(&amp;img); !ok || img.Empty() { log.Println(<span class="hljs-string"><span class="hljs-string">"Unable to read from the webcam"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } window.IMShow(img) window.WaitKey(<span class="hljs-number"><span class="hljs-number">50</span></span>) } }</code> </pre> <br><h3>  Exemple 2 </h3><br>  Dans cet exemple, utilisons l'exemple pr√©c√©dent et construisons un syst√®me de reconnaissance faciale bas√© sur Haar Cascades (Haar cascades). <br><br>  Les cascades de Haar sont des classificateurs en cascade qui sont form√©s sur la base de la technique des ondelettes de Haar.  Ils analysent les pixels de l'image pour d√©tecter certains signes.  Pour en savoir plus sur Haar Cascades, suivez les liens ci-dessous. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cadre de d√©tection d'objets Viola-jones</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Classificateurs en cascade</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Fonction de type haar</a> <br><br>  Vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pouvez</a> t√©l√©charger des cascades d√©j√† form√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Dans l'exemple actuel, les cascades seront utilis√©es pour identifier le visage d'une personne face √† face. <br><br>  Pour ce faire, vous devez cr√©er un classificateur et lui fournir un fichier d√©j√† form√© (le lien ci-dessus est donn√©).  J'ai d√©j√† t√©l√©charg√© le fichier pencv_haarcascade_frontalface_default.xml dans le r√©pertoire o√π se trouve notre programme. <br><br><pre> <code class="go hljs">harrcascade := ‚Äúopencv_haarcascade_frontalface_default.xml‚Äùclassifier := gocv.NewCascadeClassifier()classifier.Load(harrcascade) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> classifier.Close()</code> </pre> <br>  Pour d√©tecter des visages dans l'image, vous devez utiliser la m√©thode <a href="">DetectMultiScale</a> .  Cette fonction prend une image (type Mat) qui vient d'√™tre lue dans le flux vid√©o de la cam√©ra et renvoie un tableau de type Rectangle.  La taille du tableau repr√©sente le nombre de faces que le classificateur a pu d√©tecter dans le cadre.  Ensuite, pour nous assurer de voir ce qu'il a trouv√©, parcourons la liste des rectangles et affichons l'objet Rectangle sur la console, cr√©ant une bordure autour du rectangle d√©tect√©.  Cela peut √™tre fait en utilisant la fonction Rectangle.  Il faudra le tapis lu par la cam√©ra, l'objet Rectangle retourn√© par la m√©thode DetectMultiScale, la couleur et l'√©paisseur de la bordure. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, r := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> rects { fmt.Println(‚Äúdetected‚Äù, r) gocv.Rectangle(&amp;img, r, color, <span class="hljs-number"><span class="hljs-number">2</span></span>) }</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/26e/10c/587/26e10c5871175eb78a8f1ec4d65056d0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e0e/572/723/e0e5727236a25895003151ab2f089fb9.png"><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"image/color"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"gocv.io/x/gocv"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { webcam, err := gocv.VideoCaptureDevice(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatalf(<span class="hljs-string"><span class="hljs-string">"error opening web cam: %v"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> webcam.Close() img := gocv.NewMat() <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> img.Close() window := gocv.NewWindow(<span class="hljs-string"><span class="hljs-string">"webcamwindow"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> window.Close() harrcascade := <span class="hljs-string"><span class="hljs-string">"opencv_haarcascade_frontalface_default.xml"</span></span> classifier := gocv.NewCascadeClassifier() classifier.Load(harrcascade) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> classifier.Close() color := color.RGBA{<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ok := webcam.Read(&amp;img); !ok || img.Empty() { log.Println(<span class="hljs-string"><span class="hljs-string">"Unable to read from the device"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } rects := classifier.DetectMultiScale(img) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, r := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> rects { fmt.Println(<span class="hljs-string"><span class="hljs-string">"detected"</span></span>, r) gocv.Rectangle(&amp;img, r, color, <span class="hljs-number"><span class="hljs-number">3</span></span>) } window.IMShow(img) window.WaitKey(<span class="hljs-number"><span class="hljs-number">50</span></span>) } }</code> </pre> <br>  Et ... oui, √ßa a march√©!  Nous avons maintenant un syst√®me de reconnaissance faciale simple √©crit en Go.  Dans un avenir proche, je pr√©vois de poursuivre ces exp√©riences et de cr√©er de nouvelles choses sympas, combinant Go et OpenCV. <br><br>  Si vous √™tes int√©ress√©, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consultez le serveur Web gRPC</a> , que j'ai √©crit en Python et OpenCV.  Il diffuse des donn√©es au moment de la d√©tection de visage.  C'est la base pour cr√©er diff√©rents clients dans diff√©rents langages de programmation.  Ils pourront se connecter au serveur et y lire des donn√©es. <br><br>  Merci d'avoir lu l'article! <br><br><blockquote>  <b>Skillbox recommande:</b> <br><br><ul><li>  Cours pratique de deux ans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Je suis un d√©veloppeur web PRO</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"</a> </li><li>  Cours p√©dagogique en ligne <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Profession Java-d√©veloppeur"</a> . </li><li>  Cours pratique annuel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"D√©veloppeur PHP de 0 √† PRO"</a> . <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462159/">https://habr.com/ru/post/fr462159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462147/index.html">Utilisation de la navigation lors de la refactorisation d'un h√©ritage de projet dans React Native</a></li>
<li><a href="../fr462149/index.html">Mode de restriction d'acc√®s pour les accessoires sur les appareils iOS et comment le contourner</a></li>
<li><a href="../fr462151/index.html">5 principales distributions Kubernetes</a></li>
<li><a href="../fr462153/index.html">Shaders de carte interactive Unity</a></li>
<li><a href="../fr462155/index.html">Travaillez avec Worker ¬´comme vous le souhaitez¬ª, pas ¬´autant que possible¬ª</a></li>
<li><a href="../fr462161/index.html">Exp√©rience d'installation d'Apache Airflow sur Windows 10</a></li>
<li><a href="../fr462163/index.html">Des technologies qui seront populaires en 2020</a></li>
<li><a href="../fr462165/index.html">Comment 25 personnes ont √©t√© amen√©es √† travailler pour une soci√©t√© de jeux inexistante</a></li>
<li><a href="../fr462167/index.html">Contournez la limite de recherche de LinkedIn en jouant avec l'API</a></li>
<li><a href="../fr462169/index.html">Sommaire des actualit√©s sur l'apprentissage automatique et l'intelligence artificielle de juillet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>