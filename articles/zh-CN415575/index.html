<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕋 🕑 🐱 记录PostgreSQL数据库的功能。 第一部分 😓 🌁 👨🏽‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在使用PostgreSQL的过程中，已经积累了一百多个用于处理系统目录的函数：pg_class，pg_attribute，pg_constraints等。 


 该怎么办？ 它们相对很少使用。 包括在任何项目中吗？ 克拉斯诺亚尔斯克客户不会为这种“废话”付款。 但是，如果它们对作者以外的其他人有用...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>记录PostgreSQL数据库的功能。 第一部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415575/"> 在使用PostgreSQL的过程中，已经积累了一百多个用于处理系统目录的函数：pg_class，pg_attribute，pg_constraints等。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zc/rx/ta/zcrxta08dnfat5cqpgid4lyq7by.png"></div><br> 该怎么办？ 它们相对很少使用。 包括在任何项目中吗？ 克拉斯诺亚尔斯克客户不会为这种“废话”付款。 但是，如果它们对作者以外的其他人有用，该怎么办？ 然后，他决定将它们像看书一样放置在公共橱柜中，以备不时之需。 <br><a name="habracut"></a><br> 有人想在他们的工作中使用它们。 和对系统目录的经验感兴趣的人。 <br><br> 但是为了不使出版物变成无聊的枚举，不知道为什么要创建这些功能，我决定着重讨论那些可以实现共同目标的功能。 因此，选择用于显示任意数据库表特征的扩展列表的功能。 <br><br> 数据库表特征的扩展列表由<b>admtf_Table_ComplexFeatures</b>函数返回，该函数在本文中称为head函数。 因此，本文将限于考虑在执行head函数的过程中调用的函数。 <br><br> 本文的前半部分提供了有关功能实现的评论。 第二个是函数的源代码。 对于只对源文本感兴趣的读者，我们建议立即继续阅读<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">附录</a> 。 <br><p>  <b>另请参阅</b> <br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第二部分</a> ;</b> <br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第三部分</a> 。</b> <br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">最后（第四部分）</a> 。</b> <br></p><br><br><a name="ExpFeatures"></a><br><h3> 我们在说什么高级功能？ </h3><br> 为了了解数据库表的扩展特征的含义，我们首先考虑以下特征列表。 该列表包含<b>admtf_Table_ComplexFeatures（ <i>'public'</i> ， <i>'street'</i> ）</b>返回的Street数据库表的特征。 <br><p> 下表包含Street表功能的缩写列表。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">附录2的补充材料中</a>提供了此表的完整特性<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> <br><br>  <strong>表1. Street表的高级功能。</strong> <br><img src="https://habrastorage.org/webt/zj/5x/jn/zj5xjnygaeedplccbe_itjr7fpu.png"><br></p><div class="spoiler">  <b class="spoiler_title">图中表格的文本版本</b> <div class="spoiler_text"><table width="95" border="1"><tbody><tr><th width="5"> 类别分类 </th><th width="5"> 不行 </th><th width="15"> 职称 </th><th width="20"> 评注 </th><th width="20"> 类型 </th><th width="20"> 基本类型 </th><th width="5">  ？ 不为NULL </th></tr><tr><td width="5">  tbl </td><td width="5">  0 </td><td width="15"> 街 </td><td width="20"> 定居点的街道清单 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  att </td><td width="5">  1个 </td><td width="15">  wcrccode </td><td width="20"> 国家区号 </td><td width="20">  wcrccode </td><td width="20">  Smallint </td><td width="5">  Ť </td></tr><tr><td width="5">  att </td><td width="5">  2 </td><td width="15"> 地区性 </td><td width="20"> 社区ID </td><td width="20"> 地区性 </td><td width="20"> 整数 </td><td width="5">  Ť </td></tr><tr><td width="5">  att </td><td width="5">  3 </td><td width="15"> 街头小贩 </td><td width="20"> 村ID街 </td><td width="20"> 街头小贩 </td><td width="20">  Smallint </td><td width="5">  Ť </td></tr><tr><td width="5">  att </td><td width="5">  4 </td><td width="15">  streettypeacrm </td><td width="20"> 街头缩写 </td><td width="20">  streettypeacrm </td><td width="20"> 人物（8） </td><td width="5">  ˚F </td></tr><tr><td width="5">  att </td><td width="5">  5 </td><td width="15"> 街道名 </td><td width="20"> 街道名称 </td><td width="20">  streettypeacrm </td><td width="20">  varchar（150） </td><td width="5">  Ť </td></tr><tr><td width="5">  pk </td><td width="5">  0 </td><td width="15">  xpkstreet </td><td width="20"> 街道表主键 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  pkatt </td><td width="5">  1个 </td><td width="15">  wcrccode </td><td width="20"> 国家区号 </td><td width="20">  wcrccode </td><td width="20">  Smallint </td><td width="5">  Ť </td></tr><tr><td width="5">  fk01 </td><td width="5">  1个 </td><td width="15">  fk_street_locality </td><td width="20"> 表外键 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  fk02 </td><td width="5">  2 </td><td width="15">  fk_street_streettype </td><td width="20"> 表外键 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  idx01 </td><td width="5">  1个 </td><td width="15">  xie1street </td><td width="20"> 按居民点类型和街道名称编制的索引 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  idx02 </td><td width="5">  2 </td><td width="15">  xie2street </td><td width="20"> 邮递区号 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  idx03 </td><td width="5">  3 </td><td width="15">  xie3street </td><td width="20"> 所有定居点的街道名称索引 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5">  idx04 </td><td width="5">  4 </td><td width="15">  xpkstreet </td><td width="20"> 街道表的唯一（主键）索引 </td><td width="20"></td><td width="20"></td><td width="5"></td></tr></tbody></table><br></div></div><br><p> 列举对这组字母和数字的敌意，您可以看到我们正在谈论数据库表的通常特征： </p><br><ul><li> 表名； </li><li> 表属性及其类型的列表； </li><li> 表的主键和外键列表，以及组成它们的表的属性； </li><li> 表索引列表。 </li></ul><br><p> 特性列表中每个条目的唯一性由“类别”字段的值和特性的序列号（“编号”）确保。 </p><br><br>  <strong>表2.表特征的类别。</strong> <br><img src="https://habrastorage.org/webt/sy/j9/5z/syj95z_zta0nii9_9-n7zaxzq3q.png"><br><div class="spoiler">  <b class="spoiler_title">图中表格的文本版本</b> <div class="spoiler_text"><table><tbody><tr><th> 首字母缩写 </th><th> 预约时间 </th></tr><tr><td> 待定 </td><td> 表特征 </td></tr><tr><td>  att </td><td> 表属性特征 </td></tr><tr><td> 序列 </td><td> 序列特征 </td></tr><tr><td>  pk </td><td> 主要关键特征 </td></tr><tr><td>  pkAtt </td><td> 主键属性特征 </td></tr><tr><td>  fk99 </td><td> 外键功能 </td></tr><tr><td>  fk99att </td><td> 外键属性特征 </td></tr><tr><td>  fk99rtbl </td><td> 外键引用表的特征 </td></tr><tr><td>  fk99ratt </td><td> 外键引用的表的属性特征 </td></tr><tr><td> 编号99 </td><td> 指标特征 </td></tr><tr><td>  Idx99att </td><td> 索引属性特征 </td></tr><tr><td>  Inhtbl99 </td><td> 生成表的特征 </td></tr></tbody></table><br></div></div><br><p> 类别值是区分彼此不同的特征组所必需的。 序列号，以区分组内的特征。 </p><br><p> 可以在数据库表中声明几个外键（FOREIGN KEY）和索引。 因此，这些特征及其后代的类别值包含一个序列号。 例如，键为“ Category” = <strong>idx02att</strong>和“ No.” = <strong>1</strong>的条目表示第二个索引的第一个属性。 </p><br><p> 在上面的类别列表中，序列号的位置表示为“ 99”。 </p><br><p>  <strong>备注1</strong> </p><br><img src="https://habrastorage.org/webt/xt/ye/1l/xtye1lr36ssftr4kmvnwedjgnew.png"><br><div class="spoiler">  <b class="spoiler_title">图中操作员的源代码</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> admtf_Table_ComplexFeatures(<span class="hljs-string"><span class="hljs-string">'pg_catalog'</span></span>,<span class="hljs-string"><span class="hljs-string">'pg_class'</span></span>);</code> </pre> <br></div></div><br><br><p> 本文提供了表特性的示例，这些示例在专门为演示功能而创建<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的辅助方案中进行</a>了简要描述。 但是，已经在数据库中创建了该功能的读者可以将其方案和表的名称用作参数。 而且，例如，尽管在这种情况下发出了有限数量的特征，但是<strong>pg_class</strong>目录可以用作参数。 </p><p></p><p>  <strong>备注的结尾。</strong> </p><br><a name="tfTableCF_def"></a><br><h3> 头功能结构 </h3><br><img src="https://habrastorage.org/webt/mn/pw/9w/mnpw9welx2ltfhwiqllgqrp6uyc.png"><br>  <strong>图</strong>  <strong>1.引起头部功能的功能。</strong> <br><br>  <strong>表3.功能分配。</strong> <br><img src="https://habrastorage.org/webt/po/yb/et/poybetf0ogfvr0l95pxzdw5m1yq.png"><br><div class="spoiler">  <b class="spoiler_title">图中表格的文本版本</b> <div class="spoiler_text"><table width="95" border="1"><tbody><tr><th width="5"> 不行 </th><th width="10"> 职称 </th><th width="40"> 预约时间 </th></tr><tr><td width="5">  1个 </td><td width="10">  admtf_Table_Features </td><td width="40"> 该函数返回数据库表特征的列表 </td></tr><tr><td width="5">  2 </td><td width="10">  admtf_Table_Attributes </td><td width="40"> 该函数返回数据库表属性及其特征的列表。 </td></tr><tr><td width="5">  3 </td><td width="10">  admtf_Table_Constraintes </td><td width="40"> 该函数返回数据库表限制及其特征的列表。 </td></tr><tr><td width="5">  4 </td><td width="10">  admtf_Table_Indexes </td><td width="40"> 该函数返回数据库表索引及其特征的列表。 </td></tr><tr><td width="5">  5 </td><td width="10">  admtf_Table_InheritanceChildrens </td><td width="40"> 该函数返回由（IHERITS）从源数据库表生成的表的列表。 </td></tr><tr><td width="5">  6 </td><td width="10">  admtf_Table_Sequences </td><td width="40"> 该函数返回该表所依赖的序列列表（SEQUENCE）。 </td></tr><tr><td width="5">  7 </td><td width="10">  admtf_PrimaryKey_ComplexFeatures </td><td width="40"> 该函数返回数据库表的主键特征（PRIMARY KEY）的完整（扩展）列表。 </td></tr><tr><td width="5">  8 </td><td width="10">  admtf_ForeignKey_ComplexFeatures </td><td width="40"> 该函数返回数据库表的外键特征（FOREIGN KEY）的完整（扩展）列表。 </td></tr><tr><td width="5">  9 </td><td width="10">  admtf_Index_ComplexFeatures </td><td width="40"> 该函数返回数据库表索引特征的完整（扩展）列表。 </td></tr><tr><td width="5">  10 </td><td width="10">  admtf_Table_ComplexFeatures </td><td width="40"> 该函数返回数据库表特征的完整（扩展）列表。 </td></tr></tbody></table><br></div></div><br><p>  <strong>备注2。</strong> </p><br><p> 功能描述将按上面显示的顺序排列。 原因是该文章将必须分为几个部分。 并且可以使用按此顺序排列的功能，而不管其中的某些功能仅在出版物的以下部分中进行描述的事实。 </p><br><p>  <strong>备注的结尾。</strong> </p><br><br><h3>  admtf_Table_Features函数列表数据库的表特征 </h3><br><a name="tfTableF_def"></a><br><br><p>  admtf_Table_Features函数返回数据库表本身的特征列表。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以在此处查看和下载源代码。</a> </p><br><p> 作为参数，此函数采用源表的名称<b>（a_TableName</b> ）和在其中创建表的方案的名称（ <b>a_SchemaName</b> ）。 </p><br><p> 该函数从<b>pg_class</b>目录<b>条目中</b>提取主要数据，除表条目外，该条目还包含有关序列，视图，实例化视图和组合类型的记录。 因此，要选择表，使用条件relkind = <b><font color="red">'r'</font></b> 。 </p><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> tbl.relname,dsc.description,tbl.relnatts::<span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>,tbl.relchecks::<span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>, tbl.relhaspkey,tbl.relhasindex,tbl.relhassubclass,tbl.reltuples::<span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class tbl <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_namespace nspc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> tbl.relnamespace = nspc.oid <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_description dsc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> tbl.oid=dsc.objoid <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> dsc.objsubid=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>( nspc.nspname)=<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(a_SchemaName) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> tbl.relkind=<span class="hljs-string"><span class="hljs-string">'r'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(tbl.relname) =<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(a_TableName);</code> </pre><br><p> 另外，该函数访问目录数据<b>pg_namespace</b>和<b>pg_description</b> 。 第一个包含数据库模式的名称，第二个包含对所有数据库对象的注释。 </p><br><p> 重要的是要注意条件<b>objsubid = 0</b> 。 它定义了表的注释，因为表及其属性的objoid字段的值都相同。 关于表的属性的注释包含在<b>objsubid</b>与该属性的编号匹配的条目中。 </p><br><br>  <strong>表4.执行admtf_Table_Features函数（“ public”，“ Street”）的结果。</strong> <br><br><table width="95" border="1"><tbody><tr><th width="10"> 职称 </th><th width="20"> 评注 </th><th width="5"> 属性数量 </th><th width="5"> 检查约束数 </th><th width="5">  ？ 有主键吗 </th><th width="5">  ？ 是声明的索引 </th><th width="5">  ？ 有后裔吗 </th><th width="5"> 表中的条目数 </th></tr><tr><td width="10"> 街 </td><td width="20"> 定居点的街道清单 </td><td width="5">  22 </td><td width="5">  0 </td><td width="5">  Ť </td><td width="5">  Ť </td><td width="5">  ˚F </td><td width="5">  20150 </td></tr></tbody></table><br><p>  <strong>备注3</strong> </p><br><p> 注意街道表属性的数量。 它与辅助模式中指定的属性数量明显不同。 </p><br><p> 表5. Street表的其他属性。 </p><br><table><tbody><tr><th width="10"> 姓名 </th><th width="5">  tty </th><th width="5">  Attnum </th><th width="10"> 注意事项 </th></tr><tr><td width="10">  in </td><td width="5">  29日 </td><td width="5">  -4 </td><td width="10"> 系统属性 </td></tr><tr><td width="10"> 最小 </td><td width="5">  28 </td><td width="5">  -3 </td><td width="10"> 系统属性 </td></tr><tr><td width="10">  ctid </td><td width="5">  27 </td><td width="5">  -1 </td><td width="5"> 系统属性 </td></tr><tr><td width="10">  wcrccode </td><td width="5">  795369 </td><td width="5">  1个 </td><td width="5"> 有效属性 </td></tr><tr><td width="10"> 地区性 </td><td width="5">  795352 </td><td width="5">  2 </td><td width="10"> 有效属性 </td></tr><tr><td width="10"> 街头小贩 </td><td width="5">  795364 </td><td width="5">  3 </td><td width="10"> 有效属性 </td></tr><tr><td width="10">  streettypeacrm </td><td width="5">  1919168 </td><td width="5">  4 </td><td width="10"> 有效属性 </td></tr><tr><td width="10"> 街道名 </td><td width="5">  1043 </td><td width="5">  5 </td><td width="10"> 有效属性 </td></tr><tr><td width="10">  ..... pg.dropped.6 ........ </td><td width="5">  0 </td><td width="5">  6 </td><td width="10"> 远程属性 </td></tr><tr><td width="10">  ..... pg.dropped.7 ........ </td><td width="5">  0 </td><td width="5">  7 </td><td width="10"> 远程属性 </td></tr></tbody></table><br><p> 事实是，除了主要属性外，PostgreSQL还考虑了几个系统属性，甚至删除了属性。 </p><br><p>  <strong>结束语</strong> </p><br><br><h3> 数据库表属性及其特征的函数admtf_Table_Attributes列表 </h3><a name="tfTableA_def"></a><br><p>  <b>admtf_Table_Attributes</b>函数返回数据库表属性的列表。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以在此处查看和下载源代码。</a> </p><br><p> 该函数将源表的名称（ <b>a_TableName</b> ）和在其中创建表的方案的名称（ <b>a_SchemaName</b> ）作为参数。 </p><br><p> 该函数从<b>pg_attribute</b>和<b>pg_type</b>目录<b>条目中</b>检索主要数据。 第一个记录包含有关表，视图，实例化视图，组合类型甚至函数的属性的数据记录。 第二点是关于属性类型的特征。 </p><br><p> 可能需要通过在函数中定义用户和基本类型的方式进行一些说明。 </p><br><p> 如果在相应的<b>pg_type</b>目录<b>条目中</b>的<b>typbasetype</b>字段<b>大于</b> 0，则使用自定义类型声明表属性，否则，该属性为基本类型。 因此，在FROM子句中两次涉及<b>pg_type</b>目录。 在第一个目录条目中，确定用户类型的存在，如果未定义（ <b>typebasetype = 0</b> ），则从该条目中生成基本类型值。 否则，从btyp.OID = typ.typbasetype的记录中确定基本类型。 </p><br><p> 使用系统目录<b>FORMAT_TYPE（type_oid，typemod）</b>的功能直接形成基本类型的行。 其第一个参数是基本类型OID记录。 第二个参数是包含大小的类型的修饰符值。 例如，VARCHAR（100）或NUMERIC（4,2），DECIMAL（4,2）。 如果属性是用户类型，则从<b>typ.typtypmod中</b>获取<b>typemod</b>参数的值，否则从<b>attr.atttypmod中获取</b> ，即 直接从属性记录。 </p><br><img src="https://habrastorage.org/webt/gv/jx/q0/gvjxq0pb7kjjrv6galmsht5s9do.png"><br><div class="spoiler">  <b class="spoiler_title">图中操作员的源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attr.attnum, attr.attname::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(typ.typbasetype,<span class="hljs-number"><span class="hljs-number">0</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> typ.typname::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, FORMAT_TYPE(<span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(typ.typbasetype,<span class="hljs-number"><span class="hljs-number">0</span></span>),typ.oid), <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(typ.typtypmod,<span class="hljs-number"><span class="hljs-number">-1</span></span>),attr.atttypmod))::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">256</span></span>), attr.attnotnull, dsc.description <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_class tbl <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> tbl.oid = attr.attrelid <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_namespace nspc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> tbl.relnamespace = nspc.oid <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_type typ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> attr.atttypid=typ.oid <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_description dsc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> dsc.objoid=attr.attrelid <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> dsc.objsubid=attr.attnum <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>( nspc.nspname)=<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(a_SchemaName) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(tbl.relname) =<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(a_TableName) <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> tbl.relkind=<span class="hljs-string"><span class="hljs-string">'r'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.attnum&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.atttypID&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> tbl.relname,attr.attnum;</code> </pre><br></div></div><br><p> 另外，该函数访问目录数据<b>pg_class</b> ， <b>pg_namespace</b>和<b>pg_description</b> 。 第一和第二目录用于通过模式和数据库表的名称搜索属性。 <br><br> 第三个目录用于检索表属性的注释。 </p><br><p> 关于表属性的注释在条目中，其中<b>dsc.objoid</b>包含源表的OID，而<b>dsc.objsubid是</b>表中属性<b>的</b>序列号，即  <b>attr.attnum</b> 。 </p><br><p> 为了防止该函数返回系统和远程属性，WHERE子句将条件设置为<b>attr.attnum&gt; 0和attr.atttypID&gt; 0</b> 。 </p><br><br>  <strong>表6.执行admtf_Table_Attributes函数（“ public”，“ Street”）的结果。</strong> <br><br><table width="95" border="1"><tbody><tr><th width="5"> 不行 </th><th width="10"> 职称 </th><th width="20"> 自订类型 </th><th width="20"> 基本类型 </th><th width="5">  ？ 不为空 </th><th width="25"> 评注 </th></tr><tr><td width="5">  1个 </td><td width="10">  wcrccode </td><td width="20">  wcrccode </td><td width="20">  Smallint </td><td width="5">  Ť </td><td width="25"> 国家区号 </td></tr><tr><td width="5">  2 </td><td width="10"> 地区性 </td><td width="20"> 地区性 </td><td width="20"> 整数 </td><td width="5">  Ť </td><td width="25"> 社区ID </td></tr><tr><td width="5">  3 </td><td width="10"> 街头小贩 </td><td width="20"> 街头小贩 </td><td width="20">  Smallint </td><td width="5">  Ť </td><td width="25"> 村ID街 </td></tr><tr><td width="5">  4 </td><td width="10">  streettypeacrm </td><td width="20">  streettypeacrm </td><td width="20"> 人物（8） </td><td width="5">  ˚F </td><td width="25"> 街头缩写 </td></tr><tr><td width="5">  5 </td><td width="10"> 街道名 </td><td width="20"></td><td width="20">  varchar（150） </td><td width="5">  Ť </td><td width="25"> 定居点的街道名称 </td></tr></tbody></table><br><h4> 使用regclass别名作为oid类型的函数版本 </h4><br><p>  PostgreSQL对象标识符（OID）与OID的类型相同，OID当前被实现为无符号的四字节整数。 但是由于存在这种别名，因此可以将整数表示为对象的名称。 反之亦然-将对象名称转换为OID类型的整数。 </p><br><p> 作为示例，请看下面的<b>SELECT语句</b> 。 它会异常地检索属性表的名称及其类型的名称-而不是使用这些特征的名称来访问相应的目录字段，而是使用它们： <br></p><ul><li>  <b>attrelid :: regclass（attrelid :: regclass：NAME）</b> ， </li><li>  <b>atttypid :: regtype（atttypid :: regtype：NAME）</b> </li><li>  <b>typbasetype :: regtype（typbasetype :: regtype：NAME）</b> 。 </li></ul><br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attr.attname,attr.attrelid::regclass, attr.atttypid::regtype, typ.typbasetype::regtype,attr.attrelid::regclass::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, attr.atttypid::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>,typ.typbasetype::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_type typ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> attr.atttypid=typ.oid <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attr.attrelid=(<span class="hljs-string"><span class="hljs-string">'public'</span></span>||<span class="hljs-string"><span class="hljs-string">'.'</span></span>||<span class="hljs-string"><span class="hljs-string">'Street'</span></span>)::regclass <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.attnum&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.atttypID&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> attr.attnum;</code> </pre><br><p> 以下是执行此查询的结果。 </p><br><img src="https://habrastorage.org/webt/zr/4_/ga/zr4_gal9s-8jnhihyjia7cq0xvs.png"><br><p> 在使用OID类型的别名进行转换之前的SELECT运算符的输出值列表中，除属性名称之外的所有值都是数字，因此，将显示表名称和属性类型。 可以在表标题的第二行中考虑输出值的类型。 </p><br><p> 另外，在该语句的WHERE子句中，条件<b>attr.attrelid =（'public'||'。'||'Street'）:: regclass位于</b> ，其左侧是一个数字值，而右侧是一个字符串，该字符串被转换为带有使用别名<b>regclass</b> 。 </p><br><img src="https://habrastorage.org/webt/7v/tl/nh/7vtlnhnhqmr7idtdcebcsffzjik.png"><br><div class="spoiler">  <b class="spoiler_title">图中操作员的源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attr.attnum, attr.attname::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(typ.typbasetype,<span class="hljs-number"><span class="hljs-number">0</span></span>)&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> typ.typname::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>, FORMAT_TYPE(<span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(typ.typbasetype,<span class="hljs-number"><span class="hljs-number">0</span></span>),typ.oid), <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">NULLIF</span></span>(typ.typtypmod,<span class="hljs-number"><span class="hljs-number">-1</span></span>),attr.atttypmod))::<span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">256</span></span>), attr.attnotnull, dsc.description <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_type typ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> attr.atttypid=typ.oid <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OUTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_description dsc <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> dsc.objoid=attr.attrelid <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> dsc.objsubid=attr.attnum <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attr.attrelid=( a_SchemaName ||<span class="hljs-string"><span class="hljs-string">'.'</span></span>|| a_TableName)::regclass <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.attnum&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.atttypID&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> attr.attnum;</code> </pre><br></div></div><br> 使用main语句中的别名regclass，可以删除与两个目录的连接。 但是这种改进几乎对功能的性能没有影响-在两个版本中，该功能都在11毫秒内执行。 可能由于测试表几乎没有属性的事实。 <br>  <b>备注4</b> <br><p> 当数据库中存在具有异常名称的模式和/或表时，就会表现出<b>attr.attrelid =（a_SchemaName ||'。'|| a_TableName）:: regclass</b>形式的条件中的严重缺陷。 例如， <b>“我的模式”</b>和/或<b>“我的表”</b> 。 此类值必须使用双引号括起来或使用QUOTE_IDENT函数进行传输，否则该函数将因系统错误而失败。 </p><br><img src="https://habrastorage.org/webt/jt/ak/nv/jtaknvaqwphry4yla4bnlemrdeq.png"><br><div class="spoiler">  <b class="spoiler_title">图中操作员的源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/*       «   »*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attr.attname,attr.attrelid::regclass, attr.atttypid::regtype,typ.typbasetype::regtype, attr.attrelid::regclass::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, attr.atttypid::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>,typ.typbasetype::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_type typ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> attr.atttypid=typ.oid <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attr.attrelid=(<span class="hljs-string"><span class="hljs-string">' '</span></span>||<span class="hljs-string"><span class="hljs-string">'.'</span></span>||<span class="hljs-string"><span class="hljs-string">' '</span></span>)::regclass <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.attnum&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.atttypID&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> attr.attnum; <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attr.attname,attr.attrelid::regclass, attr.atttypid::regtype,typ.typbasetype::regtype, attr.attrelid::regclass::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>, attr.atttypid::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span>,typ.typbasetype::regtype::<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">attr</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> pg_type typ <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> attr.atttypid=typ.oid <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attr.attrelid=(<span class="hljs-string"><span class="hljs-string">'" "'</span></span>||<span class="hljs-string"><span class="hljs-string">'.'</span></span>||<span class="hljs-string"><span class="hljs-string">'" "'</span></span>)::regclass <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.attnum&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attr.atttypID&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> attr.attnum;</code> </pre><br></div></div><br> 因此，我更喜欢使用<b>LOWER（nspc.nspname）= LOWER（a_SchemaName）和LOWER（tbl.relname）= LOWER（a_TableName）形式的条件</b> ，这不会导致系统错误。 <br><br>  <b>结束语</b> <br><a name="Script1"></a><br><h2> 附录1.脚本 </h2><a name="tfTableF"></a><br><h3> 创建admtf_Table_Features函数 </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关功能源代码的注释，请参见此处。</a> <br><div class="spoiler">  <b class="spoiler_title">函数源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRANSACTION</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> admtf_Table_Features (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>); <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*     ,   */</span></span> <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> admtf_Table_Features (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'public'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> (rs_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,rs_TableDescription <span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span>,rs_NumberOfAttribute <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>,rs_NumberOfChecks <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>,rs_hasPKey <span class="hljs-built_in"><span class="hljs-built_in">BOOLEAN</span></span>,rs_hasIndex <span class="hljs-built_in"><span class="hljs-built_in">BOOLEAN</span></span>,rs_hasSubClass <span class="hljs-built_in"><span class="hljs-built_in">BOOLEAN</span></span>,rs_NumberOfRow <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">BODY</span></span>$ <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> c_TableKind <span class="hljs-keyword"><span class="hljs-keyword">CONSTANT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CHAR</span></span>:=<span class="hljs-string"><span class="hljs-string">'r'</span></span>; v_TableOID OID; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> v_TableName NAME; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> v_TableDescription TEXT; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> v_TableNumberOfRowCalc INTEGER; <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-comment"><span class="hljs-comment">--****************************************************************************************************** BEGIN SELECT INTO rs_TableName,rs_TableDescription,rs_NumberOfAttribute, rs_NumberOfChecks,rs_hasPKey,rs_hasIndex,rs_hasSubClass, rs_NumberOfRow tbl.relname,dsc.description,tbl.relnatts::INTEGER,tbl.relchecks::INTEGER, tbl.relhaspkey,tbl.relhasindex,tbl.relhassubclass,tbl.reltuples::INTEGER FROM pg_class tbl INNER JOIN pg_namespace nspc ON tbl.relnamespace = nspc.oid LEFT OUTER JOIN pg_Description dsc ON tbl.oid=dsc.objoid AND dsc.objsubid=0 WHERE nspc.nspname=LOWER(a_SchemaName) AND tbl.relkind=c_TableKind AND tbl.relname =LOWER(a_TableName); EXECUTE 'SELECT count(*) FROM ' ||LOWER(a_SchemaName) ||'.'||quote_ident(LOWER(a_TableName)) INTO v_TableNumberOfRowCalc; RETURN QUERY SELECT rs_TableName,rs_TableDescription,rs_NumberOfAttribute, rs_NumberOfChecks,rs_hasPKey,rs_hasIndex, rs_hasSubClass,v_TableNumberOfRowCalc AS rs_NumberOfRow; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Features(a_SchemaName NAME,a_TableName NAME) IS '   ,  '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; BEGIN TRANSACTION; DROP FUNCTION IF EXISTS admtf_Table_Features (a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)); /********************************************************************************************************/ /*     ,   */ /********************************************************************************************************/ CREATE OR REPLACE FUNCTION admtf_Table_Features (a_SchemaName VARCHAR(256) default 'public', /*     */ a_TableName VARCHAR(256) default NULL /*   */ ) RETURNS TABLE (rs_TableName VARCHAR(256),rs_TableDescription TEXT,rs_NumberOfAttribute INTEGER,rs_NumberOfChecks INTEGER,rs_hasPKey BOOLEAN,rs_hasIndex BOOLEAN,rs_hasSubClass BOOLEAN,rs_NumberOfRow INTEGER) AS $BODY$ DECLARE c_TableKind CONSTANT CHAR:='r'; v_TableOID OID; /*   */ v_TableName VARCHAR(256); /*   */ v_TableDescription TEXT; /*   */ v_TableNumberOfRowCalc INTEGER; /*     */ --****************************************************************************************************** BEGIN RETURN QUERY SELECT tf.rs_TableName::VARCHAR(256), tf.rs_TableDescription::TEXT, tf.rs_NumberOfAttribute::INTEGER, tf.rs_NumberOfChecks::INTEGER, tf.rs_hasPKey::BOOLEAN, tf.rs_hasIndex::BOOLEAN, tf.rs_hasSubClass::BOOLEAN, tf.rs_NumberOfRow::INTEGER FROM admtf_Table_Features(a_SchemaName::NAME,a_TableName::NAME) tf; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Features(a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)) IS '   ,  '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; SELECt * FROM admtf_Table_Features('public'::VARCHAR(256),'Street'::VARCHAR(256)); SELECt * FROM admtf_Table_Features('public':: NAME,'Street'::NAME);</span></span></code> </pre><br></div></div><br><a name="tfTableA"></a><br><h3> 创建admtf_Table_Attributes函数 </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关功能源代码的注释，请参见此处。</a> <br><div class="spoiler">  <b class="spoiler_title">函数源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRANSACTION</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> admtf_Table_Attributes (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>); <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> admtf_Table_Attributes (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'public'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> (r_AttributeNumber <span class="hljs-built_in"><span class="hljs-built_in">SMALLINT</span></span>,r_AttributeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_UserTypeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_TypeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_isNotNULL <span class="hljs-built_in"><span class="hljs-built_in">BOOLEAN</span></span>, r_Description <span class="hljs-built_in"><span class="hljs-built_in">Text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">BODY</span></span>$ <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> c_TableKind <span class="hljs-keyword"><span class="hljs-keyword">CONSTANT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CHAR</span></span>:=<span class="hljs-string"><span class="hljs-string">'r'</span></span>; v_Scale INTEGER; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-comment"><span class="hljs-comment">--****************************************************************************************************** BEGIN RETURN QUERY SELECT attr.attnum AS r_AttributeNumber, attr.attname::NAME AS r_AttributeName, CASE WHEN COALESCE(typ.typbasetype,0)&gt;0 THEN typ.typname::NAME ELSE ''::NAME END AS r_UserTypeName, FORMAT_TYPE(COALESCE(NULLIF(typ.typbasetype,0),typ.oid), COALESCE(NULLIF(typ.typtypmod,-1),attr.atttypmod))::NAME AS r_TypeName, attr.attnotnull AS r_isNotNULL, dsc.description AS r_Description FROM pg_attribute attr INNER JOIN pg_class tbl ON tbl.oid = attr.attrelid INNER JOIN pg_namespace nsp ON tbl.relnamespace=nsp.oid LEFT OUTER JOIN pg_type typ ON attr.atttypid=typ.oid LEFT OUTER JOIN pg_type btyp ON typ.typbasetype=btyp.oid LEFT OUTER JOIN pg_description dsc ON dsc.objoid=attr.attrelid AND dsc.objsubid=attr.attnum WHERE LOWER(nsp.nspname)=LOWER(a_SchemaName) AND LOWER(tbl.relname)=LOWER(a_TableName) AND tbl.relkind=c_TableKind AND attr.attnum&gt;0 AND attr.atttypID&gt;0 ORDER BY tbl.relname,attr.attnum; RETURN; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Attributes(a_SchemaName NAME,a_TableName NAME) IS '   '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; BEGIN TRANSACTION; DROP FUNCTION IF EXISTS admtf_Table_Attributes (a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)); /********************************************************************************************************/ /*      */ /********************************************************************************************************/ CREATE OR REPLACE FUNCTION admtf_Table_Attributes (a_SchemaName VARCHAR(256) default 'public', /*     */ a_TableName VARCHAR(256) default NULL /*   */ ) RETURNS TABLE (r_AttributeNumber SMALLINT,r_AttributeName VARCHAR(256),r_UserTypeName VARCHAR(256),r_TypeName VARCHAR(256),r_isNotNULL BOOLEAN, r_Description Text) AS $BODY$ DECLARE c_TableKind CONSTANT CHAR:='r'; v_Scale INTEGER; /*   */ --****************************************************************************************************** BEGIN RETURN QUERY SELECT ta.r_AttributeNumber::SMALLINT, ta.r_AttributeName::VARCHAR(256), ta.r_UserTypeName::VARCHAR(256), ta.r_TypeName::VARCHAR(256), ta.r_isNotNULL::BOOLEAN, ta.r_Description::TEXT FROM admtf_Table_Attributes(a_SchemaName::NAME,a_TableName::NAME) ta; RETURN; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Attributes(a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)) IS '   '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; SELECT * FROM admtf_Table_Attributes('public'::VARCHAR(256),'Street'::VARCHAR(256)); SELECT * FROM admtf_Table_Attributes('public'::NAME,'Street'::NAME);</span></span></code> </pre><br></div></div><br><h3> 使用Regclass别名创建admtf_Table_Attributes函数 </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关功能源代码的注释，请参见此处。</a> <br><div class="spoiler">  <b class="spoiler_title">函数源代码</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRANSACTION</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">DROP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> admtf_Table_Attributes (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>); <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-comment"><span class="hljs-comment">/********************************************************************************************************/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> admtf_Table_Attributes (a_SchemaName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-string"><span class="hljs-string">'public'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> a_TableName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> (r_AttributeNumber <span class="hljs-built_in"><span class="hljs-built_in">SMALLINT</span></span>,r_AttributeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_UserTypeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_TypeName <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span>,r_isNotNULL <span class="hljs-built_in"><span class="hljs-built_in">BOOLEAN</span></span>, r_Description <span class="hljs-built_in"><span class="hljs-built_in">Text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">BODY</span></span>$ <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> c_TableKind <span class="hljs-keyword"><span class="hljs-keyword">CONSTANT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">CHAR</span></span>:=<span class="hljs-string"><span class="hljs-string">'r'</span></span>; v_Scale INTEGER; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-comment"><span class="hljs-comment">--****************************************************************************************************** BEGIN RETURN QUERY SELECT attr.attnum AS r_AttributeNumber, attr.attname::NAME AS r_AttributeName, CASE WHEN COALESCE(typ.typbasetype,0)&gt;0 THEN typ.typname::NAME ELSE ''::NAME END AS r_UserTypeName, FORMAT_TYPE(COALESCE(NULLIF(typ.typbasetype,0),typ.oid), COALESCE(NULLIF(typ.typtypmod,-1),attr.atttypmod))::NAME AS r_TypeName, attr.attnotnull AS r_isNotNULL, dsc.description AS r_Description FROM pg_attribute attr INNER JOIN pg_type typ ON attr.atttypid=typ.oid LEFT OUTER JOIN pg_type btyp ON typ.typbasetype=btyp.oid LEFT OUTER JOIN pg_description dsc ON dsc.objoid=attr.attrelid AND dsc.objsubid=attr.attnum WHERE attr.attrelid=(LOWER(a_SchemaName)||'.'|| LOWER(a_TableName))::regclass AND attr.attnum&gt;0 AND attr.atttypID&gt;0 ORDER BY attr.attnum; RETURN; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Attributes(a_SchemaName NAME,a_TableName NAME) IS '   '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; BEGIN TRANSACTION; DROP FUNCTION IF EXISTS admtf_Table_Attributes (a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)); /********************************************************************************************************/ /*      */ /********************************************************************************************************/ CREATE OR REPLACE FUNCTION admtf_Table_Attributes (a_SchemaName VARCHAR(256) default 'public', /*     */ a_TableName VARCHAR(256) default NULL /*   */ ) RETURNS TABLE (r_AttributeNumber SMALLINT,r_AttributeName VARCHAR(256),r_UserTypeName VARCHAR(256),r_TypeName VARCHAR(256),r_isNotNULL BOOLEAN, r_Description Text) AS $BODY$ DECLARE c_TableKind CONSTANT CHAR:='r'; v_Scale INTEGER; /*   */ --****************************************************************************************************** BEGIN RETURN QUERY SELECT ta.r_AttributeNumber::SMALLINT, ta.r_AttributeName::VARCHAR(256), ta.r_UserTypeName::VARCHAR(256), ta.r_TypeName::VARCHAR(256), ta.r_isNotNULL::BOOLEAN, ta.r_Description::TEXT FROM admtf_Table_Attributes(a_SchemaName::NAME,a_TableName::NAME) ta; RETURN; END $BODY$ LANGUAGE plpgsql; COMMENT ON FUNCTION admtf_Table_Attributes(a_SchemaName VARCHAR(256),a_TableName VARCHAR(256)) IS '   '; --ROLLBACK TRANSACTION; COMMIT TRANSACTION; SELECT * FROM admtf_Table_Attributes('public'::VARCHAR(256),'Street'::VARCHAR(256)); SELECT * FROM admtf_Table_Attributes('public'::NAME,'Street'::NAME);</span></span></code> </pre><br></div></div><br><a name="Apendix2"></a><br><h2> 附录2.其他材料 </h2><br><h3> 辅助数据库架构 </h3><br><a name="scheme_for_tests"></a><br><img src="https://habrastorage.org/webt/qi/rb/9q/qirb9qyb5nzkn3hef8v7pvgyvvs.png"><br><br><ul><li>  <b>国家</b> -世界<b>国家</b>分类-OKSM（世界国家的全俄分类）； </li><li>  <b>HOUSEADDR-</b>定居点街道上的门牌号码列表； </li><li>  <b>LCLTYTYPE-</b>结算类型目录； </li><li>  <b>地点</b> -和解清单； </li><li> <b>STREET</b> —     ; </li><li> <b>STREETTYPE</b> —   ; </li><li> <b>TERRITORY</b> —   (, , ,   ..); </li><li> <b>TERRITORYTYPE</b> —   . </li></ul><br><br><a name="Street_char"></a><br><h3>    Street () </h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">        .</a> <br> <strong> 1.    Street ().</strong> <br><img src="https://habrastorage.org/webt/vw/ze/rp/vwzerpaegckljldqsmbrq22zf_m.png"><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><table width="95" border="1"><tbody><tr><th width="5"> 类别分类 </th><th width="5"> 不行 </th><th width="15"> 职称 </th><th width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 评注 </font></font></th><th width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 类型 </font></font></th><th width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 基本类型 </font></font></th><th width="5">  ？<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不为空 </font></font></th></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tbl </font></font></td><td width="5">  0 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 定居点的街道清单 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> att </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 国家区号 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> att </font></font></td><td width="5">  2 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 社区ID </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 整数 </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> att </font></font></td><td width="5">  3 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头小贩 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 村ID街 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头小贩 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> att </font></font></td><td width="5">  4 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头缩写 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 人物（8） </font></font></td><td width="5">  ˚F </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> att </font></font></td><td width="5">  5 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街道名 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街道名称 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> varchar（150） </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pk </font></font></td><td width="5">  0 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> xpkstreet </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街道表主键 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pkatt </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 国家区号 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pkatt </font></font></td><td width="5">  2 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 社区ID </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 整数 </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pkatt </font></font></td><td width="5">  3 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头小贩 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 村ID街 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头小贩 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01 </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk_street_locality </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 表外键 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01att </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 国家区号 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01att </font></font></td><td width="5">  2 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 社区ID </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 整数 </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01rtbl </font></font></td><td width="5">  0 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 和解清单 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01ratt </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 国家区号 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wcrccode </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smallint </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk01ratt </font></font></td><td width="5">  2 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 社区ID </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地区性 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 整数 </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk02 </font></font></td><td width="5">  2 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk_street_streettype </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 表外键 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk02att </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头缩写 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 人物（8） </font></font></td><td width="5">  ˚F </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk02rtbl </font></font></td><td width="5">  0 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街道型 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街道类型参考 </font></font></td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fk02ratt </font></font></td><td width="5">  1个 </td><td width="15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 街头缩写 </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> streettypeacrm </font></font></td><td width="20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 人物（8） </font></font></td><td width="5">  Ť </td></tr><tr><td width="5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> idx01 </font></font></td><td width="5">  1个 </td><td width="15"> xie1street </td><td width="20">         </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"> idx01att </td><td width="5">  1个 </td><td width="15"> wcrccode </td><td width="20">   </td><td width="20"> wcrccode </td><td width="20"> smallint </td><td width="5">  Ť </td></tr><tr><td width="5"> idx01att </td><td width="5">  2 </td><td width="15"> localityid </td><td width="20">    </td><td width="20"> localityid </td><td width="20"> integer </td><td width="5">  Ť </td></tr><tr><td width="5"> idx01att </td><td width="5">  3 </td><td width="15"> streettypeacrm </td><td width="20">    </td><td width="20"> streettypeacrm </td><td width="20"> character(8) </td><td width="5">  ˚F </td></tr><tr><td width="5"> idx01att </td><td width="5">  4 </td><td width="15"> streetname </td><td width="20">     </td><td width="20"></td><td width="20"> varchar(150) </td><td width="5">  Ť </td></tr><tr><td width="5"> idx02 </td><td width="5">  2 </td><td width="15"> xie2street </td><td width="20">       </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"> idx02att </td><td width="5">  1个 </td><td width="15"> wcrccode </td><td width="20">   </td><td width="20"> wcrccode </td><td width="20"> smallin </td><td width="5">  Ť </td></tr><tr><td width="5"> idx02att </td><td width="5">  2 </td><td width="15"> localityid </td><td width="20">    </td><td width="20"> localityid </td><td width="20"> integer </td><td width="5">  Ť </td></tr><tr><td width="5"> idx02att </td><td width="5">  3 </td><td width="15"> streetname </td><td width="20">     </td><td width="20"></td><td width="20"> varchar(150) </td><td width="5">  Ť </td></tr><tr><td width="5"> idx03 </td><td width="5">  3 </td><td width="15"> xie3street </td><td width="20">        </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"> idx03att </td><td width="5">  1个 </td><td width="15"> streetname </td><td width="20">     </td><td width="20"></td><td width="20"> varchar(150) </td><td width="5">  Ť </td></tr><tr><td width="5"> idx04 </td><td width="5">  4 </td><td width="15"> xpkstreet </td><td width="20">   ( )  street </td><td width="20"></td><td width="20"></td><td width="5"></td></tr><tr><td width="5"> idx04att </td><td width="15">  1个 </td><td width="15"> wcrccode </td><td width="20">   </td><td width="20"> wcrccode </td><td width="20"> smallint </td><td width="5">  Ť </td></tr><tr><td width="5"> idx04att </td><td width="5">  2 </td><td width="15"> localityid </td><td width="20">    </td><td width="20"> localityid </td><td width="20"> integer </td><td width="5">  Ť </td></tr><tr><td width="5"> idx04att </td><td width="5">  3 </td><td width="15"> streetid </td><td width="20">     </td><td width="20"> streetid </td><td width="20"> smallint </td><td width="5">  Ť </td></tr></tbody></table><br></div></div><br><h3> 另请参阅 </h3><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b> <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> ;</b> <br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第三部分</a> 。</b> <br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">记录PostgreSQL数据库的功能。</a></b>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">最后（第四部分）</a> 。</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN415575/">https://habr.com/ru/post/zh-CN415575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN415565/index.html">为什么（今天）返回444并不总是有用的</a></li>
<li><a href="../zh-CN415567/index.html">广播h264视频，而无需从Logitech C920摄像机进行转码</a></li>
<li><a href="../zh-CN415569/index.html">如何设置ubuntu 18.04 sendmail + DKIM + SPF + DMARC或我如何设法进入Gmail堡垒</a></li>
<li><a href="../zh-CN415571/index.html">kaggle：IEEE的相机模型识别</a></li>
<li><a href="../zh-CN415573/index.html">以Blender软件为例优化3D打印模型</a></li>
<li><a href="../zh-CN415577/index.html">“ DBMS技术与开发”课程的幻灯片</a></li>
<li><a href="../zh-CN415579/index.html">学习OpenGL。 第5.5课-法线映射</a></li>
<li><a href="../zh-CN415581/index.html">国际金融科技-摘要：有关该行业最重要事物的12条新闻</a></li>
<li><a href="../zh-CN415587/index.html">StereoPi-我们用于研究计算机视觉，无人机和机器人的硬件</a></li>
<li><a href="../zh-CN415589/index.html">“关于PD的更多信息”：美国电视公司将停止出售客户地理数据</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>