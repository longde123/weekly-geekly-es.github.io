<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòù üìπ ü§æ Quelques mots pour d√©fendre le monolithe üé∫ üë®üèæ‚Äçüé§ ü¶ç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous comparons les caract√©ristiques des microservices et de l'architecture monolithique, leurs avantages et leurs inconv√©nients. L'article a √©t√© pr√©pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Quelques mots pour d√©fendre le monolithe</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/453932/">  Nous comparons les caract√©ristiques des microservices et de l'architecture monolithique, leurs avantages et leurs inconv√©nients.  L'article a √©t√© pr√©par√© pour Habr sur la base des documents de notre m√©ta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hot Backend</a> , qui s'est tenu √† Samara le 9 f√©vrier 2019.  Nous consid√©rons les facteurs du choix de l'architecture en fonction de la t√¢che sp√©cifique. <a name="habracut"></a><br><br>  Il y a encore 5 ans, personne n'avait entendu parler des microservices.  Cependant, leur popularit√© augmente d'ann√©e en ann√©e, selon les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">statistiques de</a> Google Trends. <br><br><img src="https://habrastorage.org/webt/1_/of/jd/1_ofjdwx6pauxathtq1srtfdsas.png"><br><br><h2>  Monolith et microservices: exemples </h2><br>  Si le projet utilise une architecture monolithique, le d√©veloppeur n'a qu'une seule application, dont tous les composants et modules fonctionnent avec une seule base. <br><br><img src="https://habrastorage.org/webt/8q/pt/px/8qptpxklg15wtydbx847sqk2c9o.jpeg"><br><br>  L'architecture de microservice implique la d√©composition en modules qui s'ex√©cutent en tant que processus distincts et peuvent avoir des serveurs distincts.  Chaque microservice fonctionne avec sa propre base de donn√©es et tous ces services peuvent communiquer entre eux de mani√®re synchrone (http) et asynchrone.  De plus, pour optimiser l'architecture, il est souhaitable de minimiser la relation entre les services. <br><br>  Le sch√©ma ci-dessous est simplifi√©, il refl√®te tout d'abord les composantes m√©tiers. <br><br><img src="https://habrastorage.org/webt/q2/gi/y-/q2giy-br8pq2amiqihkrkzmn2e4.jpeg"><br><br><h2>  Microservices: avantages </h2><br>  L'architecture de microservices pr√©sente au moins quatre avantages: <br><br>  <b>Mise √† l'√©chelle et d√©ploiement ind√©pendants</b> <br><br>  Un d√©ploiement ind√©pendant est fourni pour chaque microservice, ce qui est pratique lors de la mise √† jour de modules individuels.  Si la charge sur le module augmente, le microservice correspondant peut √™tre mis √† l'√©chelle sans affecter les autres.  Cela vous permet de r√©partir la charge de mani√®re flexible et d'√©conomiser des ressources. <br><br>  <b>D√©veloppement ind√©pendant</b> <br><br>  Chaque microservice (par exemple, un module de m√©moire) peut √™tre d√©velopp√© par une √©quipe pour augmenter la vitesse de cr√©ation d'un produit logiciel. <br><br>  <b>Durabilit√©</b> <br><br>  La d√©faillance d'un microservice n'affecte pas les performances des autres modules. <br><br>  <b>H√©t√©rog√©n√©it√©</b> <br><br>  Chaque √©quipe est libre de choisir son propre langage et sa propre technologie pour la mise en ≈ìuvre des microservices, cependant, il est souhaitable qu‚Äôelles disposent d‚Äôinterfaces compatibles. <br><br>  Parmi les d√©veloppeurs, vous pouvez entendre l'opinion selon laquelle l'architecture monolithique est obsol√®te, elle est difficile √† maintenir et √† mettre √† l'√©chelle, elle se d√©veloppe rapidement dans un ¬´gros morceau de salet√©¬ª et est pratiquement sans motif, c'est-√†-dire que sa pr√©sence dans le code n'est pas souhaitable.  Les grandes entreprises, telles que Netflix, qui sont pass√©es √† l'architecture de microservices dans leurs projets, sont souvent cit√©es comme preuve de cette opinion. <br><br>  Voyons si tout le monde devrait vraiment passer d'un monolithe √† des microservices √† l'instar des plus grandes marques? <br><br>
<h2>  Passage aux microservices: difficult√©s possibles </h2><br>  <b>Probl√®me un: d√©composition</b> <br><br>  Id√©alement, l'application doit √™tre divis√©e en microservices afin qu'ils interagissent le moins possible les uns avec les autres, sinon l'application sera difficile √† maintenir.  Dans le m√™me temps, la d√©composition est difficile √† mettre en ≈ìuvre au d√©but du d√©veloppement, lorsque les probl√®mes commerciaux et le domaine peuvent encore changer avec l'av√®nement de nouvelles exigences.  Le refactoring co√ªte cher. <br><br>  S'il devient n√©cessaire de transf√©rer une partie des fonctions du service A vers le service B, alors des difficult√©s sont possibles ici: par exemple, les services sont ex√©cut√©s dans diff√©rentes langues, les appels internes aux services deviennent r√©seau, d'autres biblioth√®ques doivent √™tre connect√©es.  Nous ne pouvons v√©rifier l'exactitude de la refactorisation qu'√† l'aide de tests. <br><br><img src="https://habrastorage.org/webt/ms/sb/zd/mssbzdbu2gw0mkt3xxsxd7cozuo.jpeg"><br><br>  <b>Deuxi√®me probl√®me: les transactions</b> <br><br>  Un autre probl√®me est que les microservices n'ont pas le concept de transactions distribu√©es.  Nous ne pouvons garantir l'int√©grit√© architecturale d'une op√©ration commerciale que dans un seul microservice.  Si l'op√©ration implique plusieurs microservices, diff√©rentes bases de donn√©es peuvent y √™tre utilis√©es, et une telle transaction devra √™tre abandonn√©e.  Pour r√©soudre ce probl√®me, il existe diff√©rentes m√©thodes utilis√©es en entreprise lorsque l'accessibilit√© est plus importante que l'int√©grit√©.  Dans le m√™me temps, des m√©canismes de compensation sont pr√©vus en cas de probl√®me.  Par exemple, si les marchandises ne sont pas en stock, vous devez effectuer un remboursement sur le compte de l'acheteur. <br><br>  Si un monolithe nous donne automatiquement l'int√©grit√© architecturale, alors avec les microservices, vous devez cr√©er votre propre m√©canisme et utiliser des biblioth√®ques avec des solutions pr√™tes √† l'emploi.  Lors de la distribution d'une op√©ration entre les services, il est pr√©f√©rable de demander des donn√©es de mani√®re synchrone et d'effectuer les actions suivantes de mani√®re asynchrone.  S'il est impossible d'acc√©der √† l'un des services, l'√©quipe sera mise en file d'attente d√®s qu'elle sera de nouveau disponible. <br><br>  √Ä cet √©gard, il est n√©cessaire de r√©viser l'approche de l'interface utilisateur.  L'utilisateur doit √™tre inform√© que certaines actions ne sont pas effectu√©es imm√©diatement, mais dans un certain d√©lai.  Lorsque la demande est trait√©e, il re√ßoit une invitation √† voir les r√©sultats. <br><br><img src="https://habrastorage.org/webt/j3/ms/1m/j3ms1mf_jzbabdwangp62th2uru.jpeg"><br><br>  <b>Troisi√®me probl√®me: rapports</b> <br><br>  Si nous utilisons une architecture monolithique avec une seule base de donn√©es, pour cr√©er un rapport complexe, vous pouvez √©crire s√©lectionner et tirer plusieurs √©tiquettes de donn√©es: t√¥t ou tard, elles seront affich√©es.  Cependant, sur les microservices, ces donn√©es peuvent √™tre dispers√©es sur diff√©rentes bases. <br><br>  Par exemple, nous devons r√©pertorier les entreprises avec des mesures sp√©cifiques.  Avec une simple liste d'entreprises, tout fonctionne.  Et si vous devez ajouter des mesures qui se trouvent dans une autre base de donn√©es?  Oui, nous pouvons faire une demande suppl√©mentaire et demander des mesures par TIN.  Et si cette liste doit √™tre filtr√©e et tri√©e?  La liste des entreprises peut √™tre tr√®s longue, puis nous devons introduire un service suppl√©mentaire avec sa propre base de donn√©es - des rapports. <br><br><img src="https://habrastorage.org/webt/lz/kq/sn/lzkqsn07kbbjovz9_rttgfqbfmg.jpeg"><br><br>  <b>Quatri√®me probl√®me: Complexit√© de d√©veloppement √©lev√©e</b> <br><br>  Le travail sur les services distribu√©s est plus compliqu√©: toutes les demandes sont faites sur le r√©seau et peuvent √™tre d√©sactiv√©es, vous devez fournir un m√©canisme de rappel (refera-t-il l'appel? Combien de fois?).  Ce sont les ¬´briques¬ª qui s'accumulent progressivement et contribuent √† augmenter la complexit√© du projet. <br><br>  Les services peuvent √™tre d√©velopp√©s par plusieurs √©quipes diff√©rentes, et vous devez les documenter, maintenir la documentation √† jour, avertir les autres √©quipes lors du changement de version.  Ce sont des co√ªts de main-d'≈ìuvre suppl√©mentaires. <br><br>  Si chaque √©quipe a un d√©ploiement ind√©pendant, vous devez conserver au moins la version pr√©c√©dente et la d√©sactiver uniquement apr√®s que tous les consommateurs du service sont pass√©s √† la nouvelle API. <br>  Bien s√ªr, nous pouvons int√©grer toutes les API dans une sorte d'artefact qui sera accessible au public.  Mais, premi√®rement, les services peuvent √™tre √©crits dans diff√©rentes langues, et deuxi√®mement, ce n'est pas recommand√©.  Par exemple, dans l'un de nos projets, nous l'avons refus√© √† la demande du client, pour des raisons de s√©curit√©.  Chaque microservice poss√®de un r√©f√©rentiel distinct et le client ne leur donne pas acc√®s. <br><br>  Dans le processus de d√©veloppement, tout peut fonctionner correctement, puis - non.  Il arrive qu'en cas d'exceptions, l'application essaie √† l'infini de les traiter, et cela donne une grosse charge - tout le syst√®me "se couche".  Pour √©viter de telles situations, vous devez tout configurer, par exemple pour limiter le nombre de tentatives, pour ne pas renvoyer cet appel √† la file d'attente dans la m√™me seconde, etc. <br><br><img src="https://habrastorage.org/webt/_w/jd/oj/_wjdoj3ln-k7ysfb6wuh8kz1ycg.jpeg"><br><br><img src="https://habrastorage.org/webt/ae/rr/xc/aerrxc3udwi9pgafnmkzc7xy2du.jpeg"><br><br>  <b>Le cinqui√®me probl√®me: la complexit√© des tests, du tra√ßage et du d√©bogage</b> <br><br>  Pour tester un probl√®me, vous devez t√©l√©charger tous les microservices concern√©s.  Le d√©bogage devient une t√¢che non triviale et tous les journaux doivent √™tre collect√©s quelque part en un seul endroit.  Dans ce cas, vous avez besoin d'autant de journaux que possible pour comprendre ce qui s'est pass√©.  Pour suivre le probl√®me, vous devez comprendre tout le chemin parcouru par le message.  Les tests unitaires ne suffisent pas ici, car des erreurs sont probables √† la jonction des services.  Lors des modifications, il est possible de v√©rifier l'op√©rabilit√© uniquement apr√®s avoir ex√©cut√© sur le support.  Nous pouvons limiter chaque microservice √† une certaine quantit√© de m√©moire (par exemple, 500 m√©gaoctets), mais il y a des p√©riodes de charge maximale quand cela prend jusqu'√† deux gigaoctets.  Il y a des moments o√π le syst√®me commence √† ralentir.  Par cons√©quent, les ressources peuvent √™tre d√©pens√©es pour quelque chose qui n'appartient pas aux t√¢ches imm√©diates du client: par exemple, il n'y a que deux microservices d'entreprise et la moiti√© des ressources sont d√©pens√©es pour trois microservices suppl√©mentaires qui soutiennent le travail des autres. <br><br><img src="https://habrastorage.org/webt/pl/bn/36/plbn36qdp9gnyslu-b0xbecfo7c.jpeg"><br><br><h2>  Microservice ou monolithe: crit√®res de s√©lection </h2><br>  Lors du choix entre une architecture monolithique et microservice, vous devez tout d'abord partir de la complexit√© du domaine et du besoin de mise √† l'√©chelle. <br><br>  Si le sujet est simple, et qu'une augmentation globale du nombre d'utilisateurs n'est pas attendue, alors les microservices peuvent √™tre utilis√©s sans aucun doute.  Dans d'autres cas, il est pr√©f√©rable de d√©marrer le d√©veloppement sur un monolithe et d'√©conomiser des ressources si la mise √† l'√©chelle n'est pas requise.  Si le domaine est complexe, et au stade initial les exigences finales ne sont pas d√©finies, il est √©galement pr√©f√©rable de commencer par un monolithe - afin de ne pas refaire plusieurs fois les microservices.  Avec le d√©veloppement ult√©rieur du projet, il est possible de distinguer ses diff√©rentes parties dans des microservices. <br><br><img src="https://habrastorage.org/webt/bl/5c/9e/bl5c9elyajqq00pivozpby_yauy.jpeg"><br><br>  Un plus est la pr√©sence de limites au d√©but du projet, car cela aidera √† ne pas les briser pendant le processus de d√©veloppement.  Il est √©galement judicieux de commencer avec une seule base de donn√©es, mais de d√©finir un sch√©ma pour chaque module (par exemple, un sch√©ma de paiement).  Par la suite, cela contribuera √† simplifier la division des modules en microservices.  Dans ce cas, nous observons les limites des modules et pouvons utiliser des microservices. <br><br>  Chaque module doit avoir sa propre API, afin que plus tard il puisse √™tre allou√© et faire du module un microservice. <br><br><img src="https://habrastorage.org/webt/6i/rp/b9/6irpb9ewnkmgleylittjhh5z-f8.jpeg"><br><br>  Apr√®s avoir d√©termin√© les limites des modules, vous pouvez proc√©der √† la d√©composition en microservices, si n√©cessaire.  Dans environ 90% des cas, il sera possible de rester sur le monolithe, mais si n√©cessaire, il sera plus facile et moins co√ªteux de changer l'architecture. <br><br>  Dans notre pratique de travail avec des monolithes et des microservices, nous sommes parvenus aux conclusions suivantes: <br><ul><li>  Ne passez pas aux microservices simplement parce qu'ils sont utilis√©s par Netflix, Twitter, Facebook </li><li>  Commencez avec deux ou trois microservices qui interagissent les uns avec les autres, d√©terminez en d√©tail toutes les exigences non fonctionnelles (s√©curit√©, tol√©rance aux pannes, √©volutivit√©, etc.) et passez ensuite √† d'autres services </li><li>  Automatisez tout ce qui est possible </li><li>  Configurer la surveillance </li><li>  √âcrire des autotests </li><li>  N'utilisez pas de transactions distribu√©es (mais ce n'est pas une raison pour refuser la garantie de l'int√©grit√© des donn√©es). </li><li>  Si vous souhaitez utiliser une architecture de microservice, pr√©parez-vous au fait que le d√©veloppement peut vous co√ªter environ 3 fois plus cher que sur un monolithe.  Cependant, les deux technologies ont leurs propres inconv√©nients et avantages; chacune a sa propre niche. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453932/">https://habr.com/ru/post/fr453932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453914/index.html">Instructions d'installation du client de test TON</a></li>
<li><a href="../fr453916/index.html">Comment vous prot√©ger contre les escrocs mobiles</a></li>
<li><a href="../fr453920/index.html">Comment prendre le contr√¥le de votre infrastructure r√©seau. Chapitre quatre Automatisation Mod√®les</a></li>
<li><a href="../fr453926/index.html">Fonctionnement et fonctionnement du service d'autopartage</a></li>
<li><a href="../fr453930/index.html">Comparaison et s√©lection de syst√®mes de migration de donn√©es</a></li>
<li><a href="../fr453934/index.html">11 questions √† discuter avant de commencer √† travailler</a></li>
<li><a href="../fr453938/index.html">Suivi des v√©los vol√©s NB-IoT</a></li>
<li><a href="../fr453942/index.html">√Ä propos de l'√©thique avec l'exemple du PMI Codex</a></li>
<li><a href="../fr453944/index.html">Insectes masqu√©s int√©gr√©s</a></li>
<li><a href="../fr453950/index.html">Tu es cens√© √™tre ici! 22 ans de la sortie du l√©gendaire jeu Duke Nukem 3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>