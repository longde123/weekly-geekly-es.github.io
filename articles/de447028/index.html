<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò¢ ü§ûüèø üó£Ô∏è Steganographie vergangene Dateien: Wir verstecken Daten direkt in Sektoren üèë üéÅ ‚óºÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kurze Einf√ºhrung 
 Steganographie ist, wenn sich jemand nicht erinnert, das Verbergen von Informationen in Beh√§ltern. Zum Beispiel in Bildern ( hier u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Steganographie vergangene Dateien: Wir verstecken Daten direkt in Sektoren</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447028/"><h3>  Kurze Einf√ºhrung </h3><br>  Steganographie ist, wenn sich jemand nicht erinnert, das Verbergen von Informationen in Beh√§ltern.  Zum Beispiel in Bildern ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> besprochen).  Sie k√∂nnen Daten auch in den Diensttabellen des Dateisystems (dies wurde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> geschrieben) und sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in den Dienstpaketen des TCP-Protokolls</a> ausblenden.  Leider haben alle diese Methoden einen Nachteil: Um Informationen in einem Container leise zu ‚Äûverteilen‚Äú, ben√∂tigen Sie knifflige Algorithmen, die die Merkmale der internen Struktur des Containers ber√ºcksichtigen.  Ja, und mit dem Manipulationswiderstand des Containers treten Probleme auf: Wenn Sie beispielsweise das Bild leicht bearbeiten, gehen versteckte Informationen verloren. <br><br>  Ist es m√∂glich, auf listige Algorithmen und subtile Datenmanipulationen zu verzichten und gleichzeitig die Leistung des Containers und ein akzeptables Sicherheitsniveau f√ºr versteckte Daten sicherzustellen?  Mit Blick auf die Zukunft werde ich sagen - ja, das k√∂nnen Sie!  Und ich werde ein Dienstprogramm anbieten. <br><a name="habracut"></a><br><h3>  Details zur blutigen Methode </h3><br>  Die Grundidee ist so einfach wie ein Schlag auf die Stirn: Es gibt Bereiche auf der Festplatte, in die das Betriebssystem niemals schreibt (oder in seltenen F√§llen schreibt).  Um diese Bereiche nicht mit gerissenen Algorithmen suchen zu m√ºssen, verwenden wir Redundanz - das hei√üt, wir werden unsere verborgenen Informationen viele, viele Male √ºber alle Sektoren der Festplatte duplizieren.  Zus√§tzlich zu dieser Gr√∂√üe k√∂nnen Sie die erforderlichen Partitionen erstellen, Dateisysteme formatieren, Dateien schreiben und das Betriebssystem installieren. Auf jeden Fall wird ein Teil der geheimen Daten gespeichert und extrahiert, und durch wiederholtes Duplizieren k√∂nnen wir das Original aus Teilen zusammensetzen. <br><br>  Der Vorteil dieser Methode liegt auf der Hand: Wir sind nicht vom Dateiformat oder sogar vom Typ des verwendeten Dateisystems abh√§ngig. <br><br>  Die Nachteile liegen meines Erachtens auch auf der Hand: <br><br><ul><li>  Geheime Daten k√∂nnen nur durch vollst√§ndiges Umschreiben der gesamten Festplatte ge√§ndert werden, wobei die anschlie√üende Rekonstruktion des Inhalts f√ºr den Benutzer sichtbar ist.  Gleichzeitig k√∂nnen Sie keine Software verwenden, die eine Festplatte aus einem Image neu erstellt: Sie erstellt fr√ºhere geheime Daten neu. </li><li>  Je gr√∂√üer die Menge der klassifizierten Daten ist, desto gr√∂√üer ist die Wahrscheinlichkeit, dass einige Informationen verloren gehen. </li><li>  Das Abrufen von Daten von der Festplatte kann lange dauern.  Von einigen Minuten bis zu mehreren Tagen (moderne Discs sind gro√ü). </li></ul><br>  Kommen wir nun zu den Details. <br><br>  Es ist klar, dass wenn Sie einfach geheime Daten auf der Festplatte verschmieren, diese nur mit blo√üem Auge verborgen bleiben.  Wenn Sie Ihre Augen beispielsweise mit einem Festplatteneditor ausstatten, erscheinen die Daten in ihrer ganzen Pracht.  Daher w√§re es sch√∂n, die Daten so zu verschl√ºsseln, dass sie nicht blinken.  Wir werden einfach, aber mit Geschmack verschl√ºsseln: nach dem aes256-cbc-Algorithmus.  Wir fragen den Benutzer nach dem Verschl√ºsselungsschl√ºssel, lassen ihn sich ein gutes Passwort ausdenken. <br><br>  Die n√§chste Frage ist, wie wir "richtige" Daten von besch√§digten Daten unterscheiden k√∂nnen.  Hier hilft uns die Pr√ºfsumme, aber nicht einfach, sondern SHA1.  Und was?  F√ºr Git ist es gut genug, was bedeutet, dass es zu uns passt.  Es wurde entschieden: Wir versorgen jedes gespeicherte Informationsfragment mit einer Pr√ºfsumme, und wenn es nach der Entschl√ºsselung zusammenfiel, war die Entschl√ºsselung erfolgreich. <br><br>  Sie ben√∂tigen auch die Fragmentnummer und die Gesamtl√§nge der geheimen Daten.  Fragmentnummer - um zu verfolgen, welche Teile wir bereits entschl√ºsselt haben und welche √ºbrig geblieben sind.  Die Gesamtl√§nge ist f√ºr uns bei der Verarbeitung des letzten Fragments n√ºtzlich, um keine zus√§tzlichen Daten zu schreiben (dh Auff√ºllen).  Da wir immer noch eine √úberschrift erhalten, f√ºgen wir dort den Namen der geheimen Datei hinzu.  Es wird sich nach der Entschl√ºsselung als n√ºtzlich erweisen, um nicht zu erraten, wie es ge√∂ffnet werden soll. <br><br><h3>  √úberpr√ºfen Sie die Methode in der Praxis </h3><br>  Zur √úberpr√ºfung verwenden wir die g√§ngigsten Medien - ein Flash-Laufwerk.  Ich habe eine alte mit 1 GB gefunden, die sich gut f√ºr Experimente eignet.  Wenn Sie wie ich auf die Idee gekommen sind, kein Dampfbad mit physischen Medien zu nehmen, sondern eine Datei zu testen - ein Disk-Image, sage ich sofort: Es wird nicht funktionieren.  Bei der Formatierung einer solchen ‚ÄûFestplatte‚Äú erstellt Linux die Datei erneut und alle nicht verwendeten Sektoren werden mit Nullen gef√ºllt. <br><br>  Als Linux-Maschine musste ich leider die Wetterstation auf dem Raspberry Pi 3 auf dem Balkon benutzen. Da dort nicht viel Speicher ist, werden wir keine gro√üen Dateien verstecken.  Wir beschr√§nken uns auf eine maximale Gr√∂√üe von 10 Megabyte.  Es macht auch keinen Sinn, zu kleine Dateien auszublenden: Das Dienstprogramm schreibt Daten in Clustern von 4 KB auf die Festplatte.  Daher beschr√§nken wir uns von unten auf eine 3-KB-Datei - sie passt in einen solchen Cluster. <br><br>  Wir werden das Flash-Laufwerk schrittweise verspotten und nach jeder Phase pr√ºfen, ob versteckte Informationen gelesen werden: <br><br><ol><li>  Schnelle Formatierung im FAT16-Format mit einer Clustergr√∂√üe von 16 KB.  Dies schl√§gt Windows 7 f√ºr ein Flash-Laufwerk ohne Dateisystem vor. </li><li>  F√ºllen eines Flash-Laufwerks mit 50% aller Arten von M√ºll. </li><li>  Das Bef√ºllen des Flash-Laufwerks mit allen Arten von M√ºll betr√§gt 100%. </li><li>  "Lange" Formatierung im FAT16-Format (mit √úberschreiben von allem). </li></ol><br>  Die ersten beiden Tests endeten erwartungsgem√§√ü mit einem vollst√§ndigen Sieg: Das Dienstprogramm konnte erfolgreich 10 Megabyte vertrauliche Daten von einem Flash-Laufwerk extrahieren.  Nachdem das Flash-Laufwerk mit Dateien f√ºr die Aug√§pfel gef√ºllt wurde, trat ein Fehler auf: <br><br> <code>Total clusters read: 250752, decrypted: 158 <br> ERROR: cannot write incomplete secretFile</code> <br> <br>  Wie Sie sehen k√∂nnen, wurden nur 158 Cluster erfolgreich entschl√ºsselt (632 Kilobyte Rohdaten, was 636424 Byte Nutzlast ergibt).  Es ist klar, dass es keine M√∂glichkeit gibt, 10 Megabyte zu erhalten, und es gibt offensichtlich Duplikate zwischen diesen Clustern.  Selbst 1 Megabyte kann auf diese Weise nicht wiederhergestellt werden.  Es kann jedoch garantiert werden, dass wir 3 Kilobyte sensibler Daten von einem Flash-Laufwerk wiederherstellen, selbst nachdem diese formatiert und in die Aug√§pfel geschrieben wurden.  Experimente zeigen jedoch, dass es durchaus m√∂glich ist, eine 120-Kilobyte-Datei von einem solchen Flash-Laufwerk zu extrahieren. <br><br>  Der letzte Test hat leider gezeigt, dass das Flash-Laufwerk alle √ºberschrieben wurde: <br><br> <code>$ sudo ./steganodisk -p password /dev/sda <br> Device size: 250752 clusters <br> 250700 99% <br> Total clusters read: 250752, decrypted: 0 <br> ERROR: cannot write incomplete secretFile <br></code> <br><br>  Kein einziger Cluster hat √ºberlebt ... Leider, aber nicht tragisch!  Versuchen wir, vor dem Formatieren eine Partition auf dem Flash-Laufwerk zu erstellen, und zwar bereits darin - im Dateisystem.  √úbrigens kam sie mit dieser Formatierung aus der Fabrik, also machen wir nichts Verd√§chtiges. <br>  Es wird erwartet, dass der verf√ºgbare Speicherplatz auf dem Flash-Laufwerk geringf√ºgig reduziert wird. <br><br>  Es wird auch erwartet, dass 10 Megabyte auf einem vollst√§ndig verstopften Laufwerk immer noch nicht ausgeblendet werden k√∂nnen.  Aber jetzt hat sich die Anzahl der erfolgreich entschl√ºsselten Cluster mehr als verdoppelt! <br><br> <code>Total clusters read: 250752, decrypted: 405</code> <br> <br>  Leider kann ein Megabyte nicht aus Teilen zusammengesetzt werden, aber zweihundert Kilobyte sind einfach. <br><br>  Nun, die Nachricht von der letzten, vierten √úberpr√ºfung, diesmal ist erfreulich: Die vollst√§ndige Formatierung eines solchen Flash-Laufwerks hat nicht zur Zerst√∂rung aller Informationen gef√ºhrt!  120 Kilobyte geheimer Daten passen perfekt in ungenutzten Raum. <br><br>  √úbersichtstabelle zum Testen: <br><br><img src="https://habrastorage.org/webt/lc/1r/ii/lc1riil0s_qjcrnenxtkbcboi4m.png"><br><br><h3>  Ein bisschen theoretisieren: √ºber freien Speicherplatz und nicht genutzte Sektoren </h3><br>  Wenn Sie eine Festplatte einmal partitioniert haben, stellen Sie m√∂glicherweise fest, dass es nicht immer m√∂glich ist, den gesamten freien Speicherplatz auf der Festplatte zuzuweisen.  Der erste Abschnitt beginnt immer mit einem Einzug (normalerweise 1 Megabyte oder 2048 Sektoren).  Auch hinter dem letzten Abschnitt bleibt ein kleiner ‚ÄûSchwanz‚Äú ungenutzter Sektoren.  Und manchmal gibt es L√ºcken zwischen Abschnitten, wenn auch selten. <br><br>  Mit anderen Worten, es gibt Sektoren auf der Festplatte, auf die w√§hrend der normalen Arbeit mit der Festplatte nicht zugegriffen werden kann, aber Sie k√∂nnen Daten in diese Sektoren schreiben!  Was bedeutet auch zu lesen.  Bereinigt um die Tatsache, dass es auch eine Partitionstabelle und einen Bootloader-Code gibt, die sich nur in einem leeren Bereich am Anfang der Festplatte befinden. <br><br>  Lassen Sie uns f√ºr eine Weile von den Trennw√§nden ablenken und die Scheibe sozusagen aus der Vogelperspektive betrachten.  Hier haben wir eine leere Partition auf der Festplatte.  Erstellen Sie ein Dateisystem darin.  Kann man sagen, dass einige Sektoren auf der Festplatte entsperrt geblieben sind? <br><br>  Und-und-und-Trommelwirbel!  Die Antwort wird fast immer sein - ja!  In den meisten F√§llen l√§uft die Erstellung eines Dateisystems darauf hinaus, dass nur wenige Bl√∂cke von Dienstinformationen auf die Festplatte geschrieben werden, ansonsten √§ndert sich der Inhalt des Abschnitts nicht. <br><br>  Und doch k√∂nnen wir - rein empirisch - davon ausgehen, dass das Dateisystem nicht immer den gesamten dem letzten Sektor zugewiesenen Speicherplatz einnehmen kann.  Beispielsweise kann ein FAT16-Dateisystem mit einer Clustergr√∂√üe von 64 Kilobyte eine Partition mit einer Gr√∂√üe von nicht mehr als 64 Kilobyte offensichtlich nicht vollst√§ndig belegen.  Am Ende eines solchen Abschnitts sollte ein Schwanz in mehreren Sektoren verbleiben, auf die zum Speichern von Benutzerdaten nicht zugegriffen werden kann.  Experimentell konnte diese Annahme jedoch nicht best√§tigt werden. <br><br>  Um den f√ºr das Steganogramm verf√ºgbaren Speicherplatz zu maximieren, m√ºssen Sie ein gr√∂√üeres Dateisystem mit einer Clustergr√∂√üe verwenden.  Sie k√∂nnen weiterhin eine Partition erstellen, auch wenn diese optional ist (z. B. auf einem Flash-Laufwerk).  Es ist nicht notwendig, leere Bereiche zu erstellen oder nicht zugewiesene Bereiche zu belassen - dies wird die Aufmerksamkeit interessierter B√ºrger auf sich ziehen. <br><br><h3>  Dienstprogramm f√ºr Experimente </h3><br>  Dienstprogrammquellen finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier.</a> <br><br>  Zum Erstellen ben√∂tigen Sie Qt Version 5.0 und h√∂her sowie OpenSSL.  Wenn etwas nicht passieren soll, m√ºssen Sie m√∂glicherweise die Datei steganodisk.pro reparieren. <br><br>  Sie k√∂nnen die Clustergr√∂√üe von 4 KB auf beispielsweise 512 Byte (in secretfile.h) √§ndern.  Gleichzeitig steigen die Kosten f√ºr offizielle Informationen: Der Header und die Pr√ºfsumme belegen feste 68 Bytes. <br><br>  Sie m√ºssen das Dienstprogramm nat√ºrlich mit Root-Benutzerrechten und mit Vorsicht ausf√ºhren.  Vor dem √úberschreiben der angegebenen Datei oder des angegebenen Ger√§ts werden keine Fragen gestellt! <br><br>  Genie√üe es. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447028/">https://habr.com/ru/post/de447028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447018/index.html">Quantenanreicherung in einer Multi-Welt-Interpretation</a></li>
<li><a href="../de447020/index.html">Bei Produktivit√§t geht es nicht um Zeitmanagement, sondern um Aufmerksamkeitsmanagement</a></li>
<li><a href="../de447022/index.html">Zwingen Sie die Zuh√∂rer nicht zum Nachdenken</a></li>
<li><a href="../de447024/index.html">Wie kann man die Vorteile eines Laptops und eines Desktop-Computers kombinieren? Analyse des Problems und L√∂sungen</a></li>
<li><a href="../de447026/index.html">Wir schreiben den OTA-Loader f√ºr ATmega128RFA1 (als Teil des Smart Response XE-Ger√§ts)</a></li>
<li><a href="../de447034/index.html">Mit dem neuen Fehler in Telegram Desktop k√∂nnen Sie die letzte Nachricht lesen</a></li>
<li><a href="../de447036/index.html">Ein Cocktail f√ºr eine gesunde Ern√§hrung - er wird von einem Startup des Beschleunigers der ITMO University hergestellt</a></li>
<li><a href="../de447038/index.html">In der Liste der Bedrohungen: ‚ÄûGame of Thrones‚Äú - eine der beliebtesten Deckungen f√ºr Cyberkriminelle</a></li>
<li><a href="../de447040/index.html">Forschung: Die durchschnittlichen Kosten f√ºr Switches werden reduziert - wir verstehen warum</a></li>
<li><a href="../de447042/index.html">Beste Erfahrung bei der Erstellung sauberer und schneller Angular-Anwendungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>