<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚖 👍🏽 ☃️ ML新兵训练营VI的第一名故事 ⏺️ 🔸 💜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="多年来，Mail.ru一直举办机器学习锦标赛，每次任务以其自己的方式有趣且以其自己的方式复杂。 这是我第四次参加比赛，我真的很喜欢这个平台和组织，而正是通过训练营，我进入了竞争性机器学习的道路，但是我还是第一次获得了第一名。 在文章中，我将告诉您，如果测试部分与数据的训练部分明显不同，那么如何在不对...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ML新兵训练营VI的第一名故事</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418743/"> 多年来，Mail.ru一直举办机器学习锦标赛，每次任务以其自己的方式有趣且以其自己的方式复杂。 这是我第四次参加比赛，我真的很喜欢这个平台和组织，而正是通过训练营，我进入了竞争性机器学习的道路，但是我还是第一次获得了第一名。 在文章中，我将告诉您，如果测试部分与数据的训练部分明显不同，那么如何在不对公共排行榜或延迟样本进行重新训练的情况下显示稳定的结果。 <br><br><h2> 挑战赛 </h2><br> 可在→ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">链接中</a>找到任务的全文。 简而言之：有10 GB的数据，其中每行包含三种json类型的“密钥：计数器”，特定类别，特定时间戳和用户ID。 多个条目可以对应一个用户。 需要确定用户属于哪个类别，第一或第二。 该模型的质量度量是ROC-AUC，在Alexander Dyakonov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[1]</a>的博客中对此进行了很好的描述。 <br><br> 示例文件输入 <br><br><pre><code class="hljs go"><span class="hljs-number"><span class="hljs-number">00000d</span></span>2994b6df9239901389031acaac <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"809001"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"848545"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"565828"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"490363"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} {<span class="hljs-string"><span class="hljs-string">"85789"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"238490"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"32285"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"103987"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"16507"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-string"><span class="hljs-string">"6477"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-string"><span class="hljs-string">"92797"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>} {} <span class="hljs-number"><span class="hljs-number">39</span></span></code> </pre> <a name="habracut"></a><br><h2> 解决方案 </h2><br> 成功下载数据集的数据科学家提出的第一个想法是将json列转换为稀疏矩阵。 此时，许多参与者遇到了缺少RAM的问题。 在python中甚至部署一列时，内存消耗都比普通笔记本电脑高。 <br><br> 一些干统计。 每列中的唯一键数为20​​53602、20275、1057788。此外，在火车部分和测试部分中，只有493866、20268、141931。火车中的427994个唯一用户和测试部分中的181024。 培训部分中约1％的4％。 <br><br> 如您所见，我们有很多标志，使用它们都是在火车上过度拟合的一种明显方法，因为例如决策树使用标志的组合，并且甚至还有如此众多标志的独特组合，并且几乎所有这些标志仅存在于训练部分数据或正在测试中。 但是，我拥有的基本模型之一是lightgbm，colsample〜0.1，非常严格的正则化。 但是，尽管正规化的参数很大，但在比赛结束后，结果却显示出公共和私人场合的不稳定结果。 <br><br> 决定参加此比赛的人的第二个想法可能是收集火车并进行测试，并通过标识符汇总信息。 例如金额。 或最大。 在这里，事实证明Mail.ru为我们想到了两个非常有趣的事情。 首先，可以以非常高的准确性对测试进行分类。 即使根据有关cuid条目数和json中唯一键数的统计数据，测试也大大超出了训练范围。 基本分类器的测试识别率为0.9+ roc-auc。 其次，计数器没有任何意义，几乎所有模型都从从计数器转换为二进制形式的符号变得更好：没有/没有密钥。 甚至连树木（从理论上也不会因为一个单位有一定数量而不是一个单位而变得更糟）似乎也经过了重新训练。 <br><br> 公共排行榜上的结果大大超过了交叉验证的结果。 显然，这是由于这样的事实，即模型在测试中建立两个记录的排名比在火车中更容易，因为更多的符号给出了更多的排名条件。 <br><br> 在这一阶段，完全清楚的是，在这场比赛中进行验证不是一件容易的事，公共信息或其他参与者的简历也不会被诱骗，这可被诱骗到官方聊天室中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[2]</a> 。 为什么会发生？ 似乎火车和考试是按时间分开的，后来组织者证实了这一点。 <br><br> 任何有经验的kaggle成员都会立即建议进行对抗验证<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[3]</a> ，但这并不那么简单。 尽管通过度量roc-auc进行的火车和测试分类器的准确性接近于1，但火车中没有很多类似的条目。 我试图对具有相同目标的cuid聚合样本进行汇总，以增加json中具有大量唯一键的记录的数量，但是这在交叉验证和公共验证方面均造成了缺点，因此我害怕使用此类模型。 <br><br> 有两种方法：通过无监督的学习寻找永恒的价值，或尝试采用对测试更重要的功能。 我走了两种路，使用TruncatedSVD进行无监督，并在测试中按频率选择特征。 <br><br> 第一步，我做了一个深层的自动编码器，但是我被弄错了，两次取相同的矩阵，我无法修复错误并使用全套符号：在任何密集层大小下，输入张量都不适合GPU内存。 我发现了一个错误，后来我没有尝试对功能进行编码。 <br><br> 我以各种富有想象力的方式生成了SVD：在具有cat_feature的原始数据集上，然后通过cuid求和。 对于每列分别。 通过json上的tf-idf作为词袋<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[4]</a> （没有帮助）。 <br><br> 为了获得更多的品种，我尝试在火车中选择少量特征，对交叉验证的每一折火车部分使用A-NOVA。 <br><br><h2> 型号 </h2><br> 主要基本模型：lightgbm，vowpal wabbit，xgboost，SGD。 另外，我使用了几种神经网络架构。 在公共排行榜的第一名的德米特里·尼基特科（Dmitry Nikitko）建议使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">HashEmbeddings</a> ，此模型经过一些参数选择后显示出良好的效果并改善了整体效果。 <br><br> 另一个神经网络模型，用于搜索3-4-5数据列（左三个输入），数字统计量（4个输入），SVD矩阵（5个输入）之间的交互作用（分解机器样式）。 <br><br><img src="https://habrastorage.org/webt/g5/xb/yp/g5xbypjhkxazihg5vfcd7mglya0.png"><br><br><h2> 合奏 </h2><br> 我对所有模型进行了褶皱计数，然后对经过各种褶皱训练的模型得出的测试预测结果进行平均。 火车预测用于堆叠。 使用xgboost在基础模型的预测上使用1级堆栈显示最佳结果，并从每个json列中选择250个属性，并根据测试中该属性满足的频率进行选择。 <br><br> 我在解决方案上花费了大约30个小时的时间，指望具有4个core-i7内核，64 GB RAM和一个GTX 1080的服务器。结果，我的解决方案非常稳定，我从公共排行榜上的第三名移到了第一个私有排行榜上。 <br><br> 该代码的很大一部分以笔记本电脑的形式在位桶中可用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[5]</a> 。 <br><br> 我要感谢Mail.ru进行的有趣的竞赛，以及其他与小组中的有趣交流的参与者！ <br><br>  [1] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Aleksandrov Dyakonov博客上的ROC-AUC</a> <br>  [2] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">官方聊天ML BootCamp官方</a> <br>  [3] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">对抗性验证</a> <br>  [4] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">口碑</a> <br>  [5] <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">大多数模型的源代码</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN418743/">https://habr.com/ru/post/zh-CN418743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN418733/index.html">可视化国际和本地东方社区的YouTube频道的评论</a></li>
<li><a href="../zh-CN418735/index.html">关注所有权</a></li>
<li><a href="../zh-CN418737/index.html">激光烧蚀，亚碲酸盐玻璃和掺杂剂Er2O3</a></li>
<li><a href="../zh-CN418739/index.html">添加剂技术中心：工业3D打印机3D系统，Stratasys，SLM，EOS</a></li>
<li><a href="../zh-CN418741/index.html">添加加密并推送到常规SIP</a></li>
<li><a href="../zh-CN418747/index.html">解决问题：如何有效地解决团队中的问题？</a></li>
<li><a href="../zh-CN418751/index.html">敏捷的无礼中国间谍</a></li>
<li><a href="../zh-CN418753/index.html">VMware Cloud中的vSAN</a></li>
<li><a href="../zh-CN418755/index.html">电子商务如何在大规模促销中生存。 为网络上的峰值负载做好准备[第1部分]</a></li>
<li><a href="../zh-CN418757/index.html">缩短时间范围（加密货币，外汇，交易所）</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>