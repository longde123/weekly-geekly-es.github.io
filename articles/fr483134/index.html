<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”‡ ğŸ‘©ğŸ½â€ğŸ”§ ğŸ‘¨ğŸ¿ Test d'authentification Ã  deux facteurs et solutions de contournement possibles ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ¾ ğŸ‘¨ğŸ»â€ğŸ’» ğŸ•¸ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avant mÃªme que je ne commence Ã  comprendre la science complexe de la sÃ©curitÃ© de l'information, il me semblait que l'authentification 2FA est un moyen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test d'authentification Ã  deux facteurs et solutions de contournement possibles</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483134/"><img src="https://habrastorage.org/webt/g8/rq/pf/g8rqpf1rdulkehqbd2aromukw5q.png"><br><br>  Avant mÃªme que je ne commence Ã  comprendre la science complexe de la sÃ©curitÃ© de l'information, il me semblait que l'authentification 2FA est un moyen garanti de protÃ©ger votre compte et aucun "ces vos pirates" ne peut, par exemple, retirer ma monnaie interne pour acheter des vÃªtements pour les personnages sur le compte du jeu.  Mais au fil du temps, il a Ã©tÃ© expÃ©rimentalement prouvÃ© qu'un systÃ¨me d'authentification Ã  deux facteurs peut prÃ©senter un grand nombre de vulnÃ©rabilitÃ©s. <br><a name="habracut"></a><br>  En termes simples, l'authentification Ã  deux facteurs est une confirmation de l'action en entrant le code gÃ©nÃ©rÃ© pour augmenter la sÃ©curitÃ© et en jetant des bÃ¢tons dans les roues des pirates conditionnels pendant le mouvement ou avant qu'il ne commence. <br><br>  Le systÃ¨me de confirmation de code est trÃ¨s rÃ©pandu, il est utilisÃ© partout sur divers sites et peut Ãªtre connectÃ© pour les connexions primaires et secondaires.  Mais l'application ne se limite pas Ã  cela - les dÃ©veloppeurs attachent une confirmation sur la fonctionnalitÃ© de rÃ©cupÃ©ration de mot de passe, confirmation d'enregistrement / abonnement, confirmation supplÃ©mentaire des transactions financiÃ¨res, changement de mot de passe, changement de donnÃ©es personnelles.  De plus, de temps en temps, 2FA est utilisÃ© comme mur aprÃ¨s la dÃ©connexion pour le chronomÃ©trage, et non comme mot de passe ou autre moyen de confirmation. <br><br>  Dans cet article, j'ai rassemblÃ© des moyens de tester 2FA pour les vulnÃ©rabilitÃ©s, leur exploitation, ainsi que les options possibles pour contourner la protection existante contre certains types d'attaques.  Examinons la liste des vÃ©rifications de vulnÃ©rabilitÃ© qui s'appliquent Ã  2FA: <br><br><h2>  1. Absence de limite de taux </h2><br>  L'algorithme de limite de dÃ©bit est utilisÃ© pour tester si une session utilisateur (ou une adresse IP) peut Ãªtre limitÃ©e en tentatives ou en vitesse, et dans quelles circonstances cela se produit.  Si l'utilisateur a effectuÃ© trop de demandes dans un certain laps de temps, l'application Web peut rÃ©pondre avec un code 429 (plusieurs demandes) ou appliquer une limite de dÃ©bit sans afficher d'erreurs.  L'absence de limite de taux implique que pendant l'Ã©numÃ©ration normale, il n'y a pas de restrictions sur le nombre de tentatives et / ou la vitesse - il est permis d'itÃ©rer sur les codes autant de fois (Ã  n'importe quelle vitesse) au cours de la pÃ©riode de validitÃ© de la session / jeton. <br><br>  TrÃ¨s souvent, vous devez faire face Ã  une limite de dÃ©bit Â«sans bruitÂ», si vous voyez qu'il n'y a pas d'erreurs et que le corps / code HTTP ne change pas dans les requÃªtes suivantes, vous devriez Ãªtre satisfait trop tÃ´t, et vous devez d'abord vÃ©rifier le rÃ©sultat final de l'attaque en utilisant un code valide. <br><br><h2>  2. La limite de taux existe, mais peut Ãªtre contournÃ©e </h2><br>  Cas que j'ai dÃ» rencontrer auparavant: <br><br><h4>  1) Limiter la vitesse des flux sans blocage aprÃ¨s avoir atteint une certaine vitesse </h4><br>  Souvent, les chercheurs en sÃ©curitÃ© essaient de rÃ©cupÃ©rer du code en utilisant 5 threads ou plus pour accÃ©lÃ©rer une attaque (dans Burp Intruder, le nombre de threads par dÃ©faut est 5 sans dÃ©lai).  Mais parfois, un systÃ¨me de sÃ©curitÃ© contre l'Ã©clatement ou un Ã©quilibreur de charge normal ne peut rÃ©pondre qu'Ã  ce seul facteur.  Si vous essayez de forcer brutalement avec 5 threads, vous devez rÃ©duire le nombre Ã  1, puis Ã  1 avec un retard d'une seconde.  Plus tÃ´t, j'ai eu la chance d'observer un tel comportement et c'est Ã  l'aide de telles manipulations que la sÃ©lection rÃ©ussie du code s'est produite, ce qui a conduit Ã  la prise de contrÃ´le du compte.  Si le code 2FA n'a pas de date d'expiration spÃ©cifique, nous avons beaucoup de temps pour trier.  Si la pÃ©riode de validitÃ© est prÃ©sente, le succÃ¨s de l'attaque est rÃ©duit, mais le danger potentiel de vulnÃ©rabilitÃ© est toujours prÃ©sent, car il y a encore une chance d'entrer dans le code souhaitÃ©. <br><br><h4>  2) Le code OTP gÃ©nÃ©rÃ© ne change pas </h4><br>  Cela ne s'applique pas aux codes en constante Ã©volution comme dans Google Authenticator, mais uniquement aux codes statiques qui sont envoyÃ©s par SMS, e-mail ou en personne via Messenger. <br><br>  L'essence de ce contournement est que le mÃªme code OTP est envoyÃ© en permanence ou pendant un certain temps, par exemple 5 minutes, ce qui est valable pendant tout ce temps.  Il est Ã©galement utile de s'assurer qu'aucune limite de dÃ©bit silencieuse ne se produit. <br><br>  Exemple de rapport: <a href="https://hackerone.com/reports/420163">hackerone.com/reports/420163</a> <br><br>  Supposons que l'application gÃ©nÃ¨re un code alÃ©atoire de 001 Ã  999 et l'envoie au tÃ©lÃ©phone, dans les 10 minutes lorsque la fonctionnalitÃ© Â«envoyer Ã  nouveauÂ» est activÃ©e, nous obtenons le mÃªme code.  Mais la limite de dÃ©bit est liÃ©e Ã  la demande, ce qui limite le nombre de tentatives par jeton de demande.  Nous pouvons constamment demander un nouveau code, gÃ©nÃ©rer un nouveau jeton de demande, l'appliquer Ã  une demande suivante (en utilisant grep-match dans une suite burp ou en utilisant notre propre script) et effectuer la force brute d'une plage de nombres de 001 Ã  999. Ainsi, en utilisant constamment un nouveau jeton de demande nous sÃ©lectionnerons avec succÃ¨s le bon code, car il ne change pas et est statique pendant un certain temps.  Les limites de cette attaque sont un nombre long ou le mÃ©lange de lettres avec des chiffres comme code de confirmation. <br><br>  Cette situation ne doit pas Ãªtre encouragÃ©e, vous devez essayer de trier au moins une partie de notre liste, car il est possible que le code gÃ©nÃ©rÃ© se trouve dans cette partie de la liste, car il est gÃ©nÃ©rÃ© de maniÃ¨re alÃ©atoire.  Lorsque vous essayez, vous devez vous fier au hasard, mais il y a toujours une chance de trouver la bonne combinaison, ce qui prouve une vulnÃ©rabilitÃ© qui doit dÃ©finitivement Ãªtre corrigÃ©e. <br><br><h4>  3) RÃ©initialisez rate-limit-a lors de la mise Ã  jour du code. </h4><br>  Dans la demande de vÃ©rification de code, la limite de dÃ©bit est prÃ©sente, mais aprÃ¨s avoir activÃ© la fonction de renvoi du code, elle est rÃ©initialisÃ©e et vous permet de continuer le code de force brute. <br>  Exemples de rapports: <br><br>  <a href="https://hackerone.com/reports/149598">https://hackerone.com/reports/149598</a> , - thÃ©orie; <br>  <a href="https://hackerone.com/reports/205000">hackerone.com/reports/205000</a> , un exploit pratique basÃ© sur un rapport prÃ©cÃ©dent. <br><br><h4>  4) Contourner la limite de dÃ©bit en changeant l'adresse IP </h4><br>  De nombreux verrous sont basÃ©s sur la restriction de la rÃ©ception de requÃªtes IP, qui a atteint le seuil d'un certain nombre de tentatives lors de l'exÃ©cution d'une requÃªte.  Si l'adresse IP est modifiÃ©e, il est possible de contourner cette restriction.  Afin de vÃ©rifier cette mÃ©thode, changez simplement votre IP en utilisant le serveur proxy / VPN et voyez si le blocage dÃ©pend de l'IP. <br><br>  FaÃ§ons de changer IP: <br><br><ul><li>  Les proxys peuvent Ãªtre utilisÃ©s dans une attaque Ã  l'aide du module complÃ©mentaire IP Rotator pour Burp Suite <a href="https://github.com/RhinoSecurityLabs/IPRotate_Burp_Extension">github.com/RhinoSecurityLabs/IPRotate_Burp_Extension</a> .  Ã€ mon avis, c'est le meilleur choix, car il nous donne ~ des tentatives de force brute illimitÃ©es et des adresses IP qui vous permettent d'effectuer une attaque par force brute sans erreurs et interruptions 42x. </li><li>  Une bonne option pourrait Ãªtre un script python avec un module de requÃªtes proxy, mais vous devez d'abord obtenir un grand nombre de proxy valides quelque part. </li></ul><br>  Ã‰tant donnÃ© que l'outil de rotation IP envoie des demandes Ã  l'aide des adresses IP AWS, toutes les demandes seront bloquÃ©es si l'application Web se trouve derriÃ¨re le pare-feu CloudFlare. <br><br><img src="https://habrastorage.org/webt/5b/ep/c4/5bepc4djncwcbel-6gxkjfzh1ro.png"><br><br>  Dans ce cas, vous devez en outre dÃ©couvrir l'IP du serveur Web d'origine ou trouver une mÃ©thode qui ne concerne pas les adresses IP AWS. <br><br><h4>  5) Le site inclut le support de X-Forwarded-For </h4><br>  L'en-tÃªte X-Forwarded-For intÃ©grÃ© peut Ãªtre utilisÃ© pour changer IP.  Si l'application a un traitement intÃ©grÃ© pour cet en-tÃªte, envoyez simplement X-Forwarded-For: desire_IP pour remplacer l'adresse IP afin de contourner la restriction sans utiliser de proxy supplÃ©mentaires.  Chaque fois qu'une demande est envoyÃ©e par X-Forwarded-For, le serveur Web pense que notre adresse IP correspond Ã  la valeur transmise via l'en-tÃªte. <br>  Documents sur ce sujet: <br>  <a href="https://hackerone.com/reports/225897">hackerone.com/reports/225897</a> <br>  <a href="https://medium.com/%40arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157">medium.com/@arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157</a> <br><br><h2>  3. Contourner 2fa en substituant une partie de la demande d'une session d'un autre compte </h2><br>  Si un paramÃ¨tre avec une valeur spÃ©cifique est envoyÃ© pour vÃ©rifier le code dans la demande, essayez d'envoyer la valeur de la demande Ã  un autre compte. <br><br>  Par exemple, lors de l'envoi d'un code OTP, l'ID de formulaire, l'ID utilisateur ou le cookie associÃ© Ã  l'envoi du code est vÃ©rifiÃ©.  Si nous appliquons les donnÃ©es des paramÃ¨tres du compte sur lequel vous souhaitez contourner la vÃ©rification du code (compte 1) Ã  une session d'un compte complÃ¨tement diffÃ©rent (compte 2), nous obtiendrons le code et le saisirons sur le deuxiÃ¨me compte, nous pourrons alors contourner la protection sur le premier compte.  AprÃ¨s le rechargement, la page 2FA devrait disparaÃ®tre. <br><br><h2>  4. Contournez 2FA en utilisant la Â«fonctionnalitÃ© de mÃ©morisationÂ» </h2><br>  De nombreux sites qui prennent en charge l'autorisation 2FA ont la fonctionnalitÃ© Â«se souvenir de moiÂ».  Il est utile lorsque l'utilisateur ne souhaite pas entrer de code 2FA lors des connexions suivantes.  Il est important d'identifier la maniÃ¨re dont la Â«2FAÂ» est Â«mÃ©morisÃ©eÂ».  Cela peut Ãªtre un cookie, une valeur dans la session / stockage local, ou simplement attacher 2FA Ã  une adresse IP. <br><br><h4>  1) Si 2FA est attachÃ© Ã  l'aide d'un cookie, la valeur du cookie doit Ãªtre impossible Ã  deviner </h4><br>  Autrement dit, si un cookie se compose d'un ensemble de nombres qui augmentent pour chaque compte, il est tout Ã  fait possible d'appliquer une attaque par force brute Ã  la valeur du cookie et de contourner 2FA.  Les dÃ©veloppeurs doivent fournir le cookie (avec le cookie de session clÃ© et le jeton CSRF) avec l'attribut HttpOnly afin qu'il ne puisse pas Ãªtre volÃ© Ã  l'aide de XSS et utilisÃ© pour contourner 2FA. <br><br><h4>  2) Si 2FA est attachÃ© Ã  l'adresse IP, vous pouvez essayer de le remplacer </h4><br>  Pour identifier cette mÃ©thode, connectez-vous Ã  votre compte Ã  l'aide de la fonction de stockage 2FA, puis passez Ã  un autre navigateur ou au mode navigation privÃ©e du navigateur actuel et essayez de vous reconnecter.  Si 2FA n'est pas demandÃ© du tout, alors 2FA a Ã©tÃ© attachÃ© Ã  l'adresse IP. <br>  Pour remplacer l'adresse IP, vous pouvez utiliser l'en-tÃªte X-Forwarded-For au stade de la saisie du nom d'utilisateur et du mot de passe, si l'application Web le prend en charge. <br><br>  En utilisant cet en-tÃªte, vous pouvez Ã©galement contourner la fonction de liste blanche d'adresses IP, si une est prÃ©sente dans les paramÃ¨tres du compte.  Il peut Ãªtre utilisÃ© conjointement avec 2FA comme protection de compte supplÃ©mentaire ou 2FA peut mÃªme ne pas Ãªtre demandÃ© si l'adresse IP correspond Ã  la liste blanche (avec le consentement de l'utilisateur).  Ainsi, mÃªme sans attacher le 2FA Ã  l'adresse IP, dans certains cas, le 2FA peut Ãªtre contournÃ© en contournant les mÃ©thodes de protection associÃ©es. <br>  En gÃ©nÃ©ral, attacher 2FA Ã  une adresse IP n'est pas un moyen de protection complÃ¨tement sÃ»r, car lorsque vous Ãªtes prÃ©sent sur le mÃªme rÃ©seau, lorsqu'il est connectÃ© au mÃªme fournisseur de services VPN / Internet avec une adresse IP statique, 2FA peut Ãªtre contournÃ©. <br><br>  Le moyen le plus sÃ»r de vous protÃ©ger est de ne pas vous souvenir du 2FA au dÃ©triment de la convivialitÃ©. <br><br><h2>  5. Bogue de contrÃ´le d'accÃ¨s incorrect sur la page d'entrÃ©e 2FA </h2><br>  Parfois, une page de dialogue pour entrer 2FA est prÃ©sentÃ©e comme une URL avec des paramÃ¨tres.  L'accÃ¨s Ã  une telle page avec des paramÃ¨tres dans l'URL avec des cookies qui ne correspondent pas Ã  ceux utilisÃ©s pour gÃ©nÃ©rer la page ou sans cookies du tout n'est pas sÃ»r.  Mais si les dÃ©veloppeurs ont dÃ©cidÃ© d'accepter les risques, vous devez passer par plusieurs points importants: <br><br><ol><li>  Le lien expire-t-il pour l'entrÃ©e 2FA? </li><li>  si le lien est indexÃ© dans les moteurs de recherche. </li></ol><br>  Si le lien a une longue durÃ©e de vie et / ou que les moteurs de recherche contiennent des liens de travail pour l'entrÃ©e 2FA / les liens peuvent Ãªtre indexÃ©s (il n'y a pas de rÃ¨gles dans les balises robots.txt / meta), il y a une possibilitÃ© d'utiliser un mÃ©canisme de contournement 2FA sur la page d'entrÃ©e 2FA, dans laquelle contournez complÃ¨tement l'identifiant et le mot de passe et accÃ©dez au compte de quelqu'un d'autre. <br><br><h2>  6. Censure inadÃ©quate des donnÃ©es personnelles Ã  la page 2FA </h2><br>  Lors de l'envoi d'un code OTP sur une page, la censure est utilisÃ©e pour protÃ©ger les donnÃ©es personnelles telles que l'e-mail, le numÃ©ro de tÃ©lÃ©phone, le surnom, etc.  Mais ces donnÃ©es peuvent Ãªtre entiÃ¨rement divulguÃ©es dans les points de terminaison API et autres demandes pour lesquelles nous avons suffisamment de droits au stade 2FA.  Si au dÃ©part, ces donnÃ©es n'Ã©taient pas connues, par exemple, nous avons entrÃ© uniquement une connexion sans connaÃ®tre le numÃ©ro de tÃ©lÃ©phone, cela est considÃ©rÃ© comme la vulnÃ©rabilitÃ© de divulgation d'informations.  La connaissance du numÃ©ro de tÃ©lÃ©phone / e-mail peut Ãªtre utilisÃ©e pour des attaques de phishing et de force brute ultÃ©rieures. <br><br>  Un exemple d'exploitation d'une vulnÃ©rabilitÃ© Ã  l'aide du bourrage d'informations d'identification.  Disons qu'il existe une base de donnÃ©es dans le domaine public avec des connexions et des mots de passe pour le site A. Les attaquants peuvent utiliser les donnÃ©es de cette base de donnÃ©es sur le site B: <br><br><ul><li>  Tout d'abord, ils vÃ©rifient si l'utilisateur existe dans la base de donnÃ©es du site B Ã  l'aide du bogue Â«Ã‰numÃ©ration des comptesÂ» lors de l'enregistrement / rÃ©cupÃ©ration du mot de passe.  En rÃ¨gle gÃ©nÃ©rale, de nombreux sites ne considÃ¨rent pas cela comme une vulnÃ©rabilitÃ© et prennent des risques.  La Â«vulnÃ©rabilitÃ©Â» rÃ©side dans la prÃ©sence d'une erreur sur le fait de l'inscription des utilisateurs sur le site.  IdÃ©alement, un message sÃ©curisÃ© sur la page de rÃ©cupÃ©ration de mot de passe est le suivant: <br><br><img src="https://habrastorage.org/webt/mh/qe/mh/mhqemhmykfiy5pcl-35konzb0dm.png"><br><br><img src="https://habrastorage.org/webt/ha/uu/ze/hauuzewqlj9escx9nc8fslz4a0o.png"></li><li>  AprÃ¨s avoir obtenu la base de donnÃ©es des utilisateurs existants, les attaquants appliquent des mots de passe Ã  ces comptes. </li><li>  S'ils rencontrent 2FA, ils sont bloquÃ©s.  Mais en cas de censure insuffisante des donnÃ©es des utilisateurs, ils peuvent complÃ©ter leur base de donnÃ©es avec leurs donnÃ©es personnelles (s'ils n'Ã©taient pas dans la base de donnÃ©es d'origine). </li></ul><br><h2>  7. Ignorer 2FA dans certaines circonstances </h2><br>  Lors de l'exÃ©cution de certaines actions qui conduisent Ã  une connexion automatique Ã  votre compte, 2FA peut ne pas Ãªtre demandÃ©. <br><br><h4>  1) Ignorez 2FA lors de la rÃ©cupÃ©ration d'un mot de passe </h4><br>  De nombreux services se connectent automatiquement Ã  votre compte aprÃ¨s avoir terminÃ© la procÃ©dure de rÃ©cupÃ©ration de mot de passe.  Ã‰tant donnÃ© que l'accÃ¨s au compte est fourni instantanÃ©ment, lorsque vous vous connectez Ã  votre compte 2FA, il peut Ãªtre ignorÃ© et complÃ¨tement ignorÃ©. <br><br>  Impact d'un rapport de piratage similaire que j'ai envoyÃ© rÃ©cemment: <br><blockquote>  Si un attaquant accÃ¨de au courrier Ã©lectronique de la victime (il peut pirater le compte Ã  l'aide de phishing, d'attaques par force brute, de bourrage d'informations d'identification, etc.), il peut contourner 2FA, bien que dans ce cas, 2FA devrait protÃ©ger le compte.  Pour le moment, pour 2FA, il y a une vÃ©rification du code Google Authenticator ou du code de sauvegarde, mais pas du code de l'e-mail, donc ce contournement est logique. </blockquote><h4>  2) Ignorer 2FA lors de la connexion via un rÃ©seau social </h4><br>  Vous pouvez attacher un rÃ©seau social Ã  votre compte utilisateur pour vous connecter rapidement Ã  votre compte et en mÃªme temps configurer 2FA.  Lorsque vous vous connectez Ã  votre compte via les rÃ©seaux sociaux, 2FA peut Ãªtre ignorÃ©.  Si l'e-mail de la victime est piratÃ©, il sera possible de rÃ©cupÃ©rer le mot de passe du compte de rÃ©seau social (s'il le permet) et d'accÃ©der au service sans entrer 2FA. <br><br>  Impact d'un des rapports: <br><blockquote><ol><li>  Un tas d'autres vulnÃ©rabilitÃ©s, telles que la mauvaise configuration OAuth prÃ©cÃ©demment envoyÃ©e # 577468, pour capturer complÃ¨tement le compte, cassant 2FA. </li><li>  Si un attaquant piratait le courrier Ã©lectronique de l'utilisateur, il pourrait essayer de retrouver l'accÃ¨s au compte de rÃ©seau social et se connecter au compte sans vÃ©rification supplÃ©mentaire. </li><li>  Si un attaquant piratait une fois le compte d'une victime, il pourrait associer un rÃ©seau social au compte et se connecter Ã  l'avenir, ignorant complÃ¨tement 2FA et entrant le login / mot de passe. </li></ol></blockquote><h4>  3) Ignorer 2FA dans une ancienne version de l'application </h4><br>  Les dÃ©veloppeurs ajoutent souvent des versions intermÃ©diaires d'une application Web aux domaines / sous-domaines pour tester certaines fonctions.  Fait intÃ©ressant, si vous vous connectez en utilisant votre nom d'utilisateur et votre mot de passe, 2FA ne sera pas demandÃ©.  Peut-Ãªtre que les dÃ©veloppeurs utilisent une ancienne version de l'application, dans laquelle il n'y a pas de protection pour 2FA, 2FA elle-mÃªme est dÃ©sactivÃ©e ou elle a Ã©tÃ© intentionnellement dÃ©sactivÃ©e pour les tests. <br><br>  En outre, vous pouvez vÃ©rifier d'autres vulnÃ©rabilitÃ©s en mÃªme temps, - l'enregistrement d'un nouvel utilisateur sur un serveur de transfert dont la messagerie existe dans la base de donnÃ©es de version de production peut nous fournir des donnÃ©es personnelles de production;  l'absence de limite de dÃ©bit dans des fonctionnalitÃ©s importantes, par exemple la rÃ©cupÃ©ration de mot de passe.  Un exemple de la derniÃ¨re vulnÃ©rabilitÃ© est un bogue Facebook de 15 000 $, qui permettait de pirater un compte Ã  l'aide du code de rÃ©cupÃ©ration de mot de passe bruteforce sur beta.facebook.com <a href="https://www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d/">www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all- comptes-facebook-f47c0252ae4d</a> . <br><br><h4>  4) Ignorer 2FA en cas de multiplateforme </h4><br>  Les implÃ©mentations 2FA dans la version mobile ou de bureau peuvent diffÃ©rer de la version Web de l'application.  2FA peut Ãªtre plus faible que dans la version Web ou complÃ¨tement absent. <br><br>  7. Lors de la dÃ©sactivation de 2FA, le code actuel n'est pas demandÃ©. <br><br>  Si, lors de la dÃ©sactivation de 2FA, aucune confirmation supplÃ©mentaire n'est demandÃ©e, comme le code actuel de l'application d'authentification Google, le code de l'e-mail / tÃ©lÃ©phone, alors dans ce cas, il existe certains risques.  Avec une demande claire, il y a une chance d'une attaque CSRF.  Si un vecteur de contournement de la protection CSRF est trouvÃ© (le cas Ã©chÃ©ant), alors 2FA peut Ãªtre dÃ©sactivÃ©.  Une vulnÃ©rabilitÃ© de dÃ©tournement de clics peut Ã©galement Ãªtre utilisÃ©e - aprÃ¨s quelques clics d'un utilisateur sans mÃ©fiance, 2FA sera dÃ©connectÃ©.  La validation du code prÃ©cÃ©dent ajoutera une protection 2FA supplÃ©mentaire, compte tenu des attaques potentielles CSRF / XSS / Clickjacking, ainsi que des erreurs de configuration de CORS. <br><br>  Je vais vous donner un exemple de hackerone.com, - lorsque vous dÃ©sactivez 2FA dans un formulaire, vous devez saisir deux variables en mÃªme temps, - le code actuel avec l'application d'authentification google et le mot de passe.  Il s'agit de la meilleure protection recommandÃ©e. <br><br><img src="https://habrastorage.org/webt/wg/hh/jz/wghhjzf5sdotqin6knlde5i4g5q.png"><br><br><h2>  8. Les sessions prÃ©cÃ©demment crÃ©Ã©es restent valables aprÃ¨s l'activation de 2FA </h2><br>  Lorsque 2FA est activÃ©, il est souhaitable que les sessions parallÃ¨les sur le mÃªme compte se terminent et que la boÃ®te de dialogue d'entrÃ©e 2FA s'affiche, de mÃªme avec un changement de mot de passe.  Si le compte a Ã©tÃ© compromis et que la premiÃ¨re rÃ©action de la victime est l'inclusion de 2FA, la session de l'attaquant sera dÃ©sactivÃ©e et le prochain login et mot de passe nÃ©cessitera 2FA.  Dans l'ensemble, c'est la meilleure pratique Ã  suivre.  Je remarque souvent comment les Ã©changes de crypto-monnaie ajoutent une protection similaire.  Exemple de rapport HackerOne, - <br>  https://hackerone.com/reports/534450. <br><br><h4>  9. L'absence de limite de taux dans votre compte </h4><br>  2FA peut Ãªtre implÃ©mentÃ© dans diverses fonctions du compte personnel de l'utilisateur pour plus de sÃ©curitÃ©.  Cela peut Ãªtre un changement d'adresse e-mail, de mot de passe, la confirmation d'un changement de code pour les transactions financiÃ¨res, etc.  La prÃ©sence de rate-limit-a dans votre compte peut diffÃ©rer de la prÃ©sence de rate-limit-a dans 2FA lors de la connexion Ã  votre compte.  J'ai souvent rencontrÃ© des cas similaires oÃ¹ il Ã©tait possible de sÃ©lectionner librement un code 2FA dans mon compte, alors qu'Ã  l'entrÃ©e une limite de taux Â«stricteÂ» Ã©tait fixÃ©e. <br><br>  Si les dÃ©veloppeurs ont initialement ajoutÃ© une protection contre les modifications de donnÃ©es non autorisÃ©es, cette protection doit Ãªtre prise en charge et corrigÃ©e par tous les contournements possibles.  Si un contournement est trouvÃ©, cela est considÃ©rÃ© comme une vulnÃ©rabilitÃ© de contournement des fonctionnalitÃ©s de sÃ©curitÃ© qui a Ã©tÃ© implÃ©mentÃ©e par les dÃ©veloppeurs. <br><br><h4>  10. Versionnage de l'API </h4><br>  Si vous voyez quelque chose comme / v * / dans la demande de l'application Web, oÃ¹ * est un nombre, il est probable que vous puissiez passer Ã  une ancienne version de l'API.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans l'ancienne version de l'API, il peut y avoir une protection faible ou pas du tout. Il s'agit d'un Ã©vÃ©nement assez rare qui se produit si les dÃ©veloppeurs oublient de supprimer l'ancienne version de l'API dans l'environnement de production / de transfert. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, / endpoint / api / v4 / login effectue une demande de connexion, vÃ©rifiant le nom d'utilisateur et le mot de passe. Si 2FA est prÃ©sent dans le compte, cette demande doit Ãªtre suivie de / endpoint / api / v4 / 2fa_check, rien d'autre. Si nous remplaÃ§ons la version API avant 2FA, alors, dans certains cas, nous pouvons l'Ã©viter. / endpoint / api / v3 / login peut conduire Ã  / endpoint / v3 / login_successful? code = RANDOM, ignorant 2fa_check car dans cette version de l'API, 2FA n'Ã©tait tout simplement pas implÃ©mentÃ©.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un autre exemple - dans la requÃªte / endpoint / api / v4 / 2fa_check il y a une limite de dÃ©bit, tandis que / endpoint / api / v3 / 2fa_check vous permet d'itÃ©rer sur les codes sans aucune restriction. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. ContrÃ´le d'accÃ¨s incorrect lors de la demande de codes de sauvegarde </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les codes de sauvegarde sont gÃ©nÃ©rÃ©s immÃ©diatement aprÃ¨s l'activation de 2FA et sont disponibles sur une seule demande. </font><font style="vertical-align: inherit;">AprÃ¨s chaque appel ultÃ©rieur Ã  la demande, les codes peuvent Ãªtre gÃ©nÃ©rÃ©s par un nouveau ou rester inchangÃ©s (codes statiques). </font><font style="vertical-align: inherit;">S'il existe des vulnÃ©rabilitÃ©s CORS de mauvaise configuration / XSS et d'autres bogues qui vous permettent de Â«tirerÂ» les codes de sauvegarde de la demande de rÃ©ponse du point de terminaison d'affichage du code de sauvegarde, l'attaquant pourrait voler les codes et contourner 2FA si le nom d'utilisateur et le mot de passe sont connus.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En gÃ©nÃ©ral, 2fa est l'un des moyens les plus fiables de protÃ©ger votre compte, sauf si, bien sÃ»r, les dÃ©veloppeurs stockent les codes 2FA actuels de tous les utilisateurs de l'application Web dans le panneau d'administration - et cela s'est produit dans ma pratique. Je voudrais Ã©galement noter que les dÃ©veloppeurs de certaines entreprises crÃ©ent des applications pour gÃ©nÃ©rer leurs propres codes 2FA (des exemples sont Salesforce, Valve) et, en raison d'une sÃ©curitÃ© insuffisante, cette insistance sur l'indÃ©pendance par rapport Ã  l'utilisation d'autres applications d'authentification donne aux attaquants un point d'entrÃ©e supplÃ©mentaire pour contourner 2FA. Le champ d'application de cette protection est assez large et donne Ã  ceux qui souhaitent contourner la protection 2FA plus d'opportunitÃ©s, un espace pour la crÃ©ativitÃ© et augmente le nombre de variantes de dÃ©rivation 2FA.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'espÃ¨re que ces informations ont Ã©tÃ© utiles aux chercheurs en sÃ©curitÃ© de l'information, aux chasseurs de primes aux bogues, ainsi qu'aux dÃ©veloppeurs pour minimiser le nombre de vulnÃ©rabilitÃ©s dans le service en cours de dÃ©veloppement. </font><font style="vertical-align: inherit;">Restez en sÃ©curitÃ©!</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483134/">https://habr.com/ru/post/fr483134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483120/index.html">Comment connecter des cartes dans une projection ellipsoÃ¯de, si celle-ci n'est pas fournie?</a></li>
<li><a href="../fr483126/index.html">Les effets cryogÃ©niques peuvent assurer le transport en toute sÃ©curitÃ© des batteries de vÃ©hicules Ã©lectriques endommagÃ©es</a></li>
<li><a href="../fr483128/index.html">PrÃ©sentation de PHP 7.4: performances, fonctionnalitÃ©s, dÃ©prÃ©ciations</a></li>
<li><a href="../fr483130/index.html">Que faire si le code de la serrure de la valise est oubliÃ©?</a></li>
<li><a href="../fr483132/index.html">Conception et fabrication d'un tÃ©lescope</a></li>
<li><a href="../fr483136/index.html">VÃ©rification du MacBook utilisÃ© avant l'achat - liste de contrÃ´le</a></li>
<li><a href="../fr483140/index.html">Des polygones dans un autre monde: l'Amiga 500</a></li>
<li><a href="../fr483142/index.html">Portage de Quake 3 sur Rust</a></li>
<li><a href="../fr483144/index.html">Le scientifique He Jiankui est un hÃ©ros, pas un criminel</a></li>
<li><a href="../fr483146/index.html">ConfÃ©rence DEFCON 27. Outil de piratage WiFi sans fil Kraken</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>