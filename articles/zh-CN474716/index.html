<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍✈️ 🕴🏾 🎿 错误C ++ 20。 贝尔法斯特会议的结果 🍈 🚣🏿 🤙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前几天在贝尔法斯特召开了C ++编程语言标准化委员会的会议。 大约400条C ++ 20的评论从国家代表进入委员会，其中一半设法解决了。 

 在削减之下，您正在等待俄罗斯评论（是的，您对C ++ 20的评论），来自其他国家的评论以及当然是合适的新C ++ 23（执行器！）的讨论结果。 

 人们在...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>错误C ++ 20。 贝尔法斯特会议的结果</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/474716/"> 前几天在贝尔法斯特召开了C ++编程语言标准化委员会的会议。 大约400条C ++ 20的评论从国家代表进入委员会，其中一半设法解决了。 <br><br> 在削减之下，您正在等待俄罗斯评论（是的，您对C ++ 20的评论），来自其他国家的评论以及当然是合适的新C ++ 23（执行器！）的讨论结果。 <br><a name="habracut"></a><br> 人们在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">stdcpp.ru上</a> ，在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@ProCxx</a>聊天中，在Yandex.Taxi上或在会议中亲自提到的所有C ++问题，我们以对C ++ 20的评论的形式撰写。 所以呢... <br><br><h3>  std ::原子&lt;int&gt; a {}; 和std ::原子&lt;int&gt; b; </h3><br> 看起来很奇怪，但是变量<b>a</b>和<b>b</b>并未初始化为0。要将原子变量初始化为零，必须用{0}编写std :: atomic &lt;int&gt;； <br><br> 这种行为是完全不明显的，许多开发人员都将自己烧死了。 委员会接受了我们对标准的评论，并且在C ++ 20中，std :: atomic_flag和std :: atomic的默认构造函数将分别以<i>透明状态</i>和T（）初始化变量。 <br><br><h3> 性病::洗涤 </h3><br> 从C ++ 17开始，该标准具有可怕的功能std :: launder。 委员会成员认为标准库开发人员和普通用户会想出应对方法。 <br><br> 实际上，事实证明在某些情况下无法使用此功能。 原则上是绝对不需要的： <br><br><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c; }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;C&gt; v = {C{<span class="hljs-number"><span class="hljs-number">1</span></span>}}; v.pop_back(); v.push_back(C{<span class="hljs-number"><span class="hljs-number">2</span></span>}); assert(v.back().c == <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ]:-&gt;</span></span></code> </pre> <br> 如果严格遵守标准的规定，则取决于标准库的实现，编译器的功能和月相，assert可能会通过或失败。 <br><br> 在讨论该问题时，事实证明，优化（该标准描述了这种奇怪的行为）仅在其中一个编译器中实现，并没有带来明显的性能提升。 <br><br> 因此，从C ++ 20开始，您可以安全地将带有链接和常量字段的结构存储在std ::可选，std :: Variant，std :: vector，std :: deque等中。现在，placement new自动应用部分std逻辑： ：清洗。 <br><br><h3>  *这在构造函数中 </h3><br> 这是等待我们失败的评论之一： <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> {</span></span> C(C&amp;&amp; other) <span class="hljs-keyword"><span class="hljs-keyword">noexcept</span></span> : initial_(other.initial_) , secondary_(other.initial_) <span class="hljs-comment"><span class="hljs-comment">// O_O {} int initial_; int secondary_; };</span></span></code> </pre><br> 根据当前规则，在<b>O_O</b>行中<b>，</b>编译器有权假定＆other == this，因此，在上面的一行中，我们重写了other.initial_的值，需要重新读取它。 <br><br> 换句话说，编译器有权假定尚未创建的类使用从中构造对象的参数作为别名，因此，它可以生成非最佳代码。 <br><br> 一些编译器（例如，GCC）认为用户不会编写这样的耻辱，并且认为不可能混叠。 <br><br> 委员会拒绝了我们的言论“让我们假设不能混叠”。 事实证明，有些代码库具有可怕的骇客之处，而＆other ==这样，人们还没有准备好对他们说再见。 <br><br><h3> 运算符&lt;=&gt;和嵌入式编程 </h3><br> 为了使飞船操作员工作，您需要&lt;compare&gt;头文件。 但是，它不在任何平台上都可用的头文件列表中（在可以在任何Iron上使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>标准库的所谓<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">独立实现中</a> ）。 <br><br> 现在它在列表上了:) <br><br><h3> 其余的 </h3><br> 根据我们的其他评论，判决为“不在C ++ 20中”： <br>  *我们希望__func__在constexpr中使用。 <br>  *我们希望该概念不要使用不完整类型，因为否则您会遇到多个违反ODR的情况。 但是，这句话产生了意想不到的积极影响：如果您在require中使用不完整类型，则编译器现在会发出警告。 <br>  *我们想更正std :: string的赋值运算符，以免发生此类混乱： <br><br><pre> <code class="cpp hljs">basic_string::<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(charT c): <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> d = <span class="hljs-number"><span class="hljs-number">3.14</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; s = d; <span class="hljs-comment"><span class="hljs-comment">// Compiles</span></span></code> </pre><br> 委员会建议编写另一篇论文，并在C ++ 20之后对此进行更正。 <br>  *我们想终止std :: string_view中的临时行分配： <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::string_view sv; sv = foo(); <span class="hljs-comment"><span class="hljs-comment">// Compiles... dangling reference</span></span></code> </pre><br> 结果与之前的评论相同：委员会建议编写另一篇论文，并在C ++ 20之后对此进行更正。 <br>  *我们要求编译以下代码： <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;type_traits&gt; template &lt;typename... Xs&gt; auto f (Xs...) -&gt; std::invoke_result_t&lt;Xs...&gt;;</span></span></span></span></code> </pre><br> 有人告诉我们，一切都很复杂，几乎没有机会修复C ++ 20。 <br><br><h2> 来自其他国家的评论 </h2><br> 重大变化：从满足range :: contiguous_range概念的类型中添加std :: span的构造函数。 因此，现在可以从std :: vector和std :: string隐式创建span。 我们还从两个满足range :: contiguous_iterator概念的迭代器中添加了构造函数std :: string_view。 <br><br> 有趣的编辑期望&lt;compare&gt;。 在过去三年中，运算符&lt;=&gt;发生了很大变化。 他不再参与相等性的比较，因此，不再需要&lt;compare&gt;内容的三分之一。 一些国家已经注意到这一点-他们降低了标准。 <br><br> 非类型模板参数发生了很大的变化。 在C ++ 20中， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">几乎</a>可以将<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">任何</a>带有constexpr析构函数和公共成员作为模板参数的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">类（请参阅P1907）</a>传递，即使该类包含浮点类型或链接。 <br><br> 我们还将缺少的const添加到标准的不同部分，更改了C ++ 20新增的某些函数的参数名称和顺序。 对于概念和范围，标准文本的缩写以及其他一些小东西，也有许多编辑。 <br><br><h2> 数字TS </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">ZaMaZaN4iK</a>和C ++ Numerics Work In Progress文件使<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">我激动不已</a> 。 现在有针对C ++ 23的拿破仑式计划，旨在为用户提供一组新型的数字（wide_integer，integer，有理数）以及用于处理溢出和方便别名的辅助低级方法。 <br><br> 有人告诉我准备下一次会议的演讲，并介绍整个委员会的想法。 <br><br><h2> 执行者 </h2><br> 执行程序是C ++ 23的优先事项之一。 它们对于反应式编程是必需的，对于异步编程（网络，磁盘，进程等）是必需的，它们是协程隐藏的基础，并且应为第三方库提供单个接口。 <br><br> 同时，执行者应针对其内部实现优化算法。 例如，对于代码： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::input_range Range&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MySort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Range&amp; data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> stdr = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::ranges; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::sort(GetGlobalExecutor(), stdr::begin(data), stdr::end(data), <span class="hljs-number"><span class="hljs-number">42</span></span>); }</code> </pre><br>  GetGlobalExecutor（）函数可以返回： <br>  *单线程执行程序-它应在其线程上执行通常的std :: sort； <br>  *多线程执行程序-它应该执行并行排序； <br>  * GPU执行程序-它必须将数据移至视频卡的内存，在此处进行排序，然后将数据返回； <br>  * NUMA执行器-... <br>  * ... <br><br> 到目前为止，要实现此类功能，您需要执行可怕的定制点对象（CPO），并将每种算法都转化为它们。 委员会不喜欢... <br><br> 但是至少他们<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">预先批准了P0443-</a>基本接口。 对于执行人，所有随后的句子都需要以P0443的补丁形式编写。 <br><br><h2> 代替总数 </h2><br> 现在，只有一次委员会会议将我们与C ++ 20分开。 只剩一点点... <br><br> 好吧，每个想与委员会代表进行实时聊天的人-看看mitaps和C ++会议<i>（*）</i> ： <br>  * <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">明斯克的Corehard</a> <br>  * <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C ++西伯利亚2020</a> <br>  * <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C ++俄罗斯2020</a> <br>  * <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">圣</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">彼得斯堡C ++用户组</a> <br>  * <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">莫斯科C ++聚会2019</a> <br><br>  <i>（*）骇客：如果您是演讲者，则无需支付会议门票。</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN474716/">https://habr.com/ru/post/zh-CN474716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN474706/index.html">TextRadar模糊搜索算法-基本方法</a></li>
<li><a href="../zh-CN474708/index.html">互联网比以往任何时候都更加分散：每天有超过一百万的新用户在哪里“来”？ 第一部分</a></li>
<li><a href="../zh-CN474710/index.html">c.tech：前端聚会＃2</a></li>
<li><a href="../zh-CN474712/index.html">Udalenka在IT中的个人经验</a></li>
<li><a href="../zh-CN474714/index.html">全国零售的特色，或者我如何测试法国技术的力量</a></li>
<li><a href="../zh-CN474718/index.html">汽车电子安全-仪表盘控制器上的Hello World</a></li>
<li><a href="../zh-CN474720/index.html">下诺夫哥罗德无线电实验室和洛舍夫的“ cristadins”</a></li>
<li><a href="../zh-CN474722/index.html">“没有人告诉别人他们需要做什么”：NicolòRibaudo关于Babel开发等等</a></li>
<li><a href="../zh-CN474724/index.html">五年后PHP将会发生什么：我们问最近的莫斯科mitap的发言人</a></li>
<li><a href="../zh-CN474726/index.html">甚至孩子也能理解：JavaScript中异步/等待和承诺的简单说明</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>