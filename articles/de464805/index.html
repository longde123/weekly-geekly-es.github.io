<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙇🏼 ✋🏿 😨 Eine Schlange auf das iPad schreiben (Pythonista) 🤚🏽 ☑️ 🧑🏽‍🤝‍🧑🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="... oder wie man die Zeit mit einem iPad tötet und sonst nichts ... 

 Hallo! 

 Worüber sprichst du? 
 Leider ersetzen Tablets Computer noch nicht. A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eine Schlange auf das iPad schreiben (Pythonista)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464805/">  <i>... oder wie man die Zeit mit einem iPad tötet und sonst nichts ...</i> <br><br>  Hallo! <br><br><h3>  Worüber sprichst du? </h3><br>  Leider ersetzen Tablets Computer noch nicht.  Aber eine Fahrt / ein Flug ist wichtig.  Deshalb habe ich nach den IDes gesucht, die sich unter dem iPad befinden, und heute werde ich das Spiel auf Pythonista machen. <br><br><h3>  Was machen wir? </h3><br>  Die einfachsten Programme wie Kristalle (ja, ja, genau die, die Sie in der U-Bahn spielen).  Tetris, Schlange, Füllung - jeder Neuling, der ein wenig Verständnis hat, wird sie in 30 Minuten schreiben.  Unter der Zwischensequenz - Screenshots, Tutorial, Code. <br><a name="habracut"></a><br>  Hier sind ein paar Screenshots von dem, was ich vermasselt habe: <br><br><div class="spoiler">  <b class="spoiler_title">Viele Screenshots</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/n5/t-/0l/n5t-0lksjmfrqpvj-hphcjrqgv4.png"><br><br><img src="https://habrastorage.org/webt/lv/a0/ay/lva0ay1p6xghjzuh60hbewak8-i.png"><br><br><img src="https://habrastorage.org/webt/az/ow/zh/azowzhphjmi5xju-ynvluvhot48.png"><br><br><img src="https://habrastorage.org/webt/pf/vq/yj/pfvqyj1em0bsun4ozseqvjl6458.png"><br><br><img src="https://habrastorage.org/webt/4k/lo/w9/4klow9qq74gspnkh888hsksgk7c.png"><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Haftungsausschluss</b> <div class="spoiler_text">  Dieser Artikel richtet sich nicht nur ausschließlich an Anfänger (die Python kennen) und ermöglicht es Ihnen nicht, in zehn Minuten eine Panzerwelt oder eine fertige Anwendung im Allgemeinen zu erstellen. Der Autor garantiert jedoch keinen absolut schönen und korrekten Code aus Sicht der Programmierreligion (obwohl er es versucht). .  Und auch etwas wird aus Pythonista-Beispielen und -Dokumentationen gestohlen. <br></div></div><br>  <i>Der gesamte Code wird am Ende angegeben.</i> <br><br><h3>  Lernen Sie die Grafiken in Pythonista kennen </h3><br><div class="spoiler">  <b class="spoiler_title">Importieren</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random</code> </pre> <br></div></div><br>  Erstellen Sie sofort eine Szene: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"green"</span></span> run(Game(), LANDSCAPE)</code> </pre><br>  Fangen wir gleich an.  Sie sollten einen grünen Bildschirm haben.  Lassen Sie uns ein paar coole Sachen machen, indem wir die Update-Methode (die das System selbst aufruft) zur Game-Klasse hinzufügen und die Hintergrundfarbe ändern. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def update(self): self.background_color = (1.0, 1.0, (math.sin(self.t) + 1) / 2)</span></span></code> </pre><br>  Jetzt wechselt unser Bildschirm reibungslos von gelb nach weiß und umgekehrt. <br><br><img src="https://habrastorage.org/webt/-h/h_/vu/-hh_vuqntwuqqpno4h_jtu0944m.png"><br><br>  Erstellen Sie nun ein Objekt.  Wir erstellen es auch in der Setup-Methode: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.background_color = <span class="hljs-string"><span class="hljs-string">"white"</span></span> mypath = ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) self.obj = ShapeNode(mypath) self.obj.color = <span class="hljs-string"><span class="hljs-string">"purple"</span></span> <span class="hljs-comment"><span class="hljs-comment">#      html,  #FF00FF.   tuple,   (1.0, 0.0, 1.0).       alpha,    self.add_child(self.obj) def update(self): self.obj.position = (500 + 200 * math.sin(self.t), 500 + 200 * math.cos(self.t))</span></span></code> </pre><br>  Wir haben die Linie (mypath) festgelegt, einen ShapeNode darauf erstellt, die Farbe angezeigt und dann das übergeordnete Element angegeben (im Wesentlichen dasselbe - geben Sie das übergeordnete Element beim Erstellen an, d. H. ShapeNode (* ..., parent = self) oder self.add_child (obj)). <br><br>  Nun, in Game.update () ändern wir die Position des Objekts (Tupel), und es ist in Pixel und wird von der unteren linken Ecke aus gezählt. <br><blockquote>  Beachten Sie, dass wir die Szene nicht neu zeichnen müssen (obwohl dies möglich ist).  Objekte und Knoten, deren übergeordnetes Element die Szene ist (oder einige ihrer untergeordneten Objekte), werden selbst neu gezeichnet <br></blockquote>  Das Letzte, was wir in diesem Abschnitt durchgehen werden, ist touch_began (sowie touch_moved und touch_ended).  Es ist leicht zu erraten, dass die Methode Klicks auf dem Bildschirm abfängt.  Probieren wir es aus: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> mypath = ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) obj = ShapeNode(mypath) obj.color = (<span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>) self.add_child(obj) obj.position = touch.location</code> </pre><br><img src="https://habrastorage.org/webt/gp/1m/mu/gp1mmunnpgr5y6_c0ge8hpzqn8q.png"><br><br>  Jedes Mal, wenn Sie auf den Bildschirm klicken, erstellen wir einen Kreis. Der Ort des Klicks ist touch.location. <br><br><h3>  Bereit, eine Schlange zu schreiben </h3><br><div class="spoiler">  <b class="spoiler_title">Spielmechanismus</b> <div class="spoiler_text">  Eine Schlange ist eine Anordnung von Quadraten, wenn sich der Kopf bewegt - das zweite Stück bewegt sich an die Stelle des ersten, das dritte - an die Stelle des zweiten usw. Um den Schnittpunkt des Kopfes mit dem Schwanz herauszufinden, werden wir ihn mit jedem Stück Schwanz vergleichen <br></div></div><br>  Wir entfernen den gesamten geschriebenen Code, weil wir ihn mehr oder weniger schön machen wollen (aber natürlich werden wir Fahrräder machen). <br><br>  Zuerst erstellen wir die PhyObj-Klasse: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position = (x, y) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.position += (x, y)</code> </pre><br>  Ich denke, hier ist alles trivial.  Innerhalb der Klasse selbst haben wir einen Knoten erstellt und einige Methoden beschrieben, mit denen unser Code besser lesbar wird. <br><br><div class="spoiler">  <b class="spoiler_title">Holivary</b> <div class="spoiler_text">  Persönlich ziehe ich es vor, zuerst Klassen auf niedriger Ebene zu erstellen, die viele doppelte Methoden und Eigenschaften haben, aber dann wird der Code in den Klassen auf höherer Ebene sehr schön und lesbar. <br></div></div><br>  PhyObj ist das Objekt der untersten Ebene in unserem Spiel, tatsächlich ist es ein abstraktes physisches Objekt. <br><br><h4>  Beschreibung der Schlange </h4><br>  Jetzt müssen wir die Schlange beschreiben, und da sie aus Teilen besteht, werden wir zuerst eine beschreiben: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span></code> </pre><br>  Im Konstruktor rufen wir die übergeordnete Methode der Klasse auf und geben uns Form und Farbe.  Der Rand wird benötigt, damit die Quadrate nicht zusammenkleben und eine Art Netz bilden. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.tile = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) self.tile.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br>  Es hätte sich herausstellen sollen: <br><br><img src="https://habrastorage.org/webt/dg/yl/tf/dgyltfilompjygqnrriiio1mhv8.png"><br><br>  Aber warum brauchen wir zum Beispiel eine Marge: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> tile1 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile1.setpos(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) tile2 = Tile(self, (<span class="hljs-number"><span class="hljs-number">40</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>)) tile2.setpos(<span class="hljs-number"><span class="hljs-number">140</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)</code> </pre><br><img src="https://habrastorage.org/webt/0n/p8/i0/0np8i041mbo7udct2rsi3twsj18.png"><br><br>  Nun, aus diesen Stücken müssen Sie die Schlange kleben.  Wir brauchen eine Initialisierungsmethode und eine Verschiebungsmethode. <br><br>  Erstellen Sie zunächst die Initialisierung: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width <span class="hljs-comment"><span class="hljs-comment">#     self.tiles = [Tile(parent, (width, width)) for i in range(length)] #        for i, tile in enumerate(self.tiles): tile.setpos(initpos[0] + i * self.width, initpos[1]) #       </span></span></code> </pre><br>  Versuchen wir es gleich zu zeichnen: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self)</code> </pre><br><img src="https://habrastorage.org/webt/gv/kl/gg/gvklgg1stltccf2hxsyyuae_rsu.png"><br><br>  Fügen Sie die Verschiebungsmethode hinzu. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos()) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width)</code> </pre><br>  Zuerst bewegen wir den letzten zum vorletzten, dann den vorletzten zum vorletzten ... dann den zweiten zum ersten.  Und der erste auf (x, y). <br><br>  Eigentlich bewegt sich unsere Schlange gerade gut.  Versuchen wir mal: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(self)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def update(self): self.snake.move(0, 1)</span></span></code> </pre><br>  Wenn du es geschafft hast zu sehen, dann kroch sie weg, wie es sollte.  Tatsache ist, dass das Update sehr oft aufgerufen wird (und übrigens optional mit demselben Intervall). Daher müssen wir berücksichtigen, wie viel Zeit seit dem letzten Aufruf vergangen ist, und warten, bis es sich genug angesammelt hat. <br><br>  Kurz gesagt, wir tun: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake = Snake(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">40</span></span>, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(<span class="hljs-number"><span class="hljs-number">0.3</span></span>): self.snake.move(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br>  time_gone gibt True zurück, wenn mehr Zeit als t vergangen ist.  Jetzt bewegt sich die Schlange alle 0,3 Sekunden.  Hat es geklappt? <br><br><img src="https://habrastorage.org/webt/it/ew/cn/itewcnxtf37hx-bkj2-_tnrjnug.png"><br><br><h4>  Management </h4><br>  Jetzt müssen Sie die Kontrolle übernehmen, dh eine Drehung in alle vier Richtungen: <br><br><img src="https://habrastorage.org/webt/5l/hw/mo/5lhwmoxex5c_lfafmihwivyw1ym.png"><br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): # &lt;...&gt; self.dir = (0, 1) #     def update(self): if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br>  Und jetzt müssen wir touch_began verarbeiten, um zu verstehen, in welchen Bereich der Benutzer gestochen hat.  Eigentlich stellte sich heraus, dass es nicht so interessant war, wie ich dachte, also können Sie hier einfach kopieren: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def touch_began(self, touch): ws = touch.location[0] / self.size.w hs = touch.location[1] / self.size.h aws = 1 - ws if ws &gt; hs and aws &gt; hs: self.dir = (0, -1) elif ws &gt; hs and aws &lt;= hs: self.dir = (1, 0) elif ws &lt;= hs and aws &gt; hs: self.dir = (-1, 0) else: self.dir = (0, 1)</span></span></code> </pre><br>  Versuchen Sie es jetzt <br><br><img src="https://habrastorage.org/webt/-a/s5/8p/-as58pqevh1gfcxx4a556pttljo.png"><br><br>  Der Hauptmechanismus ist ausgearbeitet, es bleibt eine Überprüfung auf Kollisionen und Äpfel. <br><br><h4>  Schwanzkollision </h4><br>  Beginnen wir mit der Überprüfung und fügen der Schlange die Methode find_collisions hinzu <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_collisions(self): for i in range(1, len(self.tiles)): if self.tiles[i].getpos() == self.tiles[0].getpos(): return self.tiles[i], self.tiles[0] return False</span></span></code> </pre><br>  Jetzt können wir ein Paar Zellen erhalten, die sich schneiden.  Ich möchte sie rot färben und die Würfelmethode zu Tile hinzufügen: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def die(self): self.graph_obj.color = "red"</span></span></code> </pre><br>  Fügen Sie eine Überprüfung hinzu, um das Setup zu aktualisieren und zu ändern: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.snake = Snake(30, 40, (200, 200), self) #   self.time_reset() self.dir = (0, 1) self.game_on = True #   ? def update(self): if not self.game_on: #  ,  return col = self.snake.find_collisions() #  ? if col: for tile in col: tile.die() #     self.game_on = False #   if self.time_gone(0.3): self.snake.move(*self.dir)</span></span></code> </pre><br>  Was ist mit mir passiert: <br><br><img src="https://habrastorage.org/webt/zu/gx/n2/zugxn2bxvlbhj6cagawcjy-qsdi.png"><br><br>  Es bleibt Äpfel zu machen. <br><br><h4>  Dehnung und Äpfel </h4><br>  Wir werden die Schlange verlängern und damit sie schön aussieht, wird ein neuer Link gemäß den letzten beiden hinzugefügt, das heißt: <br><br><img src="https://habrastorage.org/webt/kl/sg/uv/klsguvpmusyky4y78dvdmk_nvdu.png"><br><br>  Fügen Sie der Schlange die Methoden hinzu: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def find_dir(self, x1, y1, x2, y2): if x1 == x2 and y1 &gt; y2: return (0, 1) elif x1 == x2 and y1 &lt; y2: return (0, -1) elif y1 == y2 and x1 &gt; x2: return (1, 0) elif y1 == y2 and x1 &lt; x2: return (-1, 0) else: assert False, "Error!" def append(self): if len(self.tiles) &gt; 1: lastdir = self.find_dir(*self.tiles[-1].getpos(), *self.tiles[-2].getpos()) else: lastdir = (-self.parent.dir[0], -self.parent.dir[1]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[-2].getpos() self.tiles[-1].setpos(x_prev + lastdir[0] * self.width, y_prev + lastdir[1] * self.width)</span></span></code> </pre><br>  find_dir findet die Richtung, in die die Schwanzspitze unserer Heldin gerichtet ist.  Anhängen, es ist leicht zu erraten, fügt eine Zelle hinzu.  Füge dem Spiel eine weitere snake_lengthen-Methode hinzu: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset()</span></span></code> </pre><br>  Die letzte Zeile wird benötigt, damit die Schlange ein wenig wartet und der Benutzer Zeit hat, um zu sehen, dass das Stück hinzugefügt wurde. <br><br>  Um herauszufinden, ob sich etwas mit der Schlange schneidet, fügen Sie die Schnittmethode hinzu. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def getpos(self): return self.tiles[0].getpos() def intersect(self, x, y): return self.getpos() == (x, y)</span></span></code> </pre><br>  Hurra, es bleibt nur ein Apfel zu kreieren.  Eigentlich beschreiben wir den Apfel auf einmal: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width)</code> </pre><br>  Solch eine seltsame Zufälligkeit ist erforderlich, um unser Bullauge auf das Gitter zu richten.  Dann ist es nicht notwendig, den Abstand zwischen der Schnauze und dem Apfel zu suchen und seinen Scheiterhaufen zu vergleichen.  Nur auf ifas.  Gehen wir zum Aktualisieren und fügen am Ende dieser Funktion sehr einfache Zeilen hinzu: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.apple = Apple(40, (50, 50), self) # 40 -  ,       Snake() # &lt;...&gt; def update(self): # &lt;...&gt; if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate()</span></span></code> </pre><br>  Nun, alles scheint zu sein, jetzt verlängert sich die Schlange, wenn sie auf einen Apfel trifft, und stirbt, wenn sie sich selbst trifft. <br><br><img src="https://habrastorage.org/webt/0r/de/gw/0rdegw0knuwccnbh6jz5oy5hova.png"><br><br><h4>  Bonus </h4><br>  Sie können Soundeffekte erstellen: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def snake_lengthen(self): self.snake.append() self.time_reset() sound.play_effect('arcade:Powerup_1', 0.25, 0.8)</span></span></code> </pre><br>  Machen Sie eine sanfte Bewegung: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(10, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.game_on = True class Snake: # &lt;...&gt; def move(self, x, y): for i in range(len(self.tiles) - 1, 0, -1): self.tiles[i].setpos(*self.tiles[i - 1].getpos(), self.parent.GLOBAL_TIMING) self.tiles[0].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) class PhyObj: def __init__(self, path, color, parent): self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position def setpos(self, x, y, t=0.0): self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) #    x, y    t def getpos(self): return self.pos def move(self, x, y, t=0.0): self.pos = (self.pos[0] + x, self.pos[1] + y) self.graph_obj.run_action(Action.move_by(x, y, t))</span></span></code> </pre><br>  Mit anderen Worten, wir haben die Logik der Position PhyObj geändert.  Früher haben wir uns auf die Position des grafischen Elements konzentriert, und jetzt gibt es ein separates Feld für die logische Position (dh das für die Spielelogik verwendete), und die Position des grafischen Elements ist jetzt frei und kann auf seine eigene Weise geändert werden.  Mit Action hinterlassen wir ihr nämlich einen parallelen Strom, in dem sie sich bewegt. <br><br>  Eine so glatte Schlange stellte sich heraus: <br><br><img src="https://habrastorage.org/webt/8g/ma/4x/8gma4xndidknidevmnr49pleuyc.png"><br><br>  Und zum Schluss das Etikett mit der Länge der Schlange: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># &lt;...&gt; def setup(self): self.game_on = False self.GLOBAL_TIMING = 0.2 self.GLOBAL_WIDTH = 40 self.apple = Apple(self.GLOBAL_WIDTH, (50, 50), self) self.snake = Snake(30, self.GLOBAL_WIDTH, (200, 200), self) self.time_reset() self.dir = (0, 1) self.label = LabelNode("", font=("Chalkduster", 20), parent=self, position=(self.size.w / 2, self.size.h - 100)) #    self.update_labels() self.game_on = True def update_labels(self): self.label.text = "Length: " + str(len(self.snake.tiles)) def update(self): if not self.game_on: return col = self.snake.find_collisions() if col: for tile in col: tile.die() self.game_on = False if self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) if self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() # </span></span></code> </pre><br><img src="https://habrastorage.org/webt/pu/vk/s5/puvks5yyrimbzdvzfbt4kwysml4.png"><br><br>  Freunde, danke für eure Aufmerksamkeit!  Wenn etwas nicht klar ist, fragen Sie.  Und wenn es interessant sein wird - ich werde weitermachen, gibt es noch etwas zu erzählen (aber dieser Artikel ist schon ziemlich lang). <br><br><div class="spoiler">  <b class="spoiler_title">Alle Schlangencode</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sound <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PhyObj</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path, color, parent)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj = ShapeNode(path, parent=parent) self.parent = parent self.graph_obj.color = color self.pos = self.graph_obj.position <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (x, y) self.graph_obj.run_action(Action.move_to(x, y, t)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.pos <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y, t=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pos = (self.pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + x, self.pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] + y) self.graph_obj.run_action(Action.move_by(x, y, t)) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent, size, margin=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">4</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.rect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>] - margin, size[<span class="hljs-number"><span class="hljs-number">1</span></span>] - margin), <span class="hljs-string"><span class="hljs-string">"#66FF66"</span></span>, parent) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">die</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.graph_obj.color = <span class="hljs-string"><span class="hljs-string">"red"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Snake</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, length, width, initpos, parent)</span></span></span><span class="hljs-function">:</span></span> self.width = width self.tiles = [Tile(parent, (width, width)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(length)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(self.tiles): tile.setpos(initpos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + i * self.width, initpos[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.parent = parent <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(len(self.tiles) - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): self.tiles[i].setpos(*self.tiles[i - <span class="hljs-number"><span class="hljs-number">1</span></span>].getpos(), self.parent.GLOBAL_TIMING) self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].move(x * self.width, y * self.width, self.parent.GLOBAL_TIMING) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_collisions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, len(self.tiles)): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.tiles[i].getpos() == self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos(): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[i], self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find_dir</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x1, y1, x2, y2)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &gt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> x1 == x2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> y1 &lt; y2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &gt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> y1 == y2 <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x1 &lt; x2: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">"Error!"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">append</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.tiles) &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>: lastdir = self.find_dir(*self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].getpos(), *self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos()) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: lastdir = (-self.parent.dir[<span class="hljs-number"><span class="hljs-number">0</span></span>], -self.parent.dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) self.tiles.append(Tile(self.parent, (self.width, self.width))) x_prev, y_prev = self.tiles[<span class="hljs-number"><span class="hljs-number">-2</span></span>].getpos() self.tiles[<span class="hljs-number"><span class="hljs-number">-1</span></span>].setpos(x_prev + lastdir[<span class="hljs-number"><span class="hljs-number">0</span></span>] * self.width, y_prev + lastdir[<span class="hljs-number"><span class="hljs-number">1</span></span>] * self.width) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>].getpos() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intersect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.getpos() == (x, y) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apple</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(PhyObj)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, width, size, parent)</span></span></span><span class="hljs-function">:</span></span> super().__init__(ui.Path.oval(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, size[<span class="hljs-number"><span class="hljs-number">0</span></span>], size[<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">"#55AAFF"</span></span>, parent) self.parent = parent self.width = width self.dislocate() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dislocate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> a = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.w / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) b = random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, int(self.parent.size.h / self.width) - <span class="hljs-number"><span class="hljs-number">2</span></span>) self.setpos(a * self.width, b * self.width) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">snake_lengthen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.snake.append() self.time_reset() sound.play_effect(<span class="hljs-string"><span class="hljs-string">'arcade:Powerup_1'</span></span>, <span class="hljs-number"><span class="hljs-number">0.25</span></span>, <span class="hljs-number"><span class="hljs-number">0.8</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.last_time = self.t <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time_gone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.t - self.last_time &gt; t: res = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.time_reset() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.GLOBAL_TIMING = <span class="hljs-number"><span class="hljs-number">0.2</span></span> self.GLOBAL_WIDTH = <span class="hljs-number"><span class="hljs-number">40</span></span> self.apple = Apple(self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>), self) self.snake = Snake(<span class="hljs-number"><span class="hljs-number">30</span></span>, self.GLOBAL_WIDTH, (<span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-number"><span class="hljs-number">200</span></span>), self) self.time_reset() self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) self.label = LabelNode(<span class="hljs-string"><span class="hljs-string">""</span></span>, font=(<span class="hljs-string"><span class="hljs-string">"Chalkduster"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>), parent=self, position=(self.size.w / <span class="hljs-number"><span class="hljs-number">2</span></span>, self.size.h - <span class="hljs-number"><span class="hljs-number">100</span></span>)) self.update_labels() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_labels</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.label.text = <span class="hljs-string"><span class="hljs-string">"Length: "</span></span> + str(len(self.snake.tiles)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.game_on: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> col = self.snake.find_collisions() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> col: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> col: tile.die() self.game_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.time_gone(self.GLOBAL_TIMING): self.snake.move(*self.dir) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.snake.intersect(*self.apple.getpos()): self.snake_lengthen() self.apple.dislocate() self.update_labels() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touch_began</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> ws = touch.location[<span class="hljs-number"><span class="hljs-number">0</span></span>] / self.size.w hs = touch.location[<span class="hljs-number"><span class="hljs-number">1</span></span>] / self.size.h aws = <span class="hljs-number"><span class="hljs-number">1</span></span> - ws <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &gt; hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &lt;= hs: self.dir = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> ws &lt;= hs <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> aws &gt; hs: self.dir = (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: self.dir = (<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) run(Game(), LANDSCAPE)</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Crystal Code WhiteBlackGoose Edition</b> <div class="spoiler_text">  Es ist lustig, dass ich, nachdem ich es gemacht habe, in den Beispielen von Pythonista selbst etwas SEHR Ähnliches gefunden habe.  Aber ich habe ein bisschen mehr Funktionen :) <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scene <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> math <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pi <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uniform <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rnd, choice, randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random A = Action sys.setrecursionlimit(<span class="hljs-number"><span class="hljs-number">1000000</span></span>) colors = [<span class="hljs-string"><span class="hljs-string">'pzl:Green5'</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Red5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Blue5"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"pzl:Purple5"</span></span>, <span class="hljs-string"><span class="hljs-string">"pzl:Button2"</span></span>] + [<span class="hljs-string"><span class="hljs-string">"plf:Item_CoinGold"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> inited inited = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Explosion</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Node)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> Node.__init__(self, *args, **kwargs) self.position = brick.position <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> dx, dy <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ((<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>), (<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)): p = SpriteNode(brick.texture, scale=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, parent=self) p.position = brick.size.w/<span class="hljs-number"><span class="hljs-number">4</span></span> * dx, brick.size.h/<span class="hljs-number"><span class="hljs-number">4</span></span> * dy p.size = brick.size d = <span class="hljs-number"><span class="hljs-number">0.6</span></span> r = <span class="hljs-number"><span class="hljs-number">30</span></span> p.run_action(A.move_to(rnd(-r, r), rnd(-r, r), d)) p.run_action(A.scale_to(<span class="hljs-number"><span class="hljs-number">0</span></span>, d)) p.run_action(A.rotate_to(rnd(-pi/<span class="hljs-number"><span class="hljs-number">2</span></span>, pi/<span class="hljs-number"><span class="hljs-number">2</span></span>), d)) self.run_action(A.sequence(A.wait(d), A.remove())) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brick</span></span></span><span class="hljs-class"> </span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SpriteNode)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, brick_type, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> img = colors[brick_type] SpriteNode.__init__(self, img, *args, **kwargs) self.brick_type = brick_type self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.enabled = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.remove_from_parent() self.is_on = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">demark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.lf = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Scene)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brickgetpos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, i, j)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (self.Woff + j * self.W, self.Hoff + i * self.H) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">brick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ty, i, j)</span></span></span><span class="hljs-function">:</span></span> b = Brick(ty, size=(self.W, self.H), position=self.brickgetpos(i, j), parent=self.game_node) b.rotation = random.random() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> b <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">random_brick_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.992</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; <span class="hljs-number"><span class="hljs-number">0.8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> FONT = (<span class="hljs-string"><span class="hljs-string">'Chalkduster'</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>) self.score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Score: 0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-100</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.score = <span class="hljs-number"><span class="hljs-number">0</span></span> self.last_score_label = LabelNode(<span class="hljs-string"><span class="hljs-string">'Delta: +0'</span></span>, font=FONT, position=(self.size.w/<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-300</span></span>, self.size.h<span class="hljs-number"><span class="hljs-number">-40</span></span>), parent=self) self.last_score = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">#self.avg_label = LabelNode('Speed: +0/s', font=FONT, position=(self.size.w/2+100, self.size.h-40), parent=self) #self.max_label = LabelNode('Peak: +0/s', font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) #self.max_speed = 0 self.game_time = 120 self.timel = LabelNode('Time: ' + str(self.game_time) + "s", font=FONT, position=(self.size.w/2+300, self.size.h-40), parent=self) self.gems = [0 for i in colors] self.effect_node = EffectNode(parent=self) self.game_node = Node(parent=self.effect_node) self.l = [0 for i in colors] self.lt = [0 for i in colors] for i in range(len(colors)): R = 50 if i == 6 else 35 self.l[i] = Brick(i, size=(R, R), position=(40, self.size.h-100-i*40), parent=self.game_node) self.lt[i] = LabelNode(": 0", font=FONT, position=(self.l[i].position[0] + 40, self.l[i].position[1]), parent=self) self.WB = 30 self.HB = 30 self.W = 900 // self.WB self.H = 900 // self.HB self.colcount = 4 self.Woff = (int(self.size.w) - self.W * self.WB + self.W) // 2 self.Hoff = self.H + 10 self.net = [[self.brick(self.random_brick_type(), i, j) for i in range(self.HB)] for j in range(self.WB)] #self.touch_moved = self.touch_began self.start_time = self.t self.game_on = True global inited inited = True def demark(self): for bricks in self.net: for brick in bricks: brick.demark() def howfar(self, x, y): alt = 0 for i in range(y): if not self.net[x][i].is_on: alt += 1 return alt def update(self): global inited if not inited: return self.game_on = self.t - self.start_time &lt; self.game_time if self.game_on: self.timel.text = "Time: " + str(round(self.game_time - (self.t - self.start_time))) + "s" else: self.timel.text = "Game over" #if speed &gt; self.max_speed: # self.max_speed = speed # self.max_label.text = "Peak: +" + str(round(self.max_speed)) + "/s" def gravity(self, x, y): alt = self.howfar(x, y) if alt == 0: return self.net[x][y].destroy() self.net[x][y - alt] = self.brick(self.net[x][y].brick_type, y, x) self.net[x][y - alt].position = self.net[x][y].position self.net[x][y - alt].rotation = self.net[x][y].rotation self.net[x][y - alt].enabled = False self.net[x][y - alt].run_action(A.sequence(A.move_to(*self.brickgetpos(y - alt, x), 0.2 * alt ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(x, y - alt)))) def enable_cell(self, x, y): self.net[x][y].enabled = True def fall(self): for x in range(self.WB): for y in range(self.HB): if self.net[x][y].is_on: self.gravity(x, y) def update_scores(self): self.score += self.last_score self.score_label.text = "Score: " + str(self.score) self.last_score_label.text = "Delta: +" + str(self.last_score) self.last_score = 0 def update_cells(self): for i in range(self.WB): for j in range(self.HB): if not self.net[i][j].is_on: self.net[i][j] = self.brick(self.random_brick_type(), j + self.HB, i) self.net[i][j].enabled = True self.net[i][j].run_action(A.sequence(A.move_to(*self.brickgetpos(j, i), 0.2 * self.HB ** 0.5, TIMING_EASE_IN_2), A.call(lambda: self.enable_cell(i, j)))) def inbounds(self, x, y): return (x &gt;= 0) and (y &gt;= 0) and (x &lt; self.WB) and (y &lt; self.HB) def bomb(self, x, y, radius): score = 0 bc = 0 for i in range(round(4 * radius ** 2)): rad = random.random() * radius ang = random.random() * 2 * pi xp, yp = x + sin(ang) * rad, y + cos(ang) * rad xp, yp = int(xp), int(yp) if self.inbounds(xp, yp): score += self.explode(xp, yp) self.fall() self.give_score(round(score / 1.7), self.brickgetpos(y, x)) def laser(self, x, y): score = 0 coords = [] for i in range(self.HB): for j in range(-1, 1 + 1, 1): coords.append((x + j, i)) for i in range(self.WB): coords.append((i, y)) for i in range(-self.HB, self.HB): coords.append((x + i, y + i)) for i in range(-self.WB, self.WB): coords.append((x - i, y + i)) bc = 0 for x, y in coords: if not self.inbounds(x, y): continue score += self.explode(x, y) self.fall() self.give_score(score, self.brickgetpos(y, x)) def getty(self, x, y): if not self.inbounds(x, y) or not self.net[x][y].is_on: return -1 else: return self.net[x][y].brick_type def popupt(self, text, position_, font_=("Arial", 30), color_="white"): label = LabelNode(text, font=font_, color=color_, parent=self, position=position_) label.run_action(A.sequence(A.wait(1), A.call(label.remove_from_parent))) def give_score(self, count, xy): self.last_score = int(count ** 2.5) size = 10 if self.last_score &gt; 50000: size = 60 elif self.last_score &gt; 20000: size = 40 elif self.last_score &gt; 10000: size = 30 elif self.last_score &gt; 5000: size = 25 elif self.last_score &gt; 2000: size = 20 elif self.last_score &gt; 1000: size = 15 if self.last_score &gt; 0: self.popupt("+" + str(self.last_score), xy, font_=("Chalkduster", int(size * 1.5))) self.update_scores() def touch_began(self, touch): if not self.game_on: return x, y = touch.location x, y = x + self.W / 2, y + self.H / 2 W, H = get_screen_size() x, y = x, y x, y = int(x), int(y) x, y = x - self.Woff, y - self.Hoff x, y = x // self.W, y // self.H if not self.inbounds(x, y): return count = self.react(self.net[x][y].brick_type, x, y, True) self.demark() if self.getty(x, y) in [0, 1, 2, 3]: if count &gt;= 2: self.react(self.net[x][y].brick_type, x, y) self.fall() self.give_score(count, touch.location) elif self.getty(x, y) == 4: self.bomb(x, y, 5 * count) elif self.getty(x, y) == 5: self.explode(x, y) self.fall() self.update_cells() def explode(self, x, y): if self.net[x][y].is_on: self.net[x][y].destroy() self.gems[self.net[x][y].brick_type] += 1 s = str(self.gems[self.net[x][y].brick_type]) self.lt[self.net[x][y].brick_type].text = " " * len(s) + ": " + s self.game_node.add_child(Explosion(self.net[x][y])) return True else: return False def react(self, col, x, y, ignore=False): if self.inbounds(x, y) and self.net[x][y].brick_type == col and self.net[x][y].is_on and self.net[x][y].lf and self.net[x][y].enabled: if not ignore: self.explode(x, y) else: self.net[x][y].mark() r = 1 r += self.react(col, x + 1, y + 0, ignore) r += self.react(col, x - 1, y - 0, ignore) r += self.react(col, x + 0, y + 1, ignore) r += self.react(col, x - 0, y - 1, ignore) return r else: return 0 def destroy_brick(self, x, y): self.net[x][y].destroy() run(Game(), LANDSCAPE, show_fps=True)</span></span></code> </pre><br></div></div><br>  Demonstration der Arbeit von Kristallen: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PLTlEe3xsaU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de464805/">https://habr.com/ru/post/de464805/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de464785/index.html">Nicht wettbewerbsfähige Beeline-Vorteile</a></li>
<li><a href="../de464787/index.html">Ich bin sicher, dass Senior Mobile Developer nur auf Empfehlung kommen werden</a></li>
<li><a href="../de464791/index.html">Kubernetes für das Auto: So öffnen Sie den Entwicklerzugriff auf den Bordcomputer und machen ihn sicher</a></li>
<li><a href="../de464795/index.html">Merry Quartusel oder wie der Prozessor zu einem solchen Leben gekommen ist</a></li>
<li><a href="../de464803/index.html">"Hide www": Warum Mainstream-Browser-Entwickler sich erneut weigerten, die Subdomain anzuzeigen</a></li>
<li><a href="../de464811/index.html">Apple Music für den Entwickler</a></li>
<li><a href="../de464819/index.html">Mein sechster Tag mit Haiku: unter der Haube von Ressourcen, Symbolen und Paketen</a></li>
<li><a href="../de464823/index.html">Wir betrachten das Durchschnittsgehalt eines „Datenwissenschaftlers“. Parsim hh.ru mit pandas / python</a></li>
<li><a href="../de464825/index.html">Vorbereiten der Anwendung für Android Q. Teil 2</a></li>
<li><a href="../de464831/index.html">Hinzufügen der Razor Pages-Funktionalität zum Standard-.NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>