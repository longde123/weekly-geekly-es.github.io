<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•ß ‚ôüÔ∏è ü•ñ O livro "Modelagem preditiva na pr√°tica" üïù üòë üëãüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oi, habrozhiteli! A ‚Äúmodelagem preditiva na pr√°tica‚Äù abrange todos os aspectos da previs√£o, come√ßando com os principais est√°gios do pr√©-processamento,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O livro "Modelagem preditiva na pr√°tica"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/462833/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/6z/8t/vz/6z8tvzrupg6sctybnofbe97w9ks.jpeg" align="left" alt="imagem"></a>  Oi, habrozhiteli!  A ‚Äúmodelagem preditiva na pr√°tica‚Äù abrange todos os aspectos da previs√£o, come√ßando com os principais est√°gios do pr√©-processamento, divis√£o de dados e os princ√≠pios b√°sicos do ajuste do modelo.  Todas as etapas da modelagem s√£o consideradas em exemplos pr√°ticos da vida real, em cada cap√≠tulo √© fornecido um c√≥digo detalhado em R. <br><br>  Este livro pode ser usado como uma introdu√ß√£o aos modelos preditivos e um guia para sua aplica√ß√£o.  Os leitores que n√£o possuem treinamento matem√°tico apreciar√£o as explica√ß√µes intuitivas de m√©todos espec√≠ficos, e a aten√ß√£o dada √† solu√ß√£o de problemas reais com dados reais ajudar√° os especialistas que desejam melhorar suas habilidades. <br><br>  Os autores tentaram evitar f√≥rmulas complexas, entender os conceitos estat√≠sticos b√°sicos, como an√°lise de correla√ß√£o e regress√£o linear, √© suficiente para dominar o material b√°sico, mas √© necess√°rio treinamento matem√°tico para estudar t√≥picos avan√ßados. <br><a name="habracut"></a><br><h3>  Trecho.  7.5  C√°lculos </h3><br>  Esta se√ß√£o usar√° fun√ß√µes dos pacotes R caret, earth, kernlab e nnet. <br><br>  O R possui muitos pacotes e fun√ß√µes para criar redes neurais.  Isso inclui pacotes nnet, neural e RSNNS.  O foco principal est√° no pacote nnet, que suporta modelos b√°sicos de redes neurais com um n√≠vel de vari√°veis ‚Äã‚Äãocultas, redu√ß√£o de peso e √© caracterizado por uma sintaxe relativamente simples.  O RSNNS suporta uma ampla variedade de redes neurais.  Observe que Bergmeir e Benitez (2012) t√™m uma breve descri√ß√£o dos v√°rios pacotes de redes neurais em R. Ele tamb√©m fornece um tutorial sobre o RSNNS. <br><br><h3>  Redes neurais </h3><br>  Para aproximar o modelo de regress√£o, a fun√ß√£o nnet pode receber a f√≥rmula do modelo e a interface da matriz.  Para a regress√£o, a rela√ß√£o linear entre vari√°veis ‚Äã‚Äãocultas e a previs√£o √© usada com o par√¢metro linout = TRUE.  A chamada mais simples para a fun√ß√£o de rede neural ser√° semelhante a: <br><br><pre><code class="javascript hljs">&gt; nnetFit &lt;- nnet(predictors, outcome, + size = <span class="hljs-number"><span class="hljs-number">5</span></span>, + decay = <span class="hljs-number"><span class="hljs-number">0.01</span></span>, + linout = TRUE, + ##   + trace = FALSE, + ##      + ##  .. + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>, + ##   ,   + MaxNWts = <span class="hljs-number"><span class="hljs-number">5</span></span> * (ncol(predictors) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Essa chamada cria um modelo com cinco vari√°veis ‚Äã‚Äãocultas.  Sup√µe-se que os dados nos preditores foram padronizados em uma √∫nica escala. <br><br>  Para calcular a m√©dia dos modelos, √© usada a fun√ß√£o avNNet do pacote de intercala√ß√£o, que possui a mesma sintaxe: <br><br><pre> <code class="javascript hljs">&gt; nnetAvg &lt;- avNNet(predictors, outcome, + size = <span class="hljs-number"><span class="hljs-number">5</span></span>, + decay = <span class="hljs-number"><span class="hljs-number">0.01</span></span>, + ##    + repeats = <span class="hljs-number"><span class="hljs-number">5</span></span>, + linout = TRUE, + ##   + trace = FALSE, + ##    + ##    .. + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>, + ##   ,   + MaxNWts = <span class="hljs-number"><span class="hljs-number">5</span></span> * (ncol(predictors) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">5</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Novos pontos de dados s√£o processados ‚Äã‚Äãpelo comando <br><br><pre> <code class="javascript hljs">&gt; predict(nnetFit, newData) &gt; ##  &gt; predict(nnetAvg, newData)</code> </pre> <br>  Para reproduzir o m√©todo apresentado anteriormente, de escolher o n√∫mero de vari√°veis ‚Äã‚Äãocultas e a quantidade de redu√ß√£o de peso por meio de amostragem repetida, aplicamos a fun√ß√£o train com o par√¢metro method = ‚Äúnnet‚Äù ou method = ‚ÄúavNNet‚Äù, primeiro removendo os preditores (para que a correla√ß√£o absoluta m√°xima de pares entre os preditores n√£o exceda 0,75): <br><br><pre> <code class="javascript hljs">&gt; ## findCorrelation      &gt; ##  ,       &gt; ##       &gt; tooHigh &lt;- findCorrelation(cor(solTrainXtrans), cutoff = <span class="hljs-number"><span class="hljs-number">.75</span></span>) &gt; trainXnnet &lt;- solTrainXtrans[, -tooHigh] &gt; testXnnet &lt;- solTestXtrans[, -tooHigh] &gt; ##   -  : &gt; nnetGrid &lt;- expand.grid(.decay = c(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">.1</span></span>), + .size = c(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>), + ##   ‚Äî   + ## (.  )   + ##  . + .bag = FALSE) &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; nnetTune &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"avNNet"</span></span>, + tuneGrid = nnetGrid, + trControl = ctrl, + ##    + ##     + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + linout = TRUE, + trace = FALSE, + MaxNWts = <span class="hljs-number"><span class="hljs-number">10</span></span> * (ncol(trainXnnet) + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">10</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>, + maxit = <span class="hljs-number"><span class="hljs-number">500</span></span>)</code> </pre> <br><h3>  Splines de regress√£o adaptativa multidimensional </h3><br>  Os modelos MARS est√£o contidos em v√°rios pacotes, mas a implementa√ß√£o mais extensa est√° no pacote earth.  Um modelo MARS usando a fase nominal de passagem direta e truncamento pode ser chamado da seguinte maneira: <br><br><pre> <code class="javascript hljs">&gt; marsFit &lt;- earth(solTrainXtrans, solTrainY) &gt; marsFit Selected <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span> terms, and <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Importance: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ... Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> terms at each degree <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> interaction: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> (additive model) GCV <span class="hljs-number"><span class="hljs-number">0.3877448</span></span> RSS <span class="hljs-number"><span class="hljs-number">312.877</span></span> GRSq <span class="hljs-number"><span class="hljs-number">0.907529</span></span> RSq <span class="hljs-number"><span class="hljs-number">0.9213739</span></span></code> </pre> <br>  Como esse modelo na implementa√ß√£o interna usa o m√©todo GCV para selecionar um modelo, sua estrutura √© um pouco diferente do modelo descrito anteriormente neste cap√≠tulo.  O m√©todo de resumo gera uma sa√≠da mais extensa: <br><br><pre> <code class="javascript hljs">&gt; summary(marsFit) Call: earth(x=solTrainXtrans, y=solTrainY) coefficients (Intercept) <span class="hljs-number"><span class="hljs-number">-3.223749</span></span> FP002 <span class="hljs-number"><span class="hljs-number">0.517848</span></span> FP003 <span class="hljs-number"><span class="hljs-number">-0.228759</span></span> FP059 <span class="hljs-number"><span class="hljs-number">-0.582140</span></span> FP065 <span class="hljs-number"><span class="hljs-number">-0.273844</span></span> FP075 <span class="hljs-number"><span class="hljs-number">0.285520</span></span> FP083 <span class="hljs-number"><span class="hljs-number">-0.629746</span></span> FP085 <span class="hljs-number"><span class="hljs-number">-0.235622</span></span> FP099 <span class="hljs-number"><span class="hljs-number">0.325018</span></span> FP111 <span class="hljs-number"><span class="hljs-number">-0.403920</span></span> FP135 <span class="hljs-number"><span class="hljs-number">0.394901</span></span> FP142 <span class="hljs-number"><span class="hljs-number">0.407264</span></span> FP154 <span class="hljs-number"><span class="hljs-number">-0.620757</span></span> FP172 <span class="hljs-number"><span class="hljs-number">-0.514016</span></span> FP176 <span class="hljs-number"><span class="hljs-number">0.308482</span></span> FP188 <span class="hljs-number"><span class="hljs-number">0.425123</span></span> FP202 <span class="hljs-number"><span class="hljs-number">0.302688</span></span> FP204 <span class="hljs-number"><span class="hljs-number">-0.311739</span></span> FP207 <span class="hljs-number"><span class="hljs-number">0.457080</span></span> h(MolWeight<span class="hljs-number"><span class="hljs-number">-5.77508</span></span>) <span class="hljs-number"><span class="hljs-number">-1.801853</span></span> h(<span class="hljs-number"><span class="hljs-number">5.94516</span></span>-MolWeight) <span class="hljs-number"><span class="hljs-number">0.813322</span></span> h(NumNonHAtoms<span class="hljs-number"><span class="hljs-number">-2.99573</span></span>) <span class="hljs-number"><span class="hljs-number">-3.247622</span></span> h(<span class="hljs-number"><span class="hljs-number">2.99573</span></span>-NumNonHAtoms) <span class="hljs-number"><span class="hljs-number">2.520305</span></span> h(<span class="hljs-number"><span class="hljs-number">2.57858</span></span>-NumNonHBonds) <span class="hljs-number"><span class="hljs-number">-0.564690</span></span> h(NumMultBonds<span class="hljs-number"><span class="hljs-number">-1.85275</span></span>) <span class="hljs-number"><span class="hljs-number">-0.370480</span></span> h(NumRotBonds<span class="hljs-number"><span class="hljs-number">-2.19722</span></span>) <span class="hljs-number"><span class="hljs-number">-2.753687</span></span> h(<span class="hljs-number"><span class="hljs-number">2.19722</span></span>-NumRotBonds) <span class="hljs-number"><span class="hljs-number">0.123978</span></span> h(NumAromaticBonds<span class="hljs-number"><span class="hljs-number">-2.48491</span></span>) <span class="hljs-number"><span class="hljs-number">-1.453716</span></span> h(NumNitrogen<span class="hljs-number"><span class="hljs-number">-0.584815</span></span>) <span class="hljs-number"><span class="hljs-number">8.239716</span></span> h(<span class="hljs-number"><span class="hljs-number">0.584815</span></span>-NumNitrogen) <span class="hljs-number"><span class="hljs-number">-1.542868</span></span> h(NumOxygen<span class="hljs-number"><span class="hljs-number">-1.38629</span></span>) <span class="hljs-number"><span class="hljs-number">3.304643</span></span> h(<span class="hljs-number"><span class="hljs-number">1.38629</span></span>-NumOxygen) <span class="hljs-number"><span class="hljs-number">-0.620413</span></span> h(NumChlorine<span class="hljs-number"><span class="hljs-number">-0.46875</span></span>) <span class="hljs-number"><span class="hljs-number">-50.431489</span></span> h(HydrophilicFactor- <span class="hljs-number"><span class="hljs-number">-0.816625</span></span>) <span class="hljs-number"><span class="hljs-number">0.237565</span></span> h(<span class="hljs-number"><span class="hljs-number">-0.816625</span></span>-HydrophilicFactor) <span class="hljs-number"><span class="hljs-number">-0.370998</span></span> h(SurfaceArea1<span class="hljs-number"><span class="hljs-number">-1.9554</span></span>) <span class="hljs-number"><span class="hljs-number">0.149166</span></span> h(SurfaceArea2<span class="hljs-number"><span class="hljs-number">-4.66178</span></span>) <span class="hljs-number"><span class="hljs-number">-0.169960</span></span> h(<span class="hljs-number"><span class="hljs-number">4.66178</span></span>-SurfaceArea2) <span class="hljs-number"><span class="hljs-number">-0.157970</span></span> Selected <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span> terms, and <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Importance: NumNonHAtoms, MolWeight, SurfaceArea2, SurfaceArea1, FP142, ... Number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> terms at each degree <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> interaction: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> (additive model) GCV <span class="hljs-number"><span class="hljs-number">0.3877448</span></span> RSS <span class="hljs-number"><span class="hljs-number">312.877</span></span> GRSq <span class="hljs-number"><span class="hljs-number">0.907529</span></span> RSq <span class="hljs-number"><span class="hljs-number">0.9213739</span></span></code> </pre> <br>  Nesta deriva√ß√£o, h (¬∑) √© a fun√ß√£o de dobradi√ßa.  Nos resultados acima, o componente h (MolWeight-5,77508) √© igual a zero para um peso molecular menor que 5,77508 (como na parte superior da Fig. 7.3).  A fun√ß√£o de dobradi√ßa refletida tem o formato h (5,77508 - MolWeight). <br><br>  A fun√ß√£o plotmo da embalagem terra pode ser usada para criar diagramas semelhantes aos mostrados na fig.  7.5  Voc√™ pode usar o train para configurar o modelo usando reamostragem externa.  O c√≥digo a seguir reproduz os resultados mostrados na fig.  7.4: <br><br><pre> <code class="javascript hljs">&gt; #  -   &gt; marsGrid &lt;- expand.grid(.degree = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>, .nprune = <span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">38</span></span>) &gt; #      &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; marsTuned &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"earth"</span></span>, + #   -   + tuneGrid = marsGrid, + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>)) &gt; marsTuned <span class="hljs-number"><span class="hljs-number">951</span></span> samples <span class="hljs-number"><span class="hljs-number">228</span></span> predictors No pre-processing Resampling: Cross-Validation (<span class="hljs-number"><span class="hljs-number">10</span></span>-fold) Summary <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sample sizes: <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">857</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, ... Resampling results across tuning parameters: degree nprune RMSE Rsquared RMSE SD Rsquared SD <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1.54</span></span> <span class="hljs-number"><span class="hljs-number">0.438</span></span> <span class="hljs-number"><span class="hljs-number">0.128</span></span> <span class="hljs-number"><span class="hljs-number">0.0802</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1.12</span></span> <span class="hljs-number"><span class="hljs-number">0.7</span></span> <span class="hljs-number"><span class="hljs-number">0.0968</span></span> <span class="hljs-number"><span class="hljs-number">0.0647</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1.06</span></span> <span class="hljs-number"><span class="hljs-number">0.73</span></span> <span class="hljs-number"><span class="hljs-number">0.0849</span></span> <span class="hljs-number"><span class="hljs-number">0.0594</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1.02</span></span> <span class="hljs-number"><span class="hljs-number">0.75</span></span> <span class="hljs-number"><span class="hljs-number">0.102</span></span> <span class="hljs-number"><span class="hljs-number">0.0551</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.984</span></span> <span class="hljs-number"><span class="hljs-number">0.768</span></span> <span class="hljs-number"><span class="hljs-number">0.0733</span></span> <span class="hljs-number"><span class="hljs-number">0.042</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0.919</span></span> <span class="hljs-number"><span class="hljs-number">0.796</span></span> <span class="hljs-number"><span class="hljs-number">0.0657</span></span> <span class="hljs-number"><span class="hljs-number">0.0432</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">0.862</span></span> <span class="hljs-number"><span class="hljs-number">0.821</span></span> <span class="hljs-number"><span class="hljs-number">0.0418</span></span> <span class="hljs-number"><span class="hljs-number">0.0237</span></span> : : : : : : <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">0.701</span></span> <span class="hljs-number"><span class="hljs-number">0.883</span></span> <span class="hljs-number"><span class="hljs-number">0.068</span></span> <span class="hljs-number"><span class="hljs-number">0.0307</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">34</span></span> <span class="hljs-number"><span class="hljs-number">0.702</span></span> <span class="hljs-number"><span class="hljs-number">0.883</span></span> <span class="hljs-number"><span class="hljs-number">0.0699</span></span> <span class="hljs-number"><span class="hljs-number">0.0307</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">0.696</span></span> <span class="hljs-number"><span class="hljs-number">0.885</span></span> <span class="hljs-number"><span class="hljs-number">0.0746</span></span> <span class="hljs-number"><span class="hljs-number">0.0315</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">0.687</span></span> <span class="hljs-number"><span class="hljs-number">0.887</span></span> <span class="hljs-number"><span class="hljs-number">0.0604</span></span> <span class="hljs-number"><span class="hljs-number">0.0281</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-number"><span class="hljs-number">0.696</span></span> <span class="hljs-number"><span class="hljs-number">0.885</span></span> <span class="hljs-number"><span class="hljs-number">0.0689</span></span> <span class="hljs-number"><span class="hljs-number">0.0291</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">38</span></span> <span class="hljs-number"><span class="hljs-number">0.686</span></span> <span class="hljs-number"><span class="hljs-number">0.887</span></span> <span class="hljs-number"><span class="hljs-number">0.0626</span></span> <span class="hljs-number"><span class="hljs-number">0.029</span></span> RMSE was used to select the optimal model using the smallest value. The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were degree = <span class="hljs-number"><span class="hljs-number">1</span></span> and nprune = <span class="hljs-number"><span class="hljs-number">38.</span></span> &gt; head(predict(marsTuned, solTestXtrans)) [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.3677522</span></span> <span class="hljs-number"><span class="hljs-number">-0.1503220</span></span> <span class="hljs-number"><span class="hljs-number">-0.5051844</span></span> <span class="hljs-number"><span class="hljs-number">0.5398116</span></span> <span class="hljs-number"><span class="hljs-number">-0.4792718</span></span> <span class="hljs-number"><span class="hljs-number">0.7377222</span></span></code> </pre> <br>  Duas fun√ß√µes s√£o usadas para avaliar a import√¢ncia de cada preditor no modelo MARS: evimp do pacote earth e varImp do pacote caret (a segunda chama a primeira): <br><br><pre> <code class="javascript hljs">&gt; varImp(marsTuned) earth variable importance only <span class="hljs-number"><span class="hljs-number">20</span></span> most important variables shown (out <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">228</span></span>) Overall MolWeight <span class="hljs-number"><span class="hljs-number">100.00</span></span> NumNonHAtoms <span class="hljs-number"><span class="hljs-number">89.96</span></span> SurfaceArea2 <span class="hljs-number"><span class="hljs-number">89.51</span></span> SurfaceArea1 <span class="hljs-number"><span class="hljs-number">57.34</span></span> FP142 <span class="hljs-number"><span class="hljs-number">44.31</span></span> FP002 <span class="hljs-number"><span class="hljs-number">39.23</span></span> NumMultBond s <span class="hljs-number"><span class="hljs-number">39.23</span></span> FP204 <span class="hljs-number"><span class="hljs-number">37.10</span></span> FP172 <span class="hljs-number"><span class="hljs-number">34.96</span></span> NumOxygen <span class="hljs-number"><span class="hljs-number">30.70</span></span> NumNitrogen <span class="hljs-number"><span class="hljs-number">29.12</span></span> FP083 <span class="hljs-number"><span class="hljs-number">28.21</span></span> NumNonHBonds <span class="hljs-number"><span class="hljs-number">26.58</span></span> FP059 <span class="hljs-number"><span class="hljs-number">24.76</span></span> FP135 <span class="hljs-number"><span class="hljs-number">23.51</span></span> FP154 <span class="hljs-number"><span class="hljs-number">21.20</span></span> FP207 <span class="hljs-number"><span class="hljs-number">19.05</span></span> FP202 <span class="hljs-number"><span class="hljs-number">17.92</span></span> NumRotBonds <span class="hljs-number"><span class="hljs-number">16.94</span></span> FP085 <span class="hljs-number"><span class="hljs-number">16.02</span></span></code> </pre> <br>  Esses resultados s√£o dimensionados no intervalo de 0 a 100, diferindo dos dados na tabela.  7.1 (o modelo apresentado na Tabela 7.1 n√£o passou pelo processo completo de crescimento e truncamento).  Observe que as vari√°veis ‚Äã‚Äãque seguem os primeiros s√£o menos significativas para o modelo. <br><br><h3>  SVM, m√©todo de vetor de suporte </h3><br>  As implementa√ß√µes de modelos SVM est√£o contidas em v√°rios pacotes R. Chang e Lin (Chang e Lin, 2011) usam a fun√ß√£o svm do pacote e1071 para usar a interface da biblioteca LIBSVM para regress√£o.  Uma implementa√ß√£o mais completa dos modelos SVM para regress√£o de Karatsogl (Karatzoglou et al., 2004) est√° contida no pacote kernlab, que inclui a fun√ß√£o ksvm para modelos de regress√£o e um grande n√∫mero de fun√ß√µes nucleares.  Por padr√£o, a fun√ß√£o base radial √© usada.  Se os valores de custo e os par√¢metros nucleares forem conhecidos, a aproxima√ß√£o do modelo poder√° ser realizada da seguinte maneira: <br><br><pre> <code class="javascript hljs">&gt; svmFit &lt;- ksvm(x = solTrainXtrans, y = solTrainY, + kernel =<span class="hljs-string"><span class="hljs-string">"rbfdot"</span></span>, kpar = <span class="hljs-string"><span class="hljs-string">"automatic"</span></span>, + C = <span class="hljs-number"><span class="hljs-number">1</span></span>, epsilon = <span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  Para estimar œÉ, foi utilizada a an√°lise automatizada.  Como y √© um vetor num√©rico, a fun√ß√£o obviamente se aproxima do modelo de regress√£o (em vez do modelo de classifica√ß√£o).  Voc√™ pode usar outras fun√ß√µes do kernel, incluindo polinomial (kernel = "polydot") e linear (kernel = "vanilladot"). <br><br>  Se os valores forem desconhecidos, eles podem ser estimados por re-amostragem.  No treinamento, os valores ‚ÄúsvmRadial‚Äù, ‚ÄúsvmLinear‚Äù ou ‚ÄúsvmPoly‚Äù do par√¢metro method selecionam diferentes fun√ß√µes do kernel: <br><br><pre> <code class="javascript hljs">&gt; svmRTuned &lt;- train(solTrainXtrans, solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"svmRadial"</span></span>, + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + tuneLength = <span class="hljs-number"><span class="hljs-number">14</span></span>, + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>))</code> </pre> <br>  O argumento tuneLength usa 14 valores padr√£o. <img src="https://habrastorage.org/webt/tj/ey/rh/tjeyrh-jsrh2bavjcscm784t7d0.png" alt="imagem"><br><img src="https://habrastorage.org/webt/8a/67/hy/8a67hygcgz4_re1ru2xxpg_a0io.png" alt="imagem">  Uma estimativa padr√£o de œÉ √© realizada atrav√©s da an√°lise autom√°tica. <br><br><pre> <code class="javascript hljs">&gt; svmRTuned <span class="hljs-number"><span class="hljs-number">951</span></span> samples <span class="hljs-number"><span class="hljs-number">228</span></span> predictors Pre-processing: centered, scaled Resampling: Cross-Validation (<span class="hljs-number"><span class="hljs-number">10</span></span>-fold) Summary <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sample sizes: <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">858</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">855</span></span>, <span class="hljs-number"><span class="hljs-number">856</span></span>, ... Resampling results across tuning parameters: C RMSE Rsquared RMSE SD Rsquared SD <span class="hljs-number"><span class="hljs-number">0.25</span></span> <span class="hljs-number"><span class="hljs-number">0.793</span></span> <span class="hljs-number"><span class="hljs-number">0.87</span></span> <span class="hljs-number"><span class="hljs-number">0.105</span></span> <span class="hljs-number"><span class="hljs-number">0.0396</span></span> <span class="hljs-number"><span class="hljs-number">0.5</span></span> <span class="hljs-number"><span class="hljs-number">0.708</span></span> <span class="hljs-number"><span class="hljs-number">0.889</span></span> <span class="hljs-number"><span class="hljs-number">0.0936</span></span> <span class="hljs-number"><span class="hljs-number">0.0345</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0.664</span></span> <span class="hljs-number"><span class="hljs-number">0.898</span></span> <span class="hljs-number"><span class="hljs-number">0.0834</span></span> <span class="hljs-number"><span class="hljs-number">0.0306</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.642</span></span> <span class="hljs-number"><span class="hljs-number">0.903</span></span> <span class="hljs-number"><span class="hljs-number">0.0725</span></span> <span class="hljs-number"><span class="hljs-number">0.0277</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.629</span></span> <span class="hljs-number"><span class="hljs-number">0.906</span></span> <span class="hljs-number"><span class="hljs-number">0.067</span></span> <span class="hljs-number"><span class="hljs-number">0.0253</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">0.621</span></span> <span class="hljs-number"><span class="hljs-number">0.908</span></span> <span class="hljs-number"><span class="hljs-number">0.0634</span></span> <span class="hljs-number"><span class="hljs-number">0.0238</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.617</span></span> <span class="hljs-number"><span class="hljs-number">0.909</span></span> <span class="hljs-number"><span class="hljs-number">0.0602</span></span> <span class="hljs-number"><span class="hljs-number">0.0232</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">0.613</span></span> <span class="hljs-number"><span class="hljs-number">0.91</span></span> <span class="hljs-number"><span class="hljs-number">0.06</span></span> <span class="hljs-number"><span class="hljs-number">0.0234</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">0.611</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0586</span></span> <span class="hljs-number"><span class="hljs-number">0.0231</span></span> <span class="hljs-number"><span class="hljs-number">128</span></span> <span class="hljs-number"><span class="hljs-number">0.609</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0561</span></span> <span class="hljs-number"><span class="hljs-number">0.0223</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-number"><span class="hljs-number">0.609</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.056</span></span> <span class="hljs-number"><span class="hljs-number">0.0224</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-number"><span class="hljs-number">0.61</span></span> <span class="hljs-number"><span class="hljs-number">0.911</span></span> <span class="hljs-number"><span class="hljs-number">0.0563</span></span> <span class="hljs-number"><span class="hljs-number">0.0226</span></span> <span class="hljs-number"><span class="hljs-number">1020</span></span> <span class="hljs-number"><span class="hljs-number">0.613</span></span> <span class="hljs-number"><span class="hljs-number">0.91</span></span> <span class="hljs-number"><span class="hljs-number">0.0563</span></span> <span class="hljs-number"><span class="hljs-number">0.023</span></span> <span class="hljs-number"><span class="hljs-number">2050</span></span> <span class="hljs-number"><span class="hljs-number">0.618</span></span> <span class="hljs-number"><span class="hljs-number">0.909</span></span> <span class="hljs-number"><span class="hljs-number">0.0541</span></span> <span class="hljs-number"><span class="hljs-number">0.023</span></span> Tuning parameter <span class="hljs-string"><span class="hljs-string">'sigma'</span></span> was held constant at a value <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">0.00387</span></span> RMSE was used to select the optimal model using the smallest value. The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were C = <span class="hljs-number"><span class="hljs-number">256</span></span> and sigma = <span class="hljs-number"><span class="hljs-number">0.00387</span></span>.</code> </pre> <br>  O subobjeto finalModel cont√©m o modelo criado pela fun√ß√£o ksvm: <br><br><pre> <code class="javascript hljs">&gt; svmRTuned$finalModel Support Vector Machine object <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ksvm</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SV</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eps</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">svr</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">regression</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">parameter</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">epsilon</span></span></span><span class="hljs-class"> </span></span>= <span class="hljs-number"><span class="hljs-number">0.1</span></span> cost C = <span class="hljs-number"><span class="hljs-number">256</span></span> Gaussian Radial Basis kernel <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">. </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Hyperparameter</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sigma</span></span></span><span class="hljs-function"> = 0.00387037424967707 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Number</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Support</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Vectors</span></span></span><span class="hljs-function"> : 625 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Objective</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Value</span></span></span><span class="hljs-function"> : -1020.558 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Training</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> : 0.009163</span></span></code> </pre> <br>  Como vetores de refer√™ncia, o modelo usa 625 pontos de dados do conjunto de treinamento (ou seja, 66% do conjunto de treinamento). <br><br>  O pacote kernlab cont√©m uma implementa√ß√£o do modelo RVM para regress√£o na fun√ß√£o rvm.  Sua sintaxe √© muito semelhante √† apresentada no exemplo para o ksvm. <br><br><h3>  M√©todo KNN </h3><br>  O pacote caren knnreg se aproxima do modelo de regress√£o KNN;  a fun√ß√£o train define o modelo para K: <br><br><pre> <code class="javascript hljs">&gt; #      . &gt; knnDescr &lt;- solTrainXtrans[, -nearZeroVar(solTrainXtrans)] &gt; set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) &gt; knnTune &lt;- train(knnDescr, + solTrainY, + method = <span class="hljs-string"><span class="hljs-string">"knn"</span></span>, + #      + #    + preProc = c(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-string"><span class="hljs-string">"scale"</span></span>), + tuneGrid = data.frame(.k = <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>), + trControl = trainControl(method = <span class="hljs-string"><span class="hljs-string">"cv"</span></span>))</code> </pre> <br><br><h3>  Sobre os autores: </h3><br>  <b>Max Kun</b> √© chefe do Departamento de Pesquisa e Desenvolvimento Estat√≠stico N√£o Cl√≠nico da Pfizer Global.  Ele trabalha com modelos preditivos h√° mais de 15 anos e √© autor de v√°rios pacotes especializados para a linguagem R. Na pr√°tica, a modelagem preditiva abrange todos os aspectos da previs√£o, come√ßando com os principais est√°gios de pr√©-processamento de dados, divis√£o de dados e princ√≠pios b√°sicos <br>  configura√ß√µes do modelo.  Todas as etapas da modelagem s√£o consideradas em exemplos pr√°ticos. <br>  da vida real, cada cap√≠tulo fornece um c√≥digo detalhado em R. <br><br>  <b>Kjell Johnson</b> trabalha no campo da estat√≠stica e modelagem preditiva para pesquisa farmac√™utica h√° mais de dez anos.  Co-fundador da Arbor Analytics, uma empresa especializada em modelagem preditiva;  anteriormente chefiou o departamento de pesquisa e desenvolvimento estat√≠stico da Pfizer Global.  Seu trabalho cient√≠fico √© dedicado √† aplica√ß√£o e desenvolvimento de metodologia estat√≠stica e algoritmos de aprendizado. <br><br>  ¬ªMais informa√ß√µes sobre o livro podem ser encontradas no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site do editor</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conte√∫do</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Trecho</a> <br><br>  Cupom de 25% de desconto para vendedores ambulantes - <b>Modelagem Preditiva Aplicada</b> <br>  Ap√≥s o pagamento da vers√£o impressa do livro, um livro eletr√¥nico √© enviado por e-mail. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462833/">https://habr.com/ru/post/pt462833/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462819/index.html">Defici√™ncias no ensino de idiomas na CEI: uma vis√£o poliglota</a></li>
<li><a href="../pt462821/index.html">Como avaliar computadores que ainda n√£o existem</a></li>
<li><a href="../pt462825/index.html">Relat√≥rios de v√≠deo do Summer Droid Meetup</a></li>
<li><a href="../pt462827/index.html">Vida e sucesso de Larry Ellison, fundador da Oracle</a></li>
<li><a href="../pt462831/index.html">Ride the Web 3.0 Wave</a></li>
<li><a href="../pt462835/index.html">Layout e estilos autom√°ticos do Unity: nosso novo pipeline e ferramentas para interface do usu√°rio</a></li>
<li><a href="../pt462837/index.html">Black Box Testing</a></li>
<li><a href="../pt462843/index.html">Limita√ß√µes de jogos de 8 bits e sua recrea√ß√£o exata no Unity</a></li>
<li><a href="../pt462845/index.html">Massagem para o seu c√©rebro: fale sobre ASMR</a></li>
<li><a href="../pt462847/index.html">Webinars da Hewlett Packard Enterprise em agosto-outubro de 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>