<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥚 👨🏽 🌒 Browser membisukan suara dalam aplikasi WebRTC Anda. Hentikan apa? 👌🏽 🧘🏻 🙇🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Teknologi WebRTC (panggilan suara dan video) bagus karena ia dibangun langsung ke web, yang, tentu saja, sangat cocok untuk WebRTC. Namun, kadang-kada...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Browser membisukan suara dalam aplikasi WebRTC Anda. Hentikan apa?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/417085/">  Teknologi WebRTC (panggilan suara dan video) bagus karena ia dibangun langsung ke web, yang, tentu saja, sangat cocok untuk WebRTC.  Namun, kadang-kadang web cukup merepotkan ketika WebRTC perlu menjalankan berlawanan dengan persyaratan umum untuk menggunakan browser.  Contoh terakhir adalah putar otomatis (selanjutnya disebut "putar otomatis") audio / video, ketika banyak pengguna tiba-tiba kehilangan suara.  Mantan penulis webrtcHacks - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dag-Inge Aas</a> - secara pribadi mengalami masalah ini.  Di bawah ini adalah pemikirannya: apa yang diharapkan dari browser dalam hal putar otomatis, perubahan terbaru di Chrome 66+, serta beberapa kiat tentang cara hidup dengan pembatasan ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lt/r4/ar/ltr4arvdfpa3fefwdabnlzrkd5a.jpeg"></div><br>  <i><font color="lightgray">Peramban tidak ingin mendengar Jahat, jadi politisi putar otomatis mematikan suara di media apa pun.</font></i>  <i><font color="lightgray">Ini bisa menjadi masalah untuk aplikasi WebRTC.</font></i> <br><a name="habracut"></a><br>  Jika Anda membaca ini, kemungkinan besar Anda menemukan bug aneh di browser Safari 11+ dan Chrome 66+.  Kita berbicara tentang suara antarmuka yang tiba-tiba menjadi tidak terdengar (misalnya, sinyal panggilan masuk), atau visualizer audio yang rusak, atau tentang bagaimana lawan bicara tidak terdengar. <br><br>  Saat ini, bug telah mempengaruhi hampir semua pemain WebRTC populer.  Ini lucu, tetapi sepertinya Bertemu dari Google dan Chromebox untuk rapat juga terpengaruh. <br><br>  Akar semua kejahatan: perubahan kebijakan putar otomatis.  Dalam posting ini saya akan berbicara tentang inovasi, bagaimana mereka berhubungan dengan WebRTC dan bagaimana menghadapinya dalam aplikasi Anda. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ja/q7/fj/jaq7fj2bekoaoywfm4avujbbxrm.png"></div><br>  <font color="lightgray">Kesalahan Tahun Ini: Kesalahan Tidak Berhasil: Konteks Audio tidak diizinkan untuk memulai.</font>  <font color="lightgray">Itu harus dilanjutkan (atau dibuat) setelah gerakan pengguna pada halaman.</font>  <font color="lightgray"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://goo.gl/7K7WLu</a></font> <br><br><h3>  Perubahan </h3><br>  Semuanya dimulai pada 2007, ketika iPhone dan iOS muncul.  Jika Anda pernah bekerja dengan Safari untuk iOS di masa lalu, Anda mungkin telah memperhatikan bahwa Safari membutuhkan keterlibatan pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">untuk memainkan elemen &lt;audio&gt; dan &lt;video&gt; dengan suara</a> .  Kemudian persyaratan ini sedikit berkurang ketika iOS 10 mengizinkan elemen video diputar secara otomatis, tetapi tanpa suara.  Ini menjadi masalah bagi WebRTC, karena  elemen &lt;video&gt; harus “melihat” dan “mendengar” aliran media.  Dalam konteks WebRTC, memungkinkan video untuk memulai secara otomatis tanpa suara tidak berguna, karena selama panggilan video Anda perlu mendengar lawan bicara secara default, dan tidak menekan "play" untuk melakukan ini.  Bagaimanapun, beberapa pengembang WebRTC terlibat dalam Safari untuk iOS, karena platform tersebut tidak mendukung WebRTC <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sampai saat ini</a> .  Sebelum ke iOS 11. <br><br>  Saya pertama kali menemukan bug ketika saya menguji implementasi panggilan video untuk iOS yang terbaru (saat itu) berfungsi.  Yang mengejutkan saya, itu berhenti bekerja, sementara saya tidak sendirian.  <b>Pengguna</b> Github <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kylemcdonald</a> <b>melaporkan</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bug getUserMedia</a> di iOS.  Solusi?  Tambahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">properti</a> playsinline <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">baru</a> ke <b>elemen</b> video, yang memungkinkan video diputar dengan suara.  Sayangnya, pengembang tidak menyebutkan WebRTC di posting asli tentang mengubah autoplay di Safari, tetapi mereka masih <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menulis tentang WebRTC</a> secara terpisah, sebelum rilis.  Artikel ini mengatakan yang berikut tentang <b>MediaStreams</b> dan pemutaran audio: <br><br><ul><li>  Media menggunakan <b>MediaStream</b> akan secara otomatis diputar jika halaman web sudah menggunakan kamera / mikrofon; </li><li>  Media menggunakan <b>MediaStream</b> akan secara otomatis diputar jika halaman web sudah memutar suara.  Agar pemutaran suara dapat dimulai, keterlibatan pengguna masih diperlukan. </li></ul><br>  Jadi, dokumen ini tidak menyebutkan <b>playsinline</b> , tetapi jika Anda menggabungkan dua pengumuman, Anda dapat memahami bagaimana membuat aplikasi WebRTC berfungsi di Safari di iOS. <br><br><h3>  Mengapa putar otomatis terbatas sama sekali? </h3><br>  Awalnya, mereka ingin melindungi pengguna dari biaya lalu lintas yang tidak perlu.  Pada tahun 2007, transfer data mahal (dan tetap demikian di sebagian besar dunia) dan hanya beberapa situs yang diadaptasi untuk seluler.  Selain itu, suara putar otomatis telah dan tetap menjadi hal yang paling menjengkelkan di web.  Oleh karena itu, untuk memutar (dan mengunduh) video, diperlukan tindakan pengguna;  ini memastikan bahwa pengguna mengetahui apa yang terjadi. <br><br>  Lalu datanglah GIF.  Gif hanya animasi di dalam &lt;img&gt;, jadi mereka tidak memerlukan "izin" dari pengguna.  Namun, mereka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bisa sulit</a> dan karenanya menyakitkan bagi pengguna internet seluler.  Video menyimpan lalu lintas, tetapi memerlukan izin untuk mengunduh - sehingga laman web terus menggunakan GIF.  Semuanya berubah di iOS 10 saat Safari mengaktifkan pemutaran otomatis dengan suara dimatikan.  Sejak saat itu, pengoptimalan beban adalah masalah video yang diizinkan dan kepergian gif tiga menit menjadi terlupakan. <br><br><h3>  Batasan putar otomatis di browser desktop </h3><br>  Jika Anda mencari cara menghentikan suara putar otomatis, Anda akan menemukan banyak cara.  Baru-baru ini, kantor-kantor berita menemukan bahwa ketika mereka menggunakan audio yang BENAR-BENAR MUDAH setelah halaman dimuat, pengguna menghabiskan lebih banyak waktu di situs dan mengklik iklan.  Tentu saja, ada baiknya melakukannya, tetapi tetap saja mereka melakukannya.  Oleh karena itu, browser desktop mengikuti contoh Safari dan melarang autoplay sound - terutama Chrome, yang meluncurkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kebijakan autoplay baru</a> di versi 66. <br><br>  Namun, Chrome tiba-tiba beralih ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Media Engagement Index</a> (MEI) yang asli. <br><br><h3>  Indeks Keterlibatan Media (MEI) </h3><br>  MEI adalah bagaimana Chrome mengukur kesediaan pengguna untuk mengizinkan putar otomatis pada halaman;  indeks ini tergantung pada perilaku sebelumnya pada halaman.  Anda dapat melihat tampilannya di sini: <b>chrome: // media-engagement /</b> .  MEI dianggap secara terpisah untuk setiap profil pengguna dan berfungsi dalam mode penyamaran (karena ini, sangat sulit bagi pengembang untuk menguji halaman dengan nol MEI sebelum mulai berproduksi).  Adakah yang menebak apa yang akan terjadi selanjutnya? <br><br> <a href=""><img src="https://habrastorage.org/webt/in/sq/yb/insqybsyqdl9cv2whta_qa_e_c0.png"></a> <br>  <font color="lightgray">Cuplikan layar dari halaman internal chrome: // media-engagement / (sumber: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">developers.google.com/web/updates/2017/09/autoplay-policy-changes</a> )</font> <br><br><h3>  Tidak hanya &lt;audio&gt; dan &lt;video&gt; </h3><br>  Ternyata kebijakan baru tidak hanya memengaruhi tag &lt;audio&gt; dan &lt;video&gt;.  Pola UX populer untuk WebRTC adalah untuk menunjukkan kepada pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tingkat volume mikrofon</a> .  Untuk melakukan ini, suara <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dianalisis melalui AudioContext</a> , yang mengambil <b>MediaStream</b> dan mengeluarkan sinyalnya dalam bentuk histogram.  Dalam hal ini, suara tidak dapat diputar, tetapi analisis audio tetap diblokir karena <b>AudioContext</b> , yang, secara teori, memungkinkan Anda untuk mengeluarkan suara. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_1/3c/ia/_13cialfrfe4n1sh_i4-deetnnc.png"></div><br>  <font color="lightgray">Contoh Uji Mikrofon</font> <br><br>  Masalahnya pertama kali dilaporkan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pelacak bug Webkit pada bulan Desember</a> , dan enam hari kemudian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">perbaikan tiba di Webkit</a> .  Koreksi?  Jangan memblokir <b>AudioContext</b> jika halaman sudah menerima audio dan video. <br><br>  Jadi mengapa Anda masih membaca artikel ini?  Ternyata <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Chrome membuat kesalahan yang sama dengan Safari</a> .  Meskipun ini telah memengaruhi banyak layanan WebRTC, Google diam tentang hal ini.  Ada banyak upaya untuk membuat mereka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">membuat pernyataan publik</a> tentang dampak autoplay pada WebRTC, tetapi ini belum terjadi. <br><br><h3>  Nilai MEI mengganggu tes </h3><br>  Bagaimana kita bisa terlibat dalam kekacauan ini?  Tentu saja, pengembang harus menguji <b>AudioContext</b> bahkan sebelum perubahan di Chrome 66 yang memengaruhi setiap pengguna.  Dan inilah MEI;  Anda mengerti, interaksi yang sering dengan halaman memberi Anda MEI yang lebih tinggi, masing-masing, pengembang lebih kecil kemungkinannya menemukan bug, karena audio telah lama diizinkan untuk diputar dan dianalisis.  Dan ya, mode penyamaran tidak membantu, karena MEI terus dihitung di sana.  Hanya meluncurkan Chrome dengan akun baru yang akan mendeteksi bug - fakta yang bahkan dapat dilupakan dengan mudah oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">teknisi Google QA</a> . <br><br><h3>  Apa yang harus dilakukan pembuat browser? </h3><br>  Perubahan fungsionalitas inti sulit diimplementasikan dengan cara yang benar.  Chrome merilis banyak perubahan kebijakan putar otomatis, tetapi tidak ada yang terkait dengan WebRTC atau <b>MediaStreams</b> .  Tampaknya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">API Izin yang</a> dilupakan tidak diperbarui, sehingga pengembang tidak dapat menguji permintaan untuk tindakan khusus.  Atau, Anda dapat membiarkan <b>AudioContext</b> mengeluarkan suara jika halaman tersebut sudah berfungsi dengan kamera / mikrofon (seperti yang dilakukan Safari), tetapi itu lebih mirip peretasan daripada solusi.  Dan juga itu tidak akan membantu dalam kasus analisis suara lain ketika <b>getUserMedia</b> tidak digunakan. <br><br>  Solusi konkret yang diperkuat untuk pembuat browser adalah untuk memungkinkan <b>izin media untuk</b> mempengaruhi MEI.  Jika pengguna memberikan akses konstan ke kamera dan mikrofonnya, maka logis untuk mengasumsikan bahwa halaman web dapat dipercaya cukup untuk menghasilkan suara tanpa tindakan tambahan dan terlepas dari apakah itu bekerja dengan kamera / mikrofon atau tidak.  Pada akhirnya, pengguna percaya bahwa Anda tidak akan berbagi kamera dan mikrofonnya dengan jutaan orang tanpa sepengetahuan mereka.  Dalam hal ini, memainkan suara antarmuka adalah yang paling tidak menjadi masalah. <br><br><h3>  Cara membantu aplikasi Anda </h3><br>  Untungnya, ada beberapa trik untuk membantu Anda.  Berikut adalah daftar apa yang kami tambahkan ke Confrere ketika kami menemukan masalah di Safari untuk iOS. <br><br><h4>  Menambahkan playinline </h4><br>  Untuk mengembalikan suara ke video, tambahkan atribut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">playsinline</a> ke elemen video.  Atribut ini didokumentasikan dengan baik, berfungsi di Safari dan Chrome dan tidak memiliki efek samping di peramban lain. <br><br><h4>  Tindakan Pengguna </h4><br>  Untuk "menyembuhkan" visualisator audio, cukup tambahkan tindakan khusus.  Kami beruntung karena kami dapat menambahkan (dan menambahkan) ke layar pengujian kami banyak langkah, menyiratkan partisipasi eksplisit pengguna.  Anda mungkin kurang beruntung.  Sampai Google membereskannya, tidak ada cara lain selain melibatkan pengguna. <br><br><h4>  Tidak dapat memperbaiki suara antarmuka </h4><br>  Ini saat ini tidak memungkinkan.  Beberapa orang mencoba untuk membuat <b>AudioContext</b> yang digunakan kembali dalam aplikasi dan semua suara melewatinya, tetapi saya belum menguji metode ini.  Safari sedikit lebih sederhana: jika Anda sudah bekerja dengan kamera / mikrofon, Anda dapat memutar suara pesan dan panggilan masuk.  Tetapi saya tidak berpikir bahwa Anda ingin terus menggunakan kamera / mikrofon hanya untuk memberi tahu pengguna tentang panggilan masuk yang masuk akal. <br><br>  Seperti yang Anda lihat, sudah ada cara untuk memperbaiki masalah sampai solusi jangka panjang muncul.  Ya, dan jangan lupa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berlangganan bug</a> untuk menerima pembaruan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id417085/">https://habr.com/ru/post/id417085/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id417073/index.html">Hari Pengembang Seluler Uber</a></li>
<li><a href="../id417075/index.html">API Cat CSS</a></li>
<li><a href="../id417079/index.html">Package Manager untuk Kubernetes - Helm: Past, Present, Future</a></li>
<li><a href="../id417081/index.html">Utara, akan, berharap, negara tanpa batas, atau Bagaimana proyek dibuat dalam kondisi Siberia yang parah</a></li>
<li><a href="../id417083/index.html">Banyak sekali Piala Dunia 2018</a></li>
<li><a href="../id417087/index.html">HPE Digitize 2018: acara dan siaran langsung</a></li>
<li><a href="../id417089/index.html">Komputer kuantum: satu foton untuk memerintah semua</a></li>
<li><a href="../id417091/index.html">Buat shader air kartun untuk web. Bagian 3</a></li>
<li><a href="../id417093/index.html">Sakelar sentuh dengan Modbus: mengapa diperlukan dan bagaimana menerapkannya di apartemen pintar</a></li>
<li><a href="../id417097/index.html">Pemrograman JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>