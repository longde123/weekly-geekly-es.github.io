<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï¥üèø ‚èèÔ∏è üÜñ Wagen f√ºr ein Rechenzentrum üë©üèø‚Äçüç≥ üò° üö¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So stellen Sie Python Telegram Bot mithilfe von Webhooks auf der Google Cloud Platform bereit 
 Anstelle des Vorworts 



 - Schreiben Sie einen Teleg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wagen f√ºr ein Rechenzentrum</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/462141/"><p>  <i>So stellen Sie Python Telegram Bot mithilfe von Webhooks auf der Google Cloud Platform bereit</i> </p><br><h2>  Anstelle des Vorworts </h2><br><img src="https://habrastorage.org/webt/oi/jo/yy/oijoyytwumhn8skry24krjfi8ke.jpeg" width="45%" height="45%" alt="Bild" align="left"><br><p>  <i>- Schreiben Sie einen Telegrammbot.</i>  <i>Jetzt schreiben sogar Schulkinder ‚Äú, sagte sie.</i> <i><br></i>  <i>"Und warum nicht", dachte ich damals ("Nun gut", w√ºrde ich jetzt sagen).</i> </p><br><p>  Wir sa√üen in Bean und diskutierten bei einer Tasse Kaffee die M√∂glichkeiten, Ideen mit Modellen f√ºr k√ºnstliche Intelligenz in einem engen und nicht sehr engen Freundeskreis zu testen.  Lena, meine ehemalige Kollegin und in jeder Hinsicht keine Blondine, die gerade ihren Abschluss als Magistratin gemacht hatte, argumentierte wie folgt.  Durch das Erstellen eines Bots k√∂nnen Sie Zeit und Energie auf der Benutzeroberfl√§che sparen, indem Sie sich beim maschinellen Lernen auf den Kern konzentrieren.  Sie m√ºssen zugeben, dass es an diesem sch√∂nen Sonntagmorgen unm√∂glich war, einer solchen Logik von ‚ÄûSportlerin, Komsomol-Mitglied und einfach sch√∂n‚Äú zu widerstehen.  Es ist gel√∂st.  Telegrammbot bedeutet Telegrammbot. </p><br><p>  Zun√§chst kroch ich in Google und fand eine gro√üe Anzahl von Links, "wie man einen Bot in 30 Minuten macht".  Es hat mich so sehr inspiriert, dass ich nicht √ºber die Namen hinausging und anfing, einen Kernel zu erstellen.  In allererster N√§herung musste ich ein Suchabfrageverarbeitungssystem mit NLP (Natural Language Processing) schreiben.  Das Schreiben des Kernels dauerte einige, ziemlich vern√ºnftige Zeit (dennoch kann Coca-Colas Erfahrung nicht getrunken werden).  Und ein paar Tage sp√§ter war ich bereit, die erste Testversion des Kernels in ein paar Stunden in ein paar andere Sende-Empfangs-Befehle zu packen und all dies in Telegram zum Nutzen meiner Freunde auszuf√ºhren.  Aber da war es. </p><br><p>  Pl√∂tzlich traten eine ganze Reihe von Problemen auf.  Nachdem ich ein paar Tage im Internet gesucht und mit Kollegen im Gesch√§ft gesprochen hatte, wurde mir klar, dass das Offensichtliche nicht offensichtlich ist und eine weitere ‚ÄûAnweisung‚Äú nicht schaden wird.  Also erschien dieser Artikel. </p><a name="habracut"></a><br><h2>  Anstelle des Eintritts.  Bibliotheken </h2><br><p>  Es gibt mehrere Python-Bibliotheken f√ºr Telegramm-Bots.  Das Telegramm selbst bezieht sich auf drei von ihnen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pyTelegramBotAPI</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AIOGram</a> .  Links zu diesen Bibliotheken und Beispiele in anderen Sprachen finden Sie auf der Telegramm-Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Nat√ºrlich gibt es immer noch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Telegramm-API selbst</a> .  Im Verlauf meiner Experimente habe ich zwei Varianten der Telegramm-API und pyTelegramBotAPI ausprobiert.  Und w√§hrend beim zweiten angehalten. </p><br><p>  Im Allgemeinen sind die Eindr√ºcke der Bibliotheken wie folgt.  Alle sind sehr √§hnlich, was nicht √ºberraschend ist.  Python-Telegramm-Bot, so schien es mir, hat die beste Dokumentation von allen, obwohl die Arbeit daran aufgeh√∂rt hat (ich hoffe, ich irre mich).  Es ist ersichtlich, dass die Arbeit an pyTelegramBotAPI fortgesetzt wird. Eine neue Funktionalit√§t wird angezeigt.  AIOGram wirkt j√ºnger und gr√ºner.  In letzterem hat mir das nicht gefallen. Anstelle der Dokumentation zu Webhooks gab es einen Link zur Telegramm-Website.  Aber alles flie√üt, alles √§ndert sich.  Und die endg√ºltige Entscheidung muss noch getroffen werden. </p><br><p>  Wir werden in diesem Artikel nicht auf das Thema Bibliotheken zur√ºckkommen. </p><br><p>  Wie ich bereits bemerkt habe, gibt es im Internet viele Handb√ºcher zum Bot des Bots selbst, die sich mit der Erstellung einfacher und komplexerer Programme befassen.  F√ºr die Zwecke dieses Artikels ist dies nicht prinzipiell.  Nehmen wir zur Veranschaulichung zwei Beispiele aus dem offiziellen pyTelegramBotAPI-Github: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Telegrammbot mit Polling</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://github.com/eternnoir/pyTelegramBotAPI/blob/master/examples/webhook_examples/webhook_aio">Telegrammbot mit Webhook</a> . </li></ol><br><p>  Die umstrittensten Themen bei Telegramm-Bots sind SSL-Zertifikate, Webhooks und Diploing.  Um dies herum und konzentrieren Sie unsere Aufmerksamkeit.  Im Folgenden werde ich Schritt f√ºr Schritt Anweisungen geben, mit denen Sie Ihren Telegramm-Bot auf einfachste und zuverl√§ssigste Weise f√ºr einen minimalen Zeitraum und sogar v√∂llig kostenlos (zumindest im ersten Jahr) auf einem der besten Cloud-Dienste der Welt platzieren k√∂nnen.  Die Erstellung von SSL-Zertifikaten, deren Registrierung im Telegramm und andere damit zusammenh√§ngende Themen werden ebenfalls hervorgehoben.  Bei Bedarf werde ich erkl√§ren, warum wir diese oder jene Option verwenden, diese oder jene Teams. <br></p><br><h2>  Umfrage gegen Webhook </h2><br><img src="https://habrastorage.org/webt/tp/2b/ve/tp2bveonfyk-z9uqucefpqkg90k.jpeg" width="45%" height="45%" alt="Bild" align="left"><br><p>  Ohne die Konfrontation zwischen Polling vs Webhook und einigen (teilweise erfundenen) Schwierigkeiten mit Webhook w√§re dieser Artikel nicht notwendig gewesen.  Da dies von grundlegender Bedeutung ist, schauen wir uns das genauer an. </p><br><p>  Was ist ein Bot und wie kommuniziert er mit Telegram?  Offensichtlich ist ein Bot ein Programm, das auf Ihrem Computer oder Server ausgef√ºhrt wird.  Die Kommunikation mit dem Telegramm erfolgt durch Senden und Empfangen von Nachrichten.  Und wenn beim Senden von Nachrichten alles klar ist, k√∂nnen Sie eine Option senden (die Adresse ‚Äûwo‚Äú, die wir kennen).  Es gibt zwei M√∂glichkeiten, Bot-Nachrichten von Telegram zu empfangen. </p><br><p>  Die erste ist eine Abfrage (w√∂rtliche √úbersetzung des Wortes Polling) des Telegrammservers nach Nachrichten f√ºr den Bot.  Die zweite ist eine "Mailbox" mit einer IP-Adresse (Webhook kann als Webfalle √ºbersetzt werden), an die Nachrichten vom Telegrammserver gelangen. </p><br><p>  Die einfachste Analogie zu echter Post.  Lassen Sie Mail (Post) der Telegrammserver sein, und Sie sind Ihr Bot.  Im ersten Fall (Umfrage) m√ºssen Sie dann zur Korrespondenz zur Post gehen.  Und wenn Sie Nachrichten unverz√ºglich empfangen m√∂chten, m√ºssen Sie nicht gehen, sondern ohne Pause buchst√§blich hin und her rennen.  Wie wir verstehen, ist es verboten, in der Post zu leben und auf Nachrichten zu warten!  Im zweiten Fall teilen Sie der Post Ihre Privatadresse mit und warten zu Hause ruhig auf die Korrespondenz, trinken Tee oder rauchen Bambus. </p><br><p>  Nat√ºrlich scheint f√ºr eine Person die erste Option die schwerwiegendste zu sein.  Aber wenn wir zwischen uns nach Nachrichten rennen und ein St√ºck Eisen mit einem Code senden, ist es uns egal.  Und so w√§re es, wenn nicht f√ºr ein Problem.  Von Zeit zu Zeit schlie√üt die Mail (der Telegrammserver) manchmal zum Mittagessen und bewegt sich dann.  Und bei Ihrer ersten Option (Umfrage) tritt eine Trag√∂die auf, die in der realen Welt der Bots mit ihrem Schweben und Scheitern endet. </p><br><p>  Im zweiten Fall passiert das "Postfach" mit der Adresse (Webhook) nicht.  Denn weder Sie noch Ihr Bot gehen irgendwohin, sondern warten einfach.  Und es ist Ihnen egal, wohin die Post umgezogen ist, denn der Postbote bringt Ihnen Post. </p><br><p>  In Bezug auf die Codemenge (siehe Link oben) scheint die erste Option einfacher zu sein.  Und der zweite ist logischer, aber schwieriger.  F√ºr die Implementierung m√ºssen Sie eine Adresse abrufen, die Authentizit√§t best√§tigen und den Webserver erh√∂hen, an den Nachrichten aus dem Telegramm gesendet werden. </p><br><p>  F√ºr die erste Option ist es nat√ºrlich m√∂glich, dem Code eine Ausnahmebehandlung hinzuzuf√ºgen.  Wenn die Mail beispielsweise geschlossen ist, warten Sie und warten Sie.  Aber das Internet behauptet, dass alle gleichen Bots mit Polling nur zum Spielen sind. </p><br><p>  Anfangs glaubte ich nicht, dass das Problem so ernst war.  Und er hat eine Option mit Umfragen gew√§hlt und vorgeschlagen, dass ich sie eines Tages auf Webhooks umschreiben werde.  Das hat aber nicht funktioniert.  Auf meinem Heimcomputer mit macOS arbeitete der Bot ein und zwei Stunden lang problemlos (nat√ºrlich mit einem VPN) und st√ºrzte nicht ab.  Aber sobald ich es auf den Cloud-Server unter Linux √ºbertragen habe, konnte es 20 Minuten lang nicht funktionieren.  Ich habe versucht, dieses Problem auf unterschiedliche Weise und mit unterschiedlichen Einstellungen zu l√∂sen, habe jedoch nur einen anderen Fehlercode erhalten.  Selawy, das ist Telegramm.  Nachdem ich einen Tag verloren hatte, musste ich unverz√ºglich Webhooks aufnehmen.  Am Ende wollte ich den Bot jetzt auf dem Server starten und nicht in einem Jahr. <br></p><br><h2>  Code auf Webhook umschreiben </h2><br><p>  <i>Der Webhook ist nicht so be√§ngstigend wie er gemalt ist.</i> </p><br><p>  Wenn Sie bereits einen Bot-Code mit Abfrage haben, ist das Kopieren in Webhook nicht schwierig.  Vergleichen Sie die Codes aus den Beispielen der pyTelegramBotAPI-Bibliothek.  Sie finden Code-Schnittpunkte.  Die Zeilen 13-25 des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Beispiels entsprechen den</a> Zeilen 56-67 des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://github.com/eternnoir/pyTelegramBotAPI/blob/master/examples/webhook_examples/webhook_aio">zweiten Beispiels</a> .  Dies ist eine logische Einheit, die f√ºr die Verarbeitung von Befehlen, Nachrichten und Antworten verantwortlich ist.  In diesem Fall ist das Beispiel zu einfach, aber es spiegelt die Hauptessenz wider. </p><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Handle '/start' and '/help' @bot.message_handler(commands=['help', 'start']) def send_welcome(message): bot.reply_to(message, """\ Hi there, I am EchoBot. I am here to echo your kind words back to you. Just say anything nice and I'll say the exact same thing to you!\ """) # Handle all other messages with content_type 'text' (content_types defaults to ['text']) @bot.message_handler(func=lambda message: True) def echo_message(message): bot.reply_to(message, message.text)</span></span></code> </pre> <br><p>  Daher muss der logische Block des Bots unver√§ndert bleiben, und der Rest sollte unter Verwendung des banalen Copy-Past-Codes au√üerhalb des logischen Blocks aus dem zweiten Beispiel (d. H. Kopierzeilen 1-55 und 70-87) ge√§ndert werden.  Wenn Sie sich den Code ansehen, den Sie kopieren, k√∂nnen Sie leicht feststellen, dass Ihr Bot mithilfe der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://aio">aiohttp-</a> Bibliothek einen http-Server installiert und den f√ºr diesen Port zugewiesenen Port <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√ºberwacht</a> , w√§hrend das Python- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SSL-</a> Modul f√ºr die Verschl√ºsselung und die Zertifikate verantwortlich ist.  Neben aiohttp gibt es noch andere √§hnliche Bibliotheken, Beispiele hierf√ºr finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p><br><p>  Also.  Wir haben einen Bot mit Webhook.  Es muss noch auf den Server hochgeladen und ausgef√ºhrt werden, wobei gleichzeitig Daten empfangen werden, um die leeren Werte im Code API_TOKEN, WEBHOOK_HOST, WEBHOOK_PORT, WEBHOOK_SSL_CERT, WEBHOOK_SSL_PRIV einzugeben.  Hinter jedem dieser Werte steht ein bestimmtes Verfahren mit einer geheimen Bedeutung. <br></p><br><h2>  Bot im Telegramm registrieren </h2><br><p>  Beginnen wir mit dem Bot-Token.  Um es zu erhalten, gehen Sie zum Telegramm-Messenger und stellen Sie eine Verbindung zum @ BotFather-Bot her.  Geben Sie den Befehl "/ newbot" ein.  Als Antwort fordert BotFather uns auf, den Namen und den Benutzernamen unseres Bots einzugeben, und sendet ein begehrtes Token der Form ‚Äû712308912: DLGSteczdUnPdnNYLzNikaGOhome7l9q3vova‚Äú (nat√ºrlich haben Sie ein anderes).  Wir speichern den Token, zeigen ihn niemandem.  Im Code weisen wir es der Variablen API_TOKEN zu. <br></p><br><h2>  Wo posten?  Google Cloud Platform gegen Heroku </h2><br><p>  Ein paar Worte zur Qual der Wahl eines Cloud-Dienstes.  Es gibt viele Beispiele im Internet, in denen Telegramm-Bots auf Heroku gehostet werden.  Heroku ist eine PaaS-Plattform (Platform as a Service).  Sie laden den Code auf GitHub und von dort auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Heroku hoch</a> .  Und Ihr Bot beginnt sofort zu arbeiten.  Server, Python und Bibliotheken m√ºssen nicht installiert werden, alles wurde bereits f√ºr Sie erledigt.  Zumindest im Idealfall.  Diese L√∂sung wurde mir auch von einem meiner Freunde empfohlen.  Aber ich habe es abgelehnt. </p><br><p>  Soweit ich wei√ü, ist die Hauptbotschaft f√ºr Heroku-Empfehlungen in vielen ‚Äû30-Minuten-Bot‚Äú -Handb√ºchern die Verf√ºgbarkeit eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kostenlosen Tarifplans</a> f√ºr Heroku.  Wenn Sie genau hinschauen, stellt sich heraus, dass dieser Plan sehr begrenzt ist und es Ihnen nicht erm√∂glicht, einen kostenlosen Bot bereitzustellen, der Tag und Nacht funktioniert. </p><br><p>  Im Gegensatz zu Heroku bietet die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Cloud Platform</a> (GCP) ein ganzes Jahr lang kostenlose Arbeit f√ºr alle Dienste innerhalb von 300 US-Dollar.  F√ºr diesen Betrag f√ºr das Jahr k√∂nnen Sie viele Dinge ausprobieren.  Meiner Meinung nach ist dies ein gro√üartiges Geschenk, insbesondere f√ºr diejenigen, die sich mit Datenwissenschaft besch√§ftigen.  Und nat√ºrlich ist GCP auch PaaS, eine vollst√§ndige Liste der Dienste finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Es gibt serverlose L√∂sungen wie bei Heroku.  Ich habe einen konservativeren Weg f√ºr mehr Kontrolle in der Zukunft gew√§hlt, n√§mlich die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Compute Engine-</a> Serverl√∂sung auf GCP. <br></p><br><h2>  Google Cloud-Plattform </h2><br><p>  <i>Projekt, Instanz, statische IP, Port</i> </p><br><h4>  Erstellen Sie ein Projekt und einen Server </h4><br><p>  Wir gehen zu GCP, w√§hlen "Kostenlos loslegen" und folgen den Anweisungen.  Wenn wir alles richtig machen, haben wir ein Konto mit einem Betrag von 300 USD und sogar das erste erstellte Projekt.  Wir w√§hlen dieses Projekt aus oder erstellen ein anderes im oberen Men√º, was nicht schwierig ist.  Wechseln Sie dann im sich √∂ffnenden Seitenmen√º zur Registerkarte "Compute Engine / VM-Instanz". </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hw/mu/dn/hwmudnnoog3fhutxopij3vmdaeo.png" width="60%" height="60%" alt="Bild"></div><br><p>  Klicken Sie auf "INSTANZ ERSTELLEN" und w√§hlen Sie beispielsweise die Serverkonfiguration aus, wie im folgenden Screenshot gezeigt.  Sie k√∂nnen eine Mikrokonfiguration ausw√§hlen, die dann nur 4 US-Dollar pro Monat kostet.  Sie k√∂nnen auch mischen, Geld wird von einem Geschenk von Google mit 300 US-Dollar abgebucht. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ah/u9/h9/ahu9h9oqvk0xvbltw08odqqkium.png" alt="Bild"></div><br><p>  Als Ergebnis bekommen wir. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s_/cv/x_/s_cvx_fytblpl3hbpwx48gdmrj8.png" alt="Bild"></div><br><p></p><br><h4>  IP-Adresse statisch machen </h4><br><p>  In der Spalte "Externe IP" sehen wir die Adresse, die wir in die Variable WEBHOOK_HOST in unserem Bot eingeben (in diesem Beispiel ist es 35.224.231.90).  Wir werden sp√§ter ein SSL-Zertifikat an diese Adresse erhalten.  Wenn Sie den Bot l√§ngere Zeit verwenden m√∂chten (auch wenn Sie den Server in GCP √§ndern), empfehle ich, diese IP-Adresse statisch zu machen, um sie beim Wechsel von einer Instanz zu einer anderen zu speichern.  Dies erfolgt im Abschnitt ‚ÄûVPC / Externe IP-Adressen‚Äú. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ws/08/f7/ws08f71j4vink6sredri7sn5k7w.png" width="60%" height="60%" alt="Bild"></div><br><p>  Wir √§ndern das Feld "Typ" von "Ephemeral" in "Statisch" und geben einer statischen Adresse einen Namen, damit Sie sp√§ter nicht verwirrt werden, wenn Sie sp√§ter ein Dutzend IP-Adressen haben. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/sy/ug/vdsyugaqmpgjrcnn_v9lniyrp2y.png" alt="Bild"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/fh/i0/pufhi0ermqi0jckodbpyx_qyjdu.png" alt="Bild"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yg/ly/ln/yglylnfmm7oclpudssp7sycu8a4.png" width="60%" height="60%" alt="Bild"></div><br><p></p><br><h4>  Port √∂ffnen </h4><br><p>  Damit der Webhook ordnungsgem√§√ü funktioniert, m√ºssen wir den Port √∂ffnen, an dem das Telegramm klopft.  Derzeit (Juli 2019) unterst√ºtzt Telegram die folgenden Ports: 443, 80, 88, 8443. Weitere Informationen finden Sie im vollst√§ndigen Telegrammhandbuch zu Webhooks <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Wir werden Port 8443 √∂ffnen. In unserem Bot ist dieser Wert bereits der Variablen WEBHOOK_PORT zugewiesen.  Es bleibt die Konfiguration der Firewall-Regel in GCP f√ºr unsere Webhook-Bot-Instanz.  Wie kann man das machen?  Gehen Sie zur Registerkarte "VPC / Firewall-Regeln" und klicken Sie auf "CREATE FIREWALL RULE". </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gr/4i/f5/gr4if5xforj5psjgljivxmru8y4.png" width="60%" height="60%" alt="Bild"></div><br><p>  Und erstellen Sie eine Regel, wie im folgenden Screenshot gezeigt. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ne/gt/jl/negtjln_cf8mbb0sledqn5wvvkg.png" alt="Bild"></div><br><p></p><br><h4>  Wir verbinden uns mit dem Server, installieren Bibliotheken </h4><br><p>  Damit ist die grundlegende Servereinrichtung auf der Google Cloud Platform abgeschlossen.  Wir haben ein Konto bei GCP eingerichtet, ein Projekt erstellt, einen Server (eine Instanz) basierend auf Ubuntu 19.04 als Teil des Projekts erstellt, eine IP-Adresse reserviert und Port 8443 ge√∂ffnet. </p><br><p>  Es ist wenig √ºbrig.  Hoffentlich k√∂nnen wir auf eine detaillierte Beschreibung des Installationsteils von Python und der Bibliotheken verzichten.  Deshalb kurz. </p><br><p>  Gehen Sie zur GCP-Registerkarte "Compute Engine / VM Instance" und klicken Sie im Feld "Connect" auf "SSH". </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s_/cv/x_/s_cvx_fytblpl3hbpwx48gdmrj8.png" alt="Bild"></div><br><p>  Auf Ihrem lokalen Computer sollte ein Terminal mit Zugriff auf die Instanz in GCP ge√∂ffnet werden.  Dies ist eine normale Ubuntu-Umgebung.  Installieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">conda</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">virtualenv</a> , erstellen Sie eine virtuelle Umgebung und installieren Sie Python 3 mit den Hauptbibliotheken.  Zus√§tzlich installieren wir die Bibliotheken, die f√ºr den Betrieb unseres Bots erforderlich sind: <br>  pip install pyTelegramBotAPI <br>  pip install aiohttp </p><br><p>  Schlie√üen Sie das Terminal nach der Installation nicht, wir ben√∂tigen es. <br></p><br><h2>  Erhalten eines selbstsignierten SSL-Zertifikats f√ºr IP </h2><br><p>  Ich muss sagen, dass im Internet rund um das Thema SSL-Zertifikate f√ºr Telegramm ein solider Horror ist.  Wie Mikhail Lermontov diesbez√ºglich sagte: </p><br><p>  <i>‚ÄûPferde auf einem Haufen verwechselt, Leute,</i> <i><br></i>  <i>Und Salven von tausend Kanonen</i> <i><br></i>  <i>Verschmolzen zu einem langen Heulen ... "</i> </p><br><p>  Wenn Sie lesen, was sie im Internet schreiben, stellt sich heraus, dass falsch empfangene Zertifikate schuld sind, wenn der Bot nicht mit Webhooks funktioniert.  Und doch k√∂nnen sie nicht auf IP registriert werden.  Im Allgemeinen akzeptiert Telegram keine selbstsignierten Zertifikate.  Und selbst wenn er das Zertifikat akzeptiert, bedeutet dies nicht, dass Ihr Bot funktioniert und Telegram nicht einmal einen Fehler sendet. </p><br><p>  Das sind Horrorgeschichten.  Warum schreibe ich das?  Neben der Tatsache, dass diese Horrorgeschichten mich einen weiteren verlorenen Tag gekostet haben, musste ich sogar auf ‚ÄûThe Hobbit‚Äú verzichten.  Mein Bot weigerte sich zun√§chst, an Webhooks zu arbeiten.  Dies geschah aufgrund meiner Fehler beim Platzieren auf dem Server (dann wusste ich das nicht).  Aber wegen der obigen Horrorgeschichten suchte ich nach dem Problem, das nicht da war, und konzentrierte mich darauf, Probleme mit SSL-Zertifikaten zu l√∂sen, die nicht da waren.  Aber ich habe unsch√§tzbare Erfahrungen gesammelt.  Ich habe f√ºr die kommenden Jahre Zertifikate sowohl f√ºr Domain-Namen als auch f√ºr IP registriert, sowohl selbstsigniert als auch bezahlt, sowohl in Form von zwei Dateien als auch in Form von vier.  Ich fand heraus, welche Zertifikate eingehen und wie man daraus Ketten macht.  Ich hoffe, das ist jemals n√ºtzlich. </p><br><p>  Eines ist gut, Sie m√ºssen nicht auf diesen Rechen treten, ich habe es bereits f√ºr Sie getan.  Ich gebe voll und ganz zu, dass es einen Grund f√ºr solche Horrorgeschichten gab, da es keinen ‚ÄûRauch ohne Feuer‚Äú gibt.  Aber f√ºr den heutigen Tag scheint sich die Situation beruhigt zu haben. </p><br><p>  Im Moment erhalten wir ein SSL-Zertifikat auf die f√ºr uns bequemste Weise, n√§mlich auf IP (und nicht auf einem Domain-Namen), selbstsigniert (d. H. Kostenlos) und kosten nur eine Zeile ohne Websites. </p><br><p>  Bereiten Sie im Terminal (das wir noch nicht geschlossen haben) ein separates Verzeichnis vor, in dem wir die Zertifikatdatei und den privaten Schl√ºssel speichern.  Gehen Sie in dieses Verzeichnis und rufen Sie den folgenden Befehl auf. </p><br><pre> <code class="bash hljs">$ openssl req -newkey rsa:2048 -sha256 -nodes -keyout url_private.key -x509 -days 3560 -out url_cert.pem</code> </pre> <br><p>  Als Antwort erhalten Sie Anfragen, einige einfache Felder auszuf√ºllen.  F√ºllen Sie sie im folgenden Beispiel aus.  Aber geben Sie nat√ºrlich den Code Ihres Landes, Ihrer Region, Ihrer Stadt und Ihres Firmennamens (falls vorhanden) korrekt an, ersetzen Sie Ihre IP-Adresse und Ihre E-Mail-Adresse. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wi/q3/fi/wiq3fixoya8owjmt_-hafyn3urw.png" alt="Bild"></div><br><p>  Als Ergebnis erhalten Sie zwei Dateien in dem Verzeichnis, aus dem Sie diesen Befehl ausgef√ºhrt haben.  Eine Datei url_cert.pem ist Ihr Zertifikat und der zweite private Schl√ºssel ist url_private.key.  Im Bot-Code werden ihnen jeweils die Variablen WEBHOOK_SSL_CERT und WEBHOOK_SSL_PRIV zugeordnet.  Vergessen Sie nicht, die Zugriffspfade zu diesen Dateien zusammen mit den Namen einzugeben.  Laden Sie Kopien herunter und bewahren Sie sie zum sp√§teren Nachschlagen auf. </p><br><p>  Schlie√üen Sie das Terminal nicht. <br></p><br><h2>  Registrieren Sie den Webhook im Telegramm </h2><br><h4>  Registrieren eines Webhooks mit einem selbstsignierten Zertifikat </h4><br><p>  Vielleicht ist dies der aufregendste Teil von ‚ÄûWas wird das Telegramm sagen?‚Äú.  Fahren Sie ohne Pr√§ambeln einfach den folgenden Befehl in Ihr Terminal.  Ersetzen Sie die IP-Adresse durch Ihre und ber√ºhren Sie nicht Port 8443.  F√ºgen Sie das von BotFather empfangene Token zwischen "/ bot" und "/ setWebhook") anstelle von YOUR-TOKEN ein.  F√ºhren Sie den Befehl in dem Verzeichnis aus, in dem die Zertifikate gespeichert sind. </p><br><pre> <code class="bash hljs">$ curl -F <span class="hljs-string"><span class="hljs-string">"url=https://35.224.231.90:8443"</span></span> -F <span class="hljs-string"><span class="hljs-string">"certificate=@url_cert.pem"</span></span> https://api.telegram.org/botYOUR-TOKEN/setWebhook</code> </pre> <br><p>  Wenn alles korrekt ist, erhalten Sie im Terminal eine kurze Nachricht vom Telegramm, dass der Webhook installiert ist. </p><br><h4>  Registrieren eines Webhooks mit dem ‚Äûrichtigen‚Äú Zertifikat </h4><br><p>  Wenn Sie kein selbstsigniertes Zertifikat haben, k√∂nnen Sie webhook mit dem folgenden Befehl direkt im Browser installieren. </p><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">https://</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">api.telegram.org</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">botYOUR</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TOKEN</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setWebhook</span></span></span><span class="hljs-function">?</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">url</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">https</span></span></span><span class="hljs-function">://</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YOUR.DOMAIN</span></span></span><span class="hljs-function">:8443/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YOUR</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TOKEN</span></span></span><span class="hljs-function">/</span></span></code> </pre> <br><p>  Bitte beachten Sie, dass Ihr Token zweimal angezeigt wird.  Dar√ºber hinaus ist es wichtig, dass YOUR.DOMAIN wie im Zertifikat angegeben angegeben wird.  Zum Beispiel.  Ich habe die Domain mydreem.com registriert. Der Registrar hat mir ein SSL-Zertifikat f√ºr die Domain www.mydreem.com ausgestellt.  Anstelle von YOUR.DOMAIN m√ºssen Sie das letzte www.mydreem.com angeben. </p><br><h4>  Wie √ºberpr√ºfe ich, ob Webhook installiert ist? </h4><br><p>  Mit dem folgenden Befehl k√∂nnen Sie √ºberpr√ºfen, ob Webhook √ºber den Browser installiert ist: </p><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">https://</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">api.telegram.org</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">botYOUR</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TOKEN</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getWebhookInfo</span></span></span></span></code> </pre> <br><p>  Dies funktioniert in allen F√§llen.  Als Antwort sollten Sie so etwas erhalten, falls der Webhook installiert ist und der Bot ausgef√ºhrt wird: </p><br><pre> <code class="dos hljs">{"ok":true,"result":{"url":"https://<span class="hljs-number"><span class="hljs-number">35</span></span>.<span class="hljs-number"><span class="hljs-number">224</span></span>.<span class="hljs-number"><span class="hljs-number">231</span></span>.<span class="hljs-number"><span class="hljs-number">90</span></span>:<span class="hljs-number"><span class="hljs-number">8443</span></span>/<span class="hljs-number"><span class="hljs-number">712308912</span></span>:DLGSteczdUnPdnNYLzNikaGOhome7l9q3vova/","has_custom_certificate":true,"pending_update_count":<span class="hljs-number"><span class="hljs-number">0</span></span>,"max_connections":<span class="hljs-number"><span class="hljs-number">40</span></span>}}</code> </pre> <br><p>  Oder so, wenn Webhook installiert ist, der Bot aber nicht funktioniert (nicht ausgef√ºhrt wird): </p><br><pre> <code class="dos hljs">{"ok":true,"result":{"url":"https://<span class="hljs-number"><span class="hljs-number">35</span></span>.<span class="hljs-number"><span class="hljs-number">224</span></span>.<span class="hljs-number"><span class="hljs-number">231</span></span>.<span class="hljs-number"><span class="hljs-number">90</span></span>:<span class="hljs-number"><span class="hljs-number">8443</span></span>/<span class="hljs-number"><span class="hljs-number">712308912</span></span>:DLGSteczdUnPdnNYLzNikaGOhome7l9q3vova/","has_custom_certificate":true,"pending_update_count":<span class="hljs-number"><span class="hljs-number">2</span></span>,"last_error_date":<span class="hljs-number"><span class="hljs-number">1564506964</span></span>,"last_error_message":"Connection refused","max_connections":<span class="hljs-number"><span class="hljs-number">40</span></span>}}</code> </pre> <br><h4>  Wie setze ich den Webhook zur√ºck? </h4><br><p>  Manchmal m√ºssen Sie m√∂glicherweise das Zertifikat des Bots √§ndern, z. B. wenn Sie auf einen anderen Server (eine andere Dom√§ne) wechseln.  Dann bleibt das Token erhalten und das Zertifikat √§ndert sich (der Webhook wird neu installiert).  Oder es wird notwendig, den Bot nicht auf dem Webhook, sondern auf dem Polling auszuf√ºhren (wenn der Webhook installiert ist, funktioniert das Polling nicht).  In beiden F√§llen ist ein Befehl zum Zur√ºcksetzen des Webhooks hilfreich: </p><br><pre> <code class="dos hljs"><span class="hljs-function"><span class="hljs-function">https://</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">api.telegram.org</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">botYOUR</span></span></span><span class="hljs-function">-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TOKEN</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setWebhook</span></span></span></span></code> </pre> <br><p>  Jetzt ist alles bereit, um den Code auf den Server hochzuladen und den Bot zu starten.  Wenn Sie mit zehn Fingern ein Meister des Spiels auf der Kommandozeile sind, wird es f√ºr Sie nicht schwierig sein.  Und in einer Minute wird Ihr Bot funktionieren.  Wenn nicht, wird der n√§chste Abschnitt dazu beitragen, das Hochladen / Herunterladen von Dateien auf Ihren Server und deren Verwaltung etwas zu vereinfachen. <br></p><br><h2>  Cloud Shell oder "Drop Dead Beautiful" </h2><br><p>  F√ºr mich als Person, die weit von der Systemadministration entfernt ist, ist es schwer zu verstehen, warum wir im Zeitalter des Triumphs der k√ºnstlichen Intelligenz immer noch wie fr√ºher auf dem EU / SM-Computer mit den Befehlszeilenservern kommunizieren.  Angenommen, es gibt Gr√ºnde, die blo√üen Sterblichen unbekannt sind.  Dann muss ein Ph√§nomen wie Cloud Shell in GCP mit gro√üer Freude akzeptiert werden.  Dieses Werkzeug erm√∂glicht es, wenn auch mit Kr√ºcken, die Arbeit der Uneingeweihten etwas zu erleichtern.  Obwohl es schaden kann, wenn Sie einige der Nuancen nicht kennen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud Shell</a> bietet Zugriff auf Cloud-Ressourcen √ºber die Befehlszeile direkt √ºber den Browser.  Sie k√∂nnen <del>  einfach </del>  Verwalten Sie Ihre Projekte und Ressourcen, ohne das Google Cloud SDK oder andere Tools in Ihrem System zu installieren (die letzten beiden S√§tze werden von ihrer Seite √ºbernommen und von mir "leicht" durchgestrichen).  Informationen zum Verwalten Ihrer Projekte √ºber die Befehlszeile finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Aber die Hauptsache f√ºr uns ist nicht das.  Starten Sie Cloud Shell (siehe das unten stehende GIF von Google). </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/si/7p/yh/si7pyhijurtp0i4ta3brjsee8yk.gif" alt="Bild"></div><br><p>  Sie sind bei Cloud Shell angemeldet.  Wenn Sie nun in Form eines Bleistifts auf die Schaltfl√§che klicken, wird der Texteditor der Beta-Version ge√∂ffnet. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jy/op/rt/jyoprt3zetf5mgzyoykqqwzfojs.png" width="45%" height="45%" alt="Bild"></div><br><p>  Im Men√º "Hilfe / Info" k√∂nnen Sie feststellen, dass es sich um "Theia-Editor-f√ºr-Cloudshell-Vorschau 0.0.1" handelt.  Am Ende des Artikels werde ich nicht auf die Funktionen der Arbeit mit diesem Editor eingehen.  Ich werde nur wichtige Punkte hervorheben.  Dies ist nicht nur ein Editor f√ºr mehrere Sprachen (nur mit Python √ºberpr√ºft), sondern auch ein Dateimanager.  Sie k√∂nnen die Dateifreigabe zwischen Cloud Shell und Ihrem lokalen Computer problemlos organisieren.  Sie k√∂nnen Dateien und Verzeichnisse innerhalb des Cloud Shell-Bereichs mit der Maus √ºbertragen. </p><br><p>  Bitte beachten Sie, dass ich nirgendwo dar√ºber geschrieben habe, dass Sie mit dem Editor Dateien auf Ihrem Server (Instanz) bearbeiten und verwalten k√∂nnen.  Aber auch das reicht aus, um unser Leben leichter zu machen.  Und mehr dazu weiter unten.  Und jetzt erz√§hle ich Ihnen etwas Wichtiges √ºber Cloud Shell.  Dies muss verstanden werden, um nicht in das Chaos zu geraten, wie es mir passiert ist. </p><br><p>  Cloud Shell ist ein Debian-basierter Server mit 5 GB Speicherplatz und 1,7 GB RAM.  Einige Softwareprogramme sind bereits vorinstalliert (einschlie√ülich Python).  Cloud Shell kann leicht mit Ihrer Instanz verwechselt werden, Conda darauf installieren, env erstellen und den Bot ausf√ºhren.  Und wenn der Bot abfragt, funktioniert es.  Wenn Sie einen Webhook verwenden, funktioniert dies nicht, da alle Ports in Cloud Shell geschlossen sind.  Und wie viele Ports in der Instanz nicht ge√∂ffnet werden, wird in der Cloud Shell nicht angezeigt. </p><br><p>  Aufgrund meiner jugendlichen Unerfahrenheit und Nachl√§ssigkeit bin ich in diese Falle geraten und habe lange versucht zu verstehen, warum Telegram meinen Bot nicht mit einem Webhook sieht.  Dann war ich sehr ver√§rgert.  Aber die Frau erw√§rmte sich und die S√∂hne beruhigten sich, und dieser Artikel erschien. </p><br><p>  Cloud Shell existiert √ºbrigens au√üerhalb von Raum und Zeit (ein Witz, der der Wahrheit nahe kommt).  Wenn Sie alle Instanzen und Projekte von zu Hause aus l√∂schen, bleibt Ihre Cloud Shell weitere 120 Tage lang mit allem, was Sie hochgeladen haben, bestehen.  Verwechseln Sie dies nicht mit dem Sichern Ihrer Server. </p><br><p>  Also.  Vorgewarnt, dann bewaffnet.  Und jetzt k√∂nnen wir √ºber Annehmlichkeiten sprechen und ein paar n√ºtzliche Befehle kennenlernen. </p><br><p>  Wenn Sie beispielsweise Cloud Shell als Terminal f√ºr den Zugriff auf Ihren Server verwenden m√∂chten (z. B. Webhook-Bot), m√ºssen Sie Ihre Instanz in der Befehlszeile aktivieren: </p><br><pre> <code class="bash hljs">$ gcloud compute ssh webhook-bot --zone us-central1<span class="hljs-_"><span class="hljs-_">-a</span></span></code> </pre> <br><p>  Danach befinden Sie sich in der Befehlszeile Ihres Servers.  Sie k√∂nnen mit dem Befehl "exit" zur Cloud Shell zur√ºckkehren.  Angenommen, Sie m√∂chten einige Dateien aus der Cloud Shell in eine Instanz kopieren.  Geben Sie dazu an der Cloud Shell-Eingabeaufforderung (keine Instanz) den folgenden Befehl ein: </p><br><pre> <code class="bash hljs">$ gcloud compute scp --recurse ~/telebot/my_favorite_robot.py webhook-bot:~/telebot --zone us-central1<span class="hljs-_"><span class="hljs-_">-a</span></span></code> </pre> <br><p>  Wenn Sie die Quelle mit dem Ziel √§ndern, wird von der Instanz in die Cloud Shell kopiert.  Im folgenden Beispiel kopieren wir die Datei "ex1.py" aus dem Verzeichnis "/ examples" des Servers "webhook-bot" in das Verzeichnis "/ telebot2" der Cloud Shell: </p><br><pre> <code class="bash hljs">$ gcloud compute scp --recurse webhook-bot:~/examples/ex1.py --zone us-central1<span class="hljs-_"><span class="hljs-_">-a</span></span> ~/telebot2</code> </pre> <br><p>  Diese und andere Dateifreigabebefehle finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Sie k√∂nnen nicht nur Dateien, sondern auch ganze Verzeichnisse austauschen.  Als Ergebnis erhalten wir das folgende Schema, das unser Leben einfacher macht.  Vom lokalen Computer kopieren wir Dateien, indem wir in Cloud Shell √ºber den Dateimanager des Editors ‚Äûtheia-editor-for-cloudshell-Preview 0.0.1‚Äú auf einige Schaltfl√§chen mit der Maus klicken.  Und dann leiten wir dies √ºber die Befehlszeile auf unseren Server (Instanz) um.  Wenn wir etwas schnell bearbeiten m√ºssen, k√∂nnen wir dies im selben Editor in Cloud Shell tun und Dateien mit demselben Befehl auf den Server hochladen.  Es stellt sich ziemlich schnell heraus. </p><br><p>  Ich glaube, dass es in jeder Hinsicht elegantere und bequemere M√∂glichkeiten gibt, Dateien f√ºr einen Cloud-Server auf GCP auszutauschen und zu verwalten (ohne zus√§tzliche Programme auf dem lokalen Computer zu installieren).  Vielleicht durch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cloud Storage</a> .  Ehrlich gesagt habe ich nur ein paar Stunden damit verbracht, dieses Thema zu suchen und zu experimentieren.  Daher w√§re ich Ihnen dankbar, wenn Sie Ihre Ideen oder Arbeitsl√∂sungen in den Kommentaren mitteilen w√ºrden. </p><br><p>  Also.  Wir haben die Dateien auf den Server (Instanz) hochgeladen.  Wenn Sie den Bot noch nicht gestartet haben, m√ºssen Sie dies tun, indem Sie zum Serverterminal gehen, die erforderliche virtuelle Umgebung aktivieren und einen Befehl wie "python my_webhook_bot.py" eingeben.  Alles sollte funktionieren.  Damit der Bot beim Schlie√üen des Terminals weiter funktioniert, muss er im Hintergrund gestartet werden.  Zum Beispiel "nohup python my_webhook_bot.py &amp;".  Die Suche, wie man den Prozess aus dem Hintergrund holt und abschlie√üt, √ºberlasse ich Ihnen, es sei denn, Sie wissen es nat√ºrlich bereits. <br></p><br><h2>  Fazit </h2><br><p>  Ich hoffe, dieser Artikel war hilfreich f√ºr Sie. Er hat geholfen, Zeit zu sparen und die Fehler zu vermeiden, die ich beim Schreiben eines Telegramm-Bots mit Webhooks und beim Platzieren auf dem Server gemacht habe.  Alles, was in dem Artikel beschrieben wurde, habe ich selbst durchgearbeitet, und zum Zeitpunkt des Schreibens von Juli bis August 2019 hat es einfach so funktioniert.  Mein besonderer Dank gilt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mikhail Krutikov</a> f√ºr das gemeinsame Surfen auf den Fl√§chen der GCP-Dienste und f√ºr die Unterst√ºtzung bei der Verwirklichung einer Reihe wichtiger Wahrheiten.  Ich bin offen f√ºr Fragen, Diskussionen und bin dankbar f√ºr den Rat in den Kommentaren zu diesem Artikel.  Oder schreiben Sie mir in Telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@Eduard_Lanchev</a> . </p><br><p>  Bis zum letzten Moment war die Frage offen, ob ich einen Link zu meinem Telegramm-Bot geben sollte.  Freunde haben mich √ºberzeugt, dass es sich gelohnt hat.  Sie k√∂nnen mit meinem Bot unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@AelitaSoccerBot chatten</a> .  Der Bot steht ganz am Anfang der Reise und es bleibt noch viel zu tun.  Schreiben Sie daher, wenn etwas nicht stimmt, schreiben Sie, wenn Sie Ihre Erfahrungen teilen oder Ratschl√§ge geben m√∂chten.  Meine Dankbarkeit wird keine Grenzen innerhalb angemessener Grenzen haben.  <em>Hinweis</em>  <em>Bis Ende 2019 war der Bot aufgrund von Zeitmangel f√ºr seine Unterst√ºtzung und Entwicklung deaktiviert.</em> </p><br><p>  Und am Ende m√∂chte ich allen Botovods und meinen Kollegen, Datenwissenschaftlern, viel Erfolg w√ºnschen! <br></p><br><h4>  N√ºtzliche Links </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Telegramm-Bot-API</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiele f√ºr Bot-Codes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python-Telegramm-Bot</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pyTelegramBotAPI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">AIOGram</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ssl - TLS / SSL-Wrapper f√ºr Socket-Objekte</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Heroku</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Cloud-Plattform</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Compute Engine</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Marvins wunderbarer Leitfaden f√ºr alle Dinge Webhook</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Conda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Virtualenv</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wolkenh√ºlle</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das Befehlszeilentool gcloud compute</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úbertragen von Dateien mit dem Befehlszeilentool gcloud</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Cloud-Speicher</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462141/">https://habr.com/ru/post/de462141/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462125/index.html">10 Schritte zum Yaml Zen</a></li>
<li><a href="../de462127/index.html">Seminar ‚ÄûF√ºr sich selbst ein Auditor: Audit eines Rechenzentrumsprojekts und Abnahmetests‚Äú, 15. August, Moskau</a></li>
<li><a href="../de462131/index.html">Durch Dornen zu einem Traumspiel</a></li>
<li><a href="../de462133/index.html">Noch einmal √ºber Zypern, die Nuancen des Lebens</a></li>
<li><a href="../de462135/index.html">Strategische Partnerschaft: Warum ServiceNow mit einem gro√üen Cloud-Anbieter zusammenarbeitet</a></li>
<li><a href="../de462145/index.html">Warum dauert das Abbestellen mehrere Tage?</a></li>
<li><a href="../de462147/index.html">Arbeiten mit der Navigation beim Refactoring eines Projekterbes in React Native</a></li>
<li><a href="../de462149/index.html">Zugriffsbeschr√§nkungsmodus f√ºr Zubeh√∂r auf iOS-Ger√§ten und deren Umgehung</a></li>
<li><a href="../de462151/index.html">5 Top-Kubernetes-Distributionen</a></li>
<li><a href="../de462153/index.html">Unity Interactive Map Shader</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>