<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≤Ô∏è üëºüèæ üë®üèº‚Äçüî¨ Conferencia DEFCON 18. Ingenier√≠a inversa Trollim usando las matem√°ticas üè© üë©üèº‚Äçüè´ ‚úãüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voy a hablar de trolling matem√°tico. Estos no son algunos trucos de hackers de moda, m√°s bien es una expresi√≥n art√≠stica, una tecnolog√≠a inteligente y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conferencia DEFCON 18. Ingenier√≠a inversa Trollim usando las matem√°ticas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/433280/"> Voy a hablar de trolling matem√°tico.  Estos no son algunos trucos de hackers de moda, m√°s bien es una expresi√≥n art√≠stica, una tecnolog√≠a inteligente y divertida para que la gente te considere un imb√©cil.  Ahora comprobar√© si mi informe est√° listo para mostrarse en la pantalla.  Todo parece ir bien, as√≠ que puedo presentarme. <br><br><img src="https://habrastorage.org/webt/ez/pj/s8/ezpjs8mlxgrkekfrl6cyjia0zhu.jpeg"><a name="habracut"></a><br><br>  Mi nombre es Frank Tu, escrito frank ^ 2 y @franksquared en Twitter, porque Twitter tambi√©n tiene alg√∫n tipo de spammer llamado "frank 2".  Trat√© de aplicarles ingenier√≠a social para que eliminaran su cuenta, porque t√©cnicamente es spam y tengo el derecho de deshacerme de √©l como mi clon.  Pero aparentemente, si los trata honestamente, no se corresponden, porque a pesar de mi solicitud de eliminar la cuenta de spammer, no hicieron nada con ella, as√≠ que envi√© este puto Twitter al infierno. <br><br>  Mucha gente me reconoce por mi gorra.  Trabajo en los grupos regionales DefCon DC949 y DC310.  Tambi√©n trabajo con Rapid7, pero no puedo hablar de eso aqu√≠ sin usar lenguaje grosero, y mi gerente no quiere que lo jure.  Entonces, he preparado esta presentaci√≥n para DefCon y voy a cumplir el plazo de 15 minutos, aunque este es un tema bastante complicado.  Esta es esencialmente una presentaci√≥n est√°ndar que se enfoca en ingenier√≠a inversa y cosas divertidas relacionadas. <br><br>  Al discutir este tema en Twitter, se formaron dos campos.  Un tipo dijo: "No tengo idea de qu√© est√° hablando este jodido franco ^ 2, ¬°pero es incre√≠ble!"  El segundo chico de Reddit vio mis diapositivas y estaba molesto por los enlaces a cosas que no estaban relacionadas con el tema, estaba enojado porque un tema tan serio no estaba completamente cubierto, as√≠ que dese√© que mi presentaci√≥n tuviera "m√°s contenido y menos basura". <br><br><img src="https://habrastorage.org/webt/dw/wg/il/dwwgilfsbikiyjsa8kkr-ifito8.jpeg"><br><br>  Por lo tanto, quiero centrarme en esta cita.  Nada personal, amigo de Reddit. Digo esto no solo en caso de que est√© presente en esta sala, sino tambi√©n porque fue una cr√≠tica justa.  Porque una conversaci√≥n que no contiene suficiente contenido √∫til es una conversaci√≥n vac√≠a. <br><br>  El tema de mi conversaci√≥n es una rutina est√°ndar para los piratas inform√°ticos, pero me parece que, de hecho, los oradores generalmente no intentan presentar su informaci√≥n de una manera entretenida, incluso cuando es posible, prefiriendo conclusiones secas y castradas.  "Aqu√≠ est√° IP, aqu√≠ est√° ESP, as√≠ es como puedes realizar un exploit, aqu√≠ est√° mi" d√≠a cero ", ¬°ahora aplaude!"  - Y todos aplauden. <br><br>  Gracias por los aplausos, lo agradezco!  Me parece que hay muchos puntos interesantes en mi material, por lo que merece ser expresado de una manera algo entretenida, lo que intentar√© hacer. <br><br>  Ver√° una actitud excepcionalmente superficial hacia la inform√°tica y un humor completamente infantil, as√≠ que espero que aprecie lo que voy a mostrar aqu√≠.  Lo siento si viniste aqu√≠ buscando una conversaci√≥n seria. <br><br>  En la diapositiva, ver√° un an√°lisis cient√≠fico de mi √∫ltimo informe que compara la parte de un enfoque estrictamente cient√≠fico y la parte de un "medicamento" que proporciona seguridad inform√°tica. <br><br><img src="https://habrastorage.org/webt/sg/dy/ef/sgdyefwk3c8k5olv7tjymmpd77a.jpeg"><br><br>  Usted ve que hay muchas m√°s "drogas", pero no tiene que preocuparse, ahora la participaci√≥n de la ciencia ha aumentado ligeramente. <br><br><img src="https://habrastorage.org/webt/t8/8e/u6/t88eu666sy0qrgwbk8qxydshdfe.jpeg"><br><br>  Entonces, hace alg√∫n tiempo, mi amigo Merlin, sentado aqu√≠ a la vanguardia, escribi√≥ un incre√≠ble bot basado en el script IRC Python, que ocupa solo una l√≠nea. <br><br>  Este es un ejercicio realmente incre√≠ble para aprender programaci√≥n funcional, con el cual es muy divertido meterse.  Simplemente puede agregar una funci√≥n tras otra y obtener combinaciones de todo tipo de funciones diferentes, y todo esto se dibuja en la pantalla como una onda de arco iris, en general, esta es una de las cosas m√°s est√∫pidas que puede hacer. <br><br><img src="https://habrastorage.org/webt/hc/bk/oe/hcbkoelnorhbl1idrue1ishlk7c.jpeg"><br><br>  Pens√© que si aplicas este principio a los archivos binarios?  No s√© de d√≥nde vino esta idea, ¬°pero result√≥ incre√≠ble!  Sin embargo, quiero aclarar algunos conceptos b√°sicos. <br><br>  Es posible que su profesor de matem√°ticas haya presentado estas funciones mucho m√°s complicadas de lo que realmente son. <br><br><img src="https://habrastorage.org/webt/fj/-q/rp/fj-qrpljhzhe4dadrmw-wpxqdyk.jpeg"><br><br>  Entonces, la f√≥rmula f (x) tiene un significado muy simple, funciona como funciones ordinarias.  Tienes X, tienes entrada, y luego obtienes X 7 veces, y eso es igual a tu valor.  En Python puedes hacer una funci√≥n (lambda x: x * 7).  Si quieres trabajar con Java, lo siento, espero que nunca quieras hacer esto, entonces puedes hacer algo como: <br><br><pre><code class="plaintext hljs">public static int multiplyBySevenAndReturn(Integer x) { return x * 7; }</code> </pre> <br>  Ya sabes, las funciones matem√°ticas pueden ser mucho m√°s complicadas, pero eso es todo lo que necesitamos saber sobre ellas en este momento. <br><br>  Si observa el ensamblaje del c√≥digo, notar√° que las instrucciones JMP y CALL no est√°n vinculadas a valores espec√≠ficos; funcionan con un desplazamiento.  Si utiliza un depurador, puede ver que JMP00401000 se parece m√°s a la instrucci√≥n de "saltar unos bytes hacia adelante" que a una instrucci√≥n espec√≠fica para saltar 5 o 10 bytes.  Lo mismo se aplica a la funci√≥n CALL, excepto que empuja un mont√≥n de cosas a tu pila.  La excepci√≥n es el caso cuando "pega" la direcci√≥n al registro, es decir, est√° accediendo a una direcci√≥n espec√≠fica.  Todo sucede aqu√≠ de una manera completamente diferente.  Despu√©s de conectar la direcci√≥n al registro y hacer algo como CALL EAX, la funci√≥n accede al valor espec√≠fico en EAX.  Lo mismo ocurre con CALL [EAX] o JMP [EAX]: simplemente elimina la referencia de EAX y se dirige a esa direcci√≥n.  Al usar un depurador, es posible que no pueda determinar a qu√© direcci√≥n espec√≠fica est√° accediendo CALL.  Esto puede ser un problema, por lo que debe saberlo. <br>  Veamos la funci√≥n de salto corto JMP SHORT.  Esta es una instrucci√≥n especial en la arquitectura x86 que le permite utilizar un desplazamiento de 1 byte en lugar de un desplazamiento de 4 bytes, lo que reduce el espacio de memoria utilizado.  Esto importar√° m√°s adelante para todas las manipulaciones que ocurrir√°n con instrucciones individuales.  Es importante tener en cuenta que JMP SHORT tiene un rango de 256 bytes.  Sin embargo, no existe un CALL SHORT. <br><br><img src="https://habrastorage.org/webt/qr/0o/fg/qr0ofgmfo8ypyexaxbhe-bmlcpo.jpeg"><br><br>  Ahora considere la brujer√≠a de la inform√°tica.  En medio de la creaci√≥n de estas diapositivas, me di cuenta de que, de hecho, puede definir un ensamblaje como espacio cero, es decir, t√©cnicamente hay espacio cero entre cada instrucci√≥n.  Si observa las instrucciones individuales, ver√° que cada una se ejecuta una tras otra.  T√©cnicamente, esto puede interpretarse como un salto incondicional a la siguiente instrucci√≥n.  Esto nos proporciona un espacio entre cada instrucci√≥n de ensamblaje, mientras que cada instrucci√≥n se asocia correspondientemente con un salto incondicional. <br><br>  Si observa este ejemplo de ensamblaje, por cierto, estas son cosas muy simples que recomiendo decodificar con ASCII, por lo que esto es solo un conjunto de instrucciones regulares. <br><br><img src="https://habrastorage.org/webt/ud/ld/7n/udld7n6wwfcvyuvxr6jdd28b1by.jpeg"><br><br>  Los 0 de JMP ubicados entre cada instrucci√≥n son saltos incondicionales que generalmente no se ven.  Se siguen despu√©s de cada instrucci√≥n.  Por lo tanto, es posible colocar cada instrucci√≥n de ensamblaje individual en una ubicaci√≥n de memoria arbitraria si y solo si cada instrucci√≥n de unidad se acompa√±a de un salto incondicional a la siguiente instrucci√≥n.  Porque si transfiere el ensamblaje y necesita usar el mismo c√≥digo que antes, debe adjuntar un salto incondicional a cada instrucci√≥n. <br>  Miremos m√°s all√°.  Una matriz unidimensional puede interpretarse t√©cnicamente como una matriz bidimensional, solo requiere un poco de matem√°ticas, filas o algo as√≠, no lo dir√© con certeza, pero no es demasiado dif√≠cil.  Esto nos permite interpretar la ubicaci√≥n en la memoria en forma de una red (x, y).  En combinaci√≥n con la interpretaci√≥n del espacio vac√≠o entre instrucciones como saltos incondicionales que pueden relacionarse entre s√≠, podemos literalmente dibujar instrucciones.  ¬°Esto es asombroso! <br><br>  Para implementar esto en la pr√°ctica, debe realizar los siguientes pasos: <br><br><ul><li>  desarme cada instrucci√≥n para averiguar cu√°l es el c√≥digo; </li><li>  Asigne un lugar en la memoria que sea mucho m√°s grande que el tama√±o del conjunto de instrucciones.  Normalmente reservo 10 veces m√°s memoria que el tama√±o del c√≥digo; </li><li>  para cada instrucci√≥n, determine f (x); </li><li>  establezca cada instrucci√≥n en la ubicaci√≥n correspondiente (x, y) en la memoria; </li><li>  adjunte un salto incondicional a la instrucci√≥n; </li><li>  marque la memoria como ejecutable y ejecute el c√≥digo. </li></ul><br>  Desafortunadamente, muchas preguntas surgen aqu√≠.  Es como con la gravedad, que funciona solo en teor√≠a, pero en la pr√°ctica vemos algo completamente diferente.  Debido a que en realidad x86 env√≠a al infierno sus instrucciones JMP, las instrucciones CALL, distorsiona su c√≥digo autorreferencial, c√≥digo auto modificable que usa iteraci√≥n. <br><br><img src="https://habrastorage.org/webt/wi/8c/cq/wi8ccqnv606718u6worjzx7bnok.jpeg"><br><br>  Comencemos con las instrucciones JMP.  Dado que las instrucciones JMP est√°n sesgadas, cuando se colocan en un lugar arbitrario, ya no apuntan hacia donde crees que deber√≠an apuntar.  SHORT JMP se encuentran en una posici√≥n similar.  Colocados accidentalmente por su funci√≥n (x, y), no indicar√°n con qu√© est√° contando.  Pero a diferencia de los JMP largos, los JMP cortos son m√°s f√°ciles de solucionar, especialmente si se trata de una matriz unidimensional.  SHORT JMP es f√°cil de convertir a JMP normal, pero luego debe averiguar en qu√© se ha convertido el nuevo desplazamiento. <br><br>  Trabajar con JMP basados ‚Äã‚Äãen registros sigue siendo un dolor de cabeza, y debido a que requieren compensaciones ajustadas y se pueden calcular en tiempo de ejecuci√≥n, no hay una manera f√°cil de saber a d√≥nde van.  Para detectar autom√°ticamente cada registro, debe utilizar un mont√≥n de conocimientos de la teor√≠a de compilaci√≥n.  En tiempo de ejecuci√≥n, puede haber punteros de funci√≥n, punteros de clase y similares.  Es cierto que si no desea hacer un trabajo extra para hacer todo esto, entonces no puede hacerlo.  Las funciones f (x) funcionan en c√≥digo real, no tan elegantemente como en papel.  Si desea hacerlo correctamente, deber√° hacer mucho trabajo. <br><br>  Para definir punteros de clase y cosas por el estilo, necesita conjurar con C y C ++.  Antes de guardar, durante el desmontaje, convierta su JMP CORTO en JMP normal, ya que tiene que lidiar con el sesgo, es bastante simple. <br><br>  Intentar calcular los desplazamientos reales es un gran dolor de cabeza.  Todas las instrucciones que encuentre tienen desplazamientos que se mover√°n cuando se mueva el c√≥digo, y deben recalcularse.  Esto significa que debe seguir las instrucciones y hacia d√≥nde se mueven como objetivos.  Es dif√≠cil para m√≠ explicarte en las diapositivas, pero un ejemplo de c√≥mo lograrlo est√° en el CD con los materiales de esta conferencia. <br><br>  Despu√©s de haber colocado todas las instrucciones, reemplace las compensaciones antiguas con las nuevas compensaciones.  Si no da√±aste el desplazamiento, entonces todo saldr√° bien.  Ahora que se ha preparado, existe una oportunidad real de implementar la idea al m√°s alto nivel.  Para hacer esto, necesitas: <br><br><ul><li>  desmontar instrucciones; </li><li>  preparar un b√∫fer de memoria; </li><li>  inicializar las constantes disponibles f (x); </li><li>  iterar sobre f (x) y ciertos punteros de datos, de acuerdo con los cuales su c√≥digo se escribir√° mientras rastrea las malditas instrucciones; </li><li>  Asignar instrucciones a los √≠ndices creados correspondientes; </li><li>  arreglar todos los saltos condicionales; </li><li>  marque la nueva partici√≥n de memoria como ejecutable; </li><li>  ejecutar c√≥digo </li></ul><br>  Si pones las cosas en su lugar, entonces obtenemos cosas extra√±as: todo se confunde, las instrucciones saltan a lugares oscuros de memoria, y todo esto parece simplemente encantador. <br><br><img src="https://habrastorage.org/webt/kv/pi/wf/kvpiwfksxaglubnkdlasc2gwcda.jpeg"><br><br>  ¬øTodo esto tiene alg√∫n significado pr√°ctico o es solo una actuaci√≥n de circo?  El valor aplicado de tales transformaciones es el siguiente.  Aislar las instrucciones de ensamblaje y algunos pasos para calcular f (x) nos permite colocar estas instrucciones de ensamblaje en cualquier lugar del b√∫fer sin ninguna interacci√≥n del usuario.  Para confundir las rutas de ejecuci√≥n de c√≥digo, todo lo que tiene que hacer es escribir matem√°ticamente la funci√≥n y los punteros en alg√∫n ensamblador, eligi√©ndolos al azar. <br><br>  Esto simplifica enormemente las t√©cnicas de codificaci√≥n polim√≥rficas.  En lugar de escribir c√≥digo cada vez que manipula su c√≥digo de una manera determinada, puede escribir una serie de funciones que determinan aleatoriamente la posici√≥n de su c√≥digo, y luego seleccionar estas funciones como aleatorias, etc. <br><br>  Anti-reverse no es tan genial como la t√©cnica anti-depuraci√≥n. <br><br>  La antiversi√≥n no se trata de la diversi√≥n que obtienes al imposibilitar el uso de la IDA, y no de cu√°nto estropear√°s la computadora del Reverser con las im√°genes de GNAA Last Measure, aunque es muy divertido.  Anti-reversi√≥n significa simplemente ser un imb√©cil, porque si, como el √∫ltimo imb√©cil, obtienes un Reverser, un tipo que rompe la protecci√≥n de diferentes sistemas, simplemente se enojar√°, enviar√° este programa malicioso al infierno y se ir√°. <br><br>  Mientras tanto, podr√° vender todos sus bots a las redes comerciales rusas, porque con su software "baja" a todos los involucrados en la ingenier√≠a inversa.  Todos saben c√≥mo encontrar t√©cnicas anti-depuraci√≥n en Google, pero no encontrar√°n soluciones a los problemas que surjan de cosas creativas all√≠.  Los anti-rev√≥lveres m√°s creativos har√°n que los reversos rompan los dedos del teclado y dejen agujeros del tama√±o de un pu√±o en las paredes.  Los inversores hervir√°n de ira, no entender√°n qu√© demonios hiciste, porque tu c√≥digo lo estrope√≥ todo. <br><br>  Este es un tipo de juego nervioso, psicol√≥gico, si eres creativo en este asunto y creas un anti-reverso realmente impresionante, puedes estar orgulloso de ello.  Pero sabes que, de hecho, solo est√°s tratando de alejarlos de tu c√≥digo. <br><br>  Entonces, ¬øqu√© voy a hacer?  Voy a tomar las funciones de ofuscaci√≥n y ofuscarlas.  Luego usar√© la segunda versi√≥n de ofuscaci√≥n de funciones enredadas y aplicar√© nuevamente ofuscaci√≥n.  Entonces, saquemos el c√≥digo.  Este es un ejemplo de trolling matem√°tico, que tom√© como ejemplo. <br><br><img src="https://habrastorage.org/webt/qt/rn/sx/qtrnsxmxi2hcqfrtyilcqrtxaem.jpeg"><br><br>  Entonces, entro en el comando "confundir por f√≥rmula" en la ventana que se abre. <br><br><img src="https://habrastorage.org/webt/_8/mi/gg/_8miggm7ypffnzh5pxg9wqp_mls.jpeg"><br><br>  A continuaci√≥n, ver√° las instrucciones de ensamblaje que hacen su trabajo.  Tenga en cuenta que uso C ++ aqu√≠, aunque a la menor oportunidad trato de evitar esto. <br><br><img src="https://habrastorage.org/webt/vo/rs/0n/vors0n4cbvak6erlntuxupbibyw.jpeg"><br><br>  Aqu√≠ se resalta la funci√≥n activa CALL EAX, seguida de la instrucci√≥n de salto que se aplicar√°, ver√° un mont√≥n de todo tipo de cosas diferentes en el b√∫fer, y todo esto se hace con cada instrucci√≥n individual. <br><br><img src="https://habrastorage.org/webt/ei/eg/ls/eiegls4lpaq-5ktwrcmvxfm7xhg.jpeg"><br><br><img src="https://habrastorage.org/webt/bb/vl/rp/bbvlrpccrihcbvjxklexk-hee7a.jpeg"><br><br>  Ahora rebobino el programa hasta el final, y ver√° el resultado.  Entonces, el c√≥digo a√∫n se ve genial, aqu√≠ se compilan un mont√≥n de instrucciones JMP, se ve confuso, y en realidad es confuso. <br><br><img src="https://habrastorage.org/webt/fe/n4/-f/fen4-ff9er24oisuviqc2gpc_rg.jpeg"><br><br>  La siguiente diapositiva muestra una representaci√≥n gr√°fica de c√≥mo se ve la pila. <br><br><img src="https://habrastorage.org/webt/zi/d9/sa/zid9sadg9n0azq5oeesabhfq2wm.jpeg"><br><br>  Cada vez que esto sucede, genero una f√≥rmula de onda sinusoidal aleatoria que tiene una forma arbitraria, ves aqu√≠ un mont√≥n de formas diferentes, y eso es genial.  Creo que el c√≥digo comienza en alg√∫n lugar en la esquina superior izquierda, pero no recuerdo exactamente.  Entonces √©l tuerce todo, no solo puedes hacer sinusoides, sino tambi√©n torcer las espirales. <br><br><img src="https://habrastorage.org/webt/tk/hq/iq/tkhqiqo6k4yxin-xboy7wqepcic.jpeg"><br><br>  Aqu√≠ solo funcionan dos f√≥rmulas, que inclu√≠ en el c√≥digo fuente.  Basado en esto, puede hacer tantas cosas creativas como desee, esencialmente es solo DIFF desde el b√∫fer de inicio al b√∫fer de finalizaci√≥n. <br><br>  El problema es que este ejemplo de c√≥digo usa saltos incondicionales, lo que en realidad es malo, porque el c√≥digo deber√≠a ser exactamente el mismo que antes, es decir, los saltos incondicionales siguen solo en una direcci√≥n.  Por lo tanto, debe ir desde el punto de entrada hasta el final de la misma manera, deshacerse de las instrucciones de salto y listo, ¬°obtuvo su c√≥digo!  Que hacer  Es necesario convertir los saltos incondicionales en condicionales.  Los saltos condicionales se realizan en dos direcciones, es mucho mejor, podemos decir que es un 50% mejor. <br><br>  Aqu√≠ tenemos un dilema interesante: si necesitamos saltos condicionales, entonces todav√≠a necesitamos usar saltos incondicionales ... ¬øqu√© demonios?  Entonces, ¬øqu√© hacemos?  ¬°Los predicados opacos nos salvar√°n!  Para aquellos que no saben, un predicado opaco es esencialmente una declaraci√≥n booleana que siempre se ejecuta para una versi√≥n en particular, independientemente de cualquier cosa. <br>  Entonces, veamos la extensi√≥n del espacio cero que mencion√© anteriormente.  Si tiene un conjunto de instrucciones y tienen saltos incondicionales, transiciones entre cada instrucci√≥n, se deduce que una serie de instrucciones de ensamblaje que no afectan directamente las instrucciones que necesitamos pueden preceder o seguir una sola instrucci√≥n. <br>  Por ejemplo, si escribi√≥ instrucciones muy espec√≠ficas que no cambian el ensamblaje principal de lo que est√° tratando de confundir, es decir, intenta no involucrarse con los registros siempre que mantenga el estado de cada instrucci√≥n de ensamblaje.  Y esto es a√∫n m√°s sorprendente. <br>  Puede considerar cada instrucci√≥n de ensamblaje, que puede confundirse, como el pre√°mbulo, los datos de ensamblaje y la posdata.  El pre√°mbulo es lo que precede a la instrucci√≥n de ensamblaje, y la posdata es lo que le sigue.  El pre√°mbulo generalmente se usa o se puede usar para dos cosas: <br><br><ul><li>  correcci√≥n de las consecuencias del predicado opaco del pre√°mbulo anterior; </li><li>  fragmentos de c√≥digo anti-depuraci√≥n. </li></ul><br>  Pero el pre√°mbulo es esencialmente limitado porque no puedes hacer demasiado. <br>  Postscript es una cosa m√°s divertida.  Se puede usar para: <br><br><ul><li>  predicados opacos y saltos intrincados a las siguientes secciones de c√≥digo; </li><li>  anti-depuraci√≥n y ofuscaci√≥n de la ejecuci√≥n general del c√≥digo; </li><li>  cifrado y descifrado de varios fragmentos de c√≥digo en el propio programa. </li></ul><br>  En este momento estoy trabajando en la posibilidad de cifrar y descifrar cada instrucci√≥n individual para que cuando se ejecute cada instrucci√≥n, descifre la siguiente secci√≥n, la siguiente secci√≥n, la siguiente, etc.  La siguiente diapositiva muestra un ejemplo de esto. <br><br><img src="https://habrastorage.org/webt/co/is/tj/coistjw3lgdiwggoqth_c9hnq2y.jpeg"><br><br>  Las l√≠neas de pre√°mbulo y la llamada del depurador se resaltan en verde.  Todo lo que hace esta llamada es verificar si tenemos un depurador, despu√©s de lo cual vamos a una secci√≥n arbitraria del c√≥digo. <br><br>  A continuaci√≥n tenemos un predicado opaco muy simple.  Si mantiene el valor Eax en la posdata de la instrucci√≥n superior, siga el operador XOR, por lo que su JZ piensa: "OK, obviamente puedo ir hacia la izquierda o hacia la derecha, creo que es mejor que vaya hacia la derecha, porque hay 0".  Luego se ejecuta POP EAX, su EAX retrocede, despu√©s de lo cual se procesa la siguiente instrucci√≥n, y as√≠ sucesivamente. <br><br>  Obviamente, esto crea problemas mucho mayores que nuestra estrategia b√°sica, como los efectos residuales y la complicaci√≥n de generar diferentes conjuntos de instrucciones.  Por lo tanto, ser√° muy dif√≠cil determinar c√≥mo una instrucci√≥n afecta a otra instrucci√≥n.  Puedes arrojarme zapatillas, porque a√∫n no he terminado este incre√≠ble programa, pero puedes seguir el progreso del desarrollo en mi blog. <br><br><img src="https://habrastorage.org/webt/c9/ce/el/c9ceelekpf6j1kv8f9x-qooiug8.jpeg"><br><br>  Observo que nuestras f√≥rmulas f (x) no tienen que calcularse iterativamente, por ejemplo f (1), f (2), ... f (n).  Nada impide que se calculen al azar.  Si es inteligente, puede determinar cu√°ntas instrucciones necesita y luego asignar, por ejemplo, f (27), f (54), f (9), y este ser√° el lugar donde se colocar√°n sus instrucciones al azar.  Cuando haces esto, dependiendo de c√≥mo escribiste tu c√≥digo, puedes detenerlo por adelantado, y el c√≥digo a√∫n vincular√° tus instrucciones al azar. <br><br>  Si su c√≥digo se genera en base a una f√≥rmula predecible, se deduce que el punto de entrada tambi√©n es predecible, por lo que puede tomar un nivel m√°s antes de terminar de recibir el c√≥digo y confundir significativamente el punto de entrada en un grado u otro.  Por ejemplo, tome 300 instrucciones de ensamblaje provenientes de un √∫nico punto de entrada. <br><br>  Ahora hablemos de las deficiencias. <br><br><img src="https://habrastorage.org/webt/2l/wp/7i/2lwp7iffr7n-s_mn-tdcztkkay8.jpeg"><br><br>  Este m√©todo requiere una compilaci√≥n cuidadosa del c√≥digo, principalmente usando GCC o, Dios no lo quiera, usando C ++.  C ++ es en realidad un lenguaje bastante bueno por varias razones, pero sabes que todos los compiladores apestan.  Entonces, lo principal en este asunto es una compilaci√≥n competente hecha a mano, porque si tu intento de confundir tu propio ensamblaje causar√° la aprobaci√≥n de la pandilla que invent√≥ el gusano Conficker, entonces la cagaste. <br><br>  Necesitar√° una gran cantidad de memoria.  Recuerda la imagen con ondas sinusoidales.  El rojo es el c√≥digo, y el azul es la memoria necesaria para que funcione, y deber√≠a ser suficiente para que todo funcione como deber√≠a. <br><br>  Probablemente estar√° lidiando con un conjunto de datos gigantesco despu√©s de completar el c√≥digo.  Y aumentar√° significativamente si desea confundir m√°s de una funci√≥n. <br><br>  Los punteros de funci√≥n se comportan de manera impredecible, a veces correctamente, a veces no.  Depende de lo que est√© haciendo, y definitivamente habr√° un problema porque no puede predecir d√≥nde y cu√°ndo se dispara el puntero de funci√≥n en su ensamblaje. <br><br>  Mientras m√°s complicado genere ofuscaci√≥n y manipule el ensamblaje en el pre√°mbulo y la posdata, m√°s dif√≠cil ser√° arreglarlo y depurarlo.  Entonces, escribir dicho c√≥digo es como equilibrar entre "est√° bien, insertar√© cuidadosamente uno o dos JMP aqu√≠" y "¬øc√≥mo diablos puedo resolverlo en poco tiempo"?  Por lo tanto, solo tiene que insertar instrucciones y luego descubrir durante varios meses lo que ha hecho. <br><br>  Espero que hayas aprendido algo √∫til hoy.  En mi opini√≥n, realmente me emborrach√© y, por lo tanto, realmente no entiendo lo que sucedi√≥ ahora.  La siguiente diapositiva muestra mis contactos de Twitter, mi blog y sitio web, as√≠ que vis√≠tame o escribe. <br><br><img src="https://habrastorage.org/webt/l3/0j/ps/l30jpsxkmmgtsez-k-pxvr9vg70.jpeg"><br><br>  Eso es todo, ¬°gracias por venir! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/y124L75ZKAc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  <b>Ap√≥yenos</b> haciendo un pedido o recomend√°ndolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un an√°logo √∫nico de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps hasta enero de forma gratuita</b> al pagar por un per√≠odo de seis meses, puede ordenar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  ¬°Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Pa√≠ses Bajos y los Estados Unidos!</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es433280/">https://habr.com/ru/post/es433280/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es433270/index.html">Soluci√≥n de problemas de MapStruct con ManyToMany</a></li>
<li><a href="../es433272/index.html">Entrevista con David Gobel</a></li>
<li><a href="../es433274/index.html">Oleg Dokuka sobre el desarrollo reactivo en jug.msk.ru</a></li>
<li><a href="../es433276/index.html">Sobre los beneficios de incrustar CSS en JS</a></li>
<li><a href="../es433278/index.html">WebGL-wind y programaci√≥n de GPU. Conferencia en FrontTalks 2018</a></li>
<li><a href="../es433282/index.html">Puertas de enlace de protocolos de intercambio industrial en Linux. Re√∫nete</a></li>
<li><a href="../es433286/index.html">10 reuniones inform√°ticas y hackatones m√°s cercanos en Mosc√∫</a></li>
<li><a href="../es433288/index.html">Seguridad web: Introducci√≥n a HTTP</a></li>
<li><a href="../es433292/index.html">El resumen de materiales interesantes para el desarrollador m√≥vil # 279 (del 10 al 16 de diciembre)</a></li>
<li><a href="../es433294/index.html">Algunas recomendaciones simples de trabajo en equipo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>