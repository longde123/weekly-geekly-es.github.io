<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèº üë° üíñ Desenvolvimento de eletr√¥nicos. Sobre microcontroladores nos dedos üëò üíê üà≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ao pensar em uma startup de tecnologia, voc√™ n√£o precisa ser um especialista em eletr√¥nica, √© muito mais prov√°vel que um especialista restrito, com co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de eletr√¥nicos. Sobre microcontroladores nos dedos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445936/"><img src="https://habrastorage.org/webt/ft/gy/ko/ftgykowsgjxoa9maxgetdwgbzyi.jpeg"><br><br>  Ao pensar em uma startup de tecnologia, voc√™ n√£o precisa ser um especialista em eletr√¥nica, √© muito mais prov√°vel que um especialista restrito, com conhecimento dos conceitos b√°sicos de marketing, tenha uma boa ideia, mas mesmo encomendando algu√©m para desenvolv√™-la, voc√™ precisa navegar pelos recursos da base elementar moderna e apresentar o pre√ßo da solu√ß√£o.  Caso contr√°rio, voc√™ pode exigir o imposs√≠vel ou obter um dispositivo com custos excessivos em uma base de elementos desatualizada. <br>  Sob o corte, uma tentativa de falar de forma breve e simples sobre as capacidades dos microcontroladores modernos para pessoas distantes deles.  Para quem tem a ideia de um novo dispositivo eletr√¥nico, mas n√£o tem ideia do que √© um microcontrolador.  Aqueles que desejam dar o primeiro passo, desde experimentos divertidos com a plataforma Arduino at√© o design de seus pr√≥prios dispositivos, tamb√©m podem encontrar dicas simples, mas √∫teis.  Tentei, sem me debru√ßar nos detalhes t√©cnicos, <s>para esse fim n√£o basta que o livro</s> exponha a ess√™ncia e d√™ algumas dicas simples, por√©m √∫teis, sobre circuitos para impedir que os iniciantes cometam erros elementares. <br><a name="habracut"></a><br><h3>  Resumo do artigo: </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como os microcontroladores conquistaram o mundo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ARM Architecture - L√≠der de mercado atual de microcontroladores</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Competi√ß√£o com irm√£os mais novos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobre a coloca√ß√£o de asfalto, os benef√≠cios do sono e suas variedades</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pouco sobre a tecnologia de fabrica√ß√£o e como as s√©ries de microcontroladores aparecem</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A periferia do mais simples microcontrolador ARM por meio d√≥lar</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A maneira mais barata de obter recursos extras</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">E o que adicionar√° a transi√ß√£o ao Cortex-M4, al√©m do pre√ßo aumentado algumas vezes?</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cortex-M7 - quando voc√™ quiser mais ...</a> <br><br><br><a name="MCU"></a><h4>  <font color="#66a3be">A prote√ß√£o de c√≥digo, a capacidade de atualiza√ß√£o e a diversidade ajudaram os microcontroladores a conquistar o mundo</font> </h4><br>  Qualquer dispositivo inteligente requer controle.  Na maioria dos casos, os microcontroladores est√£o fazendo isso hoje - chips que combinam um n√∫cleo de microprocessador, mem√≥ria e m√≥dulos perif√©ricos que s√£o respons√°veis ‚Äã‚Äãpela comunica√ß√£o com outros componentes do dispositivo e com o mundo externo. <br><br><img src="https://habrastorage.org/webt/4m/8u/r5/4m8ur5ebaj5ss5wk1u06ibyqcoe.jpeg" align="left">  Microcontroladores s√£o valiosos em todos os neg√≥cios.  Um microcontrolador √© capaz de substituir dezenas de microcircuitos especializados que seriam necess√°rios para executar as fun√ß√µes necess√°rias se o microprocessador desempenhar o papel da calculadora. <br><br>  Uma das vantagens indiscut√≠veis do microcontrolador √© que o programa sob o qual ele √© executado fica oculto dentro do seu gabinete (na se√ß√£o chamada ‚Äúmem√≥ria do programa‚Äù) e fica muito bem protegido contra hackers, √© claro, se o desenvolvedor do microc√≥digo cuidou disso ativando os mecanismos internos prote√ß√£o.  Assim, voc√™ obt√©m prote√ß√£o da propriedade intelectual o m√°ximo poss√≠vel hoje. <br><br><img src="https://habrastorage.org/webt/rt/gg/bu/rtggbu8vffk3iumjdp_xhzkxp94.jpeg" align="right">  O que n√£o pode ser invadido pode ser copiado.  Por que tentar ler o c√≥digo embutido no microcontrolador do programa usando dispositivos caros e engenhosos, se √© mais f√°cil e barato encontrar um profissional que possa escrev√™-lo novamente?  Talvez o resultado seja ainda melhor e a funcionalidade seja mais rica que a do prot√≥tipo.  Sim, custa dinheiro, mas o conte√∫do da mem√≥ria FLASH dos microcontroladores atuais √© t√£o bem protegido que as tentativas de "hacking" rude custar√£o ainda mais.  Al√©m disso, o problema da propriedade intelectual est√° sendo resolvido e voc√™, juntamente com os c√≥digos-fonte do programa, tem a oportunidade de desenvolver e melhorar seu dispositivo. <br><br>  A mem√≥ria do programa, nos modernos microcontroladores universais, √© regrav√°vel e o processo de reescrita pode ser repetido mais de dez mil vezes.  Ele implora o uso desse fato para atualizar o software, a fim de eliminar erros encontrados nele ou expandir as fun√ß√µes de um dispositivo j√° em funcionamento.  Isso √© bastante simples de implementar - ao adicionar uma se√ß√£o especial de c√≥digo chamada ‚Äúcarregador de inicializa√ß√£o‚Äù ao programa, voc√™ tem a oportunidade de atualizar o software do seu dispositivo de v√°rias maneiras: no ponto de servi√ßo (se o dispositivo tiver um conector especial oculto dentro do gabinete), conecte-o ao computador via USB, via rede ou at√© uma interface sem fio.  O principal √© fornecer ao dispositivo os perif√©ricos necess√°rios para isso.  Ao oferecer a capacidade de atualizar software, voc√™ sempre deve pensar em seguran√ßa; se esse processo n√£o estiver suficientemente protegido, os invasores n√£o apenas poder√£o roubar seu c√≥digo, mas tamb√©m poder√£o modific√°-lo e us√°-lo para seus pr√≥prios prop√≥sitos <s>, o que √© insidioso</s> .  Por exemplo, assuma o controle das coisas da sua ‚Äúcasa inteligente‚Äù ou espie com a ajuda da c√¢mera WEB instalada por voc√™ em casa. <br><br><a name="ARM_MCU"></a><h4>  <font color="#66a3be">ARM Architecture - L√≠der de mercado atual de microcontroladores</font> </h4><br>  Desde o tempo de King Peas, os microcontroladores geralmente s√£o divididos de acordo com a capacidade dos dados nos quais eles realizam opera√ß√µes.  Atualmente, na grande maioria dos casos, em novos desenvolvimentos, vale a pena escolher microcontroladores de 32 bits com um n√∫cleo ARM.  H√° um grande n√∫mero de modifica√ß√µes e voc√™ sempre pode escolher a inst√¢ncia mais adequada para resolver seu problema.  Dependendo do conjunto de fun√ß√µes e desempenho, o pre√ßo de um chip pode variar de dezenas de centavos a dezenas de d√≥lares. <br>  Os microcontroladores (MCUs), dependendo da arquitetura do n√∫cleo da computa√ß√£o, geralmente s√£o divididos em fam√≠lias grandes.  Hoje, para o desenvolvimento de dispositivos de pequena e m√©dia complexidade, os microcontroladores mais populares com n√∫cleos de Cortex-M0 a Cortex-M7.  Quanto maior o n√∫mero, maiores os recursos de computa√ß√£o (e n√£o apenas), pre√ßo e consumo m√°ximo de energia.  A sucess√£o da arquitetura desempenhou um papel importante na popularidade do ARM.  Um desenvolvedor pode modificar o c√≥digo do programa de seus desenvolvimentos anteriores com custos m√≠nimos, passando de microcontroladores de um fabricante para chips de outro e migrando entre n√∫cleos com desempenho diferente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d-/l5/o3/d-l5o3vfjxpjdltq9o6vftmu6wo.jpeg"></div><br><a name="brothers"></a><h4>  <font color="#66a3be">Competi√ß√£o com irm√£os mais novos</font> </h4><br>  No entanto, os ARMs n√£o dirigiram.  Lembro-me bem dos momentos em que os microcontroladores de 8 bits eram os l√≠deres absolutos do mercado e, de suas posi√ß√µes, colegas de 16 bits tentaram pression√°-los sem sucesso, mas, ironicamente, apenas irm√£os mais velhos de 32 bits conseguiram fazer isso.  Aconteceu que, quando apareceram, as tecnologias de fabrica√ß√£o de chips reduziram bastante o custo de integrar grandes volumes de mem√≥ria FLASH a eles.  Aproveitando esta oportunidade, os programadores come√ßaram a mudar de assembler para uma linguagem de n√≠vel superior - C, cuja estrutura era perfeitamente estabelecida na arquitetura de 32 bits.  Como resultado, os microcontroladores de 32 bits realizaram c√°lculos muito mais rapidamente que seus colegas de 8 e 16 bits, mas havia um problema: eles tinham maior consumo de corrente. <br><br>  Portanto, a princ√≠pio, eles eram usados ‚Äã‚Äãnos casos em que era necess√°rio maior desempenho computacional. <br><br>  Sabe-se que o consumo m√©dio atual de corrente do n√∫cleo de computa√ß√£o do microcontrolador aumenta significativamente com o aumento de sua frequ√™ncia de clock.  A princ√≠pio, os modelos de microcontroladores de 8 bits tiveram um consumo notavelmente mais baixo em uma frequ√™ncia semelhante e, al√©m disso, conseguiram trabalhar com uma freq√º√™ncia de clock baixa, de at√© 32 kHz. <br><br>  O consumo de energia dos microcontroladores depende fortemente da frequ√™ncia de clock do n√∫cleo e da periferia. Para regul√°-lo, eles come√ßaram a usar a unidade geradora de freq√º√™ncia de clock baseada em PLL, amplamente utilizada em dispositivos de transmiss√£o de r√°dio.  Isso tornou poss√≠vel variar amplamente a frequ√™ncia do rel√≥gio sem alterar o ressonador principal de quartzo.  Os m√≥dulos perif√©ricos n√£o precisam ter a mesma frequ√™ncia de clock que o n√∫cleo da computa√ß√£o.  Para reduzir o consumo de energia, a frequ√™ncia come√ßou a ser alimentada atrav√©s de divis√≥rias com uma taxa de divis√£o controlada por programa.  Introduziu a capacidade de desativar m√≥dulos n√£o utilizados.  Essas medidas reduziram bastante o consumo de energia, mas ainda assim permaneceu significativamente mais do que as de 8 bits. <br><br>  Por um curto per√≠odo de tempo, a paridade se desenvolveu - os MCUs de 32 bits capturaram o nicho dos aplicativos de ponta e os de 8 bits mantiveram posi√ß√µes seguras em dispositivos para os quais o baixo consumo de energia era importante.  Ele persistiu at√© que os MCUs de 32 bits dominassem perfeitamente o modo de opera√ß√£o "pulso". <br><br>  Os 8 bits, ent√£o, tamb√©m aprenderam como fazer isso, mas, devido ao baixo desempenho, eles tiveram que ficar acordados muito mais e, como resultado, come√ßaram a perder no consumo de energia, especialmente em tarefas que exigem c√°lculos, como mostra a figura abaixo. <br><br><img src="https://habrastorage.org/webt/ro/z1/ji/roz1jikhroyuoh_0whgbgiwusai.jpeg"><br><br><a name="sleep"></a><h4>  <font color="#66a3be">Sobre a coloca√ß√£o de asfalto, os benef√≠cios do sono e suas variedades</font> </h4><br>  Assim, os microcontroladores aprenderam a acreditar t√£o bem que come√ßaram a trabalhar muito rapidamente e, na maioria das vezes, eram for√ßados a "ganhar dinheiro", devorando energia para realizar ciclos inativos.  Em dispositivos com alimenta√ß√£o pr√≥pria, isso reduz bastante a vida √∫til da bateria ou com uma √∫nica carga. <br><br>  Assista os trabalhadores da constru√ß√£o civil colocando o asfalto.  Eles intensificam intensamente seu trabalho quando um caminh√£o chega com uma nova por√ß√£o de asfalto e depois de coloc√°-lo diminui a velocidade.  Portanto, os microcontroladores podem aumentar e diminuir a freq√º√™ncia do clock principal.  No entanto, isso n√£o √© t√£o f√°cil para eles quanto para os trabalhadores - a frequ√™ncia de opera√ß√£o de toda a periferia interna tamb√©m mudar√° ao mesmo tempo; portanto, suas partes sens√≠veis dever√£o ser reconfiguradas. <br>  N√£o √© mais f√°cil, depois de ter feito todo o trabalho rapidamente, dormir um pouco.  Frequentemente sim.  Al√©m disso, os tipos de sono dos microcontroladores diferem ainda mais drasticamente do que nos humanos. <br><br><img src="https://habrastorage.org/webt/_o/s5/4x/_os54x2gaveqetdf6d2erfih87o.jpeg" align="left">  Voc√™ pode tirar uma soneca.  Nesse caso, nosso chip est√° sempre pronto e, assim que o alarme do timer toca ou √© interrompido por uma interrup√ß√£o externa, ele acorda quase instantaneamente.  Como uma pessoa durante uma soneca pode aliviar o estresse, mas n√£o consegue dormir o suficiente quando voc√™ √© constantemente puxado, de modo que o microcontrolador pode reduzir seu consumo de energia nesse modo "apenas" a cada 10 vezes, esse modo √© chamado de SONO. <br><br>  A melhor maneira de dormir bem √© tirar a roupa, ir para a cama, fechar as cortinas da janela e ativar o alarme.  No entanto, ap√≥s esse sonho, voc√™ n√£o entrar√° imediatamente no trabalho.  Voc√™ ter√° que pelo menos enxaguar com √°gua fria e se vestir.  O microcontrolador tamb√©m possui esse modo, quando limita o n√∫mero de est√≠mulos externos e desliga o gerador de clock principal.  Este √© o modo STOP.  Pode reduzir o consumo em 1000 vezes, mas levar√° uma quantidade significativa de tempo para sair dela. <br><br>  Agora, imagine que antes de dormir voc√™ bebia uma boa dose de p√≠lulas para dormir, desligou o alarme e o telefone e fechou todas as janelas e portas.  Este ser√° o modo STAND BY.  O microcontrolador pode ser removido desse modo apenas com a ajuda de conclus√µes especiais, e a maior parte da mem√≥ria do que ele fez antes desse sonho ser√° perdida para sempre; voc√™ ter√° que come√ßar a trabalhar novamente.  Mas estando nesse modo, o MCU consome outra metade. <br><br>  Este √∫ltimo, um modo muito ex√≥tico, j√° lembra algu√©m que n√£o pode ficar sem equipamento especial.  Nesse caso, apenas um gerador especial funciona <s>, no entanto, que faz parte do microcontrolador</s> em um quartzo de rel√≥gio separado, que pode operar a partir de sua pr√≥pria fonte de energia e ter literalmente alguns bytes de RAM, cujo objetivo √© lembrar o microcontrolador de que estado ele caiu.  Se as partes restantes do microcontrolador, ao mesmo tempo, estiverem desconectadas da fonte de alimenta√ß√£o, o consumo de energia poder√° j√° ser um d√©cimo mil√©simo do modo ativo. <br><br>  <b>Ao escolher um modo de economia de energia, √© necess√°rio lembrar as consequ√™ncias do aplicativo</b> : <br><br><ul><li>  quanto mais profundo o sonho, mais longo o despertar </li><li>  quanto mais profundo o sonho, menos maneiras de tirar o microcontrolador dele </li><li>  quanto mais profundo o sono, menos informa√ß√µes permanecem sobre o estado anterior do microcontrolador </li><li>  Para atingir os valores m√≠nimos declarados, em muitos modos √© necess√°rio tomar medidas adicionais, por exemplo - desconectando perif√©ricos </li><li>  Para minimizar o consumo de energia do dispositivo como um todo, √© necess√°rio projetar corretamente os circuitos de todo o dispositivo </li><li>  Para minimizar o consumo de energia do dispositivo como um todo, √© necess√°rio garantir que os outros componentes e circuitos tamb√©m possuam micropoder no modo inativo.  √â tolice fazer grandes esfor√ßos para diminuir o consumo do microcontrolador abaixo de um microampere e, ao mesmo tempo, usar um estabilizador barato com uma corrente de autoconsumo de 100 microamperes no dispositivo, <s>mas isso √© muito comum</s> </li><li>  para o uso bem-sucedido dos modos de sono profundo, n√£o apenas o programa, mas tamb√©m o circuito, deve ser cuidadosamente pensado; caso contr√°rio, em vez de salvar, voc√™ pode ter problemas muito s√©rios - raramente acontecendo, mas o dispositivo "morto" congela por um motivo inexplic√°vel ou acorda com muita frequ√™ncia e, como Como resultado, o consumo √© de ordens de magnitude acima do esperado </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ya/4r/vb/ya4rvbmj6zuxbkfdm42vayp9qnm.jpeg"></div><br>  Se o seu programador com um engenheiro de circuito se culpou pela primeira vez pela curvatura e, juntos, pelo fabricante por publicar n√∫meros irrealistas em folhas de dados no microcontrolador, e seu dispositivo est√° colocando as baterias em uma ordem de magnitude mais r√°pida do que o esperado, esse √© um motivo para pelo menos recorrer √† independ√™ncia especialistas altamente qualificados. <br><br><a name="family"></a><h4>  <font color="#66a3be">Pouco sobre a tecnologia de fabrica√ß√£o e como as s√©ries de microcontroladores aparecem</font> </h4><br>  A parte fisicamente ativa do microcontrolador, como a grande maioria dos outros microcircuitos, geralmente √© formada em uma pastilha de monossil√≠cio (vamos cham√°-lo, neste contexto, de chip).  Os chips ocupam uma √°rea muito pequena, mas √© tecnologicamente rent√°vel produzir chapas de grande di√¢metro; portanto, geralmente um grande n√∫mero de chips, como favos de mel, √© colocado em um prato grande e formado durante um processo tecnol√≥gico.  Posteriormente, as placas s√£o cortadas em peda√ßos, recebendo lascas individuais, que s√£o colocadas no estojo. <img src="https://habrastorage.org/webt/zb/ci/pl/zbcipl0p0xcz2exeiddm0indj7a.jpeg" align="left">  O desenvolvimento da topologia e a depura√ß√£o dos processos tecnol√≥gicos de um novo chip s√£o muito caros, e o espa√ßo ocupado por um √∫nico chip em uma placa geralmente n√£o √© grande.  √â lucrativo para os fabricantes produzirem chips em grandes lotes, mas os usu√°rios precisam de microcontroladores em casos diferentes - √© importante que algu√©m obtenha um gabinete menor e mais barato; por outro lado, s√£o necess√°rias mais sa√≠das para controlar um LCD ou mem√≥ria externa com uma interface paralela.  √â rent√°vel para os fabricantes cobrir todos os nichos, para que os clientes n√£o atinjam os concorrentes sem encontrar o modelo ideal para si. <br><br>  Muitas vezes, √© mais lucrativo liberar um lote grande de um chip universal e coloc√°-lo em casos diferentes do que lan√ßar uma d√∫zia de chips diferentes.  Para chips colocados em caixas com um pequeno n√∫mero de pinos, algumas portas (neste contexto, por portas, entendemos as almofadas de contato na superf√≠cie do chip que servem para se comunicar com o mundo externo) simplesmente permanecem desconectadas.  Frequentemente, os fabricantes v√£o al√©m - para aumentar a demanda e o pre√ßo dos microcontroladores com um grande n√∫mero de pernas, eles cortam artificialmente a funcionalidade daqueles com menos unidades - desabilitam algumas fun√ß√µes, limitam a quantidade de mem√≥ria dispon√≠vel etc. <br><br>  Portanto, com base em um chip, eles formam uma s√©rie de microcontroladores que diferem significativamente no tamanho da mem√≥ria e em um conjunto de m√≥dulos perif√©ricos, √†s vezes √†s vezes no pre√ßo.  Ao mesmo tempo, os chips instalados neles podem ser cortados das mesmas placas.  Como a √°rea em que um chip est√° localizado √© pequena, sua contribui√ß√£o para o custo do produto final tamb√©m √© pequena e pode ser sacrificada.  Torna-se ben√©fico desativar a mem√≥ria adicional e outras fun√ß√µes, por exemplo, no est√°gio de teste - com a ajuda de bits de configura√ß√£o uma vez program√°veis ‚Äã‚Äãou queimando os jumpers com um laser.  Somente para a maioria dos produtos de massa, faz sentido criar um modelo de foto ligeiramente modificado para isso.  Al√©m disso, n√£o √© necess√°rio que exista mem√≥ria n√£o utilizada fisicamente ausente; ela pode ser novamente desligada com a remo√ß√£o de jumpers no modelo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/uu/wr/yxuuwr9uhryuqjgsw9faxxl_szo.jpeg"></div><br>  Assim, a partir de um design de chip padr√£o, √© formada toda uma s√©rie de microcircuitos. <br><br><a name="perif"></a><h4>  <font color="#66a3be">A periferia do mais simples microcontrolador ARM por meio d√≥lar</font> </h4><br>  O n√∫cleo do processador √© o c√©rebro, mas para que n√£o seja como um ‚Äúcavalo esf√©rico no v√°cuo‚Äù, s√£o necess√°rios an√°logos dos sentidos e membros. <br><br>  No microcontrolador, seu papel √© desempenhado pelas conclus√µes do gabinete, √†s quais as portas (pads) do chip podem ser conectadas dentro do gabinete.  Por sua vez, atrav√©s de comutadores internos, v√°rios m√≥dulos perif√©ricos podem ser conectados √† mesma porta. <br>  Para come√ßar, considere a periferia de uma das s√©ries mais simples da ST, com base no n√∫cleo Cortex-M0 - stm32F03. <br><br><img src="https://habrastorage.org/webt/mr/bx/fv/mrbxfvq_arcn6zy_3aapgjflvho.jpeg"><br><br>  <b>Para esta s√©rie, temos o seguinte conjunto de fun√ß√µes b√°sicas:</b> <br>  <b><font color="#66a3be">Rel√≥gio em tempo real (Real Time Clock ou RTC)</font></b> , que pode ser alimentado por uma sa√≠da separada e operar a partir de um ressonador de baixa frequ√™ncia separado.  Este m√≥dulo consome extremamente pouca energia; no caso de uma falta de energia, pode funcionar por horas em um capacitor carregado ou por anos em uma pequena bateria embutida no dispositivo.  Al√©m disso, ele pode servir como um despertador, removendo o microcontrolador do estado de at√© o sono mais profundo em um tempo predeterminado. <br><br>  <b><font color="#66a3be">O WatchDog</font></b> √© um c√£o de guarda que impede o microcontrolador de adormecer para sempre, por exemplo, entrando em um ciclo sem fim ou indo para um endere√ßo inexistente.  Seu princ√≠pio de funcionamento √© simples.      ‚Äú‚Äù    ,   ,   .   ,     ,   ,      .         , WatchDog ,    -      .     ,         WatchDog      . <br><br> <b><font color="#66a3be">  - (General Purpose Input-Output GPIO)</font></b> ‚Äî    ,     .      ,   . <br><br>     .         (     ),      ,     1.        , ,     ,          ,     .  ,    ,   ,        20 ‚Äî 50      (pull-up)    (pull-down). <br><br>     ,         <u>   </u> ,  .     ,       . <br><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"> <i>  ‚Äî    ,     ,      .    ,   ,     ,        ,    . ,   ,   ‚Äî      ,     ,    ,           . <br><br><img src="https://habrastorage.org/webt/a4/06/xz/a406xzrlqas-efxv5iidkjlmhmi.jpeg"><br><br>      ,    ( ),      . X4 ‚Äî    .    5-7,     .      , ,   ,       ,     R24-R26,  1 .  VD4-VD6     5 ,   ,    ,     3,3 ,       5 .  R29-R31  100 . <br>         .        ,    .     STM32Fxx    <s>   </s>    5  ,       ,     ,          . <br><br> ,   .  , ,         ,         ‚Äî              (- ).    ,       .    . <br><br>    .          .          ¬´¬ª ,      . <br><br>      ,     .         ,           ‚Äî  .  ,          ,    . <br> ,    ,   ARM       ,   8- .    ,         ,    .     ,     ,    ,     .</i> </div></div><br> <b><font color="#66a3be"> </font></b>      ,    ,     ,   ,       . <br><br> <b><font color="#66a3be">  </font></b>       ,    .   ,         . <br><br> <b><font color="#66a3be">  </font></b>           ,         : <br><br><ul><li> USART ‚Äî   ,       <s>   COM  RS232</s> ,     </li><li> SPI ‚Äî  ,     ,    </li><li> I2C ‚Äî  ,               .      ,           </li></ul><br>          GPIO,            . <br><br> <b><font color="#66a3be">-    AD</font></b>     . <br><br>   ,      .          ,         ,           .        .       12    ,  10     16. <br><br><img src="https://habrastorage.org/webt/2g/ru/k_/2gruk_gpzqlqu_rxupfdbyrmb4s.jpeg"><br><br>   3  12        3/4096=0.00073  ‚Äî   . <br><br>         . <br><br><div class="spoiler"> <b class="spoiler_title">   </b> <div class="spoiler_text"> <i>               .   ,     ,             <br> <b>    </b> <br><br></i> <ul><li>    MCU      </li><li>      MCU     </li></ul><br> <b>    </b> <br><br><ul><li>           ‚Äî      MCU               XR7  100 ,   ,          ‚Äî  . </li></ul><br> <b>    </b> <br><br><ul><li>        ,     .                  NP0     ,     ,       </li><li>     ,     ,             ,  ,    </li><li>             ‚Äú‚Äù,            ‚Äî       </li></ul><br> <b>    </b> ,  ,        ,      ,                 ,        . <br><br><ul><li>     ,          ,      ,   </li><li>          ( ),   .        ,   ,   ,  .     ,         </li></ul><br><img src="https://habrastorage.org/webt/cm/hp/1h/cmhp1hbrgbk70yzu20fl-v5agdu.jpeg"><br><br>                 .            MEMS             ,    .     ,        ,     . <br><br>   VBUT     .      : R5-10 , 10 0.1 ,   L1  L2 BLM18PG471SN1D     . <br><br><img src="https://habrastorage.org/webt/bi/gs/ja/bigsjabd3x3fbkyhfbnch4bsenc.jpeg"><br><br>       .  ,        ASIC,     .      ‚Äî   .         ,   ,     .        ¬´ ¬ª. <br><br>       ,   . ,    ,  ,   ,      .     1,      16.   ?  ,      .       10 ,     ‚Äî       10    .   ,   .    , ,     1 . ,    10       10 ! <br></div></div><br>  <b><font color="#66a3be">Um sistema de acesso direto √† mem√≥ria DAP ou DMA</font></b> √© outra coisa importante.  Este m√≥dulo permite enviar dados da periferia para a mem√≥ria ou vice-versa. <br><br>  Por exemplo, com sua ajuda, voc√™ pode alocar um peda√ßo de mem√≥ria para armazenar dados provenientes do ADC e fazer um buffer circular a partir dele.  Em seguida, o ADC inicia no modo de leitura de dados em intervalos regulares.  Usando mecanismos DMA, os dados lidos ser√£o, sem a participa√ß√£o do kernel, independentemente, byte a byte, colocados em um buffer dedicado.  Quando o buffer estiver completamente cheio, o kernel receber√° um sinal e come√ßar√° a process√°-los programaticamente, e o sistema DMA iniciar√° o processo de inicializa√ß√£o desde o in√≠cio.  Como o DMA possui v√°rios canais, ningu√©m se preocupa em implementar, no nosso caso, sa√≠da autom√°tica para USART dos dados do buffer.  Como resultado, obtemos o processo de transfer√™ncia da leitura do ADC para o USART que funciona sem o uso do kernel, e n√£o o simples trabalho do programador na configura√ß√£o do DMA ser√° recompensador. <br><br>  <b><font color="#66a3be">O m√≥dulo de modula√ß√£o por largura de pulso PWM ou PWM</font></b> , devido √†s limita√ß√µes do artigo, n√£o abordaremos em detalhes, apenas observo que essa √© uma fun√ß√£o extremamente √∫til e amplamente utilizada com a qual √© poss√≠vel controlar o brilho dos LEDs, velocidade do motor, m√°quinas de dire√ß√£o, projeto DC inteligente Conversores DC e at√© som sintetizam. <br><br>  O que posso obter adicionando 30 centavos? <br><br><a name="family_plus"></a><h4>  <font color="#66a3be">Mudando para o Cortex-M0 +.</font>  <font color="#66a3be">A maneira mais barata de obter recursos extras</font> </h4><br>  E que p√£ezinhos adicionais o microcontrolador da s√©rie mais recente oferece com o n√∫cleo um pouco mais moderno que o Cortex-M0 +, a um custo de 20 a 50 centavos mais caro do que os an√°logos da s√©rie acima em termos de corpo e n√∫mero de sa√≠das? <br><br>  Tabela de diferen√ßas entre s√©ries <br><br><img src="https://habrastorage.org/webt/2y/ep/sx/2yepsxg9tqadr51lrrn23xaksnw.jpeg"><br><br><ul><li>  freq√º√™ncia m√°xima do rel√≥gio dobrada </li><li>  de 2 a 1,7 volts, a tens√£o de alimenta√ß√£o m√≠nima cai </li><li>  ADC √© capaz de trabalhar duas vezes e meia mais r√°pido </li><li>  dois canais de um conversor digital-anal√≥gico de 12 bits apareceram.  Essa √© uma fun√ß√£o extremamente √∫til, com a ajuda da qual √© poss√≠vel formar um sinal de uma determinada tens√£o nos terminais com uma precis√£o melhor que 1 mV, por exemplo, formas de onda arbitr√°rias na faixa de frequ√™ncia de √°udio </li><li>  comparadores apareceram - dispositivos para comparar os valores de dois sinais anal√≥gicos, pode ser √∫til dizer ao determinar o momento de sobrecorrente </li><li>  Adicionado interface USB atrav√©s da qual voc√™ pode conectar dispositivos a um computador.  De particular interesse √© a disponibilidade de op√ß√µes de gerenciamento de energia para implementar uma interface compat√≠vel com USB tipo 3-C.  Eu falei sobre ele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em um dos meus artigos sobre Habr√©</a> </li><li>  O acelerador AES para procedimentos de criptografia / descriptografia de 256 bits apareceu </li><li>  O UART teve a oportunidade de trabalhar nos modos de suspens√£o e suporte de hardware para protocolos LIN (uma rede simples, amplamente usada na ind√∫stria automotiva), IRDA (protocolo de transfer√™ncia de dados via LEDs infravermelhos, lembre-se de controles remotos de televis√£o), SIMcard ... </li><li>  Temporizadores estendidos e m√≥dulo PWM </li><li>  o limite superior da faixa de temperatura de opera√ß√£o subiu para 125 graus </li><li>  maior confiabilidade devido √† expans√£o dos modos de reinicializa√ß√£o em caso de problemas de energia </li><li>  Adicionado um gerador de valor aleat√≥rio de hardware ‚Äúhonesto‚Äù - um recurso √∫til em criptografia </li></ul><br>  Bem, para muitas aplica√ß√µes, um acr√©scimo insignificante no pre√ßo se paga completamente, j√° que voc√™ pode se recusar a mudar para microcontroladores mais caros de s√©ries de modelos mais altas. <br><br><a name="Cort4"></a><h4>  <font color="#66a3be">E o que adicionar√° a transi√ß√£o ao Cortex-M4, al√©m do pre√ßo aumentado algumas vezes?</font> </h4><br><img src="https://habrastorage.org/webt/tb/em/zm/tbemzmhj8xymuu7tmimap7hw4og.png"><br><br><ul><li>  A frequ√™ncia m√°xima do clock sobe para 80 MHz </li><li>  Apareceu um bloco para acelerar os c√°lculos de ponto flutuante </li><li>  Obviamente, a mem√≥ria interna m√°xima aumentou </li><li>  Modelos com 100 p√©s ou mais de suporte para trabalhar com mem√≥ria est√°tica externa </li><li>  USB aprendeu a trabalhar no modo HOST </li><li>  O controlador da interface CAN apareceu.  Essa √© uma interface muito promissora, projetada para aplicativos altamente confi√°veis.  Ele iniciou sua marcha vitoriosa com a ind√∫stria automotiva e est√° travando uma guerra prolongada com o h√° muito obsoleto RS-485 na ind√∫stria extremamente conservadora de automa√ß√£o industrial h√° quase 20 anos. </li><li>  Uma interface para conectar o cart√£o SD apareceu.  Um recurso muito √∫til - adicione um suporte de 50 centavos ao seu dispositivo e obtenha um meio de armazenamento remov√≠vel com dezenas de gigabytes de tamanho!  A maioria das placas consegue trabalhar no SPI usual, mas muito mais lentamente </li><li>  Eles adicionaram um amplificador operacional embutido com uma ampla variedade de modos operacionais.  <i>Gra√ßas a esta e outras fun√ß√µes anteriores, no meu √∫ltimo projeto de estetosc√≥pio sem fio, tive que interromper a escolha no M4 em vez do M0 +.</i>  <i>Como resultado, tornou-se poss√≠vel controlar a amplifica√ß√£o do sinal do microfone MEMS e economizar dezenas de horas de grava√ß√µes de √°udio do trabalho do cora√ß√£o no cart√£o SD</i> </li><li>  O m√≥dulo de criptografia aprendeu a ler as fun√ß√µes HASH no hardware. </li><li>  O controlador de aplicativos de toque foi aprimorado e agora suporta n√£o apenas bot√µes, mas tamb√©m elementos de rolagem </li></ul><br><a name="Cort7"></a><h4>  <font color="#66a3be">Cortex-M7 - quando voc√™ quiser mais ...</font> </h4><br><img src="https://habrastorage.org/webt/lm/rb/gh/lmrbghjnya9ftsujulp3aygdma0.png"><br><br>  No grande n√∫mero de projetos, os recursos fornecidos pelos kernels acima s√£o suficientes, mas tamb√©m ocorrem exce√ß√µes.  Pessoalmente, isso aconteceu comigo apenas algumas vezes, e apenas uma vez por uma boa raz√£o - exigiu alto desempenho para a prepara√ß√£o de dados para o ASIC, um controlador Ethernet e um barramento CAN-FD com uma taxa de c√¢mbio aumentada. <br><br>  Se no n√≠vel de microcontroladores universais com n√∫cleos Cortex 4 e inferiores, na minha opini√£o subjetiva, o ST √© agora o l√≠der em termos de pre√ßo / funcionalidade, ent√£o na √°rea de chips de alto desempenho √© inferior ao ATMEL, ou melhor, ao MICROCHIP, que o absorveu recentemente.  Portanto, optei pela s√©rie ATSAMV71, a partir de US $ 6. <br><br>  Al√©m do acima (controlador Ethernet e barramento CAN-FD), em geral, temos um kernel com um acelerador de opera√ß√µes que aumenta significativamente a produtividade, operando com uma frequ√™ncia de clock de at√© 300 MHz, interfaces para conectar uma matriz de v√≠deo e suporte √† mem√≥ria din√¢mica. <br><br>  Concluindo, pedirei a quem tem experi√™ncia em se comunicar com microcontroladores. Pedirei que voc√™ escolha a resposta apropriada para a pergunta. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445936/">https://habr.com/ru/post/pt445936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445922/index.html">Por que assistir transmiss√µes online, se voc√™ pode ler Habr</a></li>
<li><a href="../pt445924/index.html">TESOUROS: quando os rel√≥gios inteligentes ficam estranhos</a></li>
<li><a href="../pt445926/index.html">O Programa Secreto de OVNIs dos EUA tamb√©m pesquisou buracos de minhoca e dimens√µes extras.</a></li>
<li><a href="../pt445928/index.html">Como aumentamos a produtividade do servi√ßo em Tensorflow em 70%</a></li>
<li><a href="../pt445932/index.html">Seguran√ßa de aplicativos clientes: dicas pr√°ticas para um desenvolvedor front-end</a></li>
<li><a href="../pt445940/index.html">AMA com Habr, v 7.0. Lim√£o, Rosquinhas e Not√≠cias</a></li>
<li><a href="../pt445946/index.html">MWC: instru√ß√µes de uso</a></li>
<li><a href="../pt445948/index.html">Heran√ßa em C ++: iniciante, intermedi√°rio, avan√ßado</a></li>
<li><a href="../pt445952/index.html">Um trilh√£o de pequenos singles</a></li>
<li><a href="../pt445954/index.html">Acelerador de IA da HSE, MTS e Rostelecom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>