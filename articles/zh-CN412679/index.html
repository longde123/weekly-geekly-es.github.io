<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â—½ï¸ ğŸ¤™ğŸ¼ ğŸ‘ª åœ¨10åˆ†é’Ÿå†…åˆ›å»ºä¸€ä¸ªç”¨äºæ–‡æœ¬è¯†åˆ«çš„Androidåº”ç”¨ç¨‹åºã€‚ ç§»åŠ¨è§†è§‰CodeLab ğŸ‘© ğŸ‘©ğŸ¼ ğŸ‘§ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æ•™ç¨‹çš„è§†é¢‘ç‰ˆæœ¬ 
 
 

 å…‰å­¦å­—ç¬¦è¯†åˆ« ï¼ˆ OCR ï¼‰ä½¿è®¡ç®—æœºèƒ½å¤Ÿè¯»å–å›¾åƒä¸­çš„æ–‡æœ¬ï¼Œä»è€Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿç†è§£ç¬¦å·ï¼Œæ–‡ç« ï¼Œä¼ å•ï¼Œæ–‡æœ¬é¡µé¢ï¼Œèœå•æˆ–ä»»ä½•æ–‡æœ¬å½¢å¼çš„ä¸œè¥¿ã€‚ Mobile Vision Text APIä¸ºAndroidå¼€å‘äººå‘˜æä¾›äº†åŠŸèƒ½å¼ºå¤§ä¸”å¯é çš„OCRåŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½æ”¯æŒå¤§å¤šæ•°Androidè®¾...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨10åˆ†é’Ÿå†…åˆ›å»ºä¸€ä¸ªç”¨äºæ–‡æœ¬è¯†åˆ«çš„Androidåº”ç”¨ç¨‹åºã€‚ ç§»åŠ¨è§†è§‰CodeLab</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412679/"><h2> æ•™ç¨‹çš„è§†é¢‘ç‰ˆæœ¬ </h2><br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/mIEfqtn9nts" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<p> <em>å…‰å­¦å­—ç¬¦è¯†åˆ«</em> ï¼ˆ <strong>OCR</strong> ï¼‰ä½¿è®¡ç®—æœºèƒ½å¤Ÿè¯»å–å›¾åƒä¸­çš„æ–‡æœ¬ï¼Œä»è€Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿç†è§£ç¬¦å·ï¼Œæ–‡ç« ï¼Œä¼ å•ï¼Œæ–‡æœ¬é¡µé¢ï¼Œèœå•æˆ–ä»»ä½•æ–‡æœ¬å½¢å¼çš„ä¸œè¥¿ã€‚  <code>Mobile Vision Text API</code>ä¸º<code>Android</code>å¼€å‘äººå‘˜æä¾›äº†åŠŸèƒ½å¼ºå¤§ä¸”å¯é çš„<code>OCR</code>åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½æ”¯æŒå¤§å¤šæ•°<code>Android</code>è®¾å¤‡ï¼Œå¹¶ä¸”ä¸ä¼šå¢åŠ åº”ç”¨ç¨‹åºçš„å¤§å°ã€‚ </p><br><p> åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œåœ¨è¯¥åº”ç”¨ç¨‹åºä¸­ï¼Œå°†åœ¨è§†é¢‘å½•åˆ¶è¿‡ç¨‹ä¸­è¯†åˆ«å¹¶æ’­æ”¾æ‰è½åˆ°æ¡†æ¶ä¸­çš„æ‰€æœ‰æ–‡æœ¬ã€‚ <a name="habracut"></a></p><br><p> æˆ‘ä»¬è¿˜å‘å¸ƒäº†æœ‰å…³å…¶ä»–Mobile VisionåŠŸèƒ½çš„æ–‡ç« ï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯†åˆ«ç‰©ä½“å’Œäººç±»çš„æƒ…æ„Ÿ</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äººè„¸è¯†åˆ«</a> ; </li></ul><br><p> æºä»£ç å¯ä»¥åœ¨<a href="">è¿™é‡Œ</a>ä¸‹è½½ã€‚ </p><br><p> æˆ–ä»å‘½ä»¤è¡Œå…‹éš†<code>GitHub</code>å­˜å‚¨åº“ï¼š </p><br><pre> <code class="bash hljs">$ git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/googlesamples/android-vision.git</code> </pre> <br><p>  <code>visionSamples</code>å­˜å‚¨åº“åŒ…å«è®¸å¤šä¸<code>Mobile Vision</code>ç›¸å…³çš„ç¤ºä¾‹é¡¹ç›®ã€‚ æœ¬è¯¾ä»…ä½¿ç”¨ä¸¤ä¸ªï¼š </p><br><ul><li> <strong><img src="https://habrastorage.org/getpro/habr/post_images/1e8/d51/ef8/1e8d51ef802bcde6a7d36bf83490b24d.png" width="22" height="22"></strong>  <strong>ocr-codelab / ocr-reader-start</strong>æ˜¯æœ¬è¯¾ç¨‹ä¸­å°†ä½¿ç”¨çš„åˆå§‹ä»£ç ã€‚ </li><li> <strong><img src="https://habrastorage.org/getpro/habr/post_images/1e8/d51/ef8/1e8d51ef802bcde6a7d36bf83490b24d.png" width="22" height="22"></strong>  <strong>ocr-codelab / ocr-reader-complete-</strong>å®Œæˆçš„åº”ç”¨ç¨‹åºçš„å®Œæ•´ä»£ç ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿›è¡Œæ•…éšœæ’é™¤æˆ–ç›´æ¥è½¬åˆ°æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚ </li></ul><br><h2>  Google PlayæœåŠ¡æ›´æ–° </h2><br><p> æ‚¨å¯èƒ½éœ€è¦å‡çº§å·²å®‰è£…çš„<code>Google Repository</code>ç‰ˆæœ¬æ‰èƒ½ä½¿ç”¨<code>Mobile Vision Text API</code> ã€‚ </p><br><p> æ‰“å¼€<code>Android Studio</code>å¹¶æ‰“å¼€<code>SDK Manager</code> ï¼š </p><br><img src="https://habrastorage.org/getpro/habr/post_images/c09/c24/18f/c09c2418f842d747bb135a7d868c4931.png" width="240" height="117"><br><p><br> ç¡®ä¿<code>Google Repository</code>æœ€æ–°çš„ã€‚ å®ƒå¿…é¡»è‡³å°‘æ˜¯ç‰ˆæœ¬<code>26</code> ã€‚ </p><br><img src="https://habrastorage.org/getpro/habr/post_images/55f/a3f/0ee/55fa3f0ee048bc97f5b14b9fff7734ea.png" width="750" height="502"><br><p></p><br><h2> æ·»åŠ Google PlayæœåŠ¡ä¾èµ–é¡¹å¹¶åˆ›å»ºè¦è¿è¡Œçš„åº”ç”¨ç¨‹åº </h2><br><p> ç°åœ¨æ‚¨å¯ä»¥æ‰“å¼€å…¥é—¨é¡¹ç›®ï¼š </p><br><ol><li><p> é€‰æ‹©å¯åŠ¨ç›®å½• <strong><img src="https://habrastorage.org/getpro/habr/post_images/1e8/d51/ef8/1e8d51ef802bcde6a7d36bf83490b24d.png" width="22" height="22"></strong> ä¸‹è½½çš„ä»£ç ä¸­çš„<code>ocr-reader</code> ï¼ˆ <strong>æ–‡ä»¶</strong> &gt; <strong>æ‰“å¼€</strong> &gt; <code>ocr-codelab/ocr-reader-start</code> ï¼‰ã€‚ </p><br></li><li><p> å°†<code>Google Play Services</code>ä¾èµ–é¡¹æ·»åŠ åˆ°åº”ç”¨ç¨‹åºã€‚ æ²¡æœ‰è¿™ç§ä¾èµ–æ€§ï¼Œ <code>Text API</code>å°†ä¸å¯ç”¨ã€‚ </p><br></li></ol><br><p> è¯¥é¡¹ç›®å¯èƒ½è¡¨æ˜ç¼ºå°‘<strong>æ•´æ•°/ google_play_services_versionæ–‡ä»¶</strong>å¹¶ç»™å‡ºäº†é”™è¯¯ã€‚ è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥ä¸­è¿›è¡Œä¿®å¤ã€‚ </p><br><p> åœ¨<code>app</code>æ¨¡å—ä¸­æ‰“å¼€<code>build.gradle</code>æ–‡ä»¶ï¼Œç„¶åæ›´æ”¹ä¾èµ–å…³ç³»å—ä»¥åœ¨å…¶ä¸­åŒ…å«<code>play-services-vision</code>ä¾èµ–å…³ç³»ã€‚ ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œæ–‡ä»¶åº”å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">dependencies</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">implementation</span></span> fileTree(dir: <span class="hljs-string"><span class="hljs-string">'libs'</span></span>, include: [<span class="hljs-string"><span class="hljs-string">'*.jar'</span></span>]) implementation <span class="hljs-string"><span class="hljs-string">'com.android.support:support-v4:26.1.0'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'com.android.support:design:26.1.0'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'com.google.android.gms:play-services-vision:15.0.0'</span></span> }</code> </pre> <br><ol><li><p> è¯·ç‚¹å‡» <img src="https://habrastorage.org/getpro/habr/post_images/f7d/f74/7c5/f7df747c534410a9c0391d47de0bb0e3.png" width="21" height="21">  <code>Gradle</code>åŒæ­¥æŒ‰é’®ã€‚ </p><br></li><li><p> è¯·ç‚¹å‡» <img src="https://habrastorage.org/getpro/habr/post_images/82f/7df/0d1/82f7df0d1dce3d570e7c35d7d8fb4575.png" width="22" height="23"> å¼€å§‹æŒ‰é’®ã€‚ </p><br></li></ol><br><p> å‡ ç§’é’Ÿåï¼Œæ‚¨å°†çœ‹åˆ°â€œè¯»å–æ–‡æœ¬â€å±å¹•ï¼Œä½†è¿™åªæ˜¯ä¸€ä¸ªé»‘å±ã€‚ </p><br><img src="https://habrastorage.org/getpro/habr/post_images/c41/e98/6dc/c41e986dc883fb67fe0caf0760e99378.png" width="349" height="621"><br><p><br> ç”±äºæœªé…ç½®<code>CameraSource</code>æ²¡æœ‰ä»»ä½•ååº”ã€‚ æ¥å§ </p><br><p> å¦‚æœä¸æˆåŠŸï¼Œæ‚¨å¯ä»¥æ‰“å¼€ä¸€ä¸ªé¡¹ç›® <strong><img src="https://habrastorage.org/getpro/habr/post_images/1e8/d51/ef8/1e8d51ef802bcde6a7d36bf83490b24d.png" width="22" height="22"></strong>  <code>ocr-reader-complete</code>å¹¶ç¡®ä¿å…¶æ­£å¸¸è¿è¡Œã€‚ è¯¥é¡¹ç›®æ˜¯è¯¾ç¨‹çš„ç°æˆç‰ˆæœ¬ï¼Œå¦‚æœè¯¥ç‰ˆæœ¬ä¸èµ·ä½œç”¨ï¼Œåˆ™åº”æ£€æŸ¥è®¾å¤‡å’Œ<code>Android Studio</code>è®¾ç½®æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚ </p><br><h2> é…ç½®TextRecognizerå’ŒCameraSource </h2><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬å°†åˆ›å»º<code>TextRecognizer</code> ã€‚ è¯¥æ£€æµ‹å™¨å¯¹è±¡å¤„ç†å›¾åƒå¹¶ç¡®å®šå…¶ä¸­æ˜¾ç¤ºå“ªäº›æ–‡æœ¬ã€‚ åˆå§‹åŒ–åï¼Œ <code>TextRecognizer</code>å¯ç”¨äºæ£€æµ‹æ‰€æœ‰ç±»å‹çš„å›¾åƒä¸­çš„æ–‡æœ¬ã€‚ æ‰¾åˆ°<code>createCameraSource</code>æ–¹æ³•å¹¶åˆ›å»ºä¸€ä¸ª<code>TextRecognizer</code> ï¼š </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createCameraSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> autoFocus, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> useFlash)</span></span></span><span class="hljs-function"> </span></span>{ Context context = getApplicationContext(); <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Create the TextRecognizer TextRecognizer textRecognizer = new TextRecognizer.Builder(context).build(); // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Set the TextRecognizer's Processor. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Check if the TextRecognizer is operational. // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Create the mCameraSource using the TextRecognizer. }</span></span></code> </pre> <br><p> ç°åœ¨<code>TextRecognizer</code>å‡†å¤‡å°±ç»ªã€‚ ä½†æ˜¯ï¼Œå®ƒå¯èƒ½è¿˜æ— æ³•æ­£å¸¸å·¥ä½œã€‚ å¦‚æœè®¾å¤‡çš„å†…å­˜ä¸è¶³æˆ–<code>Google Play Services</code>æ— æ³•åŠ è½½<code>OCR</code>ä¾èµ–é¡¹ï¼Œåˆ™<code>TextRecognizer</code>å¯¹è±¡å°†æ— æ³•å·¥ä½œã€‚ åœ¨å¼€å§‹å°†å…¶ç”¨äºæ–‡æœ¬è¯†åˆ«ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»éªŒè¯å®ƒå·²å‡†å¤‡å°±ç»ªã€‚ åˆå§‹åŒ–<code>TextRecognizer</code>ä¹‹åï¼Œæˆ‘ä»¬å°†æŠŠæ­¤æ£€æŸ¥æ·»åŠ åˆ°<code>createCameraSource</code> ï¼š </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Check if the TextRecognizer is operational. if (!textRecognizer.isOperational()) { Log.w(TAG, "Detector dependencies are not yet available."); // Check for low storage. If there is low storage, the native library will not be // downloaded, so detection will not become operational. IntentFilter lowstorageFilter = new IntentFilter(Intent.ACTION_DEVICE_STORAGE_LOW); boolean hasLowStorage = registerReceiver(null, lowstorageFilter) != null; if (hasLowStorage) { Toast.makeText(this, R.string.low_storage_error, Toast.LENGTH_LONG).show(); Log.w(TAG, getString(R.string.low_storage_error)); } }</span></span></code> </pre> <br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»éªŒè¯äº†<code>TextRecognizer</code>å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥è¯†åˆ«å•ä¸ªå¸§ã€‚ ä½†æ˜¯æˆ‘ä»¬æƒ³åšä¸€äº›æ›´æœ‰è¶£çš„äº‹æƒ…ï¼šä»¥è§†é¢‘æ¨¡å¼é˜…è¯»æ–‡æœ¬ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªé¢„å…ˆé…ç½®ä¸ºæ§åˆ¶æ‘„åƒæœºçš„<code>CameraSource</code> ã€‚ æˆ‘ä»¬éœ€è¦ä¸ºæ‹æ‘„è®¾ç½®é«˜åˆ†è¾¨ç‡ï¼Œå¹¶å¯ç”¨è‡ªåŠ¨å¯¹ç„¦ä»¥åº”å¯¹è¯†åˆ«å°æ–‡æœ¬çš„ä»»åŠ¡ã€‚ å¦‚æœæ‚¨ç¡®å®šç”¨æˆ·ä¼šçœ‹åˆ°å¤§å—çš„æ–‡æœ¬ï¼ˆä¾‹å¦‚ç¬¦å·ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è¾ƒä½çš„åˆ†è¾¨ç‡ï¼Œç„¶åå¸§å¤„ç†ä¼šæ›´å¿«ï¼š </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Create the cameraSource using the TextRecognizer. cameraSource = new CameraSource.Builder(getApplicationContext(), textRecognizer) .setFacing(CameraSource.CAMERA_FACING_BACK) .setRequestedPreviewSize(1280, 1024) .setRequestedFps(15.0f) .setFlashMode(useFlash ? Camera.Parameters.FLASH_MODE_TORCH : null) .setFocusMode(autoFocus ? Camera.Parameters.FOCUS_MODE_CONTINUOUS_VIDEO : null) .build();</span></span></code> </pre> <br><p> å®Œæˆåï¼Œè¿™æ˜¯<code>createCameraSource</code>æ–¹æ³•çš„å¤–è§‚ï¼š </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createCameraSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> autoFocus, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> useFlash)</span></span></span><span class="hljs-function"> </span></span>{ Context context = getApplicationContext(); <span class="hljs-comment"><span class="hljs-comment">// Create the TextRecognizer TextRecognizer textRecognizer = new TextRecognizer.Builder(context).build(); // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Set the TextRecognizer's Processor. // Check if the TextRecognizer is operational. if (!textRecognizer.isOperational()) { Log.w(TAG, "Detector dependencies are not yet available."); // Check for low storage. If there is low storage, the native library will not be // downloaded, so detection will not become operational. IntentFilter lowstorageFilter = new IntentFilter(Intent.ACTION_DEVICE_STORAGE_LOW); boolean hasLowStorage = registerReceiver(null, lowstorageFilter) != null; if (hasLowStorage) { Toast.makeText(this, R.string.low_storage_error, Toast.LENGTH_LONG).show(); Log.w(TAG, getString(R.string.low_storage_error)); } } // Create the cameraSource using the TextRecognizer. cameraSource = new CameraSource.Builder(getApplicationContext(), textRecognizer) .setFacing(CameraSource.CAMERA_FACING_BACK) .setRequestedPreviewSize(1280, 1024) .setRequestedFps(15.0f) .setFlashMode(useFlash ? Camera.Parameters.FLASH_MODE_TORCH : null) .setFocusMode(autoFocus ? Camera.Parameters.FOCUS_MODE_CONTINUOUS_VIDEO : null) .build(); }</span></span></code> </pre> <br><p> å¦‚æœæ‚¨è¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨å°†çœ‹åˆ°è§†é¢‘å·²ç»å¼€å§‹ï¼ ä½†æ˜¯è¦å¤„ç†æ¥è‡ªæ‘„åƒæœºçš„å›¾åƒï¼Œæˆ‘ä»¬éœ€è¦å°†æœ€åä¸€ä¸ª<code>TODO</code>æ·»åŠ åˆ°<code>createCameraSource</code> ï¼šåˆ›å»ºä¸€ä¸ª<code>Processor</code>æ¥å¤„ç†æ–‡æœ¬åˆ°è¾¾æ—¶çš„å†…å®¹ã€‚ </p><br><h2> åˆ›å»ºOcrDetectorProcessor </h2><br><p> æ‚¨çš„åº”ç”¨ç¨‹åºç°åœ¨å¯ä»¥ä½¿ç”¨<code>TextRecognizer</code>çš„å‘ç°æ–¹æ³•æ¥æ£€æµ‹å•ä¸ªæ¡†æ¶ä¸Šçš„æ–‡æœ¬ã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨ä¾‹å¦‚ç…§ç‰‡ä¸­æ‰¾åˆ°æ–‡æœ¬ã€‚ ä½†æ˜¯ï¼Œä¸ºäº†åœ¨è§†é¢‘æ‹æ‘„æœŸé—´ç›´æ¥è¯»å–æ–‡æœ¬ï¼Œæ‚¨éœ€è¦å®ç°ä¸€ä¸ª<code>Processor</code> ï¼Œè¯¥<code>Processor</code>å°†åœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ–‡æœ¬åç«‹å³å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ </p><br><p> è½¬åˆ°<code>OcrDetectorProcessor</code>ç±»<code>OcrDetectorProcessor</code>å®ç°<code>Detector.Processor</code>æ¥å£ï¼š </p><br><p>  <em>OcrDetectorProcessor.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OcrDetectorProcessor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Detector</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Processor</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextBlock</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GraphicOverlay&lt;OcrGraphic&gt; graphicOverlay; OcrDetectorProcessor(GraphicOverlay&lt;OcrGraphic&gt; ocrGraphicOverlay) { graphicOverlay = ocrGraphicOverlay; } }</code> </pre> <br><p> è¦å®ç°æ­¤æ¥å£ï¼Œæ‚¨éœ€è¦é‡å†™ä¸¤ä¸ªæ–¹æ³•ã€‚ ç¬¬ä¸€ä¸ªæ–¹æ³•<code>receiveDetections</code>åœ¨æ£€æµ‹åˆ°å®ƒä»¬æ—¶ä»<code>TextRecognizer</code>æ¥æ”¶<code>TextBlocks</code> ã€‚ ç¬¬äºŒä¸ª<code>release</code> ï¼Œç”¨äºåœ¨é”€æ¯<code>TextRecognizer</code>æ—¶é‡Šæ”¾èµ„æºã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ¸…é™¤å›¾å½¢ç”»å¸ƒï¼Œè¿™å°†å¯¼è‡´åˆ é™¤æ‰€æœ‰<code>OcrGraphic</code>å¯¹è±¡ã€‚ </p><br><p> æˆ‘ä»¬å°†è·å–<code>TextBlocks</code>å¹¶ä¸ºå¤„ç†å™¨æ£€æµ‹åˆ°çš„æ¯ä¸ªæ–‡æœ¬å—åˆ›å»º<code>OcrGraphic</code>å¯¹è±¡ã€‚ æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥ä¸­å®ç°å…¶ç»˜åˆ¶çš„é€»è¾‘ã€‚ </p><br><p>  <em>OcrDetectorProcessor.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receiveDetections</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Detector.Detections&lt;TextBlock&gt; detections)</span></span></span><span class="hljs-function"> </span></span>{ graphicOverlay.clear(); SparseArray&lt;TextBlock&gt; items = detections.getDetectedItems(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; items.size(); ++i) { TextBlock item = items.valueAt(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; item.getValue() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { Log.d(<span class="hljs-string"><span class="hljs-string">"Processor"</span></span>, <span class="hljs-string"><span class="hljs-string">"Text detected! "</span></span> + item.getValue()); OcrGraphic graphic = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OcrGraphic(graphicOverlay, item); graphicOverlay.add(graphic); } } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">release</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ graphicOverlay.clear(); }</code> </pre> <br><p> ç°åœ¨å¤„ç†å™¨å·²ç»å‡†å¤‡å°±ç»ªï¼Œæˆ‘ä»¬éœ€è¦é…ç½®<code>textRecognizer</code>ä»¥ä½¿ç”¨å®ƒã€‚ è¿”å›åˆ°<code>OcrCaptureActivity</code>ä¸­çš„<code>createCameraSource</code>æ–¹æ³•ä¸­æœ€åå‰©ä½™çš„<code>TODO</code> ï¼š </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Create the TextRecognizer TextRecognizer textRecognizer = new TextRecognizer.Builder(context).build(); // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Set the TextRecognizer's Processor. textRecognizer.setProcessor(new OcrDetectorProcessor(graphicOverlay));</span></span></code> </pre> <br><p> ç°åœ¨è¿è¡Œè¯¥åº”ç”¨ç¨‹åºã€‚ æ­¤æ—¶ï¼Œå°†ç›¸æœºæ‚¬åœåœ¨æ–‡æœ¬ä¸Šæ–¹æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°è°ƒè¯•æ¶ˆæ¯â€œæ£€æµ‹åˆ°æ–‡æœ¬ï¼â€ åœ¨<code>Android Monitor Logcat</code> ï¼ ä½†è¿™ä¸æ˜¯ä¸€ç§ç›´è§‚çš„æ–¹æ³•æ¥å¯è§†åŒ–<code>TextRecognizer</code>çœ‹åˆ°çš„å†…å®¹ï¼Œå¯¹å—ï¼Ÿ </p><br><p> åœ¨ä¸‹ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨å±å¹•ä¸Šç»˜åˆ¶æ­¤æ–‡æœ¬ã€‚ </p><br><h2> åœ¨å±å¹•ä¸Šç»˜åˆ¶æ–‡å­— </h2><br><p> è®©æˆ‘ä»¬åœ¨<code>OcrGraphic</code>å®ç°<code>draw</code>æ–¹æ³•ã€‚ æˆ‘ä»¬éœ€è¦äº†è§£å›¾åƒä¸­æ˜¯å¦æœ‰æ–‡æœ¬ï¼Œå°†å…¶è¾¹ç•Œçš„åæ ‡è½¬æ¢ä¸ºç”»å¸ƒæ¡†æ¶ï¼Œç„¶åç»˜åˆ¶è¾¹ç•Œå’Œæ–‡æœ¬ã€‚ </p><br><p>  <em>OcrGraphic.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Canvas canvas)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Draw the text onto the canvas. if (text == null) { return; } // Draws the bounding box around the TextBlock. RectF rect = new RectF(text.getBoundingBox()); rect = translateRect(rect); canvas.drawRect(rect, rectPaint); // Render the text at the bottom of the box. canvas.drawText(text.getValue(), rect.left, rect.bottom, textPaint); }</span></span></code> </pre> <br><p> å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶åœ¨ä»¥ä¸‹ç¤ºä¾‹æ–‡æœ¬ä¸Šå¯¹å…¶è¿›è¡Œæµ‹è¯•ï¼š </p><br><img src="https://habrastorage.org/getpro/habr/post_images/9f9/62d/41d/9f962d41d7ee963958a8bbc2f88b97ec.png" width="663" height="169"><br><p> æ‚¨åº”è¯¥çœ‹åˆ°å±å¹•ä¸Šå‡ºç°ä¸€ä¸ªå¸¦æœ‰æ–‡æœ¬çš„æ¡†æ¶ï¼ æ‚¨å¯ä»¥ä½¿ç”¨<code>TEXT_COLOR</code>æ¥å¤„ç†æ–‡æœ¬çš„é¢œè‰²ã€‚ </p><br><p> è¿™æ ·å‘¢ </p><br><img src="https://habrastorage.org/getpro/habr/post_images/8f2/09a/d7c/8f209ad7cd7ae77245abaa3250ea91d2.png" width="621" height="441"><br><p> æ–‡æœ¬å‘¨å›´çš„æ¡†æ¶çœ‹èµ·æ¥æ­£ç¡®ï¼Œä½†æ˜¯æ–‡æœ¬åœ¨å…¶åº•éƒ¨ã€‚ </p><br><img src="https://habrastorage.org/getpro/habr/post_images/8dc/0ef/ec1/8dc0efec1d11dadff02a2ca7aa83d752.png" width="351" height="622"><br><p><br> è¿™æ˜¯å› ä¸ºå³ä½¿çœ‹åˆ°çš„å¥å­åˆ†ä¸ºå‡ è¡Œï¼Œå¼•æ“ä¹Ÿä¼šå°†å…¶åœ¨<code>TextBlock</code>è¯†åˆ«çš„æ‰€æœ‰æ–‡æœ¬ä½œä¸ºå•ä¸ªå¥å­ä¼ è¾“ã€‚ å¦‚æœæ‚¨éœ€è¦è·å¾—å…¨éƒ¨æŠ¥ä»·ï¼Œé‚£ä¹ˆè¿™éå¸¸æ–¹ä¾¿ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³çŸ¥é“æ¯ä¸€è¡Œæ–‡æœ¬åœ¨å“ªé‡Œï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ </p><br><p> æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨<code>getComponents</code>ä»<code>TextBlock</code>è·å¾—<code>Lines</code> ï¼Œç„¶åå¯¹æ¯ä¸€è¡Œè¿›è¡Œæ’åºï¼Œä»è€Œè½»æ¾è·å¾—å…¶ä½ç½®å’Œå…¶ä¸­çš„æ–‡æœ¬ã€‚ è¿™ä½¿æ‚¨å¯ä»¥åœ¨å®é™…æ˜¾ç¤ºçš„ä½ç½®ç»˜åˆ¶æ–‡æœ¬ã€‚ </p><br><p>  <em>OcrGraphic.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Canvas canvas)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Draw the text onto the canvas. if (text == null) { return; } // Draws the bounding box around the TextBlock. RectF rect = new RectF(text.getBoundingBox()); rect = translateRect(rect); canvas.drawRect(rect, rectPaint); // Break the text into multiple lines and draw each one according to its own bounding box. List&lt;? extends Text&gt; textComponents = text.getComponents(); for(Text currentText : textComponents) { float left = translateX(currentText.getBoundingBox().left); float bottom = translateY(currentText.getBoundingBox().bottom); canvas.drawText(currentText.getValue(), left, bottom, textPaint); } }</span></span></code> </pre> <br><p> é‡è¯•æ­¤æ–‡æœ¬ï¼š </p><br><img src="https://habrastorage.org/getpro/habr/post_images/8f2/09a/d7c/8f209ad7cd7ae77245abaa3250ea91d2.png" width="655" height="465"><br><p> å¤ªå¥½äº†ï¼ æ‚¨ç”šè‡³å¯ä»¥æ ¹æ®éœ€è¦å°†æ‰¾åˆ°çš„æ–‡æœ¬åˆ†è§£æˆæ›´å°çš„éƒ¨åˆ†ã€‚ æ‚¨å¯ä»¥åœ¨æ¯ä¸€è¡Œä¸Šè°ƒç”¨<code>getComponents</code>å¹¶è·å–<code>Elements</code> ï¼ˆæ‹‰ä¸è¯ï¼‰ã€‚ å¯ä»¥é…ç½®<code>textSize</code> ï¼Œä½¿æ–‡æœ¬å ç”¨å±å¹•ä¸Šå®é™…æ–‡æœ¬çš„ç©ºé—´ã€‚ </p><br><img src="https://habrastorage.org/getpro/habr/post_images/102/3e0/2d2/1023e02d2d8659ec0a4d51662241037e.png" width="349" height="620"><br><p></p><br><h2> å•å‡»æ—¶æ’­æ”¾æ–‡æœ¬ </h2><br><p> ç°åœ¨ï¼Œæ¥è‡ªæ‘„åƒæœºçš„æ–‡æœ¬å°†è½¬æ¢ä¸ºç»“æ„åŒ–çš„è¡Œï¼Œå¹¶å°†è¿™äº›è¡Œæ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ è®©æˆ‘ä»¬å¯¹ä»–ä»¬åšäº›å…¶ä»–çš„äº‹æƒ…ã€‚ </p><br><p> ä½¿ç”¨<code>Android</code>å†…ç½®çš„<code>TextToSpeech API</code>å’Œ<code>OcrGraphic</code>çš„<code>contains</code>æ–¹æ³•ï¼Œå½“æ‚¨å•å‡»æ–‡æœ¬æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ•™åº”ç”¨ç¨‹åºå¤§å£°è¯´å‡ºæ¥ã€‚ </p><br><p> é¦–å…ˆï¼Œè®©æˆ‘ä»¬åœ¨<code>OcrGraphic</code>å®ç°<code>contains</code>æ–¹æ³•ã€‚ æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥<code>x</code>å’Œ<code>y</code>åæ ‡æ˜¯å¦åœ¨æ˜¾ç¤ºçš„æ–‡æœ¬èŒƒå›´å†…ã€‚ <br>  <em>OcrGraphic.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">contains</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Check if this graphic's text contains this point. if (text == null) { return false; } RectF rect = new RectF(text.getBoundingBox()); rect = translateRect(rect); return rect.contans(x, y); }</span></span></code> </pre> <br><p> æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°<code>Draw</code>æ–¹æ³•æœ‰å¾ˆå¤šå…±åŒç‚¹ï¼ åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿé‡ç”¨ä»£ç ï¼Œä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å†…å®¹ä¿ç•™ä¸ºä¾‹ã€‚ </p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬è½¬åˆ°<code>OcrCaptureActivity</code>çš„<code>onTap</code>æ–¹æ³•ï¼Œå¹¶å¤„ç†å¯¹æ–‡æœ¬çš„å•å‡»ï¼ˆå¦‚æœè¯¥ä½ç½®æœ‰ä¸€ä¸ªå•å‡»ï¼‰ã€‚ </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawY)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Speak the text when the user taps on screen. OcrGraphic graphic = graphicOverlay.getGraphicAtLocation(rawX, rawY); TextBlock text = null; if (graphic != null) { text = graphic.getTextBlock(); if (text != null &amp;&amp; text.getValue() != null) { Log.d(TAG, "text data is being spoken! " + text.getValue()); // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Speak the string. } else { Log.d(TAG, "text data is null"); } } else { Log.d(TAG,"no text detected"); } return text != null; }</span></span></code> </pre> <br><p> æ‚¨å¯ä»¥è¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œå¹¶ç¡®ä¿å®é™…ä¸Šé€šè¿‡<code>Android Monitor Logcat</code>å¤„ç†äº†å•å‡»æ–‡æœ¬çš„<code>Android Monitor Logcat</code> ã€‚ </p><br><p> è®©æˆ‘ä»¬æ¥è°ˆè°ˆåº”ç”¨ç¨‹åºå§ï¼ è½¬åˆ°â€œ <code>Activity</code>çš„å¼€å¤´å¹¶æ‰¾åˆ°<code>onCreate</code>æ–¹æ³•ã€‚ å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åˆå§‹åŒ–<code>TextToSpeech</code>å¼•æ“ä»¥å¤‡å°†æ¥ä½¿ç”¨ã€‚ </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle bundle)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// (Portions of this method omitted) // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Set up the Text To Speech engine. TextToSpeech.OnInitListener listener = new TextToSpeech.OnInitListener() { @Override public void onInit(final int status) { if (status == TextToSpeech.SUCCESS) { Log.d("TTS", "Text to speech engine started successfully."); tts.setLanguage(Locale.US); } else { Log.d("TTS", "Error starting the text to speech engine."); } } }; tts = new TextToSpeech(this.getApplicationContext(), listener); }</span></span></code> </pre> <br><p> å°½ç®¡äº‹å®ä¸Šæˆ‘ä»¬æ­£ç¡®åœ°åˆå§‹åŒ–äº†<code>TextToSpeech</code> ï¼Œä½†ä»ç„¶éœ€è¦å¤„ç†ä¸€èˆ¬é”™è¯¯ï¼Œä¾‹å¦‚ï¼Œå½“æ‚¨ç¬¬ä¸€æ¬¡å•å‡»æ–‡æœ¬æ—¶å¼•æ“ä»æœªå°±ç»ªæ—¶ã€‚ </p><br><p>  <code>TextToSpeech</code>ä¹Ÿå–å†³äºè¯­è¨€ã€‚ æ‚¨å¯ä»¥æ ¹æ®è¯†åˆ«çš„æ–‡æœ¬çš„è¯­è¨€æ¥æ›´æ”¹è¯­è¨€ã€‚ è¯­è¨€è¯†åˆ«æ²¡æœ‰å†…ç½®åœ¨<code>Mobile Vision Text API</code> ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡<code>Google Translate API</code> ã€‚ ä½œä¸ºç”¨äºæ–‡æœ¬è¯†åˆ«çš„è¯­è¨€ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç”¨æˆ·è®¾å¤‡çš„è¯­è¨€ã€‚ </p><br><p> å¾ˆå¥½ï¼Œå‰©ä¸‹çš„å°±æ˜¯åœ¨<code>onTap</code>æ–¹æ³•ä¸­æ·»åŠ æ–‡æœ¬æ’­æ”¾ä»£ç ã€‚ </p><br><p>  <em>OcrCaptureActivity.java</em> </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rawY)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Speak the text when the user taps on screen. OcrGraphic graphic = graphicOverlay.getGraphicAtLocation(rawX, rawY); TextBlock text = null; if (graphic != null) { text = graphic.getTextBlock(); if (text != null &amp;&amp; text.getValue() != null) { Log.d(TAG, "text data is being spoken! " + text.getValue()); // Speak the string. tts.speak(text.getValue(), TextToSpeech.QUEUE_ADD, null, "DEFAULT"); } else { Log.d(TAG, "text data is null"); } } else { Log.d(TAG,"no text detected"); } return text != null; }</span></span></code> </pre> <br><p> ç°åœ¨ï¼Œå½“æ‚¨å¯åŠ¨åº”ç”¨ç¨‹åºå¹¶å•å‡»æ£€æµ‹åˆ°çš„æ–‡æœ¬æ—¶ï¼Œè®¾å¤‡å°†æ’­æ”¾å®ƒã€‚ è¯•è¯•çœ‹ï¼ </p><br><h2> å®Œæˆæ—¶é—´ </h2><br><p> ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¯ä»¥è¯†åˆ«ç›¸æœºä¸­çš„æ–‡å­—å¹¶å¤§å£°æœ—è¯»ï¼ </p><br><p> æ‚¨å¯ä»¥å°†è·å¾—çš„æ–‡æœ¬è¯†åˆ«çŸ¥è¯†åº”ç”¨åˆ°å…¶ä»–åº”ç”¨ç¨‹åºä¸­ã€‚ ä¾‹å¦‚ï¼Œä»åç‰‡ä¸­è¯»å–åœ°å€å’Œç”µè¯å·ç ï¼Œä»å„ç§æ–‡æ¡£çš„ç…§ç‰‡ä¸­æœç´¢æ–‡æœ¬ã€‚ ç®€è€Œè¨€ä¹‹ï¼Œè¯·åœ¨å¯èƒ½éœ€è¦è¯†åˆ«å›¾åƒä¸­æ–‡æœ¬çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨<code>OCR</code> ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¥æº</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN412679/">https://habr.com/ru/post/zh-CN412679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN412667/index.html">Cyberâ€‹â€‹group Turlaåœ¨ç­èšŠè¿åŠ¨ä¸­ä½¿ç”¨Metasploit</a></li>
<li><a href="../zh-CN412669/index.html">æ—¶é—´ç®¡ç†å¹¶ä¸å¯æ€•ï¼šå¦‚ä½•åšå¾—æ›´å¤š</a></li>
<li><a href="../zh-CN412671/index.html">BLEæ§åˆ¶å°ï¼šä¸BLEè®¾å¤‡äº¤äº’çš„å…¨æ–°æ–¹æ³•</a></li>
<li><a href="../zh-CN412675/index.html">æ¯”ç‰¹å¸å’Œä»¥å¤ªåŠä¸­çš„Multisigåˆçº¦å’Œåœ°å€</a></li>
<li><a href="../zh-CN412677/index.html">è¿½æº¯çŸ©é˜µ</a></li>
<li><a href="../zh-CN412681/index.html">åè¿›åˆ¶ç®—æœ¯çš„äºŒè¿›åˆ¶è®¡ç®—</a></li>
<li><a href="../zh-CN412683/index.html">åœ¨å“ªé‡Œä»¥åŠå¦‚ä½•å­¦ä¹ æœºå™¨å­¦ä¹ ï¼Ÿ</a></li>
<li><a href="../zh-CN412685/index.html">Unity GPUè·¯å¾„è·Ÿè¸ª-ç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN412687/index.html">å®æ–½IdMã€‚ ç¨‹åºå’ŒæŠ€æœ¯æ‰‹æ®µ-ä»åŸºç¡€åˆ°IdM</a></li>
<li><a href="../zh-CN412689/index.html">é¢„æµ‹æ€§ITåˆ†æç®€åŒ–äº†åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºç›‘è§†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>