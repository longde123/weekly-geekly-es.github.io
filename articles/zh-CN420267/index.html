<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœ‹ğŸ½ ğŸ¥š ğŸ’ƒ æ¸¸æˆ0 ADçš„ä½œè€…-åšå¾—å¥½ ğŸ”‚ ğŸ¤šğŸ¼ ğŸ‘¼ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="0 ADæ˜¯ç”±å¿—æ„¿è€…ç¤¾åŒºå¼€å‘çš„å®æ—¶å†å²ç­–ç•¥ç±»å‹çš„ä¸‰ç»´æ¸¸æˆã€‚ ä»£ç åº“çš„å¤§å°å¾ˆå°ï¼Œå› æ­¤æˆ‘å†³å®šå°†æ¸¸æˆä¸å¤§å‹é¡¹ç›®ï¼ˆä¾‹å¦‚Androidå’ŒXNU Kernelï¼‰åˆ†å¼€æ£€æŸ¥ã€‚ å› æ­¤ï¼Œæ‘†åœ¨æˆ‘ä»¬é¢å‰çš„æ˜¯ä¸€ä¸ªåŒ…å«165,000è¡ŒC ++ä»£ç çš„é¡¹ç›®ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨PVS-Studioé™æ€åˆ†æå™¨å¯ä»¥å‘ç°çš„æœ‰è¶£ä¹‹å¤„ã€‚ 

 0...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æ¸¸æˆ0 ADçš„ä½œè€…-åšå¾—å¥½</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/420267/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c5/b41/bfb/6c5b41bfb68b23ef10d61f6ecd1a6665.png" alt="PVS-Studioå’Œ0 A.D."></div><br>  0 ADæ˜¯ç”±å¿—æ„¿è€…ç¤¾åŒºå¼€å‘çš„å®æ—¶å†å²ç­–ç•¥ç±»å‹çš„ä¸‰ç»´æ¸¸æˆã€‚ ä»£ç åº“çš„å¤§å°å¾ˆå°ï¼Œå› æ­¤æˆ‘å†³å®šå°†æ¸¸æˆä¸å¤§å‹é¡¹ç›®ï¼ˆä¾‹å¦‚Androidå’ŒXNU Kernelï¼‰åˆ†å¼€æ£€æŸ¥ã€‚ å› æ­¤ï¼Œæ‘†åœ¨æˆ‘ä»¬é¢å‰çš„æ˜¯ä¸€ä¸ªåŒ…å«165,000è¡ŒC ++ä»£ç çš„é¡¹ç›®ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹ä½¿ç”¨PVS-Studioé™æ€åˆ†æå™¨å¯ä»¥å‘ç°çš„æœ‰è¶£ä¹‹å¤„ã€‚ <br><a name="habracut"></a><br><h2>  0å…¬å…ƒ </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AD 0</a> ï¼ˆA.D.ï¼‰æ˜¯ä¸€æ¬¾å®æ—¶çš„å†å²ç­–ç•¥ç±»å‹çš„å…è´¹ä¸‰ç»´æ¸¸æˆï¼Œç”±ä¸€ä¸ªå¿—æ„¿è€…ç¤¾åŒºï¼ˆä¸»è¦å¼€å‘è€…è”åˆåœ¨Wildfireæ¸¸æˆå›¢é˜Ÿä¸­ï¼‰å¼€å‘ã€‚ è¯¥æ¸¸æˆå…è®¸æ‚¨æ§åˆ¶å­˜åœ¨äºå…¬å…ƒå‰500å¹´çš„æ–‡æ˜ã€‚  eã€‚â€”å…¬å…ƒå‰1å¹´ã€‚  eã€‚ æˆªè‡³2018å¹´å¤å­£ï¼Œè¯¥é¡¹ç›®ä¸ºAlphaç‰ˆæœ¬ã€‚  [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æè¿°</a>å–è‡ªç»´åŸºç™¾ç§‘]ã€‚ <br><br> ä¸ºä»€ä¹ˆæ­£å¥½æ˜¯0 ADï¼Ÿ <br><br> æˆ‘è¯·<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Egor Bredikhin</a> ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">EgorBredikhin</a> ï¼‰çš„åŒäº‹é€‰æ‹©å¹¶æ£€æŸ¥äº†ä¸€äº›å°å‹çš„å¼€æ”¾é¡¹ç›®ï¼Œæˆ‘å¯ä»¥ç”¨å®ƒå®Œæˆå…¶ä»–ä»»åŠ¡ã€‚ ä»–ç»™æˆ‘å‘é€äº†ä¸€ä¸ª0 ADé¡¹ç›®çš„æ—¥å¿—ï¼Œé—®é¢˜æ˜¯ï¼šâ€œä¸ºä»€ä¹ˆè¦è¿™ä¸ªé¡¹ç›®ï¼Ÿâ€  -æœ‰ä¸€ä¸ªç­”æ¡ˆï¼šâ€œæ˜¯çš„ï¼Œæˆ‘åˆšåˆšç©äº†è¿™ä¸ªæ¸¸æˆï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®æ—¶ç­–ç•¥ã€‚â€ å¥½çš„ï¼Œé‚£å°†æ˜¯0 AD :)ã€‚ <br><br><h2> è¯¯å·®å¯†åº¦ </h2><br> æˆ‘è¦èµæ‰¬0 ADçš„ä½œè€…çš„C ++ä»£ç çš„é«˜è´¨é‡ã€‚ åšå¾—å¥½ï¼Œæ‚¨å¾ˆå°‘ä¼šé‡åˆ°å¦‚æ­¤ä½çš„é”™è¯¯å¯†åº¦ã€‚ å½“ç„¶ï¼Œè¿™äº›å¹¶éå…¨éƒ¨é”™è¯¯ï¼Œè€Œæ˜¯å¯ä»¥ä½¿ç”¨PVS-Studioæ£€æµ‹åˆ°çš„é‚£äº›é”™è¯¯ã€‚ å°±åƒæˆ‘è¯´çš„é‚£æ ·ï¼Œå°½ç®¡PVS-Studioå¹¶æ²¡æœ‰å‘ç°æ‰€æœ‰é”™è¯¯ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ”¾å¿ƒåœ°è®¨è®ºé”™è¯¯çš„å¯†åº¦ä¸æ•´ä½“ä»£ç è´¨é‡ä¹‹é—´çš„å…³ç³»ã€‚ <br><br> ä¸€äº›æ•°å­—ã€‚ éç©ºä»£ç è¡Œçš„æ€»æ•°ä¸º231270ã€‚å…¶ä¸­ï¼Œæ³¨é‡Šå 28.7ï¼…ã€‚ æ€»å…±æœ‰165,000è¡Œçº¯C ++ä»£ç ã€‚ <br><br> åˆ†æå™¨å‘å‡ºçš„æ¶ˆæ¯æ•°é‡å¾ˆå°‘ï¼ŒæŸ¥çœ‹äº†æ‰€æœ‰æ¶ˆæ¯åï¼Œæˆ‘å†™å‡ºäº†19ä¸ªé”™è¯¯ã€‚ æˆ‘å°†åœ¨æœ¬æ–‡åé¢è€ƒè™‘æ‰€æœ‰è¿™äº›é”™è¯¯ã€‚ å¯èƒ½æˆ‘é”™è¿‡äº†ä¸€äº›ä¸œè¥¿ï¼Œè®¤ä¸ºè¯¥é”™è¯¯æ˜¯æ— å®³çš„è‰ç‡ä»£ç ã€‚ ä½†æ˜¯ï¼Œé€šå¸¸ï¼Œè¿™ä¸ä¼šæ”¹å˜å›¾ç‰‡ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘åœ¨165,000è¡Œä»£ç ä¸­å‘ç°äº†19ä¸ªé”™è¯¯ã€‚ æˆ‘ä»¬è®¡ç®—è¯¯å·®å¯†åº¦ï¼š19 * 1000/165000 = 0.115ã€‚ <br><br> ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å››èˆäº”å…¥å¹¶å‡è®¾PVS-Studioåˆ†æå™¨åœ¨æ¸¸æˆä»£ç ä¸­æ¯1000è¡Œä»£ç æ£€æµ‹åˆ°0.1ä¸ªé”™è¯¯ã€‚ <br><br> å¥½ç»“æœï¼ ä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œåœ¨æœ€è¿‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ‰å…³Androidçš„æ–‡ç« ä¸­ï¼Œ</a>æˆ‘è®¡ç®—å‡ºæ¯1000è¡Œä»£ç è‡³å°‘æ£€æµ‹åˆ°0.25ä¸ªé”™è¯¯ã€‚ å®é™…ä¸Šï¼Œé”™è¯¯çš„å¯†åº¦ç”šè‡³æ›´å¤§ï¼Œæˆ‘åªæ˜¯æ²¡æœ‰å‘ç°ä»”ç»†åˆ†ææ•´ä¸ªæŠ¥å‘Šçš„èƒ½åŠ›ã€‚ <br><br> æˆ–ä»¥EFLæ ¸å¿ƒåº“ä¸ºä¾‹ï¼Œæˆ‘ä»”ç»†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç ”ç©¶</a>å¹¶è®¡ç®—äº†ç¼ºé™·æ•°ã€‚ åœ¨å…¶ä¸­ï¼ŒPVS-Studioæ¯1000è¡Œä»£ç æ£€æµ‹åˆ°0.71ä¸ªé”™è¯¯ã€‚ <br><br> å› æ­¤ï¼Œ0 ADçš„ä½œè€…æ˜¯å¥½ä¼™ä¼´ï¼Œä½†æ˜¯ï¼Œä¸ºäº†å…¬å¹³èµ·è§ï¼Œåº”æ³¨æ„çš„æ˜¯ï¼Œç”¨C ++ç¼–å†™çš„å°‘é‡ä»£ç å¯¹ä»–ä»¬æœ‰å¸®åŠ©ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œé¡¹ç›®è¶Šå¤§ï¼Œå…¶å¤æ‚æ€§å¢é•¿å¾—è¶Šå¿«ï¼Œå¹¶ä¸”é”™è¯¯å¯†åº¦éçº¿æ€§åœ°å¢åŠ ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ›´å¤š</a> ï¼‰ã€‚ <br><br><h2> å¤±è¯¯ </h2><br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æˆ‘åœ¨æ¸¸æˆä¸­å‘ç°çš„19ä¸ªé”™è¯¯ã€‚ ä¸ºäº†åˆ†æè¯¥é¡¹ç›®ï¼Œæˆ‘ä½¿ç”¨äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio</a>ç‰ˆæœ¬6.24ã€‚ æˆ‘å»ºè®®æ‚¨å°è¯•ä¸‹è½½æ¼”ç¤ºç‰ˆæœ¬å¹¶æ£€æŸ¥æ‚¨æ­£åœ¨å¤„ç†çš„é¡¹ç›®ã€‚ <br><br>  <b>æ³¨æ„äº‹é¡¹</b> æˆ‘ä»¬å°†PVS-Studioå®šä½ä¸ºB2Bè§£å†³æ–¹æ¡ˆã€‚ å¯¹äºå°å‹é¡¹ç›®å’Œä¸ªäººå¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå…è´¹çš„è®¸å¯è¯é€‰é¡¹ï¼šâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¦‚ä½•å…è´¹ä½¿ç”¨PVS-Studio</a> â€ã€‚ <br><br>  <b>é”™è¯¯N1</b> <br><br> è®©æˆ‘ä»¬ä»ä¸€ä¸ªå¤æ‚çš„é”™è¯¯å¼€å§‹ã€‚ å®é™…ä¸Šï¼Œå®ƒå¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯æ‚¨å¿…é¡»ç†Ÿæ‚‰ç›¸å½“å¤§çš„ä¸€æ®µä»£ç ã€‚ <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> WaterManager::CreateWaveMeshes() { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nbNeighb = <span class="hljs-number"><span class="hljs-number">0</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> found = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; nbNeighb = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> p = <span class="hljs-number"><span class="hljs-number">0</span></span>; p &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; ++p) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (CoastalPointsSet.count(xx+around[p][<span class="hljs-number"><span class="hljs-number">0</span></span>] + (yy + around[p][<span class="hljs-number"><span class="hljs-number">1</span></span>])*SideSize)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (nbNeighb &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>) { CoastalPointsSet.erase(xx + yy*SideSize); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } ++nbNeighb; <span class="hljs-comment"><span class="hljs-comment">// We've found a new point around us. // Move there xx = xx + around[p][0]; yy = yy + around[p][1]; indexx = xx + yy*SideSize; if (i == 0) Chain.push_back(CoastalPoint(indexx,CVector2D(xx*2,yy*2))); else Chain.push_front(CoastalPoint(indexx,CVector2D(xx*2,yy*2))); CoastalPointsSet.erase(xx + yy*SideSize); found = true; break; } } if (!found) endedChain = true; .... }</span></span></code> </pre> <br>  PVS-Studio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è­¦å‘Š</a> ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V547</a> CWE-570è¡¨è¾¾å¼'nbNeighb&gt; = 2'å§‹ç»ˆä¸ºfalseã€‚ æ°´ç®¡ç†å™¨.cpp 581 <br><br> ä¹ä¸€çœ‹ï¼Œåˆ†æå™¨æ¶ˆæ¯ä¼¼ä¹å¾ˆå¥‡æ€ªã€‚ ä¸ºä»€ä¹ˆæ¡ä»¶<i>nbNeighb&gt; = 2</i>å§‹ç»ˆä¸ºå‡ï¼Ÿ å®é™…ä¸Šï¼Œåœ¨å¾ªç¯çš„ä¸»ä½“ä¸­ï¼Œå˜é‡<i>nbNeighb</i>çš„å¢é‡æ˜¯ï¼ <br><br> çœ‹ä¸‹é¢ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ª<i>break</i>è¯­å¥ï¼Œè¯¥è¯­å¥ä¸­æ–­å¾ªç¯çš„æ‰§è¡Œã€‚ å› æ­¤ï¼Œå¦‚æœå¢åŠ å˜é‡<i>nbNeighb</i> ï¼Œåˆ™å¾ªç¯å°†åœæ­¢ã€‚ å› æ­¤ï¼Œå˜é‡<i>nbNeighb</i>çš„å€¼å°†æ°¸è¿œä¸ä¼šè¾¾åˆ°å¤§äº1çš„å€¼ã€‚ <br><br> è¯¥ä»£ç æ˜¾ç„¶åŒ…å«æŸç§é€»è¾‘é”™è¯¯ã€‚ <br><br>  <b>é”™è¯¯N2</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> CmpRallyPointRenderer::MergeVisibilitySegments( <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">deque</span></span>&lt;SVisibilitySegment&gt;&amp; segments) { .... segments.erase(segments.end()); .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V783</a> CWE-119å¯èƒ½ä¼šå–æ¶ˆå¼•ç”¨æ— æ•ˆçš„è¿­ä»£å™¨â€œ segments.endï¼ˆï¼‰â€ã€‚  CCmpRallyPointRenderer.cpp 1290 <br><br> éå¸¸éå¸¸å¥‡æ€ªçš„ä»£ç ã€‚ ä¹Ÿè®¸ç¨‹åºå‘˜å¸Œæœ›ä»å®¹å™¨ä¸­åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç åº”å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cpp hljs">segments.erase(segments.end() - <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br> è™½ç„¶ï¼Œè¿™æ ·å†™èµ·æ¥ä¼šæ›´å®¹æ˜“ï¼š <br><br><pre> <code class="cpp hljs">segments.pop_back();</code> </pre> <br> è€å®è¯´ï¼Œæˆ‘ç›®å‰è¿˜ä¸å¤ªæ¸…æ¥šåº”è¯¥åœ¨è¿™é‡Œå†™ä»€ä¹ˆã€‚ <br><br>  <b>é”™è¯¯N3ï¼ŒN4</b> <br><br> æˆ‘å†³å®šä¸€èµ·è€ƒè™‘ä¸¤ä¸ªé”™è¯¯ï¼Œå› ä¸ºå®ƒä»¬ä¸èµ„æºæ³„æ¼æœ‰å…³ï¼Œå¹¶ä¸”éœ€è¦é¦–å…ˆæ˜¾ç¤º<i>WARN_RETURN</i>å®<i>æ˜¯</i>ä»€ä¹ˆã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> WARN_RETURN(status)\ do\ {\ DEBUG_WARN_ERR(status);\ return status;\ }\ while(0)</span></span></code> </pre> <br> å› æ­¤ï¼Œå¦‚æ‚¨æ‰€è§ï¼Œ <i>WARN_RETURN</i>å®ä½¿å‡½æ•°é€€å‡ºä¸»ä½“ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä½¿ç”¨æ­¤å®çš„ä¸æ­£ç¡®æ–¹æ³•ã€‚ <br><br> ç¬¬ä¸€ä¸ªç‰‡æ®µã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Status </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sys_generate_random_bytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(u8* buf, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> count)</span></span></span><span class="hljs-function"> </span></span>{ FILE* f = fopen(<span class="hljs-string"><span class="hljs-string">"/dev/urandom"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!f) WARN_RETURN(ERR::FAIL); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (count) { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> numread = fread(buf, <span class="hljs-number"><span class="hljs-number">1</span></span>, count, f); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numread == <span class="hljs-number"><span class="hljs-number">0</span></span>) WARN_RETURN(ERR::FAIL); buf += numread; count -= numread; } fclose(f); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> INFO::OK; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V773</a> CWE-401åœ¨ä¸é‡Šæ”¾'f'æ‰‹æŸ„çš„æƒ…å†µä¸‹é€€å‡ºäº†è¯¥åŠŸèƒ½ã€‚ èµ„æºæ³„æ¼æ˜¯å¯èƒ½çš„ã€‚  unix.cpp 332 <br><br> å¦‚æœ<i>fread</i>å‡½æ•°æ— æ³•è¯»å–æ•°æ®ï¼Œåˆ™<i>sys_generate_random_bytes</i>å‡½æ•°å°†é€€å‡ºè€Œä¸é‡Šæ”¾æ–‡ä»¶æè¿°ç¬¦ã€‚ å®é™…ä¸Šï¼Œè¿™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚ ä»¤äººæ€€ç–‘çš„æ˜¯ï¼Œæ‚¨å°†æ— æ³•ä»â€œ / dev / urandomâ€è¯»å–æ•°æ®ã€‚ ä½†æ˜¯ï¼Œä»£ç å¾ˆè‰ç‡ã€‚ <br><br> ç¬¬äºŒä¸ªç‰‡æ®µã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Status </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sys_cursor_create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... sys_cursor_impl* impl = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> sys_cursor_impl; impl-&gt;image = image; impl-&gt;cursor = XcursorImageLoadCursor(wminfo.info.x11.display, image); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(impl-&gt;cursor == None) WARN_RETURN(ERR::FAIL); *cursor = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;sys_cursor&gt;(impl); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> INFO::OK; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼šV773 CWE-401åœ¨ä¸é‡Šæ”¾â€œ implâ€æŒ‡é’ˆçš„æƒ…å†µä¸‹é€€å‡ºäº†è¯¥åŠŸèƒ½ã€‚ å¯èƒ½å‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ ç¬¬421ç«  <br><br> å¦‚æœæ¸¸æ ‡æ— æ³•åŠ è½½ï¼Œåˆ™ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ <br><br>  <b>é”™è¯¯N5</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Status </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadHeightmapImageOs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;u8&gt; fileData = <span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;u8&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> u8[fileSize]); .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V554</a> CWE-762é”™è¯¯ä½¿ç”¨äº†shared_ptrã€‚ åˆ†é…ç»™'new []'çš„å†…å­˜å°†ä½¿ç”¨'delete'æ¸…é™¤ã€‚  MapIO.cpp 54 <br><br> æ­£ç¡®çš„é€‰é¡¹ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;u8[]&gt; fileData = <span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;u8&gt;(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> u8[fileSize]);</code> </pre> <br>  <b>é”™è¯¯N6</b> <br><br><pre> <code class="cpp hljs">FUTrackedPtr(ObjectClass* _ptr = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) : ptr(_ptr) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) FUTracker::TrackObject((FUTrackable*) ptr); ptr = ptr; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V570</a>ä¸ºå…¶è‡ªèº«åˆ†é…äº†â€œ ptrâ€å˜é‡ã€‚  FUTracker.h 122 <br><br>  <b>é”™è¯¯N7ï¼ŒN8</b> <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::wstring TraceEntry::EncodeAsText() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span> action = (<span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span>)m_action; <span class="hljs-keyword"><span class="hljs-keyword">wchar_t</span></span> buf[<span class="hljs-number"><span class="hljs-number">1000</span></span>]; swprintf_s(buf, ARRAY_SIZE(buf), <span class="hljs-string"><span class="hljs-string">L"%#010f: %c \"%ls\" %lu\n"</span></span>, m_timestamp, action, m_pathname.<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>().c_str(), (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>)m_size); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> buf; }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V576</a> CWE-628æ ¼å¼é”™è¯¯ã€‚ è€ƒè™‘æ£€æŸ¥â€œ swprintf_sâ€å‡½æ•°çš„ç¬¬äº”ä¸ªå®é™…å‚æ•°ã€‚  charç±»å‹å‚æ•°æ˜¯é¢„æœŸçš„ã€‚  trace.cpp 93 <br><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é‡åˆ°äº†Visual C ++ä¸­<i>swprintf</i>å‡½æ•°çš„æ›¿ä»£å®ç°çš„å›°æƒ‘å’Œæ¨¡ç³Šçš„å†å²ã€‚ æˆ‘ä¸ä¼š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é‡è¿°</a> ï¼Œä½†æ˜¯è¯·å‚è€ƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V576</a>è¯Šæ–­ç¨‹åºçš„æ–‡æ¡£ï¼ˆè¯·å‚é˜…â€œå®½çº¿â€éƒ¨åˆ†ï¼‰ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¾ˆå¯èƒ½è¯¥ä»£ç åœ¨Windowsçš„Visual C ++ä¸­ç¼–è¯‘æ—¶å°†æ­£ç¡®è¿è¡Œï¼Œè€Œåœ¨Linuxæˆ–macOSä¸Šè¿›è¡Œç¼–è¯‘æ—¶å°†ä¸æ­£ç¡®ã€‚ <br><br> ç±»ä¼¼é”™è¯¯ï¼šV576 CWE-628æ ¼å¼é”™è¯¯ã€‚ è€ƒè™‘æ£€æŸ¥â€œ swprintf_sâ€å‡½æ•°çš„ç¬¬å››ä¸ªå®é™…å‚æ•°ã€‚  charç±»å‹å‚æ•°æ˜¯é¢„æœŸçš„ã€‚  vfs_tree.cpp 211 <br><br>  <b>é”™è¯¯N9ï¼ŒN10ï¼ŒN11</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»å…¸ç‰ˆ</a> é¦–å…ˆï¼Œä½¿ç”¨æŒ‡é’ˆï¼Œç„¶åæ‰æ£€æŸ¥æŒ‡é’ˆã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TEST_CAT2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* dst, ....)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">strcpy</span></span>(dst, dst_val); <span class="hljs-comment"><span class="hljs-comment">// &lt;= int ret = strcat_s(dst, max_dst_chars, src); TS_ASSERT_EQUALS(ret, expected_ret); if(dst != 0) // &lt;= TS_ASSERT(!strcmp(dst, expected_dst)); }</span></span></code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V595</a> CWE-476åœ¨é’ˆå¯¹nullptrè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'dst'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š140ï¼Œ143ã€‚test_secure_crt.h 140 <br><br> æˆ‘è®¤ä¸ºè¯¥é”™è¯¯ä¸éœ€è¦è§£é‡Šã€‚ ç±»ä¼¼è­¦å‘Šï¼š <br><br><ul><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptrå¯¹å…¶è¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'dst'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š150ï¼Œ153ã€‚test_secure_crt.h 150 </li><li>  V595 CWE-476åœ¨é’ˆå¯¹nullptrå¯¹å…¶è¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨äº†'dst'æŒ‡é’ˆã€‚ æ£€æŸ¥è¡Œï¼š314ã€317ã€‚test_secure_crt.h 314 </li></ul><br>  <b>é”™è¯¯N12</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tbool; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MikkTSpace::setTSpace(...., <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tbool bIsOrientationPreserving, ....) { .... m_NewVertices.push_back(bIsOrientationPreserving &gt; <span class="hljs-number"><span class="hljs-number">0.5</span></span> ? <span class="hljs-number"><span class="hljs-number">1.0f</span></span> : (<span class="hljs-number"><span class="hljs-number">-1.0f</span></span>)); .... }</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V674</a> CWE-682å°†'double'ç±»å‹çš„'0.5'æ–‡å­—ä¸'int'ç±»å‹çš„å€¼è¿›è¡Œæ¯”è¾ƒã€‚ è€ƒè™‘æ£€æŸ¥â€œ bIsOrientationPreserving&gt; 0.5â€è¡¨è¾¾å¼ã€‚ ç¬¬137ç«  <br><br> æ¯”è¾ƒç±»å‹ä¸º<i>int</i>çš„å˜é‡å’Œå¸¸é‡ä¸º0.5æ¯«æ— æ„ä¹‰ã€‚ æ­¤å¤–ï¼Œå°±å«ä¹‰è€Œè¨€ï¼Œè¿™é€šå¸¸æ˜¯å¸ƒå°”ç±»å‹çš„å˜é‡ï¼Œè¿™æ„å‘³ç€å°†å…¶ä¸0.5è¿›è¡Œæ¯”è¾ƒçœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚ å‡å®šæ­¤å¤„åº”ä½¿ç”¨<i>bssOrientationPreserving</i>ä»£æ›¿å¦ä¸€ä¸ªå˜é‡ã€‚ <br><br>  <b>é”™è¯¯N13</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> Status </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReplaceFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> VfsPath&amp; pathname, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">shared_ptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;u8&gt;&amp; fileContents, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>{ ScopedLock s; VfsDirectory* directory; VfsFile* file; Status st; st = vfs_Lookup(pathname, &amp;m_rootDirectory, directory, &amp;file, VFS_LOOKUP_ADD|VFS_LOOKUP_CREATE); <span class="hljs-comment"><span class="hljs-comment">// There is no such file, create it. if (st == ERR::VFS_FILE_NOT_FOUND) { s.~ScopedLock(); return CreateFile(pathname, fileContents, size); } .... }</span></span></code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V749</a> CWE-675ç¦»å¼€å¯¹è±¡èŒƒå›´åï¼Œå°†å†æ¬¡è°ƒç”¨â€œ sâ€å¯¹è±¡çš„ææ„å‡½æ•°ã€‚  vfs.cpp 165 <br><br> åœ¨åˆ›å»ºæ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»ä½¿<i>ScopedLock</i>ç±»å‹çš„å¯¹è±¡â€œè§£é”â€å¯¹è±¡ã€‚ ä¸ºæ­¤ï¼Œæ˜¾å¼è°ƒç”¨ææ„å‡½æ•°ã€‚ é—®é¢˜æ˜¯å½“å‡½æ•°é€€å‡ºæ—¶ï¼Œ <i>s</i>å¯¹è±¡çš„ææ„å‡½æ•°å°†å†æ¬¡è¢«è‡ªåŠ¨è°ƒç”¨ã€‚ å³ ææ„å‡½æ•°å°†è¢«è°ƒç”¨ä¸¤æ¬¡ã€‚ æˆ‘å°šæœªç ”ç©¶<i>ScopedLock</i>ç±»çš„è®¾å¤‡ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œæ‚¨éƒ½ä¸åº”è¿™æ ·åšã€‚ é€šå¸¸ï¼Œå¯¹ææ„å‡½æ•°çš„è¿™ç§åŒé‡è°ƒç”¨ä¼šå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºæˆ–å…¶ä»–ä¸æ„‰å¿«çš„é”™è¯¯ã€‚ å³ä½¿ä»£ç ç°åœ¨å·¥ä½œæ­£å¸¸ï¼Œé€šè¿‡æ›´æ”¹<i>ScopedLock</i>ç±»çš„å®ç°ä¹Ÿå¾ˆå®¹æ˜“ç ´åæ‰€æœ‰å†…å®¹ã€‚ <br><br>  <b>é”™è¯¯N14ï¼ŒN15ï¼ŒN16ï¼ŒN17</b> <br><br><pre> <code class="cpp hljs">CFsmEvent* CFsm::AddEvent( <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> eventType ) { .... pEvent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CFsmEvent( eventType ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !pEvent ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; .... }</code> </pre> <br>  PVS-Studioè­¦å‘Šï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V668</a> CWE-570æ²¡æœ‰é’ˆå¯¹ç©ºæµ‹è¯•'pEvent'æŒ‡é’ˆçš„æ„ä¹‰ï¼Œå› ä¸ºä½¿ç”¨'new'è¿ç®—ç¬¦åˆ†é…äº†å†…å­˜ã€‚ å¦‚æœå†…å­˜åˆ†é…é”™è¯¯ï¼Œå°†ç”Ÿæˆå¼‚å¸¸ã€‚  fsm.cpp 259 <br><br> æ£€æŸ¥æŒ‡é’ˆæ²¡æœ‰æ„ä¹‰ï¼Œå› ä¸ºåœ¨å‘ç”Ÿå†…å­˜åˆ†é…é”™è¯¯çš„æƒ…å†µä¸‹ï¼Œå°†<i>å¼•å‘</i>å¼‚å¸¸<i>std :: bad_alloc</i> ã€‚ <br><br> å› æ­¤ï¼Œæ£€æŸ¥æ˜¯å¤šä½™çš„ï¼Œä½†é”™è¯¯å¹¶ä¸ä¸¥é‡ã€‚ ä½†æ˜¯ï¼Œ <i>å¦‚æœ</i>åœ¨<i>ifè¯­å¥</i>çš„ä¸»ä½“ä¸­æ‰§è¡ŒæŸäº›é€»è¾‘ï¼Œåˆ™ä¸€åˆ‡éƒ½ä¼šå˜å¾—æ›´åŠ ç³Ÿç³•ã€‚ è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š <br><br><pre> <code class="cpp hljs">CFsmTransition* CFsm::AddTransition(....) { .... CFsmEvent* pEvent = AddEvent( eventType ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !pEvent ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Create new transition CFsmTransition* pNewTransition = new CFsmTransition( state ); if ( !pNewTransition ) { delete pEvent; return NULL; } .... }</span></span></code> </pre> <br> åˆ†æå™¨è­¦å‘Šï¼šV668 CWE-570æ²¡æœ‰é’ˆå¯¹ç©ºæµ‹è¯•'pNewTransition'æŒ‡é’ˆçš„æ„ä¹‰ï¼Œå› ä¸ºä½¿ç”¨'new'è¿ç®—ç¬¦åˆ†é…äº†å†…å­˜ã€‚ å¦‚æœå†…å­˜åˆ†é…é”™è¯¯ï¼Œå°†ç”Ÿæˆå¼‚å¸¸ã€‚  fsm.cpp 289 <br><br> è¯•å›¾é‡Šæ”¾å…¶åœ°å€å­˜å‚¨åœ¨<i>pEvent</i>æŒ‡é’ˆä¸­çš„<i>å†…å­˜</i> ã€‚ è‡ªç„¶ï¼Œè¿™ä¸ä¼šå‘ç”Ÿï¼Œå¹¶ä¸”ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ <br><br> å®é™…ä¸Šï¼Œå½“æˆ‘å¼€å§‹å¤„ç†è¿™æ®µä»£ç æ—¶ï¼Œç»“æœå‘ç°ä¸€åˆ‡éƒ½å˜å¾—æ›´åŠ å¤æ‚ï¼Œä¹Ÿè®¸ä¸æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œè€Œæ˜¯ä¸¤ä¸ªé”™è¯¯ã€‚ ç°åœ¨ï¼Œæˆ‘å°†è§£é‡Šè¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç†Ÿæ‚‰<i>AddEvent</i>å‡½æ•°è®¾å¤‡ã€‚ <br><br><pre> <code class="cpp hljs">CFsmEvent* CFsm::AddEvent( <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> eventType ) { CFsmEvent* pEvent = <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-comment"><span class="hljs-comment">// Lookup event by type EventMap::iterator it = m_Events.find( eventType ); if ( it != m_Events.end() ) { pEvent = it-&gt;second; } else { pEvent = new CFsmEvent( eventType ); if ( !pEvent ) return NULL; // Store new event into internal map m_Events[ eventType ] = pEvent; } return pEvent; }</span></span></code> </pre> <br> è¯·æ³¨æ„ï¼Œè¯¥å‡½æ•°å¹¶ä¸æ€»æ˜¯è¿”å›æŒ‡å‘ä½¿ç”¨<i>new</i>è¿ç®—ç¬¦åˆ›å»ºçš„æ–°å¯¹è±¡çš„æŒ‡é’ˆã€‚ æœ‰æ—¶ï¼Œå®ƒä»<i>m_Events</i>å®¹å™¨ä¸­è·å–ä¸€ä¸ªç°æœ‰å¯¹è±¡ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒæŒ‡å‘æ–°åˆ›å»ºå¯¹è±¡çš„æŒ‡é’ˆä¹Ÿå°†æ”¾ç½®åœ¨<i>m_Eventsä¸­</i> ã€‚ <br><br> é—®é¢˜å°±å‡ºç°äº†ï¼šè°æ‹¥æœ‰å¹¶åº”é”€æ¯å…¶æŒ‡é’ˆå­˜å‚¨åœ¨<i>m_Events</i>å®¹å™¨ä¸­çš„<i>å¯¹è±¡</i> ï¼Ÿ æˆ‘å¯¹è¿™ä¸ªé¡¹ç›®ä¸ç†Ÿæ‚‰ï¼Œä½†æ˜¯å¾ˆå¯èƒ½æ˜¯æŸä¸ªåœ°æ–¹çš„ä»£ç ç ´åäº†æ‰€æœ‰è¿™äº›å¯¹è±¡ã€‚ ç„¶åï¼Œåœ¨<i>CFsm :: AddTransitionå‡½æ•°</i>å†…éƒ¨åˆ é™¤å¯¹è±¡é€šå¸¸<i>æ˜¯</i>å¤šä½™çš„ã€‚ <br><br> æˆ‘çš„å°è±¡æ˜¯ï¼Œæ‚¨å¯ä»¥ç®€å•åœ°åˆ é™¤ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !pNewTransition ) { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> pEvent; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; }</code> </pre> <br> å…¶ä»–é”™è¯¯ï¼š <br><br><ul><li>  V668 CWE-571å¯¹â€œ retâ€æŒ‡é’ˆé’ˆå¯¹nullè¿›è¡Œæµ‹è¯•æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºä½¿ç”¨â€œ newâ€è¿ç®—ç¬¦åˆ†é…äº†å†…å­˜ã€‚ å¦‚æœå†…å­˜åˆ†é…é”™è¯¯ï¼Œå°†ç”Ÿæˆå¼‚å¸¸ã€‚  TerrainTextureEntry.cpp 120 </li><li>  V668 CWE-571æ²¡æœ‰å¿…è¦é’ˆå¯¹ç©ºå€¼æµ‹è¯•â€œç­”æ¡ˆâ€æŒ‡é’ˆï¼Œå› ä¸ºä½¿ç”¨â€œæ–°â€è¿ç®—ç¬¦åˆ†é…äº†å†…å­˜ã€‚ å¦‚æœå†…å­˜åˆ†é…é”™è¯¯ï¼Œå°†ç”Ÿæˆå¼‚å¸¸ã€‚ å£°éŸ³ç®¡ç†å™¨.cpp 542 </li></ul><br>  <b>é”™è¯¯N18ï¼ŒN19</b> <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dir_scan_callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struct de *de, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dir_scan_data</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dsd</span></span></span><span class="hljs-class"> = (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dir_scan_data</span></span></span><span class="hljs-class"> *) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dsd-&gt;entries == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> || dsd-&gt;num_entries &gt;= dsd-&gt;arr_size) { dsd-&gt;arr_size *= <span class="hljs-number"><span class="hljs-number">2</span></span>; dsd-&gt;entries = (struct de *) <span class="hljs-built_in"><span class="hljs-built_in">realloc</span></span>(dsd-&gt;entries, dsd-&gt;arr_size * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(dsd-&gt;entries[<span class="hljs-number"><span class="hljs-number">0</span></span>])); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dsd-&gt;entries == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// TODO(lsm): propagate an error to the caller dsd-&gt;num_entries = 0; } else { dsd-&gt;entries[dsd-&gt;num_entries].file_name = mg_strdup(de-&gt;file_name); dsd-&gt;entries[dsd-&gt;num_entries].st = de-&gt;st; dsd-&gt;entries[dsd-&gt;num_entries].conn = de-&gt;conn; dsd-&gt;num_entries++; } }</span></span></code> </pre> <br>  PVS-Studio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è­¦å‘Š</a> ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V701</a> CWE-401 reallocï¼ˆï¼‰å¯èƒ½æ³„æ¼ï¼šå½“reallocï¼ˆï¼‰åˆ†é…å†…å­˜å¤±è´¥æ—¶ï¼ŒåŸå§‹æŒ‡é’ˆâ€œ dsd-&gt;æ¡ç›®â€ä¸¢å¤±ã€‚ è€ƒè™‘å°†reallocï¼ˆï¼‰åˆ†é…ç»™ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆã€‚  mongoose.cpp 2462 <br><br> å¦‚æœæ•°ç»„çš„å¤§å°ä¸è¶³ï¼Œåˆ™ä½¿ç”¨<i>realloc</i>å‡½æ•°åˆ†é…å†…å­˜ã€‚ é”™è¯¯æ˜¯æŒ‡å‘åŸå§‹å†…å­˜å—çš„æŒ‡é’ˆçš„å€¼ç«‹å³è¢«<i>realloc</i>å‡½æ•°è¿”å›çš„æ–°å€¼è¦†ç›–ã€‚ <br><br> å¦‚æœå†…å­˜åˆ†é…å¤±è´¥ï¼Œåˆ™<i>realloc</i>å‡½æ•°å°†è¿”å›NULLï¼Œå¹¶å°†æ­¤NULLå†™å…¥<i>dsd-&gt; entrys</i>å˜é‡ã€‚ ä¹‹åï¼Œå°†ä¸å¯èƒ½é‡Šæ”¾å…¶åœ°å€å…ˆå‰å­˜å‚¨åœ¨<i>dsd-&gt; entryä¸­</i>çš„å†…å­˜å—ã€‚ å°†ä¼šå‘ç”Ÿå†…å­˜æ³„æ¼ã€‚ <br><br> å¦ä¸€ä¸ªé”™è¯¯ï¼šV701 CWE-401 reallocï¼ˆï¼‰å¯èƒ½æ³„æ¼ï¼šå½“reallocï¼ˆï¼‰åˆ†é…å†…å­˜å¤±è´¥æ—¶ï¼ŒåŸå§‹æŒ‡é’ˆâ€œ Bufferâ€ä¸¢å¤±ã€‚ è€ƒè™‘å°†reallocï¼ˆï¼‰åˆ†é…ç»™ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆã€‚  Preprocessor.cpp 84 <br><br><h2> ç»“è®º </h2><br> æˆ‘ä¸èƒ½è¯´è¿™ä¸€æ¬¡è¿™ç¯‡æ–‡ç« å¼•äººå…¥èƒœï¼Œæˆ–è€…æˆ‘è®¾æ³•è¡¨ç°å‡ºè®¸å¤šå¯æ€•çš„é”™è¯¯ã€‚ ä¸€æ¬¡æ— éœ€æ‰§è¡Œä»»ä½•æ“ä½œã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘æ‰€çœ‹åˆ°çš„ï¼Œç„¶åæˆ‘å†™</a> ã€‚ <br><br> è°¢è°¢æ‚¨çš„å…³æ³¨ã€‚ è¦è¿›è¡Œæ›´æ”¹ï¼Œæˆ‘å°†åœ¨é‚€è¯·ç»“æŸæ—¶åœ¨Instagram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@pvs_studio_unicorn</a>å’ŒTwitter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Code_Analysis</a>ä¸Šå…³æ³¨æˆ‘ã€‚ <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br> å¦‚æœæ‚¨æƒ³ä¸è¯´è‹±è¯­çš„è¯»è€…åˆ†äº«è¿™ç¯‡æ–‡ç« ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥ï¼šAndrey Karpovã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¹²å¾—å¥½ï¼Œæ¸¸æˆçš„ä½œè€…0 ADï¼</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN420267/">https://habr.com/ru/post/zh-CN420267/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN420257/index.html">æ‚¨ä»ç„¶å®‰è£…Windows 2008å—ï¼Ÿ æˆ‘ä¹Ÿæ˜¯ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ</a></li>
<li><a href="../zh-CN420259/index.html">æ–°åŠ å¡è€åŒ–è¯Šæ–­å°ç»„</a></li>
<li><a href="../zh-CN420261/index.html">æˆ‘ä»¬å°†è¡¡é‡ä»€ä¹ˆï¼Ÿ å¦‚ä½•ä¸ºä¸šåŠ¡ä»»åŠ¡é€‰æ‹©æ­£ç¡®çš„MLæŒ‡æ ‡</a></li>
<li><a href="../zh-CN420263/index.html">æœåŠ¡ç°åœ¨çš„ä¼šè®®â€œ Knowledge18â€</a></li>
<li><a href="../zh-CN420265/index.html">æˆ‘ä»¬ä¸çŸ¥é“çš„ä¸ƒä¸ªScrumå®æ–½é—®é¢˜</a></li>
<li><a href="../zh-CN420269/index.html">èµ„é‡‘æµå¤±ï¼šä¸ºä»€ä¹ˆæ‚¨çš„åç½‘ç»œé’“é±¼ç¨‹åºæ— æ³•æ£€æµ‹åˆ°ç½‘ç»œé’“é±¼ç«™ç‚¹ï¼Œä»¥åŠæ•°æ®ç§‘å­¦å¦‚ä½•ä½¿å…¶èµ·ä½œç”¨ï¼Ÿ</a></li>
<li><a href="../zh-CN420271/index.html">ç§»æƒ…è®­ç»ƒï¼šé€šè¿‡è§†é¢‘æ¸¸æˆåˆºæ¿€å¤§è„‘ç¥ç»è¿æ¥</a></li>
<li><a href="../zh-CN420273/index.html">é•¿é€”å®¢è½¦çš„å®‰æ’æ–¹å¼</a></li>
<li><a href="../zh-CN420275/index.html">2018-2019å¹´æœ‰å…³ç‰©è”ç½‘çš„ä¸»è¦ä¼šè®®ã€‚ ä¿„ç½—æ–¯ä¸ä¸–ç•Œ</a></li>
<li><a href="../zh-CN420277/index.html">æ·˜é‡‘çƒ­ä¹‹åï¼šåŒºå—é“¾æŠ€æœ¯çš„å‰æ™¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>