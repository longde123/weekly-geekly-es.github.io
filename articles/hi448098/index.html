<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯзЭЁЯП╗ ЁЯРО ЁЯСиЁЯП╜тАНЁЯдЭтАНЁЯСиЁЯП╝ GHIDRA, Playstation 1 рдирд┐рд╖реНрдкрд╛рджрдирдпреЛрдЧреНрдп, FLIRT рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдФрд░ PsyQ ЁЯзЭЁЯП┐ ЁЯТ╣ ЁЯзТ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░ 





 рдореБрдЭреЗ рдЖрдкрдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рд╣рдореЗрд╢рд╛ рдкреБрд░рд╛рдиреЗ рдХрдВрд╕реЛрд▓ рдЧреЗрдо рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдЯреЙрдХ рдореЗрдВ рдПрдХ рдбрд┐рдХрдВрдкрд╛рдЗрд▓рд░ рднреА рдерд╛ред рдФ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GHIDRA, Playstation 1 рдирд┐рд╖реНрдкрд╛рджрдирдпреЛрдЧреНрдп, FLIRT рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдФрд░ PsyQ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448098/"><p>  рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░ </p><br><p><img src="https://habrastorage.org/webt/er/4d/30/er4d30mv0sfltitbawtcyvprbsq.jpeg"></p><br><p> рдореБрдЭреЗ рдЖрдкрдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдВ рд╣рдореЗрд╢рд╛ рдкреБрд░рд╛рдиреЗ рдХрдВрд╕реЛрд▓ рдЧреЗрдо рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛, рдЬрд┐рд╕рдореЗрдВ рд╕реНрдЯреЙрдХ рдореЗрдВ рдПрдХ рдбрд┐рдХрдВрдкрд╛рдЗрд▓рд░ рднреА рдерд╛ред  рдФрд░ рдЕрдм, рдореЗрд░реЗ рдЬреАрд╡рди рдореЗрдВ рдпрд╣ рдЦреБрд╢реА рдХрд╛ рдХреНрд╖рдг рдЖрдпрд╛ рд╣реИ - <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">GHIDRA рд╕рд╛рдордиреЗ</a></strong> рдЖрдпрд╛ рд╣реИред  рдореИрдВрдиреЗ рдпрд╣ рдирд╣реАрдВ рд▓рд┐рдЦрд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рд╣реИ, рдЖрдк рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдЧреВрдЧрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдФрд░, рд╕рдореАрдХреНрд╖рд╛рдПрдВ рдЗрддрдиреА рднрд┐рдиреНрди рд╣реИрдВ (рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рдЧрд╛рдореА рд╕реЗ) рдХрд┐ рдЗрд╕ рдЪрдорддреНрдХрд╛рд░ рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд░рдирд╛ рдПрдХ рдирд╡рд╛рдЧрдВрддреБрдХ рдХреЗ рд▓рд┐рдП рднреА рдореБрд╢реНрдХрд┐рд▓ рд╣реЛрдЧрд╛ ... рдпрд╣рд╛рдВ рдЖрдкрдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ: " <em>рдореИрдВрдиреЗ 20 рд╡рд░реНрд╖реЛрдВ рддрдХ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд┐рдпрд╛, рдФрд░ рдореИрдВ рдЖрдкрдХреЗ рд╣рд╛рдЗрдбреНрд░рд╛ рдХреЛ рдмрдбрд╝реЗ рдЕрд╡рд┐рд╢реНрд╡рд╛рд╕ рдХреЗ рд╕рд╛рде рджреЗрдЦрддрд╛ рд╣реВрдВ, рдХреНрдпреЛрдВрдХрд┐ рдПрдирдПрд╕рдПред рд▓реЗрдХрд┐рди рдЬрдм- рдореИрдВ рдЗрд╕реЗ рдЪрд▓рд╛рдКрдВрдЧрд╛ рдФрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ рдЗрд╕рдХреА рдЬрд╛рдВрдЪ рдХрд░реВрдВрдЧрд╛</em> ред " <a name="habracut"></a></p><br><p>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ - рд╣рд╛рдЗрдбреНрд░рд╛ рдХреЛ рдЪрд▓рд╛рдирд╛ рдбрд░рд╛рд╡рдирд╛ рдирд╣реАрдВ рд╣реИред  рдФрд░ рд▓реЙрдиреНрдЪ рдХреЗ рдмрд╛рдж рд╣рдореЗрдВ рдЬреЛ рднреА рдорд┐рд▓реЗрдЧрд╛, рд╡рд╣ рдЖрдкрдХреЗ рд╕рднреА рдбрд░ рдХреЛ рдмреБрдХрдорд╛рд░реНрдХ-рдФрд░-рдмреИрдХрд╕реНрдЯреЗрдб рд╕рд░реНрд╡рд╡реНрдпрд╛рдкреА рдПрдирдПрд╕рдП рд╕реЗ рд░реЛрдХ рджреЗрдЧрд╛ред </p><br><p>  рддреЛ, рдореИрдВ рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣рд╛ рд╣реВрдВ ... рдРрд╕рд╛ рдПрдХ рдЙрдкрд╕рд░реНрдЧ рд╣реИ: <em>рд╕реЛрдиреА рдкреНрд▓реЗрд╕реНрдЯреЗрд╢рди 1</em> ( <em>рдкреАрдПрд╕</em> <em>1</em> , <em>рдкреАрдПрд╕рдПрдХреНрд╕</em> , <em>рдХрд░реНрд▓рд┐рдВрдЧ рдЖрдпрд░рди</em> )ред  рдЗрд╕рдХреЗ рд▓рд┐рдП рдХрдИ рд╢рд╛рдВрдд рдЦреЗрд▓ рдмрдирд╛рдП рдЧрдП рдереЗ, рдлреНрд░реЗрдВрдЪрд╛рдЗрдЬрд┐рдпреЛрдВ рдХрд╛ рдПрдХ рдЭреБрдВрдб рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ рдЬреЛ рдЕрднреА рднреА рд▓реЛрдХрдкреНрд░рд┐рдп рд╣реИрдВред  рдФрд░ рдПрдХ рджрд┐рди рдореИрдВ рдпрд╣ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рд╡реЗ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ: рдбреЗрдЯрд╛ рдкреНрд░рд╛рд░реВрдк рдХреНрдпрд╛ рд╣реИрдВ, рдХреНрдпрд╛ рд╕рдВрд╕рд╛рдзрди рд╕рдВрдкреАрдбрд╝рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреБрдЫ рд░реВрд╕реА рдореЗрдВ рдЕрдиреБрд╡рд╛рдж рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ (рдореИрдВ рддреБрд░рдВрдд рдХрд╣реВрдВрдЧрд╛ рдХрд┐ рдореИрдВрдиреЗ рдЕрднреА рддрдХ рдХрд┐рд╕реА рднреА рдЧреЗрдо рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ)ред </p><br><p> рдореИрдВрдиреЗ <code>Delphi</code> рдкрд░ рдПрдХ рджреЛрд╕реНрдд рдХреЗ рд╕рд╛рде <code>TIM</code> рдкреНрд░рд╛рд░реВрдк рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╢рд╛рдВрдд рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд▓рд┐рдЦрдХрд░ рд╢реБрд░реВ рдХрд┐рдпрд╛ (рдпрд╣ рдкреНрд▓реЗрд╕реНрдЯреЗрд╢рди рд╡рд░реНрд▓реНрдб рд╕реЗ <code>BMP</code> рдЬреИрд╕рд╛ рдХреБрдЫ рд╣реИ): <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯрд┐рдо</a></strong> 2 <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реНрдпреВ</a></strong> ред  рдПрдХ рд╕рдордп рдореЗрдВ, рд╕рдлрд▓рддрд╛ рдХрд╛ рдЖрдирдВрдж рд▓рд┐рдпрд╛ (рдФрд░ рд╢рд╛рдпрдж рдЕрдм рдЖрдирдВрдж рдорд┐рд▓рддрд╛ рд╣реИ)ред  рддрдм рдореИрдВ рдЧрд╣рд░рд╛рдИ рдореЗрдВ рдЬрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/95a/82d/ad5/95a82dad5e8cf1770315215ac1cb138e.png" alt="рдЫрд╡рд┐"></p><br><p>  рдФрд░ рдлрд┐рд░ рд╕рдорд╕реНрдпрд╛рдПрдВ рд╢реБрд░реВ рд╣реБрдИрдВред  рдореИрдВ рддрдм <code>MIPS</code> рдкрд░рд┐рдЪрд┐рдд рдирд╣реАрдВ рдерд╛ред  рдкрдврд╝рд╛рдИ рдореЗрдВ рд▓рдЧ рдЧрдПред  рдореИрдВ рдпрд╛ рддреЛ <code>IDA Pro</code> рдкрд░рд┐рдЪрд┐рдд рдирд╣реАрдВ рдерд╛ (рдореИрдВ <code>Playstation</code> рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╛рдж рдореЗрдВ <code>Sega Mega Drive</code> рдкрд░ рдЧреЗрдо рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдпрд╛ рдерд╛)ред  рд▓реЗрдХрд┐рди, рдЗрдВрдЯрд░рдиреЗрдЯ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдореБрдЭреЗ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ <code>IDA Pro</code> <code>PS1</code> рдбрд╛рдЙрдирд▓реЛрдб рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ: <strong>PS-X EXE рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╛рдЗрд▓реЗрдВ</strong> ред  рдореИрдВрдиреЗ рдПрдХ рдЕрдЬреАрдм рдирд╛рдо рдФрд░ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рдХреЗ рд╕рд╛рде рдПрдХ рдЧреЗрдо рдлрд╝рд╛рдЗрд▓ (рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡реЗ <strong>Lemmings</strong> рдереЗ) рдХреЛ рдЕрдкрд▓реЛрдб рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдЬреИрд╕реЗ рдХрд┐ Ida рдореЗрдВ <code>SLUS_123.45</code> , рдореБрдЭреЗ рдХреЛрдбрд╛рдВрддрд░рдХ рдХреЛрдб рдХреА рд▓рд╛рдЗрдиреЛрдВ рдХрд╛ рдПрдХ рдЧреБрдЪреНрдЫрд╛ рдорд┐рд▓рд╛ (рд╕реМрднрд╛рдЧреНрдп рд╕реЗ, рдореБрдЭреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкрддрд╛ рдерд╛ рдХрд┐ рдпрд╣ рдХреНрдпрд╛ рдерд╛, рд╡рд┐рдВрдбреЛрдЬ рдПрдХреНрд╕-рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЗ рддрд╣рдд рдзрдиреНрдпрд╡рд╛рджред x86), рдФрд░ рд╕рдордЭрдирд╛ рд╢реБрд░реВ рдХрд┐рдпрд╛ред </p><br><p><img src="https://habrastorage.org/webt/d8/d5/81/d8d581oddbuzq95aw7nyebedpzw.png"></p><br><p>  рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реА рдореБрд╢реНрдХрд┐рд▓ рдЬрдЧрд╣ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд▓рд╛рдЗрди рдереАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк рдХрд┐рд╕реА рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рджреЗрдЦрддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рдХреЗ рддреБрд░рдВрдд рдмрд╛рдж рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ рдкреИрд░рд╛рдореАрдЯрд░ рдЬрд┐рд╕реЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдХрд┐рд╕реА рднреА рдХреВрджрдиреЗ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЬрдВрдк / рдХреЙрд▓ рдХреЗ рдмрд╛рдж рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЙрд╕рдХреЗ рдмрд╛рдж рд╣реА рдХреЙрд▓ рдпрд╛ рдЬрдВрдк рд╕реНрд╡рдпрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдореИрдВ рдЬрд┐рди рднреА рдХрдард┐рдирд╛рдЗрдпреЛрдВ рд╕реЗ рдЧреБрдЬрд╝рд░рд╛, рдЙрд╕рдХреЗ рдмрд╛рдж рдореИрдВрдиреЗ рдЦреЗрд▓ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЗ рдХрдИ рдкреИрдХрд░реНрд╕ / рдЕрдирдкреИрдХрд░реНрд╕ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рдХрд╛рдордпрд╛рдмреА рд╣рд╛рд╕рд┐рд▓ рдХреАред  рд▓реЗрдХрд┐рди рдореИрдВрдиреЗ рдХрднреА рднреА рдХреЛрдб рдХрд╛ рдЕрдзреНрдпрдпрди рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИред  рдХреНрдпреЛрдВ?  рдареАрдХ рд╣реИ, рд╕рдм рдХреБрдЫ рд╕рд╛рдорд╛рдиреНрдп рд╣реИ: рдмрд╣реБрдд рд╕рд╛рд░реЗ рдХреЛрдб рдереЗ, BIOS рддрдХ рдкрд╣реБрдВрдЪ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдЬреЛ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рдордЭрдирд╛ рдЕрд╕рдВрднрд╡ рдерд╛ (рд╡реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдереЗ, рдФрд░ рдлрд┐рд░ рдореЗрд░реЗ рдкрд╛рд╕ рдПрд╕рдбреАрдХреЗ рдХреЗ рд▓рд┐рдП рдХрд░реНрд▓рд┐рдВрдЧ рдирд╣реАрдВ рд╣реИ), рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рддреАрди рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдирд┐рд░реНрджреЗрд╢, рдПрдХ рдбрд┐рдХрдореНрдкреЙрдЗрд▓рд░ рдХреА рдХрдореАред </p><br><p>  рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХрдИ рд╕рд╛рд▓реЛрдВ рдХреЗ рдмрд╛рдж, <code>GHIDRA</code> рд╕рд╛рдордиреЗ рдЖрддрд╛ <code>GHIDRA</code> ред  рдбрд┐рдХрдореНрдкреЙрдЗрд▓рд░ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рдмреАрдЪ <code>MIPS</code> ред  рд╣реЗ рдЖрдирдВрдж!  рдЪрд▓реЛ рдХреБрдЫ рдЬрд▓реНрдж рд╣реА рд╡рд┐рдШрдЯрд┐рдд рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ!  рд▓реЗрдХрд┐рди ... рдореИрдВ рдПрдХ рдмрдореНрдорд░ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рдерд╛ред  <code>PS-X EXE</code> рд╣рд╛рдЗрдбреНрд░рд╛ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ <code>PS-X EXE</code> ред  рдХреЛрдИ рдмрд╛рдд рдирд╣реАрдВ, рдЕрдкрдирд╛ рд▓рд┐рдЦреЛ! </p><br><h2 id="sobstvenno-kod">  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреЛрдб </h2><br><p>  рдкрд░реНрдпрд╛рдкреНрдд рдЧреАрддрд╛рддреНрдордХ рд╡рд┐рд╖рдпрд╛рдВрддрд░, рдЪрд▓реЛ рдХреЛрдб рд▓рд┐рдЦрддреЗ рд╣реИрдВред  <code>Ghidra</code> рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдбрд╛рдЙрдирд▓реЛрдбрд░реНрд╕ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ, рдореБрдЭреЗ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкрддрд╛ рдерд╛ рдХрд┐ рдореИрдВрдиреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрд╣рд▓реЗ</a> рдХреНрдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдЦрд╛ рдерд╛</a> ред  рдЗрд╕рд▓рд┐рдП, рдпрд╣ рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рдХрд░реНрд▓рд┐рдВрдЧ рд▓реЛрд╣реЗ рдХреЗ <em>рдореЗрдореЛрд░реА рдореИрдк</em> рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИ, рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХреЗ рдкрддреЗ рдФрд░, рдЖрдк рдмрд╛рдпрдиреЗрд░рд┐рдЬрд╝ рдХреЛ рдЗрдХрдЯреНрдард╛ рдФрд░ рд▓реЛрдб рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЬрд▓реНрджреА рд╕реЗ рдирд╣реАрдВ рдХрд╣рд╛ред </p><br><p>  рдХреЛрдб рддреИрдпрд╛рд░ рдерд╛, рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдФрд░ рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЛ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛ рдФрд░ рдорд╛рдиреНрдпрддрд╛ рджреА рдЧрдИ рдереА, рд▓реЗрдХрд┐рди рдЕрднреА рднреА рдЙрди рдЬрдЧрд╣реЛрдВ рдкрд░ рдПрдХ рдмрдбрд╝рд╛ рдЦрд╛рд▓реА рд╕реНрдерд╛рди рдерд╛ рдЬрд╣рд╛рдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛рд░реНрдпреЛрдВ рдФрд░ BIOS рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред  рдФрд░, рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рд╣рд╛рдЗрдбреНрд░рд╛ рдХреЗ рдкрд╛рд╕ <code>FLIRT</code> рд╕рдорд░реНрдерди рдирд╣реАрдВ рдерд╛ред  рдпрджрд┐ рдирд╣реАрдВ, рддреЛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </p><br><p>  <code>FLIRT</code> рд╣рд╕реНрддрд╛рдХреНрд╖рд░реЛрдВ рдХрд╛ рдкреНрд░рд╛рд░реВрдк <code>pat.txt</code> рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЬрд╛рдирд╛ рдФрд░ рд╡рд░реНрдгрд┐рдд рд╣реИ, рдЬрд┐рд╕реЗ Ida SDK рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЗрдбрд╛ рдХреЗ рдкрд╛рд╕ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ <code>Playstation</code> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдлрд╝рд╛рдЗрд▓реЛрдВ рд╕реЗ рдпреЗ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ: <code>ppsx</code> ред  рдореИрдВрдиреЗ <code>PsyQ Playstation Development Kit</code> рдирд╛рдордХ <code>PsyQ Playstation Development Kit</code> рд▓рд┐рдП SDK рдбрд╛рдЙрдирд▓реЛрдб рдХрд┐рдпрд╛, рд╡рд╣рд╛рдВ рдкрд░ рдХрд╛рдо рдХреА рдлрд╛рдЗрд▓реЗрдВ рдорд┐рд▓реАрдВ рдФрд░ рдЙрдирдореЗрдВ рд╕реЗ рдХрдо рд╕реЗ рдХрдо рдХреБрдЫ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдмрдирд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА - рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХред  рдпрд╣ рдПрдХ рдЫреЛрдЯрд╛ рдкрд╛рда рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдХрд╛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рд╛рд░реВрдк рд╣реЛрддрд╛ рд╣реИред  рдпрд╣ рдХреЛрдб рд▓рд┐рдЦрдирд╛ рд╢реЗрд╖ рд╣реИ рдЬреЛ рдЗрди рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░реЗрдЧрд╛, рдФрд░ рдЙрдиреНрд╣реЗрдВ рдХреЛрдб рдкрд░ рд▓рд╛рдЧреВ рдХрд░реЗрдЧрд╛ред </p><br><p><img src="https://habrastorage.org/webt/kw/0a/kc/kw0akcnlzbiwjctarj1h4axq8ri.png"></p><br><h3 id="patparser">  PatParser </h3><br><p>  рдЪреВрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рд╛рд░реВрдк рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдПрдХ рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рд▓рд┐рдЦрдирд╛ рддрд░реНрдХрд╕рдВрдЧрдд рд╣реЛрдЧрд╛ред  рдпрд╣ рдЗрд╕ рддрд░рд╣ рдирд┐рдХрд▓рд╛: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pattern linePat = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"^((?:[0-9A-F\\.]{2})+) ([0-9A-F]{2}) ([0-9A-F]{4}) ([0-9A-F]{4}) ((?:[:\\^][0-9A-F]{4}@? [\\.\\w]+ )+)((?:[0-9A-F\\.]{2})+)?$"</span></span>);</code> </pre> <br><p>  рдареАрдХ рд╣реИ, рддреЛ рдСрдлрд╕реЗрдЯ, рдкреНрд░рдХрд╛рд░ рдФрд░ рдлрд╝рдВрдХреНрд╢рди рдирд╛рдо рдХреЗ рд▓рд┐рдП рдЕрд▓рдЧ рд╕реЗ рдореЙрдбреНрдпреВрд▓ рдХреА рд╕реВрдЪреА рдореЗрдВ, рд╣рдо рдПрдХ рдЕрд▓рдЧ regexp рд▓рд┐рдЦрддреЗ рд╣реИрдВ: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pattern modulePat = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"([:\\^][0-9A-F]{4}@?) ([\\.\\w]+) "</span></span>);</code> </pre> <br><p>  рдЕрдм рдкреНрд░рддреНрдпреЗрдХ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХреЗ рдШрдЯрдХреЛрдВ рдХреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд░рддреЗ рд╣реИрдВ: </p><br><ol><li>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдмрд╛рдЗрдЯреНрд╕ ( <em>0-9A-F</em> ) рдХрд╛ рд╣реЗрдХреНрд╕ рдЕрдиреБрдХреНрд░рдо рдЖрддрд╛ рд╣реИ, рдЬрд╣рд╛рдБ рдЙрдирдореЗрдВ рд╕реЗ рдХреБрдЫ рднреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ (рдбреЙрдЯ рдХреИрд░реЗрдХреНрдЯрд░ "ред")ред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдПрдХ рдРрд╕рд╛ рд╡рд░реНрдЧ рдмрдирд╛рддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛ред  рдореИрдВрдиреЗ рдЗрд╕реЗ <code>MaskedBytes</code> рдХрд╣рд╛: </li></ol><br><div class="spoiler">  <b class="spoiler_title">MaskedBytes.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MaskedBytes</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes, masks; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getBytes() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] getMasks() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> masks; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bytes.length; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MaskedBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] masks)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bytes = bytes; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.masks = masks; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes src, MaskedBytes add)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> extend(src, add.getBytes(), add.getMasks()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes src, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] addBytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] addMasks)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = src.getBytes().length; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] tmpBytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[length + addBytes.length]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] tmpMasks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[length + addMasks.length]; System.arraycopy(src.getBytes(), <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpBytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, length); System.arraycopy(addBytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpBytes, length, addBytes.length); System.arraycopy(src.getMasks(), <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpMasks, <span class="hljs-number"><span class="hljs-number">0</span></span>, length); System.arraycopy(addMasks, <span class="hljs-number"><span class="hljs-number">0</span></span>, tmpMasks, length, addMasks.length); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MaskedBytes(tmpBytes, tmpMasks); } }</code> </pre> </div></div><br><ol><li>  рдЙрд╕ рдЦрдВрдб рдХреА рд▓рдВрдмрд╛рдИ рдЬрд╣рд╛рдВ рд╕реЗ <code>CRC16</code> рдХреА рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИред </li><li>  <code>CRC16</code> , рдЬреЛ рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдмрд╣реБрдкрдж ( <code>0x8408</code> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: </li></ol><br><div class="spoiler">  <b class="spoiler_title">рдЧрд┐рдирддреА рдХреЛрдб CRC16</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkCrc16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] bytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> resCrc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( bytes.length == <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crc = <span class="hljs-number"><span class="hljs-number">0xFFFF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; bytes.length; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = bytes[i]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; ++x) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((crc ^ a) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) != <span class="hljs-number"><span class="hljs-number">0</span></span>) { crc = (crc &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) ^ <span class="hljs-number"><span class="hljs-number">0x8408</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { crc &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; } a &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; } } crc = ~crc; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = crc; crc = (crc &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | ((x &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>); crc &amp;= <span class="hljs-number"><span class="hljs-number">0xFFFF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)crc == resCrc; }</code> </pre> </div></div><br><ol><li>  рдмрд╛рдЗрдЯреНрд╕ рдореЗрдВ "рдореЙрдбреНрдпреВрд▓" рдХреА рдХреБрд▓ рд▓рдВрдмрд╛рдИред </li><li>  рд╡реИрд╢реНрд╡рд┐рдХ рдирд╛рдореЛрдВ рдХреА рд╕реВрдЪреА (рд╣рдореЗрдВ рдХреНрдпрд╛ рдЪрд╛рд╣рд┐рдП) </li><li>  рдЕрдиреНрдп рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдВрдХ рдХреА рд╕реВрдЪреА (рднреА рдЖрд╡рд╢реНрдпрдХ)ред </li><li>  рдЯреЗрд▓ рдмрд╛рдЗрдЯреНрд╕ред </li></ol><br><p>  рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдирд╛рдо рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреНрд░рдХрд╛рд░ рд╣реИ рдФрд░ рд╢реБрд░реБрдЖрдд рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдСрдлрд╕реЗрдЯ рд╣реИред  рдПрдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╕рдВрдХреЗрдд рд╡рд░реНрдгреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рджрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ ::, ^, @, рдкреНрд░рдХрд╛рд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ: </p><br><ul><li>  " <strong>: NAME</strong> ": рд╡реИрд╢реНрд╡рд┐рдХ рдирд╛рдоред  рдпрд╣ рдРрд╕реЗ рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП рдерд╛ рдХрд┐ рдореИрдВрдиреЗ рд╕рдм рдХреБрдЫ рд╢реБрд░реВ рдХрд┐рдпрд╛; </li><li>  " <strong>: NAME @</strong> ": рд╕реНрдерд╛рдиреАрдп рдирд╛рдо / рд▓реЗрдмрд▓ред  рдпрд╣ рд╕рдВрдХреЗрдд рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд░рд╣рдиреЗ рджреЛ; </li><li>  " <strong>^ NAME</strong> ": рдирд╛рдо рдХрд╛ рд▓рд┐рдВрдХред </li></ul><br><p>  рдПрдХ рддрд░рдл, рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд▓рд┐рдВрдХ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╕рдВрджрд░реНрдн рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ (рдФрд░, рддрджрдиреБрд╕рд╛рд░, рдХреВрдж рд░рд┐рд╢реНрддреЗрджрд╛рд░ рд╣реЛрдЧрд╛), рд▓реЗрдХрд┐рди рдПрдХ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХреЗ рд▓рд┐рдПред  рдХреНрдпрд╛, рдЖрдк рдХрд╣рддреЗ рд╣реИрдВ, рд╕рдорд╕реНрдпрд╛ рд╣реИ?  рдФрд░ рдпрд╣ рд╣реИ рдХрд┐ PSX рдореЗрдВ рдЖрдк рдПрдХ рдирд┐рд░реНрджреЗрд╢ рдХреЗ рд╕рд╛рде рдкреВрд░реЗ <code>DWORD</code> рдХреЛ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рдзрдХреЗрд▓ рдирд╣реАрдВ рд╕рдХрддреЗред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐, <code>MIPS</code> рдЕрдиреБрджреЗрд╢ рдЖрдХрд╛рд░ рдЪрд╛рд░ рдмрд╛рдЗрдЯреНрд╕ рддрдХ рд╕реАрдорд┐рдд рд╣реИред  рдФрд░, рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рдПрдХ рдирд┐рд░реНрджреЗрд╢ рд╕реЗ рдПрдХ рдЖрдзрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЕрдЧрд▓реЗ рдХреЛ рдЕрд▓рдЧ рдХрд░реЗрдВ - рдФрд░ рджреВрд╕рд░рд╛ рдЖрдзрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред  рд▓реЗрдХрд┐рди рдЗрддрдирд╛ рд╕рд░рд▓ рдирд╣реАрдВ рд╣реИред  рдкрд╣рд▓реА рдЫрдорд╛рд╣реА рдХреЛ 5 рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рд▓рд┐рдВрдХ рдЗрд╕рдХреА рджреВрд╕рд░реА рдЫрдорд╛рд╣реА рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж рд╣реА рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдореБрдЭреЗ рдПрдХ рдкрд░рд┐рд╖реНрдХреГрдд рдкрд╛рд░реНрд╕рд░ рд▓рд┐рдЦрдирд╛ рдерд╛ (рд╢рд╛рдпрдж рдЗрд╕реЗ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)ред </p><br><p>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рддреАрди рдкреНрд░рдХрд╛рд░ рдХреЗ рдирд╛рдореЛрдВ рдХреЗ рд▓рд┐рдП <code>enum</code> рдмрдирд╛рддреЗ рд╣реИрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">ModuleType.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> ModuleType { GLOBAL_NAME, LOCAL_NAME, REF_NAME; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isGlobal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == GLOBAL_NAME; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isLocal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == LOCAL_NAME; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isReference</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == REF_NAME; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isGlobal()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Global"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isLocal()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Local"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Reference"</span></span>; } } }</code> </pre> </div></div><br><p>  рдЖрдЗрдП рдПрдХ рдХреЛрдб рд▓рд┐рдЦреЗрдВ рдЬреЛ рдкрд╛рда рд╣реЗрдХреНрд╕рд╛рдбреЗрд╕рд┐рдорд▓ рдЕрдиреБрдХреНрд░рдо рдФрд░ рдбреЙрдЯреНрд╕ рдХреЛ <code>MaskedBytes</code> рдЯрд╛рдЗрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>MaskedBytes</code> : </p><br><div class="spoiler">  <b class="spoiler_title">hexStringToMaskedBytesArray ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hexStringToMaskedBytesArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ MaskedBytes res = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> len = s.length(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[len / <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] masks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[len / <span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; len; i += <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c1 = s.charAt(i); <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c2 = s.charAt(i + <span class="hljs-number"><span class="hljs-number">1</span></span>); masks[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) ( (((c1 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : <span class="hljs-number"><span class="hljs-number">0xF</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | (((c2 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : <span class="hljs-number"><span class="hljs-number">0xF</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) ); bytes[i / <span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) ( (((c1 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : Character.digit(c1, <span class="hljs-number"><span class="hljs-number">16</span></span>)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) | (((c2 == <span class="hljs-string"><span class="hljs-string">'.'</span></span>) ? <span class="hljs-number"><span class="hljs-number">0x0</span></span> : Character.digit(c2, <span class="hljs-number"><span class="hljs-number">16</span></span>)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) ); } res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MaskedBytes(bytes, masks); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre> </div></div><br><p>  рдЖрдк рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдПрдХ рд╡рд░реНрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛: рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдирд╛рдо, рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдСрдлрд╕реЗрдЯ рдФрд░ рдкреНрд░рдХрд╛рд░: </p><br><div class="spoiler">  <b class="spoiler_title">ModuleData.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ModuleData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> offset; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ModuleType type; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ModuleData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset, String name, ModuleType type)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.offset = offset; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.type = type; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOffset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> offset; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> ModuleType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> type; } }</code> </pre> </div></div><br><p>  рдФрд░, рдЕрдВрдд рдореЗрдВ: рдПрдХ рд╡рд░реНрдЧ рдЬреЛ рд╕рдм рдХреБрдЫ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░реЗрдЧрд╛ рдЬреЛ <code>pat</code> рдлрд╝рд╛рдЗрд▓ рдХреА рдкреНрд░рддреНрдпреЗрдХ рдкрдВрдХреНрддрд┐ рдкрд░ рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╡рд╣ рд╣реИ: рдмрд╛рдЗрдЯреНрд╕, рд╕реАрдЖрд░рд╕реА, рдСрдлрд╕реЗрдЯ рдХреЗ рд╕рд╛рде рдирд╛рдореЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА: </p><br><div class="spoiler">  <b class="spoiler_title">SignatureData.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> pat; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SignatureData</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> MaskedBytes templateBytes, tailBytes; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MaskedBytes fullBytes; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> crc16Length; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> crc16; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> moduleLength; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> List&lt;ModuleData&gt; modules; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SignatureData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MaskedBytes templateBytes, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> crc16Length, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">short</span></span></span></span><span class="hljs-function"><span class="hljs-params"> crc16, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> moduleLength, List&lt;ModuleData&gt; modules, MaskedBytes tailBytes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateBytes = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = templateBytes; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.crc16Length = crc16Length; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.crc16 = crc16; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.moduleLength = moduleLength; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.modules = modules; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tailBytes = tailBytes; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.tailBytes != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> addLength = moduleLength - templateBytes.getLength() - tailBytes.getLength(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] addBytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[addLength]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] addMasks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[addLength]; Arrays.fill(addBytes, (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0x00</span></span>); Arrays.fill(addMasks, (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0x00</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = MaskedBytes.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateBytes, addBytes, addMasks); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes = MaskedBytes.extend(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.fullBytes, tailBytes); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTemplateBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> templateBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTailBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tailBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MaskedBytes </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFullBytes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fullBytes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCrc16Length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crc16Length; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">short</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCrc16</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crc16; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getModuleLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> moduleLength; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;ModuleData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getModules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modules; } }</code> </pre> </div></div><br><p>  рдЕрдм рдореБрдЦреНрдп рдмрд╛рдд: рд╣рдо рдЗрди рд╕рднреА рд╡рд░реНрдЧреЛрдВ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рд▓рд┐рдЦрддреЗ рд╣реИрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">рдПрдХ рдкреИрдЯ рдлрд╝рд╛рдЗрд▓ рдХреА рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд▓реА рдЧрдИ</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;ModuleData&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseModuleData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;ModuleData&gt; res = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;ModuleData&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { Matcher m = modulePat.matcher(s); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (m.find()) { String __offset = m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>); ModuleType type = __offset.startsWith(<span class="hljs-string"><span class="hljs-string">":"</span></span>) ? ModuleType.GLOBAL_NAME : ModuleType.REF_NAME; type = (type == ModuleType.GLOBAL_NAME &amp;&amp; __offset.endsWith(<span class="hljs-string"><span class="hljs-string">"@"</span></span>)) ? ModuleType.LOCAL_NAME : type; String _offset = __offset.replaceAll(<span class="hljs-string"><span class="hljs-string">"[:^@]"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> offset = Integer.parseInt(_offset, <span class="hljs-number"><span class="hljs-number">16</span></span>); String name = m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>); res.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModuleData(offset, name, type)); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">рд╕рднреА рдкреИрдЯ рдлрд╝рд╛рдЗрд▓ рд▓рд╛рдЗрдиреЛрдВ рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; lines)</span></span></span><span class="hljs-function"> </span></span>{ modulesCount = <span class="hljs-number"><span class="hljs-number">0L</span></span>; signatures = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;SignatureData&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> linesCount = lines.size(); monitor.initialize(linesCount); monitor.setMessage(<span class="hljs-string"><span class="hljs-string">"Reading signatures..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; linesCount; ++i) { String line = lines.get(i); Matcher m = linePat.matcher(line); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.matches()) { MaskedBytes pp = hexStringToMaskedBytesArray(m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ll = Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> ssss = (<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> llll = Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-number"><span class="hljs-number">16</span></span>); List&lt;ModuleData&gt; modules = parseModuleData(m.group(<span class="hljs-number"><span class="hljs-number">5</span></span>)); MaskedBytes tail = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.group(<span class="hljs-number"><span class="hljs-number">6</span></span>) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { tail = hexStringToMaskedBytesArray(m.group(<span class="hljs-number"><span class="hljs-number">6</span></span>)); } signatures.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SignatureData(pp, ll, ssss, llll, modules, tail)); modulesCount += modules.size(); } monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> </div></div><br><p>  рдлрд╝рдВрдХреНрд╢рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдЬрд╣рд╛рдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рдорд╛рдиреНрдпрддрд╛ рджреА рдЧрдИ рдереА: </p><br><div class="spoiler">  <b class="spoiler_title">рдлрдВрдХреНрд╢рди рдХреНрд░рд┐рдПрд╢рди</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">disasmInstruction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, Address address)</span></span></span><span class="hljs-function"> </span></span>{ DisassembleCommand cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisassembleCommand(address, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); cmd.applyTo(program, TaskMonitor.DUMMY); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa, Address address, String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isFunction, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isEntryPoint, MessageLog log)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fpa.getInstructionAt(address) == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) disasmInstruction(program, address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFunction) { fpa.createFunction(address, name); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isEntryPoint) { fpa.addEntryPoint(address); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFunction &amp;&amp; program.getSymbolTable().hasSymbol(address)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } program.getSymbolTable().createLabel(address, name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { log.appendException(e); } }</code> </pre> </div></div><br><p>  рд╕рдмрд╕реЗ рдХрдард┐рди рдЬрдЧрд╣, рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХрд┐рд╕реА рдЕрдиреНрдп рдирд╛рдо / рдЪрд░ рдХреЗ рд▓рд┐рдВрдХ рдХреА рдЧрд┐рдирддреА рдХрд░ рд░рд╣рд╛ рд╣реИ (рд╢рд╛рдпрдж рдХреЛрдб рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ): </p><br><div class="spoiler">  <b class="spoiler_title">рд▓рд┐рдВрдХ рдЧрдгрдирд╛</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setInstrRefName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, FlatProgramAPI fpa, PseudoDisassembler ps, Address address, String name, MessageLog log)</span></span></span><span class="hljs-function"> </span></span>{ ReferenceManager refsMgr = program.getReferenceManager(); Reference[] refs = refsMgr.getReferencesFrom(address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { disasmInstruction(program, address); refs = refsMgr.getReferencesFrom(address); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { refs = refsMgr.getReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { refs = refsMgr.getFlowReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); Instruction instr = program.getListing().getInstructionAt(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { disasmInstruction(program, address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); instr = program.getListing().getInstructionAt(address.add(<span class="hljs-number"><span class="hljs-number">4</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } FlowType flowType = instr.getFlowType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; !(flowType.isJump() || flowType.isCall() || flowType.isTerminal())) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } refs = refsMgr.getReferencesFrom(address.add(<span class="hljs-number"><span class="hljs-number">8</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (refs.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } } } } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { program.getSymbolTable().createLabel(refs[<span class="hljs-number"><span class="hljs-number">0</span></span>].getToAddress(), name, SourceType.IMPORTED); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InvalidInputException e) { log.appendException(e); } }</code> </pre> </div></div><br><p>  рдФрд░, рдЕрдВрддрд┐рдо рд╕реНрдкрд░реНрд╢ - рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рд╛рдЧреВ рдХрд░реЗрдВ: </p><br><div class="spoiler">  <b class="spoiler_title">рдЖрд╡реЗрджрди ()</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applySignatures</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ByteProvider provider, Program program, Address imageBase, Address startAddr, Address endAddr, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ BinaryReader reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BinaryReader(provider, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); PseudoDisassembler ps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PseudoDisassembler(program); FlatProgramAPI fpa = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FlatProgramAPI(program); monitor.initialize(getAllModulesCount()); monitor.setMessage(<span class="hljs-string"><span class="hljs-string">"Applying signatures..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (SignatureData sig : signatures) { MaskedBytes fullBytes = sig.getFullBytes(); MaskedBytes tmpl = sig.getTemplateBytes(); Address addr = program.getMemory().findBytes(startAddr, endAddr, fullBytes.getBytes(), fullBytes.getMasks(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, TaskMonitor.DUMMY); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (addr == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { monitor.incrementProgress(sig.getModules().size()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } addr = addr.subtract(imageBase.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] nextBytes = reader.readByteArray(addr.getOffset() + tmpl.getLength(), sig.getCrc16Length()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!PatParser.checkCrc16(nextBytes, sig.getCrc16())) { monitor.incrementProgress(sig.getModules().size()); <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } addr = addr.add(imageBase.getOffset()); List&lt;ModuleData&gt; modules = sig.getModules(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ModuleData data : modules) { Address _addr = addr.add(data.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.getType().isGlobal()) { setFunction(program, fpa, _addr, data.getName(), data.getType().isGlobal(), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, log); } monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s function %s at 0x%08X"</span></span>, data.getType(), data.getName(), _addr.getOffset())); monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (ModuleData data : modules) { Address _addr = addr.add(data.getOffset()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.getType().isReference()) { setInstrRefName(program, fpa, ps, _addr, data.getName(), log); } monitor.setMessage(String.format(<span class="hljs-string"><span class="hljs-string">"%s function %s at 0x%08X"</span></span>, data.getType(), data.getName(), _addr.getOffset())); monitor.incrementProgress(<span class="hljs-number"><span class="hljs-number">1</span></span>); } } }</code> </pre> </div></div><br><p>  рдпрд╣рд╛рдВ рдЖрдк рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <code>findBytes()</code> ред  рдЗрд╕рдХреЗ рд╕рд╛рде, рдЖрдк рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд╡рд┐рд╢рд┐рд╖реНрдЯ рджреГрд╢реНрдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдмрд┐рдЯ рдорд╛рд╕реНрдХ рдХреЗ рд╕рд╛рдеред  рд╡рд┐рдзрд┐ рдХреЛ рдЗрд╕ рддрд░рд╣ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="java hljs">Address addr = program.getMemory().findBytes(startAddr, endAddr, bytes, masks, forward, TaskMonitor.DUMMY);</code> </pre> <br><p>  рдирддреАрдЬрддрди, рдЬрд┐рд╕ рдкрддреЗ рд╕реЗ рдмрд╛рдЗрдЯреНрд╕ рд╢реБрд░реВ рд╣реЛрддреА рд╣реИрдВ, рд╡рд╣ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╛ <code>null</code> ред </p><br><h2 id="pishem-analizator">  рдПрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд▓рд┐рдЦ рд░рд╣рд╛ рд╣реИ </h2><br><p>  рдЪрд▓реЛ рдЗрд╕реЗ рдЦреВрдмрд╕реВрд░рддреА рд╕реЗ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ рд╣рдо рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдпрд╣ рдЪрд░рдг рдЪреБрдирдиреЗ рджреЗрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЕрдкрдирд╛ рд╕реНрд╡рдпрдВ рдХрд╛ рдХреЛрдб рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд▓рд┐рдЦрдирд╛ рд╣реЛрдЧрд╛ (рдЖрдк рдЗрд╕ рд╕реВрдЪреА рдореЗрдВ рд▓реЛрдЧреЛрдВ рдХреЛ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ - рдпрд╣ рд╕рдм рд╡реЗ рд╣реИрдВ, рд╣рд╛рдБ): </p><br><p><img src="https://habrastorage.org/webt/1o/wv/je/1owvjea6nuytmkwksxrhy9anyak.png"></p><br><p>  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рд╕реВрдЪреА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <code>AbstractAnalyzer</code> рд╡рд░реНрдЧ рд╕реЗ рд╡рд╛рд░рд┐рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдХреБрдЫ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдУрд╡рд░рд░рд╛рдЗрдб рдХрд░рдирд╛ рд╣реЛрдЧрд╛: </p><br><ol><li>  рдбрд┐рдЬрд╛рдЗрдирд░ред  рдЗрд╕реЗ рдЖрдзрд╛рд░ рд╡рд░реНрдЧ рдХреЗ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛ рдирд╛рдо, рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдХреЗ рд╡рд┐рд╡рд░рдг рдФрд░ рдЗрд╕рдХреЗ рдкреНрд░рдХрд╛рд░ (рдмрд╛рдж рдореЗрдВ рдЙрд╕ рдкрд░ рдЕрдзрд┐рдХ) рдХреЗ рд╕рд╛рде рдХреЙрд▓ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдпрд╣ рдореБрдЭреЗ рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </li></ol><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PsxAnalyzer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(<span class="hljs-string"><span class="hljs-string">"PSYQ Signatures"</span></span>, <span class="hljs-string"><span class="hljs-string">"PSX signatures applier"</span></span>, AnalyzerType.INSTRUCTION_ANALYZER); }</code> </pre> <br><ol><li>  <code>getDefaultEnablement()</code> ред  рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╣рдорд╛рд░рд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд╣рдореЗрд╢рд╛ рдЙрдкрд▓рдмреНрдз рд╣реИ, рдпрд╛ рдХреЗрд╡рд▓ рдЕрдЧрд░ рдХреБрдЫ рд╢рд░реНрддреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рд╣рдорд╛рд░реЗ рд▓реЛрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред </li><li>  <code>canAnalyze()</code> ред  рдХреНрдпрд╛ рдПрдХ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдмрд╛рдЗрдирд░реА рдлрд╝рд╛рдЗрд▓ рдкрд░ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ? <br>  рдкреИрд░рд╛рдЧреНрд░рд╛рдл 2 рдФрд░ 3, рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ, рдПрдХ рдПрдХрд▓ рдлрд╝рдВрдХреНрд╢рди рджреНрд╡рд╛рд░рд╛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ: </li></ol><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isPsxLoader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> program.getExecutableFormat().equalsIgnoreCase(PsxLoader.PSX_LOADER); }</code> </pre> <br><p>  рдЬрд╣рд╛рдБ <code>PsxLoader.PSX_LOADER</code> рдмреВрдЯрд▓реЛрдбрд░ рдХрд╛ рдирд╛рдо рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдореЗрдВ рдкрд╣рд▓реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><p>  рдХреБрд▓, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣реИ: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDefaultEnablement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isPsxLoader(program); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">canAnalyze</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isPsxLoader(program); }</code> </pre> <br><ol><li>  <code>registerOptions()</code> ред  рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рднреА рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдХреБрдЫ рдкреВрдЫрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реЗ рдкрд╣рд▓реЗ рдкреИрдЯ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде, рддреЛ рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рдРрд╕рд╛ рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╣реИред  рд╣рдореЗрдВ рдорд┐рд▓рддрд╛ рд╣реИ: </li></ol><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String OPTION_NAME = <span class="hljs-string"><span class="hljs-string">"PSYQ PAT-File Path"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> File file = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerOptions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Options options, Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { file = Application.getModuleDataFile(<span class="hljs-string"><span class="hljs-string">"psyq4_7.pat"</span></span>).getFile(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException e) { } options.registerOption(OPTION_NAME, OptionType.FILE_TYPE, file, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-string"><span class="hljs-string">"PAT-File (FLAIR) created from PSYQ library files"</span></span>); }</code> </pre> <br><p>  рдпрд╣рд╛рдБ рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рд╕реНрдереИрддрд┐рдХ рд╡рд┐рдзрд┐ <code>getModuleDataFile()</code> <code>Application</code> рд╡рд░реНрдЧ <code>data</code> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдкреВрд░реНрдг рдкрде рджреЗрддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд╛рд░реЗ рдореЙрдбреНрдпреВрд▓ рдХреЗ рдкреЗрдбрд╝ рдореЗрдВ рд╣реИ, рдФрд░ рд╣рдо рдмрд╛рдж рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рднреА рдЖрд╡рд╢реНрдпрдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЦреИрд░, <code>OPTION_NAME</code> <code>registerOption()</code> рд╡рд┐рдзрд┐ <code>OPTION_NAME</code> рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреЛ <code>registerOption()</code> <code>OPTION_NAME</code> , рдкреНрд░рдХрд╛рд░ <code>File</code> (рдпрд╛рдиреА, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдХ рдирд┐рдпрдорд┐рдд рд╕рдВрд╡рд╛рдж рдмреЙрдХреНрд╕ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдЧрд╛), рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдореВрд▓реНрдп рдФрд░ рд╡рд┐рд╡рд░рдгред </p><br><p>  рдЕрдЧрд▓рд╛ред  рдХреНрдпреЛрдВрдХрд┐  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрдВрдЬреАрдХреГрдд рд╡рд┐рдХрд▓реНрдк рдХреЛ рдмрд╛рдж рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЕрд╡рд╕рд░ рдирд╣реАрдВ рд╣реИ, рд╣рдореЗрдВ <code>optionsChanged()</code> рдХреЛ рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА: <code>optionsChanged()</code> </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">optionsChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Options options, Program program)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.optionsChanged(options, program); file = options.getFile(OPTION_NAME, file); }</code> </pre> <br><p>  рдпрд╣рд╛рдВ рд╣рдо рдирдП рдореВрд▓реНрдп рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХрд╛ рдЕрджреНрдпрддрди рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  <code>added()</code> рд╡рд┐рдзрд┐ред  рдЕрдм рдореБрдЦреНрдп рдмрд╛рдд: рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд╢реБрд░реВ рд╣реЛрдиреЗ рдкрд░ рд╡рд┐рдзрд┐ рдЬрд┐рд╕реЗ рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛ред  рдЗрд╕рдореЗрдВ рд╣рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдкрддреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдХреЗрд╡рд▓ рдЙрди рд▓реЛрдЧреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬрд┐рдирдореЗрдВ рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЕрдВрддрд┐рдо рдХреЛрдб: </p><br><div class="spoiler">  <b class="spoiler_title">рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ () рд╡рд┐рдзрд┐</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">added</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Program program, AddressSetView set, TaskMonitor monitor, MessageLog log)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> CancelledException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } Memory memory = program.getMemory(); AddressRangeIterator it = memory.getLoadedAndInitializedAddressSet().getAddressRanges(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!monitor.isCancelled() &amp;&amp; it.hasNext()) { AddressRange range = it.next(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { MemoryBlock block = program.getMemory().getBlock(range.getMinAddress()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (block.isInitialized() &amp;&amp; block.isExecute() &amp;&amp; block.isLoaded()) { PatParser pat = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PatParser(file, monitor); RandomAccessByteProvider provider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RandomAccessByteProvider(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(program.getExecutablePath())); pat.applySignatures(provider, program, block.getStart(), block.getStart(), block.getEnd(), log); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { log.appendException(e); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> </div></div><br><p>  рдпрд╣рд╛рдВ рд╣рдо рдЙрди рдкрддреЛрдВ рдХреА рд╕реВрдЪреА рд╕реЗ рдЧреБрдЬрд░рддреЗ рд╣реИрдВ рдЬреЛ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рд╣реИрдВ, рдФрд░ рд╡рд╣рд╛рдВ рд╣рд╕реНрддрд╛рдХреНрд╖рд░ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/-b/ro/8_/-bro8_sgvplezfb3qhiu5dfjyzm.png"></p><br><h2 id="vyvody-i-finalochka">  рдирд┐рд╖реНрдХрд░реНрд╖ рдФрд░ рдЕрдВрдд </h2><br><p>  рд╕рдм рдХреБрдЫ рдкрд╕рдВрдж рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣рд╛рдВ рдХреБрдЫ рднреА рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рд╣реИрдВ, рд╕рдореБрджрд╛рдп рдЬреАрд╡рдВрдд рд╣реИ, рдЖрдк рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреЛрдб рд▓рд┐рдЦрддреЗ рд╕рдордп рдХреНрдпрд╛ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИред  рдирд┐рдЪрд▓рд╛ рд░реЗрдЦрд╛: <code>Playstation 1</code> рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд░реНрдпрд╢реАрд▓ рдмреВрдЯрд▓реЛрдбрд░ рдФрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдХред </p><br><p><img src="https://habrastorage.org/webt/c_/uw/ej/c_uwejjyu5edynkxyzlr6wboezw.png"></p><br><p>  рд╕рднреА рд╕реНрд░реЛрдд рдХреЛрдб рдпрд╣рд╛рдВ рдЙрдкрд▓рдмреНрдз рд╣реИрдВ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ghidra_psx_ldr</a> <br>  рдпрд╣рд╛рдБ рд╡рд┐рдЬреНрдЮрдкреНрддрд┐: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рдЬреНрдЮрдкреНрддрд┐</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi448098/">https://habr.com/ru/post/hi448098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi448084/index.html">рдПрдХ рдмреНрд▓реИрдХ рд╣реЛрд▓ рдХреА рддрд╕реНрд╡реАрд░ - рдХреНрдпрд╛ рдпрд╣ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рдПрдЧреА?</a></li>
<li><a href="../hi448088/index.html">рд░реВрд╕ рдореЗрдВ рдкреНрд▓рд╛рдЬреНрдорд╛ рдЗрдВрдЬрди рдХрд╛ рдЙрддреНрдкрд╛рджрди</a></li>
<li><a href="../hi448090/index.html">рдлреНрд░рдВрдЯреЗрдВрдб рд╡реАрдХрд▓реА рдбрд╛рдЗрдЬреЗрд╕реНрдЯ (8 - 14 рдЕрдкреНрд░реИрд▓ 2019)</a></li>
<li><a href="../hi448094/index.html">рдбреЙрдХрд░: рдПрдХ рдкреВрд░реНрдг-рд╕реНрдЯреИрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдХреИрд╕реЗ рдкрд░рд┐рдирд┐рдпреЛрдЬрд┐рдд рдХрд░реЗрдВ рдФрд░ рдЧреНрд░реЗ рди рдХрд░реЗрдВ</a></li>
<li><a href="../hi448096/index.html">рдЬреВрд▓рд┐рдпрд╛ рд▓реЗрдЯреЗрдХреНрд╕ рдореЗрдВ</a></li>
<li><a href="../hi448100/index.html">рдкрд┐рдЫрд▓реЗ рд╕рдкреНрддрд╛рд╣ рдирдВрдмрд░ 360 (7 рдЕрдкреНрд░реИрд▓ - 14, 2019) рдХреЗ рд▓рд┐рдП рдлреНрд░рдВрдЯ-рдПрдВрдб рдХреА рджреБрдирд┐рдпрд╛ рд╕реЗ рддрд╛рдЬрд╛ рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрд╛рдЪрди</a></li>
<li><a href="../hi448102/index.html">рдХреБрдЫ рднреА рдирд╣реАрдВ рд╕реЗ рдбреНрд░реАрдо рдЯреАрдо: рдЖрдИрдЯреА рдкреЗрд╢реЗрд╡рд░реЛрдВ рдХреЛ рдХрд╛рдо рдкрд░ рд░рдЦрдирд╛</a></li>
<li><a href="../hi448106/index.html">рдбреЗрд╡рд▓рдкрд░реНрд╕ 1C-рдмрд┐рдЯреНрд░рд┐рдХреНрд╕ рдХрд╛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг: рдХрд░реНрдорд┐рдпреЛрдВ рдХреЗ "рдмрдврд╝рддреЗ" рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рд╕рд╛рдЭрд╛ рдХрд░реЗрдВ</a></li>
<li><a href="../hi448108/index.html">15 рдорд┐рдирдЯ рдореЗрдВ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рд╡реАрдкреАрдПрди рд╕рд░реНрд╡рд░ рдХреИрд╕реЗ рд╕реЗрдЯ рдХрд░реЗрдВ</a></li>
<li><a href="../hi448110/index.html">рдЖрдИрдкреА тАЛтАЛрдкрд░ рд╕реВрдЪрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╕рдорд╛рдзрд╛рди USB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>