<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úä üë®‚Äçüî¨ ‚ÄºÔ∏è VIM - Ce n'est pas seulement un √©diteur, c'est une int√©gration avec tout votre environnement de travail ‚öôÔ∏è üóëÔ∏è üçõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pourquoi Vim / Neovim est- il particuli√®rement bon? Le fait que votre bo√Æte √† outils soit non seulement un √©diteur (qui lui-m√™me est tr√®s extensible a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VIM - Ce n'est pas seulement un √©diteur, c'est une int√©gration avec tout votre environnement de travail</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483580/"><p>  Pourquoi <strong>Vim</strong> / <strong>Neovim</strong> est- <strong>il</strong> particuli√®rement bon?  Le fait que votre bo√Æte √† outils soit non seulement un √©diteur (qui lui-m√™me est tr√®s extensible avec des plugins et poss√®de de riches fonctionnalit√©s de base et est tr√®s flexible dans le domaine de la personnalisation), mais aussi <strong>votre environnement de travail dans son ensemble</strong> , avec toute la bo√Æte √† outils unix-way incluse √† partir de gnu / coreutils et pas seulement.  Vous pouvez prendre n'importe quel programme ou interpr√®te sans quitter l'√©diteur et l'utiliser directement dans l'√©diteur. </p><a name="habracut"></a><br><h2 id="predislovie">  Pr√©face </h2><br><p>  Ce message a √©t√© √©crit √† la h√¢te pour un cercle priv√© de personnes, mais j'ai d√©cid√© qu'il √©tait tout √† fait possible de le publier sur Habr.  Pour certains, cela peut √™tre une source d'inspiration, quelqu'un aidera √† mieux comprendre la philosophie de Vim et quelqu'un prendra quelques astuces pour lui-m√™me.  Au cas o√π, je ferais une r√©serve √† laquelle je ne devrais pas m'attendre √† ce que je commence √† prouver quelque chose √† quelqu'un dans les commentaires, par exemple, pour vous convaincre que vous devez absolument abandonner votre gros IDE et commencer √† utiliser Vim, cela ne m'int√©resse pas du tout. </p><br>
<h2 id="k-delu">  Aux entreprises </h2><br><p>  Ici, par exemple, prenez un tel morceau de code (de la configuration du projet Haskell), une liste de d√©pendances de package (exemple dans le vide): </p><br><pre><code class="plaintext hljs">build-depends: X11 , base , directory , extra , GLFW-b , safe , aeson , containers , data-default , text , process , time , dbus</code> </pre> <br><h2 id="chto-my-hotim">  Que voulons-nous? </h2><br><ol><li>  Trier les d√©pendances par ordre alphab√©tique </li><li>  Tri insensible √† la casse ( <code>X11</code> et <code>GLFW-b</code> ne doivent pas d√©passer tout) </li><li>  Restaurer les virgules ( <code>aeson</code> ira tout en haut et il ne devrait plus avoir de virgule √† gauche, mais <code>X11</code> devrait avoir une virgule √† gauche) </li><li>  Restaurer l'indentation (afin que vous puissiez √©galement obtenir la commande de l'historique et la r√©utiliser dans une autre configuration avec un niveau d'imbrication diff√©rent, ou m√™me lier la commande de raccourci clavier dans la configuration Vim) </li></ol><br><h2 id="reshenie">  Solution </h2><br><p>  Tout d'abord, s√©lectionnez (en surlignant visuellement) la liste des d√©pendances √† l'exception de la premi√®re ligne de <code>build-depends</code> .  Vous pouvez bien s√ªr simplement appuyer sur <code>V</code> (mode visuel avec s√©lection ligne par ligne) et s√©lectionner les lignes n√©cessaires √† l'aide de <code>jk</code> ou des fl√®ches haut et bas.  Dans mon cas, je fais cela avec une seule vague de ma main en utilisant un raccourci clavier personnalis√© pour le mode visuel: </p><br><pre> <code class="plaintext hljs">xn iz &lt;esc&gt;[zV]z</code> </pre> <br><p>  Par exemple, √©tant au milieu de la liste des d√©pendances, j'appuie simplement sur <code>viz</code> et toutes les d√©pendances sont mises en surbrillance, car  le pli entier est mis en surbrillance, qui est √† son tour le bloc d'imbrication actuel (puisque j'ai d√©fini la <code>foldmethod</code> de <code>foldmethod</code> comme <code>indent</code> ).  Mais vous pouvez √©galement taper manuellement <code>[zV]z</code> s√©quentiellement sans raccourci clavier personnalis√© ( <code>[z</code> saute au d√©but du pli et <code>]z</code> √† la fin), mais depuis  pour moi, une telle op√©ration est souvent utilis√©e, puis je l'ai raccourcie √† <code>viz</code> - il n'y a pas de modificateurs comme un d√©calage et elle est compress√©e sur les r√©flexes en un instant (l'analogue standard le plus proche est <code>vip</code> pour s√©lectionner un bloc aux lignes vides les plus proches). </p><br><p>  Appuyez ensuite sur <code>:</code> (deux-points) pour entrer en mode commande pour ex√©cuter une commande relative √† la surbrillance visuelle actuelle.  En fait, le mode de commande habituel, mais avec des marqueurs de s√©lection imm√©diatement ajout√©s, c'est-√†-dire  ressemblera √† <code>:'&lt;,'&gt;</code> o√π <code>'&lt;,'&gt;</code> est la plage de s√©lection, o√π <code>'&lt;</code> est la premi√®re ligne de la s√©lection visuelle et <code>'&gt;</code> est la derni√®re. </p><br><p>  Apr√®s avoir cliqu√© <code>!</code>  (point d'exclamation) sur le clavier, cela signifie que tout ce qui va plus loin est une commande shell / bash (selon les param√®tres).  Cela ressemblera √† <code>:'&lt;,'&gt;!</code>  .  En fait, apr√®s avoir mis en surbrillance, vous pouvez imm√©diatement cliquer <code>!</code>  et obtenez le m√™me r√©sultat - <code>:'&lt;,'&gt;!</code>  . </p><br><p>  Cette op√©ration redirigera les lignes en surbrillance vers la commande STDIN et remplacera les lignes en surbrillance par l'√©chappement STDOUT de cette commande.  Par exemple, vous pouvez utiliser la commande <code>sort</code> , uniquement √† des fins de v√©rification, le r√©sultat n'est pas ce dont nous avons besoin - <code>'&lt;,'&gt;!sort</code> et appuyez sur <em>Entr√©e</em> , nous obtenons: </p><br><pre> <code class="plaintext hljs"> build-depends: , aeson , base , containers , data-default , dbus , directory , extra , GLFW-b , process , safe , text , time X11</code> </pre> <br><h3 id="sposob-s-coreutils-i-voobsche-bashem">  Mode avec coreutils et tour g√©n√©rale </h3><br><p>  Restaurez la s√©lection pr√©c√©dente (vous pouvez appuyer sur <code>gv</code> pour restaurer la derni√®re s√©lection) et appuyez sur <code>!</code>  puis la fl√®che vers le haut - cela restaurera la derni√®re commande de l'historique, nous n'avons donc pas besoin d'√©crire √† nouveau, nous extrayons simplement la commande pr√©c√©dente de l'historique et la modifions.  Pour √©diter plus facilement la commande, vous pouvez appuyer sur <code>Ctrl</code> + <code>f</code> - cela ouvrira davantage.  une fen√™tre avec l'√©dition standard normale de la commande, avec toutes les capacit√©s de Vim, soit dit en passant, toutes les √©quipes pr√©c√©dentes de l'historique y seront visibles sous forme de lignes distinctes, qui peuvent √©galement √™tre s√©lectionn√©es, √©dit√©es et ex√©cut√©es. </p><br><p>  Quelle est la bonne chose √† faire - vous pouvez penser √† une trouvaille, mon point est le suivant: nous supprimons d'abord les virgules, les trions sans elles (sans tenir compte de la casse), puis nous renvoyons les virgules, √† l'exception de la toute premi√®re ligne. </p><br><p>  Tout d'abord, supprimez les virgules (et la premi√®re ligne a un retrait suppl√©mentaire afin que toutes les lignes aient le m√™me retrait) en utilisant la commande <code>sed</code> avec une expression r√©guli√®re ( <code>[, ]</code> - une virgule ou un espace, puis un autre espace, <code>\(\w\)</code> crochets d'√©chappement pour mettre en surbrillance bloc de substitution, pour qu'il soit alors disponible car <code>\1</code> , <code>\w</code> est le premier caract√®re alphab√©tique, dans le remplacement nous restaurerons le caract√®re alphab√©tique par substitution <code>\1</code> ): </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!sed 's/[, ] \(\w\)/\1/'</code> </pre> <br><p>  Nous obtenons ce qui suit: </p><br><pre> <code class="plaintext hljs"> build-depends: X11 base directory extra GLFW-b safe aeson containers data-default text process time dbus</code> </pre> <br><p>  Ensuite, nous redirige (via le symbole <code>|</code> une fonctionnalit√© de bash) vers la commande sort <code>sort</code> , en passant le <code>-f</code> pour l'insensibilit√© √† la casse: </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!sed 's/[, ] \(\w\)/\1/' | sort -f</code> </pre> <br><p>  Nous obtenons: </p><br><pre> <code class="plaintext hljs"> build-depends: aeson base containers data-default dbus directory extra GLFW-b process safe text time X11</code> </pre> <br><p>  Presque termin√©!  Il ne reste plus qu'√† ajouter des virgules, et la premi√®re ligne - quelques espaces.  Nous utilisons le m√™me <code>sed</code> , dans la syntaxe de ses op√©rations vous pouvez sp√©cifier des cha√Ænes et des plages de cha√Ænes (comme dans Vim lui-m√™me, la syntaxe est la m√™me, enfin, ou presque la m√™me).  Le pr√©fixe <code>1</code> signifiera la premi√®re ligne, <code>2,$</code> signifie la plage de la 2e ligne √† la fin ( <code>$</code> , comme <code>^</code> signifie le d√©but du fichier, par analogie avec les m√™mes caract√®res dans les expressions r√©guli√®res qui signifient la fin et le d√©but de la ligne).  Nous allons utiliser <code>\w</code> pour ignorer l'indentation et s√©lectionner imm√©diatement le premier caract√®re alphab√©tique: <code>1s/\w/ &amp;/</code> - ici, nous rempla√ßons la premi√®re ligne, restaurons le premier caract√®re alphab√©tique via <code>&amp;</code> (similaire √† <code>\1</code> , seulement <code>&amp;</code> signifie tout sous toute l'expression r√©guli√®re, tandis que <code>\1</code> signifie le premier bloc entour√© de parenth√®ses), en ajoutant quelques espaces devant lui.  Pour les lignes restantes, au lieu de deux espaces, ajoutez une virgule + espace suivi de: <code>2,$s/\w/, &amp;/</code> , la commande enti√®re sera comme ceci: <code>sed -e '1s/\w/ &amp;/' -e '2,$s/\w/, &amp;/'</code> , - <code>-e</code> nous utilisons pour s√©parer 2 op√©rations les unes des autres.  Dans Vim, l'ensemble de l'op√©ration ressemblera √†: </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!sed 's/[, ] \([^, ]\)/\1/' | sort -f | sed -e '1s/\w/ &amp;/' -e '2,$s/\w/, &amp;/'</code> </pre> <br><p>  Nous postulons et obtenons: </p><br><pre> <code class="plaintext hljs"> build-depends: aeson , base , containers , data-default , dbus , directory , extra , GLFW-b , process , safe , text , time , X11</code> </pre> <br><p>  C'est fait!  Il n'est plus n√©cessaire d'√©crire une deuxi√®me fois, il suffit de taper les premiers caract√®res, par exemple :: <code>:'&lt;,'&gt;!se</code> (en fait, il suffit d'appuyer sur <code>!se</code> ), et d'utiliser la fl√®che vers le haut pour obtenir la commande souhait√©e de l'historique.  D'une mani√®re ou d'une autre, je recommande souvent de pratiquer l'√©criture de telles choses <em>tout de suite</em> .  Ainsi, vous allez √† la fois pomper vos comp√©tences professionnelles quotidiennes en bash et en Vim lui-m√™me, comme  vous faites essentiellement la m√™me chose. </p><br><p>  En fin de compte, toute cette commande peut √™tre affect√©e √† un raccourci clavier, ou r√©sum√©e dans une fonction, et r√©utilis√©e partout pour une ou deux. </p><br><h3 id="ispolzuya-storonniy-yap">  Utilisation de PL tiers </h3><br><p>  Au lieu de lancer quelque chose √† partir de coreutils, vous pouvez ex√©cuter l'interpr√©teur d'une sorte de <strong>langage</strong> qui vous convient, j'aime faire de telles choses via <strong>Perl6</strong> (il a r√©cemment √©t√© renomm√© <strong>Raku</strong> ): </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!perl6 -e 'my @x=lines.map(*.subst(/&lt;[,\s]&gt;\s(\w)/,{$0})).sort(*.lc); @x.shift.subst(/\w/,{q/ /~$_}).say; .subst(/\w/,{q/, /~$_}).say for @x'</code> </pre> <br><p>  Oui, au moins sur le zoskoscript (node.js): </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!node -e 'let fs=require("fs"), x=fs.readFileSync(process.stdin.fd).toString().replace(/\n$/,'').split(/\n/).map(x=&gt;x.replace(/[, ] (\w)/,"$1")).sort((a,b)=&gt;a.toLowerCase().localeCompare(b.toLowerCase())); console.log(x.shift().replace(/(\w)/," $1")); process.stdout.write(x.map(x=&gt;x.replace(/(\w)/,", $1")).join("\n"))'</code> </pre> <br><p>  Cela peut √©galement √™tre fait sur VimL / Vimscript √† l'int√©rieur de Vim lui-m√™me, sans appeler de commandes externes.  Mais ce post n'est pas √† ce sujet. </p><br><p>  Naturellement, comme vous l'avez peut-√™tre devin√©, vous pouvez facilement enregistrer votre script dans un fichier s√©par√©, ou m√™me compiler votre propre programme qui prend quelque chose pour entrer dans STDIN et g√©n√®re quelque chose de trait√© dans STDOUT et l'utiliser dans Vim simplement en appelant (qui , encore une fois, peut √™tre attribu√© √† un raccourci clavier): </p><br><pre> <code class="plaintext hljs">:'&lt;,'&gt;!~/my-program-or-script</code> </pre> <br><p>  Ainsi, lorsque vous √©crivez du code dans Vim, non seulement Vim est √† votre disposition, mais √©galement tout votre environnement de travail. </p><br><p>  L'un des exemples les plus simples consiste √† rejeter un fichier JSON: </p><br><pre> <code class="plaintext hljs">:%!jq</code> </pre> <br><p>  Juste quelques touches, pourquoi r√©inventer l'analyseur et le prettifayer AST pour JSON pour tout nouvel √©diteur / IDE / quoi que ce soit, quand vous pouvez simplement prendre et ex√©cuter un fichier via <code>jq</code> sans quitter Vim?  Je ne parle pas du fait que vous pouvez traiter votre gros fichier JSON via <code>jq</code> de cette mani√®re, sans quitter Vim, trouver par exemple la cl√© souhait√©e dans l'arborescence, trier, ne laisser que les donn√©es n√©cessaires, etc. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr483580/">https://habr.com/ru/post/fr483580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr483564/index.html">Copywriting in IT: comment commencer √† √©crire sur la technologie</a></li>
<li><a href="../fr483568/index.html">Cr√©er un ordinateur primitif √† partir de z√©ro</a></li>
<li><a href="../fr483570/index.html">Mais que faire si la terre est plate?</a></li>
<li><a href="../fr483574/index.html">Analyse de fiabilit√© des √©quipements √©lectroniques de choc et de vibration - Aper√ßu</a></li>
<li><a href="../fr483578/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 493 (12.24.2019 - 12.30.2019)</a></li>
<li><a href="../fr483584/index.html">Transf√©rer un backend PHP vers le bus de flux Redis et choisir une biblioth√®que ind√©pendante des frameworks</a></li>
<li><a href="../fr483586/index.html">Les bases de l'utilisation de zmq en python, la cr√©ation d'un simple magasin cl√© / valeur</a></li>
<li><a href="../fr483588/index.html">Comment essayer de bloquer n'importe quel site en utilisant ILV</a></li>
<li><a href="../fr483590/index.html">Rechercher une erreur FDCAN qui n'est pas</a></li>
<li><a href="../fr483594/index.html">√âconomie future pour les physiciens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>