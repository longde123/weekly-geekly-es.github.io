<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôëÔ∏è üòÉ üë©üèΩ‚Äç‚öñÔ∏è MAM: Frontend-Montage ohne Schmerzen ‚Ü™Ô∏è üññüèæ üññüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo, mein Name ist Dmitry Karlovsky und ich ... verehre MAM. M AM regiert die gnostischen M- Module und erspart mir den L√∂wenanteil der Routine. 


...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MAM: Frontend-Montage ohne Schmerzen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456288/"><p>  Hallo, mein Name ist Dmitry Karlovsky und ich ... verehre MAM.  <strong>M</strong> AM regiert die gnostischen <strong>M-</strong> Module und erspart mir den L√∂wenanteil der Routine. </p><br><p><img src="https://habrastorage.org/webt/m2/5h/ps/m25hpsfevki-o6lwx4v_ukfxvtu.png" alt="Typisches Agnostikmodul"></p><br><p> <strong>Ein Agnostikmodul</strong> ist im Gegensatz zum herk√∂mmlichen <strong>Modul</strong> keine Datei mit einer Quelle, sondern ein Verzeichnis, in dem sich Quellen in verschiedenen Sprachen befinden k√∂nnen: Programmlogik in <code>JS</code> / <code>TS</code> , Tests in <code>TS</code> / <code>JS</code> , Zusammensetzung der Komponenten in <code>view.tree</code> , Stile in <code>CSS</code> Lokalisierung im <code>locale=*.json</code> , Bilder usw. usw.  Falls gew√ºnscht, ist es nicht schwierig, die Unterst√ºtzung einer anderen Sprache zu befestigen.  Zum Beispiel Stylus zum Schreiben von Stilen oder HTML zum Beschreiben von Vorlagen. </p><br><p>  Abh√§ngigkeiten zwischen Modulen werden automatisch durch Analyse der Quelle verfolgt.  Wenn das Modul eingeschaltet ist, wird es als Ganzes eingeschaltet - jeder Modulquellcode wird transponiert und f√§llt in das entsprechende Paket: Skripte - separat, Stile - separat, Tests - separat.  F√ºr verschiedene Plattformen - ihre Bundles: f√ºr einen Knoten - ihre eigenen, f√ºr einen Browser - ihre eigenen. </p><br><p>  Volle Automatisierung, fehlende Konfiguration und Boilerplate, minimale B√ºndelgr√∂√üen, automatisches Pumpen von Abh√§ngigkeiten, Entwicklung von Hunderten von entfremdeten Bibliotheken und Anwendungen in einer Codebasis ohne Schmerzen und Leiden.  <strong>Wow was f√ºr eine Sucht!</strong>  Entfernen Sie schwangere, nerv√∂se Kinder von den Monitoren und begr√º√üen Sie das U-Boot! </p><a name="habracut"></a><br><h1 id="filosofiya">  Philosophie </h1><br><p>  MAM ist ein mutiges Experiment, um die Art und Weise, wie Code organisiert ist, und den Prozess der Arbeit damit radikal zu √§ndern.  Hier sind die Grundprinzipien: </p><br><p>  <strong>Konventionen statt Konfiguration.</strong>  Angemessene, einfache und universelle Vereinbarungen erm√∂glichen es Ihnen, die gesamte Routine zu automatisieren und gleichzeitig die Bequemlichkeit und Einheitlichkeit zwischen verschiedenen Projekten zu gew√§hrleisten. </p><br><p>  <strong>Die Infrastruktur ist getrennt, der Code ist getrennt.</strong>  Eine Situation ist nicht ungew√∂hnlich, wenn Sie Dutzende oder sogar Hunderte von Bibliotheken und Anwendungen entwickeln m√ºssen.  Stellen Sie nicht f√ºr jeden die Infrastruktur f√ºr Montage, Entwicklung, Bereitstellung usw. bereit.  Es reicht aus, es einmal zu fragen und dann Anwendungen wie Torten zu nieten. </p><br><p>  <strong>Zahlen Sie nicht f√ºr das, was Sie nicht verwenden.</strong>  Sie verwenden eine Art Modul - es ist im Bundle mit all seinen Abh√§ngigkeiten enthalten.  Nicht verwenden - l√§sst sich nicht einschalten.  Je kleiner die Module sind, desto gr√∂√üer ist die Granularit√§t und desto weniger unn√∂tiger Code im Bundle. </p><br><p>  <strong>Minimaler redundanter Code.</strong>  Das Aufteilen von Code in Module sollte so einfach sein wie das Schreiben des gesamten Codes in eine einzige Datei.  Andernfalls ist der Entwickler faul, gro√üe Module in kleine zu zerlegen. </p><br><p>  <strong>Keine Versionskonflikte.</strong>  Es gibt nur eine Version - die aktuelle.  Es ist nicht erforderlich, Ressourcen f√ºr die Unterst√ºtzung alter Versionen aufzuwenden, wenn Sie diese f√ºr die Aktualisierung letzterer verwenden k√∂nnen. </p><br><p>  <strong>Halten Sie einen Finger am Puls der Zeit.</strong>  Das schnellste Feedback zu Inkompatibilit√§ten l√§sst den Code nicht schlecht werden. </p><br><p>  <strong>Der einfachste Weg ist der sicherste.</strong>  Wenn der richtige Weg zus√§tzliche Anstrengungen erfordert, stellen Sie sicher, dass niemand zu ihnen geht. </p><br><h1 id="importyeksporty">  Importe / Exporte </h1><br><p>  Wir er√∂ffnen das erste Projekt, das mit einem modernen Modulsystem entstanden ist: <a href="">Ein Modul ist weniger als 300 Zeilen lang, 30 davon sind Importe.</a> </p><br><p>  Aber das sind immer noch Blumen: <a href="">F√ºr eine Funktion von 9 Zeilen sind 8 Importe erforderlich.</a> </p><br><p>  Und mein Favorit: <a href="">Keine einzige Zeile n√ºtzlichen Codes.</a>  20 Zeilen mit Verschiebungswerten aus dem Modulhaufen in eine, sodass Sie sp√§ter von einem Modul und nicht von zwanzig importieren k√∂nnen. </p><br><p>  All dies ist ein Boilerplate, was dazu f√ºhrt, dass Entwickler zu faul sind, um kleine Codeteile in separate Module zu unterteilen, und gro√üe Module kleinen vorziehen.  Und selbst wenn sie nicht faul sind, ergibt sich entweder viel Code zum Importieren kleiner Module oder spezielle Module, die viele Module in sich selbst importieren und alle in gro√üen Mengen exportieren. </p><br><p>  All dies f√ºhrt zu einer geringen Granularit√§t des Codes und zum Aufblasen der Gr√∂√üe von Bundles mit nicht verwendetem Code, was das Gl√ºck hat, dem verwendeten Code nahe zu kommen.  F√ºr JS versuchen sie, dieses Problem zu l√∂sen, indem sie die Assembly-Pipeline komplizieren und das sogenannte "Tree-Shaking" hinzuf√ºgen, das den √úberschuss von dem, was Sie importiert haben, abschneidet.  Dies verlangsamt die Montage, aber nicht alles wird geschnitten. </p><br><p>  Idee: <strong>Was ist, wenn wir nicht importieren, sondern nur nehmen und verwenden und der Sammler selbst herausfindet, was importiert werden muss?</strong> </p><br><p>  Moderne IDEs k√∂nnen automatisch Importe f√ºr die von Ihnen verwendeten Entit√§ten generieren.  Wenn die IDE dies kann, was hindert den Kollektor dann daran?  Es reicht aus, eine einfache Vereinbarung √ºber die Benennung und den Speicherort von Dateien zu treffen, die f√ºr den Benutzer bequem und f√ºr die Maschine verst√§ndlich w√§re.  PHP hat seit langem eine solche Standardkonvention: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PSR-4</a> .  MAM f√ºhrt dasselbe f√ºr <em>.ts- und</em> .jam.js-Dateien ein: Namen, die mit $ beginnen, sind der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vollst√§ndig qualifizierte Name einer</a> globalen Entit√§t, deren Code entlang des von FQN erhaltenen Pfads geladen wird, indem Trennzeichen durch Schr√§gstriche ersetzt werden.  Ein einfaches Beispiel f√ºr zwei Module: </p><br><p>  <strong>my / alert / alert.ts</strong> </p><br><pre> <code class="plaintext hljs">const $my_alert = alert // FQN   </code> </pre> <br><p>  <strong>meine / app / app.ts</strong> </p><br><pre> <code class="plaintext hljs">$my_alert( 'Hello!' ) // ,   /my/alert/</code> </pre> <br><p>  Ein ganzes Modul aus einer Zeile - was k√∂nnte einfacher sein?  Das Ergebnis l√§sst nicht lange auf sich warten: Die einfache Erstellung und Verwendung von Modulen f√ºhrt zu einer Minimierung ihrer Gr√∂√üe.  Infolgedessen wird die Granularit√§t maximiert.  Und wie eine Kirsche - Minimierung der B√ºndelgr√∂√üe ohne Baumsch√ºtteln. </p><br><p>  Ein gutes Beispiel ist die JSON <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">/ mol / data-</a> Familie von Validierungsmodulen.  Wenn Sie die Funktion <code>$mol_data_integer</code> irgendwo in Ihrem Code verwenden, werden die Module <code>/mol/data/integer</code> und <code>/mol/data/number</code> , von denen <code>$mol_data_integer</code> abh√§ngt, in das Bundle aufgenommen.  Zum Beispiel liest der Collector <code>/mol/data/email</code> nicht einmal von der Festplatte, da niemand davon abh√§ngt. </p><br><h1 id="razgrebaya-bardak">  Ein Chaos harken </h1><br><p>  Seit wir Angular treten, werden wir nicht aufh√∂ren.  Wo sollten Sie nach der <code>applyStyles</code> Funktionsdeklaration suchen?  Sie werden <a href=""><code>/packages/core/src/render3/styling_next/bindings.ts</code></a> nicht erraten.  Die M√∂glichkeit, irgendwo etwas zu platzieren, f√ºhrt dazu, dass wir in jedem Projekt ein eindeutiges Dateispeicherungssystem beobachten, das h√§ufig keiner Logik zug√§nglich ist.  Und wenn die IDE h√§ufig durch den ‚ÄûSprung zur Definition‚Äú gespeichert wird, wird diese M√∂glichkeit dem Anzeigen des Codes auf dem Github oder dem √úberpr√ºfen der Pull-Anforderung entzogen. </p><br><p>  Idee: <strong>Was ist, wenn Entit√§tsnamen genau ihrem Standort entsprechen?</strong> </p><br><p>  Um den Code in der Datei <code>/angular/packages/core/src/render3/stylingNext/bindings.ts</code> , m√ºssen Sie in der MAM-Architektur die Entit√§t <code>$angular_packages_core_src_render3_stylingNext_applyStyles</code> , aber nat√ºrlich wird niemand handeln, da der Name so viel mehr enth√§lt.  Aber die Namen im Code, die ich sehen m√∂chte, sind kurz und pr√§gnant, sodass der Entwickler versuchen wird, alles Unn√∂tige aus dem Namen auszuschlie√üen, wobei nur das Wichtige <code>$angular_render3_applyStyles</code> : <code>$angular_render3_applyStyles</code> .  Und es befindet sich entsprechend in <code>/angular/render3/applyStyles/applyStyles.ts</code> . </p><br><p>  Beachten Sie, wie MAM die Schw√§chen von Entwicklern nutzt, um das gew√ºnschte Ergebnis zu erzielen: Jede Entit√§t erh√§lt einen kurzen, global eindeutigen Namen, der in jedem Kontext verwendet werden kann.  In den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Commit-Nachrichten k√∂nnen</a> Sie beispielsweise mit diesen Namen schnell und genau erfassen, wor√ºber sie sprechen: </p><br><pre> <code class="plaintext hljs">73ebc45e517ffcc3dcce53f5b39b6d06fc95cae1 $mol_vector: range expanding support 3a843b2cb77be19688324eeb72bd090d350a6cc3 $mol_data: allowed transformations 24576f087133a18e0c9f31e0d61052265fd8a31a $mol_data_record: support recursion</code> </pre> <br><p>  Oder nehmen wir an, Sie m√∂chten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">alle Erw√§hnungen des Moduls $ mol_fiber im Internet finden</a> - dank FQN ist dies einfacher als je zuvor. </p><br><h1 id="ciklicheskie-zavisimosti">  Zyklische Abh√§ngigkeiten </h1><br><p>  Schreiben wir 7 Zeilen einfachen Codes in eine Datei: </p><br><pre> <code class="plaintext hljs">export class Foo { get bar() { return new Bar(); } } export class Bar extends Foo {} console.log(new Foo().bar);</code> </pre> <br><p>  Trotz der zyklischen Abh√§ngigkeit funktioniert es korrekt.  Wir teilen es in 3 Dateien auf: </p><br><p>  <strong>my / foo.js.</strong> </p><br><pre> <code class="plaintext hljs">import { Bar } from './bar.js'; export class Foo { get bar() { return new Bar(); } }</code> </pre> <br><p>  <strong>my / bar.js.</strong> </p><br><pre> <code class="plaintext hljs">import { Foo } from './foo.js'; export class Bar extends Foo {}</code> </pre> <br><p>  <strong>meine / app.js.</strong> </p><br><pre> <code class="plaintext hljs">import { Foo } from './foo.js'; console.log(new Foo().bar);</code> </pre> <br><p>  Ups, <code>ReferenceError: Cannot access 'Foo' before initialization</code> .  Was f√ºr ein Unsinn?  Um dies zu beheben, muss unsere <code>app.js</code> wissen, dass <code>foo.js</code> von <code>foo.js</code> abh√§ngt.  Daher m√ºssen wir zuerst <code>bar.js</code> importieren, das <code>foo.js</code> importiert <code>foo.js</code>  Danach k√∂nnen wir <code>foo.js</code> bereits fehlerfrei importieren: </p><br><p>  <strong>meine / app.js.</strong> </p><br><pre> <code class="plaintext hljs">import './bar.js'; import { Foo } from './foo.js'; console.log(new Foo().bar);</code> </pre> <br><p>  Diese Browser, dieses NodeJS, dieses Webpack, dieses Paket - sie alle arbeiten schief mit zirkul√§ren Abh√§ngigkeiten.  Und nun, sie w√ºrden es ihnen einfach verbieten - man k√∂nnte den Code sofort komplizieren, so dass es keine Schleifen gibt.  Aber sie k√∂nnen gut funktionieren und dann bam und einen unverst√§ndlichen Fehler geben. </p><br><p>  Idee: <strong>Was ist, wenn wir w√§hrend der Montage die Dateien nur in der richtigen Reihenfolge kleben, als ob der gesamte Code urspr√ºnglich in einer Datei geschrieben w√§re?</strong> </p><br><p>  Teilen wir den Code nach den Prinzipien von MAM auf: </p><br><p>  <strong>meine / foo / foo.ts</strong> </p><br><pre> <code class="plaintext hljs">class $my_foo { get bar() { return new $my_bar(); } }</code> </pre> <br><p>  <strong>my / bar / bar.ts.</strong> </p><br><pre> <code class="plaintext hljs">class $my_bar extends $my_foo {}</code> </pre> <br><p>  <strong>meine / app / app.ts</strong> </p><br><pre> <code class="plaintext hljs">console.log(new $my_foo().bar);</code> </pre> <br><p>  Die gleichen 7 Codezeilen, die urspr√ºnglich waren.  Und sie arbeiten einfach ohne zus√§tzlichen Schamanismus.  Die Sache ist, dass der Sammler versteht, dass die Abh√§ngigkeit von <code>my/bar</code> von <code>my/foo</code> strenger ist als die von <code>my/foo</code> von <code>my/bar</code> .  Dies bedeutet, dass Sie diese Module in dieser Reihenfolge in das Bundle aufnehmen sollten: <code>my/foo</code> , <code>my/bar</code> , <code>my/app</code> . </p><br><p>  Wie versteht der Sammler das?  Jetzt ist die Heuristik einfach - durch die Anzahl der Einr√ºckungen in der Zeile, in der die Abh√§ngigkeit erkannt wird.  Bitte beachten Sie, dass eine st√§rkere Abh√§ngigkeit in unserem Beispiel keine Einr√ºckung und eine schwache eine doppelte Einr√ºckung aufweist. </p><br><h1 id="raznye-yazyki">  Verschiedene Sprachen </h1><br><p>  Es ist einfach so passiert, dass wir f√ºr verschiedene Dinge verschiedene Sprachen f√ºr diese verschiedenen Dinge gesch√§rft haben.  Am h√§ufigsten sind: JS, TS, CSS, HTML, SVG, SCSS, Less, Stylus.  Jedes hat ein eigenes Modulsystem, das in keiner Weise mit anderen Sprachen interagiert.  Unn√∂tig zu erw√§hnen, dass es ungef√§hr 100500 Arten spezifischerer Sprachen gibt.  Um eine Komponente zu verbinden, m√ºssen Sie daher ihre Skripte, Stile, Register separat registrieren, die Bereitstellung der ben√∂tigten statischen Dateien separat konfigurieren usw. usw. separat verbinden. </p><br><p>  Dank Loadern versucht Webpack, dieses Problem zu l√∂sen.  Aber er hat einen Einstiegspunkt ist ein Skript, das bereits Dateien in anderen Sprachen verbindet.  Und wenn wir kein Skript brauchen?  Zum Beispiel haben wir ein Modul mit sch√∂nen Stilen f√ºr Teller und wir m√∂chten, dass sie im hellen Thema die gleichen Farben haben und andere im dunklen: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.dark-theme</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: black; } <span class="hljs-selector-class"><span class="hljs-selector-class">.light-theme</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: white; }</code> </pre> <br><p>  Wenn wir vom Thema abh√§ngig sind, sollte au√üerdem ein Skript geladen werden, das das gew√ºnschte Thema je nach Tageszeit installiert.  Das hei√üt, CSS h√§ngt tats√§chlich von JS ab. </p><br><p>  Idee: <strong>Was ist, wenn ein modulares System nicht von Sprachen abh√§ngt?</strong> </p><br><p>  Da in MAM das modulare System von Sprachen getrennt ist, k√∂nnen die Abh√§ngigkeiten sprach√ºbergreifend sein.  CSS kann von JS abh√§ngen, was von TS abh√§ngen kann, was von einem anderen JS abh√§ngen kann.  Dies wird durch die Tatsache erreicht, dass Quellabh√§ngigkeiten von den Modulen erkannt werden und die Module vollst√§ndig verbunden sind und Quellcodes in beliebigen Sprachen enthalten k√∂nnen.  Im Fall des Themenbeispiels sieht es so aus: </p><br><p>  <strong>/my/table/table.css</strong> </p><br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/* ,   /my/theme */</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[my_theme="dark"]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: black; } <span class="hljs-selector-attr"><span class="hljs-selector-attr">[my_theme="light"]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">table</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background</span></span>: white; }</code> </pre> <br><p>  <strong>/my/theme/theme.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.documentElement.setAttribute( <span class="hljs-string"><span class="hljs-string">'my_theme'</span></span> , ( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>().getHours() + <span class="hljs-number"><span class="hljs-number">15</span></span> ) % <span class="hljs-number"><span class="hljs-number">24</span></span> &lt; <span class="hljs-number"><span class="hljs-number">12</span></span> ? <span class="hljs-string"><span class="hljs-string">'light'</span></span> : <span class="hljs-string"><span class="hljs-string">'dark'</span></span> , )</code> </pre> <br><p>  Mit dieser Technik k√∂nnen Sie √ºbrigens Ihr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modernizr</a> implementieren, jedoch ohne 300 Pr√ºfungen, die Sie nicht ben√∂tigen, da nur die Pr√ºfungen, von denen Ihr CSS wirklich abh√§ngt, in das Bundle aufgenommen werden. </p><br><h1 id="mnogo-bibliotek">  Viele Bibliotheken </h1><br><p>  In der Regel ist der Einstiegspunkt f√ºr die Erstellung eines Bundles eine Art Datei.  Im Fall von Webpack ist dies JS.  Wenn Sie viele ver√§u√üerliche Bibliotheken und Anwendungen entwickeln, ben√∂tigen Sie viele Bundles.  Und f√ºr jedes Bundle m√ºssen Sie einen separaten Einstiegspunkt erstellen.  Bei Parcel ist der Einstiegspunkt HTML, das f√ºr Anwendungen ohnehin erstellt werden muss.  Aber f√ºr Bibliotheken ist dies irgendwie nicht sehr geeignet. </p><br><p>  Idee: <strong>Was ist, wenn ein Modul ohne vorherige Vorbereitung zu einem unabh√§ngigen B√ºndel zusammengesetzt werden kann?</strong> </p><br><p>  Stellen wir die neueste Version des MAM-Projekt-Builders $ mol_build zusammen: </p><br><pre> <code class="plaintext hljs">mam mol/build</code> </pre> <br><p>  F√ºhren Sie nun diesen Sammler und lassen Sie ihn sich wieder zusammensetzen, um sicherzustellen, dass er sich noch zusammenbauen kann: </p><br><pre> <code class="plaintext hljs">node mol/build/-/node.js mol/build</code> </pre> <br><p>  Obwohl, nein, bitten wir ihn, zusammen mit der Baugruppe Tests durchzuf√ºhren: </p><br><pre> <code class="plaintext hljs">node mol/build/-/node.test.js mol/build</code> </pre> <br><p>  Und wenn alles gut gegangen ist, ver√∂ffentlichen Sie das Ergebnis in NPM: </p><br><pre> <code class="plaintext hljs">npm publish mol/build/-</code> </pre> <br><p>  Wie Sie sehen, wird beim Zusammenstellen des Moduls ein Unterverzeichnis mit dem Namen erstellt <code>-</code> und alle Assembly-Artefakte werden dort abgelegt.  Lassen Sie uns die Dateien durchgehen, die Sie dort finden: </p><br><ul><li>  <code>web.dep.json</code> - alle Informationen zum Abh√§ngigkeitsdiagramm </li><li>  <code>web.js</code> - Browser- <code>web.js</code> </li><li>  <code>web.js.map</code> - Sorsmaps f√ºr ihn </li><li>  <code>web.esm.js</code> - es hat die Form eines es-Moduls </li><li>  <code>web.esm.js.map</code> - und sorsmaps daf√ºr </li><li>  <code>web.test.js</code> - <code>web.test.js</code> </li><li>  <code>web.test.js.map</code> - und f√ºr Sorsmap-Tests </li><li>  <code>web.d.ts</code> - Bundle mit Typen von allem, was im Skript-Bundle enthalten ist </li><li>  <code>web.css</code> - B√ºndel mit Stilen </li><li>  <code>web.css.map</code> - und sortiert Karten daf√ºr </li><li>  <code>web.test.html</code> - Einstiegspunkt zum Ausf√ºhren von Leistungstests in einem Browser </li><li>  <code>web.view.tree</code> - Deklarationen aller im Bundle view.tree enthaltenen Komponenten </li><li>  <code>web.locale=*.json</code> - Bundles mit lokalisierten Texten, jedes Bundle hat ein eigenes Bundle </li><li>  <code>package.json</code> - Erm√∂glicht die sofortige Ver√∂ffentlichung des zusammengestellten Moduls in NPM </li><li>  <code>node.dep.json</code> - Alle Informationen zum Abh√§ngigkeitsdiagramm </li><li>  <code>node.js</code> - Knotenskriptpaket </li><li>  <code>node.js.map</code> - sorsmaps daf√ºr </li><li>  <code>node.esm.js</code> - Es hat die Form eines es-Moduls </li><li>  <code>node.esm.js.map</code> - und sorsmaps daf√ºr </li><li>  <code>node.test.js</code> - das gleiche Bundle, aber auch mit Tests </li><li>  <code>node.test.js.map</code> - und sorsmaps daf√ºr </li><li>  <code>node.d.ts</code> - Bundle mit Typen von allem, was im Skript-Bundle enthalten ist </li><li>  <code>node.view.tree</code> - Deklarationen aller im Bundle view.tree enthaltenen Komponenten </li><li>  <code>node.locale=*.json</code> - Bundles mit lokalisierten Texten, jedes Bundle hat ein eigenes Bundle </li></ul><br><p>  Die Statik wird einfach zusammen mit den Pfaden kopiert.  Nehmen Sie als Beispiel eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anwendung, die ihre eigenen Quellcodes anzeigt</a> .  Seine Quellen sind hier: </p><br><ul><li> <code>/mol/app/quine/quine.view.tree</code> </li> <li> <code>/mol/app/quine/quine.view.ts</code> </li> <li> <code>/mol/app/quine/index.html</code> </li> <li> <code>/mol/app/quine/quine.locale=ru.json</code> </li> </ul><br><p>  Leider kann der Collector im Allgemeinen nicht wissen, dass wir diese Dateien zur Laufzeit ben√∂tigen.  Aber wir k√∂nnen ihm das sagen, indem wir eine spezielle Datei in die N√§he legen: </p><br><p>  <strong>/mol/app/quine/quine.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">deploy \/mol/app/quine/quine.view.tree deploy \/mol/app/quine/quine.view.ts deploy \/mol/app/quine/index.html deploy \/mol/app/quine/quine.locale=ru.json</code> </pre> <br><p>  Als Ergebnis der Assembly <code>/mol/app/quine</code> werden sie auf folgende Weise kopiert: </p><br><ul><li> <code>/mol/app/quine/-/mol/app/quine/quine.view.tree</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/quine.view.ts</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/index.html</code> </li> <li> <code>/mol/app/quine/-/mol/app/quine/quine.locale=ru.json</code> </li> </ul><br><p>  Jetzt kann das Verzeichnis <code>/mol/app/quine/-</code> auf jedem statischen Hosting angelegt werden und die Anwendung ist voll funktionsf√§hig. </p><br><h1 id="celevye-platformy">  Zielplattformen </h1><br><p>  JS kann sowohl auf dem Client als auch auf dem Server ausgef√ºhrt werden.  Und wie cool es ist, wenn Sie einen Code schreiben k√∂nnen und er √ºberall funktioniert.  Manchmal unterscheidet sich die Implementierung derselben Sache auf dem Client und dem Server jedoch grundlegend.  Und ich m√∂chte zum Beispiel, dass eine Implementierung f√ºr einen Knoten und eine andere f√ºr einen Browser verwendet wird. </p><br><p>  Idee: <strong>Was ist, wenn sich der Zweck der Datei in ihrem Namen widerspiegelt?</strong> </p><br><p>  MAM verwendet ein Tag-System in Dateinamen.  <code>$mol_state_arg</code> Modul <code>$mol_state_arg</code> bietet beispielsweise Zugriff auf benutzerdefinierte Anwendungsparameter.  Im Browser werden diese Parameter √ºber die Adressleiste eingestellt.  Und im Knoten √ºber Befehlszeilenargumente.  <code>$mol_sate_arg</code> abstrahiert den Rest der Anwendung von diesen Nuancen, indem beide Optionen mit einer einzigen Schnittstelle implementiert und in Dateien abgelegt werden: </p><br><ul><li>  / mol / state / arg / arg.  <strong>web</strong> .ts - Implementierung f√ºr Browser </li><li>  / mol / state / arg / arg.  <strong>node</strong> .ts - Implementierung f√ºr einen Knoten </li></ul><br><p>  Quellen, die nicht mit diesen Tags versehen sind, werden unabh√§ngig von der Zielplattform eingeschlossen. </p><br><p>  Eine √§hnliche Situation wird bei Tests beobachtet - sie m√∂chten neben den √ºbrigen Quellen gespeichert werden, m√∂chten jedoch nicht in das Paket aufgenommen werden, das an den Endbenutzer geht.  Daher sind Tests auch mit einem separaten Tag gekennzeichnet: </p><br><ul><li>  / mol / state / arg / arg.  <strong>test</strong> .ts - Modultests, sie fallen in das Testpaket </li></ul><br><p>  Tags k√∂nnen parametrisch sein.  Zum Beispiel k√∂nnen mit jedem Modul Texte in verschiedenen Sprachen kommen und sie sollten in den entsprechenden Sprachpaketen enthalten sein.  Eine Textdatei ist ein regul√§res JSON-W√∂rterbuch mit dem Gebietsschema im Namen: </p><br><ul><li>  / mol / app / leben / leben.  <strong>locale = ru</strong> .json - texte f√ºr die russische sprache </li><li>  / mol / app / leben / leben.  <strong>locale = jp</strong> .json - Texte f√ºr Japanisch </li></ul><br><p>  Was ist schlie√ülich, wenn wir Dateien in der N√§he ablegen m√∂chten, der Kollektor sie jedoch ignorieren und nicht automatisch in das Bundle aufnehmen soll?  Es reicht aus, am Anfang ihres Namens ein nicht alphanumerisches Zeichen hinzuzuf√ºgen.  Zum Beispiel: </p><br><ul><li>  / hyoo / spielzeug / <strong>.</strong>  git - beginnt mit einem Punkt, sodass der Collector dieses Verzeichnis ignoriert </li></ul><br><h1 id="versionirovanie">  Versionierung </h1><br><p>  Google hat AngularJS zuerst ver√∂ffentlicht und in NPM als Angular ver√∂ffentlicht.  Dann schuf er ein v√∂llig neues Framework mit einem √§hnlichen Namen - Angular - und ver√∂ffentlichte es unter demselben Namen, aber bereits Version 2. Jetzt entwickeln sich diese beiden Feuerwerke unabh√§ngig voneinander.  Zwischen den Hauptversionen tritt nur eine API-brechende √Ñnderung auf.  Und der andere - <a href="">zwischen den Minderj√§hrigen</a> .  Und da es unm√∂glich ist, zwei Versionen derselben Abh√§ngigkeit auf dieselbe Ebene zu bringen, kann von einem reibungslosen √úbergang keine Rede sein, wenn zwei Versionen der Bibliothek f√ºr einige Zeit gleichzeitig in der Anwendung vorhanden sind. </p><br><p>  Es scheint, dass das Team von Angular bereits auf alle m√∂glichen Rechen getreten ist.  Und noch etwas: Der Framework-Code ist in mehrere gro√üe Module unterteilt.  Zuerst haben sie sie unabh√§ngig versioniert, aber selbst sie waren sehr schnell verwirrt, welche Versionen der Module miteinander kompatibel sind, geschweige denn gew√∂hnliche Entwickler.  Daher wechselte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Angular zur End-to-End-Versionierung</a> , bei der sich die Hauptversion des Moduls auch ohne √Ñnderung des Codes √§ndern kann.  Die Unterst√ºtzung mehrerer Versionen mehrerer Module ist sowohl f√ºr die Betreuer selbst als auch f√ºr das gesamte √ñkosystem ein gro√ües Problem.  Schlie√ülich werden viele Ressourcen aller Community-Mitglieder aufgewendet, um die Kompatibilit√§t mit bereits veralteten Modulen sicherzustellen. </p><br><p>  Die sch√∂ne Idee der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">semantischen Versionierung</a> zerf√§llt in die harte Realit√§t - Sie wissen nie, ob etwas kaputt geht, wenn Sie die Nebenversion <a href="">oder sogar die Version des Patches</a> √§ndern.  Daher ist in vielen Projekten eine bestimmte Version der Abh√§ngigkeit festgelegt.  Ein solcher Fix wirkt sich jedoch nicht auf transitive Abh√§ngigkeiten aus, die bei der Installation von Grund auf auf die neueste Version zur√ºckgesetzt werden, aber m√∂glicherweise gleich bleiben, wenn sie bereits installiert sind.  Dieses Durcheinander f√ºhrt dazu, dass Sie sich niemals auf eine feste Version verlassen k√∂nnen und regelm√§√üig die Kompatibilit√§t mit aktuellen Versionen von (zumindest transitiven) Abh√§ngigkeiten √ºberpr√ºfen m√ºssen. </p><br><p>  Aber was ist mit <a href="">Sperrdateien</a> ?  Wenn Sie eine Bibliothek entwickeln, die √ºber Abh√§ngigkeiten installiert wird, hilft Ihnen die Sperrdatei nicht weiter, da sie vom Paketmanager ignoriert wird.  F√ºr die endg√ºltige Anwendung gibt Ihnen die Sperrdatei die sogenannte "Reproduzierbarkeit von Baugruppen".  Aber seien wir ehrlich.  Wie oft m√ºssen Sie die endg√ºltige Anwendung aus derselben Quelle erstellen?  Genau einmal.  Empfangen der Ausgabe, unabh√§ngig von einem NPM, des Assembly-Artefakts: eine ausf√ºhrbare Bin√§rdatei, ein Docker-Container oder nur ein Archiv mit dem gesamten Code, der zum Ausf√ºhren erforderlich ist.  Ich hoffe du machst keine <code>npm install</code> auf prod? </p><br><p>  Einige verwenden Sperrdateien, damit der CI-Server genau das zusammenstellt, was der Entwickler festgelegt hat.  Aber warten Sie, der Entwickler selbst kann es einfach auf seinem lokalen Computer zusammenbauen.  ,    ,  ,    . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Continuous Integration</a>       ,     ,    ,  ,   - .  CI        ,            . </p><br><p>        ,     ,  . ,            Angular@4 (  3).  ,     ,  "     "  "     ".      Angular@4     ,      Angular@5.      Angular@6,         .  Angular   TypeScript    .     .  ,   2  ,  ‚Ä¶      ,   business value    ,     ,  ,  ,  . </p><br><p>                   ,    ,       ,   ,       2 .    :      ,  ‚Äî ,  ‚Äî .       3 React, 5 jQuery, 7 lodash. </p><br><p> : <strong>         ‚Äî ?</strong> </p><br><p>         .     -   .     ,       .     ,     .  ,    .  ,       .        ,    .   ,        ,            .      :  issue,    ,  workaround,  pull request,    ,      .          ,    ,    .        .            . </p><br><p>               ,        . ,        ,       .        .        .  :  ,       ,     -.     -      ‚Äî       .  ,            ,    -  .         , ,  ,   NPM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>     .  ,      .       . </p><br><p>         ,      ?   ‚Äî   .  <code>mobx</code> ,  <code>mobx2</code>     API  .   ‚Äî    ,    :     ,       .     <code>mobx</code>        <code>mobx2</code> ,      API.         API,     . </p><br><p>        .           ‚Äî .  ,      : </p><br><pre> <code class="plaintext hljs">var pages_count = $mol_atom2_sync( ()=&gt; $lib_pdfjs.getDocument( uri ).promise ).document().numPages</code> </pre> <br><p>  <strong> </strong>   <code>mol_atom2_sync</code>  <code>lib_pdfjs</code> ,      : </p><br><pre> <code class="plaintext hljs">npm install mol_atom2_sync@2.1 lib_pdfjs@5.6</code> </pre> <br><p> ,   , ‚Äî   ,       .        ?    ‚Äî    ,    <code>*.meta.tree</code> ,          : </p><br><p> <strong>/.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">pack node git \https://github.com/nin-jin/pms-node.git pack mol git \https://github.com/eigenmethod/mol.git pack lib git \https://github.com/eigenmethod/mam-lib.git</code> </pre> <br><p>    .             . </p><br><h1 id="integraciya-s-npm">   NPM </h1><br><p> MAM ‚Äî    NPM . ,         ‚Äî . ,    ,     NPM      . </p><br><p>          NPM ,     $node. ,   -        -: </p><br><p> <strong>/my/app/app.ts</strong> </p><br><pre> <code class="plaintext hljs">$node.portastic.find({ min : 8080 , max : 8100 , retrieve : 1 }).then( ( ports : number[] ) =&gt; { $node.express().listen( ports[0] ) })</code> </pre> <br><p>       ,     . -    <code>lib</code>      NPM . ,     NPM- <code>pdfjs-dist</code> : </p><br><p> <strong>/lib/pdfjs/pdfjs.ts</strong> </p><br><pre> <code class="plaintext hljs">namespace $ { export let $lib_pdfjs : typeof import( 'pdfjs-dist' ) = require( 'pdfjs-dist/build/pdf.min.js' ) $lib_pdfjs.disableRange = true $lib_pdfjs.GlobalWorkerOptions.workerSrc = '-/node_modules/pdfjs-dist/build/pdf.worker.min.js' }</code> </pre> <br><p> <strong>/lib/pdfjs/pdfjs.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">deploy \/node_modules/pdfjs-dist/build/pdf.worker.min.js</code> </pre> <br><p>        ,    . </p><br><h1 id="okruzhenie-razrabotchika">   </h1><br><p>          .     <code>create-react-app</code>  <code>angular-cli</code> ,       . , ,   <code>eject</code>       .          .       ,         ,       . </p><br><p> : <strong>      ?</strong> </p><br><p>    MAM      .          . </p><br><p>      MAM  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   MAM </a> ,    : </p><br><pre> <code class="plaintext hljs">git clone https://github.com/eigenmethod/mam.git ./mam &amp;&amp; cd mam npm install npm start</code> </pre> <br><p>   8080   . ,    ‚Äî        MAM. </p><br><p>     (  ‚Äî <code>acme</code> )         (  ‚Äî <code>hello</code>  <code>home</code> ): </p><br><p> <strong>/acme/acme.meta.tree</strong> </p><br><pre> <code class="plaintext hljs">pack hello git \https://github.com/acme/hello.git pack home git \https://github.com/acme/home.git</code> </pre> <br><p>           <code>npm start</code> : </p><br><pre> <code class="plaintext hljs">npm start acme/hello acme/home</code> </pre> <br><p>         .     ‚Äî  . ,  ,   .     ‚Äî   : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://t.me/mam_mol</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456288/">https://habr.com/ru/post/de456288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456272/index.html">Was ist Android Lint und wie k√∂nnen Sie unterst√ºtzten Code schreiben?</a></li>
<li><a href="../de456274/index.html">Psychologen: Sexroboter f√ºhren zu einer Zunahme der Anzahl von Menschen ohne ein Paar, die keine Beziehung zu anderen Menschen ben√∂tigen</a></li>
<li><a href="../de456276/index.html">Was sind Informationen?</a></li>
<li><a href="../de456280/index.html">Erste Schritte mit stm32 oder meine Fehler nicht wiederholen</a></li>
<li><a href="../de456282/index.html">Mehrdimensionale Grafiken in Python - von dreidimensional bis sechsdimensional</a></li>
<li><a href="../de456290/index.html">Telegramm Unbegrenztes Netzwerklaufwerk. Kostenlos</a></li>
<li><a href="../de456294/index.html">Unterschiede zwischen LabelEncoder und OneHotEncoder in SciKit Learn</a></li>
<li><a href="../de456296/index.html">Die Welt der dreidimensionalen Hypersph√§re. Geod√§tische Strahlverfolgung in einem geschlossenen Universum mit sph√§rischer Geometrie</a></li>
<li><a href="../de456298/index.html">Mikroelektronik-Technologien an den Fingern: Moores Gesetz, Marketingbewegungen und warum Nanometer jetzt nicht mehr dasselbe sind. Teil 2</a></li>
<li><a href="../de456300/index.html">Zina finden</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>