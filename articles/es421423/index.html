<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂ üë©üèº‚Äçüç≥ üìî Enterprise DevOps: c√≥mo una gran empresa recolecta microservicios üìª üò• üèïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! 


 Netracker ha estado desarrollando y suministrando aplicaciones empresariales para el mercado global de operadores de telecomunicacio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Enterprise DevOps: c√≥mo una gran empresa recolecta microservicios</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/netcracker/blog/421423/"><p>  Hola a todos! </p><br><p>  Netracker ha estado desarrollando y suministrando aplicaciones empresariales para el mercado global de operadores de telecomunicaciones durante muchos a√±os.  El desarrollo de tales soluciones es bastante complicado: cientos de personas participan en proyectos y el n√∫mero de proyectos activos en las decenas. </p><br><p>  Anteriormente, los productos eran monol√≠ticos, pero ahora nos estamos moviendo con confianza hacia aplicaciones de microservicio.  DevOps se enfrent√≥ a una tarea bastante ambiciosa: proporcionar este salto tecnol√≥gico. </p><br><p>  Como resultado, obtuvimos un concepto de ensamblaje exitoso, que queremos compartir como una mejor pr√°ctica.  La descripci√≥n de la implementaci√≥n con detalles t√©cnicos ser√° bastante voluminosa; no lo haremos en el marco de este art√≠culo. </p><a name="habracut"></a><br><p>  <i>En el caso general, el ensamblaje es la transformaci√≥n de algunos artefactos en otros.</i> <i><br></i> </p><br><h2>  A quien le interesar√° </h2><br><p>  Aquellas empresas que suministran software listo para usar a una organizaci√≥n completamente externa y cobran por √©l. </p><br><p>  As√≠ es como se ver√≠a el desarrollo sin entrega externa: </p><br><ul><li>  El departamento de TI de la planta desarrolla software para su empresa. </li><li> La empresa se dedica a la contrataci√≥n externa para un cliente extranjero.  El cliente compila y opera este c√≥digo independientemente en su propio servidor web. </li><li>  La compa√±√≠a suministra software a clientes externos, pero bajo una licencia de c√≥digo abierto.  La mayor parte de la responsabilidad queda aliviada. </li></ul><br><p>  Si no se enfrenta a un suministro externo, gran parte de lo que se escribe a continuaci√≥n parecer√° redundante o incluso paranoico. </p><br><p>  En la pr√°ctica, todo debe hacerse de conformidad con los requisitos internacionales para las licencias y el cifrado utilizados, de lo contrario surgir√°n al menos consecuencias legales. </p><br><p>  Un ejemplo de violaci√≥n es tomar el c√≥digo de una biblioteca con una licencia GPL3 e incrustarlo en una aplicaci√≥n comercial. </p><br><h2>  La aparici√≥n de microservicios requiere cambio </h2><br><p>  Hemos adquirido una amplia experiencia en el montaje y entrega de aplicaciones monol√≠ticas. </p><br><p>  Varios servidores Jenkins, miles de trabajos de CI, varias l√≠neas de ensamblaje totalmente automatizadas basadas en Jenkins, docenas de ingenieros dedicados de lanzamiento, su propio grupo de expertos en gesti√≥n de la configuraci√≥n. </p><br><p>  Hist√≥ricamente, el enfoque en la empresa era este: los desarrolladores escriben el c√≥digo fuente y DevOps inventa y escribe la configuraci√≥n del sistema de ensamblaje. </p><br><p>  Como resultado, ten√≠amos dos o tres configuraciones de ensamblaje t√≠picas dise√±adas para operar en el ecosistema corporativo.  Esquem√°ticamente, se ve as√≠: </p><br><img src="https://habrastorage.org/webt/pr/hi/rm/prhirmtpwufl-vfhheebwfaujpg.png"><br><p>  La herramienta de compilaci√≥n suele ser hormiga o experto, y algo se implementa mediante complementos disponibles p√∫blicamente, algo se escribe solo.  Esto funciona bien cuando una empresa utiliza un conjunto limitado de tecnolog√≠as. </p><br><p>  <i>Los microservicios difieren de las aplicaciones monol√≠ticas principalmente en la variedad de tecnolog√≠as.</i> </p><br><p>  Resulta muchas configuraciones de ensamblaje para al menos cada lenguaje de programaci√≥n.  El control centralizado se vuelve imposible. </p><br><p>  Es necesario simplificar los scripts de ensamblaje tanto como sea posible y permitir a los desarrolladores editarlos de forma independiente. </p><br><p>  Adem√°s de la compilaci√≥n y el empaquetado simples (en el diagrama en <font color="green">verde</font> ), estos scripts contienen mucho c√≥digo para la integraci√≥n con el ecosistema corporativo (en el diagrama en <font color="red">rojo</font> ). </p><br><p>  Por lo tanto, se decidi√≥ percibir el ensamblaje como una "caja negra", en la que un entorno de ensamblaje "inteligente" puede resolver todos los problemas, excepto la compilaci√≥n y el embalaje en s√≠. </p><br><p>  Al comienzo del trabajo no estaba claro c√≥mo obtener dicho sistema.  Tomar decisiones arquitect√≥nicas para las tareas de DevOps requiere experiencia y conocimiento.  ¬øC√≥mo conseguirlos?  Las opciones posibles est√°n a continuaci√≥n: </p><br><ul><li>  Busca informaci√≥n en Internet. </li><li>  Experiencia propia y conocimiento del equipo de DevOps.  Para hacer esto, es bueno hacer que este equipo de programadores tenga una experiencia vers√°til. </li><li>  Experiencia y conocimiento adquiridos fuera del equipo de DevOps.  Muchos desarrolladores de la empresa tienen buenas ideas: debe escucharlas.  La comunicaci√≥n es √∫til. </li><li>  ¬°Inventamos y experimentamos! </li></ul><br><h2>  ¬øNecesito automatizaci√≥n? </h2><br><p>  Para responder a esta pregunta, debe comprender en qu√© etapa de la evoluci√≥n se encuentran nuestros enfoques de ensamblaje.  En general, una tarea pasa por los siguientes niveles. </p><br><ol><li>  Nivel inconsciente <br><br><img width="150" src="https://habrastorage.org/webt/an/e2/uv/ane2uvhcdznwqj-bncv49oo58p8.jpeg"><br><br><p>  Necesitamos lanzar un ensamblaje por semana, nuestros muchachos est√°n bien.  Esto es natural, ¬øpor qu√© hablar de eso? </p></li><li>  El nivel de "artesano", que finalmente se transforma en el nivel de "esquivador" <br><br><img width="150" src="https://habrastorage.org/webt/ck/mc/-a/ckmc-a4-76nvtsanjjwf4ilsf-i.gif"><br><br><p>  Es necesario producir dos ensamblajes por d√≠a de manera estable y sin errores.  Tenemos a Vasya, lo hace bien, y nadie m√°s que √©l gasta esta vez. </p></li><li>  Nivel de manufactura <br><br><img width="150" src="https://habrastorage.org/webt/hw/_x/57/hw_x572z1bstsfv4gcp9ntekdho.jpeg"><br><br><p>  Las cosas han ido muy lejos.  Necesitas 20 asambleas por d√≠a, Vasya no puede hacer frente, y ahora un equipo de diez personas ya est√° sentado.  Tienen un jefe, planes, vacaciones, baja por enfermedad, motivaci√≥n, trabajo en equipo, entrenamientos, tradiciones y reglas.  Esta es una especializaci√≥n, su trabajo debe ser estudiado. <br></p><br><p>  En este nivel, la tarea se separa del ejecutor concreto y, por lo tanto, se convierte en un proceso. </p><br><p>  El resultado ser√° una descripci√≥n clara, resuelta, corregida y corregida cientos de veces del proceso con texto. </p></li><li>  El nivel de "producci√≥n automatizada" <br><br><img width="150" src="https://habrastorage.org/webt/mw/2c/pt/mw2cptkfee3fmatsj6aw-21eka4.jpeg"><br><br><p>  Los requisitos modernos para los ensamblajes est√°n creciendo: todo debe ser r√°pido, confiable, se deben proporcionar 800 ensamblajes por d√≠a.  Esto es cr√≠tico, porque sin tales vol√∫menes la empresa perder√° ventajas competitivas. </p><br><p>  Se est√° produciendo una costosa automatizaci√≥n, y un par de DevOps calificados pueden mantener el proceso en ejecuci√≥n.  La ampliaci√≥n adicional ya no es un problema. </p></li></ol><br><p>  <i>No todas las tareas deben alcanzar la √∫ltima etapa de la automatizaci√≥n.</i> </p><br><p>  A menudo, un artesano con una l√≠nea de comando resolver√° los problemas de manera f√°cil y efectiva. </p><br><p>  La automatizaci√≥n "congela" el proceso, reduce el costo de operaci√≥n y aumenta el costo del cambio. </p><br><p>  Puede ir inmediatamente al ensamblaje del autom√≥vil, pero el sistema ser√° inconveniente, no mantendr√° el ritmo de los requisitos del negocio y, como resultado, quedar√° obsoleto. </p><br><h2>  ¬øQu√© son los ensamblajes y por qu√© el problema no se resuelve con sistemas de ensamblaje prefabricados? <br></h2><br><img src="https://habrastorage.org/webt/0s/s1/dk/0ss1dkrnmpubpcllntnzuuwofw0.png"><br><p>  Utilizamos la siguiente clasificaci√≥n para determinar los niveles de agregaci√≥n de ensamblaje. <br><br></p><ul><li><p>  L1  Una peque√±a parte independiente de una gran aplicaci√≥n.  Puede ser un componente, microservicio o una biblioteca auxiliar.  El ensamblaje L1 es una soluci√≥n a problemas t√©cnicos lineales: compilaci√≥n, empaquetado, trabajo con dependencias.  Maven, gradle, npm, grunt y otros sistemas de compilaci√≥n hacen un gran trabajo al respecto.  Hay cientos de ellos. </p><p>  <i>El ensamblaje L1 se debe realizar con herramientas de terceros ya preparadas.</i> </p></li><li><p>  L2 +.  Entidades de integraci√≥n.  Las entidades L1 se combinan en formaciones m√°s grandes, por ejemplo, en aplicaciones de microservicio completas.  Varias de estas aplicaciones se pueden agrupar como una soluci√≥n √∫nica.  Usamos el signo "+", porque dependiendo del nivel de agregaci√≥n de ensamblaje, se puede asignar un nivel de L3 o incluso L4. </p><br><p>  Un ejemplo de tales ensamblajes en el mundo de terceros es la preparaci√≥n de distribuciones de Linux.  Metapaquetes all√≠. </p><br><p>  Adem√°s de tareas t√©cnicas bastante complejas (como esta: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ru.wikipedia.org/wiki/Dependency_hell</a> ).  Los ensamblajes L2 + son a menudo el producto final y, por lo tanto, tienen muchos requisitos de proceso: un sistema de derechos, fijaci√≥n de personas responsables, ausencia de errores legales, suministro de diversos documentos. </p><br><p>  <i>En L2 +, la automatizaci√≥n prioriza los requisitos del proceso.</i> </p><br><p>  Si la soluci√≥n autom√°tica no funciona, ya que es conveniente para las personas interesadas, no se implementar√°. </p><br><p>  Los ensamblajes L2 + probablemente se realizar√°n mediante una herramienta patentada dise√±ada espec√≠ficamente para los procesos de la compa√±√≠a.  ¬øCrees que los gestores de paquetes de Linux solo piensan en eso? </p></li></ul><br><br><h2>  Nuestras mejores practicas </h2><br><h3>  La infraestructura </h3><br><h4>  Disponibilidad permanente de hierro. </h4><br><p>  Toda la infraestructura de ensamblaje se encuentra en servidores cerrados dentro de la red corporativa.  En algunos casos, los servicios comerciales en la nube son posibles. <br></p><br><h4>  Autonom√≠a </h4><br><p>  En todos los procesos de CI, Internet no est√° disponible.  Todos los recursos necesarios se reflejan y almacenan en cach√© internamente.  Parcialmente, incluso github.com (¬°gracias, npm!) La mayor√≠a de estos problemas los resuelve Artifactory. </p><br><p>  Por lo tanto, estamos tranquilos cuando eliminamos artefactos de Maven Central o cerramos repositorios populares.  Hay un ejemplo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">community.oracle.com/community/java/javanet-forge-sunset</a> . </p><br><p>  La duplicaci√≥n reduce significativamente el tiempo de ensamblaje, libera el canal corporativo de Internet.  Menos recursos cr√≠ticos de red aumentan la estabilidad de la construcci√≥n. </p><br><h4>  Tres repositorios para cada tipo de artefacto. </h4><br><ol><li>  Dev es un repositorio donde cualquiera puede publicar artefactos de cualquier origen.  Aqu√≠ puede experimentar con enfoques fundamentalmente nuevos sin adaptarlos a los est√°ndares corporativos desde el primer d√≠a. </li><li>  La puesta en escena es un repositorio poblado solo con una tuber√≠a de ensamblaje. </li><li>  Lanzamiento: conjuntos individuales, listos para entrega externa.  Se llena con una operaci√≥n de transferencia especial con confirmaci√≥n manual. </li></ol><br><h4>  Regla de 30 d√≠as <br></h4><br><p>  Desde los repositorios de Dev y Staging, eliminamos todo lo anterior a 30 d√≠as.  Esto ayuda a garantizar que todos tengan las mismas oportunidades de publicaci√≥n al gastar una cantidad finita de espacio en el disco del servidor. </p><br><p>  La versi√≥n se almacena para siempre, el archivado se realiza si es necesario. </p><br><h4>  Entorno de montaje limpio <br></h4><br><p>  A menudo, despu√©s de los ensamblajes, los archivos auxiliares permanecen en el sistema, lo que puede afectar otros procesos de ensamblaje.  Ejemplos tipicos: </p><br><ul><li>  el problema m√°s com√∫n es un cach√© da√±ado por un ensamblaje incorrecto (c√≥mo tratar los cach√©s, que se describe a continuaci√≥n); </li><li>  algunas utilidades, como npm, dejan los archivos de servicio en el directorio $ HOME que afectan todos los lanzamientos posteriores de estas utilidades; </li><li>  un ensamblado particular puede gastar todo el espacio en disco en alguna partici√≥n / tmp, lo que conducir√° a una falta de disponibilidad general del entorno. </li></ul><br><p>  Por lo tanto, es mejor abandonar el entorno unificado a favor de los contenedores acoplables.  Los contenedores deben contener solo el software necesario para un ensamblaje espec√≠fico con versiones fijas. </p><br><p>  DevOps mantiene una colecci√≥n de im√°genes acoplables de ensamblaje, que se actualiza constantemente.  Al principio hab√≠a unos seis, luego ten√≠a menos de 30, luego configuramos la generaci√≥n autom√°tica de im√°genes de la lista de software.  Ahora solo especifique requisitos como require ('maven 3.3.9', 'python') y el entorno est√° listo. </p><br><h4>  Autodiagn√≥stico </h4><br><p>  No solo es necesario organizar el soporte de los usuarios para las solicitudes, tambi√©n debemos analizar el comportamiento de nuestro propio sistema.  Constantemente recopilamos registros, buscamos en ellos palabras clave que muestren problemas. </p><br><p>  En un sistema "en vivo", es suficiente escribir de 20 a 30 expresiones regulares para que para cada ensamblaje pueda decir la raz√≥n de su ca√≠da en el nivel: </p><br><ul><li>  Bloqueo del servidor Git </li><li>  el espacio en disco se ha agotado; </li><li>  error de compilaci√≥n debido a la falla del desarrollador; </li><li>  Error conocido en Docker. </li></ul><br><p>  Si algo ha ca√≠do, pero no se ha detectado un solo problema conocido, esta es una ocasi√≥n para reponer la colecci√≥n de m√°scaras. </p><br><p>  Luego vamos al usuario y le decimos que tiene una compilaci√≥n y esto se puede solucionar de esta manera. </p><br><p>  Se sorprender√° de la cantidad de problemas que los usuarios no informan en soporte.  Es mejor repararlos por adelantado y en un momento conveniente.  A menudo, un error de publicaci√≥n menor se ignora durante dos semanas, y el viernes por la noche resulta que esto bloquea la salida externa. </p><br><h4>  Elegimos cuidadosamente de qu√© sistemas depende el ensamblaje <br></h4><br><p>  Idealmente, en general, garantizar la autonom√≠a completa del ensamblaje, pero la mayor√≠a de las veces esto es imposible.  Para los ensamblados basados ‚Äã‚Äãen Java, necesita al menos un artefacto para la duplicaci√≥n; consulte la autonom√≠a anterior.  Cada sistema integrado aumenta el riesgo de falla.  Es deseable que todos los sistemas funcionen en modo HA decente. </p><br><h3>  Interfaz de l√≠nea de montaje </h3><br><h4>  Interfaz √∫nica para llamar al ensamblaje </h4><br><p>  Realizamos cualquier tipo de montaje con un solo sistema.  Las asambleas de todos los niveles (L1, L2 +) se describen por c√≥digo de programa y se llaman a trav√©s de un trabajo de Jenkins. </p><br><p>  Sin embargo, este enfoque no es ideal.  Es mejor utilizar los mecanismos de generaci√≥n autom√°tica de trabajos de Jenkins: por ejemplo, 1 trabajo = 1 repositorio git o 1 trabajo = 1 rama git.  Esto lograr√° lo siguiente: </p><br><ul><li>  los registros de conjuntos heterog√©neos no se confunden en una historia en la p√°gina de trabajo de Jenkins; </li><li>  de hecho, obtienes trabajos asignados c√≥modos para un equipo o para un desarrollador;  La sensaci√≥n de comodidad se puede mejorar ajustando los gr√°ficos de los resultados de junit, cobertura, sonar. </li></ul><br><h4>  Libertad para elegir tecnolog√≠a <br></h4><br><p>  Iniciar la compilaci√≥n es una llamada al script de bash "./build.sh".  Y luego, cualquier sistema de ensamblaje, lenguajes de programaci√≥n y todo lo dem√°s que se necesitar√° para completar una tarea comercial.  Esto proporciona un enfoque para el ensamblaje como una caja negra. </p><br><h4>  Publicaci√≥n inteligente </h4><br><p>  La l√≠nea de montaje intercepta las publicaciones de la caja negra y las coloca en el almacenamiento corporativo.  Para esto, se resuelven autom√°ticamente problemas aburridos como la generaci√≥n de nombres de im√°genes de acoplador y la elecci√≥n del repositorio adecuado para su publicaci√≥n. </p><br><p>  Los repositorios de puesta en escena y lanzamiento siempre tienen orden.  Se requiere para soportar los detalles de publicaciones de diferentes tipos: maven, npm, file, docker. </p><br><h4>  Descriptor de montaje <br></h4><br><p>  Build.sh describe c√≥mo compilar c√≥digo, pero esto no es suficiente para un contenedor de ensamblaje. </p><br><p>  Tambi√©n debes saber: </p><br><ol><li>  qu√© entorno de montaje usar; </li><li>  variables de entorno disponibles en build.sh; </li><li>  qu√© publicaciones se realizar√°n; </li><li>  Otras opciones espec√≠ficas. </li></ol><br><p>  Hemos elegido una manera conveniente de describir esta informaci√≥n en forma de un archivo yaml que se parece remotamente a .gitlab-ci.yaml. </p><br><h4>  Parametrizaci√≥n de montaje <br></h4><br><p>  El usuario puede especificar par√°metros arbitrarios sin ejecutar el comando git commit justo al comienzo del ensamblaje. </p><br><p>  Hemos implementado esto definiendo variables de entorno directamente desde la interfaz de trabajo de Jenkins. </p><br><p>  Por ejemplo, transferimos la versi√≥n de la biblioteca dependiente a dicho par√°metro de ensamblaje y, en algunos casos, redefinimos esta versi√≥n a alguna experimental.  Sin dicho mecanismo, el usuario tendr√≠a que ejecutar el comando "git commit" cada vez. </p><br><h4>  Portabilidad del sistema <br></h4><br><p>  Debe poder reproducir el proceso de ensamblaje no solo en el servidor principal de CI, sino tambi√©n en la computadora del desarrollador.  Esto ayuda a depurar scripts de compilaci√≥n complejos.  Adem√°s, en lugar de Jenkins, a veces ser√° m√°s conveniente usar Gitlab CI.  Por lo tanto, el sistema de compilaci√≥n debe ser una aplicaci√≥n Java independiente.  Lo implementamos como un complemento de gradle. </p><br><h4>  Un artefacto se puede publicar con diferentes nombres. <br></h4><br><p>  Hay dos requisitos opuestos para la publicaci√≥n que pueden surgir simult√°neamente. </p><br><p>  Por un lado, para el almacenamiento a largo plazo y la administraci√≥n de versiones, es necesario garantizar la unicidad de los nombres de los artefactos publicados.  Esto al menos proteger√° los artefactos de ser sobrescritos. </p><br><p>  Por otro lado, a veces es conveniente tener un artefacto real con un nombre fijo como √∫ltimo.  Por ejemplo, el desarrollador no necesita conocer la versi√≥n exacta de la dependencia cada vez, solo puede trabajar con la √∫ltima. </p><br><p>  El artefacto en este caso se publica con dos o m√°s nombres, ya que se adapta a todos. </p><br><p>  Por ejemplo: </p><br><ol><li>  un nombre √∫nico con una marca de tiempo o UUID, para aquellos que necesitan precisi√≥n; </li><li>  el nombre "√∫ltimo" - para sus desarrolladores, que siempre recogen el √∫ltimo c√≥digo; </li><li>  el nombre "&lt;versi√≥n principal&gt; .x-latest" es para un equipo vecino que est√° listo para recoger las √∫ltimas versiones, pero solo dentro del marco de una determinada especialidad. </li></ol><br><p>  Maven hace algo similar en su enfoque de SNAPSHOT. </p><br><h4>  Menos restricciones de seguridad <br></h4><br><p>  Todos pueden comenzar el montaje.  Esto no da√±ar√° a nadie, ya que el ensamblaje solo crea artefactos. </p><br><h3>  Cumplimiento legal </h3><br><h4>  Control de interacciones externas del proceso de montaje. </h4><br><p>  El ensamblaje no puede usar nada prohibido en el proceso de su trabajo. </p><br><p>  Para esto, se implementa el registro del tr√°fico de red y el acceso a los cach√©s de archivos.  Obtenemos el registro de la actividad de red del ensamblaje en forma de una lista de URL con hashes sha256 de los datos recibidos.  Adem√°s, cada url se valida: </p><br><ol><li>  lista blanca est√°tica; </li><li>  base de datos din√°mica de artefactos permitidos (por ejemplo, para dependencias de maven-, rpm-, npm-).  Cada adicci√≥n se considera individualmente.  Un permiso autom√°tico o una prohibici√≥n de uso puede funcionar, y tambi√©n puede comenzar una larga discusi√≥n con los abogados. </li></ol><br><h4>  Contenido transparente de los artefactos publicados. <br></h4><br><p>  A veces, la tarea es proporcionar una lista de software de terceros dentro de cualquier ensamblaje.  Para hacer esto, crearon un analizador de composici√≥n simple que analiza todos los archivos y archivos en el ensamblado, reconoce al tercero por hash y hace un informe. </p><br><h4>  El c√≥digo fuente emitido no se puede eliminar de GIT <br></h4><br><p>  A veces es posible que necesite encontrar el c√≥digo fuente mirando el artefacto binario compilado hace dos a√±os.  Para hacer esto, es necesario asignar etiquetas en Git autom√°ticamente con salida externa, as√≠ como prohibir su eliminaci√≥n. </p><br><h3>  Logistica y Contabilidad <br></h3><br><h4>  Todos los ensamblajes se almacenan en la base de datos. </h4><br><p>  Usamos el repositorio de archivos en Artifactory para estos fines.  Contiene toda la informaci√≥n de respaldo: qui√©n lo lanz√≥, cu√°les fueron los resultados de los controles, qu√© artefactos se publicaron, qu√© git hash se utiliz√≥, etc. </p><br><h4>  Sabemos c√≥mo reproducir el ensamblaje con la mayor precisi√≥n posible </h4><br><p>  Seg√∫n los resultados del montaje, almacenamos la siguiente informaci√≥n: </p><br><ul><li>  el estado exacto del c√≥digo que se recopil√≥; </li><li>  con qu√© par√°metros se realiz√≥ el lanzamiento; </li><li>  qu√© comandos se llamaron; </li><li>  qu√© acceso a los recursos externos ocurri√≥; </li><li>  entorno de montaje usado. </li></ul><br><p>  Si es necesario, podemos responder con precisi√≥n la pregunta de c√≥mo se ensambl√≥. </p><br><h4>  Comunicaci√≥n bidireccional de la asamblea con el boleto JIRA <br></h4><br><p>  Aseg√∫rese de poder resolver los siguientes problemas: </p><br><ol><li>  para el ensamblaje, cree una lista de boletos JIRA incluidos en √©l; </li><li>  escriba en el boleto JIRA en qu√© ensambles est√° incluido. </li></ol><br><p>  Se proporciona una estrecha comunicaci√≥n bidireccional entre el ensamblado y git commit.  Y luego, a partir del texto de los comentarios, ya puede encontrar todos los enlaces a JIRA. </p><br><h3>  Velocidad </h3><br><h4>  Sistema de montaje de cach√©s </h4><br><p>  La ausencia de un cach√© experto puede aumentar el tiempo de construcci√≥n en una hora. </p><br><p>  El cach√© viola el aislamiento del entorno del ensamblaje y la limpieza del ensamblaje.  Este problema se puede resolver determinando su origen para cada artefacto almacenado en cach√©.  Tenemos cada archivo de cach√© asociado con un enlace https desde el que se descarg√≥ una vez.  Adem√°s, procesamos la lectura de un cach√© como direcci√≥n de red. </p><br><h4>  Cach√©s de recursos de red </h4><br><p>  El crecimiento geogr√°fico de la empresa lleva a la necesidad de transferir archivos de 300 MB entre continentes.  Se gasta mucho tiempo, especialmente si tiene que hacer esto con frecuencia. </p><br><p>  Repositorios de Git, im√°genes acoplables de entornos de ensamblaje, almacenamiento de archivos: todo debe almacenarse en cach√© cuidadosamente.  Bueno, por supuesto, peri√≥dicamente limpio. </p><br><h4>  Montaje - lo m√°s r√°pido posible, todo lo dem√°s - luego </h4><br><p>  La primera etapa: hacemos el montaje e inmediatamente, sin gestos innecesarios, damos el resultado. </p><br><p>  La segunda etapa: validaci√≥n, an√°lisis, contabilidad y otra burocracia.  Esto puede hacerse ya en un trabajo separado de Jenkins y sin l√≠mites de tiempo estrictos. </p><br><h2>  Cual es el resultado </h2><br><ol><li>  Lo principal es que el <i>ensamblaje se ha vuelto claro para los desarrolladores</i> , ellos mismos pueden desarrollarlo y optimizarlo. </li><li>  La base ha sido creada para construir procesos de negocio que dependen del ensamblaje: instalaci√≥n, administraci√≥n de problemas, pruebas, administraci√≥n de versiones, etc. </li><li>  El equipo de DevOps ya no escribe scripts de ensamblaje: los desarrolladores lo hacen. </li><li>  Los requisitos corporativos complejos se convirtieron en un informe transparente con una lista final de verificaciones. </li><li>  Cualquiera puede construir cualquier repositorio simplemente llamando a build.sh a trav√©s de una √∫nica interfaz.  Es suficiente para √©l simplemente especificar las coordenadas git del c√≥digo fuente.  Esta persona puede ser gerente de equipo, ingeniero de control de calidad / TI, etc. </li></ol><br><p>  Y unos pocos n√∫meros </p><br><ol><li>   .   15    Jenkins job    build.sh.   15    docker-,   ,  .      .        . </li><li>  .         .      2200 .   ‚Äî  on-commit-. </li><li>      300 git-,     . </li><li>      30   ,   (25 ) ‚Äî  docker. </li><li>      ,     : <br><ol><li> glide, golang, promu; </li><li> maven, gradle; </li><li> python &amp; pip; </li><li> ruby; </li><li> nodejs &amp; npm; </li><li> docker; </li><li> rpm build tools &amp; gcc; </li><li>  Android   ADT; </li><li>  ; </li><li>    legacy-; </li><li>   . </li></ol><br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es421423/">https://habr.com/ru/post/es421423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es421413/index.html">Acceso adecuado a los m√©todos de interfaz predeterminados a trav√©s de la reflexi√≥n en Java 8, 9, 10</a></li>
<li><a href="../es421415/index.html">Magic Leap - basura triste</a></li>
<li><a href="../es421417/index.html">Cafetera para adictos al caf√©, o cafetera m√≥vil Wacaco</a></li>
<li><a href="../es421419/index.html">Oda al n√≠quel "espumado", zafiros inexistentes y al viceministro sovi√©tico: ic√≥nico OTTO SX-P1 en Jap√≥n, Estados Unidos y la URSS</a></li>
<li><a href="../es421421/index.html">LAppS: Medio mill√≥n de mensajes de 1KB-WebSocket por segundo con TLS en una CPU</a></li>
<li><a href="../es421425/index.html">Domar y consolidar: la historia de mudarse a Oracle Supercluster</a></li>
<li><a href="../es421429/index.html">LSTM - Precios din√°micos ANN en el comercio minorista de art√≠culos para el hogar</a></li>
<li><a href="../es421431/index.html">Gesti√≥n del tiempo o gesti√≥n eficaz del caos</a></li>
<li><a href="../es421433/index.html">Quedaba exactamente un d√≠a antes de que se iniciara el servidor.</a></li>
<li><a href="../es421435/index.html">"¬øPor qu√© estamos haciendo esto?" - Creador de Prisma y ex l√≠der del proyecto VK sobre su nuevo proyecto secreto.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>