<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§üüèª üôéüèª üïõ Domotique avec prise en charge des langages de programmation industriels ou BluePill x405 üë©üèª‚Äçüè´ ü§¨ üíÜüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="D√©but de l'examen 
 Donc, mes chers coll√®gues, nous commen√ßons l'examen par ce que nous voulons vraiment souligner ici. Dans l'article, je veux examin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Domotique avec prise en charge des langages de programmation industriels ou BluePill x405</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477478/"><h3>  D√©but de l'examen </h3><br>  Donc, mes chers coll√®gues, nous commen√ßons l'examen par ce que nous voulons vraiment souligner ici.  Dans l'article, je veux examiner les √©l√©ments typiques de la construction d'un programme de contr√¥leur industriel et montrer comment ils peuvent √™tre appliqu√©s aux syst√®mes domotiques.  Et le plus important est de trouver la r√©ponse √† la question - ce qui est n√©cessaire pour cela. <br><br><h3>  Domotique - Applications </h3><br>  Home sweet home ... Avez-vous vraiment besoin d'un contr√¥leur?  La r√©ponse est simple - tout d√©pend de ce qui est disponible dans une telle maison.  Bien s√ªr, si vous venez d'avoir un appartement et que l'automatisation consiste √† g√©rer votre centre multim√©dia √† domicile et la climatisation en √©t√©, tout ce qui est √©crit ci-dessous peut √™tre compl√®tement inint√©ressant.  Mais si votre hobby n'est pas seulement de pousser le canap√© (ce qui est l√† pour se cacher, je l'ai moi-m√™me parfois remarqu√©), alors l'article peut √™tre tr√®s utile. <br><a name="habracut"></a><br>  Essayons donc de comprendre comment des moyens improvis√©s peuvent simplifier notre vie difficile.  √Ä titre d'exemple, nous utilisons la situation r√©elle - une pompe dans un puits de 70 m√®tres de profondeur, que deux voisins ont mis dans un pli.  Ils l'ont install√© au printemps, quand il y avait beaucoup d'eau dans le puits, et en g√©n√©ral, c'√©tait juste chaud et bon.  Mais le temps passe et les questions commencent - pour faire monter l'eau √† une telle profondeur, vous avez besoin d'√©lectricit√©, pour laquelle vous devez payer.  Le sous-sol et le plancher technique ont √©t√© inond√©s plusieurs fois - ils ont juste oubli√© d'√©teindre la pompe ... Oui, et ce n'est pas tr√®s pratique de la contr√¥ler manuellement - vous devez fermer un robinet, en ouvrir un autre, puis allumer la pompe et regarder le niveau d'eau dans le r√©servoir. <br><br>  Vaut-il la peine d'y consacrer votre temps, qui fait d√©j√† d√©faut?  Un esprit curieux commence √† chercher des solutions et, bien s√ªr, le trouve!  Une liste de t√¢ches √† mettre en ≈ìuvre est n√©e. <br><br><ol><li>  Le paiement de l'√©lectricit√© consomm√©e n'a pas √† √™tre commun - cela signifie que nous installerons deux d√©marreurs, chacun √©tant connect√© √† son propre compteur √©lectrique. </li><li>  La pompe ne doit pas tomber en panne en raison du manque d'eau - cela signifie que nous allons installer un capteur pour la course ¬´s√®che¬ª de la pompe.  S'il n'y a pas d'eau, il suffit de ne pas d√©marrer la pompe, et si cela fonctionne, nous nous arr√™tons d'urgence. </li><li>  La pompe ne doit pas fonctionner trop longtemps, par exemple plus de 25 minutes.  Le d√©passement de cette dur√©e indique que le syst√®me quitte son mode de fonctionnement normal. </li><li>  Le remplissage des conteneurs doit se faire sans intervention humaine, c'est-√†-dire automatiquement, ce qui signifie commencer au niveau inf√©rieur et s'arr√™ter au niveau sup√©rieur. </li><li>  Un seul r√©servoir doit √™tre rempli, c'est-√†-dire que nous installons deux vannes - pour alimenter en eau un ensemble dans chaque r√©servoir. </li><li>  La pause entre les d√©marrages de la pompe doit √™tre d'au moins 30 minutes. </li><li>  Une coupure de courant ne devrait pas affecter l'algorithme de fonctionnement, s'il √©tait actif.  Malgr√© tout, l'algorithme doit √™tre termin√©. </li></ol><br>  Les t√¢ches sont simples et peuvent √™tre r√©solues de cent, voire mille fa√ßons.  Mais le titre de l'article parle de lui-m√™me, et nous emprunterons un chemin √©pineux.  Utilisons un contr√¥leur virtuel (pour l'instant, bien s√ªr), qui fera tout cela. <br><br><h3>  Comment fonctionne un contr√¥leur industriel? </h3><br>  Bien s√ªr, nous allons clarifier tout de suite - nous parlons des soi-disant contr√¥leurs logiques programmables, ou PLC pour faire court.  Qu'est-ce qui se cache sous cette abr√©viation?  Et voici ce qui est cach√© - une incroyable vari√©t√© de solutions mat√©rielles, un grand nombre de produits logiciels et d'utilitaires.  Une question raisonnable se pose imm√©diatement - comment alors utiliser tout ce bien?  Est-il vraiment n√©cessaire d'√©tudier la partie mat√©rielle √† partir de z√©ro et de trouver du temps et de l'argent pour chaque nouvel appareil afin de suivre des cours de formation et d'acqu√©rir les comp√©tences n√©cessaires pour travailler avec chaque appareil? <br><br>  La r√©ponse est non, ce n'est pas n√©cessaire.  Tout a √©t√© fait avant nous.  Il ne reste plus qu'√† √©tudier et apprendre √† utiliser.  C'est ce que je propose de faire plus loin - une petite immersion dans la norme CEI 61131. R√©v√©lons quelles parties cette norme contient. <br><br><ul><li>  CEI 61131-1: Informations g√©n√©rales. </li><li>  CEI 61131-2: Exigences et essais des √©quipements. </li><li>  CEI 61131-3: langages de programmation. </li><li>  CEI 61131-4: Guide de l'utilisateur. </li><li>  CEI 61131-5: Communications. </li><li>  CEI 61131-6: S√©curit√© fonctionnelle. </li><li>  CEI 61131-7: Programmation de commande floue. </li><li>  CEI 61131-8: Lignes directrices pour l'utilisation et la mise en ≈ìuvre des langages de programmation. </li><li>  CEI 61131-9: Interface de communication num√©rique monopoint pour petits capteurs et actionneurs. </li><li>  CEI 61131-10: Format d'√©change bas√© sur XML ouvert API. </li></ul><br>  Mais nous ne nous attarderons pas sur le sujet des normes et, pour le dire simplement, le contr√¥leur fonctionne g√©n√©ralement de mani√®re cyclique - interrogation de l'√©tat des entr√©es, l'interpr√®te ex√©cutant le programme de contr√¥le, d√©finition de l'√©tat des sorties, ex√©cution des t√¢ches de maintenance interne et retour √† nouveau √† l'interrogation de l'√©tat des entr√©es.  C‚Äôest assez ennuyeux, mais efficace et efficient.  Un programme de contr√¥le est un pseudo-code cr√©√© √† l'aide d'un environnement de programmation. Habituellement, un tel pseudo-code est une s√©quence cod√©e binaire, qui n'a rien √† voir avec les langages de programmation habituels.  Bien que pour l'utilisateur, il soit pr√©sent√© sous une forme compr√©hensible - pour le contr√¥leur, une vue compl√®tement diff√©rente est utilis√©e.  Un bon exemple est un petit programme, pr√©sent√© sous forme d'IL, LD et sous forme d'encodage binaire pour le contr√¥leur (hmm, il n'y a m√™me pas de terme sp√©cial).  Sous le becquet, un petit exemple est montr√©. <br><br><div class="spoiler">  <b class="spoiler_title">Options d'affichage du programme</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1v/zd/el/1vzdelgzkvbgvb9jdf8kzb66un8.png"><br></div></div><br>  Alors, qu'est-ce qui rend ce programme utile?  Oui, elle ne fait rien - si la valeur du merker M8010 est 1, alors 1. sera √©crit dans la sortie avec l'adresse Y377. Par cons√©quent, la m√™me chose est pour 0. <br>  L'un des plus grands avantages d'une telle impl√©mentation est la possibilit√© de d√©charger le programme de la m√©moire du contr√¥leur, de l'ouvrir pour le modifier dans un √©diteur d'une mani√®re compr√©hensible pour les humains, de compiler (ce terme est conditionnel ici) et de le recharger dans la m√©moire du contr√¥leur.  De plus, certains contr√¥leurs enregistrent m√™me des commentaires et des noms de variables. <br><br><h3>  Comment programmer le contr√¥leur? </h3><br>  Bien s√ªr, un logiciel sp√©cialis√© est n√©cessaire.  Apr√®s de longues recherches et exp√©riences, Autoshop v3.02 de Inovance Control a √©t√© choisi.  Il est remarquable en ce qu'il est gratuit, disponible en t√©l√©chargement gratuit et qu'il prend en charge les contr√¥leurs compatibles avec les contr√¥leurs Mitsubishi.  Et il prend en charge le travail non seulement via les ports s√©rie, mais √©galement via Ethernet.  Lien vers la version que nous utilisons, sous le spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Lien pour t√©l√©charger √† partir du disque Yandex</b> <div class="spoiler_text">  <a href="https://yadi.sk/d/nXaAKljCPvqR5Q">Autoshop v3.02</a> <br></div></div><br>  Eh bien, nous avons install√© le programme et maintenant une autre question - comment √©crire le programme sur notre contr√¥leur?  Puisque nous travaillerons avec un p√©riph√©rique sp√©cifique, nous installerons des pilotes sp√©cifiques pour le port COM virtuel.  Pour sauvegarder les conclusions et pour simplifier, j'ai d√©cid√© d'utiliser le port USB de la carte pour la connexion.  Pilotes sous le spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Pilotes sur disque Yandex</b> <div class="spoiler_text">  <a href="https://yadi.sk/d/n6kmoszV3TexWj">Pilotes</a> <br></div></div><br>  Apr√®s avoir install√© les pilotes et connect√© la carte via mini-USB, vous pouvez v√©rifier si tout se passe bien avec vous.  Pour ce faire, cliquez avec le bouton droit sur My Computer-Management-Device Manager-Ports (COM et LPT).  Vous devriez voir une telle fen√™tre comme sous un spoiler.  Le num√©ro de port COM sur votre syst√®me peut varier. <br><br><div class="spoiler">  <b class="spoiler_title">Gestionnaire d'appareils</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/co/vs/o_/covso_rwe7duas9oaeg8hmqbqpi.png"><br></div></div><br>  Vous pouvez maintenant s√©lectionner Tools-Communication Setting dans le menu AutoShop, s√©lectionnez Serial dans la fen√™tre qui appara√Æt, sp√©cifiez le num√©ro de port et cliquez sur le bouton Test.  Vous devriez avoir une fen√™tre comme celle-ci sous un spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">Connexion r√©ussie √† la carte</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xf/l9/xf/xfl9xfc7ey_ktixw-tj3mh8f6cy.png"><br></div></div><br>  Mais si quelque chose ne fonctionne pas pour vous, √©crivez en PM ou dans un commentaire.  Nous allons certainement vous aider. <br><br><h3>  √âl√©ments du programme, sans lesquels il sera triste </h3><br>  Ci-apr√®s, nous consid√©rerons le langage des diagrammes en √©chelle, ou le soi-disant LD.  Examinons uniquement les √©l√©ments que nous utiliserons plus tard. <br><br><ul><li>  Les entr√©es et sorties sont discr√®tes.  Ils sont d√©sign√©s par X et Y. Con√ßus pour recevoir et √©mettre des signaux discrets. </li><li>  La zone de m√©moire de M merkers M. Elle peut prendre deux √©tats - on et off. </li><li>  Les minuteries sont d√©sign√©es par T. Con√ßu pour compter le temps de 0,1 √† 3276,7 secondes. </li><li>  La zone des registres D. Elle a une dimension de cellule de 16 bits, mais peut √©galement √™tre adress√©e comme une cellule de 32 bits. </li></ul><br><h3>  Cheval sph√©rique dans le vide, ou registres d'adressage indirect </h3><br>  Les registres d'adressage indirect sont d√©sign√©s V et Z et peuvent √™tre adress√©s de V0 √† V7 et de Z0 √† Z7.  Pourquoi peuvent-ils √™tre utilis√©s?  Voyons comment ils fonctionnent g√©n√©ralement.  Cet enregistrement D1000V0 √† l'aspect fou signifie que l'adresse de cellule calcul√©e comme adresse D1000 plus la valeur √©crite dans le registre d'adressage indirect sera utilis√©e.  S'il y en a 15, alors nous utiliserons l'adresse de la cellule D1015.  C'est tr√®s pratique lorsque vous travaillez avec des tableaux de donn√©es ou avec un contr√¥le de table - il nous suffit de changer la valeur du registre d'index, et nous obtenons les valeurs de ces cellules de m√©moire qui ont √©t√© adress√©es.  Mais m√™me si nous ne les appliquerons pas, nous en parlerons dans la prochaine publication. <br><br><h3>  Un peu sur la visualisation du programme ou le d√©bogage en ligne </h3><br>  Si vous √™tes programmeur et que vous venez de terminer l'√©criture d'un programme, l'√©tape suivante est le d√©bogage.  Et ici, la question se pose - comment le faire.  Encore une fois, il y a beaucoup d'options, mais je vais parler de celle que nous utiliserons plus loin.  L'√©diteur d'environnement de programmation vous permet de montrer visuellement quelles valeurs de bits et de variables sont actuellement dans la m√©moire du contr√¥leur en appuyant sur un bouton.  Un exemple tr√®s r√©v√©lateur sera - sous l'affichage hors ligne et en ligne des spoilers du programme dans l'√©diteur. <br><br><div class="spoiler">  <b class="spoiler_title">Bouton pour passer en mode d'affichage variable</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5-/nr/8z/5-nr8zfe8q1j1zcmwlmoxg5kfw0.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Type de programme en mode de visualisation des valeurs des variables</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-_/ox/gx/-_oxgxsuqn4x90y1d8yqgndcbjq.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Type de programme en mode √©dition</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pl/f9/tj/plf9tjq0u2vx6tnufkrlao_klhu.png"><br></div></div><br>  Un peu plus sur les processus qui se produisent lorsque vous cliquez sur le bouton En ligne.  Le programme compile rapidement une liste de variables visibles et, une fois termin√©, l'√©crit dans un tampon de contr√¥leur sp√©cifique.  Apr√®s cela, le contr√¥leur pr√©pare les donn√©es de cette liste et les place dans un autre tampon.  Le programme lit les valeurs de ce tampon et les affiche sous forme de valeurs sur le diagramme synoptique.  Si vous faites d√©filer un petit programme dans la fen√™tre d'affichage et modifiez les variables visibles, ce cycle se r√©p√©tera √† nouveau ... <br><br><h3>  Qui appelle Hamlet, ou sur sc√®ne BluePill x405 </h3><br>  Avez-vous remarqu√© que le march√© ne rencontre pas de simples cartes m√®res comme une tablette bleue, mais √©quip√©es de processeurs comme F405 et plus?  Personnellement, je n'ai rencontr√© que des pierres F401, mais c'est un niveau l√©g√®rement diff√©rent ... Je suis facile √† gravir, et pour mes exp√©riences, sans y r√©fl√©chir √† deux fois, j'ai effectu√© un paiement dans le bon vieux P-CAD 2006 et command√© aupr√®s des Chinois sur l'un des sites de commande rapide.  Bien s√ªr, en couleur, c'est une tablette verte, mais en termes de signification, j'ai d√©cid√© de laisser le nom BluePill, mais indiquant qu'il est d√©j√† x405.  Le r√©sultat sous les spoilers est une photo de la carte BluePill x405. <br><br><div class="spoiler">  <b class="spoiler_title">Vue de dessus</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/kv/ha/hs/kvhahsy1nncrjqogvfafgr1jn10.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Vue de dessous</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/5z/ar/ts/5zartsne1u9zbrijwlz6txgknp8.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Concept et gerber sur github</b> <div class="spoiler_text">  <a href="https://github.com/Greeds74/BluePill-x405/tree/master/Habr">Github</a> <br></div></div><br>  Un peu pourquoi cette planche est si remarquable?  Apr√®s tout, il n'y a eu que des milliers de tentatives pour cr√©er des clones de bluepill!  Mais la diff√©rence est la suivante: j'attache un micrologiciel √† cette carte, ce qui la transformera en un noyau qui ex√©cute un programme compatible avec les contr√¥leurs industriels Mitsubishi dans un syst√®me de commande.  Ce miracle est calcul√© sur 16 entr√©es, 16 sorties, 2 entr√©es analogiques, 3 UART avec prise en charge DE pour RS485, 1 bus ma√Ætre monofil.  L'UART peut fonctionner en tant que bus ma√Ætre Modbus RTU et en tant qu'esclave.  Et ils peuvent travailler de mani√®re totalement ind√©pendante. <br>  Mais ce n'est pas tout - si vous connectez une batterie 3V √† la broche VBAT, alors non seulement l'horloge, mais aussi les temporisateurs, compteurs, merkers et les 1000 premiers registres √† usage g√©n√©ral D conserveront leurs valeurs. Et il y a 8000 registres. <br><br>  Anticipant les questions, je dirai tout de suite - oui, le logiciel est bas√© sur un syst√®me d'exploitation en temps r√©el.  Oui, le DMA est utilis√© dans la mesure du possible.  Ces fonctionnalit√©s permettent de travailler sans changement significatif du temps de cycle √† des charges de communication √©lev√©es.  Cette version est la deuxi√®me r√©vision, r√©vis√©e et compl√©t√©e. <br><br>  Cette carte peut √™tre enti√®rement programm√©e par GX FXDeveloper et IEC Developer et GX Works. <br><br><h3>  Le sort de la pompe et de deux r√©servoirs </h3><br>  R√©solvons maintenant ce probl√®me - d'autant plus que tous les outils pour cela sont disponibles.  Afin de ne pas trop tra√Æner, j'ai √©crit un programme, je l'ai divis√© en plusieurs parties (les soi-disant r√©seaux ou cha√Ænes de travail), et je vais montrer chacune d'elles ici et commenter. <br><br><div class="spoiler">  <b class="spoiler_title">Net 1 - premi√®re ex√©cution du programme</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mt/se/6l/mtse6lkxocvzicroixvaxkp986y.png"><br></div></div><br>  Le registre D1000 stocke le temps n√©cessaire pour supprimer le rebond de contact.  En fait, c'est d√©j√† dans le programme - mais je veux le montrer plus clairement.  Le registre D1001 est responsable du temps de protection de la pompe.  Nous y √©crivons 15 000 ou 1 500 secondes.  Ensuite, nous avons une cha√Æne de r√©initialisation de sauvegarde - en cas de probl√®me, vous pouvez envoyer le signal 1 √† l'entr√©e X14 et red√©marrer la carte.  Dans ce cas, 0 est √©crit dans les registres D0 et D1, et les merckers M98 et M99 sont r√©initialis√©s. <br><br><div class="spoiler">  <b class="spoiler_title">Net 2 - traitement du signal d'entr√©e</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q2/c2/0r/q2c20rgbj45frsx31p4sisxv_tg.png"><br></div></div><br>  Ici, avec l'aide de minuteries, on se d√©barrasse du rebond des contacts.  Pour ce faire, utilisez un d√©lai de 200 millisecondes.  Pour m'assurer que dans le futur programme lors du changement de l'adresse d'entr√©e du contact, il n'est pas n√©cessaire de r√©√©crire un grand nombre de cha√Ænes, j'utilise des merkers interm√©diaires (par exemple, M102).  Il convient √©galement de noter que le marchand du syst√®me M8003 est utilis√© ici - il s'allume apr√®s le premier cycle d'ex√©cution du programme.  Mais le M8002 Merker n'est actif qu'au premier cycle du programme, et cela peut et doit √™tre utilis√© pour d√©finir les valeurs initiales. <br><br><div class="spoiler">  <b class="spoiler_title">Net 3 - remplissage du r√©servoir 1.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vr/cp/h4/vrcph4mhgoiir-hgrghd92tpiew.png"><br></div></div><br>  Le remplissage du r√©servoir 1 est totalement identique au remplissage du r√©servoir 2 √† l'exception des adresses.  Le dessin ne correspondait pas du tout - mais vous feriez mieux de le regarder juste en ouvrant le projet.  Qu'est-ce qui est remarquable avec cette unit√© de contr√¥le?  La pr√©sence de protections et de blocages qui permettent des m√©canismes de d√©marrage et d'arr√™t sans choc.  Par exemple, apr√®s l'ouverture de la vanne 1, ce n'est qu'apr√®s 700 ms qu'une commande sera lanc√©e pour d√©marrer le d√©marreur, qui allumera la pompe. <br><br>  La gestion ici ne pr√©voit pas de mode manuel.  De plus, une protection contre le fonctionnement √† sec et une protection contre un fonctionnement trop long de la pompe sont mises en ≈ìuvre. <br><br><div class="spoiler">  <b class="spoiler_title">Net 5-6 - Gestion des sorties</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sw/oi/ta/swoitandloflperaamkjr9yysak.png"><br></div></div><br>  Et ici, nous contr√¥lons les sorties conform√©ment aux verrous. <br><br>  Parmi les t√¢ches, seule la connexion de l'intervalle de protection de 30 minutes avant le red√©marrage est rest√©e non satisfaite.  Je dois dire tout de suite - dans cette version, seules les entr√©es X0-X3 et la sortie Y0-Y3 sont impl√©ment√©es, ce qui est assez suffisant pour tester le mat√©riel de cet article.  La liaison est PA4-X0, PA5-X1, PA6-X2, PA7-X3 et PB4-Y0, PB5-Y1, PB6-Y2, PB7-Y3. <br><br><h3>  Vitesse du cycle de programme - M√©thodes de mesure des droits acquis </h3><br>  Lorsque nous nous posons cette question, il nous vient imm√©diatement √† l'esprit de le faire - √©crire au contr√¥leur un tr√®s gros programme √† partir d'un certain nombre d'√©l√©ments identiques, obtenir le temps d'ex√©cution et obtenir le temps d'ex√©cution d'une commande.  Il est dit - fait, sous le programme spoiler et au nom du temps d'ex√©cution du spoiler. <br><br><div class="spoiler">  <b class="spoiler_title">7995 pas - 2,6 millisecondes</b> <div class="spoiler_text">  <a href="">8000 √©tapes</a> <br></div></div><br>  Ici, chaque √©tape est une commande, et nous obtenons que 2,6 / 7995 = 0,325 microsecondes.  Pas tr√®s rapide, mais pas mal. <br><br><h3>  FPU - √™tre ou ne pas √™tre? </h3><br>  D√©terminons maintenant la rapidit√© avec laquelle les instructions √† virgule flottante fonctionnent dans notre micrologiciel.  Il existe deux firmwares, l'un utilisant le FPU int√©gr√© et l'autre avec l'√©mulation logicielle.  Le programme ci-dessous: <br><br><div class="spoiler">  <b class="spoiler_title">Programme de calcul du temps d'ex√©cution d'une instruction</b> <div class="spoiler_text">  <a href="">Programme de 8000 pas en virgule flottante</a> <br></div></div><br>  Le firmware ci-dessous est sous le spoiler, et ils n'ont aucune restriction <br><br><div class="spoiler">  <b class="spoiler_title">Deux firmware</b> <div class="spoiler_text">  <a href="https://github.com/Greeds74/BluePill-x405/tree/master/Habr_software">Firmware</a> <br></div></div><br>  Lors de l'utilisation d'un FPU mat√©riel, le temps d'ex√©cution du programme est de 1,8 ms, ou 1,8 / 600 = 0,003 ms, ou 3 microsecondes. <br><br>  Remplacez maintenant le firmware - utilisez l'√©mulation logicielle.  Le r√©sultat est d√©j√† diff√©rent - 2,5 ms, ou 2,5 / 600 = 0,0041 ms, ou 4,1 microsecondes.  Pas mal, mais la diff√©rence est assez notable. <br><br><h3>  Conclusion </h3><br>  Malgr√© le volume important de l'article, il reste encore beaucoup de mat√©riaux qu'il serait bon de couvrir.  Donc, si cet article vous int√©resse, cet article sera suivi d'un autre.  Mais je voudrais trouver des personnes partageant les m√™mes id√©es qui veulent rejoindre le croisement de l'industrie et du domestique avec un seul but - afin que ces outils soient accessibles √† un simple profane. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477478/">https://habr.com/ru/post/fr477478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477464/index.html">Comment j'ai lanc√© Docker dans Docker et ce qui en est sorti</a></li>
<li><a href="../fr477468/index.html">Un grand aper√ßu de l'imageur thermique Seek Thermal SHOT: inspection thermique des locaux r√©sidentiels</a></li>
<li><a href="../fr477470/index.html">Sur le r√¥le des t√¢ches de test dans la vie du d√©veloppeur</a></li>
<li><a href="../fr477474/index.html">Vie et coutumes des r√™veurs</a></li>
<li><a href="../fr477476/index.html">Programmation h√©t√©rog√®ne et bo√Æte √† outils OneAPI. Poser une question √† un expert Intel</a></li>
<li><a href="../fr477484/index.html">Que pensaient-ils des programmeurs</a></li>
<li><a href="../fr477488/index.html">Neungers: les √©pices doivent couler</a></li>
<li><a href="../fr477490/index.html">Kitchen Robotics Part 2 ou un autre avatar de Blynk</a></li>
<li><a href="../fr477492/index.html">Que restera-t-il dans la salle des serveurs?</a></li>
<li><a href="../fr477494/index.html">1. Analyse des logiciels malveillants √† l'aide de Check Point forensics. R√©seau de sablage</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>