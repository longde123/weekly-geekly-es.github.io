<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚¨úÔ∏è üë®üèΩ‚Äçüíº ‚õÑÔ∏è Umfangreiche Zuweisung von Rechten an Dom√§nenbenutzer aus verschiedenen Gesamtstrukturen ‚ú® ü¶Ö üë©üèº‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Anscheinend lautet mein Karma: Standardaufgaben auf alle m√∂glichen nicht-trivialen Arten umsetzen. Wenn jemand eine andere Sicht des Problems hat - bi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Umfangreiche Zuweisung von Rechten an Dom√§nenbenutzer aus verschiedenen Gesamtstrukturen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482130/">  Anscheinend lautet mein Karma: Standardaufgaben auf alle m√∂glichen nicht-trivialen Arten umsetzen.  Wenn jemand eine andere Sicht des Problems hat - bitte ich um Diskussion, um das Problem zu l√∂sen. <br><br>  Eines sch√∂nen Morgens tauchte eine interessante Aufgabe auf: Rechte an Benutzergruppen auf verschiedenen B√§llen zu verteilen, die Projektunterordner mit Dokumentenordnern enthalten.  Alles war in Ordnung und ein Skript wurde zugewiesen, das den Ordnern Rechte zuweist.  Und dann stellte sich heraus, dass die Gruppen Benutzer verschiedener Dom√§nen aus verschiedenen Gesamtstrukturen enthalten sollten ( <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25B5%25D1%2580%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%258F_%25D0%25BE%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D0%25B2_Active_Directory">f√ºr diejenigen, die vergessen haben, was es ist</a> ).  Angenommen, der Ball selbst wird auf Synology-Medien gehostet, die in der FB-Dom√§ne der PSI-Gesamtstruktur registriert sind.  Ziel: Benutzern von Dom√§nen in einer anderen Gesamtstruktur den Zugriff auf den Inhalt dieses Balls zu erm√∂glichen, und zwar sehr selektiv. <br><a name="habracut"></a><br>  TK zeichnete sich nach einiger Zeit in folgender Form ab: <br><br><ul><li>  2 W√§lder: PSI Forest, TG Forest. <br><br><img src="https://habrastorage.org/webt/wm/mu/ky/wmmukygta6ggezns9okz4nypuqq.png" alt="Bild"></li><li>  Jede Gesamtstruktur hat 3 Dom√§nen: PSI (ZG, PSI, FB);  TG (TG, HU, KC). </li><li>  Es besteht eine vertrauensvolle Beziehung zwischen Gesamtstrukturen. Synology sieht alle Sicherheitsgruppen in allen Gesamtstrukturen. </li><li>  Sprechblasen und Ordner / Unterordner m√ºssen √ºber FB-Dom√§nenadministratorkonten mit FullControl-Rechten verf√ºgen </li><li>  Die Namen der Sprechblasenordner sollten systematisiert werden.  Das Management handelte die Projekt-IDs aus und ich beschloss, den Projekt-IDs den Namen der Sicherheitsgruppen zuzuweisen. </li><li>  Projektordner in den Systemb√§llen sollten eine im Voraus in der XLSX-Datei vorbereitete Struktur mit entsprechenden Zugriffsberechtigungen enthalten (R / RW / NA, wobei NA - kein Zugriff). <br><br><img src="https://habrastorage.org/webt/3a/py/vo/3apyvo-2q-qkg7td0pnw-rqpvdy.png" alt="Bild"></li><li>  Es sollte m√∂glich sein, die Rechte von Benutzern / Gruppenmitgliedern eines Projekts nur auf bestimmte Verzeichnisse dieses Projekts zu beschr√§nken.  Der Benutzer hat m√∂glicherweise keinen Zugriff auf andere Verzeichnisse / Projekte, je nach Gruppenzugeh√∂rigkeit. </li><li>  Beim Anlegen eines Projektordners sollten m√∂glichst automatisch Gruppen in den entsprechenden Dom√§nen mit den Namen der entsprechenden Projekt-IDs angelegt werden. </li></ul><br><h4>  Anmerkungen zum ToR </h4><br><ul><li>  Vertrauensbildende Beziehungen geh√∂ren nicht zur TK </li><li>  Die Projekt-ID enth√§lt Zahlen und lateinische Buchstaben </li><li>  Projektbenutzerrollen f√ºr alle Dom√§nen haben generische Namen </li><li>  Vor dem Start des gesamten Projekts wird eine XLSX-Datei mit Ordnern und Berechtigungen (Zugriffsmatrix) erstellt </li><li>  Bei der Implementierung von Projekten ist es m√∂glich, Benutzergruppen in den entsprechenden Dom√§nen anzulegen </li><li>  Die Automatisierung erfolgt mit Standard-MS-Windows-Administrationstools </li></ul><br><h4>  TK-Implementierung </h4><br>  Nach der Formalisierung dieser Anforderungen wurde eine taktische Pause eingelegt, um die Methoden zum Erstellen von Verzeichnissen und zum Zuweisen von Rechten zu testen.  Es sollte nur PowerShell verwendet werden, um das Projekt nicht zu komplizieren.  Wie ich bereits schrieb, schien der Skriptalgorithmus recht einfach zu sein: <br><br><ul><li>  Registrieren Sie Gruppen mit dem aus der Projekt-ID abgeleiteten Namen (z. B. KC40587) und den entsprechenden in der Zugriffsmatrix angegebenen Rollen: KC40587-DE- f√ºr den Bearbeiter;  KC40587-PM - f√ºr Produktmanager usw. </li><li>  Rufen Sie die SIDs der erstellten Gruppen ab </li><li>  Registrieren Sie den Projektordner und die entsprechenden Verzeichnisse (die Liste der Unterordner h√§ngt von den B√§llen ab, in denen er erstellt und in der Zugriffsmatrix definiert wurde). </li><li>  Zuweisen von Rechten zu Gruppen gem√§√ü der Zugriffsmatrix zu neuen Unterverzeichnissen des Projekts. </li></ul><br>  Schwierigkeiten in Stufe 1: <br><br><ul><li>  Mangelndes Verst√§ndnis f√ºr die Art und Weise, wie die Zugriffsmatrix im Skript festgelegt wird (ein mehrdimensionales Array ist jetzt implementiert, es wird jedoch nach einer M√∂glichkeit gesucht, es basierend auf dem Inhalt der XLSX-Datei / Zugriffsmatrix zu f√ºllen.) <br><br><img src="https://habrastorage.org/webt/bx/zq/rk/bxzqrkid29fvb3dt3qvykqlgb1i.png" alt="Bild"></li><li>  die Unm√∂glichkeit, Zugriffsrechte in SMB-B√§llen auf Synology-Laufwerken mithilfe von PoSH festzulegen (https://social.technet.microsoft.com/Forums/en-US/3f1a949f-0919-46f1-9e10-89256cf07e65/error-using-setacl-on-nas -share? forum = winserverpowershell), wodurch viel Zeit verloren ging und ich alles mit dem Dienstprogramm icacls permissions editing an Skripte anpassen musste, das die Erstellung eines Zwischenspeichers mit Text- und Cmd-Dateien erforderte. </li></ul><br>  Im aktuellen Modus wird die Ausf√ºhrung von Cmd-Dateien manuell gesteuert, wenn ein Ordner f√ºr das Projekt registriert werden muss. <br><br><img src="https://habrastorage.org/webt/1p/zz/a4/1pzza4mxf3tssw6klg8elt8k_le.png" alt="Bild"><br><br>  Es stellte sich auch heraus, dass das Skript ausgef√ºhrt werden sollte, auch zum Registrieren von Gruppen in anderen Gesamtstrukturen (unter Verwendung des Begriffs Dom√§nen√ºbergreifend), und das Verh√§ltnis kann nicht nur 1 zu 1, sondern auch 1 zu vielen betragen. <br><br><img src="https://habrastorage.org/webt/0s/a0/bd/0sa0bd8melox5vdkjihq_fdudou.png" alt="Bild"><br><br>  Dies bedeutet, dass Gruppen aus anderen Dom√§nen, einschlie√ülich der benachbarten Gesamtstruktur, nun Zugriff auf die Ressourcen einer Dom√§ne beanspruchen k√∂nnen.  Um eine Einheitlichkeit zu erreichen, wurde beschlossen, eine symmetrische Struktur in der Organisationseinheit aller bedienten Dom√§nen aller W√§lder (schwarze vertikale Ovale) zu erstellen.  In der Armee soll alles h√§sslich, aber einheitlich sein: <br><br><img src="https://habrastorage.org/webt/jd/yw/xm/jdywxmilhxenmbyiwjj7xerjfto.png" alt="Bild"><br><br>  Wenn Sie also das 80XXX-Projekt in der TG-Dom√§ne registrieren, f√ºhrt das Skript Folgendes aus: <br><br>  1. Erstellen der entsprechenden Organisationseinheit (rote horizontale Ovale) in dieser Dom√§ne und dom√§nen√ºbergreifend, dh in den Dom√§nen, deren Mitarbeiter Zugriff auf diese Ressource haben m√ºssen. <br><br>  2. F√ºllen Sie die Organisationseinheit mit Gruppen mit Namen der Form &lt;SRC_Domain&gt; &lt;DST_Domain&gt; &lt;ID_Projekt&gt; -, wobei: <br><br><ul><li>  SRC_-Dom√§ne - Eine dom√§nen√ºbergreifende Dom√§ne, deren Mitarbeiter Zugriff auf DST-Dom√§nenressourcen haben </li><li>  DST_domain - Dom√§ne, zu deren Ressourcen tats√§chlich Zugriff gew√§hrt werden soll, dh zu deren Gunsten alles gestartet wurde </li><li>  &lt;ID_Projekt&gt; - Projektnummer </li><li>  ROLES - die Namen der in der Zugriffsmatrix aufgelisteten Rollen. </li></ul><br>  3. Lesen Sie das SID-Array aller Gruppen aller beteiligten Dom√§nen und speichern Sie es f√ºr die anschlie√üende Daten√ºbertragung in einer Datei, die die Rechte f√ºr einen bestimmten Projekt-Unterordner festlegt <br><br>  4. Generieren von Quelldateien (Parameter / Restore) mit einer Reihe von Berechtigungen f√ºr die Verwendung des Dienstprogramms icacKC im ausf√ºhrbaren Dateimodus "icacKC" \\ as-nasNN \ KC \ Projects "/ restore C: \ Temp \ KC \ KC40XX \ KC40XX.txt" <br><br>  5. Erstellen einer CMD-Datei, die alle gestarteten icacls f√ºr alle Projektordner kombiniert <br><br><img src="https://habrastorage.org/webt/hr/ik/8d/hrik8d5grjq9t45vvgwua2krgic.png" alt="Bild"><br><br>  Wie bereits geschrieben, wird die ausf√ºhrbare Datei manuell gestartet und die Auswertung der Ergebnisse der Ausf√ºhrung erfolgt ebenfalls manuell. <br><br>  Am Ende aufgetretene Schwierigkeiten: <br><br><ul><li>  Wenn der Projektordner bereits mit einer gro√üen Anzahl von Dateien gef√ºllt ist, kann das Ausarbeiten des Befehls icacls auf den verf√ºgbaren Volumes viel Zeit in Anspruch nehmen und in einigen F√§llen zu einem Fehler f√ºhren (z. B. wenn lange Dateipfade vorhanden sind). </li><li>  Zus√§tzlich zur Option / restore musste ich Zeilen mit der Option / reset hinzuf√ºgen, falls Ordner nicht erstellt, sondern aus zuvor vorhandenen Ordnern mit deaktivierten Vererbungsrechten aus dem Stammverzeichnis √ºbertragen wurden. </li><li>  Ein Teil des Skripts zum Erstellen von Gruppen musste auf einem beliebigen DC jeder Gesamtstruktur ausgef√ºhrt werden. Das Problem betrifft administrative Konten f√ºr jeden Baum. </li></ul><br>  Allgemeines Fazit: Es ist sehr merkw√ºrdig, dass es auf dem Markt noch keine Versorgungsunternehmen mit √§hnlichen Funktionen gibt.  Eine solche Funktionalit√§t scheint auf Basis des Sharepoint-Portals realisierbar zu sein. <br>  Es ist auch unverst√§ndlich, dass PoSH-Dienstprogramme nicht zum Festlegen von Berechtigungen f√ºr einen Ordner auf Sinologieger√§ten verwendet werden k√∂nnen. <br><br>  Nach Belieben bin ich bereit, das Skript mit anderen zu teilen, indem ich ein Projekt auf Github erstelle, wenn es f√ºr jemanden interessant ist. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482130/">https://habr.com/ru/post/de482130/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482108/index.html">Leise Intelligenz. Methode zur Identifizierung potenzieller WEB-Schwachstellen</a></li>
<li><a href="../de482110/index.html">Linux l√§uft auf meiner Visitenkarte</a></li>
<li><a href="../de482114/index.html">Senden Sie E-Mails mit asyncio und aiohttp aus einer Django-Anwendung</a></li>
<li><a href="../de482126/index.html">Keras Bewertung f√ºr TensorFlow</a></li>
<li><a href="../de482128/index.html">gReebok erkannt. Dermatovenerologe selbst</a></li>
<li><a href="../de482132/index.html">Tesla Cybertruck Kopie wurde in Moskau entdeckt. Dies ist eine ... russische LADA Samara</a></li>
<li><a href="../de482134/index.html">Vergleich der Hybriden oder was die Besitzer der rum√§nischen Meze-Kopfh√∂rer f√ºr 84 990 und 239 990 Rubel erwarten</a></li>
<li><a href="../de482136/index.html">Wie kann ein Monobrand-Projekt in die TOP-Liste aufgenommen werden, indem Aggregatoren und interne Dienste von Suchmaschinen besiegt werden?</a></li>
<li><a href="../de482140/index.html">Brettspiele f√ºr junge Programmierer von 4-10 Jahren. Was ist Ende 2019 auf dem Markt zu finden?</a></li>
<li><a href="../de482142/index.html">23 Minuten Rechtfertigung der Langsamen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>