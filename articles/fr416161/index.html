<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêæ üôãüèΩ üë®‚Äçüöí 10 raisons [de ne pas] utiliser k8s ü§úüèª üßë‚Äçü§ù‚Äçüßë üë®üèº‚Äçüéì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous allons parler de Kubernetes, du r√¢teau qui peut √™tre collect√© dans son utilisation pratique, et des d√©veloppements qui ont aid√© l'au...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>10 raisons [de ne pas] utiliser k8s</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/416161/">  Aujourd'hui, nous allons parler de Kubernetes, du r√¢teau qui peut √™tre collect√© dans son utilisation pratique, et des d√©veloppements qui ont aid√© l'auteur et qui devraient vous aider aussi.  Nous allons essayer de prouver que sans k8 dans le monde moderne n'importe o√π.  Pour les adversaires des k8, nous fournissons √©galement d'excellentes raisons pour lesquelles vous ne devriez pas y passer.  Autrement dit, dans l'histoire, nous allons non seulement d√©fendre Kubernetes, mais aussi le gronder.  D'ici au nom est venu ceci <b>[pas]</b> . <br><br>  Cet article est bas√© sur une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pr√©sentation d'Ivan Glushkov</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">gli</a> ) lors de la conf√©rence DevOops 2017. Les deux derniers lieux de travail d'Ivan √©taient en quelque sorte li√©s √† Kubernetes: il a travaill√© dans les infracommandes √† la fois dans Postmates et Machine Zone, et ils affectent tr√®s √©troitement Kubernetes.  De plus, Ivan dirige le podcast <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevZen</a> .  Une autre pr√©sentation sera faite au nom d'Ivan. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiCKL2SrDM0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/e73/367/d94e733670c1ae7bbe1c151ccf60e272.jpg"><br>  Tout d'abord, je vais bri√®vement expliquer pourquoi il est utile et important pour beaucoup, pourquoi ce battage m√©diatique se produit.  Ensuite, je vais vous parler de notre exp√©rience dans l'utilisation de la technologie.  Eh bien, alors les conclusions. <br><br>  Dans cet article, toutes les diapositives sont ins√©r√©es sous forme d'images, mais vous souhaitez parfois copier quelque chose.  Par exemple, il y aura des exemples avec des configurations.  Les diapositives PDF peuvent √™tre t√©l√©charg√©es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Je ne le dirai pas strictement √† tout le monde: assurez-vous d'utiliser Kubernetes.  Il y a des avantages et des inconv√©nients, donc si vous venez chercher des inconv√©nients, vous les trouverez.  Vous avez le choix, ne regardez que les avantages, seulement les inconv√©nients et regardez g√©n√©ralement tout ensemble.  <i>Simon Cat</i> m'aidera avec les pros, et le chat noir traversera la route quand il y aura un moins. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97c/277/591/97c277591363787b210e31421d9eb501.jpg"><br><br>  Alors, pourquoi ce battage m√©diatique s'est-il produit, pourquoi la technologie X est-elle meilleure que Y. Kubernetes est exactement le m√™me syst√®me, et il y en a beaucoup plus d'un.  Il y a Puppet, Chef, Ansible, Bash + SSH, Terraform.  Mon SSH pr√©f√©r√© m'aide maintenant, pourquoi devrais-je aller quelque part.  Je pense qu'il existe de nombreux crit√®res, mais j'ai soulign√© les plus importants. <br><br>  Le temps entre la validation et la sortie est une tr√®s bonne note, et les gars d'Express 42 sont d'excellents experts en la mati√®re.  L'automatisation de l'assemblage, l'automatisation de l'ensemble du pipeline est une tr√®s bonne chose, vous ne pouvez pas en faire l'√©loge, cela aide en fait.  Int√©gration continue, d√©ploiement continu.  Et, bien s√ªr, combien d'efforts vous consacrerez √† tout faire.  Tout peut √™tre √©crit dans Assembler, comme je l'ai dit, un syst√®me de d√©ploiement aussi, mais cela n'ajoutera pas de commodit√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0cb/5b1/1f3/0cb5b11f3753ddffff21dead2a80bba4.jpg"><br><br>  Je ne vous dirai pas une br√®ve introduction √† Kubernetes, vous savez ce que c'est.  J'aborderai ces domaines un peu plus loin. <br><br>  Pourquoi tout cela est-il si important pour les d√©veloppeurs?  La r√©p√©tabilit√© est importante pour eux, c'est-√†-dire s'ils ont √©crit une sorte d'application, ex√©cut√© un test, cela fonctionnera pour vous, pour votre voisin et pour la production. <br><br>  Le second est un environnement standardis√©: si vous avez √©tudi√© Kubernetes et que vous vous rendez dans une entreprise voisine o√π se trouve Kubernetes, alors tout sera pareil.  La simplification de la proc√©dure de test et de l'int√©gration continue n'est pas le r√©sultat direct de l'utilisation de Kubernetes, mais cela simplifie toujours la t√¢che, donc tout devient plus pratique. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/047/e62/d3c/047e62d3c96acd1e8ed0bea5993adf70.jpg"><br><br>  Pour les d√©veloppeurs de versions, il existe de nombreux autres avantages.  Premi√®rement, c'est une infrastructure immuable. <br><br>  Deuxi√®mement, l'infrastructure est comme du code stock√© quelque part.  Troisi√®mement, l'idempotence, la possibilit√© d'ajouter une version avec un seul bouton.  Les annulations de versions se produisent assez rapidement et l'introspection du syst√®me est assez pratique.  Bien s√ªr, tout cela peut √™tre fait sur votre syst√®me, √©crit sur le genou, mais vous ne pouvez pas toujours le faire correctement, et Kubernetes l'a d√©j√† impl√©ment√©. <br><br>  Qu'est-ce que Kubernetes n'est pas et que ne permet-il pas de faire?  Il existe de nombreuses id√©es fausses √† cet √©gard.  Commen√ßons par les conteneurs.  Kubernetes court dessus.  Les conteneurs ne sont pas des machines virtuelles l√©g√®res, mais une entit√© compl√®tement diff√©rente.  Ils sont faciles √† expliquer √† l'aide de ce concept, mais en fait c'est faux.  Le concept est compl√®tement diff√©rent, il doit √™tre compris et accept√©. <br>  Deuxi√®mement, Kubernetes ne rend pas l'application plus s√©curis√©e.  Il ne le rend pas automatiquement √©volutif. <br><br>  Vous devez vous efforcer de d√©marrer Kubernetes, il n'en sera pas ainsi "en appuyant sur un bouton, et tout a fonctionn√© automatiquement".  √áa va faire mal. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/beb/626/51f/beb62651f13a2e1e872350536858fe2b.jpg"><br>  Notre exp√©rience.  Nous voulons que vous et tout le monde ne cassiez rien.  Pour ce faire, vous devez regarder plus loin - et voici notre c√¥t√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02b/4c4/3fa/02b4c43faa4c6e7bfe3b4fd34214a665.jpg"><br><br>  Premi√®rement, Kubernetes ne va pas seul.  Lorsque vous construisez une structure qui g√©rera enti√®rement les versions et les d√©ploiements, vous devez comprendre que Kubernetes est un d√© et qu'il doit y en avoir 100. Pour construire tout cela, vous devez tout √©tudier attentivement.  Les d√©butants qui viendront dans votre syst√®me √©tudieront √©galement cette pile, une √©norme quantit√© d'informations. <br><br>  Kubernetes n'est pas le seul bloc important, il existe de nombreux autres blocs importants sans lesquels le syst√®me ne fonctionnera pas.  Autrement dit, vous devez vous soucier beaucoup de la tol√©rance aux pannes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ee/0cf/53c/9ee0cf53c72788abe1387798688d15fc.jpg"><br><br>  Pour cette raison, Kubernetes est un inconv√©nient.  Le syst√®me est complexe, vous devez vous en occuper beaucoup. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1e/fab/d4a/e1efabd4a53300ebfe5fa481df8c2be0.jpg"><br><br>  Mais il y a des avantages.  Si une personne a √©tudi√© Kubernetes dans une entreprise, dans une autre, ses cheveux ne resteront pas en place en raison du syst√®me de lib√©ration.  Au fil du temps, lorsque Kubernetes prendra plus de place, la transition des personnes et la formation seront plus faciles.  Et pour cela - un plus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/345/6ba/696/3456ba696d61adad878c461a1af7b63c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/887/47b/dba/88747bdbaa057840b0969fce42ae96fc.jpg"><br><br>  Nous utilisons Helm.  Ce syst√®me, qui est construit au-dessus de Kubernetes, ressemble √† un gestionnaire de packages.  Vous pouvez cliquer sur le bouton, dire que vous souhaitez installer * Wine * sur votre syst√®me.  Peut √™tre install√© dans Kubernetes.  Il fonctionne, se t√©l√©charge automatiquement, d√©marre et tout fonctionnera.  Il vous permet de travailler avec des plug-ins, une architecture client-serveur.  Si vous travaillez avec lui, nous vous recommandons d'ex√©cuter un Tiller sur l'espace de noms.  Cela isole l'espace de noms les uns des autres, et la rupture de l'un ne rompt pas l'autre. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27f/c3a/648/27fc3a64838b9035c96d4fcd312eea4a.jpg"><br><br>  En fait, le syst√®me est tr√®s complexe.  Un syst√®me, qui devrait √™tre une abstraction d'un niveau sup√©rieur et plus simple et plus compr√©hensible, ne le rend pas vraiment plus facile √† comprendre.  Pour ce moins. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27d/ed4/e42/27ded4e428d4a6d2da19ab86dcc42c58.jpg"><br><br>  Comparons les configurations.  Tr√®s probablement, vous avez √©galement des configurations si vous ex√©cutez votre syst√®me en production.  Nous avons notre propre syst√®me appel√© BOOMer.  Je ne sais pas pourquoi nous l'avons appel√©e ainsi.  Il se compose de marionnettes, chef, Ansible, Terraform et tout le reste, il y a une grande bouteille. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3a3/0d8/87c/3a30d887c8d5b95dfa76678c92d9dc7e.jpg"><br><br>  Voyons comment cela fonctionne.  Voici un exemple d'une configuration r√©elle qui fonctionne actuellement en production.  Que voyons-nous ici? <br><br>  Premi√®rement, nous voyons o√π lancer l'application, deuxi√®mement, ce qui doit √™tre lanc√© et, troisi√®mement, comment elle doit √™tre pr√©par√©e pour le lancement.  Dans une bouteille, les concepts sont d√©j√† m√©lang√©s. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddb/5c6/642/ddb5c6642f4c6209497dc19589d3412e.jpg"><br><br>  Si nous regardons plus loin, parce que nous avons ajout√© l'h√©ritage pour rendre les configurations plus complexes, nous devrions regarder ce qui se trouve dans la configuration commune √† laquelle nous nous r√©f√©rons.  De plus, nous ajoutons la configuration du r√©seau, les droits d'acc√®s, la planification de la charge.  Tout cela dans une config dont nous avons besoin pour ex√©cuter une vraie application en production, nous m√©langeons un tas de concepts en un seul endroit. <br><br>  C'est tr√®s difficile, c'est tr√®s faux, et c'est un √©norme plus pour Kubernetes, car vous d√©terminez simplement quoi ex√©cuter.  La configuration du r√©seau a √©t√© effectu√©e lors de l'installation de Kubernetes, le provisionnement complet a √©t√© r√©solu √† l'aide du docker - vous avez eu l'encapsulation, tous les probl√®mes ont √©t√© s√©par√©s d'une mani√®re ou d'une autre et dans ce cas, la configuration n'a que votre application, et il y a un avantage pour cela. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/833/70d/c7c/83370dc7c28d637804be907acbca63b2.jpg"><br><br>  Examinons de plus pr√®s.  Ici, nous n'avons qu'une seule application.  Pour que le d√©ploiement fonctionne, vous avez besoin de tout un tas de plus pour fonctionner.  Tout d'abord, vous devez d√©finir les services.  Comment les secrets, ConfigMap, l'acc√®s √† Load Balancer nous parviennent. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15c/8fe/4c5/15c8fe4c5e384cec97bfd9e3640adfd6.jpg"><br><br>  N'oubliez pas que vous disposez de plusieurs environnements.  Il y a Stage / Prod / Dev.  Tout cela n'est pas un petit morceau que j'ai montr√©, mais un √©norme ensemble de configurations, ce qui est vraiment difficile.  Pour ce moins. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eaf/6a0/5f8/eaf6a05f8ddf546c84938d0647fdf9f4.jpg"><br><br>  Mod√®le de barre pour comparaison.  Il r√©p√®te compl√®tement les mod√®les Kubernetes, s'il y a un fichier dans Kubernetes avec la d√©finition de d√©ploiement, le m√™me sera dans Helm.  Au lieu de valeurs sp√©cifiques pour l'environnement, vous disposez de mod√®les qui sont substitu√©s √† partir de valeurs. <br>  Vous avez un mod√®le distinct, des valeurs distinctes qui devraient √™tre substitu√©es dans ce mod√®le. <br><br>  Bien s√ªr, vous devez √©galement d√©finir les diff√©rentes infrastructures de Helm lui-m√™me, malgr√© le fait que vous disposez de nombreux fichiers de configuration dans Kubernetes que vous devez faire glisser et d√©poser dans Helm.  Tout cela est tr√®s difficile, pour lequel un inconv√©nient. <br><br>  Un syst√®me qui devrait simplifier complique en fait.  Pour moi, c'est clairement un inconv√©nient.  Soit besoin d'ajouter autre chose, soit de ne pas utiliser <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4a/c56/38f/e4ac5638f52ff34104c198c038817869.jpg"><br><br>  Allons plus loin, nous ne sommes pas assez profonds. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/baa/73a/b45/baa73ab45fa3f3c3dbc985a7cdad5395.jpg"><br><br>  Tout d'abord, comment nous travaillons avec les clusters.  J'ai lu l'article de Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´Borg, Omega et Kubernetes¬ª,</a> qui pr√©conise fortement le concept selon lequel vous devez avoir un grand cluster.  J'√©tais aussi pour cette id√©e, mais, finalement, nous l'avons laiss√©e.  √Ä la suite de nos diff√©rends, nous utilisons quatre grappes diff√©rentes. <br><br>  Premier cluster e2e √† tester Kubernetes lui-m√™me et √† tester des scripts qui d√©ploient l'environnement, les plug-ins, etc.  Le deuxi√®me, bien s√ªr, prod et stage.  Ce sont des concepts standard.  Troisi√®mement, c'est admin, dans lequel tout le reste est charg√© - en particulier, nous avons CI l√†-bas, et il semble qu'√† cause de cela, ce cluster sera toujours le plus grand. <br><br>  Il y a beaucoup de tests: par commit, par merge, tout le monde fait un tas de commits, donc les clusters sont juste √©normes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe6/e2c/284/fe6e2c284169e1782c3c9009e8802d5c.jpg"><br><br>  Nous avons essay√© de regarder CoreOS, mais ne l'avons pas utilis√©.  Ils ont TF ou CloudFormation √† l'int√©rieur, et les deux nous permettent tr√®s mal de comprendre ce qui est √† l'int√©rieur de l'√©tat.  Pour cette raison, il y a des probl√®mes lors de la mise √† niveau.  Lorsque vous souhaitez mettre √† jour les param√®tres de votre Kubernetes, par exemple, sa version, vous pouvez rencontrer le fait que la mise √† jour ne fonctionne pas de cette fa√ßon, dans le mauvais ordre.  C'est un gros probl√®me de stabilit√©.  C'est un inconv√©nient. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e41/d3d/694/e41d3d694030f44c6f6e12dc40c2b70c.jpg"><br><br>  Deuxi√®mement, lorsque vous utilisez Kubernetes, vous devez t√©l√©charger des images quelque part.  Il peut s'agir d'une source interne, d'un r√©f√©rentiel ou externe.  S'il est interne, il y a des probl√®mes.  Je recommande d'utiliser Docker Distribution car il est stable, il a √©t√© cr√©√© par Docker.  Mais le prix de soutien est toujours √©lev√©.  Pour que cela fonctionne, vous devez le rendre tol√©rant aux pannes, car c'est le seul endroit o√π vos applications obtiennent des donn√©es √† partir desquelles travailler. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f2/aba/dc6/2f2abadc6444a9da754baf98667356a1.jpg"><br><br>  Imaginez qu'au moment crucial, lorsque vous avez trouv√© un bug sur la production, votre r√©f√©rentiel est tomb√© - vous ne pouvez pas mettre √† jour l'application.  Vous devez le rendre tol√©rant aux pannes, et de tous les probl√®mes possibles qui ne peuvent √™tre que. <br><br>  Deuxi√®mement, si la masse des √©quipes, chacune a sa propre image, elles s'accumulent beaucoup et tr√®s rapidement.  Vous pouvez tuer votre distribution Docker.  Il est n√©cessaire de faire le nettoyage, de supprimer des images, de fournir des informations aux utilisateurs, quand et ce que vous allez nettoyer. <br><br>  Troisi√®mement, avec de grandes images, disons, si vous avez un monolithe, la taille de l'image sera tr√®s grande.  Imaginez que vous devez lib√©rer 30 n≈ìuds.  2 gigaoctets par 30 n≈ìuds - calculez le flux, la vitesse de t√©l√©chargement sur tous les n≈ìuds.  Je voudrais qu'il appuie sur un bouton et devienne imm√©diatement vert.  Mais non, vous devez d'abord attendre qu'il soit t√©l√©charg√©.  Il est n√©cessaire d'acc√©l√©rer ce t√©l√©chargement, et tout fonctionne √† partir d'un point. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/246/bf7/15e/246bf715ec55bbf04e96fa43708c5ce4.jpg"><br><br>  Avec les r√©f√©rentiels externes, il y a les m√™mes probl√®mes avec le garbage collector, mais le plus souvent cela se fait automatiquement.  Nous utilisons Quay.  Dans le cas de r√©f√©rentiels externes, il s'agit de services tiers dont la plupart des images sont publiques.  Qu'il n'y avait pas d'images publiques, il faut donner acc√®s.  Nous avons besoin de secrets, de droits d'acc√®s aux images, tout cela est sp√©cialement configur√©.  Bien s√ªr, cela peut √™tre automatis√©, mais dans le cas d'un lancement local de Cuba sur votre syst√®me, vous devez encore le configurer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a44/cf1/249/a44cf1249b766da256cb73c181a48921.jpg"><br><br>  Pour installer Kubernetes, nous utilisons kops.  C'est un tr√®s bon syst√®me, nous sommes les premiers utilisateurs √† partir du moment o√π ils n'avaient pas encore √©crit sur le blog.  Il ne prend pas pleinement en charge CoreOS, fonctionne bien avec Debian, sait comment configurer automatiquement les n≈ìuds ma√Ætres Kubernetes, fonctionne avec les modules compl√©mentaires et a la possibilit√© de ne faire aucun temps d'arr√™t pendant les mises √† jour de Kubernetes. <br>  Toutes ces fonctionnalit√©s sont pr√™tes √† l'emploi, pour lesquelles un gros et audacieux plus.  Excellent syst√®me! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/214/cf0/a98/214cf0a98d020ffb9ab512ac9812ed4c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba4/e64/80c/ba4e6480c2e0f047f086d77663ef2530.jpg"><br><br>  √Ä partir des liens, vous pouvez trouver de nombreuses options pour configurer un r√©seau dans Kubernetes.  Il y en a vraiment beaucoup, chacun a ses avantages et ses inconv√©nients.  Kops ne prend en charge qu'une partie de ces options.  Vous pouvez bien s√ªr le configurer pour qu'il fonctionne via CNI, mais il est pr√©f√©rable d'utiliser les plus courants et les plus standard.  Ils sont test√©s par la communaut√© et sont tr√®s probablement stables. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc5/ee7/1a1/fc5ee71a1919828d439cba33caf0c931.jpg"><br><br>  Nous avons d√©cid√© d'utiliser Calico.  Cela a bien fonctionn√© √† partir de z√©ro, sans beaucoup de probl√®mes, utilise BGP, une encapsulation plus rapide, prend en charge IP-in-IP, vous permet de travailler avec plusieurs nuages, pour nous, c'est un gros plus. <br>  Bonne int√©gration avec Kubernetes, l'utilisation d'√©tiquettes d√©limite le trafic.  Car c'est un plus. <br><br>  Je ne m'attendais pas √† ce que Calico se rende dans l'√âtat lorsqu'il est allum√©, et tout fonctionne sans probl√®me. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b08/4fd/d69/b084fdd6914fc0a4838610f5ff1db1ee.jpg"><br><br>  La haute disponibilit√©, comme je l'ai dit, nous le faisons via kops, vous pouvez utiliser 5-7-9 n≈ìuds, nous en utilisons trois.  Nous sommes assis sur etcd v2, √† cause d'un bug, ils n'ont pas √©t√© mis √† jour sur v3.  Th√©oriquement, cela acc√©l√©rera certains processus.  Je ne sais pas, j'en doute. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b6/668/228/6b6668228d189d4ecdb487c0c370352c.jpg"><br><br>  Un moment difficile, nous avons un cluster sp√©cial pour exp√©rimenter avec des scripts, roulement automatique √† travers CI.  Nous pensons que nous avons une protection contre les actions compl√®tement fausses, mais pour certaines versions sp√©ciales et complexes, juste au cas o√π nous ferions des instantan√©s de tous les disques, nous ne faisons pas de sauvegardes tous les jours. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/070/a54/74d/070a5474df7ad0e10fd3119454a2c1f1.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/70a/040/729/70a040729046c706ca8309f7b43a8d56.jpg"><br><br>  L'autorisation est une question √©ternelle.  Chez Kubernetes, nous utilisons RBAC, l'acc√®s bas√© sur les r√¥les.  C'est bien mieux qu'ABAC, et si vous l'avez configur√©, alors vous comprenez ce que je veux dire.  Regardez les configurations - soyez surpris. <br>  Nous utilisons Dex, un fournisseur OpenID qui pompe toutes les informations d'une source de donn√©es. <br>  Et pour vous connecter √† Kubernetes, il y a deux fa√ßons.  Il est n√©cessaire de s'inscrire en quelque sorte dans .kube / config o√π aller et ce qu'il peut faire.  Il est n√©cessaire de r√©cup√©rer cette configuration.  Ou l'utilisateur se rend sur l'interface utilisateur, o√π il se connecte, re√ßoit les configurations, les copie dans / config et fonctionne.  Ce n'est pas tr√®s pratique.  Nous sommes progressivement pass√©s au fait qu'une personne entre dans la console, clique sur le bouton, se connecte, les configurations sont automatiquement g√©n√©r√©es √† partir de lui et empil√©es au bon endroit.  Beaucoup plus pratique, nous avons d√©cid√© d'agir de cette fa√ßon. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/02a/038/827/02a03882785c1106981d333d1a270ce0.jpg"><br><br>  En tant que source de donn√©es, nous utilisons Active Directory.  Kubernetes vous permet de transmettre des informations sur le groupe dans toute la structure d'autorisation, ce qui se traduit par un espace de noms et des r√¥les.  Ainsi, nous distinguons imm√©diatement entre o√π une personne peut aller, o√π elle n'a pas le droit d'aller et ce qu'elle peut lib√©rer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/800/6bc/cce/8006bccce4c652ce9bf32fba1cea7c42.jpg"><br><br>  Le plus souvent, les gens ont besoin d'acc√©der √† AWS.  Si vous ne disposez pas de Kubernetes, une machine ex√©cute l'application.  Il semblerait que tout ce dont vous avez besoin soit d'obtenir les journaux, de les voir et c'est tout.  C'est pratique lorsqu'une personne peut se rendre √† sa voiture et voir comment fonctionne l'application.  Du point de vue de Kubernetes, tout fonctionne dans des conteneurs.  Il existe une commande `kubectl exec` - entrez dans le conteneur de l'application et voyez ce qui s'y passe.  Par cons√©quent, il n'est pas n√©cessaire d'acc√©der aux instances AWS.  Nous avons refus√© l'acc√®s √† tout le monde sauf √† la sous-commande. <br><br>  De plus, nous avons interdit les cl√©s d'administration √† longue dur√©e de jeu, l'entr√©e via les r√¥les.  S'il est possible d'utiliser le r√¥le d'administrateur - je suis l'administrateur.  De plus, nous avons ajout√© la rotation des cl√©s.  Il est pratique de le configurer via la commande awsudo, c'est un projet sur le github, je le recommande vivement, il vous permet de travailler comme avec une sudo-team. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/12f/a6f/a66/12fa6fa666e726aae4fd03408b3be964.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bbf/7f6/d0f/bbf7f6d0f0ea69595e1fab50b7f37645.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4da/414/371/4da414371e537acb4ed1aa16d69b92ff.jpg"><br><br>  Quotas.  Une tr√®s bonne chose √† Kubernetes, travailler d√®s la sortie de la bo√Æte.  Vous limitez tout espace de noms, par exemple, par le nombre d'objets, de m√©moire ou de CPU que vous pouvez consommer.  Je pense que c'est important et utile √† tout le monde.  Nous n'avons pas encore atteint la m√©moire et le CPU, nous n'utilisons que le nombre d'objets, mais nous ajouterons tout cela. <br><br>  Gros et gros plus, vous permet de faire beaucoup de choses d√©licates. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/be9/487/2b3be9487f65110ea6a0c3189db27ac3.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e72/e9e/4ff/e72e9e4ff8f7bedeab64808e7a6d26c1.jpg"><br><br>  Mise √† l'√©chelle.  Vous ne pouvez pas m√©langer la mise √† l'√©chelle √† l'int√©rieur de Kubernetes et √† l'ext√©rieur de Kubernetes.  √Ä l'int√©rieur de Kubernetes fait la mise √† l'√©chelle elle-m√™me.  Il peut augmenter automatiquement les pods en cas de forte charge. <br><br>  Ici, je parle de la mise √† l'√©chelle des instances Kubernetes elles-m√™mes.  Cela peut √™tre fait √† l'aide d'AWS Autoscaler, il s'agit d'un projet github.  Lorsque vous ajoutez un nouveau pod et qu'il ne peut pas d√©marrer car il manque de ressources sur toutes les instances, AWS Autoscaler peut ajouter automatiquement des n≈ìuds.  Cela vous permet de travailler sur des instances Spot, nous ne l'avons pas encore ajout√©, mais nous le ferons, cela nous permet d'√©conomiser beaucoup. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a50/031/93c/a5003193c50ccb5cd288a42f6cd4af1e.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/58f/07c/a0f/58f07ca0f60354e68e3034323da3d2fb.jpg"><br><br>  Lorsque vous avez beaucoup d'utilisateurs et d'applications utilisateur, vous devez en quelque sorte les surveiller.  Il s'agit g√©n√©ralement de t√©l√©m√©trie, de journaux, de beaux graphismes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88c/0b7/92c/88c0b792c38e79845e7d5c305cd21f20.jpg"><br><br>  Pour des raisons historiques, nous avions Sensu, il n'√©tait pas tr√®s adapt√© √† Kubernetes.  Un projet plus m√©trique √©tait n√©cessaire.  Nous avons examin√© l'int√©gralit√© de la pile TICK, en particulier InfluxDB.  Bonne interface utilisateur, langage de type SQL, mais pas assez de fonctionnalit√©s.  Nous sommes pass√©s √† Prom√©th√©e. <br><br>  Il est bon.  Bon langage de requ√™te, bonnes alertes, et tout hors de la bo√Æte. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/953/9ba/908/9539ba90827a17261f0c53d114064ae4.jpg"><br><br>  Pour envoyer la t√©l√©m√©trie, nous avons utilis√© Cernan.  Ceci est notre propre projet √©crit en Rust.  C'est le seul projet sur Rust qui travaille dans notre production depuis un an maintenant.  Il a plusieurs concepts: il existe un concept de source de donn√©es, vous configurez plusieurs sources.  Vous configurez o√π les donn√©es seront fusionn√©es.  Nous avons une configuration de filtres, c'est-√†-dire que les donn√©es qui circulent peuvent √™tre trait√©es d'une mani√®re ou d'une autre.  Vous pouvez convertir les journaux en m√©triques, les m√©triques en journaux, tout ce que vous voulez. <br>  Malgr√© le fait que vous ayez plusieurs entr√©es, plusieurs conclusions, et que vous montrez que l√† o√π il va, il y a quelque chose comme un grand syst√®me de graphes, cela s'av√®re assez pratique. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d26/ae0/763/d26ae0763c1e43c636d09ec1ee5f0d7a.jpg"><br><br>  Nous passons maintenant de mani√®re transparente de la pile Statsd / Cernan / Wavefront actuelle √† Kubernetes.  En th√©orie, Prometheus veut prendre les donn√©es des applications par lui-m√™me, vous devez donc ajouter un point de terminaison √† toutes les applications, √† partir desquelles il prendra des mesures.  Cernan est le lien de transmission, il devrait fonctionner partout.  Il existe deux possibilit√©s: vous pouvez ex√©cuter Kubernetes sur chaque instance, en utilisant le concept Sidecar, lorsqu'un autre conteneur fonctionne dans votre champ de donn√©es qui envoie des donn√©es.  Nous faisons ceci et cela. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77d/dd8/1dd/77ddd81ddd96e121117aa7dfaf5b96f6.jpg"><br>  √Ä l'heure actuelle, tous les journaux sont envoy√©s √† stdout / stderr.  Toutes les applications sont con√ßues pour cela, donc l'une des exigences essentielles est que nous ne quittions pas ce syst√®me.  Cernan envoie des donn√©es √† ElasticSearch, les √©v√©nements de l'ensemble du syst√®me Kubernetes y sont envoy√©s via Heapster.  C'est un tr√®s bon syst√®me, je le recommande. <br><br>  Apr√®s cela, vous pouvez voir tous les journaux au m√™me endroit, par exemple, dans la console.  Nous utilisons Kibana.  Il y a un merveilleux produit Stern, juste pour les journaux.  Il vous permet de regarder, de peindre diff√©rents pods de diff√©rentes couleurs, de savoir comment un sous est mort et l'autre a red√©marr√©.  R√©cup√®re automatiquement tous les journaux.  Un projet id√©al, je le recommande vivement, c'est un gros plus Kubernetes, tout va bien ici. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed4/b9b/c19/ed4b9bc1996cbadf00189e8be2630d27.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca7/b8a/b64/ca7b8ab64354e2a5361023d2c0bca95d.jpg"><br><br>  Secrets  Nous utilisons S3 et KMS.  Nous envisageons de passer √† Vault ou √† des secrets dans Kubernetes lui-m√™me.  Ils √©taient en 1.7 en √©tat alpha, mais quelque chose doit √™tre fait avec cela. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/429/3b2/6cb/4293b26cbfe90b1f84adb88696686acb.jpg"><br><br>  Nous sommes arriv√©s √† la partie int√©ressante.  Le d√©veloppement de Kubernetes n'est g√©n√©ralement pas tr√®s pris en compte.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il dit essentiellement: "Kubernetes est un syst√®me id√©al, tout va bien, passons." </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais en fait, le fromage gratuit n'est que dans une sourici√®re, et pour les d√©veloppeurs de Kubernetes, c'est l'enfer. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e96/fb8/480/e96fb8480a76e63a05e4148dfd76ebbf.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pas du point de vue que tout est mauvais, mais du fait que vous devez regarder les choses diff√©remment. Je compare le d√©veloppement dans Kubernetes √† la programmation fonctionnelle: jusqu'√† ce que vous le touchiez, vous pensez dans votre style imp√©ratif, tout va bien. Afin de d√©velopper le fonctionnalisme, vous devez tourner l√©g√®rement la t√™te de l'autre c√¥t√© - la m√™me chose ici.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez le d√©velopper, vous pouvez bien le faire, mais vous devez le voir diff√©remment. Commen√ßons par le concept Docker Way. Ce n'est pas si difficile, mais c'est assez probl√©matique de le comprendre compl√®tement. La plupart des d√©veloppeurs sont habitu√©s √† se rendre sur leur machine locale, distante ou virtuelle via SSH, en disant: "Permettez-moi de corriger quelque chose ici, podshaman." </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous lui dites que Kubernetes ne le fera pas parce que vous avez une infrastructure en lecture seule. Lorsque vous souhaitez mettre √† jour l'application, faites une nouvelle image qui fonctionnera, et l'ancienne, s'il vous pla√Æt ne touchez pas, elle mourra simplement. J'ai personnellement travaill√© sur l'introduction de Kubernetes dans diff√©rentes √©quipes et je vois l'horreur dans les yeux des gens quand ils comprennent qu'ils devront abandonner compl√®tement toutes les anciennes habitudes, en trouver de nouvelles, un nouveau syst√®me, ce qui est tr√®s difficile.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, vous devrez faire beaucoup de choix: par exemple, lorsque vous apportez des modifications, si le d√©veloppement est local, vous devez le valider dans le r√©f√©rentiel d'une mani√®re ou d'une autre, puis le r√©f√©rentiel du pipeline ex√©cute les tests, puis dit: "Oh, il y a une faute de frappe en un mot", vous avez besoin de tout faire localement. Montez le dossier en quelque sorte, allez-y, mettez √† jour le syst√®me, au moins compilez-le. Si l'ex√©cution de tests localement n'est pas pratique, il peut au moins valider dans CI pour v√©rifier certaines actions locales, puis les envoyer √† CI pour v√©rification. Ces choix sont assez compliqu√©s.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est particuli√®rement difficile lorsque vous avez une application branch√©e compos√©e d'une centaine de services, et pour que l'un d'entre eux fonctionne, vous devez vous assurer que tout le monde travaille c√¥te √† c√¥te. Vous devez soit √©muler l'environnement, soit s'ex√©cuter localement. Tout ce choix n'est pas anodin, le d√©veloppeur doit y r√©fl√©chir s√©rieusement. Cela cr√©e une attitude n√©gative envers Kubernetes. Il est, bien s√ªr, bon - mais il est mauvais, car il faut beaucoup r√©fl√©chir et changer ses habitudes. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par cons√©quent, ici, trois gros chats ont travers√© la route.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ef/b3f/144/8efb3f1441675d73b9c02d58775457d2.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/55e/ad5/82b/55ead582ba97c9d9b828801f8972c9d8.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque nous avons examin√© Kubernetes, nous avons essay√© de comprendre, peut-√™tre qu'il existe des syst√®mes de d√©veloppement pratiques. En particulier, il existe une chose telle que Deis, c'est s√ªr que vous en avez tout entendu. Il est tr√®s facile √† utiliser, et nous avons v√©rifi√©, en fait, que tous les projets simples passent tr√®s facilement √† Deis. Mais le probl√®me est que les projets plus complexes peuvent ne pas passer √† Deis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comme je l'ai dit, nous sommes pass√©s √† Helm Charts. Mais le seul probl√®me que nous voyons en ce moment est que beaucoup de bonne documentation est n√©cessaire. Nous avons besoin de quelques proc√©dures, de FAQ, pour qu'une personne puisse d√©marrer rapidement, copier les configurations actuelles, coller les leurs, changer les noms pour que tout soit correct. Il est √©galement important de comprendre cela √† l'avance et vous devez tout faire. J'ai r√©pertori√© des bo√Ætes √† outils courantes pour le d√©veloppement ici, je ne vais pas aborder tout cela sauf le mini-cube. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a85/fb3/a6e/a85fb3a6e8be12bee7fb87dc32d9c91f.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le minikube est un tr√®s bon syst√®me, dans le sens o√π il est bon qu'il l'est, mais c'est mauvais qu'il l'est. Il vous permet d'ex√©cuter Kubernetes localement, vous permet de tout voir sur votre ordinateur portable, pas besoin d'aller n'importe o√π sur SSH, etc.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je travaille sur MacOS, j'ai un Mac, respectivement, pour ex√©cuter une application locale, je dois ex√©cuter le docker localement. Cela ne peut pas √™tre fait. En fin de compte, vous devez ex√©cuter virtualbox ou xhyve. Les deux choses sont, en fait, des √©mulations au-dessus de mon syst√®me d'exploitation. Nous utilisons xhyve, mais nous vous recommandons d'utiliser VirtualBox, car il y a beaucoup de bugs, ils doivent √™tre contourn√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais l'id√©e qu'il y a de la virtualisation, et √† l'int√©rieur de la virtualisation, un autre niveau d'abstraction pour la virtualisation est lanc√©, est une sorte de ridicule, d√©lirant. En g√©n√©ral, il est bon que cela fonctionne d'une mani√®re ou d'une autre, mais il serait pr√©f√©rable qu'il soit termin√©.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb1/6e9/c9a/bb16e9c9a54a30c0d90b081709a5aa0c.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffd/c4b/98e/ffdc4b98efbf7546fbbf1da8ff70d82d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CI n'est pas directement li√© √† Kubernetes, mais c'est un syst√®me tr√®s important, surtout si vous avez Kubernetes, si vous l'int√©grez, vous pouvez obtenir de tr√®s bons r√©sultats. Nous avons utilis√© Concourse pour CI, une fonctionnalit√© tr√®s riche, vous pouvez cr√©er des graphiques effrayants, de quoi, o√π, comment cela commence, de quoi cela d√©pend. Mais les d√©veloppeurs de Concourse sont tr√®s √©tranges au sujet de leur produit. Disons qu'en passant d'une version √† une autre, ils ont rompu la compatibilit√© descendante et n'ont pas r√©√©crit la plupart des plugins. De plus, la documentation n'√©tait pas compl√®te et lorsque nous avons essay√© de faire quelque chose, rien n'a fonctionn√© du tout.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a peu de documentation en g√©n√©ral dans tous les CI, vous devez lire le code et, en g√©n√©ral, nous avons abandonn√© Concourse. Nous sommes pass√©s √† Drone.io - il est petit, tr√®s l√©ger, agile, la fonctionnalit√© est beaucoup moins, mais plus souvent c'est suffisant. Oui, il serait pratique d'avoir des graphiques de d√©pendance volumineux et lourds, mais vous pouvez √©galement travailler sur de petits graphiques. Aussi un peu de documentation, nous lisons le code, mais c'est ok. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chaque √©tape du pipeline fonctionne dans son propre conteneur Docker, ce qui facilite le passage √† Kubernetes. Si vous avez une application qui s'ex√©cute sur une vraie machine, pour l'ajouter √† CI, utilisez le conteneur Docker, et apr√®s cela, passer √† Kubernetes est simple. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons configur√© la lib√©ration automatique du cluster admin / stage, alors que nous avons peur d'ajouter le param√®tre au cluster de production. De plus, il existe un syst√®me de plugins.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffd/c4b/98e/ffdc4b98efbf7546fbbf1da8ff70d82d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est un exemple de configuration simple de drone. Tir√© du syst√®me de travail termin√©, dans ce cas, il y a cinq √©tapes dans le pipeline, chaque √©tape fait quelque chose: collecte, test, etc. Avec cet ensemble de fonctionnalit√©s qui est dans Drone, je pense que c'est une bonne chose. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/47c/8d7/033/47c8d70338233420ee9d3806e89f4c3d.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5be/0bf/cc3/5be0bfcc32dfa4c8d34c7d2eb3e5b906.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons beaucoup discut√© du nombre de clusters √† avoir: un ou plusieurs. Lorsque nous avons eu l'id√©e de plusieurs clusters, nous avons commenc√© √† travailler davantage dans cette direction, cr√©√© des scripts, mis en place un tas d'autres cubes pour nos Kubernetes. Apr√®s cela, ils sont venus sur Google et ont demand√© des conseils, est-ce que tout le monde l'a fait, peut-√™tre que quelque chose doit √™tre corrig√©.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google a convenu que l'id√©e d'un cluster unique n'est pas applicable dans Kubernetes. Il existe de nombreuses imperfections, en particulier, le travail avec les g√©olocalisations. Il s'av√®re que l'id√©e est vraie, mais il est trop t√¥t pour en parler. Peut-√™tre plus tard. Bien que Service Mesh puisse vous aider. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f1/edd/a5a/4f1edda5a7ce5e102dc5fc238ab8c07d.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En g√©n√©ral, si vous voulez voir comment fonctionne notre syst√®me, faites attention √† la g√©od√©sique. C'est un produit similaire √† ce que nous faisons. C'est open source, un choix tr√®s similaire de concept de design. Nous envisageons de faire √©quipe et √©ventuellement de les utiliser. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/790/8e7/e00/7908e7e000fafe3c0506e500b54fde9a.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oui, dans notre pratique de travailler avec Kubernetes, il y a aussi des probl√®mes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a un probl√®me avec les noms locaux, avec les certificats. Il y a un probl√®me avec le t√©l√©chargement d'images volumineuses et leur travail, peut-√™tre li√© au syst√®me de fichiers, nous n'y avons pas encore creus√©. Il existe d√©j√† trois fa√ßons diff√©rentes d'installer les extensions Kubernetes. Nous travaillons sur ce projet depuis moins d'un an, et nous avons d√©j√† trois fa√ßons diff√©rentes, les anneaux annuels se multiplient. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a9/3a7/f62/2a93a7f624007d3333fb0b56c3ab62ad.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soyons comme tous les inconv√©nients. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Donc, je pense que l'un des principaux inconv√©nients est la grande quantit√© d'informations √† √©tudier, non seulement les nouvelles technologies, mais aussi les nouveaux concepts et habitudes. C‚Äôest comme apprendre une nouvelle langue: en principe, ce n‚Äôest pas difficile, mais il est difficile de tourner la t√™te un peu √† tous les utilisateurs. Si vous n'avez jamais travaill√© avec des concepts similaires auparavant, passer √† Kubernetes est difficile.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kubernetes ne sera qu'une petite partie de votre syst√®me. Tout le monde pense qu'ils vont installer Kubernetes, et tout fonctionnera imm√©diatement. Non, c'est un petit cube, et il y en aura beaucoup. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Certaines applications sont g√©n√©ralement difficiles √† ex√©cuter sur Kubernetes - et il vaut mieux ne pas les ex√©cuter. Fichiers de configuration √©galement tr√®s lourds et volumineux, et dans les concepts au-dessus de Kubernetes, ils sont encore plus compliqu√©s. Toutes les solutions actuelles sont brutes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous ces inconv√©nients sont bien s√ªr d√©go√ªtants. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a9/3a7/f62/2a93a7f624007d3333fb0b56c3ab62ad.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les compromis et une transition difficile cr√©ent une image n√©gative de Kubernetes, et je ne sais pas comment y faire face. Nous ne pouvions pas surmonter beaucoup, il y a des gens qui d√©testent tout le mouvement, ne veulent pas et ne comprennent pas ses avantages.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ex√©cuter Minikube, votre syst√®me devra travailler dur pour que tout fonctionne. Comme vous pouvez le voir, il existe de nombreux inconv√©nients, et ceux qui ne veulent pas travailler avec Kubernetes ont leurs propres raisons. Si vous ne voulez pas entendre parler des pros, fermez les yeux et les oreilles, car ils iront plus loin. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/649/ba0/08e/649ba008e1c2a9ade9c10060a70bc7cc.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le premier avantage est qu'avec le temps, les d√©butants devront apprendre moins. Il arrive souvent que lorsqu'un nouveau venu entre dans le syst√®me, il commence √† arracher tous ses cheveux, car pendant les 1 √† 2 premiers mois, il essaie de comprendre comment tout lib√©rer, si le syst√®me est grand et vit longtemps, de nombreux anneaux annuels ont pouss√©. Kubernetes facilite les choses. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deuxi√®mement, Kubernetes ne le fait pas lui-m√™me, mais vous permet de faire un cycle de lib√©ration court. Un commit a cr√©√© un CI, CI a cr√©√© une image, pomp√© automatiquement, vous avez appuy√© sur un bouton et tout est entr√© en production. Cela r√©duit consid√©rablement le temps de sortie.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce qui suit est le fractionnement de code. Notre syst√®me et la plupart de vos syst√®mes collectent des configurations de diff√©rents niveaux en un seul endroit, c'est-√†-dire que vous avez un code d'infrastructure, un code d'entreprise, toutes les logiques sont m√©lang√©es en un seul endroit. Dans Kubernetes, cela ne sortira pas des sentiers battus, choisir le bon concept permet d'√©viter cela √† l'avance. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une communaut√© importante et tr√®s active, ce qui signifie un grand nombre de changements. La plupart de ce que j'ai mentionn√© au cours des deux derni√®res ann√©es est devenu si stable qu'ils peuvent √™tre mis en production. Certains d'entre eux sont peut-√™tre apparus plus t√¥t, mais n'√©taient pas tr√®s stables.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je consid√®re que c'est un gros avantage que vous puissiez voir √† la fois les journaux d'application et les journaux de Kubernetes qui fonctionnent avec votre application, ce qui est inestimable. Et il n'y a pas d'acc√®s aux n≈ìuds. Lorsque nous avons supprim√© l'acc√®s aux n≈ìuds aux utilisateurs, cela a imm√©diatement coup√© une grande classe de probl√®mes. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f7/686/e3a/4f7686e3a040bdf9ff0640e5f4a2bcb2.jpg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me partie des avantages est un peu plus conceptuelle. La plupart de la communaut√© Kubernetes voit la partie technologique. Mais nous avons vu la partie gestion conceptuelle. Une fois que vous √™tes pass√© √† Kubernetes, et s'il est correctement configur√©, la sous-commande (ou le backend - je ne sais pas comment vous l'appelez correctement) n'est plus n√©cessaire pour lib√©rer les applications.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisateur veut d√©charger l'application, il ne viendra pas le demander, mais lancera simplement un nouveau pod, il y a une commande pour cela. Une √©quipe d'infrastructure n'est pas n√©cessaire pour enqu√™ter sur les probl√®mes. Il suffit de regarder les journaux, notre ensemble de designs n'est pas si grand, il y a une liste par laquelle il est tr√®s facile de trouver le probl√®me. Oui, parfois un support est n√©cessaire si le probl√®me est dans Kubernetes, dans certains cas, mais le plus souvent, c'est avec des applications.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons ajout√© le budget d'erreur. Voici le concept suivant: chaque √©quipe dispose de statistiques sur le nombre de probl√®mes survenant en production. S'il y a trop de probl√®mes, l'√©quipe coupe les versions jusqu'√† ce que cela prenne un certain temps. C'est bien parce que l'√©quipe surveillera s√©rieusement que leurs versions sont tr√®s stables. Besoin de nouvelles fonctionnalit√©s - veuillez lib√©rer. Vous voulez lib√©rer √† deux heures du matin - s'il vous pla√Æt. Si apr√®s les versions, vous n'avez que ¬´neuf¬ª en SLA - faites ce que vous voulez, tout est stable, vous pouvez tout faire. Cependant, si la situation est pire, nous ne serons probablement pas autoris√©s √† publier autre chose que des correctifs.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est une chose pratique √† la fois pour la stabilit√© du syst√®me et pour l'ambiance au sein de l'√©quipe. </font><font style="vertical-align: inherit;">Nous cessons d'√™tre la "police morale", ce qui nous emp√™che de la lib√©rer tard dans la nuit. </font><font style="vertical-align: inherit;">Faites ce que vous voulez tout en ayant un bon budget d'erreurs. </font><font style="vertical-align: inherit;">Cela r√©duit consid√©rablement le stress au sein de l'entreprise. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez utiliser l' </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><a href=""><font style="vertical-align: inherit;">mail</font></a><font style="vertical-align: inherit;"> ou le tweet </font><font style="vertical-align: inherit;">pour me contacter </font><font style="vertical-align: inherit;">: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@gliush</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et √† la fin, il y a beaucoup de liens pour vous, vous pouvez t√©l√©charger et voir tout vous-m√™me:</font></font><br><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mise en r√©seau native de conteneurs - Comparaison</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Livraison continue par Jez Humble, David Farley.</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les conteneurs ne sont pas des machines virtuelles</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Docker Distribution (registre d'images)</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quay - Registre d'images en tant que service</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">etcd-operator - Gestionnaire du cluster etcd au sommet de Kubernetes</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dex - OpenID Connect Identity (OIDC) et fournisseur OAuth 2.0 avec connecteurs enfichables</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awsudo - utilitaire de type sudo pour g√©rer les informations d'identification AWS</font></font></a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Autoscaling-related components for Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Simon's cat</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Helm: Kubernetes package manager</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Geodesic: framework to create your own cloud platform</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Calico: Configuring IP-in-IP</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sensu: Open-core monitoring system</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InfluxDB: Scalable datastore for metrics, events, and real-time analytics</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cernan: Telemetry and logging aggregation server</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Prometheus: Open Source monitoring solution</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Heapster: Compute Resource Usage Analysis and Monitoring of Container Clusters</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Stern: Multi pod and container log tailing for Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Minikube: tool to run Kubernetes locally</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Docker machine driver fox xhyve native OS X Hypervisor</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Drone: Continuous Delivery platform built on Docker, written in Go</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Borg, Omega and Kubernetes</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Container-Native Networking ‚Äî Comparison</a> <br></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Bug in minikube when working with xhyve driver.</a> <br></li></ol><br><blockquote>  Minute de publicit√©.  Si vous avez aim√© ce rapport de la conf√©rence <b>DevOops</b> - notez que le 14 octobre, le nouveau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevOops 2018</a> se tiendra √† Saint-P√©tersbourg, il y aura beaucoup de choses int√©ressantes dans son programme.  Le site a d√©j√† les premiers intervenants et rapports. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416161/">https://habr.com/ru/post/fr416161/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416151/index.html">Ballon sans dimension. Magie d'analyse de dimension utilitaire</a></li>
<li><a href="../fr416153/index.html">Les avions deviendront-ils plus fiables? Les constructeurs d'avions pr√©sentent des robots aux entreprises</a></li>
<li><a href="../fr416155/index.html">WebSockets dans Angular: cr√©ez un service angulaire pour travailler avec des sockets Web</a></li>
<li><a href="../fr416157/index.html">Dans les bras de Python (femmes uniquement)</a></li>
<li><a href="../fr416159/index.html">Comment nous avons √©t√© charg√©s de comparer un h√©risson avec un serpent</a></li>
<li><a href="../fr416163/index.html">Apprenez OpenGL. Le√ßon 5.6 - Mappage de parallaxe</a></li>
<li><a href="../fr416167/index.html">Peter Norwig: apprendre la programmation en ... 10 ans</a></li>
<li><a href="../fr416169/index.html">Conteneurs pour adultes (partie 01): un guide pratique de la terminologie</a></li>
<li><a href="../fr416171/index.html">Tests d'interface utilisateur cod√©s Visual Studio: th√©orie et pratique de l'application dans notre entreprise</a></li>
<li><a href="../fr416175/index.html">R√©sultats du concours des jeunes d√©veloppeurs d'applications AR Epson Moverio BT-300</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>