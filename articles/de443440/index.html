<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📄 🛀🏼 👩🏿‍🎨 PHP-Modul zum Arbeiten mit hierarchischen Daten in InterSystems IRIS 🤲🏽 👆🏿 💃🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seit Beginn seiner Zeit ist PHP dafür bekannt (und kritisiert), die Integration in eine Vielzahl von Bibliotheken sowie in fast alle DBMS auf dem Mark...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP-Modul zum Arbeiten mit hierarchischen Daten in InterSystems IRIS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intersystems/blog/443440/"><img src="https://habrastorage.org/webt/ia/44/2l/ia442lsk5svgjp_oflwf7c_sesw.png" alt="Bild" align="left">  Seit Beginn seiner Zeit ist PHP dafür bekannt (und kritisiert), die Integration in eine Vielzahl von Bibliotheken sowie in fast alle DBMS auf dem Markt zu unterstützen.  Aus seltsamen Gründen wurden hierarchische Datenbanken auf Globals jedoch nicht unterstützt. <br><br>  Globale sind Strukturen zum Speichern hierarchischer Informationen.  Sie erinnern etwas an die Datenbank „Schlüssel -&gt; Wert“, mit dem einzigen Unterschied, dass der Schlüssel mehrstufig sein kann: <br><a name="habracut"></a><br clear="all"><pre><code class="bash hljs">Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span>) = <span class="hljs-string"><span class="hljs-string">"Moscow"</span></span> Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span>, <span class="hljs-string"><span class="hljs-string">"street"</span></span>) = <span class="hljs-string"><span class="hljs-string">"Req Square"</span></span> Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"city"</span></span>, <span class="hljs-string"><span class="hljs-string">"street"</span></span>, <span class="hljs-string"><span class="hljs-string">"house"</span></span>) = 1 Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"year"</span></span>) = 1970 Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>, <span class="hljs-string"><span class="hljs-string">"first"</span></span>) = <span class="hljs-string"><span class="hljs-string">"Vladimir"</span></span> Set ^inn(<span class="hljs-string"><span class="hljs-string">"1234567890"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>, <span class="hljs-string"><span class="hljs-string">"last"</span></span>) = <span class="hljs-string"><span class="hljs-string">"Ivanov"</span></span></code> </pre> <br>  In diesem Beispiel speichert die in der globalen Festplatte integrierte ObjectScript-Sprache, die auf der Festplatte gespeichert ist (angezeigt durch das Symbol ^ vor dem globalen Namen), mehrstufige Informationen. <br><br>  Um mit Globals aus PHP arbeiten zu können, benötigen wir natürlich neue Funktionen, die vom PHP-Modul hinzugefügt werden. Dies wird weiter unten erläutert. <br><br>  Globals unterstützen viele Funktionen für die Arbeit mit Hierarchien: Umgehen von Schlüsseln auf jeder Ebene separat, Löschen, Kopieren und Einfügen ganzer Bäume und einzelner Knoten.  Nun, ebenso wie jede gute ACID-Transaktionsdatenbank.  All dies geschieht aus zwei Gründen extrem schnell (etwa 10 <sup>5</sup> -10 <sup>6</sup> Einfügevorgänge pro Sekunde auf normaler Hardware): <br><br><ol><li>  Globals sind eine niedrigere Abstraktion als SQL. </li><li>  Die globalen Basen sind seit Jahrzehnten in Produktion und in dieser Zeit gelang es ihnen, ihren Code zu lecken und ihn gründlich zu optimieren. </li></ol><br>  Mehr über Globals in der Artikelserie „Globals - Swords-Masons for Data Storage“: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Bäume.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Bäume.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spärliche Arrays.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br><br>  In dieser Welt haben Globale ihren Hauptanwendungsort in Speichersystemen mit wenig strukturierten und spärlichen Informationen gefunden, wie z. B. medizinische, personenbezogene Daten, Bankgeschäfte usw. <br><br>  Ich liebe PHP (und entwickle es) und wollte mit Globals herumspielen.  Es gab kein fertiges Modul.  Ich schrieb an InterSystems und bat mich, es zu erstellen.  Das Warten hat zu nichts geführt, und am Ende haben wir (ich zusammen mit meinem Doktoranden) das Modul selbst gemacht.  InterSystems hat die Entwicklung im Rahmen eines Ausbildungsstipendiums gesponsert. <br><br>  Im Allgemeinen handelt es sich bei InterSystems IRIS um ein DBMS mit mehreren Modellen. Von PHP aus können Sie also über ODBC mit SQL damit arbeiten. Ich war jedoch an globalen Daten interessiert, und es gab keinen solchen Konnektor. <br><br>  Das Modul ist also für PHP 7.x verfügbar (getestet unter 7.0-7.2).  Derzeit funktioniert es nur mit InterSystems IRIS und Caché, die auf demselben Host installiert sind. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modulseite in OpenExchange</a> (ein Katalog mit Projekten und Add-Ons für Entwickler in InterSystems IRIS und Caché). <br><br>  Es gibt einen nützlichen DISKUSSION-Abschnitt, in dem Personen ihre Nutzungserfahrungen teilen. <br><br>  Hier herunterladen: <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/intersystems-community/php_ext_iris</a> <br></blockquote>  Laden Sie das Repository von der Befehlszeile herunter: <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/intersystems-community/php_ext_iris</code> </pre> <br>  <a href="">Anleitung zur Installation des Moduls in Englisch und Russisch.</a> <br><br>  Modulfunktionen: <br><div class="scrollable-table"><table><tbody><tr><td>  PHP-Funktion </td><td>  Beschreibung </td></tr><tr><th colspan="2">  Mit Daten arbeiten </th></tr><tr><td>  <nobr>iris_set ($ node, value)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Installationsort.</b> <div class="spoiler_text"><ol><li><blockquote>  <strong>iris_set ($ global, $ subscript1, ..., $ subscriptN, $ value);</strong> <strong><br></strong>  <strong>iris_set ($ global, $ value);</strong> </blockquote><br>  <strong>Rückgabe:</strong> true oder false (bei Fehler). <br>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des globalen, dann die Indizes, der letzte Parameter ist der Wert. <br><br><pre> <code class="php hljs">iris_set(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>); iris_set(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span>);</code> </pre> <br>  Analog auf ObjectScript <br><br><pre> <code class="bash hljs">Set ^time = 1 Set ^time(<span class="hljs-string"><span class="hljs-string">"tree"</span></span>, 1, 1) = <span class="hljs-string"><span class="hljs-string">"value"</span></span></code> </pre> </li><li><blockquote>  <strong>iris_set ($ arrayGlobal, $ value);</strong> </blockquote>  Nur 2 Parameter: Der erste ist ein Array, in dem der Name des globalen und alle seine Indizes gespeichert sind;  Das zweite ist die Bedeutung. <br><br><pre> <code class="php hljs">$node = [<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]; iris_set($node,<span class="hljs-string"><span class="hljs-string">'value'</span></span>);</code> </pre> </li></ol></div></div><br></td></tr><tr><td>  <nobr>iris_get ($ node)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Knoten lesen.</b> <div class="spoiler_text">  <strong>Rückgabe:</strong> Wert (Zahl oder Zeichenfolge), NULL (Wert nicht definiert) oder FALSE (bei Fehler). <br><br><ol><li><blockquote>  <strong>iris_get ($ global, $ subscript1, ..., $ subscriptN);</strong> <strong><br></strong>  <strong>iris_get ($ global);</strong> </blockquote>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes.  Ein Global hat möglicherweise keine Indizes. <br><br><pre> <code class="php hljs">$res = iris_get(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>); $res1 = iris_get(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> </li><li><blockquote>  <strong>iris_get ($ arrayGlobal);</strong> </blockquote>  Der einzige Parameter ist das Array, in dem der Name des globalen Index und alle seine Indizes gespeichert sind. <br><br><pre> <code class="php hljs">$node = [<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]; $res = iris_get($node);</code> </pre> </li></ol><br></div></div></td></tr><tr><td>  <nobr>iris_zkill ($ node)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Knotenwert löschen.</b> <div class="spoiler_text">  <strong>Rückgabe:</strong> TRUE oder FALSE - bei Fehler. <br><br>  Es ist wichtig zu beachten, dass diese Funktion nur den Wert im Knoten löscht und die zugrunde liegenden Zweige nicht berührt. <br><br><ol><li><blockquote>  <strong>iris_zkill ($ global, $ subscript1, ..., $ subscriptN);</strong> <strong><br></strong>  <strong>iris_zkill ($ global);</strong> </blockquote>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes.  Ein Global hat möglicherweise keine Indizes. <br><br><pre> <code class="php hljs">$res = iris_zkill(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    . $res1 = iris_zkill('^time', 'tree', 1, 1);</span></span></code> </pre> </li><li><blockquote>  <strong>iris_zkill ($ arrayGlobal);</strong> </blockquote>  Der einzige Parameter ist das Array, in dem der Name des globalen Index und alle seine Indizes gespeichert sind. <br><br><pre> <code class="php hljs">$a = [<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]; $res = iris_zkill($a);</code> </pre> </li></ol><br></div></div></td></tr><tr><td>  <nobr>iris_kill ($ node)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Löschen Sie einen Knoten und alle untergeordneten Zweige.</b> <div class="spoiler_text">  Rückgabe: TRUE oder FALSE - bei Fehler. <br><br><ol><li><blockquote>  <strong>iris_kill ($ global, $ subscript1, ..., $ subscriptN);</strong> <strong><br></strong>  <strong>iris_kill ($ global);</strong> </blockquote>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes.  Ein Global hat möglicherweise keine Indizes. In diesem Fall wird er vollständig gelöscht. <br><br><pre> <code class="php hljs">$res1 = iris_kill(<span class="hljs-string"><span class="hljs-string">'^example'</span></span>, <span class="hljs-string"><span class="hljs-string">'subscript1'</span></span>, <span class="hljs-string"><span class="hljs-string">'subscript2'</span></span>); $res = iris_kill(<span class="hljs-string"><span class="hljs-string">'^time'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   .</span></span></code> </pre></li><li><blockquote>  <strong>iris_kill ($ arrayGlobal);</strong> </blockquote>  Der einzige Parameter ist das Array, in dem der Name des globalen Index und alle seine Indizes gespeichert sind. <br><br><pre> <code class="php hljs">$a = [<span class="hljs-string"><span class="hljs-string">'^time'</span></span>, <span class="hljs-string"><span class="hljs-string">'tree'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]; $res = iris_kill($a);</code> </pre> </li></ol><br></div></div></td></tr><tr><td>  <nobr>iris_order ($ node)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Umgehen Sie globale Niederlassungen auf einer bestimmten Ebene</b> <div class="spoiler_text">  <strong>Rückgabe: Ein</strong> Array, das den vollständigen Namen des nächsten globalen Knotens oder FALSE enthält (bei Fehler). <br><br><ol><li><blockquote>  <strong>iris_order ($ global, $ subscript1, ..., $ subscriptN);</strong> </blockquote>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes. <br><br>  PHP-Nutzungsformular und ObjectScript-Äquivalent: <br><br><pre> <code class="php hljs">iris_order(<span class="hljs-string"><span class="hljs-string">'^ccc'</span></span>,<span class="hljs-string"><span class="hljs-string">'new2'</span></span>,<span class="hljs-string"><span class="hljs-string">'res2'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// $Order(^ccc("new2", "res2"))</span></span></code> </pre> </li><li><blockquote>  <strong>iris_order ($ arrayGlobal);</strong> </blockquote>  Der einzige Parameter ist das Array, in dem der globale Name und die Indizes des Startknotens gespeichert sind. <br><br><pre> <code class="php hljs">$node = [<span class="hljs-string"><span class="hljs-string">'^inn'</span></span>, <span class="hljs-string"><span class="hljs-string">'1234567890'</span></span>, <span class="hljs-string"><span class="hljs-string">'city'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; $node !== <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; $node = iris_order($node)) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> join(<span class="hljs-string"><span class="hljs-string">', '</span></span>, $node).<span class="hljs-string"><span class="hljs-string">'='</span></span>.iris_get($node).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre> <br>  Wird uns eine Schlussfolgerung geben: <br><br><pre> <code class="bash hljs">^inn, 1234567890, city=Moscow ^inn, 1234567890, year=1970</code> </pre> </li></ol><br></div></div></td></tr><tr><td>  <nobr>iris_order_rev ($ node)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Umgehen Sie globale Zweige auf einer bestimmten Ebene in umgekehrter Reihenfolge</b> <div class="spoiler_text">  <strong>Rückgabe: Ein</strong> Array, das den vollständigen Namen des vorherigen globalen Knotens auf derselben Ebene oder FALSE enthält (falls ein Fehler auftritt). <br><br><ol><li><blockquote>  <strong>iris_order_rev ($ global, $ subscript1, ..., $ subscriptN);</strong> </blockquote><br>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes. <br><br>  PHP-Nutzungsformular und ObjectScript-Äquivalent: <br><br><pre> <code class="php hljs">iris_order_rev(<span class="hljs-string"><span class="hljs-string">'^ccc'</span></span>,<span class="hljs-string"><span class="hljs-string">'new2'</span></span>,<span class="hljs-string"><span class="hljs-string">'res2'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// $Order(^ccc("new2", "res2"), -1)</span></span></code> </pre> </li><li><blockquote>  <strong>iris_order_rev ($ arrayGlobal);</strong> </blockquote><br>  Der einzige Parameter ist das Array, in dem der globale Name und die Indizes des Startknotens gespeichert sind. <br><br><pre> <code class="php hljs">$node = [<span class="hljs-string"><span class="hljs-string">'^inn'</span></span>, <span class="hljs-string"><span class="hljs-string">'1234567890'</span></span>, <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'last'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; $node !== <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; $node = iris_order_rev($node)) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> join(<span class="hljs-string"><span class="hljs-string">', '</span></span>, $node).<span class="hljs-string"><span class="hljs-string">'='</span></span>.iris_get($node).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre> <br>  Wird uns eine Schlussfolgerung geben: <br><br><pre> <code class="bash hljs">^inn, 1234567890, name, last=Ivanov ^inn, 1234567890, name, first=Vladimir</code> </pre> </li></ol><br></div></div></td></tr><tr><td>  <nobr>iris_query ($ CmdLine)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Umgehung globaler Niederlassungen mit Zugang zu niedrigeren Ebenen</b> <div class="spoiler_text">  <strong>Rückgabe: Ein</strong> Array, das den vollständigen Namen des zugrunde liegenden Knotens (falls vorhanden) oder des nächsten globalen Knotens (falls kein verschachtelter Knoten vorhanden ist) enthält. <br><br><ol><li><blockquote>  <strong>iris_query ($ global, $ subscript1, ..., $ subscriptN);</strong> </blockquote>  Alle Funktionsparameter sind Zeichenfolgen oder Zahlen.  Der erste ist der Name des Globalen, dann die Indizes. <br><br>  PHP-Nutzungsformular und ObjectScript-Äquivalent: <br><br><pre> <code class="php hljs">iris_query(<span class="hljs-string"><span class="hljs-string">'^ccc'</span></span>, <span class="hljs-string"><span class="hljs-string">'new2'</span></span>, <span class="hljs-string"><span class="hljs-string">'res2'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// $Query(^ccc("new2", "res2"))</span></span></code> </pre> </li><li><blockquote>  <strong>iris_query ($ arrayGlobal);</strong> </blockquote>  Der einzige Parameter ist das Array, in dem der globale Name und die Indizes des Startknotens gespeichert sind. <br><br><pre> <code class="php hljs">$node = [<span class="hljs-string"><span class="hljs-string">'^inn'</span></span>, <span class="hljs-string"><span class="hljs-string">'city'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (; $node !== <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; $node = iris_query($node)) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> join(<span class="hljs-string"><span class="hljs-string">', '</span></span>, $node).<span class="hljs-string"><span class="hljs-string">'='</span></span>.iris_get($node).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre> <br>  Wird uns eine Schlussfolgerung geben: <br><br><pre> <code class="bash hljs">^inn, 1234567890, city=Moscow ^inn, 1234567890, city, street=Req Square ^inn, 1234567890, city, street, house=1 ^inn, 1234567890, name, first=Vladimir ^inn, 1234567890, name, last=Ivanov ^inn, 1234567890, year=1970</code> </pre> </li></ol><br>  Die Reihenfolge unterscheidet sich von der Reihenfolge, in der wir festlegen, da in der globalen automatisch beim Einfügen alles in aufsteigender Reihenfolge sortiert wird. <br></div></div></td></tr><tr><th colspan="2">  Servicefunktionen </th></tr><tr><td>  <nobr>iris_set_dir ($ FullPath)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Festlegen eines Verzeichnisses mit einer Datenbank</b> <div class="spoiler_text">  <strong>Rückgabe:</strong> TRUE oder FALSE - bei Fehler. <br><br><pre> <code class="php hljs">iris_set_dir(<span class="hljs-string"><span class="hljs-string">'/InterSystems/Cache/mgr'</span></span>);</code> </pre> <br>  Es muss abgeschlossen sein, bevor eine Verbindung zur Datenbank hergestellt wird. <br></div></div></td></tr><tr><td>  <nobr>iris_exec ($ CmdLine)</nobr> </td><td><div class="spoiler">  <b class="spoiler_title">Führen Sie den DB-Befehl aus</b> <div class="spoiler_text">  <strong>Rückgabe:</strong> TRUE oder FALSE - bei Fehler. <br><br><pre> <code class="php hljs">iris_exec(<span class="hljs-string"><span class="hljs-string">'kill ^global(6)'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   ObjectScript   </span></span></code> </pre> <br></div></div></td></tr><tr><td>  <nobr>iris_connect ($ login, $ pass)</nobr> </td><td>  Stellen Sie eine Verbindung zur Datenbank her </td></tr><tr><td>  <nobr>iris_quit ()</nobr> </td><td>  Unterbrechen Sie die Verbindung zur Datenbank </td></tr><tr><td>  <nobr>iris_errno ()</nobr> </td><td>  Fehlercode abrufen </td></tr><tr><td>  <nobr>iris_error ()</nobr> </td><td>  Holen Sie sich eine Textbeschreibung des Fehlers </td></tr></tbody></table></div><br>  Wenn Sie selbst mit dem Modul spielen möchten, dann: <br><br><div class="spoiler">  <b class="spoiler_title">Speziell für Habr-Benutzer wurde eine Docker-Datei erstellt, um das Image zu erstellen.</b> <div class="spoiler_text"><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/intersystems-community/php_ext_iris <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> php_ext_iris/iris docker-compose build docker-compose up -d</code> </pre><br>  Testen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Demoseite</a> auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">localhost: 52080</a> im Browser. <br><br>  PHP-Dateien, die bearbeitet und mit ihnen abgespielt werden können, befinden sich im Ordner php / demo und werden im Container bereitgestellt. <br><br>  Verwenden Sie zum Testen von IRIS den Benutzernamen <strong>admin</strong> . Das Kennwort lautet <strong>SYS</strong> . <br><br>  Verwenden Sie die folgende URL, um die IRIS-Einstellungen einzugeben: <br>  <a href="">http: // localhost: 52773 / csp / sys / UtilHome.csp</a> <br><br>  Verwenden Sie den folgenden Befehl, um die IRIS-Konsole dieses Containers aufzurufen: <br><pre> <code class="bash hljs">docker <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> -it iris_iris_1 iris session IRIS</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Speziell für Benutzer von Habr und InterSystems Caché wurde die Virtualka mit PHP-Modul aufgehoben.</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Demoseite in russischer Sprache.</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Demoseite auf Englisch.</a> <br>  Login: habr_test <br>  Passwort: burmur # @ 8765 <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Zur Selbstinstallation des Moduls unter InterSystems Caché</b> <div class="spoiler_text"><ol><li>  Habe Linux.  Ich habe unter Ubuntu getestet, unter Windows sollte das Modul auch gebaut werden, aber ich habe es nicht getestet. </li><li>  Kostenlose Version herunterladen: <ul><li>  <a href="">InterSystems Caché (Registrierung erforderlich)</a> .  Von Linux werden Red Hat und Suse sofort unterstützt, aber Sie können es auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf andere Distributionen übertragen</a> . </li></ul><br></li><li>  Installieren Sie das cach.so-Modul <a href="">gemäß den Anweisungen</a> in PHP. </li></ol></div></div><br>  Im Docker-Container auf meinem PC (AMD FX-9370 @ 4700 MHz 32 GB, LVM, SATA SSD) habe ich zum Spaß zwei primitive Tests zur Geschwindigkeit des Einfügens neuer Werte in die Datenbank durchgeführt. <br><br><ul><li>  Das Einfügen von 1 Million neuen Elementen in das globale Element dauerte 1,81 Sekunden oder 552.000 Einfügungen pro Sekunde. </li><li>  Das Aktualisieren eines Werts in derselben globalen 1.000.000-fachen Zeit dauerte 1,98 Sekunden oder 505.000 Aktualisierungen pro Sekunde.  Eine interessante Tatsache ist, dass das Einfügen erfolgt als das Aktualisieren.  Anscheinend ist dies eine Folge der anfänglichen Datenbankoptimierung zum schnellen Einfügen. </li></ul><br>  Es ist klar, dass diese Tests nicht behaupten können, genau und nützlich zu sein, da sie primitiv sind und in einem Behälter durchgeführt werden.  Auf leistungsfähigerer Hardware mit einem PCIe-SSD-Festplattensystem können zig Millionen Einfügungen pro Sekunde erzielt werden. <br><br><h3>  Was kann abgeschlossen werden und der aktuelle Status </h3><br><ol><li>  Sie können nützliche Funktionen für die Arbeit mit Transaktionen hinzufügen (Sie können sie weiterhin über iris_exec verwenden). </li><li>  Die Funktion zum Zurückgeben der gesamten Struktur des Globalen ist nicht implementiert, sodass PHP das Globale nicht umgeht. </li><li>  Die Funktion zum Speichern des PHP-Arrays als Teilbaum ist nicht implementiert. </li><li>  Der Zugriff auf lokale Datenbankvariablen ist nicht implementiert.  Nur über iris_exec, obwohl es über iris_set besser ist. </li><li>  Nicht implementiert, indem die globale Tiefe in die entgegengesetzte Richtung umgangen wird. </li><li>  Der Zugriff auf die Datenbank über das Objekt mithilfe von Methoden (ähnlich den aktuellen Funktionen) ist nicht implementiert. </li></ol><br>  Das aktuelle Modul ist wahrscheinlich noch nicht produktionsbereit: Es wurden keine Tests auf hohe Lasten und Speicherlecks durchgeführt.  Wenn es jedoch jemand braucht, kontaktieren Sie mich (Sergey Kamenev updates@mail.ru). <br><br><h3>  Fazit </h3><br>  Lange Zeit haben sich die Welten von PHP und die hierarchischen Grundlagen auf Globals praktisch nicht überschnitten, obwohl Globals eine starke und schnelle Funktionalität für bestimmte Datentypen (medizinisch, persönlich) bieten. <br><br>  Ich hoffe, dass dieses Modul als Anstoß für Experimente von PHP-Programmierern mit Globals und ObjectScript-Programmierern zur einfachen Entwicklung von Webschnittstellen in PHP dienen wird. <br><br>  PS Vielen Dank für Ihre Aufmerksamkeit! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443440/">https://habr.com/ru/post/de443440/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443430/index.html">Warum ist es schlecht, wenn das Internet alles über Sie weiß?</a></li>
<li><a href="../de443432/index.html">Blazor 0.9.0 veröffentlicht</a></li>
<li><a href="../de443434/index.html">Benachrichtigungen: Maßnahmen zur Gewinnmitnahme / Stop-Loss erforderlich. Falls Ihr Broker diese Bestellungen nicht unterstützt</a></li>
<li><a href="../de443436/index.html">Wo kann man über Apache Ignite, verteilte Datenbanken und verteiltes maschinelles Lernen im Frühjahr sprechen?</a></li>
<li><a href="../de443438/index.html">7 nützliche Firefox-Erweiterungen zum Englischlernen</a></li>
<li><a href="../de443450/index.html">Warum die Armen nicht gesund sein können</a></li>
<li><a href="../de443452/index.html">Das russische Militär wird ein eigenes geschlossenes Internet schaffen</a></li>
<li><a href="../de443456/index.html">Wir laden Sie für eine Woche zu Yandex NLP ein</a></li>
<li><a href="../de443458/index.html">6 unterhaltsame Systemfehler beim Betrieb von Kubernetes [und deren Lösung]</a></li>
<li><a href="../de443460/index.html">11 Antworten zu Yandex.Directory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>