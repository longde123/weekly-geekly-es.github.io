<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïê üíî üï¥üèΩ Acerca de compilar JDK 8 en Ubuntu, la calidad del c√≥digo de Hotspot y por qu√© todo falla en C ++ ü•§ üö≠ ü§∏üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quer√≠a dormir hoy, pero nuevamente fall√©. En Telegram apareci√≥ un mensaje de que alguien no iba a Java ... y nos despertamos solo despu√©s de un par de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Acerca de compilar JDK 8 en Ubuntu, la calidad del c√≥digo de Hotspot y por qu√© todo falla en C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/422861/"><p>  Quer√≠a dormir hoy, pero nuevamente fall√©.  En Telegram apareci√≥ un mensaje de que alguien no iba a Java ... y nos despertamos solo despu√©s de un par de horas, cansados ‚Äã‚Äãy felices. </p><br><img src="https://habrastorage.org/webt/ti/ov/lf/tiovlf2wctfucdlsql2-avqmkwe.png"><br><br>  ¬øQui√©n puede usar esta publicaci√≥n?  S√≠, probablemente para cualquiera, excepto para aquellos que tambi√©n coleccionan JDK8 o simplemente les encanta leer horrores de pesadilla.  En general, te lo advert√≠, cierra el art√≠culo con urgencia. <br><p>  Tres problemas: </p><br><ul><li>  No voy ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nivel uno</a> ) <br>  Una parte muy aburrida para saltear.  Solo es necesario para aquellos que desean restaurar completamente la historia de los eventos; </li><li>  No voy ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nivel dos</a> ) <br>  Es m√°s interesante, porque hay un par de errores t√≠picos, nigromancia, necrofilia, que BSD es mejor que GNU / Linux y por qu√© deber√≠a actualizar a nuevas versiones de JDK. </li><li>  Incluso si va, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cae en la corteza</a> <br>  M√°s interesante  Yahuuu, la JVM cay√≥ en la corteza, ¬°pate√©mosla! </li></ul><br><p>  Under the cat muestra una soluci√≥n detallada a los problemas, con diferentes reflexiones sobre la vida. </p><br><p>  Habr√° mucho C ++, no habr√° c√≥digo Java en absoluto.  Cualquier javista al final comienza a escribir solo en C ++ ... </p><a name="habracut"></a><br><h1 id="ne-sobiraetsya">  No va a </h1><br><p>  Quien haya creado Java al menos una vez sabe que se parece a esto: </p><br><pre><code class="bash hljs">hg <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> http://hg.openjdk.java.net/jdk8u/jdk8u <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> jdk8u sh ./get_source.sh sh ./configure \ --with-debug-level=fastdebug \ --with-target-bits=64 \ --with-native-debug-symbols=internal \ --with-boot-jdk=/home/me/opt/jdk1.8.0_161 make images</code> </pre> <br><p>  (Todos mis usuarios simplemente se llaman "yo", para que pueda entregar la m√°quina virtual a cualquier persona en cualquier momento y no crear un rechazo por usar su propio nombre de usuario) </p><br><p>  El problema, por supuesto, es que esto no funciona.  Y de una manera bastante c√≠nica. </p><br><a name="one"></a><br><h2 id="pervyy-uroven-pogruzheniya">  Primer nivel de inmersi√≥n </h2><br><p>  Intentemos ejecutar: </p><br><pre> <code class="bash hljs">/home/me/git/jdk8u/hotspot/src/os/linux/vm/os_linux.inline.hpp:127:18: warning: <span class="hljs-string"><span class="hljs-string">'int readdir_r(DIR*, dirent*, dirent**)'</span></span> is deprecated [-Wdeprecated-declarations] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((status = ::readdir_r(dirp, dbuf, &amp;p)) != 0) { ^~~~~~~~~</code> </pre> <br><p>  Primero, para que lo entiendas, he instalado esto: </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> g++ -<span class="hljs-literal"><span class="hljs-literal">-version</span></span> g++ (Ubuntu <span class="hljs-number"><span class="hljs-number">7.3</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-16ubuntu3</span></span>) <span class="hljs-number"><span class="hljs-number">7.3</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> Copyright (C) <span class="hljs-number"><span class="hljs-number">2017</span></span> Free Software Foundation, Inc.</code> </pre> <br><p>  El compilador no es la primera frescura, no 8.2, pero este tambi√©n deber√≠a funcionar. </p><br><p>  A los desarrolladores de C ++ les gusta probar el software solo en la versi√≥n del compilador que han instalado.  Por lo general, el deseo de probar en diferentes plataformas termina en alg√∫n lugar en la regi√≥n de la diferencia entre gcc y clang en un sentido general.  Por lo tanto, es bastante normal ejecutar primero <code>-Werror</code> ("tratar las advertencias como errores") y luego escribir un c√≥digo que en todas las dem√°s versiones se considerar√° vorings. </p><br><p>  Este es un problema conocido, y est√° claro c√≥mo resolverlo.  Debe establecer su variable de entorno CXX_FLAGS, en la que establecer el nivel correcto de errores. </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> CXX_FLAGS=-Wno-error=deprecated-declarations -Wno-error-deprecated-declarations</code> </pre> <br><p>  Y luego vemos lo maravilloso: </p><br><pre> <code class="hljs powershell">Ignoring CXXFLAGS found <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> environment. Use -<span class="hljs-literal"><span class="hljs-literal">-with</span></span><span class="hljs-literal"><span class="hljs-literal">-extra</span></span><span class="hljs-literal"><span class="hljs-literal">-cxxflags</span></span></code> </pre> <br><p>  Ok, sistema de construcci√≥n, lo que quieras!  Reemplazamos configure con este: </p><br><pre> <code class="bash hljs">hg <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> http://hg.openjdk.java.net/jdk8u/jdk8u <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> jdk8u sh ./configure \ --with-extra-cflags=<span class="hljs-string"><span class="hljs-string">'-Wno-cpp -Wno-error=deprecated-declarations'</span></span> \ --with-extra-cxxflags=<span class="hljs-string"><span class="hljs-string">'-Wno-cpp -Wno-error=deprecated-declarations'</span></span> \ --with-debug-level=fastdebug \ --with-target-bits=64 \ --with-native-debug-symbols=internal \ --with-boot-jdk=/home/me/opt/jdk1.8.0_161 make images</code> </pre> <br><p>  ¬°Y el error sigue siendo el mismo! <br>  Pasamos a la artiller√≠a pesada: el c√≥digo fuente. </p><br><pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> -rl <span class="hljs-string"><span class="hljs-string">"Werror"</span></span> .</code> </pre> <br><p>  Se cae una gran cantidad de sombreros generados autom√°ticamente, entre los que se vislumbran archivos significativos: </p><br><pre> <code class="hljs go">./common/autoconf/flags.m4 ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/bsd/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/solaris/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/aix/makefiles/xlc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span></code> </pre> <br><p>  En <code>flags.m4</code> encontramos f√°cilmente el mensaje anterior sobre "Ignorar CXXFLAGS" y la bandera codificada m√°s madura <code>CCXX_FLGS</code> (s√≠, dos letras C), que act√∫a inmediatamente en lugar de <code>CFLAGS</code> y en lugar de <code>XX_FLAGS</code> .  Convenientemente!  Dos hechos son interesantes: </p><br><ul><li>  Este indicador no se pasa a trav√©s de los par√°metros de configuraci√≥n; </li><li>  En el valor predeterminado son significativos y sospechosamente similares a estos par√°metros: </li></ul><br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># Setup compiler/platform specific flags to CFLAGS_JDK, # CXXFLAGS_JDK and CCXXFLAGS_JDK (common to C and CXX?) if test "x$TOOLCHAIN_TYPE" = xgcc; then # these options are used for both C and C++ compiles CCXXFLAGS_JDK="$CCXXFLAGS $CCXXFLAGS_JDK -Wall -Wno-parentheses -Wextra -Wno-unused -Wno-unused-parameter -Wformat=2 \ -pipe -D_GNU_SOURCE -D_REENTRANT -D_LARGEFILE64_SOURCE"</span></span></code> </pre> <br><p>  Esta pregunta se ve muy bien en los comentarios, pero ¬øqu√© son comunes las banderas?  Derecho? </p><br><p>  No jugaremos democracia y lo codificaremos autoritariamente all√≠ <code>-w</code> ("no mostrar ning√∫n error"): </p><br><pre> <code class="bash hljs"> CCXXFLAGS_JDK=<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CCXXFLAGS</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CCXXFLAGS_JDK</span></span></span><span class="hljs-string"> -w -ffreestanding -fno-builtin -Wno-parentheses -Wno-unused -Wno-unused-parameter -Wformat=2 \</span></span></code> </pre> <br><p>  Y - ¬°salud!  - El primer error que pasamos.  Ella ya no informa, y ‚Äã‚Äãen general todo est√° bien.  Parecer√≠a. </p><br><a name="two"></a><br><h2 id="vtoroy-uroven-pogruzheniya">  Segundo nivel de inmersi√≥n </h2><br><p>  ¬°Pero ahora est√° cayendo en una pila de otros lugares nuevos! </p><br><p>  Resulta que nuestro <code>-w</code> funciona, pero no se reenv√≠a a todas las partes del ensamblaje.  Leemos detenidamente los archivos MAKE y no entendemos c√≥mo se puede reenviar exactamente este par√°metro.  ¬øRealmente se olvid√≥ de √©l? </p><br><p>  Conociendo la pregunta correcta de Google ("¬øpor qu√© cxx no llega a la compilaci√≥n?"), Llegamos r√°pidamente a la p√°gina de error con el dicho <strong>"configure --with-extra-cxxflags no afecta el punto de acceso"</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JDK-8156967</a> ). </p><br><p>  Que prometen arreglarse en JDK 12. Quiz√°s.  Maravilloso: ¬°el par√°metro de compilaci√≥n m√°s importante no se usa en el ensamblaje! </p><br><p>  La primera idea es, bueno, ¬°arremangarnos y arreglar los errores! </p><br><h2 id="oshibka-1-xn12">  Error 1.xn [12] </h2><br><pre> <code class="hljs powershell">dependencies.cpp: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dependencies</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_dependency_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xmlStream*, Dependencies::DepType, GrowableArray&lt;Dependencies::DepArgument&gt;*, Klass*)</span></span></span><span class="hljs-function">': </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dependencies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cpp</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">498</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">6</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function">: '%</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-function">' </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">directive</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">between</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">10</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bytes</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">into</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">region</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function"> [-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Werror</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format-overflow</span></span></span><span class="hljs-function">=] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dependencies</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_dependency_to</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xmlStream* xtty, ^~~~~~~~~~~~ dependencies.cpp:498:6: note: directive argument in the range [0, 2147483647]</span></span></span></span></code> </pre> <br><p>  Bueno, probablemente necesitemos agrandar la regi√≥n.  Cien libras, alguien calcul√≥ el b√∫fer haciendo clic en "¬°Soy afortunado!"  en google </p><br><p>  Pero, ¬øc√≥mo entender√≠as cu√°nto necesitas?  Hay otro tipo de refinamiento a continuaci√≥n: </p><br><pre> <code class="hljs pgsql">stdio2.h:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">43</span></span>: note: <span class="hljs-string"><span class="hljs-string">'__builtin___sprintf_chk'</span></span> output <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> a destination <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> size <span class="hljs-number"><span class="hljs-number">10</span></span> __bos (__s), __fmt, __va_arg_pack ());</code> </pre> <br><p>  La posici√≥n 12 parece algo que vale la pena, con la que ahora puedes entrar en la fuente con los pies sucios. </p><br><p>  Subimos a <code>dependencies.cpp</code> y observamos la siguiente imagen: </p><br><pre> <code class="cpp hljs">DepArgument arg = args-&gt;at(j); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (j == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg.is_oop()) { xtty-&gt;object(<span class="hljs-string"><span class="hljs-string">"x"</span></span>, arg.oop_value()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { xtty-&gt;object(<span class="hljs-string"><span class="hljs-string">"x"</span></span>, arg.metadata_value()); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> xn[<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">sprintf</span></span>(xn, <span class="hljs-string"><span class="hljs-string">"x%d"</span></span>, j); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arg.is_oop()) { xtty-&gt;object(xn, arg.oop_value()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { xtty-&gt;object(xn, arg.metadata_value()); } }</code> </pre> <br><p>  Presta atenci√≥n a la l√≠nea problem√°tica: </p><br><pre> <code class="hljs perl">char xn[<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">sprintf</span></span>(xn, <span class="hljs-string"><span class="hljs-string">"x%d"</span></span>, j);</code> </pre> <br><p>  Cambiamos de 10 a 12, volvemos a armar y ... ¬°la asamblea se ha ido! </p><br><p>  ¬øPero soy el √∫nico tan inteligente y solucionado el error de todos los tiempos?  Sin duda, de nuevo llevamos nuestro megapatch a Google: <code>char xn[12];</code> </p><br><p>  Y vemos ... s√≠, es cierto.  El error <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JDK-8184309</a> , prohibido por Vladimir Ivanov, contiene exactamente la misma soluci√≥n. </p><br><p>  Pero la conclusi√≥n es que solo est√° arreglado en JDK 10 y nifiga no est√° soportado en jdk8u.  Esta es la pregunta de por qu√© se necesitan nuevas versiones de Java. </p><br><h2 id="oshibka-2-strcmp">  Error 2. strcmp </h2><br><pre> <code class="hljs powershell">fprofiler.cpp: <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> member <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> '</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ThreadProfiler</span></span></span><span class="hljs-function">::</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TickPosition)</span></span></span><span class="hljs-function">': /</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">home</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">me</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">git</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">jdk8ut</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hotspot</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">src</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">share</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runtime</span></span></span><span class="hljs-function">/</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fprofiler</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cpp</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">638</span></span></span><span class="hljs-function">:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">56</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">argument</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">null</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">where</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">non-null</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">expected</span></span></span><span class="hljs-function"> [-</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Werror</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nonnull</span></span></span><span class="hljs-function">] </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_match</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(const char* name)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">const</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> strcmp(name, _name) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>  Ense√±ado por la amarga experiencia previa, inmediatamente vamos a ver qu√© hay en este lugar en JDK 11. Y ... este archivo no est√° all√≠.  La estructura del directorio tambi√©n ha sufrido algunas refactorizaciones. </p><br><p>  ¬°Pero no puedes alejarte de nosotros! </p><br><p>  Cualquier javista es un peque√±o nigromante en su alma, y ‚Äã‚Äãtal vez incluso un necr√≥filo.  ¬°Por lo tanto, ahora habr√° NECROMANCE EN ACCI√ìN! </p><br><p>  Primero debes apelar al alma de los muertos y descubrir cu√°ndo muri√≥: </p><br><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$</span></span> hg log -<span class="hljs-literal"><span class="hljs-literal">-template</span></span> <span class="hljs-string"><span class="hljs-string">"File(s) deleted in rev {rev}: {file_dels % '\n {file}'}\n\n"</span></span> <span class="hljs-literal"><span class="hljs-literal">-r</span></span> <span class="hljs-string"><span class="hljs-string">'removes("**/fprofiler.cpp")'</span></span> File(s) deleted <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rev <span class="hljs-number"><span class="hljs-number">47106</span></span>: hotspot/src/share/vm/runtime/fprofiler.cpp hotspot/src/share/vm/runtime/fprofiler.hpp hotspot/test/runtime/MinimalVM/Xprof.java</code> </pre> <br><p>  Ahora necesitas descubrir la causa de su muerte: </p><br><pre> <code class="hljs pgsql">hg <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> -r <span class="hljs-number"><span class="hljs-number">47106</span></span> changeset: <span class="hljs-number"><span class="hljs-number">47106</span></span>:bed18a111b90 parent: <span class="hljs-number"><span class="hljs-number">47104</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>bdc0c9c44af <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: gziemski <span class="hljs-type"><span class="hljs-type">date</span></span>: Thu Aug <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">26</span></span>:<span class="hljs-number"><span class="hljs-number">53</span></span> <span class="hljs-number"><span class="hljs-number">2017</span></span> <span class="hljs-number"><span class="hljs-number">-0500</span></span> <span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>: <span class="hljs-number"><span class="hljs-number">8173715</span></span>: Remove FlatProfiler</code> </pre><br><p>  Entonces, tenemos un asesino: <strong>gziemski</strong> .  Veamos por qu√© clav√≥ este desafortunado archivo. </p><br><p>  Para hacer esto, vaya a gordo en el ticket especificado en el resumen de la confirmaci√≥n.  Este es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">JDK-8173715</a> : </p><br><p>  Eliminar FlatProfiler: <br>  Asumimos que esta tecnolog√≠a ya no est√° en uso y es una fuente de escaneo de ra√≠z para el GC. </p><br><p>  Para shih bis.  De hecho, ahora estamos invitados a reparar el cad√°ver para que la construcci√≥n contin√∫e.  Lo que se descompuso tanto que incluso nuestros colegas nigromantes de OpenJDK lo abandonaron. </p><br><p>  Resucitemos al hombre muerto e intentemos preguntarle qu√© fue lo √∫ltimo que record√≥.  Ya estaba muerto en la revisi√≥n 47106, lo que significa que hay uno menos en la revisi√≥n, esto es "un segundo antes": </p><br><pre> <code class="bash hljs">hg cat <span class="hljs-string"><span class="hljs-string">"~/git/jdk11/hotspot/src/share/vm/runtime/fprofiler.cpp"</span></span> -r 47105 &gt; ~/tmp/fprofiler_new.cpp cp ~/git/jdk8u/hotspot/src/share/vm/runtime/fprofiler.cpp ~/tmp/fprofiler_old.cpp <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/tmp diff fprofiler_old.cpp fprofiler_new.cpp</code> </pre> <br><p>  Desafortunadamente, nada en absoluto con respecto a <code>return strcmp(name, _name) == 0;</code>  en diff no.  El paciente muri√≥ a causa de un golpe con un objeto contundente (utilidad rm), pero al momento de la muerte ya ten√≠a una enfermedad terminal. </p><br><p>  Profundicemos en la esencia del error. </p><br><p>  Esto es lo que el autor del c√≥digo quisiera decirnos: </p><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_compiled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vm_match</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* name)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">strcmp</span></span>(name, _name) == <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p>  Ahora un poco de filosof√≠a. </p><br><p>  El est√°ndar C11 en la cl√°usula 7.1.4, "Uso de funciones de biblioteca", dice expl√≠citamente: </p><br><blockquote>  Cada una de las siguientes afirmaciones se aplica a menos que se indique expl√≠citamente lo contrario en las descripciones detalladas que siguen: Si un argumento a una funci√≥n tiene un valor no v√°lido (como [...] un puntero nulo [...]) [...], El comportamiento es indefinido. </blockquote><p>  Es decir, ahora toda la cuesti√≥n es si existe alguna <em>"declaraci√≥n expl√≠cita de lo contrario"</em> .  Nada de eso est√° escrito en la descripci√≥n de <code>strcmp</code> en la secci√≥n 7.24.4, y no tengo otras secciones para usted. </p><br><p>  Es decir, tenemos un comportamiento indefinido aqu√≠. </p><br><p>  Por supuesto, puede tomar y reescribir este fragmento de c√≥digo, rode√°ndolo con verificaci√≥n.  Pero no estoy completamente seguro de entender correctamente la l√≥gica de las personas que usan UB donde no deber√≠a estar.  Por ejemplo, algunos sistemas generan SIGSERV para cero desreferenciaci√≥n, y un amante de los hacks puede aprovecharlo, pero este comportamiento no es obligatorio y puede comenzar en otra plataforma. </p><br><p>  S√≠, por supuesto, alguien dir√° que eres un tonto, que est√°s usando GCC 7.3, pero en GCC 4 todo se habr√≠a reunido.  ¬°Pero comportamiento indefinido! = ¬°Sin especificar! = Implementaci√≥n definida.  Esto para los dos √∫ltimos puede establecerse para que funcione en el compilador anterior.  Y UB en la sexta versi√≥n era UB. </p><br><p>  En resumen, me entristeci√≥ por completo esta compleja pregunta filos√≥fica (deber√≠a entrar en el c√≥digo con mis suposiciones) cuando de repente me di cuenta de que pod√≠a ser diferente. </p><br><h1 id="est-drugoy-put">  Hay otra manera </h1><br><p>  Como sabes, los buenos h√©roes siempre andan por ah√≠. </p><br><p>  Incluso si ignoramos nuestra filosof√≠a sobre UB, hay una cantidad incre√≠ble de problemas all√≠.  No es el hecho de que puedan repararse hasta la ma√±ana.  No es el hecho de que no puedo hacerlo con mis manos torcidas.  A√∫n menos es el hecho de que esto se aceptar√° en la fase inicial: el √∫ltimo parche en jdk8u fue hace 6 semanas, y esta fue la fusi√≥n global de la nueva etiqueta. </p><br><p>  Solo imagine que el c√≥digo anterior est√° escrito correctamente.  Todo lo que se interpone entre nosotros y su ejecuci√≥n es una advertencia, que se percibi√≥ como un error debido a un error en el sistema de compilaci√≥n.  Pero podemos construir un sistema de construcci√≥n. </p><br><p>  El brujo Geralt de Rivia dijo una vez: </p><br><blockquote>  "El mal es malvado, Stregobor", dijo el brujo con gravedad, levant√°ndose.  - M√°s peque√±o, m√°s grande, promedio: todo es igual, las proporciones son arbitrarias y los bordes est√°n borrosos.  No soy un ermita√±o sagrado, no solo hice un bien en mi vida.  Pero si tienes que elegir entre un mal y otro, prefiero no elegir en absoluto. <br><br>  - Z≈Ço a z≈Ço, Stregoborze - rzek≈Ç powa≈ºnie wied≈∫min wstajƒÖc.  - Mniejsze, wiƒôksze, ≈õrednie, wszystko jedno, proporcje sƒÖ umowne a granice zatarte.  Nie jestem ≈õwiƒÖtobliwym pustelnikiem, nie samo dobro czyni≈Çem w ≈ºyciu.  Ale je≈ºeli mam wybieraƒá pomiƒôdzy jednym z≈Çem a drugim, a wolƒô nie wybieraƒá wcale. </blockquote><p>  Esta es una cita de The Last Wish, una historia llamada Lesser Evil.  Todos sabemos que Geralt casi nunca podr√≠a desempe√±ar el papel de un personaje verdaderamente neutral, e incluso muri√≥ debido a otro comportamiento ca√≥tico cl√°sico. </p><br><p>  As√≠ que hagamos una demostraci√≥n r√°pida del mal menor.  Pasemos al sistema de compilaci√≥n. </p><br><p>  Al principio, ya vimos este escape: </p><br><pre> <code class="hljs go">grep -rl <span class="hljs-string"><span class="hljs-string">"Werror"</span></span> . ./common/autoconf/flags.m4 ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/linux/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/bsd/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/solaris/makefiles/gcc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span> ./hotspot/<span class="hljs-built_in"><span class="hljs-built_in">make</span></span>/aix/makefiles/xlc.<span class="hljs-built_in"><span class="hljs-built_in">make</span></span></code> </pre> <br><p>  Al comparar estos dos archivos, romp√≠ toda la cara con la cara palmada y me di cuenta de la diferencia en la cultura de las dos plataformas: </p><br><p>  BSD es una historia sobre libertad y elecci√≥n: </p><br><pre> <code class="hljs lisp"># Compiler warnings are treated as errors ifneq ($(<span class="hljs-name"><span class="hljs-name">COMPILER_WARNINGS_FATAL</span></span>),false) WARNINGS_ARE_ERRORS = -Werror endif</code> </pre> <br><p>  GNU / Linux es un r√©gimen purista autoritario: </p><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Compiler warnings are treated as errors WARNINGS_ARE_ERRORS = -Werror</span></span></code> </pre> <br><p>  Bueno, se <code>XX_FLAGS</code> a Linux a trav√©s de <code>XX_FLAGS</code> , ¬°esta variable no se tiene en cuenta al calcular <code>WARNINGS_ARE_ERRORS</code> !  En la compilaci√≥n para GNU / Linux, simplemente no tenemos m√°s opci√≥n que seguir los valores predeterminados que se han lanzado desde arriba. </p><br><p>  Bueno, o puede hacerlo m√°s f√°cil y cambiar el valor de <code>WARNINGS_ARE_ERRORS</code> a un breve, pero no menos poderoso <code>-w</code> .  ¬øQu√© te parece eso, Elon Musk? </p><br><p>  Como habr√°s adivinado, esto resuelve completamente este problema de compilaci√≥n. </p><br><p>  Cuando se ensambla el c√≥digo, ves pasar un mont√≥n de problemas extra√±os y terriblemente vistos.  A veces suced√≠a tanto miedo que realmente quer√≠a presionar ctrl + C e intentar resolverlo.  Pero no, no puedes, no puedes ... </p><br><p>  Parece que todo se reuni√≥ y no trajo ning√∫n problema adicional.  Aunque, por supuesto, no me atrev√≠ a comenzar a probar.  A√∫n as√≠, de noche, mis ojos comienzan a fijarse, y de alguna manera no quiero ir al √∫ltimo recurso: cuatro latas de energ√≠a del refrigerador. </p><br><a name="three"></a><br><h1 id="padaet-v-korku">  Cae en la corteza </h1><br><p>  La asamblea ha pasado, se han generado los ejecutables, somos geniales. </p><br><p>  Y as√≠ llegamos a la l√≠nea de meta.  ¬øO no viniste? </p><br><p>  Nuestro montaje se encuentra de la siguiente manera: </p><br><pre> <code class="hljs powershell">export JAVA_HOME=~/git/jdk8u/build/linux<span class="hljs-literal"><span class="hljs-literal">-x86_64</span></span><span class="hljs-literal"><span class="hljs-literal">-normal</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>/jdk export PATH=<span class="hljs-variable"><span class="hljs-variable">$JAVA_HOME</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre> <br><p>  Cuando intenta ejecutar el ejecutable de <code>java</code> , se bloquea instant√°neamente.  Para aquellos que no est√°n familiarizados, se ve as√≠: </p><br><p><img src="https://habrastorage.org/webt/n2/3p/ep/n23pepls-unfomopiqb1zgkx5eq.png"><br></p><br><p>  Al mismo tiempo, Alex tiene Debian 9.5 y yo tengo Ubuntu.  Dos versiones diferentes de GCC, dos costras de aspecto diferente.  Tengo bromas inocentes con el parche manual strcmp y algunos lugares m√°s, Alex no.  Cual es el problema </p><br><p>  Esta historia es digna de otra historia, pero aqu√≠ vamos directamente a las conclusiones secas, de lo contrario nunca agregar√© esta publicaci√≥n. </p><br><p>  El problema es que nuestros pogromistas favoritos de C ++ nuevamente usaron un comportamiento indefinido. </p><br><p>  (Adem√°s, donde de alguna manera desconocida depende de la implementaci√≥n del compilador. Sin embargo, debemos recordar que UB siempre es UB, incluso en una versi√≥n conocida del compilador es imposible establecerlo) </p><br><p>  En un lugar pasamos al campo de una clase poco dise√±ada all√≠, y todo se rompe.  No preguntes c√≥mo sucedi√≥, todo es complicado. </p><br><p>  Es muy dif√≠cil para un javista imaginar c√≥mo se puede recurrir a una clase subconstruida, excepto emitiendo un enlace directamente desde el constructor.  Afortunadamente, el maravilloso lenguaje C ++ puede hacer todo o casi todo.  Escribir√© un ejemplo con cierto pseudoc√≥digo: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class"> {</span></span> A() { _b.Show(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> B _b; }; A a; BA::_b; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }</code> </pre> <br><p>  ¬°Que tengas una buena depuraci√≥n! </p><br><p>  Si nos fijamos en C ++ 98 [class.cdtor]: </p><br><blockquote>  Para un objeto de tipo de clase no POD ... antes de que el constructor comience la ejecuci√≥n ... hacer referencia a cualquier miembro no est√°tico o clase base del objeto da como resultado un comportamiento indefinido </blockquote><p>  Comenzando con GCC de alguna versi√≥n (y tengo 7.3), apareci√≥ una optimizaci√≥n de la "eliminaci√≥n del dep√≥sito muerto de por vida", que cree que nos referimos a un objeto solo durante su tiempo de vida, y todo se agota fuera del tiempo de vida. </p><br><p>  La soluci√≥n es deshabilitar las nuevas optimizaciones y volver como estaban en el antiguo CCG: </p><br><pre> <code class="hljs powershell">CFLAGS += <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-strict</span></span><span class="hljs-literal"><span class="hljs-literal">-aliasing</span></span> <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-lifetime</span></span><span class="hljs-literal"><span class="hljs-literal">-dse</span></span> <span class="hljs-literal"><span class="hljs-literal">-fno</span></span><span class="hljs-literal"><span class="hljs-literal">-delete</span></span><span class="hljs-literal"><span class="hljs-literal">-null</span></span><span class="hljs-literal"><span class="hljs-literal">-pointer</span></span><span class="hljs-literal"><span class="hljs-literal">-checks</span></span></code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hay</a> una discusi√≥n sobre esto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br>  Por alguna raz√≥n, los participantes en la discusi√≥n decidieron que esto no se incluir√≠a en la corriente ascendente.  Pero a√∫n debes intentar enviarlo. </p><br><p>  Agregue estas opciones a nuestro <code>./hotspot/make/linux/makefiles/gcc.make</code> , <code>./hotspot/make/linux/makefiles/gcc.make</code> ensamblar todo nuevamente y vea las apreciadas l√≠neas: </p><br><pre> <code class="hljs powershell">t<span class="hljs-variable"><span class="hljs-variable">$</span></span> ~/git/jdk8u/build/linux<span class="hljs-literal"><span class="hljs-literal">-x86_64</span></span><span class="hljs-literal"><span class="hljs-literal">-normal</span></span><span class="hljs-literal"><span class="hljs-literal">-server</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>/jdk/bin/java <span class="hljs-literal"><span class="hljs-literal">-version</span></span> openjdk version <span class="hljs-string"><span class="hljs-string">"1.8.0-internal-fastdebug"</span></span> OpenJDK Runtime Environment (build <span class="hljs-number"><span class="hljs-number">1.8</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-internal</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span><span class="hljs-literal"><span class="hljs-literal">-me_2018_09_10_08_14</span></span><span class="hljs-literal"><span class="hljs-literal">-b00</span></span>) OpenJDK <span class="hljs-number"><span class="hljs-number">64</span></span><span class="hljs-literal"><span class="hljs-literal">-Bit</span></span> Server VM (build <span class="hljs-number"><span class="hljs-number">25.71</span></span><span class="hljs-literal"><span class="hljs-literal">-b00</span></span><span class="hljs-literal"><span class="hljs-literal">-fastdebug</span></span>, mixed mode)</code> </pre> <br><h1 id="zaklyuchenie">  Conclusi√≥n </h1><br><p>  Probablemente pensaste que la conclusi√≥n ser√≠a: "Java es una especie de infierno, hay basura en el c√≥digo, no hay soporte, todo est√° mal". </p><br><p>  ¬°Esto no es as√≠!  Por el contrario, los ejemplos anteriores muestran el mal terrible que nuestros amigos, nigromantes de OpenJDK, nos impiden. </p><br><p>  Y a pesar del hecho de que tienen que vivir y usar C ++, temblar con cada UB y cambiar la versi√≥n del compilador y aprender las sutilezas de las plataformas, el c√≥digo de usuario final en Java es incre√≠blemente estable y en las versiones publicadas en sitios web oficiales de compa√±√≠as como Azul, Red Hat y Oracle apenas pueden toparse con la corteza en un caso simple. </p><br><p>  Lo √∫nico triste es que lo m√°s probable es que los errores encontrados no sean aceptados en jdk8u.  Tomamos JDK 8 simplemente porque nos es m√°s f√°cil parchearlo aqu√≠ y ahora, y tendremos que lidiar con JDK 11.  Sin embargo, usar JDK 8 en 2018 es en mi humilde opini√≥n, esta es una muy mala pr√°ctica, y no lo hacemos desde una buena vida.  Quiz√°s nuestra vida mejore en el futuro, y leer√°s muchas m√°s historias incre√≠bles del mundo de JDK 11 y JDK 12. </p><br><p>  Gracias por la atenci√≥n prestada a un texto tan aburrido sin im√°genes :-) </p><br><blockquote>  Minuto de publicidad.  La Conferencia Joker 2018 se llevar√° a cabo muy pronto, donde habr√° muchos especialistas destacados en Java y JVM.  Vea la lista completa de oradores e informes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el sitio web oficial</a> .  Yo tambi√©n estar√© all√≠, ser√° posible conocer y abatir de por vida y OpenJDK. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422861/">https://habr.com/ru/post/es422861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422843/index.html">Una introducci√≥n al mundo de los chips falsos: t√©cnicas de detecci√≥n de falsificaciones</a></li>
<li><a href="../es422845/index.html">¬øC√≥mo hacer que la televisi√≥n sea realmente inteligente?</a></li>
<li><a href="../es422851/index.html">¬øPor qu√© el futuro del almacenamiento de datos sigue siendo una cinta magn√©tica?</a></li>
<li><a href="../es422857/index.html">Implementando su contenedor IoC</a></li>
<li><a href="../es422859/index.html">El Ministerio de Comunicaciones propuso cambiar a tarjetas SIM con encriptaci√≥n del FSB</a></li>
<li><a href="../es422863/index.html">Tribus, gremios, tren de construcci√≥n y sin TDD: c√≥mo funciona el desarrollo m√≥vil en Uber, Spotify, Odnoklassniki y Avito</a></li>
<li><a href="../es422865/index.html">Java Enterprise Open Lesson "CDI en acci√≥n"</a></li>
<li><a href="../es422867/index.html">Determinaci√≥n del n√∫mero de pisos de una casa a partir de su fotograf√≠a sin aprendizaje autom√°tico</a></li>
<li><a href="../es422869/index.html">Dominamos nuevos lenguajes de programaci√≥n, confiando en los ya aprendidos</a></li>
<li><a href="../es422871/index.html">Identificar perfiles significativos en VK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>