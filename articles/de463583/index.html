<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèø üëÇ ü§∞üèæ Fantastische Plugins, vol. 1. Theorie üôÜüèº üë®üèæ‚Äçüíª üë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Das Leben mit einem Multi-Modul-Projekt ist nicht so einfach. Um die Routine zum Erstellen eines neuen Moduls zu vermeiden, haben wir unser eigenes Pl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fantastische Plugins, vol. 1. Theorie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/463583/"><p>  Das Leben mit einem Multi-Modul-Projekt ist nicht so einfach.  Um die Routine zum Erstellen eines neuen Moduls zu vermeiden, haben wir unser eigenes Plug-In f√ºr Android Studio erstellt.  Bei der Implementierung sind wir auf einen Mangel an praktischer Dokumentation gesto√üen, haben verschiedene Ans√§tze ausprobiert und viele Fallstricke ausgegraben.  Es stellte sich heraus, zwei Artikel: "Theorie" und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Praxis"</a> .  Triff mich! </p><br><p><img src="https://habrastorage.org/webt/an/fg/dp/anfgdpffwxapeeei7coineoxdvk.png" alt="Bild"></p><a name="habracut"></a><br><h1 id="o-chem-budu-govorit">  Wor√ºber werde ich sprechen? </h1><br><ul><li>  Warum ein Plugin?  Warum ein Plugin? <br><ul><li>  Checkliste erstellen </li><li>  Checkliste Automatisierungsoptionen </li></ul></li><li>  Grundlagen der Plugin-Entwicklung <br><ul><li>  Aktionen </li><li>  UI-Entwicklung in Plugins </li><li>  Schlussfolgerungen </li></ul></li><li>  IDEA-Interna: Komponenten, PSI <br><ul><li>  IDEA Interne Einheit </li><li>  PSI </li><li>  Schlussfolgerungen </li></ul></li></ul><br><h1 id="zachem-plagin-pochemu-plagin">  Warum ein Plugin?  Warum ein Plugin? </h1><br><p>  Wenn Sie ein Android-Projekt mit mehreren Modulen entwickeln, wissen Sie, welche Routine es ist, jedes Mal ein neues Modul zu erstellen.  Sie m√ºssen ein Modul erstellen, Gradle darin konfigurieren, Abh√§ngigkeiten hinzuf√ºgen, auf die Synchronisierung warten und nicht vergessen, etwas im Anwendungsmodul zu reparieren - alles nimmt viel Zeit in Anspruch.  Wir wollten die Routine automatisieren und haben zun√§chst eine Checkliste erstellt, die zeigt, was wir jedes Mal tun, wenn wir ein neues Modul erstellen. </p><br><p>  1. Zun√§chst erstellen wir das Modul selbst √ºber das Men√º Datei -&gt; Neu -&gt; Neues Modul -&gt; Android-Bibliothek. </p><br><p><img src="https://habrastorage.org/webt/eo/nt/tk/eonttksy33ofpojuctkl8aoghuo.png" alt="Bild"></p><br><p>  2. Wir schreiben die Pfade zum Modul in die Datei settings.gradle, da wir verschiedene Modultypen haben - Core-Module und Feature-Module, die sich in verschiedenen Ordnern befinden. </p><br><div class="spoiler">  <b class="spoiler_title">Wir schreiben Pfade zu den Modulen</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// settings.gradle include ':analytics project(':analytics').projectDir = new File(settingsDir, 'core/framework-metrics/analytics) ... include ':feature-worknear' project(':feature-worknear').projectDir = new File(settingsDir, 'feature/feature-worknear')</span></span></code> </pre> </div></div><br><p>  3. √Ñndern Sie die Konstanten <em>compileSdk</em> , <em>minSdk</em> , <em>targetSdk</em> im generierten <em>build.gradle</em> : Ersetzen Sie sie durch die Konstanten, die im root <em>build.gradle</em> definiert sind. </p><br><div class="spoiler">  <b class="spoiler_title">Konstanten in build.gradle des neuen Moduls √§ndern</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Feature module build.gradle ‚Ä¶ android { compileSdkVersion rootProject.ext.targetSdkVersion defaultConfig { minSdkVersion rootProject.ext.minSdkVersion targetSdkVersion rootProject.ext.targetSdkVersion ... } }</span></span></code> </pre> </div></div><br><p>  Hinweis: Wir haben diesen Teil unserer Arbeit k√ºrzlich in unser Gradle-Plugin entfernt, mit dessen Hilfe alle erforderlichen Parameter der Datei <em>build.gradle</em> in mehreren Zeilen konfiguriert werden k√∂nnen. </p><br><p>  4. Da wir den gesamten neuen Code in Kotlin schreiben, verbinden wir standardm√§√üig zwei Plugins: <em>kotlin-android</em> und <em>kotlin-kapt</em> .  Wenn das Modul irgendwie mit der Benutzeroberfl√§che verbunden ist, verbinden wir zus√§tzlich das Modul <em>kotlin-android-extensions</em> . </p><br><div class="spoiler">  <b class="spoiler_title">Verbinden Sie Kotlin-Plugins</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Feature module build.gradle apply plugin: 'com.android.library' apply plugin: 'kotlin-android' apply plugin: 'kotlin-android-extensions' apply plugin: 'kotlin-kapt'</span></span></code> </pre></div></div><br><p>  5. Wir verbinden die allgemeinen Bibliotheken und Kernmodule.  Kernmodule sind beispielsweise Logger, Analytics, einige allgemeine Dienstprogramme und Bibliotheken - RxJava, Moxy und viele andere. </p><br><div class="spoiler">  <b class="spoiler_title">Wir verbinden gemeinsam genutzte Bibliotheken und Module</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Feature module build.gradle dependencies { def libraries = rootProject.ext.deps compileOnly project(':logger') compileOnly project(':analytics') ‚Ä¶ // Kotlin compileOnly libraries.kotlin // DI compileOnly libraries.toothpick kapt libraries.toothpickCompiler }</span></span></code> </pre></div></div><br><p>  6. Richten Sie kapt f√ºr Toothpick ein.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zahnstocher</a> ist unser zentrales DI-Framework.  H√∂chstwahrscheinlich wissen Sie: Um die Codegenerierung anstelle der Reflektion im Release-Build zu verwenden, m√ºssen Sie den Anmerkungsprozessor so konfigurieren, dass er versteht, woher die Fabriken f√ºr die erstellten Objekte stammen: </p><br><div class="spoiler">  <b class="spoiler_title">Konfigurieren des Anmerkungsprozessors f√ºr Toothpick</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Feature module build.gradle defaultConfig { ... javaCompileOptions { annotationProcessorOptions { arguments = [ toothpick_registry_package_name: "ru.hh.feature_worknear" ] } } ...</span></span></code> </pre> </div></div><br><p>  Hinweis: In hh.ru verwenden wir die erste Version von Toothpick, in der zweiten haben wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die M√∂glichkeit zur Codegenerierung entfernt</a> . </p><br><p>  7. Wir konfigurieren kapt f√ºr Moxy im erstellten Modul.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Moxy</a> ist unser Hauptframework f√ºr die Erstellung von MVP in einer Anwendung, und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie m√ºssen es ein wenig drehen, damit</a> es in einem Projekt mit mehreren Modulen funktioniert.  Registrieren Sie insbesondere das Paket des erstellten Moduls in den kapt-Argumenten: </p><br><div class="spoiler">  <b class="spoiler_title">Kapt f√ºr Moxy konfigurieren</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Feature module build.gradle android { ... kapt { arguments { arg("moxyReflectorPackage", "ru.hh.feature_worknear") } } ...</span></span></code> </pre></div></div><br><p>  Hinweis: Wir haben bereits auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neue Version von Moxy</a> umgestellt, und dieser Teil der Codegenerierung hat seine Relevanz verloren. </p><br><p>  8. Wir generieren eine Reihe neuer Dateien.  Ich meine nicht die Dateien, die automatisch erstellt werden (AndroidManifest.xml, build.gradle, .gitignore), sondern den allgemeinen Rahmen des neuen Moduls: Interaktoren, Repositorys, DI-Module, Pr√§sentatoren, Fragmente.  Es gibt viele dieser Dateien, sie haben am Anfang die gleiche Struktur, und das Erstellen ist eine Routine. </p><br><p><img src="https://habrastorage.org/webt/j2/f5/sz/j2f5szalxm1nmgg4yj9kivxpdfs.png" alt="Bild"></p><br><p>  9. Wir verbinden unser erstelltes Modul mit dem Anwendungsmodul.  In diesem Schritt m√ºssen Sie daran denken, Toothpick in der Datei build.gradle des Anwendungsmoduls zu konfigurieren.  Zu diesem Zweck f√ºgen wir das Paket des erstellten Moduls dem speziellen Argumentanmerkungsprozessor hinzu - <em>dentpick_registry_children_package_names</em> . </p><br><div class="spoiler">  <b class="spoiler_title">Zahnstocher stimmen</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// App module build.gradle defaultConfig { ‚Ä¶ javaCompileOptions { annotationProcessorOptions { arguments = [ toothpick_registry_package_name: "ru.hh.android", toothpick_registry_children_package_names: [ "ru.hh.analytics", "ru.hh.feature_worknear", ... ].join(",") ] } } ‚Ä¶</span></span></code> </pre></div></div><br><p>  Danach konfigurieren wir Moxy im Anwendungsmodul.  Wir haben eine Klasse, die mit der Annotation <strong>@RegisterMoxyReflectorPackages</strong> gekennzeichnet ist - dort f√ºgen wir den Paketnamen des erstellten Moduls hinzu: </p><br><div class="spoiler">  <b class="spoiler_title">Konfigurieren Sie MoxyReflectorStub</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-comment"><span class="hljs-comment">// App module file @RegisterMoxyReflectorPackages( "ru.hh.feature_force_update", "ru.hh.feature_profile", "ru.hh.feature_worknear" ... ) class MoxyReflectorStub</span></span></code> </pre> </div></div><br><p>  Vergessen Sie am Ende nicht, das erstellte Modul mit dem <em>Abh√§ngigkeitsblock</em> des Anwendungsmoduls zu verbinden: </p><br><div class="spoiler">  <b class="spoiler_title">Abh√§ngigkeiten hinzuf√ºgen</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Application module build.gradle dependencies { def libraries = rootProject.ext.deps implementation project(':logger') implementation project(':dependency-handler') implementation project(':common') implementation project(':analytics') implementation project(':feature_worknear') ...</span></span></code> </pre> </div></div><br><p>  Wir haben eine Checkliste mit neun Punkten. </p><br><p>  Da es viele Punkte gibt, wird es wahrscheinlich etwas vergessen.  Und dann fragen Sie sich stundenlang, was passiert ist und warum das Projekt nicht stattfinden wird. </p><br><p>  Wir haben beschlossen, dass Sie nicht so leben k√∂nnen und etwas √§ndern m√ºssen. </p><br><h2 id="varianty-avtomatizacii-chek-lista">  Checkliste Automatisierungsoptionen </h2><br><p>  Nachdem wir die Checkliste zusammengestellt hatten, suchten wir nach Optionen zur Automatisierung ihrer Elemente. </p><br><p>  Die erste Option war ein Versuch, <strong>"Strg + C, Strg + V" auszuf√ºhren</strong> .  Wir haben versucht, eine Implementierung f√ºr die Erstellung des Android Library-Moduls zu finden, die uns "out of the box" zur Verf√ºgung steht.  Im Ordner mit Android Studio (f√ºr MacOs: <em>/ Applications / Android \ Studio.app/Contents/plugins/android/lib/templates/gradle-projects/</em> ) finden Sie einen speziellen Ordner mit Vorlagen der Projekte, die bei Auswahl von Datei - <em>angezeigt werden.</em> &gt; Neu -&gt; Neues Modul.  Wir haben versucht, die NewAndroidModule-Vorlage zu kopieren, indem wir die ID in der Datei <em>template.xml.ftl</em> ge√§ndert haben.  Dann haben sie die IDE gestartet, ein neues Modul erstellt und ... Android Studio ist abgest√ºrzt, weil die Liste der Module, die Sie im Men√º zum Erstellen eines neuen Moduls sehen, fest codiert ist. Sie k√∂nnen sie nicht durch primitives Kopieren und Einf√ºgen √§ndern.  Wenn Sie versuchen, ein Element aufzunehmen und hinzuzuf√ºgen, zu l√∂schen oder zu √§ndern, st√ºrzt Android Studio einfach ab. </p><br><p><img src="https://habrastorage.org/webt/ym/ww/sw/ymwwsw1rzibvaxwrhkqkwd5fqyk.png" alt="Bild"></p><br><p>  Die zweite Option zur Automatisierung der Checkliste war die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FreeMarker-Vorlagen-Engine</a> .  Nach einem erfolglosen Versuch des Kopierens und Einf√ºgens haben wir uns die Modulvorlagen genauer angesehen und FreeMarker-Vorlagen unter der Haube gefunden. </p><br><p>  Ich werde Ihnen nicht im Detail sagen, was FreeMarker ist - es gibt einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">guten Artikel von RedMadRobot</a> und ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Video von MosDroid von Lesha Bykov</a> .  Kurz gesagt - dies ist eine Engine zum Generieren von Dateien mithilfe von Vorlagen und speziellen Map-ki-Java-Objekten.  Sie f√ºttern Vorlagen, Objekte und FreeMarker generiert Code an der Ausgabe. </p><br><p>  Aber schauen Sie sich noch einmal die Checkliste an: </p><br><p><img src="https://habrastorage.org/webt/nf/hl/81/nfhl811qacot1f4j_pt2fhsmm8k.png" alt="Bild"></p><br><p>  Wenn Sie genau hinschauen, k√∂nnen Sie sehen, dass es in zwei gro√üe Gruppen von Aufgaben unterteilt ist: </p><br><ul><li>  Die Aufgaben zum Generieren eines neuen Codes (1, 3, 4, 5, 6, 7, 8) und </li><li>  Aufgaben zum √Ñndern eines vorhandenen Codes (2, 7, 8, 9) </li></ul><br><p>  Und wenn FreeMarker Aufgaben der ersten Gruppe mit einem Knall bew√§ltigt, dann bew√§ltigt es die zweite √ºberhaupt nicht.  Als kleines Beispiel: Wenn Sie in der aktuellen Implementierung der FreeMarker-Integration in Android Studio versuchen, eine Zeile in die Datei settings.gradle einzuf√ºgen, die nicht mit dem Wort 'include' beginnt, <a href="">st√ºrzt</a> das <a href="">Studio ab</a> .  Hier haben wir die Traurigen gefangen und beschlossen, die Verwendung von FreeMarker aufzugeben. </p><br><p>  Nach einem Fehler mit FreeMarker kam die Idee auf, mein eigenes Konsolendienstprogramm f√ºr die Durchf√ºhrung einer Checkliste zu schreiben.  In Intellij IDEA ist es m√∂glich, ein Terminal zu verwenden. Warum also nicht?  Lassen Sie uns ein Skript √ºber die Bash schreiben, total business: </p><br><p><img src="https://habrastorage.org/webt/t0/2h/ki/t02hki4jlkvs_7eaqisfbuqnyb0.png" alt="Bild"></p><br><p>  Da wir das erstellte Modul jedoch flexibel konfigurieren m√∂chten, m√ºssen wir viele verschiedene Flags eingeben, was f√ºr das Drucken in der Konsole nicht sehr bequem ist. </p><br><p>  Danach traten wir einen Schritt zur√ºck und erinnerten uns daran, dass wir in Intellij IDEA arbeiteten.  Und wie ist es angeordnet?  Es gibt einen bestimmten Kern von Klassen, eine Engine, an die viele Plug-Ins angeschlossen sind, die die von uns ben√∂tigte Funktionalit√§t hinzuf√ºgen. </p><br><p>  Wie viele von Ihnen sehen im Screenshot mehr als zwei verbundene Plugins? </p><br><p><img src="https://habrastorage.org/webt/rf/fr/dm/rffrdmuui00uxtruelogjpor_le.png" alt="Bild"></p><br><div class="spoiler">  <b class="spoiler_title">Wo soll man suchen? ..</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/0m/uw/ua/0muwuamgty0p8kri2ywhq3dsbaw.png" alt="Bild"></p></div></div><br><p>  Hier sind sie mindestens drei miteinander verbunden.  Wenn Sie mit Kotlin arbeiten, ist das Kotlin-Plugin aktiviert.  Wenn Sie in einem Projekt mit Gradle arbeiten, ist auch das Gradle-Plugin enthalten.  Wenn Sie in einem Projekt mit einem Versionskontrollsystem arbeiten - Git, SVN oder etwas anderem -, ist das entsprechende Plug-In f√ºr die Integration dieses VCS enthalten. </p><br><p>  Wir haben uns das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offizielle</a> JetBrains- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Plugin-Repository angesehen</a> und festgestellt, dass es bereits √ºber 4000 offiziell registrierte Plugins gibt!  Fast die ganze Welt schreibt Plugins, und diese Plugins k√∂nnen alles: von der Integration einer Programmiersprache in IDEA bis hin zu spezifischen Tools, die in IDEA ausgef√ºhrt werden k√∂nnen. </p><br><p>  Kurz gesagt, wir haben beschlossen, unser eigenes Plugin zu schreiben. </p><br><h1 id="osnovy-razrabotki-plaginov">  Grundlagen der Plugin-Entwicklung </h1><br><p>  Wir gehen weiter zu den Grundlagen der Plugin-Entwicklung.  Um loszulegen, ben√∂tigen Sie nur drei Dinge: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IntelliJ IDEA</a> , minimale Community Edition (Sie k√∂nnen in der Ultimate-Version arbeiten, bietet jedoch keine besonderen Vorteile bei der Entwicklung von Plugins); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Plugin DevKit</a> ist ein spezielles Plugin, das die M√∂glichkeit bietet, andere Plugins zu schreiben. </li><li>  Und jede JVM-Sprache, in der Sie ein Plugin schreiben m√∂chten.  Es k√∂nnte Kotlin, Java, Groovy sein - alles. </li></ol><br><p>  Wir beginnen mit der Erstellung eines Plugin-Projekts.  Wir w√§hlen <strong>Neues Projekt</strong> , Punkt <strong>Gradle</strong> , wir kreuzen das <strong>IntelliJ Platform Plugin an</strong> und wir erstellen das Projekt. </p><br><p><img src="https://habrastorage.org/webt/je/rf/wd/jerfwdeqfmpzdef-_cypw4wahw8.png" alt="Bild"></p><br><p>  Hinweis: Wenn das Kontrollk√§stchen IntelliJ Platform Plugin nicht angezeigt wird, ist das Plugin DevKit nicht installiert. </p><br><p>  Nach dem Ausf√ºllen der erforderlichen Felder sehen wir eine leere Plugin-Struktur. </p><br><p><img src="https://habrastorage.org/webt/i2/sy/59/i2sy59dpr0pi8nlmhfyhson20h8.png" alt="Bild"></p><br><p>  Schauen wir es uns genauer an.  Es besteht aus: </p><br><ul><li>  Ordner, in die Sie den Code f√ºr das zuk√ºnftige Projekt schreiben werden;  ( <em>main / java</em> , <em>main / kotlin</em> usw.); </li><li>  <em>build.gradle-</em> Datei, in der Sie die Abh√§ngigkeiten Ihres Plugins von einigen Bibliotheken deklarieren und so etwas wie das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>gradle-Intellij-Plugin</em></a> konfigurieren. </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>Gradle-Intellij-Plugin</em></a> - Gradle-Plugin, mit dem Sie Gradle als Plugin-Build-System verwenden k√∂nnen.  Dies ist praktisch, da fast jeder Android-Entwickler mit Gradle vertraut ist und wei√ü, wie man damit arbeitet.  Dar√ºber hinaus f√ºgt das Gradle-Intellij-Plugin Ihrem Projekt n√ºtzliche Gradle-Aufgaben hinzu, insbesondere: </p><br><ul><li>  runIde - Diese Aufgabe startet eine separate IDEA-Instanz mit einem Plugin, das Sie entwickeln, damit Sie es debuggen k√∂nnen. </li><li>  buildPlugin - sammelt das Zip-Archiv Ihres Plugins, damit Sie es entweder lokal oder √ºber das offizielle IDEA-Repository verteilen k√∂nnen; </li><li>  verifyPlugin - Diese Aufgabe √ºberpr√ºft Ihr Plugin auf schwerwiegende Fehler, die es m√∂glicherweise nicht in Android Studio oder eine andere IDEA integrieren lassen. </li></ul><br><p>  Was gibt <em>Gradle-Intellij-Plugin noch</em> ?  Mit seiner Hilfe wird es einfacher, Abh√§ngigkeiten von anderen Plugins hinzuzuf√ºgen, aber wir werden etwas sp√§ter dar√ºber sprechen, aber im <em>Moment</em> kann ich sagen, dass das <em>Gradle-Intellij-Plugin</em> Ihr Bruder ist. Verwenden Sie es. </p><br><p>  Zur√ºck zur Plugin-Struktur.  Die wichtigste Datei eines Plugins ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>plugin.xml</em></a> . </p><br><div class="spoiler">  <b class="spoiler_title">plugin.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">idea-plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>com.experiment.simple.plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>Hello, world<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vendor</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">email</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"myemail@yourcompany.com"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.mycompany.com"</span></span></span><span class="hljs-tag">&gt;</span></span> My company <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vendor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>&lt;![CDATA[ My first ever plugin - try to open Hello world dialog&lt;br&gt; ]]&gt;<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span>com.intellij.modules.lang<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span>org.jetbrains.kotlin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span>org.intellij.groovy<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depends</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">idea-version</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">since-build</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"163"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">actions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My actions"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MyActionGroup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"My actions"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">separator</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.experiment.actions.OpenHelloWorldAction"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.experiment.actions.OpenHelloWorldAction"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Show Hello world"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Open dialog"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add-to-group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">group-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NewGroup"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">anchor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"last"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">actions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">idea-plugin</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p>  Dies ist eine Datei, die enth√§lt: </p><br><ul><li>  Ihre Plugin-Metadaten: Kennung, Name, Beschreibung, Herstellerinformationen, √Ñnderungsprotokoll </li><li>  Beschreibung der Abh√§ngigkeiten von anderen Plugins; </li><li>  Hier k√∂nnen Sie auch die IDEA-Version angeben, mit der Ihr Plugin ordnungsgem√§√ü funktioniert </li><li>  <em>Hier</em> werden auch <em>Aktionen</em> beschrieben. </li></ul><br><h3 id="actions">  Aktionen </h3><br><p>  Was sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Aktionen</a> ?  Angenommen, Sie √∂ffnen ein Men√º, um eine neue Datei zu erstellen.  Tats√§chlich wurde jedes Element dieses Men√ºs durch eine Art Plugin hinzugef√ºgt: </p><br><p><img src="https://habrastorage.org/webt/al/8y/kg/al8ykgojltbksqkuqu5l8cww4fw.png" alt="Bild"></p><br><p>  Aktionen sind die Einstiegspunkte f√ºr Benutzer in Ihr Plugin.  Jedes Mal, wenn der Benutzer auf einen Men√ºpunkt klickt, erhalten Sie die Kontrolle innerhalb des Plugins. Sie k√∂nnen auf diesen Klick reagieren und das Notwendige tun. <br>  Wie werden Aktionen erstellt?  Schreiben wir eine einfache Aktion, die einen Dialog mit der Meldung "Hallo Welt" anzeigt. </p><br><div class="spoiler">  <b class="spoiler_title">OpenHelloWorldAction</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHelloWorldAction</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AnAction</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionPerformed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(actionEvent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AnActionEvent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> project = actionEvent.project Messages.showMessageDialog( project, <span class="hljs-string"><span class="hljs-string">"Hello world!"</span></span>, <span class="hljs-string"><span class="hljs-string">"Greeting"</span></span>, Messages.getInformationIcon() ) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AnActionEvent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.update(e) <span class="hljs-comment"><span class="hljs-comment">// TODO - Here we can update our action (for example, disable it) } override fun beforeActionPerformedUpdate(e: AnActionEvent) { super.beforeActionPerformedUpdate(e) // TODO - This method calls right before 'actionPerformed' } }</span></span></code> </pre> </div></div><br><p>  Um eine Aktion zu erstellen, erstellen wir zun√§chst eine Klasse, die von der <em>AnAction-</em> Klasse erbt.  Zweitens m√ºssen wir die actionPerformed-Methode neu definieren, wobei der spezielle Parameter der <em>AnActionEvent-</em> Klasse <em>kommt</em> .  Dieser Parameter enth√§lt Informationen zum Ausf√ºhrungskontext Ihrer Aktion.  Der Kontext bezieht sich auf das Projekt, in dem Sie arbeiten, die Datei, die jetzt im Code-Editor des Benutzers ge√∂ffnet ist, die im Projektbaum ausgew√§hlten Elemente und andere Daten, die bei der Verarbeitung Ihrer Aufgaben hilfreich sein k√∂nnen. </p><br><p>  Um das Dialogfeld "Hallo Welt" <em>anzuzeigen</em> , <em>rufen</em> wir zuerst das Projekt ab (nur √ºber den Parameter <em>AnActionEvent</em> ) und verwenden dann die Dienstprogrammklasse <em>Nachrichten</em> , um das Dialogfeld anzuzeigen. </p><br><p>  Welche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zus√§tzlichen Funktionen</a> haben wir in der Aktion?  Wir k√∂nnen zwei Methoden √ºberschreiben: <em>update</em> und <em>beforeActionPerformedUpdate</em> . </p><br><p>  Die <em>Aktualisierungsmethode</em> wird jedes Mal aufgerufen, wenn sich der Ausf√ºhrungskontext Ihrer Aktion √§ndert.  Warum es f√ºr Sie n√ºtzlich sein kann: Zum Beispiel, um den Men√ºpunkt zu aktualisieren, der von Ihrem Plugin hinzugef√ºgt wurde.  Angenommen, Sie haben eine Aktion geschrieben, die nur mit Kotlin-Dateien funktioniert, und der Benutzer hat jetzt die Groovy-Datei ge√∂ffnet.  Dann k√∂nnen Sie in der Aktualisierungsmethode Ihre Aktion unzug√§nglich machen. </p><br><p>  Die <em>beforeActionPerformedUpdate-</em> Methode √§hnelt der update-Methode, wird jedoch direkt vor <em>actionPerformed aufgerufen</em> .  Dies ist die letzte Gelegenheit, Ihre Aktion zu beeinflussen.  In der Dokumentation wird empfohlen, bei dieser Methode nichts ‚ÄûSchweres‚Äú auszuf√ºhren, damit sie so schnell wie m√∂glich ausgef√ºhrt wird. </p><br><p>  Sie k√∂nnen Aktionen auch an bestimmte Elemente der IDEA-Schnittstelle binden und diese als Standardtastenkombinationen f√ºr den Aufruf festlegen. Ich empfehle, hier mehr dar√ºber zu lesen. </p><br><h3 id="razrabotka-ui-v-plaginah">  UI-Entwicklung in Plugins </h3><br><p>  Wenn Sie ein eigenes Dialogdesign ben√∂tigen, m√ºssen Sie hart arbeiten.  Wir haben unsere Benutzeroberfl√§che entwickelt, weil wir eine praktische grafische Oberfl√§che haben wollten, in der es m√∂glich sein w√ºrde, einige Ticks zu markieren, einen Selektor f√ºr Enum-Werte zu haben und so weiter. </p><br><p>  Das Plugin DevKit f√ºr die Entwicklung der Benutzeroberfl√§che f√ºgt einige Aktionen hinzu, z. B. das <em>GUI-Formular</em> und den <em>Dialog</em> .  Das erste erstellt ein leeres Formular f√ºr uns, das zweite ein Formular mit zwei Schaltfl√§chen: <em>Ok</em> und <em>Abbrechen</em> . </p><br><p><img src="https://habrastorage.org/webt/wd/bx/3r/wdbx3rhggovpfv-fey53fucs2aw.png" alt="Bild"></p><br><p>  Okay, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es gibt einen Formulardesigner</a> , aber er ist ... so lala.  Im Vergleich dazu sieht sogar der Layout-Designer in Android Studio komfortabel und gut aus.  Die gesamte Benutzeroberfl√§che wird in einer Bibliothek wie Java Swing entwickelt.  Dieser Formular-Designer generiert eine f√ºr Menschen lesbare XML-Datei.  Wenn Sie im Formular-Designer nichts tun k√∂nnen (Beispiel: F√ºgen Sie mehrere Steuerelemente in dieselbe Rasterzelle ein und verbergen Sie alle Steuerelemente bis auf eines), m√ºssen Sie zu dieser Datei gehen und sie √§ndern. IDEA √ºbernimmt diese √Ñnderungen. </p><br><p>  Fast jedes Formular besteht aus zwei Dateien: Die erste hat die Erweiterung <em>.form</em> , dies ist nur die XML-Datei, die zweite ist die sogenannte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>Bound-Klasse</em></a> , die in Java, Kotlin, geschrieben werden kann, aber was auch immer Sie wollen.  Es fungiert als Formular-Controller.  Unerwartet, aber das Schreiben in Java ist viel einfacher als in anderen Sprachen.  Denn zum Beispiel ist das Tuning f√ºr Kotlin noch nicht so perfekt.  Wenn Sie bei der Arbeit mit der Java-Klasse neue Komponenten hinzuf√ºgen, werden diese Komponenten automatisch zur Klasse hinzugef√ºgt. Wenn Sie den Namen der Komponente im Designer √§ndern, wird sie automatisch abgerufen.  Bei Kotlin werden jedoch keine Komponenten hinzugef√ºgt - es findet keine Integration statt, Sie k√∂nnen etwas vergessen und nicht verstehen, warum nichts funktioniert. </p><br><h3 id="rezyumiruem-osnovy">  Wir fassen die Grundlagen zusammen </h3><br><ul><li>  Um ein Plugin zu erstellen, ben√∂tigen Sie: IDEA Community Edition, Plugin DevKit und Java, die damit verbunden sind. </li><li>  Gradle-Intellij-Plugin ist dein Bruder, es wird dein Leben stark vereinfachen, ich empfehle es zu benutzen. </li><li>  Schreiben Sie keine eigene Benutzeroberfl√§che, es sei denn, dies ist erforderlich.  In IDEA gibt es viele Dienstprogrammklassen, mit denen Sie sofort eine eigene Benutzeroberfl√§che erstellen k√∂nnen.  Wenn Sie etwas Kompliziertes brauchen, machen Sie sich bereit, hart zu arbeiten. </li><li>  Das Plugin kann beliebig viele Aktionen ausf√ºhren.  Das gleiche Plugin kann Ihrer IDEA viele Funktionen hinzuf√ºgen. </li></ul><br><h1 id="vnutrennosti-idea-komponenty-psi">  IDEA-Interna: Komponenten, PSI </h1><br><p>  Lassen Sie uns √ºber den Darm von IDEA sprechen, dar√ºber, wie er im Inneren angeordnet ist.  Ich sage Ihnen, dass nichts in Ihrem Kopf zusammenbricht, wenn ich den praktischen Teil erkl√§re, und dass Sie verstehen, woher er kommt. </p><br><p>  Wie ist IDEA aufgebaut?  Auf der ersten Ebene der Hierarchie befindet sich eine Klasse wie <a href=""><em>Application</em></a> .  Dies ist eine separate IDEA-Instanz.  F√ºr jede IDEA-Instanz wird ein Anwendungsklassenobjekt erstellt.  Wenn Sie beispielsweise AppCode, Intellij IDEA und Android Studio gleichzeitig ausf√ºhren, erhalten Sie drei separate Instanzen der Anwendungsklasse.  Diese Klasse ist f√ºr den Eingabe- / Ausgabestream ausgelegt. </p><br><div class="spoiler">  <b class="spoiler_title">Platzieren Sie die Anwendung in der Hierarchie</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/rw/_y/vm/rw_yvmpfn1hyekftipxwuq-qxn8.png" alt="Bild"></p></div></div><br><p>  Die n√§chste Stufe ist die <a href=""><em>Projektklasse</em></a> .  Dies ist das Konzept, das dem beim √ñffnen eines neuen Projekts in IDEA am n√§chsten kommt.  Das Projekt wird normalerweise ben√∂tigt, um andere Komponenten in IDEA zu integrieren: Dienstprogrammklassen, Manager und vieles mehr. </p><br><div class="spoiler">  <b class="spoiler_title">Projektplatz in der Hierarchie</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xv/ku/z6/xvkuz6ezzzd5w5_c9suloyafcza.png" alt="Bild"></p></div></div><br><p>  Die n√§chste Detailebene ist die <a href=""><em>Modulklasse</em></a> .  Im Allgemeinen ist ein Modul eine Hierarchie von Klassen, die in einem Ordner zusammengefasst sind.  Aber hier meinen wir mit Modulen Maven-Module, Gradle-Module.  Diese Klasse wird zum einen ben√∂tigt, um die Abh√§ngigkeiten zwischen Modulen zu bestimmen, und zum anderen, um nach Klassen innerhalb dieser Module zu suchen. </p><br><div class="spoiler">  <b class="spoiler_title">Platzieren Sie das Modul in einer Hierarchie</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/zr/vs/ah/zrvsahicec7gak2sfqhox2ldts0.png" alt="Bild"></p></div></div><br><p>  Die n√§chste Detailebene ist die <a href=""><em>VirtualFile-</em></a> Klasse.  Dies ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abstraktion √ºber die reale Datei</a> , die sich auf Ihrer Festplatte befindet.  Mehrere <em>VirtualFile-</em> Instanzen k√∂nnen jeder realen Datei entsprechen, sind jedoch alle gleich.  Wenn gleichzeitig die reale Datei gel√∂scht wird, wird <em>VirtualFile</em> nicht selbst gel√∂scht, sondern wird einfach ung√ºltig. </p><br><div class="spoiler">  <b class="spoiler_title">VirtualFile Hierarchy Place</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/z8/4y/hq/z84yhqyl6tzv-1uwc_ersyhmqv0.png" alt="Bild"></p></div></div><br><p>  Jeder <em>VirtualFile</em> ist <em>eine</em> Entit√§t wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>Document</em></a> zugeordnet.  Es ist eine Abstraktion √ºber den Text Ihrer Datei.  <em>Das Dokument wird</em> ben√∂tigt, damit Sie Ereignisse verfolgen k√∂nnen, die sich auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√Ñnderungen im Text der Datei</a> beziehen: Der Benutzer hat eine Zeile eingef√ºgt, eine Zeile gel√∂scht usw. usw. </p><br><div class="spoiler">  <b class="spoiler_title">Dokument in Hierarchie einf√ºgen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/fr/nc/qg/frncqgrdpc3xgtnn_txrhlvdcv0.png" alt="Bild"></p></div></div><br><p>  Ein wenig neben dieser Hierarchie steht die <a href=""><em>Editor-</em></a> Klasse - es ist ein Code-Editor.  Jedes Projekt kann einen <em>Editor haben</em> .  Es wird ben√∂tigt, damit Sie Ereignisse im Zusammenhang mit dem Code-Editor verfolgen k√∂nnen: Der Benutzer hat die Zeile markiert, in der sich das Caret befindet, und so weiter. </p><br><div class="spoiler">  <b class="spoiler_title">Platz des Herausgebers in der Hierarchie</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/fk/kj/l-/fkkjl-c-t5nyehcwt6j-ywdhwf0.png" alt="Bild"></p></div></div><br><p>  Das Letzte, <a href=""><em>wor√ºber</em></a> ich sprechen wollte, ist <a href=""><em>PsiFile</em></a> .  Dies ist auch eine Abstraktion √ºber reale Dateien, jedoch unter dem Gesichtspunkt der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Darstellung von Codeelementen</a> .  PSI steht f√ºr Program Structure Interface. </p><br><div class="spoiler">  <b class="spoiler_title">PsiFile Platz in der Hierarchie</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ho/kn/l0/hoknl08rk2giwbxure86b3pqcva.png" alt="Bild"></p></div></div><br><p>  Und woraus besteht jedes Programm?  Betrachten Sie eine regul√§re Java-Klasse. </p><br><div class="spoiler">  <b class="spoiler_title">Einfache Java-Klasse</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.experiment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.inject.Inject; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> String injectedString; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(injectedString); } }</code> </pre> </div></div><br><p>  Es besteht aus der Angabe eines Pakets, von Importen, Klassen, Feldern, Methoden, Anmerkungen, Schl√ºsselw√∂rtern, Datentypen, Modifikatoren, Bezeichnern, Methodenreferenzen, Ausdr√ºcken und Token.  Und f√ºr jedes Element gibt es eine Abstraktion von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><em>PsiElement</em></a> .  Das hei√üt, jedes Ihrer Programme besteht aus <em>PsiElements</em> . </p><br><p><img src="https://habrastorage.org/webt/ps/oa/2t/psoa2timve59g__naf1rrskzfdm.png" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PsiFile</a> ist wiederum eine Baumstruktur, in der jedes Element ein √ºbergeordnetes Element und viele Nachkommen haben kann. </p><br><p><img src="https://habrastorage.org/webt/mi/4j/f2/mi4jf2mdcqjc1huurmu2ca0hsfi.png" alt="Bild"></p><br><p>  Ich m√∂chte erw√§hnen, dass PSI nicht gleich einem <strong>abstrakten Syntaxbaum ist</strong> .  Ein abstrakter Syntaxbaum ist ein Repr√§sentationsbaum Ihres Programms, nachdem der Parser Ihr Programm √ºbergeben hat, und er ist von jeder Programmiersprache getrennt.  PSI ist im Gegenteil <strong>an</strong> eine bestimmte Programmiersprache <strong>gebunden</strong> .  Wenn Sie mit einer Java-Klasse arbeiten, haben Sie es mit Java PsiElements zu tun.  Bei der Arbeit mit einer Groovy-Klasse - mit Groovy PsiElements und so weiter.   ,         PSI-  -  ,      ,   , ‚Äì    . </p><br><p>      PSI ‚Äì   PSI-   IDEA.            ,    ,        ,   .         . </p><br><h3 id="rezyumiruem-chast-pro-vnutrennosti-idea">     IDEA </h3><br><ul><li> PSI      IDEA; </li><li> PSI-   IDEA,            ; </li><li>         PsiElement-. </li></ul><br><p>      ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> .            . </p><br><h2 id="dopolnitelnye-materialy-po-plaginostroeniyu">     </h2><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zum Erstellen eines Plugins f√ºr die Zeiterfassung</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beginn einer gro√üen Reihe von Artikeln, die die Plugin-Dokumentation erg√§nzen</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie Ihr eigenes Tool-Fenster</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zur Erweiterung der Funktionalit√§t des Code-Editors</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein kleines Beispiel f√ºr das Erstellen eines eigenen Plugins</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">      IntelliJ IDEA</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">       IDEA</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">      IntelliJ IDEA</a> </li><li>   , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>     .    ,     . </li><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  Droidcon Italy 2017</a> ,  ,   , ,        FreeMarker- .        ,      . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   KotlinConf</a> ,     Square       SQLDelight,        Java,   Kotlin. </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463583/">https://habr.com/ru/post/de463583/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463573/index.html">Der erste Chip f√ºr Rechenzentren basierend auf der Zen 2-Architektur</a></li>
<li><a href="../de463575/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 22. Dritte CCNA: RIP weiter studieren</a></li>
<li><a href="../de463577/index.html">Plastizit√§t und Festigkeit: Aush√§rtung des Intermetalls ohne Betonung der Versetzung</a></li>
<li><a href="../de463579/index.html">Windows: Finden Sie heraus, wer wo angemeldet ist</a></li>
<li><a href="../de463581/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 23. Erweiterte Routing-Technologien</a></li>
<li><a href="../de463585/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 24. IPv6</a></li>
<li><a href="../de463587/index.html">ConfigureAwait, wer ist schuld und was zu tun?</a></li>
<li><a href="../de463591/index.html">BlueKeep-2 - Alle neuen Windows-Versionen sind jetzt anf√§llig</a></li>
<li><a href="../de463595/index.html">Wir steuern den Fokus oder eine Prise C # und STM32 f√ºr eine Webcam</a></li>
<li><a href="../de463597/index.html">Verwenden der Kontext-API in React zum Erstellen eines reaktionsschnellen Anwendungsdesigns</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>