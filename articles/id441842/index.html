<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👈🏽 🚽 🏂🏻 Go Praktis: Kiat untuk Menulis Program yang Didukung di Dunia Nyata 🐕 🧦 😘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini berfokus pada praktik terbaik untuk menulis kode Go. Ini disusun dalam gaya presentasi, tetapi tanpa slide biasa. Kami akan mencoba menera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Go Praktis: Kiat untuk Menulis Program yang Didukung di Dunia Nyata</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441842/">  Artikel ini berfokus pada praktik terbaik untuk menulis kode Go.  Ini disusun dalam gaya presentasi, tetapi tanpa slide biasa.  Kami akan mencoba menerangkan secara singkat dan jelas setiap item. <br><br>  Pertama, Anda perlu menyepakati apa arti praktik <i>terbaik</i> untuk bahasa pemrograman.  Di sini Anda dapat mengingat kata-kata Russ Cox, direktur teknis Go: <br><br><blockquote>  Rekayasa perangkat lunak adalah apa yang terjadi pada pemrograman, jika Anda menambahkan faktor waktu dan programmer lainnya. </blockquote><br>  Dengan demikian, Russ membedakan antara konsep <i>pemrograman</i> dan <i>rekayasa perangkat lunak</i> .  Dalam kasus pertama, Anda menulis sebuah program untuk diri sendiri, di saat Anda membuat produk yang akan digunakan oleh programmer lain dari waktu ke waktu.  Insinyur datang dan pergi.  Tim tumbuh atau menyusut.  Fitur baru ditambahkan dan bug diperbaiki.  Ini adalah sifat pengembangan perangkat lunak. <br><a name="habracut"></a><br><a name="0"></a><h1>  Isi </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Isi</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1. Prinsip dasar</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kesederhanaan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Keterbacaan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Produktivitas</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2. Pengidentifikasi</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Nama pengidentifikasi berdasarkan kejelasan daripada singkatnya</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panjang ID</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jangan beri nama variabel berdasarkan tipe</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gunakan gaya penamaan tunggal</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gunakan gaya deklarasi tunggal</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2.6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bekerja untuk tim</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3. Komentar</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Komentar dalam variabel dan konstanta harus menggambarkan isinya, bukan tujuan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Selalu mendokumentasikan karakter yang tersedia untuk umum</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4. Struktur paket</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Paket yang baik dimulai dengan nama yang bagus</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Hindari nama seperti markas, umum, atau util</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kembalilah dengan cepat tanpa menyelam dalam-dalam</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jadikan nilai nol bermanfaat</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4.5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Hindari status tingkat paket</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">5. Struktur proyek</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">5.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lebih sedikit paket tetapi lebih besar</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">5.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Paket utama terkecil</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6. struktur API</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Desain API yang sulit disalahgunakan oleh desain</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mendesain API untuk Kasus Penggunaan Dasar</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Biarkan fungsi menentukan perilaku yang diinginkan.</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">7. Penanganan kesalahan</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">7.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Hilangkan kebutuhan untuk penanganan kesalahan dengan menghapus sendiri kesalahan tersebut</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">7.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tangani kesalahan hanya sekali</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">8. Konkurensi</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">8.1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Lakukan beberapa pekerjaan sepanjang waktu.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">8.2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Serahkan paralelisme kepada penelepon</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">8.3.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jangan pernah menjalankan goroutine tanpa tahu kapan akan berhenti</a> </li></ul></li></ul><br><a name="1"></a><h1>  1. Prinsip dasar </h1><br>  Saya mungkin salah satu pengguna pertama Go di antara Anda, tetapi ini bukan pendapat pribadi saya.  Prinsip-prinsip dasar ini mendasari Go sendiri: <br><br><ol><li>  Kesederhanaan </li><li>  Keterbacaan </li><li>  Produktivitas </li></ol><br>  <i>Catatan</i>  <i>Harap dicatat, saya tidak menyebutkan "kinerja" atau "konkurensi".</i>  <i>Ada bahasa yang lebih cepat daripada Go, tetapi tentu saja tidak dapat dibandingkan dengan kesederhanaan.</i>  <i>Ada bahasa yang menempatkan paralelisme sebagai prioritas utama, tetapi mereka tidak dapat dibandingkan dalam hal keterbacaan atau produktivitas pemrograman.</i> <i><br><br></i>  <i>Kinerja dan konkurensi adalah atribut penting, tetapi tidak sepenting kesederhanaan, keterbacaan, dan produktivitas.</i> <br><br><a name="1_1"></a><h2>  Kesederhanaan </h2><br><blockquote>  <i>“Kesederhanaan adalah prasyarat untuk keandalan”</i> - Edsger Dijkstra </blockquote><br>  Mengapa berjuang untuk kesederhanaan?  Mengapa penting agar program Go sederhana? <br><br>  Kita masing-masing menemukan kode yang tidak bisa dipahami, bukan?  Ketika Anda takut untuk melakukan perubahan karena itu akan merusak bagian lain dari program yang Anda tidak mengerti dan tidak tahu bagaimana cara memperbaikinya.  Inilah kesulitannya. <br><br><blockquote>  <i>“Ada dua cara untuk merancang perangkat lunak: yang pertama adalah membuatnya sangat sederhana sehingga tidak ada kekurangan yang jelas, dan yang kedua adalah membuatnya sangat rumit sehingga tidak ada kekurangan yang jelas.</i>  <i>Yang pertama jauh lebih sulit. ”</i> - C.E. R. Hoar </blockquote><br>  Kompleksitas mengubah perangkat lunak yang andal menjadi tidak dapat diandalkan.  Kompleksitas adalah yang membunuh proyek perangkat lunak.  Oleh karena itu, kesederhanaan adalah tujuan utama Go.  Program apa pun yang kami tulis, harus sederhana. <br><br><a name="1_2"></a><h2>  1.2.  Keterbacaan </h2><br><blockquote>  <i>“Keterbacaan adalah bagian integral dari kemampuan pemeliharaan”</i> - Mark Reinhold, JVM Conference, 2018 </blockquote><br>  Mengapa penting agar kode dapat dibaca?  Mengapa kita harus berusaha agar mudah dibaca? <br><br><blockquote>  <i>"Program harus ditulis untuk orang, dan mesin hanya menjalankannya"</i> - Hal Abelson dan Gerald Sassman, "Struktur dan interpretasi program komputer" </blockquote><br>  Tidak hanya Go program, tetapi umumnya semua perangkat lunak ditulis oleh orang untuk orang.  Fakta bahwa mesin juga memproses kode adalah sekunder. <br><br>  Sekali kode tertulis akan berulang kali dibaca oleh orang: ratusan, jika tidak ribuan kali. <br><br><blockquote>  <i>"Keterampilan paling penting bagi seorang programmer adalah kemampuan untuk mengkomunikasikan ide secara efektif."</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gaston Horker</a> </blockquote><br>  Keterbacaan adalah kunci untuk memahami apa yang dilakukan suatu program.  Jika Anda tidak dapat memahami kode tersebut, bagaimana cara mempertahankannya?  Jika perangkat lunak tidak dapat didukung, itu akan ditulis ulang;  dan ini mungkin terakhir kali perusahaan Anda menggunakan Go. <br><br>  Jika Anda menulis program untuk diri sendiri, lakukan apa yang sesuai untuk Anda.  Tetapi jika ini adalah bagian dari proyek bersama atau program akan digunakan cukup lama untuk mengubah persyaratan, fungsi atau lingkungan di mana ia bekerja, maka tujuan Anda adalah membuat program tersebut dapat dipertahankan. <br><br>  Langkah pertama untuk menulis perangkat lunak yang didukung adalah memastikan kodenya jelas. <br><br><a name="1_3"></a><h2>  1.3.  Produktivitas </h2><br><blockquote>  <i>"Desain adalah seni mengatur kode sehingga berfungsi hari ini, tetapi selalu mendukung perubahan."</i> - Sandy Mets </blockquote><br>  Sebagai prinsip dasar terakhir saya ingin menyebutkan produktivitas pengembang.  Ini adalah topik besar, tetapi turun ke rasio: berapa banyak waktu yang Anda habiskan untuk pekerjaan yang bermanfaat, dan berapa banyak - menunggu respons dari alat atau pengembaraan tanpa harapan dalam basis kode yang tidak dapat dipahami.  Para programmer harus merasa bahwa mereka dapat menangani banyak pekerjaan. <br><br>  Ini adalah lelucon bahwa bahasa Go dikembangkan saat program C ++ sedang dikompilasi.  Kompilasi cepat adalah fitur utama Go dan faktor kunci dalam menarik pengembang baru.  Meskipun kompiler sedang diperbaiki, secara umum, kompilasi menit dalam bahasa lain membutuhkan waktu beberapa detik untuk Go.  Jadi pengembang Go merasa sama produktifnya dengan programmer dalam bahasa dinamis, tetapi tanpa masalah dengan keandalan bahasa tersebut. <br><br>  Jika kita berbicara secara mendasar tentang produktivitas pengembang, maka programmer Go memahami bahwa membaca kode pada dasarnya lebih penting daripada menulisnya.  Dalam logika ini, Go bahkan melangkah lebih jauh dengan menggunakan alat untuk memformat semua kode dalam gaya tertentu.  Ini menghilangkan sedikit kesulitan dalam mempelajari dialek spesifik dari proyek tertentu dan membantu mengidentifikasi kesalahan karena mereka hanya <i>terlihat</i> salah dibandingkan dengan kode biasa. <br><br>  Pemrogram Go tidak menghabiskan berhari-hari men-debug kesalahan kompilasi aneh, skrip build kompleks, atau menyebarkan kode dalam lingkungan produksi.  Dan yang paling penting, mereka tidak membuang waktu untuk mencoba memahami apa yang ditulis oleh seorang kolega. <br><br>  Ketika pengembang Go berbicara tentang <i>skalabilitas</i> , artinya produktivitas. <br><br><a name="2"></a><h1>  2. Pengidentifikasi </h1><br>  Topik pertama yang akan kita bahas - <i>pengidentifikasi</i> , adalah sinonim untuk <i>nama</i> : nama variabel, fungsi, metode, jenis, paket, dan sebagainya. <br><br><blockquote>  <i>"Nama Buruk Adalah Gejala Desain Buruk"</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dave Cheney</a> </blockquote><br>  Dengan sintaks yang terbatas pada Go, nama-nama objek memiliki dampak besar pada keterbacaan program.  Keterbacaan adalah faktor kunci dalam kode yang baik, jadi memilih nama yang baik sangat penting. <br><br><a name="2_1"></a><h2>  2.1.  Nama pengidentifikasi berdasarkan kejelasan daripada singkatnya </h2><br><blockquote>  <i>“Penting bahwa kodenya jelas.</i>  <i>Apa yang dapat Anda lakukan dalam satu baris, Anda harus lakukan dalam tiga. ”</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ukia Smith</a> </blockquote><br>  Go tidak dioptimalkan untuk rumit satu-liner atau jumlah minimum garis dalam suatu program.  Kami tidak mengoptimalkan ukuran kode sumber pada disk, atau waktu yang diperlukan untuk mengetik program di editor. <br><br><blockquote>  <i>“Nama yang bagus seperti lelucon yang bagus.</i>  <i>Jika Anda perlu menjelaskannya, maka itu tidak lagi lucu. "</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dave Cheney</a> </blockquote><br>  Kunci untuk kejelasan maksimum adalah nama yang kami pilih untuk mengidentifikasi program.  Kualitas apa yang melekat pada nama baik? <br><br><ul><li>  <b>Nama yang baik ringkas</b> .  Itu tidak harus menjadi yang terpendek, tetapi tidak mengandung kelebihan.  Ini memiliki rasio sinyal terhadap noise yang tinggi. </li><li>  <b>Nama yang baik adalah deskriptif</b> .  Ini menggambarkan penggunaan variabel atau konstan, <i>bukan</i> isinya.  Nama yang bagus menjelaskan hasil fungsi atau perilaku metode, <i>bukan</i> implementasi.  Tujuan paket, <i>bukan</i> isinya.  Semakin akurat nama tersebut menggambarkan hal yang mengidentifikasi, semakin baik. </li><li>  <b>Nama yang baik bisa ditebak</b> .  Dengan satu nama, Anda harus memahami bagaimana objek akan digunakan.  Nama-nama harus deskriptif, tetapi juga penting untuk mengikuti tradisi.  Itulah yang dimaksud programmer Go ketika mereka mengatakan <i>"idiomatik</i> . <i>"</i> </li></ul><br>  Mari kita bahas secara lebih rinci masing-masing properti ini. <br><br><a name="2_2"></a><h2>  2.2.  Panjang ID </h2><br>  Terkadang gaya Go dikritik karena nama variabel pendek.  Seperti yang dikatakan Rob Pike, "Go programmer menginginkan pengidentifikasi dengan panjang yang <i>benar</i> ." <br><br>  Andrew Gerrand menawarkan pengidentifikasi yang lebih lama untuk menunjukkan pentingnya. <br><br><blockquote>  <i>"Semakin besar jarak antara pernyataan nama dan penggunaan suatu objek, semakin lama namanya"</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Andrew Gerrand</a> </blockquote><br>  Dengan demikian, beberapa rekomendasi dapat dibuat: <br><br><ul><li>  Nama variabel pendek baik jika jarak antara deklarasi dan penggunaan <i>terakhir</i> kecil. <br></li><li>  Nama variabel panjang harus membenarkan diri mereka sendiri;  semakin lama mereka, semakin penting mereka seharusnya.  Judul verbose mengandung sedikit sinyal sehubungan dengan bobotnya pada halaman. <br></li><li>  Jangan sertakan nama tipe dalam nama variabel. <br></li><li>  Nama konstan harus menggambarkan nilai internal, bukan bagaimana nilai tersebut digunakan. <br></li><li>  Lebih suka variabel huruf tunggal untuk loop dan cabang, kata-kata terpisah untuk parameter dan nilai kembali, beberapa kata untuk fungsi dan deklarasi pada tingkat paket. <br></li><li>  Lebih suka kata-kata tunggal untuk metode, antarmuka, dan paket. <br></li><li>  Ingat bahwa nama paket adalah bagian dari nama yang digunakan pemanggil untuk referensi. </li></ul><br>  Pertimbangkan sebuah contoh. <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Person <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Age <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> } <span class="hljs-comment"><span class="hljs-comment">// AverageAge returns the average age of people. func AverageAge(people []Person) int { if len(people) == 0 { return 0 } var count, sum int for _, p := range people { sum += p.Age count += 1 } return sum / count }</span></span></code> </pre> <br>  Di baris kesepuluh, variabel rentang <code>p</code> dideklarasikan, dan dipanggil hanya sekali dari baris berikutnya.  Artinya, variabel tinggal di halaman untuk waktu yang sangat singkat.  Jika pembaca tertarik pada peran <code>p</code> dalam program ini, ia hanya perlu membaca dua baris. <br><br>  Sebagai perbandingan, <code>people</code> dinyatakan dalam parameter fungsi dan tujuh baris langsung.  Hal yang sama berlaku untuk <code>sum</code> dan <code>count</code> , sehingga mereka membenarkan nama panjang mereka.  Pembaca perlu memindai lebih banyak kode untuk menemukannya: ini membenarkan nama-nama yang lebih terhormat. <br><br>  Anda dapat memilih <code>s</code> untuk <code>sum</code> dan <code>c</code> (atau <code>n</code> ) untuk <code>count</code> , tetapi ini mengurangi pentingnya semua variabel dalam program ke tingkat yang sama.  Anda dapat mengganti <code>people</code> dengan <code>p</code> , tetapi akan ada masalah, apa yang harus dipanggil variabel iterasi <code>for ... range</code> .  Satu <code>person</code> akan terlihat aneh, karena variabel iterasi berumur pendek mendapatkan nama yang lebih panjang daripada beberapa nilai dari mana ia berasal. <br><br><blockquote>  <b>Kiat</b> .  Pisahkan aliran fungsi dengan baris kosong, karena baris kosong di antara paragraf memecah aliran teks.  Di <code>AverageAge</code> , kami memiliki tiga operasi berturut-turut.  Pertama, memeriksa pembagian dengan nol, kemudian kesimpulan dari total usia dan jumlah orang, dan yang terakhir - perhitungan usia rata-rata. </blockquote><br><h3>  2.2.1.  Yang utama adalah konteks </h3><br>  Penting untuk dipahami bahwa sebagian besar kiat penamaan bersifat spesifik konteks.  Saya suka mengatakan bahwa ini adalah prinsip, bukan aturan. <br><br>  Apa perbedaan antara <code>i</code> dan <code>index</code> ?  Misalnya, Anda tidak dapat mengatakan dengan tegas bahwa kode tersebut <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index := <span class="hljs-number"><span class="hljs-number">0</span></span>; index &lt; <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(s); index++ { <span class="hljs-comment"><span class="hljs-comment">// }</span></span></code> </pre> <br>  secara fundamental lebih mudah dibaca daripada <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i := <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-built_in"><span class="hljs-built_in">len</span></span>(s); i++ { <span class="hljs-comment"><span class="hljs-comment">// }</span></span></code> </pre> <br>  Saya percaya bahwa pilihan kedua tidak lebih buruk, karena dalam hal ini wilayah <code>i</code> atau <code>index</code> dibatasi oleh badan <code>for</code> , dan verbositas tambahan hanya menambah sedikit pemahaman program. <br><br>  Tapi yang mana dari fungsi-fungsi ini yang lebih mudah dibaca? <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *SNMP)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(oid []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, index </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span></code> </pre> <br>  atau <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s *SNMP)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(o []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, i </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span></code> </pre> <br>  Dalam contoh ini, <code>oid</code> adalah singkatan dari SNMP Object ID, dan singkatan tambahan untuk <code>o</code> forces ketika membaca kode untuk beralih dari notasi yang terdokumentasi ke notasi yang lebih pendek dalam kode.  Demikian pula, menyusut <code>index</code> ke <code>i</code> membuatnya lebih sulit untuk dipahami, karena dalam pesan SNMP, sub nilai setiap OID disebut indeks. <br><br><blockquote>  <b>Kiat</b> .  Jangan gabungkan parameter formal panjang dan pendek dalam satu iklan. </blockquote><br><a name="2_3"></a><h2>  2.3.  Jangan beri nama variabel berdasarkan tipe </h2><br>  Anda tidak memanggil hewan peliharaan Anda "anjing" dan "kucing", kan?  Untuk alasan yang sama, Anda tidak harus memasukkan nama tipe dalam nama variabel.  Itu harus menggambarkan konten, bukan tipenya.  Pertimbangkan sebuah contoh: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> usersMap <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]*User</code> </pre> <br>  Apa gunanya pengumuman ini?  Kami melihat bahwa ini adalah peta, dan ini ada hubungannya dengan <code>*User</code> Jenis <code>*User</code> : ini mungkin bagus.  Tetapi <code>usersMap</code> <i>benar-benar sebuah</i> peta, dan Go sebagai bahasa yang diketik secara statis tidak akan memungkinkan secara tidak sengaja menggunakan nama seperti itu di mana variabel skalar diperlukan, sehingga akhiran <code>Map</code> banyak. <br><br>  Pertimbangkan situasi di mana variabel lain ditambahkan: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ( companiesMap <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]*Company productsMap <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]*Products )</code> </pre> <br>  Sekarang kita memiliki tiga variabel tipe peta: <code>usersMap</code> , <code>usersMap</code> dan <code>productsMap</code> , dan semua garis dipetakan ke tipe yang berbeda.  Kami tahu ini adalah peta, dan kami juga tahu bahwa kompiler akan membuat kesalahan jika kami mencoba menggunakan <code>companiesMap</code> mana kode mengharapkan <code>map[string]*User</code> .  Dalam situasi ini, jelas bahwa akhiran <code>Map</code> tidak meningkatkan kejelasan kode, ini hanya karakter tambahan. <br><br>  Saya sarankan menghindari sufiks yang menyerupai jenis variabel. <br><br><blockquote>  <b>Kiat</b> .  Jika nama <code>users</code> tidak menggambarkan esensi dengan cukup jelas, maka <code>usersMap</code> juga. </blockquote><br>  Tip ini juga berlaku untuk parameter fungsi.  Sebagai contoh: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { <span class="hljs-comment"><span class="hljs-comment">// } func WriteConfig(w io.Writer, config *Config)</span></span></code> </pre> <br>  Nama <code>config</code> untuk parameter <code>*Config</code> berlebihan.  Kita sudah tahu bahwa ini <code>*Config</code> , segera ditulis di sebelahnya. <br><br>  Dalam hal ini, pertimbangkan <code>conf</code> atau <code>c</code> jika umur variabel cukup pendek. <br><br>  Jika pada suatu titik di daerah kami ada lebih dari satu <code>*Config</code> , maka nama <code>conf1</code> dan <code>conf2</code> kurang bermakna daripada yang <code>original</code> dan <code>updated</code> , karena yang terakhir lebih sulit untuk digabungkan. <br><br><blockquote>  <b>Catatan</b>  Jangan biarkan nama paket mencuri nama variabel yang bagus. <br><br>  Nama pengenal yang diimpor berisi nama paket.  Misalnya, tipe <code>context</code> paket <code>context</code> akan disebut <code>context.Context</code> .  Ini membuat tidak mungkin untuk menggunakan variabel atau jenis <code>context</code> dalam paket Anda. <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context context.Context, message </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br>  Ini tidak akan dikompilasi.  Itu sebabnya ketika mendeklarasikan <code>context.Context</code> Jenis <code>context.Context</code> secara lokal, misalnya, nama seperti <code>ctx</code> secara tradisional digunakan. <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx context.Context, message </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> </blockquote><br><a name="2_4"></a><h2>  2.4.  Gunakan gaya penamaan tunggal </h2><br>  Properti lain dari nama baik adalah bahwa itu harus dapat diprediksi.  Pembaca harus segera memahaminya.  Jika ini adalah nama yang <i>umum</i> , maka pembaca memiliki hak untuk berasumsi bahwa itu tidak mengubah artinya dari waktu sebelumnya. <br><br>  Misalnya, jika kode berjalan di sekitar deskriptor database, setiap kali parameter ditampilkan, itu harus memiliki nama yang sama.  Daripada semua jenis kombinasi seperti <code>d *sql.DB</code> , <code>dbase *sql.DB</code> , <code>DB *sql.DB</code> dan <code>database *sql.DB</code> lebih baik menggunakan satu hal: <br><br><pre> <code class="go hljs">db *sql.DB</code> </pre> <br>  Lebih mudah untuk memahami kodenya.  Jika Anda melihat <code>db</code> , maka Anda tahu bahwa itu <code>*sql.DB</code> dan dideklarasikan secara lokal atau disediakan oleh pemanggil. <br><br>  Saran serupa mengenai penerima suatu metode;  gunakan nama penerima yang sama untuk setiap metode jenis ini.  Ini akan memudahkan pembaca untuk memahami penggunaan penerima di antara berbagai metode jenis ini. <br><br><blockquote>  <b>Catatan</b>  Go Recipient Short Name Agreement bertentangan dengan rekomendasi yang disuarakan sebelumnya.  Ini adalah salah satu kasus di mana pilihan yang dibuat pada tahap awal menjadi gaya standar, seperti menggunakan <code>CamelCase</code> alih-alih <code>snake_case</code> . </blockquote><br><blockquote>  <b>Kiat</b> .  Gaya Go menunjuk ke nama huruf tunggal atau singkatan untuk penerima yang berasal dari tipenya.  Mungkin ternyata nama penerima terkadang bertentangan dengan nama parameter dalam metode.  Dalam hal ini, disarankan untuk membuat nama parameter sedikit lebih lama dan jangan lupa untuk menggunakannya secara berurutan. </blockquote><br>  Akhirnya, beberapa variabel satu huruf secara tradisional dikaitkan dengan loop dan penghitungan.  Sebagai contoh, <code>i</code> , <code>j</code> dan <code>k</code> biasanya variabel induktif dalam <code>for</code> loop, <code>n</code> biasanya dikaitkan dengan penghitung kontra atau akumulatif, <code>v</code> adalah singkatan khas untuk nilai dalam fungsi penyandian, <code>k</code> biasanya digunakan untuk kunci peta, dan <code>s</code> sering digunakan sebagai singkatan untuk parameter <code>string</code> tipe . <br><br>  Seperti contoh <code>db</code> atas, programmer <i>berharap</i> <code>i</code> menjadi variabel induktif.  Jika mereka melihatnya dalam kode, mereka berharap akan melihat loop segera. <br><br><blockquote>  <b>Kiat</b> .  Jika Anda memiliki begitu banyak loop bersarang sehingga Anda telah kehabisan variabel <code>i</code> , <code>j</code> dan <code>k</code> , maka Anda mungkin ingin memecah fungsi menjadi unit yang lebih kecil. </blockquote><br><a name="2_5"></a><h2>  2.5.  Gunakan gaya deklarasi tunggal </h2><br>  Go memiliki setidaknya enam cara berbeda untuk mendeklarasikan variabel. <br><br><ul><li><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </li><li><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </li><li><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>; x = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </li><li><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> </li><li><pre> <code class="go hljs">x := <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </li></ul><br>  Saya yakin saya belum mengingat semuanya.  Pengembang Go mungkin menganggap ini kesalahan, tetapi sudah terlambat untuk mengubah apa pun.  Dengan pilihan ini, bagaimana memastikan gaya yang seragam? <br><br>  Saya ingin mengusulkan gaya mendeklarasikan variabel yang saya sendiri coba gunakan sedapat mungkin. <br><br><ul><li>  <b>Saat mendeklarasikan variabel tanpa inisialisasi, gunakan <code>var</code></b> . <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> players <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-comment"><span class="hljs-comment">// 0 var things []Thing // an empty slice of Things var thing Thing // empty Thing struct json.Unmarshall(reader, &amp;thing)</span></span></code> </pre> <br>  <code>var</code> bertindak sebagai petunjuk bahwa variabel ini <i>sengaja</i> dinyatakan sebagai nilai nol dari tipe yang ditentukan.  Ini konsisten dengan persyaratan untuk mendeklarasikan variabel pada tingkat paket dengan <code>var</code> bertentangan dengan sintaks deklarasi pendek, meskipun saya akan berpendapat kemudian bahwa variabel tingkat paket tidak boleh digunakan sama sekali. </li><li>  <b>Ketika mendeklarasikan dengan inisialisasi, gunakan <code>:=</code></b> .  Ini menjelaskan kepada pembaca bahwa variabel di sebelah kiri <code>:=</code> sengaja diinisialisasi. <br><br>  Untuk menjelaskan alasannya, mari kita lihat contoh sebelumnya, tetapi kali ini kami khusus menginisialisasi setiap variabel: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> players <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> things []Thing = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thing *Thing = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(Thing) json.Unmarshall(reader, thing)</code> </pre> </li></ul><br>  Karena Go tidak memiliki konversi otomatis dari satu jenis ke yang lain, dalam contoh pertama dan ketiga jenis di sisi kiri operator penugasan harus identik dengan jenis di sisi kanan.  Compiler dapat menyimpulkan jenis variabel yang dideklarasikan dari jenis di sebelah kanan, jadi contohnya dapat ditulis lebih ringkas: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> players = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> things []Thing = <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thing = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(Thing) json.Unmarshall(reader, thing)</code> </pre> <br>  Di sini, <code>players</code> eksplisit diinisialisasi ke <code>0</code> , yang berlebihan, karena nilai awal <code>players</code> adalah nol dalam hal apa pun.  Oleh karena itu, lebih baik untuk menjelaskan bahwa kami ingin menggunakan nilai nol: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> players <span class="hljs-keyword"><span class="hljs-keyword">int</span></span></code> </pre> <br>  Bagaimana dengan operator kedua?  Kami tidak dapat menentukan jenis dan menulis <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> things = <span class="hljs-literal"><span class="hljs-literal">nil</span></span></code> </pre> <br>  Karena <code>nil</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tidak</a> <code>nil</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tipe</a> .  Sebaliknya, kami punya pilihan: atau kami menggunakan nilai nol untuk mengiris ... <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> things []Thing</code> </pre> <br>  ... atau membuat irisan dengan nol elemen? <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> things = <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>([]Thing, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Dalam kasus kedua, nilai untuk slice <i>tidak</i> nol, dan kami menjelaskan kepada pembaca menggunakan bentuk pendek pernyataan: <br><br><pre> <code class="go hljs">things := <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>([]Thing, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Ini memberi tahu pembaca bahwa kami memutuskan untuk menginisialisasi <code>things</code> secara eksplisit. <br><br>  Jadi kita sampai pada deklarasi ketiga: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thing = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(Thing)</code> </pre> <br>  Di sini, baik inisialisasi eksplisit dari variabel dan pengenalan kata kunci "unik" <code>new</code> , yang tidak disukai sebagian programmer.  Menggunakan sintaks pendek yang disarankan <br><br><pre> <code class="go hljs">thing := <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(Thing)</code> </pre> <br>  Ini memperjelas <code>thing</code> secara eksplisit diinisialisasi ke hasil <code>new(Thing)</code> , tetapi masih menyisakan yang <code>new</code> atipikal.  Masalahnya bisa diselesaikan dengan menggunakan literal: <br><br><pre> <code class="go hljs">thing := &amp;Thing{}</code> </pre> <br>  Yang mirip dengan yang <code>new(Thing)</code> , dan duplikasi semacam itu mengecewakan beberapa programmer Go.  Namun, ini berarti bahwa kita secara eksplisit menginisialisasi <code>thing</code> dengan pointer ke <code>Thing{}</code> dan nilai <code>Thing</code> nol. <br><br>  Tetapi lebih baik memperhitungkan fakta bahwa <code>thing</code> dinyatakan dengan nilai nol, dan gunakan alamat operator untuk meneruskan alamat <code>thing</code> di <code>json.Unmarshall</code> : <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thing Thing json.Unmarshall(reader, &amp;thing)</code> </pre> <br><blockquote>  <b>Catatan</b>  Tentu saja, ada pengecualian untuk aturan apa pun.  Misalnya, kadang-kadang dua variabel terkait erat, sehingga akan aneh untuk menulis <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> min <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> max := <span class="hljs-number"><span class="hljs-number">1000</span></span></code> </pre> <br>  Deklarasi yang lebih mudah dibaca: <br><br><pre> <code class="go hljs">min, max := <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span></code> </pre> </blockquote><br>  Untuk meringkas: <br><br><ul><li>  Saat mendeklarasikan variabel tanpa inisialisasi, gunakan sintaks <code>var</code> . <br></li><li>  Ketika mendeklarasikan dan secara eksplisit menginisialisasi variabel, gunakan <code>:=</code> . </li></ul><br><blockquote>  <b>Kiat</b> .  Secara eksplisit tunjukkan hal-hal kompleks. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span> = <span class="hljs-number"><span class="hljs-number">0x80</span></span></code> </pre> <br>  Di sini <code>length</code> dapat digunakan dengan pustaka, yang memerlukan jenis numerik tertentu, dan opsi ini lebih jelas menunjukkan bahwa panjang jenis secara khusus dipilih sebagai uint32 daripada dalam deklarasi pendek: <br><br><pre> <code class="go hljs">length := <span class="hljs-keyword"><span class="hljs-keyword">uint32</span></span>(<span class="hljs-number"><span class="hljs-number">0x80</span></span>)</code> </pre> <br>  Dalam contoh pertama, saya sengaja melanggar aturan saya dengan menggunakan deklarasi var dengan inisialisasi eksplisit.  Penyimpangan dari standar membuat pembaca mengerti bahwa sesuatu yang tidak biasa sedang terjadi. </blockquote><br><a name="2_6"></a><h2>  2.6.  Bekerja untuk tim </h2><br>  Saya telah mengatakan bahwa esensi pengembangan perangkat lunak adalah penciptaan kode yang dapat dibaca dan didukung.  Sebagian besar karir Anda mungkin akan bekerja pada proyek bersama.  Saran saya dalam situasi ini: ikuti gaya yang diadopsi dalam tim. <br><br>  Mengubah gaya di tengah file itu menjengkelkan.  Konsistensi adalah penting, meskipun merugikan preferensi pribadi.  Aturan praktis saya adalah: jika kode tersebut cocok dengan <code>gofmt</code> , maka masalahnya biasanya tidak layak untuk dibahas. <br><br><blockquote>  <b>Kiat</b> .  Jika Anda ingin mengganti nama di seluruh basis kode, jangan campur ini dengan perubahan lain.  Jika seseorang menggunakan git bisect, ia tidak akan suka mengarungi ribuan nama untuk menemukan kode lain yang dimodifikasi. </blockquote><br><h1>  3. Komentar </h1><br>  Sebelum kita beralih ke poin yang lebih penting, saya ingin mengambil beberapa menit untuk berkomentar. <br><br><blockquote>  <i>“Kode yang baik memiliki banyak komentar, dan kode yang buruk membutuhkan banyak komentar.”</i> - Dave Thomas dan Andrew Hunt, Pragmatic Programmer </blockquote><br>  Komentar sangat penting untuk keterbacaan program.  Setiap komentar harus melakukan satu - dan hanya satu - dari tiga hal: <br><br><ol><li>  Jelaskan <i>apa yang dilakukan</i> kode. </li><li>  Jelaskan <i>bagaimana</i> dia melakukannya. </li><li>  Jelaskan <i>mengapa</i> . </li></ol><br>  Bentuk pertama sangat ideal untuk mengomentari karakter publik: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Open     . //           .</span></span></code> </pre> <br>  Yang kedua sangat ideal untuk komentar di dalam suatu metode: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//     var results []chan error for _, dep := range a.Deps { results = append(results, execute(seen, dep)) }</span></span></code> </pre> <br>  Bentuk ketiga ("mengapa") unik karena tidak menggantikan atau mengganti dua yang pertama.  Komentar semacam itu menjelaskan faktor-faktor eksternal yang menyebabkan penulisan kode dalam bentuk saat ini.  Seringkali tanpa konteks ini, sulit untuk memahami mengapa kode ditulis dengan cara ini. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;v2.Cluster_CommonLbConfig{ <span class="hljs-comment"><span class="hljs-comment">//  HealthyPanicThreshold HealthyPanicThreshold: &amp;envoy_type.Percent{ Value: 0, }, }</span></span></code> </pre> <br>  Dalam contoh ini, mungkin tidak segera jelas apa yang terjadi ketika HealthyPanicThreshold diatur ke nol persen.  Komentar ini dimaksudkan untuk mengklarifikasi bahwa nilai 0 menonaktifkan ambang panik. <br><br><a name="3_1"></a><h2>  3.1.  Komentar dalam variabel dan konstanta harus menggambarkan isinya, bukan tujuan </h2><br>  Saya katakan sebelumnya bahwa nama variabel atau konstanta harus menggambarkan tujuannya.  Tetapi komentar pada variabel atau konstanta harus menggambarkan <i>konten</i> dengan tepat, bukan <i>tujuannya</i> . <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> randomNumber = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-comment"><span class="hljs-comment">//    </span></span></code> </pre> <br>  Dalam contoh ini, komentar menjelaskan <i>mengapa</i> <code>randomNumber</code> ke 6 dan dari mana asalnya.  Komentar tidak menjelaskan di mana <code>randomNumber</code> akan digunakan.  Berikut ini beberapa contoh lainnya: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ( StatusContinue = <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-comment"><span class="hljs-comment">// RFC 7231, 6.2.1 StatusSwitchingProtocols = 101 // RFC 7231, 6.2.2 StatusProcessing = 102 // RFC 2518, 10.1 StatusOK = 200 // RFC 7231, 6.3.1</span></span></code> </pre> <br>  <i>Dalam konteks HTTP,</i> angka <code>100</code> dikenal sebagai <code>StatusContinue</code> , sebagaimana didefinisikan dalam RFC 7231, bagian 6.2.1. <br><br><blockquote>  <b>Kiat</b> .  Untuk variabel tanpa nilai awal, komentar harus menjelaskan siapa yang bertanggung jawab untuk menginisialisasi variabel ini. <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// sizeCalculationDisabled ,   //     . . dowidth. var sizeCalculationDisabled bool</span></span></code> </pre> <br>  Di sini komentar memberi tahu pembaca bahwa fungsi <code>dowidth</code> bertanggung jawab untuk mempertahankan status <code>sizeCalculationDisabled</code> . </blockquote><br><blockquote>  <b>Kiat</b> .  Sembunyikan di depan mata.  Ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saran dari Kate Gregory</a> .  Terkadang nama terbaik untuk variabel disembunyikan di komentar. <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//   SQL var registry = make(map[string]*sql.Driver)</span></span></code> </pre> <br>  Sebuah komentar ditambahkan oleh penulis karena nama <code>registry</code> tidak cukup menjelaskan tujuannya - ini adalah registri, tetapi apa itu registri? <br><br>  Jika Anda mengganti nama variabel menjadi sqlDrivers, menjadi jelas bahwa itu berisi driver SQL. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sqlDrivers = <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]*sql.Driver)</code> </pre> <br>  Sekarang komentar telah menjadi berlebihan dan dapat dihapus. </blockquote><br><a name="3_2"></a><h2>  3.2.  Selalu mendokumentasikan karakter yang tersedia untuk umum </h2><br>  Dokumentasi untuk paket Anda dibuat oleh godoc, jadi Anda harus menambahkan komentar untuk setiap karakter publik yang dinyatakan dalam paket: variabel, konstanta, fungsi, dan metode. <br><br>  Berikut adalah dua panduan dari Panduan Gaya Google: <br><br><ul><li>  Setiap fungsi publik yang tidak jelas dan ringkas harus dikomentari. <br></li><li>  Setiap fungsi di perpustakaan harus dikomentari, terlepas dari panjang atau kompleksitasnya. </li></ul><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ioutil <span class="hljs-comment"><span class="hljs-comment">// ReadAll   r      (EOF)   // ..    err == nil, not err == EOF. //  ReadAll     ,     //  . func ReadAll(r io.Reader) ([]byte, error)</span></span></code> </pre> <br>  Ada satu pengecualian untuk aturan ini: Anda tidak perlu mendokumentasikan metode yang mengimplementasikan antarmuka.  Secara khusus, jangan lakukan ini: <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Read   io.Reader func (r *FileReader) Read(buf []byte) (int, error)</span></span></code> </pre> <br>  Komentar ini tidak berarti apa-apa.  Dia tidak mengatakan apa yang dilakukan metodenya: lebih buruk, dia mengirim suatu tempat untuk mencari dokumentasi.  Dalam situasi ini, saya mengusulkan untuk sepenuhnya menghapus komentar. <br><br>  Ini adalah contoh dari paket <code>io</code> . <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// LimitReader  Reader,    r, //    EOF  n . //   *LimitedReader. func LimitReader(r Reader, n int64) Reader { return &amp;LimitedReader{r, n} } // LimitedReader   R,     //   N .   Read  N  //    . // Read  EOF,  N &lt;= 0    R  EOF. type LimitedReader struct { R Reader // underlying reader N int64 // max bytes remaining } func (l *LimitedReader) Read(p []byte) (n int, err error) { if lN &lt;= 0 { return 0, EOF } if int64(len(p)) &gt; lN { p = p[0:lN] } n, err = lRRead(p) lN -= int64(n) return }</span></span></code> </pre> <br>  Perhatikan bahwa deklarasi <code>LimitedReader</code> segera didahului oleh fungsi yang menggunakannya, dan deklarasi <code>LimitedReader.Read</code> mengikuti deklarasi <code>LimitedReader</code> itu sendiri.  Meskipun <code>LimitedReader.Read</code> sendiri tidak didokumentasikan, dapat dipahami bahwa ini adalah implementasi dari <code>io.Reader</code> . <br><br><blockquote>  <b>Kiat</b> .  Sebelum menulis fungsi, tulis komentar yang menjelaskannya.  Jika Anda merasa sulit untuk menulis komentar, maka ini pertanda bahwa kode yang akan Anda tulis akan sulit dimengerti. </blockquote><br><h3>  3.2.1.  Jangan mengomentari kode yang buruk, tulis ulang </h3><br><blockquote>  <i>“Jangan Mengomentari Kode Buruk - Tulis Ulang Itu”</i> - Brian Kernighan </blockquote><br>  Tidak cukup untuk mengindikasikan kesulitan dalam fragmen kode di komentar.  Jika Anda menemukan salah satu komentar ini, Anda harus memulai tiket dengan pengingat refactoring.  Anda dapat hidup dengan hutang teknis selama jumlahnya diketahui. <br><br>  Di perpustakaan standar, biasanya meninggalkan komentar dalam gaya TODO dengan nama pengguna yang memperhatikan masalah tersebut. <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// TODO(dfc)  O(N^2),     .</span></span></code> </pre> <br>  Ini bukan kewajiban untuk memperbaiki masalah, tetapi pengguna yang ditunjukkan mungkin orang terbaik untuk mengajukan pertanyaan.  Proyek lain menemani TODO dengan tanggal atau nomor tiket. <br><br><h3>  3.2.2.  Alih-alih berkomentar kode, refactor saja </h3><br><blockquote>  <i>“Kode yang baik adalah dokumentasi terbaik.</i>  <i>Ketika Anda akan menambahkan komentar, tanyakan pada diri sendiri pertanyaan: "Bagaimana cara meningkatkan kode sehingga komentar ini tidak diperlukan?"</i>  <i>Refactor dan tinggalkan komentar untuk membuatnya lebih jelas. "</i> - Steve McConnell </blockquote><br>  Fungsi seharusnya hanya melakukan satu tugas.  Jika Anda ingin menulis komentar karena beberapa fragmen tidak terkait dengan sisa fungsi, maka pertimbangkan untuk mengekstraksinya menjadi fungsi yang terpisah. <br><br>  Fitur yang lebih kecil tidak hanya lebih jelas, tetapi lebih mudah untuk diuji secara terpisah dari satu sama lain.  Ketika Anda mengisolasi kode menjadi fungsi yang terpisah, namanya dapat menggantikan komentar. <br><br><a name="4"></a><h1>  4. Struktur paket </h1><br><blockquote>  <i>“Tulis kode sederhana: modul yang tidak menunjukkan apa-apa berlebihan ke modul lain dan yang tidak bergantung pada implementasi modul lain”</i> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dave Thomas</a> </blockquote><br>  Setiap paket pada dasarnya adalah program Go kecil yang terpisah.  Sama seperti implementasi fungsi atau metode tidak masalah bagi pemanggil, implementasi fungsi, metode dan tipe yang membentuk API publik dari paket Anda tidak masalah. <br><br>  Paket Go yang baik berusaha untuk konektivitas minimal dengan paket lain di tingkat kode sumber sehingga seiring pertumbuhan proyek, perubahan dalam satu paket tidak mengalir di seluruh basis kode.  Situasi seperti ini sangat menghambat programmer yang bekerja pada basis kode ini. <br><br>  Di bagian ini, kita akan berbicara tentang desain paket, termasuk nama dan tip untuk metode dan fungsi penulisan. <br><br><a name="4_1"></a><h2>  4.1.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Paket yang baik dimulai dengan nama yang bagus </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket Go yang baik dimulai dengan nama yang berkualitas. </font><font style="vertical-align: inherit;">Anggap saja sebagai presentasi singkat yang hanya terbatas pada satu kata. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti nama variabel di bagian sebelumnya, nama paket sangat penting. </font><font style="vertical-align: inherit;">Tidak perlu memikirkan tipe data dalam paket ini, lebih baik bertanya: "Layanan apa yang disediakan paket ini?" </font><font style="vertical-align: inherit;">Biasanya jawabannya bukan "Paket ini menyediakan tipe X", tetapi "Paket ini memungkinkan Anda untuk terhubung melalui HTTP."</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pilih nama paket berdasarkan fungsinya, bukan isinya.</font></font></blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1.1. </font><font style="vertical-align: inherit;">Nama paket yang bagus harus unik</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap paket memiliki nama unik dalam proyek tersebut. </font><font style="vertical-align: inherit;">Tidak ada kesulitan jika Anda mengikuti saran memberi nama untuk tujuan paket. </font><font style="vertical-align: inherit;">Jika ternyata kedua paket memiliki nama yang sama, kemungkinan besar:</font></font><br><br><ol><li>     . </li><li>       .       ,     . </li></ol><br><a name="4_2"></a><h2>  4.2.    <code>base</code> , <code>common</code>  <code>util</code> </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alasan umum untuk nama buruk adalah </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket layanan yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disebut </font><font style="vertical-align: inherit;">, di mana seiring waktu berbagai penolong dan kode layanan menumpuk. Karena sulit untuk menemukan nama yang unik di sana. Hal ini sering mengarah pada fakta bahwa nama paket menjadi atau diperoleh dari fakta bahwa itu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">termasuk</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : utilitas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nama-nama suka </font></font><code>utils</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>helpers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biasanya ditemukan di proyek-proyek besar, di mana hierarki paket yang dalam di-root, dan fungsi-fungsi tambahan dibagikan. Jika Anda mengekstrak beberapa fungsi ke dalam paket baru, impor akan rusak. Dalam hal ini, nama paket tidak mencerminkan tujuan paket, tetapi hanya fakta bahwa fungsi impor gagal karena organisasi proyek yang tidak tepat. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam situasi seperti itu, saya merekomendasikan untuk menganalisis dari mana paket-paket itu berasal.</font></font><code>utils</code> <code>helpers</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan, jika mungkin, pindahkan fungsi yang sesuai ke paket panggilan. </font><font style="vertical-align: inherit;">Bahkan jika ini menyiratkan duplikasi beberapa kode tambahan, itu lebih baik daripada memperkenalkan ketergantungan impor antara dua paket.</font></font><br><br><blockquote> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“Duplikasi [sedikit] jauh lebih murah daripada abstraksi yang salah”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Sandy Mets</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jika fungsi utilitas digunakan di banyak tempat, alih-alih satu paket monolitik dengan fungsi utilitas, lebih baik untuk membuat beberapa paket, yang masing-masing berfokus pada satu aspek. </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gunakan jamak untuk paket layanan. </font><font style="vertical-align: inherit;">Misalnya, </font></font><code>strings</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk utilitas pemrosesan string.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket dengan nama-nama seperti </font></font><code>base</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>common</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sering dijumpai ketika fungsionalitas umum tertentu dari dua atau lebih implementasi atau tipe umum untuk klien dan server digabungkan ke dalam paket terpisah. </font><font style="vertical-align: inherit;">Saya percaya bahwa dalam kasus seperti itu perlu untuk mengurangi jumlah paket dengan menggabungkan klien, server dan kode umum dalam satu paket dengan nama yang sesuai dengan fungsinya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalnya, untuk </font></font><code>net/http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak melakukan paket-paket individual </font></font><code>client</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sebaliknya, ada file </font></font><code>client.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>server.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dengan tipe data yang sesuai, serta </font></font><code>transport.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk total transportasi.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Penting untuk diingat bahwa nama pengenal termasuk nama paket.</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fungsi </font></font><code>Get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari suatu paket </font></font><code>net/http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjadi </font></font><code>http.Get</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tautan dari paket lain.</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suatu jenis </font></font><code>Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari suatu paket </font></font><code>strings</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditransformasikan menjadi ketika diimpor ke dalam paket lain </font></font><code>strings.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antarmuka </font></font><code>Error</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dari paket </font></font><code>net</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jelas terkait dengan kesalahan jaringan.</font></font></li></ul></blockquote><br><a name="4_3"></a><h2>  4.3.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kembalilah dengan cepat tanpa menyelam jauh </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena Go tidak menggunakan pengecualian dalam aliran kontrol, tidak perlu menggali jauh ke dalam kode untuk menyediakan struktur tingkat atas </font></font><code>try</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font><font style="vertical-align: inherit;">blok </font></font><code>catch</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Alih-alih hierarki multi-level, kode Go turun layar saat fungsi berlangsung. </font><font style="vertical-align: inherit;">Teman saya Matt Ryer menyebut latihan ini </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"garis pandang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">" </font></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini dicapai dengan menggunakan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operator batas</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : blok bersyarat dengan prasyarat pada input ke fungsi. </font><font style="vertical-align: inherit;">Ini adalah contoh dari paket </font></font><code>bytes</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b *Buffer)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnreadRune</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b.lastRead &lt;= opInvalid { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> errors.New(<span class="hljs-string"><span class="hljs-string">"bytes.Buffer: UnreadRune: previous operation was not a successful ReadRune"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b.off &gt;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(b.lastRead) { b.off -= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(b.lastRead) } b.lastRead = opInvalid <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat memasuki fungsi </font></font><code>UnreadRune</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, keadaan diperiksa </font></font><code>b.lastRead</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan jika operasi sebelumnya tidak </font></font><code>ReadRune</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka kesalahan segera dikembalikan. Sisa fungsi bekerja berdasarkan apa yang </font></font><code>b.lastRead</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lebih besar dari </font></font><code>opInvalid</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bandingkan dengan fungsi yang sama, tetapi tanpa operator batas:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(b *Buffer)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UnreadRune</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b.lastRead &gt; opInvalid { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> b.off &gt;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(b.lastRead) { b.off -= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(b.lastRead) } b.lastRead = opInvalid <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> errors.New(<span class="hljs-string"><span class="hljs-string">"bytes.Buffer: UnreadRune: previous operation was not a successful ReadRune"</span></span>) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tubuh cabang yang lebih mungkin berhasil tertanam dalam kondisi pertama </font></font><code>if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan kondisi untuk keluar yang sukses </font></font><code>return nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus ditemukan dengan mencocokkan </font><font style="vertical-align: inherit;">tanda kurung </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penutup</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dengan hati-hati </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Baris terakhir dari fungsi sekarang mengembalikan kesalahan, dan Anda perlu melacak pelaksanaan fungsi ke </font><font style="vertical-align: inherit;">braket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pembuka yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sesuai </font><font style="vertical-align: inherit;">untuk mengetahui bagaimana menuju ke titik ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi ini lebih sulit dibaca, yang menurunkan kualitas pemrograman dan dukungan kode, jadi Go lebih suka menggunakan operator batas dan mengembalikan kesalahan pada tahap awal.</font></font><br><br><a name="4_4"></a><h2>  4.4.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jadikan nilai nol bermanfaat </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setiap deklarasi variabel, dengan asumsi tidak adanya penginisialisasi eksplisit, akan secara otomatis diinisialisasi dengan nilai yang sesuai dengan isi memori zeroed, yaitu </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nol</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jenis nilai ditentukan oleh salah satu opsi: untuk tipe numerik - nol, untuk tipe pointer - nihil, sama untuk irisan, peta, dan saluran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemampuan untuk selalu menetapkan nilai default yang diketahui adalah penting untuk keamanan dan kebenaran program Anda dan dapat membuat program Go Anda lebih mudah dan lebih kompak. Inilah yang dipikirkan oleh programmer Go ketika mereka berkata, "Berikan struktur nilai nol yang bermanfaat." </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertimbangkan jenis </font></font><code>sync.Mutex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang berisi dua bidang bilangan bulat yang mewakili keadaan internal mutex. Bidang-bidang ini secara otomatis null dalam deklarasi apa pun.</font></font><code>sync.Mutex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Fakta ini diperhitungkan dalam kode, sehingga jenis ini cocok untuk digunakan tanpa inisialisasi eksplisit.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> MyInt <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { mu sync.Mutex val <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i MyInt <span class="hljs-comment"><span class="hljs-comment">// i.mu is usable without explicit initialisation. i.mu.Lock() i.val++ i.mu.Unlock() }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh lain dari tipe dengan nilai nol yang berguna adalah </font></font><code>bytes.Buffer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Anda dapat mendeklarasikan dan mulai menulis padanya tanpa inisialisasi eksplisit.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b bytes.Buffer b.WriteString(<span class="hljs-string"><span class="hljs-string">"Hello, world!\n"</span></span>) io.Copy(os.Stdout, &amp;b) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nilai nol dari struktur ini berarti </font></font><code>len</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">keduanya </font></font><code>cap</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sama </font></font><code>0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan y </font></font><code>array</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, penunjuk ke memori dengan isi array slice cadangan, nilainya </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini berarti bahwa Anda tidak perlu memotong secara eksplisit, Anda cukup mendeklarasikannya.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// s := make([]string, 0) // s := []string{} var s []string s = append(s, "Hello") s = append(s, "world") fmt.Println(strings.Join(s, " ")) }</span></span></code> </pre> <br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><code>var s []string</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mirip dengan dua baris komentar di atas, tetapi tidak identik dengan mereka. </font><font style="vertical-align: inherit;">Ada perbedaan antara nilai irisan nil dan nilai irisan panjang nol. </font><font style="vertical-align: inherit;">Kode berikut akan mencetak false.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s1 = []<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s2 []<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> fmt.Println(reflect.DeepEqual(s1, s2)) }</code> </pre> </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Properti berguna, meskipun tidak terduga, dari variabel pointer tidak diinisialisasi - pointer nil - adalah kemampuan untuk memanggil metode pada jenis yang nihil. </font><font style="vertical-align: inherit;">Ini dapat digunakan untuk dengan mudah memberikan nilai default.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { path <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c *Config)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Path</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> c == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"/usr/home"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c.path } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c1 *Config <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c2 = &amp;Config{ path: <span class="hljs-string"><span class="hljs-string">"/export"</span></span>, } fmt.Println(c1.Path(), c2.Path()) }</code> </pre> <br><a name="4_5"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.5. </font><font style="vertical-align: inherit;">Hindari status tingkat paket</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kunci untuk menulis program yang mudah didukung yang terhubung dengan lemah adalah bahwa mengubah satu paket harus memiliki probabilitas rendah mempengaruhi paket lain yang tidak secara langsung tergantung pada yang pertama. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada dua cara hebat untuk mencapai konektivitas lemah di Go:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gunakan antarmuka untuk menggambarkan perilaku yang diperlukan oleh fungsi atau metode. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hindari status global. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di Go, kita bisa mendeklarasikan variabel dalam lingkup fungsi atau metode, serta dalam lingkup paket. </font><font style="vertical-align: inherit;">Ketika sebuah variabel tersedia untuk umum, dengan pengenal dengan huruf kapital, maka cakupannya sebenarnya bersifat global untuk seluruh program: setiap paket </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kapan saja</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> melihat jenis dan isi dari variabel ini. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Keadaan global yang dapat berubah memberikan hubungan yang erat antara bagian-bagian independen dari program, karena variabel global menjadi parameter yang tidak terlihat untuk setiap fungsi dalam program! </font><font style="vertical-align: inherit;">Fungsi apa pun yang bergantung pada variabel global dapat dilanggar ketika jenis variabel ini berubah. </font><font style="vertical-align: inherit;">Fungsi apa pun yang bergantung pada keadaan variabel global dapat dilanggar jika bagian lain dari program mengubah variabel ini.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cara mengurangi konektivitas yang diciptakan variabel global: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pindahkan variabel terkait sebagai bidang ke struktur yang membutuhkannya. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gunakan antarmuka untuk mengurangi koneksi antara perilaku dan penerapan perilaku ini. </font></font></li></ol><br><a name="5"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5. Struktur proyek </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita bicara tentang bagaimana paket digabungkan menjadi sebuah proyek. </font><font style="vertical-align: inherit;">Ini biasanya repositori Git tunggal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seperti paket, setiap proyek harus memiliki tujuan yang jelas. </font><font style="vertical-align: inherit;">Jika itu adalah perpustakaan, ia harus melakukan satu hal, misalnya, parsing XML atau penjurnalan. </font><font style="vertical-align: inherit;">Anda seharusnya tidak menggabungkan beberapa tujuan dalam satu proyek, ini akan membantu menghindari perpustakaan yang menakutkan </font></font><code>common</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Dalam pengalaman saya, repositori </font></font><code>common</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada akhirnya terkait erat dengan konsumen terbesar, dan ini membuat sulit untuk melakukan koreksi ke versi sebelumnya (perbaikan port-belakang) tanpa memperbarui kedua </font></font><code>common</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan konsumen pada tahap pemblokiran, yang mengarah ke banyak perubahan yang tidak terkait, ditambah mereka pecah sepanjang jalan API</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda memiliki aplikasi (aplikasi web, pengontrol Kubernetes, dll.), Proyek mungkin memiliki satu atau lebih paket utama. </font><font style="vertical-align: inherit;">Sebagai contoh, di pengontrol Kubernetes saya ada satu paket </font></font><code>cmd/contour</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang berfungsi sebagai server yang digunakan di cluster Kubernetes dan sebagai klien debug.</font></font><br><br><a name="5_1"></a><h2>  5.1.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lebih sedikit paket tetapi lebih besar </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam ulasan kode, saya perhatikan salah satu kesalahan khas programmer yang beralih ke Go dari bahasa lain: mereka cenderung menyalahgunakan paket. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go tidak menyediakan sistem yang rumit dari visibility: bahasa tidak cukup akses pengubah seperti dalam Java ( </font></font><code>public</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>protected</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>private</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan implisit </font></font><code>default</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font><font style="vertical-align: inherit;">Tidak ada analog dari kelas ramah dari C ++. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di Go, kami hanya memiliki dua pengubah akses: ini adalah pengidentifikasi publik dan pribadi, yang ditunjukkan oleh huruf pertama dari pengenal (huruf besar / kecil). </font><font style="vertical-align: inherit;">Jika pengenal bersifat publik, namanya dimulai dengan huruf besar, dapat dirujuk oleh paket Go lainnya.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Anda dapat mendengar kata "diekspor" atau "tidak diekspor" sebagai sinonim untuk publik dan pribadi.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mengingat fitur kontrol akses yang terbatas, metode apa yang dapat digunakan untuk menghindari hierarki paket yang terlalu rumit? </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Di setiap paket, selain </font></font><code>cmd/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>internal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus ada kode sumber.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya telah berulang kali mengatakan bahwa lebih baik memilih paket yang lebih sedikit. </font><font style="vertical-align: inherit;">Posisi default Anda seharusnya tidak membuat paket baru. </font><font style="vertical-align: inherit;">Ini menyebabkan terlalu banyak tipe menjadi publik, menciptakan cakupan API yang luas dan kecil. </font><font style="vertical-align: inherit;">Di bawah ini kami mempertimbangkan tesis ini secara lebih rinci.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Datang dari Jawa? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda berasal dari dunia Java atau C #, maka ingat aturan tak terucapkan: paket Java setara dengan file sumber tunggal </font></font><code>.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Paket Go setara dengan seluruh modul Maven atau .NET assembly.</font></font></blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.1. </font><font style="vertical-align: inherit;">Menyortir kode berdasarkan file menggunakan instruksi impor</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda mengatur paket berdasarkan layanan, haruskah Anda melakukan hal yang sama untuk file dalam paket? </font><font style="vertical-align: inherit;">Bagaimana cara mengetahui kapan harus membagi satu file </font></font><code>.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjadi beberapa </font><font style="vertical-align: inherit;">file </font><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Bagaimana Anda tahu jika Anda telah melangkah terlalu jauh dan perlu memikirkan penggabungan file? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Berikut rekomendasi yang saya gunakan:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mulai setiap paket dengan satu file </font></font><code>.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Beri nama file ini sama dengan direktori. </font><font style="vertical-align: inherit;">Misalnya, paket </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus dalam file </font></font><code>http.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di direktori </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat paket bertambah, Anda dapat membagi berbagai fungsi menjadi beberapa file. </font><font style="vertical-align: inherit;">Sebagai contoh, file tersebut </font></font><code>messages.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan berisi tipe </font></font><code>Request</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>Response</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>client.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipe </font></font><code>Client</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">file </font></font><code>server.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tipe server </font><font style="vertical-align: inherit;">file </font><font style="vertical-align: inherit;">.</font></font><br></li><li>       ,    .  ,       . <br></li><li>        . , <code>messages.go</code>     HTTP-       , <code>http.go</code>      , <code>client.go</code>  <code>server.go</code> —    HTTP     . </li></ul><br><blockquote> <b></b> .      . </blockquote><br><blockquote> <b></b> .  Go    .      <i></i> ( —      Go).           . </blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1.2. </font><font style="vertical-align: inherit;">Lebih suka tes internal daripada eksternal</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alat ini </font></font><code>go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mendukung paket </font></font><code>testing</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di dua tempat. </font><font style="vertical-align: inherit;">Jika Anda memiliki paket </font></font><code>http2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Anda dapat menulis file </font></font><code>http2_test.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan menggunakan deklarasi paket </font></font><code>http2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Mengkompilasi kode </font></font><code>http2_test.go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">seperti</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itu adalah bagian dari paket </font></font><code>http2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dalam pidato sehari-hari, tes semacam itu disebut internal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alat ini </font></font><code>go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga mendukung deklarasi paket khusus yang diakhiri dengan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yaitu </font></font><code>http_test</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini memungkinkan file tes untuk hidup dalam paket yang sama dengan kode, tetapi ketika tes tersebut dikompilasi, mereka bukan bagian dari kode paket Anda, tetapi hidup dalam paket mereka sendiri. </font><font style="vertical-align: inherit;">Ini memungkinkan Anda untuk menulis tes seolah-olah paket lain memohon kode Anda. </font><font style="vertical-align: inherit;">Tes semacam ini disebut eksternal.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya sarankan menggunakan tes internal untuk tes unit unit. Ini memungkinkan Anda menguji setiap fungsi atau metode secara langsung, menghindari birokrasi pengujian eksternal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perlu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menempatkan contoh fungsi uji ( </font></font><code>Example</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">dalam file uji eksternal </font><font style="vertical-align: inherit;">. Ini memastikan bahwa ketika dilihat di godoc, contoh-contoh akan menerima awalan paket yang sesuai dan dapat dengan mudah disalin.</font></font><br><br><blockquote> <b></b> .    ,     . <br><br>   ,    ,   Go      <code>go</code> . ,  <code>net/http</code>       <code>net</code> . <br><br>           <code>.go</code> , ,    . </blockquote><br><h3> 5.1.3.   ,     API </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika proyek Anda memiliki beberapa paket, Anda mungkin menemukan fungsi yang diekspor yang dimaksudkan untuk digunakan oleh paket lain, tetapi tidak untuk API publik. </font><font style="vertical-align: inherit;">Dalam situasi seperti itu, alat ini </font></font><code>go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengenali nama folder khusus </font></font><code>internal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang dapat digunakan untuk menempatkan kode yang terbuka untuk proyek Anda, tetapi tertutup bagi orang lain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk membuat paket seperti itu, letakkan di direktori dengan nama </font></font><code>internal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau di subdirektori. </font><font style="vertical-align: inherit;">Ketika tim </font></font><code>go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">melihat impor paket dengan path </font></font><code>internal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, itu memeriksa lokasi paket panggilan dalam direktori atau subdirektori </font></font><code>internal/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebagai contoh, sebuah paket </font></font><code>.../a/b/c/internal/d/e/f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya dapat mengimpor paket dari pohon direktori </font></font><code>.../a/b/c</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi tidak sama sekali </font></font><code>.../a/b/g</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau repositori lainnya (lihat</font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dokumentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><a name="5_2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2. </font><font style="vertical-align: inherit;">Paket utama terkecil</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fungsi </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan paket </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus memiliki fungsionalitas minimal, karena </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berfungsi seperti singleton: program hanya dapat memiliki satu fungsi </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, termasuk tes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena itu </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">singleton, ada banyak batasan pada objek yang disebut: mereka dipanggil hanya selama </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>main.init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan hanya </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sekali</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini membuat tes menulis untuk kode sulit </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dengan demikian, Anda perlu berusaha untuk mendapatkan sebanyak mungkin logika dari fungsi utama dan, idealnya, dari paket utama.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><code>func main()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harus menganalisis flag, membuka koneksi ke database, logger, dll, dan kemudian mentransfer eksekusi ke objek tingkat tinggi.</font></font></blockquote><br><a name="6"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 6. struktur API </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saran desain terakhir untuk proyek yang saya anggap paling penting. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semua kalimat sebelumnya, pada prinsipnya, tidak mengikat. </font><font style="vertical-align: inherit;">Ini hanya rekomendasi berdasarkan pengalaman pribadi. </font><font style="vertical-align: inherit;">Saya tidak mendorong rekomendasi ini terlalu banyak ke tinjauan kode. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">API adalah masalah lain: Di sini, kesalahan dilakukan dengan lebih serius, karena segala sesuatu dapat diperbaiki tanpa merusak kompatibilitas: sebagian besar, ini hanya detail implementasi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketika berbicara tentang API publik, ada baiknya mempertimbangkan struktur secara serius sejak awal, karena perubahan selanjutnya akan merusak bagi pengguna.</font></font><br><br><a name="6_1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1. </font><font style="vertical-align: inherit;">Desain API yang sulit disalahgunakan oleh desain</font></font></h2><br><blockquote> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">“API harus sederhana untuk penggunaan yang tepat dan sulit untuk salah”</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Josh Bloch</font></font></a> </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nasihat Josh Bloch mungkin yang paling berharga dalam artikel ini. </font><font style="vertical-align: inherit;">Jika API sulit digunakan untuk hal-hal sederhana, maka setiap panggilan API lebih rumit dari yang diperlukan. </font><font style="vertical-align: inherit;">Saat panggilan API rumit dan tidak terlihat, kemungkinan akan diabaikan.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1.1. </font><font style="vertical-align: inherit;">Hati-hati dengan fungsi yang menerima banyak parameter dari jenis yang sama.</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh sederhana dari pandangan pertama yang sederhana, tetapi sulit untuk menggunakan API adalah ketika membutuhkan dua atau lebih parameter dari jenis yang sama. </font><font style="vertical-align: inherit;">Bandingkan dua tanda tangan fungsi:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CopyFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to, from </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa perbedaan antara kedua fungsi ini? </font><font style="vertical-align: inherit;">Jelas, satu mengembalikan maksimal dua angka, dan yang lainnya menyalin file. </font><font style="vertical-align: inherit;">Tapi ini bukan intinya.</font></font><br><br><pre> <code class="go hljs">Max(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-comment"><span class="hljs-comment">// 10 Max(10, 8) // 10</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Max </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">komutatif</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : urutan parameter tidak masalah. </font><font style="vertical-align: inherit;">Maksimal delapan dan sepuluh adalah sepuluh, terlepas dari apakah delapan dan sepuluh atau sepuluh dan delapan dibandingkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi dalam kasus CopyFile, ini tidak demikian.</font></font><br><br><pre> <code class="go hljs">CopyFile(<span class="hljs-string"><span class="hljs-string">"/tmp/backup"</span></span>, <span class="hljs-string"><span class="hljs-string">"presentation.md"</span></span>) CopyFile(<span class="hljs-string"><span class="hljs-string">"presentation.md"</span></span>, <span class="hljs-string"><span class="hljs-string">"/tmp/backup"</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Manakah dari operator ini yang akan membuat cadangan presentasi Anda, dan yang akan menimpanya dengan versi minggu lalu? </font><font style="vertical-align: inherit;">Anda tidak dapat memberi tahu sampai Anda memeriksa dokumentasinya. </font><font style="vertical-align: inherit;">Dalam proses review kode, tidak jelas apakah urutan argumennya benar atau tidak. </font><font style="vertical-align: inherit;">Sekali lagi, lihat dokumentasi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salah satu solusi yang mungkin adalah dengan memperkenalkan tipe tambahan yang bertanggung jawab untuk panggilan yang benar </font></font><code>CopyFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Source <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(src Source)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CopyTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dest </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CopyFile(dest, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(src)) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> from Source = <span class="hljs-string"><span class="hljs-string">"presentation.md"</span></span> from.CopyTo(<span class="hljs-string"><span class="hljs-string">"/tmp/backup"</span></span>) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Itu </font></font><code>CopyFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selalu disebut dengan benar di sini - ini dapat dinyatakan menggunakan unit test - dan dapat dilakukan secara pribadi, yang selanjutnya mengurangi kemungkinan kesalahan penggunaan.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">API dengan beberapa parameter dari jenis yang sama sulit digunakan dengan benar.</font></font></blockquote><br><a name="6_2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2. </font><font style="vertical-align: inherit;">Mendesain API untuk Kasus Penggunaan Dasar</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Beberapa tahun yang lalu, saya membuat </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">presentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tentang penggunaan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opsi fungsional</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk membuat API lebih mudah secara default. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inti dari presentasi adalah Anda harus mengembangkan API untuk use case utama. </font><font style="vertical-align: inherit;">Dengan kata lain, API seharusnya tidak mengharuskan pengguna untuk memberikan parameter tambahan yang tidak menarik baginya.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2.1. </font><font style="vertical-align: inherit;">Tidak disarankan menggunakan nil sebagai parameter</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya mulai dengan mengatakan bahwa Anda tidak boleh memaksa pengguna untuk memberikan parameter API yang tidak menarik baginya. </font><font style="vertical-align: inherit;">Ini berarti </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">merancang API untuk use case utama</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (opsi default). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah contoh dari paket net / http.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> http <span class="hljs-comment"><span class="hljs-comment">// ListenAndServe listens on the TCP network address addr and then calls // Serve with handler to handle requests on incoming connections. // Accepted connections are configured to enable TCP keep-alives. // // The handler is typically nil, in which case the DefaultServeMux is used. // // ListenAndServe always returns a non-nil error. func ListenAndServe(addr string, handler Handler) error {</span></span></code> </pre> <br> <code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menerima dua parameter: alamat TCP untuk mendengarkan koneksi yang masuk dan </font></font><code>http.Handler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk memproses permintaan HTTP yang masuk. </font></font><code>Serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan parameter kedua menjadi </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dalam komentar, dicatat bahwa biasanya objek pemanggil </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akan lewat </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menunjukkan keinginan untuk menggunakannya </font></font><code>http.DefaultServeMux</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai parameter implisit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang si penelepon </font></font><code>Serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki dua cara untuk melakukan hal yang sama.</font></font><br><br><pre> <code class="go hljs">http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, http.DefaultServeMux)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kedua opsi melakukan hal yang sama. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplikasi ini </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menyebar seperti virus. </font><font style="vertical-align: inherit;">Paket ini juga </font></font><code>http</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memiliki pembantu </font></font><code>http.Serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sehingga Anda dapat membayangkan struktur fungsi </font></font><code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ListenAndServe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(addr </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, handler Handler)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { l, err := net.Listen(<span class="hljs-string"><span class="hljs-string">"tcp"</span></span>, addr) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> l.Close() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Serve(l, handler) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena </font></font><code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan pemanggil lulus </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk parameter kedua, itu </font></font><code>http.Serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga mendukung perilaku ini. </font><font style="vertical-align: inherit;">Bahkan, itu dalam </font></font><code>http.Serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">logika yang diterapkan "jika handler sama </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, gunakan </font></font><code>DefaultServeMux</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">". </font><font style="vertical-align: inherit;">Penerimaan </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk satu parameter dapat membuat penelepon berpikir bahwa itu dapat diteruskan </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk kedua parameter. </font><font style="vertical-align: inherit;">Tapi begitulah</font></font><code>Serve</code> <br><br><pre> <code class="go hljs">http.Serve(<span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> menyebabkan kepanikan yang mengerikan. </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jangan mencampur parameter dalam tanda tangan fungsi yang sama </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan tidak </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penulis </font></font><code>http.ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mencoba menyederhanakan kehidupan pengguna API untuk kasus default, tetapi keamanan terpengaruh. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di hadapan, </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak ada perbedaan dalam jumlah garis antara penggunaan eksplisit dan tidak langsung </font></font><code>DefaultServeMux</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> root = http.Dir(<span class="hljs-string"><span class="hljs-string">"/htdocs"</span></span>) http.Handle(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, http.FileServer(root)) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dibandingkan dengan </font></font><br><br><pre> <code class="go hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> root = http.Dir(<span class="hljs-string"><span class="hljs-string">"/htdocs"</span></span>) http.Handle(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, http.FileServer(root)) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, http.DefaultServeMux)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apakah ada gunanya kebingungan untuk menjaga satu garis? </font></font><br><br><pre> <code class="go hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> root = http.Dir(<span class="hljs-string"><span class="hljs-string">"/htdocs"</span></span>) mux := http.NewServeMux() mux.Handle(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, http.FileServer(root)) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, mux)</code> </pre> <br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pikirkan dengan serius tentang berapa banyak waktu fungsi pembantu akan menyelamatkan programmer. </font><font style="vertical-align: inherit;">Kejelasan lebih baik daripada singkatnya.</font></font></blockquote><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hindari API publik dengan parameter yang hanya diperlukan pengujian. </font><font style="vertical-align: inherit;">Hindari mengekspor API dengan parameter yang nilainya hanya berbeda selama pengujian. </font><font style="vertical-align: inherit;">Sebagai gantinya, ekspor fungsi pembungkus yang menyembunyikan transfer parameter tersebut, dan dalam pengujian menggunakan fungsi pembantu serupa yang memberikan nilai yang diperlukan untuk pengujian.</font></font></blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2.2. </font><font style="vertical-align: inherit;">Gunakan argumen panjang variabel alih-alih [] T</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sangat sering, suatu fungsi atau metode mengambil sepotong nilai. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShutdownVMs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ids []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini hanya contoh buatan, tetapi ini sangat umum. Masalahnya adalah bahwa tanda tangan ini menganggap bahwa mereka akan dipanggil dengan lebih dari satu catatan. Seperti yang ditunjukkan oleh pengalaman, mereka sering dipanggil hanya dengan satu argumen, yang harus "dikemas" di dalam slice untuk memenuhi persyaratan tanda tangan fungsi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selain itu, karena parameternya </font></font><code>ids</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah slice, Anda bisa meneruskan irisan kosong atau nol ke fungsi, dan kompiler akan senang. Ini menambah beban tes tambahan karena pengujian harus mencakup kasus-kasus tersebut. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk memberikan contoh kelas API seperti itu, saya baru-baru ini refactored logika yang membutuhkan instalasi beberapa bidang tambahan jika setidaknya salah satu parameternya bukan nol. Logikanya terlihat seperti ini:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> svc.MaxConnections &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || svc.MaxPendingRequests &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || svc.MaxRequests &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> || svc.MaxRetries &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-comment"><span class="hljs-comment">// apply the non zero parameters }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena operator </font></font><code>if</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menjadi sangat panjang, saya ingin menarik logika validasi ke fungsi yang terpisah. </font><font style="vertical-align: inherit;">Inilah yang saya pikirkan:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// anyPostive indicates if any value is greater than zero. func anyPositive(values ...int) bool { for _, v := range values { if v &gt; 0 { return true } } return false }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini memungkinkan untuk menyatakan dengan jelas kondisi di mana unit dalam ruangan akan dieksekusi: </font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> anyPositive(svc.MaxConnections, svc.MaxPendingRequests, svc.MaxRequests, svc.MaxRetries) { <span class="hljs-comment"><span class="hljs-comment">// apply the non zero parameters }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, ada masalah dengan </font></font><code>anyPositive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, seseorang dapat secara tidak sengaja menyebutnya seperti ini:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> anyPositive() { ... }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam hal ini, </font></font><code>anyPositive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan kembali </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ini bukan pilihan terburuk. </font><font style="vertical-align: inherit;">Lebih buruk jika </font></font><code>anyPositive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dikembalikan </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanpa adanya argumen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, akan lebih baik untuk dapat mengubah tanda tangan anyPositive untuk memastikan bahwa setidaknya satu argumen diteruskan ke pemanggil. </font><font style="vertical-align: inherit;">Ini dapat dilakukan dengan menggabungkan parameter untuk argumen normal dan argumen panjang variabel (varargs):</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// anyPostive indicates if any value is greater than zero. func anyPositive(first int, rest ...int) bool { if first &gt; 0 { return true } for _, v := range rest { if v &gt; 0 { return true } } return false }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang </font></font><code>anyPositive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda tidak dapat menelepon dengan kurang dari satu argumen.</font></font><br><br><a name="6_3"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.3. </font><font style="vertical-align: inherit;">Biarkan fungsi menentukan perilaku yang diinginkan.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Misalkan saya diberi tugas menulis fungsi yang mempertahankan struktur </font></font><code>Document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada disk.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Save      f. func Save(f *os.File, doc *Document) error</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya bisa menulis fungsi </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang menulis </font></font><code>Document</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ke file </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Tetapi ada beberapa masalah. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tanda tangan </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menghilangkan kemungkinan merekam data melalui jaringan. Jika persyaratan seperti itu muncul di masa depan, tanda tangan dari fungsi harus diubah, yang akan mempengaruhi semua objek yang memanggil. </font></font><br><br> <code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga tidak menyenangkan untuk diuji, karena berfungsi langsung dengan file pada disk. Dengan demikian, untuk memverifikasi operasinya, tes harus membaca konten file setelah menulis. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan saya harus memastikan bahwa itu </font></font><code>f</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ditulis ke folder sementara dan kemudian dihapus. </font></font><br><br> <code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">juga mendefinisikan banyak metode yang tidak terkait dengan </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, misalnya, membaca direktori dan memeriksa apakah jalur adalah tautan simbolik. Nah, kalau tanda tangan</font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya dijelaskan bagian yang relevan </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang bisa dilakukan?</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Save      // ReadWriterCloser. func Save(rwc io.ReadWriteCloser, doc *Document) error</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dengan bantuannya </font></font><code>io.ReadWriteCloser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Anda dapat menerapkan prinsip pemisahan antarmuka - dan mendefinisikannya kembali </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada antarmuka yang menggambarkan properti yang lebih umum dari file tersebut. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah perubahan seperti itu, semua jenis yang mengimplementasikan antarmuka </font></font><code>io.ReadWriteCloser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dapat diganti dengan yang sebelumnya </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini secara bersamaan memperluas ruang lingkup </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan mengklarifikasi kepada pemanggil metode tipe apa </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang terkait dengan operasinya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dan penulis </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak dapat lagi memanggil metode yang tidak terkait ini </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, karena ia tersembunyi di balik antarmuka </font></font><code>io.ReadWriteCloser</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi kita dapat memperluas prinsip pemisahan antarmuka lebih jauh. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama jika</font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mengikuti prinsip tanggung jawab tunggal, tidak mungkin ia akan membaca file yang baru saja ia tulis untuk memeriksa isinya - kode lain harus melakukan ini. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Save      // WriteCloser. func Save(wc io.WriteCloser, doc *Document) error</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oleh karena itu, Anda dapat mempersempit spesifikasi antarmuka </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hanya dengan menulis dan menutup. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kedua, mekanisme penutupan utas </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adalah warisan waktu ketika bekerja dengan file. </font><font style="vertical-align: inherit;">Pertanyaannya adalah, dalam keadaan apa </font></font><code>wc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan ditutup. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apakah </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penyebab </font></font><code>Close</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanpa syarat, baik dalam hal keberhasilan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini menyajikan masalah bagi penelepon karena ia mungkin ingin menambahkan data ke aliran setelah dokumen ditulis.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Save      // Writer. func Save(w io.Writer, doc *Document) error</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi terbaik adalah mendefinisikan ulang Hemat untuk bekerja hanya dengan </font></font><code>io.Writer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menyimpan operator dari semua fungsi lainnya, kecuali untuk menulis data ke aliran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah menerapkan prinsip pemisahan antarmuka, fungsi pada saat yang sama menjadi lebih spesifik dalam hal persyaratan (hanya membutuhkan objek di mana ia dapat ditulis), dan lebih umum dalam hal fungsi, karena sekarang kita dapat menggunakannya </font></font><code>Save</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk menyimpan data di mana pun itu dilaksanakan </font></font><code>io.Writer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><a name="7"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7. Penanganan kesalahan </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya memberikan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beberapa presentasi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">menulis </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">banyak</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tentang topik ini di blog, jadi saya tidak akan mengulanginya. </font><font style="vertical-align: inherit;">Sebagai gantinya, saya ingin membahas dua bidang lain yang terkait dengan penanganan kesalahan.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><a name="7_1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1. </font><font style="vertical-align: inherit;">Hilangkan kebutuhan untuk penanganan kesalahan dengan menghapus sendiri kesalahan tersebut</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya membuat banyak saran untuk meningkatkan sintaks penanganan kesalahan, tetapi opsi terbaik adalah tidak menanganinya sama sekali. </font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Saya tidak mengatakan "hapus penanganan kesalahan". </font><font style="vertical-align: inherit;">Saya sarankan mengubah kode sehingga tidak ada kesalahan untuk diproses.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buku </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">filsafat pengembangan perangkat lunak</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terbaru John Osterhout menginspirasi saya untuk membuat saran ini </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Salah satu bab berjudul "Menghilangkan Kesalahan dari Realitas". </font><font style="vertical-align: inherit;">Mari kita coba terapkan nasihat ini.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1.1. </font><font style="vertical-align: inherit;">Hitungan baris</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kami akan menulis fungsi untuk menghitung jumlah baris dalam file. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CountLines</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r io.Reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ( br = bufio.NewReader(r) lines <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> err error ) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { _, err = br.ReadString(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) lines++ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != io.EOF { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lines, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saat kami mengikuti saran dari bagian sebelumnya, </font></font><code>CountLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">terima </font></font><code>io.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, bukan </font></font><code>*os.File</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; sudah menjadi tugas si penelepon untuk menyediakan </font></font><code>io.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">konten siapa yang ingin kita hitung. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami membuat </font></font><code>bufio.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan kemudian memanggil metode dalam satu lingkaran </font></font><code>ReadString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, meningkatkan penghitung, sampai kami mencapai akhir file, lalu kami mengembalikan jumlah baris yang dibaca. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setidaknya kami ingin menulis kode seperti itu, tetapi fungsinya dibebani dengan penanganan kesalahan. Misalnya, ada konstruksi yang aneh:</font></font><br><br><pre> <code class="go hljs"> _, err = br.ReadString(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) lines++ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menambah jumlah baris </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebelum</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> memeriksa kesalahan - ini terlihat aneh. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alasan kita harus menulisnya dengan cara ini adalah karena itu </font></font><code>ReadString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan mengembalikan kesalahan jika menemui akhir file lebih awal dari karakter baris baru. </font><font style="vertical-align: inherit;">Ini bisa terjadi jika tidak ada baris baru di akhir file. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk mencoba memperbaikinya, ubah logika penghitung baris, dan kemudian lihat apakah kita perlu keluar dari loop.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Logika ini masih belum sempurna, dapatkah Anda menemukan kesalahan?</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun kami belum selesai memeriksa kesalahan. </font></font><code>ReadString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan kembali </font></font><code>io.EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ketika menemui akhir file. </font><font style="vertical-align: inherit;">Ini adalah situasi yang diharapkan, jadi bagi </font></font><code>ReadString</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda perlu melakukan beberapa cara untuk mengatakan "berhenti, tidak ada lagi yang bisa dibaca." </font><font style="vertical-align: inherit;">Oleh karena itu, sebelum mengembalikan kesalahan ke objek panggilan </font></font><code>CountLine</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, Anda perlu memeriksa bahwa kesalahan tidak terkait dengan </font></font><code>io.EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan kemudian meneruskannya, kalau tidak kita kembali </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan mengatakan bahwa semuanya baik-baik saja. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya pikir ini adalah contoh yang bagus dari tesis Russ Cox tentang bagaimana penanganan kesalahan dapat menyembunyikan fungsinya. </font><font style="vertical-align: inherit;">Mari kita lihat versi yang ditingkatkan.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CountLines</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r io.Reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { sc := bufio.NewScanner(r) lines := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> sc.Scan() { lines++ } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lines, sc.Err() }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versi perbaikan ini digunakan </font></font><code>bufio.Scanner</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sebagai gantinya </font></font><code>bufio.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Di bawah tenda </font></font><code>bufio.Scanner</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menggunakan </font></font><code>bufio.Reader</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tetapi menambahkan tingkat abstraksi yang baik, yang membantu menghilangkan penanganan kesalahan.</font></font><br><br><blockquote> <b></b> . <code>bufio.Scanner</code>    ,      . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Metode </font></font><code>sc.Scan()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengembalikan nilai </font></font><code>true</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika pemindai menemukan string dan tidak menemukan kesalahan. Dengan demikian, loop body </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dipanggil hanya jika ada garis teks di buffer pemindai. Ini berarti bahwa yang baru </font></font><code>CountLines</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menangani kasus ketika tidak ada baris baru atau ketika file kosong. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kedua, karena ia </font></font><code>sc.Scan</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kembali </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ketika kesalahan terdeteksi, siklus </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berakhir ketika mencapai akhir file atau kesalahan terdeteksi. Tipe </font></font><code>bufio.Scanner</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengingat kesalahan pertama yang ditemui, dan menggunakan metode </font></font><code>sc.Err()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami dapat mengembalikan kesalahan itu segera setelah kami keluar dari loop. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya, ia </font></font><code>sc.Err()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengurus pemrosesan </font></font><code>io.EOF</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan mengubahnya menjadi </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jika akhir file tercapai tanpa kesalahan.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika Anda mengalami penanganan kesalahan yang berlebihan, cobalah mengekstraksi beberapa operasi menjadi tipe pembantu.</font></font></blockquote><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1.2. </font><font style="vertical-align: inherit;">Tanggapan Tanggapan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contoh kedua saya terinspirasi oleh posting </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Kesalahan adalah Nilai</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">" </font></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sebelumnya kami melihat contoh bagaimana file dibuka, ditulis, dan ditutup. </font><font style="vertical-align: inherit;">Ada penanganan kesalahan, tetapi tidak terlalu banyak, karena operasi dapat diringkas dalam pembantu, seperti </font></font><code>ioutil.ReadFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>ioutil.WriteFile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Tetapi ketika bekerja dengan protokol jaringan tingkat rendah, ada kebutuhan untuk membangun jawaban secara langsung menggunakan I / O primitif. </font><font style="vertical-align: inherit;">Dalam hal ini, penanganan kesalahan dapat menjadi mengganggu. </font><font style="vertical-align: inherit;">Pertimbangkan fragmen server HTTP yang membuat respons HTTP.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Header <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Key, Value <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Status <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Code <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Reason <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, st Status, headers []Header, body io.Reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { _, err := fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"HTTP/1.1 %d %s\r\n"</span></span>, st.Code, st.Reason) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, h := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> headers { _, err := fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"%s: %s\r\n"</span></span>, h.Key, h.Value) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> _, err := fmt.Fprint(w, <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } _, err = io.Copy(w, body) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama, bangun bilah status dengan </font></font><code>fmt.Fprintf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan periksa kesalahannya. Lalu untuk setiap tajuk kita menulis kunci dan nilai tajuk, setiap kali memeriksa kesalahan. Terakhir, kami menyelesaikan bagian tajuk dengan yang lain </font></font><code>\r\n</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, memeriksa kesalahan, dan menyalin badan tanggapan ke klien. Akhirnya, meskipun kita tidak perlu memeriksa kesalahan dari </font></font><code>io.Copy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kita perlu menerjemahkannya dari dua nilai kembali ke satu-satunya yang mengembalikan </font></font><code>WriteResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini banyak pekerjaan yang monoton. Tetapi Anda dapat meringankan tugas Anda dengan menerapkan jenis pembungkus kecil </font></font><code>errWriter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <code>errWriter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memenuhi kontrak </font></font><code>io.Writer</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, sehingga dapat digunakan sebagai pembungkus. </font></font><code>errWriter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meneruskan rekaman melalui fungsi hingga kesalahan terdeteksi. Dalam hal ini, ia menolak entri dan mengembalikan kesalahan sebelumnya.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> errWriter <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { io.Writer err error } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e *errWriter)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buf []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> e.err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, e.err } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n, e.err = e.Writer.Write(buf) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, st Status, headers []Header, body io.Reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { ew := &amp;errWriter{Writer: w} fmt.Fprintf(ew, <span class="hljs-string"><span class="hljs-string">"HTTP/1.1 %d %s\r\n"</span></span>, st.Code, st.Reason) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _, h := <span class="hljs-keyword"><span class="hljs-keyword">range</span></span> headers { fmt.Fprintf(ew, <span class="hljs-string"><span class="hljs-string">"%s: %s\r\n"</span></span>, h.Key, h.Value) } fmt.Fprint(ew, <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>) io.Copy(ew, body) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ew.err }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda menerapkan </font></font><code>errWriter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk </font></font><code>WriteResponse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, kejelasan kode meningkat secara signifikan. </font><font style="vertical-align: inherit;">Anda tidak perlu lagi memeriksa kesalahan dalam setiap operasi individu. </font><font style="vertical-align: inherit;">Pesan kesalahan bergerak ke akhir fungsi sebagai pemeriksaan bidang </font></font><code>ew.err</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, menghindari terjemahan nilai io.Copy yang mengganggu.</font></font><br><br><a name="7_2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2. </font><font style="vertical-align: inherit;">Tangani kesalahan hanya sekali</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Akhirnya, saya ingin mencatat bahwa kesalahan harus ditangani hanya sekali. </font><font style="vertical-align: inherit;">Memproses berarti memeriksa arti kesalahan dan membuat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">satu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keputusan.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// WriteAll writes the contents of buf to the supplied writer. func WriteAll(w io.Writer, buf []byte) { w.Write(buf) }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda membuat kurang dari satu keputusan, Anda mengabaikan kesalahan. </font><font style="vertical-align: inherit;">Seperti yang kita lihat di sini, kesalahan dari </font></font><code>w.WriteAll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diabaikan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi membuat </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lebih dari satu</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keputusan dalam menanggapi satu kesalahan juga salah. </font><font style="vertical-align: inherit;">Di bawah ini adalah kode yang sering saya temui.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, buf []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { _, err := w.Write(buf) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Println(<span class="hljs-string"><span class="hljs-string">"unable to write:"</span></span>, err) <span class="hljs-comment"><span class="hljs-comment">// annotated error goes to log file return err // unannotated error returned to caller } return nil }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam contoh ini, jika kesalahan terjadi selama waktu itu </font></font><code>w.Write</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, baris ditulis ke log, dan juga dikembalikan ke objek panggilan, yang, mungkin, juga akan mencatatnya dan meneruskannya, ke tingkat atas program. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemungkinan besar, penelepon melakukan hal yang sama:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, conf *Config)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { buf, err := json.Marshal(conf) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Printf(<span class="hljs-string"><span class="hljs-string">"could not marshal config: %v"</span></span>, err) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := WriteAll(w, buf); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Println(<span class="hljs-string"><span class="hljs-string">"could not write config: %v"</span></span>, err) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dengan demikian, setumpuk baris berulang dibuat dalam log. </font></font><br><br><pre> <code class="go hljs">unable to write: io.EOF could not write config: io.EOF</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tetapi di bagian atas program Anda mendapatkan kesalahan asli tanpa konteks apa pun. </font></font><br><br><pre> <code class="go hljs">err := WriteConfig(f, &amp;conf) fmt.Println(err) <span class="hljs-comment"><span class="hljs-comment">// io.EOF</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saya ingin menganalisis topik ini secara lebih rinci, karena saya tidak mempertimbangkan masalah secara bersamaan mengembalikan kesalahan dan masuk ke preferensi pribadi saya. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, conf *Config)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { buf, err := json.Marshal(conf) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Printf(<span class="hljs-string"><span class="hljs-string">"could not marshal config: %v"</span></span>, err) <span class="hljs-comment"><span class="hljs-comment">// oops, forgot to return } if err := WriteAll(w, buf); err != nil { log.Println("could not write config: %v", err) return err } return nil }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya sering menemui masalah yang lupa dikembalikan oleh programmer dari kesalahan. Seperti yang kami katakan sebelumnya, gaya Go adalah menggunakan operator batas, memeriksa prasyarat saat fungsi dijalankan, dan kembali lebih awal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam contoh ini, penulis memeriksa kesalahan, mendaftarkannya, tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lupa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk kembali. Karena ini, masalah halus muncul. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kontrak penanganan kesalahan Go mengatakan bahwa di hadapan kesalahan, tidak ada asumsi yang dapat dibuat tentang isi nilai pengembalian lainnya. Karena penguraian JSON gagal, isinya tidak </font></font><code>buf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diketahui: mungkin tidak mengandung apa-apa, tetapi lebih buruk, mungkin berisi fragmen JSON setengah tertulis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena programmer lupa untuk kembali setelah memeriksa dan mendaftarkan kesalahan, buffer yang rusak akan ditransfer </font></font><code>WriteAll</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Operasi kemungkinan berhasil, dan oleh karena itu file konfigurasi tidak akan ditulis dengan benar. </font><font style="vertical-align: inherit;">Namun, fungsi selesai secara normal, dan satu-satunya tanda bahwa masalah telah terjadi adalah baris di log di mana JSON marshaling gagal, dan bukan kegagalan catatan konfigurasi.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2.1. </font><font style="vertical-align: inherit;">Menambahkan konteks ke kesalahan</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Terjadi kesalahan karena penulis berusaha menambahkan konteks ke pesan kesalahan. </font><font style="vertical-align: inherit;">Dia mencoba meninggalkan tanda untuk menunjukkan sumber kesalahan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mari kita lihat cara lain untuk melakukan hal yang sama </font></font><code>fmt.Errorf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, conf *Config)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { buf, err := json.Marshal(conf) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fmt.Errorf(<span class="hljs-string"><span class="hljs-string">"could not marshal config: %v"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := WriteAll(w, buf); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fmt.Errorf(<span class="hljs-string"><span class="hljs-string">"could not write config: %v"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w io.Writer, buf []</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { _, err := w.Write(buf) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fmt.Errorf(<span class="hljs-string"><span class="hljs-string">"write failed: %v"</span></span>, err) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda menggabungkan catatan kesalahan dengan kembali pada satu baris, lebih sulit untuk lupa untuk kembali dan menghindari kelanjutan yang tidak disengaja. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika kesalahan I / O terjadi saat menulis file, metode ini </font></font><code>Error()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">akan menghasilkan sesuatu seperti ini:</font></font><br><br><pre> <code class="go hljs">could not write config: write failed: input/output error</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2.2. </font><font style="vertical-align: inherit;">Galat membungkus dengan github.com/pkg/errors</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pola ini </font></font><code>fmt.Errorf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berfungsi dengan baik untuk merekam </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pesan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kesalahan, tetapi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jenis</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> kesalahan berjalan di pinggir jalan. </font><font style="vertical-align: inherit;">Saya berpendapat bahwa menangani kesalahan sebagai nilai buram penting untuk </font><font style="vertical-align: inherit;">proyek yang </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">digabungkan secara longgar</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , jadi jenis kesalahan sumber seharusnya tidak menjadi masalah jika kita hanya perlu bekerja dengan nilainya:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pastikan itu bukan nol. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tampilkan di layar atau catat. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, itu terjadi bahwa Anda perlu mengembalikan kesalahan semula. </font><font style="vertical-align: inherit;">Untuk menjelaskan kesalahan seperti itu, Anda dapat menggunakan sesuatu seperti paket saya </font></font><code>errors</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { f, err := os.Open(path) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, errors.Wrap(err, <span class="hljs-string"><span class="hljs-string">"open failed"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> f.Close() buf, err := ioutil.ReadAll(f) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, errors.Wrap(err, <span class="hljs-string"><span class="hljs-string">"read failed"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> buf, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadConfig</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([]</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { home := os.Getenv(<span class="hljs-string"><span class="hljs-string">"HOME"</span></span>) config, err := ReadFile(filepath.Join(home, <span class="hljs-string"><span class="hljs-string">".settings.xml"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> config, errors.WithMessage(err, <span class="hljs-string"><span class="hljs-string">"could not read config"</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { _, err := ReadConfig() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { fmt.Println(err) os.Exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang pesan itu menjadi bug gaya K &amp; D yang bagus: </font></font><br><br><pre> <code class="go hljs">could not read config: open failed: open /Users/dfc/.settings.xml: no such file or directory</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dan nilainya berisi tautan ke alasan asli. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { _, err := ReadConfig() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { fmt.Printf(<span class="hljs-string"><span class="hljs-string">"original error: %T %v\n"</span></span>, errors.Cause(err), errors.Cause(err)) fmt.Printf(<span class="hljs-string"><span class="hljs-string">"stack trace:\n%+v\n"</span></span>, err) os.Exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dengan demikian, Anda dapat memulihkan kesalahan asli dan menampilkan jejak tumpukan: </font></font><br><br><pre> <code class="plaintext hljs">original error: *os.PathError open /Users/dfc/.settings.xml: no such file or directory stack trace: open /Users/dfc/.settings.xml: no such file or directory open failed main.ReadFile /Users/dfc/devel/practical-go/src/errors/readfile2.go:16 main.ReadConfig /Users/dfc/devel/practical-go/src/errors/readfile2.go:29 main.main /Users/dfc/devel/practical-go/src/errors/readfile2.go:35 runtime.main /Users/dfc/go/src/runtime/proc.go:201 runtime.goexit /Users/dfc/go/src/runtime/asm_amd64.s:1333 could not read config</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket ini </font></font><code>errors</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memungkinkan Anda untuk menambahkan konteks ke nilai kesalahan dalam format yang nyaman untuk orang dan mesin. </font><font style="vertical-align: inherit;">Pada presentasi baru-baru ini, saya katakan bahwa dalam rilis Go yang akan datang, bungkus seperti itu akan muncul di perpustakaan standar.</font></font><br><br><a name="8"></a><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 8. Konkurensi </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go sering dipilih karena kemampuan konkurensi. Pengembang melakukan banyak hal untuk meningkatkan efisiensi (dalam hal sumber daya perangkat keras) dan produktivitas, tetapi fungsi paralelisme Go dapat digunakan untuk menulis kode yang tidak produktif dan tidak dapat diandalkan. Pada akhir artikel ini saya ingin memberikan beberapa tips tentang bagaimana menghindari beberapa fungsi jebakan gokart Go. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dukungan concurrency terkemuka Go disediakan oleh saluran, serta instruksi </font></font><code>select</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan</font></font><code>go</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Jika Anda mempelajari teori Go dari buku pelajaran atau di universitas, Anda mungkin telah memperhatikan bahwa bagian paralelisme selalu menjadi yang terakhir dalam kursus. </font><font style="vertical-align: inherit;">Artikel kami tidak berbeda: saya memutuskan untuk berbicara tentang paralelisme pada akhirnya, sebagai sesuatu yang tambahan untuk keterampilan biasa yang harus dipelajari oleh programmer Go. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada dikotomi tertentu di sini, karena fitur utama Go adalah model paralelisme kami yang sederhana dan mudah. </font><font style="vertical-align: inherit;">Sebagai produk, bahasa kami menjual dirinya sendiri dengan mengorbankan hampir fungsi yang satu ini. </font><font style="vertical-align: inherit;">Di sisi lain, konkurensi sebenarnya tidak begitu mudah digunakan, jika tidak penulis tidak akan membuatnya menjadi bab terakhir dalam buku mereka, dan kita tidak akan melihat dengan menyesal kode kita. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagian ini membahas beberapa jebakan dari penggunaan fungsi konkurensi Go yang naif.</font></font><br><br><a name="8_1"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.1. </font><font style="vertical-align: inherit;">Lakukan beberapa pekerjaan sepanjang waktu.</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apa masalah dengan program ini? </font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintln(w, <span class="hljs-string"><span class="hljs-string">"Hello, GopherCon SG"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } }() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Program melakukan apa yang kami maksudkan: ini melayani server web sederhana. </font><font style="vertical-align: inherit;">Pada saat yang sama, CPU menghabiskan waktu CPU dalam infinite loop, karena </font></font><code>for{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada baris terakhir ia </font></font><code>main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memblokir gorutin utama, tanpa melakukan I / O, tidak ada menunggu pemblokiran, pengiriman atau penerimaan pesan, atau semacam koneksi dengan sheduler. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena Go runtime biasanya dilayani oleh sheduler, program ini akan berjalan dengan tidak masuk akal pada prosesor dan dapat berakhir pada kunci aktif (live-lock). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bagaimana cara memperbaikinya? </font><font style="vertical-align: inherit;">Ini ada satu pilihan.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> <span class="hljs-string"><span class="hljs-string">"runtime"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintln(w, <span class="hljs-string"><span class="hljs-string">"Hello, GopherCon SG"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } }() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> { runtime.Gosched() } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini mungkin terlihat konyol, tetapi ini adalah solusi umum yang saya temui di kehidupan nyata. </font><font style="vertical-align: inherit;">Ini adalah gejala kesalahpahaman dari masalah yang mendasarinya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika Anda sedikit lebih berpengalaman dengan Go, Anda dapat menulis sesuatu seperti ini.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintln(w, <span class="hljs-string"><span class="hljs-string">"Hello, GopherCon SG"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } }() <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> {} }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pernyataan kosong </font></font><code>select</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diblokir selamanya. </font><font style="vertical-align: inherit;">Ini berguna, karena sekarang kita tidak memutar seluruh prosesor hanya untuk panggilan </font></font><code>runtime.GoSched()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Namun, kami hanya mengobati gejalanya, bukan penyebabnya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya ingin menunjukkan kepada Anda solusi lain, yang, saya harap, sudah terlintas di benak Anda. </font><font style="vertical-align: inherit;">Alih-alih berlari </font></font><code>http.ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di goroutine, meninggalkan masalah goroutine utama, jalankan </font></font><code>http.ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">di goroutine utama.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika Anda keluar dari fungsi </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, program Go berakhir tanpa syarat, terlepas dari apa yang dijalankan goroutine lain selama eksekusi program.</font></font></blockquote><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintln(w, <span class="hljs-string"><span class="hljs-string">"Hello, GopherCon SG"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":8080"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jadi ini adalah saran pertama saya: jika goroutine tidak dapat membuat kemajuan sampai ia menerima hasil dari yang lain, maka seringkali lebih mudah untuk melakukan pekerjaan sendiri, daripada mendelegasikannya. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini sering menghilangkan banyak pelacakan negara dan manipulasi saluran yang diperlukan untuk mentransfer hasil kembali dari goroutine ke pemrakarsa proses.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Banyak programmer Go menyalahgunakan goroutine, terutama pada awalnya. </font><font style="vertical-align: inherit;">Seperti semua hal lain dalam hidup, kunci kesuksesan adalah moderasi.</font></font></blockquote><br><a name="8_2"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.2. </font><font style="vertical-align: inherit;">Serahkan paralelisme kepada penelepon</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apa perbedaan antara kedua API? </font></font><br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ListDirectory returns the contents of dir. func ListDirectory(dir string) ([]string, error)</span></span></code> </pre> <br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// ListDirectory returns a channel over which // directory entries will be published. When the list // of entries is exhausted, the channel will be closed. func ListDirectory(dir string) chan string</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami menyebutkan perbedaan yang jelas: contoh pertama membaca direktori menjadi slice, dan kemudian mengembalikan seluruh slice atau kesalahan jika terjadi kesalahan. Ini terjadi secara sinkron, penelepon memblokir </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sampai semua entri direktori telah dibaca. Bergantung pada seberapa besar direktori tersebut, ini bisa memakan banyak waktu dan berpotensi banyak memori. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perhatikan contoh kedua. Ini sedikit lebih seperti pemrograman Go klasik, di sini ia </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mengembalikan saluran melalui mana entri direktori akan dikirim. Ketika saluran ditutup, ini adalah tanda bahwa tidak ada lagi entri katalog. Karena pengisian saluran terjadi setelah pengembalian </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dapat diasumsikan bahwa goroutine mulai mengisi saluran.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Catatan</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Pada opsi kedua, tidak perlu menggunakan goroutine: Anda dapat memilih saluran yang cukup untuk menyimpan semua entri direktori tanpa memblokir, mengisinya, menutupnya, dan kemudian mengembalikan saluran ke pemanggil. </font><font style="vertical-align: inherit;">Tapi ini tidak mungkin, karena dalam kasus ini masalah yang sama akan muncul ketika menggunakan sejumlah besar memori untuk buffer semua hasil di saluran.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Versi </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">saluran memiliki dua masalah lagi:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menggunakan saluran tertutup sebagai sinyal bahwa tidak ada lagi elemen untuk diproses, </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak dapat memberi tahu pemanggil serangkaian elemen yang tidak lengkap karena kesalahan. </font><font style="vertical-align: inherit;">Penelepon tidak memiliki cara untuk menyampaikan perbedaan antara direktori kosong dan kesalahan. </font><font style="vertical-align: inherit;">Dalam kedua kasus, tampaknya saluran akan segera ditutup.</font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Penelepon harus terus membaca dari saluran ketika ditutup, karena ini adalah satu-satunya cara untuk memahami bahwa saluran yang mengisi goroutine telah berhenti berfungsi. </font><font style="vertical-align: inherit;">Ini adalah batasan serius dalam penggunaan </font></font><code>ListDirectory</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: pemanggil menghabiskan waktu membaca dari saluran, bahkan jika ia menerima semua data yang diperlukan. </font><font style="vertical-align: inherit;">Ini mungkin lebih efisien dalam hal penggunaan memori untuk direktori menengah dan besar, tetapi metode ini tidak lebih cepat dari metode berbasis slice asli.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dalam kedua kasus, solusinya adalah dengan menggunakan callback: fungsi yang dipanggil dalam konteks setiap entri direktori saat dijalankan. </font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ListDirectory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dir </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, fn </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">func</span></span></span></span><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tidak mengherankan, fungsinya </font></font><code>filepath.WalkDir</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bekerja seperti itu.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Jika fungsi Anda meluncurkan goroutine, Anda harus memberi pemanggil cara untuk menghentikan rutinitas ini secara eksplisit. </font><font style="vertical-align: inherit;">Sering kali paling mudah untuk meninggalkan mode eksekusi asinkron pada pemanggil.</font></font></blockquote><br><a name="8_3"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.3. </font><font style="vertical-align: inherit;">Jangan pernah menjalankan goroutine tanpa tahu kapan akan berhenti</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pada contoh sebelumnya, goroutine digunakan secara tidak perlu. </font><font style="vertical-align: inherit;">Tetapi salah satu kekuatan utama Go adalah kemampuan konkurensi kelasnya. </font><font style="vertical-align: inherit;">Memang, dalam banyak kasus kerja paralel cukup tepat, dan kemudian perlu menggunakan goroutine. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplikasi sederhana ini melayani lalu lintas http pada dua port berbeda: port 8080 untuk lalu lintas aplikasi dan port 8001 untuk akses ke titik akhir </font></font><code>/debug/pprof</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> _ <span class="hljs-string"><span class="hljs-string">"net/http/pprof"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resp http.ResponseWriter, req *http.Request)</span></span></span></span> { fmt.Fprintln(resp, <span class="hljs-string"><span class="hljs-string">"Hello, QCon!"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:8001"</span></span>, http.DefaultServeMux) <span class="hljs-comment"><span class="hljs-comment">// debug http.ListenAndServe("0.0.0.0:8080", mux) // app traffic }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Meskipun program ini tidak rumit, ini adalah dasar dari aplikasi nyata. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aplikasi dalam bentuk saat ini memiliki beberapa masalah yang akan muncul saat mereka tumbuh, jadi mari kita segera melihat beberapa dari mereka.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveApp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resp http.ResponseWriter, req *http.Request)</span></span></span></span> { fmt.Fprintln(resp, <span class="hljs-string"><span class="hljs-string">"Hello, QCon!"</span></span>) }) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, mux) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveDebug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:8001"</span></span>, http.DefaultServeMux) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> serveDebug() serveApp() }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">penangan melanggar </font></font><code>serveApp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>serveDebug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk fungsi yang terpisah, kita telah memisahkan mereka dari </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Kami juga mengikuti saran sebelumnya dan memastikan </font></font><code>serveApp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>serveDebug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">meninggalkan tugas untuk memastikan paralelisme pemanggil. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tetapi ada beberapa masalah dengan kinerja program semacam itu. </font><font style="vertical-align: inherit;">Jika kita keluar </font></font><code>serveApp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan kemudian </font><font style="vertical-align: inherit;">keluar </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, maka program berakhir dan akan dimulai kembali oleh manajer proses.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Seperti halnya fungsi di Go, berikan paralelisme kepada pemanggil, sehingga aplikasi harus berhenti memantau statusnya dan memulai kembali program yang memanggilnya. </font><font style="vertical-align: inherit;">Jangan membuat aplikasi Anda bertanggung jawab untuk me-restart sendiri: prosedur ini paling baik ditangani dari luar aplikasi.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namun, itu </font></font><code>serveDebug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dimulai pada goroutine yang terpisah, dan dalam kasus pelepasannya, goroutine berakhir, sementara sisa program berlanjut. </font><font style="vertical-align: inherit;">Pengembang Anda tidak akan menyukai kenyataan bahwa Anda tidak bisa mendapatkan statistik aplikasi karena pawang </font></font><code>/debug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">telah lama berhenti bekerja. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kami perlu memastikan aplikasi ditutup jika </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ada</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> goroutine yang melayani </font><font style="vertical-align: inherit;">berhenti </font><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveApp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resp http.ResponseWriter, req *http.Request)</span></span></span></span> { fmt.Fprintln(resp, <span class="hljs-string"><span class="hljs-string">"Hello, QCon!"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, mux); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveDebug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:8001"</span></span>, http.DefaultServeMux); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatal(err) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> serveDebug() <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> serveApp() <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> {} }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang </font></font><code>serverApp</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mereka </font></font><code>serveDebug</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">memeriksa kesalahan dari </font></font><code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan, jika perlu, memanggil mereka </font></font><code>log.Fatal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Karena kedua penangan bekerja di goroutine, kami menyusun rutinitas utama di </font></font><code>select{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pendekatan ini memiliki sejumlah masalah:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jika </font></font><code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kembali dengan kesalahan </font></font><code>nil</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, tidak akan ada panggilan </font></font><code>log.Fatal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dan layanan HTTP pada port ini akan keluar tanpa menghentikan aplikasi.</font></font><br></li><li> <code>log.Fatal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">panggilan </font></font><code>os.Exit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang keluar tanpa syarat dari program; </font><font style="vertical-align: inherit;">panggilan yang ditangguhkan tidak akan berfungsi, goroutine lain tidak akan diberitahu tentang penutupan, program hanya akan berhenti. </font><font style="vertical-align: inherit;">Ini membuatnya sulit untuk menulis tes untuk fungsi-fungsi ini.</font></font></li></ol><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gunakan hanya </font></font><code>log.Fatal</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pada fungsi </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bahkan, kami ingin menyampaikan kesalahan yang terjadi pada pencipta goroutine, sehingga ia dapat mengetahui mengapa dia berhenti dan menyelesaikan proses dengan bersih.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveApp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { mux := http.NewServeMux() mux.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(resp http.ResponseWriter, req *http.Request)</span></span></span></span> { fmt.Fprintln(resp, <span class="hljs-string"><span class="hljs-string">"Hello, QCon!"</span></span>) }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"0.0.0.0:8080"</span></span>, mux) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serveDebug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"127.0.0.1:8001"</span></span>, http.DefaultServeMux) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { done := <span class="hljs-built_in"><span class="hljs-built_in">make</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">chan</span></span> error, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { done &lt;- serveDebug() }() <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { done &lt;- serveApp() }() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i := <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-built_in"><span class="hljs-built_in">cap</span></span>(done); i++ { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := &lt;-done; err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { fmt.Println(<span class="hljs-string"><span class="hljs-string">"error: %v"</span></span>, err) } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Status pengembalian goroutine dapat diperoleh melalui saluran. Ukuran saluran sama dengan jumlah goroutine yang ingin kita kontrol, jadi pengiriman ke saluran </font></font><code>done</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak akan diblokir, karena ini akan memblokir penutupan goroutine dan menyebabkan kebocoran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karena saluran </font></font><code>done</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tidak dapat ditutup dengan aman, kami tidak dapat menggunakan idiom untuk siklus saluran </font></font><code>for range</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sampai semua goroutine melaporkan. Sebagai gantinya, kami menjalankan semua goroutine yang berjalan dalam satu siklus, yang sama dengan kapasitas saluran. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang kita memiliki cara untuk membersihkan setiap goroutine dengan bersih dan memperbaiki semua kesalahan yang mereka temui. Tinggal mengirim sinyal untuk menyelesaikan pekerjaan dari goroutine pertama ke orang lain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Banding untuk</font></font><code>http.Server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tentang penyelesaian, jadi saya membungkus logika ini dalam fungsi pembantu. </font><font style="vertical-align: inherit;">Helper </font></font><code>serve</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menerima alamat dan </font></font><code>http.Handler</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, juga </font></font><code>http.ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, saluran </font></font><code>stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang kami gunakan untuk menjalankan metode </font></font><code>Shutdown</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(addr </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, handler http.Handler, stop &lt;-</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">chan</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">struct</span></span></span></span><span class="hljs-function"><span class="hljs-params">{})</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { s := http.Server{ Addr: addr, Handler: handler, } <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { &lt;-stop <span class="hljs-comment"><span class="hljs-comment">// wait for stop signal s.Shutdown(context.Background()) }() return s.ListenAndServe() } func serveApp(stop &lt;-chan struct{}) error { mux := http.NewServeMux() mux.HandleFunc("/", func(resp http.ResponseWriter, req *http.Request) { fmt.Fprintln(resp, "Hello, QCon!") }) return serve("0.0.0.0:8080", mux, stop) } func serveDebug(stop &lt;-chan struct{}) error { return serve("127.0.0.1:8001", http.DefaultServeMux, stop) } func main() { done := make(chan error, 2) stop := make(chan struct{}) go func() { done &lt;- serveDebug(stop) }() go func() { done &lt;- serveApp(stop) }() var stopped bool for i := 0; i &lt; cap(done); i++ { if err := &lt;-done; err != nil { fmt.Println("error: %v", err) } if !stopped { stopped = true close(stop) } } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sekarang untuk setiap nilai di saluran </font></font><code>done</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kami menutup saluran </font></font><code>stop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, yang membuat setiap gorutin di saluran ini menutup sendiri </font></font><code>http.Server</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Pada gilirannya, ini mengarah pada pengembalian semua goroutine yang tersisa </font></font><code>ListenAndServe</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ketika semua gorut yang berjalan telah berhenti, itu </font></font><code>main.main</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berakhir dan proses berhenti dengan bersih.</font></font><br><br><blockquote> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kiat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Menulis logika seperti itu sendiri adalah pekerjaan berulang dan risiko kesalahan. </font><font style="vertical-align: inherit;">Lihatlah </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> seperti </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">ini</font></a><font style="vertical-align: inherit;"> yang akan melakukan sebagian besar pekerjaan untuk Anda.</font></font></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id441842/">https://habr.com/ru/post/id441842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id441826/index.html">Apa yang terjadi di pasar streaming audio: mendiskusikan pengembangan platform streaming</a></li>
<li><a href="../id441830/index.html">Panduan Pengguna Kibana. Visualisasi. Bagian 4</a></li>
<li><a href="../id441832/index.html">Siapa manajer proyek menurut pendapat pemilik bisnis dan bagaimana menghadapinya</a></li>
<li><a href="../id441834/index.html">Jangan mulai bekerja. Tetapi bagaimana jika masalahnya ada pada Anda?</a></li>
<li><a href="../id441836/index.html">One Cloud Story: Huawei + 3data = Cloud</a></li>
<li><a href="../id441844/index.html">iRobot Scooba: pengalaman dan solusi untuk masalah umum pembersih robot pencuci</a></li>
<li><a href="../id441848/index.html">Magang untuk pengembang di Avito: misi tempur dan bekerja dengan mentor berpengalaman</a></li>
<li><a href="../id441850/index.html">Keberuntungan menceritakan pada jaringan saraf: apakah penulis sendiri mencatat dalam komentar di posting</a></li>
<li><a href="../id441852/index.html">42 Silicon Valley: bagaimana cara dipilih</a></li>
<li><a href="../id441854/index.html">SISA? Ambil JSON-RPC bodoh</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>