<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚öïÔ∏è üëêüèΩ üë©üèª‚Äçüîß Algumas palavras em defesa do mon√≥lito üòß üèñÔ∏è üë®üèø‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comparamos os recursos do microsservi√ßo e da arquitetura monol√≠tica, suas vantagens e desvantagens. O artigo foi preparado para Habr com base nos mate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Algumas palavras em defesa do mon√≥lito</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/453932/">  Comparamos os recursos do microsservi√ßo e da arquitetura monol√≠tica, suas vantagens e desvantagens.  O artigo foi preparado para Habr com base nos materiais de nossa meta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hot Backend</a> , realizada em Samara em 9 de fevereiro de 2019.  Consideramos os fatores de escolha da arquitetura, dependendo da tarefa espec√≠fica. <a name="habracut"></a><br><br>  Mesmo 5 anos atr√°s, ningu√©m tinha ouvido falar em microsservi√ßos.  No entanto, sua popularidade est√° aumentando de ano para ano, de acordo com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estat√≠sticas do</a> Google Trends. <br><br><img src="https://habrastorage.org/webt/1_/of/jd/1_ofjdwx6pauxathtq1srtfdsas.png"><br><br><h2>  Mon√≥lito e microsservi√ßos: exemplos </h2><br>  Se o projeto usar uma arquitetura monol√≠tica, o desenvolvedor ter√° apenas um aplicativo, todos os componentes e m√≥dulos dos quais trabalham com uma √∫nica base. <br><br><img src="https://habrastorage.org/webt/8q/pt/px/8qptpxklg15wtydbx847sqk2c9o.jpeg"><br><br>  A arquitetura de microsservi√ßos envolve a decomposi√ß√£o em m√≥dulos que s√£o executados como processos separados e podem ter servidores separados.  Cada microsservi√ßo trabalha com seu pr√≥prio banco de dados e todos esses servi√ßos podem se comunicar de forma s√≠ncrona (http) e ass√≠ncrona.  Al√©m disso, para otimizar a arquitetura, √© desej√°vel minimizar o relacionamento entre os servi√ßos. <br><br>  O diagrama abaixo √© simplificado, reflete, em primeiro lugar, os componentes de neg√≥cios. <br><br><img src="https://habrastorage.org/webt/q2/gi/y-/q2giy-br8pq2amiqihkrkzmn2e4.jpeg"><br><br><h2>  Microsservi√ßos: benef√≠cios </h2><br>  H√° pelo menos quatro vantagens da arquitetura de microsservi√ßo: <br><br>  <b>Dimensionamento e implanta√ß√£o independentes</b> <br><br>  Uma implanta√ß√£o independente √© fornecida para cada microsservi√ßo, e isso √© conveniente ao atualizar m√≥dulos individuais.  Se a carga no m√≥dulo aumentar, o microsservi√ßo correspondente poder√° ser escalado sem afetar os outros.  Isso permite distribuir de forma flex√≠vel a carga e economizar recursos. <br><br>  <b>Desenvolvimento independente</b> <br><br>  Cada microsservi√ßo (por exemplo, um m√≥dulo de mem√≥ria) pode ser desenvolvido por uma equipe para aumentar a velocidade de cria√ß√£o de um produto de software. <br><br>  <b>Sustentabilidade</b> <br><br>  A falha de um microsservi√ßo n√£o afeta o desempenho de outros m√≥dulos. <br><br>  <b>Heterogeneidade</b> <br><br>  Cada equipe √© livre para escolher seu pr√≥prio idioma e tecnologia para implementar microsservi√ßos, no entanto, √© desej√°vel que eles tenham interfaces compat√≠veis. <br><br>  Entre os desenvolvedores, voc√™ pode ouvir a opini√£o de que a arquitetura monol√≠tica est√° desatualizada, √© dif√≠cil de manter e dimensionar, cresce rapidamente em um "grande peda√ßo de terra" e √© praticamente antipadr√£o, ou seja, sua presen√ßa no c√≥digo √© indesej√°vel.  Grandes empresas, como a Netflix, que mudaram para a arquitetura de microsservi√ßo em seus projetos, s√£o frequentemente citadas como evid√™ncia dessa opini√£o. <br><br>  Vamos ver se todos realmente devem mudar de um mon√≥lito para microsservi√ßos, seguindo o exemplo das maiores marcas? <br><br>
<h2>  Mudando para microsservi√ßos: poss√≠veis dificuldades </h2><br>  <b>Problema Um: Decomposi√ß√£o</b> <br><br>  Idealmente, o aplicativo deve ser dividido em microsservi√ßos para que eles interajam o m√≠nimo poss√≠vel, caso contr√°rio, o aplicativo ser√° dif√≠cil de manter.  Ao mesmo tempo, √© dif√≠cil implementar a decomposi√ß√£o no in√≠cio do desenvolvimento, quando os problemas de neg√≥cios e a √°rea de assunto ainda podem mudar com o advento de novos requisitos.  A refatora√ß√£o √© cara. <br><br>  Se for necess√°rio transferir parte das fun√ß√µes do servi√ßo A para o servi√ßo B, pode haver dificuldades: por exemplo, os servi√ßos s√£o executados em diferentes idiomas, as chamadas internas aos servi√ßos se tornam rede, outras bibliotecas devem ser conectadas.  Podemos verificar a corre√ß√£o da refatora√ß√£o apenas com a ajuda de testes. <br><br><img src="https://habrastorage.org/webt/ms/sb/zd/mssbzdbu2gw0mkt3xxsxd7cozuo.jpeg"><br><br>  <b>Problema Dois: Transa√ß√µes</b> <br><br>  Outro problema √© que os microsservi√ßos n√£o t√™m o conceito de transa√ß√µes distribu√≠das.  Podemos garantir a integridade arquitetural de uma opera√ß√£o comercial apenas em um microsservi√ßo.  Se a opera√ß√£o envolver v√°rios microsservi√ßos, diferentes bancos de dados poder√£o ser usados ‚Äã‚Äãl√° e essa transa√ß√£o ter√° que ser abandonada.  Para resolver esse problema, existem v√°rios m√©todos usados ‚Äã‚Äãnos neg√≥cios quando a acessibilidade √© mais importante que a integridade.  Ao mesmo tempo, mecanismos de compensa√ß√£o s√£o fornecidos caso algo d√™ errado.  Por exemplo, se as mercadorias n√£o estiverem em estoque, voc√™ precisar√° fazer um reembolso na conta do comprador. <br><br>  Se um mon√≥lito nos fornecer integridade arquitetural automaticamente, com os microsservi√ßos, voc√™ precisar√° criar seu pr√≥prio mecanismo e usar bibliotecas com solu√ß√µes prontas.  Ao distribuir uma opera√ß√£o entre servi√ßos, √© melhor solicitar dados de forma s√≠ncrona e executar a√ß√µes subseq√ºentes de forma ass√≠ncrona.  Se for imposs√≠vel acessar um dos servi√ßos, a equipe ficar√° na fila assim que estiver dispon√≠vel novamente. <br><br>  Nesse sentido, √© necess√°rio revisar a abordagem da interface do usu√°rio.  O usu√°rio deve ser notificado de que algumas a√ß√µes n√£o s√£o executadas imediatamente, mas dentro de um certo tempo.  Quando o aplicativo √© processado, ele recebe um convite para ver os resultados. <br><br><img src="https://habrastorage.org/webt/j3/ms/1m/j3ms1mf_jzbabdwangp62th2uru.jpeg"><br><br>  <b>Problema tr√™s: relat√≥rios</b> <br><br>  Se usarmos uma arquitetura monol√≠tica com um √∫nico banco de dados, para criar um relat√≥rio complexo, voc√™ pode escrever selecione e puxe v√°rios r√≥tulos de dados: mais cedo ou mais tarde eles ser√£o exibidos.  No entanto, em microsservi√ßos, esses dados podem ser espalhados em diferentes bases. <br><br>  Por exemplo, precisamos listar empresas com m√©tricas espec√≠ficas.  Com uma lista simples de empresas, tudo funciona.  E se voc√™ precisar adicionar m√©tricas que estejam em outro banco de dados?  Sim, podemos fazer uma solicita√ß√£o adicional e solicitar m√©tricas pelo TIN.  E se essa lista precisar ser filtrada e classificada?  A lista de empresas pode ser muito grande e, em seguida, precisamos introduzir um servi√ßo adicional com seu pr√≥prio banco de dados - relat√≥rios. <br><br><img src="https://habrastorage.org/webt/lz/kq/sn/lzkqsn07kbbjovz9_rttgfqbfmg.jpeg"><br><br>  <b>Problema quatro: alta complexidade de desenvolvimento</b> <br><br>  O trabalho em servi√ßos distribu√≠dos √© mais complicado: todas as solicita√ß√µes s√£o feitas pela rede e podem ser desativadas; √© necess√°rio fornecer um mecanismo de retorno de chamada (ser√° que a liga√ß√£o ser√° feita novamente? Quantas vezes?).  Estes s√£o os "tijolos" que gradualmente se acumulam e contribuem para aumentar a complexidade do projeto. <br><br>  Os servi√ßos podem ser desenvolvidos por v√°rias equipes diferentes, e voc√™ precisa document√°-los, manter a documenta√ß√£o atualizada, avisar outras equipes ao alterar a vers√£o.  Estes s√£o custos adicionais de m√£o-de-obra. <br><br>  Se cada equipe tiver uma implanta√ß√£o independente, voc√™ precisar√° manter pelo menos a vers√£o anterior e desabilit√°-la somente depois que todos os consumidores do servi√ßo tiverem mudado para a nova API. <br>  Obviamente, podemos levar todas as APIs para algum tipo de artefato que estar√° dispon√≠vel ao p√∫blico.  Mas, primeiro, os servi√ßos podem ser escritos em diferentes idiomas e, segundo, isso n√£o √© recomendado.  Por exemplo, em um de nossos projetos, recusamos isso a pedido do cliente, relacionado a considera√ß√µes de seguran√ßa.  Cada microsservi√ßo possui um reposit√≥rio separado e o cliente n√£o d√° acesso a eles. <br><br>  No processo de desenvolvimento, tudo pode funcionar corretamente, e ent√£o - n√£o.  Acontece que, no caso de exce√ß√µes, o aplicativo tenta infinitamente process√°-las, e isso gera uma grande carga - todo o sistema "estabelece".  Para evitar tais situa√ß√µes, voc√™ precisa configurar tudo, por exemplo, para limitar o n√∫mero de tentativas, para n√£o retornar esta chamada para a fila no mesmo segundo, etc. <br><br><img src="https://habrastorage.org/webt/_w/jd/oj/_wjdoj3ln-k7ysfb6wuh8kz1ycg.jpeg"><br><br><img src="https://habrastorage.org/webt/ae/rr/xc/aerrxc3udwi9pgafnmkzc7xy2du.jpeg"><br><br>  <b>O quinto problema: a complexidade do teste, rastreamento e depura√ß√£o</b> <br><br>  Para testar um problema, voc√™ precisa baixar todos os microsservi√ßos envolvidos.  A depura√ß√£o se torna uma tarefa n√£o trivial e todos os logs precisam ser coletados em algum lugar do mesmo local.  Nesse caso, voc√™ precisa do maior n√∫mero poss√≠vel de logs para descobrir o que aconteceu.  Para rastrear o problema, voc√™ precisa entender todo o caminho que a mensagem percorreu.  Os testes de unidade n√£o s√£o suficientes aqui, pois √© prov√°vel que haja erros na jun√ß√£o de servi√ßos.  Ao fazer altera√ß√µes, √© poss√≠vel verificar a operabilidade somente ap√≥s a execu√ß√£o no suporte.  Podemos limitar cada microsservi√ßo a uma certa quantidade de mem√≥ria (por exemplo, 500 megabytes), mas h√° momentos de pico de carga quando s√£o necess√°rios dois gigabytes.  H√° momentos em que o sistema come√ßa a ficar mais lento.  Como resultado, os recursos podem ser gastos em algo que n√£o pertence √†s tarefas imediatas do cliente: por exemplo, existem apenas dois microsservi√ßos comerciais e metade dos recursos s√£o gastos em tr√™s microsservi√ßos adicionais que d√£o suporte ao trabalho dos outros. <br><br><img src="https://habrastorage.org/webt/pl/bn/36/plbn36qdp9gnyslu-b0xbecfo7c.jpeg"><br><br><h2>  Microsservi√ßo ou mon√≥lito: crit√©rios de sele√ß√£o </h2><br>  Ao escolher entre arquitetura monol√≠tica e microsservi√ßos, primeiro, voc√™ precisa prosseguir da complexidade da √°rea de assunto e da necessidade de dimensionamento. <br><br>  Se a √°rea de assunto for simples e n√£o for esperado um aumento global no n√∫mero de usu√°rios, os microsservi√ßos poder√£o ser usados ‚Äã‚Äãsem d√∫vida.  Em outros casos, √© melhor iniciar o desenvolvimento em um mon√≥lito e economizar recursos se a escala n√£o for necess√°ria.  Se a √°rea de assunto √© complexa e, no est√°gio inicial, os requisitos finais n√£o s√£o definidos, tamb√©m √© melhor come√ßar com um mon√≥lito - para n√£o refazer os microsservi√ßos v√°rias vezes.  Com o desenvolvimento do projeto, √© poss√≠vel distinguir suas partes individuais em microsservi√ßos. <br><br><img src="https://habrastorage.org/webt/bl/5c/9e/bl5c9elyajqq00pivozpby_yauy.jpeg"><br><br>  Uma vantagem √© a presen√ßa de limites no in√≠cio do projeto, pois isso ajudar√° a n√£o quebr√°-los durante o processo de desenvolvimento.  Tamb√©m faz sentido come√ßar com um banco de dados, mas definir um esquema para cada m√≥dulo (por exemplo, um esquema de pagamento).  Posteriormente, isso ajudar√° a simplificar a divis√£o dos m√≥dulos em microsservi√ßos.  Nesse caso, observamos os limites dos m√≥dulos e podemos usar microsservi√ßos. <br><br>  Cada m√≥dulo deve ter sua pr√≥pria API, para que mais tarde possa ser alocado e transformou o m√≥dulo em um microsservi√ßo. <br><br><img src="https://habrastorage.org/webt/6i/rp/b9/6irpb9ewnkmgleylittjhh5z-f8.jpeg"><br><br>  Depois de determinar os limites dos m√≥dulos, voc√™ pode proceder √† decomposi√ß√£o em microsservi√ßos, se necess√°rio.  Em cerca de 90% dos casos, ser√° poss√≠vel permanecer no mon√≥lito, mas, se necess√°rio, ser√° mais f√°cil e barato alterar a arquitetura. <br><br>  Em nossa pr√°tica de trabalhar com mon√≥litos e microsservi√ßos, chegamos √†s seguintes conclus√µes: <br><ul><li>  N√£o mude para microsservi√ßos apenas porque eles s√£o usados ‚Äã‚Äãpelo Netflix, Twitter, Facebook </li><li>  Comece com dois ou tr√™s microsservi√ßos que interagem entre si, elabore detalhadamente todos os requisitos n√£o funcionais (seguran√ßa, toler√¢ncia a falhas, escalabilidade etc.) e s√≥ depois passe para outros servi√ßos </li><li>  Automatize tudo o que √© poss√≠vel </li><li>  Configurar monitoramento </li><li>  Gravar autotestes </li><li>  N√£o use transa√ß√µes distribu√≠das (mas esse n√£o √© um motivo para recusar a garantia de integridade dos dados). </li><li>  Se voc√™ deseja usar uma arquitetura de microsservi√ßo, esteja preparado para o fato de que o desenvolvimento pode custar cerca de tr√™s vezes mais do que em um mon√≥lito.  No entanto, ambas as tecnologias t√™m suas pr√≥prias desvantagens e vantagens, cada uma delas com seu pr√≥prio nicho. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt453932/">https://habr.com/ru/post/pt453932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt453914/index.html">Instru√ß√µes de instala√ß√£o do cliente de teste TON</a></li>
<li><a href="../pt453916/index.html">Como se proteger de golpistas m√≥veis</a></li>
<li><a href="../pt453920/index.html">Como assumir o controle de sua infraestrutura de rede. Cap√≠tulo Quatro Automa√ß√£o Templates</a></li>
<li><a href="../pt453926/index.html">Como o servi√ßo de compartilhamento de carros funciona e funciona</a></li>
<li><a href="../pt453930/index.html">Compara√ß√£o e sele√ß√£o de sistemas de migra√ß√£o de dados</a></li>
<li><a href="../pt453934/index.html">11 perguntas a discutir antes de come√ßar o trabalho</a></li>
<li><a href="../pt453938/index.html">Rastreamento de bicicleta roubada NB-IoT</a></li>
<li><a href="../pt453942/index.html">Sobre √©tica com o exemplo do PMI Codex</a></li>
<li><a href="../pt453944/index.html">Erros mascarados no embedd</a></li>
<li><a href="../pt453950/index.html">Voc√™ deveria estar aqui! 22 anos do lan√ßamento do lend√°rio jogo Duke Nukem 3D</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>