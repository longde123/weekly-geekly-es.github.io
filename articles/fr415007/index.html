<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è±Ô∏è üë§ üíº Comment configurer Bluetooth sur Linux de mani√®re compliqu√©e ü§òüèæ üôéüèΩ ü•á</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En pr√©paration du forum informatique annuel, j'ai eu l'id√©e de cr√©er un simple manipulateur contr√¥l√© par une manette de jeu sans fil pour d√©montrer le...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment configurer Bluetooth sur Linux de mani√®re compliqu√©e</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415007/"><p><img src="https://habrastorage.org/webt/wq/9u/sv/wq9usvb7w6-8_c5p_dhrrkom_qa.jpeg"></p><br><p> En pr√©paration du forum informatique annuel, j'ai eu l'id√©e de cr√©er un simple manipulateur contr√¥l√© par une manette de jeu sans fil pour d√©montrer les capacit√©s des microcontr√¥leurs et des ordinateurs √† carte unique.  √Ä port√©e de main se trouvait un contr√¥leur TRIC, plusieurs servomoteurs, un constructeur de fer, et un mois avant le d√©but du forum. </p><br><p>  ¬´Tout se d√©roule comme pr√©vu¬ª, mais pas dans ce cas. </p><a name="habracut"></a><br><h1 id="etap-1-podgotovka">  √âtape 1. Pr√©paration </h1><br><p>  TRIC √† bord de Linux √©tait un buste pour un tel manipulateur, mais "le point est la banalit√© d'utilisation et de maintenance" (citation de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">ClusterM √†</a> propos de Linux dans un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">interphone intelligent</a> ). </p><br><p>  Apr√®s avoir lu la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification</a> , il a √©t√© d√©couvert qu'il dispose de Bluetooth.  Si vous avez travaill√© avec ce contr√¥leur, vous savez que le transfert de programmes se fait via le Wi-Fi et qu'il n'y a pas d'autres moyens pratiques de communiquer avec lui.  Il n'y a aucune mention de Bluetooth dans le menu.  Mais comment √ßa? </p><br><p>  Arm√© de SSH, d'un tournevis et de curiosit√©, j'ai commenc√© √† chercher le Bluetooth.  Le syst√®me comprenait hcitool, hciconfig et le d√©mon bluetoothd.  Tous ont dit qu'il n'√©tait pas l√†. </p><br><pre><code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0 Can't get device info: No such device</span></span></code> </pre> <br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 5449 root@trik-7dda93:~# bluetoothd[5449]: Bluetooth daemon 4.101 bluetoothd[5449]: Starting SDP server bluetoothd[5449]: Bluetooth Management interface initialized</span></span></code> </pre> <br><p>  Appelant des amis √† la recherche d'un module USB externe, j'ai continu√© √† chercher. </p><br><p>  Apr√®s avoir d√©mont√© le contr√¥leur, le module Jorjin WG7311-0A a √©t√© trouv√©.  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification</a> indique qu'il y a vraiment une connexion Wi-Fi, Bluetooth et m√™me une radio FM.  L'interface pour communiquer avec Bluetooth est UART, et elle est activ√©e via BT_EN. </p><br><p><img src="https://habrastorage.org/webt/de/5d/qh/de5dqhz_nocaef_cwt0fh_d5umc.jpeg"></p><br><p>  Apr√®s avoir lu comment le module Bluetooth est connect√© via UART via hcitool, j'ai tent√© ma chance et rien.  Deux des trois ports UART gratuits √©taient silencieux. </p><br><p>  Mais nous avons contact BT_EN!  Il est possible que le module soit simplement √©teint et ne r√©ponde pas aux demandes.  Apr√®s avoir examin√© le p√©riph√©rique du noyau Linux pour les p√©riph√©riques ARM, un fichier a √©t√© trouv√© o√π tous les contacts utilis√©s par SoC sont enregistr√©s.  En ouvrant <code>arch/arm/mach-davinci/board-da850-trik.c</code> dans le code source du noyau, un contact GPIO pour Bluetooth a √©t√© trouv√©.  Victoire!  Pensai-je. </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> da850_trik_bluetooth_pins[] __initconst = { DA850_GPIO6_11, <span class="hljs-comment"><span class="hljs-comment">/*BT_EN_33 */</span></span> DA850_GPIO6_10, <span class="hljs-comment"><span class="hljs-comment">/*BT_WU_33*/</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span> };</code> </pre> <br><h1 id="etap-2-nastuplenie">  √âtape 2. Offensive </h1><br><p>  Pour activer un contact via GPIO, vous devez trouver son num√©ro de s√©rie de bout en bout.  Nous trouvons la ligne suivante dans le code du noyau avec une demande d'initialisation du contact BT_EN_33 dans <code>arch/arm/mach-davinci/board-da850-trik.c</code> : </p><br><pre> <code class="hljs lisp">ret = gpio_request_one(<span class="hljs-name"><span class="hljs-name">GPIO_TO_PIN</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), GPIOF_OUT_INIT_LOW, <span class="hljs-string"><span class="hljs-string">"BT_EN_33"</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code> </pre> <br><p>  Il utilise la macro GPIO_TO_PIN.  Voir la description de la macro dans <code>arch/arm/mach-davinci/include/mach/gpio-davinci.h</code> : </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* Convert GPIO signal to GPIO pin number */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> GPIO_TO_PIN(bank, gpio) (16 * (bank) + (gpio))</span></span></code> </pre> <br><p>  En l'utilisant, vous pouvez trouver le num√©ro de contact de bout en bout.  Nous obtenons que 16 * 6 + 11 = 107. Passons maintenant √† l'inclusion du contact. </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value</code> </pre> <br><p>  0 ou 1 dans la commande echo est l'√©tat du contact. </p><br><p>  Ex√©cutez la commande pour vous connecter et ... </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts can't open firmware file: No such file or directory Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts Device setup complete</span></span></code> </pre> <br><p>  incompr√©hensible pour nous (pour le moment) des messages d'erreur.  Nous essayons de configurer l'appareil via hcitool: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hcitool dev Devices:</span></span></code> </pre> <br><p>  Il n'y a pas d'appareils, bien que l'initialisation soit cens√©ment pass√©e.  Nous essayons de nous connecter une deuxi√®me fois, mais avec un autre type d'adaptateur: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciattach /dev/ttyS0 texasalt Texas module LMP version : 0x06 Texas module LMP sub-version : 0x1f0f internal version freeze: 15 software version: 6 chip: wl1271 (7) Opening firmware file: /etc/firmware/wl1271.bin Could not open firmware file /etc/firmware/wl1271.bin: No such file or directory (2). Device setup complete</span></span></code> </pre> <br><p>  Et encore une fois, rien.  Revenons √† la premi√®re erreur et appliquons la connaissance de l'anglais: </p><br><pre> <code class="bash hljs">Warning: cannot find BTS file: /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Nous ouvrons le dossier / lib / firmware avec firmware et ne trouvons pas le fichier dont nous avons besoin.  Apr√®s une longue recherche sur Internet, nous trouvons le fichier souhait√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le r√©f√©rentiel TI</a> et le t√©l√©chargeons.  D'autres versions du m√™me fichier ont refus√© de fonctionner. </p><br><pre> <code class="bash hljs">curl -k https://git.ti.com/wilink8-bt/ti-bt-firmware/blobs/raw/45897a170bc30afb841b1491642e774f0c89b584/TIInit_7.6.15.bts &gt; TIInit_7.6.15.bts cp TIInit_7.6.15.bts /lib/firmware/TIInit_7.6.15.bts</code> </pre> <br><p>  Nous red√©marrons le contr√¥leur et nous nous reconnectons: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value root@trik-7dda93:~# hciattach /dev/ttyS0 texas Found a Texas Instruments' chip! Firmware file : /lib/firmware/TIInit_7.6.15.bts Loaded BTS script version 1 Device setup complete</span></span></code> </pre> <br><p>  Hourra!  Le firmware a d√©marr√©.  V√©rification de hciconfig: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># hciconfig hci0: Type: BR/EDR Bus: UART BD Address: 78:**:**:**:**:B3 ACL MTU: 1021:4 SCO MTU: 180:4 DOWN RX bytes:509 acl:0 sco:0 events:21 errors:0 TX bytes:388 acl:0 sco:0 commands:21 errors:0</span></span></code> </pre> <br><p>  Nous d√©marrons le service bluetoothd, recherchons des appareils et d√©tectons notre module: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># bluetoothd -n &amp; [1] 4689 bluetoothd[4689]: Bluetooth daemon 4.101 bluetoothd[4689]: Starting SDP server bluetoothd[4689]: Bluetooth Management interface initialized bluetoothd[4689]: Parsing /etc/bluetooth/serial.conf failed: No such file or directory bluetoothd[4689]: Could not get the contents of DMI chassis type bluetoothd[4689]: Adapter /org/bluez/4689/hci0 has been enabled root@trik-7dda93:~# hciconfig hci0 piscan</span></span></code> </pre> <br><p>  Une recherche informatique trouve un appareil: </p><br><p><img src="https://habrastorage.org/webt/vs/bz/mb/vsbzmb32vz8tbechhhpuroku9qs.png"></p><br><p>  Pour activer Bluetooth, vous pouvez cr√©er un script: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash case "$1" in start) echo 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value bluetoothd -n &amp; hciattach /dev/ttyS0 texas hciconfig hci0 piscan ;; stop) ;; restart) ;; status) ;; *) ;;</span></span></code> </pre> <br><p>  Et ajoutez-le √† l'ex√©cution automatique: </p><br><pre> <code class="bash hljs">cp init-bluetooth /etc/init.d/init-bluetooth update-rc.d init-bluetooth <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> 99</code> </pre> <br><p>  Le red√©marrage et l'arr√™t du module se comportent de fa√ßon impr√©visible, donc les options d'arr√™t et de red√©marrage n'ont pas de commandes. </p><br><h1 id="etap-3-proverka-svyazi">  √âtape 3. V√©rification de la communication </h1><br><p>  Le moyen le plus simple de v√©rifier la communication dans les deux sens est le service de port COM.  Avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quelques commandes,</a> allumez-le: </p><br><pre> <code class="bash hljs">root@trik-7dda93:~<span class="hljs-comment"><span class="hljs-comment"># sdptool add --channel=3 SP Serial Port service registered root@trik-7dda93:~# mknod -m 666 /dev/rfcomm0 c 216 0 root@trik-7dda93:~# rfcomm watch /dev/rfcomm0 3 /sbin/getty rfcomm0 115200 linux Waiting for connection on channel 3</span></span></code> </pre> <br><p>  Nous nous connectons depuis le t√©l√©phone et voyons une invitation √† entrer dans le syst√®me: </p><br><p><img src="https://habrastorage.org/webt/0i/lw/p9/0ilwp9kassasp_xfmvc3xhcwvl8.png"></p><br><p>  Aucun des terminaux test√©s ne permettait d'entrer un mot de passe utilisateur vide, j'ai donc d√ª envoyer des informations de connexion √† l'aide de la redirection de thread dans une session SSH. </p><br><h1 id="etap-4-configure--make">  √âtape 4. ./configure &amp;&amp; make </h1><br><p>  En suivant les instructions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pour connecter une manette de jeu √† Linux,</a> nous rencontrons les probl√®mes suivants: </p><br><ul><li>  BlueZ dans la distribution est obsol√®te et ne comprend pas les commandes du d√©mon sixad, qui √©tablit une connexion avec la manette de jeu </li><li>  La nouvelle version BlueZ de la source refuse de compiler en raison de nombreuses d√©pendances </li><li>  La nouvelle BlueZ de Debian n√©cessite udev et systemd, qui sont absents de la distribution actuelle </li></ul><br><p>  La seule d√©pendance qui a pu satisfaire √©tait le module du noyau uinput. </p><br><p>  Pour ce faire: </p><br><ul><li>  obtenir la configuration du noyau actuel sur l'appareil </li></ul><br><pre> <code class="bash hljs">cp /proc/config.gz config.gz gunzip config.gz</code> </pre> <br><ul><li>  t√©l√©charger le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">code du noyau</a> </li><li>  t√©l√©charger et installer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne d'outils</a> </li><li>  copiez la configuration du noyau dans le dossier avec le code du noyau </li><li>  ajouter le module uinput √† la configuration </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"CONFIG_INPUT_UINPUT=m"</span></span> &gt;&gt; config</code> </pre> <br><ul><li>  d√©marrer l'assemblage en allumant d'abord la cha√Æne d'outils </li></ul><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /opt/trik-sdk/environment-setup-arm926ejste-oe-linux-gnueabi make</code> </pre> <br><ul><li>  copier les modules du noyau sur la carte m√©moire </li></ul><br><pre> <code class="bash hljs">make INSTALL_MOD_PATH=/mnt/trik-sd modules_install</code> </pre> <br><ul><li>  construire l'image uBoot et la copier dans / boot </li></ul><br><pre> <code class="bash hljs">make uImage cp arch/arm/boot/uImage /mnt/trik-sd/boot/uImage-3.6.7</code> </pre> <br><p>  Maintenant, le programme ne jure pas sur l'absence d'un module noyau, mais nous ne pouvons rien faire.  Les instructions pour la manette de jeu vous seront utiles plus tard. </p><br><h1 id="etap-5-varim-kashu-iz-topora">  √âtape 5. Cuire la bouillie de la hache </h1><br><p>  Arriver au plan "tyap-blooper".  Puisqu'il n'y a aucun moyen pratique de mettre les programmes n√©cessaires sur la distribution d'origine, nous mettrons quelque chose de populaire.  Le processeur a une architecture ARMv5TE, ce qui signifie qu'il existe des distributions pour lui. </p><br><p>  Nous essayons de d√©compresser et d'ex√©cuter Arch Linux universel pour ARM et lors du chargement dans la console, nous voyons que systemd n√©cessite une version de noyau plus r√©cente, que nous n'avons pas.  Les tentatives de transfert du noyau 4.16 ont √©chou√© et cela a pris trop de temps. </p><br><p>  Nous passons √† une autre option - Debian.  Une image disque avec un syst√®me install√© pour ARM existe, mais il est pr√©f√©rable de mettre un syst√®me propre avec les packages et les param√®tres n√©cessaires pour nous. </p><br><h2 id="ustanovka-v-qemu">  Installation dans QEMU </h2><br><p>  T√©l√©chargez l'image d'installation (lien vers <a href="">.iso</a> ) et installez QEMU. <br>  Nous avons √©galement besoin du noyau et de l'image initrd pour d√©marrer l'installation, qui peut √™tre t√©l√©charg√©e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><p>  Cr√©ez une image d'une carte m√©moire avec la taille d'une vraie carte m√©moire (dans ce cas 4 Go): </p><br><pre> <code class="bash hljs">qemu-img create -f raw debian.img 4G</code> </pre> <br><p>  Nous commen√ßons l'installation: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.gz -hda debian.img -cdrom debian-7.11.0-armel-CD-1.iso</code> </pre> <br><p>  Si vous souhaitez cr√©er une disposition de disque d'une distribution d'origine relative non standard, laissez d'abord la partition racine, sinon vous devrez modifier les param√®tres de d√©marrage du noyau dans uBoot.  Il y a le num√©ro de la partition sur laquelle se trouve le syst√®me de fichiers racine. </p><br><p>  Le balisage standard contient: </p><br><ol><li>  Partition EXT4 pour un syst√®me de fichiers racine de 1,3 Go </li><li>  Partition FAT32 pour le stockage des donn√©es utilisateur d'une taille de 500 Mo </li></ol><br><p>  La sortie fdisk pour l'image de la distribution d'origine: </p><br><pre> <code class="hljs powershell">Disk: trik<span class="hljs-literal"><span class="hljs-literal">-distro</span></span>.img geometry: <span class="hljs-number"><span class="hljs-number">893</span></span>/<span class="hljs-number"><span class="hljs-number">64</span></span>/<span class="hljs-number"><span class="hljs-number">63</span></span> [<span class="hljs-number"><span class="hljs-number">3604478</span></span> <span class="hljs-type"><span class="hljs-type">sectors</span></span>] Signature: <span class="hljs-number"><span class="hljs-number">0</span></span>xAA55 Starting Ending <span class="hljs-comment"><span class="hljs-comment">#: id cyl hd sec - cyl hd sec [ start - size] ------------------------------------------------------------------------ 1: 83 1023 3 32 - 1023 3 32 [ 1040382 - 2564096] Linux files* 2: 0C 64 0 1 - 1023 3 32 [ 8192 - 1032190] Win95 FAT32L 3: 00 0 0 0 - 0 0 0 [ 0 - 0] unused 4: 00 0 0 0 - 0 0 0 [ 0 - 0] unused</span></span></code> </pre><br><p>  Apr√®s avoir r√©gl√© les param√®tres, nous partons boire quelques tasses de th√©, car  l'√©mulateur n'est pas beaucoup plus rapide qu'un vrai processeur ARM. </p><br><p>  Pour d√©marrer le syst√®me install√©, vous avez besoin d'une autre image initrd, qui peut √™tre prise √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partir d'ici</a> . </p><br><p>  Nous d√©marrons le syst√®me: </p><br><pre> <code class="bash hljs">qemu-system-arm -M versatilepb -kernel vmlinuz-3.2.0-4-versatile -initrd initrd.img-3.2.0-4-versatile -hda debian.img -append <span class="hljs-string"><span class="hljs-string">"root=/dev/sda1"</span></span></code> </pre> <br><h2 id="nastroyka-sistemy">  Configuration du syst√®me </h2><br><p>  Apr√®s le d√©marrage, nous entrons dans le superutilisateur, v√©rifions la connexion √† Internet, mettons √† jour les r√©f√©rentiels et le syst√®me, mettons le minimum de programmes: </p><br><pre> <code class="bash hljs">apt-get update apt-get upgrade apt-get install curl git mc htop joystick</code> </pre> <br><h3 id="terminaly">  Terminaux </h3><br><p>  Nous √©ditons <code>/etc/inittab</code> , <code>/etc/inittab</code> les terminaux inutiles, activons l'UART dont nous avons besoin pour nous et ajoutons une entr√©e automatique pour le bon utilisateur (utilisez root uniquement lors du d√©bogage).  La saisie automatique est utile si vous pr√©voyez d'ex√©cuter le shell pour le contr√¥le sur le contr√¥leur. </p><br><pre> <code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">2345</span></span><span class="hljs-symbol"><span class="hljs-symbol">:respawn</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/sbin/getty</span></span> <span class="hljs-number"><span class="hljs-number">38400</span></span> tty1 --autologin root <span class="hljs-comment"><span class="hljs-comment">#2:23:respawn:/sbin/getty 38400 tty2 #3:23:respawn:/sbin/getty 38400 tty3 #4:23:respawn:/sbin/getty 38400 tty4 #5:23:respawn:/sbin/getty 38400 tty5 #6:23:respawn:/sbin/getty 38400 tty6 uart:12345:respawn:/sbin/getty -L 115200 ttyS1</span></span></code> </pre> <br><h3 id="bluetooth-i-wi-fi">  Bluetooth et wifi </h3><br><p>  Installez bluez-utils et wpasupplicant pour acc√©der au Wi-Fi et au Bluetooth. </p><br><pre> <code class="bash hljs">apt-get install bluez-utils wpasupplicant</code> </pre> <br><p>  Nous d√©sactivons l'interface eth0 et configurons l'interface wlan1 dans <code>/etc/network/interfaces</code> : </p><br><pre> <code class="hljs kotlin"># /etc/network/interfaces -- configuration file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ifup(<span class="hljs-number"><span class="hljs-number">8</span></span>), ifdown(<span class="hljs-number"><span class="hljs-number">8</span></span>) # The loopback <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">lo</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loopback</span></span></span><span class="hljs-class"> # </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wireless</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interfaces</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">auto</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">iface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wlan1</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inet</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dhcp</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_mode</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">managed</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wireless_essid</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">driver</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wext</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span><span class="hljs-class"> /</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">etc</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">wpa_supplicant</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conf</span></span></span></span></code> </pre> <br><p>  Ajoutez le r√©seau √† l'avance √† <code>/etc/wpa_supplicant.conf</code> , car  faire cela sur le contr√¥leur lui-m√™me n'est pas si pratique: </p><br><pre> <code class="bash hljs">wpa_passphrase ssid password &gt;&gt; /etc/wpa_supplicant.conf</code> </pre> <br><p>  Si vous ne disposez pas d'un acc√®s Wi-Fi, vous pouvez utiliser UART pour une configuration suppl√©mentaire, mais gardez √† l'esprit que par d√©faut, le noyau affiche toutes les erreurs sur ce terminal.  Par cons√©quent, pendant le fonctionnement, un message soudain du noyau ou du service peut vous interrompre. </p><br><p>  Ajoutez un script pour activer Bluetooth.  Cette fois, modifiez <code>/etc/init.d/bluetooth</code> : </p><br><pre> <code class="bash hljs"> 139: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> start) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 1 &gt;&gt; /sys/devices/virtual/gpio/gpio107/value  168: hciattach /dev/ttyS0 texas log_end_msg 0 ;;</code> </pre><br><p>  Ainsi, tous les services qui n√©cessitent le service Bluetooth ex√©cuteront les commandes n√©cessaires pour s'initialiser. </p><br><h3 id="vzmah-vlevo-vzmah-vpravo">  Balayez vers la gauche, balayez vers la droite </h3><br><p>  Nous supprimons les programmes et services inutiles qui peuvent √™tre affich√©s √† l'aide de htop, car ils occupent une place pr√©cieuse dans la RAM: </p><br><p><img src="https://habrastorage.org/webt/4e/rg/av/4ergavw2trhiiyvvlnmdtc1luhk.png"></p><br><p>  Dans ce cas, le service ConsoleKit comporte de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nombreux processus</a> .  D√©placez le fichier de ce service vers le dossier racine en cas de r√©cup√©ration: </p><br><pre> <code class="bash hljs">mv /usr/share/dbus-1/system-services/org.freedesktop.ConsoleKit.service /root/</code> </pre> <br><p>  Avant d'arr√™ter le service, la consommation de RAM √©tait de 19 Mo, et apr√®s - 16 Mo. </p><br><h3 id="razdely-sistemy">  Sections syst√®me </h3><br><p>  Bien que uBoot transf√®re au noyau le p√©riph√©rique sur lequel se trouve la partition racine, cela vaut la peine de l'√©crire dans <code>/etc/fstab</code> pour plus de fiabilit√©.  Nous changeons la premi√®re ligne responsable de la section racine: </p><br><pre> <code class="hljs mel">/dev/mmcblk0p1 / auto defaults <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> devpts /dev/pts devpts mode=<span class="hljs-number"><span class="hljs-number">0620</span></span>,gid=<span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> usbdevfs /<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span>/bus/usb usbdevfs noauto <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /run tmpfs mode=<span class="hljs-number"><span class="hljs-number">0755</span></span>,nodev,nosuid,strictatime <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> tmpfs /var/volatile tmpfs defaults <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  Si vous n'avez pas cr√©√© la partition racine en premier, n'oubliez pas de sp√©cifier le num√©ro de partition souhait√©. </p><br><p>  Si vous avez laiss√© la deuxi√®me partition FAT pour les donn√©es utilisateur, vous devez cr√©er un dossier pour y monter la partition </p><br><pre> <code class="bash hljs">mkdir /usr/share/trik</code> </pre> <br><p>  et √©crivez la section dans <code>/etc/fstab</code> : </p><br><pre> <code class="bash hljs">/dev/mmcblk0p2 /usr/share/trik vfat defaults 0 0</code> </pre> <br><h1 id="etap-6-probuem-nashu-kashu">  √âtape 6. Nous essayons notre bouillie </h1><br><p>  Apr√®s avoir configur√© l'image syst√®me, vous devez la monter pour installer les modules du noyau et le noyau lui-m√™me: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ,     (start) fdisk -l debian.img mount -o loop,offset=NNNN debian.img /mnt/debian</span></span></code> </pre> <br><p>  o√π, NNNN = taille du secteur * d√©but de la section.  La taille de secteur par d√©faut est de 512 octets. </p><br><p>  Nous montons √©galement la distribution d'origine: </p><br><pre> <code class="bash hljs">fdisk -l trik-distro.img mount -o loop,offset=NNNN trik-distro.img /mnt/trik-clean</code> </pre> <br><p>  Nous supprimons le noyau pour QEMU et ses modules, comme  ils ne sont pas destin√©s √† notre plateforme.  Nous copions le nouveau noyau et les nouveaux modules, tout comme sur la distribution d'origine. </p><br><pre> <code class="hljs powershell">rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/boot/ rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-4</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> rm <span class="hljs-literal"><span class="hljs-literal">-rf</span></span> /mnt/debian/lib/modules/<span class="hljs-number"><span class="hljs-number">3.2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-versatile</span></span> mkdir /mnt/debian/boot/ cp arch/arm/boot/uImage /mnt/debian/boot/ make INSTALL_MOD_PATH=/mnt/debian modules_install</code> </pre> <br><p>  Nous aurons besoin d'un firmware pour le module Wi-Fi, qui se trouve dans la distribution d'origine dans le dossier / lib / firmware et le firmware Bluetooth que nous avons trouv√© plus t√¥t. </p><br><pre> <code class="hljs ruby">cp /mnt/trik-clean/lib/firmware/* <span class="hljs-regexp"><span class="hljs-regexp">/mnt/debian</span></span><span class="hljs-regexp"><span class="hljs-regexp">/lib/firmware</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ cp TIInit_7.6.15.bts /mnt</span></span><span class="hljs-regexp"><span class="hljs-regexp">/debian/lib</span></span><span class="hljs-regexp"><span class="hljs-regexp">/firmware/</span></span></code> </pre> <br><p>  D√©connectez les images de disque: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">umount</span></span> /mnt/trik-clean umount /mnt/debian</code> </pre> <br><p>  Et commencez √† copier l'image sur la carte m√©moire √† l'aide de dd: </p><br><pre> <code class="hljs cs"><span class="hljs-meta"><span class="hljs-meta">#    ( ) lsblk dd </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">=debian.img of=/dev/sdX bs=4M</span></span></code> </pre> <br><h1 id="etap-7-finishnaya-pryamaya">  √âtape 7. La ligne d'arriv√©e </h1><br><p>  Nous compilons les programmes de connexion de la manette de jeu sur le nouveau syst√®me et installons le d√©mon sixad. </p><br><p>  Nous connectons la manette de jeu via USB au contr√¥leur et ex√©cutons le programme pour cr√©er une paire: </p><br><pre> <code class="bash hljs">root@trik:~/bt<span class="hljs-comment"><span class="hljs-comment"># ./sixpair Current Bluetooth master: 78:**:**:**:**:b9 Setting master bd_addr to 78:**:**:**:**:b9</span></span></code> </pre> <br><p>  Lorsque la manette de jeu est connect√©e, rien ne se passe et le service sixad est silencieux: </p><br><pre> <code class="bash hljs">sixad-bin[2675]: started sixad-bin[2675]: sixad started, press the PS button now sixad-bin[2675]: unable to connect to sdp session</code> </pre> <br><p>  Mais la communaut√© Raspberry Pi a d√©j√† fait une ¬´b√©quille¬ª pour r√©parer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">connexion</a> . </p><br><p>  Nous reconstruisons le programme et nous nous r√©jouissons. </p><br><pre> <code class="hljs powershell">sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: sixad started, press the PS button now sixad<span class="hljs-literal"><span class="hljs-literal">-bin</span></span>[<span class="hljs-number"><span class="hljs-number">2833</span></span>]: unable to connect to sdp session sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: started sixad<span class="hljs-literal"><span class="hljs-literal">-sixaxis</span></span>[<span class="hljs-number"><span class="hljs-number">2836</span></span>]: Connected <span class="hljs-string"><span class="hljs-string">'PLAYSTATION(R)3 Controller (00:**:**:**:**:09)'</span></span> [<span class="hljs-type"><span class="hljs-type">Battery</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span>]</code> </pre> <br><p>  Maintenant, la manette de jeu est disponible pour le syst√®me en tant que p√©riph√©rique d'entr√©e et le programme jstest affichera l'√©tat de tous les boutons et capteurs analogiques: </p><br><pre> <code class="hljs apache"><span class="hljs-attribute"><span class="hljs-attribute">root</span></span>@trik:~# ls /dev/input/ by-path event0 event1 event2 event3 js0 js1 js2 mice root@trik:~# jstest --normal /dev/input/jsX Driver version is 2.1.0. Joystick (PLAYSTATION(R)3 Controller (00:**:**:**:**:09)) has 29 axes (X, Y, Z, Rx, Ry, Rz, Throttle, Rudder, Wheel, Gas, Brake, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, (null), (null), (null), (null), (null), (null), (null), (null)) and 17 buttons (Trigger, ThumbBtn, ThumbBtn2, TopBtn, TopBtn2, PinkieBtn, BaseBtn, BaseBtn2, BaseBtn3, BaseBtn4, BaseBtn5, BaseBtn6, BtnDead, BtnA, BtnB, BtnC, BtnX). Testing ... (interrupt to exit) Axes: 0: 0 1: 0 2: 0 3: 0 4: -7150 5: -7746 6:-32767 7: 0 8: 0 9: 0 10: 0 11: 0 12: 0 13: 0 14: 0 15: 0 16: 0 17: 0 18: 0 19: 0 20: 0 21: 0 22: 0 23: 0 24: 0 25: 0 26: 0 27: 0 28: 0 Buttons: 0:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 1:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 2:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 3:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 4:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 5:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 6:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 7:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 8:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 9:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 10:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 11:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 12:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 13:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 14:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 15:<span class="hljs-literal"><span class="hljs-literal">off</span></span> 16:<span class="hljs-literal"><span class="hljs-literal">off</span></span></code> </pre> <br><p>  o√π X est le num√©ro de p√©riph√©rique dans le syst√®me, par d√©faut - 2. Le nombre de boutons et d'axes peut √™tre affich√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><h1 id="ispolzuem-na-praktike">  Utilisation en pratique </h1><br><p>  Vid√©o montrant la manette de jeu sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">YouTube</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Photos de la distribution</b> <div class="spoiler_text"><p>  Chargement du noyau: <br><img src="https://habrastorage.org/webt/aj/mx/xt/ajmxxtarcapbe4hwfefj5-v83ws.jpeg"><br>  Terminal fonctionnant sur X11: <br><img src="https://habrastorage.org/webt/bi/gn/vk/bignvkyajckcuobz8rzgyf5priw.jpeg"></p><br><p><img src="https://habrastorage.org/webt/cp/6k/pu/cp6kpumd7uxcxnlyc3jg7mpmn2m.jpeg"><br>  Et selon la tradition: <br><img src="https://habrastorage.org/webt/9f/et/xk/9fetxkfu74mdacfatuwnaodrmj8.jpeg"></p><br><p><img src="https://habrastorage.org/webt/qw/mi/1h/qwmi1hncq77acchz8dfjfpzs334.jpeg"></p></div></div><br><h3 id="poleznye-ssylki">  Liens utiles </h3><br><p>  Programmes pour connecter la manette Dualshock 3 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">six paires</a> et <a href="">sixad</a> . </p><br><p>  Pour les manettes de jeu et autres p√©riph√©riques d'entr√©e, il existe une biblioth√®que C l√©g√®re - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">libenjoy</a> . </p><br><p>  Le code source du programme de contr√¥le des servomoteurs et des moteurs est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le r√©f√©rentiel GitHub</a> . </p><br><p>  Tous les fichiers de configuration de l'article pour un kit de distribution de fortune sont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le r√©f√©rentiel GitHub</a> . </p><br><p>  La source du noyau est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le r√©f√©rentiel GitHub</a> . </p><br><h1 id="interesnye-fakty-o-kontrollere">  Faits int√©ressants sur le contr√¥leur </h1><br><ul><li>  La sp√©cification indique que la RAM est de 256 Mo.  Mais si vous ex√©cutez htop, vous verrez que seulement 128 Mo sont disponibles.  Ceci est limit√© par les options du noyau qui peuvent √™tre affich√©es dans la console uBoot: </li></ul><br><pre> <code class="bash hljs">mem=128M console=ttyS1,115200n8 rw noinitrd rootwait root=/dev/mmcblk0p1 vt.global_cursor_default=0 consoleblank=0</code> </pre> <br><p>  La puce m√©moire est marqu√©e 3PC22 D9MTD fabriqu√©e par Micron.  Il n'a pas √©t√© possible de trouver des informations sur son volume actuel. </p><br><ul><li>  uBoot est stock√© sur une m√©moire flash SPI dans laquelle le noyau est √©galement c√¢bl√© et n'est pas utilis√©.  Vous pouvez essayer d'utiliser cet endroit pour vos t√¢ches ou copier un nouveau noyau et reconfigurer uBoot pour qu'il l'utilise. </li></ul><br><p>  Adresses d'images de dmesg: </p><br><pre> <code class="bash hljs">[ 11.598170] 0x000000000000-0x000000040000 : <span class="hljs-string"><span class="hljs-string">"uboot"</span></span> [ 11.642985] 0x000000040000-0x000000080000 : <span class="hljs-string"><span class="hljs-string">"uboot-env1"</span></span> [ 11.706256] 0x000000080000-0x0000000c0000 : <span class="hljs-string"><span class="hljs-string">"uboot-env2"</span></span> [ 11.761827] 0x0000000c0000-0x000000100000 : <span class="hljs-string"><span class="hljs-string">"config-periph"</span></span> [ 11.805129] 0x000000100000-0x000000400000 : <span class="hljs-string"><span class="hljs-string">"kernel"</span></span> [ 11.861864] 0x000000400000-0x000001000000 : <span class="hljs-string"><span class="hljs-string">"RootFS"</span></span></code> </pre> <br><ul><li>  L'√©cran du contr√¥leur, bien que petit, poss√®de en fait un capteur r√©sistif.  On ignore si le capteur lui-m√™me est connect√©. </li><li>  Dualshock 3 a des LED sur le connecteur USB qui indiquent le num√©ro de la manette de jeu / joystick.  Il y a un gamepad dans la vid√©o, mais son num√©ro est 3. Ce n'est pas une erreur, car  il y a deux autres ¬´joysticks¬ª dans le syst√®me: un acc√©l√©rom√®tre et un gyroscope. </li></ul><br><h1 id="problemy-voznikshie-pri-ispolzovanii">  Probl√®mes rencontr√©s lors de l'utilisation </h1><br><ul><li>  Le robot se bloque parfois fermement, sans √©teindre les servomoteurs, ce qui leur permet de changer leur position du bruit sur la ligne de donn√©es.  Cela a √©t√© vu m√™me sur une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">distribution standard</a> . </li><li>  L'inclusion de contr√¥leurs PWM est diff√©rente de ce qui est √©crit dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation</a> .  Au moins en C pur, cela n'a pas fonctionn√©. </li><li>  L'USB cesse parfois de fonctionner sur Debian. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr415007/">https://habr.com/ru/post/fr415007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414997/index.html">ML-Blitz: analyse des t√¢ches du premier tour de qualification</a></li>
<li><a href="../fr414999/index.html">Watchman 3D et testeur de thermistance</a></li>
<li><a href="../fr415001/index.html">L'op√©rateur de la voiture robotique Uber, qui a abattu un cycliste, a regard√© l'√©mission Voice au moment de la collision</a></li>
<li><a href="../fr415003/index.html">T√©l√©chargement de fichiers sans restriction sur Apple.com</a></li>
<li><a href="../fr415005/index.html">Panneaux solaires, commandes vocales et course tout-terrain: le pr√©sent et l'avenir des v√©los √©lectriques</a></li>
<li><a href="../fr415009/index.html">Qui est √ßa en Am√©rique du Nord Recrutement - Partie 1</a></li>
<li><a href="../fr415011/index.html">Rapport du Club de Rome 2018, chapitre 3.10: ¬´Taxe sur les battements¬ª</a></li>
<li><a href="../fr415015/index.html">√âvaluation des employeurs informatiques √† Nijni Novgorod: une √©tude des pr√©f√©rences des √©tudiants des sp√©cialit√©s techniques</a></li>
<li><a href="../fr415017/index.html">Produit .NET qui sauve des vies</a></li>
<li><a href="../fr415019/index.html">Marketing. √Ä peu pr√®s compliqu√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>