<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌪️ 👧🏿 🤚 Berbuat Baik, Berbuat Buruk: Menulis Kode Jahat dengan Go, Bagian 2 🧛 🌱 🔻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tips Buruk untuk Programer Go 



 Di bagian pertama publikasi, saya menjelaskan cara menjadi programmer Go "jahat". Kejahatan datang dalam banyak ben...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Berbuat Baik, Berbuat Buruk: Menulis Kode Jahat dengan Go, Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460911/">  <i><b>Tips Buruk untuk Programer Go</b></i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8cc/265/872/8cc265872daa29a415c830378896ad61.png" alt="gambar"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Di bagian pertama publikasi,</a> saya menjelaskan cara menjadi programmer Go "jahat".  Kejahatan datang dalam banyak bentuk, tetapi dalam pemrograman itu terletak pada kesulitan yang disengaja untuk memahami dan memelihara kode.  Program jahat mengabaikan sarana dasar bahasa yang mendukung teknik yang memberikan manfaat jangka pendek dengan imbalan masalah jangka panjang.  Sebagai pengingat singkat, “praktik” jahat Go termasuk: <br><br><ul><li>  Paket tidak bernama dan terorganisir </li><li>  Antarmuka tidak terorganisir dengan benar </li><li>  Melewati pointer ke variabel dalam fungsi untuk mengisi nilainya </li><li>  Menggunakan panik bukannya kesalahan </li><li>  Menggunakan fungsi init dan mengosongkan impor untuk mengkonfigurasi dependensi </li><li>  Unduh file konfigurasi menggunakan fungsi init </li><li>  Menggunakan kerangka kerja alih-alih perpustakaan </li></ul><br><h3>  Bola kejahatan yang besar </h3><br>  Apa yang terjadi jika kita menggabungkan semua praktik kejahatan kita?  Kami akan memiliki kerangka kerja yang akan menggunakan banyak file konfigurasi, mengisi bidang struktur menggunakan pointer, mendefinisikan antarmuka untuk menggambarkan jenis yang dipublikasikan, mengandalkan kode "ajaib" dan panik setiap kali terjadi masalah. <br><br>  Dan saya berhasil.  Jika Anda membuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/evil-go</a> , Anda akan melihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Fall</a> , kerangka kerja DI yang memungkinkan Anda untuk menerapkan praktik "jahat" apa pun yang Anda inginkan.  Saya telah menyolder Fall dengan kerangka kerja Outboy kecil yang mengikuti prinsip yang sama. <br><br>  Anda mungkin bertanya betapa jahatnya mereka?  Ayo lihat.  Saya sarankan pergi untuk program Go sederhana (ditulis menggunakan praktik terbaik) yang menyediakan titik akhir http.  Dan kemudian menulis ulang menggunakan Fall and Outboy. <br><a name="habracut"></a><br><h3>  Praktik terbaik </h3><br>  Program kami terletak pada satu paket yang disebut sapa, yang menggunakan semua fungsi dasar untuk mengimplementasikan titik akhir kami.  Karena ini adalah contoh, kami menggunakan kerja dalam memori DAO, dengan tiga bidang untuk nilai yang akan kami kembalikan.  Kami juga akan memiliki metode yang, tergantung pada input, menggantikan panggilan ke database kami dan mengembalikan salam yang diinginkan. <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> greet <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Dao <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { DefaultMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> BobMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> JuliaMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sdi Dao)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GreetingForName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, error)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> name { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Bob"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdi.BobMessage, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Julia"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdi.JuliaMessage, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdi.DefaultMessage, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } }</code> </pre> <br>  Berikutnya adalah logika bisnis.  Untuk mengimplementasikannya, kami menetapkan struktur untuk menyimpan data output, antarmuka GreetingFinder untuk menggambarkan apa yang dicari logika bisnis di tingkat pencarian data, dan struktur untuk menyimpan logika bisnis itu sendiri dengan bidang untuk GreetingFinder.  Logikanya sebenarnya sederhana - hanya memanggil GreetingFinder dan menangani kesalahan yang mungkin terjadi. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Response <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Message <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GreetingFinder <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { GreetingForName(name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, error) } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Service <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { GreetingFinder GreetingFinder } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ssi Service)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Greeting</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Response, error)</span></span></span></span> { msg, err := ssi.GreetingFinder.GreetingForName(name) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Response{}, err } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Response{Message: msg}, <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  Kemudian datang lapisan web, dan untuk bagian ini kita mendefinisikan antarmuka Greeter, yang menyediakan semua logika bisnis yang kita butuhkan, serta struktur yang berisi http handler yang dikonfigurasi dengan Greeter.  Kemudian kami membuat metode untuk mengimplementasikan antarmuka http.Handler, yang membagi permintaan http, memanggil greeter-a (ucapan), memproses kesalahan, dan mengembalikan hasilnya. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Greeter <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Greeting(name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) (Response, error) } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Controller <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Greeter Greeter } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mc Controller)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ServeHTTP</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rw http.ResponseWriter, req *http.Request)</span></span></span></span> { result, err := mc.Greeter.Greeting( req.URL.Query().Get(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { rw.WriteHeader(http.StatusInternalServerError) rw.Write([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(err.Error())) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } rw.Write([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(result.Message)) }</code> </pre> <br>  Ini adalah akhir dari paket salam.  Selanjutnya, kita akan melihat bagaimana pengembang Go yang "baik" akan menulis utama untuk menggunakan paket ini.  Dalam paket utama, kita mendefinisikan struktur yang disebut Config, yang berisi properti yang perlu kita jalankan.  Fungsi utama kemudian melakukan 3 hal. <br><br><ul><li>  Pertama, ia memanggil fungsi loadProperties, yang menggunakan pustaka sederhana ( <a href="">https://github.com/evil-go/good-sample/blob/master/config/config.go</a> ) untuk memuat properti dari file konfigurasi dan menempatkannya dalam salinan konfigurasi kami.  Jika unduhan konfigurasi gagal, fungsi utama melaporkan kesalahan dan keluar. </li><li>  Kedua, fungsi utama mengikat komponen-komponen dalam paket ucapan, secara eksplisit menetapkan nilai-nilai dari konfigurasi dan mengatur dependensi. </li><li>  Ketiga, ia memanggil perpustakaan server kecil ( <a href="">https://github.com/evil-go/good-sample/blob/master/server/server.go</a> ) dan meneruskan alamat, metode HTTP, dan http.Handler ke endpoint untuk pemrosesan permintaan.  Panggilan perpustakaan meluncurkan layanan web.  Dan ini adalah seluruh aplikasi kita. </li></ul><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { DefaultMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> BobMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> JuliaMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Path <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { c, err := loadProperties() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { fmt.Println(err) os.Exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } dao := greet.Dao{ DefaultMessage: c.DefaultMessage, BobMessage: c.BobMessage, JuliaMessage: c.JuliaMessage, } svc := greet.Service{GreetingFinder: dao} controller := greet.Controller{Greeter: svc} err = server.Start(server.Endpoint{c.Path, http.MethodGet, controller}) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { fmt.Println(err) os.Exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } }</code> </pre> <br>  Contohnya cukup singkat, tetapi ini menunjukkan betapa kerennya Go ditulis;  beberapa hal ambigu, tetapi secara umum jelas apa yang terjadi.  Kami merekatkan perpustakaan kecil yang secara khusus diatur untuk bekerja bersama.  Tidak ada yang disembunyikan;  siapa pun dapat mengambil kode ini, memahami bagaimana bagian-bagiannya terhubung bersama, dan jika perlu ulang ke yang baru. <br><br><h3>  Bintik hitam </h3><br>  Sekarang kita akan mempertimbangkan versi Fall and Outboy.  Hal pertama yang akan kita lakukan adalah memecah paket ucapan menjadi beberapa paket, yang masing-masing berisi satu lapisan aplikasi.  Ini adalah paket DAO.  Impor Fall, kerangka DI kami, dan karena kita "jahat" dan mendefinisikan hubungan dengan antarmuka sebaliknya, kita akan mendefinisikan antarmuka yang disebut GreetDao.  Harap dicatat - kami telah menghapus semua tautan ke kesalahan;  jika ada yang salah, kami hanya panik.  Pada titik ini, kami sudah memiliki kemasan yang buruk, antarmuka yang buruk, dan bug yang buruk.  Awal yang bagus! <br><br>  Kami sedikit mengubah nama struktur kami dari contoh yang baik.  Fields sekarang memiliki tag struct;  mereka digunakan untuk membuat Fall menetapkan nilai terdaftar di bidang.  Kami juga memiliki fungsi init untuk paket kami, yang dengannya kami mengumpulkan "kekuatan jahat".  Dalam fungsi init paket, kami memanggil Fall dua kali: <br><br><ul><li>  Setelah mendaftarkan file konfigurasi yang memberikan nilai untuk tag struktur. </li><li>  Dan yang lainnya, untuk mendaftarkan pointer ke instance dari struktur.  Fall akan dapat mengisi kolom ini untuk kami dan membuat DAO tersedia untuk digunakan oleh kode lain. </li></ul><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> dao <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/fall"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GreetDao <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { GreetingForName(name <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> greetDaoImpl <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { DefaultMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`value:"message.default"`</span></span> BobMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`value:"message.bob"`</span></span> JuliaMessage <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`value:"message.julia"`</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(gdi greetDaoImpl)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GreetingForName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> name { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Bob"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gdi.BobMessage <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Julia"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gdi.JuliaMessage <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gdi.DefaultMessage } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fall.RegisterPropertiesFile(<span class="hljs-string"><span class="hljs-string">"dao.properties"</span></span>) fall.Register(&amp;greetDaoImpl{}) }</code> </pre> <br>  Mari kita lihat paket layanannya.  Ia mengimpor paket DAO karena perlu akses ke antarmuka yang ditentukan di sana.  Paket layanan juga mengimpor paket model, yang belum kami pertimbangkan - kami akan menyimpan tipe data kami di sana.  Dan kami mengimpor Fall, karena, seperti semua kerangka kerja "baik", ia menembus ke mana-mana.  Kami juga mendefinisikan antarmuka untuk layanan untuk memberikan akses ke lapisan web.  Sekali lagi, tanpa penanganan kesalahan. <br><br>  Implementasi layanan kami sekarang memiliki tag struktural dengan kawat.  Bidang bertanda kawat secara otomatis menghubungkan ketergantungannya ketika struktur terdaftar di musim gugur.  Dalam contoh kecil kami, jelas apa yang akan ditugaskan ke bidang ini.  Namun dalam program yang lebih besar, Anda hanya akan tahu bahwa di suatu tempat antarmuka GreetDao ini diimplementasikan, dan terdaftar di Musim Gugur.  Anda tidak dapat mengontrol perilaku ketergantungan. <br><br>  Berikutnya adalah metode layanan kami, yang telah sedikit dimodifikasi untuk mendapatkan struktur GreetResponse dari paket model, dan yang menghilangkan penanganan kesalahan.  Akhirnya, kami memiliki fungsi init dalam paket yang mendaftarkan instance layanan di Musim Gugur. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/fall"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/evil-sample/dao"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/evil-sample/model"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GreetService <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Greeting(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) model.GreetResponse } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> greetServiceImpl <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Dao dao.GreetDao <span class="hljs-string"><span class="hljs-string">`wire:""`</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ssi greetServiceImpl)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Greeting</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">model</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GreetResponse</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model.GreetResponse{Message: ssi.Dao.GreetingForName(name)} } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fall.Register(&amp;greetServiceImpl{}) }</code> </pre> <br>  Sekarang mari kita lihat paket model.  Tidak ada yang perlu dilihat.  Dapat dilihat bahwa model dipisahkan dari kode yang membuatnya, hanya untuk membagi kode menjadi beberapa lapisan. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GreetResponse <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Message <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> }</code> </pre> <br>  Dalam paket web kami memiliki antarmuka web.  Di sini kami mengimpor Fall dan Outboy, dan kami juga mengimpor paket layanan yang menjadi dasar paket web.  Karena framework hanya bekerja dengan baik bersama ketika mereka terintegrasi di belakang panggung, Fall memiliki kode khusus untuk memastikan bahwa itu dan Outboy bekerja bersama.  Kami juga mengubah struktur sehingga menjadi pengontrol untuk aplikasi web kami.  Dia memiliki dua bidang: <br><br><ul><li>  Yang pertama terhubung melalui Fall ke implementasi antarmuka GreetService dari paket layanan. </li><li>  Yang kedua adalah jalur untuk satu-satunya titik akhir web kami.  Ini diberikan nilai dari file konfigurasi yang terdaftar dalam fungsi init dari paket ini. </li></ul><br>  Handler http kami telah berganti nama menjadi GetHello dan sekarang bebas dari penanganan kesalahan.  Kami juga memiliki metode Init (dengan huruf kapital), yang tidak boleh dikacaukan dengan fungsi init.  Init adalah metode ajaib yang disebut untuk struktur yang terdaftar di Musim Gugur setelah mengisi semua bidang.  Di Init, kami memanggil Outboy untuk mendaftarkan controller dan titik akhir di jalur yang ditetapkan menggunakan Fall.  Melihat kode, Anda akan melihat path dan handler, tetapi metode HTTP tidak ditentukan.  Di Outboy, nama metode digunakan untuk menentukan metode HTTP mana yang ditanggapi oleh pawang.  Karena metode kami disebut GetHello, ia merespons permintaan GET.  Jika Anda tidak tahu aturan ini, Anda tidak akan dapat memahami permintaan apa yang dia jawab.  Benar, ini sangat jahat? <br><br>  Akhirnya, kita memanggil fungsi init untuk mendaftarkan file konfigurasi dan pengontrol di Musim Gugur. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> web <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/fall"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/outboy"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/evil-sample/service"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GreetController <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Service service.GreetService <span class="hljs-string"><span class="hljs-string">`wire:""`</span></span> Path <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`value:"controller.path.hello"`</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mc GreetController)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetHello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rw http.ResponseWriter, req *http.Request)</span></span></span></span> { result := mc.Service.Greeting(req.URL.Query().Get(<span class="hljs-string"><span class="hljs-string">"name"</span></span>)) rw.Write([]<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>(result.Message)) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mc GreetController)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { outboy.Register(mc, <span class="hljs-keyword"><span class="hljs-keyword">map</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>]<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>{ <span class="hljs-string"><span class="hljs-string">"GetHello"</span></span>: mc.Path, }) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fall.RegisterPropertiesFile(<span class="hljs-string"><span class="hljs-string">"web.properties"</span></span>) fall.Register(&amp;GreetController{}) }</code> </pre> <br>  Tetap hanya untuk menunjukkan bagaimana kita menjalankan program.  Dalam paket utama, kami menggunakan impor kosong untuk mendaftar Outboy dan paket web.  Dan fungsi utama memanggil fall.Start () untuk meluncurkan seluruh aplikasi. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( _ <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/evil-sample/web"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/fall"</span></span> _ <span class="hljs-string"><span class="hljs-string">"github.com/evil-go/outboy"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fall.Start() }</code> </pre> <br><h3>  Gangguan pada integumen </h3><br>  Dan ini dia, program lengkap yang ditulis menggunakan semua alat Go jahat kita.  Ini mimpi buruk.  Dia secara ajaib menyembunyikan bagaimana bagian-bagian dari program tersebut cocok bersama, dan membuatnya sangat sulit untuk memahami pekerjaannya. <br><br>  Namun, Anda harus mengakui bahwa ada sesuatu yang menarik tentang penulisan kode dengan Fall and Outboy.  Untuk program kecil, Anda bahkan bisa mengatakan itu adalah peningkatan.  Lihat betapa mudahnya mengkonfigurasi!  Saya dapat menghubungkan dependensi dengan hampir tanpa kode!  Saya mendaftarkan pawang untuk metode ini, hanya menggunakan namanya!  Dan tanpa penanganan kesalahan, semuanya terlihat sangat bersih! <br><br>  Begitulah cara kejahatan bekerja.  Sekilas, ini sangat menarik.  Tetapi ketika program Anda berubah dan tumbuh, semua keajaiban ini hanya mulai mengganggu, mempersulit pemahaman tentang apa yang terjadi.  Hanya ketika Anda benar-benar terobsesi dengan kejahatan barulah Anda menoleh ke belakang dan menyadari bahwa Anda terjebak. <br><br>  Untuk pengembang Java, ini mungkin terasa akrab.  Teknik-teknik ini dapat ditemukan di banyak kerangka kerja Java populer.  Seperti yang saya sebutkan sebelumnya, saya telah bekerja dengan Jawa selama lebih dari 20 tahun, mulai dari 1.0.2 pada tahun 1996.  Dalam banyak kasus, pengembang Java adalah yang pertama kali menemukan masalah dalam menulis perangkat lunak perusahaan berskala besar di era Internet.  Saya ingat saat ketika servlets, EJB, Spring, dan Hibernate baru saja muncul.  Keputusan yang dibuat pengembang Java saat itu masuk akal.  Tetapi selama bertahun-tahun, teknik ini menunjukkan usia mereka.  Bahasa yang lebih baru, seperti Go, dirancang untuk menghilangkan titik nyeri yang ditemukan saat menggunakan teknik yang lebih lama.  Namun, ketika pengembang Java mulai mempelajari Go dan menulis kode dengannya, mereka harus ingat bahwa mencoba mereproduksi pola dari Java akan menghasilkan hasil yang buruk. <br><br>  Go dirancang untuk pemrograman serius - untuk proyek yang menjangkau ratusan pengembang dan puluhan tim.  Tetapi untuk Go untuk melakukan ini, Anda harus menggunakannya dengan cara yang terbaik.  Kita dapat memilih untuk menjadi jahat atau baik.  Jika kita memilih yang jahat, kita dapat mendorong pengembang Go muda untuk mengubah gaya dan teknik mereka sebelum mereka memahami Go.  Atau kita bisa memilih yang baik.  Bagian dari pekerjaan kami sebagai pengembang Go adalah untuk mendidik Gophers muda (Gophers), untuk membantu mereka memahami prinsip-prinsip yang mendasari praktik terbaik kami. <br><br>  Satu-satunya kelemahan untuk mengikuti jalan kebaikan adalah bahwa Anda harus mencari cara lain untuk mengekspresikan kejahatan batin Anda.  <i>Mungkin mencoba mengemudi dengan kecepatan 30 km / jam di jalan raya federal?</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460911/">https://habr.com/ru/post/id460911/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460899/index.html">26 Juli, Deworkacy - DocOps dari Rostelecom</a></li>
<li><a href="../id460901/index.html">Mengapa Pengembang Senior Tidak Dapat Mendapatkan Pekerjaan</a></li>
<li><a href="../id460905/index.html">Pengetahuan SEO minimal untuk pengusaha</a></li>
<li><a href="../id460907/index.html">Menggunakan Liquibase untuk mengelola struktur database dalam aplikasi Spring Boot. Bagian 2</a></li>
<li><a href="../id460909/index.html">Apa yang akan kita makan pada tahun 2050</a></li>
<li><a href="../id460913/index.html">Tur foto museum Institut Fisika dan Energi di Obninsk</a></li>
<li><a href="../id460915/index.html">Sistem manajemen basis data yang nyaman</a></li>
<li><a href="../id460923/index.html">Tugas uji Yandex</a></li>
<li><a href="../id460925/index.html">Game online dengan robot RC asli di Chernobyl. Bagian 2</a></li>
<li><a href="../id460929/index.html">Atlassian Confluence: extensible dengan python</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>