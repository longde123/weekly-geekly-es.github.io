<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òïÔ∏è üî† üì∞ Implementa√ß√£o da interface do usu√°rio do OpenStack LBaaS üë∂üèΩ üôÉ ü§∂üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quando implementei a interface do usu√°rio do balanceador de carga para uma nuvem privada virtual, tive que enfrentar dificuldades significativas. Isso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementa√ß√£o da interface do usu√°rio do OpenStack LBaaS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/selectel/blog/455523/"><img src="https://habrastorage.org/webt/ct/q8/3-/ctq83--b7viz0r6evi5um6brnam.png"><br><br>  Quando implementei a interface do usu√°rio do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">balanceador de carga</a> para uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nuvem privada virtual,</a> tive que enfrentar dificuldades significativas.  Isso me levou a refletir sobre o papel do frontend, que quero compartilhar em primeiro lugar.  E justifique seus pensamentos, usando o exemplo de uma tarefa espec√≠fica. <br><br>  Na minha opini√£o, a solu√ß√£o para o problema acabou sendo bastante criativa e eu tive que procur√°-lo em uma estrutura muito limitada, ent√£o acho que pode ser interessante. <br><a name="habracut"></a><br><h2>  Fun√ß√£o de front-end </h2><br>  Devo dizer imediatamente que n√£o finjo a verdade e levanto uma quest√£o controversa.  Estou um pouco deprimido pela ironia do front-end e da web em particular, como algo insignificante.  E √© ainda mais deprimente que √†s vezes isso aconte√ßa razoavelmente.  Agora a moda j√° est√° adormecida, mas houve um tempo em que todos estavam andando com estruturas, paradigmas e outras entidades, eles disseram em voz alta que tudo isso √© super importante e super necess√°rio, e em troca eles receberam a ironia de que o front-end lida com a sa√≠da de formul√°rios e processar cliques nos bot√µes, o que pode ser feito ‚Äúno joelho‚Äù. <br><br>  Agora, ao que parece, tudo voltou mais ou menos ao normal.  Ningu√©m realmente quer falar sobre cada vers√£o menor do pr√≥ximo framework.  Poucas pessoas procuram a ferramenta ou abordagem perfeita, devido √† crescente conscientiza√ß√£o de sua utilidade.  Mas mesmo isso, por exemplo, n√£o interfere na repreens√£o quase irracional do Electron e nas aplica√ß√µes nele.  Acho que isso se deve √† falta de entendimento da tarefa que est√° sendo resolvida pelo front-end. <br><br>  O frontend n√£o √© apenas um meio de exibir informa√ß√µes fornecidas pelo back-end e n√£o apenas um meio de processar a√ß√µes do usu√°rio.  O frontend √© algo mais, algo abstrato, e se voc√™ der uma defini√ß√£o simples e clara, o significado ser√° inevitavelmente perdido. <br><br>  O frontend est√° em alguma "estrutura".  Por exemplo, em termos t√©cnicos, est√° entre a API fornecida pelo back-end e a API fornecida pelos recursos de E / S.  Em termos de tarefas, √© entre as tarefas da interface do usu√°rio que o UX resolve e as tarefas que o back-end resolve.  Assim, √© obtida uma especializa√ß√£o frontend bastante estreita, uma especializa√ß√£o da camada.  Isso n√£o significa que os provedores de front-end n√£o possam exercer influ√™ncia em √°reas fora de sua especializa√ß√£o, mas no momento em que essa influ√™ncia √© imposs√≠vel, surge a verdadeira tarefa de front-end. <br><br>  Este problema pode ser expresso atrav√©s de uma contradi√ß√£o.  N√£o √© necess√°rio que a interface do usu√°rio esteja em conformidade com os modelos de dados e o comportamento de back-end.  O comportamento e os modelos de dados do back-end n√£o s√£o necess√°rios para atender √†s tarefas da interface do usu√°rio.  E ent√£o a tarefa do front-end √© eliminar essa contradi√ß√£o.  Quanto maior a discrep√¢ncia entre as tarefas do back-end e a interface do usu√°rio, mais importante √© o papel do front-end.  E para deixar claro o que estou falando, darei um exemplo em que essa discrep√¢ncia, por alguma raz√£o, se mostrou significativa. <br><br><h2>  Declara√ß√£o do problema </h2><br>  O OpenStack LBaaS, na minha opini√£o, √© um complexo de ferramentas de hardware e software necess√°rio para equilibrar a carga entre servidores.  √â importante para mim que sua implementa√ß√£o dependa de fatores objetivos, da exibi√ß√£o f√≠sica.  Por esse motivo, existem algumas peculiaridades na API e nas maneiras de interagir com essa API. <br><br>  Ao desenvolver uma interface de usu√°rio, o principal interesse n√£o s√£o os recursos t√©cnicos do back-end, mas seus recursos fundamentais.  A interface √© criada para o usu√°rio, e o usu√°rio precisa de uma interface para gerenciar os par√¢metros de balanceamento, e o usu√°rio n√£o precisa se aprofundar nos recursos internos da implementa√ß√£o de back-end. <br><br>  O back-end √© em grande parte desenvolvido pela comunidade e √© poss√≠vel influenciar seu desenvolvimento em quantidades muito limitadas.  Um dos principais recursos para mim √© que os desenvolvedores de back-end est√£o prontos para sacrificar a conveni√™ncia e a simplicidade dos controles por uma quest√£o de desempenho, e isso √© absolutamente justificado, pois √© uma quest√£o de equilibrar a carga. <br><br>  H√° mais um ponto sutil, e quero descrev√™-lo imediatamente, alertando algumas perguntas.  √â claro que no OpenStack e em sua API a luz n√£o convergiu.  Voc√™ sempre pode desenvolver seu pr√≥prio conjunto de ferramentas ou uma "camada" que funcionar√° com a API do OpenStack, produzindo sua pr√≥pria API que √© conveniente para as tarefas do usu√°rio.  A √∫nica quest√£o √© a conveni√™ncia.  Se as ferramentas inicialmente dispon√≠veis permitem implementar a interface do usu√°rio como pretendida, faz sentido produzir entidades? <br><br>  A resposta a esta pergunta √© multifacetada e, para os neg√≥cios, depender√° de desenvolvedores, emprego, compet√™ncia, quest√µes de responsabilidade, suporte e assim por diante.  No nosso caso, foi mais conveniente resolver algumas das tarefas no front-end. <br><br><h3>  Recursos do OpenStack LBaaS </h3><br>  Quero identificar apenas os recursos que tiveram uma forte influ√™ncia no frontend.  As perguntas sobre por que esses recursos surgiram ou em que eles confiam j√° est√£o al√©m do escopo deste artigo. <br><br>  Trabalho com documenta√ß√£o pronta e tenho que aceitar seus recursos.  Quem estiver interessado no que √© o OpenStack Octavia, por dentro, pode se familiarizar com a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o oficial</a> .  Octavia √© o nome de um conjunto de ferramentas projetadas para equilibrar a carga no ecossistema OpenStack. <br><br>  O primeiro recurso que encontrei durante o desenvolvimento √© o grande n√∫mero de modelos e relacionamentos necess√°rios para exibir o estado do balanceador.  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">API Octavia</a> descreve 12 modelos, mas apenas o 7. √© necess√°rio para o lado do cliente.Esses modelos t√™m conex√µes, geralmente desnormalizadas, a imagem abaixo mostra um diagrama aproximado: <br><br><div style="text-align:center;"><img title="Exemplo de diagrama de modelos e relacionamentos OpenStack Octavia" src="https://habrastorage.org/webt/p2/fw/2v/p2fw2vvyascudv9zjx5a0m-5bkq.png"></div><br><br>  "Seven" n√£o parece muito impressionante, mas, na realidade, para garantir a opera√ß√£o completa da interface, no momento em que escrevi este texto, eu tive que usar 16 modelos de dados e cerca de 30 relacionamentos entre eles.  Como o Octavia √© apenas um balanceador, ele requer outros m√≥dulos do OpenStack para funcionar.  E tudo isso √© necess√°rio para apenas duas p√°ginas na interface do usu√°rio. <br><br>  O segundo e o terceiro recurso s√£o o Octavia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ass√≠ncrono</a> e transacional.  Os modelos de dados t√™m um campo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">status</a> que reflete o estado das opera√ß√µes executadas em um objeto. <br><div class="scrollable-table"><table><tbody><tr><th>  Status </th><th>  Descri√ß√£o do produto </th></tr><tr><td>  ATIVO </td><td>  Objeto em bom estado </td></tr><tr><td>  EXCLU√çDO </td><td>  Objeto exclu√≠do </td></tr><tr><td>  Erro </td><td>  O objeto est√° corrompido </td></tr><tr><td>  PENDING_CREATE </td><td>  Objeto em constru√ß√£o </td></tr><tr><td>  PENDING_UPDATE </td><td>  Objeto no processo de atualiza√ß√£o </td></tr><tr><td>  PENDING_DELETE </td><td>  Objeto no processo de exclus√£o </td></tr></tbody></table></div>  A opera√ß√£o de leitura de um objeto ocorre de forma s√≠ncrona e n√£o possui restri√ß√µes.  Mas as opera√ß√µes de cria√ß√£o, atualiza√ß√£o e exclus√£o podem levar um tempo indefinido.  Isso se deve precisamente ao fato de os modelos de dados terem, grosso modo, significado f√≠sico. <br><br>  Depois de enviar uma solicita√ß√£o de cria√ß√£o, podemos saber que o registro apareceu, podemos l√™-lo, mas at√© que a opera√ß√£o de cria√ß√£o seja conclu√≠da, n√£o podemos executar nenhuma outra opera√ß√£o nesse registro.  Qualquer tentativa resultar√° em erro.  A opera√ß√£o de altera√ß√£o de um objeto pode ser iniciada apenas quando o objeto estiver no status <b>ATIVO</b> ; voc√™ pode enviar um objeto para exclus√£o nos status <b>ATIVO</b> e <b>ERRO</b> . <br><br>  Esses status podem ser obtidos via WebSockets, o que facilita muito o processamento, mas as transa√ß√µes s√£o um problema muito maior.  Ao fazer altera√ß√µes em qualquer objeto, todos os modelos relacionados tamb√©m participar√£o da transa√ß√£o.  Por exemplo, ao fazer altera√ß√µes em <b>Membro</b> , o <b>Pool</b> , o <b>Ouvinte</b> e o <b>Loadbalancer</b> associados ser√£o bloqueados.  √â assim que se parece em termos de eventos recebidos em soquetes da web: <br><br><div style="text-align:center;"><img title="O processo de alterar o status de objetos relacionados." src="https://habrastorage.org/webt/ia/fp/ff/iafpffzblzikgdekdrrs83br1_y.png"></div><ul><li>  os quatro primeiros eventos s√£o a transfer√™ncia de objetos para o status <strong>PENDING_UPDATE</strong> : o campo de <strong>destino</strong> cont√©m o nome do modelo do objeto que participa da transa√ß√£o; </li><li>  o quinto evento √© apenas uma duplicata (n√£o sei com o que ele est√° conectado); </li><li>  os quatro √∫ltimos s√£o um retorno ao status <strong>ATIVO</strong> .  Nesse caso, √© uma opera√ß√£o de altera√ß√£o de peso e leva menos de um segundo, mas √†s vezes leva muito mais tempo. </li></ul><br>  Voc√™ tamb√©m pode ver na captura de tela que a ordem dos eventos n√£o precisa ser rigorosa.  Assim, verifica-se que, para iniciar qualquer opera√ß√£o, √© necess√°rio conhecer n√£o apenas o status do pr√≥prio objeto, mas tamb√©m o status de todas as depend√™ncias que tamb√©m participar√£o da transa√ß√£o. <br><br><h3>  Recursos da interface do usu√°rio </h3><br>  Agora imagine-se no lugar de um usu√°rio que precisa conhecer um local que seja para equilibrar entre dois servidores: <br><br><ol><li>  √â necess√°rio criar um ouvinte no qual o algoritmo de balanceamento ser√° definido. </li><li>  Crie um pool. </li><li>  Atribua um pool ao ouvinte. </li><li>  Adicione links para portas balanceadas no pool. </li></ol><br>  Cada vez √© necess√°rio aguardar a conclus√£o da opera√ß√£o, que depende de todos os objetos criados anteriormente. <br><br>  Como um estudo interno mostrou, na vis√£o do usu√°rio comum, existe apenas uma percep√ß√£o aproximada de que o balanceador deve ter um ponto de entrada, deve haver pontos de sa√≠da e os par√¢metros do balanceamento a serem realizados: algoritmo, peso e outros.  O usu√°rio n√£o precisa saber o que √© o OpenStack. <br><br>  N√£o sei o qu√£o complicada a interface deve ser para a percep√ß√£o, onde o pr√≥prio usu√°rio deve seguir todos os recursos t√©cnicos do back-end descrito acima.  Para o console, isso pode ser permitido, pois seu uso implica um alto n√≠vel de imers√£o em tecnologia, mas para a web essa interface √© horr√≠vel. <br><br>  Na web, o usu√°rio espera preencher um formul√°rio claro e l√≥gico, pressionar um bot√£o, aguardar e tudo funcionar√°.  Talvez isso possa ser discutido, mas proponho me concentrar nos recursos que afetam a implementa√ß√£o do frontend. <br><br>  A interface foi projetada de forma a envolver o uso em cascata de opera√ß√µes: uma a√ß√£o na interface pode envolver v√°rias opera√ß√µes.  A interface n√£o implica que o usu√°rio possa executar a√ß√µes que atualmente n√£o s√£o poss√≠veis, mas assume que o usu√°rio deve entender por que isso √© assim.  A interface √© um todo √∫nico e, portanto, seus elementos individuais podem usar informa√ß√µes de v√°rias entidades dependentes, incluindo meta-informa√ß√µes. <br><br><div style="text-align:center;"><img title="A interface da lista de balanceadores no painel Selectel" src="https://habrastorage.org/webt/cc/no/am/ccnoamyjre40swvpswygbqezn_w.png"></div><br><br>  Se levarmos em conta que existem alguns recursos da interface que n√£o s√£o exclusivos do balanceador, como op√ß√µes, acorde√µes, guias, um menu de contexto e assumimos que seus princ√≠pios operacionais s√£o claros inicialmente, acho que para um usu√°rio que sabe o que √© o balanceamento de carga, n√£o ser√° muito dif√≠cil ler a maior parte da interface acima e supor como gerenci√°-la.  Mas destacar quais partes da interface est√£o ocultas atr√°s dos modelos do balanceador, ouvinte, pool, membro e outras entidades n√£o √© mais a tarefa mais √≥bvia. <br><br><h3>  Resolvendo Contradi√ß√µes </h3><br>  Espero ter conseguido mostrar que os recursos do back-end n√£o se encaixam bem na interface e que esses recursos nem sempre podem ser eliminados pelo back-end.  Junto com isso, os recursos da interface n√£o se encaixam bem no back-end e nem sempre podem ser eliminados sem complicar a interface.  Cada uma dessas √°reas resolve seus pr√≥prios problemas.  A responsabilidade do front-end √© resolver problemas para garantir o n√≠vel necess√°rio de intera√ß√£o entre a interface e o back-end. <br><br>  Na minha pr√°tica, imediatamente corri para a piscina com a cabe√ßa, sem prestar aten√ß√£o, ou melhor, nem tentando descobrir os recursos mais altos, mas tive sorte ou a experi√™ncia ajudou (e o vetor correto foi escolhido).  Reparei repetidamente por mim mesmo que, ao usar uma API ou biblioteca de terceiros, √© muito √∫til se familiarizar com a documenta√ß√£o com anteced√™ncia: quanto mais detalhado, melhor.  A documenta√ß√£o geralmente √© semelhante entre si, as pessoas ainda confiam na experi√™ncia de outras pessoas, mas h√° uma descri√ß√£o dos recursos de cada sistema individual e est√° contida nos detalhes. <br><br>  Se eu passasse algumas horas extras estudando a documenta√ß√£o, em vez de extrair as informa√ß√µes necess√°rias por palavras-chave, teria pensado nos problemas que encontraria e esse conhecimento poderia ter um impacto na arquitetura do projeto desde os est√°gios iniciais.  Voltar para eliminar os erros cometidos no in√≠cio √© muito desmoralizante.  E sem um contexto completo, √†s vezes voc√™ precisa voltar v√°rias vezes. <br><br>  Como op√ß√£o, voc√™ pode dobrar sua linha, gerando gradualmente mais e mais c√≥digos "com uma mordida", mas quanto mais esse monte de c√≥digo for, mais ele ser√° processado no final.  Ao projetar a arquitetura, √© claro, n√£o se deve mergulhar muito fundo, levar em considera√ß√£o todas as op√ß√µes poss√≠veis e imposs√≠veis, gastando uma quantidade enorme de tempo nela, √© importante encontrar um equil√≠brio.  Por√©m, o conhecimento mais ou menos detalhado da documenta√ß√£o costuma ser um investimento muito √∫til e n√£o leva muito tempo. <br><br>  No entanto, desde o in√≠cio, tendo visto um grande n√∫mero de modelos envolvidos, percebi que seria necess√°rio criar um mapeamento do estado de back-end para o cliente com todas as conex√µes preservadas.  Depois que eu consegui exibir todas as informa√ß√µes necess√°rias no cliente, com todas as conex√µes e assim por diante, foi necess√°rio organizar uma fila de tarefas. <br><br>  Os dados s√£o atualizados de forma ass√≠ncrona, a disponibilidade das opera√ß√µes √© determinada por uma variedade de condi√ß√µes e, quando s√£o necess√°rias opera√ß√µes em cascata, nenhuma fila pode ser dispensada nessas condi√ß√µes.  Talvez, em poucas palavras, essa seja toda a arquitetura da minha solu√ß√£o: armazenamento com um reflexo do estado de back-end e da fila de tarefas. <br><br><h2>  Arquitetura da solu√ß√£o </h2><br>  Devido ao n√∫mero indefinido de modelos e relacionamentos, coloco escalabilidade na estrutura do reposit√≥rio fazendo isso usando uma f√°brica que retorna uma descri√ß√£o declarativa das cole√ß√µes do reposit√≥rio.  A cole√ß√£o possui um servi√ßo, uma classe de modelo simples com CRUD.  Seria poss√≠vel fazer uma descri√ß√£o dos links no modelo, como √© feito, por exemplo, no RoR ou no bom e antigo Backbone, mas isso exigiria que uma grande quantidade de c√≥digo fosse alterada.  Portanto, a descri√ß√£o das rela√ß√µes fica pr√≥xima √† classe do modelo: <br><br><div style="text-align:center;"><img title="Exemplo de descri√ß√£o do link" src="https://habrastorage.org/webt/_y/jw/pr/_yjwpryzsckc_by0igzpq5vlog0.png"></div><br><br>  No total, eu tenho dois tipos de conex√µes: um para um, um para muitos.  O feedback tamb√©m pode ser descrito.  Al√©m do tipo, √© indicada a cole√ß√£o de depend√™ncias, o campo ao qual a depend√™ncia encontrada √© anexada e o campo no qual o ID do objeto dependente √© lido (no caso de comunica√ß√£o um para muitos, a lista de IDs √© lida).  Se a condi√ß√£o de comunica√ß√£o de um objeto for mais complicada do que simples links para objetos, ent√£o na f√°brica √© poss√≠vel descrever a fun√ß√£o de testar dois objetos, cujos resultados determinar√£o a presen√ßa de uma conex√£o.  Tudo parece um pouco "bicicleta", mas funciona sem depend√™ncias desnecess√°rias e exatamente como deveria. <br><br>  O reposit√≥rio possui um m√≥dulo para aguardar a adi√ß√£o e exclus√£o de um recurso, em ess√™ncia est√° processando eventos √∫nicos com verifica√ß√£o condicional e com uma interface promis.  Ao se inscrever, o tipo de evento (adi√ß√£o, exclus√£o), fun√ß√£o de teste e manipulador s√£o aprovados.  Quando um determinado evento ocorre e com um resultado de teste positivo, o manipulador √© executado, ap√≥s o qual o rastreamento √© interrompido.  Pode ocorrer um evento ao se inscrever de forma s√≠ncrona. <br><br>  O uso desse padr√£o tornou poss√≠vel afixar automaticamente relacionamentos arbitrariamente complexos entre modelos e faz√™-lo em um s√≥ lugar.  Este lugar eu chamei de rastreador.  Ao adicionar um objeto ao reposit√≥rio, ele come√ßa a rastrear seus relacionamentos.  O m√≥dulo em espera permite responder a eventos e verificar se h√° uma conex√£o entre o objeto monitorado e o objeto no armazenamento.  Se o objeto j√° estava no reposit√≥rio, o m√≥dulo de espera chama o manipulador imediatamente. <br><br>  Esse dispositivo de armazenamento permite descrever qualquer n√∫mero de cole√ß√µes e os relacionamentos entre elas.  Ao adicionar e excluir objetos, o armazenamento coloca ou redefine automaticamente as propriedades com o conte√∫do dos objetos dependentes.  As vantagens dessa abordagem s√£o que todos os relacionamentos s√£o descritos explicitamente e s√£o monitorados e atualizados por um sistema;  contras - na complexidade da implementa√ß√£o e depura√ß√£o. <br><br>  Em geral, esse reposit√≥rio √© bastante trivial e eu fiz isso sozinho, porque seria muito mais dif√≠cil integrar uma solu√ß√£o pronta a uma base de c√≥digo existente, mas seria ainda mais dif√≠cil anexar uma fila de tarefas a uma solu√ß√£o pronta. <br><br>  Todas as tarefas, como cole√ß√µes, t√™m uma descri√ß√£o declarativa e s√£o criadas pela f√°brica.  As tarefas podem ter na descri√ß√£o as condi√ß√µes para iniciar e uma lista de tarefas que precisar√£o ser adicionadas √† fila ap√≥s a conclus√£o da atual. <br><br><div style="text-align:center;"><img title="Um exemplo de gera√ß√£o de uma tarefa para criar um pool" src="https://habrastorage.org/webt/03/7w/fo/037wfo0c0fn7uxeblixnsahw7j8.png"></div><br>  O exemplo acima descreve a tarefa de criar um pool.  Nas depend√™ncias, o balanceador e o ouvinte s√£o indicados, por padr√£o, uma verifica√ß√£o √© realizada para o status <b>ATIVO</b> .  O objeto do balanceador est√° bloqueado, porque as tarefas de processamento na fila podem ocorrer de forma s√≠ncrona, o bloqueio permite evitar conflitos no momento em que a solicita√ß√£o de execu√ß√£o foi enviada, mas o status n√£o foi alterado, mas sup√µe-se que ser√° alterado.  Em vez de <b>PAI</b> , se o pool for criado como resultado da cascata de tarefas, o <b>ID</b> ser√° substitu√≠do automaticamente. <br><br>  Depois de criar um pool, as tarefas ser√£o adicionadas √† fila para criar um monitor de disponibilidade e criar todos os membros desse pool.  A sa√≠da √© uma estrutura que pode ser totalmente convertida em JSON.  Isso √© feito para restaurar a fila em caso de falha. <br><br>  A fila, com base na descri√ß√£o da tarefa, monitora independentemente todas as altera√ß√µes no reposit√≥rio e verifica as condi√ß√µes que devem ser atendidas para executar a tarefa.  Como eu j√° disse, os status v√™m por meio de soquetes da web e √© muito simples gerar os eventos necess√°rios para a fila, mas, se necess√°rio, n√£o ser√° um problema anexar um mecanismo de atualiza√ß√£o de dados do timer (isso foi originalmente estabelecido na arquitetura, pois os soquetes da web eram por v√°rias raz√µes, pode n√£o funcionar muito est√°vel).  Ap√≥s a conclus√£o da tarefa, a fila informa automaticamente o reposit√≥rio sobre a necessidade de atualizar os links nos objetos especificados. <br><br><h2>  Conclus√£o </h2><br>  A necessidade de escalabilidade levou a uma abordagem declarativa.  A necessidade de exibir modelos e os relacionamentos entre eles levou a um √∫nico reposit√≥rio.  A necessidade de processar objetos dependentes levou √† fila. <br><br>  Combinar essas necessidades pode n√£o ser a tarefa mais f√°cil em termos de implementa√ß√£o (mas esse √© um problema separado).  Por√©m, em termos de arquitetura, a solu√ß√£o √© muito simples e permite eliminar todas as contradi√ß√µes entre as tarefas do back-end e a interface do usu√°rio, estabelecer sua intera√ß√£o e estabelecer as bases para outros recursos poss√≠veis de qualquer uma das partes. <br><br>  Do lado do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">painel de controle</a> Selectel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> o processo de balanceamento √© simples e direto, o que permite que os clientes do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servi√ßo</a> n√£o gastem recursos na implementa√ß√£o independente do balanceador, mantendo a capacidade de controlar o tr√°fego de maneira flex√≠vel. <br><br>  Experimente o nosso balanceador em a√ß√£o agora e escreva sua opini√£o nos coment√°rios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455523/">https://habr.com/ru/post/pt455523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455511/index.html">O sono √© o principal recurso para o c√©rebro de um programador</a></li>
<li><a href="../pt455513/index.html">A explos√£o e a conspira√ß√£o global: a hist√≥ria da cria√ß√£o de baterias de √≠ons de l√≠tio</a></li>
<li><a href="../pt455515/index.html">Como reverter e invadir o disco r√≠gido externo auto-criptografado do Aigo. Parte 1: Dissecando em partes</a></li>
<li><a href="../pt455517/index.html">Formado no curso de Netologia ‚ÄúData Science‚Äù sobre seu trabalho no setor banc√°rio</a></li>
<li><a href="../pt455519/index.html">Como implementamos a integra√ß√£o de novos desenvolvedores</a></li>
<li><a href="../pt455525/index.html">Zimbra e Mail Bomb Defense</a></li>
<li><a href="../pt455527/index.html">O que est√° escrito nisso? Nos bastidores dos objetos JavaScript</a></li>
<li><a href="../pt455529/index.html">Como reverter e invadir o disco r√≠gido externo auto-criptografado do Aigo. Parte 2: Despejando com Cypress PSoC</a></li>
<li><a href="../pt455533/index.html">F√≠sica da bolha: uma busca pelo mecanismo de destrui√ß√£o da espuma</a></li>
<li><a href="../pt455535/index.html">Gerenciando certificados SSL / TLS nas nuvens e cont√™ineres - n√£o no trabalho humano</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>