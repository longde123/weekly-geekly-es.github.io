<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏻 🖐🏾 ↩️ STM32. Latihan penurunan berat badan atau diet untuk pengontrol 🧢 🎃 📋</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Omong kosong macam apa, beberapa pembaca mungkin akan berpikir ketika mereka melihat judul publikasi. Apakah penulis membuat kesalahan pada sumber day...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>STM32. Latihan penurunan berat badan atau diet untuk pengontrol</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441668/"><img src="https://habrastorage.org/webt/u0/9v/yw/u09vyw-escpdlkeezud4cab8trw.jpeg"><br><br><p>  Omong kosong macam apa, beberapa pembaca mungkin akan berpikir ketika mereka melihat judul publikasi.  Apakah penulis membuat kesalahan pada sumber daya?  Atau apakah sudah direncanakan untuk meletakkannya di hub "Geek Health"?  Dan mereka akan sebagian benar, tetapi hanya sebagian ... Di bawah potongan, kita akan berbicara tentang metode untuk mengurangi dan mengoptimalkan konsumsi energi perangkat elektronik. </p><a name="habracut"></a><br><p>  Beberapa waktu yang lalu, papan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> jatuh ke tangan saya, yang untuk sementara waktu menganggur sampai saya memutuskan untuk mempelajari konsumsi daya dari satu perangkat yang dirancang dengan daya otonom. </p><br><img src="https://habrastorage.org/webt/v-/ma/qp/v-maqpklxovwalvp3dc_99ireja.jpeg"><br><p>  Papan ini dikembangkan oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">STMicroelectronics</a> dan diposisikan sebagai "Perisai daya, papan ekspansi Nuklir untuk pengukuran konsumsi daya".  Saya tidak menemukan penjelasan bahasa Rusia yang jelas di jaringan untuk bekerja dengan devkit ini dan memutuskan untuk mencari tahu sendiri, tetapi pada saat yang sama berbagi informasi dengan komunitas habro yang disegani. </p><br><p>  Jika kami menyoroti yang utama, papan ekspansi adalah sumber daya yang dapat diprogram dari 1,8 hingga 3,3 volt dengan kemampuan untuk mengukur arus beban dalam waktu nyata (dalam mode dinamis hingga <br>  50 mA) dengan frekuensi pengambilan sampel hingga 100 kHz.  Perangkat dapat beroperasi baik secara mandiri maupun sebagai bagian dari kompleks perangkat keras-perangkat lunak.  Untuk menampilkan secara grafis nilai yang diukur, utilitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">STM32Cube MonitorPower digunakan</a> .  Perangkat lunak ini juga memungkinkan Anda untuk mengatur semua parameter yang diperlukan dan melakukan pemrosesan pada saat terjadinya suatu peristiwa (pemicu peluncuran).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> diasah untuk bekerja dengan papan Nucleo-32 (64, 144), Arduino Nano (Uno), untuk tujuan ini perisai yang sesuai ditempatkan di atasnya, tetapi dimungkinkan untuk bekerja dengan papan yang sewenang-wenang.  Foto di bawah ini menunjukkan koneksi perangkat yang sedang dipelajari ke salah satu konektor di papan tulis. </p><br><img src="https://habrastorage.org/webt/3p/o-/ll/3po-lljw_abqlzhztomwkzncw0i.jpeg"><br><br><p>  Selain perangkat lunak aplikasi, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> mendukung mode perintah, yang <s>mana program terminal</s> mana <s>pun harus</s> bekerja.  (Di sini saya tampaknya sedikit bersemangat, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://">HTerm</a> mendapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://">luka</a> dengan setengah tendangan, tapi saya harus bermain sedikit dengan ZOC favorit saya).  Selain itu, dilihat dari deskripsi, melalui penggunaan driver VCP, perangkat dapat menuangkan data ke port COM dengan kecepatan hingga 3686400 baud.  Kecepatan tinggi semacam itu dipastikan khususnya dengan mentransmisikan aliran data biner (untuk frekuensi sampling di atas 50 KHz), untuk karakter ASCII kecepatannya sedikit lebih rendah. </p><br><p>  Lebih khusus, tugas yang akan saya coba pecahkan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> adalah: </p><ol><li><p>  Untuk mendapatkan informasi tentang konsumsi daya dinamis dari simpul yang diminati dalam produk yang dirancang menggunakan pemicu pemicu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> di tempat yang dipelajari dari kode program. </p></li><li><p>  Dalam proses operasi perangkat yang berkelanjutan untuk mengatur akumulasi fragmen yang diperlukan untuk analisis umum selanjutnya. </p></li></ol><br><p>  Tangkapan layar di bawah ini menunjukkan log saat ini dari kartu SD selama perekaman data. </p><br> <a href=""><img src="https://habrastorage.org/webt/_g/t6/3h/_gt63h_pmhohs4w_q-higuefp8k.jpeg"></a> <br><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">STM32Cube MonitorPower</a> tidak hanya memungkinkan secara kualitatif, tetapi juga secara kuantitatif mengevaluasi konsumsi energi perangkat yang diteliti.  Nilai minimum, maksimum, rata-rata dari arus yang dikonsumsi dan nilai energi terintegrasi ditunjukkan di bagian bawah gambar.  Data tersebut tersedia untuk seluruh pengukuran dan untuk fragmen yang dipilih. </p><br><p>  Dalam manual Pengguna, dicatat bahwa pemicu pemicu pengukuran dilakukan oleh impuls pada kaki perisai arduino D7.  Ternyata, hanya satu awal proses dengan pekerjaan perekaman kontinu berikutnya.  Upaya untuk mengatur mode mulai-berhenti untuk merekam arus (di kedua sisi pulsa) tidak berhasil.  Artinya, setelah mulai merekam di tempat yang tepat di depan naik, tidak mungkin untuk memperlambat proses dengan jatuh depan pulsa.  Dan ini tidak seperti yang saya harapkan dari perangkat ini. </p><br><div class="spoiler">  <b class="spoiler_title">Mode start-stop yang sepenuhnya dikontrol dapat diatur menggunakan urutan perintah dari program terminal</b> <div class="spoiler_text"><table cellpadding="2"><tbody><tr><td><p>  tim </p></td><td><p>  deskripsi </p></td></tr><tr><td><p>  htc </p></td><td><p>  menangkap kontrol host </p></td></tr><tr><td><p>  volt 3300-03 </p></td><td><p>  tegangan suplai pada saluran yang diukur 3300 mV </p></td></tr><tr><td><p>  acqtime 0 </p></td><td><p>  pengukuran terus menerus tanpa batas waktu </p></td></tr><tr><td><p>  freq 10000 </p></td><td><p>  frekuensi sampling 10 kHz </p></td></tr><tr><td><p>  mulai </p></td><td><p>  mulai dari pengukuran </p></td></tr><tr><td><p>  ... </p></td><td><p>  pengukuran (data dituangkan ke terminal) </p></td></tr><tr><td><p>  berhenti </p></td><td><p>  akhir pengukuran </p></td></tr></tbody></table></div></div><br><p>  Masalahnya adalah bahwa ini adalah kontrol manual yang tidak disinkronkan dengan peristiwa di pengontrol target.  Tentu saja, Anda dapat mencoba untuk membentuk urutan perintah yang ditunjukkan pada sisi perangkat yang sedang dipelajari, bukan host, tetapi kemudian aliran output data dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> juga akan memercikkan ke controller dan tidak jelas apa yang harus dilakukan dengan mereka, dan pengalihan output "somewhere_to_other_place_" juga tidak tersedia, ( meskipun ada UART Tx, pin Rx di papan tulis, mereka muncul sebagai "dipesan" dalam manual dan mungkin tidak terlibat dalam versi firmware saat ini).  Saya keluar dari situasi ini sebagai berikut: </p><br><div class="spoiler">  <b class="spoiler_title">Urutan perintah berikut ini dibentuk di sisi host (komputer)</b> <div class="spoiler_text"><table cellpadding="4"><tbody><tr><td><p>  tim </p></td><td><p>  deskripsi </p></td></tr><tr><td><p>  htc </p></td><td><p>  menangkap kontrol host </p></td></tr><tr><td><p>  volt 3300-03 </p></td><td><p>  tegangan suplai pada saluran yang diukur 3300 mV </p></td></tr><tr><td><p>  <em><strong>acqtime 1</strong></em> </p></td><td><p>  durasi pengukuran <br>  (kisaran 10 μs hingga 10 detik dapat digunakan) </p></td></tr><tr><td><p>  <em><strong>trigsrc d7</strong></em> </p></td><td><p>  sinkronisasi awal pengukuran dengan sisi yang naik <br>  pulsa pada pin D7 </p></td></tr><tr><td><p>  freq 10000 </p></td><td><p>  frekuensi sampling 10 kHz </p></td></tr><tr><td><p>  mulai </p></td><td><p>  mulai dari pengukuran </p></td></tr><tr><td><p>  ... </p></td><td><p>  pengukuran (data dimulai di tepi denyut nadi dan berhenti <br>  tuangkan setelah waktu yang ditentukan dalam acqtime) </p></td></tr></tbody></table></div></div><br><p>  Sekarang data akan ditangkap dalam batch, bukan dalam aliran kontinu.  Pendekatan ini memungkinkan Anda menjelajahi konsumsi sirkuit di berbagai tempat program dan pada interval waktu yang berbeda, yang cukup jauh satu sama lain.  Artinya, jika ada kebutuhan untuk mengumpulkan informasi tentang konsumsi energi perangkat yang bekerja satu jam (hari, minggu), Anda tidak perlu menulis aliran kontinu, dan bahkan dengan laju pengambilan sampel maksimum, dan kemudian memahami kekacauan ini, tetapi cukup sediakan algoritma operasi di atas.  Dan jika program terminal menulis penanda waktu ke log-nya, seperti yang ditunjukkan pada gambar di bawah ini, maka menguraikan kronologi peristiwa dari file seperti itu akan sangat sederhana. </p><br> <a href=""><img src="https://habrastorage.org/webt/pu/0j/cp/pu0jcpgvy-7wnmcgipzauzjjlw0.jpeg"></a> <br><br><p>  Ini seperti perekam video dengan deteksi gerakan dan cap waktu. </p><br><p>  Biarkan saya memberi Anda beberapa tangkapan layar yang diperoleh menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> .  Yang pertama adalah konsumsi daya controller saat membaca data dari ADC built-in.  32 nilai dibaca oleh penghenti waktu dengan frekuensi 4 KHz dan disimpan dalam memori. </p><br> <a href=""><img src="https://habrastorage.org/webt/yu/d-/lz/yud-lz-ormre9rvdr9pqklka9e4.jpeg"></a> <br><br><p>  Pada yang kedua - pembacaan dan penyimpanan data yang serupa, tetapi hanya pengontrol "memungkinkan dirinya untuk tidur" setelah setiap pengukuran, sampai penghentian pengatur waktu berikutnya terjadi, menggunakan salah satu mode hemat energi yang tersedia. </p><br> <a href=""><img src="https://habrastorage.org/webt/zb/ze/zu/zbzezucrkjdtpxou_jll9hk3owm.jpeg"></a> <br><br><p>  Sebuah delta signifikan dalam konsumsi saat ini selama pengukuran, ~ 6 mA, segera terlihat.  Dua contoh ini tidak mengklaim untuk mengoptimalkan konsumsi daya perangkat berdaya rendah, tetapi hanya menunjukkan kemampuan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">X-NUCLEO-LPM01A</a> , yang mampu mengukur arus dari 1 nA. </p><br><p>  Sebagai kesimpulan, saya akan mengatakan bahwa, menurut pendapat saya yang sederhana, devkit ini tampaknya menjadi alat yang sangat cocok yang dapat mengambil tempat yang selayaknya di sebelah osiloskop dan penganalisa sinyal logika pada tabel embedder.  Dan penggunaan pendekatan yang dijelaskan akan memungkinkan tidak hanya untuk "memoderasi selera pengontrol" dalam pengembangan perangkat kritis daya, tetapi juga untuk lebih memahami dinamika proses dalam berbagai mode hemat energi yang secara aktif digunakan oleh pengembang perangkat elektronik modern. </p><br><p>  Biaya papan - lebih dari 7000 rubel, membayangi pelangi gambar, tetapi dapatkah jumlah yang begitu kecil di zaman modern menghentikan geek sejati dari memiliki devkit yang indah ini? </p><br><p>  NB Meskipun ada indikasi dalam UM bahwa UART dicadangkan untuk aplikasi masa depan, saya masih terjebak di dalamnya dan menemukan bahwa itu hidup sebagai antarmuka kedua (I / O diduplikasi dari VCP) pada kecepatan 921600 8N1 dan dapat digunakan sebagai perintah, membentuk mulai dan berhenti untuk awal - akhir pengukuran.  Kelemahan dari pendekatan ini adalah ketersediaan wajib dari UART gratis di sisi controller yang diteliti, belum lagi fakta bahwa 921600 baud sering tidak mungkin pada frekuensi clock rendah. </p><br><p>  PPS Sudah setelah menulis artikel, saya melihat perbedaan pada gambar terakhir ~ 2 mA di pintu masuk pengukuran dan di akhir.  Saya mungkin tidak mematikan pencatatan jam kerja ADC, atau saya meninggalkan penghitung waktu untuk bekerja, tetapi ini, seperti yang suka dikatakan Leonid Kanevsky: "cerita yang sama sekali berbeda" ... </p><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id441668/">https://habr.com/ru/post/id441668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id441648/index.html">Memperkenalkan Microsoft HoloLens 2</a></li>
<li><a href="../id441650/index.html">Webinar Group-IB "Pandangan Forensik tentang Perlindungan Objek CII pada 2019"</a></li>
<li><a href="../id441654/index.html">Bagaimana cara magang ke perusahaan IT besar</a></li>
<li><a href="../id441660/index.html">STM32F103C8T6 sebagai flash drive dengan sistem file FAT12</a></li>
<li><a href="../id441664/index.html">Linus Torvalds tidak percaya bahwa server pada arsitektur ARM akan menggantikan x86. “Menjual model 64-bit - kebodohan”</a></li>
<li><a href="../id441674/index.html">Tata letak tes? Mudah</a></li>
<li><a href="../id441676/index.html">Cara berteman PLUTO dan HDSDR</a></li>
<li><a href="../id441678/index.html">Fisika tornado permainan: bagaimana aerodinamika diterapkan di Just Cause 4 (lalu lintas)</a></li>
<li><a href="../id441680/index.html">Lua In Moscow 2019 program konferensi</a></li>
<li><a href="../id441682/index.html">HyperX Fury 3D - SSD dengan silsilah yang jelas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>