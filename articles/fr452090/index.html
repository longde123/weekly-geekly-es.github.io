<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüë©‚Äçüëß üôáüèª üë∑üèº Cr√©ation d'un g√©n√©rateur de puzzle proc√©dural üåπ üë©üèæ‚Äçüíº üê∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article d√©crit le g√©n√©rateur de niveau pour mon jeu de puzzle Linjat . Un article peut √™tre lu sans pr√©paration, mais il est plus facile √† assimil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cr√©ation d'un g√©n√©rateur de puzzle proc√©dural</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452090/"> Cet article d√©crit le g√©n√©rateur de niveau pour mon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jeu de</a> puzzle <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Linjat</a> .  Un article peut √™tre lu sans pr√©paration, mais il est plus facile √† assimiler si vous jouez sur plusieurs niveaux.  J'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">post√© le</a> code source <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur github</a> ;  tout ce qui est discut√© dans l'article se trouve dans le <code>src/main.cc</code> <br><br>  Exemple de plan de publication: <br><br><ul><li>  Linjat est un jeu de logique dans lequel vous devez fermer tous les nombres et points de la grille avec des lignes. </li><li>  Les puzzles sont g√©n√©r√©s de mani√®re proc√©durale en utilisant une combinaison de solveur, de g√©n√©rateur et d'optimiseur. </li><li>  Le solveur essaie de r√©soudre les √©nigmes comme le ferait une personne et attribue √† chaque puzzle une note d'int√©r√™t. </li><li>  Le g√©n√©rateur de puzzle est con√ßu de sorte qu'il est possible de changer facilement une partie du puzzle (num√©ro) et en m√™me temps toutes les autres parties (points) changent de sorte que le puzzle reste r√©soluble. </li><li>  L'optimiseur de casse-t√™te r√©sout √† plusieurs reprises les niveaux et g√©n√®re de nouvelles variations par rapport aux plus int√©ressantes du moment. </li></ul><br><h3>  Les r√®gles </h3><br>  Pour comprendre le fonctionnement du g√©n√©rateur de niveau, vous devez malheureusement comprendre les r√®gles du jeu.  Heureusement, ils sont tr√®s simples.  Le puzzle se compose d'une grille contenant des carr√©s vides, des nombres et des points.  Un exemple: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/641/0d0/547/6410d0547bc14faae51beb3942867cb0.png"></div><br>  Le but du joueur est de tracer une ligne verticale ou horizontale √† travers chacun des nombres, sous r√©serve de trois conditions: <br><br><ul><li>  Une ligne passant par un num√©ro doit avoir la m√™me longueur que le num√©ro. </li><li>  Les lignes ne peuvent pas se croiser. </li><li>  Tous les points doivent √™tre ferm√©s par des lignes. </li></ul><br>  Exemple de solution: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e1/3ce/91c/7e13ce91c2da2e2d64bd98f523010671.png"></div><br>  Hourra!  La conception du jeu est pr√™te, l'interface utilisateur est impl√©ment√©e et il ne reste plus qu'√† trouver plusieurs centaines de bons puzzles.  Et pour de tels jeux, il n'est g√©n√©ralement pas logique d'essayer de cr√©er de tels puzzles manuellement.  Ceci est un travail informatique. <br><a name="habracut"></a><br><h3>  Pr√©requis </h3><br>  Qu'est-ce qui rend le puzzle de ce jeu bon?  J'ai tendance √† croire que les jeux de r√©flexion peuvent √™tre divis√©s en deux cat√©gories.  Il y a des jeux dans lesquels vous explorez un espace d'√©tat complexe du d√©but √† la fin (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sokoban</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rush Hour</a> ), et dans lesquels il peut ne pas √™tre √©vident quels √©tats existent dans le jeu.  Et il y a des jeux dans lesquels tous les √©tats sont connus d√®s le d√©but, et nous fa√ßonnons progressivement l'espace d'√©tat en utilisant le processus d'√©limination des √©tats inutiles (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sudoku</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Picross</a> ).  Mon jeu tombe d√©finitivement dans la deuxi√®me cat√©gorie. <br><br>  Les joueurs ont des exigences tr√®s diff√©rentes pour ces diff√©rents types de puzzles.  Dans le second cas, ils s'attendent √† ce que le casse-t√™te ne puisse √™tre r√©solu que par d√©duction, et qu'ils n'auront jamais besoin de revenir en arri√®re / deviner / essayer et l'erreur <sup>[0]</sup> <sup>[1]</sup> . <br><br>  Il ne suffit pas de savoir si un puzzle ne peut √™tre r√©solu que par la logique.  De plus, nous devons en quelque sorte comprendre √† quel point les puzzles cr√©√©s sont bons.  Sinon, la plupart des niveaux ne seront que des scories triviales.  Dans une situation id√©ale, ce principe pourrait √©galement √™tre utilis√© pour cr√©er une courbe de progression fluide, de sorte que, √† mesure que le joueur progresse dans le jeu, les niveaux deviennent progressivement plus difficiles. <br><br><h3>  Solveur </h3><br>  La premi√®re √©tape pour r√©pondre √† ces exigences est de cr√©er un solveur de jeu optimis√© √† cet effet.  Le solveur de retour arri√®re vous permet de d√©terminer rapidement et avec pr√©cision si le puzzle est r√©soluble;  en outre, il peut √™tre modifi√© pour d√©terminer si la solution est unique.  Mais il ne peut pas donner une id√©e de la complexit√© du puzzle, car les gens les r√©solvent diff√©remment.  Le solveur doit imiter le comportement humain. <br><br>  Comment une personne r√©sout-elle ce casse-t√™te?  Voici quelques mouvements √©vidents que le didacticiel en jeu enseigne: <br><br><ul><li>  Si un point peut √™tre atteint √† partir d'un seul num√©ro, pour fermer un point, vous devez tracer une ligne √† partir de ce num√©ro.  Dans cet exemple, le point ne peut √™tre atteint que par les trois, mais pas par les quatre: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/76d/1d4/e3e/76d1d4e3e87a0cc9efdebbd586420c84.png"></div><br>  Et cela conduit √† cette situation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a15/db3/05f/a15db305fa78a149ee614de0b4b8ed54.png"></div></li><li>  Si la ligne ne rentre pas dans une direction, elle doit √™tre plac√©e dans une autre.  Dans l'exemple ci-dessus, les quatre ne peuvent plus √™tre positionn√©s verticalement, nous savons donc que ce sera horizontal: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ef/048/99f/5ef04899f1c9da5a5b8492e1316ddcbf.png"></div></li><li>  S'il est connu que la ligne de longueur X doit √™tre dans une certaine position (verticale / horizontale) et qu'il n'y a pas assez d'espace vide pour placer une ligne de X cellules vides des deux c√¥t√©s, alors vous devez couvrir plusieurs carr√©s au milieu.  Si les quatre √©taient trois dans l'exemple ci-dessus, nous ne saurions pas s'il s'√©tend compl√®tement √† droite ou √† gauche.  Mais nous saurions que la ligne devrait couvrir deux carr√©s du milieu: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02c/bfa/021/02cbfa02113362bc6e3c5217baee3ff3.png"></div></li></ul><br>  Un raisonnement similaire est la base m√™me du jeu.  Le joueur cherche des moyens d'√©tirer une petite ligne, puis examine √† nouveau le champ, car il peut lui donner des informations pour faire une autre conclusion logique.  Cr√©er un solveur qui suit ces r√®gles sera suffisant pour d√©terminer <i>si une</i> personne peut r√©soudre le puzzle sans revenir en arri√®re. <br><br>  Cependant, cela ne nous dit rien sur la complexit√© ou l'int√©r√™t du niveau.  Outre la solvabilit√©, nous devons en quelque sorte quantifier la complexit√©. <br><br>  Une premi√®re id√©e √©vidente pour la fonction de notation: plus vous avez besoin de mouvements pour r√©soudre le puzzle, plus il est difficile.  C'est probablement une bonne m√©trique dans d'autres jeux, mais le mien, tr√®s probablement, est plus important que le nombre de coups autoris√©s qu'un joueur a.  Si un joueur peut tirer 10 conclusions logiques, il en trouvera tr√®s probablement une tr√®s rapidement.  S'il n'y a qu'un seul coup droit, cela prendra plus de temps. <br><br>  C'est-√†-dire que, en premi√®re approximation, nous avons besoin que l'arbre de d√©cision soit profond et √©troit: il y a une longue d√©pendance des mouvements du d√©but √† la fin, et √† chaque instant il n'y a qu'un petit nombre de fa√ßons de remonter la cha√Æne <sup>[2]</sup> . <br><br>  Comment d√©termine-t-on la largeur et la profondeur d'un arbre?  Une solution unique au casse-t√™te et √† l'√©valuation de l'arbre cr√©√© ne donnera pas de r√©ponse exacte.  L'ordre exact dans lequel les mouvements sont effectu√©s affecte la forme de l'arbre.  Nous devons consid√©rer toutes les solutions possibles et faire avec elles quelque chose comme l'optimisation pour les meilleurs et les pires cas.  Je suis familier avec la technique de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">recherche grossi√®re des graphiques de recherche dans les jeux de puzzle</a> , mais pour ce projet, je voulais cr√©er un solveur en un seul passage, et non pas une recherche exhaustive.  En raison de la phase d'optimisation, j'ai essay√© de m'assurer que le temps d'ex√©cution du solveur n'√©tait pas mesur√© en secondes, mais en millisecondes. <br><br>  J'ai d√©cid√© de ne pas le faire.  Au lieu de cela, mon solveur ne fait pas un mouvement √† la fois, mais r√©sout le puzzle en couches: en prenant un √©tat, il trouve tous les mouvements valides qui peuvent √™tre effectu√©s.  Il applique ensuite tous ces mouvements en m√™me temps et recommence dans un nouvel √©tat.  Le nombre de couches et le nombre maximum de d√©placements trouv√©s sur une couche sont ensuite utilis√©s comme valeurs approximatives de la profondeur et de la largeur de l'arbre de recherche dans son ensemble. <br><br>  Voici comment r√©soudre l'un des √©nigmes difficiles avec ce mod√®le.  Les lignes pointill√©es sont des lignes √©tir√©es sur cette couche du solveur, les lignes pleines sont celles qui n'ont pas chang√©.  Les lignes vertes ont la bonne longueur, les rouges ne sont pas encore termin√©es. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2af/1de/cfb/2af1decfbc170ec8965ae8b1cce2cbea.png"></div><br>  Le probl√®me suivant est que tous les mouvements effectu√©s par le joueur sont cr√©√©s √©gaux.  Ce que nous avons √©num√©r√© au d√©but de cette section n'est que du bon sens.  Voici un exemple de r√®gle de d√©duction plus complexe, dont la recherche n√©cessitera un peu plus de r√©flexion.  Consid√©rez le champ suivant: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c4/c18/772/9c4c187726bf50f03bbffa748137cf44.png"></div><br>  Les points en C et D ne peuvent √™tre couverts que par les cinq et les quatre du milieu (et pas un seul num√©ro ne peut couvrir les deux points en m√™me temps).  Cela signifie que les quatre au milieu doivent couvrir un point sur deux et ne peuvent donc pas √™tre utilis√©s pour couvrir A. Par cons√©quent, le point A doit fermer les quatre dans le coin inf√©rieur gauche. <br><br>  De toute √©vidence, il serait insens√© de consid√©rer cette cha√Æne de raisonnement comme la simple conclusion "ce point ne peut √™tre atteint qu'√† partir de ce nombre".  Est-il possible de donner plus de poids √† ces r√®gles plus complexes dans la fonction d'√©valuation?  Malheureusement, dans un solveur bas√© sur des couches, cela n'est pas possible, car il n'est pas garanti de trouver une solution au moindre co√ªt.  Ce n'est pas seulement un probl√®me th√©orique - en pratique, il arrive souvent qu'une partie du champ puisse √™tre r√©solue soit par un seul argument complexe, soit par une cha√Æne de mouvements beaucoup plus simples.  En fait, un solveur bas√© sur les couches trouve le chemin le plus court et non le moins co√ªteux, et cela ne peut pas √™tre refl√©t√© dans la fonction d'√©valuation. <br><br>  En cons√©quence, je suis arriv√© √† cette d√©cision: j'ai chang√© le solveur de sorte que chaque couche se compose d'un seul type de raisonnement.  L'algorithme contourne les r√®gles de raisonnement dans un ordre approximatif de complexit√©.  Si la r√®gle trouve des mouvements, ils sont appliqu√©s et l'it√©ration se termine et l'it√©ration suivante d√©marre la liste depuis le tout d√©but. <br><br>  Ensuite, la d√©cision se voit attribuer une √©valuation: chaque couche se voit attribuer des co√ªts en fonction d'une r√®gle qui y a √©t√© utilis√©e.  Cela ne garantit toujours pas que la solution sera la plus √©conomique, mais si les pond√©rations sont s√©lectionn√©es correctement, l'algorithme ne trouvera pas au moins une solution co√ªteuse si elle est bon march√©. <br><br>  De plus, cela ressemble beaucoup √† la fa√ßon dont les gens r√©solvent les √©nigmes.  Ils essaient d'abord de trouver des solutions faciles et ne commencent √† bouger activement leur cerveau que s'il n'y a pas de mouvements simples. <br><br><h3>  G√©n√©rateur </h3><br>  La section pr√©c√©dente a d√©termin√© si un niveau particulier √©tait bon ou mauvais.  Mais cela ne suffit pas, nous devons toujours g√©n√©rer des niveaux pour que le solveur puisse les √©valuer.  Il est tr√®s peu probable qu'un monde g√©n√©r√© al√©atoirement soit r√©soluble, sans parler d'int√©ressant. <br><br>  L'id√©e principale (ce n'est en aucun cas nouveau) est l'utilisation alternative du solveur et du g√©n√©rateur.  Commen√ßons par un puzzle, qui est probablement insoluble: placez simplement deux √† cinq nombres dans des carr√©s al√©atoires de la cellule: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8cf/164/3c5/8cf1643c568477bc2c774d33a0994f96.png"></div><br>  Le solveur fonctionne jusqu'√† ce qu'il puisse se d√©velopper davantage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/64f/9b4/a5c/64f9b4a5c022b2560c1a26746a0c3539.png"></div><br>  Ensuite, le g√©n√©rateur ajoute plus d'informations au puzzle sous la forme d'un point, apr√®s quoi l'ex√©cution du solveur continue. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b4/397/23f/1b439723f7d229887c8392ebc07053f3.png"></div><br>  Dans ce cas, le point ajout√© au solveur n'est pas suffisant pour un d√©veloppement ult√©rieur.  Ensuite, le g√©n√©rateur continuera d'ajouter de nouveaux points jusqu'√† ce qu'il satisfasse le solveur: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6b2/3a0/48d/6b23a048dc66700a3eadf94206705c7c.png"></div><br>  Et puis le solveur continue son travail habituel: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b8e/b9a/77a/b8eb9a77a027a741ce259a1b95fe9c89.png"></div><br>  Ce processus se poursuit soit jusqu'√† ce que le puzzle soit r√©solu, soit jusqu'√† ce qu'il reste plus d'informations √† ajouter (par exemple, lorsque chaque cellule qui peut √™tre atteinte √† partir du nombre contient d√©j√† un point). <br><br>  Cette m√©thode ne fonctionne que si les nouvelles informations ajout√©es ne peuvent rendre incorrectes les conclusions formul√©es pr√©c√©demment.  Cela serait difficile √† faire lors de l'ajout de nombres √† la grille <sup>[3]</sup> .  Mais l'ajout de nouveaux points au champ a cette propri√©t√©;  au moins pour les r√®gles de raisonnement que j'utilise dans ce programme. <br><br>  O√π l'algorithme doit-il ajouter des points?  Au final, j'ai d√©cid√© de les ajouter √† l'espace vide, qui peut √™tre ferm√© dans l'√©tat initial avec autant de lignes que possible, afin que chaque point cherche √† donner le moins d'informations possible.  Je n'ai pas essay√© de placer sp√©cifiquement le point √† l'endroit o√π il serait utile de progresser dans la r√©solution du puzzle au moment o√π le solveur se coince.  Cela cr√©e un effet tr√®s pratique: la plupart des points au d√©but du puzzle semblent compl√®tement inutiles, ce qui rend le puzzle plus difficile qu'il ne l'est vraiment.  Si tout cela est beaucoup de mouvements √©vidents qu'un joueur peut faire, mais pour une raison quelconque, aucun d'entre eux ne fonctionne pas correctement.  En cons√©quence, il s'est av√©r√© que le g√©n√©rateur de puzzle se comportait un peu comme un cochon. <br><br>  Ce processus ne cr√©e pas toujours une solution, mais il est assez rapide (environ 50-100 millisecondes), donc pour g√©n√©rer un niveau, vous pouvez simplement le r√©p√©ter plusieurs fois.  Malheureusement, il cr√©e g√©n√©ralement des puzzles m√©diocres.  D√®s le d√©but, il y a trop de mouvements √©vidents, le champ se remplit tr√®s rapidement et l'arbre de d√©cision s'av√®re plut√¥t superficiel. <br><br><h3>  Optimiseur </h3><br>  Le processus d√©crit ci-dessus a cr√©√© des puzzles m√©diocres.  √Ä la derni√®re √©tape, j'utilise ces niveaux comme base pour le processus d'optimisation.  Cela fonctionne comme suit. <br><br>  L'optimiseur cr√©e un pool qui contient jusqu'√† 10 options de puzzle.  Le pool est initialis√© avec un nouveau puzzle al√©atoire g√©n√©r√©.  √Ä chaque it√©ration, l'optimiseur s√©lectionne un puzzle dans le pool et effectue sa mutation. <br><br>  La mutation supprime tous les points, puis modifie l√©g√®rement les nombres (c'est-√†-dire diminue / augmente la valeur d'un nombre s√©lectionn√© au hasard ou d√©place le nombre vers une autre cellule de la grille).  Vous pouvez appliquer plusieurs mutations au champ en m√™me temps.  Ensuite, nous ex√©cutons le solveur dans le mode de g√©n√©ration de niveau sp√©cial d√©crit dans la section pr√©c√©dente.  Il ajoute suffisamment de points au puzzle pour qu'il redevienne r√©soluble. <br><br>  Apr√®s cela, nous red√©marrons le solveur, cette fois en mode normal.  Pendant cette ex√©cution, le solveur surveille a) la profondeur de l'arbre de d√©cision, b) la fr√©quence du besoin de diff√©rents types de r√®gles, c) la largeur de l'arbre de d√©cision √† diff√©rents moments.  Le puzzle est √©valu√© sur la base des crit√®res d√©crits ci-dessus.  La fonction d'√©valuation pr√©f√®re les solutions profondes et √©troites, et les niveaux de complexit√© accrue ajoutent √©galement plus de poids aux √©nigmes dans lesquelles des r√®gles de raisonnement plus complexes sont n√©cessaires. <br><br>  Ensuite, un nouveau puzzle est ajout√© √† la piscine.  Si la piscine contient plus de 10 puzzles, le pire est √©limin√©. <br><br>  Ce processus est r√©p√©t√© plusieurs fois (environ 10 000 √† 5 000 it√©rations m'ont pris).  Apr√®s cela, la version la mieux not√©e du puzzle est enregistr√©e dans la base de donn√©es du niveau du puzzle.  Voici √† quoi ressemble la progression du meilleur puzzle en un seul cycle d'optimisation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/504/e61/40c/504e6140c20049ca3424456de0985aaf.png"></div><br>  J'ai essay√© d'utiliser d'autres fa√ßons de structurer l'optimisation.  Dans une version, un recuit simul√© a √©t√© utilis√©; d'autres √©taient des algorithmes g√©n√©tiques avec diverses op√©rations de croisement.  Aucune des solutions n'a fonctionn√© aussi bien qu'un algorithme na√Øf avec un pool d'options remontant au sommet. <br><br><h3>  Solution unique unique </h3><br>  Lorsqu'un puzzle a une solution unique et unique, une difficult√© int√©ressante se pose.  Est-il possible de permettre au joueur de supposer qu'il existe une solution et de tirer des conclusions sur cette base?  Serait-il juste que le g√©n√©rateur de casse-t√™te sugg√®re que le joueur le fasse? <br><br>  Dans un article sur HackerNews, j'ai dit qu'il y avait quatre options pour aborder cette situation: <br><br><ul><li>  D√©clarez le caract√®re unique de la solution d√®s le d√©but et forcez le g√©n√©rateur √† cr√©er des niveaux qui n√©cessitent ce type de raisonnement.  C'est une mauvaise d√©cision car elle complique la compr√©hension des r√®gles.  Et ce sont g√©n√©ralement les d√©tails que les gens oublient. </li><li>  Ne garantissez pas l'unicit√© d'une d√©cision: prenez potentiellement de nombreuses d√©cisions et prenez-les toutes.  En fait, cela ne r√©sout pas le probl√®me, mais le repousse. </li><li>  Supposons simplement qu'il s'agit d'un √©v√©nement tr√®s rare, qui dans la pratique n'est pas important.  (Il s'agit de la solution qui a √©t√© utilis√©e dans la mise en ≈ìuvre initiale.) </li><li>  Modifiez le g√©n√©rateur de casse-t√™te afin qu'il ne g√©n√®re pas de casse-t√™te dans lesquels la connaissance de l'unicit√© de la solution serait utile.  (Probablement la bonne solution, mais n√©cessitant un travail suppl√©mentaire.) </li></ul><br>  Au d√©part, j'ai choisi cette derni√®re option, et c'√©tait une terrible erreur.  Il s'est av√©r√© que je n'ai pris en compte qu'une seule fa√ßon dont l'unicit√© de la solution a conduit √† une fuite d'informations, et c'est en fait assez rare.  Mais il y en a d'autres;  l'un d'eux √©tait en fait pr√©sent √† tous les niveaux que j'ai g√©n√©r√©s et conduisait souvent au fait que la solution devenait triviale.  Par cons√©quent, en mai 2019, j'ai chang√© les modes Hard et Expert en utilisant la troisi√®me option. <br><br>  Le cas le plus ennuyeux est un diable avec une ligne pointill√©e dans ce champ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af9/ecf/34f/af9ecf34f96e0d74ae1f514207940020.png"></div><br>  Pourquoi un joueur rus√© peut-il tirer une telle conclusion?  Un diable peut couvrir n'importe laquelle des quatre cases voisines.  Aucun d'entre eux n'a de points, ils ne doivent donc pas √™tre couverts par une ligne.  Et le carr√© ci-dessous n'a pas de superpositions avec d'autres nombres.  S'il n'y a qu'une seule solution, cela devrait √™tre le cas lorsque d'autres nombres couvrent les trois carr√©s restants et que les deux ferment le carr√© en dessous. <br><br>  La solution consiste √† ajouter quelques points suppl√©mentaires lors de la reconnaissance de tels cas: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d7d/d45/ebd/d7dd45ebd5d0a7aebbc78e7da61e1cd9.png"></div><br>  Un autre cas courant est un tiret avec une ligne pointill√©e dans ce champ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/252/fc8/13e/252fc813e342f503a2c189645590e7f1.png"></div><br>  Les carr√©s √† gauche et en haut des deux ne sont pas diff√©rents.  Aucun d'entre eux n'a de point, et aucun ne peut √™tre joint √† partir d'un autre num√©ro.  Toute solution dans laquelle un diable couvre le carr√© sup√©rieur aura une solution correspondante dans laquelle il ferme le carr√© de gauche, et vice versa.  S'il y avait une seule solution unique, cela ne pouvait pas √™tre le cas, et le diable aurait d√ª couvrir le carr√© inf√©rieur. <br><br>  J'ai d√©cid√© ce type de bo√Ætier de la mani√®re suivante: "si √ßa fait mal, alors ne le touchez pas."  Solver a appliqu√© cette r√®gle √† un stade pr√©coce de la liste des priorit√©s et a attribu√© un poids n√©gatif √† ces mouvements.  Les puzzles avec cette fonctionnalit√© sont g√©n√©ralement ignor√©s par l'optimiseur, et les quelques restants sont ignor√©s au stade de la s√©lection finale des niveaux pour le jeu publi√©. <br><br>  Ce n'est pas une liste compl√®te. Pendant les tests de jeu avec une recherche d√©lib√©r√©e d'erreurs, j'ai trouv√© de nombreuses autres r√®gles pour des solutions uniques.  Mais la plupart d'entre eux semblaient rares et ils √©taient suffisants √† trouver, donc ils n'ont pas grandement simplifi√© le jeu.  Si quelqu'un r√©sout le puzzle en utilisant un tel raisonnement, je ne le bl√¢merai pas. <br><br><h3>  Conclusion </h3><br>  Initialement, le jeu a √©t√© d√©velopp√© comme une exp√©rience dans la g√©n√©ration proc√©durale de puzzles.  La conception et le g√©n√©rateur du jeu sont all√©s de pair, de sorte que les techniques elles-m√™mes sont difficiles √† appliquer directement aux autres jeux. <br><br>  La question √† laquelle je n'ai pas de r√©ponse: l'investissement de tels efforts dans la g√©n√©ration proc√©durale s'est-il justifi√©?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les commentaires des joueurs sur la conception des niveaux ont √©t√© tr√®s controvers√©s. Dans les commentaires positifs, on a g√©n√©ralement dit que certains trucs d√©licats se font toujours sentir dans les puzzles. Dans la plupart des critiques n√©gatives, ils m'ont √©crit que le jeu n'avait pas un gradient de complexit√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai encore quelques puzzles √† leurs balbutiements, et j'ai tellement aim√© le g√©n√©rateur que j'utilise probablement une approche proc√©durale similaire pour eux. Je ne changerai qu'une chose: d√®s le d√©but, je proc√©derai √† des tests de jeu actifs avec la recherche d'erreurs.</font></font><br><br><h3>  Remarques </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[0] Ou, du moins, il me semblait. Mais quand j'ai regard√© les joueurs en direct, pr√®s de la moiti√© d'entre eux ont juste fait des suppositions, puis ont r√©p√©t√© √† travers eux. Oh bien. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1] Les lecteurs de mon article devraient √©galement lire l'article </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R√©soudre le d√©mineur et le rendre meilleur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Magnus Hoff. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2] Je pr√©ciserai que la profondeur / l'√©troitesse d'un arbre est une m√©trique que je consid√©rais comme importante pour mon jeu, et pas pour toutes les autres √©nigmes. Par exemple, il y a un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://web.archive.org/web/20130703141244/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bon argument selon</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lequel le casse-t√™te de l'heure de pointe est int√©ressant s'il a plusieurs chemins pour r√©soudre presque, mais pas exactement la m√™me longueur. Mais c'est arriv√© parce que Rush Hour est un jeu pour trouver la solution la plus courte, et pas n'importe quelle solution.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[3] Hors ajout d'unit√©s. </font><font style="vertical-align: inherit;">Il n'y avait pas de points dans la premi√®re version du puzzle, et le plan pr√©voyait que le g√©n√©rateur ajoute des unit√©s si n√©cessaire. </font><font style="vertical-align: inherit;">Mais cela semblait trop restrictif.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452090/">https://habr.com/ru/post/fr452090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452076/index.html">Briser le navigateur UC</a></li>
<li><a href="../fr452078/index.html">R√©servation Kubernetes: elle existe</a></li>
<li><a href="../fr452082/index.html">Flux flexible des mises √† jour int√©gr√©es: acc√©l√©rez le processus de mise √† jour des applications sur Android</a></li>
<li><a href="../fr452086/index.html">Ce qui est dans mon pixel pour vous: cr√©er des nanopixels en utilisant des m√©tasurfaces plasmon</a></li>
<li><a href="../fr452088/index.html">Reconnaissance routi√®re par segmentation s√©mantique</a></li>
<li><a href="../fr452092/index.html">Mises √† jour int√©gr√©es √† l'application: acc√©l√©ration des mises √† jour des applications Android</a></li>
<li><a href="../fr452094/index.html">.NET: outils pour travailler avec le multithreading et l'asynchronie. Partie 1</a></li>
<li><a href="../fr452098/index.html">Journaux du d√©veloppeur frontal Habr: refactor et reflex</a></li>
<li><a href="../fr452102/index.html">Jeu photo pour ceux qui aiment les drones: bref sur AirSelfie 2</a></li>
<li><a href="../fr452106/index.html">Nous invitons les conf√©renciers √† la r√©union de bricolage d'√©t√© du 16 juin 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>