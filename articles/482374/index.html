<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç§ ü§õüèº üïò Desarrollo de juegos en LibGDX utilizando la plantilla del sistema de componentes de la entidad ‚§µÔ∏è üàµ üßõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola habr Mi nombre es Andrey Shilo, soy un desarrollador de Android en FINCH . Hoy les contar√© qu√© errores no deben cometerse al escribir incluso el ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de juegos en LibGDX utilizando la plantilla del sistema de componentes de la entidad</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482374/">  Hola habr  Mi nombre es Andrey Shilo, soy un desarrollador de Android en <a href="https://www.facebook.com/FinchMoscow">FINCH</a> .  Hoy les contar√© qu√© errores no deben cometerse al escribir incluso el juego m√°s simple y por qu√© el enfoque arquitect√≥nico del <a href="https://en.wikipedia.org/wiki/Entity_component_system">Sistema de componentes de entidad</a> (ECS) es genial. <br><a name="habracut"></a><br><h2>  La primera vez siempre es dolorosa. </h2><br>  Tenemos un proyecto divertido para una gran empresa de medios, que es una red social no est√°ndar.  red con publicaciones, comentarios, me gusta y videos.  Una vez, nos dieron una tarea: introducir la mec√°nica del juego como una promoci√≥n.  El juego parec√≠a simples mini carreras, donde con un toque en el lado izquierdo / derecho, el auto se mov√≠a hacia el carril izquierdo / derecho.  Entonces, esquivando obst√°culos y recolectando impulsores, ten√≠as que llegar a la l√≠nea de meta, en general, el jugador ten√≠a tres vidas. <br><br>  Se supon√≠a que el juego se implementar√≠a dentro de la aplicaci√≥n, por supuesto, en una pantalla separada.  Elegimos incondicionalmente <a href="https://libgdx.badlogicgames.com/">LibGDX</a> como motor, ya que puede codificar el juego en kotiln y depurarlo en el escritorio, iniciando el juego como una <a href="https://libgdx.badlogicgames.com/documentation/gettingstarted/Running%2520and%2520Debugging.html">aplicaci√≥n java</a> .  Al mismo tiempo, no ten√≠amos personas que conocieran otros motores que pudieran implementarse en la aplicaci√≥n (si lo sabe, comp√°rtalos). <br><br>  El juego se ve as√≠: <br><br><img src="https://habrastorage.org/webt/le/xy/z0/lexyz0syrcyj6czcecctxnw0kh8.jpeg"><br><br>  Dado que el juego seg√∫n el TK original parec√≠a simple, no profundizamos en los enfoques arquitect√≥nicos.  Adem√°s, las promociones pasan r√°pidamente: en promedio, una acci√≥n demora un mes y medio.  En consecuencia, m√°s tarde, el c√≥digo del juego simplemente se cortar√° y no ser√° necesario hasta la pr√≥xima promoci√≥n, siempre que alguien quiera repetir algo as√≠. <br><br>  Todos los factores descritos anteriormente y los amados e instantes gerentes nos empujaron a escribir una mec√°nica de juego sin ninguna arquitectura. <br><br><h2>  Descripci√≥n del juego resultante. </h2><br>  La mayor parte del c√≥digo se compil√≥ en las clases: MyGdxGame: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/Game.html">Game</a> , GameScreen: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/Screen.html">Screen</a> y TrafficGame: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html">Actor</a> . <br><br>  MyGdxGame: es el punto de entrada al comienzo del juego, aqu√≠ los par√°metros se transfieren al constructor en forma de cadenas.  GameScreen y los par√°metros del juego tambi√©n se crean aqu√≠, que se pasan a esta clase, pero en una forma diferente. <br><br>  GameScreen: crea un actor del juego TrafficGame, lo agrega a la escena, le pasa los par√°metros ya mencionados y tambi√©n "escucha" los clics del usuario en la pantalla y llama a los m√©todos correspondientes del actor TrafficGame. <br><br>  TrafficGame: el actor principal de la escena en la que tiene lugar todo el movimiento del juego: renderizado y l√≥gica de trabajo. <br><br>  Aunque el uso de <a href="https://github.com/libgdx/libgdx/wiki/Scene2d">scene2d</a> hace posible construir √°rboles de anidaci√≥n de actores, esta no es la mejor soluci√≥n arquitect√≥nica.  Sin embargo, para implementar un juego UI / UX (en LibGDX), scene2d es una gran opci√≥n. <br><br>  En nuestro caso, TrafficGame tiene una gran colecci√≥n de instancias mixtas y todo tipo de indicadores de comportamiento que se permitieron en m√©todos con construcciones de gran tama√±o.  Un ejemplo: <br><br><pre><code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isGameActive: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(value) { backgroundActor?.isGameActive = value boostersMap.values.filterNotNull().forEach { it.isGameActive = value } obstaclesMap.values.filterNotNull().forEach { it.isGameActive = value } finishActor.isGameActive = value field = value } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> backgroundActoolbarActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pauseButtonActor: PauseButtonActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> finishActor: FinishActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isQuizWon = falser: BackgroundActor? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> playerCarActor: PlayerCarActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toolbarActor: To <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pointsTime = <span class="hljs-number"><span class="hljs-number">0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> totalTimeElapsed = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> timeToFinishTheGame = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastQuizBoosterTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastBoosterTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boostersMap = hashMapOf&lt;<span class="hljs-built_in"><span class="hljs-built_in">Long</span></span>?, BoosterActor?&gt;() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> boosterSpawnedCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> totalBoostersEatenCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boosterLimit = <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastBoosterYPos = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toGenerateBooster = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastObstacleTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obstaclesMap = hashMapOf&lt;<span class="hljs-built_in"><span class="hljs-built_in">Long</span></span>?, ObstacleActor?&gt;()</code> </pre> <br>  Naturalmente, no deber√≠as escribir as√≠.  Pero en defensa dir√© que sucedi√≥ as√≠ porque: <br><br><ul><li>  Necesita comenzar ahora, bueno, y le mostraremos el TK final con el dise√±o m√°s adelante.  Cl√°sico </li><li>  Las arquitecturas que ya son familiares (MVP / MVC / MVVM, etc.) no son adecuadas para la implementaci√≥n del proceso del juego, ya que est√°n dise√±adas exclusivamente para la interfaz de usuario, en el juego todo sucede en tiempo real. </li><li>  Inicialmente, el juego parec√≠a simple, pero de hecho requer√≠a mucho c√≥digo, teniendo en cuenta una gran cantidad de matices, la mayor parte de los cuales surgieron durante la escritura del juego. </li></ul><br><img src="https://habrastorage.org/webt/8e/cg/sn/8ecgsncl5hmmhmzw8unltjyqgh0.jpeg"><br><br>  Adem√°s de todas estas dificultades, hay otro problema com√∫n con la herencia.  Si hace que un juego sea m√°s dif√≠cil, por ejemplo, un juego de plataformas, entonces surge la pregunta: "¬øC√≥mo distribuir el c√≥digo reutilizable entre los objetos del juego?"  La opci√≥n m√°s com√∫nmente elegida es la herencia, donde el c√≥digo reutilizable se coloca en las clases principales.  Pero esta soluci√≥n crea muchos problemas si aparecen condiciones que no encajan en el √°rbol de herencia: <br><br><img src="https://habrastorage.org/webt/xg/tw/_6/xgtw_64w3v31if0kfnwoy9yemlg.png"><br><br>  Y generalmente resuelven estos problemas reescribiendo la estructura del √°rbol de herencia desde cero (bueno, esta vez ser√° mejor), o las clases principales se rompen con muletas. <br><br><img src="https://habrastorage.org/webt/af/8-/4o/af8-4ovkeruwatlo--agakilupm.gif"><br><br><h2>  ECS es nuestro todo </h2><br>  Una historia completamente diferente es nuestro segundo juego promocional.  Era como <a href="https://ru.wikipedia.org/wiki/Flappy_Bird">Flappy Bird</a> , pero con diferencias: el personaje estaba controlado por la voz, y el techo y el piso no eran obst√°culos, se pod√≠a deslizar sobre ellos. <br>  Un ejemplo de juego y para comparar, el proceso de jugar Flappy Bird: <br><br><img src="https://habrastorage.org/webt/9k/sv/ao/9ksvaojzedwbnyd0nm602f2n90e.gif"><br><img src="https://habrastorage.org/webt/gr/sq/3t/grsq3twwn7aorv6utrvdvgnwldw.gif"><br><br>  Para mayor claridad, en el ejemplo, la c√°mara se retira para ver el backstage del juego.  El piso y el techo son bloques cuadrados que, llegando al borde, se reordenan al principio, y los obst√°culos se generan de acuerdo con un patr√≥n dado que proviene de la parte posterior.  El dise√±o del juego fue elegido por los clientes, as√≠ que no te sorprendas. <br><br>  Me gusta el desarrollo de juegos para dispositivos m√≥viles y durante las horas libres, en aras de la experimentaci√≥n, explorar√© los patrones del juego y todo lo relacionado con el desarrollo del juego.  Le√≠ un libro sobre <a href="https://gameprogrammingpatterns.com/">patrones de dise√±o de juegos</a> , pero no entend√≠ cu√°l deber√≠a ser la verdadera arquitectura de la l√≥gica del juego, hasta que me encontr√© con ECS. <br><br>  Sistema de componentes de la entidad: el patr√≥n de dise√±o m√°s utilizado en el desarrollo de juegos.  La idea principal del patr√≥n es la <a href="https://en.wikipedia.org/wiki/Composition_over_inheritance">composici√≥n en lugar de la herencia</a> .  La composici√≥n le permite mezclar diferentes mec√°nicas en los objetos del juego, esto, en el futuro, le permite delegar la configuraci√≥n de las propiedades del objeto a un dise√±ador de juegos, por ejemplo, a trav√©s de un constructor escrito.  Como ya estaba familiarizado con este patr√≥n, decidimos aplicarlo en el segundo juego. <br><br>  Considere los componentes del patr√≥n: <br><br><ul><li>  <i>Componente</i> : objetos con una <b>estructura de datos simple que</b> no contiene ninguna l√≥gica, o que act√∫an como un atajo.  Los componentes se dividen por prop√≥sito y determinan todas las propiedades de los objetos del juego.  Velocidad, posici√≥n, textura, cuerpo, etc.  etc.  todo esto se describe en los componentes y luego se agrega a los objetos del juego. <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VelocityComponent</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Component { val velocity = Vector2</span></span></span></span>() }</code> </pre> </li><li>  <i>Entidad</i> - objetos del juego: obst√°culos / refuerzos / h√©roe controlado e incluso fondo.  No tienen clases especializadas por tipo: UltraMegaSuperman: GameUnit, sino que simplemente <b>son contenedores</b> para el conjunto de componentes.  El hecho de que una determinada entidad sea UltraMegaSuperman define su conjunto de componentes y sus par√°metros. <br>  Por ejemplo, en nuestro caso, el personaje principal ten√≠a los siguientes componentes: <br><br><ul><li>  TextureComponent: define qu√© dibujar en la pantalla </li><li>  TransformComponent: la posici√≥n del objeto en el espacio del juego </li><li>  VelocityComponent: velocidad del objeto en el espacio del juego </li><li>  HeroControllerComponent: contiene valores que afectan el movimiento del h√©roe </li><li>  ImmortalityTimeComponent: contiene el tiempo restante de inmortalidad </li><li>  Componente din√°mico: indica que el objeto no es est√°tico y est√° sujeto a la gravedad. </li><li>  BodyComponent: define el cuerpo f√≠sico del h√©roe 2d necesario para calcular colisiones </li></ul></li><li>  <i>Sistema</i> : contiene el c√≥digo para procesar datos de los componentes de cada entidad.  No deben <b>almacenar objetos de entidad y / o componente</b> , ya que esto contradecir√° el patr√≥n.  Idealmente, deber√≠an estar limpios. <br><br>  Los sistemas hacen todo el trabajo sucio: dibujan todos los objetos del juego, mueven el objeto por su velocidad, verifican colisiones, cambian la velocidad del control entrante, etc.  Por ejemplo, el efecto de la gravedad se ve as√≠: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(entity: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Entity</span></span></span></span><span class="hljs-function"><span class="hljs-params">, deltaTime: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { entity.getComponent(VelocityComponent::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) .</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">velocity</span></span></span><span class="hljs-class"> .</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">add</span></span></span></span>(<span class="hljs-number"><span class="hljs-number">0f</span></span>, -GRAVITY * deltaTime) }</code> </pre> <br>  La especializaci√≥n de cada sistema determina los requisitos para las entidades que debe procesar.  Es decir, en el ejemplo anterior, la entidad debe tener los componentes de velocidad VelocityComponent y DynamicComponent para que esta entidad pueda procesarse; de ‚Äã‚Äãlo contrario, la entidad no es interesante para el sistema y, por lo tanto, con los dem√°s.  Para dibujar una textura, por ejemplo, debe saber qu√© es la textura TextureComponent y d√≥nde dibujar TransformComponent.  Para determinar los requisitos en cada sistema, la familia se escribe en el constructor en el que se indican las clases de componentes. <br><br><pre> <code class="kotlin hljs">Family.all(TransformComponent::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TextureComponent::class.java).get</span></span></span></span>()</code> </pre> <br>  Adem√°s, el orden de las entidades de procesamiento dentro del sistema puede ser ajustado por un comparador.  Adem√°s, el orden de ejecuci√≥n de los sistemas en el motor tambi√©n se rige por el valor de prioridad. <br></li></ul><br>  El motor combina tres componentes.  Contiene todos los sistemas y todas las entidades del juego.  Al comienzo del juego, todos los sistemas necesarios en el juego. <br><br><pre> <code class="kotlin hljs">engine.apply { addSystem(ControlSystem()) addSystem(GravitySystem()) addSystem(renderingSystem) addSystem(MovementSystem()) addSystem(EnemyGeneratorSystem()) }</code> </pre>  as√≠ como las entidades iniciales se agregan al motor, <br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> hero: Entity = engine.createEntity() engine.addEntity(hero)</code> </pre> <br>  <a href="https://libgdx.badlogicgames.com/ci/ashley/docs/com/badlogic/ashley/core/PooledEngine.html">PooledEngine :: createEntity</a> : obtiene un objeto de entidad del <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BF%25D1%2583%25D0%25BB">grupo</a> , ya que las entidades se pueden crear durante el juego para no ensuciar la memoria.  Si es necesario, se toman del grupo de objetos y, cuando se eliminan, se vuelven a colocar.  Del mismo modo hecho para componentes.  Al recibir componentes del grupo, es necesario inicializar todos los campos, ya que pueden contener informaci√≥n sobre el uso anterior de este componente. <br><br>  La relaci√≥n entre las partes principales del patr√≥n se presenta a continuaci√≥n: <br><br><img src="https://habrastorage.org/webt/gk/tj/ak/gktjakst_gxpnuikd_bbgpnfv2a.png"><br><br>  El motor contiene una colecci√≥n de sistemas y una colecci√≥n de entidades.  Cada sistema recibe un enlace del motor a una colecci√≥n de entidades, que es una selecci√≥n de la colecci√≥n general de acuerdo con los requisitos del sistema; se actualizar√° durante el juego cuando las entidades y los componentes cambien.  Cada entidad contiene una colecci√≥n de sus componentes que la definen en el juego. <br><br>  El ciclo del juego est√° estructurado de la siguiente manera: <br><br><ol><li>  Usando la implementaci√≥n del patr√≥n <a href="https://habr.com/ru/post/271315/">"Ciclo de juego"</a> de LibGDX, en el m√©todo de actualizaci√≥n obtenemos su incremento en cada paso de tiempo: deltaTime. </li><li>  A continuaci√≥n, pasamos el tiempo al motor.  Y √©l, a su vez, itera a trav√©s del sistema en un ciclo, los distribuye deltaTime. <pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> until systems.size()) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> system = systems[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (system.checkProcessing()) { system.update(deltaTime) } }</code> </pre> </li><li>  Los sistemas que reciben deltaTime clasifican sus entidades y les aplican cambios teniendo en cuenta deltaTime. <pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> until entities.size()) { processEntity(entities[i], deltaTime) }</code> </pre> </li></ol><br>  Esto sucede cada medida del juego. <br><br><h2>  Beneficios de ECS </h2><br><ol><li>  <b>Los datos son lo primero</b> .  Dado que los sistemas procesan solo aquellas entidades que les convienen, en ausencia de tales entidades, el sistema simplemente no har√° nada, esto hace posible probar y depurar nuevas caracter√≠sticas, creando solo las entidades necesarias para esto. <br><br>  Por ejemplo, creaste el juego "Tanks".  Despu√©s de un tiempo, decidi√≥ agregar un nuevo tipo de terreno: "lava".  Si el tanque intenta atravesarlo, terminar√° en falla.  Pero la tecnolog√≠a futurista viene al rescate, instalando la cual puedes cruzar la lava. <br><br>  Para depurar este caso, no es necesario crear modelos completos de tanques y construir mapas completos con ubicaciones de lava agregadas, solo piense en los componentes m√≠nimos necesarios en el tanque y agregue una entidad al motor del juego para probar.  Todo esto suena obvio, pero de hecho te encuentras con la clase TheTank que en el constructor pide una lista de par√°metros: calibre, velocidad, sprite, velocidad de disparo, nombres de la tripulaci√≥n, etc.  aunque esto es innecesario para probar las intersecciones de lava. <br></li><li>  Adem√°s, siguiendo el ejemplo del p√°rrafo anterior, notamos una <b>gran flexibilidad</b> , ya que con este enfoque es mucho m√°s f√°cil agregar y eliminar funciones. <br><br>  Un verdadero ejemplo.  El escenario del juego de nuestra segunda promoci√≥n fue que el usuario, despu√©s de ejecutar una canci√≥n, se estrell√≥ en la l√≠nea de meta en ~ 2 minutos, y el juego comenz√≥ la cuenta regresiva reiniciando el nivel nuevamente, pero ahorrando puntos, dando as√≠ al jugador un descanso. <br><br>  Un par de d√≠as antes del lanzamiento esperado llega la tarea de "eliminar la l√≠nea de meta y hacer un informe de media hora de juego continuo con obst√°culos y canciones en bucle".  Un cambio global, pero fue muy f√°cil de hacer: fue suficiente para eliminar la esencia de la l√≠nea de meta y agregar un sistema de referencia para el final del juego. </li><li>  Todos los desarrollos son <b>f√°ciles de probar</b> .  Sabiendo que los datos en primer lugar, puede simular cualquier caso de prueba, ejecutarlos y ver el resultado. </li><li>  En el futuro, para <b>validar el estado del juego</b> , puede conectar un servidor al proceso del juego.  Ejecutar√° a trav√©s del mismo c√≥digo la misma entrada del cliente y comparar√° su resultado con el resultado en el cliente.  Si los datos no convergen, entonces el cliente es un tramposo o tenemos errores en el juego. </li></ol><br><br><h2>  ECS en el gran mundo de gamedev </h2><br>  Las grandes empresas como Unity, Epic o Crytek utilizan esta plantilla en sus marcos para proporcionar a los desarrolladores una herramienta con muchas caracter√≠sticas.  Te aconsejo que veas el informe sobre c√≥mo <a href="https://www.youtube.com/watch%3Fv%3D2Hi3GeCBpd0">se</a> implement√≥ la <a href="https://www.youtube.com/watch%3Fv%3D2Hi3GeCBpd0">l√≥gica</a> del <a href="https://www.youtube.com/watch%3Fv%3D2Hi3GeCBpd0">juego en Overwatch</a> <br><br>  Para una mejor comprensi√≥n, hice un peque√±o <a href="https://github.com/AndrewMisterio/examples">ejemplo en github</a> . <br>  Gracias por su atencion! <br><br><h2>  Tambi√©n sobre el tema: </h2><br><ul><li>  <a href="https://habr.com/ru/post/343778/">Implementaci√≥n y ejemplo del juego.</a> </li><li>  <a href="https://habr.com/ru/post/358108/">ECS y todo-todo-todo</a> </li><li>  <a href="https://leopotam.com/2/">Conceptos b√°sicos de ECS</a> </li><li>  <a href="https://fateev.pro/ru/gamedev/entity-component-system">Sistema de componentes y entidades</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482374/">https://habr.com/ru/post/482374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482362/index.html">Casi anarqu√≠a: una breve historia de Fidonet, un proyecto que no le importa ganar en Internet</a></li>
<li><a href="../482364/index.html">Cosas que [tal vez] no sab√≠as sobre Java</a></li>
<li><a href="../482366/index.html">¬øQu√© piensan los expertos en autom√≥viles rob√≥ticos sobre el piloto autom√°tico Tesla?</a></li>
<li><a href="../482370/index.html">nodejs: gestores de procesos y m√≥dulos ES6</a></li>
<li><a href="../482372/index.html">Habilite el modo de sesi√≥n mejorada para los invitados de Arch Linux en Hyper-V</a></li>
<li><a href="../482378/index.html">Una breve historia de Wacom: c√≥mo la tecnolog√≠a de tabletas gr√°ficas lleg√≥ a los lectores electr√≥nicos</a></li>
<li><a href="../482382/index.html">¬øCuatro principios de traducci√≥n, o de qu√© manera una persona no ceder√° ante un traductor autom√°tico?</a></li>
<li><a href="../482384/index.html">Mi proyecto no realizado. Red de 200 enrutadores MikroTik</a></li>
<li><a href="../482390/index.html">Tutorial de Ember.js tutorial. Aplicaci√≥n Super Rentals. Parte 1.2</a></li>
<li><a href="../482392/index.html">Trucos de ELF en Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>