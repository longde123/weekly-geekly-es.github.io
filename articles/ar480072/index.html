<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฃ๐พ ๐ ๐ฐ๐ฟ Kubernetes: ูุง ุฃูููุฉ ุฅุนุฏุงุฏ ุฅุฏุงุฑุฉ ููุงุฑุฏ ุงููุธุงูุ ๐ ๐จ๐พโ๐ง ๐๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุงุนุฏุฉ ุนุงูุฉ ุ ููุงู ุญุงุฌุฉ ุฏุงุฆููุง ุฅูู ุชูููุฑ ูุฌููุนุฉ ูุฎุตุตุฉ ูู ุงูููุงุฑุฏ ูุฃู ุชุทุจูู ูุชุดุบูููุง ุงูุตุญูุญ ูุงููุณุชูุฑ. ูููู ูุงุฐุง ูู ุชุนูู ุนุฏุฉ ุชุทุจููุงุช ุนูู ููุณ ุงููุฏุฑุงุช ูู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetes: ูุง ุฃูููุฉ ุฅุนุฏุงุฏ ุฅุฏุงุฑุฉ ููุงุฑุฏ ุงููุธุงูุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nixys/blog/480072/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ููุงุนุฏุฉ ุนุงูุฉ ุ ููุงู ุญุงุฌุฉ ุฏุงุฆููุง ุฅูู ุชูููุฑ ูุฌููุนุฉ ูุฎุตุตุฉ ูู ุงูููุงุฑุฏ ูุฃู ุชุทุจูู ูุชุดุบูููุง ุงูุตุญูุญ ูุงููุณุชูุฑ.  ูููู ูุงุฐุง ูู ุชุนูู ุนุฏุฉ ุชุทุจููุงุช ุนูู ููุณ ุงููุฏุฑุงุช ูู ููุช ูุงุญุฏุ  ููููุฉ ุชูููุฑ ุงูุญุฏ ุงูุฃุฏูู ูู ุงูููุงุฑุฏ ุงููุงุฒูุฉ ููู ููููุ  ููู ูููููู ุงูุญุฏ ูู ุงุณุชููุงู ุงูููุงุฑุฏุ  ููููุฉ ุชูุฒูุน ุงูุญูู ุจุดูู ุตุญูุญ ุจูู ุงูุนูุฏุ  ููููุฉ ุงูุชุฃูุฏ ูู ุขููุฉ ุงูููุงุณ ุงูุฃููู ูู ุญุงูุฉ ุฒูุงุฏุฉ ุงูุญูู ุนูู ุงูุชุทุจููุ </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-f/yj/hw/-fyjhwhkhcibnshgzndgd4w4e_c.png"></p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชุจุฏุฃ ูุน ุงูุฃููุงุน ุงูุฃุณุงุณูุฉ ููููุงุฑุฏ ุงูููุฌูุฏุฉ ูู ุงููุธุงู - ุจุงูุทุจุน ุ ููุช ุงููุนุงูุฌ ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู.  ูู ุนุฑูุถ k8 ุ ูุชู ููุงุณ ูุฐู ุงูุฃููุงุน ูู ุงูููุงุฑุฏ ุจุงููุญุฏุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ - ูู ุงูููู </li><li style=";text-align:right;direction:rtl">  RAM - ุจุงูุจุงูุช </li></ul><br><p style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุฐูู ุ ููู ููุฑุฏ ููุงู ูุฑุตุฉ ูุชุนููู ููุนูู ูู ุงููุชุทูุจุงุช - <strong>ุงูุทูุจุงุช</strong> <strong>ูุงูุญุฏูุฏ</strong> .  ุงูุทูุจุงุช - ูุตู ุงูุญุฏ ุงูุฃุฏูู ููุชุทูุจุงุช ุงูููุงุฑุฏ ุงููุฌุงููุฉ ููุนูุฏุฉ ูุชุดุบูู ุงูุญุงููุฉ (ูุงููููุฏ ููู) ุ ุจูููุง ุชุญุฏุฏ ุงูุญุฏูุฏ ูููุฏูุง ุตุงุฑูุฉ ุนูู ุงูููุงุฑุฏ ุงููุชุงุญุฉ ููุญุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃู ูููู ุฃูู ูู ุงูุจูุงู ููุณ ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ููุง ุงูููุนูู ุจุดูู ุตุฑูุญ ุ ูุณูููู ุงูุณููู ุนูู ุงููุญู ุงูุชุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ุชุนููู ุญุฏูุฏ ุงูููุฑุฏ ููุท ุจุดูู ุตุฑูุญ ุ ูุณุชุชููู ุทูุจุงุช ูุฐุง ุงูููุฑุฏ ุชููุงุฆููุง ูููุฉ ูุณุงููุฉ ููุญุฏูุฏ (ูููู ุงูุชุญูู ูู ุฐูู ุนู ุทุฑูู ุงุณุชุฏุนุงุก ููุงูุงุช ุงููุตู).  ุฃู  ูู ุงููุงูุน ุ ุณูุชู ุชูููุฏ ุชุดุบูู ุงูุญุงููุฉ ุจููุณ ูููุฉ ุงูููุงุฑุฏ ุงูุชู ูุชุทูุจูุง ุชุดุบูููุง. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ุชุนููู ุงูุทูุจุงุช ููุท ุตุฑุงุญุฉู ูุฃุญุฏ ุงูููุงุฑุฏ ุ ููู ูุชู ุชุนููู ูููุฏ ุนูู ูุฐุง ุงูููุฑุฏ - ุฃู  ุงูุญุงููุฉ ูุญุฏูุฏุฉ ููุท ุจูุงุณุทุฉ ููุงุฑุฏ ุงูุนูุฏุฉ ููุณูุง. </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุงููููู ุฃูุถูุง ุชูููู ุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ููุณ ููุท ุนูู ูุณุชูู ุญุงููุฉ ูุญุฏุฏุฉ ุ ูููู ุฃูุถูุง ุนูู ูุณุชูู ูุณุงุญุฉ ุงูุงุณู ุจุงุณุชุฎุฏุงู ุงูููุงูุงุช ุงูุชุงููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>LimitRange</strong> - ูุตู ุณูุงุณุฉ ุงูุชูููุฏ ุนูู ูุณุชูู ุงูุญุงููุฉ / ุงููููุฏ <strong>ุจุงูุนุฏุฏ</strong> ns ูููุงู ุญุงุฌุฉ ููุตู ุงููููุฏ ุงูุงูุชุฑุงุถูุฉ ุนูู ุงูุญุงููุฉ / ุงููููุฏ ุ ููุฐูู ูููุน ุฅูุดุงุก ุญุงููุงุช / ูููุฏ ูู ุงูุฏููู (ุฃู ุงูุนูุณ) ุ ูุงูุญุฏ ูู ุนุฏุฏูุง ูุชุญุฏูุฏ ุงููุฑู ุงููุญุชูู ุจูู ุงูุญุฏูุฏ ู ุงูุทูุจุงุช </li><li style=";text-align:right;direction:rtl">  <strong>ResourceQuotas</strong> - ูุตู ุณูุงุณุฉ ุงูุชูููุฏ ุนููููุง ูุฌููุน ุงูุญุงููุงุช ุจุงูุนุฏุฏ ns ููุณุชุฎุฏู ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ูุชุญุฏูุฏ ุงูููุงุฑุฏ ุจูู ุงูุจูุฆุงุช (ูููุฏ ุนูุฏูุง ูุง ูุชู ุชุญุฏูุฏ ุงูุจูุฆุงุช ุจุดูู ุตุงุฑู ุนูู ูุณุชูู ุงูุนูุฏ) </li></ul><br><p style=";text-align:right;direction:rtl">  ูููุง ููู ุฃูุซูุฉ ุนูู ุงูุจูุงูุงุช ุงูุชู ุชู ุชุนููู ุญุฏูุฏ ุงูููุงุฑุฏ ูููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุนูู ูุณุชูู ุงูุญุงููุฉ ุงููุญุฏุฏุฉ: </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">containers: - name: app-nginx image: nginx resources: requests: memory: 1Gi limits: cpu: 200m</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูู ูุฐู ุงูุญุงูุฉ ุ ูุจุฏุก ุญุงููุฉ ูุน nginx ุ ุณุชุญุชุงุฌ ุนูู ุงูุฃูู ุฅูู ูุฌูุฏ 1G OP ู 0.2 CPU ูุฌุงููุง ุนูู ุงูุนูุฏุฉ ุ ูู ุญูู ุฃู ุงูุญุงููุฉ ุงููุตูู ูููู ุฃู ุชุฃูู 0.2 CPU ููู OP ุงููุชุงุญุฉ ุนูู ุงูุนูุฏุฉ. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ุนุฏุฏ ุตุญูุญ ns: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: ResourceQuota metadata: name: nxs-test spec: hard: requests.cpu: 300m requests.memory: 1Gi limits.cpu: 700m limits.memory: 2Gi</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูุง ูููู ุฃู ูุชุฌุงูุฒ ูุฌููุน ูู ุญุงููุงุช ุงูุทูุจ ูู ns ุงูุงูุชุฑุงุถู 300m ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ู 1 G ูู OP ุ ููุฌููุน ุงูุญุฏ ุงูุฃูุตู 700m ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ู 2 G ูู OP. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุงููููุฏ ุงูุงูุชุฑุงุถูุฉ ููุญุงููุงุช ุจุงูุนุฏุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: LimitRange metadata: name: nxs-limit-per-container spec: limits: - type: Container defaultRequest: cpu: 100m memory: 1Gi default: cpu: 1 memory: 2Gi min: cpu: 50m memory: 500Mi max: cpu: 2 memory: 4Gi</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูู ูุณุงุญุฉ ุงูุงุณู ุงูุงูุชุฑุงุถูุฉ ูุฌููุน ุงูุญุงููุงุช ุ ุจุดูู ุงูุชุฑุงุถู ุ ุณูุชู ุถุจุท ุงูุทูุจ ุนูู 100m ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ู 1 G ูู OP ุ ูุญุฏ - 1 CPU ู 2G.  ูู ุงูููุช ููุณู ุ ุชู ูุถุน ูููุฏ ุฃูุถูุง ุนูู ุงูููู ุงููุญุชููุฉ ูู ุงูุทูุจ / ุงูุญุฏ ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (50m &lt;x &lt;2) ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู (500M &lt;x &lt;4G). </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุงููููุฏ ุงูููุฑูุถุฉ ุนูู ูุณุชูู ุงููููุฏ ns: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: LimitRange metadata: name: nxs-limit-pod spec: limits: - type: Pod max: cpu: 4 memory: 1Gi</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ููู ูููุฏ ูู ns ุงูุงูุชุฑุงุถู ุ ุณูุชู ุชุนููู ุญุฏ 4 vCPU ู 1G. </p><br></li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฃูุฏ ุฃู ุฃุฎุจุฑู ุจุงููุฒุงูุง ุงูุชู ูููู ุฃู ูููุฑูุง ููุง ุชุซุจูุช ูุฐู ุงููููุฏ. </p><br><h2 id="mehanizm-balansirovki-nagruzki-mezhdu-nodami" style=";text-align:right;direction:rtl">  ุขููุฉ ููุงุฒูุฉ ุงูุชุญููู ุจูู ุงูุนูุฏ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ุชุนูููู ุ ูุฅู ูููู k8s ูุซู <strong>ุงููุฌุฏูู</strong> ุ ูุงูุฐู ูุนูู ููููุง ูุฎูุงุฑุฒููุฉ ูุนููุฉ ุ ูุณุคูู ุนู ุชูุฒูุน ุงููููุฏ ุนูู ุงูุนูุฏ.  ุชูุฑ ูุฐู ุงูุฎูุงุฑุฒููุฉ ูู ุนูููุฉ ุงุฎุชูุงุฑ ุงูุนูุฏุฉ ุงููุซุงููุฉ ููุชุดุบูู ุนุจุฑ ูุฑุญูุชูู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุตููุฉ </li><li style=";text-align:right;direction:rtl">  ุชุตููู </li></ol><br><p style=";text-align:right;direction:rtl">  ุฃู  ููููุง ููุณูุงุณุฉ ุงูููุถุญุฉ ุ ูุชู ุชุญุฏูุฏ ุงูุนูุฏ ูุจุฏุฆููุง ูุงูุชู ูููู ุชุดุบูููุง ุนูู ุฃุณุงุณ ูุฌููุนุฉ ูู <strong>ุงููุชูุจุฆุงุช</strong> (ุจูุง ูู ุฐูู ูุง ุฅุฐุง ูุงูุช ุงูุนูุฏุฉ ูุฏููุง ููุงุฑุฏ ูุงููุฉ ูุชุดุบูู ุงููููุฏ - PodFitsResources) ุ ููู ุซู ูุชู ููุญ ุงูููุงุท ููู ูู ูุฐู ุงูุนูุฏ ุ ููููุง <strong>ููุฃููููุงุช</strong> (ุจูุง ูู ุฐูู ุ ูููุง ุฒุงุฏุช ุงูููุงุฑุฏ ุงููุฌุงููุฉ ููุนูุฏุฉ - ูููุง ุฒุงุฏ ุนุฏุฏ ุงูููุงุท ุงูุชู ุชู ุชุนููููุง ููุง - LeastResourceAllocation / LeastRequestedPriority / BalancedResourceAllocation) ููุชู ุชุดุบูููุง ุนูู ุงูุนูุฏุฉ ูุน ุฃูุจุฑ ุนุฏุฏ ูู ุงูููุงุท (ุฅุฐุง ูุงูุช ุนุฏุฉ ุนูุฏ ุชูู ุจูุฐุง ุงูุดุฑุท ูู ููุช ูุงุญุฏ ุ ูุณูุชู ุชุญุฏูุฏ ุนูุฏ ุนุดูุงุฆู). </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ูุฌุจ ุฃู ุชููู ุฃู ุงููุฌุฏูู ุ ุนูุฏ ุชูููู ุงูููุงุฑุฏ ุงููุชุงุญุฉ ููุนูุฏุฉ ุ ูุฑูุฒ ุนูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ูู ุงูุฎ - ุนูู ุณุจูู ุงููุซุงู  ุจูุงุณุทุฉ ููุฏุงุฑ ุงูููุฑุฏ ุงููุทููุจ / ุงูุญุฏ ููู ูุฑูุฉ ุชุนูู ุนูู ูุฐู ุงูุนูุฏุฉ ุ ูููู ููุณ ูู ุฎูุงู ุงูุงุณุชููุงู ุงููุนูู ููููุงุฑุฏ.  ูููู ุงูุญุตูู ุนูู ูุฐู ุงููุนูููุงุช ูู ุฅุฎุฑุงุฌ <code>kubectl describe node $NODE</code> ุ ุนูู ุณุจูู ุงููุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># kubectl describe nodes nxs-k8s-s1 .. Non-terminated Pods: (9 in total) Namespace Name CPU Requests CPU Limits Memory Requests Memory Limits AGE --------- ---- ------------ ---------- --------------- ------------- --- ingress-nginx nginx-ingress-controller-754b85bf44-qkt2t 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system kube-flannel-26bl4 150m (0%) 300m (1%) 64M (0%) 500M (1%) 233d kube-system kube-proxy-exporter-cb629 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system kube-proxy-x9fsc 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system nginx-proxy-k8s-worker-s1 25m (0%) 300m (1%) 32M (0%) 512M (1%) 233d nxs-monitoring alertmanager-main-1 100m (0%) 100m (0%) 425Mi (1%) 25Mi (0%) 233d nxs-logging filebeat-lmsmp 100m (0%) 0 (0%) 100Mi (0%) 200Mi (0%) 233d nxs-monitoring node-exporter-v4gdq 112m (0%) 122m (0%) 200Mi (0%) 220Mi (0%) 233d Allocated resources: (Total limits may be over 100 percent, ie, overcommitted.) Resource Requests Limits -------- -------- ------ cpu 487m (3%) 822m (5%) memory 15856217600 (2%) 749976320 (3%) ephemeral-storage 0 (0%) 0 (0%)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุฑู ุฌููุน ุงููุฑูู ุชุนูู ุนูู ุนูุฏุฉ ูุนููุฉ ุ ููุฐูู ุงูููุงุฑุฏ ุงูุชู ูุทูุจูุง ูู ูู ุงููุฑูู.  ูุฅููู ูุง ุชุจุฏู ุนููู ุณุฌูุงุช ุงููุฌุฏูู ุนูุฏ ุจุฏุก ุชุดุบูู pod cronjob-cron-events-1573793820-xt6q9 (ุชุธูุฑ ูุฐู ุงููุนูููุงุช ูู ุณุฌู ุงููุฌุฏูู ุนูุฏ ุชุนููู ุงููุณุชูู ุงูุนุงุดุฑ ูู ุชุณุฌูู ุงูุฏุฎูู ูู ูุณูุทุงุช ุฃูุฑ start - v = 10): </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุฑุณ ูุงุณุน</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">I1115 07:57:21.637791 1 scheduling_queue.go:908] About to try and schedule pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 I1115 07:57:21.637804 1 scheduler.go:453] Attempting to schedule pod: nxs-stage/cronjob-cron-events-1573793820-xt6q9 I1115 07:57:21.638285 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s5 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638300 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s6 is allowed, Node is running only 20 out of 110 Pods. I1115 07:57:21.638322 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s3 is allowed, Node is running only 20 out of 110 Pods. I1115 07:57:21.638322 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s4 is allowed, Node is running only 17 out of 110 Pods. I1115 07:57:21.638334 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s10 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638365 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s12 is allowed, Node is running only 9 out of 110 Pods. I1115 07:57:21.638334 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s11 is allowed, Node is running only 11 out of 110 Pods. I1115 07:57:21.638385 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s1 is allowed, Node is running only 19 out of 110 Pods. I1115 07:57:21.638402 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s2 is allowed, Node is running only 21 out of 110 Pods. I1115 07:57:21.638383 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s9 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638335 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s8 is allowed, Node is running only 18 out of 110 Pods. I1115 07:57:21.638408 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s13 is allowed, Node is running only 8 out of 110 Pods. I1115 07:57:21.638478 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s10 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638505 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s8 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638577 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s9 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638583 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s7 is allowed, Node is running only 25 out of 110 Pods. I1115 07:57:21.638932 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: BalancedResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 2343 millicores 9640186880 memory bytes, score 9 I1115 07:57:21.638946 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: LeastResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 2343 millicores 9640186880 memory bytes, score 8 I1115 07:57:21.638961 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: BalancedResourceAllocation, capacity 39900 millicores 66620170240 memory bytes, total request 4107 millicores 11307422720 memory bytes, score 9 I1115 07:57:21.638971 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: BalancedResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 5847 millicores 24333637120 memory bytes, score 7 I1115 07:57:21.638975 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: LeastResourceAllocation, capacity 39900 millicores 66620170240 memory bytes, total request 4107 millicores 11307422720 memory bytes, score 8 I1115 07:57:21.638990 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: LeastResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 5847 millicores 24333637120 memory bytes, score 7 I1115 07:57:21.639022 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: TaintTolerationPriority, Score: (10) I1115 07:57:21.639030 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: TaintTolerationPriority, Score: (10) I1115 07:57:21.639034 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: TaintTolerationPriority, Score: (10) I1115 07:57:21.639041 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: NodeAffinityPriority, Score: (0) I1115 07:57:21.639053 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: NodeAffinityPriority, Score: (0) I1115 07:57:21.639059 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: NodeAffinityPriority, Score: (0) I1115 07:57:21.639061 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639063 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639073 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639077 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639085 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639088 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639103 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639109 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639114 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639127 1 generic_scheduler.go:781] Host nxs-k8s-s10 =&gt; Score 100037 I1115 07:57:21.639150 1 generic_scheduler.go:781] Host nxs-k8s-s8 =&gt; Score 100034 I1115 07:57:21.639154 1 generic_scheduler.go:781] Host nxs-k8s-s9 =&gt; Score 100037 I1115 07:57:21.639267 1 scheduler_binder.go:269] AssumePodVolumes for pod "nxs-stage/cronjob-cron-events-1573793820-xt6q9", node "nxs-k8s-s10" I1115 07:57:21.639286 1 scheduler_binder.go:279] AssumePodVolumes for pod "nxs-stage/cronjob-cron-events-1573793820-xt6q9", node "nxs-k8s-s10": all PVCs bound and nothing to do I1115 07:57:21.639333 1 factory.go:733] Attempting to bind cronjob-cron-events-1573793820-xt6q9 to nxs-k8s-s10</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ููุง ูุฑู ุฃู ุงููุฌุฏูู ูููู ูู ุงูุจุฏุงูุฉ ุจุงูููุชุฑุฉ ููุดูู ูุงุฆูุฉ ูู 3 ุนูุฏ ูููู ุชุดุบูููุง (nxs-k8s-s8 ู nxs-k8s-s9 ู nxs-k8s-s10).  ุซู ูููู ุจุญุณุงุจ ุงูููุงุท ููููุง ูุนุฏุฉ ูุนููุงุช (ุจูุง ูู ุฐูู BalancedResourceAllocation ู LeastResourceAllocation) ููู ูู ูุฐู ุงูุนูุฏ ูู ุฃุฌู ุชุญุฏูุฏ ุงูุนูุฏุฉ ุงูุฃูุซุฑ ููุงุกูุฉ.  ูู ุงูููุงูุฉ ุ ูุชู ุงูุชุฎุทูุท ููุง ุชุญุช ุงูุนูุฏุฉ ุงูุชู ุชุญุชูู ุนูู ุฃูุจุฑ ุนุฏุฏ ูู ุงูููุงุท (ููุง ุ ูููู ููุนูุฏุชูู ูู ููุณ ุงูููุช ููุณ ุนุฏุฏ ุงูููุงุท 100037 ุ ูุฐูู ูุชู ุงุฎุชูุงุฑ ูุงุญุฏ ุนุดูุงุฆู - nxs-k8s-s10). </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎูุงุตุฉ</strong> : ุฅุฐุง ูุงูุช ุงููุฑูู ุชุนูู ุนูู ุงูุนูุฏุฉ ุงูุชู ูุง ุชูุฌุฏ ูููุฏ ุนูููุง ุ ูุฅู k8s (ูู ูุฌูุฉ ูุธุฑ ุงุณุชููุงู ุงูููุงุฑุฏ) ุณูููู ูุฐุง ููุงูุฆูุง ุฅุฐุง ูุงูุช ูุฐู ุงููุฑูู ุบุงุฆุจุฉ ุชูุงููุง ุนูู ูุฐู ุงูุนูุฏุฉ.  ูุฐูู ุ ุฅุฐุง ูุงู ูุฏูู ูุฑูุฉ ูุดุฑูุทุฉ ูุน ุนูููุฉ ุดุฑุณุฉ (ุนูู ุณุจูู ุงููุซุงู ุ wowza) ูููุณ ููุงู ูููุฏ ุนูู ุฐูู ุ ูุฏ ุชูุดุฃ ุญุงูุฉ ุนูุฏูุง ุ ูู ุงููุงูุน ุ ูุฏ ุฃููุช ูุงุญุฏุฉ ูู ุฌููุน ููุงุฑุฏ ุงูุนูุฏุฉ ุ ูููู ุจุงููุณุจุฉ ููุฐู k8s ุชุนุชุจุฑ ูุฐู ุงูุนูุฏุฉ ุบูุฑ ูุญููุฉ ู ุณูุชู ููุญูุง ููุณ ุนุฏุฏ ุงูููุงุท ุนูุฏ ุงูุชุฑุชูุจ (ุฃู ุจุงูููุงุท ูุน ุชูููู ุงูููุงุฑุฏ ุงููุชุงุญุฉ) ุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุนูุฏุฉ ุงูุชู ูุง ุชุญุชูู ุนูู ููุงุท ุนูู ุ ูุงูุชู ูููู ุฃู ุชุคุฏู ูู ุงูููุงูุฉ ุฅูู ุชูุฒูุน ุบูุฑ ูุชุณุงู ููุชุญููู ุจูู ุงูุนูุฏ. </p><br><h2 id="vyselenie-poda" style=";text-align:right;direction:rtl">  ุฅุฎูุงุก ุงููููุฏ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ุชุนูููู ุ ูุชู ุชุนููู ูู ูู ุงููุฑูู ูุงุญุฏุฉ ูู 3 ูุฆุงุช ุฌูุฏุฉ ุงูุฎุฏูุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>guaranuted</strong> - ูุชู ุชุนูููู ุนูุฏ ุชุนููู ุทูุจ ูุญุฏ ููู ุญุงููุฉ ูู ุงููููุฏ ููุฐุงูุฑุฉ ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ููุฌุจ ุฃู ุชุชุทุงุจู ูุฐู ุงูููู </li><li style=";text-align:right;direction:rtl">  <strong>ูุงุจู ููุงููุฌุงุฑ</strong> - ุญุงููุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ูู ุงููููุฏ ููุง ุทูุจ ูุญุฏ ุ ุจูููุง ุทูุจ &lt;ุญุฏ </li><li style=";text-align:right;direction:rtl">  <strong>ุฃูุถู ุฌูุฏ</strong> - ุนูุฏูุง ูุง ุชูุฌุฏ ุญุงููุฉ ูู ุงููููุฏ ูุญุฏูุฏุฉ ูู ุงูููุงุฑุฏ </li></ol><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ุนูุฏูุง ูููู ููุงู ููุต ูู ุงูููุงุฑุฏ (ุงููุฑุต ุ ุงูุฐุงูุฑุฉ) ุนูู ุงูุนูุฏุฉ ุ ูุจุฏุฃ kubelet ุจุชุฑุชูุจ ูุฅุฎูุงุก ุงูุณููุงุช ููููุง ูุฎูุงุฑุฒููุฉ ูุนููุฉ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฃููููุฉ pod ููุฆุฉ ุฌูุฏุฉ ุงูุฎุฏูุฉ ุงูุฎุงุตุฉ ุจู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุง ูุชุญุฏุซ ุนู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู (RAM) ุ ูุณูุชู ููุญ ููุงุท ูุฆุฉ ุฌูุฏุฉ ุงูุฎุฏูุฉ ููููุง ูููุจุฏุฃ ุงูุชุงูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ูุถููู</strong> : -998 </li><li style=";text-align:right;direction:rtl">  <strong>ุฃุญุณู ุชุฌุฑุจุฉ</strong> : 1000 </li><li style=";text-align:right;direction:rtl">  <strong>Burstable</strong> : ุฏูููุฉ (ุจุญุฏ ุฃูุตู (2 ุ 1000 - (1000 * memoryRequestBytes) / machineMemoryCapacityBytes) ุ 999) </li></ul><br><p style=";text-align:right;direction:rtl">  ุฃู  ูุน ููุณ ุงูุฃููููุฉ ุ ุณูู ูููู kubelet ุฃููุงู ุจุทุฑุฏ ุงููุฑูู ูุน ูุฆุฉ ุฌูุฏุฉ ุงูุฎุฏูุฉ ุงูุฃูุถู ูู ุงูุนูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎูุงุตุฉ</strong> : ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชูููู ุงุญุชูุงููุฉ ุฅุฎูุงุก ุงูุญุงูุธุฉ ุงููุงุฒูุฉ ูู ุงูุนูุฏุฉ ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ููุงุฑุฏ ูุงููุฉ ุนูููุง ุ ุซู ูุน ุงูุฃููููุฉ ุ ูุฌุจ ุนููู ุฃูุถูุง ุงูุนูุงูุฉ ุจุชุญุฏูุฏ ุงูุทูุจ / ุงูุญุฏ ูุฐูู. </p><br><h2 id="mehanizm-gorizontalnogo-avtomasshtabirovaniya-podov-prilozheniya-hpa" style=";text-align:right;direction:rtl">  ูููุฏ ุงูุชุทุจูู ุขููุฉ ุงูููุงุณ ุงูุชููุงุฆู ุงูุฃูููุฉ (HPA) </h2><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ุชููู ุงููููุฉ ูู ุฒูุงุฏุฉ ูุชูููู ุนุฏุฏ ุงูุณููุงุช ุชููุงุฆููุง ููููุง ูุงุณุชุฎุฏุงู ุงูููุงุฑุฏ (ุงููุธุงู - ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ / ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุฃู ุงููุณุชุฎุฏู - rps) ุ ูููู ุฃู ุชุณุงุนุฏ k8s ูุซู <strong>HPA</strong> (Horizontal Pod Autoscaler) ูู ุญููุง.  ุงูุฎูุงุฑุฒููุฉ ุงูุชู ูู ููุง ููู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุชุญุฏูุฏ ุงููุฑุงุกุงุช ุงูุญุงููุฉ ููููุฑุฏ ุงููุฑุตูุฏ (currentMetricValue) </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุญุฏูุฏ ุงูููู ุงููุทููุจุฉ ููููุฑุฏ (ุงููุฑุฌูุฉ MetricValue) ุ ูุงูุชู ุชู ุชุนููููุง ูููุงุฑุฏ ุงููุธุงู ุจุงุณุชุฎุฏุงู ุงูุทูุจ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุญุฏูุฏ ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ุงูุญุงููุฉ (currentReplicas) </li><li style=";text-align:right;direction:rtl">  ุชุญุณุจ ุงูุตูุบุฉ ุงูุชุงููุฉ ุงูุนุฏุฏ ุงููุทููุจ ูู ุงููุณุฎ ุงููุชูุงุซูุฉ (wishReplicas) <br>  wantReplicas = [currentReplicas * (currentMetricValue / desireMetricValue)] </li></ol><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูู ูุญุฏุซ ุงูููุงุณ ุนูุฏูุง ูููู ุงููุนุงูู (currentMetricValue / wishMetricValue) ูุฑูุจูุง ูู 1 (ูููููุง ุถุจุท ุงูุฎุทุฃ ุงููุณููุญ ุจู ุจุฃููุณูุง ุ ูููู ุงูุชุฑุงุถููุง ูู 0.1). </p><br><p style=";text-align:right;direction:rtl">  ุถุน ูู ุงูุงุนุชุจุงุฑ hpa ุจุงุณุชุฎุฏุงู ุชุทุจูู ุงุฎุชุจุงุฑ ุงูุชุทุจูู (ุงูููุถุญ ุจุงุณู ุงููุดุฑ) ุ ุญูุซ ูู ุงูุถุฑูุฑู ุชุบููุฑ ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ุงุนุชูุงุฏูุง ุนูู ุงุณุชููุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุจูุงู ุงูุชุทุจูู </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kind: Deployment apiVersion: apps/v1beta2 metadata: name: app-test spec: selector: matchLabels: app: app-test replicas: 2 template: metadata: labels: app: app-test spec: containers: - name: nginx image: registry.nixys.ru/generic-images/nginx imagePullPolicy: Always resources: requests: cpu: 60m ports: - name: http containerPort: 80 - name: nginx-exporter image: nginx/nginx-prometheus-exporter resources: requests: cpu: 30m ports: - name: nginx-exporter containerPort: 9113 args: - -nginx.scrape-uri - http://127.0.0.1:80/nginx-status</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูุฑู ุฃูู ูุน ุงูุชุทุจูู ุ ูุชู ุชุดุบููู ูุจุฏุฆููุง ูู ุญุงูุชูู ุ ูู ูุงุญุฏุฉ ูููุง ุชุญุชูู ุนูู ุญุงููุชูู nginx ู nginx-source ุ ููู <strong>ุทูุจ</strong> ูู <strong>ุทูุจุงุช</strong> ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  HPA ูุงุถุญ </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: autoscaling/v2beta2 kind: HorizontalPodAutoscaler metadata: name: app-test-hpa spec: maxReplicas: 10 minReplicas: 2 scaleTargetRef: apiVersion: extensions/v1beta1 kind: Deployment name: app-test metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 30</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู  ุฃูุดุฃูุง hpa ุงูุฐู ุณูุฑุงูุจ ุงุฎุชุจุงุฑ ุงูุชุทุจูู Deployment ูุถุจุท ุนุฏุฏ ุงููููุฏ ูุน ุงูุชุทุจูู ุจูุงุกู ุนูู ูุคุดุฑ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (ูุชููุน ุฃู ุชุณุชููู ุงููููุฏ 30ูช ูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุงูุชู ุชุทูุจูุง) ุ ุจูููุง ูููู ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ูู ุญุฏูุฏ 2-10. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุ ุณููุธุฑ ูู ุขููุฉ ุชุดุบูู HPA ุฅุฐุง ูููุง ุจุชุทุจูู ุนุจุก ุนูู ุฃุญุฏ ุงููููุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># kubectl top pod NAME CPU(cores) MEMORY(bytes) app-test-78559f8f44-pgs58 101m 243Mi app-test-78559f8f44-cj4jz 4m 240Mi</span></span></code> </pre> <br></li></ul><br><p style=";text-align:right;direction:rtl">  ุงููุฌููุน ูุฏููุง ูุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููููุฉ ุงููุทููุจุฉ (wishMetricValue) - ููููุง ูุฅุนุฏุงุฏุงุช hpa ุ ูุฏููุง 30ูช </li><li style=";text-align:right;direction:rtl">  ุงููููุฉ ุงูุญุงููุฉ (currentMetricValue) - ููุญุณุงุจ ุ ูููู ูุฏูุฑ ุงูุชุญูู ุจุญุณุงุจ ูุชูุณุท โโูููุฉ ุงุณุชููุงู ุงูููุงุฑุฏ ูููช ุ ุฃู  ูู ูุดุฑูุท ุจูุง ููู: <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุงูููู ุงููุทููุฉ ูููุงููุณ ุงููููุฏ ูู ุฎุงุฏู ุงูููุงุณ ุ ุฃู  101 ู ู 4 ู </li><li style=";text-align:right;direction:rtl">  ูุญุณุจ ูุชูุณุท โโุงููููุฉ ุงููุทููุฉ ุ ุฃู  (101 ู + 4 ู) / 2 = 53 ู </li><li style=";text-align:right;direction:rtl">  ุงูุญุตูู ุนูู ุงููููุฉ ุงููุทููุฉ ูุงุณุชููุงู ุงูููุฑุฏ ุงููุทููุจ (ููุฐุง ุ ูุชู ุชูุฎูุต ุทูุจ ุฌููุน ุงูุญุงููุงุช) 60m + 30m = 90m </li><li style=";text-align:right;direction:rtl">  ูุญุณุจ ูุชูุณุท โโูุณุจุฉ ุงุณุชููุงู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจุงููุณุจุฉ ุฅูู ุทูุจ ุงููููุฏ  53 ู / 90 ู * 100 ูช = 59 ูช </li></ol></li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฏููุง ูู ูุง ูู ุถุฑูุฑู ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุชุบููุฑ ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ุ ูุฐูู ูุญุณุจ ุงููุนุงูู: </p><br><p style=";text-align:right;direction:rtl"> <code>ratio = 59% / 30% = 1.96</code> </p> <br><p style=";text-align:right;direction:rtl">  ุฃู  ูุฌุจ ุฒูุงุฏุฉ ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ~ 2 ูุฑุงุช ูุชุดูู [2 * 1.96] = 4. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎูุงุตุฉ:</strong> ููุง ุชุฑูู ุ ูู ุฃุฌู ุฃู ุชุนูู ูุฐู ุงูุขููุฉ ุ ููุงู ุดุฑุท ูุณุจู ูุดูู ุชูุงูุฑ ุงูุทูุจุงุช ูุฌููุน ุงูุญุงููุงุช ูู ุงููููุฏ ุงููุฑุตูุฏ. </p><br><h2 id="mehanizm-gorizontalnogo-avtomasshtabirovaniya-nod-cluster-autoscaler" style=";text-align:right;direction:rtl">  ุขููุฉ ุงูููุงุณ ุงูุชููุงุฆู ุงูุฃููู ููุนูุฏ (Cluster Autoscaler) </h2><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุชุญููุฏ ุงูุชุฃุซูุฑ ุงูุณูุจู ุนูู ุงููุธุงู ุฃุซูุงุก ุฑุดูุงุช ุงูุญูู ุ ูุฅู ูุฌูุฏ hpa ุงูููููู ูุง ูููู.  ุนูู ุณุจูู ุงููุซุงู ุ ููููุง ููุฅุนุฏุงุฏุงุช ูู ุฅุฏุงุฑุฉ ูุญุฏุฉ ุงูุชุญูู hpa ุชูุฑุฑ ุฃู ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ูุญุชุงุฌ ุฅูู ูุถุงุนูุฉ ุ ููุน ุฐูู ุ ูุง ุชูุฌุฏ ููุงุฑุฏ ูุฌุงููุฉ ุนูู ุงูุนูุฏ ูุชุดุบูู ูุซู ูุฐุง ุงูุนุฏุฏ ูู ุงููุฑูู (ุฃู ุ ูุง ูููู ููุนูุฏุฉ ุชูููุฑ ุงูููุงุฑุฏ ุงููุทููุจุฉ ูุทูุจุงุช pod) ููุฐู ุฃุฏุฎู ุญุงูุฉ ุงูุงูุชุธุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุญุงูุฉ ุ ุฅุฐุง ูุงู ูุฏู ุงููุฒูุฏ IaaS / PaaS ุงูููุงุณุจ (ุนูู ุณุจูู ุงููุซุงู ุ GKE / GCE ุ AKS ุ EKS ุ ุฅูุฎ) ุ ูููู ุฃู ุชุณุงุนุฏูุง ุฃุฏุงุฉ ูุซู <strong>Node Autoscaler</strong> .  ูุณูุญ ูู ุจุชุนููู ุงูุญุฏ ุงูุฃูุตู ูุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุนูุฏ ูู ุงููุชูุฉ ูุถุจุท ุงูุนุฏุฏ ุงูุญุงูู ููุนูุฏ ุชููุงุฆููุง (ุนู ุทุฑูู ุงููุตูู ุฅูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ููุฒูุฏ ุงูุฎุฏูุฉ ุงูุณุญุงุจูุฉ ูุทูุจ / ุญุฐู ุงูุนูุฏ) ุนูุฏูุง ูููู ููุงู ููุต ูู ุงูููุงุฑุฏ ูู ุงููุฌููุนุฉ ููุง ูููู ุฌุฏููุฉ ุงูุจุฑุงูุฌ (ูู ุญุงูุฉ ุงูุงูุชุธุงุฑ). </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฎูุงุตุฉ: ูู</strong> ุฃุฌู ุงูุชููู ูู ููุงุณ ุงูุนูุฏ ุชููุงุฆููุง ุ ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ุงูุทูุจุงุช ูู ุญุงููุงุช ุงููููุฏ ุญุชู ุชุชููู K8s ูู ุชูููู ุญูู ุงูุนูุฏ ุจุดูู ุตุญูุญ ุ ูุจุงูุชุงูู ุงูุฅุจูุงุบ ุนู ุนุฏู ูุฌูุฏ ููุงุฑุฏ ูู ุงููุฌููุนุฉ ูุจุฏุก ุงููููุฏ ุงูุชุงูู. </p><br><hr><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุชุญุฏูุฏ ุญุฏูุฏ ุงูููุงุฑุฏ ููุญุงููุฉ ููุณ ุดุฑุทูุง ุฃุณุงุณููุง ูุจุฏุก ุชุดุบูู ุงูุชุทุจูู ุจูุฌุงุญ ุ ูููู ูุง ูุฒุงู ูู ุงูุฃูุถู ุงูููุงู ุจุฐูู ููุฃุณุจุงุจ ุงูุชุงููุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุนูููุฉ ุฌุฏููุฉ ุฃูุซุฑ ุฏูุฉ ูู ุญูุซ ููุงุฒูุฉ ุงูุชุญููู ุจูู ุงูุนูุฏ k8s </li><li style=";text-align:right;direction:rtl">  ูุชูููู ุงุญุชูุงููุฉ ุญุฏูุซ ุนูููุฉ ุฅุฎูุงุก ุงููููุฏ </li><li style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ููููุฏ ุชุทุจููุงุช ุงูููุงุณ ุงูุชููุงุฆู ุงูุฃููู (HPA) </li><li style=";text-align:right;direction:rtl">  ููุชุญุฌูู ุงูุชููุงุฆู ุงูุฃููู ููุนูุฏ (Cluster Autoscaling) ููููุฑู ุงูุฎุฏูุงุช ุงูุณุญุงุจูุฉ </li></ol><br><h2 id="takzhe-chitayte-drugie-stati-v-nashem-bloge" style=";text-align:right;direction:rtl">  ุงูุฑุฃ ุฃูุถูุง ููุงูุงุช ุฃุฎุฑู ุนูู ูุฏููุชูุง: </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/481992/">Tekton Pipeline - ุฎุทูุท ุฃูุงุจูุจ Kubernetes ุงูุฃุตููุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/473578/">ุจูุงุก ูุญุฏุงุช ุฏููุงููููุฉ ู Nginx</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/468779/">ูุง ูุงู ูุชูุฌุฉ ุงูุชุฑุญูู ูู ClickHouse ุฏูู ุงูุญุตูู ุนูู ุฅุฐู ูู ClickHouse ุจุชุฑุฎูุต</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/461723/">ููู ุญุฒูุฉ ุงูุณูุงู ูู Golang</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/437372/">ุซูุงุซุฉ ุญูู ุจุณูุทุฉ ููุญุฏ ูู ุงูุตูุฑ ุนุงูู ูููุงุก</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/company/nixys/blog/424717/">ุงููุณุฎ ุงูุงุญุชูุงุทู ูุนุฏุฏ ูุจูุฑ ูู ูุดุงุฑูุน ุงูููุจ ุบูุฑ ุงููุชุฌุงูุณุฉ</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar480072/">https://habr.com/ru/post/ar480072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar480060/index.html">ุจุณูุท P300 ุงููุตูู ุนูู ุงูุจูุงูุงุช ุงูููุชูุญุฉ</a></li>
<li><a href="../ar480062/index.html">10 ุฃูุธูุฉ ุชุญูู. ุฃูู ูู ุฃูุซุฑ ููุงุกูุฉ ููุชูุงุตู ูู ุงูููุงู ููุดุงุฑูุฉ ุงููููุงุชุ</a></li>
<li><a href="../ar480064/index.html">ุชุนูู ุงููููุงุช ูุฌูุนุฉ ุญุณุจ ุงูููุถูุน</a></li>
<li><a href="../ar480068/index.html">[ุชุญุฏูุซ] ุชุนุฑุถ ุดุนุจูุง ููุถุฑุจ ุ ูุณูู ูููู ุตุงูุชููุ</a></li>
<li><a href="../ar480070/index.html">ุฑุฏ ูุนู ุงูููุงุฆุฏ: ูุนูุฉ ููุดุฑูุงุชุ</a></li>
<li><a href="../ar480076/index.html">ูุนุงูุฌุฉ ูุชูููู ุงูุจูุงูุงุช ูู ูุตุงุฏุฑ ูุฎุชููุฉ</a></li>
<li><a href="../ar480078/index.html">ููุชุจุงุช ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุงูุฌุฏูุฏุฉ ูู React ุงูุทุฑููุฉ</a></li>
<li><a href="../ar480080/index.html">ูุงุฐุง ุชุญุชุงุฌ ูู ุชุฏููู ุงูููุงุญุธุงุชุ</a></li>
<li><a href="../ar480082/index.html">ุงุณุชุฎุฏุงู ุงูุชูุณูู ูู MySQL for Zabbix ูุน ุนุฏุฏ ูุจูุฑ ูู ูุงุฆูุงุช ุงููุฑุงูุจุฉ</a></li>
<li><a href="../ar480086/index.html">ููููุฉ ุงูุงูุชุซุงู ููุชุทูุจุงุช 152-FZ ุ ูุญูุงูุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ ูุนููุงุฆูุง ูููุณ ุฎุทูุฉ ุนูู ุฃุดุนู ุงููุงุฑ ูุฏููุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>