<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶è üõ°Ô∏è üßôüèæ Transferir servi√ßo da web para o Yandex.Cloud com a AWS üë©üèº‚Äçüíª üõµ üíÉüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! Meu nome √© Vitaly Davydov, sou o fundador da Poteha Labs. 

 No final do ano passado, a Yandex lan√ßou um novo produto para desenvolvedore...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transferir servi√ßo da web para o Yandex.Cloud com a AWS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440054/"> Ol√° pessoal!  Meu nome √© Vitaly Davydov, sou o fundador da Poteha Labs. <br><br>  No final do ano passado, a Yandex lan√ßou um novo produto para desenvolvedores - o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex</a> , que fornece energia de computa√ß√£o e servi√ßos relacionados para processamento e armazenamento de dados.  Neste artigo, falarei sobre como avaliamos a transfer√™ncia de um de nossos projetos para a nuvem, seus recursos e tarifas. <br><br><img src="https://habrastorage.org/webt/jp/oy/k3/jpoyk3haeubxjlomuswoi0g25sm.png" alt="Vis√£o geral do Yandex.Clouds"><br><a name="habracut"></a><br>  Existem duas maneiras de implantar seu servi√ßo da Web ou aplicativo m√≥vel.  Vejamos um exemplo de banco de dados (como uma das partes de um servi√ßo da web): <br><br><ul><li>  <b>Autogerenciamento</b> - alugue um carro e implante seu PostgreSQL nele.  Seu postgres tem seus pr√≥s e contras: se as cargas forem pequenas, essa solu√ß√£o ser√° suficiente.  Por√©m, quanto maiores os volumes, mais manuten√ß√£o √© necess√°ria e, em algum momento, voc√™ precisar√° de um engenheiro de DevOps separado. </li><li>  <b>Totalmente gerenciado</b> - escolha um provedor de nuvem e use o PostgreSQL como um servi√ßo.  Nesse caso, o provedor de nuvem assume o suporte de toda a infraestrutura e garante que tudo funcione de acordo com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SLA</a> (acordo sobre o n√≠vel de presta√ß√£o do servi√ßo, que limita o <i>tempo m√°ximo de indisponibilidade, o tempo m√°ximo m√°ximo de indisponibilidade por um per√≠odo</i> ).  Sem problemas com o suporte √† infraestrutura. </li></ul><br>  Quem escolhe a op√ß√£o de nuvem est√° familiarizado com os tr√™s principais principais provedores de servi√ßos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Microsoft Azure</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Amazon Web Services (AWS)</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google Cloud</a> .  Eles fornecem um n√∫mero ilimitado de m√°quinas virtuais e dezenas de servi√ßos convenientes e, dentre tr√™s op√ß√µes, voc√™ pode escolher a solu√ß√£o adequada ao pre√ßo.  Normalmente, trabalhamos com a AWS, que recentemente apresenta v√°rios inconvenientes quando usado na R√∫ssia. <br><br>  O primeiro recurso da AWS na R√∫ssia est√° associado a bloqueios ativos de ILV, dos quais muitos servi√ßos sofreram em 2018, desde startups a sistemas banc√°rios ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Viber, Skyeng e outros</a> ). <br><br>  Al√©m disso, desde o in√≠cio de 2019, a Amazon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">come√ßou a cobrar</a> IVA (20% do pre√ßo) das empresas russas pelo uso de suas solu√ß√µes em nuvem.  Isso n√£o √© espec√≠fico da Amazon: o IVA j√° √© coletado pela Microsoft, Google e outras empresas estrangeiras da Internet; no entanto, em qualquer caso, √© um aumento desagrad√°vel nos pre√ßos das empresas pelo conjunto de servi√ßos usual. <br><br>  Al√©m de empresas internacionais conhecidas, tamb√©m existe o mercado russo para sistemas em nuvem: a plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mail.Ru Cloud Solutions</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Selectel</a> e alguns players menores.  Enquanto muitos fornecem apenas aluguel de ferro, o que n√£o √© igual √† computa√ß√£o em nuvem.  Uma nuvem completa fornece n√£o apenas carros de aluguel, mas tamb√©m um conjunto de servi√ßos para simplificar a infraestrutura (por exemplo, como bancos de dados gerenciados). <br><br><h3>  Mercado russo </h3><br>  Na R√∫ssia, as solu√ß√µes completas de nuvem s√£o poucas (a saber, duas): MCS do mail.ru e o rec√©m-lan√ßado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex</a> . <br><br>  A Yandex aborda a quest√£o da presta√ß√£o de servi√ßos para arrendar o ecossistema de servi√ßos.  Uma nuvem pronta para uso n√£o oferece tantos servi√ßos quanto na AWS: computadores, armazenamento de dados, bancos de dados, balanceador de carga (alfa), orquestra√ß√£o de cont√™iner (alfa), planeja adicionar uma plataforma sem servidor.  O conjunto de servi√ßos proposto permite projetar e dimensionar um grande n√∫mero de solu√ß√µes de neg√≥cios mais rapidamente do que em sua pr√≥pria infraestrutura, e o n√∫mero de servi√ßos tamb√©m est√° em constante crescimento.  O Cloud possui tr√™s datacenters, para que voc√™ possa criar sistemas distribu√≠dos geograficamente. <br><br>  No final de 2018, o Cloud lan√ßou publicamente e abriu primeiro uma conex√£o de programa de parceria (na qual <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nos</a> tornamos um dos primeiros parceiros) e, a partir de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7 de dezembro de 2018</a> , tornou-se dispon√≠vel para todos.  Quando voc√™ se conecta agora, o Cloud concede aos usu√°rios uma concess√£o por conhecimento - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4000 rublos por 2 meses</a> .  Gra√ßas ao acesso antecipado, analisamos as oportunidades, tarifas e fizemos c√°lculos para transferir um de nossos servi√ßos da AWS para a nuvem. <br><br><h3>  Arquitetura </h3><br>  Agora, nosso servi√ßo da Web trabalha em produ√ß√£o na AWS e consiste em dois componentes: frente e verso; portanto, consideraremos a transfer√™ncia para o componente Cloud por componente.  Migramos o aplicativo com a seguinte pilha de tecnologia: <br><br>  - <b>Frontend</b> .  Escrito em React, a renderiza√ß√£o ocorre no cliente.  Arquivos est√°ticos (html, scripts e estilos) s√£o armazenados no Simple Storage Service (S3). <img src="https://habrastorage.org/webt/0f/or/gq/0forgqeox8rhmdvmyto_vz-krw4.jpeg" alt="Arquitetura de front-end da AWS"><br><br>  - <b>Back</b> - <b>end</b> .  Um aplicativo django que √© executado em cont√™ineres de encaixe nas m√°quinas virtuais do Elastic Compute Cloud (EC2).  As m√°quinas s√£o gerenciadas pelo Elastic Container Service (ECS, um orquestrador de cont√™ineres gratuito), para bancos de dados que usamos o PostgreSQL no Relational Database Service (RDS).  Para balanceamento de carga - Elastic Load Balancer (ELB). <img src="https://habrastorage.org/webt/61/cm/a0/61cma02fgqcbpa1w1b94xdxerky.jpeg" alt="Arquitetura de back-end da AWS"><br>  Implementamos o aplicativo por meio do GitLab CI, usando a AWS CLI para atualizar o servi√ßo no ECS e a est√°tica no S3. <br><br>  Como ser√° a arquitetura do servi√ßo no Yandex.Cloud: <br><br>  - <b>Frontend</b> .  Em vez do S3, o Yandex Object Storage √© usado, no qual voc√™ tamb√©m pode distribuir as estat√≠sticas do site. <img src="https://habrastorage.org/webt/rg/rx/hg/rgrxhgth9iwtiucnq_8jr5cwr08.jpeg" alt="Arquitetura de front-end no Yandex.Cloud"><br><br>  - <b>Back</b> - <b>end</b> .  Em vez do EC2, o Yandex Compute Cloud √© usado, com estrutura semelhante: tamb√©m h√° armazenamento em bloco, que existe separadamente das m√°quinas.  A nuvem n√£o possui um an√°logo do ECS pronto para uso agora (mas na vers√£o alfa existem Grupos de Inst√¢ncias Yandex, com base nos quais eles prometem apresentar um servi√ßo de cont√™iner gerenciado).  Portanto, por enquanto, em vez do ECS, voc√™ precisa usar o Kubernetes ou o Rancher, que voc√™ precisa implantar.  O Yandex Load Balancer na nuvem tamb√©m est√° em alfa; portanto, por enquanto, voc√™ pode usar o nginx, erguido em uma m√°quina separada, como o balanceador.  Para o PostgreSQL, a Cloud possui o Servi√ßo Gerenciado Yandex para o PostgreSQL. <img src="https://habrastorage.org/webt/ji/sg/h-/jisgh-eaukttdx3nrpggc7yahhw.jpeg" alt="Arquitetura de back-end no Yandex.Cloud"><br><br><h3>  Estimativa de custo </h3><br>  Depois de estudar a arquitetura poss√≠vel, fizemos um c√°lculo estimado do custo do servi√ßo na nuvem ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as taxas oficiais est√£o aqui</a> ).  Na tabela abaixo, o custo aproximado de cada elemento para o nosso servi√ßo (os pre√ßos s√£o indicados sem IVA). <br><br><table><tbody><tr><th rowspan="2">  O que </th><th colspan="2">  Quanto, esfregue.  ($) / m√™s </th></tr><tr><th>  Aws </th><th>  Yandex Cloud </th></tr><tr><td>  Balanceador de carga <br>  (1 pc., 1 GB de RAM, 1vCPU 100%, 10 GB SSD) </td><td>  1.300 (20) </td><td>  630 (10) </td></tr><tr><td>  Inst√¢ncias de aplicativos <br>  (2 pcs., 4 GB de RAM, 1vCPU 100%, 20 GB SSD) </td><td>  7.400 (115) </td><td>  2.350 (36) </td></tr><tr><td>  Inst√¢ncia para o cont√™iner ORE <br>  (Rancheiro) </td><td>  - </td><td>  630 (10) </td></tr><tr><td>  Bases de dados <br>  (2 pcs, 4 GB de RAM, 1vCPU 100%, 100 GB SSD) </td><td>  12.800 (198) </td><td>  630 (10) </td></tr><tr><td>  Armazenamento de objetos <br>  (10 GB, 1.000.000 PUT, 10.000.000 GET) </td><td>  585 (9) </td><td>  470 (7) </td></tr><tr><td>  IP p√∫blico <br>  (2 pe√ßas. AWS, 4 pe√ßas. Yandex. Nuvem) </td><td>  470 (7) </td><td>  380 (6) </td></tr><tr><td>  Tr√°fego de sa√≠da <br>  (500 GB) </td><td>  2 925 (45) </td><td>  635 (10) </td></tr><tr><td>  <b>Total</b> </td><td>  <b>25 480 esfregar.</b>  <b>($ 392)</b> </td><td>  <b>9 695 esfregar.</b>  <b>($ 149)</b> </td></tr></tbody></table><br>  Para nossos par√¢metros, a nuvem era 2,6 vezes mais barata que a AWS.  O financiamento da transi√ß√£o para a nuvem para o servi√ßo √© definitivamente lucrativo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√°lculos</a> detalhados para a nuvem, para a AWS voc√™ pode usar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">calculadora on</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">line</a> ). <br><br><h3>  Recursos dos servi√ßos Yandex.Cloud </h3><br><ul><li>  O Yandex Compute Cloud difere do EC2, pois no EC2 voc√™ pode aumentar o poder de uma m√°quina por RAM e CPU apenas ao mesmo tempo, e na nuvem eles s√£o independentes (para cada vCPU voc√™ pode escolher de 1 a 8 GB de RAM), o que oferece mais flexibilidade. </li><li>  O Yandex Object Storage √© compat√≠vel com a API S3.  Das desvantagens, ainda n√£o √© poss√≠vel configurar um certificado https no seu dom√≠nio.  O problema foi resolvido usando o certificado Cloudflare e o tr√°fego do usu√°rio para a camada API externa ser√° protegido.  Esta √© uma op√ß√£o r√°pida e f√°cil.  Voc√™ tamb√©m pode configurar a renderiza√ß√£o do lado do servidor, por isso estamos aguardando a nuvem adicionar esse recurso. </li><li>  A nuvem ainda n√£o possui um servi√ßo para coleta de logs centralizada ass√≠ncrona (um an√°logo do AWS CloudWatch); portanto, para coletar e analisar logs, √© necess√°rio conectar solu√ß√µes de terceiros. </li><li>  Controle de acesso a recursos: na AWS, isso √© feito por meio de fun√ß√µes criadas no servi√ßo Gerenciamento de Identidade e Acesso (IAM) e automaticamente atribu√≠das a todas as inst√¢ncias no cluster do ECS.  A nuvem tamb√©m possui seu pr√≥prio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IAM</a> , mas os direitos granulares, como na AWS, ainda n√£o est√£o dispon√≠veis. </li><li>  Embora n√£o haja m√°quinas GPU para computa√ß√£o. </li></ul><br><h3>  Conclus√£o </h3><br>  Concluindo, destacamos os motivos para experimentar o Yandex Cloud: <br><br><ul><li>  Conjunto potencialmente grande de servi√ßos de infraestrutura; </li><li>  A API compat√≠vel com a AWS est√° dispon√≠vel para alguns servi√ßos, o que simplifica bastante a transi√ß√£o; </li><li>  As tarifas s√£o mais baixas do que as de suas contrapartes ocidentais; n√£o h√° conex√£o com a taxa de c√¢mbio do d√≥lar; </li><li>  Prote√ß√£o contra bloqueios repentinos; </li><li>  Um data center na R√∫ssia, gra√ßas ao qual a lei de prote√ß√£o de dados pessoais dos usu√°rios √© sempre implementada. </li></ul><br>  Para 2019, a Cloud tem grandes planos de lan√ßar os servi√ßos anunciados e adicionar novos.  Pensamos que, com esse conjunto de caracter√≠sticas e tarifas, ele poder√° se tornar um forte concorrente da Amazon no mercado russo. <br><br>  Obrigado por sua aten√ß√£o, vou responder perguntas nos coment√°rios. <br><br>  <i>Agradecemos a Wife ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">pruzhinkina</a> ) e Kirill ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">kpotehin</a> ) por sua ajuda na prepara√ß√£o da revis√£o</i> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440054/">https://habr.com/ru/post/pt440054/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440044/index.html">Hist√≥rico detalhado da Qualcomm</a></li>
<li><a href="../pt440046/index.html">Li√ß√£o aberta "Criando clientes REST no Spring"</a></li>
<li><a href="../pt440048/index.html">M√©tricas favoritas: 5 indicadores que toda equipe de vendas deve seguir</a></li>
<li><a href="../pt440050/index.html">Proxies DNS do tipo Fa√ßa Voc√™ Mesmo no Node.JS</a></li>
<li><a href="../pt440052/index.html">An√°lise est√°tica do BIOS / UEFI ou como obter um gr√°fico de depend√™ncia</a></li>
<li><a href="../pt440058/index.html">Relat√≥rio de problemas e disponibilidade da Internet 2018‚Äì2019</a></li>
<li><a href="../pt440060/index.html">TensorFlow no Apache Ignite</a></li>
<li><a href="../pt440062/index.html">Planejando com prazer. Como configuramos processos sem gerentes</a></li>
<li><a href="../pt440064/index.html">Data centers √† sua escolha: Londres, Moscou, Zurique, S√£o Petersburgo</a></li>
<li><a href="../pt440066/index.html">Extens√µes VSCode para facilitar o desenvolvimento de JavaScript e Vue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>