<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóëÔ∏è üñ®Ô∏è üíÉ Bagaimana kami menembus Great Chinese Firewall (Bagian 1) üè§ üë©‚Äçüëß üèä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! 


 Sentuhan Nikita adalah seorang insinyur sistem dari SEMrush . Hari ini saya akan memberi tahu Anda tentang bagaimana kami menghadap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana kami menembus Great Chinese Firewall (Bagian 1)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/semrush/blog/458602/"><p>  Halo semuanya! </p><br><p>  Sentuhan Nikita adalah seorang insinyur sistem dari <strong>SEMrush</strong> .  Hari ini saya akan memberi tahu Anda tentang bagaimana kami menghadapi tugas memastikan stabilitas layanan semrush.com kami di Cina, dan masalah apa yang kami temui selama penerapannya (mengingat lokasi pusat data kami di pantai timur AS). </p><br><p>  Ini akan menjadi kisah yang hebat, dibagi menjadi beberapa artikel.  Saya akan memberi tahu Anda bagaimana semuanya terjadi pada kami: dari layanan yang sama sekali tidak bekerja dari Tiongkok hingga kinerja layanan di tingkat versi Amerika untuk orang Amerika.  Saya berjanji ini akan menarik dan bermanfaat.  Jadi ayo pergi. </p><br><img src="https://habrastorage.org/webt/cv/6s/sv/cv6ssvuv-od31op6cjnadtw6xsy.png"><br><h2 id="problemy-kitayskogo-interneta">  Masalah internet Cina </h2><br><p>  Bahkan orang yang paling jauh dari spesifikasi administrasi jaringan setidaknya pernah mendengar tentang <strong>Great Chinese Firewall</strong> .  Eh, kedengarannya keren, ya?  Tapi apa itu, bagaimana cara kerjanya sebenarnya adalah pertanyaan yang agak rumit.  Di Internet Anda dapat menemukan banyak artikel tentang ini, tetapi dari sudut pandang teknis, perangkat firewall ini tidak dijelaskan di mana pun.  Namun, yang tidak mengejutkan.  Saya langsung mengakui bahwa, berdasarkan hasil tahun kerja, saya tidak bisa mengatakan dengan tepat bagaimana cara kerjanya, tetapi saya bisa memberi tahu tentang komentar dan kesimpulan praktis saya.  Dan kita akan mulai dengan rumor tentang firewall ini. </p><a name="habracut"></a><br><p>  Ada banyak rumor tentang firewall ini.  Mari kita kumpulkan yang utama dan paling menarik dari mereka ke dalam satu daftar: </p><br><ul><li>  Google, Facebook, Twitter, dan layanan serupa lainnya diblokir dan tidak berfungsi di Cina. </li><li>  Setiap lalu lintas yang pergi ke luar Cina dan ke China diurai dan dibatasi oleh pembelajaran mesin (dalam hal lalu lintas yang mencurigakan), yang sangat memperlambatnya (lalu lintas) melewati perbatasan. </li><li>  Badan intelijen Cina membongkar semua lalu lintas terenkripsi yang melewati firewall mereka. </li><li>  Terowongan VPN, terowongan IPSEC tidak stabil, jatuh dan terus-menerus diblokir. </li><li>  Semakin sederhana enkripsi, semakin sederhana frasa sandi yang digunakan untuk otentikasi / sandi lalu lintas, semakin cepat ia melewati firewall Cina. </li></ul><br><p>  Inilah yang berhasil kami ketahui tentang rumor ini: </p><br><ul><li>  Google, Facebook, Twitter, dan layanan serupa lainnya benar-benar diblokir (KO Anda), tetapi banyak domain teknis Google, misalnya, tidak dilarang dan berfungsi (gstatic.com yang sama).  Ini mengarah pada kesimpulan: jangan sembarangan memotong semua Google dan sumber daya lain yang tampaknya diblokir, tampaknya diblokir. </li><li>  Setiap lalu lintas yang melewati perbatasan benar-benar menambah waktu yang serius.  Lihatlah dua hasil.  Satu situs, satu halaman, dapatkan <em>ikal</em> sederhana.  Pengukuran pertama dari Cina itu sendiri (kota Shenzhen yang indah).  Yang kedua membeku di luar dari Hong Kong (memiliki kedaulatan, dan tidak ada firewall antara itu dan dunia).  Jarak antara kota-kota di garis lurus adalah sekitar 30-40 km. </li></ul><br><pre><code class="bash hljs">nikita@china-shenzhen:~<span class="hljs-comment"><span class="hljs-comment"># curl -o /dev/null -w@curl_time "https://www.semrush.com/info/ebay.com" % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 381k 0 381k 0 0 71824 0 --:--:-- 0:00:05 --:--:-- 82832 time_namelookup: 0.004500 time_connect: 0.169342 time_appconnect: 0.723189 time_pretransfer: 0.723499 time_redirect: 0.000000 time_starttransfer: 1.532912 ---------- time_total: 5.443407 ---------- size_download: 390968 Bytes speed_download: 71824.000B/s nikita@china-hongkong:~# curl -o /dev/null -w@curl_time "https://www.semrush.com/info/ebay.com" % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 319k 0 319k 0 0 2555k 0 --:--:-- --:--:-- --:--:-- 2573k time_namelookup: 0.029366 time_connect: 0.030742 time_appconnect: 0.047310 time_pretransfer: 0.047388 time_redirect: 0.000000 time_starttransfer: 0.120793 ---------- time_total: 0.124871 ---------- size_download: 326755 Bytes speed_download: 2616740.000B/s</span></span></code> </pre> <br><p>  Perhatikan <strong>time_connect</strong> .  Dan secara umum, Anda melihat hasilnya: firewall menambahkan 4 detik ekstra, yang sangat panjang. </p><br><ul><li>  Terowongan VPN dan IPSEC sering jatuh.  Saya akan membicarakan hal ini nanti dan lebih terinci.  Server VPN yang digunakan oleh pengguna diblokir dari waktu ke waktu (biasanya dalam satu hari setelah dimulainya penggunaan). </li><li>  Ada pendapat yang diterima dari orang-orang yang tinggal di China bahwa semakin mudah enkripsi lalu lintas, semakin cepat melewati perbatasan, karena mudah dipahami bahwa tidak ada yang ilegal di dalamnya.  Dan sama seperti lalu lintas "bersih" mendapat lebih banyak bandwidth dan kecepatan, dan lalu lintas "kotor", yang tidak menghasilkan apa-apa, sebaliknya mendapat umpan lambat.  Sebagai contoh, saya akan membawa curl ke <em>ifconfig.co</em> menggunakan protokol HTTPS dan HTTP. </li></ul><br><pre> <code class="bash hljs">curl -o /dev/null -w@curl_time <span class="hljs-string"><span class="hljs-string">"https://ifconfig.co/"</span></span> % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 13 100 13 0 0 2 0 0:00:06 0:00:05 0:00:01 3 time_namelookup: 0.004305 time_connect: 0.397465 time_appconnect: 5.149305 time_pretransfer: 5.149393 time_redirect: 0.000000 time_starttransfer: 5.568847 ---------- time_total: 5.568893 ---------- size_download: 13 Bytes speed_download: 2.000B/s curl -o /dev/null -w@curl_time <span class="hljs-string"><span class="hljs-string">"http://ifconfig.co/"</span></span> % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 13 100 13 0 0 28 0 --:--:-- --:--:-- --:--:-- 28 time_namelookup: 0.004282 time_connect: 0.212457 time_appconnect: 0.000000 time_pretransfer: 0.212484 time_redirect: 0.000000 time_starttransfer: 0.450565 ---------- time_total: 0.450620 ---------- size_download: 13 Bytes speed_download: 28.000B/s</code> </pre> <br><p>  Perbedaannya adalah 5 detik untuk total waktu muat 13 byte.  Saat melakukan tes ini beberapa kali, Anda dapat melihat bahwa GET pada HTTP selesai secara umum dalam waktu yang sama setiap waktu, saat menggunakan HTTPS situs terkadang merespons dalam 3, 5, 10, dan bahkan 17 detik.  Kesalahan SSL terkadang terjadi: </p><br><p> <code>Unknown SSL protocol error in connection to ifconfig.co:443.</code> </p> <br><p>  Jadi apa yang kita miliki: </p><br><ul><li>  Masalah yang dibuat oleh firewall Cina yang dijelaskan di atas. </li><li>  Ping ke sumber daya eksternal dan terowongan di dalam menghilang secara berkala. </li><li>  Latensi antara dua titik terus berubah, dan seringkali tidak dapat diprediksi.  Dengan menghubungkan berbagai kota / wilayah, Anda berharap bahwa berdasarkan lokasi geografis dari wilayah tersebut, penundaannya akan berkurang, dan Anda mendapatkan situasi yang sebaliknya. </li><li>  Saluran Internet dan komunikasi cepat atau lambat.  Ada sedikit ketergantungan pada waktu hari dan hari dalam seminggu, tetapi tidak selalu. </li><li>  Permintaan DNS ke dunia luar dari Tiongkok terkadang melebihi batas waktu yang diizinkan. </li></ul><br><p>  Gambar tampak "sangat baik". </p><br><p>  Pusat data, seperti yang saya katakan, berada di sebelah timur Amerika Serikat, dan seluruh SEMrush terdiri dari lusinan produk yang saling berhubungan, backend, ujung depan, basis data, dan semua ini di pusat data dan di awan.  Sebagai tim administrator sistem, kami ditugaskan dengan upaya kecil untuk segera mulai bekerja di Cina. </p><br><p>  Kami harus menjawab pertanyaan penting: dapatkah kami bertahan dengan sedikit darah dan menyelesaikan semua masalah yang terkait dengan Internet Cina dan firewall di tingkat jaringan / cloud / server? </p><br><p>  Kami mulai dengan mendapatkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lisensi <strong>ICP</strong></a> . </p><br><h2 id="icp-licenziya">  Lisensi ICP </h2><br><p>  Agar dapat menempatkan layanan Anda di China (Daratan China) dan melakukan tes, Anda harus terlebih dahulu mendapatkan lisensi domain ICP. </p><br><p>  Jika lalu lintas pengguna situs Anda diakhiri di Daratan China, dan jika domain Anda tidak memiliki lisensi ICP, lalu lintas Anda akan diblokir di sisi penyedia / hosting.  Menariknya, penyedia tertentu cocok dengan lisensi ICP, baik itu Cloudflare atau Alibaba Cloud.  Oleh karena itu, jika Anda menerima lisensi ICP untuk Cloudflare dan meng-host situs Anda dengan mereka, maka Anda tidak akan dapat "bergerak mulus" ke Alibaba Cloud.  Anda harus menambahkan satu hosting lagi ke lisensi ini. </p><br><p>  Setelah menerima lisensi domain ICP, kami dapat menemukan dan menerapkan ide dan solusi teknis tertentu. </p><br><h2 id="testirovanie-resheniy">  Solusi Pengujian </h2><br><p>  Tetapi sebelum Anda secara langsung membuat opsi untuk pementasan, memutar kenop, mengoptimalkan situs dan kecepatannya, Anda perlu memilih alat untuk mengujinya untuk melihat apa yang tindakan kami meningkatkan atau memperburuk pekerjaan situs. </p><br><p>  Alat pengujian kami harus memenuhi dua persyaratan utama: </p><br><ul><li>  dia harus bisa menjalankan tes dari China, </li><li>  Itu harus memiliki tes browser. </li></ul><br><p>  Jadi kami menemukan titik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tangkap</a> !  Mereka memiliki jangkauan yang sangat baik dengan titik uji di seluruh dunia.  Di Cina, melalui alat ini, Anda juga dapat menjalankan tes dari 100.500 provinsi.  Di masing-masing, beberapa penyedia berbeda + kemampuan untuk melakukan tes <strong>Backbone</strong> (sesuatu seperti mesin <strong>virtual</strong> di pusat data) dan tes <strong>Lastmile</strong> (sedekat mungkin dengan kondisi pengguna, alias workstation).  Jenis tes yang terakhir lebih mahal. </p><br><p>  Setelah menyelesaikan kontrak satu tahun (Anda tidak bisa berbuat lebih sedikit), kami mulai mempelajari alat ini.  Terus terang, kami sangat terkejut dengan fungsinya.  Anda dapat menjalankan: </p><br><ul><li>  Tes DNS </li><li>  Tes web (browser, GET / POST sederhana, emulasi klien seluler, dll.), </li><li>  Pemeriksaan transaksional (mis. Login), </li><li>  Tes API </li><li>  Ping, traceroute, NTP, dll. </li></ul><br><p>  Anda tidak bisa mendaftar semuanya.  Dan yang paling penting, setiap tes dapat disesuaikan dengan cukup baik dengan menambahkan banyak header dan parameter lainnya.  Outputnya adalah sejumlah besar informasi yang sepenuhnya menggambarkan pengujian Anda.  Jika kita berbicara tentang yang paling menarik bagi kita (uji peramban), maka hasilnya termasuk: </p><br><ul><li>  Hubungkan, Tunggu, Muat, SSL, waktu DNS, </li><li>  TTFB, TTLB, Dokumen lengkap, Waktu render, beban DOM, </li><li>  Respons (sesuatu yang dekat dengan Time To First Byte), Respons Webpage (sesuatu yang dekat dengan Time To Last Byte), </li><li>  Persentil apa pun, Sedang, Rata-rata waktu </li><li>  Dll </li></ul><br><p>  Karenanya, semua metrik ini membantu Anda melihat perubahan dan memahami apakah itu telah menjadi lebih baik.  Kami terutama melihat <strong>Respon, Respons Halaman Web, Median, 75 dan 95 Persentil</strong> . </p><br><p>  Sebuah pertanyaan penting yang telah mengemuka sejak awal: apakah <strong>mungkin untuk mempercayai Catchpoint</strong> ?  Apakah alat ini mencerminkan kecepatan pemuatan situs nyata di Tiongkok dari kota yang berbeda atau hanya semacam uji dalam ruang hampa yang tidak ada hubungannya dengan pengalaman pengguna nyata? <br>  Ini adalah masalah besar, karena berada di Rusia hampir mustahil untuk menemukan cara kerja situs dari Tiongkok.  Dengan melakukan socks-proxy melalui mesin virtual, Anda mendapatkan beban situs web dalam beberapa menit pada akhirnya, yang tidak dapat diterima untuk pengujian, sehingga satu-satunya pilihan untuk pengujian manual adalah curl dan GET sederhana dari konsol dengan pengukuran waktu.  Ini membantu, karena tes ini mencerminkan kecepatan solusi jaringan, dan jika ada tes browser, ini sangat bagus. </p><br><p>  Kemudian, kami pergi ke China sendiri dan memastikan bahwa <strong>Catchpoint dapat dipercaya, cukup akurat mencerminkan indikator kecepatan yang sebenarnya.</strong> </p><br><h2 id="cloudflare-china-network">  Jaringan cloudflare china </h2><br><p>  Karena kami berhasil menggunakan Cloudflare untuk domain semrush.com utama, kami memutuskan untuk segera mencoba fitur mereka yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">China Network</a> .  Opsi ini diaktifkan hanya untuk situs Enterprise atas permintaan dan dengan biaya.  Ini juga tersedia hanya untuk situs-situs yang memiliki lisensi ICP yang sesuai, di mana Cloudflare ditetapkan sebagai penyedia.  Setelah dimasukkan, "CDN Cina" dari Cloudflare menjadi tersedia untuk situs - lalu lintas dari wilayah China mendarat di PoP (Points of Presence) CF berikutnya, dan kemudian dikirim ke asal melalui jaringan atau jaringan penyedia / mitra. </p><br><p>  Skema bangku tes ini disajikan di bawah ini. </p><br><img src="https://habrastorage.org/webt/zk/hw/um/zkhwumkneyyxkij6gdffhzcl6qw.png"><br><p>  Ini pilihan yang bagus untuk kita.  Ternyata domain kedua juga untuk CF, yang tidak menambah jumlah solusi yang digunakan di perusahaan, dan juga praktis tidak menyulitkan infrastruktur. </p><br><p>  Kami menjalankan tes browser, dan inilah yang terjadi: </p><br><img src="https://habrastorage.org/webt/cs/wo/hp/cswohpvoexjj3nanyzxloxk2poo.png"><br><p>  Berlian merah adalah file uji.  File-file di bawah ini adalah kesalahan DNS (mengatasi batas waktu).  Yang gagal di atas adalah batas waktu. </p><br><p>  <em>Waktu aktif: 86,6</em> <em><br></em>  <em>Median: 18-an</em> <em><br></em>  <em>75 Persentil: 29,3d</em> <em><br></em>  <em>95 Persentil: 60-an</em> </p><br><p>  Median, setelah <em>menghapus</em> unduhan <em>reCaptcha</em> (layanan <em>Google</em> diblokir di Cina), menurun dari 28 menjadi 18 detik.  Tapi tetap saja, ini adalah indikator yang mengerikan, mengingat bahwa tes yang sama untuk semrush.com (dari AS) memberi kurang dari 10 detik untuk 95% pengguna (dari AS) ke halaman yang sama (statika + dinamika). </p><br><p>  Dalam setiap tes, Anda dapat pergi dan melihat <em>Air Terjun</em> dan parameter lainnya yang lebih rinci.  Kami mulai menyelidiki penyebab kesalahan, dan jika untuk timeout semuanya kurang atau kurang jelas: Internet di China "bergerak turun, lalu pindah", karena kecepatan koneksi dan pemuatan sumber daya dari luar negeri tidak stabil dan tidak merata, maka kesalahan DNS sangat mengejutkan kami. .  Kami menemukan bahwa PoP Cloudflare memang terletak di China, alamat situs memutuskan untuk IP anycast tunggal, tetapi server DNS digunakan oleh AS, itulah sebabnya mengapa permintaan DNS dipaksa untuk melewati perbatasan, jadi kadang-kadang gagal. </p><br><p>  Setelah mengklarifikasi pertanyaan ini dengan CF, ternyata <strong>mereka tidak memiliki server DNS sendiri di China</strong> , dan kapan itu masih belum diketahui. </p><br><p>  Oleh karena itu, kami memutuskan untuk menguji hanya Cloudflare DNS dan mengubah mekanisme Cloudflare untuk situs kami ke mode " <strong>DNS Only</strong> ".  Ini adalah mode seperti itu ketika Cloudflare tidak mem-proxy traffic dengan sendirinya, yang berarti itu tidak memberikan perlindungan DDoS, CDN dan fitur-fitur lainnya, dan bekerja dalam mode server DNS biasa. </p><br><p>  Stand ini ditunjukkan secara skematis pada gambar berikut.  Angka tersebut memperhitungkan pengetahuan yang muncul bahwa server Cloudflare DNS berada di belakang firewall. </p><br><img src="https://habrastorage.org/webt/ac/w0/r7/acw0r7fgqahq9w2kckq6-myxjky.png"><br><p>  Di Catchpoint, kami menjalankan tes GET sederhana (non-browser) yang menunjukkan banyak kegagalan.  Alasan mereka adalah semua kesalahan DNS yang sama. </p><br><img src="https://habrastorage.org/webt/_w/3c/wu/_w3cwuxv8j9tdeuvp20jblktqoi.png"><br><p>  Kami mulai men-debug kesalahan ini menggunakan <em>menggali</em> dan menemukan bahwa alamat ditentukan dengan benar pada permintaan pertama, dan pada permintaan berulang kami mendapatkan <em>SERVFAIL</em> dan <em>tidak ditemukan</em> setiap kali.  Tiba-tiba apa itu? </p><br><pre> <code class="bash hljs">root@iZwz97n2wgbp61qucbfrjsZ:~<span class="hljs-comment"><span class="hljs-comment"># host semrushchina.cn semrushchina.cn has address 220.170.186.192 Host semrushchina.cn not found: 2(SERVFAIL) root@iZwz97n2wgbp61qucbfrjsZ:~# host semrushchina.cn semrushchina.cn has address 220.170.186.192 Host semrushchina.cn not found: 2(SERVFAIL) root@iZwz97n2wgbp61qucbfrjsZ:~# host semrushchina.cn semrushchina.cn has address 220.170.186.192 Host semrushchina.cn not found: 2(SERVFAIL) root@iZwz97n2wgbp61qucbfrjsZ:~# host semrushchina.cn semrushchina.cn has address 220.170.186.192 Host semrushchina.cn not found: 2(SERVFAIL)</span></span></code> </pre> <br><p>  Saat meminta server Cloudflare NS secara langsung, tidak ada kesalahan seperti itu: </p><br><pre> <code class="bash hljs">root@iZwz97n2wgbp61qucbfrjsZ:~<span class="hljs-comment"><span class="hljs-comment"># for i in `seq 1 2`; do host semrushchina.cn ray.ns.cloudflare.com.; done Using domain server: Name: ray.ns.cloudflare.com. Address: 173.245.59.138#53 Aliases: semrushchina.cn has address 220.170.186.192 semrushchina.cn has address 220.170.186.192 Using domain server: Name: ray.ns.cloudflare.com. Address: 173.245.59.138#53 Aliases: semrushchina.cn has address 220.170.186.192 semrushchina.cn has address 220.170.186.192</span></span></code> </pre> <br><p>  Ini berarti bahwa masalahnya ada di sisi server DNS "lokal" atau server penyedia. <br>  Investigasi lebih lanjut menunjukkan bahwa kami mendapatkan <em>SERVFAIL</em> pada resolusi catatan <em>AAAA</em> . </p><br><p>  Ternyata ketika Cloudflare meminta catatan <em>AAAA</em> yang tidak ada dalam domain, Cloudflare merespons dengan catatan <em>A</em> , yang merupakan kesalahan dan ketidakcocokan RFC.  Karena itu resolver lokal ( <em>xxxx</em> ) tidak suka ini, dan itu menjawab <em>SERVFAIL</em> .  Dalam log di bawah ini perilaku ini terlihat jelas: </p><br><pre> <code class="bash hljs">root@iZwz97n2wgbp61qucbfrjsZ:~<span class="hljs-comment"><span class="hljs-comment"># dig -t AAAA semrushchina.cn @xxxx ; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Ubuntu &lt;&lt;&gt;&gt; -t AAAA semrushchina.cn @xxxx ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: SERVFAIL, id: 55467 ;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 0, ADDITIONAL: 1 ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 4096 ;; QUESTION SECTION: ;semrushchina.cn. IN AAAA ;; Query time: 334 msec ;; SERVER: xxxx#53(xxxx) ;; WHEN: Tue Aug 14 23:38:50 CST 2018 ;; MSG SIZE rcvd: 44 root@iZwz97n2wgbp61qucbfrjsZ:~# dig -t AAAA semrushchina.cn @dana.ns.cloudflare.com. ; &lt;&lt;&gt;&gt; DiG 9.10.3-P4-Ubuntu &lt;&lt;&gt;&gt; -t AAAA semrushchina.cn @dana.ns.cloudflare.com. ;; global options: +cmd ;; Got answer: ;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 63944 ;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1 ;; WARNING: recursion requested but not available ;; OPT PSEUDOSECTION: ; EDNS: version: 0, flags:; udp: 512 ;; QUESTION SECTION: ;semrushchina.cn. IN AAAA ;; ANSWER SECTION: semrushchina.cn. 300 IN A 220.170.186.192 ;; Query time: 185 msec ;; SERVER: 173.245.58.105#53(173.245.58.105) ;; WHEN: Tue Aug 14 23:43:03 CST 2018 ;; MSG SIZE rcvd: 60</span></span></code> </pre><br><p>  Kami mengirim laporan bug Cloudflare, dan mereka memperbaikinya setelah beberapa saat.  Ternyata menarik: saat ini, masih belum ada dukungan IPv6 di Cina, sehingga Cloudflare tidak bisa memberikan alamat IPv6 sebagai tanggapan atas permintaan untuk catatan <em>AAAA</em> .  Pada akhirnya, semuanya diputuskan sehingga untuk China Cloudflare mulai menanggapi <em>NODATA</em> untuk permintaan tersebut. </p><br><p>  Jadi, kesalahan DNS dalam tes Catchpoint menurun tajam, tetapi tidak sampai akhir.  Timeout juga tidak hilang: </p><br><img src="https://habrastorage.org/webt/u5/i7/fj/u5i7fjgo6pb9fl4mddq27uhk9lo.png"><br><p>  Dan kami mulai mencari solusi lain. </p><br><p>  Pada bagian selanjutnya saya akan memberi tahu bagaimana kami menguji <strong>Cloud</strong> China <strong>Alibaba</strong> , bagaimana dengan bantuan sedikit "sihir" Nginx kami dapat dengan cepat membuat solusi PoC (Proof of Concept), bagaimana kami menciptakan solusi Multi-Cloud, yang salah satunya akhirnya banyak membantu. mempercepat layanan dari Cina. </p><br><p>  <strong>Tetap disini!</strong> </p><br><h3 id="vse-chasti">  Semua bagian </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 3</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id458602/">https://habr.com/ru/post/id458602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id458584/index.html">11 Juli, Group-IB Webinar ‚ÄúAnalisis Malware untuk Pemula: Pendekatan Dasar‚Äù</a></li>
<li><a href="../id458592/index.html">Dari Latensi Ceph Tinggi ke Patch Kernel dengan eBPF / BCC</a></li>
<li><a href="../id458594/index.html">Jangan lupa untuk meningkatkan kemungkinan respons terhadap klien menggunakan permintaan berulang dalam penyeimbangan L7</a></li>
<li><a href="../id458596/index.html">Petty little joy # 6: OpenAI Gym - mainkan game dan kendalikan robot</a></li>
<li><a href="../id458598/index.html">Pengakuan sumber cahaya pada peta lingkungan</a></li>
<li><a href="../id458604/index.html">Mengapa dua produsen elektronik terbesar bergabung dalam proyek GPU baru</a></li>
<li><a href="../id458606/index.html">Jalankan OpenVPN di Docker dalam 2 detik</a></li>
<li><a href="../id458608/index.html">Alat Pengembang Node.js Antrian pekerjaan</a></li>
<li><a href="../id458612/index.html">Kosmos 7 tahun</a></li>
<li><a href="../id458614/index.html">Membuat hook UsePosition () reaktif untuk mendapatkan dan melacak koordinat browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>