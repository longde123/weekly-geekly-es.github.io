<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∑üèæ ‚õ±Ô∏è üî∑ Nous cr√©ons une station de radio Internet simple, compacte et bon march√© üéø üï¶ üëºüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Linux sera la plate-forme logicielle, pour plus de simplicit√©, il vaut mieux utiliser quelque chose de commun, avec beaucoup d'informations sur Intern...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous cr√©ons une station de radio Internet simple, compacte et bon march√©</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426349/"> Linux sera la plate-forme logicielle, pour plus de simplicit√©, il vaut mieux utiliser quelque chose de commun, avec beaucoup d'informations sur Internet, en cas de probl√®me.  Le fer √† repasser pour une station de radio Internet peut √™tre n'importe quoi, un serveur √† part enti√®re avec vos projets, un vieil ordinateur portable ou un netbook, nous voulons pas cher, et nous n'avons pas besoin de performances sp√©ciales de fer. <br><br>  Si vous n‚Äôavez rien sous la main ou si nous avons besoin d‚Äôun serveur compl√®tement silencieux, pourquoi ne pas essayer d‚Äôutiliser un mini-ordinateur? <br><br>  Quelque chose comme le Raspberry Pi 3? <br><br>  Non, nous voulons moins cher, nous avons donc besoin de quelque chose comme Orange Pi.  J'ai trouv√© un mod√®le Orange Pi Pc Plus avec 1 Go de RAM DDR3 et 8 Go de m√©moire Flash EMMC. <br><br><img src="https://habrastorage.org/webt/ew/ry/mf/ewrymf0vj-86hqfa2v8e7rrmjks.png"><a name="habracut"></a><br><br>  UPD: Hier, tout le monde a en quelque sorte pris l'article trop au s√©rieux, mais en fait, l'exp√©rience a √©t√© men√©e pour le bien des fans, pour voir si cela fonctionne ou non.  Naturellement, on ne parle d'aucune utilisation ¬´industrielle¬ª, c'est comme essayer de sonder le stade avec un centre musical ordinaire. <br><br>  De quoi d'autre pouvons-nous avoir besoin? <br><br>  Je veux essayer de tout configurer de mani√®re simple, j'ai donc toujours besoin d'un c√¢ble √† paire torsad√©e vers le routeur et une carte m√©moire Micro SD, car je ne peux pas installer le syst√®me d'exploitation directement sur le micro-ordinateur.  J'ai trouv√© une carte m√©moire pour 8 gigaoctets, ce montant est bien suffisant. <br><br>  Donc, tout d'abord, vous devez √©crire l'image du syst√®me d'exploitation sur la carte m√©moire. <br>  Pour les serveurs, je pr√©f√®re utiliser la Debian √©prouv√©e (oui, la jeune g√©n√©ration pr√©f√®re probablement CentOS, mais la barbe grise conviendra avec moi que Debian est toujours tr√®s bonne). <br><br>  En g√©n√©ral, il y a beaucoup d'images pr√™tes √† l'emploi pour Orange Pi sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.orangepi.org/downloadresources</a> , mais je vais toujours sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.armbian.com/download</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√©l√©charge le</a> fichier torrent depuis armbian depuis dl.armbian.com/orangepipcplus (dans le mien cas de Debian_stretch_next.7z). <br><br>  J'ai Orange Pi Pc Plus, vous pouvez avoir n'importe quel autre mini-ordinateur, alors recherchez l'image appropri√©e. <br><br>  Apr√®s le t√©l√©chargement, d√©compressez l'archive et voyez l'image au format img.  Quiconque veut de quoi remplir l'image, je pr√©f√®re personnellement Etcher (https://etcher.io).  Nous avons ins√©r√© une carte m√©moire, l'avons s√©lectionn√©e si vous avez plusieurs m√©dias connect√©s, cliquez sur le bouton de couture, entrez le mot de passe si vous avez √©galement Linux sur votre ordinateur de bureau ou portable. <br><br><img src="https://habrastorage.org/webt/lq/3w/3y/lq3w3yteie6cz8jage7vau5zssw.png"><br><br>  La carte avec l'image est pr√™te, vous pouvez commencer √† tout connecter. <br>  De quoi avons-nous besoin pour d√©marrer et commencer la configuration de notre serveur? <br>  Le mini-ordinateur lui-m√™me, Internet via un c√¢ble Ethernet et une alimentation √©lectrique. <br>  Et c'est tout. <br><br>  Non, bien s√ªr, vous pouvez √™tre confus, connecter le moniteur et le clavier et tout configurer directement, mais j'aime davantage le clavier de mon ordinateur portable, donc je vais configurer mon mini-ordinateur √† distance, via SSH. <br><br>  Alors, commen√ßons, on colle le c√¢ble Ethernet, une carte Micro SD avec une image Armbian. <br>  Il ne reste plus qu'√† alimenter le mini-ordinateur. <br><br>  Mais avec la puissance de l'Orange Pi, tout est tr√®s triste.  Qu'y a-t-il sur un mini-ordinateur normal?  C'est vrai, Micro-USB, mais comment puis-je alimenter l'Orange Pi?  Seulement 5V via un connecteur √† broches, qui est achet√© s√©par√©ment. <br><br>  Un adaptateur secteur avec un connecteur appropri√© co√ªte plus qu'un simple c√¢ble avec un port USB standard √† la fin, vous pouvez donc le prendre. <br><br>  S'il n'y a pas d'alimentation gratuite avec USB (et nous n'en avons pas besoin de toute fa√ßon, mais pour 2 amp√®res), alors nous fouillons dans notre bo√Æte avec des fils, des adaptateurs et des cartes pour ordinateurs (vous avez une telle bo√Æte, non?) Et trouvez un adaptateur appropri√© √† partir de certains vieux, longtemps cass√©s par une tablette enfant, soudez le c√¢ble et l'alimentation de notre serveur est pr√™te. <br><br>  Eh bien, ou prenez simplement le chargeur de l'ancien lecteur mp3 √† disque iRiver (il ne fait que 4,7 volts et 1,2 amp√®res mais il fonctionne √©galement). <br><br>  Nous servons de la nourriture et nous sommes pr√™ts √† passer, en fait, √† celui pour lequel tout a √©t√© con√ßu, √† la cr√©ation d'une station de radio Internet. <br><br>  Si vous, comme moi, avez l'intention de vous d√©brouiller avec un minimum de p√©riph√©riques, alors nous devons savoir quelle adresse IP a re√ßu notre mini-ordinateur.  Le moyen le plus simple de le d√©couvrir est d'aller sur votre routeur et de voir quelle adresse IP le routeur a donn√© √† notre serveur (votre routeur peut faire DHCP, non?). <br><br>  Vous pouvez maintenant vous connecter via SSH √† notre serveur.  Celui qui utilise le client SSH est celui √† utiliser (vous n'avez jamais Windows, mais je ne sais pas ce que font les clients SSH). <br>  Dans mon cas, je viens de marteler la console ssh root@192.168.0.88, j'accepte d'ajouter la cl√© ECDSA, le mot de passe par d√©faut pour root est r√©gl√© sur "1234", apr√®s la connexion, on se retrouve dans la console du micro-ordinateur, ce qui sugg√®re imm√©diatement de changer le mot de passe root. <br><br><img src="https://habrastorage.org/webt/gu/nz/c0/gunzc0ewl71jcxyhwrvoeegqpvc.png"><br><br>  Apr√®s cela, il est propos√© de cr√©er un compte utilisateur non privil√©gi√©, nous le cr√©ons. <br>  Par rapport aux versions pr√©c√©dentes du syst√®me d'exploitation, la version actuelle est quelque peu simplifi√©e en termes de param√®tres et beaucoup de choses sont d√©j√† configur√©es automatiquement. <br><br>  Armbian dispose d'un outil de configuration tr√®s pratique: <code>armbian-config</code> copie la commande sur la console et voit ce qui peut √™tre utile. <br><br><img src="https://habrastorage.org/webt/ow/nr/yi/ownryigiv-au8gowgrfhvcetduk.png"><br><br>  Nous n'avons pas encore besoin des param√®tres syst√®me, mais ils peuvent √™tre n√©cessaires plus tard, par exemple, pour transf√©rer le syst√®me configur√© de Micro SD vers la m√©moire Flash EMMC 8 Go int√©gr√©e d'un mini-ordinateur. <br><br>  La section R√©seau nous sera utile, mais ce serait bien d'avoir une adresse IP statique pour le serveur.  Notre station de radio Internet peut √™tre connect√©e au r√©seau m√™me via Wi-Fi.  Tout le monde se fixe le niveau de perversit√©, mais si vous construisez une radio Internet uniquement pour vous et qu'il n'y a pas de plan pour plus de 10 auditeurs en m√™me temps, alors pourquoi ne pas prendre notre serveur via Wi-Fi?  Dans les cas extr√™mes, vous pouvez √† tout moment brancher un c√¢ble Ethernet. <br><br>  Nous avons donc d√©cid√© du type de connexion.Nous devons maintenant configurer une adresse IP statique.Pour cela, nous allons dans les param√®tres IP et s√©lectionnons l'interface r√©seau souhait√©e, apr√®s quoi nous disons que nous voulons une adresse statique, d√©marrez-la et enregistrez les param√®tres.  Il n'est pas n√©cessaire de changer le masque et la passerelle, car ils sont re√ßus de votre routeur via DHCP. <br><br><img src="https://habrastorage.org/webt/b0/gp/qv/b0gpqvib6trft_pkir827aj8d3m.png"><br><br>  Apr√®s avoir entr√© une nouvelle adresse IP et appuy√© sur Entr√©e, votre session SSH se bloquera imm√©diatement, car l'appareil aura imm√©diatement une nouvelle adresse IP.  Par cons√©quent, nous fermons simplement la fen√™tre avec le terminal et allons √† notre mini-ordinateur via SSH en utilisant la nouvelle adresse IP. <br><br>  Soit dit en passant, puisque toutes les fonctions que nous avons seront de nature administrative, afin de ne pas √©crire constamment avant chaque commande sudo, je me connecte simplement au mini-ordinateur en tant que root. <br><br>  En ex√©cutant √† nouveau <code>armbian-config</code> , pouvons-nous voir quoi d'autre peut √™tre configur√©?  Dans la section Personnel, nous pouvons configurer le fuseau horaire, les param√®tres r√©gionaux et le nom d'h√¥te.  J'ai ajout√© les param√®tres r√©gionaux ru_RU.UTF-8 UTF-8, qui seront utiles. <br><br>  Pour que les param√®tres s'appliquent, vous devez quitter l'utilitaire de configuration, vous d√©connecter et vous reconnecter, ou red√©marrer le serveur avec la commande reboot. <br><br>  J'ai utilis√© la commande de red√©marrage pour m'assurer que les param√®tres ont √©t√© enregistr√©s et que le serveur a d√©marr√© avec succ√®s. <br><br>  La configuration de base du serveur a √©t√© effectu√©e et pourquoi ne pas installer le syst√®me d'exploitation avec MicroSD OS sur la m√©moire flash interne EMMC?  Bien s√ªr, si votre mini-ordinateur a cette m√©moire √† bord. <br><br>  Pour ce faire, acc√©dez √† <code>armbian-config</code> - Syst√®me - Installer, s√©lectionnez le lecteur disponible, appuyez sur Entr√©e, obtenez les salutations du pass√©, acceptez et s√©lectionnez le type de syst√®me de fichiers ext4. <br><br><img src="https://habrastorage.org/webt/yt/g4/ut/ytg4utinyttwtqoftarwnu-btv8.png"><br><br>  Maintenant, nous pouvons nous asseoir et attendre que le syst√®me d'exploitation soit transf√©r√© vers la m√©moire interne du mini-ordinateur. <br><br><img src="https://habrastorage.org/webt/es/rz/0x/esrz0x4sqck7jn3sggbx6bba_yi.png"><br><br>  Une fois la copie termin√©e, choisissez de couper l'alimentation.  Nous attendons quelques secondes jusqu'√† ce que le voyant du mini-ordinateur s'√©teigne, coupez l'alimentation, retirez la carte microSD, rebranchez l'alimentation et allumez l'ordinateur. <br><br>  Oui, si vous n'avez pas de m√©moire interne et que vous n'y avez pas transf√©r√© le syst√®me d'exploitation, retirer un MicroSD n'est probablement pas une bonne id√©e. <br><br>  Apr√®s vous √™tre connect√© √† notre mini-ordinateur via SSH et vous √™tre assur√© que tout fonctionne, vous pouvez commencer √† r√©gler la station de radio elle-m√™me. <br><br>  Tout d'abord, nous mettons √† jour les informations du package en lan√ßant <code>apt update</code> dans la console du serveur. <br><br>  Oui, j'aime le confort, donc j'installe mc avec la commande <code>apt install mc</code> . <br>  J'aime tout faire sous mc, et si j'ai besoin de voir la console, j'appuie simplement sur ctrl + o. <br><br>  Tout d'abord, installez le lecteur de musique d√©mon lui-m√™me: <code>apt install mpd</code> . <br>  Un tas de d√©pendances sera install√© avec elle. <br><br>  Passons √† la configuration.  Le fichier /etc/mpd.conf est responsable de la configuration du d√©mon, ouvrez-le avec la <code>nano /etc/mpd.conf</code> . <br><br>  Mon nom d'utilisateur est sans privil√®ges hzs, et mon fichier de configuration ressemble √† ceci: <br><br><pre> <code class="php hljs">music_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/music"</span></span> playlist_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/playlists"</span></span> db_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/tag_cache"</span></span> log_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd.log"</span></span> pid_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/pid"</span></span> state_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/state"</span></span> sticker_file <span class="hljs-string"><span class="hljs-string">"/var/lib/mpd/sticker.sql"</span></span> user <span class="hljs-string"><span class="hljs-string">"hzs"</span></span> bind_to_address <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> restore_paused <span class="hljs-string"><span class="hljs-string">"yes"</span></span> metadata_to_use <span class="hljs-string"><span class="hljs-string">"artist,title"</span></span> auto_update <span class="hljs-string"><span class="hljs-string">"yes"</span></span> audio_output { type <span class="hljs-string"><span class="hljs-string">"httpd"</span></span> name <span class="hljs-string"><span class="hljs-string">"My New Internet Radio Station!!!"</span></span> encoder <span class="hljs-string"><span class="hljs-string">"lame"</span></span> <span class="hljs-comment"><span class="hljs-comment"># optional, vorbis or lame port "8000" bind_to_address "0.0.0.0" # optional, IPv4 or IPv6 bitrate "256" # do not define if quality is defined format "44100:16:2" } volume_normalization "yes" filesystem_charset "UTF-8" id3v1_encoding "UTF-8"</span></span></code> </pre> <br>  Tout est clair ici et sans commentaires particuliers. <br><br>  Pour travailler, vous devez cr√©er une structure de r√©pertoires √† partir du haut des param√®tres.  Veuillez noter que le propri√©taire de ces r√©pertoires doit √™tre un utilisateur non privil√©gi√©, de qui tout fonctionnera, dans mon cas hzs. <br><br>  Depuis root, ex√©cutez les commandes suivantes: <br><br> <code>chown -cR hzs:hzs /home/hzs/music</code> <br> <code>chown -cR hzs:hzs /home/hzs/.mpd</code> <br> <br>  Il est temps de t√©l√©charger de la musique, nous avons SSH sur le serveur, afin que nous puissions connecter notre client FTP pr√©f√©r√© √† notre serveur. <br><br>  Nous savons que l'adresse IP, le port 22, le nom d'utilisateur et le mot de passe sont ceux que vous avez sp√©cifi√©s lors de la cr√©ation de l'utilisateur non privil√©gi√©, le type de connexion SSH.  Versez de la musique pour le test dans le r√©pertoire de la musique sp√©cifi√©e dans la configuration. <br><br><img src="https://habrastorage.org/webt/hs/x6/wy/hsx6wyhf98bmwv5bvy5kkpdvogi.png"><br><br>  Maintenant, le joueur est d√©marr√© avec la mauvaise configuration, donc nous arr√™tons le d√©mon et le red√©marrons: <br><br> <code>service mpd stop</code> <br> <code>service mpd start</code> <br> <br>  Pour le contr√¥le le plus simple du d√©mon, nous allons <code>apt install mpc</code> console <code>apt install mpc</code> √† l'aide de la commande <code>apt install mpc</code> . <br><br>  Apr√®s l'installation, nous allons configurer un peu le lecteur: <br><br> <code>mpc random on</code> <br> <code>mpc repeat on</code> <br> <br>  Maintenant, vous devez ajouter des pistes et une liste de lecture, dans la console, c'est un peu gimmorro, mais rien ne peut √™tre fait. <br><br>  Nous regardons les fichiers √† notre disposition, que nous pouvons ajouter √† la playlist: <br><br> <code>mpc ls</code> <br> <br>  Pour ajouter un fichier √† la playlist, dans la commande <code>mpc add</code> nous devons sp√©cifier le nom complet du fichier √† ajouter, la s√©lection par masque ne fonctionne pas: <br><br> <code>mpc add "01 Lost in Your Eyes.mp3"</code> <br> <br>  Nous regardons la playlist r√©sultante: <br><br> <code>mpc playlist</code> <br> <br>  Il est temps de lancer notre radio: <br><br> <code>mpc play</code> <br> <br><img src="https://habrastorage.org/webt/8p/gc/j5/8pgcj5ce-fqssnegu8svkdjqxwu.png"><br><br>  Essayons d'√©couter, pour cela, dans n'importe quel lecteur audio, ouvrons le flux audio de notre station de radio.  Pour ce faire, entrez l'adresse du flux <code>http://ip:port</code> , je l'ai <code>http://192.168.0.90:8000</code> . <br><br>  Audacious jouait par intermittence, il y avait un probl√®me avec la mise en cache, mais SMPlayer et VLC ne ressentaient aucun probl√®me. <br><br><img src="https://habrastorage.org/webt/do/y_/e8/doy_e8rrunt7km5_eqddovxtp0c.png"><br><br><img src="https://habrastorage.org/webt/pl/dc/ec/pldcecft-jdoram8ixgsqbupi7o.png"><br><br><img src="https://habrastorage.org/webt/ff/j4/np/ffj4nptgv3ma90bakt63oyciqys.png"><br><br>  En principe, √† ce stade, notre station de radio Internet fonctionne d√©j√†, vous devez ajouter de la musique √† la liste de lecture et transf√©rer les ports sur le routeur afin que notre station de radio Internet devienne une station de radio Internet et non une radio du r√©seau local. <br><br>  J'ai plusieurs domaines, donc la premi√®re chose que je fais dans les param√®tres DNS est de cr√©er un enregistrement ¬´A¬ª avec testradio et l'adresse IP externe statique de mon routeur √† la maison.  Vous n'√™tes pas oblig√© de le faire. <br><br>  Ensuite, sur mon routeur, je configure la redirection de port. <br><br>  Comme j'ai d√©j√† ma propre station de radio sur un grand serveur, je sp√©cifie le port source externe 9000 et le port local interne 8000, donc de l'ext√©rieur, la radio diffusera via <code>http://_ip:9000</code> . <br><br><img src="https://habrastorage.org/webt/z5/h5/vf/z5h5vf6bgcfm0k1t464-y9e1dlq.png"><br><br>  Voil√†, maintenant nous avons une ¬´vraie¬ª station de radio Internet. <br><br>  Si vous ne voulez pas vous arr√™ter l√†, allez plus loin. <br><br>  Nous ne diffusons pas la voix du DJ, mais si n√©cessaire, elle peut √™tre impl√©ment√©e, mais ce dont nous avons vraiment besoin, c'est d'une interface de gestion de playlist pratique. <br><br>  Il existe des tonnes de consoles de gestion, certaines peuvent √™tre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">consult√©es ici</a> , mais j'utiliserai le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">client Pitchfork MPD</a> . <br><br>  Il s'agit d'un museau Web √† part enti√®re, et oui, nous allons tirer un pistolet sur les moineaux et √©lever un serveur http √† part enti√®re sur un mini-ordinateur avec notre station de radio: <br><br> <code>apt install apache2</code> <br> <br>  Nous aurons √©galement besoin de PHP: <br><br> <code>apt-get install php</code> <br> <br>  Encore besoin <br><br> <code>apt install php7.0-xml</code> <br> <br>  et <br><br> <code>apt install php-pear</code> <br> <br>  Nous cr√©ons le r√©pertoire / home / hzs / wwwroot / pf dans le dossier home et d√©compressons dans celui-ci le client MPD Pitchfork pr√©c√©demment charg√© via SSH. <br><br><img src="https://habrastorage.org/webt/vt/3j/wh/vt3jwhnfoip8vuciat5mtbjja44.png"><br><br>  Dans le fichier de configuration du serveur Web apache2 /etc/apache2/sites-available/000-default.conf <br> <code>nano /etc/apache2/sites-available/000-default.conf</code> <br>  nous tondons tout et √©crivons (n'oubliez pas de changer ¬´hzs¬ª en votre nom d'utilisateur): <br><br><pre> <code class="php hljs">&lt;VirtualHost *:<span class="hljs-number"><span class="hljs-number">80</span></span>&gt; ServerName localhost ServerAdmin webmaster@localhost DocumentRoot /home/hzs/wwwroot &lt;Directory /home/hzs/wwwroot/&gt; Options All AllowOverride All DirectoryIndex index.php index.html index.htm Order Allow,Deny Allow from All <span class="hljs-keyword"><span class="hljs-keyword">Require</span></span> all granted &lt;/Directory&gt; &lt;/VirtualHost&gt;</code> </pre> <br>  Ensuite, nous red√©marrons le serveur http <br><br> <code>service apache2 restart</code> <br> <br>  En allant √† l'adresse de votre serveur IP / pf (dans mon cas: <code>http://192.168.0.90/pf</code> ) <br><br>  Nous verrons le panneau de contr√¥le: <br><br><img src="https://habrastorage.org/webt/wf/ch/a-/wfcha-qsfl5kbftdhelmpue4a0s.png"><br><br>  Tout est assez simple et intuitif. <br><br>  Ensuite, cliquez sur l'ic√¥ne du dossier √† droite et sur l'onglet Syst√®me de fichiers. <br><br>  Pour mettre √† jour la liste des fichiers, cliquez sur le bouton Mettre √† jour la base de donn√©es, puis s√©lectionnez les fichiers restants que nous n'avons toujours pas dans la liste de lecture et cliquez sur le bouton Ajouter un peu plus bas. <br><br>  Nous actualisons la page et constatons que tous les fichiers que nous avons ajout√©s √† la playlist: <br><br><img src="https://habrastorage.org/webt/d4/iz/vm/d4izvmjxin4-aapy4fxwvelnbxk.png"><br><br>  Si vous devez masquer le contr√¥le du lecteur avec un mot de passe, vous pouvez modifier le fichier de configuration: <br><br> <code>nano /home/hzs/wwwroot/pf/config/config.xml</code> <br> <br>  Il existe une structure de param√®tres parfaitement compr√©hensible. <br><br>  Nous avons donc un serveur de serveur de radio Internet √† part enti√®re mesurant 10 * 7 * 3 centim√®tres.  Bien s√ªr, le serveur basse consommation utilis√© n'attirera pas des centaines d'auditeurs, mais au moins il ne vous laissera pas sans votre musique pr√©f√©r√©e o√π que vous soyez, s'il y a Internet √† proximit√©. <br><br>  En principe, vous ne pouvez pas continuer √† lire, mais pour ceux qui sont particuli√®rement persistants, nous continuons. <br>  Nous avons un serveur web complet, pourquoi ... <br>  Eh bien, vous comprenez d√©j√†. <br><br>  Cr√©ez le r√©pertoire testradio √† la racine de notre serveur web, cr√©ez-y le fichier <code>"index.php"</code> : <br><br><pre> <code class="php hljs">&lt;!DOCTYPE html&gt; &lt;html xmlns=<span class="hljs-string"><span class="hljs-string">"https://www.w3.org/1999/xhtml"</span></span> xml:lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"ltr"</span></span>&gt; &lt;head&gt; &lt;meta http-equiv=<span class="hljs-string"><span class="hljs-string">"content-type"</span></span> content=<span class="hljs-string"><span class="hljs-string">"text/html; charset=utf-8"</span></span> /&gt; &lt;title&gt;My Test Radio&lt;/title&gt; &lt;script src=<span class="hljs-string"><span class="hljs-string">"jquery-3.3.1.min.js"</span></span>&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;My Test Radio&lt;/h1&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"song"</span></span>&gt; now playing:&lt;br&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"title"</span></span>&gt;now playing&lt;/div&gt; &lt;br&gt; &lt;div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"play"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Play&lt;/span&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"pause"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Pause&lt;/span&gt; &lt;/div&gt; &lt;br&gt; &lt;div&gt; vol:&lt;br&gt; &lt;input id=<span class="hljs-string"><span class="hljs-string">"volume"</span></span> type=<span class="hljs-string"><span class="hljs-string">"range"</span></span> min=<span class="hljs-string"><span class="hljs-string">"0"</span></span> max=<span class="hljs-string"><span class="hljs-string">"10"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span> /&gt; &lt;/div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"duration"</span></span>&gt;&lt;/span&gt; &lt;br&gt; &lt;div&gt;<span class="hljs-number"><span class="hljs-number">256</span></span> kbps&lt;/div&gt; &lt;/div&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> audio = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Audio(<span class="hljs-string"><span class="hljs-string">'http://testradio.nisel.ru:9000'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> play = document.getElementById(<span class="hljs-string"><span class="hljs-string">'play'</span></span>); play.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.play(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pause = document.getElementById(<span class="hljs-string"><span class="hljs-string">'pause'</span></span>); pause.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.pause(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> volume = document.getElementById(<span class="hljs-string"><span class="hljs-string">'volume'</span></span>); volume.addEventListener(<span class="hljs-string"><span class="hljs-string">'change'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ audio.volume = parseFloat(this.value / <span class="hljs-number"><span class="hljs-number">10</span></span>); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); audio.addEventListener(<span class="hljs-string"><span class="hljs-string">"timeupdate"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duration = document.getElementById(<span class="hljs-string"><span class="hljs-string">'duration'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = parseInt(audio.currentTime % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">60</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">3600</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) s = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + s; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) m = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + m; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (h &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) h = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + h; duration.innerHTML = h + <span class="hljs-string"><span class="hljs-string">':'</span></span> + m + <span class="hljs-string"><span class="hljs-string">':'</span></span> + s; }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); &lt;/script&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $.ajax({ url: <span class="hljs-string"><span class="hljs-string">"trackname.php"</span></span>, cache: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, success: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(html)</span></span></span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#title"</span></span>).html(html); } }); } $(document).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ show(); setInterval(<span class="hljs-string"><span class="hljs-string">'show()'</span></span>,<span class="hljs-number"><span class="hljs-number">5000</span></span>); }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre> <br>  Il s'agit de l'exemple le plus simple de cr√©ation d'un lecteur pour un site, il peut √©galement afficher le nom de la composition actuelle, mis √† jour avec ajax toutes les 5 secondes. <br><br>  L'apparence peut √™tre finie au go√ªt en utilisant CSS. <br><br>  Le code montre que le flux audio va d√©j√† √† l'adresse sp√©cifi√©e dans le DNS de mon domaine. <br>  N'oubliez pas de d√©poser le fichier jquery dans le r√©pertoire (dans mon cas jquery-3.3.1.min.js).  En g√©n√©ral, bien s√ªr, jquery est trop ici et on pourrait faire une demande ajax sans cela, mais il s'est av√©r√© trop paresseux pour penser et j'ai utilis√© un morceau de code pr√™t √† l'emploi. <br><br>  Ensuite, cr√©ez le fichier <code>"trackname.php"</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> file_get_contents(<span class="hljs-string"><span class="hljs-string">'http://192.168.0.90/mpc'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Toujours √† la racine du serveur Web, nous cr√©ons le r√©pertoire ¬´mpc¬ª et le fichier <code>"index.php"</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> exec(<span class="hljs-string"><span class="hljs-string">'mpc current'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Pourquoi certains peuvent demander de telles b√©quilles, le fait est que dans ma station de radio militaire, le serveur du joueur est sur le m√™me serveur, et la face Web du site est sur un serveur Web physiquement diff√©rent. <br><br><img src="https://habrastorage.org/webt/sl/mg/eq/slmgeqlpij1qqccf75z2yfurvy4.png"><br><br>  √âtant donn√© que vous devez interroger la piste en cours de lecture directement sur le serveur avec le lecteur, le r√©pertoire du serveur Web mpc doit s'y trouver et le fichier <code>"trackname.php"</code> trouve sur le serveur Web du site lui-m√™me et t√©l√©charge le fichier avec la description de la piste d'un autre serveur vers son adresse IP. <br><br>  Le lecteur lui-m√™me et le site de la station de radio peuvent √™tre tr√®s √©loign√©s et communiquer √† la fois sur des adresses IP externes et sur des adresses obstru√©es par DNS.  Pour que tout fonctionne, il vous suffit de transf√©rer correctement les ports. <br><br>  Vous pouvez modifier le projet √† votre guise, eh bien, j'ai pass√© un agr√©able samedi apr√®s-midi. <br>  Toutes les exp√©riences r√©ussies! <br><br>  <b>UPD2: Une exp√©rience d'une semaine est arriv√©e √† sa conclusion logique et j'ai √©teint mon mini serveur avec une station de radio.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426349/">https://habr.com/ru/post/fr426349/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426339/index.html">25 octobre 2018 R√©union du groupe d'utilisateurs Atlassian √† Raiffeisenbank</a></li>
<li><a href="../fr426341/index.html">M√©morisation du kwarg par d√©faut en Python</a></li>
<li><a href="../fr426343/index.html">R√®gles de comportement gentleman en informatique: l'histoire d'ITIL</a></li>
<li><a href="../fr426345/index.html">Des puzzles int√©ressants issus d'entretiens techniques</a></li>
<li><a href="../fr426347/index.html">ITMO University Digest: Nouvelles √©tudes, exp√©rience des anciens et projets internationaux</a></li>
<li><a href="../fr426351/index.html">Modifications apport√©es aux certifications et examens Microsoft</a></li>
<li><a href="../fr426355/index.html">Fonction Math.Sin (double) pour GPU</a></li>
<li><a href="../fr426357/index.html">Unity & Vive: Tutoriel</a></li>
<li><a href="../fr426359/index.html">L'initiative anti-piratage de Yandex n'est pas approuv√©e par les titulaires de droits d'auteur</a></li>
<li><a href="../fr426361/index.html">√Ä propos de l'√©merveillement de l'abeille et de la fa√ßon dont nous la tuons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>