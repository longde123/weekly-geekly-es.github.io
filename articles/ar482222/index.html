<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ต๐พ ๐ ุชุทุจูู ุงูููุจ ุนูู Kotlin + Spring Boot + Vue.js (ุฅุถุงูุฉ) ๐ฐ ๐ฑ๏ธ โ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุณุงุก ุงูุฎูุฑ ุฃููุง ุงูุณูุงู ุงูุฃุนุฒุงุก ูู ูุจุฑ! 

 ููุง ููุญู ุงูุงุณู ุ ุชุนุฏ ูุฐู ุงูููุงูุฉ ุฅุถุงูุฉ ุฅูู ุชุทุจูู ุงูููุจ ุงูููุชูุจ ูุณุจููุง ุนูู Kotlin + Spring Boot + Vue.js ุ ูุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุทุจูู ุงูููุจ ุนูู Kotlin + Spring Boot + Vue.js (ุฅุถุงูุฉ)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482222/" style=";text-align:right;direction:rtl">  ูุณุงุก ุงูุฎูุฑ ุฃููุง ุงูุณูุงู ุงูุฃุนุฒุงุก ูู ูุจุฑ! <br><br>  ููุง ููุญู ุงูุงุณู ุ ุชุนุฏ ูุฐู ุงูููุงูุฉ ุฅุถุงูุฉ ุฅูู <a href="https://habr.com/ru/post/467161/">ุชุทุจูู ุงูููุจ</a> ุงูููุชูุจ ูุณุจููุง <a href="https://habr.com/ru/post/467161/">ุนูู Kotlin + Spring Boot + Vue.js</a> ุ ูุงูุฐู ูุณูุญ ููุง ุจุชุญุณูู ุงููููู ุงูุนุธูู ููุชุทุจูู ูู ุงููุณุชูุจู ูุฌุนู ุงูุนูู ูุนู ุฃุณูู. <br><a name="habracut"></a><br>  ูุจู ุจุฏุก ุงููุตุฉ ุ ุงุณูุญูุง ูู ุฃู ุฃุดูุฑ ูู ูู ุนูู ูู ุงูููุงู ุงูุณุงุจู. <br><br><h3 style=";text-align:right;direction:rtl">  ูุญุชูู </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุฅุนุฏุงุฏ CI / CD (Heroku)</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุญูุงูุฉ ุจูุช (reCAPTCHA)</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุงููุฌุฑุฉ ุงูููุฏ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุชุฎุฒูู JWT ุฑูุฒ ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุชุฃููุฏ ุชุณุฌูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://habr.com/ru/post/482222/">ุฑูุงุจุท ูููุฏุฉ</a> </li></ul><br><a name="cicd"></a><br><h2 style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ CI / CD (Heroku) </h2><br>  ุงููุธุฑ ูู ุชูููุฐ ุงูุชูุงูู ุงููุณุชูุฑ ูุงูุชุณููู ุจุงุณุชุฎุฏุงู ููุตุฉ <a href="https://www.heroku.com/" rel="nofollow">Heroku</a> cloud <a href="https://www.heroku.com/" rel="nofollow">PaaS</a> ููุซุงู. <br><br>  ุฃูู ุดูุก ูุญุชุงุฌ ุฅูู ุงูููุงู ุจู ูู ูุถุน ุฑูุฒ ุงูุชุทุจูู ูู ุงููุณุชูุฏุน ุนูู <a href="https://github.com/" rel="nofollow">ุฌูุซุจ</a> .  ุจุญูุซ ูุง ููุฌุฏ ุดูุก ุบูุฑ ุถุฑูุฑู ูู ุงููุณุชูุฏุน ุ ุฃูุตู ุจุงููุญุชููุงุช ุงูุชุงููุฉ ูููู <i>.gitignore</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">.gitignore</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">*.class # Help # backend/*.md # Package Files # *.jar *.war *.ear # Eclipse # .settings .project .classpath .studio target # NetBeans # backend/nbproject/private/ backend/nbbuild/ backend/dist/ backend/nbdist/ backend/.nb-gradle/ backend/build/ # Apple # .DS_Store # Intellij # .idea *.iml *.log # logback logback.out.xml backend/src/main/resources/public/ backend/target backend/.mvn backend/mvnw frontend/dist/ frontend/node/ frontend/node_modules/ frontend/npm-debug.log frontend/target !.mvn/wrapper/maven-wrapper.jar</code> </pre> <br></div></div><br>  <u>ูุงู:</u> ูุจู ุฃู ุชุจุฏุฃ ุงูุนูู ูุน Heroku ุ ุฃุถู ููููุง ูุณูู <i>Procfile</i> (ุจุฏูู ุฃู ุงูุชุฏุงุฏ) ุฅูู ุงูุฏููู ุงูุฌุฐุฑ ูุน ุงูุณุทุฑ: <br>  <code>web: java -Dserver.port=$PORT -jar backend/target/backend-0.0.1-SNAPSHOT.jar</code> ุ ุญูุซ <i>backend-0.0.1-SNAPSHOT.jar</i> ูู ุงุณู ููู JAR <i>ุงูุชุฌููุน</i> .  ูุชุฃูุฏ ูู <u>ุงูููุงู ุงูุงูุชุฒุงู ูุฏูุน</u> . <br><br>  <u>ููุงุญุธุฉ:</u> ููููู ุฃูุถูุง ุฅุถุงูุฉ ููู travis.yaml ุฅูู ุงูุฏููู ุงูุฌุฐุฑ ูุชูููู ููุช ุฅูุดุงุก ุงูุชุทุจูู ููุดุฑู ุนูู Heroku: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">travis.yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">language: java jdk: - oraclejdk8 script: mvn clean install jacoco:report coveralls:report cache: directories: - node_modules</code> </pre> <br></div></div><br>  ุซู: <br><br>  <b># 1</b> ุณุฌู ูู <a href="https://www.heroku.com/" rel="nofollow">Heroku</a> . <br><br>  <b># 2</b> ุฅูุดุงุก ุชุทุจูู ุฌุฏูุฏ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅูุดุงุก ุชุทุจูู ุฌุฏูุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/u3/ml/bx/u3mlbx0w2ho3uezsrl75nyse2m4.png"><br></div></div><br>  <b># 3</b> ูุณูุญ ูู Heroku ุจุชูุตูู ููุงุฑุฏ ุฅุถุงููุฉ ุจุงูุชุทุจูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุงุนุฏุฉ ุจูุงูุงุช PostreSQL.  ููููุงู ุจุฐูู ุ ูู ุจูุง ููู: <i>ุงูุชุทุจูู -&gt; ุงูููุงุฑุฏ -&gt; ุงููุธุงุฆู ุงูุฅุถุงููุฉ -&gt; Heroku Postgres</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุจูุณุชููู ููุฑููู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/k5/l8/ht/k5l8htgji3kaxmqyznbdqhyeuki.png"><br></div></div><br>  <b># 4</b> ุงุฎุชูุงุฑ ุฎุทุฉ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุฎุชูุงุฑ ุงูุฎุทุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/id/jv/vd/idjvvdwyyk9ou_wbes00mxvfdac.png"><br></div></div><br>  <b># 5</b> ุงูุขู ููููู ุฑุคูุฉ ุงูููุฑุฏ ุงููุชุตู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูููุงุฑุฏ ุงููุชุตูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/l2/mx/mf/l2mxmf3itjef2-1lpiwmltrtadq.png"><br></div></div><br>  <b># 6</b> ุงูุธุฑ ุฅูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุ ูุณุชููู ููุงู ุญุงุฌุฉ ูุฅุนุฏุงุฏ ูุชุบูุฑุงุช ุงูุจูุฆุฉ: <i>ุงูุฅุนุฏุงุฏุงุช -&gt; ุนุฑุถ ุจูุงูุงุช ุงูุงุนุชูุงุฏ</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุฑุถ ุจูุงูุงุช ุงูุงุนุชูุงุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/gh/xl/v9/ghxlv99r9m2mgrr6ceemgpn-hjg.png"><br></div></div><br>  <b># 7</b> ูู ุจุชุนููู ูุชุบูุฑุงุช ุงูุจูุฆุฉ: <i>ุงูุชุทุจูู -&gt; ุงูุฅุนุฏุงุฏุงุช -&gt; ุงููุดู ุนู ุชุจุงููุงุช ุงูุชูููู</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุชุบูุฑุงุช ุงูุจูุฆุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xr/uj/q8/xrujq8lynqi6kqoqtqiklpwbaxu.png"><br></div></div><br>  <b># 8</b> ุงุถุจุท ูุชุบูุฑุงุช ุงูุจูุฆุฉ ููุงุชุตุงู ุจุงูุชูุณูู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">SPRING_DATASOURCE_URL = jdbc:postgresql://&lt;i&gt;hostname:port&lt;/i&gt;/&lt;i&gt;db_name&lt;/i&gt; SPRING_DATASOURCE_USERNAME = &lt;i&gt;username&lt;/i&gt; SPRING_DATASOURCE_PASSWORD = &lt;i&gt;password&lt;/i&gt;</code> </pre><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููู ุชุจุฏูุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/me/jr/ne/mejrnecja54rgwchq6peumbc6w0.png"><br></div></div><br>  <b># 9</b> ุฅูุดุงุก ุฌููุน ุงูุฌุฏุงูู ุงููุงุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ. <br><br>  <b># 10:</b> ูุฌุจ ุฃู ูุจุฏู ููู application.properties ุ ุนูู ุงูุชูุงูู ุ ูุซู ูุฐุง: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">application.properties</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spring.datasource.url=${SPRING_DATASOURCE_URL} spring.datasource.username=${SPRING_DATASOURCE_USERNAME} spring.datasource.password=${SPRING_DATASOURCE_PASSWORD} spring.jpa.generate-ddl=true spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults = false spring.jpa.database-platform=org.hibernate.dialect.PostgreSQL9Dialect spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true</code> </pre><br></div></div><br>  <b># 11</b> ุฅูุดุงุก <i>ุฎุท ุฃูุงุจูุจ ุฌุฏูุฏ</i> - <i>ุฅูุดุงุก ุฎุท ุฃูุงุจูุจ ุฌุฏูุฏ</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅูุดุงุก ุฎุท ุฃูุงุจูุจ ุฌุฏูุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dh/sg/wb/dhsgwbhgaz9arzl4lgwkdoykeda.png"><br></div></div><br>  <b># 12</b> ุทุฑููุฉ ุงููุดุฑ - <i>GitHub</i> (ุงููุฑ ููู <i>ุงูุงุชุตุงู ุจู GitHub</i> ูุงุชุจุน ุงูุฅุฑุดุงุฏุงุช ูู ูุงูุฐุฉ ุฌุฏูุฏุฉ). <br><br>  <b># 13</b> <i>ุชูููู ุงููุดุฑ ุงูุชููุงุฆู</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููู ุงููุดุฑ ุงูุชููุงุฆู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/8e/fb/ui/8efbuinhnr0y1j7eggqkhbjae2s.png"><br></div></div><br>  <b># 14</b> ุงููุดุฑ ุงููุฏูู - ุงููุฑ ููู <i>ูุดุฑ ุงููุฑุน</i> ูููุดุฑ ุงูุฃูู.  ูู ุงููุณุชุนุฑุถ ูุจุงุดุฑุฉู ุ ุณุชุฑู ุฅุฎุฑุงุฌ ุณุทุฑ ุงูุฃูุงูุฑ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฏููู ุงููุดุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/7i/5m/tz/7i5mtzam___vhonxjbtuogrg-ay.png"><br></div></div><br>  <b># 15</b> ุงููุฑ ููู <i>ุนุฑุถ</i> ุจุนุฏ ุงูุฅูุดุงุก ุงููุงุฌุญ ููุชุญ ุงูุชุทุจูู ุงูููุดูุฑ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฑุฃู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cp/p-/fr/cpp-frnkeudluh4bm1ir-f4oi10.png"><br></div></div><br><a name="recaptcha"></a><br><h2 style=";text-align:right;direction:rtl">  ุญูุงูุฉ ุจูุช (reCAPTCHA) </h2><br>  ุงูุฎุทูุฉ ุงูุฃููู ูุชูููู ุงูุชุญูู ูู reCAPTCHA ูู ุชุทุจูููุง ูู ุฅูุดุงุก reCAPTCH ุฌุฏูุฏ ูู <a href="https://www.google.com/recaptcha/intro/v3.html" rel="nofollow">ููุญุฉ ุฅุฏุงุฑุฉ Google</a> .  ููุงู ูููู ุจุฅูุดุงุก ูููุน ุฌุฏูุฏ (ุฅุถุงูุฉ ูููุน ุฌุฏูุฏ / ุฅูุดุงุก) ูุชุนููู ุงูุฅุนุฏุงุฏุงุช ุงูุชุงููุฉ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุนุฏุงุฏุงุช ReCAPTCHA</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/xi/eh/rp/xiehrpgngjvxqvd1dq-4wp5gfqc.png"><br></div></div><br>  ูู ูุณู <i>ุงููุฌุงูุงุช</i> ุ ูุฌุจ ุนููู ุชุญุฏูุฏ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุนููุงู ุงูุฐู ุณูุนูุด ููู ุงูุชุทุจูู ุ ูุนููู ุชุญุฏูุฏ <code>localhost</code> ุ ุจุญูุซ ุชุชุฌูุจ ุงููุชุงุนุจ ุฃุซูุงุก ุชุตุญูุญ ุงูุฃุฎุทุงุก ูู ุดูู ุนุฏู ุงููุฏุฑุฉ ุนูู ุชุณุฌูู ุงูุฏุฎูู ุฅูู ุงูุชุทุจูู ุงูุฎุงุต ุจู. <br><br>  <b>ุงูุฎูููุฉ</b> <br><br>  ุญูุธ <i>ููุชุงุญ ุงููููุน ูุงูููุชุงุญ</i> <i>ุงูุณุฑู</i> ... <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุชุงุญ ุงููููุน / ุงูููุชุงุญ ุงูุณุฑู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hs/re/-t/hsre-ttxpgbhgau9q4fsvtdqxq0.png"><br></div></div><br>  ... ุซู ูุชุนููููุง ููุชุบูุฑุงุช ุงูุจูุฆุฉ ุ ูุงูุฃุณูุงุก ุงููุชุบูุฑุฉ ุ ุจุฏูุฑูุง ุ ูุชุนููู ุฎุตุงุฆุต <i>application.properties</i> ุฌุฏูุฏุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">google.recaptcha.key.site=${GOOGLE_RECAPTCHA_KEY_SITE} google.recaptcha.key.secret=${GOOGLE_RECAPTCHA_KEY_SECRET}</code> </pre><br>  ุฃุถู ุชุจุนูุฉ ุฌุฏูุฏุฉ ูู <i>pom.xml</i> ููุชุญูู ุนูู ุฌุงูุจ Google ูู ุงูุฑููุฒ ุงููููุฒุฉ reCAPTCHA ุงูุชู ุณูุฑุณููุง ุงูุนููู ุฅูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.mashape.unirest<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>unirest-java<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.4.9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  ููุฏ ุญุงู ุงูููุช ูุชุญุฏูุซ ุงูููุงูุงุช ุงูุชู ูุณุชุฎุฏููุง ูุชุฎููู ุงููุณุชุฎุฏููู ูุชุณุฌูููู ุนู ุทุฑูู ุฅุถุงูุฉ ุญูู ุณูุณูุฉ ููู ูููุณ ุฑูุฒ reCAPTCHA: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">LoginUser.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.JsonProperty <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.Serializable <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoginUser</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Serializable { @JsonProperty</span></span></span></span>(<span class="hljs-string"><span class="hljs-string">"username"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> username: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"password"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> password: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"recapctha_token"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recaptchaToken: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() {} <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(username: String, password: String, recaptchaToken: String) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password = password <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.recaptchaToken = recaptchaToken } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serialVersionUID = -<span class="hljs-number"><span class="hljs-number">1764970284520387975L</span></span> } }</code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">NewUser.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.JsonProperty <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.Serializable <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewUser</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Serializable { @JsonProperty</span></span></span></span>(<span class="hljs-string"><span class="hljs-string">"username"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> username: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"firstName"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstName: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"lastName"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastName: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"email"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> email: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"password"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> password: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonProperty(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"recapctha_token"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recaptchaToken: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() {} <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(username: String, firstName: String, lastName: String, email: String, password: String, recaptchaToken: String) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstName = firstName <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastName = lastName <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.email = email <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password = password <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.recaptchaToken = recaptchaToken } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serialVersionUID = -<span class="hljs-number"><span class="hljs-number">1764970284520387975L</span></span> } }</code> </pre><br></div></div><br>  ุฃุถู ุฎุฏูุฉ ุตุบูุฑุฉ ุณุชููู ุจุจุซ ุงูุฑูุฒ ุงููููุฒ reCAPTCHA ูู ุฎุฏูุฉ ุฎุงุตุฉ ูู Google ูุงูุฅุจูุงุบ ุฑุฏุง ุนูู ูุง ุฅุฐุง ูุงู ุงูุฑูุฒ ุงููููุฒ ูุฏ ุชุญูู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ReCaptchaService.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Service <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.client.RestOperations <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Autowired <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.mashape.unirest.http.HttpResponse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.mashape.unirest.http.JsonNode <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.mashape.unirest.http.Unirest <span class="hljs-meta"><span class="hljs-meta">@Service(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"captchaService"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReCaptchaService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> BASE_VERIFY_URL: String = <span class="hljs-string"><span class="hljs-string">"https://www.google.com/recaptcha/api/siteverify"</span></span> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> restTemplate: RestOperations? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${google.recaptcha.key.site}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keySite: String <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${google.recaptcha.key.secret}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keySecret: String <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validateCaptcha</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> url: String = String.format(BASE_VERIFY_URL + <span class="hljs-string"><span class="hljs-string">"?secret=%s&amp;response=%s"</span></span>, keySecret, token) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> jsonResponse: HttpResponse&lt;JsonNode&gt; = Unirest.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(url) .header(<span class="hljs-string"><span class="hljs-string">"accept"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>).queryString(<span class="hljs-string"><span class="hljs-string">"apiKey"</span></span>, <span class="hljs-string"><span class="hljs-string">"123"</span></span>) .asJson() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (jsonResponse.getStatus() == <span class="hljs-number"><span class="hljs-number">200</span></span>) } }</code> </pre><br></div></div><br>  ูุฌุจ ุงุณุชุฎุฏุงู ูุฐู ุงูุฎุฏูุฉ ูู ูุญุฏุฉ ุชุญูู ุชุณุฌูู ุงููุณุชุฎุฏู ูุงูุชุฑุฎูุต: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">AuthController.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.ReCaptchaService โฆ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> captchaService: ReCaptchaService โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Validation failed (ReCaptcha v2)"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>]... โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Validation failed (ReCaptcha v2)"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>...</code> </pre><br></div></div><br>  <b>ุงููุงุฌูุฉ</b> <br><br>  ุงูุฎุทูุฉ ุงูุฃููู ูู ุชุซุจูุช ูุญูุธ ุญุฒูุฉ <code>reCAPTHA</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ npm install --save vue-recaptcha</code> </pre> <br>  ุซู ุงุชุตู ุจุงููุต ูู <i>index.html</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://www.google.com/recaptcha/api.js onload=vueRecaptchaApiLoaded&amp;render=explicit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">defer</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  ุฃุถู ุฃู ูููุฉ ุงูุชุญูู ุฅูู ุฃู ูุณุงุญุฉ ุฎุงููุฉ ุนูู ุงูุตูุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vue-recaptcha</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"invisible"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:sitekey</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sitekey"</span></span></span><span class="hljs-tag"> @</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verify</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onCapthcaVerified"</span></span></span><span class="hljs-tag"> @</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">expired</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onCaptchaExpired"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  ูุณูู ูููู ุฒุฑ ุงูุฅุฌุฑุงุก ุงููุณุชูุฏู (ุงูุชุฑุฎูุต ุฃู ุงูุชุณุฌูู) ุงูุขู ุฃููุงู ุจุงุณุชุฏุนุงุก ุทุฑููุฉ ุงูุชุญูู ูู ุงูุตุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">v-on:click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"validateCaptcha"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">&gt;</span></span>Login<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b-button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  ุฃุถู ุงูุชุจุนูุฉ ููููููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> VueRecaptcha <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue-recaptcha'</span></span></code> </pre> <br>  ุชุญุฑูุฑ <i>ุงูุชุตุฏูุฑ ุงูุงูุชุฑุงุถู</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">components: { VueRecaptcha }, โฆ data() { โฆ siteKey: <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> โฆ }</code> </pre><br>  ูุฅุถุงูุฉ ุทุฑู ุฌุฏูุฏุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>validateCaptcha()</code> - ูุงูุฐู ูุณูู ุจุงูููุฑ ููู ุงูุฒุฑ </li><li style=";text-align:right;direction:rtl">  <code>onCapthcaVerified(recaptchaToken)  onCaptchaExpired()</code> - ุงูุฐู ูุณุชุฏุนู captcha ููุณู </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุทุฑู ุฌุฏูุฏุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">validateCaptcha() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$refs.recaptcha.execute() }, onCapthcaVerified(recaptchaToken) { AXIOS.post(<span class="hljs-string"><span class="hljs-string">`/auth/signin`</span></span>, {<span class="hljs-string"><span class="hljs-string">'username'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$data.username, <span class="hljs-string"><span class="hljs-string">'password'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$data.password, <span class="hljs-string"><span class="hljs-string">'recapctha_token'</span></span>: recaptchaToken}) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$store.dispatch(<span class="hljs-string"><span class="hljs-string">'login'</span></span>, {<span class="hljs-string"><span class="hljs-string">'token'</span></span>: response.data.accessToken, <span class="hljs-string"><span class="hljs-string">'roles'</span></span>: response.data.authorities, <span class="hljs-string"><span class="hljs-string">'username'</span></span>: response.data.username}); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$router.push(<span class="hljs-string"><span class="hljs-string">'/home'</span></span>) }, error =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showAlert(error.response.data.message); }) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(e); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showAlert(<span class="hljs-string"><span class="hljs-string">'Server error. Please, report this error website owners'</span></span>); }) }, onCaptchaExpired() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$refs.recaptcha.reset() }</code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุคุฏู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/m0/rc/w9/m0rcw9xjgqjqpgiuwdib16_mur8.png"><br></div></div><br><a name="email"></a><br><h2 style=";text-align:right;direction:rtl">  ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </h2><br>  ุงููุธุฑ ูู ุฅููุงููุฉ ุฅุฑุณุงู ุฑุณุงุฆู ุฅูู ุงูุชุทุจูู ูุฏููุง ูู ุฎูุงู ุฎุงุฏู ุงูุจุฑูุฏ ุงูุนุงู ุ ูุซู ุฌูุฌู ุฃู Mail.ru. <br><br>  ุงูุฎุทูุฉ ุงูุฃููู ุ ุนูู ุงูุชูุงูู ุ ูู ุฅูุดุงุก ุญุณุงุจ ุนูู ุฎุงุฏู ุงูุจุฑูุฏ ุงููุญุฏุฏ ุ ุฅุฐุง ูู ููู ุจุงููุนู. <br><br>  ุงูุฎุทูุฉ ุงูุซุงููุฉ ุงูุชู ูุญุชุงุฌูุง ูุฅุถุงูุฉ ุงูุชุจุนูุงุช ุงูุชุงููุฉ ูู <i>pom.xml</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุนุชูุงุฏุง ุนูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.boot<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-boot-starter-mail<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.boot<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-boot-starter-thymeleaf<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>commons-io<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>commons-io<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  ุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุฅุถุงูุฉ ุฎุตุงุฆุต ุฌุฏูุฏุฉ ุฅูู <i>application.properties</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฎุตุงุฆุต SMTP</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spring.mail.host=${SMTP_MAIL_HOST} spring.mail.port=${SMTP_MAIL_PORT} spring.mail.username=${SMTP_MAIL_USERNAME} spring.mail.password=${SMTP_MAIL_PASSWORD} spring.mail.properties.mail.smtp.auth=true spring.mail.properties.mail.smtp.starttls.enable=true spring.mail.properties.mail.smtp.ssl.enable=true spring.mail.properties.mail.smtp.connectiontimeout=5000 spring.mail.properties.mail.smtp.timeout=5000 spring.mail.properties.mail.smtp.writetimeout=5000</code> </pre><br></div></div><br>  ููููู ุชุญุฏูุฏ ุฅุนุฏุงุฏุงุช SMTP ููุง: <a href="https://support.google.com/mail/answer/7126229%3Fhl%3Dru" rel="nofollow">Google</a> ู <a href="https://help.mail.ru/mail-help/mailer/popsmtp" rel="nofollow">Mail.ru</a> <br><br>  ุฅูุดุงุก ูุงุฌูุฉ ุญูุซ ูุนูู ุนุฏุฉ ุทุฑู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฅุฑุณุงู ุฑุณุงูุฉ ูุตูุฉ ุนุงุฏูุฉ </li><li style=";text-align:right;direction:rtl">  ูุฅุฑุณุงู ุจุฑูุฏ HTML ุงูุฅููุชุฑููู </li><li style=";text-align:right;direction:rtl">  ูุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ุจุงุณุชุฎุฏุงู ูุงูุจ </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">EmailService.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kotlinspringvue.backend.email <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.mail.SimpleMailMessage <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmailService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSimpleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, text: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSimpleMessageUsingTemplate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, template: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, params:</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">MutableMap</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Any&gt;)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendHtmlMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, htmlMsg: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> }</code> </pre><br></div></div><br>  ูููู ุงูุขู ุจุฅูุดุงุก ุชุทุจูู ููุฐู ุงููุงุฌูุฉ - ุฎุฏูุฉ ุฅุฑุณุงู ุฑุณุงุฆู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">EmailServiceImpl.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kotlinspringvue.backend.email <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Autowired <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.io.FileSystemResource <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.mail.MailException <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.mail.SimpleMailMessage <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.mail.javamail.JavaMailSender <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.mail.javamail.MimeMessageHelper <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Component <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.thymeleaf.spring5.SpringTemplateEngine <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.thymeleaf.context.Context <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.mail.MessagingException <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.mail.internet.MimeMessage <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.commons.io.IOUtils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.core.env.Environment <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmailServiceImpl</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EmailService { @Value</span></span></span></span>(<span class="hljs-string"><span class="hljs-string">"\${spring.mail.username}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sender: String <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> environment: Environment <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emailSender: JavaMailSender? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> templateEngine: SpringTemplateEngine <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSimpleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, text: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> message = SimpleMailMessage() message.setTo(to) message.setFrom(sender) message.setSubject(subject) message.setText(text) emailSender!!.send(message) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (exception: MailException) { exception.printStackTrace() } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSimpleMessageUsingTemplate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, template: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, params:</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">MutableMap</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Any&gt;)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> message = emailSender!!.createMimeMessage() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> helper = MimeMessageHelper(message, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> context: Context = Context() context.setVariables(params) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> html: String = templateEngine.process(template, context) helper.setTo(to) helper.setFrom(sender) helper.setText(html, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) helper.setSubject(subject) emailSender!!.send(message) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendHtmlMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(to: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, subject: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, htmlMsg: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> message = emailSender!!.createMimeMessage() message.setContent(htmlMsg, <span class="hljs-string"><span class="hljs-string">"text/html"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> helper = MimeMessageHelper(message, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>) helper.setTo(to) helper.setFrom(sender) helper.setSubject(subject) emailSender!!.send(message) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (exception: MailException) { exception.printStackTrace() } } }</code> </pre><br></div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณุชุฎุฏู JavaMailSender ุงูุฐู ุชู ุชููููู ุชููุงุฆููุง ูู Spring ูุฅุฑุณุงู ุฑุณุงุฆู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </li><li style=";text-align:right;direction:rtl">  ุฅุฑุณุงู ุฑุณุงุฆู ุนุงุฏูุฉ ุฃูุฑ ุจุณูุท ููุบุงูุฉ - ุชุญุชุงุฌ ููุท ุฅูู ุฅุถุงูุฉ ูุต ุฅูู ูุต ุงูุฑุณุงูุฉ ูุฅุฑุณุงูู </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุนุฑูู ุฑุณุงุฆู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู <code>text/html</code> HTML ุนูู ุฃููุง ุฑุณุงุฆู ููุน Mime ููุญุชูุงูุง <code>text/html</code> </li><li style=";text-align:right;direction:rtl">  ููุนุงูุฌุฉ ูุงูุจ ุฑุณุงูุฉ HTML ุ ูุณุชุฎุฏู Spring Template Engine </li></ul><br>  ูููู ุจุฅูุดุงุก ูุงูุจ ุจุณูุท ูููุชุงุจุฉ ุจุงุณุชุฎุฏุงู ุฅุทุงุฑ ุนูู <a href="https://www.thymeleaf.org/" rel="nofollow">Thymeleaf ูู</a> ุฎูุงู ูุถุนู ูู <i>src / main / resources / templates /</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">emailTemplate.html</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:th</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.thymeleaf.org"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"UTF-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Hello<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font-family: Arial, Helvetica, sans-serif;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span>Hello!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"margin-top: 20px; margin-bottom: 30px; margin-left: 20px;"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Hello, dear: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${addresseeName}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">th:src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${signatureImage}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"200px;"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  ูุชู ุงูุฅุนูุงู ุนู ุงูุนูุงุตุฑ ุงููุชุบูุฑุฉ ูููุงูุจ (ูู ุญุงูุชูุง ุ ุงุณู ุงููุณุชูู ููุณุงุฑ ุงูุตูุฑุฉ ููุชูููุน) ุจุงุณุชุฎุฏุงู ุงูุนูุงุตุฑ ุงููุงุฆุจุฉ. <br><br>  ุงูุขู ูู ุจุฅูุดุงุก ุฃู ุชุญุฏูุซ ูุญุฏุฉ ุชุญูู ูู ุดุฃููุง ุฅุฑุณุงู ุฑุณุงุฆู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">BackendController.kt</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.email.EmailServiceImpl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.web.response.ResponseMessage <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.ResponseEntity <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.HttpStatus โฆ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emailService: EmailService <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${spring.mail.username}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> addressee: String โฆ <span class="hljs-meta"><span class="hljs-meta">@GetMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/sendSimpleEmail"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@PreAuthorize(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"hasRole('USER')"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendSimpleEmail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { emailService.sendSimpleMessage(addressee, <span class="hljs-string"><span class="hljs-string">"Simple Email"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello! This is simple email"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e: Exception) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Error while sending message"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Email has been sent"</span></span>), HttpStatus.OK) } <span class="hljs-meta"><span class="hljs-meta">@GetMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/sendTemplateEmail"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@PreAuthorize(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"hasRole('USER')"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendTemplateEmail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params:MutableMap&lt;String, Any&gt; = mutableMapOf() params[<span class="hljs-string"><span class="hljs-string">"addresseeName"</span></span>] = addressee params[<span class="hljs-string"><span class="hljs-string">"signatureImage"</span></span>] = <span class="hljs-string"><span class="hljs-string">"https://coderlook.com/wp-content/uploads/2019/07/spring-by-pivotal.png"</span></span> emailService.sendSimpleMessageUsingTemplate(addressee, <span class="hljs-string"><span class="hljs-string">"Template Email"</span></span>, <span class="hljs-string"><span class="hljs-string">"emailTemplate"</span></span>, params) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e: Exception) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Error while sending message"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Email has been sent"</span></span>), HttpStatus.OK) } <span class="hljs-meta"><span class="hljs-meta">@GetMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/sendHtmlEmail"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@PreAuthorize(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"hasRole('USER')"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendHtmlEmail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { emailService.sendHtmlMessage(addressee, <span class="hljs-string"><span class="hljs-string">"HTML Email"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Hello!&lt;/h1&gt;&lt;p&gt;This is HTML email&lt;/p&gt;"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e: Exception) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Error while sending message"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Email has been sent"</span></span>), HttpStatus.OK) }</code> </pre><br></div></div><br>  <u>ููุงุญุธุฉ:</u> ููุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ุ ุณูุฑุณู ุฃููุงู ุฑุณุงุฆู ุฅูู ุฃููุณูุง. <br><br>  ุฃูุถูุง ุ ููุชุฃูุฏ ูู ุฃู ูู ุดูุก ูุนูู ุ ูููููุง ุฅูุดุงุก ูุงุฌูุฉ ููุจ ูุชูุงุถุนุฉ ุชุณุญุจ ุจุจุณุงุทุฉ ุฃุณุงููุจ ุฎุฏูุฉ ุงูููุจ: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Email.vue</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">&lt;template&gt; &lt;div id="email"&gt; &lt;b-button v-on:click="sendSimpleMessage" variant="primary"&gt;Simple Email&lt;/b-button&gt;&lt;br/&gt; &lt;b-button v-on:click="sendEmailUsingTemplate" variant="primary"&gt;Template Email&lt;/b-button&gt;&lt;br/&gt; &lt;b-button v-on:click="sendHTMLEmail" variant="primary"&gt;HTML Email&lt;/b-button&gt;&lt;br/&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import {AXIOS} from './http-common' export default { name: 'EmailPage', data() { return { counter: 0, username: '', header: {'Authorization': 'Bearer ' + this.$store.getters.getToken} } }, methods: { sendSimpleMessage() { AXIOS.get('/sendSimpleEmail', { headers: this.$data.header }) .then(response =&gt; { console.log(response); alert("OK"); }) .catch(error =&gt; { console.log('ERROR: ' + error.response.data); }) }, sendEmailUsingTemplate() { AXIOS.get('/sendTemplateEmail', { headers: this.$data.header }) .then(response =&gt; { console.log(response); alert("OK") }) .catch(error =&gt; { console.log('ERROR: ' + error.response.data); }) }, sendHTMLEmail() { AXIOS.get('/sendHtmlEmail', { headers: this.$data.header }) .then(response =&gt; { console.log(response); alert("OK") }) .catch(error =&gt; { console.log('ERROR: ' + error.response.data); }) } } } &lt;/script&gt; &lt;style&gt; #email { margin-left: 38%; margin-top: 50px; } button { width: 150px; } &lt;/style&gt;</code> </pre><br></div></div><br>  <u>ููุงุญุธุฉ:</u> ูุง ุชูุณู ุชุญุฏูุซ <code>router.js</code> ูุฅุถุงูุฉ ุงูุฑุงุจุท ุฅูู <code>App.vue</code> ุงูุชููู <code>App.vue</code> ุฅุฐุง ููุช ุชููู ุจุฅูุดุงุก ูููู ุฌุฏูุฏ. <br><br><a name="gradle"></a><br><h2 style=";text-align:right;direction:rtl">  ุงููุฌุฑุฉ ุงูููุฏ </h2><br>  ุณุฃูุถุญ ุนูู ุงูููุฑ: ูู ุญุงูุฉ ุงุนุชุจุงุฑ ูุฐุง ุงูุนูุตุฑ ุชุญุณูููุง ุ ุฏุน ุงูุฌููุน ููุฑุฑูู ูุดุฑูุนู.  ูุญู ููุท ููุธุฑ ูู ููููุฉ ุงูููุงู ุจุฐูู. <br><br>  ุจุดูู ุนุงู ุ ููููู ุงุณุชุฎุฏุงู <a href="http://www.rationaljava.com/2016/02/moving-from-maven-to-gradle-in-under-5.html" rel="nofollow">ุงูุงูุชูุงู ูู Maven ุฅูู Gradle ูู ุชุนููู ุฃูู ูู 5 ุฏูุงุฆู</a> ุ ูููู ูู ุบูุฑ ุงููุฑุฌุญ ุฃู ุชุฑูู ุงููุชูุฌุฉ ุฅูู ูุณุชูู ุงูุชููุนุงุช.  ูุง ุฒูุช ุฃูุตู ุจุงูููุงู ุจุงูุชุฑุญูู ูุฏูููุง ุ ููู ูุณุชุบุฑู ุงูุฃูุฑ ููุชูุง ุทูููุงู. <br><br>  ุฃูู ุดูุก ูุชุนูู ุนูููุง ุงูููุงู ุจู ูู <a href="https://gradle.org/install/" rel="nofollow">ุชุซุจูุช Gradle</a> . <br><br>  ุซู ูุญุชุงุฌ ุฅูู ุชูููุฐ ุงูุฅุฌุฑุงุก ุงูุชุงูู ููู ูู ุงููุดุงุฑูุน ุงููุฑุนูุฉ - <code>backend</code> <code>fronted</code> : <br><br>  <b># 1</b> ุญุฐู ูููุงุช Maven - <i>pom.xml</i> ุ <i>.mvn</i> . <br><br>  <b># 2</b> ูู ุฏููู ุงููุดุฑูุน ุงููุฑุนู ุ ูู ุจุชุดุบูู gradle init ูุงูุฅุฌุงุจุฉ ุนูู ุงูุฃุณุฆูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>ุญุฏุฏ ููุน ุงููุดุฑูุน ุงููุฑุงุฏ ุฅูุดุงุคู:</i> <b>ุฃุณุงุณู</b> </li><li style=";text-align:right;direction:rtl">  <i>ุงุฎุชุฑ ูุบุฉ ุงูุชูููุฐ:</i> <b>Kotlin</b> </li><li style=";text-align:right;direction:rtl">  <i>ุญุฏุฏ build script DSL:</i> <b>Kotlin</b> (ุจูุง ุฃููุง ููุชุจ ูุดุฑูุนูุง ูู Kotlin) </li></ul><br>  <b># 3</b> ุญุฐู <i>settings.gradle.kts</i> - ูุฐุง ุงูููู ูุทููุจ ููุท ูููุดุฑูุน ุงูุฌุฐุฑ. <br><br>  <b># 4</b> ุชุดุบูู <code>gradle wrapper</code> . <br><br>  ุงูุขู ุฏุนูุง ููุชูู ุฅูู ูุดุฑูุนูุง ุงูุฌุฐุฑ.  ูุฐูู ุ ุชุญุชุงุฌ ุฅูู ุงุชุจุงุน ุงูุฎุทูุงุช 1 ู 2 ู 4 ุงูููุถุญุฉ ุฃุนูุงู ูููุดุงุฑูุน ุงููุฑุนูุฉ - ูู ุดูุก ูู ููุณู <u>ุจุงุณุชุซูุงุก ุญุฐู <i>settings.gradle.kts</i></u> . <br><br>  ุณูุจุฏู ุชูููู <i>ุงูุจููุฉ</i> ููุดุฑูุน <i>ุงููุงุฌูุฉ ุงูุฎูููุฉ</i> ููุง ููู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">build.gradle.kts</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.jetbrains.kotlin.gradle.tasks.KotlinCompile plugins { id(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot"</span></span>) version <span class="hljs-string"><span class="hljs-string">"2.1.3.RELEASE"</span></span> id(<span class="hljs-string"><span class="hljs-string">"io.spring.dependency-management"</span></span>) version <span class="hljs-string"><span class="hljs-string">"1.0.8.RELEASE"</span></span> kotlin(<span class="hljs-string"><span class="hljs-string">"jvm"</span></span>) version <span class="hljs-string"><span class="hljs-string">"1.3.50"</span></span> kotlin(<span class="hljs-string"><span class="hljs-string">"plugin.spring"</span></span>) version <span class="hljs-string"><span class="hljs-string">"1.3.50"</span></span> id(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin.plugin.jpa"</span></span>) version <span class="hljs-string"><span class="hljs-string">"1.3.50"</span></span> } group = <span class="hljs-string"><span class="hljs-string">"com.kotlin-spring-vue"</span></span> version = <span class="hljs-string"><span class="hljs-string">"0.0.1-SNAPSHOT"</span></span> java.sourceCompatibility = JavaVersion.VERSION_1_8 repositories { mavenCentral() maven { url = uri(<span class="hljs-string"><span class="hljs-string">"https://plugins.gradle.org/m2/"</span></span>) } } dependencies { runtimeOnly(project(<span class="hljs-string"><span class="hljs-string">":frontend"</span></span>)) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-actuator:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-web:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-data-jpa:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-mail:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-security:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.postgresql:postgresql:42.2.5"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-thymeleaf:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"commons-io:commons-io:2.4"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"io.jsonwebtoken:jjwt:0.9.0"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"io.jsonwebtoken:jjwt-api:0.10.6"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"com.mashape.unirest:unirest-java:1.4.9"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"com.fasterxml.jackson.module:jackson-module-kotlin:2.9.8"</span></span>) runtimeOnly(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-devtools:2.1.3.RELEASE"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin:kotlin-reflect"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin:kotlin-stdlib-jdk8"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"org.jetbrains.kotlin:kotlin-noarg:1.3.50"</span></span>) testImplementation(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot:spring-boot-starter-test"</span></span>) { exclude(group = <span class="hljs-string"><span class="hljs-string">"org.junit.vintage"</span></span>, module = <span class="hljs-string"><span class="hljs-string">"junit-vintage-engine"</span></span>) } } tasks.withType&lt;KotlinCompile&gt; { kotlinOptions { freeCompilerArgs = listOf(<span class="hljs-string"><span class="hljs-string">"-Xjsr305=strict"</span></span>) jvmTarget = <span class="hljs-string"><span class="hljs-string">"1.8"</span></span> } }</code> </pre><br></div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌุจ ุชุญุฏูุฏ ุฌููุน ุงูุฅุถุงูุงุช ุงููุทููุจุฉ ูู Kotlin ู Spring. </li><li style=";text-align:right;direction:rtl">  ูุง ุชูุณู ุนู ุงูุจุฑูุงูุฌ ุงููุณุงุนุฏ <i>org.jetbrains.kotlin.plugin.jpa</i> - ูู ุงูุถุฑูุฑู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  ูู ุงูุชุจุนูุงุช ุ ูุฌุจ ุนููู ุชุญุฏูุฏ <code>runtimeOnly(project(":frontend"))</code> - ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุดุฑูุน <i>ุงููุงุฌูุฉ ุงูุฃูุงููุฉ</i> ุฃููุงู </li></ul><br>  ุจูุงุก ุงูุชูููู ููุดุฑูุน <i>ุงููุงุฌูุฉ ุงูุฃูุงููุฉ</i> : <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">build.gradle.kts</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs">plugins { id(<span class="hljs-string"><span class="hljs-string">"org.siouan.frontend"</span></span>) version <span class="hljs-string"><span class="hljs-string">"1.2.1"</span></span> id(<span class="hljs-string"><span class="hljs-string">"java"</span></span>) } group = <span class="hljs-string"><span class="hljs-string">"com.kotlin-spring-vue"</span></span> version = <span class="hljs-string"><span class="hljs-string">"0.0.1-SNAPSHOT"</span></span> java { targetCompatibility = JavaVersion.VERSION_1_8 } buildscript { repositories { mavenCentral() maven { url = uri(<span class="hljs-string"><span class="hljs-string">"https://plugins.gradle.org/m2/"</span></span>) } } } frontend { nodeVersion.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">"10.16.0"</span></span>) cleanScript.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">"run clean"</span></span>) installScript.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">"install"</span></span>) assembleScript.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-string"><span class="hljs-string">"run build"</span></span>) } tasks.named(<span class="hljs-string"><span class="hljs-string">"jar"</span></span>, Jar::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">) </span></span>{ dependsOn(<span class="hljs-string"><span class="hljs-string">"assembleFrontend"</span></span>) from(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$buildDir</span></span></span><span class="hljs-string">/dist"</span></span>) into(<span class="hljs-string"><span class="hljs-string">"static"</span></span>) }</code> </pre><br></div></div><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุงูุฎุงุต ุจู ุ ูุชู ุงุณุชุฎุฏุงู ุงููููู ุงูุฅุถุงูู <code>org.siouan.frontend</code> ูุฅูุดุงุก ุงููุดุฑูุน </li><li style=";text-align:right;direction:rtl">  ูู ูุณู <code>frontend {...}</code> ูุฌุจ ุฃู ุชุดูุฑ ุฅูู ุฅุตุฏุงุฑ Node.js ุ ููุฐูู ุงูุฃูุงูุฑ ุงูุชู ุชุณุชุฏุนู ุงูุจุฑุงูุฌ ุงููุตูุฉ ููุชูุธูู ูุงูุชุฑููุจ ูุงูุชุฌููุน ุงููุญุฏุฏุฉ ูู <code>package.json</code> </li><li style=";text-align:right;direction:rtl">  ุงูุขู ูููู <code>runtimeOnly(project(":frontend"))</code> ุงูุฃูุงููุฉ ูู ููู JAR ูุงุณุชุฎุฏุงูู ูุชุจุนูุฉ ( <code>runtimeOnly(project(":frontend"))</code> ูู <i>ุงููุงุฌูุฉ ุงูุฎูููุฉ</i> ) ุ ูุฐูู ูุญู ุจุญุงุฌุฉ ุฅูู ูุตู ูููุฉ ุชููู ุจูุณุฎ ุงููููุงุช ูู ุฏููู ุงูุชุฌููุน ุฅูู <i>/ ุงูุนุงูุฉ</i> ููุฎูู ููู ุฌุฑุฉ </li></ul><br>  <u>ููุงุญุธุฉ:</u> <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุจุชุญุฑูุฑ <code>vue.config.js</code> ุ ูุชุบููุฑ ุฏููู <code>vue.config.js</code> <i>ูุฅูุดุงุก / dist</i> . </li><li style=";text-align:right;direction:rtl">  ูู ููู <i>ุงูุจุฑูุงูุฌ ุงููุตู</i> <code>vue-cli-service build</code> ุ ุญุฏุฏ ุจูุงุก <code>vue-cli-service build</code> ุฃู ุชุฃูุฏ ูู ุชุญุฏูุฏู </li></ul><br>  ูุฌุจ ุฃู ูุญุชูู ููู settings.gradle.kts ูู ูุดุฑูุน ุงูุฌุฐุฑ ุนูู ุงูููุฏ ุงูุชุงูู: ... <br><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs">rootProject.name = <span class="hljs-string"><span class="hljs-string">"demo"</span></span> include(<span class="hljs-string"><span class="hljs-string">":frontend"</span></span>, <span class="hljs-string"><span class="hljs-string">":backend"</span></span>)</code> </pre><br>  ... ูู ุงุณู ุงููุดุฑูุน ูุงููุดุงุฑูุน ุงููุฑุนูุฉ. <br><br>  ูุงูุขู ูููููุง ุจูุงุก ุงููุดุฑูุน ุนู ุทุฑูู ุชุดุบูู ุงูุฃูุฑ: <code>./gradlew build</code> <br><br>  <u>ููุงุญุธุฉ:</u> ุฅุฐุง ูุงูุช ุงูุนูุงุตุฑ ุงููุงุฆุจุฉ ุงููุญุฏุฏุฉ ูู <i>application.properties</i> (ุนูู ุณุจูู ุงููุซุงู ุ <code>${SPRING_DATASOURCE_URL}</code> ) ูุง ุชูุฌุฏ ูุชุบูุฑุงุช ุจูุฆุฉ ููุงุจูุฉ ุ <code>${SPRING_DATASOURCE_URL}</code> ุงูุชุฌููุน.  ูุชุฌูุจ ุฐูู ุ ุงุณุชุฎุฏู <code><b>/gradlew build -x</b></code> <br><br>  ููููู ุงูุชุญูู ูู ุจููุฉ ุงููุดุฑูุนุงุช ุจุงุณุชุฎุฏุงู ุฃูุฑ <code>gradle -q projects</code> ุ ูุฌุจ ุฃู ุชุจุฏู ุงููุชูุฌุฉ ูุดุงุจูุฉ ููุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Root project 'demo' +--- Project ':backend' \--- Project ':frontend'</code> </pre> <br>  ูุฃุฎูุฑูุง ุ ูุชุดุบูู ุงูุชุทุจูู ุ ูุฌุจ ุชุดุบูู <code>./gradlew bootRun</code> . <br><br><h4 style=";text-align:right;direction:rtl">  .gitignore </h4><br>  ูุฌุจ ุฅุถุงูุฉ ุงููููุงุช ูุงููุฌูุฏุงุช ุงูุชุงููุฉ ุฅูู ููู <i>.gitignore</i> : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุฎูููุฉ / ุจูุงุก / </li><li style=";text-align:right;direction:rtl">  ุงููุงุฌูุฉ ุงูุฃูุงููุฉ / ุจูุงุก / </li><li style=";text-align:right;direction:rtl">  ุจูุงุก </li><li style=";text-align:right;direction:rtl">  .gradle </li></ul><br>  <u>ูุงู:</u> ูุฌุจ ุฃูุง ุชุถูู ูููุงุช <code>gradlew</code> ุฅูู <code>gradlew</code> - ูุง ููุฌุฏ ุดูุก ุฎุทูุฑ ูููุง ุ ูููููุง ุถุฑูุฑูุฉ ููุชุฌููุน ุงููุงุฌุญ ุนูู ุฎุงุฏู ุจุนูุฏ. <br><br><h4 style=";text-align:right;direction:rtl">  ูุดุฑ ุนูู Heroku </h4><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูุชุบููุฑุงุช ุงูุชู ูุญุชุงุฌ ุฅูููุง ูู ุฃุฌู ูุดุฑ ุงูุชุทุจูู ุจุฃูุงู ูู Heroku. <br><br>  <b># 1 Procfile</b> <br><br>  ูุญู ุจุญุงุฌุฉ ุฅูู ุฃู ูุณุฃู ุชุนูููุงุช Heroku ุฌุฏูุฏุฉ ูุฅุทูุงู ุงูุชุทุจูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">web: java -Dserver.port=$PORT -jar backend/build/libs/backend-0.0.1-SNAPSHOT.jar</code> </pre> <br>  <b># 2 ูุชุบูุฑุงุช ุงูุจูุฆุฉ</b> <br><br>  Heroku ูุงุฏุฑ ุนูู ุฅุนุงุฏุฉ ุชุดููู ููุน ุงูุชุทุจูู (ุนูู ุณุจูู ุงููุซุงู ุ ุชุทุจูู Spring Boot) ูุงุชุจุงุน ุฅุฑุดุงุฏุงุช ุงูุชุฌููุน ุงูููุงุณุจุฉ.  ููู ุชุทุจูููุง (ูุดุฑูุน ุงูุฌุฐุฑ) ูุง ูุจุฏู ููุฃูู ุชุทุจูู Spring Boot ุนูู Heroku.  ุฅุฐุง ุชุฑููุง ูู ุดูุก ููุง ูู ุ ูุณูุทูุจ ููุง Heroku ุชุญุฏูุฏ <code>stage</code> .  ุจุตุฑุงุญุฉ ุ ูุง ุฃุนุฑู ุฃูู ููุชูู ูุฐุง ุงููุณุงุฑ ุ ูุฃููู ูู ุฃุชุจุนู.  ูู ุงูุฃุณูู ุชุญุฏูุฏ ูุชุบูุฑ <code>GRADLE_TASK</code> ุจูููุฉ <code>build</code> : <br><br><img src="https://habrastorage.org/webt/5j/xz/o2/5jxzo2ukto8lyakkxajjg5rrvtg.png"><br><br>  <b># 3 reCAPTCHA</b> <br><br>  ุนูุฏ ูุถุน ุงูุชุทุจูู ูู ูุฌุงู ุฌุฏูุฏ ุ ูุง ุชูุณู ุชุญุฏูุซ ูููุฉ ุงูุชุญูู ุ ุญูุซ ุชุนูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุนูู <code>GOOGLE_RECAPTCHA_KEY_SITE</code> ู <code>GOOGLE_RECAPTCHA_KEY_SECRET</code> ุ ููุฐูู ุชุญุฏูุซ ููุชุงุญ ุงููููุน ูู ุงููุงุฌูุฉ ุงููุฑุนูุฉ ูููุดุฑูุน ุงูุฃูุงูู. <br><br><a name="cookies"></a><br><h2 style=";text-align:right;direction:rtl">  ุชุฎุฒูู JWT ุฑูุฒ ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท </h2><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุฃูุตู ุจุดุฏุฉ ุจูุฑุงุกุฉ ููุงู " <a href="https://www.rdegges.com/2018/please-stop-using-local-storage/" rel="nofollow">ุงูุฑุฌุงุก ุงูุชููู ุนู ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุญูู"</a> ุ ูุฎุงุตุฉู <i>ููุงุฐุง ูููู ุงูุชุฎุฒูู ุงููุญูู ุบูุฑ ุขูู ููุฌุจ ุนุฏู ุงุณุชุฎุฏุงูู ูุชุฎุฒูู ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ</i> . <br><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููููุฉ ุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ JWT ูู ููุงู ุฃูุซุฑ ุฃูุงููุง - ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูู ุนูุงูุฉ <code>httpOnly</code> ุ ุญูุซ ูู ูููู ูุชุงุญูุง ูููุฑุงุกุฉ / ุงูุชุบููุฑ ุจุงุณุชุฎุฏุงู JavaScript. <br><br>  <b># 1</b> ุฅุฒุงูุฉ ูู ุงูููุทู ุงููุชุนูู ุจู JWT ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ: <br>  ูุธุฑูุง ูุฃู ุงูุฑูุฒ ุงููููุฒ ูุง ูุฒุงู ุบูุฑ ูุงุจู ูููุตูู ุจูุงุณุทุฉ JavaScript ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงูุชุฎุฒูู ุงูุฌุฏูุฏุฉ ุ ููููู ุฅุฒุงูุฉ ุฌููุน ุงูุฅุดุงุฑุงุช ุฅููู ุจุฃูุงู ูู ูุดุฑูุนูุง ุงููุฑุนู. <br><br>  ููู ุฏูุฑ ุงููุณุชุฎุฏู ุฏูู ุงูุฑุฌูุน ุฅูู ุฃู ุจูุงูุงุช ุฃุฎุฑู ููุณ ูุนูููุงุช ูููุฉ ุ ููุง ูุฒุงู ูู ุงููููู ุชุฎุฒููู ูู ุงูุชุฎุฒูู ุงููุญูู ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุตุฑุญูุง ุจู ุฃู ูุง ุ ููููุง ููุง ุฅุฐุง ูุงู ูุฐุง ุงูุฏูุฑ ูุญุฏุฏูุง ุฃู ูุง. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">store / index.js</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vue <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vuex <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex'</span></span>; Vue.use(Vuex); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> state = { <span class="hljs-attr"><span class="hljs-attr">role</span></span>: localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'user-role'</span></span>) || <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">username</span></span>: localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'user-name'</span></span>) || <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">authorities</span></span>: localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'authorities'</span></span>) || <span class="hljs-string"><span class="hljs-string">''</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getters = { <span class="hljs-attr"><span class="hljs-attr">isAuthenticated</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state.role != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; state.role != <span class="hljs-string"><span class="hljs-string">''</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }, <span class="hljs-attr"><span class="hljs-attr">isAdmin</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state.role === <span class="hljs-string"><span class="hljs-string">'admin'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }, <span class="hljs-attr"><span class="hljs-attr">getUsername</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state.username; }, <span class="hljs-attr"><span class="hljs-attr">getAuthorities</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state.authorities; } }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mutations = { <span class="hljs-attr"><span class="hljs-attr">auth_login</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, user</span></span></span><span class="hljs-function">) =&gt;</span></span> { localStorage.setItem(<span class="hljs-string"><span class="hljs-string">'user-name'</span></span>, user.username); localStorage.setItem(<span class="hljs-string"><span class="hljs-string">'user-authorities'</span></span>, user.roles); state.username = user.username; state.authorities = user.roles; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isUser = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isAdmin = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; user.roles.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user.roles[i].authority === <span class="hljs-string"><span class="hljs-string">'ROLE_USER'</span></span>) { isUser = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (user.roles[i].authority === <span class="hljs-string"><span class="hljs-string">'ROLE_ADMIN'</span></span>) { isAdmin = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isUser) { localStorage.setItem(<span class="hljs-string"><span class="hljs-string">'user-role'</span></span>, <span class="hljs-string"><span class="hljs-string">'user'</span></span>); state.role = <span class="hljs-string"><span class="hljs-string">'user'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isAdmin) { localStorage.setItem(<span class="hljs-string"><span class="hljs-string">'user-role'</span></span>, <span class="hljs-string"><span class="hljs-string">'admin'</span></span>); state.role = <span class="hljs-string"><span class="hljs-string">'admin'</span></span>; } }, <span class="hljs-attr"><span class="hljs-attr">auth_logout</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { state.token = <span class="hljs-string"><span class="hljs-string">''</span></span>; state.role = <span class="hljs-string"><span class="hljs-string">''</span></span>; state.username = <span class="hljs-string"><span class="hljs-string">''</span></span>; state.authorities = []; localStorage.removeItem(<span class="hljs-string"><span class="hljs-string">'user-role'</span></span>); localStorage.removeItem(<span class="hljs-string"><span class="hljs-string">'user-name'</span></span>); localStorage.removeItem(<span class="hljs-string"><span class="hljs-string">'user-authorities'</span></span>); } }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actions = { <span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context, user</span></span></span><span class="hljs-function">) =&gt;</span></span> { context.commit(<span class="hljs-string"><span class="hljs-string">'auth_login'</span></span>, user) }, <span class="hljs-attr"><span class="hljs-attr">logout</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) =&gt;</span></span> { context.commit(<span class="hljs-string"><span class="hljs-string">'auth_logout'</span></span>); } }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vuex.Store({ state, getters, mutations, actions });</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุญุฐุฑูุง ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุณููู </font></font><code>store/index.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ุฅุฐุง ูู ูุนูู ุงูุชูููุถ ูุฅูุบุงุก ุงูุชุตุฑูุญ ุจุดูู ุตุญูุญ ุ ูุณุชุณุชูุฑ ุฑุณุงุฆู ุงูุฎุทุฃ ูู ูุญุฏุฉ ุงูุชุญูู. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฑุฌุงุน JWT ูููู ุชุนุฑูู ุงุฑุชุจุงุท ูู ูุญุฏุฉ ุชุญูู ุงูุชุฎููู ( </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุณ ูู ูุต ุงูุงุณุชุฌุงุจุฉ</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authCookieName: String <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isCookieSecure: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-meta"><span class="hljs-meta">@PostMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/signin"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticateUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Valid</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@RequestBody</span></span></span></span><span class="hljs-function"><span class="hljs-params"> loginRequest: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LoginUser</span></span></span></span><span class="hljs-function"><span class="hljs-params">, response: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HttpServletResponse</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Validation failed (ReCaptcha v2)"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (userCandidate.isPresent) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> user: User = userCandidate.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authentication = authenticationManager.authenticate( UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password)) SecurityContextHolder.getContext().setAuthentication(authentication) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> jwt: String = jwtProvider.generateJwtToken(user.username!!) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cookie: Cookie = Cookie(authCookieName, jwt) cookie.maxAge = jwtProvider.jwtExpiration!! cookie.secure = isCookieSecure cookie.isHttpOnly = <span class="hljs-literal"><span class="hljs-literal">true</span></span> cookie.path = <span class="hljs-string"><span class="hljs-string">"/"</span></span> response.addCookie(cookie) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"User not found!"</span></span>), HttpStatus.BAD_REQUEST) } }</code> </pre><br></div></div><br> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงู</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : ูุฑุฌู ููุงุญุธุฉ ุฃู ุฃุถุน ุฎูุงุฑุงุช </font></font><code>authCookieName</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>isCookieSecure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ุฅุฑุณุงู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ุฅูู ุงูุนูู </font></font><code>secure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ูููู ุฅูุง ุงูุดุจููุ ุงูุฃูุฑ ุงูุฐู ูุฌุนู ูู ุงูุตุนุจ ุงูุชุตุญูุญ ูุน ุงููุถูู ุงููุญูู ููุบุงูุฉ. </font><font style="vertical-align: inherit;">ูููู ูู ุงูุฅูุชุงุฌ ุ ุจุงูุทุจุน ุ ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท ูุน ูุฐู ุงูุนูุงูุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุถูุง ุ ูููุตุญ ุงูุขู ุจุงุณุชุฌุงุจุงุช ูุญุฏุฉ ุงูุชุญูู ูุงุณุชุฎุฏุงู ููุงู ุจุฏูู ุญูู ุฎุงุต ูู JWT. </font><font style="vertical-align: inherit;">ุงูุชุญุฏูุซ </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฑูู 3</font></font></b><font style="vertical-align: inherit;"></font><code>JwtAuthTokenFilter</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุนุชุฏูุง ุฃู ูุฃุฎุฐ ุฑูุฒูุง ูููุฒูุง ูู ุฑุฃุณ ุงูุทูุจ ุ ูุงูุขู ูุฃุฎุฐู ูู ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JwtAuthTokenFilter.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authCookieName: String ... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getJwt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HttpServletRequest</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: String? { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cookie <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> request.cookies) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cookie.name == authCookieName) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cookie.value } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre><br></div></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูููู </font></font><a href="https://ru.wikipedia.org/wiki/Cross-origin_resource_sharing" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CORS</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง ูุงู ูู ููุงูุชู ุงูุณุงุจูุฉ ูุง ูุฒุงู ุจุฅููุงูู ุชุฎุทู ูุฐุง ุงูุณุคุงู ุจูุฏูุก ุ ุงูุขู ุณูููู ูู ุงูุบุฑูุจ ุญูุงูุฉ ุงูุฑูุฒ ุงููููุฒ JWT ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชูููู CORS ุนูู ุงูุฌุงูุจ ุงูุฎููู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุฅุตูุงุญ ูุฐุง ุนู ุทุฑูู ุงูุชุนุฏูู </font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WebSecurityConfig.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">corsConfigurationSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: CorsConfigurationSource { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> configuration = CorsConfiguration() configuration.allowedOrigins = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"http://localhost:8080"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://localhost:8081"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://kotlin-spring-vue-gradle-demo.herokuapp.com"</span></span>) configuration.allowedHeaders = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"*"</span></span>) configuration.allowedMethods = Arrays.asList(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-string"><span class="hljs-string">"PUT"</span></span>, <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span>, <span class="hljs-string"><span class="hljs-string">"OPTIONS"</span></span>) configuration.allowCredentials = <span class="hljs-literal"><span class="hljs-literal">true</span></span> configuration.maxAge = <span class="hljs-number"><span class="hljs-number">3600</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> source = UrlBasedCorsConfigurationSource() source.registerCorsConfiguration(<span class="hljs-string"><span class="hljs-string">"/**"</span></span>, configuration) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source } <span class="hljs-meta"><span class="hljs-meta">@Throws(Exception::class)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">configure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(http: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HttpSecurity</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { http .cors().and() .csrf().disable().authorizeRequests() .antMatchers(<span class="hljs-string"><span class="hljs-string">"/**"</span></span>).permitAll() .anyRequest().authenticated() .and() .exceptionHandling().authenticationEntryPoint(unauthorizedHandler).and() .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) http.addFilterBefore(authenticationJwtTokenFilter(), UsernamePasswordAuthenticationFilter::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">headers</span></span></span></span>().cacheControl().disable() }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงูุขู ููููู ุฅุฒุงูุฉ ุฌููุน ุงูุชุนูููุงุช ุงูุชูุถูุญูุฉ </font></font><code>@CrossOrigin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุญุฏุงุช ุงูุชุญูู. </font></font><br><br> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงู:</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุนููุฉ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AllowCredentials</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุทููุจุฉ ูุฅุฑุณุงู ุงูุทูุจุงุช ูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ. </font><font style="vertical-align: inherit;">ุงูุฑุฃ ุงููุฒูุฏ ุนู ูุฐุง </font></font><a href="https://stackoverflow.com/questions/45004354/when-should-i-really-set-access-control-allow-credentials-to-true-in-my-resp" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุฏูุซ ุงูุฑุคูุณ ุนูู ุงูุฌุงูุจ ุงูุฃูุงูู:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HTTP-commons.js</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AXIOS = axios.create({ <span class="hljs-attr"><span class="hljs-attr">baseURL</span></span>: <span class="hljs-string"><span class="hljs-string">`/api`</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: { <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Origin'</span></span>: [<span class="hljs-string"><span class="hljs-string">'http://localhost:8080'</span></span>, <span class="hljs-string"><span class="hljs-string">'http://localhost:8081'</span></span>, <span class="hljs-string"><span class="hljs-string">'https://kotlin-spring-vue-gradle-demo.herokuapp.com'</span></span>], <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Methods'</span></span>: <span class="hljs-string"><span class="hljs-string">'GET,POST,DELETE,PUT,OPTIONS'</span></span>, <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Headers'</span></span>: <span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-string"><span class="hljs-string">'Access-Control-Allow-Credentials'</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } })</code> </pre><br></div></div><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูุชูุด </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุนููุง ูุญุงูู ุชุณุฌูู ุงูุฏุฎูู ุฅูู ุงูุชุทุจูู ูู ุฎูุงู ุชุณุฌูู ุงูุฏุฎูู ูู ูุถูู ุบูุฑ ููุฌูุฏ ูู ุงููุงุฆูุฉ ุงููุณููุญ ุจูุง </font></font><code>WebSecurityConfig.kt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูู ุจุชุดุบูู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุนูู ุงููููุฐ </font></font><code>8080</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ </font></font><code>8082</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุงูู ุชุณุฌูู ุงูุฏุฎูู:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุฏู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/sw/ce/hk/swcehkifaph10nqjveh17sv1w88.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทูุจ ุชูููุถ ุชู ุฑูุถู ุจูุงุณุทุฉ ุณูุงุณุฉ CORS. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฏุนูุง ูุฑู ููู ุชุนูู ูููุงุช ุชุนุฑูู ุงุฑุชุจุงุท ุงูุนูู ุจุดูู ุนุงู </font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ุฏุนูุง ูุฐูุจ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅูู ุงููููุน </font></font><a href="https://kotlinlang.org/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://kotlinlang.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููููุฐู ูู ูุญุฏุฉ ุชุญูู ุงููุณุชุนุฑุถ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.cookie</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุฏู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/4o/s7/ct/4os7ctztsejgbzclio8ci8nloky.png"><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ุชุธูุฑ </font></font><code>httpOnly</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท </font><font style="vertical-align: inherit;">ุบูุฑ </font><font style="vertical-align: inherit;">ุงููุฑุชุจุทุฉ ุจูุฐุง ุงููููุน </font><font style="vertical-align: inherit;">ูู ูุญุฏุฉ ุงูุชุญูู </font><font style="vertical-align: inherit;">ุ ูุงูุชู ุ ููุง ูุฑู ุ ูููู ุงููุตูู ุฅูููุง ุนุจุฑ JavaScript. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุฏุนูุง ูุฐูุจ ุฅูู ุชุทุจูููุง ุ ูู </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุชุณุฌูู ุงูุฏุฎูู</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุจุญูุซ </font><font style="vertical-align: inherit;">ูุญูุธ </font><font style="vertical-align: inherit;">ุงููุชุตูุญ </font><font style="vertical-align: inherit;">ููู ุชุนุฑูู ุงูุงุฑุชุจุงุท </font><font style="vertical-align: inherit;">ูุน JWT) ููุฑุฑ ููุณ ุงูุดูุก:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุฏู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fh/_b/zh/fh_bzh9ytv6rf_xn40fjf3c83ag.png"><br></div></div><br> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ:</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุทุฑููุฉ ุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ JWT ูุฐู ุฃูุซุฑ ููุซูููุฉ ูู ุงุณุชุฎุฏุงู Local Storage ุ ููู ูุฌุจ ุฃู ุชููู ุฃููุง ููุณุช ุญูุงู ุณุญุฑููุง.</font></font><br><br><a name="confirmation"></a><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุฃููุฏ ุชุณุฌูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุง ููู ุฎูุงุฑุฒููุฉ ูุฎุชุตุฑุฉ ูุชูููุฐ ูุฐู ุงููููุฉ: </font></font><br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ูุฌููุน ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ุ </font></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุชุนููู </font><font style="vertical-align: inherit;">ุงูุณูุฉ </font><font style="vertical-align: inherit;">ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุนูู</font></font><code>false</code> </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุฅูุดุงุก ุฑูุฒ ุณูุณูุฉ ูู ุงูุฃุญุฑู ุงูุชุนุณููุฉ ุ ูุงูุชู ุณุชููู ุจูุซุงุจุฉ ููุชุงุญ ูุชุฃููุฏ ุงูุชุณุฌูู </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชู ุฅุฑุณุงู ุงูุฑูุฒ ุงููููุฒ ุฅูู ุงููุณุชุฎุฏู ูู ุงูุจุฑูุฏ ูุฌุฒุก ูู ุงูุงุฑุชุจุงุท </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"></font><code>isEnabled</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู ุถุจุท </font><font style="vertical-align: inherit;">ุงูุณูุฉ </font><font style="vertical-align: inherit;">ุนูู " </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุตุญูุญ"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฐุง </font><i><font style="vertical-align: inherit;">ุงุชุจุน</font></i><font style="vertical-align: inherit;"> ุงููุณุชุฎุฏู ุงูุฑุงุจุท ููุชุฑุฉ ุฒูููุฉ ูุญุฏุฏุฉ.</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุงููุธุฑ ูู ูุฐู ุงูุนูููุฉ ุจูุฒูุฏ ูู ุงูุชูุตูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชุงุฌ ุฅูู ุฌุฏูู ูุชุฎุฒูู ุงูุฑูุฒ ุงููููุฒ ูุชุฃููุฏ ุงูุชุณุฌูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> public.verification_token ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">serial</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, token <span class="hljs-built_in"><span class="hljs-built_in">character</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varying</span></span>, expiry_date <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">without</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> zone, user_id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> public.verification_token <span class="hljs-keyword"><span class="hljs-keyword">ADD</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> verification_token_users_fk <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (user_id) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> public.users (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">MATCH</span></span> SIMPLE <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASCADE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CASCADE</span></span>;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููููุง ูุฐูู ุ ููุงู ุฌุฏูุฏ ูุฑุณู ุงูุฎุฑุงุฆุท ุฐุงุช ุงูุนูุงูุฉ ุจุงููุงุฆู ...: </font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationToken.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kotlinspringvue.backend.jpa <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Calendar <span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table(name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"verification_token"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VerificationToken</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue(strategy = GenerationType.AUTO)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> id: <span class="hljs-built_in"><span class="hljs-built_in">Long</span></span>? = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-meta"><span class="hljs-meta">@Column(name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"token"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> token: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-meta"><span class="hljs-meta">@Column(name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"expiry_date"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> expiryDate: Date, <span class="hljs-meta"><span class="hljs-meta">@OneToOne(targetEntity = User::class, fetch = FetchType.EAGER, cascade = [CascadeType.PERSIST])</span></span> <span class="hljs-meta"><span class="hljs-meta">@JoinColumn(nullable = false, name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"user_id"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> user: User ) { <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(token: String?, user: User) : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, token, calculateExpiryDate(<span class="hljs-number"><span class="hljs-number">1440</span></span>), user) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateExpiryDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(expiryTimeInMinutes: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Date { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cal = Calendar.getInstance() cal.time = Timestamp(cal.time.time) cal.add(Calendar.MINUTE, expiryTimeInMinutes) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Date(cal.time.time) }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... ูุงููุณุชูุฏุน: </font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VerificationTokenRepository.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kotlinspringvue.backend.repository <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.jpa.VerificationToken <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.jpa.repository.JpaRepository <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.* <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VerificationTokenRepository</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">JpaRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">VerificationToken, Long</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findByToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Optional&lt;VerificationToken&gt; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ุงูุขู ุจุญุงุฌุฉ ุฅูู ุชูููุฐ ุฃุฏูุงุช ูุฅุฏุงุฑุฉ ุงูุฑููุฒ - ุฅูุดุงุก ูุงูุชุญูู ูุงูุฅุฑุณุงู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู. </font><font style="vertical-align: inherit;">ููููุงู ุจุฐูู ุ ูููู ุจุชุนุฏูู </font></font><code>UserDetailsServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนู ุทุฑูู ุฅุถุงูุฉ ุทุฑู ูุฅูุดุงุก ูุงูุชุญูู ูู ุงูุฑูุฒ ุงููููุฒ:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDetailsServiceImpl.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createVerificationTokenForUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, user: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">User</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { tokenRepository.save(VerificationToken(token, user)) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validateVerificationToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(token: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: String { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> verificationToken: Optional&lt;VerificationToken&gt; = tokenRepository.findByToken(token) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (verificationToken.isPresent) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> user: User = verificationToken.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>().user <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cal: Calendar = Calendar.getInstance() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((verificationToken.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>().expiryDate.time - cal.time.time) &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { tokenRepository.delete(verificationToken.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TOKEN_EXPIRED } user.enabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> tokenRepository.delete(verificationToken.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>()) userRepository.save(user) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TOKEN_VALID } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> TOKEN_INVALID } }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ุงูุขู ุทุฑููุฉ ูุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู ูุน ุฑุงุจุท ุชุฃููุฏ ุฅูู </font></font><code>EmailServiceImpl</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EmailServiceImpl.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"> <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${host.url}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hostUrl: String <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userDetailsService: UserDetailsServiceImpl ... <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRegistrationConfirmationEmail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">User</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> token = UUID.randomUUID().toString() userDetailsService.createVerificationTokenForUser(token, user) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> link = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$hostUrl</span></span></span><span class="hljs-string">/?token=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$token</span></span></span><span class="hljs-string">&amp;confirmRegistration=true"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> msg = <span class="hljs-string"><span class="hljs-string">"&lt;p&gt;Please, follow the link to complete your registration:&lt;/p&gt;&lt;p&gt;&lt;a href=\"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$link</span></span></span><span class="hljs-string">\"&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$link</span></span></span><span class="hljs-string">&lt;/a&gt;&lt;/p&gt;"</span></span> user.email?.let{sendHtmlMessage(user.email!!, <span class="hljs-string"><span class="hljs-string">"KSVG APP: Registration Confirmation"</span></span>, msg)} }</code> </pre><br></div></div><br>  <u>ููุงุญุธุฉ:</u> <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุตู ุจุชุฎุฒูู ุนููุงู URL ุงูุฎุงุต ุจุงููุถูู ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application.properties</font></font></i> </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุฑุงุจุท ุงูุฎุงุต ุจูุง ุ ูููู ุจุชูุฑูุฑ ูุนููุชูู GET ( </font></font><code>token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ุฅูู ุงูุนููุงู ุงูุฐู ูุชู ููู ูุดุฑ ุงูุชุทุจูู. </font><font style="vertical-align: inherit;">ูู ููุช ูุงุญู ุณูู ุงุดุฑุญ ููุงุฐุง.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ุจุชุนุฏูู ูุญุฏุฉ ุงูุชุญูู ูู ุงูุชุณุฌูู ููุง ููู: </font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูููู ุฌููุน ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ุจุชุนููู ุงููููุฉ </font></font><code>false</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุญูู</font></font><code>isEnabled</code> </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ ุ ุณูู ูุฑุณู ุฑุณุงูุฉ ุจุฑูุฏ ุฅููุชุฑููู ูุชุฃููุฏ ุงูุชุณุฌูู </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูุดุงุก ูุญุฏุฉ ุชุญูู ุงูุชุญูู ูู ุตุญุฉ ุงูุฑูุฒ ูููุตูุฉ </font></font></li><li style=";text-align:right;direction:rtl"> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู:</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุซูุงุก ุงูุชูููุถ ุ ุณูุชุญูู ูู ุงูุชุญูู ูู ุงูุญุณุงุจ:</font></font></li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AuthController.kt</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.kotlinspringvue.backend.controller <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.email.EmailService <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.validation.Valid <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.stream.Collectors <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Autowired <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.HttpStatus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.http.ResponseEntity <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.authentication.AuthenticationManager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.authentication.UsernamePasswordAuthenticationToken <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.context.SecurityContextHolder <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.crypto.password.PasswordEncoder <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.GrantedAuthority <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.security.core.authority.SimpleGrantedAuthority <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.ui.Model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.model.LoginUser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.model.NewUser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.web.response.SuccessfulSigninResponse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.web.response.ResponseMessage <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.jpa.User <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.repository.UserRepository <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.repository.RoleRepository <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.jwt.JwtProvider <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.ReCaptchaService <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.UserDetailsService <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.Value <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.context.ApplicationEventPublisher <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.<span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>.* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.context.request.WebRequest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.UnsupportedEncodingException <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.Cookie <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.HttpServletRequest <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.servlet.http.HttpServletResponse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_VALID <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_INVALID <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.kotlinspringvue.backend.service.UserDetailsServiceImpl.Companion.TOKEN_EXPIRED <span class="hljs-meta"><span class="hljs-meta">@RestController</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/api/auth"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthController</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${ksvg.app.authCookieName}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authCookieName: String <span class="hljs-meta"><span class="hljs-meta">@Value(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"\${ksvg.app.isCookieSecure}"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isCookieSecure: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> authenticationManager: AuthenticationManager <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userRepository: UserRepository <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> roleRepository: RoleRepository <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> encoder: PasswordEncoder <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> jwtProvider: JwtProvider <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> captchaService: ReCaptchaService <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userService: UserDetailsService <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> emailService: EmailService <span class="hljs-meta"><span class="hljs-meta">@PostMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/signin"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">authenticateUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Valid</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@RequestBody</span></span></span></span><span class="hljs-function"><span class="hljs-params"> loginRequest: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LoginUser</span></span></span></span><span class="hljs-function"><span class="hljs-params">, response: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">HttpServletResponse</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(loginRequest.username!!) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!captchaService.validateCaptcha(loginRequest.recaptchaToken!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Validation failed (ReCaptcha v2)"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (userCandidate.isPresent) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> user: User = userCandidate.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!user.enabled) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Account is not verified yet! Please, follow the link in the confirmation email."</span></span>), HttpStatus.UNAUTHORIZED) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authentication = authenticationManager.authenticate( UsernamePasswordAuthenticationToken(loginRequest.username, loginRequest.password)) SecurityContextHolder.getContext().setAuthentication(authentication) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> jwt: String = jwtProvider.generateJwtToken(user.username!!) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cookie: Cookie = Cookie(authCookieName, jwt) cookie.maxAge = jwtProvider.jwtExpiration!! cookie.secure = isCookieSecure cookie.isHttpOnly = <span class="hljs-literal"><span class="hljs-literal">true</span></span> cookie.path = <span class="hljs-string"><span class="hljs-string">"/"</span></span> response.addCookie(cookie) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> authorities: List&lt;GrantedAuthority&gt; = user.roles!!.stream().map({ role -&gt; SimpleGrantedAuthority(role.name)}).collect(Collectors.toList&lt;GrantedAuthority&gt;()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity.ok(SuccessfulSigninResponse(user.username, authorities)) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"User not found!"</span></span>), HttpStatus.BAD_REQUEST) } } <span class="hljs-meta"><span class="hljs-meta">@PostMapping(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/signup"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Valid</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@RequestBody</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newUser: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">NewUser</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ResponseEntity&lt;*&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> userCandidate: Optional &lt;User&gt; = userRepository.findByUsername(newUser.username!!) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!captchaService.validateCaptcha(newUser.recaptchaToken!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Validation failed (ReCaptcha v2)"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!userCandidate.isPresent) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (usernameExists(newUser.username!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Username is already taken!"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emailExists(newUser.email!!)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ResponseEntity(ResponseMessage(<span class="hljs-string"><span class="hljs-string">"Email is already in use!"</span></span>), HttpStatus.BAD_REQUEST) } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Creating user's account val user = User( 0, newUser.username!!, newUser.firstName!!, newUser.lastName!!, newUser.email!!, encoder.encode(newUser.password), false ) user.roles = Arrays.asList(roleRepository.findByName("ROLE_USER")) val registeredUser = userRepository.save(user) emailService.sendRegistrationConfirmationEmail(registeredUser) } catch (e: Exception) { return ResponseEntity(ResponseMessage("Server error. Please, contact site owner"), HttpStatus.SERVICE_UNAVAILABLE) } return ResponseEntity(ResponseMessage("Please, follow the link in the confirmation email to complete the registration."), HttpStatus.OK) } else { return ResponseEntity(ResponseMessage("User already exists!"), HttpStatus.BAD_REQUEST) } } @PostMapping("/registrationConfirm") @CrossOrigin(origins = ["*"]) @Throws(UnsupportedEncodingException::class) fun confirmRegistration(request: HttpServletRequest, model: Model, @RequestParam("token") token: String): ResponseEntity&lt;*&gt; { when(userService.validateVerificationToken(token)) { TOKEN_VALID -&gt; return ResponseEntity.ok(ResponseMessage("Registration confirmed")) TOKEN_INVALID -&gt; return ResponseEntity(ResponseMessage("Token is invalid!"), HttpStatus.BAD_REQUEST) TOKEN_EXPIRED -&gt; return ResponseEntity(ResponseMessage("Token is invalid!"), HttpStatus.UNAUTHORIZED) } return ResponseEntity(ResponseMessage("Server error. Please, contact site owner"), HttpStatus.SERVICE_UNAVAILABLE) } @PostMapping("/logout") fun logout(response: HttpServletResponse): ResponseEntity&lt;*&gt; { val cookie: Cookie = Cookie(authCookieName, null) cookie.maxAge = 0 cookie.secure = isCookieSecure cookie.isHttpOnly = true cookie.path = "/" response.addCookie(cookie) return ResponseEntity.ok(ResponseMessage("Successfully logged")) } private fun emailExists(email: String): Boolean { return userRepository.findByUsername(email).isPresent } private fun usernameExists(username: String): Boolean { return userRepository.findByUsername(username).isPresent } }</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุขู ุ ุฏุนููุง ูุนูู ุนูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ: </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูุดุงุก ูููู </font></font><code>RegistrationConfirmPage.vue</code> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃุถู ูุณุงุฑูุง ุฌุฏูุฏูุง </font></font><code>router.js</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ุงููุนููุฉ </font></font><code>:token</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'/registration-confirm/:token'</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'RegistrationConfirmPage'</span></span>, <span class="hljs-attr"><span class="hljs-attr">component</span></span>: RegistrationConfirmPage }</code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุฏูุซ </font></font><code>SignUp.vue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ุจุนุฏ ุฅุฑุณุงู ุงูุจูุงูุงุช ุจูุฌุงุญ ูู ุงูููุงุฐุฌ ุ ุณูุจูุบูู ุฃูู ูุฅููุงู ุงูุชุณุฌูู ุ ูุฌุจ ุนููู ุงุชุจุงุน ุงูุฑุงุจุท ูู ุงูุฑุณุงูุฉ. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 4 </font></font></b> <u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููู:</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฃุณู ุ ูุง ูููููุง ุฅุนุทุงุก ุฑุงุจุท ุซุงุจุช ููููู ูููุตู ูู ุดุฃูู ุงูุชุญูู ูู ุตุญุฉ ุงูุฑูุฒ ุงููููุฒ ูุงูุฅุจูุงุบ ุนู ุงููุฌุงุญ ุฃู ุงููุดู. </font><font style="vertical-align: inherit;">ุณุชุคุฏู ุจูุง ุงูุฑูุงุจุท ูุน ูุณุงุฑุงุช ุงููุทุน ุงููุงุฆูุฉ ุฅูู ุตูุญุฉ ุงูุชุทุจูู ุงูุฃุตููุฉ. </font><font style="vertical-align: inherit;">ูููู ูููููุง ุฅุฎุจุงุฑ ุทูุจูุง ุนู ุงูุญุงุฌุฉ ุฅูู ุชุฃููุฏ ุงูุชุณุฌูู ุจุงุณุชุฎุฏุงู ูุนููุฉ GET ุงููููููุฉ </font></font><code>confirmRegistration</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">methods: { confirmRegistration() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$route.query.confirmRegistration === <span class="hljs-string"><span class="hljs-string">'true'</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$route.query.token != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$router.push({<span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'RegistrationConfirmPage'</span></span>, <span class="hljs-attr"><span class="hljs-attr">params</span></span>: { <span class="hljs-attr"><span class="hljs-attr">token</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$route.query.token}}); } }, ... mounted() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.confirmRegistration(); }</code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ุจุฅูุดุงุก ูููู ูููู ุจุงูุชุญูู ูู ุงูุฑูุฒ ุงููููุฒ ูุงูุชูุงุฑูุฑ ุญูู ูุชูุฌุฉ ุงูุชุญูู ูู ุงูุตุญุฉ:</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RegistrationConfirmPage.vue</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">&lt;template&gt; &lt;div id="registration-confirm"&gt; &lt;div class="confirm-form"&gt; &lt;b-card title="Confirmation" tag="article" style="max-width: 20rem;" class="mb-2" &gt; &lt;div v-if="isSuccess"&gt; &lt;p class="success"&gt;Account is successfully verified!&lt;/p&gt; &lt;router-link to="/login"&gt; &lt;b-button variant="primary"&gt;Login&lt;/b-button&gt; &lt;/router-link&gt; &lt;/div&gt; &lt;div v-if="isError"&gt; &lt;p class="fail"&gt;Verification failed:&lt;/p&gt; &lt;p&gt;{{ errorMessage }}&lt;/p&gt; &lt;/div&gt; &lt;/b-card&gt; &lt;/div&gt; &lt;/div&gt; &lt;/template&gt; &lt;script&gt; import {AXIOS} from './http-common' export default { name: 'RegistrationConfirmPage', data() { return { isSuccess: false, isError: false, errorMessage: '' } }, methods: { executeVerification() { AXIOS.post(`/auth/registrationConfirm`, null, {params: { 'token': this.$route.params.token}}) .then(response =&gt; { this.isSuccess = true; console.log(response); }, error =&gt; { this.isError = true; this.errorMessage = error.response.data.message; }) .catch(e =&gt; { console.log(e); this.errorMessage = 'Server error. Please, report this error website owners'; }) } }, mounted() { this.executeVerification(); } } &lt;/script&gt; &lt;style scoped&gt; .confirm-form { margin-left: 38%; margin-top: 50px; } .success { color: green; } .fail { color: red; } &lt;/style&gt;</code> </pre><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุคุฏู</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/0n/vj/os/0nvjosmit-f6n538uae6rsvwujo.png"><br></div></div><br><h3 style=";text-align:right;direction:rtl">  ุจุฏูุง ูู ุงูุงุณุชูุชุงุฌ </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุฎุชุงู ูู ูุฐู ุงููุงุฏุฉ ุ ุฃูุฏ ุฃู ุฃุณุชูุจุท ูุฃููู ุฅู ููููู ุงูุชุทุจูู ุงูุฐู ุชูุช ููุงูุดุชู ูู ูุฐุง ุงูููุงู ูุงูููุงู ุงูุณุงุจู ูู ููู ุฌุฏูุฏูุง ูู ููุช ูุชุงุจุฉ ูุฐุง ุงูุชูุฑูุฑ. </font><font style="vertical-align: inherit;">ุงูุนูู ุจุณุฑุนุฉ ุฅูุดุงุก ูููุฉ ูุงููุฉ ูู ุงูุชุทุจููุงุช ุนูู ุงูุชูููุฏ ุงูุฑุจูุน ุจุงุณุชุฎุฏุงู ุฌุงูุง ุณูุฑูุจุช ุงูุฃุทุฑ ุงูุญุฏูุซุฉ ุงูุฒุงูู / ุชุชูุงุนู / Vue.js ูุญู ุจุฃูุงูุฉ </font></font><a href="https://www.jhipster.tech/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุจ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุน ุฐูู ุ ูุฏ ูุชู ุชุทุจูู ุงูุฃููุงุฑ ุงูููุถุญุฉ ูู ูุฐู ุงูููุงูุฉ ุญุชู ุจุงุณุชุฎุฏุงู JHipster ุ ูุฐูู ุขูู ุฃู ูุฌุฏ ุงููุฑุงุก ุงูุฐูู ูุฃุชูู ุฅูู ูุฐุง ุงูููุงู ูุฐู ุงููุงุฏุฉ ูููุฏุฉ ุญุชู ูุบุฐุงุก ููุชูููุฑ.</font></font><br><br><a name="links"></a><br><h2 style=";text-align:right;direction:rtl">  ุฑูุงุจุท ูููุฏุฉ </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://github.com/DrLeprechaun/kotlin-spring-vue" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูุฏุน GitHub (ุญุชู ุงูุฎุทูุฉ "ุงูุชุฑุญูู ุฅูู Gradle")</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://github.com/DrLeprechaun/kotlin-spring-vue-gradle" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูุฏุน GitHub (ุจุนุฏ ุฎุทูุฉ "ุงูุชุฑุญูู ุฅูู Gradle")</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://kotlin-spring-vue-demo.herokuapp.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุทุจูู (ุญุชู ุงูุฎุทูุฉ "ุงูุชุฑุญูู ุฅูู Gradle")</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://kotlin-spring-vue-gradle-demo.herokuapp.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุทุจูู (ุจุนุฏ ุงูุฎุทูุฉ "ุงูุชุฑุญูู ุฅูู Gradle")</font></font></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://vaadimblog.blogspot.com/p/kotlin-spring-boot-vuejs.html" rel="nofollow">  ,   ,    </a> </li><li style=";text-align:right;direction:rtl"> <a href="https://itnext.io/how-to-use-google-recaptcha-with-vuejs-7756244400da" rel="nofollow">How to use Google reCaptcha with Vuejs</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://vuejsexamples.com/google-recaptcha-component-for-vue-js/" rel="nofollow">Google ReCAPTCHA component for Vue.js</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://www.baeldung.com/spring-email" rel="nofollow">Guide to Spring Email</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://medium.com/%40raviswapna1/send-email-using-spring-boot-and-thymeleaf-b0f62786bd8e" rel="nofollow">Send Email using Spring Boot and Thymeleaf</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://docs.gradle.org/5.6.3/userguide/migrating_from_maven.html" rel="nofollow">Migrating Builds From Apache Maven</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://guides.gradle.org/migrating-build-logic-from-groovy-to-kotlin/" rel="nofollow">Migrating build logic from Groovy to Kotlin</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://ordina-jworks.github.io/architecture/2018/10/12/spring-boot-angular-gradle.html" rel="nofollow">Integrate Angular in Spring Boot Using Gradle</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://devcenter.heroku.com/articles/getting-started-with-gradle-on-heroku" rel="nofollow">Getting Started with Gradle on Heroku</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://devcenter.heroku.com/articles/deploying-gradle-apps-on-heroku" rel="nofollow">Deploying Gradle Apps on Heroku</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://devcenter.heroku.com/articles/deploying-gradle-apps-on-heroku" rel="nofollow">Deploying multi-project builds</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://www.rdegges.com/2018/please-stop-using-local-storage/" rel="nofollow">Please Stop Using Local Storage</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://medium.com/%40jcbaey/authentication-in-spa-reactjs-and-vuejs-the-right-way-e4a9ac5cd9a3" rel="nofollow">Authentication in SPA (ReactJS and VueJS) the right way</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://www.ninjadevcorner.com/2018/09/stateless-authentication-jwt-secure-spring-boot-rest-api.html" rel="nofollow">Stateless Authentication using JWT to secure a Spring Boot REST API</a> </li><li style=";text-align:right;direction:rtl"> <a href="https://www.baeldung.com/registration-verify-user-by-email" rel="nofollow">Registration โ Activate a New Account by Email</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar482222/">https://habr.com/ru/post/ar482222/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar482210/index.html">ุจูุช ูุชุชุฑูุณ ูุงูุฑุณูู ุงููุชุญุฑูุฉ ุงูููุฏุณุฉ ุงูุนูุณูุฉ. ุชุญููู ุงููุณุงุฑ ุงููุญููู ูู ุจุทููุฉ ุงูุจุฑูุฌุฉ ุงูุซุงููุฉ</a></li>
<li><a href="../ar482212/index.html">ูุชุญุฏุซ ุนู ... ุงูุฌุจูุ</a></li>
<li><a href="../ar482216/index.html">23 ุฑุฏุง ุนูู ุงูุงูุชุฆุงุจ ูู ุทุจูุจ ููุณู ูุญุชุฑู ููุณูู ููุงููู (dpmmax)</a></li>
<li><a href="../ar482218/index.html">ุฌุงูุง ุฏุงูุฌุณุช ูู 27 ุฏูุณูุจุฑ</a></li>
<li><a href="../ar482220/index.html">ุชูุทูู ุนูุงูุฉ Aruco</a></li>
<li><a href="../ar482224/index.html">ุนูุฏูุง ูุญุชุงุฌ ุงููุตูู ุฅูู ุฃู ูููู ูุจุฑูุฌูุง ููููุงู</a></li>
<li><a href="../ar482226/index.html">ุฃูุถู 20 ุชุทุจูููุง ูุง ูููู ูููุฏู ุงูุฑุนุงูุฉ ุงูุตุญูุฉ ุฃู ูููุชูุง</a></li>
<li><a href="../ar482228/index.html">ููุชุจ "ุขูุฉ ุญุงุณุจุฉ" ูู C #. ุงูุฌุฒุก ุงูุฃูู. ุญุณุงุจ ุงููููุฉ ูุงููุดุชูุงุช ูุงูุชุจุณูุท ูุงูุฃูุฒ ุงูุฃุฎุฑู</a></li>
<li><a href="../ar482230/index.html">ูุนุฑูุฉ ุฎูุงุฏู ุงูููุจ. ุงูุฌุฒุก 2 - ุณููุงุฑูู HTTPS ุงููุงูุนู:</a></li>
<li><a href="../ar482232/index.html">StackOverflow ูู ุฃูุซุฑ ูู ูุฌุฑุฏ ูุณุชูุฏุน ููุฅุฌุงุจุงุช ุนูู ุงูุฃุณุฆูุฉ ุงูุบุจูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>