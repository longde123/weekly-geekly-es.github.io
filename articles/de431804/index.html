<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÉ üå®Ô∏è üèñÔ∏è So arbeiten Sie mit Ausnahmen in DDD ‚¨ÜÔ∏è üì¶ ü§¶üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Rahmen der j√ºngsten DotNext 2018- Konferenz fand BoF on Domain Driven Design statt. Es befasste sich mit der Frage der Arbeit mit Ausnahmen, die ei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So arbeiten Sie mit Ausnahmen in DDD</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/true_engineering/blog/431804/"><img src="https://habrastorage.org/webt/ue/vj/i6/uevji6om-hntwftu4kgfbt_mfsk.png" alt="Bild"><br><br>  Im Rahmen der j√ºngsten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DotNext 2018-</a> Konferenz fand BoF on Domain Driven Design statt.  Es befasste sich mit der Frage der Arbeit mit Ausnahmen, die eine hitzige Debatte ausl√∂sten, jedoch keine ausf√ºhrliche Diskussion erhielten, da dies nicht das Hauptthema war. <br><br>  Wenn Sie viele Ressourcen studieren, angefangen von Fragen zum Stackoverflow bis hin zu kostenpflichtigen Architekturkursen, k√∂nnen Sie au√üerdem feststellen, dass die IT-Community eine mehrdeutige Einstellung zu Ausnahmen und deren Verwendung hat. <br><br>  Es wird am h√§ufigsten erw√§hnt, dass es mit Ausnahmen einfach ist, einen Ausf√ºhrungsthread zu erstellen, der eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Operatorsemantik aufweist</a> , was die Lesbarkeit des Codes beeintr√§chtigt. <br><br>  Es gibt unterschiedliche Meinungen dar√ºber, ob <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie eigene Arten von Ausnahmen erstellen</a> oder die in .NET bereitgestellten Standardausnahmen verwenden sollen. <br><br>  Jemand √ºberpr√ºft Ausnahmen, und √ºberall <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verwendet</a> jemand <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Ergebnismonade</a> .  Das Ergebnis erm√∂glicht es Ihnen, anhand der Methodensignatur zu verstehen, ob eine erfolgreiche Ausf√ºhrung m√∂glich ist oder nicht.  Es ist jedoch nicht weniger wahr, dass in imperativen Sprachen (einschlie√ülich C #) die weit verbreitete Verwendung von Result zu schlecht lesbarem Code f√ºhrt, der mit Sprachkonstrukten bedeckt ist, so dass es schwierig ist, das urspr√ºngliche Skript zu erkennen. <br><br>  In diesem Artikel werde ich √ºber die Praktiken unseres Teams sprechen (kurz gesagt - wir verwenden alle Ans√§tze und keiner von ihnen ist ein Dogma). <br><br>  Wir werden √ºber eine Unternehmensanwendung sprechen, die auf der Basis von ASP.NET MVC + WebAPI erstellt wurde.  Die Anwendung basiert auf einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zwiebelarchitektur</a> und kommuniziert mit der Datenbank und dem Nachrichtenbroker.  Es verwendet eine strukturierte Protokollierung im ELK-Stack und die √úberwachung wird mit Grafana konfiguriert. <br><a name="habracut"></a><br>  Wir werden die Arbeit mit Ausnahmen aus drei Perspektiven betrachten: <br><br><ol><li>  Allgemeine Ausnahmeregeln </li><li>  Ausnahmen, Fehler und Zwiebelarchitektur </li><li>  Sonderf√§lle f√ºr Webanwendungen </li></ol><br><h2>  Allgemeine Ausnahmeregeln </h2><br><ol><li>  Ausnahmen und Fehler sind nicht dasselbe.  F√ºr Ausnahmen verwenden wir Ausnahmen, f√ºr Fehler - Ergebnis. </li><li>  Ausnahmen gelten nur f√ºr Ausnahmesituationen, die per Definition nicht viele sein k√∂nnen.  Je weniger Ausnahmen, desto besser. </li><li>  Die Ausnahmebehandlung sollte so detailliert wie m√∂glich sein.  Wie Richter in seinem monumentalen Werk schrieb. </li><li>  Wenn der Fehler in seiner urspr√ºnglichen Form an den Benutzer √ºbermittelt werden soll, verwenden Sie Ergebnis. </li><li>  Eine Ausnahme sollte die Grenzen des Systems nicht in seiner urspr√ºnglichen Form belassen.  Dies ist nicht benutzerfreundlich und gibt einem Angreifer die M√∂glichkeit, m√∂gliche Schwachstellen im System weiter zu untersuchen. </li><li>  Wenn die ausgel√∂ste Ausnahme von unserer Anwendung behandelt wird, verwenden wir nicht die Ausnahme, sondern das Ergebnis.  Die Implementierung von Ausnahmen wird vom goto-Operator ausgeblendet. Je schlimmer sie ist, desto weiter entfernt ist der Verarbeitungscode vom Ausnahme-Ausl√∂secode.  Das Ergebnis deklariert explizit die M√∂glichkeit eines Fehlers und erlaubt nur dessen "lineare" Verarbeitung. </li></ol><br><h2>  Ausnahmen, Fehler und Zwiebelarchitektur </h2><br>  In den folgenden Abschnitten werden die Verantwortlichkeiten und Regeln f√ºr das Ausl√∂sen / Behandeln von Ausnahmen / Fehlern f√ºr die folgenden Ebenen betrachtet: <br><br><ul><li>  Anwendungshosts </li><li>  Infrastruktur </li><li>  Anwendungsdienste </li><li>  Dom√§nenkern </li></ul><br><h3>  Anwendungshost </h3><br>  <b>Wof√ºr ist verantwortlich?</b> <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kompositionsstamm</a> , der den Betrieb der gesamten Anwendung anpasst. </li><li> Die Grenze der Interaktion mit der Au√üenwelt sind Benutzer, andere Dienste, geplanter Start. </li></ul><br>  Da dies recht komplexe Aufgaben sind, lohnt es sich, sich einzuschr√§nken.  Die verbleibenden Verantwortlichkeiten √ºbertragen wir auf die inneren Schichten. <br><br>  <b>Wie man mit Fehlern aus dem Ergebnis umgeht</b> <br><br>  Sendungen nach au√üen, Konvertierung in das entsprechende Format (z. B. in http-Antwort). <br><br>  <b>Wie das Ergebnis generiert wird</b> <br><br>  Auf keinen Fall.  Diese Schicht enth√§lt keine Logik, daher k√∂nnen nirgendwo Fehler generiert werden. <br><br>  <b>Umgang mit Ausnahmen</b> <br><br><ol><li>  Blendet Details aus und konvertiert sie in ein Format, das zum Senden an die Au√üenwelt geeignet ist </li><li>  Loggt sich ein. </li></ol><br>  <b>Wie man Ausnahmen wirft</b> <br><br>  Auf keinen Fall ist diese Ebene die externeste und enth√§lt keine Logik - es gibt niemanden, der eine Ausnahme ausl√∂st. <br><br><h3>  Infrastruktur </h3><br>  <b>Wof√ºr ist verantwortlich?</b> <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Adapter an Ports</a> oder einfach zum Implementieren von Dom√§nenschnittstellen, die den Zugriff auf die Infrastruktur erm√∂glichen - Dienste von Drittanbietern, Datenbanken, Active Directory usw. Diese Schicht sollte so dumm wie m√∂glich sein und so wenig Logik wie m√∂glich enthalten. </li><li>  Bei Bedarf kann es als <a href="">Antikorruptionsschicht</a> fungieren. </li></ol><br>  <b>Wie man mit Fehlern aus dem Ergebnis umgeht</b> <br><br>  Ich kenne die Datenbankanbieter und andere Dienste, die auf der Ergebnismonade ausgef√ºhrt werden, nicht.  Einige Dienste arbeiten jedoch mit R√ºckkehrcodes.  In diesem Fall konvertieren wir sie in das vom Port geforderte Ergebnisformat. <br><br>  <b>Wie das Ergebnis generiert wird</b> <br><br>  Im Allgemeinen enth√§lt diese Schicht keine Logik, was bedeutet, dass keine Fehler generiert werden.  Bei Verwendung als Antikorruptionsschicht sind jedoch verschiedene Optionen m√∂glich.  Beispiel: Analysieren Sie Ausnahmen von einem Legacy-Service und konvertieren Sie diese Ausnahmen, die einfache Validierungsnachrichten sind, in Ergebnis. <br><br>  <b>Umgang mit Ausnahmen</b> <br><br>  Im allgemeinen Fall wirft es es gegebenenfalls weiter, nachdem es die Details gesichert hat.  Wenn der zu implementierende Port die R√ºckgabe des Ergebnisses im Vertrag zul√§sst, konvertiert die Infrastruktur die Arten von Ausnahmen, die verarbeitet werden k√∂nnen, in Ergebnis. <br><br>  Beispielsweise l√∂st der im Projekt verwendete Nachrichtenbroker eine Ausnahme aus, wenn versucht wird, eine Nachricht zu senden, wenn der Broker nicht verf√ºgbar ist.  Die Application Services-Schicht ist f√ºr diese Situation bereit und kann sie mit einer Wiederholungsrichtlinie, einem Leistungsschalter oder einem manuellen Daten-Rollback verarbeiten. <br><br>  In diesem Fall deklariert die Application Services-Schicht einen Vertrag, der im Fehlerfall das Ergebnis zur√ºckgibt.  Die Infrastrukturschicht implementiert diesen Port und konvertiert die Ausnahme vom Broker in das Ergebnis.  Nat√ºrlich werden nur bestimmte Arten von Ausnahmen konvertiert und nicht alle hintereinander. <br><br>  Mit diesem Ansatz erhalten wir zwei Vorteile: <br><br><ol><li>  Erkl√§ren Sie ausdr√ºcklich die M√∂glichkeit von Fehlern im Vertrag. </li><li>  Wir beseitigen die Situation, in der der Anwendungsdienst wei√ü, wie der Fehler zu behandeln ist, aber die Art der Ausnahme nicht kennt, da sie von einem bestimmten Nachrichtenbroker abstrahiert wird.  Um einen Catch-Block auf der Basis von System.Exception zu erstellen, m√ºssen alle Arten von Ausnahmen erfasst werden, nicht nur diejenigen, die der Anwendungsdienst verarbeiten kann. </li></ol><br>  <b>Wie man Ausnahmen wirft</b> <br><br>  H√§ngt von den Besonderheiten des Systems ab. <br><br>  Beispielsweise l√∂sen die Anweisungen Single und First LINQ eine InvalidOperationException aus, wenn nicht vorhandene Daten angefordert werden.  Diese Art von Ausnahme wird jedoch √ºberall in .NET verwendet, sodass eine granulare Verarbeitung nicht m√∂glich ist. <br><br>  Wir im Team haben die Praxis √ºbernommen, eine benutzerdefinierte ItemNotFoundException zu erstellen und diese aus der Infrastrukturschicht zu werfen, wenn die angeforderten Daten nicht gefunden wurden und nicht den Gesch√§ftsregeln entsprechen sollten. <br><br>  Wenn die angeforderten Daten nicht gefunden werden und dies zul√§ssig ist, sollten sie im Hafenvertrag ausdr√ºcklich deklariert werden.  Zum Beispiel mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vielleicht-Monade</a> . <br><br><h3>  Anwendungsdienste </h3><br>  <b>Wof√ºr ist verantwortlich?</b> <br><br><ol><li>  Validierung der Eingabedaten. </li><li>  Orchestrierung und Koordination von Diensten - Beginn und Ende von Transaktionen, Implementierung verteilter Skripte usw. </li><li>  Laden Sie Dom√§nenobjekte und externe Daten √ºber Ports in die Infrastruktur herunter und rufen Sie anschlie√üend Befehle in Domain Core auf. </li></ol><br>  <b>Wie man mit Fehlern aus dem Ergebnis umgeht</b> <br><br>  Fehler vom Dom√§nenkern werden unver√§ndert in die Au√üenwelt √ºbertragen.  Fehler aus der Infrastruktur k√∂nnen durch Wiederholungsversuche, Leistungsschalterrichtlinien oder durch externe √úbertragung behoben werden. <br><br>  <b>Wie das Ergebnis generiert wird</b> <br><br>  Kann die Validierung als Ergebnis implementieren. <br><br>  Kann Benachrichtigungen √ºber den teilweisen Erfolg der Operation generieren.  Zum Beispiel Nachrichten an einen Benutzer wie ‚ÄûIhre Bestellung wurde erfolgreich aufgegeben, aber beim √úberpr√ºfen der Lieferadresse ist ein Fehler aufgetreten.  Ein Spezialist wird sich in K√ºrze mit Ihnen in Verbindung setzen, um die Lieferdetails zu kl√§ren. ‚Äú <br><br>  <b>Umgang mit Ausnahmen</b> <br><br>  Angenommen, die Infrastrukturausnahmen, die die Anwendung verarbeiten kann, werden bereits von der Infrastrukturschicht in Ergebnis konvertiert, werden sie jedoch √ºberhaupt nicht verarbeitet. <br><br>  <b>Wie man Ausnahmen wirft</b> <br><br>  Im Allgemeinen auf keinen Fall.  Es gibt jedoch Grenzoptionen, die im letzten Abschnitt des Artikels beschrieben werden. <br><br><h3>  Dom√§nenkern </h3><br>  <b>Wof√ºr ist verantwortlich?</b> <br><br>  Die Implementierung der Gesch√§ftslogik, der "Kern" des Systems und die Hauptbedeutung seiner Existenz. <br><br>  <b>Wie man mit Fehlern aus dem Ergebnis umgeht</b> <br><br>  Da die Ebene intern ist und Fehler nur von Objekten in derselben Dom√§ne m√∂glich sind, wird die Verarbeitung entweder auf Gesch√§ftsregeln oder auf die √úbersetzung des Fehlers in seiner urspr√ºnglichen Form nach oben reduziert. <br><br>  <b>Wie das Ergebnis generiert wird</b> <br><br>  Wenn Sie gegen Gesch√§ftsregeln versto√üen, die in Domain Core gekapselt sind und nicht durch die Validierung von Eingabedaten auf Application Services-Ebene abgedeckt sind.  Im Allgemeinen wird in dieser Ebene das Ergebnis am h√§ufigsten verwendet. <br><br>  <b>Umgang mit Ausnahmen</b> <br><br>  Auf keinen Fall.  Infrastrukturausnahmen wurden bereits von der Infrastrukturschicht verarbeitet, Daten sind dank der Application Services-Schicht bereits strukturiert, vollst√§ndig und validiert angekommen.  Dementsprechend sind alle Ausnahmen, die herausfliegen k√∂nnen, echte Ausnahmen. <br><br>  <b>Wie man Ausnahmen wirft</b> <br><br>  Normalerweise funktioniert hier eine allgemeine Regel: Je weniger Ausnahmen - desto besser. <br><br>  Aber hatten Sie jemals Situationen, in denen Sie Code geschrieben haben und verstanden haben, dass er unter bestimmten Umst√§nden schreckliche Gesch√§fte machen kann?  Zum Beispiel, um Geld zweimal abzuschreiben oder die Daten so sehr zu verderben, dass wir sp√§ter keine Knochen mehr sammeln. <br><br>  In der Regel handelt es sich um die Ausf√ºhrung von Befehlen, die f√ºr den aktuellen Status des Objekts nicht akzeptabel sind. <br><br>  Nat√ºrlich sollte die entsprechende Schaltfl√§che auf der Benutzeroberfl√§che in diesem Zustand nicht sichtbar sein.  In diesem Zustand sollten wir keinen Befehl vom Bus erhalten.  All dies gilt, vorausgesetzt, die √§u√üeren Schichten und Systeme haben ihre Funktion <i>normal ausgef√ºhrt</i> .  Aber in Domain Core sollten wir nichts √ºber die Existenz externer Schichten wissen und an die Richtigkeit ihrer Arbeit glauben. Wir m√ºssen die Invarianten des Systems sch√ºtzen. <br><br>  Einige der Pr√ºfungen k√∂nnen auf Validierungsebene in Application Services platziert werden.  Dies kann jedoch zu einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">defensiven Programmierung f√ºhren</a> , die im Extremfall zu Folgendem f√ºhrt: <br><br><ol><li>  Die Einkapselung wird geschw√§cht, da bestimmte Invarianten auf der √§u√üeren Schicht √ºberpr√ºft werden m√ºssen. </li><li>  Das Wissen √ºber den Themenbereich ‚Äûflie√üt‚Äú in die √§u√üere Ebene, √úberpr√ºfungen k√∂nnen von beiden Ebenen dupliziert werden. </li><li>  Das √úberpr√ºfen <i>der</i> Ausf√ºhrung eines Befehls von einer externen Ebene aus kann komplexer und weniger zuverl√§ssig sein als das √úberpr√ºfen, ob ein Dom√§nenobjekt einen Befehl in seinem aktuellen Status <i>nicht</i> ausf√ºhren <i>kann</i> . </li></ol><br>  Wenn wir solche √úberpr√ºfungen in der Validierungsschicht platzieren, m√ºssen wir dem Benutzer den Grund f√ºr den Fehler mitteilen.  Da es sich um eine Operation handelt, die unter den gegenw√§rtigen Bedingungen √ºberhaupt nicht durchgef√ºhrt werden kann, laufen wir Gefahr, in einer von zwei Situationen zu sein: <br><br><ul><li>  Wir haben einem normalen Benutzer eine Nachricht gegeben, die er √ºberhaupt nicht verstanden hat und die er trotzdem unterst√ºtzen w√ºrde, genau wie bei der Meldung "Ein unerwarteter Fehler ist aufgetreten". </li><li>  Wir haben den B√∂sewicht in einer ziemlich verst√§ndlichen Form informiert, warum er die Operation, die er ausf√ºhren m√∂chte, nicht ausf√ºhren kann und nach anderen Problemumgehungen suchen kann. </li></ul><br>  Aber zur√ºck zum Hauptthema des Artikels.  Bei allen Anzeichen ist die diskutierte Situation au√üergew√∂hnlich.  Es sollte niemals passieren, aber wenn es so ist, wird es schlecht sein. <br><br>  In dieser Situation ist es am logischsten, eine Ausnahme auszul√∂sen, die erforderlichen Details zu verpf√§nden, dem Benutzer einen Fehler der allgemeinen Form ‚ÄûOperation ist nicht m√∂glich‚Äú zur√ºckzugeben, die √úberwachung f√ºr diese Art von Fehlern einzurichten und zu erwarten, dass wir sie niemals sehen werden. <br><br>  Welche Art oder Arten von Ausnahmen sind in diesem Fall zu verwenden?  Logischerweise sollte dies eine separate Art von Ausnahme sein, damit wir sie von anderen unterscheiden k√∂nnen und sie nicht versehentlich von der Ausnahmebehandlung von der √§u√üeren Ebene erfasst wird.  Wir brauchen auch keine Hierarchie oder viele Ausnahmen, das Wesentliche ist dasselbe - etwas Unannehmbares ist passiert.  In unseren Projekten erstellen wir hierf√ºr einen CorruptedInvariantException-Typ und verwenden ihn in geeigneten Situationen. <br><br><h2>  Sonderf√§lle f√ºr Webanwendungen </h2><br>  Ein wesentlicher Unterschied zwischen Webanwendungen anderer (Desktop-, Daemons- und Windows-Dienste usw.) ist die Interaktion mit der Au√üenwelt in Form von kurzfristigen Vorg√§ngen (Verarbeitung von HTTP-Anforderungen), nach denen die Anwendung sofort ‚Äûvergisst‚Äú, was passiert ist. <br><br>  Nach der Verarbeitung der Anforderung wird immer eine Antwort generiert.  Wenn der von unserem Code ausgef√ºhrte Vorgang keine Daten zur√ºckgibt, gibt die Plattform weiterhin eine Antwort mit dem Statuscode zur√ºck.  Wenn der Vorgang durch eine Ausnahme abgebrochen wurde, gibt die Plattform weiterhin eine Antwort mit dem entsprechenden Statuscode zur√ºck. <br><br>  Um dieses Verhalten zu implementieren, wird die Anforderungsverarbeitung auf Webplattformen in Form von Pipes erstellt.  Zuerst wird die Anforderung nacheinander verarbeitet (Anforderung), und dann wird die Antwort vorbereitet. <br><br>  Wir k√∂nnen Middleware, Aktionsfilter, http-Handler oder ISAPI-Filter (je nach Plattform) verwenden und jederzeit in diese Pipeline integrieren.  In jeder Phase der Anforderungsverarbeitung k√∂nnen wir die Verarbeitung unterbrechen, und die Pipeline bildet eine Antwort. <br><br>  In der Regel implementieren wir den Gesch√§ftsteil der Anwendung nicht mehr in der Pipeline-Architektur, sondern schreiben Code, der Operationen nacheinander ausf√ºhrt.  Bei diesem Ansatz ist es etwas schwieriger, das Szenario zu implementieren, wenn wir die Ausf√ºhrung der Anforderung unterbrechen und sofort mit der Erstellung der Antwort fortfahren. <br><br>  Was hat das alles mit Ausnahmebehandlung zu tun? <br><br>  Tatsache ist, dass die in den vorherigen Teilen des Artikels beschriebenen Regeln f√ºr das Arbeiten mit Ausnahmen nicht gut in dieses Szenario passen. <br><br>  Ausnahmen sind schlecht zu verwenden, da es sich um eine Semantik handelt. <br><br>  Die weit verbreitete Verwendung von Result f√ºhrt dazu, dass wir es (Result) √ºber alle Ebenen der Anwendung ziehen. Wenn wir die Antwort erstellen, m√ºssen wir das Ergebnis irgendwie analysieren, um zu verstehen, welcher Statuscode zur√ºckgegeben werden soll.  Es ist auch ratsam, diesen Parsing-Code zu verallgemeinern und in Middleware oder ActionFilter zu √ºbertragen, was zu einem separaten Abenteuer wird.  Das hei√üt, das Ergebnis ist nicht viel besser als Ausnahmen. <br><br>  <i>Was tun in einer solchen Situation?</i> <br><br>  Baue kein Absolutes.  Wir legen die Regeln zu unserem eigenen Vorteil fest und nicht zum Nachteil. <br><br>  Wenn Sie eine Operation abbrechen m√∂chten, weil ihre Fortsetzung nicht m√∂glich ist, f√ºhrt das Ausl√∂sen einer Ausnahme nicht zur Semantik.  Wir leiten die Ausf√ºhrung zum Exit und nicht zu einem anderen Gesch√§ftscodeblock. <br><br>  Wenn der Grund f√ºr die Unterbrechung wichtig ist, um den gew√ºnschten Statuscode zu ermitteln, k√∂nnen benutzerdefinierte Ausnahmetypen verwendet werden. <br><br>  Zuvor haben wir zwei benutzerdefinierte Typen erw√§hnt, die wir verwenden: ItemNotFoundException (Umwandlung in 404) und CorruptedInvariant (Umwandlung in 500). <br><br>  Wenn Sie die Rechte von Benutzern √ºberpr√ºfen, da diese nicht auf das Vorbild oder die Anspr√ºche fallen, ist es zul√§ssig, eine benutzerdefinierte ForbiddenException (Statuscode 403) zu erstellen. <br><br>  Und schlie√ülich die Validierung.  Wir k√∂nnen immer noch nichts tun, bis der Benutzer seine Anfrage √§ndert. Diese Semantik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird durch Code 422 beschrieben</a> .  Also unterbrechen wir den Vorgang und senden die Anfrage direkt an den Exit.  Dies kann auch mit Ausnahme erfolgen.  Beispielsweise verf√ºgt die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FluentValidation-</a> Bibliothek bereits √ºber einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">integrierten Ausnahmetyp</a> , der alle Details an den Client √ºbergibt, die erforderlich sind, um dem Benutzer klar anzuzeigen, was mit der Anforderung nicht stimmt. <br><br>  Das ist alles.  Wie arbeiten Sie mit Ausnahmen? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de431804/">https://habr.com/ru/post/de431804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de431786/index.html">Die Geschichte dessen, was Sie w√§hrend der Entwicklung nicht tun m√ºssen</a></li>
<li><a href="../de431790/index.html">So erstellen Sie eine Website oder Anwendung unter Ber√ºcksichtigung von Benutzern mit besonderen Anforderungen</a></li>
<li><a href="../de431792/index.html">Die Zusammenfassung interessanter Materialien f√ºr den mobilen Entwickler # 277 (26. November - 2. Dezember)</a></li>
<li><a href="../de431796/index.html">Die NASA schlie√üt Vertr√§ge √ºber die Entwicklung des Mondmoduls mit privaten Unternehmen ab</a></li>
<li><a href="../de431802/index.html">Problempersonen unter Projektmanagern</a></li>
<li><a href="../de431806/index.html">Palm Phone getestet: Urteil - Entwickler sind komplett gescheitert</a></li>
<li><a href="../de431810/index.html">F√ºhren Sie den Test mit einem dreiachsigen Beschleunigungsmesser durch</a></li>
<li><a href="../de431814/index.html">Verwenden der optischen Zeichenerkennung in DeviceLock DLP, um Dokumentlecks zu vermeiden</a></li>
<li><a href="../de431816/index.html">3. Dezember SpaceX wird zum dritten Mal versuchen, die erste Stufe der Tr√§gerrakete zu starten</a></li>
<li><a href="../de431818/index.html">Vergleichen Sie PHP FPM, PHP PPM, Nginx Unit, React PHP und RoadRunner</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>