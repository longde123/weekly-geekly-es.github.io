<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌆 🍷 🌦️ Apprentissage en profondeur pour identifier les peintures 🔍 👆🏼 👨🏿‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Aujourd'hui, je veux parler de la façon dont l'apprentissage en profondeur nous aide à mieux comprendre l'art. L'article est divisé en ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprentissage en profondeur pour identifier les peintures</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/421187/"><p>  Bonjour, Habr!  Aujourd'hui, je veux parler de la façon dont l'apprentissage en profondeur nous aide à mieux comprendre l'art.  L'article est divisé en parties conformément aux tâches que nous avons résolues: </p><br><ol><li>  rechercher une image dans la base de données à partir d'une photo prise par un téléphone mobile; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">détermination du style et du genre d'une image qui n'est pas dans la base de données.</a> </li></ol><br><p>  Tout cela devait faire partie du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">service de base de données Arthive</a> et de ses applications mobiles. </p><br><p>  La tâche d'identifier les peintures était de trouver l'image correspondante à partir de l'image provenant de l'application mobile dans la base de données, en y consacrant moins d'une seconde.  Le traitement entièrement dans l'appareil mobile a été exclu au stade de l'étude préalable à la conception.  De plus, il s'est avéré <s>qu'il</s> est <s>impossible</s> d'effectuer de manière garantie sur un appareil mobile la séparation de l'image de l'arrière-plan dans des conditions de prise de vue réelles.  Par conséquent, nous avons décidé que notre service accepterait la photo entière du téléphone mobile comme entrée, avec toutes les distorsions, le bruit et le chevauchement partiel possible. </p><br><img src="https://habrastorage.org/webt/cn/if/2y/cnif2ycyblx3ytn1e66pngunngq.jpeg"><br><p>  Allons-nous aider Dasha à trouver ces peintures dans une base de données de plus de 200 000 images? </p><a name="habracut"></a><br><p>  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">base d'</a> art d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Arthive</a> comprend près de 250 000 images, ainsi que diverses métadonnées.  La base est constamment mise à jour - de dizaines à des centaines d'images par jour.  Même pompées avec une résolution limitée (pas plus de 1400 pixels sur la plupart des côtés), les images occupent plus de 80 gigaoctets.  Malheureusement, la base de données est «sale»: il y a des fichiers cassés ou trop petits, des images non alignées et non traitées, des images en double.  Cependant, dans l'ensemble, ce sont de bonnes données. </p><br><h2>  Comparaison de tableaux </h2><br><p>  Voyons à quoi ressemblent les images de la base de données: <br></p><table><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/sz/1q/rz/sz1qrz48kric62h7miqopl9lj1u.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Mark Rothko</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orange, rouge, jaune</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/2s/2j/fi/2s2jfinlqycohujkfvv9khkcv2q.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ilya Repin</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Religieuse</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/9l/ri/v0/9lriv0ga3emv589y3yrsbkxzwji.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">David Burliuk</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Femmes des tropiques</a> <br></td></tr></tbody></table><br><p>  Fondamentalement, les images de la base de données sont alignées, recadrées aux bordures de la toile, les couleurs sont préservées. </p><br><p>  Et voici à quoi pourraient ressembler les demandes des appareils mobiles: </p><br><p><img src="https://habrastorage.org/webt/1p/iv/ej/1pivejjuiwsrqmhrh1yjonxeu-c.jpeg"></p><br><p>  Les couleurs sont presque toujours déformées - un éclairage complexe est trouvé, des reflets sont présents, même des reflets d'autres peintures dans le verre sont trouvés.  Les images elles-mêmes sont déformées en perspective, peuvent être partiellement recadrées ou, au contraire, occuper moins de la moitié de l'image, peuvent être partiellement fermées, par exemple, par des personnes. </p><br><p>  Afin d'identifier les images, vous devez pouvoir comparer les images des requêtes avec les images de la base de données. </p><br><p>  Pour comparer les images sujettes à la distorsion de perspective et à la distorsion des couleurs, nous utilisons la correspondance des points clés.  Pour ce faire, nous trouvons des points clés avec des descripteurs sur les images, trouvons leur correspondance, puis affichons de manière homographique les points correspondants en utilisant la méthode RANSAC.  Cela se fait généralement de la même manière que celle décrite dans l'exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OpenCV</a> .  Si le nombre de points «antérieurs» trouvés par RANSAC est suffisamment grand et que la transformation homographique trouvée semble plausible (n'a pas de forte échelle ou de rotation), alors nous pouvons supposer que les images souhaitées sont une seule et même image sujette à des distorsions de perspective . </p><br><p>  Un exemple de cartographie des points clés: </p><br><p><img src="https://habrastorage.org/webt/jg/vq/df/jgvqdfnkcmhe9-ohvbubeyajiua.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Exemple de correspondance négative</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q_/8b/yz/q_8byzpsh8rizjhgsol2z1nye4g.jpeg"></div></div><br><div class="spoiler">  <b class="spoiler_title">Comparaison des peintures de l'exemple ci-dessus</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/df/qb/ff/dfqbffq4ibpvjz1qh4_xhjhejvm.jpeg"><br><img src="https://habrastorage.org/webt/l4/b9/5a/l4b95adleete923jqu8leqc_gr4.jpeg"><br><img src="https://habrastorage.org/webt/sw/zc/os/swzcosr49hcjkuqc98lux5cwces.jpeg"><br><img src="https://habrastorage.org/webt/cn/hi/rr/cnhirrksz5srhe81bc3i0mc1exc.jpeg"><br><img src="https://habrastorage.org/webt/4r/y5/uf/4ry5ufekvsefkbba9allszpesro.jpeg"><br><img src="https://habrastorage.org/webt/70/oj/jy/70ojjy-ovr6eouymbnx7h0jel9i.jpeg"></div></div><br><p>  Bien sûr, la recherche de points clés est généralement un processus assez lent, mais pour rechercher dans la base de données, vous pouvez trouver à l'avance les points clés de toutes les images et en enregistrer certaines.  Dans nos expériences, nous sommes arrivés à la conclusion que moins de 1000 points suffisent pour une recherche fiable de peintures.  Lorsque vous utilisez 64 octets par point (coordonnées + descripteur AKAZE) pour stocker 1024 points, 64 Ko par image ou environ 15 Go par base suffisent. </p><br><p>  La comparaison des images par points clés dans notre cas a pris environ 15 ms, c'est-à-dire que pour une énumération complète d'une base de données de 250 000 images, cela prend environ 1 heure.  C’est beaucoup. </p><br><p>  D'un autre côté, si nous apprenons à sélectionner rapidement dans l'ensemble de la base de données plusieurs (disons 100) des candidats les plus probables, nous atteindrons le délai cible de 1 seconde par demande. </p><br><h2>  Classement de similarité </h2><br><p>  Les réseaux de convolution profonds se sont imposés comme un bon moyen de rechercher des images similaires.  Le réseau est utilisé pour extraire des entités et calculer sur leur base un descripteur qui a la propriété que la distance (euclidienne, cosinus ou autre) entre les descripteurs d'images similaires sera moindre que pour des images différentes. </p><br><p>  Vous pouvez entraîner le réseau de telle sorte que pour l'image de l'image de la base et son image déformée de la photo, il produise des descripteurs proches et pour différentes images - plus éloignées.  En outre, un tel réseau est utilisé pour calculer des descripteurs de toutes les images dans la base de données et des descripteurs de photos dans les requêtes.  Vous pouvez sélectionner rapidement les images les plus proches et les organiser en fonction de la distance entre les descripteurs. <br></p><p>  Le moyen de base pour former un réseau à calculer un descripteur est d'utiliser un réseau siamois. </p><br><p><img src="https://habrastorage.org/webt/eh/1l/xi/eh1lxi3gh88kjrqucs6kc2a4lpq.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.261ex" height="2.419ex" viewBox="0 -780.1 1404.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a, b </script>  - images d'entrée <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.298ex" viewBox="0 -728.2 2332.1 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-31" x="1831" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> y = 1 </script>  si <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> a </script>  et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script>  - une classe <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-30" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 0 </script>  si différent <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mi>D</mi><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>a</mi><mi>n</mi><mi>s</mi><msup><mi>R</mi><mi>d</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.729ex" height="2.901ex" viewBox="0 -935.7 8494.3 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="1469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="1859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-66" x="2304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="2854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="3244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="3673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-44" x="4063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="5141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="5665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6E" x="6194" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-73" x="6795" y="0"></use><g transform="translate(7264,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="1074" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi>D</mi><mtext>&nbsp;</mtext><mi>d</mi><mi>a</mi><mi>n</mi><mi>s</mi><msup><mi>R</mi><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6"> f (a), f (b) D \ dans R ^ d </script>  - descripteurs d'images <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.847ex" height="2.66ex" viewBox="0 -832 9406.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="1442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="1887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="2317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-3D" x="2984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="4564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-66" x="4953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="5893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="6423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="6812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-66" x="7257" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="7808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="8197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="8627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="9016" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> d (a, b) = d (f (a), f (b)) </script>  - distance entre une paire de vecteurs de caractéristiques <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.142ex" height="2.66ex" viewBox="0 -832 25033.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-79" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-63" x="3804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6F" x="4761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-74" x="5247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="5608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="6132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="6521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="7051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="7496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="7925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2B" x="8537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="9538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-31" x="9927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2212" x="10650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-79" x="11651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="12148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-63" x="12788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="13221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6F" x="13745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-74" x="14230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6D" x="14592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="15470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-78" x="16000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="16572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-30" x="16962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="17462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6D" x="17907" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="18786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-72" x="19315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-67" x="19767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-65" x="20247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2212" x="20936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="21937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="22460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="22850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="23379" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-62" x="23824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="24254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="24643" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> loss = y \ cdot d (a, b) + (1 - y) \ cdot max (0, marge - d (a, b)) </script>  - fonction objective </p><br><p>  Pour construire une telle architecture, un réseau qui calcule un descripteur (Feature Extractor) est utilisé dans le modèle 2 fois avec des poids communs.  Deux images sont envoyées à l'entrée réseau.  Le réseau Feature Extractor calcule les descripteurs d'image, puis le réseau calcule la distance en fonction de la métrique spécifiée (généralement la distance euclidienne ou cosinus est utilisée).  La fonction cible de l'entraînement en réseau est construite de telle manière que pour les paires positives (images d'une image) la distance diminue et pour les négatifs (images d'images différentes) elle augmente.  Pour réduire l'influence des paires négatives, la distance entre elles est limitée par la valeur de la marge. </p><br><p>  Ainsi, nous pouvons dire que dans le processus d'apprentissage, le réseau cherche à calculer des descripteurs d'images similaires à l'intérieur d'une hypersphère avec un rayon de marge, et des descripteurs de différentes - à pousser hors de cette sphère. </p><br><p>  Par exemple, cela pourrait ressembler à la formation d'un descripteur bidimensionnel à l'aide du réseau siamois sur l'ensemble de données MNIST. </p><br><p><img src="https://habrastorage.org/webt/vs/5y/7n/vs5y7nggt4cvqls3ohka9v8qmqi.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Animation de formation</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/-u/fv/hl-ufvknsfliuuxpfvaqrynkusm.gif"></div></div><br><p>  Pour former le réseau siamois, vous devez saisir des paires d'images et une étiquette égale à 1 si les images appartiennent à la même classe ou à 0 si différentes.  Il y a le problème du choix de la proportion de paires positives et négatives.  Idéalement, bien sûr, il faudrait soumettre au réseau de formation toutes les combinaisons possibles de paires de l'ensemble de formation, mais cela est techniquement impossible.  Et le nombre de paires négatives dans ce cas dépasse considérablement le nombre de paires positives, ce qui n'aura pas non plus un très bon effet sur le processus d'apprentissage. </p><br><p>  Une partie du problème avec le choix de la proportion de paires pour la formation est résolue en utilisant l'architecture triplet. </p><br><p><img src="https://habrastorage.org/webt/u4/a5/yz/u4a5yzgvxnum6zlvbugpj9japvm.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.862ex" height="1.817ex" viewBox="0 -520.7 2523.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-70" x="974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6E" x="1923" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a, p, n </script>  - images d'entrée: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.433ex" height="1.817ex" viewBox="0 -520.7 1478.2 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-70" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> a, p </script>  - une photo, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> n </script>  - un autre <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>e</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.359ex" height="2.66ex" viewBox="-38.5 -832 18237.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-65" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-72" x="970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-74" x="1421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-65" x="1783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-3D" x="2527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6D" x="3583" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="4462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-78" x="4991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="5564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="5953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="6477" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="6866" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="7396" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-70" x="7841" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="8344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2212" x="8956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-64" x="9957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-28" x="10480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="10870" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="11399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6E" x="11844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="12445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2B" x="13057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-6D" x="14057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-61" x="14936" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-72" x="15465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-67" x="15917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMATHI-65" x="16397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-2C" x="16864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-30" x="17309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhhJ7MJtsuq7rvG75Pr3g1cDDPp4fw#MJMAIN-29" x="17809" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>e</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12"> perte = max (d (a, p) - d (a, n) + marge, 0) </script>  - fonction objective </p><br><p>  A l'entrée d'un tel réseau, 3 images sont immédiatement formées, formant une paire positive et négative. </p><p></p><p>  De plus, presque tous les chercheurs conviennent que le choix des paires négatives est essentiel à l'apprentissage en réseau.  La fonction objective pour de nombreux échantillons (paires pour les siamois, triples pour les triplets) se révèle être 0 s'ils ne violent pas la limite de marge, par conséquent, ces échantillons ne participent pas à la formation du réseau.  Au fil du temps, le processus d'apprentissage ralentit encore plus, car il y a de moins en moins d'échantillons avec une valeur non nulle de la fonction objectif.  Pour résoudre ce problème, les paires négatives sont choisies non pas par hasard, mais en recherchant l'extraction de cas difficiles.  En pratique, plusieurs candidats négatifs sont sélectionnés pour cela, pour chacun desquels un descripteur est calculé en utilisant la dernière version des pondérations du réseau (d'une époque précédente ou même de l'ère actuelle).  Ayant un descripteur, vous pouvez sélectionner un négatif dans chacun des trois, ce qui produit une perte non nulle connue. </p><br><p>  Pour rechercher des images similaires, Feature Extractor est séparé du réseau et utilisé pour calculer les descripteurs.  Pour les images de la base de données, les descripteurs sont calculés à l'avance lorsqu'ils sont ajoutés.  Ainsi, la tâche de trouver des images similaires consiste à calculer le descripteur d'image dans la requête et à rechercher les descripteurs les plus proches de la métrique donnée dans la base de données. </p><br><p>  Notre extracteur de fonctionnalités réseau est basé sur l'architecture Inception v3.  L'une des couches intermédiaires a été sélectionnée expérimentalement, sur la base de la sortie dont un descripteur de 512 nombres réels est calculé. </p><br><p><img src="https://habrastorage.org/webt/0q/w2/mz/0qw2mzgdztu_zyr9fxxsijznzrw.png"></p><br><h2>  Augmentation des données </h2><br><p>  Ce serait bien si nous pouvions mettre chaque photo dans différents cadres, sur différents murs et prendre des photos à chaque fois sous un angle différent sur différents téléphones.  En pratique, cela est bien sûr impossible.  Par conséquent, il est nécessaire de générer des données d'entraînement. </p><br><p>  Pour générer des données, environ 500 photographies de diverses peintures avec différents arrière-plans dans différentes conditions d'éclairage ont été collectées.  Pour chaque photo, 4 points ont été sélectionnés correspondant aux coins de la toile de l'image.  Pour quatre points, nous pouvons arbitrairement adapter n'importe quelle image dans le cadre, remplaçant ainsi l'image et obtenant une distorsion en perspective presque aléatoire de l'image à partir de la base de données.  En complétant ce processus par une recadrage aléatoire, du bruit et une distorsion des couleurs, nous avons la possibilité de générer des images parfaitement adaptées qui imitent des photographies de peintures. </p><br><p><img src="https://habrastorage.org/webt/fi/ad/wg/fiadwgwcbv0bqqgbfiphnthicm8.jpeg" alt="Artification"></p><br><h2>  Séparation d'une image d'un arrière-plan </h2><br><p>  La qualité du travail et les modèles d'identification des peintures et les modèles de classification des genres / styles dépendent largement de la manière dont l'image est séparée de l'arrière-plan.  Idéalement, avant d'insérer une image dans un modèle, vous devez trouver les 4 coins de sa toile et afficher la perspective dans un carré.  En pratique, il s'est avéré très difficile de mettre en œuvre un algorithme qui garantirait cela.  D'une part, il existe une grande variété d'arrière-plans, de cadres et d'objets qui peuvent tomber dans le cadre près de l'image.  D'un autre côté, il y a des peintures à l'intérieur desquelles se dessinent des contours assez visibles de formes rectangulaires (fenêtres, façades de bâtiments, image dans l'image).  Par conséquent, il est souvent très difficile de dire où l'image se termine et où commence son environnement. </p><br><p>  Au final, nous avons opté pour une implémentation simple basée sur des méthodes classiques de vision par ordinateur (détection des frontières + filtrage morphologique + analyse des composants connectés), qui vous permet de couper en toute confiance les arrière-plans monophoniques, sans perdre une partie de l'image. </p><br><h2>  Vitesse de travail </h2><br><p>  L'algorithme de traitement des requêtes comprend les étapes principales suivantes: </p><br><ol><li>  préparation - en fait, un simple détecteur de l'image est mis en œuvre, ce qui fonctionne bien si l'image contient un fond uni; </li><li>  calculer un descripteur d'image à l'aide d'un réseau profond; </li><li>  classement des images par distance aux descripteurs dans la base de données; </li><li>  rechercher des points clés dans l'image; </li><li>  vérifier les candidats dans l'ordre de classement. </li></ol><br><p>  Nous avons testé la vitesse du réseau sur 200 requêtes, le temps de traitement suivant a été obtenu pour chacune des étapes (temps en secondes): <br></p><table><thead><tr><th>  étape </th><th>  min </th><th>  max </th><th>  moyenne </th></tr></thead><tbody><tr><td>  Préparation (recherche d'images) </td><td>  0,008 </td><td>  0,011 </td><td>  0,016 </td></tr><tr><td>  Calcul de descripteur (GPU) </td><td>  0,082 </td><td>  0,092 </td><td>  0,088 </td></tr><tr><td>  KNN (k &lt;500, CPU, force brute) </td><td>  0,199 </td><td>  <strong>0,820</strong> </td><td>  0,394 </td></tr><tr><td>  Recherche de points clés </td><td>  0,031 </td><td>  0,432 </td><td>  0,156 </td></tr><tr><td>  Vérifier les points clés </td><td>  0,007 </td><td>  <strong>9.844</strong> </td><td>  2,585 </td></tr><tr><td>  <strong>Temps total de demande</strong> </td><td>  0,358 </td><td>  10,386 </td><td>  3.239 </td></tr></tbody></table><br><p>  La vérification des candidats s'arrêtant immédiatement, la photo étant trouvée avec suffisamment de confiance, on peut supposer que le temps de traitement minimum des demandes correspond aux photos trouvées parmi les premiers candidats.  Le temps de demande maximum est obtenu pour les tableaux qui n'ont pas été trouvés du tout - le contrôle s'arrête après 500 candidats. </p><br><p>  On constate que la plupart du temps est consacré à la sélection des candidats et à leur vérification.  Il convient de noter que la mise en œuvre de ces étapes a été rendue très non optimale et présente un grand potentiel d'accélération. </p><br><h2>  Recherche en double </h2><br><p>  Après avoir construit l'index complet de la base des peintures, nous l'avons utilisé pour rechercher des doublons dans la base de données.  Après environ 3 heures de visualisation de la base de données, il a été constaté qu'au moins 13657 images sont répétées deux fois (et environ trois) dans la base de données. </p><br><p>  De plus, des cas très intéressants ont été trouvés qui ne sont pas des doublons. </p><br><img src="https://habrastorage.org/webt/hj/nh/kr/hjnhkregrx0th9cdshhzvf79b9y.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deux</a> .  Il semble que ce soient deux étapes du même travail. <br><br><img src="https://habrastorage.org/webt/eo/0o/qd/eo0oqdq2yip70qungxv6gttad3k.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deux</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">trois</a> .  Ne faites pas attention au nom - les trois images sont différentes. <br><br>  Ainsi qu'un exemple d'une identification faussement positive par des points clés. <br><br><img src="https://habrastorage.org/webt/5t/gr/cr/5tgrcrmewazx_lqxd_po9cqd5v4.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deux</a> . <br><br><div class="spoiler">  <b class="spoiler_title">cartographie des points clés</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y1/ug/7i/y1ug7idfof7szcvsbmsbr64h7fy.jpeg"></div></div><br><h2>  Au lieu d'une conclusion </h2><br><p>  En général, nous sommes satisfaits du résultat du service. </p><br><p>  Sur les ensembles de test, une précision d'identification de plus de 80% est atteinte.  En pratique, il s'avère souvent que si l'image n'est pas retrouvée la première fois, alors il suffit de la photographier sous un angle différent, et elle est localisée.  Des erreurs lorsqu'une image incorrecte est trouvée ne se produisent presque jamais. </p><br><p>  Dans l'ensemble, la solution a été emballée dans un conteneur docker et remise au client.  Désormais, l'identification des peintures par des photos est disponible dans les applications utilisant le service Arthive, par exemple le Musée Pouchkine, disponible sur le Play Market (cependant, il détache la peinture de l'arrière-plan, exigeant que l'arrière-plan soit clair, ce qui rend parfois la photographie difficile). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421187/">https://habr.com/ru/post/fr421187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421173/index.html">Vue de recherche Google personnalisée</a></li>
<li><a href="../fr421175/index.html">Surveillance du cluster Kubernetes avec Prometheus</a></li>
<li><a href="../fr421177/index.html">Comment attirer un spécialiste de l'analyse de données lorsque votre entreprise n'a même pas de site Web</a></li>
<li><a href="../fr421179/index.html">HashMap interne en Java</a></li>
<li><a href="../fr421183/index.html">IBM brevète des drones qui distinguent les émotions et apportent du café aux gens. Et quoi d'autre à écrire vendredi?</a></li>
<li><a href="../fr421189/index.html">Migration d'une base de données vers une ancienne version de MS SQL Server</a></li>
<li><a href="../fr421191/index.html">Comme il est facile pour un artisan de rêver avec un noyau 3D</a></li>
<li><a href="../fr421193/index.html">Audi PB18 e-tron</a></li>
<li><a href="../fr421195/index.html">Intelligence artificielle</a></li>
<li><a href="../fr421197/index.html">En Russie, un neuro-casque est en cours de développement pour les personnes souffrant de troubles de la parole et du moteur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>