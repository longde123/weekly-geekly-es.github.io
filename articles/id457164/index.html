<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçº ü§¢ ‚úåüèø Navigasi dalam aplikasi .NET Core lintas platform dengan kondisi penyimpanan ke disk menggunakan contoh ReactiveUI dan Avalonia üë®üèø‚Äç‚öñÔ∏è üé´ üî§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antarmuka pengguna aplikasi modern biasanya kompleks - seringkali perlu untuk mengimplementasikan dukungan navigasi halaman, memproses berbagai bidang...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Navigasi dalam aplikasi .NET Core lintas platform dengan kondisi penyimpanan ke disk menggunakan contoh ReactiveUI dan Avalonia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457164/"><p><img src="https://habrastorage.org/webt/tu/lv/gl/tulvgli1xkcq1jqef9m91o_caxe.png"><br></p><br><p> Antarmuka pengguna aplikasi modern biasanya kompleks - seringkali perlu untuk mengimplementasikan dukungan navigasi halaman, memproses berbagai bidang input, dan menampilkan atau menyembunyikan informasi berdasarkan parameter yang dipilih oleh pengguna.  Pada saat yang sama, untuk meningkatkan UX, aplikasi harus menyimpan keadaan elemen antarmuka ke disk selama suspensi atau shutdown, memulihkan keadaan dari disk ketika program dimulai kembali. </p><br><p> Kerangka kerja MVVM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">ReactiveUI</a> mengusulkan untuk mempertahankan keadaan aplikasi dengan membuat serial model grafik presentasi pada saat penangguhan program, sementara mekanisme untuk menentukan saat penangguhan berbeda untuk kerangka dan platform.  Jadi, untuk WPF, acara <code>Exit</code> digunakan, untuk Xamarin. Android - <code>ActivityPaused</code> , untuk Xamarin.iOS - <code>DidEnterBackground</code> , untuk UWP - <code>OnLaunched</code> overload. </p><br><p>  Pada artikel ini, kami akan mempertimbangkan penggunaan ReactiveUI untuk menyimpan dan mengembalikan keadaan perangkat lunak dengan GUI, termasuk keadaan router, menggunakan kerangka kerja GUI lintas-platform <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Avalonia</a> sebagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">contoh</a> .  Materi mengasumsikan pemahaman dasar dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pola desain MVVM</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">pemrograman reaktif</a> dalam konteks bahasa C # dan platform .NET untuk pembaca.  Langkah-langkah dalam artikel ini berlaku untuk Windows 10 dan Ubuntu 18. </p><a name="habracut"></a><br><h2 id="sozdanie-proekta">  Pembuatan proyek </h2><br><p>  Untuk mencoba perutean dalam tindakan, buat proyek .NET Core baru dari template Avalonia, instal paket <code>Avalonia.ReactiveUI</code> - lapisan tipis integrasi Avalonia dan ReactiveUI.  Pastikan Anda telah menginstal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">.NET Core SDK</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">git</a> sebelum memulai. </p><br><pre> <code class="plaintext hljs">git clone https://github.com/AvaloniaUI/avalonia-dotnet-templates git --git-dir ./avalonia-dotnet-templates/.git checkout 9263c6b dotnet new --install ./avalonia-dotnet-templates dotnet new avalonia.app -o ReactiveUI.Samples.Suspension cd ./ReactiveUI.Samples.Suspension dotnet add package Avalonia.ReactiveUI dotnet add package Avalonia.Desktop dotnet add package Avalonia</code> </pre> <br><p>  Pastikan aplikasi dimulai dan menampilkan jendela bertuliskan Selamat Datang di Avalonia! </p><br><pre> <code class="plaintext hljs"># Use .NET Core version which you have installed. # It can be netcoreapp2.0, netcoreapp2.1 and so on. dotnet run --framework netcoreapp3.0</code> </pre> <br><p><img src="https://habrastorage.org/webt/bn/84/7b/bn847bgygv5j5awbdb_0pvipoyq.png" width="400"><br></p><br><h2 id="podklyuchenie-predvaritelnyh-sborok-avalonia-iz-myget">  Hubungkan pra-build Avalonia dari MyGet </h2><br><p>  Untuk menghubungkan dan menggunakan build Avalonia terbaru yang secara otomatis dipublikasikan ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">MyGet</a> ketika <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">cabang</a> <code>master</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">repositori Avalonia di GitHub</a> berubah, kami menggunakan file konfigurasi sumber paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><code>nuget.config</code></a> .  Agar IDE dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">.NET Core CLI dapat</a> melihat <code>nuget.config</code> , Anda perlu membuat file <code>sln</code> untuk proyek yang dibuat di atas.  Kami menggunakan alat dari .NET Core CLI: </p><br><pre> <code class="plaintext hljs">dotnet new sln # Ctrl+C dotnet sln ReactiveUI.Samples.Suspension.sln add ReactiveUI.Samples.Suspension.csproj</code> </pre> <br><p>  Buat file <code>nuget.config</code> dalam folder dengan file <code>nuget.config</code> dari konten berikut: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packageSources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AvaloniaCI"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://www.myget.org/F/avalonia-ci/api/v2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packageSources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Anda mungkin perlu me-restart IDE, atau membongkar dan mengunduh seluruh solusi.  Kami akan memperbarui paket Avalonia ke versi yang diperlukan (setidaknya 0,9.1) menggunakan antarmuka manajer paket NuGet dari IDE Anda, atau menggunakan alat baris perintah Windows atau terminal Linux: </p><br><pre> <code class="plaintext hljs">dotnet add package Avalonia.ReactiveUI --version 0.9.1 dotnet add package Avalonia.Desktop --version 0.9.1 dotnet add package Avalonia --version 0.9.1 cat ReactiveUI.Samples.Suspension.csproj</code> </pre> <br><p>  Sekarang file proyek <code>ReactiveUI.Samples.Suspension.csproj</code> terlihat seperti ini: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Sdk</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.NET.Sdk"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputType</span></span></span><span class="hljs-tag">&gt;</span></span>WinExe<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OutputType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFramework</span></span></span><span class="hljs-tag">&gt;</span></span>netcoreapp3.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TargetFramework</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PropertyGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Compile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Update</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"**\*.xaml.cs"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DependentUpon</span></span></span><span class="hljs-tag">&gt;</span></span>%(Filename)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DependentUpon</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Compile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AvaloniaResource</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"**\*.xaml"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SubType</span></span></span><span class="hljs-tag">&gt;</span></span>Designer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SubType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AvaloniaResource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Avalonia"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.9.1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Avalonia.Desktop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.9.1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PackageReference</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Avalonia.ReactiveUI"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.9.1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Buat <code>Views/</code> dan <code>ViewModels/</code> folder di root proyek, ubah nama kelas <code>MainWindow</code> ke <code>MainView</code> untuk kenyamanan, pindahkan ke direktori <code>Views/</code> , ubah ruang nama sesuai dengan <code>ReactiveUI.Samples.Suspension.Views</code> .  <code>App.xaml.cs</code> konten file <code>Program.cs</code> dan <code>App.xaml.cs</code> - terapkan panggilan <code>UseReactiveUI</code> ke pembuat aplikasi Avalonia, pindahkan inisialisasi tampilan utama ke <code>OnFrameworkInitializationCompleted</code> untuk mematuhi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">rekomendasi</a> manajemen siklus hidup aplikasi: </p><br><p>  <strong>Program.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Program</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  .   API  Avalonia  , //  SynchronizationContext,    // OnFrameworkInitializationCompleted  App.xaml.cs:  //     -    . public static void Main(string[] args) =&gt; BuildAvaloniaApp() .StartWithClassicDesktopLifetime(args); //   Avalonia.    // ,      . public static AppBuilder BuildAvaloniaApp() =&gt; AppBuilder.Configure&lt;App&gt;() .UseReactiveUI() // ! .UsePlatformDetect() .LogToDebug(); }</span></span></code> </pre> <br><p>  <strong>App.xaml.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> : <span class="hljs-title"><span class="hljs-title">Application</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; AvaloniaXamlLoader.Load(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    .     //  MVVM , DI    .    //     ApplicationLifetime,    //     . public override void OnFrameworkInitializationCompleted() { new Views.MainView().Show(); base.OnFrameworkInitializationCompleted(); } }</span></span></code> </pre> <br><p>  Anda perlu menambahkan <code>using Avalonia.ReactiveUI</code> ke <code>Program.cs</code> .  Pastikan bahwa setelah memperbarui paket, proyek dimulai dan menampilkan jendela selamat datang standar. </p><br><pre> <code class="plaintext hljs"># Use .NET Core version which you have installed. # It can be netcoreapp2.0, netcoreapp2.1 and so on. dotnet run --framework netcoreapp3.0</code> </pre> <br><p><img src="https://habrastorage.org/webt/bn/84/7b/bn847bgygv5j5awbdb_0pvipoyq.png" width="400"><br></p><br><h2 id="krossplatformennyy-routing-reactiveui">  Perutean lintas-platform ReactiveUI </h2><br><p>  Sebagai aturan, ada dua pendekatan utama untuk menerapkan navigasi antara halaman aplikasi .NET - view-first dan view model-first.  Pendekatan Lihat pertama melibatkan pengontrolan tumpukan navigasi dan navigasi antara halaman pada tingkat Lihat dalam terminologi MVVM - misalnya, menggunakan kelas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Frame</a> dan <a href="" rel="nofollow">Halaman</a> dalam kasus UWP atau WPF, dan ketika menggunakan pendekatan tampilan model-pertama, navigasi dilaksanakan pada tingkat model presentasi.  Alat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">reaktifUI</a> yang mengatur perutean dalam aplikasi difokuskan pada penggunaan pendekatan tampilan model-pertama.  Routing ReactiveUI terdiri dari implementasi <code>IScreen</code> yang berisi keadaan router, beberapa implementasi <code>IRoutableViewModel</code> dan kontrol XAML <code>RoutedViewHost</code> platform, <code>RoutedViewHost</code> . </p><br><p><img width="600" src="https://habrastorage.org/webt/4s/7a/6_/4s7a6_gsiixrbgx3h5kf7leezcw.png"><br></p><br><p>  Keadaan router diwakili oleh objek <code>RoutingState</code> , yang mengontrol tumpukan navigasi.  <code>IScreen</code> adalah akar dari tumpukan navigasi, dan mungkin ada beberapa akar navigasi dalam aplikasi.  <code>RoutedViewHost</code> memonitor status router <code>RoutingState</code> sesuai, merespons perubahan dalam tumpukan navigasi dengan menyematkan <code>IRoutableViewModel</code> dari kontrol XAML yang sesuai.  Fungsi yang dijelaskan akan diilustrasikan dengan contoh di bawah ini. </p><br><h2 id="sohranenie-sostoyaniya-modeley-predstavleniya-na-disk">  Menyimpan keadaan model tampilan ke disk </h2><br><p>  Pertimbangkan contoh khas layar pencarian informasi. </p><br><p><img width="400" src="https://habrastorage.org/webt/ki/tk/o4/kitko4krrwapat8y9_bm0kcobky.png"><br></p><br><p>  Kita harus memutuskan elemen model representasi layar mana yang akan disimpan ke disk selama jeda atau shutdown aplikasi, dan elemen mana yang akan dibuat ulang setiap kali dimulai.  Tidak perlu menyimpan status <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">perintah ReactiveUI</a> yang mengimplementasikan antarmuka <code>ICommand</code> dan dilampirkan ke tombol - <code>ReactiveCommand&lt;TIn, TOut&gt;</code> dibuat dan diinisialisasi dalam konstruktor, sedangkan status indikator <code>CanExecute</code> tergantung pada properti model tampilan dan dihitung ulang ketika mereka berubah.  Kebutuhan untuk menyimpan hasil pencarian - titik diperdebatkan - tergantung pada spesifikasi aplikasi, tetapi akan lebih bijaksana untuk menyimpan dan mengembalikan keadaan bidang input <code>SearchQuery</code> ! </p><br><p>  <strong>ViewModels / SearchViewModel.cs</strong> </p><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DataContract</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SearchViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span>, <span class="hljs-title"><span class="hljs-title">IRoutableViewModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReactiveCommand&lt;Unit, Unit&gt; _search; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _searchQuery; <span class="hljs-comment"><span class="hljs-comment">//   IScreen  ,   NULL //  IScreen  Splat.Locator.    //      . public SearchViewModel(IScreen screen = null) { HostScreen = screen ?? Locator.Current.GetService&lt;IScreen&gt;(); //     SearchQuery , //     . var canSearch = this .WhenAnyValue(x =&gt; x.SearchQuery) .Select(query =&gt; !string.IsNullOrWhiteSpace(query)); //      ,  //     . _search = ReactiveCommand.CreateFromTask( () =&gt; Task.Delay(1000), //    canSearch); } public IScreen HostScreen { get; } public string UrlPathSegment =&gt; "/search"; public ICommand Search =&gt; _search; [DataMember] public string SearchQuery { get =&gt; _searchQuery; set =&gt; this.RaiseAndSetIfChanged(ref _searchQuery, value); } }</span></span></code> </pre> <br><p>  Kelas model tampilan ditandai dengan atribut <code>[DataContract]</code> , dan properti yang perlu diserialisasi dengan <code>[DataMember]</code> .  Ini cukup jika serializer yang digunakan menggunakan pendekatan opt-in - ini hanya menyimpan properti yang secara eksplisit ditandai dengan atribut ke disk, dalam kasus pendekatan opt-out, perlu menandai dengan <code>[IgnoreDataMember]</code> atribut properti-properti yang tidak perlu disimpan ke disk.  Selain itu, kami menerapkan antarmuka <code>IRoutableViewModel</code> dalam model tampilan kami sehingga nantinya dapat menjadi bagian dari bingkai navigasi router aplikasi. </p><br><div class="spoiler">  <b class="spoiler_title">Demikian pula, kami menerapkan model presentasi halaman otorisasi</b> <div class="spoiler_text"><p>  <strong>ViewModels / LoginViewModel.cs</strong> </p><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DataContract</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LoginViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span>, <span class="hljs-title"><span class="hljs-title">IRoutableViewModel</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReactiveCommand&lt;Unit, Unit&gt; _login; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _password; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _username; <span class="hljs-comment"><span class="hljs-comment">//   IScreen  ,   NULL //  IScreen  Splat.Locator.    //      . public LoginViewModel(IScreen screen = null) { HostScreen = screen ?? Locator.Current.GetService&lt;IScreen&gt;(); //     Username  Password // ,     . var canLogin = this .WhenAnyValue( x =&gt; x.Username, x =&gt; x.Password, (user, pass) =&gt; !string.IsNullOrWhiteSpace(user) &amp;&amp; !string.IsNullOrWhiteSpace(pass)); //      ,  //    . _login = ReactiveCommand.CreateFromTask( () =&gt; Task.Delay(1000), //    canLogin); } public IScreen HostScreen { get; } public string UrlPathSegment =&gt; "/login"; public ICommand Login =&gt; _login; [DataMember] public string Username { get =&gt; _username; set =&gt; this.RaiseAndSetIfChanged(ref _username, value); } //        ! public string Password { get =&gt; _password; set =&gt; this.RaiseAndSetIfChanged(ref _password, value); } }</span></span></code> </pre> </div></div><br><p>  Model presentasi untuk dua halaman aplikasi siap, mengimplementasikan antarmuka <code>IRoutableViewModel</code> dan dapat dibangun ke dalam router <code>IScreen</code> .  Sekarang kami langsung mengimplementasikan <code>IScreen</code> .  Kami menandai dengan bantuan atribut <code>[DataContract]</code> properti mana dari model tampilan untuk diserialisasi dan yang diabaikan.  Perhatikan setter publik dari properti yang ditandai dengan <code>[DataMember]</code> , dalam contoh di bawah ini - properti ini sengaja dibuka untuk ditulis sehingga serializer dapat memodifikasi contoh objek yang baru dibuat selama deserialisasi model. </p><br><p>  <strong>ViewModels / MainViewModel.cs</strong> </p><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DataContract</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span>, <span class="hljs-title"><span class="hljs-title">IScreen</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReactiveCommand&lt;Unit, Unit&gt; _search; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReactiveCommand&lt;Unit, Unit&gt; _login; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RoutingState _router = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RoutingState(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainViewModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//       , //  ,   . var canLogin = this .WhenAnyObservable(x =&gt; x.Router.CurrentViewModel) .Select(current =&gt; !(current is LoginViewModel)); _login = ReactiveCommand.Create( () =&gt; { Router.Navigate.Execute(new LoginViewModel()); }, canLogin); //       , //  ,   . var canSearch = this .WhenAnyObservable(x =&gt; x.Router.CurrentViewModel) .Select(current =&gt; !(current is SearchViewModel)); _search = ReactiveCommand.Create( () =&gt; { Router.Navigate.Execute(new SearchViewModel()); }, canSearch); } [DataMember] public RoutingState Router { get =&gt; _router; set =&gt; this.RaiseAndSetIfChanged(ref _router, value); } public ICommand Search =&gt; _search; public ICommand Login =&gt; _login; }</span></span></code> </pre> <br><p>  Dalam aplikasi kami, hanya <code>RoutingState</code> perlu disimpan ke disk, karena alasan yang jelas, perintah tidak perlu disimpan ke disk - statusnya sepenuhnya tergantung pada router.  Objek berseri harus menyertakan informasi tambahan tentang jenis yang menerapkan <code>IRoutableViewModel</code> sehingga tumpukan navigasi dapat dipulihkan setelah deserialisasi.  Kami menjelaskan logika <code>MainViewModel</code> tampilan <code>MainViewModel</code> , tempatkan kelas dalam <code>ViewModels/MainViewModel.cs</code> dan dalam ruang nama <code>ReactiveUI.Samples.Suspension.ViewModels</code> sesuai. </p><br><p><img width="250" src="https://habrastorage.org/webt/d7/l0/zm/d7l0zmx2opzysobg-rkqvhexpxk.png"><br></p><br><h2 id="routing-v-prilozhenii-avalonia">  Routing di aplikasi Avalonia </h2><br><p>  Logika antarmuka pengguna di tingkat lapisan model dan model presentasi dari aplikasi demo diimplementasikan dan dapat dipindahkan ke perakitan terpisah yang ditujukan untuk .NET Standard, karena tidak tahu apa-apa tentang kerangka kerja GUI yang digunakan.  Mari kita lihat pada layer presentasi.  Dalam terminologi MVVM, lapisan presentasi bertanggung jawab untuk menampilkan keadaan model presentasi di layar Untuk membuat keadaan router <code>RoutingState</code> , kontrol XAML <code>RoutedViewHost</code> terkandung dalam paket <code>Avalonia.ReactiveUI</code> .  Kami menerapkan GUI untuk <code>SearchViewModel</code> - untuk ini, di direktori <code>Views/</code> , buat dua file: <code>SearchView.xaml</code> dan <code>SearchView.xaml.cs</code> . </p><br><p>  Deskripsi antarmuka pengguna menggunakan dialek XAML yang digunakan di Avalonia mungkin terdengar asing bagi para pengembang di Windows Presentation Foundation, Universal Windows Platform, atau Xamarin.Forms.  Dalam contoh di atas, kami membuat antarmuka yang sepele untuk formulir pencarian - kami menggambar bidang teks untuk memasukkan permintaan pencarian dan tombol yang memulai pencarian, sementara kami mengikat kontrol ke properti dari model <code>SearchViewModel</code> yang ditentukan di atas. </p><br><p>  <strong>Tampilan / SearchView.xaml</strong> </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserControl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/avaloniaui"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:mc</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:DataContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{d:DesignInstance viewModels:SearchViewModel}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:viewModels</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clr-namespace:ReactiveUI.Samples.Suspension.ViewModels"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReactiveUI.Samples.Suspension.Views.SearchView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:reactiveUi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://reactiveui.net"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mc:Ignorable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search view"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding SearchQuery, Mode=TwoWay}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Search}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserControl</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <strong>Tampilan / SearchView.xaml.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SearchView</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveUserControl</span></span>&lt;<span class="hljs-title"><span class="hljs-title">SearchViewModel</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SearchView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  WhenActivated     //        . this.WhenActivated((CompositeDisposable disposable) =&gt; { }); AvaloniaXamlLoader.Load(this); } }</span></span></code> </pre> <br><p>  Kode-belakang kontrol <code>SearchView.xaml</code> juga akan muncul untuk <code>SearchView.xaml</code> WPF, UWP, dan XF yang akrab.  Panggilan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">WhenActivated</a> digunakan untuk mengeksekusi beberapa kode ketika tampilan atau model tampilan diaktifkan dan dinonaktifkan.  Jika aplikasi Anda menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">hot observable</a> (timer, geolocation, koneksi ke bus pesan), akan lebih baik untuk melampirkannya ke <code>CompositeDisposable</code> memanggil <code>DisposeWith</code> sehingga ketika Anda <code>DisposeWith</code> kontrol XAML dan model tampilan yang sesuai dari pohon visual, <em>observasi panas</em> berhenti menerbitkan nilai-nilai baru dan tidak ada kebocoran memori. </p><br><div class="spoiler">  <b class="spoiler_title">Demikian pula, kami menerapkan representasi halaman otorisasi.</b> <div class="spoiler_text"><p>  <strong>Tampilan / LoginView.xaml</strong> </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserControl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/avaloniaui"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:mc</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:DataContext</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{d:DesignInstance viewModels:LoginViewModel, IsDesignTimeCreatable=True}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:viewModels</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"clr-namespace:ReactiveUI.Samples.Suspension.ViewModels"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReactiveUI.Samples.Suspension.Views.LoginView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:reactiveUi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://reactiveui.net"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mc:Ignorable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Login view"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Username, Mode=TwoWay}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBox</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PasswordChar</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Password, Mode=TwoWay}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Login"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Login}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">UserControl</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <strong>Tampilan / LoginView.xaml.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LoginView</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveUserControl</span></span>&lt;<span class="hljs-title"><span class="hljs-title">LoginViewModel</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoginView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.WhenActivated(disposables =&gt; { }); AvaloniaXamlLoader.Load(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> </div></div><br><p>  Edit file <code>Views/MainView.xaml</code> dan <code>Views/MainView.xaml.cs</code> .  <code>RoutedViewHost</code> XAML <code>RoutedViewHost</code> dari ruang nama <code>RoutedViewHost</code> di layar utama, tetapkan status router <code>RoutingState</code> ke properti <code>RoutingState</code> .  Tambahkan tombol untuk menavigasi ke halaman pencarian dan otorisasi, ikat mereka ke properti <code>ViewModels/MainViewModel</code> yang dijelaskan di atas. </p><br><p>  <strong>Tampilan / MainView.xaml</strong> </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/avaloniaui"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/winfx/2006/xaml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:d</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/expression/blend/2008"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:mc</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/markup-compatibility/2006"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mc:Ignorable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:DesignWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"800"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:DesignHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"450"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReactiveUI.Samples.Suspension.Views.MainView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:reactiveUi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://reactiveui.net"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ReactiveUI.Samples.Suspension"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RowDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"48"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.RowDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,   RoutingState,   View  ViewModel --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reactiveUi:RoutedViewHost</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Router</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Router}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reactiveUi:RoutedViewHost.DefaultContent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextBlock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Default Content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reactiveUi:RoutedViewHost.DefaultContent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">reactiveUi:RoutedViewHost</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Row</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.ColumnDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ColumnDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ColumnDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ColumnDefinition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid.ColumnDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Column</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Search}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Column</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Login}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Login"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Grid.Column</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Command</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{Binding Router.NavigateBack}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Back"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Grid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Window</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <strong>Tampilan / MainView.xaml.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainView</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveWindow</span></span>&lt;<span class="hljs-title"><span class="hljs-title">MainViewModel</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MainView</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.WhenActivated(disposables =&gt; { }); AvaloniaXamlLoader.Load(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br><p>  Sebuah aplikasi sederhana yang menunjukkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">kemampuan</a> perutean <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">ReactiveUI</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Avalonia</a> sudah siap.  Ketika Anda mengklik tombol <code>Search</code> dan <code>Login</code> , perintah yang sesuai dipanggil, contoh baru model tampilan dibuat dan <code>RoutingState</code> diperbarui.  Kontrol XAML, <code>RoutedViewHost</code> , yang berlangganan perubahan pada <code>RoutingState</code> , mencoba untuk mendapatkan tipe <code>IViewFor&lt;TViewModel&gt;</code> , di mana <code>TViewModel</code> adalah tipe model tampilan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><code>Locator.Current</code></a> .  Jika implementasi terdaftar dari <code>IViewFor&lt;TViewModel&gt;</code> ditemukan, instance baru akan dibuat, dibuat di dalam <code>RoutedViewHost</code> dan ditampilkan di jendela aplikasi Avalonia. </p><br><p><img width="550" src="https://habrastorage.org/webt/ys/o4/dg/yso4dgybdbqulwbb7dumlbktp5w.png"><br></p><br><p>  Kami mendaftarkan komponen yang diperlukan <code>IViewFor&lt;TViewModel&gt;</code> dan <code>IScreen</code> di <code>App.OnFrameworkInitializationCompleted</code> metode aplikasi kami menggunakan <code>Locator.CurrentMutable</code> .  <code>IViewFor&lt;TViewModel&gt;</code> diperlukan agar <code>RoutedViewHost</code> berfungsi <code>RoutedViewHost</code> , dan pendaftaran <code>IScreen</code> diperlukan agar saat deserialisasi, <code>LoginViewModel</code> dan <code>LoginViewModel</code> dapat diinisialisasi dengan benar menggunakan konstruktor tanpa parameter dan <code>Locator.Current</code> . </p><br><p>  <strong>App.xaml.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnFrameworkInitializationCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   . Locator.CurrentMutable.RegisterConstant&lt;IScreen&gt;(new MainViewModel()); Locator.CurrentMutable.Register&lt;IViewFor&lt;SearchViewModel&gt;&gt;(() =&gt; new SearchView()); Locator.CurrentMutable.Register&lt;IViewFor&lt;LoginViewModel&gt;&gt;(() =&gt; new LoginView()); //        . new MainView { DataContext = Locator.Current.GetService&lt;IScreen&gt;() }.Show(); base.OnFrameworkInitializationCompleted(); }</span></span></code> </pre> <br><p>  Jalankan aplikasi dan pastikan perutean bekerja dengan benar.  Jika ada kesalahan dalam markup XAML, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">kompiler XamlIl yang digunakan di Avalonia</a> akan memberi tahu kita dengan tepat di mana, pada tahap kompilasi.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">XamlIl juga mendukung debugging XAML langsung di debugger IDE</a> ! </p><br><pre> <code class="plaintext hljs">dotnet run --framework netcoreapp3.0</code> </pre> <br><p><img src="https://habrastorage.org/webt/c2/pp/88/c2pp88h397pwscpwn-i8vnke6sw.gif" width="400"><br></p><br><h2 id="sohranenie-i-vosstanovlenie-sostoyaniya-prilozheniya-celikom">  Menyimpan dan memulihkan seluruh status aplikasi </h2><br><p>  Sekarang setelah perutean dikonfigurasikan dan berfungsi, bagian yang paling menarik dimulai - Anda perlu menerapkan penyimpanan data ke disk saat Anda menutup aplikasi dan membaca data dari disk saat dijalankan, bersama dengan keadaan router.  Inisialisasi kait yang mendengarkan acara awal dan tutup aplikasi ditangani oleh kelas <code>AutoSuspendHelper</code> khusus, <code>AutoSuspendHelper</code> untuk setiap platform yang didukung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">ReactiveUI</a> .  Tugas pengembang adalah menginisialisasi kelas ini di bagian paling awal dari akar komposisi aplikasi.  Juga diperlukan untuk menginisialisasi properti <code>RxApp.SuspensionHost.CreateNewAppState</code> fungsi yang akan mengembalikan keadaan default aplikasi jika tidak ada status tersimpan atau kesalahan tak terduga terjadi, atau jika file yang disimpan rusak. </p><br><p>  Selanjutnya, Anda perlu memanggil metode <code>RxApp.SuspensionHost.SetupDefaultSuspendResume</code> , melewati penerapan <code>ISuspensionDriver</code> , driver yang <code>ISuspensionDriver</code> dan membaca objek keadaan.  Untuk menerapkan <code>ISuspensionDriver</code> , <code>ISuspensionDriver</code> menggunakan perpustakaan <code>Newtonsoft.Json</code> dan <code>System.IO</code> namespace untuk bekerja dengan sistem file.  Untuk melakukan ini, instal paket <code>Newtonsoft.Json</code> : </p><br><pre> <code class="plaintext hljs">dotnet add package Newtonsoft.Json</code> </pre> <br><p>  <strong>Drivers / NewtonsoftJsonSuspensionDriver.cs</strong> </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">NewtonsoftJsonSuspensionDriver</span></span> : <span class="hljs-title"><span class="hljs-title">ISuspensionDriver</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _file; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> JsonSerializerSettings _settings = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JsonSerializerSettings { TypeNameHandling = TypeNameHandling.All }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewtonsoftJsonSuspensionDriver</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> file</span></span></span><span class="hljs-function">)</span></span> =&gt; _file = file; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IObservable&lt;Unit&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InvalidateState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (File.Exists(_file)) File.Delete(_file); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.Return(Unit.Default); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IObservable&lt;</span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">object</span></span></span><span class="hljs-function">&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lines = File.ReadAllText(_file); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state = JsonConvert.DeserializeObject&lt;<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>&gt;(lines, _settings); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.Return(state); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IObservable&lt;Unit&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SaveState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lines = JsonConvert.SerializeObject(state, _settings); File.WriteAllText(_file, lines); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.Return(Unit.Default); } }</code> </pre> <br><p>      ‚Äî <code>System.IO</code>    Universal Winows Platform,     ‚Äî   <code>File</code>  <code>Directory</code>  <code>StorageFile</code>  <code>StorageFolder</code> .      ,         <code>IRoutableViewModel</code> ,  <code>Newtonsoft.Json</code>       <code>TypeNameHandling.All</code>  .       Avalonia ‚Äî  <code>App.OnFrameworkInitializationCompleted</code> : </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnFrameworkInitializationCompleted</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   . var suspension = new AutoSuspendHelper(ApplicationLifetime); RxApp.SuspensionHost.CreateNewAppState = () =&gt; new MainViewModel(); RxApp.SuspensionHost.SetupDefaultSuspendResume(new NewtonsoftJsonSuspensionDriver("appstate.json")); suspension.OnFrameworkInitializationCompleted(); //  ,      . var state = RxApp.SuspensionHost.GetAppState&lt;MainViewModel&gt;(); Locator.CurrentMutable.RegisterConstant&lt;IScreen&gt;(state); Locator.CurrentMutable.Register&lt;IViewFor&lt;SearchViewModel&gt;&gt;(() =&gt; new SearchView()); Locator.CurrentMutable.Register&lt;IViewFor&lt;LoginViewModel&gt;&gt;(() =&gt; new LoginView()); //  . new MainView { DataContext = Locator.Current.GetService&lt;IScreen&gt;() }.Show(); base.OnFrameworkInitializationCompleted(); }</span></span></code> </pre> <br><p>   <code>AutoSuspendHelper</code>   <code>Avalonia.ReactiveUI</code>        <code>IApplicationLifetime</code> ‚Äî  ,           <code>ISuspensionDriver</code>    .    <code>ISuspensionDriver</code>            <code>appstate.json</code>     : </p><br><div class="spoiler"> <b class="spoiler_title">appstate.json</b> <div class="spoiler_text"><p>   ‚Äî      <code>$type</code> ,          ,    . </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"$type"</span></span>: <span class="hljs-string"><span class="hljs-string">"ReactiveUI.Samples.Suspension.ViewModels.MainViewModel, ReactiveUI.Samples.Suspension"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Router"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$type"</span></span>: <span class="hljs-string"><span class="hljs-string">"ReactiveUI.RoutingState, ReactiveUI"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"_navigationStack"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"$type"</span></span>: <span class="hljs-string"><span class="hljs-string">"System.Collections.ObjectModel.ObservableCollection`1[[ReactiveUI.IRoutableViewModel, ReactiveUI]], System.ObjectModel"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"$values"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"$type"</span></span>: <span class="hljs-string"><span class="hljs-string">"ReactiveUI.Samples.Suspension.ViewModels.SearchViewModel, ReactiveUI.Samples.Suspension"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"SearchQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"funny cats"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"$type"</span></span>: <span class="hljs-string"><span class="hljs-string">"ReactiveUI.Samples.Suspension.ViewModels.LoginViewModel, ReactiveUI.Samples.Suspension"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Username"</span></span>: <span class="hljs-string"><span class="hljs-string">"worldbeater"</span></span> } ] } } }</code> </pre> </div></div><br><p>   , ,  ,     ,     ,      ,     !  ,        ,  ReactiveUI ‚Äî   UWP  WPF,    Xamarin.Forms. </p><br><p><img src="https://habrastorage.org/webt/yf/ig/p0/yfigp0_ob3ah_cofj-3tdazxrgc.png" width="750"><br></p><br><p> <strong>:</strong> <code>ISuspensionDriver</code>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Akavache</a> ‚Äî      <code>UserAccount</code>  <code>Secure</code>   iOS  UWP          ,    ,   Android  <a href="" rel="nofollow"> BundleSuspensionDriver</a>   <code>ReactiveUI.AndroidSupport</code> .      JSON   Xamarin.Essentials <code>SecureStorage</code> . ,           ‚Äî    ! </p><br><h2 id="poleznye-ssylki">   </h2><br><ul><li>  ,   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">  GitHub</a> . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">Avalonia</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"></a> . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda </font><font style="vertical-align: inherit;">dapat </font><font style="vertical-align: inherit;">mulai belajar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ReactiveUI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel tentang ReactiveUI di Habr</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anda dapat belajar tentang bekerja dengan koleksi gaya reaktif dalam </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">artikel tentang DynamicData</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id457164/">https://habr.com/ru/post/id457164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id457150/index.html">Terminal Windows Baru Sekarang Tersedia di Microsoft Store</a></li>
<li><a href="../id457152/index.html">Konferensi DEFCON 25. Garry Kasparov. "Pertempuran terakhir otak." Bagian 1</a></li>
<li><a href="../id457154/index.html">Desain aplikasi responsif untuk setiap pengguna</a></li>
<li><a href="../id457156/index.html">Apa yang mungkin menjadi sistem komputasi masa depan</a></li>
<li><a href="../id457160/index.html">Pendekatan saya untuk mengimplementasikan delegasi di C ++: memanggil fungsi dengan parameter yang tidak diketahui saat runtime</a></li>
<li><a href="../id457168/index.html">Analisis Sentimen Prototipe dengan Python dan TextBlob</a></li>
<li><a href="../id457172/index.html">ScreenLogger - senyum, Anda difilmkan oleh kamera tersembunyi</a></li>
<li><a href="../id457178/index.html">Bagaimana prosesor dirancang dan diproduksi: desain CPU</a></li>
<li><a href="../id457180/index.html">Situs resmi Node.js sekarang dalam bahasa Rusia</a></li>
<li><a href="../id457182/index.html">Bahasa REXX, Hari Jadi ke-40</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>