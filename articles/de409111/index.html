<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏻‍🤝‍👨🏽 🎳 👩🏽‍🏫 Modbus RTU-Netzwerkemulationssoftware 🚘 🤱🏿 🕎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einführung 
 Wenn Sie nur einen Hammer als Werkzeug haben, ähnelt jedes Problem einem Nagel. 

 Abraham Maslow 
 Das Modbus-Protokoll ist sowohl Habr-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modbus RTU-Netzwerkemulationssoftware</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409111/"><h1>  Einführung </h1><br><blockquote>  Wenn Sie nur einen Hammer als Werkzeug haben, ähnelt jedes Problem einem Nagel. <br><br>  <i>Abraham Maslow</i> </blockquote><br>  Das Modbus-Protokoll ist sowohl Habr-Lesern als auch Hicktime-Lesern bekannt.  Viele Veröffentlichungen haben sich seiner Anwendung gewidmet, die schwer aufzulisten sind, weil es so viele davon gibt, und von Zeit zu Zeit erscheinen hier und da neue Artikel. <br><br><img src="https://habrastorage.org/webt/2m/xh/ry/2mxhryo9sblm6uzcf0srfxzqkkm.png"><br><br>  Die Popularität dieses Protokolls beruht auf seiner Offenheit und Einfachheit.  Der Anwendungsbereich ist breit genug: von professionellen industriellen Automatisierungssystemen bis hin zu Amateur-DIY-Projekten mit verteilten Steuerungssystemen, "intelligenten" Häusern und so weiter.  Dieses Protokoll wurde auch von mir gewählt, als mein Team mit der Erstellung von Software für den Zugsimulator beschäftigt war.  Das Modbus RTU-Protokoll auf der physischen RS485-Schnittstelle wird in diesem Simulator verwendet, um Daten von Steuerungen, die an der Fahrerkonsole angebracht sind, in den Steuercomputer einzugeben (denken Sie nicht, dass Modbus für echtes rollendes Material verwendet wird!). <br><br>  Es lohnt sich nicht, über die Schwierigkeiten beim Einrichten von Software zu sprechen, die mit einem Netzwerk von Controllern interagiert, die Geräte steuern.  Insbesondere wenn ein Teil der Geräte bereits im Eisen vorhanden ist und der andere Teil sich in der Entwicklung und Herstellung befindet.  In diesem Fall muss Software der obersten Ebene unter Berücksichtigung ihrer Interaktion mit dieser Hardware geschrieben werden.  Und es ist ratsam, es so zu schreiben, dass sofort eine funktionierende Version des Systems erstellt wird, ohne dass „Krücken“ verwendet werden, die immer schwer vom Code zu entfernen sind. <br><br>  "Sie müssen Software schreiben, wenn Prototypen der gesamten Hardware fertig sind", sagen Sie, und Sie werden Recht haben, aber ... ha ha ha, das passiert in der realen Welt selten.  Und hier helfen uns Software-Emulatoren. <br><a name="habracut"></a><br><h1>  1. Kurz über Modbus RTU </h1><br>  Ich werde nicht im Detail über das Protokoll sprechen.  Wer sich für Details interessiert, kann die Suche nutzen - das Protokoll ist offen, seine offizielle Spezifikation und viele Informationen sind im Netzwerk verfügbar.  Ich kann nur sagen, dass es in Modbus RTU das Binärformat der übertragenen Daten beschreibt und das RS485-Standard-Twisted-Pair-Kabel als Übertragungsmedium verwendet.  RS232 kann auch verwendet werden, wenn das Netzwerk einen Sender und einen Empfänger hat, oder RS422 für die unidirektionale Datenübertragung. <br><br>  Wir werden an RS485 interessiert sein, einer Halbduplex-Schnittstelle, über die jeweils nur ein Gerät Daten überträgt.  Die Arbitrierung des Busses in Modbus erfolgt aufgrund der Dauerhaftigkeit des obligatorischen Ruheintervalls von 3,5 Zeichen bei einer bestimmten Übertragungsgeschwindigkeit.  Jede Nachricht sollte mit einem Ruheintervall beginnen und enden.  Es gibt ein Master-Gerät im Netzwerk und mehrere Slaves (bis zu 31 in einem Netzwerksegment ohne Verwendung von Repeatern).  Jedes Slave-Gerät verfügt über eine eindeutige ID (1 bis 31).  Die Datenübertragung durch Slaves erfolgt nur, wenn der Master eine Anforderung zum Empfangen von Daten von diesem Gerät gesendet hat. <br><br>  Eine typische Assistentenanforderung sieht folgendermaßen aus <br><br><table><tbody><tr><td>  ID </td><td>  Funktionscode </td><td>  Datenadresse </td><td>  Datenmenge (2 Bytes) </td><td>  Daten </td><td>  CRC16 </td></tr></tbody></table><br>  CRC16 wird verwendet, um die Integrität der übertragenen Daten zu steuern.  Modus verwendet die Big Endian-Datendarstellungsnotation: Bei Werten von 2 Bytes steht das höchstwertige Byte in der Nachricht an erster Stelle.  Das Protokoll verwendet vier Arten von Daten: <br><br><ol><li>  Spulen - diskrete Ausgänge (1 Bit) zum Lesen / Schreiben </li><li>  Digitaleingänge - Nur-Lese-Digitaleingänge (1 Bit) </li><li>  Halteregister - Ausgangsregister (2 Bytes) zum Lesen / Schreiben verfügbar </li><li>  Eingangsregister - Eingangsregister (2 Bytes) zum Lesen verfügbar </li></ol><br>  Als Antwort auf die Anfrage sendet der Slave Daten im folgenden Format <br><br><table><tbody><tr><td>  ID </td><td>  Funktionscode </td><td>  Die Datenmenge in Bytes </td><td>  Daten </td><td>  CRC16 </td></tr></tbody></table><br>  Eine vom Master empfangene Nachricht wird in den Empfangspuffer aller Geräte eingegeben.  Wenn jedoch das erste Byte des Empfangspuffers nicht mit der Geräte-ID übereinstimmt, werden die empfangenen Daten ignoriert und der Empfangspuffer gelöscht.  Wenn die Nachricht für dieses Gerät bestimmt ist, bildet sie eine Antwort und sendet sie nach Einhaltung des Ruheintervalls an den Master. <br><br>  Wie sie sagen, einfach, aber mit Geschmack.  Weitere Informationen hierzu finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Protokollspezifikation</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lesen Sie hier</a> , wie Sie das Protokoll auf der seriellen Schnittstelle implementieren können.  Dafür haben wir uns hier nicht versammelt. <br><br>  Bei der Entwicklung von Top-Level-Software (z. B. auf Basis eines PCs implementierter Master) für ein solches Netzwerk wäre es schön, eine Reihe von Softwaretools zu haben, mit denen ein solches Konzept implementiert werden kann <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/89b/944/3b5/89b9443b5fb11f04536782afce19be3d.png" alt="Bild"></div><br>  Die Bedeutung dieses Schemas ist wie folgt.  Angenommen, wir haben einen Teil der Geräte im zukünftigen Netzwerk.  Oder solche Geräte gibt es bisher nicht.  Es besteht jedoch der brennende Wunsch, Software für die oberste Verwaltungsebene zu schreiben und zu debuggen, damit wir nichts neu schreiben müssen, wenn das Netzwerk noch in Hardware implementiert ist.  Dazu müssen Sie ein physisches Übertragungsmedium verwenden, für das wir ein ähnliches Gerät verwenden <br><br><img src="https://habrastorage.org/webt/1x/cz/ja/1xczjafogu-dwd3qnetuijaszma.jpeg"><br><br>  Einer der Adapter wird verwendet, um die Software des entwickelten Assistenten zu verbinden.  Eine andere dient zum Anschließen eines Emulators eines zukünftigen Netzwerks von Slaves.  Mit dem Zweig mit einem weißen Anschluss verbinden wir den Teil des Netzwerks, der bereits in Hardware implementiert ist.  So haben wir die Möglichkeit, ruhig mit dem Standard-Kommunikationsprotokoll zu arbeiten und schrittweise echte Geräte in Betrieb zu nehmen.  Wenn wir dem Kunden das Objekt geben, wird uns nicht die Möglichkeit genommen, seine Software in einer komfortablen Laborumgebung ohne Zugriff auf das Objekt zu ändern.  QSlave im Diagramm ist genau derselbe Teil des Netzwerks, der von der Software emuliert wird.  Natürlich müssen Sie die entsprechende Software schreiben, die vom Autor erstellt wurde. <br><br><h1>  2. QSlave - Slave-Netzwerkemulation </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">QSlave</a> ist ein offener plattformübergreifender Modbus-RTU-Netzwerkemulator.  Sie können es unter der GPL v2.0-Lizenz auf Github unter dem obigen Link erhalten. <br><br><img src="https://habrastorage.org/webt/4n/nd/am/4nndamsmf4i7ghnfrzzbbc94vqu.png"><br><br>  Die Anwendung wird in C ++ unter Verwendung des Qt-Frameworks entwickelt.  Qt verfügt im Allgemeinen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">über Bibliotheken für die Arbeit mit Modbus</a> , aber die Besonderheiten der Aufgabe - die Simulation eines Netzwerks von Slaves anstelle eines einzelnen Slaves - führten dazu, dass die integrierten Qt-Bibliotheken für Modbus hier nicht verwendet wurden.  Um die von der virtuellen seriellen Schnittstelle empfangenen Daten zu verarbeiten, wurde eine selbstgeschriebene Modbus-Bibliothek erstellt.  Der Code dieser Bibliothek wird als separates Projekt implementiert, ist völlig unabhängig von der Benutzeroberfläche und kann zur Kenntnisnahme von Softwaresimulationen mit erweiterten Funktionen verwendet werden.  Aufgrund der Tatsache, dass die Modbus-Emulation von der Benutzeroberfläche getrennt ist, wird das Netzwerk mithilfe von Konfigurationsdateien konfiguriert.  Das XML-Format wurde gewählt (wir verwenden es häufig in unseren Projekten).  Eine Beispielkonfiguration finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Projektcode</a> .  Eine Reihe von Konfigurationen besteht aus einer Hauptdatei mit der Erweiterung * .net, die so aussieht <br><br>  <b>example.net</b> <br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Traffic light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  XML-  (  *.xml) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span>traffic-light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  und XML-Konfigurationsdateien für jeden der Slaves <br><br>  <b>Ampel.xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>16<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Red signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Yellow signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Green signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Ready<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signal activity time<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signals count<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Die letzte Datei enthält eine Beschreibung aller auf dem Gerät verfügbaren Daten.  Um die Konfiguration herunterzuladen, müssen Sie die * .net-Datei über das QSlave-Programmmenü (Datei → Konfiguration öffnen) öffnen.  Alle Konfigurationsdateien müssen sich im selben Verzeichnis befinden.  Die Beispielkonfiguration beschreibt ein Netzwerk von einem Slave-Gerät, eine virtuelle Ampel, deren diskrete Ausgänge die Signale beschreiben, ein digitaler Eingang zeigt ein Bit des betriebsbereiten Geräts an (bereit), das Eingangsregister meldet die Anzahl der Ampeln und das Ausgangsregister legt die Zeit fest, während der es eingeschaltet ist jedes der Signale. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fea/def/3a4/feadef3a4c17567d127543ee0954b561.png" alt="Bild"><br><br>  Natürlich simuliert dieser Simulator nicht die interne Logik des Geräts.  Sie können nur die Werte der Speicherzellen festlegen, die dem Master zur Verfügung stehen.  Jeder der Werte kann nach eigenem Ermessen festgelegt werden, indem die entsprechende Zelle in der Tabelle bearbeitet wird. <br><br>  Bei aller Einfachheit hilft uns diese Software bei der Arbeit an der Simulatorsoftware (die bereits in Betrieb genommen wurde), ohne das Labor zu verlassen. <br><br><img src="https://habrastorage.org/webt/qh/9j/ba/qh9jba49bbzglh5ca1t2nryin9a.png"><br><br>  Niemand sagt jedoch, dass Sie keinen erweiterten Emulator erstellen können, der den Betrieb virtueller Netzwerkgeräte simuliert.  Zum Erstellen können Sie den im QSlave-Paket verfügbaren Modbus-Bibliothekscode verwenden. <br><br><h1>  3. QMaster - Emulation des Master-Geräts </h1><br>  Um Slaves zu erstellen und ihre Firmware zu debuggen, benötigen Sie eine Assistentensimulation.  Es gibt eine Reihe offener Emulatoren, wie zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">QModbus</a> .  Wir haben es in unserer Arbeit verwendet, bis wir beschlossen, die Datenübertragungsrate auf 250 kBit / s zu erhöhen.  QModbus erlaubt dies nicht.  Es war möglich, es aus den Quellen für Linux neu zu erstellen, aber unsere Elektronikingenieure sitzen unter Windows und wo die Montage aus mehreren Gründen nicht stattfand.  Es stellte sich heraus, dass diese Anwendung in Qt 4 geschrieben ist und eine libmodbus-Bibliothek eines Drittanbieters verwendet.  Ich wollte eine plattformübergreifende Lösung für Qt5, zumal Qt5 bereits sofort mit Modbus funktioniert.  Daher wurde das Analogon mit dem Qt Modbus-Bibliotheksstapel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">QMaster geschrieben</a> .  Unter den gleichen Bedingungen ist es auch auf Github erhältlich. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a13/5fa/5b2/a135fa5b2781d646d18010960defd69d.png" alt="Bild"><br><br><h1>  Fazit </h1><br>  Abschließend möchte ich sagen, dass ich (bei der Arbeit) hauptsächlich an geschlossenen Projekten arbeite.  Die beschriebenen Tools wurden jedoch von mir in meiner Freizeit auf eigene Initiative persönlich entwickelt.  Außerdem sind sie in der Windows-Version statisch mit dem Qt-GPL-Code verknüpft, sodass ich sie unter den gleichen Bedingungen wie Qt an die Community weitergeben muss.  Darüber hinaus können diese Tools für den Leser nützlich sein. <br><br>  Vielen Dank für Ihre Aufmerksamkeit! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de409111/">https://habr.com/ru/post/de409111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de409099/index.html">Was gibt es für das neue Jahr zu geben? Problem 2017</a></li>
<li><a href="../de409101/index.html">Wissenschaftliche Möglichkeiten zur Überwindung von Müdigkeit: Nootropika, Kaffee und Neurotechnologie</a></li>
<li><a href="../de409103/index.html">Crispr Therapeutics plant erste klinische Studien zur Behandlung genetisch bedingter Krankheiten</a></li>
<li><a href="../de409105/index.html">Die größten Kryptowährungen, ihr Ergebnis und warum NiceHash nicht zu Hause gestohlen hat</a></li>
<li><a href="../de409107/index.html">Programmieren und Übertragen von Daten an Arduino über Funk mit dem ESP8266. Teil drei. Hallo ANDROID</a></li>
<li><a href="../de409113/index.html">Eine Kleinigkeit, aber schön: eine Tasse, die die Temperatur des Getränks reguliert</a></li>
<li><a href="../de409115/index.html">Soundtracks von Kult-Spielen: Pest, Utopie und Eispickel</a></li>
<li><a href="../de409119/index.html">Intel ❄ 2017. Ergebnisse des Jahres</a></li>
<li><a href="../de409121/index.html">Was ist das: der russische Markt für Streaming-Dienste</a></li>
<li><a href="../de409123/index.html">Wie man einen bequemen Synthesizer mit eigenen Händen herstellt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>