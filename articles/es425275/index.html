<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õèÔ∏è üöÉ üí¨ 12 consejos para escalar Node.js üõåüèº üöµüèæ üíé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Node.js ya est√° operando con √©xito a escala global, como lo demuestran las aplicaciones implementadas en √©l de compa√±√≠as como Netflix, Reddit, Walmart...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>12 consejos para escalar Node.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425275/">  Node.js ya est√° operando con √©xito a escala global, como lo demuestran las aplicaciones implementadas en √©l de compa√±√≠as como Netflix, Reddit, Walmart y Ebay.  Sin embargo, tiene su propio conjunto de problemas al escalar;  desde el punto de vista de escalar personas que trabajan en una base de c√≥digo √∫nico, por lo que desde el punto de vista del escalado vertical y horizontal en la nube.  Adem√°s de mi experiencia personal con el escalado de Node.js para compa√±√≠as como Reddit y Netflix, habl√© con algunos expertos en Microsoft Azure y le ofrec√≠ algunos consejos para escalar Node.js para su compa√±√≠a. <br><a name="habracut"></a><br><h3>  Escribe un Node.js de calidad </h3><br>  Cuanto antes comience a usar linters, formateo y herramientas de verificaci√≥n de tipo en su c√≥digo, mejor. <br><br>  Estas cosas pueden ser dif√≠ciles de introducir en el medio de un proyecto debido a la gran cantidad de refactorizaci√≥n que puede requerirse, tambi√©n puede contaminar su historial de git, pero al final estas herramientas lo ayudar√°n a que el c√≥digo sea legible. <br>  Si todav√≠a no los usa, vuelva inmediatamente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESLint</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prettier</a> .  ESLint proteger√° su c√≥digo de patrones incorrectos, Prettier lo ayudar√° a formatear autom√°ticamente su c√≥digo antes de solicitarlo. <br><br>  Una soluci√≥n m√°s sustancial es agregar herramientas como Flow o TypeScript a su base de c√≥digo.  Estas herramientas le permiten detectar errores m√°s sutiles, como llamar a una funci√≥n con un par√°metro num√©rico en lugar de una cadena o llamar al m√©todo <b>.filter</b> en objetos en lugar de una matriz.  A pesar de la complejidad y la necesidad de capacitar a su equipo, estas herramientas merecen su atenci√≥n: pueden acelerar el desarrollo con Intellisense y prevenir errores de tiempo de ejecuci√≥n con protecci√≥n de tipo. <br><br><h3>  Escribir pruebas </h3><br>  Las pruebas siempre han sido un problema dif√≠cil para los desarrolladores.  Algunos creen firmemente en el desarrollo basado en pruebas, mientras que otros rara vez escriben pruebas.  Pero hay un t√©rmino medio: <br><br><ul><li>  <b>Defina m√≥dulos clave</b> y escriba pruebas unitarias completas para ellos.  Preste especial atenci√≥n a los "viajes felices": casos extremos y escenarios en los que pueden ocurrir errores.  Para otros m√≥dulos, escriba una o dos pruebas unitarias que cubran "caminos felices" y posiblemente casos comunes que haya descubierto </li><li>  <b>Prueba m√≠nima de IU</b> .  La interfaz de usuario est√° cambiando constantemente y, a menudo, no es pr√°ctico pasar mucho tiempo haciendo pruebas para el c√≥digo que cambiar√° con frecuencia. <br></li><li>  <b>Escribe pruebas para detectar errores</b> .  Siempre que encuentre y corrija un error en su c√≥digo, escriba una prueba unitaria que detecte este error en el futuro. <br></li><li>  <b>Escriba algunas pruebas de integraci√≥n</b> para asegurarse de que todas las partes coincidan entre s√≠. <br></li><li>  <b>Escriba a√∫n menos pruebas de extremo a extremo</b> .  Cubra las rutas clave en su sitio, por ejemplo, si est√° creando un sitio de comercio electr√≥nico, puede valer la pena escribir una prueba para ingresar al sitio, agregarlo a la cesta y verificar la lista de productos.  Estas pruebas son costosas de mantener, as√≠ que considere mantener un peque√±o n√∫cleo de pruebas que pueda motivar a mantener. <br></li></ul><br>  El punto de partida para escribir pruebas es la capacidad de implementar con confianza un nuevo c√≥digo.  Escriba tantas pruebas que no haya menos de lo que usted siente, pero trate de escribir no m√°s que la lista anterior. <br><br><h3>  Dise√±o sin estado </h3><br>  La clave al escribir Node.js escalable es que sus servidores no tienen que almacenar estados para alguien o algo.  Esto evitar√° la escala horizontal.  Mueva el estado a otra aplicaci√≥n y resuelva el problema en otro lugar (por ejemplo, Redis, Etcd, ...).  Deber√≠as pensar en esto de antemano.  Entonces ser√° muy dif√≠cil desentra√±ar si no ha hecho esto antes.  Tambi√©n ayudar√° si alguna vez decide descomponer monolitos en microservicios. <br><br><h3>  Estad√≠sticas: para desarrollo - Node.js, para producci√≥n - CDN </h3><br>  C√≥mo me gustar√≠a que las empresas vean un error en este error.  Servir sus activos est√°ticos desde su aplicaci√≥n web (en particular a trav√©s de algo como webpack-dev-server o el servidor de desarrollo de Parsel) es una excelente experiencia de desarrollador, ya que acorta el ciclo de introducci√≥n al escribir c√≥digo.  Sin embargo, nunca debe publicar sus estad√≠sticas a trav√©s de Node.js.  Debe enviarse por separado a trav√©s de una CDN, como una CDN de Azure. <br><br>  Los retornos est√°ticos con Node.js son innecesariamente lentos porque los CDN est√°n m√°s dispersos y, por lo tanto, f√≠sicamente m√°s cerca del usuario final, y los servidores de CDN est√°n altamente optimizados para peque√±os recursos.  Mantener las estad√≠sticas con Node tambi√©n es irrazonablemente costoso, ya que el tiempo del servidor Node.js es mucho m√°s costoso que el tiempo del servidor CDN. <br><br><h3>  Comience a implementar temprano, implemente con m√°s frecuencia </h3><br>  No te conozco, pero cuando desbloqueo algo por primera vez, nunca funciona.  Esto generalmente se debe a que olvid√© enviar las claves privadas correctas o codifiqu√© la ruta al host local.  Peque√±os problemas que funcionan localmente de forma remota se niegan a hacer esto.  Estos problemas se pueden acumular, y lo que se podr√≠a solucionar f√°cilmente antes si, por supuesto, antes de encontrarlos, se puede convertir en una enorme cantidad de errores incomprensibles que simplemente no se pueden detectar normalmente. <br><br>  Por cierto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Visual Studio Code te permite resolver este tipo de problema</a> .  Le permite implementar su aplicaci√≥n directamente en Azure con un solo clic.  Esta es una forma bastante simple de verificar que no haya problemas para implementar en otro entorno. <br><br><h3>  Implemente 2 servidores a la vez </h3><br>  Este consejo proviene de mi conocimiento ganado con esfuerzo y de un mar de dolor.  La esencia del consejo es que hay pocas diferencias entre la implementaci√≥n de dos servidores y diez servidores, y no hay mucha diferencia entre la implementaci√≥n de diez servidores y cien servidores.  Sin embargo, simplemente existe una gran diferencia entre implementar un servidor y dos servidores. <br>  Similar al problema de implementar servidores sin estado, comenzando con dos servidores, puede superar r√°pidamente sus problemas de escala horizontal para que cuando haya un fuerte aumento en el tr√°fico, est√© listo para escalar. <br><br><h3>  No tengas miedo de las l√≠neas </h3><br>  Las bases de datos modernas manejan una cierta cantidad de lectura y escritura por su cuenta, sin su ayuda.  Cuando est√© probando su idea, no dude en confiar en su base de datos para manejar cargas de trabajo peque√±as o medianas. <br><br>  La escala prematura tiene m√°s probabilidades de matarte que salvarte.  Pero, en alg√∫n momento, su aplicaci√≥n crecer√° y no podr√° escribir todo en la base de datos tambi√©n, ante problemas de ancho de banda de lectura y escritura.  Para algunas aplicaciones que tienen un registro ligero, o si selecciona una base de datos como Cassandra, que maneja la escala masiva por s√≠ sola, esto ser√° un problema m√°s adelante, para otros ser√° m√°s temprano. <br><br>  Si tiene o tendr√° un problema de este tipo, tendr√° opciones para elegir tecnolog√≠as con las que ir√° m√°s all√°.  Una de estas tecnolog√≠as puede ser la cola de mensajes.  El est√°ndar actual en este momento es Apache Kafka, que le permite organizar sus mensajes en temas y luego aplicaciones para suscribirse a este tema.  Entonces, por ejemplo, puede acumular mensajes en la aplicaci√≥n, escuchar un determinado tema y luego escribir datos por lotes en su base de datos para que no se obstruya todo el tiempo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adem√°s, Kafka se ejecuta f√°cilmente en Azure</a> . <br><br><h3>  Microservicios para escalar </h3><br>  A medida que su aplicaci√≥n crece, comienzan a aparecer divisiones l√≥gicas naturales.  Una parte de la aplicaci√≥n puede procesar pagos, mientras que la otra parte servir√° la API para su interfaz.  Al hacer divisiones l√≥gicas, considere hacerlos microservicios separados.  Pero tenga cuidado, ya que la introducci√≥n de microservicios tambi√©n est√° cargada de gran complejidad.  Pero vale la pena.  Entonces, por ejemplo, cada microservicio puede tener su propia m√©trica.  Al evaluarlos, puede escalarlos de forma independiente. <br><br><h3>  Use contenedores </h3><br>  Su aplicaci√≥n puede funcionar bien localmente, pero puede haber serios problemas al intentar implementarla.  Herramientas como Docker y Kubernetes funcionar√°n para evitar este problema.  Docker, que puede imaginar como una mini instancia (contenedor) de Linux o Windows, en la que puede ejecutar la aplicaci√≥n;  y Kubernetes como una herramienta que conecta todos sus contenedores en la nube. <br><br>  Kubernetes puede ser una bestia compleja, pero una bestia que resuelve un problema complejo.  Si eres un hechicero DevOps inexperto, entonces puedes tener dificultades, por lo que te recomiendo comenzar con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Draft</a> .  Si est√° familiarizado con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yeoman</a> para proyectos Javascript, puede evaluar Draft como una herramienta similar, pero para proyectos Kubernetes: una herramienta que crea una estructura de alambre para su proyecto.  A partir de ah√≠, puede usar la herramienta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Helm</a> para instalar piezas de arquitectura adicionales que necesita construir (por ejemplo, nginx, m√°s servidores Node.js, MongoDB, Kafka, etc.), casi como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">npm</a> para Kubernetes. <br><br>  Tan pronto como comprenda el ecosistema de Kubernetes, a partir de ahora, la implementaci√≥n en la nube se convertir√° en un juego para ni√±os. <br><br><h3>  Recoge m√©tricas </h3><br>  Si no sabe c√≥mo responder a la pregunta "¬øC√≥mo funciona mi solicitud?", Entonces tendr√° problemas o lo har√°n pronto.  Despu√©s de todo, varios tipos de indicadores a lo largo del tiempo lo ayudar√°n a mejorar constantemente el estado de su aplicaci√≥n.  Desde el punto de vista de los costos para el futuro, y desde el punto de vista de la conveniencia del usuario en t√©rminos de mejorar el tiempo de respuesta.  Definitivamente, debe realizar un seguimiento de las m√©tricas, como las rutas lentas, las visitas a la p√°gina, el tiempo de sesi√≥n y otras m√©tricas clave que son importantes para su negocio. <br><br>  Hay muchas formas de recopilar estos indicadores.  Servicios como New Relic y AppDynamics le proporcionar√°n informaci√≥n invaluable sobre c√≥mo mejorar su aplicaci√≥n. <br><br>  Si trabaja con Azure, Application Insights tambi√©n hace frente a esta necesidad, y tambi√©n es f√°cil conectar otras herramientas como CI / CD. <br><br><h3>  CI / CD lo salvar√° de tanto dolor </h3><br>  ¬øCu√°ntas veces ha estropeado la implementaci√≥n durante FTP y ha desactivado su servidor durante varios minutos?  Fue conmigo.  Nunca debe confiar en usted mismo para implementar el c√≥digo de producci√≥n.  C√≥mo hacer esto usando Visual Studio Code es bastante bueno, pero es principalmente para fines de desarrollo o demostraci√≥n.  Cuando est√© listo para crear un sistema de nivel de producci√≥n, debe usar la integraci√≥n continua y la implementaci√≥n continua (a menudo abreviado CI / CD - integraci√≥n continua y implementaci√≥n continua). <br><br>  La integraci√≥n continua es la pr√°ctica del desarrollo de software, que consiste en fusionar copias de trabajo en una rama principal de desarrollo com√∫n varias veces al d√≠a y realizar ensamblajes autom√°ticos frecuentes del proyecto para identificar r√°pidamente posibles defectos y resolver problemas de integraci√≥n. <br><br>  La implementaci√≥n continua se encarga de tomar el c√≥digo que pas√≥ el elemento de configuraci√≥n, ejecutar los pasos necesarios para compilarlos, empaquetarlos o empaquetarlos, y enviarlos al servidor.  Es una buena pr√°ctica tener varios niveles para probar.  Primero puede ir al servidor de desarrollo interno para verlo primero en un entorno de bajo riesgo.  Puede probarlo primero antes de enviarlo a un entorno de control de calidad donde sus ingenieros de control de calidad o posiblemente un servicio externo confirmar√°n que todo funciona como se esperaba.  A partir de ah√≠, puede cambiar a un entorno intermedio en el que su aplicaci√≥n sigue siendo solo interna, pero funciona utilizando datos y configuraciones de producci√≥n, por lo que puede probarla en el entorno de producci√≥n antes de enviarla directamente a producci√≥n.  Tambi√©n puede seleccionar un peque√±o grupo de servidores para verificar el nuevo c√≥digo: usted y dirigir solo un peque√±o porcentaje del tr√°fico real a estos servidores para asegurarse de que nada se rompa cuando trabaje con usuarios reales.  Si se rompe, ya sabe d√≥nde buscar el problema.  De lo contrario, puede pasar de un peque√±o grupo de usuarios a todos. <br><br>  Muchos proveedores y proyectos de c√≥digo abierto abordan estas necesidades.  Jenkins, Travis y CircleCI son excelentes opciones para CI.  Azure tiene su propio servicio de CI / CD llamado Azure Pipelines, y es bastante intuitivo de usar, y nuevamente, se conecta f√°cilmente al ecosistema integrado de Azure. <br><br><h3>  Guardar secretos </h3><br>  Cualquier aplicaci√≥n inevitablemente tiene algunos secretos.  Pueden ser claves y l√≠neas secretas de credenciales, bases de datos y mucho m√°s.  Ser√≠a muy malo si se convirtieran en las manos equivocadas.  Sin embargo, son necesarios para ejecutar la aplicaci√≥n.  Entonces, ¬øqu√© hacemos?  Por lo general, en el desarrollo usaremos herramientas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dotenv</a> para guardar el archivo de configuraci√≥n localmente y poder leerlo a trav√©s de process.env en Node.js.  Esto es genial para los desarrolladores, pero terrible para la producci√≥n. <br><br>  En cambio, es √∫til usar alg√∫n tipo de herramienta de administraci√≥n secreta.  Afortunadamente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kubernetes tiene un sistema incorporado</a> y es bastante simple de usar.  Proporciona secretos de Kubernetes en el lado del contenedor y luego los proporcionar√° a su aplicaci√≥n como un entorno que complica enormemente el ataque. <br><br>  Otra herramienta digna de su atenci√≥n es Azure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Key Vault</a> .  Lo bueno de Key Vault, aunque Microsoft no puede leer sus claves (solo usted tiene la opci√≥n de descifrarlas), Azure realizar√° un seguimiento de sus registros y de cualquier uso dudoso de sus claves para advertirle de cualquier compromiso. <br><br><h3>  Conclusi√≥n </h3><br>  Node.js, como cualquier otra plataforma, necesita ser escalado.  Y, como cualquier otra plataforma, tiene sus propias tareas y la peculiaridad de escalar, que vale la pena conocer y que deben tenerse en cuenta al dise√±ar grandes proyectos. <br><br>  Art√≠culo original: "Once consejos para escalar Node.js" ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Es</a> ). <br><br>  Sugiero en los comentarios compartir consejos que puede dar sobre el escalado de Node.js.  Ser√° interesante escucharlo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425275/">https://habr.com/ru/post/es425275/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425265/index.html">Reglas de desarrollo en Yandex.Health</a></li>
<li><a href="../es425267/index.html">Lugar de trabajo del desarrollador .NET o dificultades para elegir la configuraci√≥n ideal ver.2.0</a></li>
<li><a href="../es425269/index.html">Hackathon GAZ: c√≥mo tocar al gigante automotor</a></li>
<li><a href="../es425271/index.html">WPA3 podr√≠a ser m√°s seguro: opini√≥n de expertos</a></li>
<li><a href="../es425273/index.html">Otra forma de usar docker-compose</a></li>
<li><a href="../es425279/index.html">C√≥mo entrevistar a Google: qu√© ser, qu√© no pasar</a></li>
<li><a href="../es425281/index.html">Pautas para llevar "a la condici√≥n" un clon del popular mini-enrutador chino Hame A15, tambi√©n conocido como "sin marca A5-V11"</a></li>
<li><a href="../es425283/index.html">Localizaci√≥n infinita, o c√≥mo traducimos un mapa en tiempo real</a></li>
<li><a href="../es425285/index.html">Si no contratas a Jones, entonces no mereces a los se√±ores</a></li>
<li><a href="../es425287/index.html">Casas FIAS en PostgreSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>