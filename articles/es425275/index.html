<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>久勇 游뚞 游눫 12 consejos para escalar Node.js 游띏游낖 游뛋游 游눑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Node.js ya est치 operando con 칠xito a escala global, como lo demuestran las aplicaciones implementadas en 칠l de compa침칤as como Netflix, Reddit, Walmart...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>12 consejos para escalar Node.js</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425275/">  Node.js ya est치 operando con 칠xito a escala global, como lo demuestran las aplicaciones implementadas en 칠l de compa침칤as como Netflix, Reddit, Walmart y Ebay.  Sin embargo, tiene su propio conjunto de problemas al escalar;  desde el punto de vista de escalar personas que trabajan en una base de c칩digo 칰nico, por lo que desde el punto de vista del escalado vertical y horizontal en la nube.  Adem치s de mi experiencia personal con el escalado de Node.js para compa침칤as como Reddit y Netflix, habl칠 con algunos expertos en Microsoft Azure y le ofrec칤 algunos consejos para escalar Node.js para su compa침칤a. <br><a name="habracut"></a><br><h3>  Escribe un Node.js de calidad </h3><br>  Cuanto antes comience a usar linters, formateo y herramientas de verificaci칩n de tipo en su c칩digo, mejor. <br><br>  Estas cosas pueden ser dif칤ciles de introducir en el medio de un proyecto debido a la gran cantidad de refactorizaci칩n que puede requerirse, tambi칠n puede contaminar su historial de git, pero al final estas herramientas lo ayudar치n a que el c칩digo sea legible. <br>  Si todav칤a no los usa, vuelva inmediatamente a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ESLint</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prettier</a> .  ESLint proteger치 su c칩digo de patrones incorrectos, Prettier lo ayudar치 a formatear autom치ticamente su c칩digo antes de solicitarlo. <br><br>  Una soluci칩n m치s sustancial es agregar herramientas como Flow o TypeScript a su base de c칩digo.  Estas herramientas le permiten detectar errores m치s sutiles, como llamar a una funci칩n con un par치metro num칠rico en lugar de una cadena o llamar al m칠todo <b>.filter</b> en objetos en lugar de una matriz.  A pesar de la complejidad y la necesidad de capacitar a su equipo, estas herramientas merecen su atenci칩n: pueden acelerar el desarrollo con Intellisense y prevenir errores de tiempo de ejecuci칩n con protecci칩n de tipo. <br><br><h3>  Escribir pruebas </h3><br>  Las pruebas siempre han sido un problema dif칤cil para los desarrolladores.  Algunos creen firmemente en el desarrollo basado en pruebas, mientras que otros rara vez escriben pruebas.  Pero hay un t칠rmino medio: <br><br><ul><li>  <b>Defina m칩dulos clave</b> y escriba pruebas unitarias completas para ellos.  Preste especial atenci칩n a los "viajes felices": casos extremos y escenarios en los que pueden ocurrir errores.  Para otros m칩dulos, escriba una o dos pruebas unitarias que cubran "caminos felices" y posiblemente casos comunes que haya descubierto </li><li>  <b>Prueba m칤nima de IU</b> .  La interfaz de usuario est치 cambiando constantemente y, a menudo, no es pr치ctico pasar mucho tiempo haciendo pruebas para el c칩digo que cambiar치 con frecuencia. <br></li><li>  <b>Escribe pruebas para detectar errores</b> .  Siempre que encuentre y corrija un error en su c칩digo, escriba una prueba unitaria que detecte este error en el futuro. <br></li><li>  <b>Escriba algunas pruebas de integraci칩n</b> para asegurarse de que todas las partes coincidan entre s칤. <br></li><li>  <b>Escriba a칰n menos pruebas de extremo a extremo</b> .  Cubra las rutas clave en su sitio, por ejemplo, si est치 creando un sitio de comercio electr칩nico, puede valer la pena escribir una prueba para ingresar al sitio, agregarlo a la cesta y verificar la lista de productos.  Estas pruebas son costosas de mantener, as칤 que considere mantener un peque침o n칰cleo de pruebas que pueda motivar a mantener. <br></li></ul><br>  El punto de partida para escribir pruebas es la capacidad de implementar con confianza un nuevo c칩digo.  Escriba tantas pruebas que no haya menos de lo que usted siente, pero trate de escribir no m치s que la lista anterior. <br><br><h3>  Dise침o sin estado </h3><br>  La clave al escribir Node.js escalable es que sus servidores no tienen que almacenar estados para alguien o algo.  Esto evitar치 la escala horizontal.  Mueva el estado a otra aplicaci칩n y resuelva el problema en otro lugar (por ejemplo, Redis, Etcd, ...).  Deber칤as pensar en esto de antemano.  Entonces ser치 muy dif칤cil desentra침ar si no ha hecho esto antes.  Tambi칠n ayudar치 si alguna vez decide descomponer monolitos en microservicios. <br><br><h3>  Estad칤sticas: para desarrollo - Node.js, para producci칩n - CDN </h3><br>  C칩mo me gustar칤a que las empresas vean un error en este error.  Servir sus activos est치ticos desde su aplicaci칩n web (en particular a trav칠s de algo como webpack-dev-server o el servidor de desarrollo de Parsel) es una excelente experiencia de desarrollador, ya que acorta el ciclo de introducci칩n al escribir c칩digo.  Sin embargo, nunca debe publicar sus estad칤sticas a trav칠s de Node.js.  Debe enviarse por separado a trav칠s de una CDN, como una CDN de Azure. <br><br>  Los retornos est치ticos con Node.js son innecesariamente lentos porque los CDN est치n m치s dispersos y, por lo tanto, f칤sicamente m치s cerca del usuario final, y los servidores de CDN est치n altamente optimizados para peque침os recursos.  Mantener las estad칤sticas con Node tambi칠n es irrazonablemente costoso, ya que el tiempo del servidor Node.js es mucho m치s costoso que el tiempo del servidor CDN. <br><br><h3>  Comience a implementar temprano, implemente con m치s frecuencia </h3><br>  No te conozco, pero cuando desbloqueo algo por primera vez, nunca funciona.  Esto generalmente se debe a que olvid칠 enviar las claves privadas correctas o codifiqu칠 la ruta al host local.  Peque침os problemas que funcionan localmente de forma remota se niegan a hacer esto.  Estos problemas se pueden acumular, y lo que se podr칤a solucionar f치cilmente antes si, por supuesto, antes de encontrarlos, se puede convertir en una enorme cantidad de errores incomprensibles que simplemente no se pueden detectar normalmente. <br><br>  Por cierto, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Visual Studio Code te permite resolver este tipo de problema</a> .  Le permite implementar su aplicaci칩n directamente en Azure con un solo clic.  Esta es una forma bastante simple de verificar que no haya problemas para implementar en otro entorno. <br><br><h3>  Implemente 2 servidores a la vez </h3><br>  Este consejo proviene de mi conocimiento ganado con esfuerzo y de un mar de dolor.  La esencia del consejo es que hay pocas diferencias entre la implementaci칩n de dos servidores y diez servidores, y no hay mucha diferencia entre la implementaci칩n de diez servidores y cien servidores.  Sin embargo, simplemente existe una gran diferencia entre implementar un servidor y dos servidores. <br>  Similar al problema de implementar servidores sin estado, comenzando con dos servidores, puede superar r치pidamente sus problemas de escala horizontal para que cuando haya un fuerte aumento en el tr치fico, est칠 listo para escalar. <br><br><h3>  No tengas miedo de las l칤neas </h3><br>  Las bases de datos modernas manejan una cierta cantidad de lectura y escritura por su cuenta, sin su ayuda.  Cuando est칠 probando su idea, no dude en confiar en su base de datos para manejar cargas de trabajo peque침as o medianas. <br><br>  La escala prematura tiene m치s probabilidades de matarte que salvarte.  Pero, en alg칰n momento, su aplicaci칩n crecer치 y no podr치 escribir todo en la base de datos tambi칠n, ante problemas de ancho de banda de lectura y escritura.  Para algunas aplicaciones que tienen un registro ligero, o si selecciona una base de datos como Cassandra, que maneja la escala masiva por s칤 sola, esto ser치 un problema m치s adelante, para otros ser치 m치s temprano. <br><br>  Si tiene o tendr치 un problema de este tipo, tendr치 opciones para elegir tecnolog칤as con las que ir치 m치s all치.  Una de estas tecnolog칤as puede ser la cola de mensajes.  El est치ndar actual en este momento es Apache Kafka, que le permite organizar sus mensajes en temas y luego aplicaciones para suscribirse a este tema.  Entonces, por ejemplo, puede acumular mensajes en la aplicaci칩n, escuchar un determinado tema y luego escribir datos por lotes en su base de datos para que no se obstruya todo el tiempo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adem치s, Kafka se ejecuta f치cilmente en Azure</a> . <br><br><h3>  Microservicios para escalar </h3><br>  A medida que su aplicaci칩n crece, comienzan a aparecer divisiones l칩gicas naturales.  Una parte de la aplicaci칩n puede procesar pagos, mientras que la otra parte servir치 la API para su interfaz.  Al hacer divisiones l칩gicas, considere hacerlos microservicios separados.  Pero tenga cuidado, ya que la introducci칩n de microservicios tambi칠n est치 cargada de gran complejidad.  Pero vale la pena.  Entonces, por ejemplo, cada microservicio puede tener su propia m칠trica.  Al evaluarlos, puede escalarlos de forma independiente. <br><br><h3>  Use contenedores </h3><br>  Su aplicaci칩n puede funcionar bien localmente, pero puede haber serios problemas al intentar implementarla.  Herramientas como Docker y Kubernetes funcionar치n para evitar este problema.  Docker, que puede imaginar como una mini instancia (contenedor) de Linux o Windows, en la que puede ejecutar la aplicaci칩n;  y Kubernetes como una herramienta que conecta todos sus contenedores en la nube. <br><br>  Kubernetes puede ser una bestia compleja, pero una bestia que resuelve un problema complejo.  Si eres un hechicero DevOps inexperto, entonces puedes tener dificultades, por lo que te recomiendo comenzar con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Draft</a> .  Si est치 familiarizado con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yeoman</a> para proyectos Javascript, puede evaluar Draft como una herramienta similar, pero para proyectos Kubernetes: una herramienta que crea una estructura de alambre para su proyecto.  A partir de ah칤, puede usar la herramienta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Helm</a> para instalar piezas de arquitectura adicionales que necesita construir (por ejemplo, nginx, m치s servidores Node.js, MongoDB, Kafka, etc.), casi como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">npm</a> para Kubernetes. <br><br>  Tan pronto como comprenda el ecosistema de Kubernetes, a partir de ahora, la implementaci칩n en la nube se convertir치 en un juego para ni침os. <br><br><h3>  Recoge m칠tricas </h3><br>  Si no sabe c칩mo responder a la pregunta "쮺칩mo funciona mi solicitud?", Entonces tendr치 problemas o lo har치n pronto.  Despu칠s de todo, varios tipos de indicadores a lo largo del tiempo lo ayudar치n a mejorar constantemente el estado de su aplicaci칩n.  Desde el punto de vista de los costos para el futuro, y desde el punto de vista de la conveniencia del usuario en t칠rminos de mejorar el tiempo de respuesta.  Definitivamente, debe realizar un seguimiento de las m칠tricas, como las rutas lentas, las visitas a la p치gina, el tiempo de sesi칩n y otras m칠tricas clave que son importantes para su negocio. <br><br>  Hay muchas formas de recopilar estos indicadores.  Servicios como New Relic y AppDynamics le proporcionar치n informaci칩n invaluable sobre c칩mo mejorar su aplicaci칩n. <br><br>  Si trabaja con Azure, Application Insights tambi칠n hace frente a esta necesidad, y tambi칠n es f치cil conectar otras herramientas como CI / CD. <br><br><h3>  CI / CD lo salvar치 de tanto dolor </h3><br>  쮺u치ntas veces ha estropeado la implementaci칩n durante FTP y ha desactivado su servidor durante varios minutos?  Fue conmigo.  Nunca debe confiar en usted mismo para implementar el c칩digo de producci칩n.  C칩mo hacer esto usando Visual Studio Code es bastante bueno, pero es principalmente para fines de desarrollo o demostraci칩n.  Cuando est칠 listo para crear un sistema de nivel de producci칩n, debe usar la integraci칩n continua y la implementaci칩n continua (a menudo abreviado CI / CD - integraci칩n continua y implementaci칩n continua). <br><br>  La integraci칩n continua es la pr치ctica del desarrollo de software, que consiste en fusionar copias de trabajo en una rama principal de desarrollo com칰n varias veces al d칤a y realizar ensamblajes autom치ticos frecuentes del proyecto para identificar r치pidamente posibles defectos y resolver problemas de integraci칩n. <br><br>  La implementaci칩n continua se encarga de tomar el c칩digo que pas칩 el elemento de configuraci칩n, ejecutar los pasos necesarios para compilarlos, empaquetarlos o empaquetarlos, y enviarlos al servidor.  Es una buena pr치ctica tener varios niveles para probar.  Primero puede ir al servidor de desarrollo interno para verlo primero en un entorno de bajo riesgo.  Puede probarlo primero antes de enviarlo a un entorno de control de calidad donde sus ingenieros de control de calidad o posiblemente un servicio externo confirmar치n que todo funciona como se esperaba.  A partir de ah칤, puede cambiar a un entorno intermedio en el que su aplicaci칩n sigue siendo solo interna, pero funciona utilizando datos y configuraciones de producci칩n, por lo que puede probarla en el entorno de producci칩n antes de enviarla directamente a producci칩n.  Tambi칠n puede seleccionar un peque침o grupo de servidores para verificar el nuevo c칩digo: usted y dirigir solo un peque침o porcentaje del tr치fico real a estos servidores para asegurarse de que nada se rompa cuando trabaje con usuarios reales.  Si se rompe, ya sabe d칩nde buscar el problema.  De lo contrario, puede pasar de un peque침o grupo de usuarios a todos. <br><br>  Muchos proveedores y proyectos de c칩digo abierto abordan estas necesidades.  Jenkins, Travis y CircleCI son excelentes opciones para CI.  Azure tiene su propio servicio de CI / CD llamado Azure Pipelines, y es bastante intuitivo de usar, y nuevamente, se conecta f치cilmente al ecosistema integrado de Azure. <br><br><h3>  Guardar secretos </h3><br>  Cualquier aplicaci칩n inevitablemente tiene algunos secretos.  Pueden ser claves y l칤neas secretas de credenciales, bases de datos y mucho m치s.  Ser칤a muy malo si se convirtieran en las manos equivocadas.  Sin embargo, son necesarios para ejecutar la aplicaci칩n.  Entonces, 쯤u칠 hacemos?  Por lo general, en el desarrollo usaremos herramientas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dotenv</a> para guardar el archivo de configuraci칩n localmente y poder leerlo a trav칠s de process.env en Node.js.  Esto es genial para los desarrolladores, pero terrible para la producci칩n. <br><br>  En cambio, es 칰til usar alg칰n tipo de herramienta de administraci칩n secreta.  Afortunadamente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kubernetes tiene un sistema incorporado</a> y es bastante simple de usar.  Proporciona secretos de Kubernetes en el lado del contenedor y luego los proporcionar치 a su aplicaci칩n como un entorno que complica enormemente el ataque. <br><br>  Otra herramienta digna de su atenci칩n es Azure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Key Vault</a> .  Lo bueno de Key Vault, aunque Microsoft no puede leer sus claves (solo usted tiene la opci칩n de descifrarlas), Azure realizar치 un seguimiento de sus registros y de cualquier uso dudoso de sus claves para advertirle de cualquier compromiso. <br><br><h3>  Conclusi칩n </h3><br>  Node.js, como cualquier otra plataforma, necesita ser escalado.  Y, como cualquier otra plataforma, tiene sus propias tareas y la peculiaridad de escalar, que vale la pena conocer y que deben tenerse en cuenta al dise침ar grandes proyectos. <br><br>  Art칤culo original: "Once consejos para escalar Node.js" ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Es</a> ). <br><br>  Sugiero en los comentarios compartir consejos que puede dar sobre el escalado de Node.js.  Ser치 interesante escucharlo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es425275/">https://habr.com/ru/post/es425275/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es425265/index.html">Reglas de desarrollo en Yandex.Health</a></li>
<li><a href="../es425267/index.html">Lugar de trabajo del desarrollador .NET o dificultades para elegir la configuraci칩n ideal ver.2.0</a></li>
<li><a href="../es425269/index.html">Hackathon GAZ: c칩mo tocar al gigante automotor</a></li>
<li><a href="../es425271/index.html">WPA3 podr칤a ser m치s seguro: opini칩n de expertos</a></li>
<li><a href="../es425273/index.html">Otra forma de usar docker-compose</a></li>
<li><a href="../es425279/index.html">C칩mo entrevistar a Google: qu칠 ser, qu칠 no pasar</a></li>
<li><a href="../es425281/index.html">Pautas para llevar "a la condici칩n" un clon del popular mini-enrutador chino Hame A15, tambi칠n conocido como "sin marca A5-V11"</a></li>
<li><a href="../es425283/index.html">Localizaci칩n infinita, o c칩mo traducimos un mapa en tiempo real</a></li>
<li><a href="../es425285/index.html">Si no contratas a Jones, entonces no mereces a los se침ores</a></li>
<li><a href="../es425287/index.html">Casas FIAS en PostgreSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>