<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐จโ๐ค ๐ ๐คฎ ุงููุฌูุงุช ุจูู ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช โฑ๏ธ ๐ข ๐ถ๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุนุงุฌูุงู ุฃู ุขุฌูุงู ุ ุฃุซูุงุก ุงูููุจูุชุฉ ุ ุชูุดุฃ ุงููููุฉ ุงููุชูุซูุฉ ูู ุชุณููุฉ ุงูุบุงุจุฉ ุจุฃููููุง - ุดุฑูุทุฉ ุฃู ุชููู ููุงู ุฃู ุญููู ูู ุฃุญุฏ ุงููุฌุงูุงุช. ูู ูุซู ูุฐู ุงููุญุธุงุช ุ ูุทุฑ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงููุฌูุงุช ุจูู ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/466445/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ki/6u/o8/ki6uo88vz8xcqbapiyvfwn4sc-s.jpeg"><br><br>  ุนุงุฌูุงู ุฃู ุขุฌูุงู ุ ุฃุซูุงุก ุงูููุจูุชุฉ ุ ุชูุดุฃ ุงููููุฉ ุงููุชูุซูุฉ ูู ุชุณููุฉ ุงูุบุงุจุฉ ุจุฃููููุง - ุดุฑูุทุฉ ุฃู ุชููู ููุงู ุฃู ุญููู ูู ุฃุญุฏ ุงููุฌุงูุงุช.  ูู ูุซู ูุฐู ุงููุญุธุงุช ุ ูุทุฑุญ ุงููุซูุฑ ูู ุงูุฃุณุฆูุฉ ุญูู ุงูุตูุงุฏูู ุ ูููุชููุงุชูู ุ ูุงููุฌูุงุช ุจุฃููุณูู.  ุฏุนููุง ูุญุงูู ูุนุฑูุฉ ูู ุดูุก. <br><a name="habracut"></a><br>  ูุชู ุงุณุชุฎุฏุงู ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช ููุตุงุฏูุฉ ูุณุชุฎุฏูู ูุฌุงู ูุง ุนูู ูุญุฏุฉ ุชุญูู ูุฌุงู ุขุฎุฑ.  ุจูุนูู ุขุฎุฑ ุ ุจุญูุซ ูููู ูููุณุชุฎุฏููู ูู ุงููุฌุงู A ุงููุตูู ุฅูู ููุงุฑุฏ ุงููุฌุงู B. ูููู ุฃู ูููู ูููู ุงููุฌุงู ูู ููุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃุดุฌุงุฑ ุงููุฌุงู </li><li style=";text-align:right;direction:rtl">  ุบุงุจุงุช ุงููุฌุงู. </li></ul><br><img src="https://habrastorage.org/webt/5w/zx/4c/5wzx4cfoai1nwiwk6rissbhy4cu.png"><br><br>  ุนูุฏ ุฅูุดุงุก ุดุฌุฑุฉ ุงููุฌุงูุงุช ุจูู ุงููุฌุงูุงุช ุ ูุชู ุชุฃุณูุณ ุนูุงูุงุช ุซูุฉ ูุชุนุฏูุฉ ุจุดูู ุงูุชุฑุงุถู.  ุฌููุน ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ูุดุชุฑูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชุงููุฌ ุนุงููู </li><li style=";text-align:right;direction:rtl">  ูุณุงุญุฉ ุงูุงุณู. </li><li style=";text-align:right;direction:rtl">  ุงููุฎุทุท. </li></ul><br>  ูููู ุฏูุฌ ุฃุดุฌุงุฑ ุงููุฌุงู ูู ุงูุบุงุจุงุช.  ุนูุฏ ุฅูุดุงุก ูุฌููุนุฉ ุชูุฑุนุงุช ูุฌุงู ุ ูุชู ุฅูุดุงุก ุนูุงูุงุช ุซูุฉ ูุชุนุฏูุฉ ุ ูุชุชุดุงุฑู ุฌููุน ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ูู ุงููุฌููุนุฉ ูู ูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชุงููุฌ ุนุงููู </li><li style=";text-align:right;direction:rtl">  ุงููุฎุทุท. </li></ul><br>  ููุถุญ ุงูุฌุฏูู ุฃุฏูุงู ุฃููุงุน ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช ูุฎุตุงุฆุตูุง. <br><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุนุฏุฏ </td><td>  ููุน ุงูุซูุฉ </td><td>  Transitivity </td><td>  ุงุชุฌุงู </td><td>  ุขููุฉ ุงููุตุงุฏูุฉ </td><td>  ูุตู </td></tr><tr><td>  1 </td><td>  ุฎุงุฑุฌู </td><td>  ุบูุฑ ูุชุนุฏูุฉ </td><td>  ูู ุงุชุฌุงู ูุงุญุฏ ุฃู ูู ุงุชุฌุงููู </td><td>  NTLM ููุท </td><td>  ูุชู ุชุซุจูุชูุง ุจูู ุงููุฌุงูุงุช ุงูุชู ุชูุชูู ุฅูู ุบุงุจุงุช ูุฎุชููุฉ ุ ุฃู ูุน ูุฌุงู Windows NT 4.0. </td></tr><tr><td>  2 </td><td>  ููููุฉ </td><td>  ูุชุนุฏูุฉ ุฃู ุบูุฑ ูุชุนุฏูุฉ </td><td>  ูู ุงุชุฌุงู ูุงุญุฏ ุฃู ูู ุงุชุฌุงููู </td><td>  Kerberos ููุท </td><td>  ูุซุจุชุฉ ุจูู ูุฌุงูุงุช Windows ูุบูุฑ Windows ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู Kerberos.  ูููู ุงุณุชุฎุฏุงู ูุฐุง ุงูููุน ูู ุงูุซูุฉ ูุชูููุฑ ูุตุงุฏูุฉ ุดุงููุฉ ุนูู ุฃูุธูุฉ Windows ู UNIX. </td></tr><tr><td>  3 </td><td>  ุบุงุจุฉ </td><td>  ูุชุนุฏ </td><td>  ูู ุงุชุฌุงู ูุงุญุฏ ุฃู ูู ุงุชุฌุงููู </td><td>  Kerberos ุฃู NTLM </td><td>  ุชุนููู ุจูู ุงูุบุงุจุงุช.  ูู ุงูููุช ููุณู ุ ููุฑุฑ ุงููุณุคูููู ุจุฃููุณูู ูุง ุฅุฐุง ูุงูุช ุงูุนูุงูุฉ ุซูุงุฆูุฉ ุฃู ุฃุญุงุฏูุฉ ุงูุฌุงูุจ. </td></tr><tr><td>  4 </td><td> ุงูุงุฎุชุตุงุฑ </td><td>  ูุชุนุฏ </td><td>  ูู ุงุชุฌุงู ูุงุญุฏ ุฃู ูู ุงุชุฌุงููู </td><td>  Kerberos ุฃู NTLM </td><td>  ุชุนููู ุจูู ูุฌุงูุงุช ุงูุฃุดุฌุงุฑ ุงููุฎุชููุฉ ุงูุชู ุชูุชูู ุฅูู ููุณ ุงูุบุงุจุฉ.  ูุณุชุฎุฏู ูุชูููู ูุณุงุฑ ุงูุซูุฉ ุ ูุจุงูุชุงูู ุฒูุงุฏุฉ ููุงุกุฉ ุงูุชูุงุนู ุจูู ุงููุฌุงููู. </td></tr><tr><td>  5 </td><td>  ุจูู ุงููุงูุฏูู ูุงูุทูู </td><td>  ูุชุนุฏ </td><td>  ูู ุงุชุฌุงููู </td><td>  Kerberos ุฃู NTLM </td><td>  ูุชู ุชุซุจูุชูุง ุชููุงุฆููุง ุนูุฏ ุฅูุดุงุก ูุฌุงู ุฌุฏูุฏ ูู ุงูุดุฌุฑุฉ.  ุฏุงุฎู ุดุฌุฑุฉ ุงููุฌุงู ุ ูุชู ูุตู ุงูุนูุงูุงุช ุจูุงุณุทุฉ ูุฎุทุท ุงููุงูุฏูู ูุงูุทูู. </td></tr><tr><td>  6 </td><td>  ุงูุซูุฉ ุดุฌุฑุฉ ุงูุฌุฐุฑ </td><td>  ูุชุนุฏ </td><td>  ูู ุงุชุฌุงููู </td><td>  Kerberos ุฃู NTLM </td><td>  ูุชู ุงูุชุซุจูุช ุชููุงุฆููุง ุนูุฏ ุฅูุดุงุก ุดุฌุฑุฉ ูุฌุงู ุฌุฏูุฏุฉ ูู ูุฌููุนุฉ ุชูุฑุนุงุช ููุฌูุฏุฉ.  ูู ุงููุงูุน ุ ูุชู ุชุฃุณูุณ ุงูุซูุฉ ุจูู ูุฌุงู ุฌุฐุฑ ุงูุบุงุจุฉ ูุงููุฌุงู ุงูุฐู ุชู ุฅูุดุงุคู ุ ูุงูุฐู ุณูููู ูู ุงูุฌุฐุฑ ููุดุฌุฑุฉ ุงูุฌุฏูุฏุฉ. </td></tr></tbody></table></div><br>  ุจุดูู ุฃูุซุฑ ูุถูุญูุง ุ ูุชู ุชูุถูุญ ุฃููุงุน ุนูุงูุงุช ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช ูู ุงูุตูุฑุฉ ุฃุฏูุงู. <br><br><img src="https://habrastorage.org/webt/jp/mc/eo/jpmceokjm7kwra_mhgfrw3n8tc0.png"><br><br><h4 style=";text-align:right;direction:rtl">  Transitivity (Transitivity) </h4><br>  ููุงู ุญุงุฌุฉ ุฅูู ุงูููููุฉ ูุชุญุฏูุฏ ุงูุซูุฉ ุฎุงุฑุฌ ุงููุฌุงููู ุงููุฐูู ุชู ุชุดูููููุง ุจููููุง ุ ููุณุชุฎุฏู ูุชูุณูุน ุนูุงูุงุช ุงูุซูุฉ ูุน ุงููุฌุงูุงุช ุงูุฃุฎุฑู.  ุฅุฐุง ุฃุถููุง ูุฌุงููุง ุชุงุจุนูุง ุฅูู ุงููุฌุงู ุ ูุณูุชู ุฅูุดุงุก ุนูุงูุฉ ุซูุฉ ุซูุงุฆูุฉ ุงูุงุชุฌุงู ุจูู ุงููุฌุงููู ุงูุฃุตูููู ูุงููุฌุงู ุงููุฑุนู.  ูุฐู ุงูุนูุงูุงุช ูุชุนุฏูุฏุฉ ุ ุฃู  ุฅุฐุง ูุงู ุงููุฌุงู A ูุซู ูู ุงููุฌุงู D ูุงููุฌุงู D ูุซู ูู ุงููุฌุงู E ุ ูุฅู ุงููุฌุงู A ูุซู ูู ุงููุฌุงู E. <br><br><img src="https://habrastorage.org/webt/xv/wb/wf/xvwbwfp8-uopt2k_bmlk5y0onci.png"><br><br>  ูููู ุงุณุชุฎุฏุงู ุงูุซูุฉ ุบูุฑ ุงูุชุจุงุฏููุฉ ูุฑูุถ ุงูุซูุฉ ูุน ุงููุฌุงูุงุช ุงูุฃุฎุฑู. <br><br><h4 style=";text-align:right;direction:rtl">  ุงูุงุชุฌุงู (ุงุชุฌุงู) </h4><br>  ูุณุงุฑ ุนูุงูุฉ ุงูุซูุฉ ูู ุณูุณูุฉ ูู ุนูุงูุงุช ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช ุงูุชู ูุฌุจ ุชููู ุทูุจุงุช ุงููุตุงุฏูุฉ ุนูููุง.  ุจูุนูู ุขุฎุฑ ุ ูุจู ูุตุงุฏูุฉ ูุณุชุฎุฏู ุ ูุชู ุชุญุฏูุฏ ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช.  ุจุงููุณุจุฉ ููุณุชุฎุฏูู ุงููุฌุงู A ูููุตูู ุฅูู ููุงุฑุฏ ุงููุฌุงู D ุ ูุฌุจ ุฃู ูุซู ุงููุฌุงู D ูู ุงููุฌุงู A. <br><br>  ุงุชุฌุงู ุงูุซูุฉ ูู ูู ููุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงุญุฏ ูู ุฌุงูุจ ู. </li><li style=";text-align:right;direction:rtl">  ุซูุงุฆูุฉ. </li></ul><br>  ุงูุซูุฉ ุฃุญุงุฏูุฉ ุงูุงุชุฌุงู ูู ูุณุงุฑ ูุตุงุฏูุฉ ุฃุญุงุฏูุฉ ุงูุงุชุฌุงู ูุชู ุฅูุดุงุคู ุจูู ูุฌุงููู.  ูู ุงูุซูุฉ ุฃุญุงุฏูุฉ ุงูุงุชุฌุงู ุจูู ุงููุฌุงู A ูุงููุฌุงู B ุ ูููู ูููุณุชุฎุฏููู ูู ุงููุฌุงู B ุงููุตูู ุฅูู ุงูููุงุฑุฏ ูู ุงููุฌุงู A. ููุน ุฐูู ุ ูุง ูุชูุชุน ุงููุณุชุฎุฏููู ูู ุงููุฌุงู A ุจุงููุตูู ุฅูู ุงูููุงุฑุฏ ูู ุงููุฌุงู B. ูุฐุง ุงูููุน ูู ุงูุซูุฉ ููุณ ูุชุนุฏูุฉ. <br><br>  ุงูุซูุฉ ุงูุซูุงุฆูุฉ ูู ูุฒูุฌ ูู ุนูุงูุงุช ุงูุซูุฉ ุฃุญุงุฏูุฉ ุงูุงุชุฌุงู.  ูู ุงูุซูุฉ ุซูุงุฆูุฉ ุงูุงุชุฌุงู ุจูู ุงููุฌุงููู A ู B ุ ูููู ููุณุชุฎุฏูููุง ุงููุตูู ุฅูู ููุงุฑุฏ ููุง ุงููุฌุงููู.  ูุฐุง ุงูููุน ูู ุงูุซูุฉ ูุชุนุฏูุฉ. <br><br>  ุงุชุฌุงู ุงูุซูุฉ ูู ุนูุณ ุงุชุฌุงู ุงููุตูู ุฏุงุฆููุง.  ูุฎุทุท ูุงููุฑูุณููุช ุงูุชูุซููู ุฃุฏูุงู: <br><img src="https://habrastorage.org/webt/r2/d6/jo/r2d6jope8ji-ivoblptob-s5y94.png"><br>  ุงุฑุชุจุงุทุงุช ููุฒูุฏ ูู ุฃููุงุน ุงูุซูุฉ ุงููุชุนููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุซูุฉ ุงูุฎุงุฑุฌูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุบุงุจุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุงุฎุชุตุงุฑ</a> </li></ul><br><h4 style=";text-align:right;direction:rtl">  Kerberos ุจูู ุงููุฌุงูุงุช ุงูููุซููุฉ </h4><br>  ุงููุธุฑ ูู ูุซุงู.  ุงูุนููู ูุญุงูู ุงููุตูู ุฅูู ุฎุงุฏู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ุงูููุงุท ูู 1 ุฅูู 3 ุ ุชุญุฏุซ ุงูุฅุฌุฑุงุกุงุช ุงูููุงุณูุฉ ุนูุฏ ุงุณุชุฎุฏุงู ุจุฑูุชูููู Kerberos.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุชุญููู ูููุฉ ุงููุฑูุฑ ุฅูู ุชุฌุฒุฆุฉ NTLM ุ ูุชู ุชุดููุฑ ุงูุทุงุจุน ุงูุฒููู ูุน ุนูุงูุฉ ุชุฌุฒุฆุฉ ูุฅุฑุณุงููุง ุฅูู KDC ููุตุฏู ูู ุทูุจ ุชุฐูุฑุฉ TGT (AS-REQ).  ุชุชุญูู ูุญุฏุฉ ุชุญูู ุงููุฌุงู (KDC) ูู ูุนูููุงุช ุงููุณุชุฎุฏู ูุชููู ุจุฅูุดุงุก ุจุทุงูุฉ TGT. </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุดููุฑ ุจุทุงูุฉ TGT ูุชูููุนูุง ูุฅุฑุณุงููุง ุฅูู ุงููุณุชุฎุฏู (AS-REP).  ูููู ููุท ูุฎุฏูุฉ Kerberos (KRBTGT) ูุชุญ ุงูุจูุงูุงุช ููุฑุงุกุชูุง ูู ุชุฐูุฑุฉ TGT. </li><li style=";text-align:right;direction:rtl">  ูููู ุงููุณุชุฎุฏู ุจุฅุฑุณุงู ุชุฐูุฑุฉ TGT ุฅูู ูุญุฏุฉ ุชุญูู ูุฌุงู ุนูุฏ ุทูุจ ุจุทุงูุฉ TGS (TGS-REQ).  ูุญุฏุฉ ุชุญูู ุงููุฌุงู ุชูุชุญ ุชุฐูุฑุฉ TGT ูุชุชุญูู ูู ุงููุฌููุน ุงูุงุฎุชุจุงุฑู ูู PAC. </li></ul><br></div></div><br>  ุชุจุฏุฃ ุงูุชุบููุฑุงุช ูู ุงูููุทุฉ 4: ุชุธูุฑ ุจุทุงูุฉ TGT ุจูู ุงููุทุงูุงุช ุ ูุง ูุณูู ุชุฐูุฑุฉ ุงูุฅุญุงูุฉ ุ ูุงูุชู ูุชู ุชุดููุฑูุง / ุชูููุนูุง ุจุงุณุชุฎุฏุงู ููุชุงุญ interm ูุฌุงู ุชู ุฅูุดุงุคู ูู ูููุฉ ูุฑูุฑ ููุซูู ุจูุง.  ูุชู ุชุนููู ูููุฉ ูุฑูุฑ ููุซููุฉ ุนูุฏ ุฅูุดุงุก ุงูุซูุฉ ููุนุฑููุฉ ูุฏู ูู ูู ูุญุฏุงุช ุงูุชุญูู ุจุงููุฌุงู.  ุจุงุณุชุฎุฏุงู ุชุฐูุฑุฉ TGT ุจูู ุงููุทุงูุงุช ุ ูููู ููุณุชุฎุฏู ุงููุฌุงู 1 ุทูุจ ุชุฐูุฑุฉ TGS ูููุตูู ุฅูู ููุงุฑุฏ ุงููุฌุงู 2. <br><br><img src="https://habrastorage.org/webt/s4/3v/hj/s43vhjcgbdqvzebpjmra7d2cr_g.png"><br><br><h4 style=";text-align:right;direction:rtl">  NTLM ุจูู ุงููุฌุงูุงุช ุงูููุซููุฉ </h4><br><img src="https://habrastorage.org/webt/v2/2c/x4/v22cx4pt6iw7mlgxrlus2t3xdqs.png"><br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฑุณู ุงูุนููู ุทูุจ ุงููุตุงุฏูุฉ ูุจุงุดุฑุฉ ุฅูู ุงูููุฑุฏ ููุณู ุ ุงูููุฌูุฏ ูู ูุฌุงู ุขุฎุฑ ุ ูุงูุฐู ูุฑูุฏ ุงููุตูู ุฅููู. </li><li style=";text-align:right;direction:rtl">  ูุณุชูุจู ุงูุฎุงุฏู ุทูุจูุง ูู ุงูุนููู ููุฑุณู ุฅููู ุฑุฏูุง CHALLENGE_MESSAGE ุ ูุงูุฐู ูุญุชูู ุนูู ุชุณูุณู ุนุดูุงุฆู ูู 8 ุจุงูุช.  ูุทูู ุนููู ุชุญุฏู Server. </li><li style=";text-align:right;direction:rtl">  ูููู ุงูุนููู ุ ุจุนุฏ ุชูููู ุชุณูุณู Server Challenge ูู ุงูุฎุงุฏู ุ ุจุชุดููุฑ ูุฐุง ุงูุชุณูุณู ุจูููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจู ุ ุซู ูุฑุณู ุฅูู ุงูุฎุงุฏู ุงุณุชุฌุงุจุฉ ุชุญุชูู ุนูู 24 ุจุงูุช. </li><li style=";text-align:right;direction:rtl">  ูุฑุณู ุงูุฎุงุฏู ุทูุจูุง ูุงุณุชุฌุงุจุฉ ููุญุฏุฉ ุงูุชุญูู ูู ุงููุฌุงู ุจ. </li><li style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุงููุตุงุฏูุฉ ุจูู ุงูุตูุงุฏูู ุ ูุชู ุชูููุฐ ุงูููุทู ุงูุชุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุต ุนูุงูุงุช ุงูุซูุฉ ุงูุงุชุฌุงู. <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุฅุฑุณุงู ุจูุงูุงุช ุงุนุชูุงุฏ ุงูุนููู ุฅูู ุงููุฌุงู ุฃ ูููุตุงุฏูุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ุชูู ููุงู ุนูุงูุฉ ุซูุฉ ุ ูุชู ุงูุชุญูู ูู ุงูุงูุชูุงุฆูุฉ ุจุงุณุชุฎุฏุงู ุงููุฌุงู ุฃ. </li></ul><br></li><li style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุงูุนุจูุฑ ุจูู ุงููุฌุงูุงุช <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ูุฌูุฏ ุนุจูุฑ ุจูู ุงููุฌุงูุงุช ุ ูุชู ุฅุฑุณุงู ุทูุจ ุงููุตุงุฏูุฉ ุฅูู ุงููุฌุงู ุงูุชุงูู ูู ูุณุงุฑ ุงูุซูุฉ.  ุชูุฑุฑ ูุญุฏุฉ ุงูุชุญูู ุจุงููุฌุงู ูุฐู ุงูุนูููุฉ ุ ูุงูุชุญูู ูู ุจูุงูุงุช ุงุนุชูุงุฏ ุงููุณุชุฎุฏู ููุงุจู ูุงุนุฏุฉ ุจูุงูุงุชู ุงูุฎุงุตุฉ ุจุญุณุงุจุงุช ุงูุฃูุงู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููู ููุงู ููู ุ ูุชู ุฅุฑุฌุงุน ุฑุณุงูุฉ ุชู ุฑูุถ ุงููุตูู ุฅูู ุงูุนููู. </li></ul><br></li></ul><br>  6-8.  ุงูุฌูุงุจ ูุน ุงููุฑุงุฑ ุจุดุฃู ูุตุงุฏูุฉ ุงูุนููู. <br><br><h1 style=";text-align:right;direction:rtl">  ุงููุฌูุงุช ุจูู ุงูุซูุฉ ุจูู ุงููุฌุงูุงุช </h1><br>  ูุฐูู ุ ูุฅุฌุฑุงุก ูุฌูู ุ ูุญุชุงุฌ ุฅูู ูุนูููุงุช ุญูู ุงูุซูุฉ ูู ุงูุนูุงูุงุช ูู ูุฌุงููุง. <br><br><h4 style=";text-align:right;direction:rtl">  ูุงุฆูุฉ ุงูุตูุงุฏูู </h4><br>  ููุงู 3 ุทุฑู ุฑุฆูุณูุฉ ูุฅุฏุฑุงุฌ ููุงุฆู ุงูุซูุฉ ูู ูุฌุงู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุฎูุงู Win32 API ุ </li><li style=";text-align:right;direction:rtl">  ุนุจุฑ ุทุฑู .NET. </li><li style=";text-align:right;direction:rtl">  ูู ุฎูุงู LDAP. </li></ol><br>  <b><i>Win32 API</i></b> <br><br>  ูุชู ุชูููุฐ ุงูุชุนุฏุงุฏ ุนู ุทุฑูู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DsEnumerateDomainTrusts</a> ุ ูุงูุชู ุชูุฑุฌุน ุงูุจููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DS_DOMAIN_TRUSTSA</a> .  ุจุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ ุ ูุชู ุฅุฑุฌุงุน SID ู GUID ูููุฌุงู ุงููุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุฃุนูุงู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุณูุงุช ุงูุชู</a> ุชููุฒ ุงูุซูุฉ ุงูุญุงููุฉ ูู ุงููุฌุงู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุฃุนูุงู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  DS_DOMAIN_DIRECT_INBOUND </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูุชู ุชุซู ูุจุงุดุฑุฉ ูู ุงููุฌุงู ุงูุฐู ูุฏูู ุงุณู ุงูุฎุงุฏู ูุนุถู. </td></tr><tr><td>  DS_DOMAIN_DIRECT_OUTBOUND </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูููุซูู ุจูุง ูุจุงุดุฑุฉ ูู ูุจู ุงููุฌุงู ุงูุฐู ูุฏูู ServerName ูุนุถู. </td></tr><tr><td>  DS_DOMAIN_IN_FOREST </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูุชู ูู ุนุถู ูู ููุณ ุงููุฌุงู ุงูุฃู ุงูุฐู ูุญุชูู ุนูู ServerName ูุนุถู. </td></tr><tr><td>  DS_DOMAIN_NATIVE_MODE </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูุชู ูุนูู ูููุง ุงููุฌุงู ุงูุฃุณุงุณู ูู ุงููุถุน ุงูุฃุตูู ููุธุงู ุงูุชุดุบูู Windows 2000. </td></tr><tr><td>  DS_DOMAIN_PRIMARY </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูุชู ูู ุงููุฌุงู ุงูุฃุณุงุณู ูููุฌุงู ุงูุฐู ูุญุชูู ุนูู ServerName ูุนุถู. </td></tr><tr><td>  DS_DOMAIN_TREE_ROOT </td><td>  ุชุนุฏุงุฏ ุงููุฌุงูุงุช ุงูููุฌูุฏุฉ ูู ุฌุฐุฑ ูุฌููุนุฉ ุงูุชูุฑุนุงุช ูุงูุชู ููุง ุงุณู ุงูุฎุงุฏู ูุนุถู. </td></tr></tbody></table></div><br></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุณูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><br><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  TRUST_ATTRIBUTE_NON_TRANSITIVE </td><td>  ุนุฏู ุงูุณูุงุญ ุจุงูููู. </td></tr><tr><td>  TRUST_ATTRIBUTE_UPLEVEL_ONLY </td><td>  ุงุฑุชุจุงุท ุงูุซูุฉ ุบูุฑ ุตุงูุญ ูุฃูุธูุฉ ุชุดุบูู ุงูุนููู ุงูุฃูุฏู ูู Windows 2000. </td></tr><tr><td>  TRUST_ATTRIBUTE_FILTER_SIDS </td><td>  ูุฌุงูุงุช ุงูุญุฌุฑ ุงูุตุญู. </td></tr><tr><td>  TRUST_ATTRIBUTE_FOREST_TRANSITIVE </td><td>  ูุฏ ูุญุชูู ุฑุงุจุท ุงูุซูุฉ ุนูู ูุนูููุงุช ุซูุฉ ุงููุฌููุนุฉ. </td></tr><tr><td>  TRUST_ATTRIBUTE_CROSS_ORGANIZATION </td><td>  ูุฐู ุงูุซูุฉ ุฅูู ูุฌุงู / ูุฌููุนุฉ ุชูุฑุนุงุช ููุณุช ุฌุฒุกูุง ูู ูุฐุง ุงููุดุฑูุน. </td></tr><tr><td>  TRUST_ATTRIBUTE_TREAT_AS_EXTERNAL </td><td>  ูุชู ุงูุชุนุงูู ูุน ุงูุซูุฉ ุนูู ุฃููุง ุฎุงุฑุฌูุฉ ูุฃุบุฑุงุถ ุญุฏูุฏ ุงูุซูุฉ. </td></tr><tr><td>  TRUST_ATTRIBUTE_WITHIN_FOREST </td><td>  ุงูุซูุฉ ุฏุงุฎููุฉ ููุฐู ุงูุบุงุจุฉ. </td></tr></tbody></table></div><br></div></div><br>  ูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BloodHound</a> ุจุฌูุน ุงููุนูููุงุช ุจุงุณุชุฎุฏุงู ุทุฑููุฉ Win32 API. <br><br><img src="https://habrastorage.org/webt/d4/hq/df/d4hqdf50vvyi6k4b2bv6dbcnekw.png"><br><br>  <b><i>ุตุงูู</i></b> <br><br>  ูุชู ุงุณุชุฎุฏุงู ุงูุฃุณููุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GetCurrentDomain</a> ูู ูุณุงุญุฉ ุงูุงุณู [System.DirectoryServices.ActiveDirectory.Domain] ุ ูุงูุชู ุชูุฑุฌุน ูุซูู ูุฆุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">System.DirectoryServices.ActiveDirectory.Domain</a> .  ุชุทุจู ูุฐู ุงููุฆุฉ ุทุฑููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GetAllTrustRelationships</a> ุ ูุงูุชู ุชูุฑุฌุน ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูุงูุงุช</a> ุงูุซูุฉ ูููุฌุงู ุงูุญุงูู. <br><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</code> </pre> <br>  ุจุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ ูุชู ุชุทุจููู ูู ุงููุญุฏุฉ ุงูููุทูุฉ Get-DomainTrust ูู <a href="">PowerView</a> . <br><br><img src="https://habrastorage.org/webt/bv/px/vf/bvpxvf6de-v4o3f04sp5mtrgdd0.png"><br><br>  ูุงุญุฏุฉ ูู ูุฒุงูุง ูุฐู ุงูุทุฑููุฉ ูู ุจุณุงุทุชูุง.  ุงููุนูููุงุช ุณููุฉ ุงููุฑุงุกุฉ ูุงูููู ุ ูููู ุญุฌููุง ุฃุตุบุฑ ุจูุซูุฑ ูู ุนูุฏ ุฅุฌุฑุงุก ุงูุชุนุฏุงุฏ ุจุทุฑู ุฃุฎุฑู. <br><br>  <b><i>LDAP</i></b> <br><br>  ูุชู ุชุฎุฒูู ูุนูููุงุช ุซูุฉ ุงููุฌุงู ูู "Active Directory" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฆู</a> ูุฆุฉ ูููุฆุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">trustDomain</a> . <br><br>  ูุซุงู ููุงุณุชุฎุฏุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">dsquery * -filter <span class="hljs-string"><span class="hljs-string">"(objectClass=trustedDomain)"</span></span> -attr *</code> </pre> <br><img src="https://habrastorage.org/webt/oa/xc/2x/oaxc2xunppmfjl7vpjztuudgm5e.png"><br><br>  ูุณุชุฎุฏู <a href="">PowerView</a> ูุฐู ุงูุทุฑููุฉ ุงูุชุฑุงุถููุง. <br><br><img src="https://habrastorage.org/webt/cx/p1/_w/cxp1_w24rxlh7-naqk5swez6vc4.png"><br><br>  ูุน ูุนูููุงุช ุญูู ุงููุฌุงูุงุช ูุฃููุงุน ุงูุซูุฉ ุ ููููู ุงูุงูุชูุงู ูุจุงุดุฑุฉ ุฅูู ุงููุฌูู ููุณู.  ุงููุธุฑ ูู 2 ุงูุฎูุงุฑุงุช: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุฏ ูุฌุญูุง ูู ุงุฎุชุฑุงู ุงููุฌุงู ุ ููุฏููุง ุญููู ูุณุคูู ุงููุฌุงู. </li><li style=";text-align:right;direction:rtl">  ููุณ ูุฏููุง ุญููู ูุณุคูู ุงููุฌุงู. </li></ol><br><h2 style=";text-align:right;direction:rtl">  ูุน ุญููู ุงููุณุคูู ุฅูู ูุงุญุฏุฉ ูู ุงููุฌุงูุงุช </h2><br>  ุจูุงุกู ุนูู ุงููุฌุงู ุงูุฐู ุชู ุงุฎุชุฑุงูู ุ ูููู ุชูููุฒ ุนุฏุฉ ูุชุฌูุงุช ูุฌูููุฉ: <br><br><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุนุฏุฏ </td><td>  ุจุฏุก ุงููุฌุงู  ูููู ุงูููุงุฌู </td><td>  ูุทุงู ุงููุฌูู </td><td>  ุชูููุฉ ุงููุฌูู </td><td>  ุนูุงูุฉ ุงูุซูุฉ </td></tr><tr><td>  1 </td><td>  ุฌุฐุฑ </td><td>  ุทูู </td><td>  Golden Ticket + Enterprise Admin Group </td><td>  ุนุงูู ุจูู (ุงุชุฌุงููู) </td></tr><tr><td>  2 </td><td>  ุทูู </td><td>  ุทูู </td><td>  SID ุนูููุฉ ุงูุชุงุฑูุฎ </td><td>  ุจูู ุงููุงูุฏ ูุงูุทูู ุจูู ุงููุงูุฏูู (ูู ุงุชุฌุงููู) </td></tr><tr><td>  3 </td><td>  ุทูู </td><td>  ุฌุฐุฑ </td><td>  SID ุนูููุฉ ุงูุชุงุฑูุฎ <br>  ุงูุซูุฉ ุนูููุฉ ุงูุชุฐุงูุฑ </td><td>  ุนุงูู-ุดุฌุฑุฉ-ุงูุฌุฐุฑ (ุงุชุฌุงููู) </td></tr><tr><td>  4 </td><td>  ุงูุบุงุจุฉ 1 </td><td>  ุงูุบุงุจุฉ 2 </td><td>  ุนูุฉ ุงูุทุงุจุนุฉ </td><td>  ุงูุบุงุจุงุช ุจูู ุงููุฌุงูุงุช ุฃู ุงูุซูุฉ ุงูุฎุงุฑุฌูุฉ (ุงุชุฌุงูุงู) </td></tr></tbody></table></div><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ุฃุฌู ุงูุชูููุฐ ุงููุงุฌุญ ูุฌููุน ุงููุชุฌูุงุช ุ ูู ุงูุถุฑูุฑู ูุฌูุฏ ุซูุฉ ุซูุงุฆูุฉ ุจูู ุงููุฌุงูุงุช. <br><br><h4 style=";text-align:right;direction:rtl">  <i>1. ุนูููุฉ SID ุงูุชุงุฑูุฎ</i> </h4><br>  ุชู ุชูุฏูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญููุธุงุช SID</a> ูุชุณููู ุชุฑุญูู ุงููุณุชุฎุฏููู ูู ูุฌุงู ุฅูู ุขุฎุฑ.  ุชุญุชูู ุงูุณูุฉ ุนูู ูุงุฆูุงุช SID ุงูุณุงุจูุฉ.  ูู ูู ูุฑุฉ ููุชูู ูููุง ูุงุฆู ูู ูุฌุงู ุฅูู ุขุฎุฑ ุ ูุชู ุฅูุดุงุก SID ุฌุฏูุฏ ุ ูุตุจุญ ูุงุฆู SID.  ุชุชู ุฅุถุงูุฉ SID ุงูุณุงุจู ุฅูู ุงูุฎุงุตูุฉ sIDHistory. <br><br>  ุชุญุชูู ูู ูุฌููุนุฉ ุนูู ูุฌููุนุฉ ูุณุชุฎุฏู Enterprise Admins ููุฌูุฏุฉ ููุท ูู ูุฌุงู ุงูุฌุฐุฑ ููุฏููุง ุญููู ุงููุณุคูู ุงููุญูู ุนูู ูุญุฏุงุช ุชุญูู ุงููุฌุงู ูุฌููุน ุงููุฌุงูุงุช ุงูุชุงุจุนุฉ ูู ูุฌููุนุฉ ุงูุชูุฑุนุงุช.  ุธูุฑ ูุฐุง ุงููุฌูู ูุฃูู ูุฑุฉ ูู ููุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดูู ููุชูุงูู</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">BlackHat USA 2015</a> .  ุฌููุฑ ุงููุฌูู ูู ุฃููุง ูุตุฏุฑ ุชุฐูุฑุฉ ุฐูุจูุฉ ูุน ุฅุถุงูุฉ SID ุฅุถุงููุฉ ููุฌููุนุฉ Enterprise Admins.  ูุชู ุฐูู ุนู ุทุฑูู ุฅุถุงูุฉ ExtraSids ูู ุงูุจููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KERB_SID_AND_ATTRIBUTES</a> ุ ูุงูุชู ูุชู ุฅุฑุณุงููุง ูู ุงูุจููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KERB_VALIDATION_INFO</a> . <br><br><img src="https://habrastorage.org/webt/kl/hy/fj/klhyfjzath65qptysuylgzft-fk.png"><br><br>  ุงููุฌูู ุงูุชุฌุฑูุจู: <br><br><img src="https://habrastorage.org/webt/v6/ia/1g/v6ia1gvjk-sxs7x8plq6uvwojjk.gif"><br><br>  ูุญุชูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Impacket</a> ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑูุงูุฌ ูุตู ูููู</a> ุจุฃุชูุชุฉ ูู ูุฐุง. <br><br><h4 style=";text-align:right;direction:rtl">  <i>2. Golden Ticket + Enterprise Admin Group</i> </h4><br>  ุงูุชูุงู ุญููู ุงููุณุคูู ูู ูุฌุงู ุงูุฌุฐุฑ ุ ูููููุง ุฅูุดุงุก ุชุฐูุฑุฉ ุฐูุจูุฉ ุจุฅุถุงูุฉ ูุณุชุฎุฏู ุฅูู ูุฌููุนุฉ Enterprise Admins (519). <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Kerberos::golden /domain:&lt;domain&gt; /sid:&lt;domain_SID&gt; /krbtgt:&lt;ntlm_hash_krbtgt_user&gt; /user:&lt;user&gt; /groups:500,501,513,512,520,518,519 /ptt</code> </pre> <br>  ููุง ูู ููุถุญ ุฃุนูุงู ุ ูุฏู Enterprise Admin ุญููู ุงููุณุคูู ุงููุญูู ููุทุงูุงุช DC ุงูุชุงุจุนุฉ.  ูุจุงูุชุงูู ุ ุณูู ูููู ูุงุฏุฑูู ุนูู ุชุณููุฉ ุฌููุน ูุฌุงูุงุช ุงูุทูู ูู ุงูุบุงุจุฉ. <br><br><h4 style=";text-align:right;direction:rtl">  <i>3. ุชุดุบูู ุชุฐุงูุฑ ุงูุซูุฉ</i> </h4><br>  ูููุตูู ุฅูู ููุฑุฏ ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู Kerberos ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุจุทุงูุฉ TGS ุ ูุงูุชู ูุชู ุชุดููุฑูุง ุจุชุฌุฒุฆุฉ NTLM ููููุฉ ูุฑูุฑ ุญุณุงุจ ุงูุฎุฏูุฉ.  ูุญุฏุฉ ุชุญูู ุงููุฌุงู ุชุฎุฒู ููุท ุชุฌุฒุฆุงุช ูููุงุช ูุฑูุฑ ุงููุณุชุฎุฏู ุงูุฎุงุตุฉ ุจูุฌุงููุง ุ ูุฐูู ุนูุฏูุง ูุญุชุงุฌ ูุณุชุฎุฏู ูู ุงููุฌุงู A ุฅูู ุงููุตูู ุฅูู ููุฑุฏ ูู ุงููุฌุงู B ุ ูุชู ุงุณุชุฎุฏุงู ููุชุงุญ ุงููุฌุงู ุงููุดุชุฑู.  ูุชู ุฅูุดุงุก ูุฐุง ุงูููุชุงุญ ุนูู ุฃุณุงุณ ูููุฉ ูุฑูุฑ ููุซูู ุจูุง ุ ูุงูุชู ูุชู ุชุนููููุง ุนูุฏ ุฅูุดุงุก ุนูุงูุงุช ุซูุฉ ุจูู ุงููุฌุงูุงุช ูู ููุณ ุงููุฌุงู ุงูุฃู.  ูู ูุงุนุฏุฉ ุจูุงูุงุช ูููุฉ ุงููุฑูุฑ (NTDS.dit) ุนูู ูุญุฏุฉ ุชุญูู ุงููุฌุงู ุ ููููู ุงูุนุซูุฑ ุนูู ูุณุชุฎุฏููู ุจุนูุงูุฉ $ ูู ุงูููุงูุฉ.  ูุชู ุงุณุชุฎุฏุงู ูููุฉ ุงููุฑูุฑ ุงูุฎุงุตุฉ ุจูู ุฃูุถูุง ูุฅูุดุงุก ููุงุชูุญ ุจูู ุงููุฌุงููู.  ูุฅูุดุงุก ุชุฐูุฑุฉ TGT ุจูู ุงููุฌุงูุงุช ุ ูุญุชุงุฌ ุฅูู ูููุฉ ูุฑูุฑ ุชุฌุฒุฆุฉ ููุฐุง ุงูุญุณุงุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Kerberos::golden /user:&lt;user&gt; /domain:&lt;domain&gt; /sid:&lt;sid_domain&gt; /sids:&lt;extra_sid_entrprice_admin_group_from _another_domain&gt; /aes256:&lt;aes256_trust_user_password&gt; /service:krbtgt /target:&lt;target_domain&gt; /ptt</code> </pre> <br>  ุงููุฌูู ุงูุชุฌุฑูุจู: <br><br><img src="https://habrastorage.org/webt/fk/cv/ji/fkcvjizxaup946gngi9zsk6xqm8.gif"><br><br>  ุงููุฌูู ุฐู ุตูุฉ ุฎุงุตุฉ ุนูุฏูุง ูุงุญุธุช ุฎุฏูุฉ IS ูุฌูุฏ ุชูุฏูุฏ ูุบูุฑุช ูููุฉ ุงููุฑูุฑ krbtgt 2 ูุฑุงุช.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูููู ูุงุฏุฑูู ุนูู ุฅูุดุงุก ุชุฐุงูุฑ ุฐูุจูุฉ ุจุงุณุชุฎุฏุงู ูููุฉ ูุฑูุฑ ููุซูู ุจูุง ุจูู ุงููุฌุงูุงุช. <br><br><h4 style=";text-align:right;direction:rtl">  <i>4. ุนูุฉ ุงูุทุงุจุนุฉ</i> </h4><br>  ูุญุชูู ุจุฑูุชูููู ุงูุทุจุงุนุฉ ุนู ุจุนุฏ ูู Windows Print System (MS-RPRN) ุนูู ุชูููู ุงูุฃุณููุจ RpcRemoteFindFirstPrinterChangeNotification (Ex) ุงูุชุฑุงุถููุง ุ ููุง ูุชูุญ ูู ูุฑุถ ุงููุตุงุฏูุฉ ุนูู ุฃู ููุจููุชุฑ ูุดุบู ุฎุฏูุฉ Spooler ุนูู ุงููุถูู ุงููุญุฏุฏ ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู Kerberos ุฃู NTLM.  ูู ุญุงูุฉ c NTLM ุ ูููููุง ุชุดุบูู NTLM-relay ุ ุฃู ุงูุจุฏุก ูู ูุณุฑ ูููุฉ ูุฑูุฑ ุงูููุจููุชุฑ (ูู ูุชู ุงูุชุบูุจ ุนูููุง ุฃุจุฏูุง).  ูู ุญุงูุฉ Kerberos ุ ููุงู ุญุงุฌุฉ ุฅูู ุฌูุงุฒ ุฎุทุฑ ูุน ุชูููุถ ุบูุฑ ูุญุฏูุฏ.  ุซู ูููููุง ุงูุชูุงุท ุชุฐูุฑุฉ TGT ูุชุทููุฑ ูุฌูู. <br><br>  ุงููุฌูู ุงูุชุฌุฑูุจู: <br><br><img src="https://habrastorage.org/webt/3g/h9/gf/3gh9gfnx0b6k8hucav8zy964ap0.gif"><br><br>  ููุถุญ ุงูุดูู ุฃุฏูุงู ุงูุฎุทูุงุช ุงูููุถุญุฉ ูู ุงูููุฏูู. <br><br><img src="https://habrastorage.org/webt/cu/e0/0l/cue00l2_x_fdpsxj0vyalrvjscs.png"><br><br><h2 style=";text-align:right;direction:rtl">  ููุณ ูุฏููุง ุญููู ูุณุคูู ุงููุฌุงู </h2><br>  ููููุง ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ.  ุฃุนุทู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฑููุณ ุฌุงุฑุณูุง</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฑูุฑู</a> ุฌุฏูููุง ููุชุงุฒูุง ููุถุญ ุฎุตุงุฆุต ุงูุฃููุงุน ุงููุฎุชููุฉ ูู ุงููุฌููุนุงุช. <br><br><img src="https://habrastorage.org/webt/jz/5x/jc/jz5xjcruevdpcv_jnz1knoyh1oi.png"><br><br>  ูู ุงูููุฒุงุช ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู <a href="">ุฃูู ูุชู ูุณุฎ ูุฌููุนุงุช AD Domain Local ู AD Global ุจุฏูู ุฃุนุถุงุก ุงููุฌููุนุฉ ูู ุงููุชุงููุฌ ุงูุนูููู ุ ููุชู ูุณุฎ ูุฌููุนุงุช AD Universal ูุน ุงููุณุชุฎุฏููู.</a> <br><blockquote style=";text-align:right;direction:rtl">  ูุธุฑูุง ููุทุฑููุฉ ุงูุชู ูุชู ุจูุง ุชุนุฏุงุฏ ุงููุฌููุนุงุช ูู ุฎูุงู ุงููุชุงููุฌ ุงูุนูููู ุ ูููู ุฃู ุชุฎุชูู ูุชุงุฆุฌ ุงููุตูุฉ ุงูุฎูููุฉ [ุฃู ุฃู ุงูุจุญุซ memb ูุฏ ูุฎุชูู ุ ุงุนุชูุงุฏูุง ุนูู ูุง ุฅุฐุง ููุช ุชุจุญุซ ูู ุงููุชุงููุฌ ุงูุนูููู (ุงููููุฐ 3268) ุฃู ุงููุฌุงู (ุงููููุฐ 389) ุ ููุน ูุฌููุนุงุช ููุชูู ุฅูููุง ุงููุณุชุฎุฏู (ูุฌููุนุงุช ุนููููุฉ ููุงุจู ูุฌููุนุงุช ุงููุฌุงู ุงููุญููุฉ). </blockquote>  ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุญููู ูุณุคูู ุงููุฌุงู ุ ูููู ุจุชุนุฏุงุฏ ุงููุงุฆูุงุช.  ูุญู ููุชููู ุจู: <br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุณุชุฎุฏูู ูุฌุงู ุขุฎุฑ ูุฏููู ุญููู ุงููุณุคูู ุงููุญูู ุนูู ุงูุฃุฌูุฒุฉ ุงูููุฌูุฏุฉ ูู ูุทุงููุง. </li><li style=";text-align:right;direction:rtl">  ูุณุชุฎุฏููู ูู ูุฌุงูุงุช ุฃุฎุฑู ุฃุนุถุงุก ูู ูุฌููุนุงุช ูุฌุงู ุงููุณุชุฎุฏู.  ูุฌููุนุงุช ุชุญุชูู ุนูู ูุณุชุฎุฏููู ูู ูุฌุงู ุขุฎุฑ. </li><li style=";text-align:right;direction:rtl">  ูุฏูุฑู ุฏูุฑู ุฃุจุทุงู ุขุณูุง </li></ol><br><h4 style=";text-align:right;direction:rtl">  <i>1. ูุณุชุฎุฏูู ูุฌุงู ุขุฎุฑ ูุฏููู ุญููู ุงููุณุคูู ุงููุญูู ุนูู ุงูุฃุฌูุฒุฉ ูู ูุทุงููุง</i> </h4><br>  ุงุจุญุซ ุนู ูุณุชุฎุฏููู ูู ูุฌุงู ุขุฎุฑ ูู ุงููุณุคูููู ุงููุญูููู ุนูู ุงููุถูููู ูู ูุทุงููุง ูู BloodHound: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">MATCH (c:Computer) OPTIONAL MATCH p1 = (u1)-[:AdminTo]-&gt;(c) WHERE NOT u1.domain = c.domain WITH p1,c OPTIONAL MATCH p2 = (u2)-[:MemberOf*1..]-&gt;(:Group)-[:AdminTo]-&gt;(c) WHERE NOT u2.domain = c.domain RETURN p1,p2</code> </pre><br><img src="https://habrastorage.org/webt/07/2y/92/072y92dgtftil5yz9uvrgv8ui3a.png"><br><br>  ุงูููุงุฏุฉ ูู <a href="">PowerView</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Get-NetLocalGroupMember &lt;server&gt;</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  <i>2. ุงููุณุชุฎุฏููู ูู ุงููุฌุงูุงุช ุงูุฃุฎุฑู ุ ุงูุชู ุชุชุฃูู ูู ูุฌููุนุงุช ูุฌุงู ุงููุณุชุฎุฏู.</i>  <i>ูุฌููุนุงุช ุชุญุชูู ุนูู ูุณุชุฎุฏููู ูู ูุฌุงู ุขุฎุฑ</i> </h4><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ูุชู ูุณุฎ ุงููุณุชุฎุฏููู ุงูุฐูู ูู ุฃุนุถุงุก ูู ูุฌููุนุงุช Universal ููุท ุฅูู ุงููุดุฑุฉ ุงููุตูุฑุฉ ุงูุนููููุฉ.  ูุฅุธูุงุฑ ูุฐู ุงูููุฒุฉ ุ ุณูููู ุจุงุณุชุนูุงู ูุฌููุนุงุช ูู ุงููุชุงููุฌ ุงูุนูููู ุงูุชู ุชุญุชูู ุนูู ูุณุชุฎุฏู ูุงุญุฏ ุนูู ุงูุฃูู ูุทูุจ ldap ูุจุงุดุฑ ุฅูู ูุญุฏุฉ ุชุญูู ุงููุฌุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Get-DomainGroup -Properties name, grouptype, member, DistinguishedName -LDAPFilter <span class="hljs-string"><span class="hljs-string">'(member=*)'</span></span> -SearchBase <span class="hljs-string"><span class="hljs-string">"GC://jet.lab"</span></span></code> </pre> <br><img src="https://habrastorage.org/webt/vr/zv/sd/vrzvsdj1pez6rn-ndb4_zcklpdu.png"><br><br>  ุนูุฏ ุชูููุฐ ุงุณุชุนูุงู ุฅูู ุงููุชุงููุฌ ุงูุนูููู ุ ูุฑู ูุฌููุนุฉ Universal Group ูุงุญุฏุฉ ููุท ูุน ููุน AD Universal ูู ุงููุฌุงู one.jet.lab. <br><br>  ุฅุฐุง ูููุง ุจุชูููุฐ ุงุณุชุนูุงู LDAP ุงููุจุงุดุฑ ุนูู one.jet.lab ุ ูุณูุฑู ูุฌููุนุงุช ุฃุฎุฑู ูู ุงูููุน AD Domain local ู AD Global. <br><br><img src="https://habrastorage.org/webt/jf/3n/ku/jf3nkumv72dhsoyhb8kpqntq9ba.png"><br><br>  ูู ุงูููู ูุฑุงุนุงุฉ ุฐูู ุนูุฏ ุชุนุฏุงุฏ ุงููุณุชุฎุฏููู ูุงููุฌููุนุงุช. <br><br>  ุงูุฃูุงูุฑ ูู <a href="">PowerView</a> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Get-DomainForeignUser -Domain &lt;Domain&gt; Get-DomainForeignGroupMember -Domain &lt;Domain&gt;</code> </pre> <br><img src="https://habrastorage.org/webt/ia/no/24/iano24rfj4ldithcbqhapwts4uk.png"><br><br><img src="https://habrastorage.org/webt/zf/2n/f-/zf2nf-tutgsxrzz99pdp6199fw0.png"><br><br><h4 style=";text-align:right;direction:rtl">  <i>3. ุฑุคุณุงุก ุฏูุฑู ุฃุจุทุงู ุขุณูุง</i> </h4><br>  ูููู ุงููุตูู ุฅูู ูุงุตู ุฃูุงู ntSecurityDescriptor (https://docs.microsoft.com/en-us/windows/win32/adschema/a-ntsecuritydescriptor) ูุฌููุน ุงููุณุชุฎุฏููู ูู ุงููุฌุงูุงุช ุงูููุซููุฉ ููุชู ูุณุฎู ูู ุงููุชุงููุฌ ุงูุนูููู.  ูุจุงูุชุงูู ุ ูููููุง ุงูุงุณุชุนูุงู ุนู ุฌููุน DACLs ูุฌููุน ุงููุงุฆูุงุช ูู ูุฌุงูุงุช ุงูุซูุฉ ูุชุตููุฉ ุงููุณุชุฎุฏููู ูู ุงููุฌุงูุงุช ุงูุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Get-DomainObjectAcl -Domain jet.lab -ResolveGuids | ?{<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.SecurityIdentifier -like <span class="hljs-string"><span class="hljs-string">'SID_Domain*'</span></span>}</code> </pre> <br><img src="https://habrastorage.org/webt/fw/kn/si/fwknsimcsrubz0tputfddzosgr0.png"><br><br>  ูุฐูู ุ ุชูููุง ูู ุชุญุฏูุฏ ุงููุณุชุฎุฏู ูุงูู ูู ุงููุฌุงู forestc.lab ุ ุงูุฐู ูุงู ูุฏูู ุญููู ูููุฌููุนุฉ ุงูุนุงูููุฉ ูู ูุฌุงู jet.lab. <br><br>  ูุชู ุงุณุชุฎุฏุงู PS SID Filtering ูุงููุตุงุฏูุฉ ุงูุงูุชูุงุฆูุฉ ููุญูุงูุฉ ุจูู ุงูุบุงุจุงุช.  ุฃุฏู ุงููุฌูู ุจูู ุงูุบุงุจุงุช ุจุงุณุชุฎุฏุงู SID Filtering ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููู dirkjan</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏููุชู</a> .  ุฃูุถูุง ูู 9 ููููู ุ ุฃุตุฏุฑุช Microsoft <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญุฏูุซูุง</a> ูุนุทู ุชูููุถ TGT ุจูู ุงูุบุงุจุงุช ุงูุชุฑุงุถููุง.  ุงูุขู ูู ุดูุก ุ ุงููุตุฉ ูุน ุชูููุถ ุบูุฑ ูุญุฏูุฏ ูุงูุชุณููุฉ ูู ุบุงุจุฉ ูุงุญุฏุฉ ูู ุฃุฎุฑู ุจุงุณุชุฎุฏุงู ุจุฑูุชูููู Kerberos ูู ูุนุฏ ูุนูู. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar466445/">https://habr.com/ru/post/ar466445/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar466435/index.html">ุชุฏุฑูุจ Cisco 200-125 CCNA v3.0. ุงูููู 42. Inter-VLAN Routing and SVI</a></li>
<li><a href="../ar466437/index.html">ุชุฏุฑูุจ Cisco 200-125 CCNA v3.0. ููู 43. ุจุฑูุชููููุงุช ุงูุชูุฌูู ูุชุฌู ุงููุณุงูุงุช ูุญุงูุฉ ุงูุงุฑุชุจุงุท</a></li>
<li><a href="../ar466439/index.html">ุชุญูู ูู ููุณู: ูู ุนุฏุฏ ุงูุฃุณุฆูุฉ ุงูุชู ููููู ุงูุฅุฌุงุจุฉ ุนูู ChGKุ</a></li>
<li><a href="../ar466441/index.html">Python buggy code: 10 ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ุงูุชู ูุฑุชูุจูุง ูุทูุฑู ุงูุจุฑุงูุฌ</a></li>
<li><a href="../ar466443/index.html">ShIoTiny ูุงูุนุงูู: ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุชูุซูููุฉ ุฃู ADC ููุฃุตุบุฑ</a></li>
<li><a href="../ar466447/index.html">ูุงุฐุง ูุฌุจ ุฃู ูุจูู ุดุจูุฉ CDNุ</a></li>
<li><a href="../ar466449/index.html">ุชุฏุฑูุจ Cisco 200-125 CCNA v3.0. ููู 44. ููุฏูุฉ ู OSPF</a></li>
<li><a href="../ar466451/index.html">Read_You ูุง ูููู_ุฑูู</a></li>
<li><a href="../ar466453/index.html">ุชุฏุฑูุจ Cisco 200-125 CCNA v3.0. ููู 45. ุชูููู OSPF</a></li>
<li><a href="../ar466455/index.html">ุงูุฎุฏูุงุช ุ ูุงูุฎุฏูุงุช ุงูุฏูููุฉ ูุงูุจุฑูุฌุฉ ุงูููุฌูุฉ ูุญู ุงูุฏูุนุงุช</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>