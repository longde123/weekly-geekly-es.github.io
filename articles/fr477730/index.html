<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìø ü§¶üèæ ü§∂üèΩ ChipWhisperer: Attaque d'√©nergie contre Magma ‚ÜïÔ∏è üöê üöò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Post√© par rakf 





 Dans le cadre du Summer of Hack 2019 √† Digital Security, j'ai fait face √† une attaque de puissance et j'ai travaill√© avec ChipWh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ChipWhisperer: Attaque d'√©nergie contre Magma</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/"><p>  Post√© par <a href="https://habr.com/ru/users/rakf/" class="user_link">rakf</a> </p><br><p><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br><p>  Dans le cadre du Summer of Hack 2019 √† Digital Security, j'ai fait face √† une attaque de puissance et j'ai travaill√© avec ChipWhisperer. </p><br><h2 id="chto-eto">  Qu'est ce que c'est </h2><br><p>  L'analyse d'√©nergie est un type d'attaque via des canaux tiers.  Autrement dit, les attaques qui utilisent des informations qui apparaissent √† la suite de la mise en ≈ìuvre physique du syst√®me. </p><br><p>  Quelles informations peuvent √™tre utiles √† un attaquant: </p><br><ul><li>  temps de conversion cryptographique; </li><li>  la consommation d'√©nergie; </li><li>  champs √©lectromagn√©tiques; </li><li>  bruit etc. </li></ul><br><p>  Une attaque √©nerg√©tique est consid√©r√©e comme la plus universelle. </p><a name="habracut"></a><br><h2 id="pochemu-rabotaet">  Pourquoi √ßa marche? </h2><br><p>  Les microprocesseurs, microcontr√¥leurs, RAM et de nombreux autres circuits logiques sont bas√©s sur la technologie CMOS.  La consommation d'√©nergie des circuits CMOS se compose de deux composants: statique et dynamique.  La consommation d'√©lectricit√© statique est tr√®s faible, ce qui est l'une des raisons de la monopolisation de la technologie.  La puissance dynamique est due √† la commutation des transistors et d√©pend des donn√©es trait√©es et des op√©rations effectu√©es.  √âtant donn√© que la composante statique est principalement constante, la variation de la puissance totale est due exclusivement √† la puissance dynamique et, par cons√©quent, la consommation totale d'√©nergie peut √™tre utilis√©e pour l'analyse. </p><br><h2 id="instrumentariy">  Bo√Æte √† outils </h2><br><p>  <a href="https://newae.com/tools/chipwhisperer/">ChipWhisperer</a> , j'ai utilis√© la version en 2 parties: </p><br><p><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="Version en 2 parties ChipWhisperer"></p><br><p>  ChipWhisperer est une bo√Æte √† outils open source pour rechercher la s√©curit√© des appareils embarqu√©s.  Il permet l'analyse d'√©nergie et les attaques bas√©es sur les erreurs. </p><br><p>  Les frais co√ªteront 250 $.  Les d√©veloppeurs la positionnent comme une solution r√©volutionnaire, car de tels complexes, selon les cr√©ateurs, co√ªtent 30 000 $.  L'appareil se compose de 2 cartes: la cible et la carte de capture. </p><br><p>  Il existe d'autres versions, avec leurs avantages (mais aussi √† un co√ªt √©lev√©), vous pouvez √©galement acheter s√©par√©ment diff√©rentes cartes cibles, cartes d'extension, sonde pour une analyse compl√®te de vos appareils et utiliser ChipWhisperer uniquement pour le retrait. </p><br><p>  ChipWhisperer a un excellent <a href="https://wiki.newae.com/Main_Page">wiki</a> , de petits <a href="https://chipwhisperer.readthedocs.io/en/latest/tutorials.html">laboratoires de</a> d√©veloppement, et par la 5√®me version, ils ont m√™me fait une bonne <a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">documentation</a> API.  Les pistes sont supprim√©es de l'appareil connect√© √† l'aide de leur logiciel et enregistr√©es en tant que matrice NumPy. </p><br><p>  Vous devez d'abord √©crire le firmware du p√©riph√©rique cible.  Dans le cadre du laboratoire, les chiffres AES, DES, TEA sont consid√©r√©s.  Pour eux, il existe d√©j√† un firmware et des param√®tres pr√™ts √† l'emploi pour supprimer les traces (nombre d'√©chantillons √† pr√©lever, d√©calage, fr√©quence ADC, etc.).  Pour des recherches ind√©pendantes, les param√®tres devront √™tre s√©lectionn√©s exp√©rimentalement. </p><br><p>  Comme mentionn√© ci-dessus, vous pouvez provoquer une d√©faillance de la carte cible: provoquer un dysfonctionnement du signal d'horloge, ignorer les instructions et extraire des informations secr√®tes. </p><br><p>  Dans les grands complexes, un oscilloscope est utilis√© pour tracer les traces. </p><br><h2 id="analiz">  Analyse </h2><br><p>  Il existe plusieurs m√©thodes d'analyse de base: </p><br><ul><li>  analyse de puissance simple (SPA); </li><li>  analyse de puissance diff√©rentielle (DPA); </li><li> analyse de corr√©lation de puissance (CPA). </li></ul><br><p>  Une simple analyse de puissance comprend une analyse visuelle du graphique de puissance.  Par exemple, un mot de passe peut √™tre obtenu un caract√®re √† la fois en observant le profil de puissance lorsque le bon caract√®re est entr√© et en le comparant avec le mauvais. </p><br><p><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="Analyse de la puissance des mots de passe"></p><br><p>  Ou vous pouvez voir les tours de cryptage sur les pistes.  Ce n'est pas assez de donn√©es pour obtenir une cl√©, mais on peut supposer quel algorithme est ex√©cut√©.  La figure montre clairement 10 s√©ries d'AES. </p><br><p><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="AES SPA"></p><br><p>  L'analyse diff√©rentielle (DPA) est beaucoup plus efficace que la simple analyse. La DPA est bas√©e sur des m√©thodes d'analyse statistique pour d√©tecter les diff√©rences de traces de puissance.  Cependant, un outil tr√®s efficace pour ¬´ouvrir¬ª la cl√© n√©cessitera un grand nombre de routes.  Je n'ai pas utilis√© cette m√©thode pour l'analyse, mais au final je donnerai quelques liens vers des sources o√π elle est bien d√©crite. </p><br><p>  La base de l'analyse de corr√©lation est un appareil statistique pour d√©terminer la cl√© de cryptage secr√®te.  Parfois, il est isol√© dans un type distinct, parfois appel√© DPA.  Cette m√©thode n√©cessite moins de traces que DPA, je l'ai utilis√©e pour l'analyse de puissance.  Je vais vous en dire plus. </p><br><p>  La t√¢che principale est de construire un mod√®le pr√©cis de consommation d'√©nergie du dispositif √† l'√©tude.  Si un mod√®le pr√©cis est construit, il existe une corr√©lation notable entre la valeur pr√©vue et la valeur r√©elle. </p><br><p>  L'un des mod√®les de puissance qui peut √™tre utilis√© est le mod√®le de poids Hamming.  Le poids de Hamming est le nombre de valeurs non nulles en repr√©sentation binaire.  L'hypoth√®se de ce mod√®le est que le nombre de bits d√©finis dans le registre sera en corr√©lation avec l'√©nergie consomm√©e par le dispositif.  Le poids de Hamming lui-m√™me est utilis√© ci-apr√®s comme unit√© d'√©nergie conventionnelle.  Le mod√®le de distance de Hamming est √©galement utilis√© - le nombre de bits diff√©rents en 2 valeurs. </p><br><p>  Pour comparer le mod√®le de poids de Hamming et la consommation √©lectrique r√©elle, un coefficient de Pearson lin√©aire est utilis√©.  Il montre la d√©pendance lin√©aire d'une quantit√© par rapport √† une autre.  Avec un mod√®le correctement construit, ce coefficient tendra √† 1. </p><br><p>  L'algorithme CPA g√©n√©ralis√© comprend les √©tapes principales suivantes: </p><br><ul><li>  supprimer la consommation d'√©nergie lors de la conversion des messages sur une cl√© inconnue; </li><li>  nous construisons un mod√®le de consommation d'√©nergie de la puce lors de la conversion des m√™mes messages sur toutes les variantes possibles du sous-bloc cl√© (256 options pour chaque octet); </li><li>  nous trouvons le coefficient de corr√©lation lin√©aire pour la consommation d'√©nergie simul√©e et r√©elle.  Dans le cas d'une vraie cl√©, le coefficient tendra √† 1; </li><li>  l'algorithme est r√©p√©t√© pour les sous-blocs cl√©s restants. </li></ul><br><p>  En cons√©quence, la cl√© est restaur√©e s√©quentiellement, en petites parties.  Si nous attaquons un octet de la cl√© √† la fois, nous utilisons 2 <sup>8</sup> tentatives pour chaque cl√©.  Par exemple, si vous choisissez AES - 128, le nombre total de tentatives pour 16 octets de la cl√© sera de 2 <sup>12</sup> , ce qui est bien mieux que d'appuyer sur 2 <sup>128</sup> . </p><br><h3 id="analiz-shifra-magma">  Analyse du chiffre magma </h3><br><p>  Magma est un code d√©fini dans GOST R 34.12-2015, en fait le m√™me GOST 28147-89, uniquement de profil.  Le bloc chiffr√© passe par 32 tours dans lesquels certaines transformations se produisent.  La cl√© se compose de 256 bits, chaque cl√© ronde fait partie de l'original. </p><br><p><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="Fonction Feistel GOST"></p><br><p>  Nous analyserons les donn√©es obtenues en utilisant la m√©thode CPA. </p><br><p>  Tout d'abord, vous devez choisir une valeur interm√©diaire de l'algorithme, qui d√©pend des donn√©es connues et d'une petite partie de la cl√© et peut √™tre calcul√©e par de simples transformations.  Habituellement, cette valeur est la sortie de la S-box (Magma a maintenant 1 table de substitution, il est donc plus facile de mener de telles attaques) du premier (les textes ouverts sont connus) ou du dernier tour (les textes chiffr√©s sont connus). </p><br><p>  J'ai recherch√© une cl√© avec des textes ouverts bien connus, donc cette option sera examin√©e plus avant.  Dans l'algorithme Magma, contrairement √† DES, AES, l'ajout d'un bloc 32 bits avec une cl√© ronde se produit modulo 2 <sup>32</sup> , par cons√©quent, il est pr√©f√©rable de d√©marrer l'analyse √† partir des derni√®res sorties S-box, car l'ajout des valeurs les plus √©lev√©es n'affecte pas les plus jeunes.  Nous consid√©rons la sortie de chaque S-box: 8 premiers, puis 8, 7 et ainsi de suite jusqu'au premier.  La suppression des pistes a √©t√© effectu√©e sur un microcontr√¥leur 8 bits, et nous pouvons supposer que cela fonctionnait avec deux bo√Ætiers S.  Par cons√©quent, j'attaquerai imm√©diatement de 1 octet. </p><br><p>  Calcul du mod√®le √©nerg√©tique pour le dernier octet cl√©: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[leak("Gost28147_tc26_ParamZ", kguess, block2ns(text[tnum])[0], 0)]</span></span></code> </pre> <br><p>  o√π la fonction de fuite renvoie simplement la sortie S-box du dernier octet. </p><br><p>  Nous calculons le coefficient de Pearson lin√©aire pour les valeurs simul√©es et r√©elles selon la formule: </p><br><p><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="Corr√©lation"></p><br><pre> <code class="python hljs"> cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-comment"><span class="hljs-comment">#Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span></span></code> </pre> <br><p>  Lors du choix d'une vraie sous-cl√©, le coefficient de corr√©lation aura une augmentation significative: </p><br><p><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="Corr√©lation1"></p><br><p>  Ainsi, chaque octet de la cl√© ronde est analys√©. </p><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number"><span class="hljs-number">8</span></span>) | best_round ...</code> </pre> <br><p>  √âtant donn√© la premi√®re cl√© ronde, nous pouvons calculer les 2 cl√©s rondes et les suivantes de la m√™me mani√®re.  Une cl√© Magma compl√®te peut √™tre obtenue en retirant 8 cl√©s rondes. </p><br><p>  Dans le processus de r√©solution de ce probl√®me, plusieurs nuances apparaissent.  Contrairement aux chiffres AES, DES et Grasshopper, l'ajout d'une cl√© ronde en texte brut se produit modulo 2 <sup>32</sup> .  L'ajout de bits faibles affecte le haut, contrairement √† XORa.  Lors du calcul de chaque sous-cl√© suivante, vous devez prendre en compte les r√©sultats du pass√©.  De m√™me avec des touches rondes.  Les donn√©es sont tr√®s sensibles.  Si l'une des valeurs n'est pas calcul√©e correctement, un calcul suppl√©mentaire de la cl√© enti√®re sera incorrect. </p><br><p>  Il convient √©galement de consid√©rer qu'il est maintenant assez difficile de trouver une puce ayant une architecture √† quatre bits: la plupart des puces ont une puce √† huit bits.  Bien s√ªr, il existe des puces cryptographiques sp√©cialis√©es qui sont con√ßues pour un algorithme de conversion de s√©curit√© sp√©cifique (ou plusieurs algorithmes) et qui ont l'architecture la plus efficace. </p><br><p>  Pour ex√©cuter le chiffrement DES, un tel cryptoprocesseur peut avoir une architecture √† six bits, pour Magma - une architecture √† quatre bits, qui permet √† chaque S-box d'√™tre trait√©e s√©par√©ment.  Mon appareil cible est 8 bits, et dans le cas de "Magma", la conversion sera effectu√©e sur huit bits dans une approche, c'est-√†-dire  le remplacement aura lieu sur 2 S-box, la consommation √©lectrique sera prise en compte pour 2 S-box.  Si l'une des bo√Ætes S, senior ou junior, correspond √† la vraie cl√© et que l'autre ne correspond pas, des salves de corr√©lation √©lev√©es peuvent se produire. </p><br><p>  Compte tenu de tout ce qui pr√©c√®de, √† la sortie, nous avons le script suivant pour l'analyse des chemins de consommation d'√©nergie pour le chiffre Magma: </p><br><div class="spoiler">  <b class="spoiler_title">Script Python</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np path = <span class="hljs-string"><span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span></span> traces = np.load(path + <span class="hljs-string"><span class="hljs-string">'traces.npy'</span></span>) text = np.load(path + <span class="hljs-string"><span class="hljs-string">'textin.npy'</span></span>) keys = np.load(path + <span class="hljs-string"><span class="hljs-string">'keylist.npy'</span></span>) HW = [bin(n).count(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>)] SBOXES = {<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>: ( (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), )} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_K</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s, _in)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" S-box substitution :param s: S-box :param _in: 32-bit word :returns: substituted 32-bit word """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (s[<span class="hljs-number"><span class="hljs-number">0</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">1</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">2</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">3</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">4</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">5</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">6</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">7</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">28</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block2ns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Convert block to N1 and N2 integers """</span></span> data = bytearray(data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( data[<span class="hljs-number"><span class="hljs-number">7</span></span>] | data[<span class="hljs-number"><span class="hljs-number">6</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, data[<span class="hljs-number"><span class="hljs-number">3</span></span>] | data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addmod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, mod=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ** </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Modulo adding of two integers """</span></span> r = x + int(y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r &lt; mod <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r - mod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_shift11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 11-bit cyclic shift """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) | ((x &gt;&gt; (<span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">11</span></span>)) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, byte)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] _in = addmod(data, key) sbox_leak = _K(s, _in); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sbox_leak &gt;&gt; (<span class="hljs-number"><span class="hljs-number">8</span></span> * byte)) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Feistel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, nround)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] w = bytearray(key) x = [ w[<span class="hljs-number"><span class="hljs-number">3</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] | w[<span class="hljs-number"><span class="hljs-number">2</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | w[<span class="hljs-number"><span class="hljs-number">1</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | w[<span class="hljs-number"><span class="hljs-number">0</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>) ] n1, n2 = block2ns(data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nround): n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n1 numtraces = len(traces) numpoint = np.shape(traces)[<span class="hljs-number"><span class="hljs-number">1</span></span>] bestguess = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">32</span></span> round_data = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * numtraces <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[i] = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): best_round = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tnum_r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[tnum_r][rnum] = Feistel(<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>, bestguess, text[tnum_r], rnum) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero best_round_key = kguess &lt;&lt; (bnum * 8) | best_round sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[round("Gost28147_tc26_ParamZ", best_round_key, round_data[tnum][rnum], bnum)] #Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess])) best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * 8)) bestguess[((rnum + 1) * 4)-bnum - 1] = np.argmax(maxcpa) print "Best Key Guess: " for b in bestguess: print "%02x "%b,</span></span></code> </pre> </div></div><br><p>  <a href="https://github.com/rakf/ChipWhisperer/tree/master/GOST">R√©f√©rentiel de r√©sultats GitHub</a> </p><br><h2 id="vyvody">  Conclusions </h2><br><p>  Dans le cadre de l'√©tude, j'ai travaill√© avec ChipWhisperer.  Malgr√© le fait que je n'ai pas essay√© tous les outils (par exemple, glitching), je trouve certainement ChipWhisperer utile, surtout si vous ne voulez pas acheter du mat√©riel sp√©cial co√ªteux. </p><br><p>  Quant √† l'analyse de notre chiffre pour la consommation d'√©nergie, il est plus r√©sistant √† cette attaque que les chiffres d√©crits ci-dessus, mais avec suffisamment de donn√©es, la cl√© peut √™tre obtenue sans probl√®me. </p><br><p>  Mat√©riaux int√©ressants: </p><br><ul><li>  Analyse de puissance diff√©rentielle P. Kocher </li><li>  "Attaques d'analyse de puissance: r√©v√©ler les secrets des cartes √† puce" </li><li>  <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">Cryptographie √† la pointe du fusil I: √† la recherche de cl√©s d'algorithmes cryptographiques</a> R. Korkikyan. </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">Cryptographie √† la pointe du fusil II: analyse nutritionnelle diff√©rentielle</a> R. Korkikyan. </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">Rapport avec ZeroNights 2014</a> R. Korkikyan. </li><li>  cryptage <a href="http://2014.zeronights.org/assets/files/slides/cryptocodingv2.pdf">v2</a> avec ZeroNights 2014 sur la mise en ≈ìuvre logicielle. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477730/">https://habr.com/ru/post/fr477730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477716/index.html">Les math√©maticiens utilisant l'exemple du "tag" calculent comment le hasard se produit</a></li>
<li><a href="../fr477718/index.html">Couche convolutionnelle: convolution rapide selon la m√©thode de Shmuel Vinograd</a></li>
<li><a href="../fr477722/index.html">Google Style Guide en C ++. Partie 8</a></li>
<li><a href="../fr477724/index.html">Habraseminar de la marque RH: sur les talents, la chasse et le contenu</a></li>
<li><a href="../fr477728/index.html">Que faire pour diriger l'√©quipe afin que l'√©quipe ne s'√©puise pas</a></li>
<li><a href="../fr477732/index.html">Mauvaise classification des doigts des syst√®mes de navigation sous-marine</a></li>
<li><a href="../fr477734/index.html">Comprendre l'UICollectionViewLayout avec l'application Photos</a></li>
<li><a href="../fr477736/index.html">Le parcours du testeur: du ¬´frein √† main¬ª √† l'automatisation</a></li>
<li><a href="../fr477738/index.html">iKassa ou comment nous avons apprivois√© le ¬´caissier num√©rique¬ª</a></li>
<li><a href="../fr477740/index.html">Et o√π regarder ce t√©lescope avec votre ≈ìil?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>