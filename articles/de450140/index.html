<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòî üåç ‚òùüèø CAN fahren üêπ üë©üèæ üë©‚Äçüëß‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Einf√ºhrung 
 Das unbemannte StarLine-Fahrzeug auf Basis der Lexus RX 450h- Plattform ist ein Forschungsprojekt, das 2018 gestartet wurde. Das Projekt ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CAN fahren</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450140/"><h3>  Einf√ºhrung </h3><br>  <b>Das unbemannte StarLine-Fahrzeug</b> auf Basis der <b>Lexus RX 450h-</b> Plattform ist ein Forschungsprojekt, das 2018 gestartet wurde.  Das Projekt steht ambitionierten Fachleuten aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Open Source Community</a> offen.  Wir bieten jedem die M√∂glichkeit, auf Codeebene am Entwicklungsprozess teilzunehmen und seine Algorithmen an einem echten Auto zu testen, das mit teuren Ger√§ten ausgestattet ist.  Um das Auto zu steuern, wurde beschlossen, Apollo, ein offenes Framework, zu verwenden.  Damit Apollo funktioniert, mussten wir eine Reihe von Modulen anschlie√üen.  Diese Module helfen dem Programm, Informationen √ºber das Auto zu erhalten und es gem√§√ü den angegebenen Algorithmen zu steuern. <br><br>  <b>Diese Module umfassen:</b> <br><br><ul><li>  Modul zum Positionieren eines Autos im Weltraum unter Verwendung von GPS-Koordinaten; </li><li>  Modul zum Lenken, Beschleunigen und Bremsen eines Autos; </li><li>  Modul des Zustands von Fahrzeugsystemen: Geschwindigkeit, Beschleunigung, Lenkradposition, Bet√§tigen der Pedale usw.; </li><li>  Modul zum Abrufen von Informationen √ºber die Umgebung des Autos.  Ultraschallsensoren, Kameras, Radarger√§te und Lidare k√∂nnen damit umgehen. </li></ul><br>  Zun√§chst stand unser Team vor der Aufgabe, das Steuern des Lenkrads, das Beschleunigen und Bremsen des Autos zu lernen.  Au√üerdem erhalten Sie Informationen √ºber den Zustand von Fahrzeugsystemen.  Daf√ºr wurde viel Arbeit geleistet, um den Lexus CAN-Bus zu studieren. <br><a name="habracut"></a><br><h3>  Theoretischer Teil </h3><br><h4>  Was ist ein CAN-Bus? </h4><br>  In modernen Autos √ºbernahmen elektronische Systeme die Kontrolle √ºber alle Systeme (Abb. 1).  Elektronische Komponenten sind spezialisierte Computer, von denen jeder √ºber alle erforderlichen Schnittstellen f√ºr die Integration in ein Auto verf√ºgt.  √úber digitale Kommunikationsschnittstellen werden die Einheiten vernetzt, um Informationen miteinander auszutauschen.  Die gebr√§uchlichsten digitalen Schnittstellen in Autos sind CAN, LIN, FLEXRay.  Von diesen ist CAN am weitesten verbreitet. <br><br>  Der CAN-Bus (Controller Area Network) ist das Industriestandardnetzwerk.  1986 wurde dieser Standard von Bosch entwickelt.  Und das erste Auto mit einem CAN-Bus war der 1991 erschienene Mercedes-Benz W140.  Der Standard wurde entwickelt, damit Ger√§te ohne Host miteinander kommunizieren k√∂nnen.  Informationen werden √ºber spezielle Nachrichten ausgetauscht, die aus ID-Feldern, Nachrichtenl√§nge und Daten bestehen.  Jeder Block hat seine eigenen IDs.  In diesem Fall hat eine Nachricht mit einer niedrigeren ID Priorit√§t auf dem Bus.  Das Datenfeld kann beispielsweise Informationen √ºber den Status von Systemen und Sensoren, Befehle zur Steuerung von Mechanismen usw. enthalten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e6/109/0a4/1e61090a4149347d85f1b19488b27e94.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>1. CAN-Bus des Fahrzeugs.</i> <br><br>  Auf der physikalischen Ebene ist der Bus ein verdrilltes Paar Kupferleiter.  Das Signal wird differentiell √ºbertragen, wodurch eine hohe St√∂rfestigkeit erreicht wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/288/59d/b2f/28859db2fc4d7f30bb521f4e6c0a3123.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>2. Physikalische Darstellung des Signals auf dem CAN-Bus</i> <br><br>  √úber den CAN-Bus erhalten Sie Informationen zum Status verschiedener Sensoren und Fahrzeugsysteme.  Auch √ºber CAN k√∂nnen Sie die Komponenten des Autos steuern.  Diese M√∂glichkeiten nutzen wir f√ºr unser Projekt. <br><br>  Wir haben uns f√ºr Lexus RX entschieden, weil wir wussten, dass wir alle erforderlichen Knoten √ºber CAN verwalten k√∂nnen.  Da das Schwierigste bei der Erforschung eines Autos geschlossene Protokolle sind.  Einer der Gr√ºnde f√ºr die Wahl dieses speziellen Automodells war daher das Vorhandensein einer Beschreibung des CAN-Bus-Protokollteils im OpenPilot-OpenSource-Projekt. <br><br>  Um ein Auto richtig zu fahren, muss man verstehen, wie die mechanischen Teile der Systeme eines Autos funktionieren.  Wir mussten ein gutes Verst√§ndnis daf√ºr haben, wie man mit einem elektrischen Leistungsverst√§rker arbeitet oder die Verz√∂gerung eines Autos steuert.  Wenn zum Beispiel die R√§der gedreht werden, erzeugen sie einen Widerstand gegen die Lenkung, was die Lenkung beim Drehen einschr√§nkt.  Einige Systeme k√∂nnen nicht verwendet werden, ohne in speziellen Betriebsarten in das Auto einzusteigen.  Wir mussten diese und andere Details in diesem Prozess untersuchen. <br><br><h4>  Elektrische Servolenkung </h4><br>  Elektrische Servolenkung EPS (Electric Power Steering) ist ein System zur Reduzierung der Lenkkraft beim Drehen (Abb. 3).  Das Pr√§fix "Elektro" spricht √ºber die Art des Systems - elektrisch.  Das Lenken des Lenkrads mit diesem System wird komfortabel, der Fahrer dreht das Lenkrad in die richtige Richtung und der Elektromotor hilft, es in den gew√ºnschten Winkel zu drehen. <br><br>  Auf der Lenkwelle eines Autos ist ein elektrischer Leistungsverst√§rker installiert, dessen Teile durch eine Torsionswelle miteinander verbunden sind.  Auf der Torsionswelle ist ein Drehmomentsensor (Drehmomentsensor) montiert.  Wenn sich das Lenkrad dreht, dreht sich die Torsionswelle, was vom Drehmomentsensor aufgezeichnet wird.  Die vom Drehmomentsensor, den Drehzahlsensoren und den Kurbelwellenumdrehungen empfangenen Daten werden dem elektronischen Steuerger√§t der ECU zugef√ºhrt.  Und die ECU wiederum berechnet bereits die erforderliche Kompensationskraft und gibt dem Elektromotor des Verst√§rkers einen Befehl. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/b45/063/5b7b4506386956bd872df48432858d8c.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>3. Schematische Darstellung der elektrischen Servolenkung</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Fkgp64e-nNQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Video: Das LKA-System steuert ein Auto mit dem EPS-System.</i> <br><br><h4>  Elektronisches Gaspedal </h4><br>  Die Drossel ist ein Mechanismus zum Einstellen der Menge an Kraftstoffgemisch, die in den Motor f√§llt.  Je mehr Mischung wird, desto schneller f√§hrt das Auto. <br>  Das elektronische Gaspedal ist ein System, bei dem mehrere elektronische Komponenten bet√§tigt werden.  Das Signal √ºber die Position des Pedals tritt beim Dr√ºcken in das Motorsteuerger√§t ECM (Engine Control Module) ein.  Das ECM berechnet anhand dieses Signals die erforderliche Kraftstoffmenge, die dem Motor zugef√ºhrt werden muss.  Abh√§ngig von der ben√∂tigten Kraftstoffmenge passt das ECM den Drosselklappen√∂ffnungswinkel an. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6e8/16b/a1b/6e816ba1b6d687c9849321d8aac3f431.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>4. Das elektronische Gaspedalsystem.</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/98brdhB3n04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Video: Das elektronische Gaspedal dient zur Bedienung des Tempomats.</i> <br><br><h4>  Elektronische Fahrerassistenzsysteme </h4><br>  Wir haben ein Auto gekauft, das mit einer Vielzahl von digitalen Einheiten und Fahrerassistenzsystemen (ADAS) ausgestattet ist.  In unserem Projekt verwenden wir LKA, ACC und PCS. <br><br>  LKA (Lane Keep Assist) ist ein Streifenr√ºckhaltesystem, das aus einer Frontkamera und einer Recheneinheit besteht.  LKA h√§lt das Auto auf der Fahrspur, wenn beispielsweise der Fahrer abgelenkt ist.  Algorithmen in der Recheneinheit empfangen Daten von der Kamera und treffen auf dieser Grundlage eine Entscheidung √ºber den Zustand des Fahrzeugs auf der Stra√üe.  Das System kann verstehen, dass sich das Auto unkontrolliert in Richtung der rechten oder linken Spur bewegt.  In solchen F√§llen ert√∂nt ein Piepton, um die Aufmerksamkeit des Fahrers auf sich zu ziehen.  Beim √úberqueren der Fahrspur passt das System selbst den Drehwinkel der R√§der so an, dass das Fahrzeug auf der Fahrspur bleibt.  Das System sollte nur eingreifen, wenn es feststellt, dass das Man√∂ver zwischen den Fahrspuren nicht vom Fahrer verursacht wurde. <br><br>  ACC (Adaptive Cruise Control) - ein adaptives Tempomatsystem, mit dem Sie die gew√ºnschte Geschwindigkeit einstellen k√∂nnen.  Das Auto selbst beschleunigt und verlangsamt sich, um die gew√ºnschte Geschwindigkeit beizubehalten, w√§hrend der Fahrer seinen Fu√ü vom Gas- und Bremspedal nehmen kann.  Dieser Modus ist praktisch, wenn Sie auf Autobahnen und Autobahnen fahren.  Die adaptive Geschwindigkeitsregelung kann Hindernisse vor dem Auto erkennen und verlangsamen, um eine Kollision mit ihnen zu vermeiden.  Wenn ein anderes Fahrzeug mit einer niedrigeren Geschwindigkeit vorausf√§hrt, wird ACC langsamer und folgt.  Wenn ein statisches Objekt erkannt wird, wird das ACC langsamer, bis es stoppt.  Um Objekte vor dem Auto zu erkennen, verwendet ein solches System ein Radar mit einem Wellenl√§ngenbereich von Millimetern.  Typischerweise arbeiten solche Radarger√§te mit einer Frequenz von 24 bis 72 GHz und k√∂nnen Objekte in einer Entfernung von 300 Metern sicher sehen.  Das Radar wird normalerweise hinter dem vorderen Emblem am K√ºhlergrill installiert. <br><br>  PCS (Pre-Collision System) - Kollisionsvermeidungssystem.  Das System soll eine Kollision mit einem vorausfahrenden Auto verhindern.  Wenn eine Kollision unvermeidlich ist, minimiert das System Kollisionssch√§den.  Es verwendet auch Radar, um die Entfernung zum Objekt zu sch√§tzen, und eine Frontkamera, um es zu erkennen.  Die PCS-Front sagt die Wahrscheinlichkeit einer Kollision basierend auf der Fahrzeuggeschwindigkeit, der Entfernung zum Objekt und seiner Geschwindigkeit voraus.  Typischerweise hat ein System zwei Betriebsstufen.  Die erste Stufe - das System ert√∂nt und wird auf dem Armaturenbrett angezeigt, um den Fahrer √ºber die Gefahr zu informieren.  Die zweite Stufe - die Notbremsung wird √ºber das ABS-System aktiviert und die Gurtstraffer werden aktiviert. <br><br><h3>  Praktischer Teil </h3><br><h4>  Lenkrad </h4><br>  Das erste, was unser Team tun wollte, war zu lernen, wie man lenkt.  Das Lenkrad in einem Auto kann von zwei Systemen gesteuert werden: IPAS-Parkassistent (Intelligent Park Assist) und LKA. <br><br>  Mit IPAS k√∂nnen Sie den Lenkwinkel direkt in Grad einstellen.  Da unser Auto dieses System nicht hat, ist es unm√∂glich, die Lenkung auf diese Weise zu √ºberpr√ºfen und zu beherrschen. <br><br>  Daher haben wir die Stromkreise des Autos untersucht und festgestellt, welche CAN-Busse n√ºtzlich sein k√∂nnten.  Wir haben einen CAN-Bus-Analysator angeschlossen.  Das Protokoll enth√§lt eine Datei mit Nachrichtendatens√§tzen im Bus in chronologischer Reihenfolge.  Unsere Aufgabe war es, EPS-Servolenkungsteams (elektrische Servolenkung) zu finden.  Wir nahmen das Lenkradprotokoll von einer Seite zur anderen, im Protokoll konnten wir die Messwerte des Drehwinkels und der Drehzahl des Lenkrads finden.  Unten finden Sie ein Beispiel f√ºr das √Ñndern von Daten im CAN-Bus.  Die f√ºr uns interessanten Daten werden mit einem Marker hervorgehoben. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9e/2ff/eee/e9e2ffeee019069421b869be9fb6d6d4.gif" alt="Bild"><br>  <i>360 Grad Lenkung links</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b5/259/583/3b5259583320120b011d47f3c4517dd8.gif" alt="Bild"><br>  <i>Drehen Sie das Lenkrad um 270 Grad nach rechts</i> <br><br>  Im n√§chsten Schritt haben wir das Spurhaltesystem untersucht.  Dazu gingen wir in eine ruhige Stra√üe und zeichneten die Austauschprotokolle zwischen der Spurhalteeinheit und der DSU (Driving Support ECU) auf.  Mit dem CAN-Bus-Analysator konnten wir Nachrichten vom LKA-System berechnen.  Abbildung 6 zeigt den EPS-Steuerbefehl. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/76f/2a7/159/76f2a7159e1b5b36232ae0702079af45.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>5. Lenkbefehl mit dem LKA-System</i> <br><br>  Der LKA steuert das Lenkrad durch Einstellen des Drehmomentwerts auf der Welle (STEER_TORQUE_CMD) des Lenkrads.  Der Befehl wird vom EPS-Modul akzeptiert.  Jede Nachricht enth√§lt einen Z√§hlerwert (COUNTER) im Header, der bei jedem Senden erh√∂ht wird.  Das Feld LKA_STATE enth√§lt LKA-Statusinformationen.  Um die Steuerung zu erfassen, m√ºssen Sie das Bit STEER_REQUEST setzen. <br><br>  Meldungen, die f√ºr den Betrieb wichtiger Autosysteme verantwortlich sind, werden durch eine Pr√ºfsumme (CHECKSUM) gesch√ºtzt, um das Risiko von Fehlalarmen zu minimieren.  Das Auto ignoriert einen solchen Befehl, wenn die Nachricht eine falsche Pr√ºfsumme oder einen falschen Z√§hlerwert enth√§lt.  Dies ist ein vom Hersteller entwickelter Schutz gegen Systemst√∂rungen von Drittanbietern und St√∂rungen in der Kommunikationsleitung. <br><br>  Die Grafik (Abb. 6.) zeigt das LKA-Betriebsdiagramm.  Drehmomentsensor - Wert vom Drehmomentsensor auf der Torsionswelle.  Torque Cmd ist ein Team von LKA f√ºr die Lenkung.  Das Bild zeigt, wie der LKA gesteuert wird, um das Auto auf der Fahrspur zu halten.  Beim √úberqueren von Null √§ndert sich die Drehrichtung des Lenkrads.  Das hei√üt,  Ein negatives Signal zeigt eine Rechtskurve an, ein positiver Wert nach links.  Wenn Sie den Befehl auf Null halten, weist dies auf einen Mangel an Kontrolle durch die LKA hin.  Mit dem Eingreifen des Fahrers gibt das System keine Kontrolle mehr aus.  LKA erkennt den Eingriff des Fahrers mit einem zweiten Drehmomentsensor auf der Welle von der Lenkradseite. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ac/562/2c8/2ac5622c84943c61207d0ac0c17a20fa.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>6. Zeitplan des LKA-Systems</i> <br><br>  Wir mussten die Arbeit des Lenkungsteams √ºberpr√ºfen.  Mit dem StarLine Sigma 10-Modul haben wir die Firmware f√ºr Kontrolltests vorbereitet.  StarLine Sigma 10 sollte Befehle an das Lenkrad senden, um das Lenkrad nach links oder rechts zu drehen.  Zu diesem Zeitpunkt hatten wir keine grafische Oberfl√§che zur Steuerung des Moduls, daher mussten wir die Standardmittel des Autos verwenden.  Wir haben den Status der Position des Tempomathebels im CAN-Bus gefunden und das Modul so programmiert, dass die obere Position des Hebels dazu f√ºhrte, dass sich das Lenkrad nach rechts und die untere Position nach links drehte (Abb. 7). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/147/82e/068/14782e068fe5ac6bc3636603d2113cee.gif" alt="Bild"><br>  <i>Abb.</i>  <i>7. Die ersten Lenkversuche</i> <br><br>  Das Video zeigt, dass die Steuerung in kurzen Abschnitten durchgef√ºhrt wird.  Dies tritt aus mehreren Gr√ºnden auf. <br><br>  Der erste Grund ist das fehlende Feedback.  Wenn die Diskrepanz zwischen dem Drehmoment-Cmd-Signal und dem Drehmomentsensor einen bestimmten Œî-Wert √ºberschreitet, akzeptiert das System automatisch keine Befehle mehr (Abb. 8).  Wir stellen den Algorithmus so ein, dass der Ausgangsbefehl (Torque CMD) abh√§ngig vom Wert des Drehmoments auf der Welle (Torque Sensor) angepasst wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bd/ff5/458/3bdff5458f46a6de9f48598a735db625.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>8. Signaldiskrepanzen f√ºhren zu Systemfehlern</i> <br><br>  Die folgende Einschr√§nkung bezieht sich auf das in EPS integrierte Sicherheitssystem.  Das EPS-System erm√∂glicht es LKA-Teams nicht, √ºber einen weiten Bereich zu steuern.  Welches ist ziemlich logisch, weil  Beim Fahren auf der Stra√üe ist ein pl√∂tzliches Man√∂vrieren nicht sicher.  Wenn also der Schwellenwert des Drehmoments auf der Welle √ºberschritten wird, erzeugt das LKA-System einen Fehler und schaltet sich aus (Abb. 9). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/360/888/015/3608880153b575b2874efd8db45fe7f8.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>9. √úberschreiten des Schwellenwerts der Drehmomentregelung auf der Welle</i> <br><br>  Unabh√§ngig davon, ob das LKA-System aktiviert ist oder nicht, sind st√§ndig Nachrichten mit Befehlen auf dem Bus vorhanden.  Wir weisen das EPS-Modul an, die R√§der mit einer bestimmten Kraft nach links oder rechts zu drehen.  In der Zwischenzeit unterbricht LKA unsere Pakete mit "leeren" Nachrichten.  Nach unserem Team mit dem Wert des Augenblicks kommt der Standard mit Null (Abb. 10). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c0a/85b/1a9/c0a85b1a9ad409684dbcb740acfd18ed.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>10. Regelm√§√üige Nachrichten haben keine Momentwerte und unterbrechen unsere Kontrolle</i> <br><br>  Mithilfe des StarLine Sigma 10-Moduls konnten wir dann den gesamten Datenverkehr von LKA filtern und Nachrichten mit der ID 2E4 blockieren, wenn wir sie ben√∂tigten.  Dies l√∂ste das Problem und es gelang uns, eine reibungslose Lenksteuerung zu erhalten (Abb. 11). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/712/6ab/cff/7126abcff6446d6a6477c667880747a7.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>11. Reibungslose Lenkradeinstellung ohne Fehler</i> <br><br><h4>  Gasmanagement </h4><br>  Das ACC Adaptive Cruise Control-System steuert die Beschleunigungs- und Bremssoftware √ºber den CAN-Bus.  Das Steuerger√§t des ECU-Motors empf√§ngt DSU-Befehle. Wenn Sie beschleunigen m√ºssen, aktiviert es das elektronische Gaspedal.  Regeneratives Bremsen wird verwendet, um das Auto zu bremsen.  In diesem Fall wird ein Befehl zum Bremsen und Beschleunigen verwendet, nur die Werte unterscheiden sich. <br><br>  Der Befehl zur Steuerung der Beschleunigung oder Verz√∂gerung ist in Abbildung 12 dargestellt. Er besteht aus dem Beschleunigungswert ACCEL_CMD, einem Paar Overhead-Bits und einer Pr√ºfsummenpr√ºfsumme.  F√ºr die Fahrzeugbeschleunigung ist ACCEL_CMD positiv, f√ºr die Verz√∂gerung negativ.  Die Beschleunigung wird im Bereich von 0 bis 3 m / s ^ 2 eingestellt, die Verz√∂gerung ist √§hnlich, jedoch mit einem Minuszeichen.  Um Daten an den Bus zu senden, muss die gew√ºnschte Beschleunigung oder Verz√∂gerung mit einem Koeffizienten von 0,001 neu berechnet werden.  Um beispielsweise 1 m / s ^ 2 zu beschleunigen, ist ACCEL_CMD = 1000 (0x03E8). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/0a2/042/4fc0a20425a9718cb90eb40f4b5a127f.jpg" alt="Bild"><br>  <i>Abb.</i>  <i>12. Der Befehl zur Steuerung der Beschleunigung / Verz√∂gerung des Fahrzeugs</i> <br><br>  Wir haben die Protokolle aus dem Standard-ACC-System entfernt und die Teams analysiert.  Verglichen mit unserer Beschreibung der Teams und begann zu testen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f37/e3d/9a4/f37e3d9a42d8164a6b5e1f21c4fba704.gif" alt="Bild"><br>  <i>Abb.</i>  <i>13. Beschleunigungs- / Verz√∂gerungsprotokoll der adaptiven Geschwindigkeitsregelung ACC (mit einer Markierung hervorgehoben)</i> <br><br>  Es war nicht ohne Schwierigkeiten.  Wir fuhren auf einer Stra√üe mit viel Verkehr, um das Beschleunigungsteam zu testen.  Die Beschleunigungs- oder Verz√∂gerungssteuerungsbefehle des Fahrzeugs funktionieren nur, wenn die Geschwindigkeitsregelung aktiviert ist. Es reicht nicht aus, sie mit der Taste zu aktivieren.  Es ist notwendig, das vorausfahrende Auto zu finden und den folgenden Modus einzuschalten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9e0/4eb/012/9e04eb01233c579da82c01d623c05c40.gif" alt="Bild"><br>  <i>Abb.</i>  <i>14. Die Aktivierung des Tempomats erfolgt, wenn sich ein anderes Fahrzeug vor Ihnen befindet</i> <br><br>  Mit dem StarLine Sigma 10-Modul senden wir einen Beschleunigungsbefehl, und das Auto nimmt Fahrt auf.  Zu diesem Zeitpunkt haben wir die grafische Oberfl√§che zur Steuerung des StarLine Sigma 10-Moduls angeschlossen. Jetzt steuern wir das Lenkrad, das Beschleunigen und das Bremsen mithilfe der Tasten in der Anwendung. <br><br>  Die Teams arbeiteten, bis sie das vorausfahrende Auto verloren.  Das Tempomatsystem wurde ausgeschaltet und daher funktionierten die Beschleunigungsbefehle nicht mehr. <br>  Wir begannen die M√∂glichkeit zu untersuchen, Teams ohne aktive Geschwindigkeitsregelung einzusetzen.  Ich musste viel Zeit damit verbringen, die Daten im CAN-Bus zu analysieren, um zu verstehen, wie die Bedingungen f√ºr die Arbeit der Teams geschaffen werden k√∂nnen.  Zun√§chst waren wir interessiert, welcher Block die Ausf√ºhrung von ACC-Befehlen zur Beschleunigung oder Verz√∂gerung blockiert.  Ich musste untersuchen, welche IDs von DSU, LKA, Radar und Kamera stammen, und die gef√§lschten Daten verschiedener Sensoren entfernen. <br><br>  Die Entscheidung kam 3 Wochen sp√§ter.  Zu diesem Zeitpunkt hatten wir eine Vorstellung davon, wie die Bl√∂cke des Autos interagieren, f√ºhrten eine Untersuchung des Nachrichtenverkehrs durch und identifizierten Gruppen von Nachrichten, die von jedem Block gesendet wurden.  Das Driving Support ECU (DSU) ist f√ºr die adaptive Geschwindigkeitsregelung ACC verantwortlich.  Die DSU gibt Befehle zum Beschleunigen und Abbremsen des Fahrzeugs aus. Dieses Ger√§t empf√§ngt Daten vom Millimeter-Radar.  Das Radar teilt der DSU mit, in welcher Entfernung sich das Objekt von der Maschine bewegt, mit welcher relativen Geschwindigkeit und bestimmt seine horizontale Position (links, rechts oder in der Mitte). <br><br>  Unsere Idee war es, die Radardaten zu ersetzen.  Wir haben das Protokoll f√ºr die Verfolgung des Autos entfernt und die Radardaten im Moment der Verfolgung herausgezogen.  Jetzt, nachdem wir den Tempomat eingeschaltet haben, senden wir gef√§lschte Daten √ºber das Vorhandensein eines Autos vor Ihnen.  Es stellt sich heraus, dass es unser Auto t√§uscht und sagt, dass sich ein anderes Auto vor uns in einer bestimmten Entfernung bewegt. <br><br>  a) <img src="https://habrastorage.org/getpro/habr/post_images/18e/762/ed2/18e762ed2cf1f72b3240fe1bc3647048.gif" alt="Bild">  b) <img src="https://habrastorage.org/getpro/habr/post_images/be9/c16/276/be9c162764819ce5e0f733c67506ac4d.gif" alt="Bild"><br>  <i>Abb.</i>  <i>15. Kreuzfahrtaktivierung: a) Versuch der Aktivierung, ohne Radardaten zu ersetzen;</i>  <i>b) Aktivierung beim Ersetzen von Daten vom Radar.</i> <br><br>  Wenn wir unseren Haken starten, leuchtet auf dem Armaturenbrett das Anwesenheitssymbol des vorausfahrenden Fahrzeugs.  Jetzt k√∂nnen wir unser Management testen.  Wir starten den Beschleunigungsbefehl und das Auto beginnt schnell zu beschleunigen. <br><br>  Wie wir bereits erfahren haben, ist der Beschleunigungs- und Verz√∂gerungsbefehl eins.  Daher √ºberpr√ºften sie sofort die Verz√∂gerung.  Wir fuhren mit aktiver Geschwindigkeitsregelung auf Geschwindigkeit, starteten einen Bremsbefehl und das Auto wurde sofort langsamer. <br><br>  Infolgedessen beschleunigt und verlangsamt sich das Auto jetzt genau so, wie wir es brauchten. <br><br>  Das Ziel ist erreicht. <br><br><h4>  Was verwenden wir sonst noch? </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um eine Drohne zu erstellen, m√ºssen Hilfssysteme gesteuert werden: Blinker, Bremslichter, Alarme, Hupe usw. All dies kann auch √ºber den CAN-Bus gesteuert werden. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hardware und Software </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um heute mit dem Auto zu arbeiten, verwenden wir verschiedene Ger√§te: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit dem Marathon Bus Analyzer k√∂nnen Sie Daten von zwei Bussen gleichzeitig verbinden und lesen. </font><font style="vertical-align: inherit;">Auf der Website des Analysatorherstellers finden Sie eine kostenlose Software zur Protokollanalyse. </font><font style="vertical-align: inherit;">Wir verwenden jedoch in unserem Unternehmen geschriebene Software f√ºr den internen Gebrauch.</font></font></li><li>  StarLine  10         .   CAN  LIN .       C,       .       CAN-.    ,  ID         . </li><li>   Toyota/Lexus.          : , -, ,  . </li></ul><br>        ,        ,              . <br><br> <b>  StarLine</b> ‚Äî                  ,       . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitLab </a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450140/">https://habr.com/ru/post/de450140/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450130/index.html">√úberleben Teams nach dem Hackathon?</a></li>
<li><a href="../de450132/index.html">Monade kann nicht erkl√§rt werden</a></li>
<li><a href="../de450134/index.html">Das zweite Leben von Ringen und Broschen: Wie man Schmuck mithilfe der 3D-Technologie schnell nachbaut</a></li>
<li><a href="../de450136/index.html">Wenn die W√§nde nicht genug sind. So sch√ºtzen Sie Endpunkte</a></li>
<li><a href="../de450138/index.html">Product Management Digest # 7 (M√§rz - April 2019)</a></li>
<li><a href="../de450142/index.html">Im Mai: befohlen - zu √ºberleben</a></li>
<li><a href="../de450144/index.html">Wie bringen neue Technologien den Traum von der Unsterblichkeit n√§her?</a></li>
<li><a href="../de450146/index.html">Mein Milliarden-Dollar-Fehler</a></li>
<li><a href="../de450148/index.html">Eins Veeam ONE. Geheimdienste, Karten, Agenten und vieles mehr - heute auf den Monitoren des Landes</a></li>
<li><a href="../de450150/index.html">Sicherheitswoche 18: ShadowHammer-Angriff im Detail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>