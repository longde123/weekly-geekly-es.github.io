<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèæ ü§∑üèª üë¢ S√©curit√© DHCP dans Windows 10: exploration de la vuln√©rabilit√© critique CVE-2019-0726 üë®üèø‚Äçüç≥ üëâüèº üö∂üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Image: Pexels 

 Avec la publication des mises √† jour de janvier pour Windows, la nouvelle de la vuln√©rabilit√© extr√™mement dangereuse CVE-2019-0547 da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>S√©curit√© DHCP dans Windows 10: exploration de la vuln√©rabilit√© critique CVE-2019-0726</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/448378/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/sw/gb/5n/swgb5nnwlka74q3klyp10gk-ofu.jpeg"></a> <br><br>  <i>Image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pexels</a></i> <br><br>  Avec la publication des mises √† jour de janvier pour Windows, la nouvelle de la vuln√©rabilit√© extr√™mement dangereuse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2019-0547</a> dans les clients DHCP a √©mu le public.  La cote CVSS √©lev√©e et le fait que Microsoft n'a pas publi√© imm√©diatement une √©valuation des performances, ce qui a rendu difficile pour les utilisateurs de d√©cider d'une mise √† jour urgente du syst√®me, ont attis√© l'int√©r√™t.  Certaines publications sugg√®rent m√™me que l'absence d'index peut √™tre interpr√©t√©e comme la preuve qu'un exploit fonctionnel appara√Ætra dans un avenir proche. <a name="habracut"></a><br><br>  Des solutions comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MaxPatrol 8</a> peuvent identifier les ordinateurs du r√©seau qui sont vuln√©rables √† des attaques sp√©cifiques.  D'autres solutions, telles que PT NAD, d√©tectent elles-m√™mes de telles attaques.  Pour rendre cela possible, il est n√©cessaire de d√©crire √† la fois les r√®gles de d√©tection des vuln√©rabilit√©s des produits et les r√®gles de d√©tection des attaques contre ces produits.  √Ä son tour, pour que cela devienne possible, il est n√©cessaire que chaque vuln√©rabilit√© individuelle connaisse le vecteur, la m√©thode et les conditions de son fonctionnement, c'est-√†-dire litt√©ralement tous les d√©tails et les nuances associ√©s √† l'op√©ration.  Une compr√©hension beaucoup plus compl√®te et approfondie est n√©cessaire que ce qui peut g√©n√©ralement √™tre compil√© √† partir de descriptions sur des sites de fournisseurs ou dans CVE, tels que: <br><br><blockquote>  La vuln√©rabilit√© se manifeste parce que le syst√®me d'exploitation traite incorrectement les objets en m√©moire. </blockquote><br>  Donc, pour ajouter aux produits de la soci√©t√© les r√®gles de d√©tection des attaques sur une vuln√©rabilit√© nouvellement cr√©√©e dans DHCP, ainsi que les r√®gles d'identification des appareils affect√©s, vous devez comprendre les d√©tails.  Dans le cas de vuln√©rabilit√©s binaires, patch-diff est souvent utilis√© pour obtenir un aper√ßu des erreurs sous-jacentes, c'est-√†-dire une comparaison des modifications apport√©es au code binaire d'une application, d'une biblioth√®que ou du noyau du syst√®me d'exploitation avec un correctif sp√©cifique, une mise √† jour qui corrige cette erreur.  Mais la premi√®re √©tape est toujours la reconnaissance. <br><br>  <b>Remarque</b> : <i>Pour acc√©der directement √† la description de la vuln√©rabilit√©, en contournant les concepts DHCP sous-jacents, vous pouvez ignorer les premi√®res pages et acc√©der directement √† la section "Fonction DecodeDomainSearchListData".</i> <br><br><h2>  Reconnaissance </h2><br>  Nous nous tournons vers le moteur de recherche et voyons tous les d√©tails de vuln√©rabilit√© actuellement connus.  Cette fois, il y a un minimum de d√©tails, et tous sont des processions gratuites des informations recueillies √† partir de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publication originale</a> sur le site Web de MSRC.  Cette situation est assez courante pour les erreurs d√©couvertes par Microsoft lors d'un audit interne. <br><br>  Nous d√©couvrons dans la publication que nous sommes confront√©s √† une vuln√©rabilit√© de corruption de m√©moire, qui est contenue dans les syst√®mes client et serveur de Windows 10 version 1803 et appara√Æt au moment o√π un attaquant envoie des r√©ponses sp√©cialement con√ßues √† un client DHCP.  Apr√®s quelques jours √† partir de ce moment sur la page, les indices de performance appara√Ætront √©galement: <br><br><img src="https://habrastorage.org/webt/oi/kr/ha/oikrhaavmkrvqdgzpfxqp4oquiy.png"><br><br>  Comme vous pouvez le voir, MSRC a not√© ¬´2 - Exploitation moins probable¬ª.  Cela signifie qu'une erreur avec une probabilit√© √©lev√©e n'est pas op√©rationnelle du tout, ou que l'op√©ration est lourde de telles difficult√©s, dont le d√©passement n√©cessitera des co√ªts de main-d'≈ìuvre trop √©lev√©s.  Certes, Microsoft n'a pas tendance √† sous-estimer ces estimations.  Ceci est en partie influenc√© par le risque de perte de r√©putation et en partie par une certaine ind√©pendance du centre de r√©ponse au sein de l'entreprise.  Par cons√©quent, supposez: puisque la menace d'exploitation est indiqu√©e dans le rapport comme peu probable, elle l'est certainement.  En fait, cela aurait pu compl√©ter l'analyse, mais il ne serait pas superflu de rev√©rifier et au moins de d√©couvrir quelle √©tait la vuln√©rabilit√©.  En fin de compte, malgr√© toute la personnalit√© ind√©niable, les erreurs ont tendance √† se r√©p√©ter et √† se manifester ailleurs. <br><br>  √Ä partir de la m√™me page, nous t√©l√©chargeons le correctif (mise √† jour de s√©curit√©) fourni sous la forme d'une archive .msu, le d√©compressons et recherchons les fichiers probablement li√©s au traitement des r√©ponses DHCP c√¥t√© client.  R√©cemment, il est devenu beaucoup plus difficile de le faire, car les mises √† jour ont commenc√© √† √™tre livr√©es non pas sous la forme de packages distincts qui corrigent des erreurs sp√©cifiques, mais sous la forme d'un package cumulatif unique comprenant toutes les corrections mensuelles.  Cela augmentait consid√©rablement l'exc√®s de bruit, c'est-√†-dire les changements non li√©s √† notre t√¢che. <br><br>  Parmi l'ensemble des fichiers, la recherche trouve plusieurs biblioth√®ques adapt√©es au filtre, que nous comparons avec leurs versions sur un syst√®me non corrig√©.  La biblioth√®que dhcpcore.dll est la plus prometteuse.  Dans ce cas, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BinDiff</a> produit des modifications minimales: <br><br> <a href=""><img src="https://habrastorage.org/webt/vr/ml/oe/vrmloeuvnuyeqib2f8rarowqnri.png"></a> <br><br>  En fait, √† part les modifications cosm√©tiques apport√©es √† une seule fonction - DecodeDomainSearchListData.  Si vous connaissez bien le protocole DHCP et ses options qui ne sont pas utilis√©es trop souvent, vous pouvez d√©j√† supposer que cette fonction traite la liste.  Sinon, passez √† la deuxi√®me √©tape - l'√©tude du protocole. <br><br><h2>  DHCP et ses options </h2><br>  DHCP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 2131</a> | <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wiki</a> ) est un protocole extensible dont les capacit√©s de r√©approvisionnement sont fournies par le champ d'options.  Chaque option est d√©crite par une balise unique (num√©ro, identifiant), la taille occup√©e par les donn√©es contenues dans l'option et les donn√©es elles-m√™mes.  Cette pratique est typique des protocoles r√©seau, et l'une des options ¬´implant√©es¬ª dans le protocole est l'option de recherche de domaine d√©crite dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3397</a> .  Il permet au serveur DHCP de d√©finir les terminaisons de nom de domaine standard sur les clients, qui seront utilis√©es comme suffixes DNS pour la connexion configur√©e de cette mani√®re. <br><br>  Soit, par exemple, les terminaisons de noms suivantes ont √©t√© d√©finies sur notre client: <br><br><pre><code class="bash hljs">.microsoft.com .wikipedia.org</code> </pre> <br><img src="https://habrastorage.org/webt/_a/7o/ag/_a7oag6njc0p-kdww7o32ggatxc.png"><br><br>  Ensuite, dans toute tentative de d√©termination de l'adresse par le nom de domaine, les requ√™tes DNS substitueront les suffixes de cette liste tour √† tour jusqu'√† ce qu'un mappage r√©ussi soit trouv√©.  Par exemple, si l'utilisateur a entr√© ru dans la barre d'adresse du navigateur, des requ√™tes DNS seront g√©n√©r√©es d'abord pour ru.microsoft.com, puis pour ru.wikipedia.org: <br><br><img src="https://habrastorage.org/webt/qu/8v/kz/qu8vkzddg_pkqvt1o4dwstz2eho.png"><br><br>  En fait, les navigateurs modernes sont trop intelligents et r√©pondent donc aux redirections vers le moteur de recherche vers des noms qui ne sont pas similaires au FQDN.  Par cons√©quent, ci-dessous, nous joignons la conclusion des utilitaires moins g√¢t√©s: <br><br><img src="https://habrastorage.org/webt/ke/tq/f3/ketqf3pyckb-rp2en-dygbswtrq.png"><br><br>  Il peut sembler au lecteur qu'il s'agit de cette vuln√©rabilit√©, car la simple possibilit√© de remplacer les suffixes DNS par un serveur DHCP, avec lequel tout appareil du r√©seau peut s'identifier, constitue une menace pour les clients qui demandent des param√®tres r√©seau via DHCP. .  Mais non: comme il ressort du RFC, cela est consid√©r√© comme un comportement document√© tout √† fait l√©gitime.  En fait, le serveur DHCP est intrins√®quement l'un de ces composants approuv√©s qui peuvent avoir un fort impact sur les appareils qui y acc√®dent. <br><br><h2>  Option de recherche de domaine </h2><br>  L'option de recherche de domaine est num√©rot√©e 0x77 (119).  Comme toutes les options, il est cod√© avec une balise √† un octet avec le num√©ro d'option.  Comme la plupart des autres options, imm√©diatement apr√®s la balise se trouve une taille √† un octet des donn√©es suivant la taille.  Des instances d'options peuvent √™tre pr√©sentes dans le message DHCP plusieurs fois.  Dans ce cas, les donn√©es de toutes ces sections sont concat√©n√©es dans l'ordre dans lequel elles apparaissent dans le message. <br><br><img src="https://habrastorage.org/webt/cp/dg/yz/cpdgyzwd_4zxdxiujznhojbfczk.png"><br><br>  Dans l'exemple pr√©sent√©, tir√© de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RFC 3397</a> , les donn√©es sont divis√©es en trois sections, chacune de 9 octets.  Comme vous pouvez le voir sur l'image, les noms de sous-domaine dans le nom de domaine complet sont cod√©s avec une longueur sur un octet du nom, imm√©diatement suivi par le nom lui-m√™me.  Le codage du nom de domaine complet se termine par un octet nul (c'est-√†-dire un nom de sous-domaine de taille nulle). <br><br>  De plus, l'option utilise la m√©thode la plus simple de compression des donn√©es, ou plut√¥t, simplement l'analyse des points.  Au lieu de la taille du nom de domaine, le champ peut contenir la valeur 0xc0.  Ensuite, l'octet suivant d√©finit le d√©calage par rapport au d√©but des donn√©es d'option, qui doivent √™tre utilis√©es pour rechercher la fin du nom de domaine. <br><br>  Ainsi, dans cet exemple, une liste de deux suffixes de domaine est cod√©e: <br><br><pre> <code class="bash hljs">.eng.apple.com .marketing.apple.com</code> </pre><br><h2>  Fonction DecodeDomainSearchListData </h2><br>  Ainsi, le num√©ro d'option DHCP 0x77 (119) permet au serveur de configurer les suffixes DNS sur les clients.  Mais pas sur les machines avec des syst√®mes d'exploitation Windows.  Les syst√®mes Microsoft ont traditionnellement ignor√© cette option, donc historiquement, la fin des noms DNS, si n√©cessaire, a √©t√© report√©e via les strat√©gies de groupe.  Cela s'est poursuivi jusqu'√† r√©cemment, lorsque la prochaine version de Windows 10, version 1803, a ajout√© le traitement pour l'option de recherche de domaine.  A en juger par le nom de la fonction dans dhcpcore.dll, dans laquelle les modifications ont √©t√© apport√©es, c'est dans le gestionnaire ajout√© que l'erreur en question se trouve. <br><br>  Se rendre au travail.  Nous peignons un peu le code et d√©couvrons ce qui suit.  La proc√©dure DecodeDomainSearchListData, en totale conformit√© avec le nom, d√©code les donn√©es de l'option de recherche de domaine du message re√ßu du serveur.  En entr√©e, il re√ßoit un tableau de donn√©es compress√© de la mani√®re d√©crite dans le paragraphe pr√©c√©dent, et en sortie, il g√©n√®re une cha√Æne termin√©e par un z√©ro contenant une liste de terminaisons de nom de domaine, s√©par√©es par des virgules.  Par exemple, cette fonction convertit les donn√©es de l'exemple ci-dessus en une cha√Æne: <br><br><pre> <code class="bash hljs"> eng.apple.com,marketing.apple.com</code> </pre> <br>  DecodeDomainSearchListData est appel√© √† partir de la proc√©dure UpdateDomainSearchOption, qui d√©finit la liste renvoy√©e sur la valeur "DhcpDomainSearchList" de la cl√© de registre: <br> <code>HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{INTERFACE_GUID}\</code> <br>  stocker les principaux param√®tres d'une interface r√©seau sp√©cifique. <br><br><img src="https://habrastorage.org/webt/po/cq/zk/pocqzkd8ldtqb8ecrh_oyiajgba.png"><br><br>  La fonction DecodeDomainSearchListData remplit en deux passes.  Lors de la premi√®re passe, il effectue toutes les actions sauf l'√©criture dans le tampon de sortie.  Ainsi, la premi√®re passe est consacr√©e au calcul de la taille de la m√©moire requise pour accueillir les donn√©es renvoy√©es.  Lors de la deuxi√®me passe, la m√©moire est d√©j√† allou√©e pour ces donn√©es et la m√©moire allou√©e est remplie.  La fonction est plut√¥t petite, environ 250 instructions, et son travail principal consiste √† traiter chacune des trois options possibles pour le caract√®re repr√©sent√© dans le flux d'entr√©e: 1) 0x00, 2) 0xc0 ou 3) toutes les autres valeurs.  Le correctif hypoth√©tique pour l'erreur li√©e au DHCP se r√©sume essentiellement √† ajouter une v√©rification de la taille du tampon r√©sultant au d√©but de la deuxi√®me passe.  Si cette taille est nulle, la m√©moire n'est pas allou√©e au tampon et la fonction termine imm√©diatement l'ex√©cution et renvoie une erreur: <br><br><img src="https://habrastorage.org/webt/fn/ym/4g/fnym4gbsu66h64bn03lwrqttxlm.png"><br><br>  Il s'av√®re que la vuln√©rabilit√© se manifeste dans les cas o√π la taille du tampon cible est nulle.  En m√™me temps, au tout d√©but de l'ex√©cution, la fonction v√©rifie les donn√©es d'entr√©e, dont la taille ne peut √™tre inf√©rieure √† deux octets.  Par cons√©quent, pour le fonctionnement, il est n√©cessaire de s√©lectionner une option non vide de suffixes de domaine de telle mani√®re que la taille du tampon de sortie soit nulle. <br><br><h2>  Fonctionnement </h2><br>  La premi√®re chose qui vient √† l'esprit est que vous pouvez utiliser les points d'analyse d√©crits pr√©c√©demment afin que les donn√©es d'entr√©e non vides g√©n√®rent une ligne de sortie vide: <br><br><img src="https://habrastorage.org/webt/fz/px/vp/fzpxvpozmhgp7sbxoavng5hork8.png"><br><br>  Un serveur configur√© pour envoyer une option avec un tel contenu dans la r√©ponse entra√Ænera en fait une violation d'acc√®s sur les clients non mis √† jour.  Cela se produit pour la raison suivante.  √Ä chaque √©tape, lorsque la fonction analyse une partie du nom de domaine complet, elle le copie dans le tampon cible et place un point apr√®s celui-ci.  Dans l'exemple tir√© du RFC, les donn√©es seront copi√©es dans le tampon dans l'ordre suivant: <br><br><pre> <code class="bash hljs">1). eng. 2). eng.apple. 3). eng.apple.com.</code> </pre> <br>  Ensuite, lorsque le domaine contient une taille de domaine nulle, la fonction remplace le caract√®re pr√©c√©dent du tampon de destination par une virgule: <br><br><pre> <code class="bash hljs">4). eng.apple.com,</code> </pre> <br>  et continue l'analyse: <br><br><pre> <code class="bash hljs">5). eng.apple.com,marketing. 6). eng.apple.com,marketing.apple. 7). eng.apple.com,marketing.apple.com. 8). eng.apple.com,marketing.apple.com,</code> </pre> <br>  √Ä la fin de l'entr√©e, il ne reste plus qu'√† remplacer la derni√®re virgule par un caract√®re z√©ro et vous obtenez une ligne pr√™te pour l'√©criture dans le registre: <br><br><pre> <code class="bash hljs">9). eng.apple.com,marketing.apple.com</code> </pre> <br>  Que se passe-t-il lorsqu'un attaquant envoie un tampon form√© de la mani√®re d√©crite?  Si vous regardez l'exemple, vous pouvez voir que la liste qu'il contient se compose d'un √©l√©ment - une cha√Æne vide.  Lors de la premi√®re passe, la fonction calcule la taille des donn√©es de sortie.  √âtant donn√© que les donn√©es ne contiennent pas un seul nom de domaine non nul, la taille est nulle. <br><br>  Lors de la deuxi√®me passe, un bloc de m√©moire dynamique est allou√© pour y placer des donn√©es et copier les donn√©es elles-m√™mes.  Mais la fonction d'analyse rencontre imm√©diatement un caract√®re nul, ce qui signifie la fin du nom de domaine, et donc, comme cela a √©t√© dit, remplace le caract√®re pr√©c√©dent d'un point par une virgule.  Et ici, nous sommes confront√©s √† un probl√®me.  L'it√©rateur de tampon cible est √† la position z√©ro.  Il n'y a aucun caract√®re pr√©c√©dent.  Le caract√®re pr√©c√©dent appartient √† l'en-t√™te du bloc de m√©moire dynamique.  Et ce m√™me caract√®re sera remplac√© par 0x2c, c'est-√†-dire par une virgule. <br><br>  Cependant, cela ne se produit que sur les syst√®mes 32 bits.  L'utilisation de unsigned int pour stocker la position actuelle de l'it√©rateur de tampon cible introduit des ajustements au traitement sur les syst√®mes x64.  Prenons une plus grande attention au morceau de code responsable de l'√©criture d'une virgule dans le tampon: <br><br><img src="https://habrastorage.org/webt/cv/wr/da/cvwrdacd4nzbpec5skyyqubd5sg.png"><br><br>  L'unit√© est soustraite de la position actuelle √† l'aide du registre eax 32 bits, tandis que lors de l'adressage du tampon, le code acc√®de au registre de rax 64 bits complet.  Dans l'architecture AMD64, toute op√©ration avec des registres 32 bits annule la partie sup√©rieure du registre.  Cela signifie que dans le registre rax, qui contenait auparavant z√©ro, apr√®s soustraction, pas la valeur ‚Äì1, mais 0xffffffff sera stock√©e.  Par cons√©quent, sur les syst√®mes 64 bits, la valeur 0x2c sera √©crite dans l'adresse buf [0xffffffff], c'est-√†-dire bien au-del√† des limites de la m√©moire allou√©e au tampon. <br><br>  Les donn√©es obtenues sont en bon accord avec l'√©valuation des performances de Microsoft, car pour exploiter cette vuln√©rabilit√©, un attaquant doit apprendre √† effectuer une pulv√©risation de segments √† distance sur un client DHCP et en m√™me temps avoir un contr√¥le suffisant sur l'allocation de m√©moire dynamique pour enregistrer des valeurs pr√©d√©finies, √† savoir une virgule et z√©ro octet, produit dans l'adresse pr√©par√©e et conduit √† des cons√©quences n√©gatives contr√¥l√©es.  Sinon, l'√©criture de donn√©es vers une adresse non v√©rifi√©e entra√Ænera une interruption du processus svchost.exe, ainsi que de tous les services actuellement h√©berg√©s, et un nouveau red√©marrage de ces services par le syst√®me d'exploitation.  Un fait que les attaquants dans certaines conditions peuvent √©galement utiliser √† leur propre avantage. <br><br>  Cela semble √™tre tout ce qui peut √™tre dit au sujet de l'erreur sous enqu√™te.  Seul le sentiment demeure que c'est loin d'√™tre la fin.  Comme si nous n'avions pas consid√©r√© toutes les options.  Il doit y avoir quelque chose de plus qui est cach√© dans ces lignes. <br><br><h2>  CVE-2019-0726 </h2><br>  Probablement comme √ßa.  Si vous examinez attentivement le type de donn√©es √† l'origine de l'erreur et que vous la comparez √† la fa√ßon dont cette erreur se produit exactement, vous remarquerez que la liste des noms de domaine peut √™tre modifi√©e de telle sorte que le tampon r√©sultant sera de taille non nulle, mais une tentative d'√©criture en dehors de celle-ci est il en sera de m√™me.  Pour ce faire, le premier √©l√©ment de la liste doit √™tre une cha√Æne vide et tous les autres peuvent contenir des terminaisons de domaine normales.  Par exemple: <br><br><img src="https://habrastorage.org/webt/b2/me/mx/b2memx0tuctb6b7oozdlqwykubw.png"><br><br>  L'option pr√©sent√©e comprend deux √©l√©ments.  Le premier suffixe de domaine est vide, il se termine imm√©diatement par un octet z√©ro.  Le deuxi√®me suffixe est .ru.  La taille de ligne calcul√©e en sortie sera √©gale √† trois octets, ce qui permettra de s'affranchir du contr√¥le impos√© par la mise √† jour de janvier sur le vide du buffer cible.  Dans le m√™me temps, z√©ro au tout d√©but des donn√©es forcera la fonction √† √©crire une virgule avec le caract√®re pr√©c√©dent dans la cha√Æne r√©sultante, mais comme la position actuelle de l'it√©rateur dans la cha√Æne est z√©ro, comme dans le cas consid√©r√© ci-dessus, l'enregistrement se produira √† nouveau en dehors du tampon allou√©. <br><br>  Maintenant, il est n√©cessaire de confirmer les r√©sultats th√©oriques obtenus dans la pratique.  Nous simulons une situation dans laquelle le serveur DHCP envoie un message avec l'option pr√©sent√©e en r√©ponse √† une demande du client, et interceptons imm√©diatement une exception lors de la tentative d'√©criture d'une virgule √† la position 0xffffffff allou√©e sous la ligne de tampon r√©sultante: <br><br><img src="https://habrastorage.org/webt/o3/zk/us/o3zkus_tpdsnpbtff_rqnlu1cdw.png"><br><br>  Ici, le registre r8 contient un pointeur sur les options entrantes, rdi est l'adresse du tampon cible s√©lectionn√© et rax est la position dans ce tampon o√π le caract√®re doit √™tre √©crit.  Nous avons obtenu de tels r√©sultats sur un syst√®me compl√®tement mis √† jour (en janvier 2019). <br><br>  Nous √©crivons sur le probl√®me d√©couvert dans Microsoft et ... ils perdent la lettre.  Oui, cela arrive parfois m√™me avec des fournisseurs r√©put√©s.  Aucun syst√®me n'est parfait, et dans ce cas, vous devez rechercher d'autres moyens de communication.  Par cons√©quent, une semaine plus tard, sans m√™me recevoir de r√©ponse automatique pendant ce temps, nous contactons le gestionnaire directement via Twitter et selon les r√©sultats de plusieurs jours d'analyse de l'application, nous constatons que les d√©tails envoy√©s n'ont rien √† voir avec CVE-2019-0547 et repr√©sentent une vuln√©rabilit√© ind√©pendante pour laquelle nouvel identifiant CVE.  Un mois plus tard, en mars, la correction correspondante sort et l'erreur re√ßoit le num√©ro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2019-0726</a> . <br><br>  C'est ainsi que vous pouvez parfois essayer de comprendre les d√©tails de la vuln√©rabilit√© 1 jour pour d√©couvrir accidentellement 0 jour simplement en faisant confiance √† votre intuition. <br><br>  <b>Publi√© par</b> Mikhail Tsvetkov, sp√©cialiste en analyse d'application des technologies positives. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448378/">https://habr.com/ru/post/fr448378/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448366/index.html">Rust 1.34 Release</a></li>
<li><a href="../fr448368/index.html">SQL: la t√¢che du temps de travail</a></li>
<li><a href="../fr448372/index.html">Arr√™tez de rejeter les grands demandeurs d'emploi avec vos mauvaises questions.</a></li>
<li><a href="../fr448374/index.html">De nouvelles preuves de l'activit√© volcanique, qui a provoqu√© l'extinction la plus massive de l'histoire, sont re√ßues.</a></li>
<li><a href="../fr448376/index.html">Les math√©matiques disent aux cellules ce qu'elles devraient √™tre</a></li>
<li><a href="../fr448382/index.html">Comment nous avons √©valu√© la qualit√© de la documentation</a></li>
<li><a href="../fr448386/index.html">9 fa√ßons incroyablement simples de faire r√©pondre les gens √† vos messages</a></li>
<li><a href="../fr448388/index.html">La dict√©e num√©rique aura lieu pour la premi√®re fois en Russie</a></li>
<li><a href="../fr448390/index.html">Comment faire une montre pour Ilona Mask</a></li>
<li><a href="../fr448392/index.html">Deux approches pour structurer un graphique d'activit√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>