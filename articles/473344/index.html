<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòõ üë®üèæ‚Äçü§ù‚Äçüë®üèª üåµ Conciertos y eventos KudaGo en tu espejo üë©üèª‚Äç‚öïÔ∏è üßòüèª ‚õìÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le contar√© c√≥mo hice posible recibir y mostrar informaci√≥n de la API p√∫blica de KudaGo en su espejo. Por supuesto, no se trata de un simple, sino de u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conciertos y eventos KudaGo en tu espejo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473344/">  Le contar√© c√≥mo hice posible recibir y mostrar informaci√≥n de la API p√∫blica de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KudaGo</a> en su espejo.  Por supuesto, no se trata de un simple, sino de un espejo "inteligente". <br><a name="habracut"></a><br><h3>  ¬øQu√© es un espejo inteligente? </h3><br>  Lo m√°s probable es que muchos hayan o√≠do hablar de la plataforma modular <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MagicMirror¬≤</a> , que le permite implementar una aplicaci√≥n en Raspberry Pi que puede convertir un espejo para un hall de entrada o un ba√±o en su asistente personal.  Puede implementar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto</a> usando el llamado espejo "bidireccional", monitor, brazos rectos y el microordenador mencionado anteriormente. <br><br>  Magia en MagicMirror solo est√° en el nombre.  Si entend√≠ correctamente, todo esto se desarroll√≥ en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Electron</a> , lo que significa que Node.js. est√° involucrado en el asunto.  La "Aplicaci√≥n" crea una p√°gina html que, cuando se inicia, se abre en una ventana del navegador, y los llamados m√≥dulos ya se muestran all√≠, ambos preinstalados (Reloj, Calendario, Clima actual, Pron√≥stico del tiempo, Noticias) y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrollados por la comunidad</a> .  Y hay bastante interesante (tanto √∫til como <s>terco</s> inusual), por ejemplo, aqu√≠ hay solo algunos de m√°s de cien m√≥dulos: <br><br><h4>  √ötil </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Integraci√≥n del Asistente de Google</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Control por voz</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Reconocimiento facial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">YouTube</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Seguimiento de resultados deportivos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Feed de Instagram</a> </li></ul><br><h4>  Fantas√≠a </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estad√≠sticas de FortNite</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Seguimiento de la tasa de criptomonedas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Video de Live Earth desde la Estaci√≥n Espacial Internacional.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estado del enjambre de Docker</a> </li></ul><br><h3>  Antecedentes </h3><br>  Sobre c√≥mo recog√≠ mi espejo no pintar√© en detalle.  Si alguien se interesa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">, puede leer aqu√≠</a> .  Si desea crear el suyo, una simple b√∫squeda en Google le devolver√° docenas de ejemplos \ gu√≠as \ manuales.  Quiero mostrar c√≥mo hacer un m√≥dulo para tal espejo. <br><br>  Soy un gran admirador de asistir a varios conciertos y eventos de San Petersburgo.  Pero a veces sucede que (incluso teniendo en cuenta la abundancia de publicidad contextual, spam y carteles) me entero de algunos eventos casi uno o dos d√≠as antes.  Por lo tanto, siempre busqu√© una manera de filtrar de manera √≥ptima el flujo de informaci√≥n sobre ellos.  Las aplicaciones en un tel√©fono inteligente con una funcionalidad similar no duraron mucho tiempo (m√°s precisamente, me olvid√© de ellas).  Todos los carteles requirieron tiempo y un paso constante de la b√∫squeda "elige 10 filtros y adivina cu√°l es el correcto".  Las redes sociales generalmente se convierten en spam publicitario.  Y luego surgi√≥ la idea de implementar un "analizador" que seleccionara peri√≥dicamente la informaci√≥n seg√∫n sus propios criterios y la mostrara en alguna parte. <br><br><h3>  Desarrollo de tu modulo </h3><br>  Si alguien quiere ver el resultado de inmediato o instalar el m√≥dulo en un "espejo", entonces aqu√≠ est√° el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace al repositorio</a> .  Tambi√©n hay instrucciones de instalaci√≥n. <br><br>  Como fuente de informaci√≥n, el servicio de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">kudago</a> result√≥ ser el m√°s adecuado.  No se requiere registro.  M√©todos sanos.  Datos concisos en la respuesta.  No es una cobertura extra√±a, incluye no solo "bordillo de la ciudad" y "sin caucho", sino tambi√©n 9 ciudades rusas principales. <br><br>  Nuestro m√≥dulo desarrollado debe almacenarse en la <i>carpeta modules / modulename</i> .  Para crear un m√≥dulo simple (como el m√≠o) necesitamos crear dos archivos en esta carpeta: <br><br><ul><li>  modulename / modulename.js es el script del m√≥dulo principal. </li><li>  modulename / node_helper.js es el "ayudante opcional" que cargar√° el script.  El asistente y el script del m√≥dulo pueden comunicarse entre s√≠ mediante un sistema de socket integrado. </li></ul><br>  Despu√©s de jugar con una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gu√≠a del desarrollador de MagicMirror</a> , adem√°s de mirar las soluciones de otras personas, cargu√© un script para obtener entradas de la API de kudago usando XMLHttpRequest.  Y se top√≥ con el problema de las consultas entre dominios.  No soy un experto en JavaScript en absoluto (y ni siquiera un desarrollador).  Todo lo que entend√≠ fue enviar una solicitud "ejecutando un script en un navegador" y obtener una respuesta de kudago, no pude tener √©xito.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Esto</a> es lo que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">learn.javascript me</a> explic√≥ <br><br><blockquote>  Las solicitudes de dominio cruzado se someten a un control de seguridad especial, cuyo prop√≥sito es evitar que los hackers malvados conquisten Internet. <br><br>  En serio  Los desarrolladores del est√°ndar han proporcionado todas las barreras para que el "malvado pirata inform√°tico" no pueda, usando el nuevo est√°ndar, hacer algo fundamentalmente diferente de lo que pudo haber hecho antes y, por lo tanto, "romper" alg√∫n servidor que ejecuta el viejo est√°ndar y sin esperar nada fundamentalmente nuevo. </blockquote><br>  Bueno, en realidad no es lo que quer√≠a.  No ten√≠a ganas de entender los problemas de JavaScript.  Despu√©s de todo, a mano estaba el Python familiar y predecible.  Solo obtendr√© informaci√≥n de la biblioteca de <i>solicitudes</i> , escribiendo el resultado en json.  Solo queda resolver la cuesti√≥n de c√≥mo ejecutar el c√≥digo Python desde js. <br><br>  ¬°Resulta que node_helper.js es √∫til para m√≠!  Al iniciar nuestro m√≥dulo, puede usar las capacidades de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">python-shell</a> .  Simplemente especifique la ruta al int√©rprete de Python, la ruta al script, los argumentos y sus valores.  De esta forma, Kudago amablemente me devolvi√≥ una respuesta exitosa. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de llamada de script Python</b> <div class="spoiler_text"><pre><code class="javascript hljs">kudagoGetData: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//call python script for collecting events from KudaGo api self = this; var options = { pythonPath: this.config.pythonPath, scriptPath: './modules/MMM-KudaGo', mode: 'json', args: [ "--location", this.config.location, "--days", this.config.days, "--categories", this.config.categories, "--tags", this.config.tags, ] }; pyshell.PythonShell.run('KudaGo.py', options, function (err) { if (err) throw err; }); }</span></span></code> </pre> <br></div></div><br>  Adem√°s, solo node_helper.js puede leer informaci√≥n del archivo json (de forma predeterminada, el archivo se ubicar√° en la ruta <i>kudago / events.json</i> ) con los datos descargados de kudago.  Implementamos en √©l la misma lectura del archivo. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo para leer informaci√≥n de un archivo</b> <div class="spoiler_text"><pre> <code class="javascript hljs">readData: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//read a file with events fs.readFile("./modules/MMM-KudaGo/kudago/events.json", "utf8", (err, data) =&gt; { if (err) throw err; this.sendSocketNotification("DATA", data); }); }</span></span></code> </pre> <br></div></div><br>  Como ya escrib√≠, en MagicMirror todos los m√≥dulos se comunican a trav√©s del sistema de socket, por lo que para que nuestro script Python se ejecute al inicio, agregue el c√≥digo apropiado a node_helper.js <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo para iniciar el m√≥dulo al inicio</b> <div class="spoiler_text"><pre> <code class="javascript hljs">socketNotificationReceived: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">notification, payload</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (notification === <span class="hljs-string"><span class="hljs-string">"START"</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config = payload; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.kudagoGetData(); setInterval(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.kudagoGetData(); }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.config.updateInterval); } }</code> </pre> <br></div></div><br>  Todos los par√°metros que se obtienen de <i>this.config</i> son las variables predefinidas en el archivo del m√≥dulo principal o las especificadas en config.js, el archivo de configuraci√≥n general para todos los m√≥dulos MagicMirror. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de configuraci√≥n para el m√≥dulo creado</b> <div class="spoiler_text"><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">module</span></span>: <span class="hljs-string"><span class="hljs-string">'MMM-KudaGo'</span></span>, <span class="hljs-attr"><span class="hljs-attr">disabled</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">position</span></span>: <span class="hljs-string"><span class="hljs-string">'bottom_bar'</span></span>, <span class="hljs-attr"><span class="hljs-attr">config</span></span>: { <span class="hljs-attr"><span class="hljs-attr">location</span></span>: <span class="hljs-string"><span class="hljs-string">"spb"</span></span>, <span class="hljs-attr"><span class="hljs-attr">categories</span></span>: <span class="hljs-string"><span class="hljs-string">"concert"</span></span>, <span class="hljs-attr"><span class="hljs-attr">tags</span></span>: <span class="hljs-string"><span class="hljs-string">"  --,"</span></span>, <span class="hljs-attr"><span class="hljs-attr">days</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> } }</code> </pre> <br></div></div><br>  Bueno, en el archivo principal de nuestro m√≥dulo <a href="">MMM-KudaGo.js hay</a> par√°metros predeterminados, funciones para manejar datos de eventos (tomados de un archivo json), signos para dibujar una placa (de la cual las personas que saben sangrar√°n sangre de mis ojos, pero estoy en un tanque, lo principal para m√≠ es trabajado).  Debido al hecho de que saqu√© el trabajo con la API en archivos python, los archivos .js no est√°n sobrecargados con c√≥digo (a diferencia de la mayor√≠a de los otros m√≥dulos), anidados (¬øo c√≥mo se llaman aqu√≠?) Funciones, bucles y otros fideos. <br><br><h3>  Resultado </h3><br><div class="spoiler">  <b class="spoiler_title">Captura de pantalla del m√≥dulo en s√≠</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/2c0/d50/2f0/2c0d502f052e78c683af398ab6000092.jpg" alt="imagen"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Captura de pantalla espejo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yf/fh/7k/yffh7ks7qlbu6gvufqrpd7ffes8.png" alt="imagen"><br></div></div><br>  Result√≥ implementar una b√∫squeda de una o varias categor√≠as de eventos, buscar por etiquetas, buscar un intervalo de d√≠as determinado, con actualizaciones a intervalos espec√≠ficos (para obtener una lista m√°s detallada de categor√≠as y etiquetas, consulte el <a href="">archivo L√©ame</a> ).  Y mu√©strelo todo en la pantalla, indicando el lugar, el nombre, la fecha y el precio, en forma legible y sin perder tiempo en una b√∫squeda independiente. <br><br>  Por supuesto, debe mirar cuidadosamente varias veces lo que el applet devuelve all√≠ para comprender qu√© etiquetas debe poner para que no muestre conciertos o representaciones teatrales, sino, por ejemplo, cursos de yoga o festivales gratuitos en su ciudad.  ¬°Pero personalmente, mis necesidades est√°n completamente satisfechas! <br><br>  Espero que tambi√©n se te ocurra y crees un m√≥dulo √∫til para la comunidad, que compartas con otros en una p√°gina especial del proyecto.  Por cierto, si tienes buenas ideas o necesitas algo, escribe los comentarios.  ¬°Quiz√°s empujar a alguien a lo creativo! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/473344/">https://habr.com/ru/post/473344/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../473332/index.html">Mitya Alexandrov y Dmitry Konstantinov en la reuni√≥n jug.msk.ru</a></li>
<li><a href="../473334/index.html">Cat Ghonim: ¬øC√≥mo hacer que los gatos no se alivien en el c√©sped en casa?</a></li>
<li><a href="../473338/index.html">TDD: c√≥mo escribir las especificaciones correctamente (describe)</a></li>
<li><a href="../473340/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 386 (21-27 de octubre de 2019)</a></li>
<li><a href="../473342/index.html">"El largo camino te est√° esperando ..." o resolviendo el problema de pron√≥stico en C # usando Ml.NET (DataScience)</a></li>
<li><a href="../473346/index.html">Crear una API REST con Node.js y una Base de datos Oracle. Parte 2</a></li>
<li><a href="../473348/index.html">La idea de inercia (SGDm), la idea de escalamiento (Adagrad) y la regularizaci√≥n en el aprendizaje autom√°tico utilizando el problema de clasificaci√≥n como ejemplo</a></li>
<li><a href="../473350/index.html">Crear una API REST con Node.js y una Base de datos Oracle. Parte 3</a></li>
<li><a href="../473352/index.html">–° colecciones actuales en 10 minutos</a></li>
<li><a href="../473354/index.html">Sobre las rarezas de la habost√°tica</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>