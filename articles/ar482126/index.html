<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔆 🚁 ✋🏾 استعراض Keras ل TensorFlow 💠 👩‍👩‍👧 🤹🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ترجمة دليل نظرة عامة من Tensorflow.org. يمنحك هذا الدليل الأساسيات للبدء في تطبيق Keras. القراءة تستغرق 10 دقائق. 

 استيراد tf.keras 
 tf.keras هو تط...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>استعراض Keras ل TensorFlow</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482126/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wz/o5/gm/wzo5gmjyybfdr1ea_lwtrhsjzvw.jpeg"><br><br>  ترجمة دليل نظرة عامة من Tensorflow.org.  يمنحك هذا الدليل الأساسيات للبدء في تطبيق Keras.  القراءة تستغرق 10 دقائق. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  استيراد tf.keras </h2><br>  <code>tf.keras</code> هو تطبيق لمواصفات TensorFlow Keras API.  هذا هو واجهة برمجة التطبيقات عالية المستوى لبناء نماذج التدريب التي تتضمن دعمًا من الدرجة الأولى للوظائف الخاصة بـ TensorFlow مثل <i>التنفيذ المتحمس</i> ، وخطوط أنابيب <code>tf.data</code> ، <code>tf.data</code> .  يجعل <code>tf.keras</code> استخدام TensorFlow أسهل دون التضحية بالمرونة والأداء. <br><br>  للبدء ، قم باستيراد <code>tf.keras</code> كجزء من إعداد TensorFlow: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import, division, print_function, unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> keras</code> </pre> <br>  يمكن <code>tf.keras</code> تنفيذ أي كود متوافق مع Keras ، ولكن تذكر: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  قد يختلف إصدار <code>tf.keras</code> في أحدث إصدار من TensorFlow عن أحدث إصدار من keras في PyPI.  تحقق من <code>tf.keras.__version__</code> . </li><li style=";text-align:right;direction:rtl">  عند حفظ أوزان النماذج ، يقوم <code>tf.keras</code> بذلك افتراضيًا بتنسيق نقطة تفتيش.  مرر <code>save_format='h5'</code> لاستخدام HDF5 (أو أضف امتداد <code>.h5</code> إلى <code>.h5</code> الملف). </li></ul><br><h2 style=";text-align:right;direction:rtl">  بناء نموذج بسيط </h2><br><h3 style=";text-align:right;direction:rtl">  نموذج متسلسل </h3><br>  في Keras ، تقوم بجمع <i>طبقات</i> لبناء <i>النماذج</i> .  النموذج عبارة عن رسم بياني للطبقة (عادة).  أكثر أنواع النماذج شيوعًا هو رصة الطبقة: نموذج <code>tf.keras.Sequential</code> . <br><br>  نحن نبني شبكة بسيطة متصلة بالكامل (أي مدركة متعددة الطبقات): <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers model = tf.keras.Sequential() <span class="hljs-comment"><span class="hljs-comment">#       64 : model.add(layers.Dense(64, activation='relu')) #   : model.add(layers.Dense(64, activation='relu')) #   softmax  10 : model.add(layers.Dense(10, activation='softmax'))</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  تخصيص الطبقات </h3><br>  تتوفر العديد من أنواع طبقات <code>tf.keras.layers</code> .  يستخدم معظمهم مُنشئ وسيطة شائع: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>activation</code> : يضبط وظيفة التنشيط للطبقة.  تحدد هذه المعلمة اسم الوظيفة المضمنة أو الكائن الذي تم استدعاؤه.  المعلمة لا يوجد لديه القيمة الافتراضية. </li><li style=";text-align:right;direction:rtl">  <code>kernel_initializer</code> و <code>bias_initializer</code> : مخططات التهيئة التي تنشئ أوزان الطبقة (الأساسية <code>bias_initializer</code> ).  يمكن أن تكون هذه المعلمة اسم أو كائن يسمى.  مهيئ الافتراضي هو <code>"Glorot uniform"</code> . </li><li style=";text-align:right;direction:rtl">  <code>kernel_regularizer</code> و <code>bias_regularizer</code> : تتم إضافة مخططات <code>bias_regularizer</code> إلى أوزان الطبقة (الأساسية <code>bias_regularizer</code> ) ، مثل L1 أو L2.  بشكل افتراضي ، لم يتم ضبط التنظيم. </li></ul><br>  تستخدم الأمثلة التالية لمثيلات طبقات `tf.keras.layers.Dense` وسيطات المُنشئ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    : layers.Dense(64, activation='sigmoid') # : layers.Dense(64, activation=tf.keras.activations.sigmoid) #     L1   0.01    : layers.Dense(64, kernel_regularizer=tf.keras.regularizers.l1(0.01)) #     L2   0.01    : layers.Dense(64, bias_regularizer=tf.keras.regularizers.l2(0.01)) #        : layers.Dense(64, kernel_initializer='orthogonal') #        2.0: layers.Dense(64, bias_initializer=tf.keras.initializers.Constant(2.0))</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  التدريب والتقييم </h2><br><h3 style=";text-align:right;direction:rtl">  الإعداد التدريب </h3><br>  بعد تكوين النموذج ، قم بتكوين عملية التعلم عن طريق استدعاء طريقة <code>compile</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential([ <span class="hljs-comment"><span class="hljs-comment">#     64   : layers.Dense(64, activation='relu', input_shape=(32,)), #  : layers.Dense(64, activation='relu'), #   softmax  10 : layers.Dense(10, activation='softmax')]) model.compile(optimizer=tf.keras.optimizers.Adam(0.01), loss='categorical_crossentropy', metrics=['accuracy'])</span></span></code> </pre> <br>  يقبل <code>tf.keras.Model.compile</code> ثلاث وسائط مهمة: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>optimizer</code> : يحدد هذا الكائن الإجراء التدريب.  قم بتمرير مثيلات محسن من الوحدة النمطية <code>tf.keras.optimizers</code> ، مثل <code>tf.keras.optimizers.Adam</code> أو <code>tf.keras.optimizers.SGD</code> .  إذا كنت تريد فقط استخدام الخيارات الافتراضية ، فيمكنك أيضًا تحديد مُحسِّن مع كلمات رئيسية مثل <code>'adam'</code> أو <code>'sgd'</code> . </li><li style=";text-align:right;direction:rtl">  <code>loss</code> : هذه وظيفة يتم تصغيرها في عملية التعلم.  من بين الاختلافات الشائعة الخطأ القياسي ( <code>mse</code> ) ، <code>categorical_crossentropy</code> ، <code>binary_crossentropy</code> .  يتم تحديد وظائف الخسارة بالاسم أو بتمرير الكائن الذي تم استدعاؤه من الوحدة النمطية <code>tf.keras.losses</code> . </li><li style=";text-align:right;direction:rtl">  <code>metrics</code> : تستخدم لمراقبة التدريب.  هذه أسماء سلسلة أو كائنات تسمى من الوحدة النمطية <code>tf.keras.metrics</code> . </li><li style=";text-align:right;direction:rtl">  بالإضافة إلى ذلك ، للتأكد من تدريب النموذج وتقييمه بشغف ، تحقق من تمرير المعلمة <code>run_eagerly=True</code> إلى المحول البرمجي </li></ul><br>  بعد ذلك ، سنرى بعض الأمثلة على تكوين النموذج للتدريب: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       . model.compile(optimizer=tf.keras.optimizers.Adam(0.01), loss='mse', # mean squared error metrics=['mae']) # mean absolute error #     . model.compile(optimizer=tf.keras.optimizers.RMSprop(0.01), loss=tf.keras.losses.CategoricalCrossentropy(), metrics=[tf.keras.metrics.CategoricalAccuracy()])</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  التعلم من بيانات NumPy </h3><br>  بالنسبة إلى مجموعات البيانات الأصغر ، استخدم صفيفات ذاكرة NumPy لتدريب وتقييم النموذج.  يتم "تدريب" النموذج على بيانات التدريب باستخدام طريقة `fit`: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np data = np.random.random((<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>)) labels = np.random.random((<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) model.fit(data, labels, epochs=<span class="hljs-number"><span class="hljs-number">10</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">32</span></span>)</code> </pre> <br>  يأخذ <code>tf.keras.Model.fit</code> ثلاث وسائط مهمة: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>epochs</code> : التعلم مقسم إلى * الحلقات *.  العصر عبارة عن تكرار واحد لكل بيانات الإدخال (يتم ذلك على دفعات صغيرة). </li><li style=";text-align:right;direction:rtl">  <code>batch_size</code> : عند إرسال بيانات <code>batch_size</code> ، يقسم النموذج البيانات إلى كتل أصغر (مجموعات) ويتكرر عبر هذه الكتل أثناء التدريب.  يشير هذا الرقم إلى حجم كل كتلة بيانات.  تذكر أن الكتلة الأخيرة قد تكون أصغر إذا لم يتم تقسيم العدد الإجمالي للسجلات على حجم الدُفعة. </li><li style=";text-align:right;direction:rtl">  <code>validation_data</code> : عند وضع النماذج الأولية للنموذج ، فأنت تريد أن تتبع أداءه بسهولة على بيانات التحقق من الصحة.  يتيح تمرير مجموعة من بيانات الإدخال والتسميات باستخدام هذه الوسيطة للطراز عرض قيم وظيفة الخسارة والمقاييس في وضع الإخراج للبيانات التي يتم إرسالها في نهاية كل عصر. </li></ul><br>  فيما يلي مثال باستخدام <code>validation_data</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np data = np.random.random((<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>)) labels = np.random.random((<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) val_data = np.random.random((<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>)) val_labels = np.random.random((<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) model.fit(data, labels, epochs=<span class="hljs-number"><span class="hljs-number">10</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">32</span></span>, validation_data=(val_data, val_labels))</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  التدريب باستخدام مجموعات بيانات tf.data </h3><br>  استخدم API Datasets لتغيير حجم قواعد البيانات الكبيرة أو التدريب عبر أجهزة متعددة.  قم بتمرير مثيل `tf.data.Dataset` إلى طريقة <code>fit</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    : dataset = tf.data.Dataset.from_tensor_slices((data, labels)) dataset = dataset.batch(32) model.fit(dataset, epochs=10)</span></span></code> </pre> <br>  نظرًا لأن <code>Dataset</code> توفر البيانات على دفعات ، فإن هذا الجزء من الشفرة لا يتطلب وسيطة <code>batch_size</code> . <br><br>  يمكن أيضًا استخدام مجموعات البيانات للتحقق من صحة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">dataset = tf.data.Dataset.from_tensor_slices((data, labels)) dataset = dataset.batch(<span class="hljs-number"><span class="hljs-number">32</span></span>) val_dataset = tf.data.Dataset.from_tensor_slices((val_data, val_labels)) val_dataset = val_dataset.batch(<span class="hljs-number"><span class="hljs-number">32</span></span>) model.fit(dataset, epochs=<span class="hljs-number"><span class="hljs-number">10</span></span>, validation_data=val_dataset)</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  التقييم والتنبؤ </h3><br>  يمكن أن تستخدم <code>tf.keras.Model.predict</code> <code>tf.data.Dataset</code> و <code>tf.data.Dataset</code> و <code>tf.data.Dataset</code> . <br><br>  هذه هي الطريقة التي يمكنك بها <i>تقدير</i> الخسائر في وضع الإخراج ومقاييس البيانات المقدمة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   Numpy data = np.random.random((1000, 32)) labels = np.random.random((1000, 10)) model.evaluate(data, labels, batch_size=32) #   dataset = tf.data.Dataset.from_tensor_slices((data, labels)) dataset = dataset.batch(32) model.evaluate(dataset)</span></span></code> </pre> <br>  وإليك كيفية <i>التنبؤ</i> بإخراج المستوى الأخير في وضع الإخراج للبيانات المقدمة في شكل صفيف NumPy: <br><br><h2 style=";text-align:right;direction:rtl">  بناء نماذج معقدة </h2><br><h3 style=";text-align:right;direction:rtl">  API الوظيفية </h3><br>  نموذج <code>tf.keras.Sequential</code> هو مكدس طبقة بسيط لا يمكنك تخيل نموذج اعتباطي.  استخدم واجهة برمجة تطبيقات Keras الوظيفية لبناء طبولوجيا نموذج معقد ، مثل: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  نماذج الإدخال متعددة </li><li style=";text-align:right;direction:rtl">  نماذج متعددة المخرجات ، </li><li style=";text-align:right;direction:rtl">  النماذج ذات الطبقات الشائعة (تسمى نفس الطبقة عدة مرات) ، </li><li style=";text-align:right;direction:rtl">  النماذج ذات تدفقات البيانات غير المتناسقة (مثل العلاقات المتبقية). </li></ul><br>  بناء نموذج مع API وظيفية يعمل على النحو التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  مثيل الطبقة قابل للاستدعاء وإرجاع موتر. </li><li style=";text-align:right;direction:rtl">  تُستخدم <code>tf.keras.Model</code> لتحديد مثيل <code>tf.keras.Model</code> </li><li style=";text-align:right;direction:rtl">  تم تدريب هذا النموذج تمامًا مثل طراز "Sequential". </li></ol><br>  يستخدم المثال التالي واجهة برمجة التطبيقات الوظيفية لإنشاء شبكة بسيطة متصلة بالكامل: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">inputs = tf.keras.Input(shape=(<span class="hljs-number"><span class="hljs-number">32</span></span>,)) <span class="hljs-comment"><span class="hljs-comment">#    #        . x = layers.Dense(64, activation='relu')(inputs) x = layers.Dense(64, activation='relu')(x) predictions = layers.Dense(10, activation='softmax')(x)</span></span></code> </pre> <br>  إنشاء مثيل للنموذج باستخدام هذه المدخلات والمخرجات. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Model(inputs=inputs, outputs=predictions) <span class="hljs-comment"><span class="hljs-comment">#     . model.compile(optimizer=tf.keras.optimizers.RMSprop(0.001), loss='categorical_crossentropy', metrics=['accuracy']) #   5  model.fit(data, labels, batch_size=32, epochs=5)</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  نماذج فئة فرعية </h3><br>  قم بإنشاء نموذج قابل للتخصيص بالكامل باستخدام فئة فرعية <code>tf.keras.Model</code> وتحديد التوزيع المباشر الخاص بك.  قم بإنشاء طبقات في طريقة <code>__init__</code> وقم بتعيينها <code>__init__</code> لمثيل الفئة.  حدد الانتشار المباشر في طريقة <code>call</code> . <br><br>  تعد الفئة الفرعية لنموذج مفيدًا بشكل خاص عند تمكين التنفيذ المتقن ، لأنه يتيح لك كتابة التوزيع المباشر بشكل حتمي. <br><br>  ملاحظة: إذا كنت تريد تنفيذ النموذج الخاص بك <i>دائمًا بشكل</i> حتمي ، فيمكنك تعيين <code>dynamic=True</code> عند استدعاء المنشئ <code>super</code> . <br><blockquote style=";text-align:right;direction:rtl">  النقطة الأساسية: استخدم واجهة برمجة التطبيقات الصحيحة للعمل.  على الرغم من أن التصنيف الفرعي للنموذج يوفر المرونة ، إلا أنه يتعين عليك دفع ثمنه بمزيد من التعقيد وإمكانية أكبر للأخطاء المخصصة.  إن أمكن ، اختر واجهة برمجة التطبيقات الوظيفية. </blockquote>  يُظهر المثال التالي نموذجًا tf.keras.Model فئة فرعية باستخدام توزيع مباشر مخصص ، وهو أمر غير مطلوب ليكون ضروريًا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyModel</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(tf.keras.Model)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, num_classes=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> super(MyModel, self).__init__(name=<span class="hljs-string"><span class="hljs-string">'my_model'</span></span>) self.num_classes = num_classes <span class="hljs-comment"><span class="hljs-comment">#    . self.dense_1 = layers.Dense(32, activation='relu') self.dense_2 = layers.Dense(num_classes, activation='sigmoid') def call(self, inputs): #     , #      ( `__init__`). x = self.dense_1(inputs) return self.dense_2(x)</span></span></code> </pre> <br>  إنشاء مثيل لفئة الطراز الجديد: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = MyModel(num_classes=<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-comment"><span class="hljs-comment">#     . model.compile(optimizer=tf.keras.optimizers.RMSprop(0.001), loss='categorical_crossentropy', metrics=['accuracy']) #   5 . model.fit(data, labels, batch_size=32, epochs=5)</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  طبقات مخصصة </h3><br>  قم بإنشاء طبقة مخصصة عن طريق التصنيف الفرعي <code>tf.keras.layers.Layer</code> وتطبيق الطرق التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>__init__</code> : حدد بشكل اختياري الطبقات الفرعية التي سيتم استخدامها في هذه الطبقة. </li><li style=";text-align:right;direction:rtl">  * <code>build</code> : إنشاء طبقة الأوزان.  إضافة الأوزان باستخدام طريقة <code>add_weight</code> </li><li style=";text-align:right;direction:rtl">  <code>call</code> : تحديد التوزيع المباشر. </li><li style=";text-align:right;direction:rtl">  اختياريًا ، يمكن إجراء تسلسل للطبقة من خلال تطبيق أسلوب <code>get_config</code> وطريقة الفئة <code>from_config</code> . </li></ul><br>  فيما يلي مثال لطبقة المستخدم التي تضاعف المصفوفة ( <code>matmul</code> ) التي تغذيها المدخلات بمصفوفة kernel: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyLayer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(layers.Layer)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, output_dim, **kwargs)</span></span></span><span class="hljs-function">:</span></span> self.output_dim = output_dim super(MyLayer, self).__init__(**kwargs) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, input_shape)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#       . self.kernel = self.add_weight(name='kernel', shape=(input_shape[1], self.output_dim), initializer='uniform', trainable=True) def call(self, inputs): return tf.matmul(inputs, self.kernel) def get_config(self): base_config = super(MyLayer, self).get_config() base_config['output_dim'] = self.output_dim return base_config @classmethod def from_config(cls, config): return cls(**config)</span></span></code> </pre><br>  قم بإنشاء نموذج باستخدام الطبقة المخصصة الخاصة بك: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential([ MyLayer(<span class="hljs-number"><span class="hljs-number">10</span></span>), layers.Activation(<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)]) <span class="hljs-comment"><span class="hljs-comment">#      model.compile(optimizer=tf.keras.optimizers.RMSprop(0.001), loss='categorical_crossentropy', metrics=['accuracy']) #   5 . model.fit(data, labels, batch_size=32, epochs=5)</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  الاسترجاعات </h2><br>  Kolbek هو كائن تم نقله إلى النموذج لتخصيص وتوسيع سلوكه أثناء التدريب.  يمكنك كتابة رد الاتصال المخصص الخاص بك أو استخدام <code>tf.keras.callbacks</code> والذي يتضمن: <br><br>  <code>tf.keras.callbacks.ModelCheckpoint</code> : حفظ نقاط توقف النموذج على فترات زمنية منتظمة. <br>  <code>tf.keras.callbacks.LearningRateScheduler</code> : قم بتغيير خطوة التعلم ديناميكيًا. <br>  <code>tf.keras.callbacks.EarlyStopping</code> : إيقاف التدريب عندما تتوقف نتيجة التحقق من الصحة عن التحسن. <br>  <code>tf.keras.callbacks.TensorBoard:</code> مراقبة سلوك النموذج باستخدام <br>  TensorBoard <br><br>  لاستخدام <code>tf.keras.callbacks.Callback</code> ، <code>tf.keras.callbacks.Callback</code> إلى طريقة الطراز <code>fit</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">callbacks = [ <span class="hljs-comment"><span class="hljs-comment">#    `val_loss`     2  tf.keras.callbacks.EarlyStopping(patience=2, monitor='val_loss'), #   TensorBoard   `./logs` directory tf.keras.callbacks.TensorBoard(log_dir='./logs') ] model.fit(data, labels, batch_size=32, epochs=5, callbacks=callbacks, validation_data=(val_data, val_labels))</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  حفظ واستعادة </h2><br><h3 style=";text-align:right;direction:rtl">  حفظ قيم الوزن فقط </h3><br>  حفظ وتحميل أوزان النماذج باستخدام <code>tf.keras.Model.save_weights</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential([ layers.Dense(<span class="hljs-number"><span class="hljs-number">64</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, input_shape=(<span class="hljs-number"><span class="hljs-number">32</span></span>,)), layers.Dense(<span class="hljs-number"><span class="hljs-number">10</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>)]) model.compile(optimizer=tf.keras.optimizers.Adam(<span class="hljs-number"><span class="hljs-number">0.001</span></span>), loss=<span class="hljs-string"><span class="hljs-string">'categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>])</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     TensorFlow Checkpoint model.save_weights('./weights/my_model') #    #        . model.load_weights('./weights/my_model')</span></span></code> </pre> <br>  بشكل افتراضي ، يتم حفظ أوزان النماذج في تنسيق نقطة تفتيش TensorFlow.  يمكن أيضًا حفظ الأوزان بتنسيق Keras HDF5 (القيمة الافتراضية لتطبيق Keras العالمي): <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     HDF5 model.save_weights('my_model.h5', save_format='h5') #    model.load_weights('my_model.h5')</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl">  حفظ تكوين النموذج فقط </h3><br>  يمكن حفظ تكوين النموذج - وهذا يؤدي إلى تسلسل بنية النموذج دون أي أوزان.  يمكن للتهيئة المحفوظة استعادة نفس النموذج وتهيئته ، حتى بدون رمز يحدد النموذج الأصلي.  تدعم Keras تنسيقات تسلسل JSON و YAML: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     JSON json_string = model.to_json() json_string</span></span></code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pprint pprint.pprint(json.loads(json_string))</code> </pre> <br>  استعادة نموذج (إعادة تهيئة) من JSON: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">fresh_model = tf.keras.models.model_from_json(json_string)</code> </pre><br>  يتطلب تسلسل النموذج إلى YAML تثبيت `pyyaml` <i>قبل استيراد TensorFlow</i> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">yaml_string = model.to_yaml() print(yaml_string)</code> </pre> <br>  استعادة نموذج من YAML: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">fresh_model = tf.keras.models.model_from_yaml(yaml_string)</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ملاحظة: النماذج غير المصنفة تحت فئة غير قابلة للتسلسل ، لأن بنيتها محددة بواسطة كود Python في نص أسلوب `call`. </blockquote><br><h3 style=";text-align:right;direction:rtl">  حفظ النموذج بأكمله في ملف واحد </h3><br>  يمكن حفظ النموذج بأكمله في ملف يحتوي على قيم الأوزان وتكوين النموذج وحتى تكوين المحسن.  سيتيح لك ذلك تعيين نقطة توقف نموذجية ومواصلة التدريب لاحقًا من نفس الموضع تمامًا حتى بدون الوصول إلى الكود المصدر. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#    model = tf.keras.Sequential([ layers.Dense(10, activation='softmax', input_shape=(32,)), layers.Dense(10, activation='softmax') ]) model.compile(optimizer='rmsprop', loss='categorical_crossentropy', metrics=['accuracy']) model.fit(data, labels, batch_size=32, epochs=5) #      HDF5 model.save('my_model.h5') #         . model = tf.keras.models.load_model('my_model.h5')</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  تنفيذ حريصة </h2><br>  التنفيذ المتقن هو بيئة برمجة ضرورية تنفذ العمليات على الفور.  هذا غير مطلوب لـ Keras ، ولكن مدعوم من <code>tf.keras</code> وهو مفيد للتحقق من البرنامج وتصحيح الأخطاء. <br><br>  جميع نماذج بناء واجهة برمجة تطبيقات `tf.keras` متوافقة مع التنفيذ المتشوق.  على الرغم من إمكانية استخدام واجهات برمجة التطبيقات (API) التتابعية والوظيفية ، إلا أن التنفيذ المتقن يفيد بشكل خاص عند تصنيف <i>فئة فرعية</i> وإنشاء <i>طبقات مخصصة</i> - تتطلب واجهات برمجة التطبيقات هذه كتابة توزيع مباشر في شكل شفرة (بدلاً من واجهات برمجة التطبيقات التي تنشئ نماذج من خلال تجميع الطبقات الموجودة). <br><br><h2 style=";text-align:right;direction:rtl">  توزيع </h2><br><h3 style=";text-align:right;direction:rtl">  GPUs متعددة </h3><br>  يمكن تشغيل نماذج <code>tf.keras</code> على وحدات معالجة <code>tf.distribute.Strategy</code> متعددة باستخدام <code>tf.distribute.Strategy</code> .  يوفر هذا API التعلم الموزع عبر وحدات معالجة الرسومات متعددة مع تغيير طفيف أو لا تغيير على التعليمات البرمجية الموجودة. <br><br>  حاليًا ، <code>tf.distribute.MirroredStrategy</code> استراتيجية التوزيع الوحيدة المدعومة.  <code>MirroredStrategy</code> يكرر الرسومات مع <br>  التعلم المتزامن باستخدام الكل في جهاز واحد.  لاستخدام ` <code>distribute.Strategy</code> ، قم بتثبيت محسِّن التصميم وتصميمه وتجميعه في" <code>Strategy</code> " <code>.scope()</code> ` ، ثم قم بتدريب النموذج. <br><br>  المثال التالي يوزع <code>tf.keras.Model</code> بين وحدات معالجة الرسومات المتعددة على نفس الجهاز. <br><br>  أولاً ، نحدد نموذجًا في مجال الاستراتيجية الموزعة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">strategy = tf.distribute.MirroredStrategy() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> strategy.scope(): model = tf.keras.Sequential() model.add(layers.Dense(<span class="hljs-number"><span class="hljs-number">16</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'relu'</span></span>, input_shape=(<span class="hljs-number"><span class="hljs-number">10</span></span>,))) model.add(layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'sigmoid'</span></span>)) optimizer = tf.keras.optimizers.SGD(<span class="hljs-number"><span class="hljs-number">0.2</span></span>) model.compile(loss=<span class="hljs-string"><span class="hljs-string">'binary_crossentropy'</span></span>, optimizer=optimizer) model.summary()</code> </pre> <br>  ثم نقوم بتدريب النموذج على البيانات كالمعتاد: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">x = np.random.random((<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) y = np.random.randint(<span class="hljs-number"><span class="hljs-number">2</span></span>, size=(<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)) x = tf.cast(x, tf.float32) dataset = tf.data.Dataset.from_tensor_slices((x, y)) dataset = dataset.shuffle(buffer_size=<span class="hljs-number"><span class="hljs-number">1024</span></span>).batch(<span class="hljs-number"><span class="hljs-number">32</span></span>) model.fit(dataset, epochs=<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  <i>بعد التحقق ، ستظهر الترجمة أيضًا على Tensorflow.org.</i>  <i>إذا كنت ترغب في المشاركة في ترجمة وثائق موقع Tensorflow.org إلى اللغة الروسية ، يرجى الاتصال في رسالة شخصية أو تعليقات.</i>  <i>هي موضع تقدير أي تصحيحات أو تعليقات.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar482126/">https://habr.com/ru/post/ar482126/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar482104/index.html">كيفية التعامل مع عادات الناس المبرمجين</a></li>
<li><a href="../ar482106/index.html">هابر لحسابهم الخاص 2019: نتائج العام</a></li>
<li><a href="../ar482108/index.html">ذكاء هادئ. طريقة لتحديد نقاط الضعف المحتملة WEB</a></li>
<li><a href="../ar482110/index.html">يعمل Linux على بطاقة العمل الخاصة بي</a></li>
<li><a href="../ar482114/index.html">إرسال رسائل البريد الإلكتروني باستخدام asyncio و aiohttp من تطبيق Django</a></li>
<li><a href="../ar482128/index.html">الكشف عن gReebok. طبيب الجلدية والتناسلية نفسه</a></li>
<li><a href="../ar482130/index.html">التنازل عن الحقوق على نطاق واسع لمستخدمي المجال من الغابات المختلفة</a></li>
<li><a href="../ar482132/index.html">تم العثور على نسخة تسلا Cybertruck في موسكو. هذا هو تخصيص ... الروسية لادا سمارة</a></li>
<li><a href="../ar482134/index.html">مقارنة بين الهجينة أو ما يتوقعه أصحاب سماعات Meze الرومانية مقابل 84 990 و 239 990 روبل</a></li>
<li><a href="../ar482136/index.html">كيف يمكن لمشروع أحادي العلامة الدخول إلى القمة من خلال هزيمة المجمعين والخدمات الداخلية لمحركات البحث؟</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>