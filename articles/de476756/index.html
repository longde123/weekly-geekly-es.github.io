<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò£ üôÜüèº üèáüèº Mit Haskell FunC in FunCtional verwandeln: Wie Serokell den Blockchain-Wettbewerb f√ºr Telegramme gewann üì≤ üà≥ üõÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sie haben wahrscheinlich geh√∂rt, dass Telegram die Blockchain-Plattform von Ton starten wird . Aber Sie h√§tten die Nachricht verpassen k√∂nnen, dass Te...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mit Haskell FunC in FunCtional verwandeln: Wie Serokell den Blockchain-Wettbewerb f√ºr Telegramme gewann</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476756/"><p>  Sie haben wahrscheinlich geh√∂rt, dass Telegram <a href="https://vc.ru/finance/88457-telegram-predlozhil-investoram-podozhdat-zapuska-ton-do-aprelya-2020-goda-ili-vernut-77-ot-summy-vlozheniy-v-proekt">die Blockchain-Plattform von Ton starten wird</a> .  Aber Sie h√§tten die Nachricht verpassen k√∂nnen, dass Telegram vor nicht allzu langer Zeit <a href="https://habr.com/ru/news/t/468755/">einen Wettbewerb</a> f√ºr die Implementierung eines oder mehrerer intelligenter Vertr√§ge f√ºr diese Plattform ausgeschrieben hat. </p><br><p>  Das Serokell-Team mit langj√§hriger Erfahrung in der Entwicklung gro√üer Blockchain-Projekte konnte sich nicht zur√ºckhalten.  Wir haben f√ºnf Mitarbeiter an den Wettbewerb delegiert, die zwei Wochen sp√§ter unter dem (un) bescheidenen Spitznamen Sexy Chameleon den ersten Platz belegten.  In diesem Artikel werde ich dar√ºber sprechen, wie es ihnen gelungen ist.  Wir hoffen, dass Sie in den n√§chsten zehn Minuten mindestens eine interessante Geschichte lesen und maximal etwas N√ºtzliches darin finden, das Sie in Ihrer Arbeit anwenden k√∂nnen. </p><br><p>  Aber lassen Sie uns mit einem kleinen Eintauchen in den Kontext beginnen. </p><a name="habracut"></a><br><h2 id="konkurs-i-ego-usloviya">  Wettbewerb und seine Bedingungen </h2><br><p>  Die Hauptaufgaben der Teilnehmer waren daher die Umsetzung eines oder mehrerer der vorgeschlagenen intelligenten Vertr√§ge sowie die Unterbreitung von Vorschl√§gen zur Verbesserung des TON-√ñkosystems.  Der Wettbewerb fand vom 24. September bis 15. Oktober statt und die Ergebnisse wurden erst am 15. November bekannt gegeben.  Angesichts der Tatsache, dass es Telegram in dieser Zeit gelungen ist, die Ergebnisse von Wettbewerben √ºber Design und Anwendungsentwicklung in C ++ durchzuf√ºhren und bekannt zu geben, um die Qualit√§t von VoIP-Anrufen in Telegram zu testen und zu bewerten. </p><br><p>  Wir haben zwei intelligente Vertr√§ge aus der von den Organisatoren vorgeschlagenen Liste ausgew√§hlt.  F√ºr einen von ihnen verwendeten wir mit TON vertriebene Tools und den zweiten implementierten wir in einer neuen Sprache, die von unseren Ingenieuren speziell f√ºr TON entwickelt und in Haskell integriert wurde. </p><br><p>  Die Wahl einer funktionalen Programmiersprache ist kein Zufall.  In unserem <a href="https://serokell.io/blog">Unternehmensblog</a> sprechen wir oft dar√ºber, warum wir die Komplexit√§t funktionaler Sprachen f√ºr eine gro√üe √úbertreibung halten und warum wir generell bevorzugen, dass sie objektorientiert sind.  √úbrigens enth√§lt es auch das <a href="https://serokell.io/blog/ton-blockchain-competition">Original dieses Artikels</a> . </p><br><h2 id="pochemu-my-voobsche-reshili-uchastvovat">  Warum haben wir uns f√ºr eine Teilnahme entschieden? </h2><br><p>  Kurz gesagt, weil unsere Spezialisierung nicht standardm√§√üige und komplexe Projekte sind, die besondere F√§higkeiten erfordern und f√ºr die IT-Community h√§ufig von wissenschaftlichem Wert sind.  Wir unterst√ºtzen die Open-Source-Entwicklung nachdr√ºcklich und beteiligen uns an deren Popularisierung sowie an der Zusammenarbeit mit f√ºhrenden Universit√§ten in Russland auf dem Gebiet der Informatik und Mathematik. </p><br><p>  Die interessanten Aufgaben des Wettbewerbs und die Beteiligung am Telegramm-Projekt, die wir so sehr geliebt haben, waren an sich schon eine hervorragende Motivation, aber der Preisfonds wurde zu einem zus√§tzlichen Anreiz.  :) </p><br><h2 id="issledovanie-blokcheyna-ton">  TON Blockchain Research </h2><br><p>  Wir beobachten die neuen Entwicklungen in der Blockchain, der k√ºnstlichen Intelligenz und dem maschinellen Lernen genau und versuchen, in jedem Bereich, in dem wir arbeiten, eine wichtige Ver√∂ffentlichung zu verpassen.  Daher war unser Team zu Beginn des Wettbewerbs bereits mit den Ideen aus dem <a href="https://test.ton.org/ton.pdf">TON-Whitepaper</a> vertraut.  Bevor wir jedoch mit der Arbeit mit TON begannen, haben wir die technische Dokumentation und den tats√§chlichen Quellcode der Plattform nicht analysiert, sodass der erste Schritt ganz offensichtlich war - ein gr√ºndliches Studium der offiziellen Dokumentation auf der <a href="https://test.ton.org/">Website</a> und im <a href="https://github.com/ton-blockchain/ton/tree/master/doc">Projektarchiv</a> . </p><br><p>  Zu Beginn des Wettbewerbs war der Code bereits ver√∂ffentlicht worden. Um Zeit zu sparen, haben wir uns entschlossen, einen Leitfaden oder eine Zusammenfassung zu suchen, die von <em>Benutzern</em> geschrieben wurde.  Leider ergab dies kein Ergebnis - abgesehen von den Anweisungen zum Erstellen der Plattform unter Ubuntu fanden wir keine anderen Materialien. </p><br><p>  Die Dokumentation selbst wurde sorgf√§ltig ausgearbeitet, war jedoch an einigen Stellen schwer zu lesen.  Sehr oft mussten wir zu bestimmten Punkten zur√ºckkehren und von allgemeinen Beschreibungen abstrakter Ideen zu einfachen Implementierungsdetails √ºbergehen. </p><br><p>  Es w√§re einfacher, wenn die Spezifikation √ºberhaupt keine detaillierte Beschreibung der Implementierung h√§tte.  Informationen dar√ºber, wie die virtuelle Maschine ihren Stack pr√§sentiert, lenken Entwickler eher davon ab, intelligente Vertr√§ge f√ºr die TON-Plattform zu erstellen, als ihnen zu helfen. </p><br><h2 id="nix-sobiraem-proekt">  Nix: ein Projekt bauen </h2><br><p>  Wir bei Serokell sind gro√üe Fans von <a href="https://nixos.org/nix">Nix</a> .  Wir sammeln unsere Projekte f√ºr sie und stellen sie mit <a href="https://nixos.org/nixops">NixOps bereit</a> , und <a href="https://nixos.org/">NixOS ist</a> auf allen unseren Servern installiert.  Dank dessen sind alle unsere Builds reproduzierbar und funktionieren unter jedem Betriebssystem, auf dem Nix installiert werden kann. </p><br><p>  Also haben wir <a href="">Nix-Overlay mit einem Ausdruck zum Erstellen von TON erstellt</a> .  Das Kompilieren von TON ist so einfach wie m√∂glich: </p><br><pre><code class="plaintext hljs">$ cd ~/.config/nixpkgs/overlays &amp;&amp; git clone https://github.com/serokell/ton.nix $ cd /path/to/ton/repo &amp;&amp; nix-shell [nix-shell]$ cmakeConfigurePhase &amp;&amp; make</code> </pre> <br><p>  Beachten Sie, dass Sie keine Abh√§ngigkeiten installieren m√ºssen.  Nix erledigt auf magische Weise alles f√ºr Sie, egal ob Sie NixOS, Ubuntu oder macOS verwenden. </p><br><h2 id="programmirovanie-dlya-ton">  Programmierung f√ºr TON </h2><br><p>  Der TON Network Smart-Vertragscode wird auf der TON Virtual Machine (TVM) ausgef√ºhrt.  TVM ist komplizierter als die meisten anderen virtuellen Maschinen und verf√ºgt √ºber eine sehr interessante Funktionalit√§t, z. B. kann es mit <em>Fortsetzungen</em> und <em>Verkn√ºpfungen zu Daten arbeiten</em> . </p><br><p>  Au√üerdem haben die TON-Jungs drei neue Programmiersprachen erstellt: </p><br><p>  <strong>Fift</strong> ist eine universelle Stack-Programmiersprache, die an <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25BE%25D1%2580%25D1%2582_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">Forth</a> erinnert.  Seine √ºberragende F√§higkeit ist die F√§higkeit, mit TVM zu interagieren. </p><br><p>  <strong>FunC</strong> ist eine intelligente Vertragsprogrammiersprache, die <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8_(%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F)">C</a> √§hnelt und in eine andere Sprache kompiliert wurde - Fift Assembler. </p><br><p>  <strong>Fift Assembler</strong> - Fift-Bibliothek zum Generieren von ausf√ºhrbarem Bin√§rcode f√ºr TVM.  Fift Assembler fehlt ein Compiler.  Es ist eine <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9_%25D1%258F%25D0%25B7%25D1%258B%25D0%25BA">eingebettete dom√§nenspezifische Sprache (eDSL)</a> . </p><br><h2 id="nashi-konkursnye-raboty">  Unsere wettbewerbsf√§higen Werke </h2><br><p>  Schlie√ülich ist es Zeit, die Ergebnisse unserer Bem√ºhungen zu betrachten. </p><br><h3 id="asinhronnyy-platezhnyy-kanal">  <strong>Asynchroner Zahlungskanal</strong> </h3><br><p>  Zahlungskanal - ein intelligenter Vertrag, mit dem zwei Benutzer Zahlungen au√üerhalb der Blockchain senden k√∂nnen.  Das spart nicht nur Geld (es gibt keine Provision), sondern auch Zeit (Sie m√ºssen nicht warten, bis der n√§chste Block abgearbeitet ist).  Zahlungen k√∂nnen beliebig klein sein und beliebig oft erfolgen.  Gleichzeitig m√ºssen sich die Parteien nicht gegenseitig vertrauen, da die Fairness der Endabrechnung durch einen klugen Vertrag gew√§hrleistet ist. </p><br><p>  Wir haben eine ziemlich einfache L√∂sung f√ºr das Problem gefunden.  Zwei Teilnehmer k√∂nnen signierte Nachrichten austauschen, die jeweils zwei Nummern enthalten - den Gesamtbetrag, den jeder Teilnehmer bezahlt.  Diese beiden Zahlen funktionieren wie <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BD%25D1%258B%25D0%25B5_%25D1%2587%25D0%25B0%25D1%2581%25D1%258B">Vektoruhren</a> in traditionellen verteilten Systemen und legen die Reihenfolge der Transaktionen fest, in der sie "vorher geschehen" sind.  Mit diesen Daten kann der Vertrag etwaige Konflikte l√∂sen. </p><br><p>  Um diese Idee umzusetzen, ist eine Nummer ausreichend, aber wir haben beide √ºberlassen, da wir in der Lage waren, eine komfortablere Benutzeroberfl√§che zu erstellen.  Au√üerdem haben wir beschlossen, in jede Nachricht einen Zahlungsbetrag aufzunehmen.  Wenn die Nachricht aus irgendeinem Grund verloren geht, kann es sein, dass der Benutzer den Verlust nicht bemerkt, obwohl alle Betr√§ge und die endg√ºltige Berechnung korrekt sind. </p><br><p>  Um unsere Idee zu testen, haben wir nach Beispielen f√ºr die Verwendung eines so einfachen und √ºbersichtlichen Zahlungskanalprotokolls gesucht.  √úberraschenderweise fanden wir nur zwei: </p><br><ol><li>  <a href="https://medium.com/%40matthewdif/ethereum-payment-channel-in-50-lines-of-code-a94fad2704bc">Beschreibung eines</a> √§hnlichen Ansatzes, nur f√ºr unidirektionalen Kanal. </li><li>  <a href="https://programtheblockchain.com/posts/2018/02/23/writing-a-simple-payment-channel/">Ein Tutorial</a> , das die gleiche Idee beschreibt wie wir, aber ohne viele wichtige Details zu erkl√§ren, wie die allgemeine Korrektheit und das Verfahren zur L√∂sung von Konflikten. </li></ol><br><p>  Es hat sich herausgestellt, dass es sinnvoll ist, unser Protokoll im Detail zu beschreiben und dabei besonders auf seine Richtigkeit zu achten.  Nach mehreren Iterationen war die Spezifikation fertig, und jetzt k√∂nnen Sie sie auch ansehen. </p><br><p>  Wir haben einen Vertrag f√ºr FunC implementiert und das Befehlszeilendienstprogramm f√ºr die Interaktion mit unserem Vertrag in Fift geschrieben, wie von den Organisatoren empfohlen.  Wir k√∂nnten jede andere Sprache f√ºr unsere CLI w√§hlen, aber es war interessant f√ºr uns, Fift auszuprobieren, um zu sehen, wie es sich in Aktion zeigt. </p><br><p>  Ehrlich gesagt, nachdem wir mit Fift gearbeitet haben, sahen wir keinen guten Grund, diese Sprache popul√§ren und aktiv verwendeten Sprachen mit entwickelten Werkzeugen und Bibliotheken vorzuziehen.  Das Programmieren in der Stack-Sprache ist ziemlich unangenehm, da Sie st√§ndig im Auge behalten m√ºssen, was sich auf dem Stack befindet, und der Compiler nicht hilft. </p><br><p>  Daher ist die einzige unserer Meinung nach Rechtfertigung f√ºr die Existenz von Fift seine Rolle als Host-Sprache f√ºr den Fift-Assembler.  W√§re es nicht besser, den TVM-Assembler in eine vorhandene Sprache einzubetten und keine neue Sprache f√ºr diesen Zweck zu entwickeln, im Wesentlichen den einzigen Zweck? </p><br><h3 id="tvm-haskell-edsl">  <strong>TVM Haskell eDSL</strong> </h3><br><p>  Jetzt ist es Zeit, √ºber unseren zweiten intelligenten Vertrag zu sprechen.  Wir haben beschlossen, eine Brieftasche mit mehreren Unterschriften zu entwickeln, aber es w√§re zu langweilig, einen weiteren intelligenten Vertrag f√ºr FunC zu schreiben.  Wir wollten etwas mehr Schwung hinzuf√ºgen, und es wurde unsere eigene Assemblersprache f√ºr TVM. </p><br><p>  Wie Fift Assembler kann auch unsere neue Sprache eingebettet werden, aber anstelle von Fift haben wir Haskell als Host gew√§hlt, wodurch wir das fortschrittliche Typsystem vollst√§ndig nutzen konnten.  Wenn Sie mit intelligenten Vertr√§gen arbeiten, bei denen selbst ein kleiner Fehler sehr teuer sein kann, ist die statische Eingabe unserer Meinung nach ein gro√üer Vorteil. </p><br><p>  Um zu demonstrieren, wie der in Haskell integrierte TVM-Assembler aussieht, haben wir eine Standardbrieftasche darauf implementiert.  Hier sind ein paar Dinge, auf die Sie achten sollten: </p><br><ul><li>  Dieser Vertrag besteht aus einer Funktion, aber Sie k√∂nnen so viel verwenden, wie Sie m√∂chten.  Wenn Sie eine neue Funktion in der Host-Sprache (dh in Haskell) definieren, k√∂nnen Sie mit unserem eDSL ausw√§hlen, ob diese Funktion in TVM in ein separates Unterprogramm umgewandelt oder nur an der Stelle des Anrufs integriert werden soll. </li><li>  Funktionen haben wie Haskell Typen, die beim Kompilieren √ºberpr√ºft werden.  In unserem eDSL ist der Funktionseingabetyp der Typ des Stacks, den die Funktion erwartet, und der Ergebnistyp ist der Typ des Stacks, der nach dem Aufruf abgerufen wird. </li><li>  Der Code verf√ºgt <code>stacktype</code> Anmerkungen zum <code>stacktype</code> , die den erwarteten <code>stacktype</code> Peer beschreiben.  Im urspr√ºnglichen Brieftaschenvertrag waren dies nur Kommentare, aber in unserer eDSL sind sie tats√§chlich Teil des Codes und werden beim Kompilieren √ºberpr√ºft.  Sie k√∂nnen als Dokumentation oder Anweisungen dienen, die dem Entwickler helfen, das Problem zu finden, wenn sich der Stapeltyp √§ndert, w√§hrend sich der Code √§ndert.  Derartige Annotationen wirken sich nat√ºrlich nicht auf die Laufzeitleistung aus, da f√ºr sie kein TVM-Code generiert wird. </li><li>  Dies ist immer noch ein Prototyp, der in zwei Wochen geschrieben wurde, es bleibt also noch viel Arbeit am Projekt.  Beispielsweise sollten alle Klasseninstanzen, die Sie im folgenden Code sehen, automatisch generiert werden. </li></ul><br><p>  So sieht die Implementierung von Multisig Wallet auf unserem eDSL aus: </p><br><pre> <code class="haskell hljs"><span class="hljs-title"><span class="hljs-title">main</span></span> :: <span class="hljs-type"><span class="hljs-type">IO</span></span> () main = putText $ pretty $ declProgram procedures methods <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> procedures = [ (<span class="hljs-string"><span class="hljs-string">"recv_external"</span></span>, decl recvExternal) , (<span class="hljs-string"><span class="hljs-string">"recv_internal"</span></span>, decl recvInternal) ] methods = [ (<span class="hljs-string"><span class="hljs-string">"seqno"</span></span>, declMethod getSeqno) ] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sCnt</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> , </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sPubKey</span></span></span><span class="hljs-class"> :: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> } instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DecodeSlice</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> where </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DecodeSliceFields</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> = [</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class">] decodeFromSliceImpl = do decodeFromSliceImpl @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> decodeFromSliceImpl @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EncodeBuilder</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Storage</span></span></span><span class="hljs-class"> where encodeToBuilder = do encodeToBuilder @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> encodeToBuilder @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PublicKey</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">deriving</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Eq</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ord</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Show</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Generic</span></span></span><span class="hljs-class">) instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Exception</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> instance </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Enum</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WalletError</span></span></span><span class="hljs-class"> where toEnum 33 = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> toEnum 34 = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> toEnum _ = error "</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Uknown</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MultiSigError</span></span></span><span class="hljs-class"> id" fromEnum </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeqNoMismatch</span></span></span><span class="hljs-class"> = 33 fromEnum </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SignatureMismatch</span></span></span><span class="hljs-class"> = 34 recvInternal :: '[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">] :-&gt; '[] recvInternal = drop recvExternal :: '[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">] :-&gt; '[] recvExternal = do decodeFromSlice @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Signature</span></span></span><span class="hljs-class"> dup preloadFromSlice @</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class"> stacktype @[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Word32</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Slice</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Signature</span></span></span><span class="hljs-class">] </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">-- cnt cs sign pushRoot decodeFromCell @Storage stacktype @[PublicKey, Word32, Word32, Slice, Signature] -- pk cnt' cnt cs sign xcpu @1 @2 stacktype @[Word32, Word32, PublicKey, Word32, Slice, Signature] -- cnt cnt' pk cnt cs sign equalInt &gt;&gt; throwIfNot SeqNoMismatch push @2 sliceHash stacktype @[Hash Slice, PublicKey, Word32, Slice, Signature] -- hash pk cnt cs sign xc2pu @0 @4 @4 stacktype @[PublicKey, Signature, Hash Slice, Word32, Slice, PublicKey] -- pubk sign hash cnt cs pubk chkSignU stacktype @[Bool, Word32, Slice, PublicKey] -- ? cnt cs pubk throwIfNot SignatureMismatch accept swap decodeFromSlice @Word32 nip dup srefs @Word8 pushInt 0 if IsEq then ignore else do decodeFromSlice @Word8 decodeFromSlice @(Cell MessageObject) stacktype @[Slice, Cell MessageObject, Word8, Word32, PublicKey] xchg @2 sendRawMsg stacktype @[Slice, Word32, PublicKey] endS inc encodeToCell @Storage popRoot getSeqno :: '[] :-&gt; '[Word32] getSeqno = do pushRoot cToS preloadFromSlice @Word32</span></span></span></span></code> </pre> <br><p>  In <a href="https://github.com/serokell/fift-asm-dsl">diesem Repository</a> finden Sie den vollst√§ndigen Quellcode unseres eDSL und den Brieftaschenvertrag mit mehreren Unterschriften <a href="https://github.com/serokell/fift-asm-dsl">.</a>  Im <a href="https://serokell.io/blog/parsing-typed-edsl">Detail sprach</a> unser Kollege George Agapov √ºber die eingebauten Sprachen. </p><br><h2 id="vyvody-o-konkurse-i-ton">  Schlussfolgerungen zum Wettbewerb und zur TON </h2><br><p>  Insgesamt dauerte unsere Arbeit 380 Stunden (zusammen mit dem Kennenlernen der Dokumentation, der Besprechungen und der Entwicklung selbst).  F√ºnf Entwickler nahmen am Wettbewerb teil: STO, Teamleiter, Blockchain-Plattformspezialist und Haskell-Softwareentwickler. </p><br><p>  Wir fanden die Ressourcen, um problemlos am Wettbewerb teilnehmen zu k√∂nnen, da der Geist des Hackathons, die enge Zusammenarbeit und die Notwendigkeit, schnell in Aspekte neuer Technologien einzutauchen, immer aufregend sind.  Einige schlaflose N√§chte, um bei begrenzten Ressourcen maximale Ergebnisse zu erzielen, werden durch unsch√§tzbare Erfahrungen und exzellente Erinnerungen kompensiert.  Dar√ºber hinaus ist die Bearbeitung solcher Aufgaben immer ein guter Test f√ºr die Unternehmensprozesse, da es √§u√üerst schwierig ist, ohne eine exzellent abgestimmte interne Interaktion wirklich anst√§ndige Ergebnisse zu erzielen. </p><br><p>  Abgesehen von den Texten: Wir waren beeindruckt von der Menge an Arbeit, die das TON-Team geleistet hat.  Sie haben es geschafft, ein komplexes, sch√∂nes und vor allem funktionierendes System aufzubauen.  TON erwies sich als Plattform mit gro√üem Potenzial.  Damit sich dieses √ñkosystem entwickeln kann, muss jedoch noch viel mehr getan werden, sowohl im Hinblick auf seine Verwendung in Blockchain-Projekten als auch im Hinblick auf die Verbesserung von Entwicklungswerkzeugen.  Wir sind stolz, jetzt Teil dieses Prozesses zu sein. </p><br><p>  Wenn Sie nach dem Lesen dieses Artikels noch Fragen oder Anregungen zur Anwendung von TON zur L√∂sung Ihrer Probleme haben, <a href="https://serokell.io/">schreiben Sie uns</a> - wir teilen gerne unsere Erfahrungen mit. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de476756/">https://habr.com/ru/post/de476756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de476740/index.html">Entdecken Sie die Cybergroup-Aktivit√§ten von Donot Team</a></li>
<li><a href="../de476742/index.html">Wie wir den Status "Immer in Kontakt" ge√§ndert haben, um professionelles Burnout zu verhindern</a></li>
<li><a href="../de476748/index.html">ca. tech: QATOK</a></li>
<li><a href="../de476752/index.html">Wie die zuk√ºnftige IT-Landschaft dazu beitr√§gt, Verbraucher, IT-Anbieter und Forschung und Entwicklung zusammenzubringen</a></li>
<li><a href="../de476754/index.html">So leiten Sie ein Konto f√ºr die Verwendung von Yandex Maps-API-Diensten an einen Nachbarn weiter oder warum ben√∂tigt ein IT-Riese eine Qualit√§tskontrolle?</a></li>
<li><a href="../de476758/index.html">Wie w√§hle ich das richtige 3D-Druckfilament aus?</a></li>
<li><a href="../de476760/index.html">Ein paar Worte zu den Vorteilen des Lesens</a></li>
<li><a href="../de476770/index.html">"Oriole 2.0" - der Zug, mit dem Sie auf dem WDC fahren</a></li>
<li><a href="../de476772/index.html">DeepPavlov f√ºr Entwickler: # 2 Setup und Bereitstellung</a></li>
<li><a href="../de476774/index.html">Playme TAU DVR Bewertung: Magnethalterung, billig</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>