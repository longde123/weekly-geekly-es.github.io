<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯХд ЁЯСиЁЯП╛тАНЁЯН│ ЁЯУЦ рдПрдХрддрд╛ рдореЗрдВ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдмрдирд╛рдирд╛: рдЯрд╛рд╡рд░реНрд╕ рдФрд░ рд╢реВрдЯрд┐рдВрдЧ рджреБрд╢реНрдорди ЁЯПд ЁЯРА ЁЯзСЁЯП╝тАНЁЯдЭтАНЁЯзСЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХрд╛ рдкрд╣рд▓рд╛ рдФрд░ рджреВрд╕рд░рд╛ рднрд╛рдЧ] 



- рд╣рдо рдЯреЙрд╡рд░ рдХреЗ рдореИрджрд╛рди рдкрд░ рдЬрдЧрд╣ рдмрдирд╛рддреЗ рд╣реИрдВред 
- рд╣рдо рднреМрддрд┐рдХреА рдХреА рдорджрдж рд╕реЗ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВред 
- рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЯреНрд░реИрдХ рдХрд░рдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдХрддрд╛ рдореЗрдВ рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рдмрдирд╛рдирд╛: рдЯрд╛рд╡рд░реНрд╕ рдФрд░ рд╢реВрдЯрд┐рдВрдЧ рджреБрд╢реНрдорди</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459070/">  [рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд╛ рдкрд╣рд▓рд╛</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджреВрд╕рд░рд╛</a> рднрд╛рдЧ] <br><br><ul><li>  рд╣рдо рдЯреЙрд╡рд░ рдХреЗ рдореИрджрд╛рди рдкрд░ рдЬрдЧрд╣ рдмрдирд╛рддреЗ рд╣реИрдВред </li><li>  рд╣рдо рднреМрддрд┐рдХреА рдХреА рдорджрдж рд╕реЗ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВред </li><li>  рд╣рдо рдЙрдиреНрд╣реЗрдВ рдЯреНрд░реИрдХ рдХрд░рддреЗ рд╣реИрдВ рдЬрдмрдХрд┐ рдпрд╣ рд╕рдВрднрд╡ рд╣реИред </li><li>  рд╣рдо рдЙрдиреНрд╣реЗрдВ рдПрдХ рд▓реЗрдЬрд░ рдмреАрдо рдХреЗ рд╕рд╛рде рд╢реВрдЯ рдХрд░рддреЗ рд╣реИрдВред </li></ul><br>  рдпрд╣ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдЯреЙрд╡рд░ рд░рдХреНрд╖рд╛ рд╢реИрд▓реА рдмрдирд╛рдиреЗ рдкрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рддреАрд╕рд░рд╛ рднрд╛рдЧ рд╣реИред  рдпрд╣ рдЯрд╛рд╡рд░реЛрдВ рдХреЗ рдирд┐рд░реНрдорд╛рдг, рд▓рдХреНрд╖реНрдп рдФрд░ рджреБрд╢реНрдордиреЛрдВ рдкрд░ рд╢реВрдЯрд┐рдВрдЧ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИред <br><br>  рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдПрдХрддрд╛ 2018.3.0f2 рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/470/ceb/183/470ceb1832b49ee7372fb79b8425b567.jpg" width="512" height="256"></div><br>  <i>рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдЧрд░реНрдореА рджреЗрдВред</i> <br><br><h2>  рдЯреЙрд╡рд░ рдирд┐рд░реНрдорд╛рдг </h2><br>  рджреАрд╡рд╛рд░реЗрдВ рдХреЗрд╡рд▓ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдзреАрдорд╛ рдХрд░ рджреЗрддреА рд╣реИрдВ, рдЬрд┐рд╕ рд░рд╛рд╕реНрддреЗ рдкрд░ рдЙрдиреНрд╣реЗрдВ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЙрд╕рдХреА рд▓рдВрдмрд╛рдИ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред  рд▓реЗрдХрд┐рди рдЧреЗрдо рдХрд╛ рд▓рдХреНрд╖реНрдп рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдирд╖реНрдЯ рдХрд░рдирд╛ рд╣реИред  рдпрд╣ рд╕рдорд╕реНрдпрд╛ рдЙрд╕ рдХреНрд╖реЗрддреНрд░ рдкрд░ рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рд░рдЦрдХрд░ рд╣рд▓ рдХреА рдЬрд╛рддреА рд╣реИ рдЬреЛ рдЙрди рдкрд░ рдЧреЛрд▓реА рдорд╛рд░ рджреЗрдВрдЧреЗред <br><a name="habracut"></a><br><h3>  рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА </h3><br>  рдЯрд╛рд╡рд░реНрд╕ рдПрдХ рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреА рдЯрд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рд╣реИрдВ, рддреЛ <code>GameTileContent</code> рдореЗрдВ рдЙрдирдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> GameTileContentType { Empty, Destination, Wall, SpawnPoint, TowerтВм }</code> </pre> <br>  рдЗрд╕ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ, рд╣рдо рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдкреНрд░рдХрд╛рд░ рдХреЗ рдЯреЙрд╡рд░ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕реЗ <code>GameTileContentFactory</code> рдХреЛ рдЯреЙрд╡рд░ <code>GameTileContentFactory</code> рдПрдХ рд▓рд┐рдВрдХ рдХреЗ <code>GameTileContentFactory</code> рдкреНрд░рджрд╛рди рдХрд░рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг <code>Get</code> рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рднреА рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameTileContent towerPrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTileContent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTileContentType type</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { тАж <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GameTileContentType.TowerтВм: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Get(towerPrefab); } тАж }</code> </pre> <br>  рд▓реЗрдХрд┐рди рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рд╢реВрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЙрдирдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдФрд░ рдЙрдиреНрд╣реЗрдВ рдЕрдкрдиреЗ рдХреЛрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред  рдЗрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдПрдХ <code>Tower</code> рдХреНрд▓рд╛рд╕ рдмрдирд╛рдПрдВ рдЬреЛ <code>GameTileContent</code> рдХреНрд▓рд╛рд╕ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Tower</span></span> : <span class="hljs-title"><span class="hljs-title">GameTileContent</span></span> {}</code> </pre> <br>  рдЖрдк рдХрд╛рд░рдЦрд╛рдиреЗ рдХреЗ рдореИрджрд╛рди рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ <code>Tower</code> рдмрджрд▓рдХрд░ рдЯреЙрд╡рд░ рдкреНрд░реАрдлреИрдм рдХрд╛ рдЕрдкрдирд╛ рдШрдЯрдХ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдЪреВрдБрдХрд┐ рд╡рд░реНрдЧ рдХреЛ рдЕрднреА рднреА рдПрдХ <code>GameTileContent</code> рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреБрдЫ рдФрд░ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИред <br><br><pre> <code class="cs hljs"> Tower towerPrefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><h3>  рдкреВрд░реНрд╡рдирд┐рд░реНрдорд┐рдд </h3><br>  рдЯреЙрд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреНрд░реАрдлреИрдм рдмрдирд╛рдПрдВред  рдЖрдк рджреАрд╡рд╛рд░ <code>GameTileContent</code> рдХреЛ рдбреБрдкреНрд▓рд┐рдХреЗрдЯ рдХрд░рдХреЗ рдФрд░ рдЗрд╕рдХреЗ <code>GameTileContent</code> рдШрдЯрдХ рдХреЛ <code>Tower</code> рдШрдЯрдХ рдХреЗ рд╕рд╛рде рдмрджрд▓рдХрд░ рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдЗрд╕рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ <em>рдЯреЙрд╡рд░ рдореЗрдВ</em> рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВред  рдЯреЙрд╡рд░ рдХреЛ рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдлрд┐рдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЯреЙрд╡рд░ рдХреЗ рдЖрдзрд╛рд░ рдХреЗ рд░реВрдк рдореЗрдВ рджреАрд╡рд╛рд░ рдХреНрдпреВрдм рдХреЛ рдмрдЪрд╛рдПрдВред  рдлрд┐рд░ рдЙрд╕рдХреЗ рдКрдкрд░ рдПрдХ рдФрд░ рдХреНрдпреВрдм рд░рдЦреЗрдВред  рдореИрдВрдиреЗ рдЙрд╕реЗ 0.5 рдХрд╛ рдкреИрдорд╛рдирд╛ рджрд┐рдпрд╛ред  рдЙрд╕ рдкрд░ рдПрдХ рдФрд░ рдХреНрдпреВрдм рд░рдЦреЛ, рдПрдХ рдмреБрд░реНрдЬ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрддреЗ рд╣реБрдП, рдпрд╣ рд╣рд┐рд╕реНрд╕рд╛ рджреБрд╢реНрдордиреЛрдВ рдкрд░ рдирд┐рд╢рд╛рдирд╛ рд▓рдЧрд╛рдПрдЧрд╛ рдФрд░ рдЧреЛрд▓реА рдорд╛рд░ рджреЗрдЧрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/392/e5d/633/392e5d63397672627c3b5ec018df0444.png" width="190" height="260"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d92/dec/c33/d92decc33036a1e973a7f20a3df2c00e.png" width="320" height="120"></div><br>  <i>рдПрдХ рдЯрд╛рд╡рд░ рдмрдирд╛рдиреЗ рд╡рд╛рд▓реЗ рддреАрди рдХреНрдпреВрдмреНрд╕ред</i> <br><br>  рдмреБрд░реНрдЬ рдШреВрдореЗрдЧрд╛, рдФрд░ рдЪреВрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдПрдХ рднреМрддрд┐рдХ рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рдЯреНрд░реИрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЗрддрдирд╛ рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдо рдЯреЙрд╡рд░ рдХреЛрд▓рд╛рдЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ рдХреЛрд╢рд┐рдХрд╛рдУрдВ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рд▓рдЧрднрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдмреБрд░реНрдЬ рдХреНрдпреВрдм рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рд╣рдЯрд╛ рджреЗрдВ рдФрд░ рдЯреЙрд╡рд░ рдХреНрдпреВрдм рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рдмрджрд▓ рджреЗрдВ рддрд╛рдХрд┐ рдпрд╣ рджреЛрдиреЛрдВ рдХреНрдпреВрдмреНрд╕ рдХреЛ рдХрд╡рд░ рдХрд░реЗред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e01/11e/3b7/e0111e3b7221bbbe4e5b0d23373e4b3a.png" width="190" height="260"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a1f/857/09b/a1f85709bd504d176a18930240edea5a.png" width="320" height="152"></div><br>  <i>рдХреЛрд▓рд╛рдЗрдбрд░ рдШрди рдЯреЙрд╡рд░ред</i> <br><br>  рдЯреЙрд╡рд░ рдПрдХ рд▓реЗрдЬрд░ рдмреАрдо рдХреЛ рд╢реВрдЯ рдХрд░реЗрдЧрд╛ред  рдЗрд╕рдХреА рдХрд▓реНрдкрдирд╛ рдХрдИ рддрд░реАрдХреЛрдВ рд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рд╕рд┐рд░реНрдл рдПрдХ рдкрд╛рд░рднрд╛рд╕реА рдШрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕реЗ рд╣рдо рдПрдХ рдмреАрдо рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдлреИрд▓рд╛рдПрдВрдЧреЗред  рдкреНрд░рддреНрдпреЗрдХ рдЯреЙрд╡рд░ рдХрд╛ рдЕрдкрдирд╛ рдмреАрдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдЯреЙрд╡рд░ рдкреНрд░реАрдлрд╝реИрдм рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред  рдЗрд╕реЗ рдмреБрд░реНрдЬ рдХреЗ рдЕрдВрджрд░ рд░рдЦреЗрдВ рддрд╛рдХрд┐ рдпрд╣ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЫрд┐рдкрд╛ рд╣реЛ рдФрд░ рдЗрд╕реЗ рдЫреЛрдЯреЗ рдкреИрдорд╛рдиреЗ рдкрд░ рджреЗ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП 0.2ред  рдЪрд▓реЛ рдЗрд╕реЗ рдкреНрд░реАрдлрдм рд░реВрдЯ рдХрд╛ рдмрдЪреНрдЪрд╛ рдмрдирд╛рддреЗ рд╣реИрдВ, рдмреБрд░реНрдЬ рдХреНрдпреВрдм рдирд╣реАрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/19a/1dc/29e/19a1dc29e70adb158e07f29653db2d66.png" width="190" height="260" alt="рд▓реЗрдЬрд░ рдмреАрдо"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45a/273/081/45a273081365aa9e483f1aa97cbe39c8.png" width="226" height="108" alt="рдЕрдиреБрдХреНрд░рдо"></div><br>  <i>рдПрдХ рд▓реЗрдЬрд░ рдмреАрдо рдХрд╛ рдЫрд┐рдкрд╛ рд╣реБрдЖ рдШрдиред</i> <br><br>  рд▓реЗрдЬрд░ рдмреАрдо рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрдкрдпреБрдХреНрдд рд╕рд╛рдордЧреНрд░реА рдмрдирд╛рдПрдВред  рдореИрдВрдиреЗ рдХреЗрд╡рд▓ рдорд╛рдирдХ рдкрд╛рд░рднрд╛рд╕реА рдХрд╛рд▓реА рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдФрд░ рд╕рднреА рдкреНрд░рддрд┐рдмрд┐рдВрдмреЛрдВ рдХреЛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛, рдФрд░ рдЗрд╕реЗ рдПрдХ рд▓рд╛рд▓ рдЙрддреНрд╕рд░реНрдЬрд┐рдд рд░рдВрдЧ рднреА рджрд┐рдпрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fb/e49/860/2fbe498604cc4cc4ed6ee60a45eea63d.png" width="320" height="284" alt="рд░рдВрдЧ"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0eb/b46/483/0ebb4648376a7fe68c96b7a16ce27db9.png" width="320" height="56" alt="рдХреЛрдИ рдкреНрд░рддрд┐рдмрд┐рдВрдм рдирд╣реАрдВ"></div><br>  <i>рд▓реЗрдЬрд░ рдмреАрдо рдХреА рд╕рд╛рдордЧреНрд░реАред</i> <br><br>  рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдХрд┐ рд▓реЗрдЬрд░ рдмреАрдо рдореЗрдВ рдХреЛрд▓рд╛рдЗрдбрд░ рдирд╣реАрдВ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдХрд╛рд╕реНрдЯ рдФрд░ рдЫрд╛рдпрд╛ рдХреЛ рднреА рдмрдВрдж рдХрд░ рджреЗрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ecf/f21/0ad/ecff210ad75ef4b12cb0a74102365492.png" width="320" height="162"></div><br>  <i>рд▓реЗрдЬрд╝рд░ рдмреАрдо рд╢реИрдбреЛ рд╕реЗ рдЗрдВрдЯрд░реИрдХреНрдЯ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред</i> <br><br>  рдЯреЙрд╡рд░ рдкреНрд░реАрдлреИрдм рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЗрд╕реЗ рдХрд╛рд░рдЦрд╛рдиреЗ рдореЗрдВ рдЬреЛрдбрд╝ рджреЗрдВрдЧреЗред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/626/37c/935/62637c9353cf1e20e170e82bbefcdb11.png" width="320" height="114"></div><br>  <i>рдЯрд╛рд╡рд░ рдХреЗ рд╕рд╛рде рдлреИрдХреНрдЯрд░реАред</i> <br><br><h3>  рдЯреЙрд╡рд░ рдкреНрд▓реЗрд╕рдореЗрдВрдЯ </h3><br>  рд╣рдо рдПрдХ рдФрд░ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВрдЧреЗ рдФрд░ рдирд┐рдХрд╛рд▓реЗрдВрдЧреЗред  рдЖрдк рдмрд╕ рд╡рд┐рдзрд┐ рдирд╛рдо рдФрд░ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рдХрд╛рд░ рдХреЛ рдмрджрд▓рдХрд░ <code>GameBoard.ToggleWall</code> рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleTower</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.TowerтВм) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Empty) { tile.Content = contentFactory.Get(GameTileContentType.TowerтВм); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!FindPaths()) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } } }</code> </pre> <br>  <code>Game.HandleTouch</code> , рд╢рд┐рдлреНрдЯ рдХреА рдХреЛ рдкрдХрдбрд╝рдХрд░ рджреАрд╡рд╛рд░реЛрдВ рдХреА рдмрдЬрд╛рдп рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рд╕реНрд╡рд┐рдЪ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HandleTouch</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile tile = board.GetTile(TouchRay); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKey(KeyCode.LeftShift)) { board.ToggleTower(tile); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { board.ToggleWall(tile); } } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/926/804/2ac/9268042acc19a28d6ff1a6d74d83144f.png" width="230" height="230"></div><br>  <i>рдореИрджрд╛рди рдкрд░ рдЯрд╛рд╡рд░реНрд╕ред</i> <br><br><h3>  рдкрде рдЕрд╡рд░реБрджреНрдз </h3><br>  рдЕрдм рддрдХ, рдХреЗрд╡рд▓ рджреАрд╡рд╛рд░реЗрдВ рдПрдХ рдорд╛рд░реНрдЧ рдХреА рдЦреЛрдЬ рдХреЛ рд░реЛрдХ рд╕рдХрддреА рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рджреБрд╢реНрдорди рдЯрд╛рд╡рд░реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВред  рдЖрдЗрдП <code>GameTileContent</code> рд╕рд╣рд╛рдпрдХ рд╕рдВрдкрддреНрддрд┐ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╕рд╛рдордЧреНрд░реА рдкрде рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддреА рд╣реИ рдпрд╛ рдирд╣реАрдВред  рдЕрдЧрд░ рдпрд╣ рдПрдХ рджреАрд╡рд╛рд░ рдпрд╛ рдЯреЙрд╡рд░ рд╣реИ рддреЛ рд░рд╛рд╕реНрддрд╛ рдЕрд╡рд░реБрджреНрдз рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> BlocksPath =&gt; Type == GameTileContentType.Wall || Type == GameTileContentType.TowerтВм;</code> </pre> <br>  рд╕рд╛рдордЧреНрд░реА рдкреНрд░рдХрд╛рд░ рдХреА рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп <code>GameTile.GrowPathTo</code> рдореЗрдВ рдЗрд╕ рдЧреБрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GrowPathTo</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile neighbor, Direction direction</span></span></span><span class="hljs-function">)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-comment"><span class="hljs-comment">//neighbor.Content.Type != GameTileContentType.Wall ? neighbor : null; neighbor.Content.BlocksPath ? null : neighbor; }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6fa/93f/eed/6fa93feedb4925ee12decb4233612a4c.png" width="230" height="230"></div><br>  <i>рдЕрдм рдкрде рджреАрд╡рд╛рд░реЛрдВ рдФрд░ рдЯрд╛рд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрд╡рд░реБрджреНрдз рд╣реИред</i> <br><br><h3>  рджреАрд╡рд╛рд░реЛрдВ рдХреА рдЬрдЧрд╣ </h3><br>  рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ, рдЦрд┐рд▓рд╛рдбрд╝реА рдЕрдХреНрд╕рд░ рджреАрд╡рд╛рд░реЛрдВ рдХреЛ рдЯрд╛рд╡рд░реЛрдВ рд╕реЗ рдмрджрд▓ рджреЗрдЧрд╛ред  рдпрд╣ рдЙрд╕рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рджреАрд╡рд╛рд░ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛, рдФрд░ рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рджреБрд╢реНрдорди рдЗрд╕ рдЕрд╕реНрдерд╛рдпреА рд░реВрдк рд╕реЗ рджрд┐рдЦрд╛рдИ рдЧрдИ рдЦрд╛рдИ рдореЗрдВ рдШреБрд╕ рд╕рдХрддреЗ рд╣реИрдВред  рдпрджрд┐ рдЯрд╛рдЗрд▓ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЯрд╛рдЗрд▓ рдкрд░ рд╣реИ, рддреЛ рдпрд╣ <code>GameBoard.ToggleTower</code> рд▓рд┐рдП рдЖрдк <code>GameBoard.ToggleTower</code> рдХреЛ рдордЬрдмреВрд░ рдХрд░рдХреЗ рдПрдХ рд╕реАрдзрд╛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рд▓рд╛рдЧреВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрджрд┐ рдРрд╕рд╛ рд╣реИ, рддреЛ рддреБрд░рдВрдд рдЗрд╕реЗ рдПрдХ рдЯреЙрд╡рд░ рдХреЗ рд╕рд╛рде рдмрджрд▓реЗрдВред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рдЕрдиреНрдп рддрд░реАрдХреЛрдВ рдХреА рддрд▓рд╛рд╢ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЯрд╛рдЗрд▓ рдЕрднреА рднреА рдЙрдиреНрд╣реЗрдВ рдмреНрд▓реЙрдХ рдХрд░рддреА рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleTower</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Tower) { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Empty) { тАж } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Wall) { tile.Content = contentFactory.Get(GameTileContentType.Tower); } }</code> </pre> <br><h2>  рд╣рдо рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдирд┐рд╢рд╛рдирд╛ рдмрдирд╛рддреЗ рд╣реИрдВ </h2><br>  рдПрдХ рдЯрд╛рд╡рд░ рдЕрдкрдирд╛ рдХрд╛рдо рддрднреА рдкреВрд░рд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдЙрд╕реЗ рдХреЛрдИ рджреБрд╢реНрдорди рдорд┐рд▓реЗред  рджреБрд╢реНрдорди рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рдмрд╛рдж, рдЙрд╕реЗ рдпрд╣ рддрдп рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдЗрд╕рдХрд╛ рдХреМрди рд╕рд╛ рд╣рд┐рд╕реНрд╕рд╛ рд▓рдХреНрд╖реНрдп рдХрд░рдирд╛ рд╣реИред <br><br><h3>  рд▓рдХреНрд╖реНрдп рдХреА рдУрд░ рдЗрд╢рд╛рд░рд╛ рдХрд░рддреЗ рд╣реБрдП </h3><br>  рд▓рдХреНрд╖реНрдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рднреМрддрд┐рдХреА рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдЬреИрд╕реЗ рдХрд┐ рдЯреЙрд╡рд░ рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╣рдореЗрдВ рдЬрд░реВрд░реА рдирд╣реАрдВ рдХрд┐ рджреБрд╢реНрдорди рдХреЗ рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рдЙрд╕рдХреЗ рдЖрдХрд╛рд░ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрдк рд╕рдмрд╕реЗ рд╕рд░рд▓ рдХреЛрд▓рд╛рдЗрдбрд░ рдЪреБрди рд╕рдХрддреЗ рд╣реИрдВ, рдЬреЛ рдХрд┐ рдПрдХ рдЧреЛрд▓рд╛ рд╣реИред  рджреБрд╢реНрдорди рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рд▓рдХреНрд╖реНрдп рдХреЗ рд▓рд┐рдП рдПрдХ рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕рд╕реЗ рдЬреБрдбрд╝реЗ рд╣реБрдП рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЗ рд╕рд╛рде рдХрд░реЗрдВрдЧреЗред <br><br>  рд╣рдо рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рджреБрд╢реНрдорди рдХреА рдореВрд▓ рд╡рд╕реНрддреБ рд╕реЗ рдирд╣реАрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдореЗрд╢рд╛ рдореЙрдбрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ рдФрд░ рдЯреЙрд╡рд░ рдХреЛ рдЬрдореАрди рдкрд░ рдмрдирд╛рдПрдЧрд╛ред  рдпрд╣реА рд╣реИ, рдЖрдкрдХреЛ рдХреЙрд▓рд░ рдХреЛ рдореЙрдбрд▓ рдкрд░ рдХрд╣реАрдВ рд░рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рднреМрддрд┐рдХреА рдЗрдВрдЬрди рд╣рдореЗрдВ рдЗрд╕ рд╡рд╕реНрддреБ рдХрд╛ рдПрдХ рд▓рд┐рдВрдХ рджреЗрдЧрд╛, рдЬрд┐рд╕реЗ рд╣рдо рд▓рдХреНрд╖реНрдп рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рд░реВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ <code>Enemy</code> рдШрдЯрдХ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдХрд╛рд░реНрдп рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <code>TargetPoint</code> рдШрдЯрдХ <code>TargetPoint</code> рд╣реИрдВред  рдЖрдЗрдП рдЗрд╕реЗ рдирд┐рдЬреА рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдФрд░ <code>Enemy</code> рдШрдЯрдХ рдХреА рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд░рд╕реАрдж рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдкрддреНрддрд┐ рджреЗрдВ, рдФрд░ рджреБрдирд┐рдпрд╛ рдореЗрдВ рдЕрдкрдиреА рд╕реНрдерд┐рддрд┐ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ рд╕рдВрдкрддреНрддрд┐ред <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TargetPoint</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Enemy EnemyтВм { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Vector3 Position =&gt; transform.position; }</code> </pre> <br>  рдЖрдЗрдП рдЗрд╕реЗ рдПрдХ <code>Awake</code> рд╡рд┐рдзрд┐ рджреЗрдВ рдЬреЛ рдЕрдкрдиреЗ <code>Enemy</code> рдШрдЯрдХ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рддрд╛ рд╣реИред  <code>transform.root</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрдзреЗ рд░реВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ рдЬрд╛рдПрдВред  рдпрджрд┐ <code>Enemy</code> рдШрдЯрдХ рдореМрдЬреВрдж рдирд╣реАрдВ рд╣реИ, рддреЛ рд╣рдордиреЗ рджреБрд╢реНрдорди рдмрдирд╛рддреЗ рд╕рдордп рдПрдХ рдЧрд▓рддреА рдХреА рд╣реИ, рддреЛ рдЖрдЗрдП рдЗрд╕рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдпрд╛рди рдЬреЛрдбрд╝реЗрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { EnemyтВм = transform.root.GetComponent&lt;Enemy&gt;(); Debug.Assert(EnemyтВм != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Target point without Enemy root!"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рдЙрд╕реА рдЧреЗрдо рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдЬреЛрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рд╕реЗ <code>TargetPoint</code> рдЬреБрдбрд╝рд╛ рд╣реБрдЖ рд╣реИред <br><br><pre> <code class="cs hljs"> Debug.Assert(EnemyтВм != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Target point without Enemy root!"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); Debug.Assert( GetComponent&lt;SphereCollider&gt;() != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Target point without sphere collider!"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> );</code> </pre> <br>  рджреБрд╢реНрдорди рдХреЗ рдкреНрд░реАрдлреИрдм рдХреНрдпреВрдм рдореЗрдВ рдПрдХ рдШрдЯрдХ рдФрд░ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рдЬреЛрдбрд╝реЗрдВред  рдпрд╣ рдХреНрдпреВрдм рдХреЗ рдХреЗрдВрджреНрд░ рдореЗрдВ рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рд▓рдХреНрд╖реНрдп рдмрдирд╛рдПрдЧрд╛ред  рд╣рдо 0.25 рдХреА рддреНрд░рд┐рдЬреНрдпрд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдЧреЛрд▓рд╛рдХрд╛рд░ рдХреЛрд▓рд╛рдЗрдбрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдХреНрдпреВрдм рдХрд╛ рд╕реНрдХреЗрд▓ 0.5 рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХреЛрд▓рд╛рдЗрдбрд░ рдХрд╛ рд╕рд╣реА рддреНрд░рд┐рдЬреНрдпрд╛ 0.125 рд╣реЛрдЧрд╛ред  рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рджреБрд╢реНрдорди рдХреЛ рдиреЗрддреНрд░рд╣реАрди рд░реВрдк рд╕реЗ рдЯреЙрд╡рд░ рдХреЗ рд░реЗрдВрдЬ рд╕рд░реНрдХрд▓ рдХреЛ рдкрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдХреБрдЫ рд╕рдордп рдмрд╛рдж рд╣реА рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд▓рдХреНрд╖реНрдп рдмрди рдЬрд╛рдПрдЧрд╛ред  рдХреЛрд▓рд╛рдЗрдбрд░ рдХрд╛ рдЖрдХрд╛рд░ рднреА рджреБрд╢реНрдорди рдХреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкреИрдорд╛рдиреЗ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЦреЗрд▓ рдореЗрдВ рдЗрд╕рдХрд╛ рдЖрдХрд╛рд░ рднреА рдереЛрдбрд╝рд╛ рднрд┐рдиреНрди рд╣реЛрдЧрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85e/5ca/5e4/85e5ca5e47b8d59fa4211c78126bd512.png" width="176" height="176"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/a71/aec/7aea71aecbd64d4e045df141ecd1c711.png" width="320" height="176" alt="рдЗрдВрд╕реНрдкреЗрдХреНрдЯрд░"></div><br>  <i>рдПрдХ рд▓рдХреНрд╖реНрдп рдмрд┐рдВрджреБ рдХреЗ рд╕рд╛рде рдПрдХ рджреБрд╢реНрдорди рдФрд░ рдПрдХ рдШрди рдкрд░ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ред</i> <br><br><h3>  рд╢рддреНрд░реБ рдкрд░рдд </h3><br>  рдЯрд╛рд╡рд░реНрд╕ рдХреЗрд╡рд▓ рджреБрд╢реНрдордиреЛрдВ рдХреА рджреЗрдЦрднрд╛рд▓ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рд╡реЗ рдХрд┐рд╕реА рдФрд░ рдЪреАрдЬ рдХрд╛ рд▓рдХреНрд╖реНрдп рдирд╣реАрдВ рд░рдЦрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕рднреА рджреБрд╢реНрдордиреЛрдВ рдХреЛ рдПрдХ рдЕрд▓рдЧ рдкрд░рдд рдореЗрдВ рдбрд╛рд▓ рджреЗрдВрдЧреЗред  рд╣рдо рдкрд░рдд 9 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред рдЗрд╕рдХрд╛ рдирд╛рдо <em>рд╢рддреНрд░реБ</em> рдХреЛ <em>рд▓реЗрдпрд░реНрд╕ рдПрдВрдб рдЯреИрдЧ</em> рд╡рд┐рдВрдбреЛ рдореЗрдВ рдмрджрд▓реЗрдВ, рдЬрд┐рд╕реЗ рдПрдбрд┐рдЯрд░ рдХреЗ рдКрдкрд░реА рджрд╛рдПрдВ рдХреЛрдиреЗ рдореЗрдВ <em>рд▓реЗрдпрд░реНрд╕</em> рдбреНрд░реЙрдк-рдбрд╛рдЙрди рдореЗрдиреВ рдореЗрдВ <em>рдПрдбрд┐рдЯ рд▓реЗрдпрд░реНрд╕</em> рд╡рд┐рдХрд▓реНрдк рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8e6/9a5/762/8e69a5762e8eb1856175f9d9dc1ab388.png" width="320" height="308"></div><br>  <i>рд▓реЗрдпрд░ 9 рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рджреБрд╢реНрдордиреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</i> <br><br>  рдпрд╣ рдкрд░рдд рдХреЗрд╡рд▓ рджреБрд╢реНрдордиреЛрдВ рдХреА рдорд╛рдиреНрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рди рдХрд┐ рднреМрддрд┐рдХ рд╕рдВрдмрдВрдзреЛрдВ рдХреЗ рд▓рд┐рдПред  рдЖрдЗрдП рдЗрд╕реЗ <em>рд▓реЗрдпрд░ рдХреЛрд▓рд┐рд╢рди рдореИрдЯреНрд░рд┐рдХреНрд╕</em> рдореЗрдВ рдЕрдХреНрд╖рдо рдХрд░рдХреЗ рдЗрдВрдЧрд┐рдд рдХрд░реЗрдВ, рдЬреЛ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ <em>рднреМрддрд┐рдХреА</em> рдкреИрдирд▓ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/876/06e/e7d/87606ee7dfc4777760d81219517125ce.png" width="200" height="200"></div><br>  <i>рдкрд░рдд рдХреА рдЯрдХрд░рд╛рд╡ рдХреА рдореИрдЯреНрд░рд┐рдХреНрд╕ред</i> <br><br>  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд▓рдХреНрд╖реНрдп рдмрд┐рдВрджреБ рдХреЗ рдЦреЗрд▓ рд╡рд╕реНрддреБ рд╡рд╛рдВрдЫрд┐рдд рдкрд░рдд рдкрд░ рд╣реИред  рджреБрд╢реНрдорди рдХреЗ рдмрд╛рдХреА рдкреНрд░реАрдлреИрдм рдЕрдиреНрдп рдкрд░рддреЛрдВ рдкрд░ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╕рдм рдХреБрдЫ рд╕рдордиреНрд╡рдп рдХрд░рдирд╛ рдФрд░ рдкреВрд░реЗ рдкреНрд░реАрдлреИрдм рдХреЛ <em>рджреБрд╢реНрдорди рдХреА</em> рдкрд░рдд рдореЗрдВ рд░рдЦрдирд╛ рдЖрд╕рд╛рди рд╣реЛрдЧрд╛ред  рдпрджрд┐ рдЖрдк рд░реВрдЯ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреА рдкрд░рдд рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдЙрд╕рдХреЗ рд╕рднреА рдЪрд╛рдЗрд▓реНрдб рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд▓реЗрдпрд░ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЗрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d1/f75/062/6d1f75062420abadb285e9efca1e1a5e.png" width="320" height="44"></div><br>  <i>рд╕рд╣реА рдкрд░рдд рдкрд░ рджреБрд╢реНрдордиред</i> <br><br>  рдЪрд▓рд┐рдП рдЗрд╕ рдХрдерди рдХреЛ <code>TargetPoint</code> рдХрд┐ <code>TargetPoint</code> рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд╕рд╣реА рдкрд░рдд рдкрд░ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж Debug.Assert(gameObject.layer == <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">"Target point on wrong layer!"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЦрд┐рд▓рд╛рдбрд╝реА рдХреА рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рджреБрд╢реНрдорди рдХреЗ рд╕рд╛рдерд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдирджреЗрдЦрд╛ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ <code>GameBoard.GetTile</code> рдореЗрдВ <code>GameBoard.GetTile</code> рдореЗрдВ рдПрдХ рд▓реЗрдпрд░ рдорд╛рд╕реНрдХ рддрд░реНрдХ рдЬреЛрдбрд╝рдХрд░ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕ рд╡рд┐рдзрд┐ рдореЗрдВ рдПрдХ рд░реВрдк рд╣реИ рдЬреЛ рдЕрддрд┐рд░рд┐рдХреНрдд рддрд░реНрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдмреАрдо рдФрд░ рдкрд░рдд рдореБрдЦреМрдЯрд╛ рдХреА рджреВрд░реА рдХреЛ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдо рдЗрд╕реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрдзрд┐рдХрддрдо рджреВрд░реА рдФрд░ рдкрд░рдд рдХрд╛ рдореБрдЦреМрдЯрд╛ рджреЗрдВрдЧреЗ, рдЕрд░реНрдерд╛рдд 1ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GameTile </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetTile</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Ray ray</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Physics.Raycast(ray, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> RaycastHit hit, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>.MaxValue, <span class="hljs-number"><span class="hljs-number">1</span></span>)) { тАж } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдкрд░рдд рдореБрдЦреМрдЯрд╛ 0 рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП?</b> <div class="spoiler_text">  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд▓реЗрдпрд░ рдЗрдВрдбреЗрдХреНрд╕ рд╢реВрдиреНрдп рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдо рд▓реЗрдпрд░ рдорд╛рд╕реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рдкрд░рдд рдХреЛ рдЪрд╛рд▓реВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рддреЛ рдореБрдЦреМрдЯрд╛ рдкреВрд░реНрдгрд╛рдВрдХ рдХреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдмрд┐рдЯреНрд╕ рдХреЛ 1 рдореЗрдВ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдкрд╣рд▓рд╛ рдмрд┐рдЯ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рд╕рдмрд╕реЗ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ 2 <sup>0</sup> , рдЬреЛ 1 рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИред </div></div><br><h3>  рдЕрджреНрдпрддрди рдЯрд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА </h3><br>  рдЯрд╛рд╡рд░реНрд╕ рддрднреА рдЕрдкрдирд╛ рдХрд╛рд░реНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрдм рдЙрдирдХреА рд╕реНрдерд┐рддрд┐ рдЕрдкрдбреЗрдЯ рд╣реЛред  рд╡рд╣реА рдкреВрд░реА рдЯрд╛рдЗрд▓ рдХреА рд╕рд╛рдордЧреНрд░реА рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдмрд╛рдХреА рд╕рд╛рдордЧреНрд░реА рдЕрдм рддрдХ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░рддреА рд╣реИред  рдЗрд╕рд▓рд┐рдП, <code>GameTileContent</code> рдПрдХ <code>GameTileContent</code> рд╡рд░реНрдЪреБрдЕрд▓ рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдХреБрдЫ рднреА рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {}</code> </pre> <br>  рдЪрд▓реЛ <code>Tower</code> рдлрд┐рд░ рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рднрд▓реЗ рд╣реА рдЕрднреА рдХреЗ рд▓рд┐рдП рдпрд╣ рдХреЗрд╡рд▓ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдПрдХ рд▓рдХреНрд╖реНрдп рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Searching for target..."</span></span>); }</code> </pre> <br>  <code>GameBoard</code> рдЯрд╛рдЗрд▓реЛрдВ рдФрд░ рдЙрдирдХреА рд╕рд╛рдордЧреНрд░реА рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдЗрд╕ рдмрд╛рдд рдкрд░ рднреА рдирдЬрд╝рд░ рд░рдЦреЗрдЧрд╛ рдХрд┐ рдХрд┐рд╕ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕рдореЗрдВ рд╕реВрдЪреА рдФрд░ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ <code>GameUpdate</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ, рдЬреЛ рд╕реВрдЪреА рдореЗрдВ рд╕рдм рдХреБрдЫ рдЕрдкрдбреЗрдЯ рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> List&lt;GameTileContent&gt; updatingContent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;GameTileContent&gt;(); тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; updatingContent.Count; i++) { updatingContent[i].GameUpdate(); } }</code> </pre> <br>  рд╣рдорд╛рд░реЗ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдореЗрдВ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  <code>ToggleTower</code> рдмрджрд▓реЗрдВ рддрд╛рдХрд┐ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рд╕рд╛рдордЧреНрд░реА рдХреЛ рдЬреЛрдбрд╝реЗ рдФрд░ <code>ToggleTower</code> ред  рдпрджрд┐ рдЕрдиреНрдп рд╕рд╛рдордЧреНрд░реА рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рддреЛ рд╣рдореЗрдВ рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдЕрднреА рдХреЗ рд▓рд┐рдП, рдпрд╣ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToggleTower</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameTile tile</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Tower) { updatingContent.Remove(tile.Content); tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tile.Content.Type == GameTileContentType.Empty) { tile.Content = contentFactory.Get(GameTileContentType.Tower); <span class="hljs-comment"><span class="hljs-comment">//if (!FindPaths()) { if (FindPaths()) { updatingContent.Add(tile.Content); } else { tile.Content = contentFactory.Get(GameTileContentType.Empty); FindPaths(); } } else if (tile.Content.Type == GameTileContentType.Wall) { tile.Content = contentFactory.Get(GameTileContentType.Tower); updatingContent.Add(tile.Content); } }</span></span></code> </pre> <br>  рдпрд╣ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдм рд╣рдорд╛рд░реЗ рд▓рд┐рдП <code>Game.Update</code> рдореЗрдВ рдХреЗрд╡рд▓ рдлрд╝реАрд▓реНрдб рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ <code>Game.Update</code> ред  рд╣рдо рджреБрд╢реНрдордиреЛрдВ рдХреЗ рдмрд╛рдж рдХреНрд╖реЗрддреНрд░ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░реЗрдВрдЧреЗред  рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдЯрд╛рд╡рд░реНрд╕ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рдХреНрд╖реНрдп рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ рдЬрд╣рд╛рдВ рджреБрд╢реНрдорди рд╣реИрдВред  рдпрджрд┐ рд╣рдо рдЕрдиреНрдпрдерд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЯрд╛рд╡рд░реЛрдВ рдХрд╛ рд▓рдХреНрд╖реНрдп рд╣реЛрдЧрд╛ рдХрд┐ рджреБрд╢реНрдорди рдЕрдВрддрд┐рдо рд╕реАрдорд╛ рдореЗрдВ рдХрд╣рд╛рдВ рдереЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж enemies.GameUpdate(); board.GameUpdate(); }</code> </pre> <br><h3>  рд▓рдХреНрд╖реНрдп рдХреА рд╕реАрдорд╛ </h3><br>  рдЯрд╛рд╡рд░реНрд╕ рдХрд╛ рдПрдХ рд╕реАрдорд┐рдд рд▓рдХреНрд╖реНрдп рддреНрд░рд┐рдЬреНрдпрд╛ рд╣реИред  <code>Tower</code> рд╡рд░реНрдЧ рдореЗрдВ рдПрдХ рдлрд╝реАрд▓реНрдб рдЬреЛрдбрд╝рдХрд░ рдЗрд╕реЗ рдХрд╕реНрдЯрдо рдмрдирд╛рддреЗ рд╣реИрдВред  рджреВрд░реА рдХреЛ рдЯреЙрд╡рд░ рдЯрд╛рдЗрд▓ рдХреЗ рдХреЗрдВрджреНрд░ рд╕реЗ рдорд╛рдкрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП 0.5 рдХреА рд╕реАрдорд╛ рдкрд░ рдпрд╣ рдХреЗрд╡рд▓ рдЕрдкрдиреА рдЯрд╛рдЗрд▓ рдХреЛ рдХрд╡рд░ рдХрд░реЗрдЧрд╛ред  рдЗрд╕рд▓рд┐рдП, рдЕрдзрд┐рдХрд╛рдВрд╢ рдкрдбрд╝реЛрд╕реА рдЯрд╛рдЗрд▓реНрд╕ рдХреЛ рдХрд╡рд░ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рдЙрдЪрд┐рдд рдиреНрдпреВрдирддрдо рдФрд░ рдорд╛рдирдХ рд╕реАрдорд╛ 1.5 рд╣реЛрдЧреАред <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(1.5f, 10.5f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> targetingRange = <span class="hljs-number"><span class="hljs-number">1.5f</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c38/ae4/ee8/c38ae4ee885cf5d89f24164b9c6bc5fe.png" width="320" height="74"></div><br>  <i>рд╕реАрдорд╛ 2.5 рдХрд╛ рд▓рдХреНрд╖реНрдпред</i> <br><br>  рдЪрд▓реЛ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде рд░реЗрдВрдЬ рдХрд▓реНрдкрдирд╛ред  рд╣рдореЗрдВ рдЗрд╕реЗ рд▓рдЧрд╛рддрд╛рд░ рджреЗрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдХреЗрд╡рд▓ рдЪрдпрдирд┐рдд рдСрдмреНрдЬреЗрдХреНрдЯреНрд╕ рдХреЗ рд▓рд┐рдП <code>OnDrawGizmosSelected</code> рдкрджреНрдзрддрд┐ рдХреЛ <code>OnDrawGizmosSelected</code> ред  рд╣рдо рдЧреЛрд▓реЗ рдХреЗ рдкреАрд▓реЗ рдлреНрд░реЗрдо рдХреЛ рдПрдХ рддреНрд░рд┐рдЬреНрдпрд╛ рдХреЗ рд╕рд╛рде рджреВрд░реА рдХреЗ рдмрд░рд╛рдмрд░ рдЦреАрдВрдЪрддреЗ рд╣реИрдВ рдФрд░ рдЯреЙрд╡рд░ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕реЗ рдЬрдореАрди рд╕реЗ рдереЛрдбрд╝рд╛ рдКрдкрд░ рд░рдЦреЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╣рдореЗрд╢рд╛ рд╕реНрдкрд╖реНрдЯ рджрд┐рдЦрд╛рдИ рджреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmosSelected</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Gizmos.color = Color.yellow; Vector3 position = transform.localPosition; position.y += <span class="hljs-number"><span class="hljs-number">0.01f</span></span>; Gizmos.DrawWireSphere(position, targetingRange); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/674/6b7/3cd/6746b73cd2e015fd599b770bb89e1c8a.png" width="230" height="230"></div><br>  <i>Gizmo рд▓рдХреНрд╖реНрдп рд╕реАрдорд╛ред</i> <br><br>  рдЕрдм рд╣рдо рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рд╡рд░реЛрдВ рдореЗрдВ рд╕реЗ рдХреМрди рд╕рд╛ рджреБрд╢реНрдорди рдПрдХ рдХрд┐рдлрд╛рдпрддреА рд▓рдХреНрд╖реНрдп рд╣реИред  рд▓реЗрдХрд┐рди рджреГрд╢реНрдп рдЦрд┐рдбрд╝рдХреА рдореЗрдВ рдЯреЙрд╡рд░ рдЪреБрдирдирд╛ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╣рдореЗрдВ рдмрдЪреНрдЪреЗ рдХреЗ рдХреНрдпреВрдмреНрд╕ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рдЪрдпрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдФрд░ рдлрд┐рд░ рдЯреЙрд╡рд░ рдХреЗ рдореВрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЕрдиреНрдп рдкреНрд░рдХрд╛рд░ рдХреА рдЯрд╛рдЗрд▓ рд╕рд╛рдордЧреНрд░реА рднреА рдЗрд╕реА рд╕рдорд╕реНрдпрд╛ рд╕реЗ рдЧреНрд░рд╕реНрдд рд╣реИрдВред  рд╣рдо рджреГрд╢реНрдп рд╡рд┐рдВрдбреЛ рдореЗрдВ <code>GameTileContent</code> рд╕рд╛рдордЧреНрд░реА рдХреЗ рд░реВрдЯ рдХреЗ <code>SelectionBase</code> рдХреЛ <code>GameTileContent</code> рдореЗрдВ <code>SelectionBase</code> рд╡рд┐рд╢реЗрд╖рддрд╛ рдЬреЛрдбрд╝рдХрд░ <code>GameTileContent</code> ред <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">SelectionBase</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameTileContent</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { тАж }</code> </pre> <br><h3>  рд▓рдХреНрд╖реНрдп рдкрд░ рдХрдмреНрдЬрд╛ </h3><br>  <code>Tower</code> рдХреНрд▓рд╛рд╕ рдореЗрдВ рдПрдХ <code>TargetPoint</code> рдлреАрд▓реНрдб рдЬреЛрдбрд╝реЗрдВ рддрд╛рдХрд┐ рд╡рд╣ рдЕрдкрдиреЗ рдХрдмреНрдЬреЗ рд╡рд╛рд▓реЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдЯреНрд░реИрдХ рдХрд░ рд╕рдХреЗред  рдлрд┐рд░ рд╣рдо рдирдИ <code>AquireTarget</code> рдкрджреНрдзрддрд┐ рдХреЛ рдХреЙрд▓ <code>GameUpdate</code> рдХреЛ <code>GameUpdate</code> , рдЬреЛ рд▓рдХреНрд╖реНрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдкрд░, рдпрд╣ рдХрдВрд╕реЛрд▓ рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ред <br><br><pre> <code class="cs hljs"> TargetPoint target; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (AcquireTarget()) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Acquired target!"</span></span>); } }</code> </pre> <br>  <code>AcquireTarget</code> рд╣рдо <code>AcquireTarget</code> рдХреЛ рдПрдХ рдЯрд╛рд╡рд░ рдХреА рд╕реНрдерд┐рддрд┐ рдФрд░ рддрд░реНрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реАрдорд╛ рдкрд░ рдХреЙрд▓ рдХрд░рдХреЗ рд╕рднреА рдЙрдкрд▓рдмреНрдз рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдПрдХ <code>Collider</code> рд╕рд░рдгреА рд╣реЛрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА <code>Collider</code> рдЧреЛрд▓рд╛ рдХреЗ рд╕рдВрдкрд░реНрдХ рдореЗрдВ рд╣реЛрдВрдЧреЗред  рдпрджрд┐ рд╕рд░рдгреА рдХреА рд▓рдВрдмрд╛рдИ рд╕рдХрд╛рд░рд╛рддреНрдордХ рд╣реИ, рддреЛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд▓рдХреНрд╖реНрдп рдмрд┐рдВрджреБ рд╣реИ, рдФрд░ рд╣рдо рдмрд╕ рдкрд╣рд▓реЗ рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХрд╛ <code>TargetPoint</code> рдШрдЯрдХ рд▓реЗрдВ, рдЬреЛ рд╣рдореЗрд╢рд╛ рдореМрдЬреВрдж рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЗрд╕реЗ рд▓рдХреНрд╖реНрдп рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдЕрд╕рд╛рдЗрди рдХрд░реЗрдВ рдФрд░ рд╕рдлрд▓рддрд╛ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░реЗрдВред  рдЕрдиреНрдпрдерд╛, рд╣рдо рд▓рдХреНрд╖реНрдп рдХреЛ рд╕рд╛рдлрд╝ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╡рд┐рдлрд▓рддрд╛ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcquireTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Collider[] targets = Physics.OverlapSphere( transform.localPosition, targetingRange ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (targets.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { target = targets[<span class="hljs-number"><span class="hljs-number">0</span></span>].GetComponent&lt;TargetPoint&gt;(); Debug.Assert(target != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Targeted non-enemy!"</span></span>, targets[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  рд╣рдо рд╕рд╣реА рд▓рдХреНрд╖реНрдп рдмрд┐рдВрджреБ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддреЗ рд╣реИрдВ, рдЕрдЧрд░ рд╣рдо рдХреЗрд╡рд▓ рджреБрд╢реНрдордиреЛрдВ рдХреА рдкрд░рдд рдкрд░ рдХреЛрд▓рд╛рдбрд░ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реИрдВред  рдпрд╣ рд▓реЗрдпрд░ 9 рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╕рдВрдмрдВрдзрд┐рдд рд▓реЗрдпрд░ рдорд╛рд╕реНрдХ рдХреЛ рдкрд╛рд╕ рдХрд░реЗрдВрдЧреЗред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> enemyLayerMask = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcquireTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Collider[] targets = Physics.OverlapSphere( transform.localPosition, targetingRange, enemyLayerMask ); тАж }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдпрд╣ рдмрд┐рдЯрдорд╛рд╕реНрдХ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ?</b> <div class="spoiler_text">  рдЪреВрдБрдХрд┐ рджреБрд╢реНрдорди рдХреА рдкрд░рдд рдореЗрдВ 9 рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдмрд┐рдЯрдореЗрд╕реНрдХ рдХреЗ рджрд╕рд╡реЗрдВ рдмрд┐рдЯ рдХрд╛ рдорд╛рди 1 рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рдПрдХ рдкреВрд░реНрдгрд╛рдВрдХ 2 <sup>9</sup> рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ 512 рд╣реИред рд▓реЗрдХрд┐рди рдЗрд╕ рддрд░рд╣ рдХрд╛ рдмрд┐рдЯрдХреЙрдЗрди рд░рд┐рдХреЙрд░реНрдб рдЕрдирдЗрдВрд╕реНрдЯрд┐рдЯреНрдпреВрдЯ рд╣реИред  рд╣рдо рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рд╢рд╛рдмреНрджрд┐рдХ рднреА рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП <code>0b10_0000_0000</code> , рд▓реЗрдХрд┐рди рдлрд┐рд░ рд╣рдореЗрдВ рд╢реВрдиреНрдп рдЧрд┐рдирдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рд╕рдмрд╕реЗ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд╛рдПрдВ рд╢рд┐рдлреНрдЯ рдСрдкрд░реЗрдЯрд░ <code>&lt;&lt;</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдмрд┐рдЯреНрд╕ рдХреЛ рдмрд╛рдИрдВ рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЬреЛ рджреЛ рдХреА рд╢рдХреНрддрд┐ рдореЗрдВ рдПрдХ рд╕рдВрдЦреНрдпрд╛ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред </div></div><br>  рдЖрдк рдЯреЙрд╡рд░ рдФрд░ рд▓рдХреНрд╖реНрдп рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдмреАрдЪ рдПрдХ рдЙрдкрдпреЛрдЧреА рд░реЗрдЦрд╛ рдЦреАрдВрдЪрдХрд░ рдХреИрдкреНрдЪрд░ рдХрд┐рдП рдЧрдП рд▓рдХреНрд╖реНрдп рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrawGizmosSelected</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (target != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Gizmos.DrawLine(position, target.Position); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7a5/e99/4be/7a5e994be6b7d848c2d4bfe7d627c708.png" width="230" height="230"></div><br>  <i>рд▓рдХреНрд╖реНрдпреЛрдВ рдХрд╛ рджреГрд╢реНрдпред</i> <br><br><div class="spoiler">  <b class="spoiler_title">OnTriggerEnter рдЬреИрд╕реА рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдХрд░реЗрдВ?</b> <div class="spoiler_text">  рдХреНрд░реЙрд╕-рдХрдЯрд┐рдВрдЧ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЬрд╛рдВрдЪрдиреЗ рдХрд╛ рд▓рд╛рдн рдпрд╣ рд╣реИ рдХрд┐ рд╣рдо рдХреЗрд╡рд▓ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдиреЗ рдкрд░ рд╣реА рдРрд╕рд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрджрд┐ рдЯреЙрд╡рд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╣реИ, рддреЛ рд▓рдХреНрд╖реНрдпреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдХрд╛рд░рдг рдирд╣реАрдВ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ рд╕рдордп рдореЗрдВ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рд╕реЗ, рд╣рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдЯреЙрд╡рд░ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рд▓рдХреНрд╖реНрдпреЛрдВ рдХреА рд╕реВрдЪреА рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░рдиреА рд╣реИ, рдЬреЛ рд▓рдЧрд╛рддрд╛рд░ рдмрджрд▓ рд░рд╣реА рд╣реИред </div></div><br><h3>  рдЯрд╛рд░рдЧреЗрдЯ рд▓реЙрдХ </h3><br>  рдХрдмреНрдЬрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЧрдпрд╛ рд▓рдХреНрд╖реНрдп рдЙрд╕ рдХреНрд░рдо рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рднреМрддрд┐рдХ рдЗрдВрдЬрди рджреНрд╡рд╛рд░рд╛ рджрд░реНрд╢рд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рддреН, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдордирдорд╛рдирд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдпрд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ рдХрд┐ рдХрдмреНрдЬрд╛ рдХрд┐рдП рдЧрдП рд▓рдХреНрд╖реНрдп рдмрд┐рдирд╛ рдХрд┐рд╕реА рдХрд╛рд░рдг рдХреЗ рдмрджрд▓ рд░рд╣реЗ рд╣реИрдВред  рдЯреЙрд╡рд░ рдХреЛ рд▓рдХреНрд╖реНрдп рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдЙрд╕рдХреЗ рд▓рд┐рдП рдЙрд╕реЗ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рдФрд░ рджреВрд╕рд░реЗ рдкрд░ рд╕реНрд╡рд┐рдЪ рди рдХрд░рдирд╛ рдЕрдзрд┐рдХ рддрд░реНрдХрд╕рдВрдЧрдд рд╣реИред  рдПрдХ <code>TrackTarget</code> рд╡рд┐рдзрд┐ рдЬреЛрдбрд╝реЗрдВ рдЬреЛ рдЗрд╕ рддрд░рд╣ рдХреЗ рдЯреНрд░реИрдХрд┐рдВрдЧ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рд╕рдлрд▓ рд░рд╣рд╛ред  рдпрджрд┐ рд╣рдо рд▓рдХреНрд╖реНрдп рдкрд░ рдХрдмреНрдЬрд╛ рдХрд░ рд▓реЗрддреЗ рд╣реИрдВ, рддреЛ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рд╣рдо рдЖрдкрдХреЛ рдмрддрд╛рдПрдВрдЧреЗ <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TrackTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (target == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  рд╣рдо <code>GameUpdate</code> рдореЗрдВ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдХреЗрд╡рд▓ рддрднреА рдЬрдм рд╣рдо рд╡рд╛рдкрд╕ рд▓реМрдЯреЗрдВрдЧреЗ, рд╣рдо <code>AcquireTarget</code> рдХреЙрд▓ <code>AcquireTarget</code> ред  рдпрджрд┐ рд╡рд┐рдзрд┐ рд╕рд╣реА рд╣реИ, рддреЛ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рд▓рдХреНрд╖реНрдп рд╣реИред  рдпрд╣ рдУрдЖрд░ рдСрдкрд░реЗрдЯрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЪреЗрдХ рдЪреЗрдХ рдореЗрдВ рджреЛрдиреЛрдВ рд╡рд┐рдзрд┐ рдХреЙрд▓ рд░рдЦрдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрджрд┐ рдкрд╣рд▓рд╛ рдСрдкрд░реЗрдВрдб <code>true</code> , рддреЛ рджреВрд╕рд░рд╛ рдЪреЗрдХ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдХреЙрд▓ рдорд┐рд╕ рд╣реЛ рдЬрд╛рдПрдЧреАред  AND рдСрдкрд░реЗрдЯрд░ рд╕рдорд╛рди рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TrackTarget() || AcquireTarget()) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Locked on target!"</span></span>); } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8ec/27c/0a2/8ec27c0a2201434cba3725621b68aaa1.png" width="230" height="230"></div><br>  <i>рдЯреНрд░реИрдХрд┐рдВрдЧ рд▓рдХреНрд╖реНрдпред</i> <br><br>  рдирддреАрдЬрддрди, рдЯрд╛рд╡рд░реЛрдВ рдХреЛ рд▓рдХреНрд╖реНрдп рдкрд░ рддрдп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдпрд╣ рдЕрдВрддрд┐рдо рдмрд┐рдВрджреБ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИ рдФрд░ рдирд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдпрджрд┐ рдЖрдк рджреБрд╢реНрдордиреЛрдВ рдХрд╛ рдмрд╛рд░-рдмрд╛рд░ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдХреЗ рдмрдЬрд╛рдп рдЖрдкрдХреЛ рд▓рд┐рдВрдХ рдХреА рд╢реБрджреНрдзрддрд╛ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреИрд╕рд╛ рдХрд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдСрдмреНрдЬреЗрдХреНрдЯ рдореИрдиреЗрдЬрдореЗрдВрдЯ</a> рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдЖрдВрдХрдбрд╝реЛрдВ рдХреЗ рд▓рд┐рдВрдХ рдХреЗ рд╕рд╛рде рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рд▓рдХреНрд╖реНрдп рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрдм рд╡реЗ рд╕реАрдорд╛ рдХреЗ рднреАрддрд░ рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ <code>TrackTarget</code> рдХреЛ рдЯреЙрд╡рд░ рдФрд░ рд▓рдХреНрд╖реНрдп рдХреЗ рдмреАрдЪ рдХреА рджреВрд░реА рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрджрд┐ рдпрд╣ рд╕реАрдорд╛ рдорд╛рди рд╕реЗ рдЕрдзрд┐рдХ рд╣реИ, рддреЛ рд▓рдХреНрд╖реНрдп рдХреЛ рд░реАрд╕реЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЧрд▓рдд рд▓реМрдЯрдирд╛ рд╣реЛрдЧрд╛ред  рдЖрдк рдЗрд╕ рдЬрд╛рдВрдЪ рдХреЗ рд▓рд┐рдП <code>Vector3.Distance</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TrackTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (target == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } Vector3 a = transform.localPosition; Vector3 b = target.Position; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Vector3.Distance(a, b) &gt; targetingRange) { target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рдХреЛрдб рдХреЛрд▓рд╛рдЗрдбрд░ рдХреА рддреНрд░рд┐рдЬреНрдпрд╛ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рдирд╣реАрдВ рд░рдЦрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЯреЙрд╡рд░ рд▓рдХреНрд╖реНрдп рдЦреЛ рд╕рдХрддрд╛ рд╣реИ, рдлрд┐рд░ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдХреИрдкреНрдЪрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдХреЗрд╡рд▓ рдЗрд╕реЗ рдЕрдЧрд▓реЗ рдлреНрд░реЗрдо рдореЗрдВ рдЯреНрд░реИрдХ рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реА рддрд░рд╣ред  рд╣рдо рд░реЗрдВрдЬ рдореЗрдВ рдПрдХ рдХреЛрд▓рд╛рдЗрдбрд░ рддреНрд░рд┐рдЬреНрдпрд╛ рдЬреЛрдбрд╝рдХрд░ рдЗрд╕рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Vector3.Distance(a, b) &gt; targetingRange + <span class="hljs-number"><span class="hljs-number">0.125f</span></span>) { тАж }</code> </pre> <br>  рдпрд╣ рд╣рдореЗрдВ рд╕рд╣реА рдкрд░рд┐рдгрд╛рдо рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ рдЕрдЧрд░ рджреБрд╢реНрдорди рдХреЗ рдкреИрдорд╛рдиреЗ рдХреЛ рдирд╣реАрдВ рдмрджрд▓рд╛ рдЧрдпрд╛ рд╣реИред  рдЪреВрдВрдХрд┐ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рджреБрд╢реНрдорди рдХреЛ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдкреИрдорд╛рдиреЗ рджреЗрддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╕реАрдорд╛ рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп рд╣рдореЗрдВ рдЗрд╕реЗ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ <code>Enemy</code> рджреНрд╡рд╛рд░рд╛ рджрд┐рдП рдЧрдП рдкреИрдорд╛рдиреЗ рдХреЛ рдпрд╛рдж рд░рдЦрдирд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЧреЗрдЯрд░ рдкреНрд░реЙрдкрд░реНрдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рдЦреЛрд▓рдирд╛ рд╣реЛрдЧрд╛ред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Scale { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> scale, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pathOffset</span></span></span><span class="hljs-function">)</span></span> { Scale = scale; тАж }</code> </pre> <br>  рдЕрдм рд╣рдо <code>Tower.TrackTarget</code> рдореЗрдВ рд╕рд╣реА рд░реЗрдВрдЬ рдХреА рдЬрд╛рдВрдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Vector3.Distance(a, b) &gt; targetingRange + <span class="hljs-number"><span class="hljs-number">0.125f</span></span> * target.EnemyтВм.Scale) { тАж }</code> </pre> <br><h3>  рд╣рдо рднреМрддрд┐рдХреА рдХреЛ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╣реИрдВ </h3><br>  рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╕рдм рдХреБрдЫ рдареАрдХ рдХрд╛рдо рдХрд░ рд░рд╣рд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЯрд╛рд╡рд░реЛрдВ рдЬреЛ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдХреЗрдВрджреНрд░ рдореЗрдВ рд▓рдХреНрд╖реНрдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рд▓рдХреНрд╖реНрдп рдХреЛ рдкрдХрдбрд╝рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВ рдЬреЛ рд╕реАрдорд╛ рд╕реЗ рдмрд╛рд╣рд░ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╡реЗ рдЗрди рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЛ рдЯреНрд░реИрдХ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗ, рдЗрд╕рд▓рд┐рдП рд╡реЗ рдХреЗрд╡рд▓ рдПрдХ рдлреНрд░реЗрдо рдХреЗ рд▓рд┐рдП рдЙрди рдкрд░ рддрдп рдХрд┐рдП рдЧрдП рд╣реИрдВред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e91/0a1/836/e910a1836ef729d95ebee121a67c3f2c.png" width="230" height="230"></div><br>  <i>рдЧрд▓рдд рдирд┐рд╢рд╛рдирд╛ рд▓рдЧрд╛рдирд╛ред</i> <br><br>  рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЦреЗрд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рднреМрддрд┐рдХ рдЗрдВрдЬрди рдХреА рд╕реНрдерд┐рддрд┐ рдЕрдкреВрд░реНрдг рд░реВрдк рд╕реЗ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рд╣реЛрддреА рд╣реИред  рд╕рднреА рджреБрд╢реНрдордиреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдг рджреБрдирд┐рдпрд╛ рдХреЗ рдореВрд▓ рдореЗрдВ рдмрдирд╛рдП рдЧрдП рд╣реИрдВ, рдЬреЛ рдХреНрд╖реЗрддреНрд░ рдХреЗ рдХреЗрдВрджреНрд░ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИред  рдлрд┐рд░ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдирд┐рд░реНрдорд╛рдг рдХреЗ рдмрд┐рдВрджреБ рдкрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рднреМрддрд┐рдХреА рдЗрдВрдЬрди рдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрднреА рдкрддрд╛ рдирд╣реАрдВ рд╣реИред <br><br>  рдЬрдм рдЖрдк <code>Physics.autoSyncTransforms</code> рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдореЗрд╢рди рд╕реЗрдЯ рдХрд░рдХреЗ рдСрдмреНрдЬреЗрдХреНрдЯ рдЯреНрд░рд╛рдВрд╕рдлрд╝реЙрд░реНрдореЗрд╢рди рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рддрд╛рддреНрдХрд╛рд▓рд┐рдХ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд╕рдХреНрд╖рдо рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдпрд╣ рдЕрдХреНрд╖рдо рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рдФрд░ рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреЗрд╡рд▓ рдЯрд╛рд╡рд░реЛрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рддреЗ рд╕рдордп рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд╣рдо <code>Game.Update</code> рдореЗрдВ рджреБрд╢реНрдорди рдФрд░ рдХреНрд╖реЗрддреНрд░ рдЕрдкрдбреЗрдЯ рдХреЗ рдмреАрдЪ <code>Game.Update</code> рдХреЛ рдХреЙрд▓ рдХрд░рдХреЗ рдЗрд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж enemies.GameUpdate(); Physics.SyncTransforms(); board.GameUpdate(); }</code> </pre> <br><h3>  рдКрдБрдЪрд╛рдИ рдкрд░ рдзреНрдпрд╛рди рди рджреЗрдВ </h3><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд╣рдорд╛рд░рд╛ рдЧреЗрдордкреНрд▓реЗ 2 рдбреА рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, <code>Tower</code> рдмрджрд▓ рджреЗрдВ рддрд╛рдХрд┐ рдЬрдм рд▓рдХреНрд╖реНрдп рдХрд░рдирд╛ рдФрд░ рдЙрд╕ рдкрд░ рдирдЬрд╝рд░ рд░рдЦрдирд╛ рдХреЗрд╡рд▓ рдПрдХреНрд╕ рдФрд░ рдЬреЗрдб рдирд┐рд░реНрджреЗрд╢рд╛рдВрдХ рдХреЛ <code>AcquireTarget</code> рдореЗрдВ <code>AcquireTarget</code> ред рднреМрддрд┐рдХ рдЗрдВрдЬрди 3 рдбреА рдЕрдВрддрд░рд┐рдХреНрд╖ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╣рдо 2 рдбреА рдореЗрдВ <code>AcquireTarget</code> рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: рдЧреЛрд▓рд╛рдХрд╛рд░ рдХреЛ рдКрдкрд░ рдЦреАрдВрдЪреЗрдВ рддрд╛рдХрд┐ рдпрд╣ рд╕рднреА рдХреЛрд▓рд╛рдЗрдбрд░ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП, рд╣реЛ рд╕рдХреЗред рдЙрдирдХреА рдКрд░реНрдзреНрд╡рд╛рдзрд░ рд╕реНрдерд┐рддрд┐ рд╕реЗред  рдпрд╣ рдПрдХ рдЧреЛрд▓реЗ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдХреИрдкреНрд╕реВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рджреВрд╕рд░рд╛ рдмрд┐рдВрджреБ рдЬрдореАрди рдХреЗ рдКрдкрд░ рдХрдИ рдЗрдХрд╛рдЗрдпрд╛рдВ рд╣реЛрдВрдЧреА (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рддреАрди)ред <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcquireTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a = transform.localPosition; Vector3 b = a; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> += <span class="hljs-number"><span class="hljs-number">3f</span></span>; Collider[] targets = Physics.OverlapCapsule( a, b, targetingRange, enemyLayerMask ); тАж }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title">    2D-?</b> <div class="spoiler_text">   ,       XZ,   2D-    XY.     ,     ,    2D-   .     3D-. </div></div><br>    <code>TrackTarget</code> . ,    2D-  <code>Vector2.Distance</code> ,            ,   .        . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TrackTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (target == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } Vector3 a = transform.localPosition; Vector3 b = target.Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x = ax - bx; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> z = az - bz; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> r = targetingRange + <span class="hljs-number"><span class="hljs-number">0.125f</span></span> * target.EnemyтВм.Scale; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x * x + z * z &gt; r * r) { target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><div class="spoiler"> <b class="spoiler_title">    ?</b> <div class="spoiler_text">     2D-   ,     .     ,       .  ,        ,    . </div></div><br><h3>    </h3><br>   <code>Physics.OverlapCapsule</code>   ,        .   ,         <code>OverlapCapsuleNonAlloc</code>      .       .       .        ,      1. <br><br>   <code>OverlapCapsuleNonAlloc</code>    ,    ,          . <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Collider[] targetsBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Collider[<span class="hljs-number"><span class="hljs-number">1</span></span>]; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcquireTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 a = transform.localPosition; Vector3 b = a; <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> += <span class="hljs-number"><span class="hljs-number">2f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hits = Physics.OverlapCapsuleNonAlloc( a, b, targetingRange, targetsBuffer, enemyLayerMask ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hits &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { target = targetsBuffer[<span class="hljs-number"><span class="hljs-number">0</span></span>].GetComponent&lt;TargetPoint&gt;(); Debug.Assert(target != <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"Targeted non-enemy!"</span></span>, targetsBuffer[<span class="hljs-number"><span class="hljs-number">0</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br><h2>    </h2><br> ,      ,     .    ,     . <br><br><h3>   </h3><br>     ,  <code>Tower</code>      <code>Transform</code> .           . <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] Transform turret = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e0f/3be/41b/e0f3be41b0936993268316b8f01e1f67.png" width="320" height="90"></div><br> <i> .</i> <br><br>   <code>GameUpdate</code>   ,      .      .       ,    <code>Transform.LookAt</code>      . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TrackTarget() || AcquireTarget()) { <span class="hljs-comment"><span class="hljs-comment">//Debug.Log("Locked on target!"); Shoot(); } } void Shoot () { Vector3 point = target.Position; turret.LookAt(point); }</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/00e/5bb/e9d/00e5bbe9d98e739800bf47435ca574af.png" width="230" height="230"></div><br> <i> .</i> <br><br><h3>   </h3><br>      <code>Tower</code>     . <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] Transform turret = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, laserBeam = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/802/c9c/86e/802c9c86eac24112cb2b4f072fd0f410.png" width="320" height="110"></div><br> <i>  .</i> <br><br>       ,    . -,      .   ,   . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Shoot</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 point = target.Position; turret.LookAt(point); laserBeam.localRotation = turret.localRotation; }</code> </pre> <br> -     ,               .      Z,    ,    .      XY,      (Awake) . <br><br><pre> <code class="cs hljs"> Vector3 laserBeamScale; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { laserBeamScale = laserBeam.localScale; } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Shoot</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 point = target.Position; turret.LookAt(point); laserBeam.localRotation = turret.localRotation; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> d = Vector3.Distance(turret.position, point); laserBeamScale.z = d; laserBeam.localScale = laserBeamScale; }</code> </pre> <br> -,         . <br><br><pre> <code class="cs hljs"> laserBeam.localScale = laserBeamScale; laserBeam.localPosition = turret.localPosition + <span class="hljs-number"><span class="hljs-number">0.5f</span></span> * d * laserBeam.forward;</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/288/d96/438/288d96438354bd732fd7a3bb84ead491.png" width="230" height="230"></div><br> <i>  .</i> <br><br><div class="spoiler"> <b class="spoiler_title">       ?</b> <div class="spoiler_text">     ,         ,       forward.       ,     .     . </div></div><br>  ,     .    ,   .     ,     <code>GameUpdate</code>  0. <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (TrackTarget() || AcquireTarget()) { Shoot(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { laserBeam.localScale = Vector3.zero; } }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/39b/8c8/c23/39b8c8c239e0936137c646f91a4197de.png" width="230" height="230"></div><br> <i>   .</i> <br><br><h3>   </h3><br>              .   ,     .      ,   <code>Enemy</code>  .       ,    100.   ,       ,     . <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Health { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> scale, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pathOffset</span></span></span><span class="hljs-function">)</span></span> { тАж Health = <span class="hljs-number"><span class="hljs-number">100f</span></span> * scale; }</code> </pre> <br>     ,    <code>ApplyDamage</code> ,     .   ,   ,     . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ApplyDamage</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> damage</span></span></span><span class="hljs-function">)</span></span> { Debug.Assert(damage &gt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>, <span class="hljs-string"><span class="hljs-string">"Negative damage applied."</span></span>); Health -= damage; }</code> </pre> <br>       ,      .           <code>GameUpdate</code> . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Health &lt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { OriginFactory.Reclaim(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } тАж }</code> </pre> <br>         ,    ,       ,     ,     . <br><br><h3>    </h3><br>    ,     .     <code>Tower</code>  .       ,        (damage per second).  <code>Shoot</code>     <code>Enemy</code>      . <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(1f, 100f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> damagePerSecond = <span class="hljs-number"><span class="hljs-number">10f</span></span>; тАж <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Shoot</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж target.Enemy.ApplyDamage(damagePerSecond * Time.deltaTime); }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/886/18f/199/88618f199c9c08e7eaeb89b16083f545.png" width="320" height="128" alt="inspector"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/vt/sf/gkvtsfa1ya4igbsjagqhtnzu0wq.gif"></div><br> <i>   тАФ 20   .</i> <br><br><h3>    </h3><br>        ,     ,       .     ,      ,    ,         .       ,     . <br><br>  ,      ,    .   ,     ,   100. ,              ,       . <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Collider[] targetsBuffer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Collider[<span class="hljs-number"><span class="hljs-number">100</span></span>];</code> </pre> <br>             . <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AcquireTarget</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { тАж <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hits &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { target = targetsBuffer[Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, hits)].GetComponent&lt;TargetPoint&gt;(); тАж } target = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nv/lt/hi/nvlthij_ixh6lsxgwujtoipjwg4.gif"></div><br> <i> .</i> <br><br><div class="spoiler"> <b class="spoiler_title">       ?</b> <div class="spoiler_text"> , ,        .  ,      ,     .    .             . </div></div><br> ,     ┬л ┬╗ -  .          . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi459070/">https://habr.com/ru/post/hi459070/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi459052/index.html">рддреБрд▓рдирд╛ рдХреИрд╕реЗ рдХрд░реЗрдВ: "рдЕрджреНрднреБрдд рдХрд╛рд░" рдФрд░ "рдмрджрд╕реВрд░рдд рдЭреЛрдкрдбрд╝реА", рдПрдХ рд╡рд┐рдкрдгрди рд╕рд░реНрд╡реЗрдХреНрд╖рдг рдФрд░ рдмрдбрд╝реЗ рдбреЗрдЯрд╛ рдореЗрдВ</a></li>
<li><a href="../hi459054/index.html">рдХреНрд▓рд┐рдХ рдХрд╛ рд╣реАрдЯрдореИрдк - рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рд╛рдЗрдЯ рдкрд░ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi459062/index.html">рдореЛрдмрд╛рдЗрд▓ # 305 рдбреЗрд╡рд▓рдкрд░ (1 рдЬреБрд▓рд╛рдИ - 7 рдХреЛ) рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрд╛рдЪрди</a></li>
<li><a href="../hi459066/index.html">рдбреЗрдЯрд╛рдмреЗрд╕ рд▓рд┐рдЦрдирд╛ рдФрд░ рдкрдврд╝рдирд╛ рд╕рдВрддреБрд▓рди</a></li>
<li><a href="../hi459068/index.html">рд╡рд┐рдВрдбреЛрдЬ рд╕рд░реНрд╡рд░ 2008 рдЖрд░ 2 - рдж рдХрд┐рдВрдЧ рдЗрдЬ рдбреЗрдб, рд▓реЙрдиреНрдЧ рд▓рд┐рд╡ рдж рдХрд┐рдВрдЧ</a></li>
<li><a href="../hi459074/index.html">рдкреЗрдЯреАрдПрдо рдереЛрдбрд╝рд╛ рдЦреБрд╢реА # 7: рддреАрди рдПрдХ рдХреА рдХреАрдордд рдХреЗ рд▓рд┐рдП - рдХрдВрд╕реЛрд▓ рдПрдиреАрдореЗрд╢рди, рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдбреАрдмрдЧрд┐рдВрдЧ</a></li>
<li><a href="../hi459078/index.html">рд╕реНрд░реЛрдд рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░реНрди рд╕реНрд╡рд┐рдЪ - рдХреНрдпреЛрдВ?</a></li>
<li><a href="../hi459080/index.html">рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдБ java.net рдХрд╛ HttpUrlConnection</a></li>
<li><a href="../hi459082/index.html">рдИрдбрд┐рдЯрд┐рдХреНрд╕ рдХреМрди рд╣реИрдВ, рдЭреВрдареА рдпрд╛рджреЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреА рд╣реИрдВ, рдФрд░ рд╕реНрдореГрддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рддреАрди рд▓реЛрдХрдкреНрд░рд┐рдп рдорд┐рдердХ</a></li>
<li><a href="../hi459084/index.html">Google рд╣реЛрдо рд╣рдм рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЛрдбрд╝рд╛ рдпрд╛ рдореИрдВрдиреЗ 130 рдпреВрд░реЛ рдХреЗ рд▓рд┐рдП рдПрдХ рдлреЛрдЯреЛ рдлреНрд░реЗрдо рдХреИрд╕реЗ рдЦрд░реАрджрд╛</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>