<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëºüèæ üññüèΩ üìÖ OSPF (premi√®re partie) üë©üèæ‚Äçüè≠ ü§üüèª üßìüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article a √©t√© √©crit pour moi, afin que, si n√©cessaire, rafra√Æchisse rapidement ma m√©moire et comprenne la th√©orie. J'ai d√©cid√© de le publier, peut...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OSPF (premi√®re partie)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418391/"> Cet article a √©t√© √©crit pour moi, afin que, si n√©cessaire, rafra√Æchisse rapidement ma m√©moire et comprenne la th√©orie.  J'ai d√©cid√© de le publier, peut-√™tre qu'il sera utile √† quelqu'un, ou peut-√™tre que je me trompe dans quelque chose. <br><br>  Dans cet article, nous allons essayer de comprendre la th√©orie du protocole OSPF.  Nous ne nous pencherons pas sur l'histoire et le processus de cr√©ation du protocole; cette information est abondante dans presque tous les articles sur OSPF.  Nous allons essayer de comprendre plus en d√©tail comment fonctionne OSPF et comment il construit sa table de routage.  Il est important de donner une d√©finition g√©n√©rale du protocole: <br><br>  <b>OSPF</b> (Open Shortest Path First) est un protocole de routage dynamique bas√© sur la technologie d'√©tat des liens et utilise l'algorithme Dijkstra pour trouver le chemin le plus court. <br><br>  La question se pose imm√©diatement - Qu'est-ce que la technologie de suivi des canaux?  Je pense que ce nom n'est pas enti√®rement r√©ussi.  Il se trouve qu'il existe deux types de protocoles de routage dynamique: Link-state et Distance-Vector.  Consid√©rez leurs principes de travail: <br><br>  Dans les protocoles √† vecteur de distance, le routeur reconna√Æt les informations de route via des routeurs directement connect√©s au m√™me segment de r√©seau.  Autrement dit, le routeur ne dispose d'informations sur la topologie que dans les limites de ses routeurs voisins et n'a aucune id√©e de la disposition de la topologie derri√®re ces routeurs, en se concentrant uniquement sur les m√©triques.  Dans les protocoles √† √©tat de liaison, chaque routeur ne doit pas facilement conna√Ætre les meilleurs itin√©raires vers tous les r√©seaux distants, mais doit √©galement avoir en m√©moire une carte r√©seau compl√®te avec toutes les connexions existantes entre d'autres routeurs, y compris.  Ceci est r√©alis√© en construisant une base LSDB sp√©ciale, mais plus √† ce sujet plus tard. <br><a name="habracut"></a><br>  Commen√ßons donc par la fa√ßon dont LSDB est construit √† partir duquel le routeur apprend les routes tout-tout?  Nous construisons la topologie initiale pour l'√©tude.  Cela ressemble √† ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea4/c83/539/ea4c835392207c07ca33dd8ec883a707.jpg" alt="image"><br><br>  Nous allons configurer OSPF.  O√π commence OSPF?  C √©tablissement d'un voisinage entre les routeurs - apr√®s avoir activ√© OSPF sur les interfaces du routeur, les routeurs commencent √† envoyer des messages Hello.  Ce message est envoy√© √† l'adresse de multidiffusion - 224.0.0.5 toutes les 10 secondes (Hello Timer).  Nous allons d'abord activer OSPF sur le routeur vIOS1. <br><br>  Voyons √† quoi ressemble le package Hello: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ca/3bf/881/6ca3bf881cddaf569bdfb54bd3913666.jpg" alt="image"><br><br>  Dans le message, il est important de faire attention aux champs tels que l'ID de zone, le routeur OSPF source.  Lorsque le processus OSPF d√©marre, l'ID de routeur est s√©lectionn√©, ce qui est n√©cessaire pour identifier le routeur parmi les autres routeurs OSPF.  Les r√®gles de choix de ce param√®tre sont les suivantes: <br><br>  1. Configur√© par une commande sp√©ciale routeur-id ABCD - au format d'adresse IP. <br>  2. Une interface de bouclage et plusieurs interfaces avec diff√©rentes adresses sont configur√©es: <br><br><ul><li>  L'adresse attribu√©e √† l'interface de bouclage sera l'ID du routeur. </li></ul><br>  3. Configur√© plusieurs interfaces de bouclage avec plusieurs adresses IP dans chacune: <br><br><ul><li>  L'adresse IP la plus √©lev√©e attribu√©e √† l'une des interfaces de bouclage sera l'ID du routeur. </li></ul><br>  4. Configur√© plusieurs interfaces avec une adresse IP sur chacune: <br><br><ul><li>  La plus grande adresse IP de toutes les interfaces actives sera l'ID du routeur. </li></ul><br>  Passons maintenant au champ Area ID - c'est un concept plus important et fondamental dans OSPF.  Pour fonctionner avec un grand nombre de routeurs, OSPF utilise des zones.  Chacune des interfaces de routeur doit appartenir √† une seule zone.  Dans notre topologie, les interfaces Gi0 / 0 des routeurs vIOS1, vIOS2, vIOS3, vIOS4 appartiennent √† la zone 0. La zone 0 est appel√©e Backbone et est le centre de toutes les autres zones.  Chaque autre zone doit √™tre connect√©e √† la zone Backbone (le lien virtuel n'est pas encore pris en compte).  Dans une analyse plus approfondie, ces concepts deviendront plus clairs. <br><br>  Nous avons donc activ√© OSPF sur vIOS1 et il a commenc√© √† envoyer des paquets Hello toutes les 10 secondes.  Activez OSPF sur vIOS2 et voyez comment les relations avec les voisins sont √©tablies. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c3/721/8d4/9c37218d473f4f96d9c762300ed21bd1.jpg" alt="image"><br><br>  Nous surveillons donc attentivement la s√©quence des messages.  Tout d'abord, Hello envoie uniquement le routeur 1.1.1.1 (192.168.1.1), d√®s que nous activons OSPF sur 192.168.1.2, un paquet Hello sera envoy√©.  vIOS1 et vIOS2 recevront des paquets Hello l'un de l'autre et pour que le voisinage ait lieu, il est important que les param√®tres suivants soient les m√™mes dans la configuration OSPF sur les deux routeurs: <br><br><ul><li>  Hello Interval - fr√©quence d'envoi des messages Hello </li><li>  Router Dead Interval - la p√©riode de temps apr√®s laquelle le voisin est consid√©r√© comme indisponible s'il n'y a pas de Bonjour. </li><li>  ID de zone - le quartier ne peut √™tre √©tabli que via des interfaces dans une zone. </li><li>  Authentification - le mot de passe utilis√© pour l'authentification et le type d'authentification, le cas √©ch√©ant. </li><li>  Indicateur de zone de stub - indicateur facultatif d√©fini sur tous les routeurs appartenant √† la zone de stub </li></ul><br>  Si vous regardez le package Hello illustr√© ci-dessus, tous ces param√®tres sont indiqu√©s dans le package Hello.  D√®s qu'un des routeurs (vIOS1) re√ßoit un nouveau paquet Hello et v√©rifie toutes les conditions, il enverra imm√©diatement un paquet Hello o√π il indiquera l'adresse du nouveau routeur (vIOS2) dans le champ Voisin actif, vIOS2 se recevra et se verra dans le champ voisins, ajoutera vIOS1 aux voisins et enverra le paquet de monodiffusion √† 192.168.1.1 (vIOS1), o√π il l'indiquera comme voisin.  Pour ainsi dire, ils sont devenus voisins et maintenant le plaisir commence - l'√©change d'informations et la construction de la base LSDB.  Pour l'implantation du quartier, je vous conseille de lire l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> suivant. <br><br>  La base LSDB contiendra des informations sur les itin√©raires et ce LSDB apr√®s l'√©tablissement du quartier devrait √™tre identique sur tous les routeurs dans la m√™me zone.  Et, tout d'abord, les routeurs, apr√®s avoir √©tabli un quartier, commencent le processus de synchronisation de leurs bases de donn√©es (vIOS1 avec vIOS2).  Comme vous pouvez le voir, tout commence par l'√©change de messages DB Description (DBD).  Pour √™tre plus clair, parlons des types de messages qu'OSPF utilise: <br><br><ul><li>  Bonjour - utilis√© pour d√©couvrir les voisins, v√©rifier les param√®tres, √©tablir des relations de voisinage avec eux et surveiller la disponibilit√©. </li><li>  Description de la base de donn√©es (DBD) - V√©rifie l'√©tat de la synchronisation de la base de donn√©es sur les routeurs. </li><li>  Link-State Request (LSR) - demande des enregistrements sp√©cifiques sur l'√©tat des canaux du routeur au routeur pour la synchronisation. </li><li>  Link-State Update (LSU) - Envoie des enregistrements d'√©tat de canal sp√©cifiques en r√©ponse √† une demande. </li><li>  Accus√© de r√©ception d'√©tat de liaison (LSAck) - accuse r√©ception d'autres types de paquets. </li></ul><br>  Il est √©galement important d'introduire un concept tel que LSA: <br><br>  <b>Link State Advertisement (LSA)</b> - Une unit√© de donn√©es qui d√©crit l'√©tat local d'un routeur ou d'un r√©seau.  De nombreux LSA d√©crivant les routeurs et les r√©seaux forment une base de donn√©es d'√©tat de liaison (LSDB).  LSDB se compose de plusieurs types de LSA.  Tr√®s d√©taill√© sur chaque LSA est √©crit dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet</a> article.  Les messages DBD utilisent de nombreux indicateurs pour d√©terminer l'√©tat de synchronisation et ces messages contiennent des informations sur leur propre base de donn√©es.  C'est-√†-dire que vIOS1 signale dans ces messages que dans ma base de donn√©es il y a des informations sur des r√©seaux tels que 192.168.0 / 24, 1.1.1.0/24 (LSA Type 1), et vIOS2 signale √† son tour qu'il a des enregistrements sur R√©seaux: 192.168.2.0/24, 2.2.2.0/24 (LSA Type 1).  Apr√®s avoir re√ßu les messages DBD, chaque routeur envoie LSAck pour confirmer le message re√ßu, puis compare les informations de la base de donn√©es voisine avec les siennes.  S'il s'av√®re qu'aucune information n'est disponible, le routeur envoie une demande LS, o√π il demande des informations compl√®tes sur tout LSA.  Par exemple, vIOS1 a demand√© LS Request √† vIOS2, vIOS2 r√©pond avec LS Update, qui contient d√©j√† des informations d√©taill√©es sur chaque route.  Voici la mise √† jour LS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a79/2cc/672/a792cc672c63e0a95c5b17951567b565.jpg" alt="image"><br><br>  Comme vous pouvez le voir, dans ce post, vIOS2 parle des sous-r√©seaux connus de lui et des informations qui leur sont associ√©es.  De plus, vIOS1 parle de son LSDB.  Et √† la fin, les routeurs ont le m√™me LSDB.  Une fois le processus termin√©, l'algorithme de Dijkstra (Shortest Path First) est lanc√©.  Il calcule tous les itin√©raires connus √† partir de LSDB et place les meilleurs d'entre eux dans la table de routage.  Le meilleur avec la m√©trique inf√©rieure, mais plus √† ce sujet plus tard. <br><br>  R√©fl√©chissons √† la question, que se passe-t-il si nous activons OSPF sur vIOS3?  Puisque vIOS3 devra construire LSDB et le synchroniser avec d'autres routeurs, la question se pose avec qui exactement synchroniser?  Avec vIOS1 ou vIOS2?  Avec chacun individuellement?  Dans quelle mesure est-ce optimal?  Par cons√©quent, dans OSPF, il existe une chose telle que le routeur d√©sign√© DR.  Nous introduisons ce concept: <br><br>  <b>Routeur d√©di√© (routeur d√©sign√©, DR)</b> - g√®re le processus de distribution LSA sur le r√©seau.  Chaque routeur de r√©seau √©tablit une relation de voisinage avec DR.  Les informations sur les modifications du r√©seau sont envoy√©es par DR, le routeur qui a d√©tect√© cette modification, et DR est responsable de veiller √† ce que ces informations soient envoy√©es aux autres routeurs du r√©seau. <br><br>  En d'autres termes, si un nouveau routeur appara√Æt dans le segment de r√©seau, il synchronisera son LSDB avec DR.  Il est √©galement important de noter que non seulement les nouveaux, mais tous les autres routeurs informeront le DR √† ce sujet lorsque le r√©seau change ou qu'un nouvel itin√©raire appara√Æt, et les autres prendront ces informations du DR.  Mais alors des questions se posent: que se passera-t-il si la reprise apr√®s incident √©choue?  Comment DR est-il s√©lectionn√©? <br><br>  En cas d'√©chec, un nouveau DR doit √™tre s√©lectionn√©.  De nouvelles relations de voisinage doivent √™tre form√©es et, tant que les bases de donn√©es du routeur ne seront pas synchronis√©es avec la nouvelle base de donn√©es DR, le r√©seau ne sera pas disponible pour le transfert de paquets.  Pour √©liminer cet inconv√©nient, s√©lectionnez BDR - Routeur d√©sign√© de sauvegarde: <br><br>  <b>Routeur d√©sign√© de sauvegarde (BDR).</b>  Chaque routeur r√©seau √©tablit une relation de voisinage non seulement avec DR, mais aussi BDR.  DR et BDR √©tablissent √©galement des relations de voisinage entre elles.  Lorsque DR √©choue, BDR devient DR et remplit toutes ses fonctions.  √âtant donn√© que les routeurs r√©seau ont √©tabli des relations de voisinage avec les BDR, le temps d'indisponibilit√© du r√©seau est minimis√©.  Ainsi, dans notre r√©seau, nous obtenons non seulement DR, mais aussi BDR.  Les autres routeurs ne recevront et ne rapporteront des informations pertinentes sur le r√©seau que par leur interm√©diaire.  DR et BDR ne peuvent √™tre s√©lectionn√©s que dans un seul segment, pas une zone!  Autrement dit, pour les routeurs vIOS1, vIOS2, vIOS3, vIOS4, un DR et BDR seront s√©lectionn√©s, et, par exemple, entre vIOS et vIOS1, leurs DR et BDR seront d√©termin√©s par rapport √† leur segment de r√©seau, m√™me s'ils se trouvent dans la m√™me zone 0. Pour la communication avec DR et BDR, les routeurs utilisent une adresse de multidiffusion de 224.0.0.6. <br><br>  La question suivante est: comment le DR / BDR est-il s√©lectionn√©?  Les crit√®res suivants s'appliquent: <br><br><ol><li>  DR: routeur de priorit√© la plus √©lev√©e de l'interface OSPF. </li><li>  BDR: Routeur avec la deuxi√®me priorit√© la plus √©lev√©e de l'interface OSPF. </li><li>  Si les priorit√©s des interfaces OSPF sont √©gales, l'ID de routeur le plus √©lev√© est utilis√© pour effectuer la s√©lection.  Comme nous l'avons dit, les routeurs d√©finissent leur ID de routeur.  Au d√©but, lorsque l'OSPF a √©t√© lanc√© sur vIOS1 et vIOS2, en plus d'√©tablir un quartier, des √©lections DR / BDR ont √©galement eu lieu.  VIOS2 avec ID - 2.2.2.2 a gagn√© dans ce diff√©rend, alors que vIOS1 avait ID - 1.1.1.1.  vIOS1 a √©t√© s√©lectionn√© comme BDR.  Il est important de noter que le processus de s√©lection de DR et BDR ne se produit pas imm√©diatement apr√®s la r√©ception des premiers paquets Hello du deuxi√®me routeur.  Pour ce faire, il existe un temporisateur sp√©cial √©gal √† Router Dead Interval - 40 secondes.  Si pendant ce temps un paquet Hello avec le meilleur ID n'est pas re√ßu, une s√©lection sera effectu√©e en fonction des paquets Hello existants. </li></ol><br>  Ce n'est que maintenant que nous pouvons revenir √† la question - que se passera-t-il si nous activons OSPF sur vIOS3?  Apr√®s avoir activ√© OSPF, vIOS3 commencera √† envoyer et √† √©couter les paquets Hello.  Il recevra les paquets Hello de vIOS1 et vIOS2, qui indiqueront quels routeurs sont DR et BDR et comprendront avec qui synchroniser LSDB.  Il est important de noter que lorsqu'un routeur avec un meilleur ID appara√Æt, alors DR / BDR ne change pas jusqu'√† ce que l'un d'eux se bloque.  Apr√®s cela, vIOS3 commence √† synchroniser son LSDB avec ces routeurs. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f8e/8b2/35a/f8e8b235a0eb24d311d6b745dac5910e.jpg" alt="image"><br><br>  Apr√®s avoir re√ßu de nouvelles informations de vIOS3, DR envoie des messages de mise √† jour LS √† tous les routeurs √† l'adresse 224.0.0.5, √† laquelle d'autres routeurs, apr√®s avoir re√ßu un paquet, envoient LS Acknowledge √† DR, mais √† l'adresse 224.0.0.6 (adresse pour DR / BDR). <br><br>  Selon le m√™me sch√©ma, nous connectons √©galement vIOS4.  Apr√®s la synchronisation, tous les routeurs ont le m√™me LSDB.  Voyons √† quoi ressemblent les √©tats de voisinage de vIOS3.  Commande show ip ospf neighbour: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf2/3eb/51f/bf23eb51f7a7ab94f64be8726dae9370.jpg" alt="image"><br><br>  Comme nous pouvons le voir, DR est 2.2.2.2, BDR est 1.1.1.1 et 2WAY / DROTHER est s√©lectionn√© avec vIOS4.  Les √âtats du voisinage ont √©t√© mentionn√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ci-dessus</a> . <br><br>  Et voici les √©tats de voisinage sur vIOS1 avec le voisinage √©tabli avec vIOS: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f3c/583/7e7/f3c5837e7b1d99243357857cc4cb1352.jpg" alt="image"><br><br>  Comme vous pouvez le voir, il a deux DR car il a un voisin dans un autre segment du r√©seau. <br><br><h3>  Multizones </h3><br>  Consid√©rez le fonctionnement d'OSPF lorsque plusieurs zones sont utilis√©es.  Changez notre topologie en ajoutant de nouveaux routeurs: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/54c/b16/f0c/54cb16f0c9293e15b65544b3b89573a4.jpg" alt="image"><br><br>  Pour commencer, nous allons configurer OSPF sur vIOS1 et vIOS afin que leurs interfaces Gi0 / 1 sur vIOS et vIOS1 soient dans la zone 1. Voyons ce qui change.  vIOS1 poss√®de d√©sormais des interfaces √† la fois dans la zone 0 (Gi0 / 0) et dans la zone 1 (Gi0 / 0).  Un tel routeur est appel√© ABR - Area Border Router (ci-dessous, nous donnons une d√©finition plus correcte de ABR).  ABR enverra les informations d'itin√©raire d'une zone √† l'autre.  Cela se fait via LSA Type 3: <br><br>  <b>Type 3 LSA - Network Summary LSA</b> - annonce sommaire de l'√©tat des canaux du r√©seau: <br><br><ul><li>  Diffusion d'annonces par les routeurs p√©riph√©riques </li><li>  L'annonce d√©crit les itin√©raires vers des r√©seaux en dehors de la zone locale </li><li>  Contient des informations sur les r√©seaux et le co√ªt du chemin d'acc√®s √† ces r√©seaux, mais n'envoie pas d'informations sur la topologie du r√©seau </li><li>  Par d√©faut, le routeur de p√©riph√©rie envoie une annonce distincte pour chaque r√©seau qu'il conna√Æt.  Si n√©cessaire, sur le r√©seau ABR peut √™tre r√©sum√© </li><li>  ID d'√©tat de liaison - num√©ro de r√©seau de destination. </li></ul><br>  √Ä la base, entre les zones, le principe de fonctionnement du protocole ressemble √† celui du protocole vecteur de distance, ne transmettant que des informations de route avec des m√©triques.  Voici la mise √† jour LS de vIOS1 dans la zone 0, qui contient 3 pi√®ces LSA Type 3: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f3/681/fa8/3f3681fa87bb1a94778d4bec031f37a1.jpg" alt="image"><br><br>  √Ä la base, la structure de LSA Type 3 n'est pas tr√®s diff√©rente de LSA Type 1, mais elles affectent le protocole de diff√©rentes mani√®res.  Lorsqu'un LSA mis √† jour est re√ßu ou si un LSA de type 1 et 2 est perdu, SPF (algorithme de chemin le plus court) est red√©marr√© et recalcule le LSDB. <br><br>  √Ä la r√©ception d'un LSA de type 3, ce processus ne se produit pas - un itin√©raire avec une m√©trique dans le LSA de type 3 est obtenu. Ce LSA stocke les donn√©es par lesquelles ABR un itin√©raire donn√© a √©t√© re√ßu (ABR est sp√©cifi√© dans le champ Routeur publicitaire) et une m√©trique pour atteindre cet ABR d√©j√† disponible en LSDB.  Ainsi, la m√©trique de LSA Type 3 est r√©sum√©e avec la m√©trique de la route vers ABR et nous obtenons la route termin√©e sans red√©marrer le SPF.  Ce processus est appel√© <b>calcul SPF partiel</b> .  Ceci est tr√®s important car sur les grands r√©seaux, les tailles LSDB peuvent √™tre assez grandes et l'ex√©cution de SPF n'est souvent pas bonne.  De plus, la cr√©ation de LSA de type 3 sugg√®re que la modification et le recalcul des LSDB constituent un domaine.  ABR signale seulement qu'avec une route, ce qui a chang√©. <br><br>  Il est √©galement important de noter que tout itin√©raire d'une zone non nulle √† une zone non nulle passe par la zone 0. S'il existe un ABR, il ne peut pas √™tre connect√© √† la zone 0 (nous excluons l'option avec lien virtuel).  La zone 0 est le c≈ìur qui relie toutes les autres zones et assure le routage entre les zones.  La d√©finition de l'ABR ressemble √† ceci: <br><br>  <b>Routeur fronti√®re (routeur fronti√®re de zone, ABR)</b> - connecte une ou plusieurs zones √† la zone de jonction et agit comme une passerelle pour le trafic inter-zone.  Un routeur p√©riph√©rique a toujours au moins une interface dans la zone de jonction.  Pour chaque zone attach√©e, le routeur g√®re une base de donn√©es d'√©tat des canaux distincte. <br>  Nous avons trait√© de la mise en place du quartier, de la cr√©ation de LSDB et SPF, avec la zone habituelle.  Examinons maintenant la convergence et la r√©ponse d'OSPF aux changements de topologie. <br><br>  Examinons notre topologie et imaginons que vIOS3 a cess√© de fonctionner (l'√©tat des canaux n'a pas chang√©).  Cela aidera √† reconstruire la topologie de la minuterie d'intervalle mort - 40 secondes.  Si pendant cet intervalle, le routeur ne re√ßoit pas de paquet Hello d'un voisin, le quartier s'effondre.  Dans notre cas, DR enverra LS Update avec LSA Type 2, ce qui indique qu'il n'y a pas de vIOS3 parmi les routeurs connect√©s, cela entra√Ænera le d√©marrage de SPF et le recomptage LSDB sans LSA re√ßu de vIOS3.  Il est important de noter que sur un routeur vIOS4 normal, m√™me l'√©puisement du Dead Interval Timer et la perte de proximit√© avec vIOS3 ne conduisent pas √† un recalcul de la topologie, c'est le message LS Update avec LSA Type 2 qui d√©marre ce processus. <br><br>  <b>Type 2 LSA - Network LSA -</b> Annonce de l'√©tat de la <b>liaison r√©seau</b> : <br><br><ul><li>  Distribu√© par DR dans plusieurs r√©seaux d'acc√®s </li><li>  Le LSA r√©seau n'est pas cr√©√© pour les r√©seaux dans lesquels DR n'est pas s√©lectionn√© </li><li>  Distribu√© uniquement dans une zone </li><li>  ID d'√©tat de liaison - Adresse IP de l'interface DR </li></ul><br>  Ainsi, ignorer les donn√©es qui ont cess√© de fonctionner se produit √† l'aide de ce message.  C'est cette indication des voisins qui est le d√©clencheur du rejet des itin√©raires non pertinents. <br><br>  Rallumez vIOS3 et r√©tablissez le quartier.  La prochaine exp√©rience sera une r√©action √† la d√©sactivation de l'interface Gi0 / 1 sur vIOS3.  D√®s que vIOS3 d√©tecte des coupures de liens, il envoie instantan√©ment LS Update √† DR √† l'adresse 224.0.0.6, o√π il est signal√© que certaines routes sont tomb√©es en d√©finissant un indicateur dans LSA - LS Age √©gal √† 3600 secondes.  Pour LSDB, il s'agit de Max Age et tous les LSA avec Max Age ne sont pas pris en compte dans SPF, ils ne seront donc pas dans la table de routage.  La question est: quand Age LSA atteint naturellement Max Age, que se passe-t-il?  Pour ce faire, OSPF a LSRefreshTime - √©gal √† la moiti√© de l'√¢ge maximal, toutes les 1800 secondes LS Update est envoy√© par le routeur pour mettre √† jour les donn√©es de la minuterie: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43a/dd0/8c4/43add08c439f2826bb85e434a2280ae5.jpg" alt="image"><br><br>  De plus, DR ayant trait√© cette mise √† jour LS, envoie LS LS √† tous les autres routeurs √† l'adresse 224.0.0.5.  D√®s que les routeurs obtiennent de nouvelles informations, ils envoient LSAck.  Cela garantit une bonne convergence dans OSPF. <br><br><h3>  Choisir le meilleur itin√©raire </h3><br>  Le routeur s√©lectionne le meilleur itin√©raire en fonction de la valeur m√©trique la plus faible.  Cependant, OSPF prend √©galement en compte plusieurs autres facteurs lors du choix d'un itin√©raire.  Dans ce cas, la source de l'itin√©raire et son type sont importants.  La s√©lection d'itin√©raire prioritaire est la suivante: <br><br><ul><li>  Itin√©raires internes d'une zone (intra-zone) </li><li>  Itin√©raires entre zones (inter-zones) </li><li>  Routes externes de type 1 (E1) </li><li>  Routes externes de type 2 (E2) </li></ul><br>    E2        (     ASBR),     E2,     ASBR,   .    ,       .         (cost).    : <br><br> cost = reference bandwidth / link bandwidth. Reference bandwidth ‚Äî   .  ,  Cisco  100Mbit. <br><br> <b>ABR Loop Prevention.</b>    ,     OSPF   distance-vector .    ,  ,    . ,      Split Horizon  distance-vector .    ,        0  4 : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/318/d56/328/318d56328823c86abf8df0b5439e76b7.jpg" alt="image"><br><br>   ,  vIOS18       100   Gi0/0.     ,  vIOS18    LSA Type 3,     0. ,       LSA Type 3    0. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr418391/">https://habr.com/ru/post/fr418391/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr418381/index.html">Nouveaut√©s de DevTools dans Chrome version 68</a></li>
<li><a href="../fr418383/index.html">Animations Android bas√©es sur Kotlin et RxJava</a></li>
<li><a href="../fr418385/index.html">Comment j'ai assembl√© un ordinateur pour les anciens jeux</a></li>
<li><a href="../fr418387/index.html">Les physiciens dialoguent sur l'√¢me</a></li>
<li><a href="../fr418389/index.html">RabbitMQ vs. Kafka: Utilisation de Kafka dans des applications orient√©es √©v√©nements</a></li>
<li><a href="../fr418393/index.html">[Vendredi] Comment nous avons sci√© le Web 3D</a></li>
<li><a href="../fr418395/index.html">Elon Musk: des g√©n√©rateurs locaux de champ √©lectromagn√©tique prot√©geront les colons sur Mars</a></li>
<li><a href="../fr418397/index.html">Vendredi Gestion: Webinaires Skillbox gratuits</a></li>
<li><a href="../fr418399/index.html">Sur la vague de Selectel FM</a></li>
<li><a href="../fr418401/index.html">Comment je ne suis pas devenu toi: un message d'amour pour les administrateurs syst√®me</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>