<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌘 ✋ 🍨 使用8base，GraphQL和React创建Sticky Notes应用程序 🔌 ↔️ 👩🏽‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在此处查看该程序的演示版本。 

 在任何时候，时间管理对我来说都是一个艰巨的工作，计划的任务被遗忘，笔记丢失了，因为它们分布在保存笔记的多个应用程序中。 我建议您创建个性化便笺的应用程序中根本没有该解决方案，尽管由于放入时间的缘故，您可能会使用它。 

 要创建笔记应用程序，我们需要一个实际上不需...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用8base，GraphQL和React创建Sticky Notes应用程序</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463907/"><img src="https://habrastorage.org/getpro/habr/post_images/c98/5ef/e7d/c985efe7da6be444438fac5cbae68238.png" alt="图片"><br><br> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>查看该程序的演示版本。 <br><br> 在任何时候，时间管理对我来说都是一个艰巨的工作，计划的任务被遗忘，笔记丢失了，因为它们分布在保存笔记的多个应用程序中。 我建议您创建个性化便笺的应用程序中根本没有该解决方案，尽管由于放入时间的缘故，您可能会使用它。 <br><a name="habracut"></a><br> 要创建笔记应用程序，我们需要一个实际上不需要开发后端的简单堆栈以及一个易于部署的应用程序。 基于这些要求，我们将为应用程序选择堆栈。 看起来像这样： <br>  <b>-React-</b>用于前端开发。 这是一个用于创建用户界面的流行库，可以轻松地将其部署在Now和Netlify等多个平台上。 <br>  <b>-8base GraphQL-</b>我们的应用程序的数据库层。 在这里，我们将在应用程序中存储和读取请求。 使用8base，您无需为应用程序创建和维护后端。 <br><br> 我已经使用这些工具成功创建了一个简单的应用程序。 在本文中，我们将研究创建此应用程序并设置在8base平台上运行的后端的过程。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/807/f6e/fa9/807f6efa97c63a172fa3e621d6411de5.png" alt="图片"><br><br> 如果您不方便使用屏幕截图，则可以随时查看<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">演示应用程序</a> 。 便笺随机放置在网页上，并且可以拖动到其他位置。 <br><br> 遵循说明需要对<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">React</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Node.js</a>有基本的了解<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> 在开始之前，请确保已<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安装</a> Node和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">npm</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">yarn</a> 。 <br><br> 我们还将在项目中使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GraphQL</a>查询，因此对这种技术的一些熟悉将很有用。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">8base</a>平台提供了广泛的功能，可帮助开发人员更快，更轻松地创建应用程序。 使用8base，您可以轻松组织应用程序的后端，而无需编写代码。 使用8base平台，您可以使用简单的图形界面创建后端，该界面允许您执行以下操作： <br><br><ul><li> 定义数据模式：创建表/表关系。 </li><li> 上传文件。 </li><li> 定义访问权限和授权角色。 </li><li> 使用研讨会管理各种项目。 </li><li> 使用API​​ Explorer（基于GraphQL）设计查询。 </li></ul><br> 在本指南中，我们将了解如何使用8base来快速配置服务器端并使用GraphQL API处理数据。 我们的前端应用程序将使用React构建，并使用GraphQL与服务器交互。 <br><br> 要开始使用8base，请按照下列步骤操作： <br><br>  1.在8base上<b>创建一个帐户</b> 。 它是免费的。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/674/3bc/809/6743bc8091fa63acb34a068fe09581a9.png" alt="图片"><br><br>  2.注册完成后，单击“ <b>数据构建器”</b>按钮转到“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">数据”</a>页面，然后单击“新建表”以开始配置后端。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/571/e32/808/571e32808c3cd8d029805f01279c60a8.png" alt="图片"><br><br>  3.加载新表后，您将被带到方案中，并且可以开始定义字段。 让我们注意几件事。 在左侧，您将看到<i>系统表</i>和<i>您的表</i> 。 <br><br> 每个新的8base工作空间都会自动带有几个内置表。 这些表用于文件，设置和权限之类的东西，并且都可以通过8base GraphQL API进行访问。 <br><br>  4.继续<b>创建</b> <i>Notes</i> <b>表</b> ，该<b>表</b>包含以下字段： <br><br>  <b>title</b> ：字段类型<i>Text</i> 。 这将是注释的标题。 <br>  <b>text</b> ： <i>文本</i>字段的类型。 该字段将包含注释的正文。 <br> 我们的计划非常简单，用于实现我们试图实现的机会。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bea/d62/ca7/bead62ca7ffa32276ddc9df5ef9a4712.png" alt="图片"><br><br>  5.然后<b>复制</b>端点API URL（位于左下方）-这是应用程序的客户端和服务器部分之间的通信主线。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56b/762/8d9/56b7628d911cf529305c3dece34a3896.png" alt="图片"><br><br>  6.最后，出于本指南的目的，默认情况下，我们将<b>允许Guest进行公共访问</b> ，因此不需要身份验证。 要允许来宾访问新的Notes表，请转到“设置”&gt;“角色”&gt;“来宾”，然后在“ Notes”部分中选中相应的框。 默认情况下，所有访问您的API端点的未授权用户都会分配来宾角色。 本指南未涵盖授权。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里，</a>您可以了解有关如何使用它的更多信息。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/110/0c9/f7d/1100c9f7d58abd0b4ade83938c6378c7.png" alt="图片"><br><br> 既然我们已经完成了使用8base的后端配置，那么我们将开始在应用程序的前端工作。 <br><br><h3> 开始使用 </h3><br> 我创建了一个入门项目来轻松配置和减少开销，因此本文基本上描述了如何开始使用8base和GraphQL。 已经配置了应用程序的框架，包括项目的样式和结构。 入门分支中提供以下选项： <br><br><ol><li> 便笺表单中用于创建便笺的组件。 </li><li> 笔记的组件，显示单个笔记的详细信息。 </li><li> 注释列表组件，显示可用注释的列表。 </li></ol><br> 运行以下命令来克隆存储库： <br><br><pre><code class="javascript hljs">git clone -b starter https:<span class="hljs-comment"><span class="hljs-comment">//github.com/HackAfro/note-app.git</span></span></code> </pre> <br> 通过运行以下命令打开文件夹并安装项目依赖项： <br><br><pre> <code class="javascript hljs">npm install</code> </pre> <br> 通过在项目根文件夹中的终端中运行npm start来启动React应用程序服务器。 <br><br><h4> 使用GraphQL连接到8base后端 </h4><br> 现在我们的初始前端已启动并正在运行，下一步是配置客户端以使用GraphQL与8base后端进行交互。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">apollo-boost</a>是一个有用的库，可帮助您建立连接。 它提供了客户端使用URI连接到GraphQL后端。  URI是8base提供的端点。 让我们更新<i>index.js</i>文件以配置ApolloClient。 <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-dom"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ApolloProvider } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-apollo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ApolloClient <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"apollo-boost"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> serviceWorker <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./serviceWorker"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"./index.css"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./App"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> client = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApolloClient({ <span class="hljs-attr"><span class="hljs-attr">uri</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;YOUR_8BASE_ENDPOINT&gt;"</span></span> }); ReactDOM.render( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ApolloProvider</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">client</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{client}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">App</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ApolloProvider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"root"</span></span>) ); serviceWorker.unregister();</code> </pre> <br>  ApolloClient将带有<i>uri</i>属性的对象作为参数； 同时，客户端允许我们使用提供的<i>uri</i>来接收，更新和删除数据。 确保将&lt;YOUR_8BASE_ENDPOINT&gt;的值替换为实际的端点。 <br><br> 然后，将应用程序包装在ApolloProvider中，后者接受prop客户端。  ApolloProvider加载8base表架构，使您可以访问前端代码中的所有数据模型属性。 <br><br><h4> 接收和显示笔记 </h4><br> 为了从后端获取笔记，我们将编写一个GraphQL查询来接收存储在8base中的笔记。 让我们开始更新<i>App.js</i>文件。 <br><br> 将以下导入添加到找到TODO的位置-1条注释： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gql <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"graphql-tag"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphql } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-apollo"</span></span>;</code> </pre> <br> 它们对于创建GraphQL查询以及将道具发送到App组件做笔记很有用。 接下来，我们需要添加一个从服务器端接收注释的请求。 更新<i>NOTE_LIST_QUERY，</i>使其看起来像下面的代码片段： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> NOTE_LIST_QUERY = gql<span class="hljs-string"><span class="hljs-string">` query { notesList { items { id title text } } } `</span></span>;</code> </pre> <br> 如果您不确定自己的要求，可以随时在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://auth.8base.com/login%3Fstate%3Dg6Fo2SBpQzdtSDdPX3B6Y1Y1QUFvVXp0R014dG56MVpWVzlHZaN0aWTZIG5ncC16aHpjSXE1TlJtVUVyQmVKdVpIQXo5aEdFVFZEo2NpZNkgcUdIWlZ1NUN4WTVrbGl2bTI4T1BMam9wdnNZcDBiYUQ%26client%3DqGHZVu5CxY5klivm28OPLjopvsYp0baD%26protocol%3Doauth2%26response_type%3Dtoken%2520id_token%26redirect_uri%3D">8base API Explorer中</a>对其进行测试。 让我们检查一下上面的查询。 <br><br> 如果在资源管理器中执行此查询，则很可能会返回一个空数组，因为未创建任何注释。 我们可以使用8base工具栏轻松创建笔记。 按照侧栏中的<b>数据</b>链接，并按照下面的屏幕快照中的说明进行操作： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/757/48f/de2/75748fde25301cb5fba67934b5a89d37.png" alt="图片"><br><br> 我们将从notesList元素获取<i>id</i> ， <i>title</i>和<i>text</i> 。 接下来，我们将准备<i>App</i>组件，以使用从请求中收到的注释。 最后，我们将使用<i>graphql HOC</i> （高阶组件）将查询与<i>App</i>组件相关联。 该函数接受查询字符串和配置参数。 <br>  // TODO-3 <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> graphql(NOTE_LIST_QUERY, { <span class="hljs-attr"><span class="hljs-attr">props</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = result; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { loading, refetch } = data; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> notes = []; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data &amp;&amp; data.notesList) notes = data.notesList.items; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { loading, notes, refetch, }; }, })(App);</code> </pre> <br> 在TODO-上面的3条注释下替换现有的出口行。 <br><br>  <i>graphql</i>函数返回一个“增强器”函数，该函数将使用GraphQL功能扩展传递给它的任何组件。 这对应于响应函数中的<i>连接</i>功能也使用的高阶组件模式。 <br><br> 使用<code>graphql()</code>函数，我们可以访问GraphQL端点。 它接受查询作为第一个参数（NOTE_LIST_QUERY），第二个作为配置，返回值为HOC，应使用所需的组件作为参数来执行。 在片段中，我们将<code>data.noteList</code>属性的值传递<code>data.noteList</code>新的变量notes。 通过返回此值，我们可以在组件内部以<code>props.notes</code>对其进行访问，并以<code>props.notes</code>的形式进行下载。 <br><br>  <i>refetch</i>方法将非常有用，因此我们可以实现接近实时更新的功能。 我们将在每次突变后调用该函数，以确保应用程序中的数据始终与8base后端同步。 <br> 如果您切换到localhost：3000，则会看到刚刚创建的注释。 我们需要能够在不访问8base工具栏的情况下创建注释，这意味着移至GraphQL ...的下一个层次。 变异！ <br><br><h4> 创建笔记 </h4><br> 完成用于从后端接收笔记的设置之后，下一个逻辑步骤是添加创建笔记的功能。 初始文件包含表单组件，我们需要更新该组件以使突变能够将创建的注释保存在8base后端。 <br><br> 在上一节中，我们执行了从后端接收笔记的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">请求</a> ，在这一部分中，我们将执行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">变异</a>以保存新笔记，该变异与请求相似，唯一的区别是每当需要更改数据时都会调用变异。 在8base中创建表后，可以在Explorer API中轻松访问该表的查询和变异。 因此，如果我们怀疑突变的结构如何，我们总能到达那里。 <br><br> 让我们看看该突变在API Explorer中创建注释的样子。 转到8base工具栏，然后单击侧栏中的API Explorer。 <br><br> 在API资源管理器中，点击<i>突变</i>链接，如上所示。 这将显示所有可用的突变。 查找负责创建注释的内容： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f18/b87/a31/f18b87a316f26f5ebdaaaafbdc3a9625.png" alt="图片"><br><br> 屏幕快照显示，突变名称为<i>noteCreate</i> ，并且它使用一个类型为<i>NoteCreateInput的</i>参数。  <i>NoteCreateInput-</i>定义创建注释所需的请求正文的类型。 <br><br> 现在我们知道我们需要什么，让我们开始实施。 我照顾了您，并创建了一个用于创建便笺的表单，因此仍然可以使用<i>graphql</i>函数向组件添加变异。 <br><br> 打开<i>src / components / note-form / index.js</i> ，在有TODO 1注释的位置添加以下导入： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gql <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"graphql-tag"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphql } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"react-apollo"</span></span>;</code> </pre> <br> 接下来，我们将声明该突变，更新<i>NOTE_MUTATION</i>变量并为其分配一个新值，类似于下面的片段： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> NOTE_MUTATION = gql<span class="hljs-string"><span class="hljs-string">` mutation NoteCreate($data: NoteCreateInput!) { noteCreate(data: $data) { id } } `</span></span>;</code> </pre> <br> 接下来，我们使用<i>graphql</i>函数将突变与组件相关联。 将文件中的<i>导出</i>行替换为以下代码段： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> graphql(NOTE_MUTATION, { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">"noteCreate"</span></span> })(NoteForm);</code> </pre><br> 因此， <i>graphql</i>函数传递了命名函数<i>noteCreate</i> ，该函数将用于执行创建突变。 提交表单时，让我们使用<i>noteCreate</i>函数创建一个注释。 <br><br> 转到TODO 4注释并更新<i>submit</i>功能，使其看起来像下面的代码片段： <br>  // TODO-4 <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> submit = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> note =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> res = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> noteCreate({ <span class="hljs-attr"><span class="hljs-attr">variables</span></span>: { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: note } }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (res.data.noteCreate.id) { setNote({ <span class="hljs-attr"><span class="hljs-attr">title</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }); refetch() } };</code> </pre> <br> 在上面的代码片段中，我们使用<i>noteCreate</i>函数在notes表中执行了<i>create</i>突变。 传递给函数的参数是一个包含<i>变量</i>和<i>数据</i>主体的对象。 <br><br> 我们等待直到请求完成，然后通过在响应正文中找到id来检查请求是否成功。 然后我们重置note和refetch的状态。 我在本文前面提到了refetch函数，但让我更新您的内存。  Refetch强制您的组件重复在<code>graphql()</code>函数中定义的查询。 <br><br> 现在一切准备就绪，可以进行测试。 转到localhost：3000，填写表格并享受结果。 <br><br><h4> 删除笔记 </h4><br> 如果您无法删除所有笔记并假装它们根本不存在，那么任何笔记应用程序都有什么用呢？ 删除注释的步骤： <br><br><ol><li> 用户单击删除按钮。 </li><li> 出现确认窗口-这减少了恶意用户的数量，非常有用。 </li><li> 仍然要采取行动-删除注释。 </li></ol><br> 删除注释的设置位于<i>src /注释卡/delete-button.js</i>文件中。 打开文件，并在文件顶部添加以下导入。 特别是在TODO 1所在的位置： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gql <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'graphql-tag'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { graphql } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-apollo'</span></span>;</code> </pre> <br> 然后编写删除突变并将其分配给<i>DELETE_MUTATION</i>变量。 这看起来应如下所示： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DELETE_MUTATION = gql<span class="hljs-string"><span class="hljs-string">` mutation DeleteNote($data: NoteDeleteInput!) { noteDelete(data: $data) { success } } `</span></span>;</code> </pre> <br> 接下来，我们使用<i>graphql</i>函数将突变与组件相关联。 将文件中的<i>导出</i>行替换为以下片段： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> graphql(DELETE_MUTATION, { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'deleteNote'</span></span>, })(DeleteButton);</code> </pre> <br> 然后， <i>graphql</i>函数传递命名的<i>deleteNote</i>函数，该函数将用于执行delete突变。 现在，我们可以更新click事件处理程序并添加急需的设置以删除注释。 <br><br> 转到组件中的<i>onDeleteClick</i>函数，将以下片段放入函数中： <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> onDeleteClick = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: noteId, }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> remove = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.confirm(<span class="hljs-string"><span class="hljs-string">'Are you sure you want to delete this note?'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (remove) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> deleteNote({ <span class="hljs-attr"><span class="hljs-attr">variables</span></span>: { data } }); refetch(); } };</code> </pre> <br> 当您单击删除按钮时，在<b>数据</b>对象的主体中，我们将<i>id</i>字段设置为<i>noteId</i> ，然后向用户显示一条确认消息，明确表明我们打算永久删除此注释。 如果用户按照预期执行并决定继续，则调用<i>deleteNote</i>函数以<i>使</i>删除<i>变异</i> 。 完成后，您需要一个应用程序。 <br><br> 这是它的外观。 转到localhost：3000并尝试删除注释： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/515/f80/9ea/515f809ea6cbc73518d449241df4299e.png" alt="图片"><br> 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>找到此应用程序的演示。 <br><br><h3> 结论 </h3><br> 我相信您在创建该应用程序时过得很愉快，我们研究了如何编写查询以从8base的服务器端接收数据，以及如何编写<i>创建</i>和<i>删除</i>突变。  8base作为平台相对易于浏览，并提供直观的用户界面。 我整夜都在弄清楚。 您可以通过学习如何编写<i>更新</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">突变</a>以及添加编辑注释的功能来填补缺失的空缺。 我相信用户会满意的。 您还可以查看其官方<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a>以获取有关平台的更多信息。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>找到应用程序的源代码。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463907/">https://habr.com/ru/post/zh-CN463907/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463897/index.html">MCS云平台安全审核</a></li>
<li><a href="../zh-CN463899/index.html">为什么我们一直在等自行车的发明这么久？</a></li>
<li><a href="../zh-CN463901/index.html">在圣彼得堡测试NB-IoT网络的可用性（2019年8月）</a></li>
<li><a href="../zh-CN463903/index.html">5设计领导技巧 第二部分</a></li>
<li><a href="../zh-CN463905/index.html">YouTube频道促销</a></li>
<li><a href="../zh-CN463913/index.html">招聘机构真正在寻找程序员吗？</a></li>
<li><a href="../zh-CN463915/index.html">什么是CDN，它如何运作？</a></li>
<li><a href="../zh-CN463917/index.html">成为Web开发人员前我想知道的20件事</a></li>
<li><a href="../zh-CN463919/index.html">大哲学思想：十大DotNext 2019飞行员讲座</a></li>
<li><a href="../zh-CN463921/index.html">（不是非常）iOS和Android通用代码库的隐藏成本</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>