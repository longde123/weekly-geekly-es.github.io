<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíó ‚óΩÔ∏è üóæ Como passar em um teste cibern√©tico no Checkpoint üë∏üèª ü§´ ü¶å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal, sou Nikita Kurtin , curadora da Escola Superior Israelense de TI e seguran√ßa HackerU 

 A Checkpoint , empresa israelense l√≠der em segura...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como passar em um teste cibern√©tico no Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Ol√° pessoal, sou <b>Nikita Kurtin</b> , curadora da Escola Superior Israelense de TI e seguran√ßa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><b>HackerU</b></a> <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A Checkpoint</a></b> , empresa israelense l√≠der em seguran√ßa da informa√ß√£o, publicou uma s√©rie de testes cibern√©ticos neste ver√£o. <br><br>  As tarefas foram divididas em seis categorias: <br><br>  ‚Ä¢ l√≥gica <br>  ‚Ä¢ Web <br>  Programa√ß√£o <br>  Rede <br>  ‚Ä¢ Revers√£o <br>  Surpresa <br><br>  Duas tarefas para cada dire√ß√£o.  Neste post, vou contar como passei em apenas quatro testes, nos pr√≥ximos tr√™s outros: <br><br>  <b>O Checkpoint</b> j√° havia conseguido ganhar respeito e interesse de minha parte, ent√£o decidi aceitar esses desafios.  No entanto, devido ao emprego, fui capaz de realizar apenas 8 de 12 tarefas (de quatro categorias diferentes).  E eu consegui resolver 7 deles. <br><br>  O desafio terminou oficialmente at√© o final de setembro de 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="imagem"><br><br>  Portanto, agora, com a consci√™ncia limpa, posso lhe contar passo a passo sobre como eu comecei a resolver os seguintes problemas: <br><br>  ‚Ä¢ Desafio l√≥gico "PNG ++" <br>  ‚Ä¢ Desafio na Web ‚ÄúOs rob√¥s est√£o de volta‚Äù <br>  ‚Ä¢ Desafio na Web "Galeria Diego" <br>  ‚Ä¢ Tarefa de programa√ß√£o "Etapas cuidadosas" <br>  ‚Ä¢ A tarefa de programar "Puzzle" <br>  ‚Ä¢ Desafio de rede ‚ÄúPing Pong‚Äù <br>  ‚Ä¢ Protocolo de desafio de rede <br><br>  <u><b>Desafio: PNG ++</b></u> <u><br></u> <br>  Descri√ß√£o: <br><br>  Esta imagem (link para o arquivo PNG criptografado) <i>foi codificada usando uma cifra personalizada.</i> <i><br><br></i>  <i>Conseguimos ler a maior parte desse c√≥digo aqui (link para c√≥digo python).</i> <i><br></i>  <i>Infelizmente, algu√©m derramou caf√© lentamente em todo o key_transformator.py.</i> <i><br><a name="habracut"></a></i>  <i>Voc√™ poderia nos ajudar a decifrar esta imagem?</i> <br><br>  C√≥digo Python: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="imagem"><br><br>  A l√≥gica de criptografia √© a seguinte: <br><br>  1. Defina o comprimento da chave (tamanho da chave) para 4 bytes <br><br>  2. Leia os bytes do arquivo "flag.png" na vari√°vel "img" <br><br>  3. Adicione preenchimento ao arquivo, ao primeiro m√∫ltiplo mais pr√≥ximo de quatro.  Preenchimento √© igual ao n√∫mero de bytes ausentes.  Por exemplo, se o comprimento do arquivo for 29 bytes (3 ausentes), adicione tr√™s bytes com o valor decimal 3 (ASCII 0x03).  Ou, em outras palavras, os bytes de preenchimento n√£o podem estar vazios (ASCII 0x00), porque seu valor decimal √© zero, o que n√£o implica em preenchimento. <br><br>  4. Defina a tecla de partida com quatro letras mai√∫sculas aleat√≥rias ([AZ]). <br><br>  5. Fa√ßa o mesmo com todos os bytes do arquivo, criptografando cadeias de quatro bytes por vez <br><br>  a.  Cada byte no arquivo √© discutido por byte da chave <br>  b.  A chave √© constantemente convertida em outra chave, key_transformator.transform (key) √© respons√°vel por isso <br>  c.  Bytes criptografados s√£o adicionados ao enc_data <br><br>  6. Digite enc_data (bytes criptografados) em encrypted.png <br><br>  Para come√ßar, verifiquei o cabe√ßalho do formato PNG e descobri que os oito primeiros bytes s√£o os seguintes: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  Peguei os oito primeiros bytes do arquivo criptografado e os torci com esses oito bytes: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="imagem"><br><br>  A chave do primeiro bloco ficou assim: <br>  [85, 80, 82, 81] <br><br>  E o segundo bloco - assim: <br>  [86, 81, 83, 82] <br><br>  Como cada chave subseq√ºente √© gerada dinamicamente usando a chave anterior (key = key_transformator.transform (key)), entendi o algoritmo: adicione um a cada byte na chave anterior: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  E ent√£o percebi que o nome do desafio escondia uma dica doentia. <br><br>  Eu escrevi duas "fun√ß√µes auxiliares": <br><br>  ‚Ä¢ "nextKey", que restaura a pr√≥xima chave com base na √∫ltima <br>  ‚Ä¢ ‚ÄúnextChar‚Äù, que restaura a pr√≥xima letra e, na maioria dos casos, simplesmente aumenta em um se cair dentro dos limites de bytes (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="imagem"><br><br>  Eu converti os 4 bytes originais [85, 80 82, 81] em letras: "UPRQ" e executei o algoritmo de volta <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="imagem"><br><br>  O sinalizador foi especificado no arquivo descriptografado: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="imagem"><br><br>  <u><b>Desafio: O retorno dos rob√¥s</b></u> <u><br></u> <br><br>  Descri√ß√£o: <br><br>  <i>Os rob√¥s s√£o legais, mas acredite: o acesso deles deve ser limitado!</i>  Confira (link) <br><br>  Ap√≥s seguir o link, voc√™ v√™ uma determinada p√°gina dedicada aos rob√¥s.  Basicamente, tudo sugere que voc√™ deve verificar a presen√ßa do arquivo "robots.txt". <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="imagem"><br><br>  Adicionando ./robots.txt ao URL, obtemos o seguinte: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="imagem"><br><br>  Eu verifiquei ./secret_login.html e me deparei com uma p√°gina de registro <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="imagem"><br><br>  Em seguida, verifiquei o c√≥digo fonte do formul√°rio para encontrar a confirma√ß√£o da senha e vi este Javascript: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="imagem"><br><br>  Parece que quando o valor √© confirmado, ele √© enviado para a fun√ß√£o de autoriza√ß√£o, que decodifica o valor passado usando a fun√ß√£o btoa (fun√ß√£o de decodifica√ß√£o base64 em Javascript) e o compara com a string: ‚ÄúSzMzcFQjM1IwYjB0JDB1dA ==‚Äù. <br><br>  Decodifiquei esta linha <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="imagem"><br><br>  Eu inseri o valor resultante na string da senha.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="imagem"><br><br><br>  <b><u>Desafio: Diego Gallery</u></b> <b><br></b> <br>  Descri√ß√£o: <br><br>  <i>Recentemente, comecei a desenvolver uma plataforma para gerenciar as fotos do meu gato e proteger meu flag.txt.</i>  <i>Por favor, verifique meu sistema (link para o formul√°rio de inscri√ß√£o).</i> <i><br><br></i>  <i>Para evitar batentes no sistema de seguran√ßa, como a capacidade de incorporar c√≥digo SQL, criei meu pr√≥prio esquema.</i> <i><br><br></i>  <i>Sua breve descri√ß√£o est√° dispon√≠vel aqui (link para o diagrama)</i> <br><br>  Formul√°rio de Inscri√ß√£o: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="imagem"><br><br>  Circuito predefinido: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="imagem"><br><br>  Depois de definir o nome de usu√°rio e a senha do teste, obtive acesso √† galeria p√∫blica do gato "Diego". <br><br>  Desde que me registrei como usu√°rio regular, achei que talvez fosse necess√°rio encontrar uma maneira de escalar os privil√©gios do PE (escalonamento de privil√©gios).  Examinando o esquema para usu√°rios registrados, vi que a diferen√ßa entre o usu√°rio comum e o administrador est√° na terceira se√ß√£o do esquema, separada por tr√™s tra√ßos. <br><br>  Tendo calculado que se o primeiro valor (nome de usu√°rio) se refere √† primeira se√ß√£o e o segundo (senha) se refere √† segunda, a fun√ß√£o √© atribu√≠da pelo sistema imediatamente ap√≥s a entrada do usu√°rio com os direitos atuais. <br><br>  Por exemplo: <br><br>  IN√çCIO ||| Primeiro valor ||| Segundo valor ||| usu√°rio (Adicionado pelo servi√ßo da web) ||| END <br><br>  Minha carga √∫til foi a seguinte: <br><br>  ‚Ä¢ Primeiro valor: "niki ||| niki ||| admin ||| END \ nSTART ||| outro" <br>  ‚Ä¢ Segundo valor: "outro" <br><br>  Isso provavelmente gerou as seguintes linhas de log: <br><br>  IN√çCIO ||| niki ||| niki ||| admin ||| END <br>  IN√çCIO ||| outro ||| outro ||| usu√°rio ||| END <br><br>  Depois disso, consegui fazer login como administrador e obter todos os direitos: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="imagem"><br><br>  Pressionar os bot√µes apenas ativa um aviso de que a bandeira est√° segura. <br>  No entanto, dentro da URL, voc√™ pode ler: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Que alude muito explicitamente ao <i>LFI (inclus√£o de arquivo local) via URL</i> <br><br>  Eu tentei: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  E a bandeira era minha. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="imagem"><br><br>  <b><u>Desafio: etapas cuidadosas</u></b> <b><br></b> <br>  Descri√ß√£o: <br><br>  <i>Este (link do arquivo) √© um monte de arquivos que encontramos.</i>  <i>Temos certeza de que a bandeira secreta est√° oculta em algum lugar dentro deles.</i> <i><br></i>  <i>Temos certeza absoluta de que os dados que estamos procurando est√£o ocultos na se√ß√£o de coment√°rios de cada arquivo.</i> <i><br></i>  <i>Voc√™ poderia ir com cuidado entre os arquivos e encontrar a bandeira?</i> <i><br></i>  <i>Boa sorte</i> <br><br>  Ap√≥s extrair o arquivo, voc√™ obt√©m um diret√≥rio chamado "archives" com dois mil arquivos dentro, intitulado "unzipme. [Number]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="imagem"><br><br>  Eu usei o programa binwalk para verificar o primeiro arquivo.  E aqui est√° o que o programa me deu: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="imagem"><br><br>  Sim, ent√£o, na se√ß√£o de coment√°rios, temos letras e n√∫meros.  Dicas de novo? <br><br>  No come√ßo, pensei em conectar as letras aos √≠ndices fornecidos nesse arquivo zip e verificar o pr√≥ximo arquivo j√° com o √≠ndice 245. <br><br>  Mas aqui veio uma surpresa: o segundo arquivo n√£o estava em zip, mas em formato rar. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="imagem"><br><br>  Portanto, eu tive que "anrarn" para chegar aos coment√°rios: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="imagem"><br><br>  Minha l√≥gica era executar o arquivo no binwalk e, se eu encontrar um RAR, descompacte-o para obter os coment√°rios.  Caso contr√°rio, visualize diretamente a se√ß√£o de coment√°rios para entender outras a√ß√µes. <br><br>  Meu primeiro palpite: o n√∫mero √© o √≠ndice de arquivos (cada um foi numerado de 0 a 1999).  No entanto, descobri que alguns n√∫meros s√£o negativos, o que significa que n√£o podem ser um √≠ndice. <br><br>  Segunda suposi√ß√£o: o n√∫mero √© um salto, que pode muito bem ser negativo.  Para cada n√∫mero, eu precisava de um salto para o pr√≥ximo arquivo.  Eu sabia que se meu c√≥digo pular constantemente para o pr√≥ximo arquivo calculado, isso poder√° criar uma pequena intercepta√ß√£o na forma de um ciclo e meu c√≥digo ficar√° preso em um loop infinito.  Ent√£o, eu escrevi um c√≥digo python com um limite de conta.  E depois de v√°rios testes, descobri que o n√∫mero 120 seria suficiente: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="imagem"><br><br>  E a bandeira era minha: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="imagem"><br><br>  Os outros tr√™s que descrevi no pr√≥ximo post, leia, tente, ficarei feliz em seus coment√°rios </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429112/">https://habr.com/ru/post/pt429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429102/index.html">Vendas de ve√≠culos el√©tricos no Canad√°</a></li>
<li><a href="../pt429104/index.html">Dados altos</a></li>
<li><a href="../pt429106/index.html">CEI para infraestrutura</a></li>
<li><a href="../pt429108/index.html">Google: a remo√ß√£o de links "pirateados" da emiss√£o n√£o resolver√° o problema de conte√∫do ilegal</a></li>
<li><a href="../pt429110/index.html">Dicas de CSS que voc√™ provavelmente n√£o encontrar√° nos tutoriais</a></li>
<li><a href="../pt429114/index.html">Como passar em um teste cibern√©tico no ponto de verifica√ß√£o parte 2</a></li>
<li><a href="../pt429116/index.html">Crie imagens responsivas</a></li>
<li><a href="../pt429118/index.html">Analista de aeroporto</a></li>
<li><a href="../pt429120/index.html">Desafiadores de Java # 3: Polimorfismo e heran√ßa</a></li>
<li><a href="../pt429122/index.html">O futuro pr√≥ximo da NetApp</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>