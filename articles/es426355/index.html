<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍💼 🗣️ ♉️ Función Math.Sin (doble) para GPU ☑️ 🏷️ 🕵🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prólogo 
 Necesitaba calcular el arco con mayor precisión en el procesador de la tarjeta de video en tiempo real. 

 El autor no estableció una meta p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Función Math.Sin (doble) para GPU</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426355/"><h3>  Prólogo </h3><br>  Necesitaba calcular el arco con mayor precisión en el procesador de la tarjeta de video en tiempo real. <br><br>  El autor no estableció una meta para superar la función estándar System.Math.Sin () (C #) y no la alcanzó. <br><a name="habracut"></a><br>  <i>El resultado del trabajo y mi elección (para aquellos que no quieren leer):</i> <br><br><div class="spoiler">  <b class="spoiler_title">Sin_3 (rad)</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Math_d { const <span class="hljs-type"><span class="hljs-type">double</span></span> PI025 = Math.PI / <span class="hljs-number"><span class="hljs-number">4</span></span>; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>^<span class="hljs-number"><span class="hljs-number">17</span></span> = <span class="hljs-number"><span class="hljs-number">131072</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span> ),   <span class="hljs-number"><span class="hljs-number">10000</span></span> ( ),  <span class="hljs-number"><span class="hljs-number">2</span></span>^<span class="hljs-number"><span class="hljs-number">21</span></span> = <span class="hljs-number"><span class="hljs-number">22097152</span></span> (<span class="hljs-number"><span class="hljs-number">16</span></span> )   +<span class="hljs-number"><span class="hljs-number">-1</span></span> ( ) (  ) &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; const <span class="hljs-type"><span class="hljs-type">int</span></span> length_mem = <span class="hljs-number"><span class="hljs-number">22097152</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> length_mem_M1 = length_mem - <span class="hljs-number"><span class="hljs-number">1</span></span>; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;    sin,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] mem_sin; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;    cos,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] mem_cos; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  ,   sin,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> Initialise() { Ini_Mem_Sin(); Ini_Mem_Cos(); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;       Cos,   . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;&lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin_3(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">double</span></span> rad_025; <span class="hljs-type"><span class="hljs-type">int</span></span> i; //    //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rad &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { rad = -rad + Math.PI; } i = (<span class="hljs-type"><span class="hljs-type">int</span></span>)(rad / PI025); //   rad_025 = rad - PI025 * i; //     ( ) i = i &amp; <span class="hljs-number"><span class="hljs-number">7</span></span>; //      <span class="hljs-number"><span class="hljs-number">8</span></span> //    switch (i) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin_Lerp(PI025 - rad_025); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   sin    &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Ini_Mem_Sin() { <span class="hljs-type"><span class="hljs-type">double</span></span> rad; mem_sin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[length_mem]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length_mem; i++) { rad = (i * PI025) / length_mem_M1; mem_sin[i] = Math.Sin(rad); } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   cos    &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Ini_Mem_Cos() { <span class="hljs-type"><span class="hljs-type">double</span></span> rad; mem_cos = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[length_mem]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length_mem; i++) { rad = (i * PI025) / length_mem_M1; mem_cos[i] = Math.Cos(rad); } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      sin  <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;     <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin_Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">int</span></span> i_0; <span class="hljs-type"><span class="hljs-type">int</span></span> i_1; <span class="hljs-type"><span class="hljs-type">double</span></span> i_0d; <span class="hljs-type"><span class="hljs-type">double</span></span> percent; <span class="hljs-type"><span class="hljs-type">double</span></span> a; <span class="hljs-type"><span class="hljs-type">double</span></span> b; <span class="hljs-type"><span class="hljs-type">double</span></span> s; percent = rad / PI025; i_0d = percent * length_mem_M1; i_0 = (<span class="hljs-type"><span class="hljs-type">int</span></span>)i_0d; i_1 = i_0 + <span class="hljs-number"><span class="hljs-number">1</span></span>; a = mem_sin[i_0]; b = mem_sin[i_1]; s = i_0d - i_0; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Lerp(a, b, s); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      cos  <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;     <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span> Cos_Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">int</span></span> i_0; <span class="hljs-type"><span class="hljs-type">int</span></span> i_1; <span class="hljs-type"><span class="hljs-type">double</span></span> i_0d; <span class="hljs-type"><span class="hljs-type">double</span></span> percent; <span class="hljs-type"><span class="hljs-type">double</span></span> a; <span class="hljs-type"><span class="hljs-type">double</span></span> b; <span class="hljs-type"><span class="hljs-type">double</span></span> s; percent = rad / PI025; i_0d = percent * length_mem_M1; i_0 = (<span class="hljs-type"><span class="hljs-type">int</span></span>)i_0d; i_1 = i_0 + <span class="hljs-number"><span class="hljs-number">1</span></span>; a = mem_cos[i_0]; b = mem_cos[i_1]; s = i_0d - i_0; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Lerp(a, b, s); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      . (<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + s * (b - a)) &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="a"&gt;  . &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="b"&gt;  . &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="s"&gt;  . <span class="hljs-number"><span class="hljs-number">0</span></span> = a, <span class="hljs-number"><span class="hljs-number">1</span></span> = b, <span class="hljs-number"><span class="hljs-number">0.5</span></span> =   a  b. &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> a, <span class="hljs-type"><span class="hljs-type">double</span></span> b, <span class="hljs-type"><span class="hljs-type">double</span></span> s) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + s * (b - a); } }</code> </pre> <br></div></div><br><h3>  Razones para su publicación. </h3><br><ul><li>  No existe una función Sin estándar para el doble en el lenguaje HLSL (pero esto no es exacto) </li><li>  Hay poca información disponible en Internet sobre este tema. </li></ul><br><h3>  Enfoques considerados </h3><br><ul><li>  Serie Taylor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">(Wikipedia)</a> </li><li>  Polinomios ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">autor de la función: "asvp"</a> ) </li><li>  Interpolación lineal de resultados precalculados de Math.Sin y Math.Cos (autor: ) </li></ul><br><h3>  Los parámetros analizados </h3><br><ul><li>  Precisión con Math.Sin </li><li>  Velocidad en relación con las matemáticas. </li></ul><br>  <u>Además del análisis, mejoraremos su rendimiento.</u> <br><br><h4>  Taylor clasifica </h4><br>  Pros: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">La más alta precisión</b> <div class="spoiler_text">  Esta función, utilizada para calcular el valor Sin, se puede utilizar para calcular el <u>valor</u> Sin <u>infinitamente preciso</u> .  Cuantas más iteraciones sufra, más exactamente se obtendrá el valor en la salida (en una hipótesis).  En la práctica de programación, vale la pena considerar los errores de redondeo de los cálculos dependiendo de los tipos de parámetros utilizados (doble, flotante, decimal y otros). </div></div></li><li><div class="spoiler">  <b class="spoiler_title">Calcula cualquier ángulo</b> <div class="spoiler_text">  Puede ingresar cualquier valor como argumento de la función, por lo que no es necesario monitorear los parámetros de entrada. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Independencia</b> <div class="spoiler_text">  No requiere cálculos preliminares (como las funciones que se analizan a continuación), y a menudo es la base sobre la cual se ensamblan las funciones más rápidas. <br></div></div></li></ul><br>  Contras: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">Muy baja velocidad (4-10%)</b> <div class="spoiler_text">  Se necesitan muchas iteraciones para acercar la precisión a la precisión de Math.Sin, por lo que funciona 25 veces más lento que la función estándar. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Cuanto mayor es el ángulo, menor es la precisión</b> <div class="spoiler_text">  Cuanto mayor sea el ángulo ingresado en la función, se necesitan más iteraciones para lograr la misma precisión que Math.Sin. <br></div></div></li></ul><br>  <i><b>Aspecto original (velocidad: 4%):</b></i> <br><br>  La función estándar implica calcular factoriales, así como elevar a una potencia cada iteración. <br><br><img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/c847dfe24de5ad14ebd936999a7183ba96d81717" alt="imagen"><br><br>  <i><b>Modificado (velocidad: 10%):</b></i> <br><br>  El cálculo de algunos grados se puede reducir en un ciclo (a * = aa;), y otros factores se pueden calcular previamente y poner en una matriz, mientras que el cambio de los signos (+, -, +, ...) no se puede elevar a una potencia y su cálculo también se puede reducir utilizando los valores anteriores. <br><br>  El resultado es el siguiente código: <br><br><div class="spoiler">  <b class="spoiler_title">Sin (rad, pasos)</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> // &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  ,    Fact &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] fact; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;            . ///   rad,   . ///  ( Math): <span class="hljs-number"><span class="hljs-number">4</span></span>% (fps)  steps = <span class="hljs-number"><span class="hljs-number">17</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;   .      pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="steps"&gt;  :  ,   .  pi/<span class="hljs-number"><span class="hljs-number">4</span></span>   E<span class="hljs-number"><span class="hljs-number">-15</span></span>  <span class="hljs-number"><span class="hljs-number">8.</span></span> &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin(<span class="hljs-type"><span class="hljs-type">double</span></span> rad, <span class="hljs-type"><span class="hljs-type">int</span></span> steps) { <span class="hljs-type"><span class="hljs-type">double</span></span> ret; <span class="hljs-type"><span class="hljs-type">double</span></span> a; //,     <span class="hljs-type"><span class="hljs-type">double</span></span> aa; // *  <span class="hljs-type"><span class="hljs-type">int</span></span> i_f; //  <span class="hljs-type"><span class="hljs-type">int</span></span> sign; // (  -  +,     = +) ret = <span class="hljs-number"><span class="hljs-number">0</span></span>; sign = <span class="hljs-number"><span class="hljs-number">-1</span></span>; aa = rad * rad; a = rad; i_f = <span class="hljs-number"><span class="hljs-number">1</span></span>; //      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; steps; n++) { sign *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; ret += sign * a / Fact(i_f); a *= aa; i_f += <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   (n!).  n &gt; fact.Length,  <span class="hljs-number"><span class="hljs-number">-1.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="n"&gt; ,     . &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Fact(<span class="hljs-type"><span class="hljs-type">int</span></span> n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; n &lt; fact.Length) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fact[n]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>.Log("    . n = " + n + ",   = " + fact.Length); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Init_Fact() { <span class="hljs-type"><span class="hljs-type">int</span></span> steps; steps = <span class="hljs-number"><span class="hljs-number">46</span></span>; fact = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[steps]; fact[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> n = <span class="hljs-number"><span class="hljs-number">1</span></span>; n &lt; steps; n++) { fact[n] = fact[n - <span class="hljs-number"><span class="hljs-number">1</span></span>] * n; } }</code> </pre><br></div></div><br>  <i><b>Vista superior (velocidad: 19%):</b></i> <br><br>  Sabemos que cuanto menor es el ángulo, menos iteraciones son necesarias.  El ángulo más pequeño que necesitamos es = 0.25 * PI, es decir  45 grados  Considerando Sin y Cos en la región de 45 grados, podemos obtener todos los valores de -1 a 1 para Sin (en la región de 2 * PI).  Para hacer esto, dividimos el círculo (2 * PI) en 8 partes y para cada parte indicamos nuestro propio método de cálculo del seno.  Además, para acelerar el cálculo, nos negaremos a utilizar la función de obtener el resto (%) (para obtener la posición del ángulo dentro de la zona de 45 grados): <br><br><div class="spoiler">  <b class="spoiler_title">Sin_2 (rad)</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> // &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  ,    Fact &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] fact; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   Sin &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;&lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin_2(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">double</span></span> rad_025; <span class="hljs-type"><span class="hljs-type">int</span></span> i; //rad = rad % PI2; //% -   .  , fps   <span class="hljs-number"><span class="hljs-number">90</span></span>  <span class="hljs-number"><span class="hljs-number">150</span></span> (  <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">000</span></span>   ) //rad_025 = rad % PI025; i = (<span class="hljs-type"><span class="hljs-type">int</span></span>)(rad / PI025); rad_025 = rad - PI025 * i; i = i &amp; <span class="hljs-number"><span class="hljs-number">7</span></span>; //     <span class="hljs-number"><span class="hljs-number">8</span></span>  //    switch (i) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin(rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos(PI025 - rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos(rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin(PI025 - rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin(rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos(PI025 - rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos(rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin(PI025 - rad_025, <span class="hljs-number"><span class="hljs-number">8</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;            . ///   rad,   . ///  ( Math): <span class="hljs-number"><span class="hljs-number">10</span></span>% (fps)  steps = <span class="hljs-number"><span class="hljs-number">17</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;   .      pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="steps"&gt;  :  ,   .  pi/<span class="hljs-number"><span class="hljs-number">4</span></span>   E<span class="hljs-number"><span class="hljs-number">-15</span></span>  <span class="hljs-number"><span class="hljs-number">8.</span></span> &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin(<span class="hljs-type"><span class="hljs-type">double</span></span> rad, <span class="hljs-type"><span class="hljs-type">int</span></span> steps) { <span class="hljs-type"><span class="hljs-type">double</span></span> ret; <span class="hljs-type"><span class="hljs-type">double</span></span> a; //,     <span class="hljs-type"><span class="hljs-type">double</span></span> aa; // *  <span class="hljs-type"><span class="hljs-type">int</span></span> i_f; //  <span class="hljs-type"><span class="hljs-type">int</span></span> sign; // (  -  +,     = +) ret = <span class="hljs-number"><span class="hljs-number">0</span></span>; sign = <span class="hljs-number"><span class="hljs-number">-1</span></span>; aa = rad * rad; a = rad; i_f = <span class="hljs-number"><span class="hljs-number">1</span></span>; //      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; steps; n++) { sign *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; ret += sign * a / Fact(i_f); a *= aa; i_f += <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;            . ///   rad,   . ///  ( Math): <span class="hljs-number"><span class="hljs-number">10</span></span>% (fps), <span class="hljs-number"><span class="hljs-number">26</span></span>% (test)  steps = <span class="hljs-number"><span class="hljs-number">17</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;   .      pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="steps"&gt;  :  ,   .  pi/<span class="hljs-number"><span class="hljs-number">4</span></span>   E<span class="hljs-number"><span class="hljs-number">-15</span></span>  <span class="hljs-number"><span class="hljs-number">8.</span></span> &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Cos(<span class="hljs-type"><span class="hljs-type">double</span></span> rad, <span class="hljs-type"><span class="hljs-type">int</span></span> steps) { <span class="hljs-type"><span class="hljs-type">double</span></span> ret; <span class="hljs-type"><span class="hljs-type">double</span></span> a; <span class="hljs-type"><span class="hljs-type">double</span></span> aa; // *  <span class="hljs-type"><span class="hljs-type">int</span></span> i_f; //  <span class="hljs-type"><span class="hljs-type">int</span></span> sign; // (  -  +,     = +) ret = <span class="hljs-number"><span class="hljs-number">0</span></span>; sign = <span class="hljs-number"><span class="hljs-number">-1</span></span>; aa = rad * rad; a = <span class="hljs-number"><span class="hljs-number">1</span></span>; i_f = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; steps; n++) { sign *= <span class="hljs-number"><span class="hljs-number">-1</span></span>; ret += sign * a / Fact(i_f); a *= aa; i_f += <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   (n!).  n &gt; fact.Length,  <span class="hljs-number"><span class="hljs-number">-1.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="n"&gt; ,     . &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Fact(<span class="hljs-type"><span class="hljs-type">int</span></span> n) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; n &lt; fact.Length) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fact[n]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>.Log("    . n = " + n + ",   = " + fact.Length); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Init_Fact() { <span class="hljs-type"><span class="hljs-type">int</span></span> steps; steps = <span class="hljs-number"><span class="hljs-number">46</span></span>; fact = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[steps]; fact[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> n = <span class="hljs-number"><span class="hljs-number">1</span></span>; n &lt; steps; n++) { fact[n] = fact[n - <span class="hljs-number"><span class="hljs-number">1</span></span>] * n; } }</code> </pre> <br></div></div><br><h3>  Polinomios </h3><br>  Encontré este método en Internet, el autor necesitaba una función de búsqueda rápida de Sin para el doble de baja precisión (error &lt;0.000 001) sin usar bibliotecas de valores precalculados. <br><br>  Pros: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">Alta velocidad (9-84%)</b> <div class="spoiler_text">  Inicialmente, el polinomio arrojado sin cambios mostró una velocidad del 9% del Math.Sin original, que es 10 veces más lento.  Gracias a pequeños cambios, la velocidad aumenta bruscamente al 84%, lo que no está mal si cierra los ojos con precisión. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">No se requieren cálculos preliminares adicionales ni memoria</b> <div class="spoiler_text">  Si en la parte superior y más abajo necesitamos componer matrices de variables para acelerar los cálculos, entonces todos los coeficientes clave fueron calculados amablemente y colocados en la fórmula por el propio autor en forma de constantes. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Precisión superior a Mathf.Sin (flotante)</b> <div class="spoiler_text">  Para comparar: <br><br>  0.84147 <b>1</b> - Mathf.Sin (1) (motor de Unity); <br>  0.841470984807897 - Math.Sin (1) (función estándar de C #); <br>  0.8414709 <b>56802368</b> - sin (1) (GPU, lenguaje hlsl); <br>  0.84147 <b>1184637935</b> - <b>Sin_0 (1)</b> . <br></div></div></li></ul><br>  Contras: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">No universal</b> <div class="spoiler_text">  No puede ajustar la precisión manualmente porque no se sabe qué herramientas utilizó el autor para calcular este polinomio. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Por qué</b> <div class="spoiler_text">  ¿Por qué el autor necesitaba una función que no requiera ninguna matriz y que tenga una precisión tan baja (en comparación con el doble)? <br></div></div></li></ul><br>  <i><b>Vista original</b></i> <br><br><div class="spoiler">  <b class="spoiler_title">Sin_1 (x)</b> <div class="spoiler_text"><pre> <code class="hljs cmake">/// &lt;summary&gt;  ( <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>): <span class="hljs-number"><span class="hljs-number">9</span></span>% (fps)&lt;/summary&gt; /// &lt;param name=<span class="hljs-string"><span class="hljs-string">"x"</span></span>&gt;     -<span class="hljs-number"><span class="hljs-number">2</span></span>*Pi  <span class="hljs-number"><span class="hljs-number">2</span></span>*Pi &lt;/param&gt; public static double Sin_1(double x) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.9999997192673006</span></span> * x - <span class="hljs-number"><span class="hljs-number">0.1666657564532464</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">3</span></span>) + <span class="hljs-number"><span class="hljs-number">0.008332803647181511</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">5</span></span>) - <span class="hljs-number"><span class="hljs-number">0.00019830197237204295</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">7</span></span>) + <span class="hljs-number"><span class="hljs-number">2.7444305061093514</span></span>e-<span class="hljs-number"><span class="hljs-number">6</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">9</span></span>) - <span class="hljs-number"><span class="hljs-number">2.442176561869478</span></span>e-<span class="hljs-number"><span class="hljs-number">8</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">11</span></span>) + <span class="hljs-number"><span class="hljs-number">1.407555708887347</span></span>e-<span class="hljs-number"><span class="hljs-number">10</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">13</span></span>) - <span class="hljs-number"><span class="hljs-number">4.240664814288337</span></span>e-<span class="hljs-number"><span class="hljs-number">13</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">Math</span></span>.Pow(x, <span class="hljs-number"><span class="hljs-number">15</span></span>); }</code> </pre><br></div></div><br>  <i><b>Vista superior</b></i> <br><br><div class="spoiler">  <b class="spoiler_title">Sin_0 (rad)</b> <div class="spoiler_text"><pre> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;summary&gt;  ( Math): <span class="hljs-number"><span class="hljs-number">83</span></span>% (fps)&lt;<span class="hljs-regexp"><span class="hljs-regexp">/summary&gt; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">//</span></span> &lt;param name=<span class="hljs-string"><span class="hljs-string">"rad"</span></span>&gt;     -<span class="hljs-number"><span class="hljs-number">2</span></span>*Pi  <span class="hljs-number"><span class="hljs-number">2</span></span>*Pi &lt;<span class="hljs-regexp"><span class="hljs-regexp">/param&gt; public static double Sin_0(double rad) { double x; double xx; double ret; xx = rad * rad; x = rad; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/1 ret = 0.9999997192673006 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/3 ret -= 0.1666657564532464 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/5 ret += 0.008332803647181511 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/7 ret -= 0.00019830197237204295 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/9 ret += 2.7444305061093514e-6 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/11 ret -= 2.442176561869478e-8 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/13 ret += 1.407555708887347e-10 * x; x *= xx; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/15 ret -= 4.240664814288337e-13 * x; return ret; }</span></span></code> </pre><br></div></div><br><h3>  Interpolación lineal </h3><br>  Este método se basa en la interpolación lineal entre los resultados de dos registros en una matriz. <br>  Las entradas se dividen en mem_sin y mem_cos, contienen los resultados precalculados de la función estándar Math.Sin y Math.Cos en un segmento de parámetros de entrada de 0 a 0.25 * PI. <br><br>  El principio de las manipulaciones con un ángulo de 0 a 45 grados no difiere de la versión mejorada de la serie Taylor, pero al mismo tiempo se llama una función que encuentra, entre los cuales dos registros hay un ángulo, y encuentra un valor entre ellos. <br><br>  Pros: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">Alta velocidad (65%)</b> <div class="spoiler_text">  Debido a la simplicidad del algoritmo de interpolación, la velocidad alcanza el 65% de la velocidad de Math.Sin.  Creo que la velocidad&gt; 33% es satisfactoria. <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">La más alta precisión</b> <div class="spoiler_text">  Un ejemplo de un caso raro de rechazo: <br>  0.255835595715180 - Math.Sin; <br>  0.2558355957151 <b>79</b> - <b>Sin_3</b> . <br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Pie rápido</b> <div class="spoiler_text">  Me encanta esta función porque nació en agonía, escrita por mí y superó los requisitos: velocidad&gt; 33%, precisión superior a 1e-14.  Le daré un nombre orgulloso: Vēlōx Pes. <br></div></div></li></ul><br>  Contras: <br><br><ul><li><div class="spoiler">  <b class="spoiler_title">Requiere un lugar en la memoria</b> <div class="spoiler_text">  Para trabajar, primero debe calcular dos matrices: para sin y para cos;  cada matriz pesa ~ 16 mb (16 * 2 = 32 mb) <br></div></div></li></ul><br>  <i><b>Vista original</b></i> <br><br><div class="spoiler">  <b class="spoiler_title">Sin_3 (rad)</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Math_d { const <span class="hljs-type"><span class="hljs-type">double</span></span> PI025 = Math.PI / <span class="hljs-number"><span class="hljs-number">4</span></span>; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>^<span class="hljs-number"><span class="hljs-number">17</span></span> = <span class="hljs-number"><span class="hljs-number">131072</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span> ),   <span class="hljs-number"><span class="hljs-number">10000</span></span> ( ),  <span class="hljs-number"><span class="hljs-number">2</span></span>^<span class="hljs-number"><span class="hljs-number">21</span></span> = <span class="hljs-number"><span class="hljs-number">22097152</span></span> (<span class="hljs-number"><span class="hljs-number">16</span></span> )   +<span class="hljs-number"><span class="hljs-number">-1</span></span> ( ) (  ) &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; const <span class="hljs-type"><span class="hljs-type">int</span></span> length_mem = <span class="hljs-number"><span class="hljs-number">22097152</span></span>; const <span class="hljs-type"><span class="hljs-type">int</span></span> length_mem_M1 = length_mem - <span class="hljs-number"><span class="hljs-number">1</span></span>; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;    sin,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] mem_sin; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;    cos,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span>[] mem_cos; /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;  ,   sin,    . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> Initialise() { Ini_Mem_Sin(); Ini_Mem_Cos(); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;       Cos,   . &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;&lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin_3(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">double</span></span> rad_025; <span class="hljs-type"><span class="hljs-type">int</span></span> i; //    //<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rad &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { rad = -rad + Math.PI; } i = (<span class="hljs-type"><span class="hljs-type">int</span></span>)(rad / PI025); //   rad_025 = rad - PI025 * i; //     ( ) i = i &amp; <span class="hljs-number"><span class="hljs-number">7</span></span>; //      <span class="hljs-number"><span class="hljs-number">8</span></span> //    switch (i) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Cos_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Sin_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos_Lerp(PI025 - rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Cos_Lerp(rad_025); <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> -Sin_Lerp(PI025 - rad_025); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   sin    &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Ini_Mem_Sin() { <span class="hljs-type"><span class="hljs-type">double</span></span> rad; mem_sin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[length_mem]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length_mem; i++) { rad = (i * PI025) / length_mem_M1; mem_sin[i] = Math.Sin(rad); } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;   cos    &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; static <span class="hljs-type"><span class="hljs-type">void</span></span> Ini_Mem_Cos() { <span class="hljs-type"><span class="hljs-type">double</span></span> rad; mem_cos = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">double</span></span>[length_mem]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length_mem; i++) { rad = (i * PI025) / length_mem_M1; mem_cos[i] = Math.Cos(rad); } } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      sin  <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;     <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span> Sin_Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">int</span></span> i_0; <span class="hljs-type"><span class="hljs-type">int</span></span> i_1; <span class="hljs-type"><span class="hljs-type">double</span></span> i_0d; <span class="hljs-type"><span class="hljs-type">double</span></span> percent; <span class="hljs-type"><span class="hljs-type">double</span></span> a; <span class="hljs-type"><span class="hljs-type">double</span></span> b; <span class="hljs-type"><span class="hljs-type">double</span></span> s; percent = rad / PI025; i_0d = percent * length_mem_M1; i_0 = (<span class="hljs-type"><span class="hljs-type">int</span></span>)i_0d; i_1 = i_0 + <span class="hljs-number"><span class="hljs-number">1</span></span>; a = mem_sin[i_0]; b = mem_sin[i_1]; s = i_0d - i_0; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Lerp(a, b, s); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      cos  <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="rad"&gt;     <span class="hljs-number"><span class="hljs-number">0</span></span>  pi/<span class="hljs-number"><span class="hljs-number">4.</span></span> &lt;/param&gt; static <span class="hljs-type"><span class="hljs-type">double</span></span> Cos_Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> rad) { <span class="hljs-type"><span class="hljs-type">int</span></span> i_0; <span class="hljs-type"><span class="hljs-type">int</span></span> i_1; <span class="hljs-type"><span class="hljs-type">double</span></span> i_0d; <span class="hljs-type"><span class="hljs-type">double</span></span> percent; <span class="hljs-type"><span class="hljs-type">double</span></span> a; <span class="hljs-type"><span class="hljs-type">double</span></span> b; <span class="hljs-type"><span class="hljs-type">double</span></span> s; percent = rad / PI025; i_0d = percent * length_mem_M1; i_0 = (<span class="hljs-type"><span class="hljs-type">int</span></span>)i_0d; i_1 = i_0 + <span class="hljs-number"><span class="hljs-number">1</span></span>; a = mem_cos[i_0]; b = mem_cos[i_1]; s = i_0d - i_0; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Lerp(a, b, s); } /// &lt;<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt;      . (<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + s * (b - a)) &lt;/<span class="hljs-keyword"><span class="hljs-keyword">summary</span></span>&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="a"&gt;  . &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="b"&gt;  . &lt;/param&gt; /// &lt;param <span class="hljs-type"><span class="hljs-type">name</span></span>="s"&gt;  . <span class="hljs-number"><span class="hljs-number">0</span></span> = a, <span class="hljs-number"><span class="hljs-number">1</span></span> = b, <span class="hljs-number"><span class="hljs-number">0.5</span></span> =   a  b. &lt;/param&gt; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">double</span></span> Lerp(<span class="hljs-type"><span class="hljs-type">double</span></span> a, <span class="hljs-type"><span class="hljs-type">double</span></span> b, <span class="hljs-type"><span class="hljs-type">double</span></span> s) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + s * (b - a); } }</code> </pre><br></div></div><br><br>  <u>UPD: se corrigió el error al determinar el índice en Sin_Lerp (), Cos_Lerp (), Ini_Mem_Sin () e Ini_Mem_Cos ().</u> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es426355/">https://habr.com/ru/post/es426355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es426343/index.html">Reglas de comportamiento caballeroso en TI: la historia de ITIL</a></li>
<li><a href="../es426345/index.html">Interesantes acertijos de entrevistas técnicas</a></li>
<li><a href="../es426347/index.html">ITMO University Digest: nuevos estudios, experiencia de antiguos alumnos y proyectos internacionales</a></li>
<li><a href="../es426349/index.html">Creamos una estación de radio por Internet simple, compacta y económica</a></li>
<li><a href="../es426351/index.html">Cambios en las certificaciones y exámenes de Microsoft</a></li>
<li><a href="../es426357/index.html">Unidad y Vive: Tutorial</a></li>
<li><a href="../es426359/index.html">Iniciativa contra la piratería Yandex no aprobada por los titulares de derechos de autor</a></li>
<li><a href="../es426361/index.html">Sobre la maravilla de la abeja y cómo la matamos</a></li>
<li><a href="../es426363/index.html">Hechos e hipótesis sobre el accidente "Union MS-10"</a></li>
<li><a href="../es426365/index.html">No confíes en Facebook es demasiado tarde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>