<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍳 🤐 🆙 Myapp prolonge ses vacances 🍠 🤛🏽 🧑🏿‍🤝‍🧑🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je suis sûr qu'il y aura ceux parmi le public respecté qui me comprendront. Le fait est que dans toute l'abondance des bibliothèques et des cadres pop...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Myapp prolonge ses vacances</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485688/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/co/a1/gq/coa1gqqaalmvaklsbnzj_d69vc0.png"></div><br>  Je suis sûr qu'il y aura ceux parmi le public respecté qui me comprendront.  Le fait est que dans toute l'abondance des bibliothèques et des cadres populaires pour le frontend Web, je n'aime personnellement <b>pas</b> presque <b>toutes les</b> alternatives.  Dans chacune des options, je me trouve des inconvénients importants qui m'empêchent de les utiliser calmement.  Tout commence toujours de façon rose: un concept intéressant, le son, à première vue, le raisonnement en points «pour» ... Mais alors, tout, encore et encore, commence à se heurter à des dépendances redondantes, des entités superflues et tente de résoudre les problèmes créés par les développeurs eux-mêmes.  On nous propose d'apprendre une nouvelle syntaxe, d'accepter de nouvelles idées, d'apprendre un tas de mots à la mode, d'installer de nombreux packages «nécessaires».  Ok, j'aime tout ce qui est nouveau et j'aime les mots intelligents.  Mais je suis très découragé quand ce qui peut être fait simplement, les gens commencent à se compliquer fractalement.  Vous avez probablement déjà lu les confessions de ceux qui, comme moi, désespéraient de chercher le bon sens dans tout cela et ont décidé d'aller à l'autre extrême - d'écrire tout «à la vanille».  Cela m'est arrivé lorsque j'ai été déçu par le projet <a href="https://www.polymer-project.org/">Polymer</a> , créé avec la participation active des développeurs de Google.  Au début, j'aimais beaucoup tout, la devise de ce mouvement était la phrase «Utilisez la plateforme!», Qui signifiait pour moi: «vous ne devriez pas faire dans le code ce que le navigateur lui-même fera plus efficacement».  L'équipe Polymer a fait beaucoup pour introduire de nouvelles normes et capacités au niveau de la plateforme, et <b>merci</b> beaucoup pour cela.  Mais lorsque ces objectifs ont été <a href="https://caniuse.com/">atteints</a> , ils ont eux-mêmes commencé à violer leurs propres principes.  Et maintenant, leur nouvelle bibliothèque ( <a href="https://lit-element.polymer-project.org/">LitElement</a> ) refuse déjà de travailler directement dans le navigateur sans installer un environnement spécial, car les gars ne suivent pas les normes ... Je continue de surveiller le développement de LitElement, et même de voir des signes évidents que ces personnes errantes retournent sur le vrai chemin, mais moi-même déjà Je ne vais pas l'utiliser, car maintenant j'ai quelque chose de mieux. <br><a name="habracut"></a><br><h3>  Quoi? </h3><br>  <a href="https://github.com/foxeyes/holiday">Holiday.js</a> est une bibliothèque pour ceux qui ont besoin de tout ce dont ils ont besoin et qui n'ont besoin de rien de plus.  Vacances - parce que travailler avec elle pour moi est un jour férié.  Et aussi parce que je l'ai écrit, principalement en vacances ou en vacances.  Néanmoins, il s'agit d'un projet très sérieux, avec l'aide duquel toute une série d'applications complexes sont en cours de développement pour l'entreprise très sanglante, que les gens aiment effrayer les débutants de la construction de vélos.  J'écris également tous mes projets personnels sur Holiday.js. <br><br>  Tout est basé sur un groupe d' <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements">éléments</a> standard et de normes <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM">DOM Shadow</a> , comme vous l'avez peut-être deviné, et si vous les connaissez déjà, il sera très facile de le comprendre. <br><br><div class="spoiler">  <b class="spoiler_title">Un peu de moi</b> <div class="spoiler_text">  J'ai 40 ans.  Actuellement, je suis un développeur Web de premier plan et un ingénieur R&amp;D dans une entreprise néerlandaise spécialisée dans les solutions d'intégration d'IBM.  Nos clients sont de grandes entreprises: pétrole, gaz, pétroliers, chemins de fer - c’est tout.  L'essence de mon travail consiste à étendre les capacités standard des systèmes d'entreprise grands et lents et à améliorer l'expérience utilisateur lorsque vous travaillez avec eux.  D'un côté, j'ai des oncles liés, de l'autre - un vent frais de liberté de développement web moderne.  C'est une combinaison intéressante, elle vous permet de voir beaucoup de choses sous un nouvel angle.  Et j'aime ça.  Plus tôt, j'ai essayé le rôle d'une startup, d'un ingénieur ux, d'un directeur artistique d'un petit studio de design, et bien d'autres, donc mon «expérience» globale est comme une courtepointe patchwork.  Mais cela ne signifie pas que je sois superficiellement lié à tout, je trouve juste dans de nombreux types d'activités des principes d'ingénierie similaires qui m'intéressent avant tout. <br></div></div><br><h3>  À quoi ça sert? </h3><br>  Si je lis moi-même un article similaire pour ne pas perdre tout intérêt, j'aimerais voir un exemple de code composant.  Le voici: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {HdElement} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../holiday/core/hd-element.js'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HdElement</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">imageURL</span></span>: <span class="hljs-string"><span class="hljs-string">'images/photo.jpg'</span></span>, <span class="hljs-attr"><span class="hljs-attr">firstName</span></span>: <span class="hljs-string"><span class="hljs-string">'John'</span></span>, <span class="hljs-attr"><span class="hljs-attr">secondName</span></span>: <span class="hljs-string"><span class="hljs-string">'Snow'</span></span>, }; } } MyComponent.template = <span class="hljs-comment"><span class="hljs-comment">/*html*/</span></span> <span class="hljs-string"><span class="hljs-string">` &lt;style&gt; :host { display: block; padding: 10px; background - color: #fff; color: #000; } &lt;/style&gt; &lt;img bind="src: imageURL" /&gt; &lt;div bind="textContent: firstName"&gt;&lt;/div&gt; &lt;div bind="textContent: secondName"&gt;&lt;/div&gt; `</span></span>; MyComponent.is = <span class="hljs-string"><span class="hljs-string">'my-component'</span></span>;</code> </pre> <br>  Ici, nous voyons que le composant a un certain état et un modèle avec des attributs étranges des éléments " <b>bind</b> ".  Ces attributs sont la magie principale: ils vous permettent d'analyser le modèle et d'enregistrer une copie du résultat en mémoire pour une utilisation ultérieure (clonage) SANS traitement supplémentaire de la chaîne de modèle dans l'exécution JS, ce qui donne des performances élevées lors du rendu initial lorsque chaque composant est instancié.  Contrairement à de nombreuses bibliothèques modernes dans lesquelles la partie DOM dont le composant est responsable est déterminée par la fonction de l'état, dans Holiday.js, un modèle est un produit semi-fini qui définit la structure initiale et permet de lier des données plus tard, en utilisant l'API DOM habituelle, et ça marche très vite.  Nous reviendrons sur la question de la vitesse. <br><br>  Je vais énumérer d'autres avantages: <br><br><ul><li>  Proximité maximale avec les API natives, minimum d'abstractions supplémentaires </li><li>  Syntaxe de modèle natif: vous n'avez pas besoin d'apprendre de nouveaux HTML et CSS </li><li>  Pour commencer, vous n'avez pas besoin d'installer quoi que ce soit supplémentaire, votre projet peut ne pas avoir de dossier node_modules du tout </li><li>  Facilité: vous n'obligerez pas les utilisateurs à attendre longtemps pour les téléchargements </li><li>  Le kit comprend la gestion globale de l'état, le routage, une bibliothèque d'interface utilisateur: vous ne vous sentirez pas dans le désert </li></ul><br>  La documentation principale du projet: <a href="https://holiday-js.web.app/">https://holiday-js.web.app/</a> <br><br><h3>  Cycle de vie </h3><br>  Regardons les étapes du cycle de vie des composants: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {HdElement} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../holiday/core/hd-element.js'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LifecycleExample</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HdElement</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); <span class="hljs-comment"><span class="hljs-comment">//   : this.state = { name: '', bigName: '', }; /*   ,      DOM  "   ",       .    ,      "defineAccessor": */ this.defineAccessor('name', (name) =&gt; { // Some accessor code: this.setStateProperty('name', name); }); /*    ,      DOM               . */ } connectedCallback() { super.connectedCallback(); /*  .    DOM.               . */ } stateUpdated(path) { /*        : */ if (path === 'name') { this.setStateProperty('bigName', this.state.name.toUpperCase()); } } attributeChangedCallback(attributeName, oldValue, newValue) { /*  .      . */ super.attributeChangedCallback(attributeName, oldValue, newValue); } disconnectedCallback() { /*  .    DOM.              */ } } LifecycleExample.template = /*html*/ ` &lt;div bind="textContent: name"&gt;&lt;/div&gt; &lt;div bind="textContent: bigName"&gt;&lt;/div&gt; `; /*  HTML-,     : */ LifecycleExample.logicAttributes = [ //   ,         'name', ]; /*     CustomElements: */ LifecycleExample.is = 'lifecycle-example';</span></span></code> </pre><br><h3>  Patterns </h3><br>  Étant donné que les modèles dans Holiday.js ne sont que des <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">littéraux de modèle</a> standard, vous avez une totale liberté sur la façon de les placer dans le projet et de former leur contenu.  Vous pouvez les placer dans des modules séparés, vous pouvez les définir avec le code du composant ou vous pouvez les générer à la volée à partir des données.  Vous pouvez utiliser des expressions et des résultats de fonction dans des modèles.  Tout cela donne de grandes opportunités et une liberté d'expression.  Par exemple, vous pouvez importer des styles communs dans un modèle, utiliser des variables et calculer des valeurs en CSS sans utiliser de préprocesseurs et avec une grande commodité, assembler des modèles à partir de pièces prêtes à l'emploi. <br><br>  Les <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots">emplacements</a> sont une partie importante des modèles de composants Web.  Les emplacements vous permettent de désigner des emplacements spéciaux dans le DOM "fantôme" de votre composant, dans lesquels ses descendants directs seront affichés dans l'arborescence DOM générale.  Un exemple: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toolbar"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toolbar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"footer"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">slot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">footer</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Placement dans les créneaux horaires: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slot</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"header"</span></span></span><span class="hljs-tag">&gt;</span></span>Header content<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toolbar-component</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slot</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"toolbar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toolbar-component</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>Content of the default slot...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slot</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"footer"</span></span></span><span class="hljs-tag">&gt;</span></span>Footer content...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-component</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Comme vous l'avez peut-être deviné, cela vous permet de créer des dispositions de composants, où les modules souhaités peuvent être facilement triés en cellules. <br><br>  Comme mentionné ci-dessus, pour lier dynamiquement des données et des gestionnaires, l'attribut «bind» est utilisé: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"textContent: content; onclick: on.clicked"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Pour lier des valeurs d'attribut, utilisez le symbole "@" au début du nom de la propriété: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style: style"</span></span></span><span class="hljs-tag">&gt;</span></span>Content...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Vous pouvez trouver plus de détails dans la section correspondante de la documentation: <a href="https://holiday-js.web.app/%3Ftemplates">https://holiday-js.web.app/?templates</a> <br><br><h3>  Gestion de l'État </h3><br>  A l'intérieur du composant: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HdElement</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); <span class="hljs-comment"><span class="hljs-comment">//        : this.state = { content: 'Initial Content', style: 'color: #f00', on: { clicked: () =&gt; { console.log('Clicked!'); }, }, }; //       "setStateProperty": window.setTimeout(() =&gt; { //   : this.setStateProperty('content', 'Updated Content'); //   : this.setStateProperty({ 'content': 'Updated Content', 'style': 'color: #00f', }); }, 1000); } }</span></span></code> </pre><br>  Pour contrôler l'état au niveau de l'application entière, le module HdState est utilisé. <br>  Exemple d'utilisation: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {HdState} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../holiday/core/hd-state.js'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   : HdState.subscribe('ui.loading', (val) =&gt; { console.log(val); }); //   : HdState.publish('ui.loading', true); // : HdState.publish({ 'ui.loading': true, 'ui.sidePanelActive': true, });</span></span></code> </pre><br>  Pour travailler avec l'état global, vous devez d'abord déterminer son schéma général: <br><br><pre> <code class="javascript hljs">HdState.applyScheme({ <span class="hljs-attr"><span class="hljs-attr">ui</span></span>: { <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: { <span class="hljs-comment"><span class="hljs-comment">/*      ,       : */</span></span> type: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>, <span class="hljs-comment"><span class="hljs-comment">//    : value: false, }, sidePanelActive: { type: Boolean, value: false, }, }, user: { authorized: { type: Boolean, value: false, }, name: { type: String, value: null, //          : cache: true, }, }, });</span></span></code> </pre><br>  Le circuit peut également être commodément divisé en blocs logiques séparés. <br><br>  Pour éviter les fuites de mémoire, les abonnements non pertinents doivent être supprimés: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> subscription = HdState.subscribe(<span class="hljs-string"><span class="hljs-string">'ui.loading'</span></span>, (val) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(val); }); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Unsubscribe: subscription.remove(); }, 10000);</span></span></code> </pre><br>  Documentation d'État: <a href="https://holiday-js.web.app/%3Fstate">https://holiday-js.web.app/?state</a> <br><br><h3>  Outils de développement </h3><br>  Le plus petit ensemble pour commencer est un éditeur de texte et un navigateur.  Oui, c'est suffisant pour essayer.  Il convient de noter que dans cette configuration, le navigateur doit être exactement Firefox.  Il peut charger des modules ES <b>sans</b> utiliser de serveur local. <br><br>  Pour un travail plus complet, vous aurez besoin de git et de tout serveur Web que vous avez aimé (pour travailler avec des modules ES dans d'autres navigateurs). <br><br>  Pour mettre en évidence la syntaxe HTML et l'auto-complétion dans les littéraux de modèle, j'utilise l'extension pour VS Code, initialement conçue pour fonctionner avec lit-html: <a href="https://github.com/pushqrdx/vscode-inline-html">https://github.com/pushqrdx/vscode-inline-html</a> <br><br>  Pour créer le code avant la publication, vous pouvez utiliser n'importe quel <a href="https://webpack.js.org/">compilateur</a> populaire, tel que <a href="https://webpack.js.org/">webpack</a> ou <a href="https://rollupjs.org/guide/en/">rollup</a> . <br><br><h3>  Performances </h3><br>  Les repères pour les frameworks ne sont pas faciles à écrire.  Pour une comparaison représentative, vous devez vous assurer que vous comparez des choses comparables et, dans la mesure du possible, en minimisant les effets des effets secondaires.  Ainsi, ils devraient avoir une idée claire de ce qui se passe «sous le capot» dans chaque cas.  Tout d'abord, vous devez décider des paramètres que nous mesurerons.  Pour notre cas, il est important pour nous: <br><br><ol><li>  Temps de démarrage de l'exécution du programme principal (téléchargement) </li><li>  Temps de rendu initial du composant </li><li>  Il est temps de mettre à jour ces composants et de les redessiner </li></ol><br>  Malheureusement, nous n'avons pas de moyen fiable de savoir à quel moment le navigateur a exécuté le programme et terminé le rendu.  Au niveau du navigateur, il y a beaucoup de nos propres optimisations, qui pour nous sont quelque chose comme une «boîte noire» et peuvent différer selon les moteurs.  Ce que nous pouvons utiliser: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance">API de performance</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">requestAnimationFrame</a> et <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">méthode requestIdleCallback</a> non standard, qui ne fonctionne que dans Chrome et Firefox.  Assez pour la première fois. <br><br>  À quoi comparerons-nous Holiday.js?  J'ai commencé avec deux bibliothèques: React (où sans elle) et LitElement (technologies similaires au cœur).  Vous pouvez trouver du code de référence dans ces référentiels: <br><br>  <a href="https://github.com/foxeyes/holiday-benchmark">https://github.com/foxeyes/holiday-benchmark</a> <br>  <a href="https://github.com/foxeyes/lit-benchmark">https://github.com/foxeyes/lit-benchmark</a> <br>  <a href="https://github.com/foxeyes/react-benchmark">https://github.com/foxeyes/react-benchmark</a> <br><br>  Malheureusement, je n'ai pas encore fini de tester l'automatisation, et ce n'est pas facile non plus, car l'automatisation ne devrait pas créer par elle-même des effets secondaires.  Pour le moment, je continue de travailler sur ce problème et je prépare un outil approprié en utilisant <a href="https://github.com/puppeteer/puppeteer">Puppeteer</a> (une chose très utile, je recommande).  En attendant, vous pouvez essayer les tests en mode manuel (Chrome / Firefox) et vérifier les résultats dans la console du navigateur.  Vous verrez que Holiday.js est un <b>leader confiant dans tous les cas</b> . <br><br>  Vous pouvez remarquer que dans le cas de React, un conteneur div supplémentaire est créé lorsque les composants sont affichés, ce qui permet de niveler le nombre d'éléments DOM créés.  J'ai décidé que ce serait vrai, car un composant Web est toujours un élément DOM et un conteneur, et la correspondance des structures arborescentes DOM dans différents tests est très importante.  De plus, il est possible de supprimer l'imbrication inutile dans Holiday.js et d'afficher les données de la même manière que dans React.  Cependant, si ce problème vous semble controversé, faites tout d'abord attention à la rapidité des mises à jour. <br><br><h3>  Prise en charge du navigateur </h3><br>  Non, Internet Explorer n'est pas pris en charge.  Cela aurait pu être réalisé avec certains efforts (pour la 11e version), mais le rejet du soutien est une position de principe.  Premièrement, je pense qu'IE devrait mourir longtemps et en notre pouvoir d'y contribuer.  Deuxièmement, les personnes qui préconisent la prise en charge d'IE font souvent une grave erreur logique: la part d'IE dans le trafic total, selon les données actuelles, est d'environ 1,6% pour <b>toutes les</b> versions trouvées.  Et le navigateur le plus populaire, qui devance largement les autres, est Chrome pour <b>mobile</b> (~ 35%).  Ainsi, en prenant en charge IE, vous refusez consciemment d'utiliser un grand nombre de technologies qui sont simplement nécessaires pour implémenter une adaptabilité et une mobilité complètes dans vos applications, c'est-à-dire, pour le bien d'une petite minorité, compliquer la vie d'une grande majorité de ses utilisateurs.  Ou augmentez <b>considérablement</b> le coût de développement et de maintenance de vos produits.  Troisièmement, Microsoft a, ces derniers temps, forcé activement les utilisateurs à abandonner Windows 7, de sorte que la proportion du trafic IE dans un avenir proche diminuera de plus en plus rapidement.  J'admets qu'il y a des cas où le support d'IE ne peut pas être contourné, mais de tels cas sont beaucoup plus rares que nous ne le pensions. <br><br>  Le 15 janvier de cette année, Microsoft a publié une version finale du nouveau <a href="https://www.microsoft.com/en-us/edge">Edge</a> , sur le moteur Chromium.  À partir de ce moment, nous pouvons supposer que Holiday.js est nativement pris en charge dans <b>toutes</b> les versions actuelles des navigateurs populaires.  Pour les anciens Edge, un <a href="https://github.com/webcomponents/polyfills/tree/master/packages/webcomponentsjs">polyfill</a> est requis.  La possibilité de travailler avec des polyfills est implémentée dans Holiday.js, mais le script lui-même doit être connecté séparément. <br><br><h3>  Minimalisme </h3><br>  Le concept de Holiday.js est basé sur la simplicité et le minimalisme.  L'une des étapes importantes dans le travail sur ce projet a été pour moi la <b>suppression de la fonctionnalité</b> , que j'ai hâte de mettre en œuvre, mais j'ai réalisé plus tard que je pouvais m'en passer.  Par conséquent, s'il vous semble que quelque chose manque vraiment, posez-vous une question, est-ce vraiment le cas?  J'ai répondu par moi-même comme ceci: si quelque chose d'autre est vraiment nécessaire, il vaut mieux créer une classe étendue séparément, avec héritage de la principale.  Jusqu'à présent, cette approche ne m'a pas échoué.  Holiday.js, dans son état actuel, a été testé au combat et s'est révélé très positif au travail. <br><br><h3>  Plans </h3><br>  Si vous lisez à cet endroit, alors mes efforts ont déjà été dépensés en vain.  Même si vous ne souhaitez pas utiliser Holiday.js, vous pouvez au moins obtenir quelque chose d'intéressant en travaillant avec des composants Web en tant que tels.  Je serai très heureux si ce matériel marque le début de la construction communautaire.  Je serai très heureux d'avoir une discussion constructive, des critiques, des rapports de bugs, des pullrequests et, bien sûr, des étoiles sur GitHub.  Bien sûr, je ne pourrais pas aborder tous les aspects, et je serai heureux de répondre à vos questions.  Veuillez prendre en compte que jusqu'à présent, j'ai travaillé <b>seul</b> sur cette bibliothèque, et faire tout seul, y compris la documentation, les tests et les outils associés, en parallèle avec les principaux travaux et projets pour animaux de compagnie, est difficile. <br><br>  Cependant, dans un avenir proche: <br><br><ul><li>  Plus de comparaisons avec d'autres bibliothèques et frameworks populaires. </li><li>  Outil de test PingPong minimaliste et flexible basé sur Puppeteer </li><li>  Générateur de projet de base avec des exemples (Starter Kit) </li><li>  Développement de la documentation </li></ul><br>  Je croise les doigts, appuie sur "Publier" ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr485688/">https://habr.com/ru/post/fr485688/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr485654/index.html">Une idée tirée de la physique aide l'IA à travailler dans des dimensions plus élevées.</a></li>
<li><a href="../fr485660/index.html">La société de protection DDoS a elle-même lancé des attaques DDoS, a reconnu son fondateur</a></li>
<li><a href="../fr485664/index.html">Création de paramètres dynamiques dans un travail Jenkins, ou comment rendre votre tâche conviviale</a></li>
<li><a href="../fr485672/index.html">Redis Best Practices, Partie 1</a></li>
<li><a href="../fr485682/index.html">La gestion du temps n'aidera pas: la procrastination est le problème de la régulation des émotions, pas du temps</a></li>
<li><a href="../fr485692/index.html">Conseils d'un spécialiste informatique au client, ou comment automatiser le désordre</a></li>
<li><a href="../fr485694/index.html">Embox sur processeur Elbrus. Ou n'oublie jamais ce que tu as en intelligence</a></li>
<li><a href="../fr485702/index.html">FunCorp iOS Meetup # 2</a></li>
<li><a href="../fr485704/index.html">Pixel art pour débutants: corriger les erreurs courantes</a></li>
<li><a href="../fr485706/index.html">Nous vous invitons à la réunion «Transformation numérique et nouveaux rôles en science des données»</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>