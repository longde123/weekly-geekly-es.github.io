<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧝🏿 🏂 ⏸️ Bagaimana Yandex mengajarkan kecerdasan buatan untuk menemukan kesalahan dalam berita 🚖 🍋 ♍️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kita sering berbicara tentang teknologi dan perpustakaan yang berasal dan terbentuk di Yandex. Bahkan, kami setidaknya menerapkan dan mengembangkan so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bagaimana Yandex mengajarkan kecerdasan buatan untuk menemukan kesalahan dalam berita</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/479662/">  Kita sering berbicara tentang teknologi dan perpustakaan yang berasal dan terbentuk di Yandex.  Bahkan, kami setidaknya menerapkan dan mengembangkan solusi pihak ketiga. <br><br>  Hari ini saya akan memberi tahu komunitas Habr tentang salah satu contoh tersebut.  Anda akan belajar mengapa kami mengajarkan jaringan saraf BERT untuk menemukan kesalahan ketik di berita utama, dan tidak menggunakan model yang sudah jadi, mengapa Anda tidak dapat mengambil dan menjalankan BERT pada beberapa kartu video dan bagaimana kami menggunakan fitur kunci dari teknologi ini - mekanisme perhatian. <br><br><img src="https://habrastorage.org/webt/tt/hg/e0/tthge0hf0fug6jmwdhad_x-kjbg.png"><br><br><a name="habracut"></a><h2>  Tantangan </h2><br>  Yandex.News adalah layanan yang mengumpulkan berita dari publikasi yang terhubung dengan kami.  Ini bukan hanya berita media yang paling banyak dibaca dan dikutip di halaman utama, tetapi juga bagian <a href="https://yandex.ru/sport">tematik</a> atau bahkan pilihan pribadi dari semua publikasi.  Bagaimanapun, ini adalah ribuan situs dan jutaan judul, dari mana mesin harus membentuk pilihan setiap beberapa menit. <br><br>  Ini adalah mesin, karena kami tidak pernah melakukan intervensi dalam gambar hari ini: kami tidak menambahkan berita di sana secara manual, kami tidak menghapusnya dari sana (tidak peduli seberapa besar keinginan kami), kami tidak mengedit berita utama.  Sekitar ini sudah rusak banyak salinan.  Pendekatan yang sepenuhnya algoritmik memiliki pro dan kontra.  Sesuatu yang bisa kita tingkatkan dengan teknologi, sesuatu yang tidak.  Meskipun ada kesalahan pengejaan atau kesalahan ketik pada judul, kami tidak memperbaikinya.  Kami telah menambahkan favicons publikasi ke berita utama sehingga jelas dari mana berita itu berasal.  Ini sebagian membantu, tetapi kami tidak menerima kesalahan dan mulai mencari cara untuk menghilangkannya tanpa membuat perubahan pada teks. <br><br>  Jika tidak mungkin untuk memperbaiki kesalahan, maka Anda dapat melatih mesin untuk menemukan header yang, karena kesalahan, tidak cocok untuk bagian atas.  Selain itu, Yandex memiliki spesialisasi dalam morfologi Rusia sejak saat nama tersebut belum ditemukan.  Tampaknya kita mengambil jaringan saraf - dan intinya ada di topi. <br><br><h2>  Alat-alatnya </h2><br>  Yandex memiliki teknologi <a href="https://yandex.ru/dev/speller/">Speller</a> untuk menemukan dan memperbaiki kesalahan.  Berkat <a href="https://habr.com/ru/company/yandex/blog/333522/">pustaka</a> pembelajaran mesin <a href="https://habr.com/ru/company/yandex/blog/333522/">CatBoost,</a> Speller dapat mendekripsi kata-kata yang tidak dapat dikenali ("kata sifat" → "teman sekelas") dan mempertimbangkan konteks ketika mencari kesalahan ketik ("musik miss" → "musik unduhan").  Tampaknya Speller ideal untuk tugas kita, tetapi tidak. <br><br>  Ejaan (dikenal secara internal sebagai wali pencarian) sudah diasah pada tingkat arsitektur untuk menyelesaikan tugas yang sama sekali berbeda: untuk membantu pengguna mengembalikan formulir permintaan yang benar.  Dalam Pencarian, tidak begitu penting apakah kasus tersebut dipilih dengan benar, huruf kapital atau koma ditempelkan.  Di sana, lebih penting bagi permintaan pencarian "Haminguel" untuk menebak bahwa orang itu ada dalam pikiran Hemingway. <br><br>  Kesalahan dalam tajuk utama dibuat oleh orang-orang yang relatif melek yang tidak mungkin menulis Haminguel.  Tetapi persetujuan yang salah ("penerbangan ditunda"), kata-kata yang hilang ("pemuda mencoba mobil") dan huruf kapital tambahan ("Presiden Bank") adalah hal biasa.  Akhirnya, ada kalimat yang benar secara formal "Aku akan memperbaiki Gorky Street di Pskov", yang tidak akan dijaga oleh wali yang normal (yah, bagaimana jika ini adalah janji dari penulis?), Tapi ini jelas merupakan berita utama yang manja.  Selain itu, dalam Berita tugasnya tidak sama dengan di Pencarian: bukan untuk memperbaiki kesalahan ketik dan kesalahan, tetapi untuk mendeteksi mereka. <br><br>  Kami memiliki pilihan lain, misalnya, model yang didasarkan pada DSSM (jika menarik, kami secara singkat berbicara tentang pendekatan ini dalam posting tentang <a href="https://habr.com/ru/company/yandex/blog/314222/">algoritma Palekh</a> ), tetapi mereka juga memiliki keterbatasan.  Misalnya, urutan kata tidak diperhitungkan dengan sempurna. <br><br>  Secara umum, alat yang sudah jadi tidak cocok untuk tugas kita, atau terbatas.  Jadi, Anda perlu membuat sendiri - untuk melatih model Anda.  Dan ini adalah alasan yang bagus untuk bekerja dengan teknologi BERT, yang menjadi tersedia bagi pengembang pada 2018 dan menunjukkan hasil yang mengesankan. <br><br><h2>  Memperkenalkan BERT </h2><br>  Masalah utama dari masalah pemrosesan bahasa alami modern (NLP) adalah menemukan cukup contoh yang ditandai oleh orang untuk melatih jaringan saraf.  Jika Anda membutuhkan pertumbuhan yang berkualitas, maka sampel pelatihan harus sangat besar - jutaan dan miliaran contoh.  Pada saat yang sama, ada banyak tugas di NLP dan semuanya berbeda.  Mengumpulkan data dalam volume yang sama untuk setiap tugas itu lama, mahal, dan seringkali mustahil.  Bahkan untuk perusahaan terbesar di dunia. <br><br>  Tetapi ada opsi untuk mengatasi masalah ini - dengan bantuan pelatihan dalam dua tahap.  Pada awalnya, jaringan saraf diajarkan struktur bahasa untuk waktu yang lama dan mahal pada tubuh besar miliaran kata (ini adalah pra-pelatihan).  Kemudian jaringan dengan cepat dan murah dipelintir untuk tugas tertentu - misalnya, untuk membagi ulasan menjadi baik dan buruk (ini adalah fine-tuning).  Cukup sekitar 10 ribu contoh ditandai di <a href="https://habr.com/ru/company/yandex/blog/305956/">Tolok</a> . <br><br>  Teknologi BERT (Representasi Encoder Dua Arah dari Transformer) didasarkan pada gagasan ini.  Idenya sendiri bukanlah hal baru dan telah diterapkan sebelumnya, tetapi ada perbedaan yang signifikan.  Transformer adalah arsitektur jaringan saraf yang memungkinkan Anda memperhitungkan seluruh konteks sekaligus, termasuk ujung kalimat yang lain dan pergantian partisipan di suatu tempat di tengah.  Dan ini perbedaannya dari arsitektur modis sebelumnya, yang memperhitungkan konteksnya.  Misalnya, jaringan saraf LSTM memiliki panjang konteks puluhan kata yang terbaik, dan di sini semuanya 200. <br><br>  Di <a href="https://github.com/google-research/bert">GitHub</a> , kode sumber TensorFlow dan bahkan model universal pra-terlatih dalam 102 bahasa tersedia, dari Rusia ke volapyuk.  Ambil, tampaknya, solusi di luar kotak - dan dapatkan hasilnya segera.  Tapi tidak. <br><br>  Ternyata model universal dalam teks-teks Rusia menunjukkan kualitas yang jauh lebih rendah daripada model bahasa Inggris, memecahkan rekor dalam teks-teks bahasa Inggris (yang, Anda lihat, logis).  Dalam teks-teks Rusia, ia kehilangan model internal kami tentang DSSM. <br><br>  Oke, Anda dapat melakukan pra-mendidik diri sendiri - untungnya, Yandex memiliki cukup teks dan pengalaman bahasa Rusia dalam pembelajaran mesin.  Namun ada nuansa.  Butuh satu tahun untuk belajar! <br><br>  Faktanya adalah bahwa BERT diarahkan untuk prosesor tensor Google (TPU), oleh karena itu di luar kotak itu dapat bekerja dengan hanya satu kartu video (GPU).  Dan mustahil untuk memparalelkan dahi seseorang dengan <a href="https://github.com/horovod">horovod</a> apa pun: mentransfer 400 megabita data dari satu kartu ke kartu lainnya pada setiap langkah sangat mahal, paralelisasi akan menjadi sia-sia.  Apa yang harus dilakukan <br><br><h2>  Optimasi </h2><br>  Mereka mulai mencari ide dan solusi yang dapat mempercepat masalah ini secara signifikan.  Pertama-tama, kami memperhatikan bahwa setiap angka dalam model kami menempati 32 bit memori (standar float untuk angka di komputer).  Tampaknya kecil, tetapi ketika Anda memiliki 100 juta bobot, maka ini sangat penting.  Kami tidak membutuhkan keakuratan seperti itu di mana-mana, jadi kami memutuskan untuk mengonversi sebagian angka menjadi format 16-bit (inilah yang disebut pelatihan presisi campuran). <br><br>  Sepanjang jalan, dengan bantuan banyak file dan kruk, kami mengacaukan kompilasi XLA, mengandalkan <a href="https://github.com/google-research/bert/pull/255">komit</a> NVIDIA yang masih mentah.  Berkat ini, kartu NVIDIA Tesla V100 kami (server kecil dari mereka berdiri sebagai apartemen di daerah murah Moskow) dapat sepenuhnya mengungkapkan potensi mereka karena aritmatika 16-bit pada Tensor Cores. <br><br>  Kami hanya tertarik pada tajuk utama berbahasa Rusia, tetapi model multibahasa, yang kami ambil sebagai dasar, dilatih dalam ratusan bahasa, termasuk bahkan volapuk buatan.  Kata-kata dari semua bahasa yang diterjemahkan ke dalam ruang vektor disimpan dalam model.  Selain itu, Anda tidak dapat mengambilnya dan menghapusnya dari sana - saya harus berkeringat untuk mengurangi ukuran kamus. <br><br>  Dan satu hal lagi.  Jika Anda seorang ilmuwan dan komputer Anda ada di bawah meja, maka Anda dapat mengkonfigurasi ulang semua yang ada untuk setiap tugas tertentu.  Tetapi dalam cloud computing nyata, di mana ribuan mesin dikonfigurasi dengan cara yang sama, itu cukup bermasalah, misalnya, untuk membangun kembali kernel untuk setiap fitur TensorFlow baru.  Oleh karena itu, kami menghabiskan banyak upaya untuk mengumpulkan versi paket yang dapat dilakukan oleh semua chip bermodel baru, dan tidak memerlukan pembaruan radikal dan konfigurasi ulang kartu video di cloud. <br><br>  Secara umum, peras semua jus di mana pun mereka bisa.  Dan kami berhasil.  Tahun berubah menjadi seminggu. <br><br><h2>  Pelatihan </h2><br>  Membangun dataset yang tepat biasanya merupakan bagian tersulit dari pekerjaan itu.  Pertama, kami mempelajari pengelompokan pada tiga juta judul yang ditandai dengan toloker.  Tampaknya banyak, tetapi hanya 30 ribu dari mereka - dengan kesalahan ketik.  Di mana mendapatkan lebih banyak contoh? <br><br>  Kami memutuskan untuk melihat mana judul media itu sendiri yang benar.  Ada lebih dari 2 juta dalam sejarah Yandex. Berita Baru.  Bingo!  Meskipun terlalu dini untuk bersukacita. <br><br>  Ternyata sangat sering media mengulang berita utama bukan karena kesalahan.  Rincian baru terungkap - dan editor mengganti satu kata dengan yang benar.  Oleh karena itu, kami membatasi diri pada koreksi dengan perbedaan antara versi hingga tiga huruf (meskipun masih ada suara di sini: "ditemukan dua" - menjadi "ditemukan tiga").  Jadi kami mencetak satu juta kesalahan ketik.  Kami pertama-tama mempelajari pilihan besar ini dengan noise, dan kemudian pada tanda tolker kecil tanpa noise. <br><br><h2>  Kualitas </h2><br>  Dalam tugas-tugas seperti itu, adalah kebiasaan untuk mengukur akurasi dan kelengkapan.  Dalam kasus kami, akurasi adalah proporsi putusan yang benar di antara semua putusan tentang kesalahan dalam header.  Kelengkapan - proporsi header kesalahan yang kami tangkap di antara semua header kesalahan.  Baik itu dan yang lain di dunia ideal harus bercita-cita 100%.  Tetapi dalam tugas pembelajaran mesin, indikator-indikator ini cenderung bertentangan.  Artinya, semakin kita memutar akurasinya, semakin lengkap kelengkapannya.  Begitu juga sebaliknya. <br><br>  Dalam pendekatan kami sebelumnya berdasarkan DSSM, kami telah mencapai akurasi 95% (yaitu 5% vonis positif palsu).  Ini sudah merupakan indikator yang cukup tinggi.  Oleh karena itu, kami memutuskan untuk mempertahankan tingkat akurasi yang sama dan melihat bagaimana kelengkapan berubah dengan model baru.  Dan dia melonjak dari 21 menjadi 78%.  Dan itu pasti sukses. <br><br>  Di sini mungkin untuk mengakhiri itu, tetapi saya ingat janji untuk berbicara tentang perhatian. <br><br><h2>  Jaringan saraf dengan spidol </h2><br>  Secara umum diterima bahwa jaringan saraf adalah kotak hitam.  Kami memberi makan sesuatu ke input dan mendapatkan sesuatu ke output.  Mengapa dan bagaimana sebuah misteri. <br><br>  Keterbatasan ini dimaksudkan untuk menghindari jaringan saraf yang ditafsirkan.  BERT adalah salah satunya.  Penafsirannya terletak pada mekanisme perhatian.  Secara kasar, di setiap lapisan jaringan saraf kita mengulangi teknik yang sama: kita melihat kata-kata tetangga dengan “perhatian” yang berbeda dan memperhitungkan interaksi dengan mereka.  Sebagai contoh, ketika jaringan saraf memproses kata ganti "dia", itu "hati-hati melihat" pada kata benda yang merujuk "dia". <br><br>  Gambar di bawah ini menunjukkan dalam berbagai warna merah apa kata token "melihat" di, yang mengumpulkan informasi tentang seluruh judul untuk lapisan classifier akhir.  Jika salah ketik kata - perhatian menyorotinya, jika kata-kata tidak konsisten - maka keduanya (dan, mungkin, tergantung pada mereka). <br><br><img src="https://habrastorage.org/webt/tt/hg/e0/tthge0hf0fug6jmwdhad_x-kjbg.png"><br><br>  Di tempat ini, omong-omong, orang dapat melihat potensi penuh dari jaringan saraf.  Tidak ada tahap pelatihan apakah model kami tahu persis di mana kesalahan ketik dalam contoh berada: ia hanya tahu bahwa seluruh judul tidak benar.  Dan dia masih belajar bahwa "sekolah untuk 1224 tempat" tidak benar untuk ditulis karena angka yang tidak konsisten, dan dia secara khusus menyoroti angka 4. <br><br>  Kami tidak berhenti pada kesalahan ketik dan mulai menerapkan pendekatan baru tidak hanya untuk mencari kesalahan, tetapi juga untuk mengidentifikasi header yang usang.  Tapi ini adalah kisah yang sangat berbeda dengan yang kami harap akan kembali ke Habr dalam waktu dekat. <br><br><h2>  Tautan yang bermanfaat bagi mereka yang ingin mempelajari topik tersebut </h2><br><ul><li>  <a href="https://github.com/google-research/bert">Kode TensorFlow dan model pra-terlatih untuk BERT</a> </li><li>  <a href="https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html">Open Sourcing BERT: Pra-pelatihan mutakhir untuk Pemrosesan Bahasa Alami</a> </li><li>  <a href="https://timdettmers.com/2018/10/17/tpus-vs-gpus-for-transformers-bert/">TPUs vs GPUs for Transformers (BERT)</a> </li><li>  <a href="http://jalammar.github.io/illustrated-transformer/">Trafo bergambar</a> </li><li>  <a href="https://news.developer.nvidia.com/nvidia-achieves-4x-speedup-on-bert-neural-network/">NVIDIA Mencapai 4X Speedup di BERT Neural Network</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479662/">https://habr.com/ru/post/id479662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479646/index.html">Saran atau alasan buruk untuk terus belajar bahasa Inggris setelah Intermediate</a></li>
<li><a href="../id479650/index.html">Top 12 infografis dinamis dinamis TI paling menarik</a></li>
<li><a href="../id479654/index.html">Generator Django vue</a></li>
<li><a href="../id479656/index.html">PostgreSQL Antipatterns: statistik di sekitar kepala</a></li>
<li><a href="../id479660/index.html">3. Analisis malware menggunakan forensik Check Point. Ponsel sandblast</a></li>
<li><a href="../id479664/index.html">Bagaimana kubernet dikelola dan OpenShift berhasil berfungsi di IBM Cloud. Bagian 1 - Arsitektur dan Keamanan</a></li>
<li><a href="../id479666/index.html">Golang: Apa yang menjadi Spesialis Go bergantung pada lautan spesialisasi IT?</a></li>
<li><a href="../id479668/index.html">QA untuk pemula: bagaimana cara menguji roket atau pesawat?</a></li>
<li><a href="../id479672/index.html">BISA sniffer</a></li>
<li><a href="../id479676/index.html">ExtJS 7 dan Spring Boot 2. Bagaimana cara membangun SPA yang berinteraksi dengan API Anda dan plugin ReactJS eksternal?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>