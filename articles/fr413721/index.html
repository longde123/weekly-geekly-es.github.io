<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¿â€ğŸ’¼ ğŸŒ¶ï¸ ğŸ‘µğŸ¾ Time Checking: Timejacking vs Bitcoin ğŸ¦† ğŸ§œğŸ¾ ğŸ„</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le concours du mot le plus populaire de l'annÃ©e, le mot Â«blockchainÂ» deviendrait probablement le vainqueur de la sphÃ¨re informatique. MalgrÃ© le f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Time Checking: Timejacking vs Bitcoin</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/413721/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/32/86/rv/3286rvioxsavz1pt8i6sqrd0n4c.jpeg"></div><br><br>  Dans le concours du mot le plus populaire de l'annÃ©e, le mot Â«blockchainÂ» deviendrait probablement le vainqueur de la sphÃ¨re informatique.  MalgrÃ© le fait qu'il existe une tendance <s>malsaine</s> Ã  l'introduire activement n'importe oÃ¹ - dans la mÃ©decine, l'Ã©conomie, l'Internet des objets, l'Ã©levage de lapins et la fabrication de tartes, les crypto-monnaies restent le principal champ d'application de la blockchain.  Et tout le monde le sait: des portefeuilles virtuels pour les pirates - comme un chat avec de la crÃ¨me sure. <br><br>  Dans cet article, nous considÃ©rerons l'attaque Â«TimejackingÂ», basÃ©e sur la vulnÃ©rabilitÃ© dans le traitement des horodatages des blocs dans le systÃ¨me de crypto-monnaie Bitcoin, et essayer d'expliquer pourquoi l'attaque est, et sa mise en Å“uvre rÃ©ussie ne l'est pas. <br><br>  PS Il y aura de nombreux dÃ©rivÃ©s du mot "temps".  Beaucoup. <br><a name="habracut"></a><br><h2>  <b>En bref</b> </h2><br>  Pour la premiÃ¨re fois, Alex Boverman a Ã©crit sur l'attaque du Timejacking.  Vous pouvez vous familiariser avec sa publication <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Quelle est l'essence: l'attaque exploite les vulnÃ©rabilitÃ©s du mÃ©canisme de vÃ©rification des horodatages des blocs et du compteur de temps en Bitcoin.  L'attaquant manipule l'un des compteurs de temps du nÅ“ud victime et crÃ©e un bloc Â«empoisonnÃ©Â».  La victime lÃ¢chera ce bloc, et le reste du rÃ©seau acceptera avec succÃ¨s, et s'il vous plaÃ®t - nous avons provoquÃ© une fourchette!  L'ensemble du rÃ©seau utilise une chaÃ®ne de blocs construite aprÃ¨s celle Â«empoisonnÃ©eÂ», et la victime considÃ¨re comme valide une chaÃ®ne alternative avec des dÃ©penses rÃ©pÃ©tÃ©es en jetons (alias double-dÃ©penses), dans laquelle le bloc Â«empoisonnÃ©Â» n'apparaÃ®t pas. <br><br>  L'attaque se dÃ©roule en deux temps.  Pour le rendre plus clair, parlons de chacun d'eux sÃ©parÃ©ment. <br><br><h2>  <b>Acte 1. CrÃ©er une fourchette et isoler la victime</b> </h2><br>  Un attaquant doit gÃ©nÃ©rer une Â«POMME de contentionÂ» - le bloc trÃ¨s Â«empoisonnÃ©Â» que la victime ignorera.  De la mÃªme maniÃ¨re, la victime dÃ©posera d'autres blocs qui seront ajoutÃ©s sÃ©quentiellement aprÃ¨s celui Â«empoisonnÃ©Â». <br><br>  <b>Comment tromper une victime et l'obliger Ã  lÃ¢cher le bon bloc?</b> <br><br>  L'en-tÃªte de chaque bloc a un horodatage que le nÅ“ud vÃ©rifie lors de la vÃ©rification.  Cette valeur doit tomber dans une certaine plage, nous l'appellerons une fenÃªtre temporaire.  La plage de fenÃªtre temporelle est illustrÃ©e dans la figure ci-dessous: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/mu/go/fsmugohtfy3uilmc0iyf2u7fp6a.jpeg"></div><br>  La fenÃªtre temporelle a deux limites: <br><br><ul><li>  infÃ©rieur - <b>t <sub>min</sub></b> , il est Ã©gal Ã  la mÃ©diane des horodatages de 11 blocs prÃ©cÃ©dant le bloc vÃ©rifiÃ© </li><li>  supÃ©rieur - Ã©gal Ã  la valeur du temps rÃ©seau t <sub>0</sub> + 2 heures </li></ul><br>  La valeur de l'horodatage du bloc est vÃ©rifiÃ©e non pas par rapport Ã  l'heure systÃ¨me du nÅ“ud, mais par rapport Ã  l'heure mÃ©diane de ses voisins - l'heure du rÃ©seau (aka heure ajustÃ©e au rÃ©seau). <br><br>  Comment est pris en compte le temps rÃ©seau: <br><br><ul><li>  Lorsqu'une nouvelle connexion est Ã©tablie, les nÅ“uds Ã©changent l'heure de leur systÃ¨me </li><li>  Chaque nÅ“ud calcule l'Ã©cart de son propre temps systÃ¨me par rapport au temps systÃ¨me de chacun de ses voisins </li><li>  Pour les Ã©carts calculÃ©s, la valeur mÃ©diane est sÃ©lectionnÃ©e. </li><li>  Temps systÃ¨me natif + Ã©cart mÃ©dian = <b>temps rÃ©seau</b> </li></ul><br>  Voici un exemple de calcul du temps rÃ©seau: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zw/dm/eu/zwdmeuayfjs0vslokmwolesugo4.jpeg"></div><br>  Ainsi, un attaquant peut manipuler la valeur du temps rÃ©seau de la victime en lui connectant un nombre suffisant de voisins annonÃ§ant l'heure systÃ¨me en retard.  La valeur de l'heure du rÃ©seau victime diminue - la limite supÃ©rieure de la plage de valeurs admissibles de l'horodatage du bloc vÃ©rifiÃ© diminue.  Mais si l'Ã©cart du temps du voisin dÃ©passe <a href="">70 minutes</a> , son temps ne sera pas pris en compte lors du calcul de l'heure du rÃ©seau.  Par consÃ©quent, la valeur maximale permettant de rÃ©duire la durÃ©e de rÃ©seau de la victime est de 70 minutes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/yq/dk/wnyqdkckyddzalio-mzl9m-i7b0.jpeg"></div><br>  En consÃ©quence, notre bloc Â«empoisonnÃ©Â» est un bloc dont l'horodatage doit tomber dans la fenÃªtre temporelle de tous les nÅ“uds du rÃ©seau Ã  l'exception de la victime.  Ce n'est qu'alors que l'ensemble du rÃ©seau l'acceptera avec succÃ¨s, et la victime dont l'heure du rÃ©seau est modifiÃ©e ne la dÃ©posera pas moins avec succÃ¨s.  Dans la figure ci-dessous - la fenÃªtre temporelle de la victime par rapport Ã  la fenÃªtre temporelle des nÅ“uds restants. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-k/jf/yc/-kjfycci5-wji1inohzrlxujg4e.jpeg"></div><br>  Notez que, grÃ¢ce au protocole NTP, nous pouvons supposer que pour la plupart des nÅ“uds, l'heure systÃ¨me est approximativement la mÃªme, c'est-Ã -dire que l'heure rÃ©seau de chaque nÅ“ud est proche de la valeur de l'heure systÃ¨me. <br><br>  En consÃ©quence, la victime est isolÃ©e du rÃ©seau principal et considÃ¨re la chaÃ®ne principale de blocs incorrecte, qui sera construite par le reste des nÅ“uds du bloc "empoisonnÃ©".  Dans le mÃªme temps, la victime acceptera en toute confiance les autres blocs, gÃ©nÃ©reusement gÃ©nÃ©rÃ©s par l'attaquant pour la chaÃ®ne alternative. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/44/7z/6t/447z6t74qbyjwqnzzjhnxgog6le.jpeg"></div><br><h2>  <b>Acte 2. Double dÃ©pense</b> </h2><br>  Ã€ ce stade, l'attaquant gÃ©nÃ¨re une chaÃ®ne alternative, dans laquelle il ajoute une transaction qui transfÃ¨re des jetons au portefeuille de la victime.  Des blocs de chaÃ®ne alternatifs sont envoyÃ©s Ã  la victime.  Dans la figure ci-dessous - la plage de valeurs de l'horodatage du bloc "empoisonnÃ©". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gb/lx/ig/gblxigftue4b3qftdlldapqed40.jpeg"></div><br>  La victime acceptera cette chaÃ®ne, car la valeur des horodatages est sÃ©lectionnÃ©e par l'intrus dans sa propre fenÃªtre temporelle, et les nÅ“uds restants l'ignoreront Ã  juste titre - aprÃ¨s tout, ils construisent dÃ©jÃ  leur chaÃ®ne Ã  partir du bloc Â«empoisonnÃ©Â», qui est plus long que l'alternative.  En consÃ©quence, la victime pense avoir reÃ§u des jetons et envoyer les marchandises.  Et le rÃ©seau principal est sÃ»r que les jetons n'ont pas quittÃ© le portefeuille de l'attaquant, et il reÃ§oit les marchandises pour "merci" - aprÃ¨s tout, la plupart ne peuvent pas se tromper.  Final, le hÃ©ros du cÃ´tÃ© obscur triomphe! <br><br><h2>  <b>Mais pas si simple</b> </h2><br>  <b>Ã‰cueil n Â° 1</b> <br><br>  Une Ã©norme puissance de calcul est impliquÃ©e dans l'exploitation de Bitcoin aujourd'hui.  La probabilitÃ© de gÃ©nÃ©ration rÃ©ussie d'un bloc "empoisonnÃ©" peut Ãªtre estimÃ©e par la formule suivante: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/js/4u/ddjs4uoct9fzcc3lajt9qwz8_ca.png"></div><br>  Aujourd'hui, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hashrate total du</a> rÃ©seau Bitcoin est approximativement Ã©gal Ã  H = 34 âˆ™ 10 <sup>18</sup> hash / s.  Dans ce cas, en utilisant l'appareil le plus productif de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cette liste</a> , dont le taux de hachage dÃ©clarÃ© est h = 18 âˆ™ 10 <sup>12</sup> hachage / s, la probabilitÃ© de gÃ©nÃ©rer un bloc Â«empoisonnÃ©Â» en 1 an (t = 365 âˆ™ 24 âˆ™ 60) est d'environ 3%.  Et si nous prenons de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ces statistiques un</a> pool minier relativement petit qui a 0,3% du hashrate total, alors la probabilitÃ© de gÃ©nÃ©ration de blocs rÃ©ussie dans les 3 jours est de 73%. <br><br>  <b>Ã‰cueil n Â° 2</b> <br><br>  Avec le passage du temps du rÃ©seau de la victime, lâ€™horodatage du bloc Â«empoisonnÃ©Â» tombera finalement dans la fenÃªtre temporelle de la victime.  Ensuite, la victime changera la chaÃ®ne alternative en chaÃ®ne principale, car tout le rÃ©seau y travaille et sa hauteur sera plus grande.  Le bloc Â«empoisonnÃ©Â» tombera dans la fenÃªtre de temps de la victime en moins de 70 minutes - c'est le temps maximum pour lequel il est nÃ©cessaire de terminer la deuxiÃ¨me Ã©tape. <br><br>  Pour que la victime accepte la transaction avec double dÃ©pense, le bloc avec elle doit Ãªtre confirmÃ© par 6 autres blocs (pour un client standard).  Le contrevenant devra gÃ©nÃ©rer des blocs de confirmation de maniÃ¨re indÃ©pendante, et en mÃªme temps, il est nÃ©cessaire de respecter les 70 minutes susmentionnÃ©es.  Boverman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">considÃ¨re une</a> situation oÃ¹ un attaquant dÃ©tient 10% de la puissance de l'ensemble du rÃ©seau.  Dans une telle situation, il faudra environ 5,5 heures pour gÃ©nÃ©rer 6 blocs avec un taux de rÃ©ussite de 10%.  Pendant 3,3 heures, la probabilitÃ© de rÃ©ussite tombe Ã  1%, pour 140 minutes - 0,147%.  Selon ces estimations, gÃ©nÃ©rer avec succÃ¨s 6 blocs en 70 minutes est un fantasme. <br><br>  <b>Ã‰cueil n Â° 3</b> <br><br>  Lorsque le nÅ“ud calcule l'heure du rÃ©seau, il prend en compte l'heure systÃ¨me des <a href="">200 premiers voisins</a> uniquement - alors l'Ã©cart mÃ©dian ne sera pas recalculÃ©.  Cela signifie que l'attaque doit Ãªtre mise en Å“uvre jusqu'Ã  ce que le nombre de voisins dÃ©jÃ  connectÃ©s Ã  la victime ne dÃ©passe pas 99 - sinon le temps annoncÃ© par l'attaquant ne sera pas mÃ©dian.  Ce nombre de voisins s'exÃ©cutera dans environ 24 heures, et aprÃ¨s cela, la victime devra Ãªtre redÃ©marrÃ©e - par exemple, en utilisant DoS. <br><br><h2>  <b>La fin</b> </h2><br>  En conclusion, nous pouvons dire que l'attaque "Timejacking" est trÃ¨s bonne, mais dans les dures rÃ©alitÃ©s Bitcoin devient inapplicable.  Qu'en est-il des autres systÃ¨mes utilisant la blockchain?  Laissez-nous cette question pour vos recherches futures! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413721/">https://habr.com/ru/post/fr413721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413711/index.html">Programme prÃ©liminaire PyConRu-2018: trois dÃ©veloppeurs Python Core, confÃ©renciers de Google, Yelp, Red Hat, Yandex</a></li>
<li><a href="../fr413713/index.html">Performances de l'entrepÃ´t de donnÃ©es: nouveaux chiffres</a></li>
<li><a href="../fr413715/index.html">Pension de retraite informatique</a></li>
<li><a href="../fr413717/index.html">GraphQL pour les plates-formes InterSystems</a></li>
<li><a href="../fr413719/index.html">C ++ 20 en route! Rencontre Ã  Rapperswil Yona</a></li>
<li><a href="../fr413723/index.html">Saga des services Ã©lectroniques et de leurs emplacements. Partie 2. Armoire Ã©lectronique</a></li>
<li><a href="../fr413725/index.html">Travailler avec des tableaux dans bash</a></li>
<li><a href="../fr413729/index.html">Comment et pourquoi nous avons Ã©crit notre ECS</a></li>
<li><a href="../fr413731/index.html">Ã‰tude du marchÃ© du travail BA / SA</a></li>
<li><a href="../fr413733/index.html">Mikrosh, Krista, Apogee, Lviv - les premiers ordinateurs soviÃ©tiques Ã  emporter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>