<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘†ğŸ¾ ğŸ‘©ğŸ¿â€ğŸ”§ ğŸ—¡ï¸ WinFormsï¼šé”™è¯¯ï¼Œç¦å°”æ‘©æ–¯ ğŸ”€ ğŸ¤½ğŸ¾ ğŸ§ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬å–œæ¬¢åœ¨Microsofté¡¹ç›®ä¸­å¯»æ‰¾é”™è¯¯ã€‚ æ€ä¹ˆäº† å¾ˆç®€å•ï¼šä»–ä»¬çš„é¡¹ç›®é€šå¸¸å¾ˆå®¹æ˜“æ£€æŸ¥ï¼ˆå¯ä»¥åœ¨Visual Studioç¯å¢ƒä¸­ç«‹å³å®Œæˆå·¥ä½œï¼Œä¸ºæ­¤PVS-Studioæ‹¥æœ‰ä¾¿æ·çš„æ’ä»¶ï¼‰ï¼Œå¹¶ä¸”å‡ ä¹æ²¡æœ‰é”™è¯¯ã€‚ å› æ­¤ï¼Œé€šå¸¸çš„å·¥ä½œç®—æ³•å¦‚ä¸‹ï¼šä»MSæŸ¥æ‰¾å¹¶ä¸‹è½½ä¸€ä¸ªæ‰“å¼€çš„é¡¹ç›®ï¼› æ£€æŸ¥ä¸€ä¸‹ï¼› é€‰æ‹©æœ‰è¶£çš„é”™è¯¯ï¼› ç¡®ä¿æ•°é‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>WinFormsï¼šé”™è¯¯ï¼Œç¦å°”æ‘©æ–¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/462807/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/71b/aeb/a84/71baeba847a8865aef0cc8148effbb8c.png" alt="å›¾ç‰‡5"></div><br> æˆ‘ä»¬å–œæ¬¢åœ¨Microsofté¡¹ç›®ä¸­å¯»æ‰¾é”™è¯¯ã€‚ æ€ä¹ˆäº† å¾ˆç®€å•ï¼šä»–ä»¬çš„é¡¹ç›®é€šå¸¸å¾ˆå®¹æ˜“æ£€æŸ¥ï¼ˆå¯ä»¥åœ¨Visual Studioç¯å¢ƒä¸­ç«‹å³å®Œæˆå·¥ä½œï¼Œä¸ºæ­¤PVS-Studioæ‹¥æœ‰ä¾¿æ·çš„æ’ä»¶ï¼‰ï¼Œå¹¶ä¸”å‡ ä¹æ²¡æœ‰é”™è¯¯ã€‚ å› æ­¤ï¼Œé€šå¸¸çš„å·¥ä½œç®—æ³•å¦‚ä¸‹ï¼šä»MSæŸ¥æ‰¾å¹¶ä¸‹è½½ä¸€ä¸ªæ‰“å¼€çš„é¡¹ç›®ï¼› æ£€æŸ¥ä¸€ä¸‹ï¼› é€‰æ‹©æœ‰è¶£çš„é”™è¯¯ï¼› ç¡®ä¿æ•°é‡å¾ˆå°‘ï¼› å†™ä¸€ç¯‡æ–‡ç« ï¼Œä¸è¦å¿˜è®°èµæ‰¬å¼€å‘äººå‘˜ã€‚ å¤ªå¥½äº†ï¼ åŒèµ¢ï¼šèŠ±äº†ä¸€äº›æ—¶é—´ï¼Œæ‰‹å†Œå¾ˆé«˜å…´åœ¨åšå®¢ä¸Šçœ‹åˆ°æ–°ææ–™ï¼Œä¸šåŠ›äº•ç„¶æœ‰åºã€‚ ä½†æ˜¯è¿™ä¸€æ¬¡å‡ºäº†ç‚¹é—®é¢˜ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹åœ¨Windows Formsçš„æºä»£ç ä¸­å‘ç°äº†ä»€ä¹ˆæœ‰è¶£çš„ä¸œè¥¿ï¼Œä»¥åŠè¿™æ¬¡æ˜¯å¦åº”è¯¥èµæ‰¬Microsoftã€‚ <br><a name="habracut"></a><br>  <b>å¼•è¨€</b> <br><br> åœ¨2018å¹´12æœˆä¸Šæ—¬ï¼Œå¾®è½¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®£å¸ƒ</a>å‘å¸ƒ.NET Core 3 Preview 1ã€‚ æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æŸ¥çœ‹æäº¤ç»Ÿè®¡ä¿¡æ¯ã€‚ ç°åœ¨ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä¸‹è½½WinFormsæºä»£ç ä»¥è¿›è¡Œå®¡æŸ¥ã€‚ <br><br> æˆ‘è¿˜ä¸‹è½½äº†æºä»£ç ï¼Œä»¥ä½¿ç”¨PVS-StudioæŸ¥æ‰¾é”™è¯¯ã€‚ æ£€æŸ¥æ²¡æœ‰é€ æˆå›°éš¾ã€‚ å¿…éœ€ï¼šVisual Studio 2019ï¼Œ.NET Core 3.0 SDKé¢„è§ˆï¼ŒPVS-Studioã€‚ ç°åœ¨æ¥æ”¶åˆ°åˆ†æä»ªè­¦å‘Šæ—¥å¿—ã€‚ <br><br> æ”¶åˆ°PVS-Studioæ—¥å¿—åï¼Œæˆ‘é€šå¸¸ä»¥è¯Šæ–­ç¼–å·çš„å‡åºå¯¹å…¶è¿›è¡Œæ’åºï¼ˆVisual Studioä¸­å¸¦æœ‰PVS-Studioæ¶ˆæ¯æ—¥å¿—çš„çª—å£å…·æœ‰ç”¨äºæ’åºå’Œè¿‡æ»¤åˆ—è¡¨çš„å„ç§é€‰é¡¹ï¼‰ã€‚ è¿™å…è®¸å¤„ç†ç›¸åŒç±»å‹çš„é”™è¯¯ç»„ï¼Œä»è€Œå¤§å¤§ç®€åŒ–äº†æºä»£ç çš„åˆ†æã€‚ æˆ‘åœ¨æ˜Ÿå·ä¸Šæ ‡è®°äº†æœ‰è¶£çš„é”™è¯¯ï¼Œç„¶åï¼Œåœ¨åˆ†æäº†æ•´ä¸ªæ—¥å¿—ä¹‹åï¼Œæˆ‘å†™å‡ºäº†ä»£ç ç‰‡æ®µå¹¶è¿›è¡Œäº†æè¿°ã€‚ è€Œä¸”ç”±äºé€šå¸¸å¾ˆå°‘æœ‰é”™è¯¯ï¼Œå› æ­¤æˆ‘å°†å®ƒä»¬æ··åˆåœ¨ä¸€èµ·ï¼Œè¯•å›¾å°†æœ€æœ‰è¶£çš„é”™è¯¯æ”¾åœ¨æ–‡ç« çš„å¼€å¤´å’Œç»“å°¾ã€‚ ä½†è¿™ä¸€æ¬¡é”™è¯¯çš„ç¡®å¤šäº†ä¸€äº›ï¼ˆå—¯ï¼Œå¾ˆé•¿ä¸€æ®µæ—¶é—´éƒ½æ— æ³•ä¿å­˜è¿™ç§é˜´è°‹ï¼‰ï¼Œæˆ‘å°†æŒ‰ç…§è¯Šæ–­ç¼–å·çš„é¡ºåºè¿›è¡Œå¤„ç†ã€‚ <br><br> å‘ç°äº†ä»€ä¹ˆï¼Ÿ åœ¨1670 csæ–‡ä»¶ä¸­ï¼Œå¯¹540,000è¡Œä»£ç ï¼ˆä¸åŒ…æ‹¬ç©ºä»£ç ï¼‰å‘å‡ºäº†833ä¸ªé«˜å’Œä¸­ç½®ä¿¡åº¦è­¦å‘Šï¼ˆåˆ†åˆ«ä¸º249å’Œ584ï¼‰ã€‚ æ˜¯çš„ï¼Œæ ¹æ®ä¼ ç»Ÿï¼Œæˆ‘æ²¡æœ‰æ£€æŸ¥æµ‹è¯•ï¼Œä¹Ÿæ²¡æœ‰è€ƒè™‘ä½ç½®ä¿¡åº¦ï¼ˆå‘å‡º215ï¼‰çš„è­¦å‘Šã€‚ æ ¹æ®æˆ‘ä»¥å‰çš„è§‚å¯Ÿï¼ŒMSå¯¹è¯¥é¡¹ç›®æå‡ºäº†å¤ªå¤šè­¦å‘Šã€‚ ä½†å¹¶éæ‰€æœ‰è­¦å‘Šéƒ½æ˜¯é”™è¯¯ã€‚ <br><br> å¯¹äºè¯¥é¡¹ç›®ï¼Œè¯¯æŠ¥çš„æ•°é‡çº¦ä¸º30ï¼…ã€‚ åœ¨å¤§çº¦20ï¼…çš„æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä¸ç†Ÿæ‚‰è¯¥ä»£ç ï¼Œæ‰€ä»¥æˆ‘æ— æ³•å°±è¿™æ˜¯å¦æ˜¯ä¸€ä¸ªé”™è¯¯åšå‡ºå‡†ç¡®çš„ç»“è®ºã€‚ å¥½å§ï¼Œæˆ‘é”™è¿‡çš„é”™è¯¯ä¸­è‡³å°‘æœ‰20ï¼…å¯ä»¥å½’å› äºäººä¸ºå› ç´ ï¼šåŒ†å¿™ï¼Œç–²åŠ³ç­‰ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œç›¸åçš„æ•ˆæœä¹Ÿæ˜¯å¯èƒ½çš„ï¼šæˆ‘æŸ¥çœ‹äº†ä¸€äº›ç›¸åŒç±»å‹çš„è§¦å‘ï¼Œå…¶è§¦å‘æ¬¡æ•°å¯èƒ½è¾¾åˆ°70-80ï¼Œé€šè¿‡å¶å°”ä¼šå¢åŠ æˆ‘è®¤ä¸ºæ˜¯çœŸæ­£çš„é”™è¯¯çš„è§¦å‘æ¬¡æ•°ã€‚ <br><br> åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œå¦‚æœå°šæœªé¢„å…ˆé…ç½®åˆ†æä»ªï¼Œåˆ™30ï¼…çš„è­¦å‘Šè¡¨ç¤ºå®é™…é”™è¯¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ç™¾åˆ†æ¯”ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘èƒ½å¤Ÿæ£€æµ‹åˆ°çš„é”™è¯¯æ•°é‡çº¦ä¸º240ï¼Œè¿™åœ¨ç»Ÿè®¡æ•°æ®çš„èŒƒå›´å†…ã€‚ æˆ‘è®¤ä¸ºï¼Œå¯¹äºMSçš„é¡¹ç›®ï¼Œæˆ‘å†è¯´ä¸€éï¼Œè¿™å¹¶ä¸æ˜¯æœ€å‡ºè‰²çš„ç»“æœï¼ˆå°½ç®¡æ¯1000è¡Œä»£ç åªæœ‰0.44é”™è¯¯ï¼‰ï¼Œå¹¶ä¸”WinFormsä»£ç ä¸­å¯èƒ½å­˜åœ¨æ›´å¤šå®é™…é”™è¯¯ã€‚ æˆ‘å»ºè®®åœ¨æ–‡ç« ç»“å°¾è®¨è®ºåŸå› ï¼Œä½†ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æœ€æœ‰è¶£çš„é”™è¯¯ã€‚ <br><br>  <b>å¤±è¯¯</b> <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3003</a>å·²æ£€æµ‹åˆ°'ifï¼ˆAï¼‰{...} else ifï¼ˆAï¼‰{...}'æ¨¡å¼çš„ä½¿ç”¨ã€‚ å­˜åœ¨é€»è¾‘é”™è¯¯çš„å¯èƒ½æ€§ã€‚ æ£€æŸ¥è¡Œï¼š213ã€224ã€‚ButtonStandardAdapter.cs 213 <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PaintWorker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PaintEventArgs e, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> up, CheckState state)</span></span></span><span class="hljs-function"> </span></span>{ up = up &amp;&amp; state == CheckState.Unchecked; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (up &amp; IsHighContrastHighlighted()) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (up &amp; IsHighContrastHighlighted()) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... } .... }</code> </pre> <br> åœ¨<i>if</i>å’Œ<i>else if</i>å—ä¸­ï¼Œæ£€æŸ¥ç›¸åŒæ¡ä»¶ã€‚ çœ‹èµ·æ¥åƒæ˜¯å¤åˆ¶ç²˜è´´ã€‚ è¿™æ˜¯ä¸€ä¸ªé”™è¯¯å—ï¼Ÿ å¦‚æœæ‚¨æŸ¥çœ‹<i>IsHighContrastHighlighted</i>æ–¹æ³•çš„å£°æ˜ï¼Œåˆ™ä¼šæœ‰ç–‘é—®ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsHighContrastHighlighted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> SystemInformation.HighContrast &amp;&amp; Application.RenderWithVisualStyles &amp;&amp; (Control.Focused || Control.MouseIsOver || (Control.IsDefault &amp;&amp; Control.Enabled)); }</code> </pre> <br> è¯¥æ–¹æ³•å¯èƒ½åœ¨è¿ç»­è°ƒç”¨ä¸­è¿”å›ä¸åŒçš„å€¼ã€‚ å½“ç„¶ï¼Œåœ¨è°ƒç”¨æ–¹æ³•ä¸­æ‰§è¡Œçš„æ“ä½œçœ‹èµ·æ¥å¾ˆå¥‡æ€ªï¼Œä½†æ˜¯å®ƒå…·æœ‰ç”Ÿå‘½æƒã€‚ ä½†æ˜¯ï¼Œæˆ‘å»ºè®®ä½œè€…çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ã€‚ ä»¥é˜²ä¸‡ä¸€ã€‚ ä½†æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œè¯´æ˜äº†åœ¨åˆ†æä¸ç†Ÿæ‚‰çš„ä»£ç æ—¶å¾ˆéš¾å¾—å‡ºç»“è®ºã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3004'then</a> 'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚  RichTextBox.cs 1018 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> SelectionCharOffset { get { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> selCharOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; .... NativeMethods.CHARFORMATA cf = GetCharFormat(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-comment"><span class="hljs-comment">// if the effects member contains valid info if ((cf.dwMask &amp; RichTextBoxConstants.CFM_OFFSET) != 0) { selCharOffset = cf.yOffset; // &lt;= } else { // The selection contains characters of different offsets, // so we just return the offset of the first character. selCharOffset = cf.yOffset; // &lt;= } .... } .... }</span></span></code> </pre> <br> åœ¨è¿™é‡Œè‚¯å®šä¼šå‡ºç°å¤åˆ¶ç²˜è´´é”™è¯¯ã€‚ æ— è®ºæ¡ä»¶å¦‚ä½•ï¼Œ <i>selCharOffset</i>å˜é‡<i>å°†</i>å§‹ç»ˆè·å¾—ç›¸åŒçš„å€¼ã€‚ <br><br>  WinFormsä»£ç ä¸­è¿˜æœ‰ä¸¤ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <ul><li>  V3004'then'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚  SplitContainer.cs 1700 </li><li>  V3004'then'è¯­å¥ç­‰æ•ˆäº'else'è¯­å¥ã€‚ å·¥å…·tripProfessionalRenderer.cs 371 </li></ul><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3008</a>è¿ç»­ä¸¤æ¬¡ä¸ºå˜é‡åˆ†é…å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š681ã€680ã€‚ProfessionalColorTable.cs 681 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitSystemColors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ref Dictionary&lt;KnownColors, Color&gt; rgbTable)</span></span></span><span class="hljs-function"> </span></span>{ .... rgbTable[ProfessionalColorTable.KnownColors.msocbvcrCBBdrOuterDocked] = buttonFace; rgbTable[ProfessionalColorTable.KnownColors.msocbvcrCBBdrOuterDocked] = buttonShadow; .... }</code> </pre> <br> è¯¥æ–¹æ³•å¡«å……<i>rgbTable</i>å­—å…¸ã€‚ åˆ†æå™¨æŒ‡å‘ä¸€æ®µä»£ç ï¼Œå…¶ä¸­ä¸¤ä¸ªä¸åŒçš„å€¼ä¾æ¬¡å†™å…¥åŒä¸€é”®ã€‚ ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥çš„ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•è¿˜æœ‰16ä¸ªè¿™æ ·çš„ä½ç½®ï¼Œè¿™ä¸å†åƒä¸€ä¸ªé”™è¯¯ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Œå¯¹æˆ‘æ¥è¯´ä»ç„¶æ˜¯ä¸ªè°œã€‚ æˆ‘æ²¡æœ‰å‘ç°è‡ªåŠ¨ç”Ÿæˆä»£ç çš„è¿¹è±¡ã€‚ åœ¨ç¼–è¾‘å™¨ä¸­ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/006/f68/827/006f688275da3701f28abe7918835ce9.png" alt="å›¾ç‰‡3"></div><br> æˆ‘å°†åˆ—å‡ºå‰åä¸ªæ“ä½œï¼š <br><br><ol><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š785ï¼Œ784ã€‚ProfessionalColorTable.cs 785 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š787ã€786ã€‚ProfessionalColorTable.cs 787 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š789ã€788ã€‚ProfessionalColorTable.cs 789 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š791ã€790ã€‚ProfessionalColorTable.cs 791 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š797ã€796ã€‚ProfessionalColorTable.cs 797 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š799ã€798ã€‚ProfessionalColorTable.cs 799 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š807ã€806ã€‚ProfessionalColorTable.cs 807 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š815ã€814ã€‚ProfessionalColorTable.cs 815 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š817ï¼Œ816ã€‚ProfessionalColorTable.cs 817 </li><li>  V3008ä¸ºå˜é‡è¿ç»­åˆ†é…ä¸¤æ¬¡å€¼ã€‚ ä¹Ÿè®¸è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ£€æŸ¥è¡Œï¼š823ï¼Œ822ã€‚ProfessionalColorTable.cs 823 </li></ol><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3011</a>é‡åˆ°ä¸¤ä¸ªç›¸åçš„æ¡ä»¶ã€‚ ç¬¬äºŒä¸ªæ¡ä»¶å§‹ç»ˆä¸ºå‡ã€‚ æ£€æŸ¥è¡Œï¼š5242ã€5240ã€‚DataGrid.cs 5242 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckHierarchyState</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (checkHierarchy &amp;&amp; listManager != null &amp;&amp; myGridTable != null) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (myGridTable == null) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { // there was nothing to check return; } for (int j = 0; j &lt; myGridTable.GridColumnStyles.Count; j++) { DataGridColumnStyle gridColumn = myGridTable.GridColumnStyles[j]; } checkHierarchy = false; } }</span></span></code> </pre> <br>  <i>returnè¯­å¥</i>å°†æ°¸è¿œä¸ä¼šæ‰§è¡Œã€‚ æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œæ¡ä»¶<i>myGridTableï¼=</i>å¤–éƒ¨<i>if</i>å—ä¸­çš„<i>Null</i>åœ¨é‡æ„æœŸé—´ç¨åæ·»åŠ ã€‚ ç°åœ¨æ£€æŸ¥<i>myGridTable == nullæ˜¯</i>æ²¡æœ‰æ„ä¹‰çš„ã€‚ ä¸ºäº†æé«˜ä»£ç çš„è´¨é‡ï¼Œè¯·åˆ é™¤æ­¤æ£€æŸ¥ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3019</a>å¯èƒ½åœ¨ä½¿ç”¨'as'å…³é”®å­—è¿›è¡Œç±»å‹è½¬æ¢åå°†ä¸æ­£ç¡®çš„å˜é‡ä¸nullè¿›è¡Œæ¯”è¾ƒã€‚ æ£€æŸ¥å˜é‡â€œ leftâ€ï¼Œâ€œ cscLeftâ€ã€‚  TypeCodeDomSerializer.cs 611 <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3019</a>å¯èƒ½åœ¨ä½¿ç”¨'as'å…³é”®å­—è¿›è¡Œç±»å‹è½¬æ¢åå°†ä¸æ­£ç¡®çš„å˜é‡ä¸nullè¿›è¡Œæ¯”è¾ƒã€‚ æ£€æŸ¥å˜é‡â€œ rightâ€ï¼Œâ€œ cscRightâ€ã€‚  TypeCodeDomSerializer.cs 615 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object left, object right)</span></span></span><span class="hljs-function"> </span></span>{ OrderedCodeStatementCollection cscLeft = left as OrderedCodeStatementCollection; OrderedCodeStatementCollection cscRight = right as OrderedCodeStatementCollection; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (left == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (right == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (right == left) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cscLeft.Order - cscRight.Order; <span class="hljs-comment"><span class="hljs-comment">// &lt;= }</span></span></code> </pre> <br> åˆ†æä»ªç«‹å³å¯¹<i>Compare</i>æ–¹æ³•å‘å‡ºä¸¤ä¸ªè­¦å‘Šã€‚ æ€ä¹ˆäº† åªæ˜¯ä¸æ£€æŸ¥<i>cscLeft</i>å’Œ<i>cscRight</i>çš„å€¼æ˜¯å¦ç­‰äº<i>null</i> ã€‚ åœ¨ä¸æˆåŠŸåœ°è½¬æ¢ä¸º<i>OrderedCodeStatementCollection</i>ç±»å‹ä¹‹åï¼Œä»–ä»¬å¯ä»¥è·å¾—æ­¤å€¼ã€‚ ç„¶åï¼Œå°†åœ¨æœ€åä¸€ä¸ª<i>returnè¯­å¥ä¸­</i>å¼•å‘å¼‚å¸¸ã€‚ å½“æ‰€æœ‰æ£€æŸ¥éƒ½é€šè¿‡<i>å·¦</i>å’Œ<i>å³</i>å¹¶ä¸”æ²¡æœ‰å¯¼è‡´è¯¥æ–¹æ³•çš„åˆæ­¥é€€å‡ºæ—¶ï¼Œè¿™ç§æƒ…å†µæ˜¯å¯èƒ½çš„ã€‚ <br><br> è¦ä¿®å¤ä»£ç ï¼Œåº”åœ¨<i>å„å¤„</i>ä½¿ç”¨<i>cscLeft</i> / <i>cscRight</i>è€Œä¸æ˜¯<i>left</i> / <i>right</i> ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3020</a>å¾ªç¯å†…æ— æ¡ä»¶çš„â€œä¸­æ–­â€ã€‚  SelectionService.cs 421 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ISelectionService.SetSelectedComponents( ICollection components, SelectionTypes selectionType) { .... <span class="hljs-comment"><span class="hljs-comment">// Handle the click case object requestedPrimary = null; int primaryIndex; if (fPrimary &amp;&amp; 1 == components.Count) { foreach (object o in components) { requestedPrimary = o; if (o == null) { throw new ArgumentNullException(nameof(components)); } break; } } .... }</span></span></code> </pre> <br> è¯¥ç‰‡æ®µæ˜¯æŒ‡â€œå¸¦æœ‰æ°”å‘³â€çš„ä»£ç ã€‚ è¿™é‡Œæ²¡æœ‰é”™è¯¯ã€‚ ä½†æ˜¯ï¼Œå¯¹<i>æ¯ä¸ª</i>å¾ªç¯çš„ç»„ç»‡æ–¹å¼æå‡ºäº†ç–‘é—®ã€‚ ä¸ºä»€ä¹ˆåœ¨è¿™é‡Œéœ€è¦å®ƒ-å¾ˆæ˜æ˜¾ï¼šç”±äºéœ€è¦æå–ä½œä¸º<i>ICollection</i>ä¼ é€’çš„é›†åˆçš„å…ƒç´ ã€‚ ä½†æ˜¯ï¼Œä¸ºä»€ä¹ˆåœ¨æœ€åˆä¸ºå•æ¬¡è¿­ä»£è€Œè®¾è®¡çš„å¾ªç¯ä¸­ï¼ˆå‰ææ˜¯<i>ç»„ä»¶</i>é›†åˆä¸­å­˜åœ¨å•ä¸ªå…ƒç´ ï¼‰ï¼Œåˆ™éœ€è¦ä¸€ä¸ªé¢å¤–çš„å®‰å…¨ç½‘ï¼ˆä»¥<i>ä¸­æ–­</i>çš„å½¢å¼ï¼‰ï¼Ÿ ç­”æ¡ˆå¯èƒ½æ˜¯ï¼šâ€œå®ƒæ˜¯å†å²å‘å±•çš„â€ã€‚ è¯¥ä»£ç çœ‹èµ·æ¥å¾ˆéš¾çœ‹ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3022</a>è¡¨è¾¾å¼'ocxStateï¼= Null'å§‹ç»ˆä¸ºtrueã€‚  AxHost.cs 2186 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> State OcxState { .... <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } .... ocxState = value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ocxState != null) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { axState[manualUpdate] = ocxState._GetManualUpdate(); licenseKey = ocxState._GetLicenseKey(); } else { axState[manualUpdate] = false; licenseKey = null; } .... } }</span></span></code> </pre> <br> ç”±äºé€»è¾‘é”™è¯¯ï¼Œåœ¨æ­¤ç‰‡æ®µä¸­å½¢æˆäº†â€œæ­»ä»£ç â€ã€‚  <i>else</i>å—ä¸­çš„è¡¨è¾¾å¼å°†æ°¸è¿œä¸ä¼šæ‰§è¡Œã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3027</a>åœ¨é’ˆå¯¹åŒä¸€é€»è¾‘è¡¨è¾¾å¼ä¸­çš„nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œåœ¨é€»è¾‘è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†å˜é‡'e'ã€‚ å›¾åƒç¼–è¾‘å™¨.cs 99 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> override object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EditValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... ImageEditor e = ....; Type myClass = GetType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!myClass.Equals(e.GetType()) &amp;&amp; e != null &amp;&amp; myClass.IsInstanceOfType(e)) { .... } .... }</code> </pre> <br> é¦–å…ˆä½¿ç”¨æ¡ä»¶ä¸­çš„å˜é‡<i>e</i> ï¼Œç„¶åæ£€æŸ¥<i>ç©º</i>ä¸ç­‰å¼ã€‚ å—¨ï¼Œ <i>NullReferenceException</i> ã€‚ <br><br> å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3027</a>åœ¨å¯¹åŒä¸€é€»è¾‘è¡¨è¾¾å¼ä¸­çš„nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œåœ¨é€»è¾‘è¡¨è¾¾å¼ä¸­ä½¿ç”¨äº†å˜é‡'dropDownItem'ã€‚  ToolStripMenuItemDesigner.cs 1351 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnterInSituEdit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ToolStripItem toolItem)</span></span></span><span class="hljs-function"> </span></span>{ .... ToolStripDropDownItem dropDownItem = toolItem as ToolStripDropDownItem; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(dropDownItem.Owner is ToolStripDropDownMenu) &amp;&amp; dropDownItem != null &amp;&amp; dropDownItem.Bounds.Width &lt; commitedEditorNode.Bounds.Width) { .... } .... }</code> </pre> <br> è¿™ç§æƒ…å†µä¸ä¸Šä¸€ä¸ªç±»ä¼¼ï¼Œåªä¸è¿‡å…·æœ‰å˜é‡<i>dropDownItem</i> ã€‚ æˆ‘è®¤ä¸ºè¿™äº›é”™è¯¯æ˜¯ç”±äºé‡æ„æœŸé—´çš„ç–å¿½è€Œå‡ºç°çš„ã€‚ ç¨åï¼Œéƒ¨åˆ†æ¡ä»¶<i>ï¼ï¼ˆDropDownItem.Owneræ˜¯ToolStripDropDownMenuï¼‰å¯èƒ½</i>å·²æ·»åŠ åˆ°ä»£ç ä¸­ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3030</a>å®šæœŸæ£€æŸ¥ã€‚  'columnCount&gt; 0'æ¡ä»¶å·²ç»åœ¨è¡Œ3900ä¸­å¾—åˆ°éªŒè¯ã€‚ListView.cs 3903 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">internal ColumnHeader </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InsertColumn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index, ColumnHeader ch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> refreshSubItems)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">// Add the column to our internal array int columnCount = (columnHeaders == null ? 0 : columnHeaders.Length); if (columnCount &gt; 0) { ColumnHeader[] newHeaders = new ColumnHeader[columnCount + 1]; if (columnCount &gt; 0) { System.Array.Copy(columnHeaders, 0, newHeaders, 0, columnCount); } .... } .... }</span></span></code> </pre> <br> ä¸€ä¸ªçœ‹ä¼¼æ— å®³çš„é”™è¯¯ã€‚ ç¡®å®ï¼Œå¯ä»¥æ‰§è¡Œé¢å¤–çš„æ£€æŸ¥ï¼Œä½†è¿™ä¸ä¼šå½±å“å·¥ä½œçš„é€»è¾‘ã€‚ æœ‰æ—¶ï¼Œå½“æ‚¨éœ€è¦é‡æ–°æ£€æŸ¥è§†è§‰ç»„ä»¶çš„çŠ¶æ€æ—¶ï¼Œä»–ä»¬ç”šè‡³ä¼šè¿™æ ·åšï¼Œä¾‹å¦‚ï¼Œé€šè¿‡è·å–åˆ—è¡¨ä¸­çš„æ¡ç›®æ•°ã€‚ ä»…åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»–ä»¬æ‰ä»”ç»†æ£€æŸ¥<i>å±€éƒ¨</i>å˜é‡<i>columnCount</i> ã€‚ è¿™æ˜¯éå¸¸å¯ç–‘çš„ã€‚ ä»–ä»¬è¦ä¹ˆæƒ³è¦æ£€æŸ¥å¦ä¸€ä¸ªå˜é‡ï¼Œè¦ä¹ˆåœ¨å…¶ä¸­ä¸€é¡¹æ£€æŸ¥ä¸­ä½¿ç”¨äº†é”™è¯¯çš„æ¡ä»¶ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3061</a>å‚æ•°â€œ lprcClipRectâ€å§‹ç»ˆåœ¨ä½¿ç”¨å‰åœ¨æ–¹æ³•ä¸»ä½“ä¸­é‡å†™ã€‚  WebBrowserSiteBase.cs 281 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> UnsafeNativeMethods.IOleInPlaceSite.GetWindowContext( out UnsafeNativeMethods.IOleInPlaceFrame ppFrame, out UnsafeNativeMethods.IOleInPlaceUIWindow ppDoc, NativeMethods.COMRECT lprcPosRect, NativeMethods.COMRECT lprcClipRect, NativeMethods.tagOIFI lpFrameInfo) { ppDoc = null; ppFrame = Host.GetParentContainer(); lprcPosRect.left = Host.Bounds.X; lprcPosRect.top = Host.Bounds.Y; .... lprcClipRect = WebBrowserHelper.GetClipRect(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= if (lpFrameInfo != null) { lpFrameInfo.cb = Marshal.SizeOf&lt;NativeMethods.tagOIFI&gt;(); lpFrameInfo.fMDIApp = false; .... } return NativeMethods.S_OK; }</span></span></code> </pre> <br> æ˜¾è€Œæ˜“è§çš„é”™è¯¯ã€‚ æ˜¯çš„ï¼Œ <i>lprcClipRect</i>å‚æ•°å®é™…ä¸Š<i>æ˜¯</i>ç”¨æ–°å€¼åˆå§‹åŒ–çš„ï¼Œæ²¡æœ‰ä»¥ä»»ä½•æ–¹å¼ä½¿ç”¨å®ƒã€‚ ä½†æ˜¯ï¼Œè¿™ä¼šå¯¼è‡´ä»€ä¹ˆå‘¢ï¼Ÿ æˆ‘è®¤ä¸ºåœ¨è°ƒç”¨ä»£ç çš„æŸä¸ªåœ°æ–¹ï¼Œé€šè¿‡æ­¤å‚æ•°ä¼ é€’çš„é“¾æ¥å°†ä¿æŒä¸å˜ï¼Œå°½ç®¡å…¶æ„å›¾æœ‰æ‰€ä¸åŒã€‚ ç¡®å®ï¼Œè¯·çœ‹çœ‹åœ¨æ­¤æ–¹æ³•ä¸­ä½¿ç”¨å…¶ä»–å˜é‡ã€‚ ç”šè‡³å®ƒçš„åç§°ï¼ˆâ€œ Getâ€å‰ç¼€ï¼‰ä¹Ÿæš—ç¤ºå°†é€šè¿‡ä¼ é€’çš„å‚æ•°åœ¨æ–¹æ³•å†…éƒ¨è¿›è¡Œä¸€äº›åˆå§‹åŒ–ã€‚ å°±æ˜¯è¿™æ ·ã€‚ å‰ä¸¤ä¸ªå‚æ•°ï¼ˆ <i>ppFrame</i>å’Œ<i>ppDoc</i> ï¼‰ä¸<i>out</i>ä¿®é¥°ç¬¦ä¸€èµ·ä¼ é€’å¹¶è·å–æ–°å€¼ã€‚ é“¾æ¥<i>lprcPosRect</i>å’Œ<i>lpFrameInfo</i>ç”¨äºè®¿é—®ç±»çš„å­—æ®µå¹¶å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚ å¹¶ä¸”åªæœ‰<i>lprcClipRect</i>ä¸åœ¨å¸¸è§„åˆ—è¡¨ä¸­ã€‚ æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œæ­¤å‚æ•°éœ€è¦<i>out</i>æˆ–<i>ref</i>ä¿®é¥°ç¬¦ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3066</a>ä¼ é€’ç»™â€œ AdjustCellBorderStyleâ€æ–¹æ³•çš„å‚æ•°çš„å¯èƒ½é”™è¯¯é¡ºåºï¼šâ€œ isFirstDisplayedRowâ€å’Œâ€œ isFirstDisplayedColumnâ€ã€‚  DataGridViewComboBoxCell.cs 1934 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> override </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseMove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DataGridViewCellMouseEventArgs e)</span></span></span><span class="hljs-function"> </span></span>{ .... dgvabsEffective = AdjustCellBorderStyle( DataGridView.AdvancedCellBorderStyle, dgvabsPlaceholder, singleVerticalBorderAdded, singleHorizontalBorderAdded, isFirstDisplayedRow, <span class="hljs-comment"><span class="hljs-comment">// &lt;= isFirstDisplayedColumn); // &lt;= .... }</span></span></code> </pre> <br> åˆ†æå™¨æ€€ç–‘æœ€åä¸¤ä¸ªå‚æ•°æ··æ·†äº†ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹<i>AdjustCellBorderStyle</i>æ–¹æ³•çš„å£°æ˜ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> DataGridViewAdvancedBorderStyle </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AdjustCellBorderStyle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DataGridViewAdvancedBorderStyledataGridViewAdvancedBorderStyleInput, DataGridViewAdvancedBorderStyle dataGridViewAdvancedBorderStylePlaceholder, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> singleVerticalBorderAdded, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> singleHorizontalBorderAdded, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isFirstDisplayedColumn, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> isFirstDisplayedRow)</span></span></span><span class="hljs-function"> </span></span>{ .... }</code> </pre> <br> çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ æ˜¯çš„ï¼Œç»å¸¸æœ‰æ„åœ°ä»¥ç›¸åçš„é¡ºåºä¼ é€’ä¸€äº›å‚æ•°ï¼Œä¾‹å¦‚ï¼Œä»¥ä¾¿äº¤æ¢æŸäº›å˜é‡ã€‚ ä½†æˆ‘è®¤ä¸ºæƒ…å†µå¹¶éå¦‚æ­¤ã€‚ è°ƒç”¨æˆ–è¢«è°ƒç”¨æ–¹æ³•ä¸­æ²¡æœ‰ä»»ä½•å†…å®¹è¯´æ˜è¿™ç§ä½¿ç”¨æ¨¡å¼ã€‚ é¦–å…ˆï¼Œ <i>å¸ƒå°”</i>ç±»å‹å˜é‡ä»¤äººå›°æƒ‘ã€‚ å…¶æ¬¡ï¼Œæ–¹æ³•çš„åç§°ä¹Ÿå¾ˆå¸¸è§ï¼šæ²¡æœ‰â€œäº¤æ¢â€æˆ–â€œåå‘â€ã€‚ è€Œä¸”ï¼ŒçŠ¯è¿™æ ·çš„é”™è¯¯å¹¶ä¸éš¾ã€‚ äººä»¬é€šå¸¸å¯¹è¡Œ/åˆ—å¯¹çš„é¡ºåºæœ‰ä¸åŒçš„è®¤è¯†ã€‚ ä¾‹å¦‚ï¼Œå¯¹æˆ‘è€Œè¨€ï¼Œä»…ç†Ÿæ‚‰â€œè¡Œ/åˆ—â€ã€‚ ä½†æ˜¯å¯¹äºåä¸º<i>AdjustCellBorderStyle</i>æ–¹æ³•çš„ä½œè€…<i>æ¥è¯´</i> ï¼Œæ˜¾ç„¶ï¼Œæ›´ç†Ÿæ‚‰çš„é¡ºåºæ˜¯â€œåˆ—/è¡Œâ€ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3070</a>åˆå§‹åŒ–â€œ LOCALE_USER_DEFAULTâ€å˜é‡æ—¶ä½¿ç”¨æœªåˆå§‹åŒ–çš„å˜é‡â€œ LANG_USER_DEFAULTâ€ã€‚  NativeMethods.cs 890 <br><br><pre> <code class="cpp hljs">internal <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NativeMethods</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LOCALE_USER_DEFAULT = MAKELCID(LANG_USER_DEFAULT); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LANG_USER_DEFAULT = MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT); .... }</code> </pre> <br> ä¸€ä¸ªç½•è§çš„é”™è¯¯ã€‚ ç±»å­—æ®µçš„åˆå§‹åŒ–é¡ºåºæ··åˆåœ¨ä¸€èµ·ã€‚ è¦è®¡ç®—<i>LOCALE_USER_DEFAULT</i>å­—æ®µçš„å€¼ï¼Œè¯·ä½¿ç”¨<i>LANG_USER_DEFAULT</i>å­—æ®µï¼Œè¯¥å­—æ®µå°šæœªåˆå§‹åŒ–ä¸”å€¼ä¸º0ã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œ <i>LANG_USER_DEFAULT</i>å˜é‡æœªåœ¨ä»£ç ä¸­çš„å…¶ä»–ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚ æˆ‘ä¸å¤ªæ‡’æƒ°ï¼Œå¹¶ç¼–å†™äº†ä¸€ä¸ªæ¨¡æ‹Ÿè¿™ç§æƒ…å†µçš„å°å‹æ§åˆ¶å°ç¨‹åºã€‚ æˆ‘ä»£æ›¿äº†WinFormsä»£ç ä¸­ä½¿ç”¨çš„æŸäº›å¸¸é‡çš„å€¼ï¼Œè€Œæ˜¯æ›¿æ¢äº†å®ƒä»¬çš„å®é™…å€¼ï¼š <br><br><pre> <code class="cpp hljs">internal <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NativeMethods</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LOCALE_USER_DEFAULT = MAKELCID(LANG_USER_DEFAULT); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> LANG_USER_DEFAULT = MAKELANGID(<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MAKELANGID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> primary, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sub)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((((ushort)(sub)) &lt;&lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) | (ushort)(primary)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MAKELCID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lgid)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> MAKELCID(lgid, <span class="hljs-number"><span class="hljs-number">0x0</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MAKELCID</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> lgid, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sort)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((<span class="hljs-number"><span class="hljs-number">0xFFFF</span></span> &amp; lgid) | (((<span class="hljs-number"><span class="hljs-number">0x000f</span></span>) &amp; sort) &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>)); } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Program</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.Console.WriteLine(NativeMethods.LOCALE_USER_DEFAULT); } }</code> </pre> <br> å¯åŠ¨åï¼Œæ§åˆ¶å°ä¸Šå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š0ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬äº¤æ¢<i>LOCALE_USER_DEFAULT</i>å’Œ<i>LANG_USER_DEFAULTå­—æ®µ</i>çš„å£°æ˜ã€‚ ç¨‹åºçš„ç»“æœæ ¼å¼ä¸ºï¼š1024ã€‚æˆ‘è®¤ä¸ºè¿™é‡Œæ— å¯å¥‰å‘Šäº†ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½å–æ¶ˆç©ºå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œ cesâ€ã€‚ ç¬¬562ç«  <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeserializeStatement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( IDesignerSerializationManager manager, CodeStatement statement)</span></span></span><span class="hljs-function"> </span></span>{ .... CodeExpressionStatement ces = statement as CodeExpressionStatement; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ces != null) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... DeserializeExpression(manager, null, ces.Expression); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... } .... }</span></span></code> </pre> <br> åº”è¯¥â€œä¸‹é™â€çš„ä»£ç è¶³å¤Ÿç¨³å®šï¼Œå› ä¸ºä»…å½“<i>ces</i>å¼•ç”¨ä¸º<i>null</i>æ—¶ï¼Œæ‚¨æ‰èƒ½è¿›å…¥<i>else</i>åˆ†æ”¯ã€‚ <br><br> å¦ä¸€ä¸ªç±»ä¼¼çš„ä¾‹å­ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½å–æ¶ˆç©ºå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œ comboBoxâ€ã€‚  ComboBox.cs 6610 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValidateOwnerDrawRegions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ComboBox comboBox, ....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (comboBox != null) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } Rectangle topOwnerDrawArea = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Rectangle(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, comboBox.Width, innerBorder.Top); .... }</code> </pre> <br> çŸ›ç›¾çš„ä»£ç ã€‚ æ˜¾ç„¶ï¼Œä»–ä»¬é€šè¿‡ç¼–å†™<i>ifï¼ˆcomboBoxï¼= Nullï¼‰</i>è€Œä¸æ˜¯<i>ifï¼ˆcomboBox == nullï¼‰</i>æ¥æ··åˆæµ‹è¯•ã€‚ è¿™æ ·-æˆ‘ä»¬å°†æ”¶åˆ°ä¸‹ä¸€ä¸ª<i>NullReferenceException</i> ã€‚ <br><br> æˆ‘ä»¬æ£€æŸ¥äº†ä¸¤ä¸ªéå¸¸æ˜æ˜¾çš„é”™è¯¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a> ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­ç›´è§‚åœ°è·Ÿè¸ªæ–¹æ³•ä¸­å¯èƒ½ä½¿ç”¨ç©ºå¼•ç”¨çš„æƒ…å†µã€‚ ä½†æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>è¯Šæ–­æ›´åŠ æ™ºèƒ½ï¼Œå¯ä»¥åœ¨æ–¹æ³•è°ƒç”¨é“¾ä¸­æŸ¥æ‰¾ç±»ä¼¼çš„é”™è¯¯ã€‚ ä¸ä¹…å‰ï¼Œæˆ‘ä»¬æ˜¾ç€å¢å¼ºäº†æ•°æ®æµå’Œè¿‡ç¨‹é—´åˆ†æçš„æœºåˆ¶ã€‚ æ‚¨å¯ä»¥åœ¨æ–‡ç« â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cï¼ƒ8.0å’Œé™æ€åˆ†æä¸­çš„å¯ç©ºå¼•ç”¨ç±»å‹</a> â€ä¸­é˜…è¯»æœ‰å…³æ­¤å†…å®¹çš„ä¿¡æ¯ã€‚ è¿™æ˜¯åœ¨WinFormsä¸­å‘ç°çš„ç±»ä¼¼é”™è¯¯ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080'reader.NameTable</a> 'ä¸­çš„æ–¹æ³•å†…éƒ¨å¯èƒ½å­˜åœ¨ç©ºå–æ¶ˆå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥ç¬¬ä¸€ä¸ªå‚æ•°ï¼šcontentReaderã€‚  ResXResourceReader.cs 267 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnsureResData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... XmlTextReader contentReader = null; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fileContents != null) { contentReader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XmlTextReader(....); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reader != null) { contentReader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XmlTextReader(....); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fileName != null || stream != null) { .... contentReader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XmlTextReader(....); } SetupNameTable(contentReader); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... } finally { .... } .... }</span></span></code> </pre> <br> æŸ¥çœ‹æ–¹æ³•ä¸»ä½“ä¸­çš„å˜é‡<i>contentReader</i>ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ åœ¨ä½¿ç”¨ç©ºå¼•ç”¨è¿›è¡Œåˆå§‹åŒ–ä¹‹åï¼Œç”±äºæ£€æŸ¥ä¹‹ä¸€ï¼Œè¯¥é“¾æ¥å°†è¢«åˆå§‹åŒ–ã€‚ ä½†æ˜¯ï¼Œä¸€ç³»åˆ—æ£€æŸ¥å¹¶ä¸ä»¥<i>else</i>å—ç»“å°¾ã€‚ è¿™æ„å‘³ç€åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼ˆæˆ–ç”±äºå°†æ¥çš„é‡æ„ï¼‰ï¼Œé“¾æ¥ä»ç„¶å¯ä»¥ä¿æŒé›¶ã€‚ æ¥ä¸‹æ¥ï¼Œå®ƒå°†è¢«ä¼ é€’åˆ°<i>SetupNameTable</i>æ–¹æ³•ï¼Œåœ¨æ­¤æ–¹æ³•ä¸­æ— éœ€ä»»ä½•éªŒè¯å³å¯ä½¿ç”¨å®ƒï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetupNameTable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XmlReader reader)</span></span></span><span class="hljs-function"> </span></span>{ reader.NameTable.Add(ResXResourceWriter.TypeStr); reader.NameTable.Add(ResXResourceWriter.NameStr); .... }</code> </pre> <br> è¿™å¯èƒ½æ˜¯ä¸å®‰å…¨çš„ä»£ç ã€‚ <br><br> è¿˜æœ‰ä¸€ä¸ªé”™è¯¯ï¼Œåˆ†æä»ªå¿…é¡»ç»è¿‡ä¸€ç³»åˆ—è°ƒç”¨æ‰èƒ½ç¡®å®šé—®é¢˜ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3080</a>å¯èƒ½å–æ¶ˆç©ºå¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œå¸ƒå±€â€ã€‚  156ï¼Œç¬¬156ç«  <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Rectangle </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAnchorDestination</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( IArrangedElement element, Rectangle displayRect, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> measureOnly)</span></span></span><span class="hljs-function"> </span></span>{ .... AnchorInfo layout = GetAnchorInfo(element); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = layout.Left + displayRect.X; .... }</code> </pre> <br> åˆ†æå™¨å£°ç§°å¯ä»¥ä»<i>GetAnchorInfo</i>æ–¹æ³•è·å–ç©ºå¼•ç”¨ï¼Œè¯¥æ–¹æ³•å°†åœ¨è®¡ç®—<i>å·¦</i>å€¼æ—¶å¼•å‘å¼‚å¸¸ã€‚ è®©æˆ‘ä»¬éå†æ•´ä¸ªå‘¼å«é“¾ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦æ˜¯è¿™æ ·ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> AnchorInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetAnchorInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IArrangedElement element)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (AnchorInfo)element.Properties.GetObject(s_layoutInfoProperty); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key)</span></span></span><span class="hljs-function"> </span></span>=&gt; GetObject(key, out _); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> key, out </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> found)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> keyIndex = SplitKey(key, out <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> element); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!LocateObjectEntry(keyIndex, out <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index)) { found = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> null; } <span class="hljs-comment"><span class="hljs-comment">// We have found the relevant entry. See if // the bitmask indicates the value is used. if (((1 &lt;&lt; element) &amp; s_objEntries[index].Mask) == 0) { found = false; return null; } found = true; switch (element) { case 0: return s_objEntries[index].Value1; .... default: Debug.Fail("Invalid element obtained from LocateObjectEntry"); return null; } }</span></span></code> </pre> <br> å®é™…ä¸Šï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå…³é—­è°ƒç”¨é“¾çš„<i>GetObject</i>æ–¹æ³•å°†è¿”å›<i>null</i> ï¼Œè€Œæ— éœ€ä»»ä½•å…¶ä»–æ£€æŸ¥ï¼Œè¯¥æ–¹æ³•å°†ä¼ é€’ç»™è°ƒç”¨æ–¹æ³•ã€‚ å¯èƒ½ï¼Œ <i>GetAnchorDestination</i>æ–¹æ³•åº”æä¾›è¿™ç§æƒ…å†µã€‚ <br><br> åœ¨WinFormsä»£ç ä¸­ï¼Œæœ‰å¾ˆå¤šè¿™æ ·çš„é”™è¯¯ï¼Œ <b>è¶…è¿‡70ä¸ª</b> ã€‚ å®ƒä»¬éƒ½æ˜¯ç›¸ä¼¼çš„ï¼Œå› æ­¤åœ¨æœ¬æ–‡ä¸­ä¸å†èµ˜è¿°ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3091</a>å®è¯åˆ†æã€‚ å­—ç¬¦ä¸²æ–‡å­—ä¸­å¯èƒ½å­˜åœ¨é”™å­—ï¼šâ€œ ShowCheckMarginâ€ã€‚  â€œ ShowCheckMarginâ€ä¸€è¯å¯ç–‘ã€‚  PropertyNames.cs 136 <br><br><pre> <code class="cpp hljs">internal <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PropertyNames</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> ShowImageMargin = <span class="hljs-string"><span class="hljs-string">"ShowCheckMargin"</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> readonly <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> ShowCheckMargin = <span class="hljs-string"><span class="hljs-string">"ShowCheckMargin"</span></span>; .... }</code> </pre> <br> ä¸€ä¸ªä¸å¤ªå®¹æ˜“å‘ç°çš„é”™è¯¯çš„å¥½ä¾‹å­ã€‚ åˆå§‹åŒ–ç±»å­—æ®µæ—¶ï¼Œå®ƒä»¬ä½¿ç”¨ç›¸åŒçš„å€¼ï¼Œå°½ç®¡ä»£ç çš„ä½œè€…æ˜¾ç„¶å¹¶ä¸è¿™ä¹ˆè®¤ä¸ºï¼ˆåº”å½’å’äºå¤åˆ¶ç²˜è´´ï¼‰ã€‚ åˆ†æå™¨é€šè¿‡æ¯”è¾ƒå˜é‡åç§°å’Œåˆ†é…çš„å­—ç¬¦ä¸²çš„å€¼æ¥å¾—å‡ºæ­¤ç»“è®ºã€‚ æˆ‘åªç»™å‡ºäº†é”™è¯¯è¡Œï¼Œä½†åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æŸ¥çœ‹äº†å®ƒçš„å¤–è§‚ï¼š <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/313/196/4de/3131964de8f3f5161678c44086ed2e40.png" alt="å›¾ç‰‡2"></div><br> æ­£æ˜¯å¯¹æ­¤ç±»é”™è¯¯çš„æ£€æµ‹è¯æ˜äº†é™æ€åˆ†æå·¥å…·çš„å¼ºå¤§åŠŸèƒ½å’Œæ— é™å…³æ³¨ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3095</a>åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨'currentForm'å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š3386ã€3404ã€‚Application.cs 3386 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunMessageLoopInner</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> reason, ApplicationContext context)</span></span></span><span class="hljs-function"> </span></span>{ .... hwndOwner = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandleRef( null, UnsafeNativeMethods.GetWindowLong( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandleRef(currentForm, currentForm.Handle), <span class="hljs-comment"><span class="hljs-comment">// &lt;= NativeMethods.GWL_HWNDPARENT)); .... if (currentForm != null &amp;&amp; ....) .... }</span></span></code> </pre> <br> ç»å…¸ç‰ˆ ä½¿ç”¨<i>currentForm</i>å˜é‡æ— éœ€ä»»ä½•æ£€æŸ¥ã€‚ ä½†æ˜¯åœ¨ä»£ç çš„æ›´æ·±å¤„ï¼Œå®ƒæ£€æŸ¥<i>ç©º</i>ç›¸ç­‰æ€§ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å»ºè®®æ‚¨åœ¨ä½¿ç”¨å¼•ç”¨ç±»å‹ä»¥åŠä½¿ç”¨é™æ€åˆ†æå™¨æ—¶è¦æ ¼å¤–å°å¿ƒï¼š)ã€‚ <br><br> å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3095</a>åœ¨å¯¹nullè¿›è¡ŒéªŒè¯ä¹‹å‰ï¼Œå·²ä½¿ç”¨â€œ backgroundBrushâ€å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š2331ï¼Œ2334ã€‚DataGrid.cs 2331 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Color BackgroundColor { .... <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value.Equals(backgroundBrush.Color)) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { if (backgroundBrush != null &amp;&amp; BackgroundBrush != DefaultBackgroundBrush) .... } } }</span></span></code> </pre> <br> åœ¨WinFormsä»£ç ä¸­ï¼Œæˆ‘é‡åˆ°äº†<b>60</b>å¤šä¸ªæ­¤ç±»é”™è¯¯ã€‚ æˆ‘è®¤ä¸ºï¼Œæ‰€æœ‰è¿™äº›éƒ½éå¸¸å…³é”®ï¼Œéœ€è¦å¼€å‘äººå‘˜çš„æ³¨æ„ã€‚ ä½†æ˜¯åœ¨æœ¬æ–‡ä¸­ï¼Œè°ˆè®ºå®ƒä»¬å¹¶ä¸æ˜¯é‚£ä¹ˆæœ‰è¶£ï¼Œå› æ­¤ï¼Œæˆ‘å°†åªé™äºä¸Šé¢è®¨è®ºçš„ä¸¤ä¸ªã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3125</a>å·²ä½¿ç”¨'_propInfo'å¯¹è±¡ï¼Œå¹¶åœ¨ä¸åŒçš„æ‰§è¡Œåˆ†æ”¯ä¸­é’ˆå¯¹nullå¯¹å…¶è¿›è¡Œäº†éªŒè¯ã€‚ æ£€æŸ¥è¡Œï¼š996ã€982ã€‚Binding.cs 996 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetPropValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(object value)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> .... <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_propInfo != null) .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _propInfo.SetValue(_control, value); } .... }</code> </pre> <br> è¦å®Œæˆå›¾ç‰‡ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§ç»å…¸çš„bug <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3125</a> ã€‚ ç›¸åçš„æƒ…å†µã€‚ é¦–å…ˆï¼Œå®‰å…¨åœ°ä½¿ç”¨å¯èƒ½ä¸ºnullçš„å¼•ç”¨ï¼Œæ£€æŸ¥æ˜¯å¦ä¸º<i>null</i> ï¼Œä½†éšåä»–ä»¬ä¸å†åœ¨ä»£ç ä¸­è¿™æ ·åšã€‚ <br><br> è¿˜æœ‰å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3125</a>åœ¨é’ˆå¯¹nullè¿›è¡ŒéªŒè¯ä¹‹åï¼Œä½¿ç”¨äº†â€œæ‰€æœ‰è€…â€å¯¹è±¡ã€‚ æ£€æŸ¥è¡Œï¼š64ï¼Œ60ã€‚FlatButtonAppearance.cs 64 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> BorderSize { .... <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (owner != null &amp;&amp; owner.ParentInternal != null) { LayoutTransaction.DoLayoutIf(....); } owner.Invalidate(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... } }</span></span></code> </pre> <br> ç¾äºº ä½†è¿™æ˜¯ä»å¤–éƒ¨ç ”ç©¶äººå‘˜çš„è§’åº¦æ¥çœ‹çš„ã€‚ å®é™…ä¸Šï¼Œé™¤äº†è¿™ä¸¤ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3125ä¹‹å¤–</a> ï¼Œåˆ†æå™¨è¿˜åœ¨WinFormsä»£ç ä¸­å‘ç°äº†<b>50å¤šä¸ª</b>ç±»ä¼¼çš„æ¨¡å¼ã€‚ å¼€å‘äººå‘˜æœ‰å·¥ä½œè¦åšã€‚ <br><br> æœ€åï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„é”™è¯¯ã€‚ <br><br>  PVS-Studioï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V3137</a>åˆ†é…äº†â€œ hCurrentFontâ€å˜é‡ï¼Œä½†è¯¥å˜é‡æœªåœ¨åŠŸèƒ½ç»“æŸæ—¶ä½¿ç”¨ã€‚  DeviceContext2.cs 241 <br><br><pre> <code class="cpp hljs">sealed partial <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeviceContext</span></span></span><span class="hljs-class"> :</span></span> .... { WindowsFont selectedFont; .... <span class="hljs-function"><span class="hljs-function">internal </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DisposeFont</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> disposing)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (disposing) { DeviceContexts.RemoveDeviceContext(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (selectedFont != null &amp;&amp; selectedFont.Hfont != IntPtr.Zero) { IntPtr hCurrentFont = IntUnsafeNativeMethods.GetCurrentObject( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HandleRef(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, hDC), IntNativeMethods.OBJ_FONT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hCurrentFont == selectedFont.Hfont) { <span class="hljs-comment"><span class="hljs-comment">// select initial font back in IntUnsafeNativeMethods.SelectObject(new HandleRef(this, Hdc), new HandleRef(null, hInitialFont)); hCurrentFont = hInitialFont; // &lt;= } selectedFont.Dispose(disposing); selectedFont = null; } } .... }</span></span></code> </pre> <br> è®©æˆ‘ä»¬çœ‹çœ‹åˆ†æå™¨è­¦å‘Šäº†ä»€ä¹ˆï¼Œä»¥åŠä¸ºä»€ä¹ˆä¸ºå˜é‡åˆ†é…äº†ä¸€ä¸ªå€¼ï¼Œä½†ä»¥ååœ¨è¯¥æ–¹æ³•ä¸­ä¸ä½¿ç”¨å®ƒçš„äº‹å®å¯èƒ½è¡¨æ˜å­˜åœ¨é—®é¢˜ã€‚ <br><br> åœ¨æ–‡ä»¶<i>DeviceContext2.csä¸­</i>å£°æ˜äº†éƒ¨åˆ†ç±»ã€‚  <i>DisposeFont</i>æ–¹æ³•ç”¨äºå¤„ç†å›¾å½¢åé‡Šæ”¾èµ„æºï¼šè®¾å¤‡ä¸Šä¸‹æ–‡å’Œå­—ä½“ã€‚ ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘æä¾›äº†æ•´ä¸ª<i>DisposeFont</i>æ–¹æ³•ã€‚ æ³¨æ„å±€éƒ¨å˜é‡<i>hCurrentFont</i> ã€‚ é—®é¢˜åœ¨äºï¼Œåœ¨æ–¹æ³•ä¸­å£°æ˜æ­¤å˜é‡å°†éšè—ç›¸åŒåç§°çš„ç±»å­—æ®µã€‚ æˆ‘å‘ç°<i>DeviceContext</i>ç±»çš„ä¸¤ä¸ªæ–¹æ³•<i>éƒ½ä½¿ç”¨</i>äº†ä¸€ä¸ªåä¸º<i>hCurrentFont</i>çš„<b>å­—æ®µ</b> ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SelectFont</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WindowsFont font)</span></span></span><span class="hljs-function"> </span></span>{ .... hCurrentFont = font.Hfont; .... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResetFont</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... hCurrentFont = hInitialFont; }</code> </pre> <br> çœ‹ä¸€ä¸‹<i>ResetFont</i>æ–¹æ³•ã€‚ æœ€åä¸€è¡Œæ­£æ˜¯<i>DisposeFont</i>æ–¹æ³•åœ¨åµŒå¥—<i>if</i>å—ä¸­<i>æ‰€åš</i>çš„æ“ä½œï¼ˆåˆ†æå™¨æŒ‡å‘æ­¤ä½ç½®ï¼‰ã€‚ åœ¨åŒä¸€ä¸ªåç§°çš„<i>hCurrentFont</i>å­—æ®µæ˜¯åœ¨<i>DeviceContext.cs</i>æ–‡ä»¶çš„éƒ¨åˆ†ç±»çš„å¦ä¸€éƒ¨åˆ†ä¸­<i>å£°æ˜çš„</i> ï¼š <br><br><pre> <code class="cpp hljs">sealed partial <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeviceContext</span></span></span><span class="hljs-class"> :</span></span> .... { .... IntPtr hInitialFont; .... IntPtr hCurrentFont; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br> å› æ­¤ï¼ŒçŠ¯äº†ä¸€ä¸ªæ˜æ˜¾çš„é”™è¯¯ã€‚ å¦ä¸€ä¸ªé—®é¢˜æ˜¯å®ƒçš„é‡è¦æ€§ã€‚ ç°åœ¨ï¼Œç”±äº<i>DisposeFont</i>æ–¹æ³•åœ¨æ ‡æœ‰â€œé€‰æ‹©è¿”å›åˆå§‹å­—ä½“â€æ³¨é‡Šçš„éƒ¨åˆ†ä¸­<i>èµ·ä½œç”¨</i> ï¼Œå› æ­¤<i>hCurrentFont</i>å­—æ®µå°†ä¸ä¼šè¢«åˆ†é…ä¸€äº›åˆå§‹å€¼ã€‚ æˆ‘è®¤ä¸ºåªæœ‰ä»£ç ä½œè€…æ‰èƒ½ç»™å‡ºç¡®åˆ‡çš„ç»“è®ºã€‚ <br><br>  <b>ç»“è®º</b> <br><br> å› æ­¤ï¼Œè¿™ä¸€æ¬¡æˆ‘ä¸å¾—ä¸â€œè´£éª‚â€ MSã€‚ åœ¨WinFormsä¸­ï¼Œå­˜åœ¨è®¸å¤šé”™è¯¯ï¼Œéœ€è¦å¼€å‘äººå‘˜å¯†åˆ‡æ³¨æ„ã€‚ ä¹Ÿè®¸è¿™æ˜¯ç”±äºMSåœ¨.NET Core 3å’ŒåŒ…æ‹¬WinFormsåœ¨å†…çš„ç»„ä»¶ä¸ŠåŒ†å¿™å·¥ä½œæ‰€è‡´ã€‚ æˆ‘è®¤ä¸ºWinFormsä»£ç ä»ç„¶â€œæ½®æ¹¿â€ï¼Œä½†æˆ‘å¸Œæœ›æƒ…å†µä¼šå¾ˆå¿«å¥½è½¬ã€‚ <br><br> å‡ºç°å¤§é‡é”™è¯¯çš„ç¬¬äºŒä¸ªåŸå› å¯èƒ½æ˜¯æˆ‘ä»¬çš„åˆ†æä»ªæ›´å¥½åœ°å¯»æ‰¾äº†å®ƒä»¬ï¼š)ã€‚ <br><br> é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘çš„åŒäº‹Sergey Vasilievçš„ä¸€ç¯‡æ–‡ç« å¾ˆå¿«å°±ä¼šå‘è¡¨ï¼Œä»–åœ¨å…¶ä¸­æœç´¢å¹¶å‘ç°äº†.NET Coreåº“ä»£ç ä¸­çš„è®¸å¤šé—®é¢˜ã€‚ æˆ‘å¸Œæœ›ä»–çš„å·¥ä½œä¹Ÿå°†æœ‰åŠ©äºæ”¹å–„.NETå¹³å°çš„æ€§èƒ½ï¼Œå› ä¸ºæˆ‘ä»¬å§‹ç»ˆå°è¯•å°†å¼€å‘äººå‘˜çš„é¡¹ç›®åˆ†æç»“æœä¼ è¾¾ç»™å¼€å‘äººå‘˜ã€‚ <br><br> å¥½å§ï¼Œå¯¹äºé‚£äº›æƒ³è¦è‡ªå·±æ”¹è¿›äº§å“æˆ–è¿›è¡Œç ”ç©¶ä»¥å‘ç°ä»–äººé¡¹ç›®ä¸­çš„é”™è¯¯çš„äººï¼Œæˆ‘å»ºè®®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸‹è½½å¹¶å°è¯•ä½¿ç”¨</a> PVS-Studioã€‚ <br><br> æ‰€æœ‰å¹²å‡€çš„ä»£ç ï¼ <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br> å¦‚æœæ‚¨æƒ³ä¸è®²è‹±è¯­çš„è¯»è€…åˆ†äº«è¿™ç¯‡æ–‡ç« ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹é“¾æ¥ï¼šSergey Khrenovã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WinFormsï¼šé”™è¯¯ï¼Œç¦å°”æ‘©æ–¯</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN462807/">https://habr.com/ru/post/zh-CN462807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN462797/index.html">å…³äºäº‘ï¼Œä¸ä»…æ˜¯ä¸“ä¸šäººå£«</a></li>
<li><a href="../zh-CN462799/index.html">RAVISå’ŒDABçš„èµ·æ­¥è¾ƒä½ã€‚ DRMå†’çŠ¯äº†ã€‚ ä¿„ç½—æ–¯è”é‚¦æ•°å­—å¹¿æ’­çš„å¥‡å¼‚æœªæ¥</a></li>
<li><a href="../zh-CN462801/index.html">2019å¹´15ç§äº§å“ç»ç†å¿…å¤‡å·¥å…·</a></li>
<li><a href="../zh-CN462803/index.html">ä»ä¸€ä¸ªERPç³»ç»Ÿè¿ç§»åˆ°å¦ä¸€ä¸ª</a></li>
<li><a href="../zh-CN462805/index.html">åˆ†æï¼šåœ¨äº¤æ˜“æ‰€äº¤æ˜“æ—¶å¦‚ä½•å®é™…ä¿æŠ¤è´§å¸</a></li>
<li><a href="../zh-CN462809/index.html">WinFormsï¼šé”™è¯¯ï¼Œç¦å°”æ‘©æ–¯</a></li>
<li><a href="../zh-CN462811/index.html">ä¸ºä»€ä¹ˆåœ¨Goä¸­éœ€è¦æ³›å‹ï¼Ÿ</a></li>
<li><a href="../zh-CN462813/index.html">å¶å¡æ·ç³å ¡ï¼Œ8æœˆ14æ—¥-Atlassian User Group mitap</a></li>
<li><a href="../zh-CN462817/index.html">Kotlin / EverywhereæŠ¥å‘Š-å±•ç¤ºå®è·µï¼š7æœˆ31æ—¥</a></li>
<li><a href="../zh-CN462819/index.html">ç‹¬è”ä½“è¯­è¨€æ•™è‚²çš„ä¸è¶³ï¼šå¤šè§’åº¦çš„çœ‹æ³•</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>