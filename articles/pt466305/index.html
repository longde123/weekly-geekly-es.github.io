<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçá üë©üèº‚Äçü§ù‚Äçüë©üèª üôÖüèæ Takashi Kokubun: como fazer com que os aplicativos Ruby sejam executados mais rapidamente üõèÔ∏è üßëüèæ‚Äçü§ù‚ÄçüßëüèΩ üêù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A Confer√™ncia Central da R√∫ssia em Ruby, em 28 de setembro, marca 10 anos. Este ano, o RubyRussia tem um novo local, com at√© 4 fluxos de relat√≥rios se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Takashi Kokubun: como fazer com que os aplicativos Ruby sejam executados mais rapidamente</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/railsclub/blog/466305/"> A Confer√™ncia Central da R√∫ssia em Ruby, em 28 de setembro, marca 10 anos.  Este ano, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RubyRussia tem um</a> novo local, com at√© 4 fluxos de relat√≥rios selecionados, comunica√ß√£o e, claro, a lend√°ria p√≥s-festa!  Entre os palestrantes est√£o Yukihiro Matsumoto, Takashi Kokubun, Xavier Noria, Nick Sutterer, Genadi Samokovarov e muito mais! <br><br>  Em prepara√ß√£o, conversamos com palestrantes sobre Ruby, trabalho e vida.  Hoje publicamos material em que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dmitry Matveyev</a> (gerente de projetos em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Evrone</a> ) faz perguntas a <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Takashi Kokubun</a></b> . <br><br><img src="https://habrastorage.org/webt/ld/5d/ea/ld5deappknbod3tlj0kruqrj9d8.jpeg" alt="imagem"><br>  <i>O palestrante RubyRussia 2019, um otimizador para o compilador Ruby JIT, suporta Haml e ERB, um engenheiro de back-end da ArmTreasure Data.</i> <br><a name="habracut"></a><br>  <b>Diga-me o que ser√° discutido no seu relat√≥rio na confer√™ncia?</b> <br><br>  Sobre o trabalho no compilador JIT.  Eu gostaria de focar em tr√™s pontos.  A primeira √© a fun√ß√£o embutida.  A fun√ß√£o deve estar "limpa", sem efeitos colaterais, para que seu corpo possa estar alinhado.  Se houver muitas fun√ß√µes, o compilador come√ßar√° a funcionar lentamente.  Vou descrever como resolver esse problema. <br>  O segundo ponto diz respeito √† otimiza√ß√£o do posicionamento de objetos na mem√≥ria.  Em aplicativos grandes e complexos como o Rails, voc√™ precisa criar muitos objetos em uma solicita√ß√£o.  Se voc√™ otimizar esse processo, poder√° melhorar o desempenho.  Geralmente, os objetos s√£o criados na pilha.  Portanto, voc√™ precisa gerenciar estruturas de dados complexas.  Voc√™ tamb√©m precisa chamar o coletor de lixo para remover objetos n√£o utilizados.  E se colocarmos objetos na pilha, simplesmente aumentar√≠amos o ponteiro da pilha ao adicionar um objeto e diminuir√≠amos quando o objeto precisar ser exclu√≠do.  O uso da pilha para armazenar objetos √© mais r√°pido por si s√≥, al√©m do coletor de lixo come√ßar a funcionar mais rapidamente.  Mas, para usar a pilha, precisamos garantir que os objetos n√£o sejam usados ‚Äã‚Äãem outros lugares.  Para esse fim, usamos uma t√©cnica chamada "an√°lise de escape".  Precisamos analisar cada m√©todo e garantir que cada um de seus objetos internos n√£o seja usado externamente e n√£o seja retornado como resultado do m√©todo atual.  Se pudermos fazer isso, podemos colocar objetos na pilha, e isso aumentar√° a produtividade.  Minha id√©ia √© adicionar metadados para obter instru√ß√µes.  Agora, isso √© um experimento, mas vou fazer uma solicita√ß√£o para o mestre com esse c√≥digo em um futuro pr√≥ximo. <br><br>  O terceiro ponto √© sobre a otimiza√ß√£o do envio de chamadas de fun√ß√£o no JIT.  Atualmente, esse processo gera uma forte ramifica√ß√£o da l√≥gica, o que afeta adversamente o mecanismo de previs√£o de ramifica√ß√£o do processador.  Isso diminui a velocidade do processador como um todo.  Precisamos simplificar essa l√≥gica, ou seja, reduzir o n√∫mero de condi√ß√µes.  Atualmente, estou explorando como fazer isso. <br><br>  <b>Este √© um relat√≥rio grave, com muitos c√≥digos e conceitos!</b>  <b>Parece ser dif√≠cil?</b> <br><br>  Eu acho que a maioria das pessoas n√£o implementa compiladores por conta pr√≥pria, e eu entendo que isso pode ser dif√≠cil.  Mas tentarei explicar tudo da maneira mais simples poss√≠vel com exemplos e ilustra√ß√µes.  Ou seja, meu relat√≥rio deve ser compreens√≠vel para pessoas sem experi√™ncia especial no desenvolvimento de compiladores. <br><br>  <b>√â poss√≠vel usar o novo compilador na produ√ß√£o agora e em quais casos?</b> <br><br>  A id√©ia √© fazer com que os aplicativos RoR sejam executados mais rapidamente.  Por exemplo, minha empresa atual se beneficiar√° disso.  Mas eu n√£o diria que tudo est√° pronto para produ√ß√£o.  Acontece que apenas os aplicativos RoR n√£o s√£o particularmente acelerados.  Isso ocorre porque esses aplicativos geralmente s√£o grandes e geram muito c√≥digo C, o que leva ao uso ineficiente do armazenamento em cache no processador.  Eu tenho algumas id√©ias sobre como corrigir isso.  √â nisso que estou trabalhando agora.  Mas agora meu compilador pode ser √∫til para pequenas aplica√ß√µes.  Por exemplo, eu sei que a gema karafka trabalha mais r√°pido com ela do que sem ela. <br><br>  <b>Eu li que o compilador JIT j√° foi derramado no mestre do brunch de linguagem Ruby e est√° dispon√≠vel desde a vers√£o 2.6.</b>  <b>√â isso mesmo?</b> <br><br>  Sim, minha solicita√ß√£o de mesclagem j√° foi aceita.  Mas esta √© a primeira vers√£o e ainda h√° muito trabalho a ser feito.  As melhorias j√° estar√£o no Ruby 2.7 e ainda mais no Ruby 3. <br><br>  <b>Diga-me como voc√™ come√ßou a escrever em Ruby?</b> <br><br>  No come√ßo, trabalhei com o Objective-C, mas n√£o gostei muito.  Era necess√°rio escrever um aplicativo de back-end e os amigos recomendaram o Ruby On Rails.  Fiz exatamente isso - e fiquei muito satisfeito com o resultado!  Gostei da sintaxe simples e compreens√≠vel da linguagem e comecei a estud√°-la e a us√°-la mais profundamente. <br><br>  <b>Voc√™ est√° escrevendo Ruby no trabalho agora?</b> <br><br>  Estive na Treasure Data nos √∫ltimos dois anos.  √â uma plataforma que rastreia dados do usu√°rio em aplicativos clientes.  Este projeto foi originalmente escrito em Ruby On Rails, e meu post foi chamado "Desenvolvedor Ruby".  Ent√£o eu escrevi muito em Ruby.  Mas agora estou trabalhando em alguns servi√ßos distribu√≠dos escritos em Java e Kotlin, e √†s vezes tamb√©m uso Python. <br><br>  <b>O projeto Treasure Data est√° associado a alta carga e big data.</b>  <b>Mas Ruby n√£o √© o idioma mais r√°pido.</b>  <b>Como voc√™ conseguiu criar um aplicativo de alta carga que funciona com big data na plataforma RoR?</b> <br><br>  O aplicativo registra os dados do usu√°rio e os salva no armazenamento.  Ele tamb√©m fornece uma interface para consultar dados em idiomas como Hive e Presto, e um painel de administra√ß√£o.  N√£o foi um problema escrever tudo sobre trilhos.  Al√©m disso, criamos uma infraestrutura competente e temos a capacidade de aumentar os recursos de mem√≥ria e processador em picos de carga.  O principal problema que temos com o Ruby √© que ele n√£o √© adequado para computa√ß√£o paralela.  E temos que usar o Kotlin para esse fim. <br><br>  <b>Por que voc√™ ama Ruby?</b>  <b>Se houvesse um projeto que pudesse ser implementado no Ruby e no Python, qual deles voc√™ escolheria?</b> <br><br>  Eu gosto da sintaxe limpa do Ruby, √© muito leg√≠vel e intuitiva.  Isso permite que voc√™ escreva com rapidez e facilidade a l√≥gica do aplicativo, o que √© importante do ponto de vista comercial.  Esta √© uma linguagem puramente objetiva, eu realmente aprecio isso.  Tenho experi√™ncia em Python, mas isso n√£o me parece t√£o intuitivo.  Eu o escolheria apenas para projetos de aprendizado de m√°quina. <br><br>  <b>Outra coisa em que voc√™ est√° trabalhando ultimamente √© o mecanismo de modelo Haml ...</b> <br><br>  Eu trabalhei em Haml e ERB em um trabalho anterior.  Agora, n√£o dedico muito tempo a isso, mas √†s vezes olho para as pull-quests nesses projetos. <br><br>  <b>O que voc√™ acha das perspectivas de mecanismos de modelo como Haml, Slim ou ERB, em geral, dado que no mundo moderno h√° uma tend√™ncia de separar completamente a parte traseira e a frente em dois aplicativos diferentes e fornecer a forma√ß√£o de p√°ginas HTML completamente ao JavaScript?</b>  <b>Ou seja, nessa configura√ß√£o, os mecanismos de modelo se tornam completamente desnecess√°rios?</b> <br><br>  Concordo que, para tarefas com uma interface de usu√°rio complexa, faz sentido colocar essa l√≥gica em um aplicativo separado.  Isso precisa ser feito para competir com outras empresas, que est√£o aumentando cada vez mais a complexidade e a funcionalidade da interface do usu√°rio.  Mas ainda h√° necessidade de solu√ß√µes mais simples e, mais importante, mais baratas que fa√ßam sentido escrever no RoR com mecanismos de modelo cl√°ssicos.  Assim, eles ainda est√£o em opera√ß√£o e ser√£o utilizados por um longo tempo. <br><br>  <b>Vejo que voc√™ pode programar em v√°rias linguagens, pelo menos em Ruby, Python, Java, Kotlin e C. Um bom conjunto.</b>  <b>Voc√™ pode dar conselhos aos iniciantes sobre como aprender tantas l√≠nguas?</b>  <b>Como se tornar um bom programador?</b> <br><br>  Eu acho que a efic√°cia do treinamento ser√° alta quando o idioma for adequado para as tarefas que um programador enfrenta.  O Ruby √© bom para escrever aplicativos da Web, porque trabalhar com strings √© muito f√°cil se comparado ao Java.  O Python √© mais adequado para aprendizado de m√°quina (possui uma rica infraestrutura nessa √°rea).  Se voc√™ quiser aprender Python, eu recomendaria resolver tarefas de aprendizado de m√°quina em vez de escrever aplicativos da Web.  Se voc√™ estiver mais interessado em Java, Kotlin ou outras linguagens baseadas em JVM, sugiro escrever sistemas distribu√≠dos.  Atualmente, o Ruby n√£o √© adequado para computa√ß√£o paralela ou exigente.  Para resolver esses problemas no Ruby, precisamos de muitos processos que consomem muitos recursos, para que n√£o sejam eficazes.  Assim, o uso de ferramentas apropriadas para problemas relevantes ajudar√° a entender por que essa ferramenta foi projetada dessa maneira.  Isso ajudar√° a entender melhor sua ess√™ncia. <br><br>  <b>Quais livros est√£o no topo de sua "classifica√ß√£o" pessoal?</b> <br><br>  O primeiro √© Ruby sob um microsc√≥pio.  Est√° escrito de maneira muito simples e descreve os detalhes do int√©rprete.  Uma compreens√£o profunda de como o int√©rprete funciona ajudar√° a resolver problemas complexos e tamb√©m aumentar√° a confian√ßa na propriedade da ferramenta, ou seja,  l√≠ngua.  Eu recomendo este livro mesmo para iniciantes. <br><br>  O segundo √© "C√≥digo leg√≠vel".  √â sobre como escrever c√≥digo claro, por incr√≠vel que pare√ßa :).  N√≥s escrevemos muito c√≥digo e lemos muito c√≥digo, e devemos ser capazes de escrever c√≥digo que outras pessoas entender√£o.  E para isso, precisamos olhar o c√≥digo do √¢ngulo da percep√ß√£o de outra pessoa.  Livros como este ajudam.  Eu tamb√©m recomendo mesmo para iniciantes.  Bem, o terceiro livro ... Este √© um livro em japon√™s, sobre como o processador √© organizado, sobre sua arquitetura, at√© os transistores dos quais ele √© composto.  Compreender como um computador funciona em um n√≠vel t√£o baixo √†s vezes √© muito √∫til, mesmo quando se resolve problemas em n√≠veis muito mais altos.  Eu recomendo a leitura de qualquer bom livro sobre design de microprocessador, mesmo que √† primeira vista isso pare√ßa √≥bvio. <br><br>  <b>O que voc√™ espera da R√∫ssia e da confer√™ncia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RubyRussia</a></b> ? <br><br>  Eu nunca estive na R√∫ssia antes.  Espero ver muito de tudo bonito, por exemplo, belas casas, belas paisagens ... Al√©m disso, deve ser mais frio na R√∫ssia do que no Jap√£o.  Ser√° interessante para mim ver e sentir todas essas diferen√ßas entre nossos pa√≠ses. <br><br>  <b>Legal!</b>  <b>Posso garantir que, mesmo que fa√ßa frio (na verdade, no final de setembro, n√£o faz tanto frio conosco), a confer√™ncia e a festa ser√£o quentes de qualquer maneira!</b> <br><br>  Tamb√©m estamos esperando por voc√™ na confer√™ncia!  Voc√™ pode fazer suas perguntas pessoalmente (e no lend√°rio p√≥s-festa :) em 28 de setembro.  O programa est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> , e o bilhete agora custa 9.000 rublos. <br><br>  Gra√ßas √†s empresas que suportam o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RubyRussia</a> : <br><br>  Organizador - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Evrone</a> <br>  Parceiro Geral - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Toptal</a> <br>  Parceiro Gold - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gett</a> <br>  Parceiros Silver - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">JetBrains</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bookmate</a> <br>  Parceiro Bronze - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">InSales</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466305/">https://habr.com/ru/post/pt466305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466289/index.html">Iniciativas legislativas. Estranho, mas apresentado √† Duma do Estado</a></li>
<li><a href="../pt466291/index.html">Pesquisa de Sustentabilidade dos Segmentos Nacionais da Internet para 2019</a></li>
<li><a href="../pt466295/index.html">Cache de reserva indolor no Scala</a></li>
<li><a href="../pt466299/index.html">Soci√≥logos russos realizaram a primeira pesquisa de chatbots do mundo</a></li>
<li><a href="../pt466301/index.html">Outra coisa: pacotes de aplicativos Haiku?</a></li>
<li><a href="../pt466307/index.html">Como fa√ßo para projetar o SCS</a></li>
<li><a href="../pt466311/index.html">Workshop SLS 6 de setembro</a></li>
<li><a href="../pt466315/index.html">@Pythonetc compila√ß√£o, agosto 2019</a></li>
<li><a href="../pt466317/index.html">Dicas e truques do meu canal de telegrama @pythonetc, agosto de 2019</a></li>
<li><a href="../pt466319/index.html">Acordo: VMware compra startup baseada na nuvem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>