<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêÑ üåßÔ∏è üçä 5. Introdu√ß√£o ao Fortinet v6.0. NAT üßÄ üå©Ô∏è ‚ú®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sauda√ß√µes! Bem-vindo √† quinta li√ß√£o da Fortinet Getting Started . Na √∫ltima li√ß√£o, descobrimos como as pol√≠ticas de seguran√ßa funcionam. Agora √© hora ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>5. Introdu√ß√£o ao Fortinet v6.0. NAT</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/484072/"><img src="https://habrastorage.org/webt/zp/hu/i4/zphui4qn8xzxkrnibtvd4j44noq.png"><br><br>  Sauda√ß√µes!  Bem-vindo √† quinta li√ß√£o da <a href="https://fortiservice.com/news/fortinet-getting-started-vvedenie/">Fortinet Getting Started</a> .  Na <a href="https://habr.com/ru/company/tssolution/blog/481882/">√∫ltima li√ß√£o,</a> descobrimos como as pol√≠ticas de seguran√ßa funcionam.  Agora √© hora de liberar usu√°rios locais na Internet.  Para fazer isso, nesta li√ß√£o, veremos como o mecanismo NAT funciona. <br>  Al√©m de liberar usu√°rios para a Internet, tamb√©m consideraremos o m√©todo de publica√ß√£o de servi√ßos internos.  Sob o gato, √© apresentada uma breve teoria do v√≠deo, bem como a pr√≥pria li√ß√£o em v√≠deo. <a name="habracut"></a><br>  A convers√£o de endere√ßos de rede (NAT) √© um mecanismo para converter endere√ßos IP de pacotes de rede.  Em termos de Fortinet NAT, ele √© dividido em dois tipos: NAT de origem e NAT de destino. <br><br>  Os nomes falam por si - ao usar o NAT de origem, o endere√ßo da fonte muda, ao usar o NAT de destino, o endere√ßo de destino. <br><br>  Al√©m disso, tamb√©m existem v√°rias op√ß√µes de configura√ß√£o de NAT - NAT de pol√≠tica de firewall e NAT central. <br><br><img src="https://habrastorage.org/webt/wd/xo/bg/wdxobgt4wt5bshbcblbnwjo_pd8.png"><br><br>  Ao usar a primeira op√ß√£o, o NAT de origem e destino deve ser configurado para cada pol√≠tica de seguran√ßa.  Nesse caso, o NAT de origem usa o endere√ßo IP da interface de sa√≠da ou o pool de IP pr√©-configurado.  O NAT de destino usa um objeto pr√©-configurado (chamado VIP - IP virtual) como o endere√ßo de destino. <br><br>  Ao usar o NAT Central, a configura√ß√£o do NAT de Origem e Destino √© realizada imediatamente para todo o dispositivo (ou dom√≠nio virtual).  Nesse caso, as configura√ß√µes de NAT se aplicam a todas as pol√≠ticas, dependendo das regras de NAT de origem e NAT de destino. <br><br>  As regras NAT de origem s√£o configuradas na pol√≠tica central de NAT de origem.  O NAT de destino √© configurado no menu DNAT usando endere√ßos IP. <br><br>  Nesta li√ß√£o, consideraremos apenas o NAT da pol√≠tica de firewall - como mostra a pr√°tica, esta op√ß√£o de configura√ß√£o √© muito mais comum que o NAT central. <br><br>  Como eu j√° disse, ao configurar o NAT da fonte de diretiva de firewall, existem duas op√ß√µes de configura√ß√£o: substituir o endere√ßo IP pelo endere√ßo da interface de sa√≠da ou pelo endere√ßo IP do pool de endere√ßos IP pr√©-configurado.  Parece algo como a imagem abaixo.  A seguir, falarei brevemente sobre poss√≠veis pools, mas, na pr√°tica, consideraremos apenas a op√ß√£o com o endere√ßo da interface de sa√≠da - em nosso layout, n√£o precisamos de pools de endere√ßos IP. <br><br><img src="https://habrastorage.org/webt/wc/yf/_w/wcyf_w3n-tloy66twrczoj7mlle.png"><br><br>  O pool de IPs define um ou mais endere√ßos IP que ser√£o usados ‚Äã‚Äãcomo o endere√ßo de origem durante a sess√£o.  Esses endere√ßos IP ser√£o usados ‚Äã‚Äãno lugar do endere√ßo IP da interface FortiGate de sa√≠da. <br><br>  Existem 4 tipos de conjuntos de IPs que podem ser configurados no FortiGate: <br><br><ul><li>  Sobrecarga </li><li>  Um para um </li><li>  Faixa de porta fixa </li><li>  Aloca√ß√£o de bloco de porta </li></ul><br>  Sobrecarga √© o principal pool de IPs.  Nele, os endere√ßos IP s√£o convertidos de acordo com o esquema muitos para um ou muitos para v√°rios.  A tradu√ß√£o de porta tamb√©m √© usada.  Considere o circuito mostrado na figura abaixo.  Temos um pacote com certos campos Origem e Destino.  Se ele se enquadra em uma pol√≠tica de firewall que permite que esse pacote acesse uma rede externa, a regra NAT √© aplicada a ela.  Como resultado, neste pacote, o campo Origem √© substitu√≠do por um dos endere√ßos IP especificados no pool de IPs. <br><br><img src="https://habrastorage.org/webt/8z/i1/af/8zi1afghepy-mwhlpbyar_hqcqy.png"><br><br>  Um pool do tipo One to One tamb√©m define muitos endere√ßos IP externos.  Quando um pacote se enquadra em uma pol√≠tica de firewall com a regra NAT ativada, o endere√ßo IP no campo Origem √© alterado para um dos endere√ßos pertencentes a esse pool.  A substitui√ß√£o ocorre de acordo com a regra - ‚Äúprimeiro a entrar, primeiro a ser servido‚Äù.  Para tornar mais claro, considere um exemplo. <br><br>  Um computador da rede local com o endere√ßo IP 192.168.1.25 envia o pacote para a rede externa.  Ele se enquadra na regra NAT e o campo Source √© alterado para o primeiro endere√ßo IP do pool; no nosso caso, √© 83.235.123.5.  Vale ressaltar que, ao usar esse pool de IPs, a convers√£o de portas n√£o √© usada.  Se depois que um computador da mesma rede local com um endere√ßo, por exemplo, 192.168.1.35 enviar um pacote para uma rede externa e tamb√©m se enquadrar nessa regra NAT, o endere√ßo IP no campo Origem deste pacote ser√° alterado para 83.235.123.6.  Se n√£o houver mais endere√ßos no pool, as conex√µes subseq√ºentes ser√£o rejeitadas.  Ou seja, nesse caso, sob nossa regra de NAT, 4 computadores podem cair simultaneamente. <br><br><img src="https://habrastorage.org/webt/ay/s2/6k/ays26khdzqemcgga0ouwn-7ejxg.png"><br><br>  FIxed Port Range conecta intervalos internos e externos de endere√ßos IP.  A tradu√ß√£o de porta tamb√©m est√° desativada.  Isso permite corrigir o in√≠cio ou o final do pool de endere√ßos IP internos com o in√≠cio ou o final do pool de endere√ßos IP externos.  No exemplo abaixo, o conjunto de endere√ßos interno 192.168.1.25 - 192.168.1.28 √© mapeado para o conjunto de endere√ßos externo 83.235.123.5 - 83.235.125.8. <br><br><img src="https://habrastorage.org/webt/3h/hn/l8/3hhnl8bdcl7wmalr2dqj_dz1gl4.png"><br><br>  Aloca√ß√£o de bloco de portas - esse pool de IPs √© usado para alocar um bloco de portas para os usu√°rios do pool de IPs.  Al√©m do pr√≥prio pool de IP, dois par√¢metros tamb√©m devem ser indicados aqui - o tamanho do bloco e o n√∫mero de blocos alocados para cada usu√°rio. <br><br><img src="https://habrastorage.org/webt/js/jm/dg/jsjmdg6atbpwe_tgv9bqswkshxo.png"><br><br>  Agora considere a tecnologia do NAT de destino.  √â baseado em endere√ßos IP virtuais (VIP).  Para pacotes que se enquadram nas regras NAT de destino, o endere√ßo IP no campo Destino √© alterado: geralmente o endere√ßo p√∫blico da Internet √© alterado para o endere√ßo do servidor privado.  Os endere√ßos IP virtuais s√£o usados ‚Äã‚Äãnas pol√≠ticas de firewall como o campo Destino. <br><br>  O tipo padr√£o de endere√ßo IP virtual √© NAT est√°tico.  Essa correspond√™ncia de endere√ßos externos e internos √© de um para um. <br><br>  Em vez do NAT est√°tico, os endere√ßos virtuais podem ser limitados ao encaminhamento de portas espec√≠ficas.  Por exemplo, associe conex√µes a um endere√ßo externo na porta 8080 com uma conex√£o a um endere√ßo IP interno na porta 80. <br><br>  No exemplo abaixo, o computador com o endere√ßo 172.17.10.25 est√° tentando acessar o endere√ßo 83.235.123.20 na porta 80.  Esta conex√£o est√° sujeita √† regra DNAT, portanto, o endere√ßo IP de destino √© alterado para 10.10.10.10. <br><br><img src="https://habrastorage.org/webt/ps/fa/17/psfa17kfl1nfpqa5qbbkw_a3sow.png"><br><br>  O v√≠deo discute a teoria e fornece exemplos pr√°ticos de configura√ß√£o do NAT de origem e destino. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/oQrHyhPpIHo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Na pr√≥xima li√ß√£o, passaremos a garantir a seguran√ßa do usu√°rio na Internet.  Especificamente, na pr√≥xima li√ß√£o, consideraremos a funcionalidade de filtragem da Web e controle de aplicativos.  Para n√£o perder, fique atento √†s atualiza√ß√µes nos seguintes canais: <br><br>  <a href="https://www.youtube.com/channel/UCKOESE8nBWQPuQmi994_YMA">Youtube</a> <br>  <a href="https://vk.com/fortiservice">Grupo VKontakte</a> <br>  <a href="https://zen.yandex.ru/id/5c7d2162fa818600ae386a52">Yandex Zen</a> <br>  <a href="https://fortiservice.com/">Nosso site</a> <br>  <a href="https://www.t.me/tssolution">Canal de telegrama</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484072/">https://habr.com/ru/post/pt484072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484062/index.html">Aprendendo ingl√™s com MEMASICS</a></li>
<li><a href="../pt484064/index.html">Como preparar um jogo para localiza√ß√£o? 10 Regras B√°sicas</a></li>
<li><a href="../pt484066/index.html">Dinheiro vs equipe. N√£o s√£o os aspectos mais √≥bvios do relacionamento de empreendedores, fundadores e investidores</a></li>
<li><a href="../pt484068/index.html">gRPC como um protocolo de comunica√ß√£o entre servi√ßos. Relat√≥rio Yandex</a></li>
<li><a href="../pt484070/index.html">Como escrevemos um sistema antifraude em quatro m√£os e tr√™s cabe√ßas</a></li>
<li><a href="../pt484076/index.html">Onde armazenar criptomoedas: tributa√ß√£o de criptomoedas em diferentes pa√≠ses</a></li>
<li><a href="../pt484084/index.html">1C-Bitrix e uma tentativa de introduzi-lo</a></li>
<li><a href="../pt484088/index.html">Desfile de senhas (an√°lise de ~ 5 bilh√µes de senhas devido a vazamentos)</a></li>
<li><a href="../pt484090/index.html">Nova infraestrutura de TI para o russo Post Data Center</a></li>
<li><a href="../pt484092/index.html">Pr√≠ncipes e nobres um tanto vestidos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>