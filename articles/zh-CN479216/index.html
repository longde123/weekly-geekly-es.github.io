<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈯️ 👩🏾‍🤝‍👨🏼 🐀 第二次风Pandora DXL 3000或我如何固定自己的遥测 👩🏼‍🎨 📛 🖖🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="也许熟悉的情况使我开发了自己的遥测仪-它起作用了，但后来停了下来。 一个晚上，汽车警报器停止感知钥匙扣。 我了解到，首先您需要尝试重新绑定钥匙扣，为此有必要执行一个简单的过程，显然要遵循安装手册中的说明。 由于汽车警报器处于布防模式，因此无法执行该过程，可以通过输入服务代码通过代客按钮禁用该警报。 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>第二次风Pandora DXL 3000或我如何固定自己的遥测</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479216/"> 也许熟悉的情况使我开发了自己的遥测仪-它起作用了，但后来停了下来。 一个晚上，汽车警报器停止感知钥匙扣。 我了解到，首先您需要尝试重新绑定钥匙扣，为此有必要执行一个简单的过程，显然要遵循安装手册中的说明。 由于汽车警报器处于布防模式，因此无法执行该过程，可以通过输入服务代码通过代客按钮禁用该警报。 <br><br> 我从来没有想过要记住服务代码，甚至还记得主代码。 我尝试重新调用几个用于内存的代码未成功。 几分钟之内，我不得不偷了我的车。 由于警报器安装在乘客车厢中，因此在我耳边的警报器发出的颤音持续了很长时间。 我不记得为什么我将警笛准确地放在那儿了-要么是出于自己的懒惰，要么是出于某种意义。 您知道，从个人的亲身经历来看，这可能会导致措手不及的小人严重困惑。 令我深感遗憾的是，我不得不拆除了该部门。 我开始弄清楚下一步该怎么做。 谁在乎最后发生了什么，我要一只猫。 <br><a name="habracut"></a><br> 我有几个假设： <br><br><ol><li> 天线模块的操作失败。 </li><li> 主块中的非易失性存储器故障。 结果，可能会损坏有关智能钥匙及其同步的数据。 </li><li> 变送器的非易失性存储器故障。 结果与第2段相似。 </li><li> 信号阻塞，为盗窃做准备。 </li></ol><br> 我搬到安全地点后，立即检查是否存在信号干扰器。 汽车警报器也没有对智能钥匙做出反应。 <br><br> 我向经销商询问了这些产品的可用性。 重置服务代码的能力。 有人告诉我，没有这样的机会，你将不得不购买几千卢布的新工具包。 是的，如果您与我们一起完成所有这些业务，那就更好了-他们说，会多捐几千美元。 恕我直言，这个答案一点也没让我感到惊讶！ 对于经销商而言，销售新套件要比进行售后服务更好。 然后突然间，我感到自己的情绪得到了极大的改善，产生了自己解决问题的想法，并一路摸索是否可以重置代码。 通常，正是这些时刻提示了替代方案，逆向，发展和DIY。 我挑战了自己。 <br><br> 我根本不是从挖掘块开始，而是从另一种方法开始。 当潘多拉（Pandora）躺在壁橱里时，我试图制作自己的模块。 我认为，如果您开发自己的汽车警报模块，它将立即变得凉爽，可靠，灵活并且绝对不会困难。 我能说的是，这全是热情。 我花了几周时间编写固件并对该模块进行原型设计。 这个过程是完全创造性的。 因此，突然间，一个主意出现了，我很高兴地意识到了这一点。 例如，在已经具备必要的线轴，晶体管和GSM的工作原型阶段，我突然想添加更多的GPS和蓝牙。 好吧，为什么要拉猫的尾巴呢？ 正如我最初想像的那样，让模块立即变凉，由于ATMega328只有一个UART端口，因此我不得不将微控制器更改为粗体。 从AVR和三个UART获得一些共同点对我来说似乎是不切实际的。 我不喜欢实现软件UART的选项，原因很简单，因为硬件更可靠。 我记得STM32在各种电子方面的文章中已经充满力量和主力，如何在AliExpress上订购。 我毫不犹豫地给自己写了一对STM32F103，因为它是一个真正的32位微控制器，具有大量的内存和丰富的外设，甚至具有必要数量的UART。 当时我没有编程STM32的经验，但这只是引起了学习新知识的兴趣。 <br><br> 考虑到微控制器的到来，决定推迟原型，而不仅仅是等待，而是检查仍然存在的假设。 <br><br> 冬天快到了，没有“监督”功能的汽车在某种程度上没有激发舒适感。 一切一直持续到我看了汽车防盗器的盖子。 在里面，我发现了ATMega324！ 我的快乐无止境，因为它是AVR，这意味着您可以正确使用它。 我做的第一件事是检查UART和SPI接线。  ATMega324具有2个UART端口。 一个UART连接到移位寄存器，第二个UART连接到天线模块连接器。  SPI电路将我引到一块未焊接的电路板上（在电路板左下角的石英附近的照片中）。 <br><br><img src="https://habrastorage.org/webt/1t/u9/el/1tu9el_7ehmsadjvf5nd8qhwrjg.jpeg"><br><br> 快速焊接模块并连接编程器。 读取固件和EEPROM导致清空转储。 当然，开发人员不能允许此类穿刺。 检查本机和天线模块之间的交换。 警报时，TX线清晰。 这可能意味着内存中的小装饰品数量为0。天线模块根本不说话。 事实证明，微控制器通过晶体管开关控制天线模块的功率。 在按键的输出端检测到输入电压，根据说明，该电压应为+ 5V。 这一切对我来说似乎有些奇怪。 也许因为这个原因，天线模块是静音的？ 我没有检验假设的任何选择。 那保险丝位呢？ 真是惊喜！ 通过SPI接口在固件中允许固件。 好吧，现在如何完全静止不动？ 是的-写固件！ 这是一个非常重要的选择，因为除了固件本身之外，我还必须敲打主板。 <br><br> 保护性清漆会干扰该过程，但是用尖锐的探针武装起来，情况会好得多。 事实证明，清漆层没有剥离，而是在正确的位置轻轻刺穿。 铃声板花了两个晚上。 <br><br><div class="spoiler">  <b class="spoiler_title">微控制器端口引脚排列</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th> 针号 </th><th>  CPU针脚 </th><th> 文档连接器 </th><th> 连接器输出编号 </th><th> 根据安装卡的文档进行预约 </th></tr><tr><td>  9 </td><td>  PD0（RXD0 / PCINT24） </td><td>  X1 </td><td> 接收/呼叫 </td><td> 天线RX信号和CALL BUTTON按钮输入 </td></tr><tr><td>  10 </td><td>  PD1（TXD0 / PCINT25） </td><td>  X1 </td><td> 得克萨斯州 </td><td>  TX天线信号 </td></tr><tr><td>  11 </td><td>  PD2-&gt; 6C595 RCK引脚 </td><td></td><td></td><td></td></tr><tr><td>  12 </td><td>  PD3-&gt; 6C595 SER IN引脚 </td><td></td><td></td><td></td></tr><tr><td>  13 </td><td>  PD4-&gt; 6C595 SRCK引脚 </td><td></td><td></td><td></td></tr><tr><td>  14 </td><td>  PD5 </td><td>  X5 </td><td> 通讯 </td><td>  IButton按钮输入 </td></tr><tr><td>  15 </td><td>  PD6 </td><td>  X4，X4a </td><td>  Dq </td><td> 来自发动机和内部温度传感器的DQ信号 </td></tr><tr><td>  16 </td><td>  PD7 </td><td>  X7 </td><td></td><td> 主电平触发输入 </td></tr><tr><td>  3 </td><td>  PB7 / SCK-&gt; 6C595 CLR </td><td></td><td></td><td></td></tr><tr><td>  2 </td><td>  PB6 </td><td>  X8 </td><td>  5 </td><td>  CH5输出（300mA）- </td></tr><tr><td>  1个 </td><td>  PB5 </td><td>  X8 </td><td>  2 </td><td> 输出CH4（1A）- </td></tr><tr><td>  PB4 </td><td>  X8 </td><td>  3 </td><td></td><td>  CH2输出（500mA）- </td></tr><tr><td>  43 </td><td>  PB3 </td><td>  X8 </td><td>  20 </td><td> 来自转速表，喷油器，发电机的信号输入 </td></tr><tr><td>  42 </td><td>  PB2 </td><td>  X8 </td><td>  4 </td><td>  CH3输出（300mA）- </td></tr><tr><td>  41 </td><td>  PB1 </td><td>  X8 </td><td>  13、14 </td><td> 左转灯 <br> 右转向灯 <br></td></tr><tr><td>  40 </td><td>  PB0 </td><td>  X8 </td><td>  18岁 </td><td> 继电器CH1（15 A） <br>  15、16-&gt; 18 <br></td></tr><tr><td>  37 </td><td>  PA0 </td><td></td><td></td><td> 加速度计（X轴） </td></tr><tr><td>  36 </td><td>  PA1 </td><td></td><td></td><td> 加速度计（Y轴） </td></tr><tr><td>  35 </td><td>  PA2 </td><td>  X3 </td><td> 通讯 </td><td> 代客/电压测量按钮 </td></tr><tr><td>  34 </td><td>  PA3 </td><td></td><td></td><td></td></tr><tr><td>  33 </td><td>  PA4 </td><td>  X8 </td><td>  8 </td><td> 行李箱限位开关（±） </td></tr><tr><td>  32 </td><td>  PA5 </td><td>  X8 </td><td>  11 </td><td> 门限位开关（±） </td></tr><tr><td>  31 </td><td>  PA6 </td><td>  X8 </td><td>  19 </td><td> 来自空挡/手刹传感器的输入（±） </td></tr><tr><td>  30 </td><td>  PA7 </td><td>  X8 </td><td>  7 </td><td> 来自机油传感器的输入，灯电量（±） </td></tr><tr><td>  19 </td><td>  PC0 </td><td>  X7 </td><td></td><td> 前级触发输入 </td></tr><tr><td>  20 </td><td> 电脑1 </td><td>  X6 </td><td>  1个 </td><td> 红色指示灯 </td></tr><tr><td>  21 </td><td>  PC2 </td><td>  X6 </td><td>  2 </td><td> 绿色指示灯 </td></tr><tr><td>  22 </td><td>  PC3 </td><td>  X1 </td><td>  + 12V </td><td> 天线功率 </td></tr><tr><td>  23 </td><td> 电脑4 </td><td>  X8 </td><td>  21 </td><td> 来自制动踏板按钮的输入 </td></tr><tr><td>  24 </td><td>  PC5 </td><td>  X8 </td><td>  10 </td><td> 点火输入 </td></tr><tr><td>  25 </td><td>  PC6 </td><td></td><td></td><td></td></tr><tr><td>  26 </td><td> 个人电脑7 </td><td>  X8 </td><td>  17 </td><td> 警笛 </td></tr></tbody></table></div><br><br></div></div><br><br> 我编写了一个测试固件，将其刷新，然后按一下滚轴-太好了！ 天线模块和钥匙扣已经没有用了。 因此，如果您可以使用汽车中所有现成的电路和连接点为汽车警报器编写固件，则仍然可以解决通信通道问题。 我想，如果您将GSM和GPS留在项目中，扔掉蓝牙并将其全部固定在Pandora汽车警报器上怎么办？ 好吧，当然，这是最好的选择！ 首先，没有必要准备复杂的电路板，潘多拉（Pandora）电路解决了许多问题，但我只需要制造一个可以连接的扩展模块即可代替标准天线模块。 如您所知，中国微控制器的等待期还没有明显过。 <br><br> 为了将所有模块相互连接，我蚀刻了电路板。 她很简单。 其中，完成的GPS，GSM模块和汽车报警器已连接到STM32微控制器的UART端口。 <br><br><img src="https://habrastorage.org/webt/tt/ec/wt/ttecwtsyfttz4b_mosb3ryydgeq.jpeg"><br><br> 模块的填充物位于笔记本电脑的电源设备中。 <br><br><img src="https://habrastorage.org/webt/k3/dz/qw/k3dzqwjwabwqdcc6e0mywrx9lri.jpeg"><br><br>  DC-DC转换器不希望被放置在机箱内部，而不得不找到一个更宽敞的机箱。 因此，带有方便卡扣装置的SUPRA收音机正面的笔袋非常适合这种情况。 <br><br><img src="https://habrastorage.org/webt/q0/st/sp/q0stspdrfsjnsqkxhxypr_79hi0.jpeg"><br><br> 木板上涂有聚氨酯清漆。 <br><br> 组件。 这里的一切都很简单： <br><br>  DC-DC转换器LM2596 <br>  GSM调制解调器SIM800L（电源3.6-4.4） <br>  GPS模块NEO-6M（电源3.4-3.8） <br> 一块PCB。 <br><br> 模块所需的电压形成一个DC-DC转换器。 其输出电压设置为3.7伏。 调节螺钉上涂有清漆，以防止其因振动而移位。 <br><br> 我以为首先需要支持哪些外围设备，我得到了以下列表： <br><br><ol><li> 内饰和发动机温度传感器。 </li><li> 加速度计 </li><li> 电压表车载网络。 </li><li> 门限位开关输入。 </li><li> 行李箱限位开关输入。 </li><li> 制动踏板限位开关输入。 </li><li> 输出到点火器。 </li><li> 中继器继电器输出。 </li><li> 退出防盗停车架线工。 </li><li> 输出到互锁继电器。 </li><li> 退出警笛。 </li></ol><br> 自觉拒绝支持： <br><br><ol><li> 退出中央锁定继电器。 轿厢未连接至中央门锁的门。 </li><li> 转速表输入，因为连接到混合动力汽车根本没有意义。 </li><li> 发动机罩限位开关的输入，因为车辆缺少该输入。 </li></ol><br> 实现的算法和功能： <br><br><ol><li> 将设置存储在EEPROM中。 </li><li> 使用START-STOP技术启动发动机。 </li><li> 使用模拟控制（iDatalink）激活无钥匙搜寻器。 </li><li> 远程启动引擎。 </li><li> 电池欠压控制。 </li><li> 监控发动机电压。 </li><li> 设防/撤防（区域周边控制）。 </li><li> 控制门和行李箱的限位开关。 </li><li> 警笛声的支持。 </li><li> 支持信号灯（转向信号灯）。 </li><li> 支持静音模式。 </li><li> 支持外部扩展卡（遥测模块）。 </li><li> 连接和状态转移到服务器。 </li><li> 在不与服务器通信的情况下，系统管理DTMF代码。 </li><li> 可信号码列表。 </li></ol><br> 通过呼叫设置了安全模式的受信任电话号码来实现反馈。 <br><br> 系统管理是通过Telegram机器人实现的： <br><br><img src="https://habrastorage.org/webt/ox/s5/k1/oxs5k1bqjhtcsev0qruogung8wa.png" alt="图片"><br><br> 该机器人还会发送有关紧急情况的消息，例如： <br><br><ol><li> 电池电压低。 </li><li> 电池电压已恢复。 </li><li> 发动机温度低。 </li><li> 发动机温度高。 </li></ol><br> 实际上，自制已经3年了，在此期间，我发现： <br><br><ol><li> 自制产品的最长正常运行时间约为80天，然后设备重启，因为GSM调制解调器甚至停止了接听电话。 </li><li> 在负温度和高温（-40至+40）下稳定运行。 </li><li> 需要做数字总线支持。 </li></ol><br> 将Pandora DXL 3000刷新到SPI总线的可能性是一个漏洞，因为它使您可以下载可以激活无钥匙防盗器爬行器的输出并停用锁的软件。 <br><br> 总的来说，所做的工作给了我很多经验。 我研究了汽车警报器的电路，了解如何紧凑而又简单地做到这一点，并学习了如何对STM32微控制器进行编程。 结果，我制作了自己使用的产品。 我受到启发并继续开发第二版。 第二个版本将能够连接到数字总线，以简化并减少连接点的数量，并实现旁路标准防盗锁，而无需在IMMO-IMI链上使用外部爬虫。 <br><br> 噢，是的，这一直以来，系统一直在继续使用20车身的家用车Toyota Prius，该车身富含数字轮胎。 对BEAN总线的调试支持正全面展开。 <br><br>  <b>PS：</b>第二个版本已经开发，正在2007年丰田Camry上进行测试。 <br><br> 结果，我将我的项目看作是为汽车遥测创建开放系统的机会。 <br><br> 感谢您的关注！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479216/">https://habr.com/ru/post/zh-CN479216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479192/index.html">类固醇管理程序：FreeBSD + ZFS + cbsd</a></li>
<li><a href="../zh-CN479200/index.html">分形图像压缩</a></li>
<li><a href="../zh-CN479202/index.html">C ++和数值方法：近似牛顿-科茨积分</a></li>
<li><a href="../zh-CN479210/index.html">自2020年1月1日起，外国在线商店的购买将发生什么</a></li>
<li><a href="../zh-CN479214/index.html">莫斯科＃2开发人员即将到来的免费活动精选</a></li>
<li><a href="../zh-CN479218/index.html">如何制作将照片转换为漫画书的机器人：傻瓜的分步说明</a></li>
<li><a href="../zh-CN479220/index.html">Nano-neuron-7个简单的JavaScript函数，显示机器如何“学习”</a></li>
<li><a href="../zh-CN479222/index.html">＃325移动开发人员的有趣材料摘要（12月2日至8日）</a></li>
<li><a href="../zh-CN479226/index.html">Habr分析：用户从Habr订购什么作为礼物</a></li>
<li><a href="../zh-CN479230/index.html">使用草率的注释记录您的Express API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>