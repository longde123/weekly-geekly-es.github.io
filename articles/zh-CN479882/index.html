<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšµğŸ¾ ğŸ« ğŸˆ¯ï¸ è¿›è¡Œè½¯ä»¶é…ç½® ğŸ‘¨ğŸ»â€ğŸ³ ğŸš– ğŸ†‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¤§å®¶å¥½ï¼ åœ¨Goä¸Šè¿›è¡Œäº†äº”å¹´ç¼–ç¨‹ä¹‹åï¼Œæˆ‘å‘ç°è‡ªå·±ç›¸å½“ 
 ç‰¹å®šç¨‹åºé…ç½®æ–¹æ³•çš„çƒ­å¿ƒæ”¯æŒè€…ã€‚ åœ¨è¿™ 
 æˆ‘å°†å°è¯•åœ¨æ–‡ç« ä¸­æ­ç¤ºä»–çš„ä¸»è¦æ€æƒ³ï¼Œå¹¶åˆ†äº«ä¸€å°éƒ¨åˆ† 
 å®ç°è¿™äº›æƒ³æ³•çš„å›¾ä¹¦é¦†ã€‚ 


 æ˜¾ç„¶ï¼Œæœ¬æ–‡æ˜¯éå¸¸ä¸»è§‚çš„ï¼Œå¹¶ä¸å‡è£…æ˜¯å®¢è§‚çš„ 
 çœŸç›¸ ä½†æ˜¯ï¼Œæˆ‘å¸Œæœ›å®ƒå¯¹ç¤¾åŒºæœ‰ç”¨ï¼Œå¹¶æœ‰åŠ©äºå‡å°‘ 
 åœ¨è¿™æ ·çç¢çš„ä»»åŠ¡ä¸Š...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>è¿›è¡Œè½¯ä»¶é…ç½®</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479882/"><p><img src="https://habrastorage.org/webt/8g/-t/pl/8g-tplxpugbs2hslzi5n0rxri_i.jpeg" alt="åœ°é¼ ä¸æ ‡å¿—"></p><br><p> å¤§å®¶å¥½ï¼ åœ¨Goä¸Šè¿›è¡Œäº†äº”å¹´ç¼–ç¨‹ä¹‹åï¼Œæˆ‘å‘ç°è‡ªå·±ç›¸å½“ <br> ç‰¹å®šç¨‹åºé…ç½®æ–¹æ³•çš„çƒ­å¿ƒæ”¯æŒè€…ã€‚ åœ¨è¿™ <br> æˆ‘å°†å°è¯•åœ¨æ–‡ç« ä¸­æ­ç¤ºä»–çš„ä¸»è¦æ€æƒ³ï¼Œå¹¶åˆ†äº«ä¸€å°éƒ¨åˆ† <br> å®ç°è¿™äº›æƒ³æ³•çš„å›¾ä¹¦é¦†ã€‚ </p><br><p> æ˜¾ç„¶ï¼Œæœ¬æ–‡æ˜¯éå¸¸ä¸»è§‚çš„ï¼Œå¹¶ä¸å‡è£…æ˜¯å®¢è§‚çš„ <br> çœŸç›¸ ä½†æ˜¯ï¼Œæˆ‘å¸Œæœ›å®ƒå¯¹ç¤¾åŒºæœ‰ç”¨ï¼Œå¹¶æœ‰åŠ©äºå‡å°‘ <br> åœ¨è¿™æ ·çç¢çš„ä»»åŠ¡ä¸ŠèŠ±è´¹çš„æ—¶é—´ã€‚ </p><a name="habracut"></a><br><h2 id="o-chem-rech"> ä½ åœ¨è¯´ä»€ä¹ˆ </h2><br><p> ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘è®¤ä¸ºé…ç½®æ˜¯å¯¹æˆ‘ä»¬å˜é‡çš„å®šä¹‰ <br> æˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶ä»å¤–éƒ¨è·å–å…¶å€¼çš„ç¨‹åºã€‚ <br> å®ƒå¯ä»¥æ˜¯å‚æ•°æˆ–å‘½ä»¤è¡Œå‚æ•°ï¼Œç¯å¢ƒå˜é‡ï¼Œ <br> å­˜å‚¨åœ¨ç£ç›˜ä¸Šæˆ–ç½‘ç»œä¸Šä»»ä½•åœ°æ–¹çš„é…ç½®æ–‡ä»¶ï¼Œæ•°æ®åº“è¡¨ <br> æ•°æ®ç­‰ç­‰ã€‚ </p><br><p> ç”±äºGoæ˜¯ä¸€ç§é«˜åº¦é™æ€çš„ç±»å‹åŒ–è¯­è¨€ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ› <br> ç¡®å®šå¹¶è·å–æ­¤ç±»å˜é‡çš„å€¼ï¼Œå¹¶è€ƒè™‘å…¶ç±»å‹ã€‚ </p><br><p> æœ‰å¤§é‡çš„å¼€æ”¾æºä»£ç åº“ç”šè‡³æ¡†æ¶ï¼Œ <br> è§£å†³è¿™ç±»é—®é¢˜ã€‚ ä»–ä»¬ä¸­çš„å¤§å¤šæ•°ä»£è¡¨äº†è‡ªå·±çš„æ„¿æ™¯ã€‚ <br> å¦‚ä½•åšåˆ°çš„ã€‚ </p><br><p> æˆ‘æƒ³è°ˆè°ˆä¸€ç§ä¸å¤ªå¸¸è§çš„ç¨‹åºé…ç½®æ–¹æ³•ã€‚ <br> è€Œä¸”ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ç§æ–¹æ³•æœ€ç®€å•ã€‚ </p><br>
<h2 id="paket-flag">  <code>flag</code>åŒ… </h2><br><p> æ˜¯çš„ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªç©ç¬‘ï¼Œæˆ‘çœŸçš„æƒ³å¼•èµ·æ‚¨çš„æ³¨æ„ <br> è‘—åçš„Goæ ‡å‡†åº“åŒ…ã€‚ </p><br><p> ä¹ä¸€çœ‹ï¼Œ <code>flag</code>æ˜¯ç”¨äºå¤„ç†å‘½ä»¤å‚æ•°çš„å·¥å…· <br> çº¿ï¼Œä»…æ­¤è€Œå·²ã€‚ ä½†æ˜¯æ­¤åŒ…ä¹Ÿå¯ä»¥ç”¨ä½œ<strong>æ¥å£ã€‚</strong> <strong><br></strong>  <strong>ç¡®å®š</strong>æˆ‘ä»¬ç¨‹åº<strong>çš„</strong>å‚æ•°ã€‚ åœ¨è®¨è®ºçš„æ–¹æ³•ä¸­ <br>  <code>flag</code>ä¸»è¦ç”¨äºè¿™ç§æ–¹å¼ã€‚ </p><br><p> å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¸Œæœ›è¾“å…¥ç±»å‹çš„å‚æ•°ã€‚ <br>  <code>flag</code>åŒ…æä¾›äº†å¯¹å¤§å¤šæ•°åŸºæœ¬ç±»å‹æ‰§è¡Œæ­¤æ“ä½œçš„èƒ½åŠ›ã€‚ <br>  <code>flag.String()</code> ï¼Œ <code>flag.Int()</code>ç”šè‡³æ˜¯<code>flag.Duration()</code> ã€‚ </p><br><p> å¯¹äºæ›´å¤æ‚çš„ç±»å‹ï¼Œä¾‹å¦‚<code>[]string</code>æˆ–<code>time.Time</code>æœ‰ä¸€ä¸ªæ¥å£ <br>  <code>flag.Value</code> ï¼Œå®ƒå…è®¸æ‚¨æè¿°<code>flag.Value</code>ä»ä¸­è·å–å‚æ•°çš„å€¼ <br>  <em>å­—ç¬¦ä¸²è¡¨ç¤º</em> ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œç±»å‹ä¸º<code>time.Time</code>çš„å‚æ•°å¯ä»¥è¿™æ ·å®ç°ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// TimeValue is an implementation of flag.Value interface. type TimeValue struct { P *time.Time Layout string } func (t *TimeValue) Set(s string) error { v, err := time.Parse(t.Layout, s) if err == nil { (*tP) = v } return err } func (t *TimeValue) String() string { return tPFormat(t.Layout) }</span></span></code> </pre> <br><p> è½¯ä»¶åŒ…çš„é‡è¦å±æ€§æ˜¯å®ƒåœ¨<strong>æ ‡å‡†åº“ä¸­çš„</strong>å­˜åœ¨- <code>flag</code>æ˜¯ <br>  <em>é…ç½®ç¨‹åºçš„æ ‡å‡†æ–¹æ³•</em> ï¼Œè¿™æ„å‘³ç€å…¶å¯èƒ½æ€§ <br> ä¸åŒé¡¹ç›®å’Œåº“ä¹‹é—´çš„ä½¿ç”¨ç‡é«˜äºå…¶ä»–é¡¹ç›®å’Œåº“ <br> ç¤¾åŒºä¸­çš„å›¾ä¹¦é¦†ã€‚ </p><br><h2 id="pochemu-ne-ispolzuyut-flag"> ä¸ºä»€ä¹ˆä¸ä½¿ç”¨<code>flag</code> ï¼Ÿ </h2><br><p> åœ¨æˆ‘çœ‹æ¥ï¼Œä½¿ç”¨å’Œå­˜åœ¨å…¶ä»–åº“çš„åŸå› æœ‰ä¸¤ä¸ªï¼š </p><br><ul><li> ä¸ä»…ä»å‘½ä»¤è¡Œè¯»å–å‚æ•° </li><li> æˆ‘æƒ³æ„é€ å‚æ•° </li></ul><br><p> ä¾‹å¦‚ï¼Œå¦‚æœä»æ–‡ä»¶ä¸­è¯»å–å‚æ•°ï¼Œåˆ™ä¸€åˆ‡éƒ½å·®ä¸å¤šäº†ï¼ˆ <br> ç¨åï¼‰ï¼Œç„¶åå…³äºç»“æ„å‚æ•°ï¼Œç›´æ¥è¯´å‡ å¥è¯ <br> ç°åœ¨ã€‚ </p><br><p> æˆ‘è®¤ä¸ºï¼Œè¿™ä¸æ˜¯ç¡®å®šé…ç½®çš„æœ€ä½³æ–¹æ³• <br> ç¨‹åºä½œä¸ºç»“æ„ï¼Œå…¶å­—æ®µå¯ä»¥æ˜¯å…¶ä»–ç»“æ„ï¼Œå› æ­¤ <br> è¿›ä¸€æ­¥ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> AppConfig <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Port <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Database <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Endpoint <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Timeout time.Duration } ... }</code> </pre> <br><p> åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½¿ç”¨å’Œå­˜åœ¨åº“çš„åŸå›  <br> å…è®¸æ‚¨ä»¥è¿™ç§æ–¹å¼ä½¿ç”¨é…ç½®çš„æ¡†æ¶ã€‚ </p><br><p> æˆ‘è®¤ä¸º<code>flag</code>ä¸åº”è¯¥æä¾›ç»“æ„é…ç½®åŠŸèƒ½ã€‚ <br> åªéœ€å‡ è¡Œä»£ç ï¼ˆæˆ–ä¸€ä¸ªåº“ï¼‰å³å¯è½»æ¾å®ç° <br>  <code>flagutil</code> ï¼Œå°†åœ¨ä¸‹é¢è¿›è¡Œè®¨è®ºï¼‰ã€‚ </p><br><p> è€Œä¸”ï¼Œå¦‚æœæ‚¨è€ƒè™‘ä¸€ä¸‹ï¼Œè¿™ç§ç»“æ„çš„å­˜åœ¨ä¼šå¯¼è‡´ <br> ç»„ä»¶ä¹‹é—´çš„è¿é€šæ€§ã€‚ </p><br><h2 id="strukturnaya-konfiguraciya"> ç»“æ„æ„é€  </h2><br><p> æƒ³æ³•æ˜¯å®šä¹‰å‚æ•°è€Œä¸ç®¡ç»“æ„ <br> ç¨‹åºï¼Œå¹¶å°½å¯èƒ½é è¿‘ä½¿ç”¨å®ƒä»¬çš„åœ°æ–¹-ä¹Ÿå°±æ˜¯è¯´ï¼Œ <br> ç›´æ¥åœ¨åŒ…è£…çº§åˆ«ã€‚ </p><br><p> å‡è®¾æˆ‘ä»¬ä¸ºæŸäº›æœåŠ¡ï¼ˆæ•°æ®åº“ï¼Œ <br>  APIæˆ–å…¶ä»–ï¼‰ï¼Œç§°ä¸º<code>yoogle</code> ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> yoogle <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Endpoint <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Timeout time.Duration } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c *Config)</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Client</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br><p> è¦å¡«å……<code>yoogle.Config</code>ç»“æ„ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‡½æ•° <br> å°†ç»“æ„å­—æ®µæ³¨å†Œåˆ°æ¥æ”¶åˆ°çš„<code>*flag.FlagSet</code> ã€‚ </p><br><p> å¯ä»¥åœ¨<code>yoogle</code>åŒ…<code>yoogle</code>æˆ–åŒ…ä¸­å£°æ˜æ­¤ç±»å‡½æ•° <br>  <code>yooglecfg</code> ï¼ˆåœ¨ç¬¬ä¸‰æ–¹åº“çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™è¿™æ ·çš„å‡½æ•° <br> å…¶ä»–åœ°æ–¹ï¼‰ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> yooglecfg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"flag"</span></span> <span class="hljs-string"><span class="hljs-string">"app/yoogle"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Export</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(flag *flag.FlagSet)</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">yoogle</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Config</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c yoogle.Config flag.StringVar(&amp;c.Endpoint, <span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://example.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"endpoint for our API"</span></span>, ) flag.DurationVar(&amp;c.Timeout, <span class="hljs-string"><span class="hljs-string">"timeout"</span></span>, time.Second, <span class="hljs-string"><span class="hljs-string">"timeout for operations"</span></span>, ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;c }</code> </pre> <br><p> ä¸ºäº†æ¶ˆé™¤å¯¹<code>flag</code>åŒ…çš„ä¾èµ–ï¼Œå¯ä»¥ä½¿ç”¨ <br> å¿…è¦çš„<code>flag.FlagSet</code>æ–¹æ³•ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> yooglecfg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"app/yoogle"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> FlagSet <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { StringVar(p *<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, name, value, desc <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Export</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(flag FlagSet)</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">yoogle</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Config</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c yoogle.Config flag.StringVar(&amp;c.Endpoint, <span class="hljs-string"><span class="hljs-string">"endpoint"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://example.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"endpoint for our API"</span></span>, ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> &amp;c }</code> </pre> <br><p> å¹¶ä¸”å¦‚æœé…ç½®å–å†³äºå‚æ•°å€¼ï¼ˆä¾‹å¦‚ï¼Œ <br> è¡¨ç¤ºæŸç§ç®—æ³•ï¼‰ï¼Œå‡½æ•°<code>yooglecfg.Export()</code>å¯ä»¥è¿”å› <br> è§£ææ‰€æœ‰å€¼<strong>å</strong>è°ƒç”¨æ„é€ å‡½æ•° <br> é…ç½®ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> yooglecfg <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"app/yoogle"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> FlagSet <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { StringVar(p *<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, name, value, desc <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Export</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(flag FlagSet)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">yoogle</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Config</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> algorithm <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> flag.StringVar(&amp;algorithm, <span class="hljs-string"><span class="hljs-string">"algorithm"</span></span>, <span class="hljs-string"><span class="hljs-string">"quick"</span></span>, <span class="hljs-string"><span class="hljs-string">"algorithm used to do something"</span></span>, ) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c yoogle.Config <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">yoogle</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Config</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> algorithm { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"quick"</span></span>: c.Impl = quick.New() <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"merge"</span></span>: c.Impl = merge.New() <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"bubble"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(...) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> c } }</code> </pre> <br><blockquote> å¯¼å‡ºåŠŸèƒ½ä½¿æ‚¨å¯ä»¥åœ¨ä¸çŸ¥é“ç»“æ„çš„æƒ…å†µä¸‹å®šä¹‰åŒ…å‚æ•° <br> ç¨‹åºé…ç½®ä»¥åŠå¦‚ä½•è·å–å…¶å€¼ã€‚ </blockquote><br><h2 id="githubcomgobwasflagutilflagutil">  <a href="https://github.com/gobwas/flagutil">github.com/gobwas/flagutil</a> </h2><br><p> æˆ‘ä»¬æ‰¾å‡ºäº†ä¸€ä¸ªå¤§çš„é…ç½®ç»“æ„å¹¶è®¾å®šäº†å‚æ•° <br> ç‹¬ç«‹çš„ï¼Œä½†å°šä¸æ¸…æ¥šå¦‚ä½•å°†å®ƒä»¬èåˆåœ¨ä¸€èµ·å¹¶è·å¾— <br> ä»·å€¼è§‚ã€‚ </p><br><p> æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç¼–å†™äº†<code>flagutil</code>è½¯ä»¶åŒ…ã€‚ </p><br><h3 id="sobiraem-parametry-vmeste"> å°†å‚æ•°æ”¾åœ¨ä¸€èµ· </h3><br><p> ç¨‹åºï¼Œå…¶ç¨‹åºåŒ…å’Œç¬¬ä¸‰æ–¹åº“çš„æ‰€æœ‰å‚æ•°å‡æ¥æ”¶å…¶å‰ç¼€ <br> å¹¶åœ¨åŒ…çº§åˆ«<code>main</code>å¤„æ”¶é›†ï¼š </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"flag"</span></span> <span class="hljs-string"><span class="hljs-string">"app/yoogle"</span></span> <span class="hljs-string"><span class="hljs-string">"app/yooglecfg"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/gobwas/flagutil"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { flags := flag.NewFlagSet(<span class="hljs-string"><span class="hljs-string">"my-app"</span></span>, flag.ExitOnError) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flag.IntVar(&amp;port, <span class="hljs-string"><span class="hljs-string">"port"</span></span>, <span class="hljs-number"><span class="hljs-number">4050</span></span>, <span class="hljs-string"><span class="hljs-string">"port to bind to"</span></span>, ) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> config *yoogle.Config flagutil.Subset(flags, <span class="hljs-string"><span class="hljs-string">"yoogle"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sub *flag.FlagSet)</span></span></span></span> { config = yooglecfg.Export(sub) }) }</code> </pre> <br><p>  <code>flagutil.Subset()</code>å‡½æ•°åšä¸€ä»¶ç®€å•çš„äº‹æƒ…ï¼šå®ƒæ·»åŠ ä¸€ä¸ªå‰ç¼€ <br>  ï¼ˆ <code>"yoogle"</code> ï¼‰åˆ°å›è°ƒå†…éƒ¨<code>sub</code>æ³¨å†Œçš„æ‰€æœ‰å‚æ•°ã€‚ </p><br><p> ç°åœ¨è¿è¡Œç¨‹åºå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="bash hljs">app -port 4050 -yoogle.endpoint https://example.com -yoogle.timeout 10s</code> </pre> <br><h3 id="poluchaem-znacheniya-parametrov"> è·å–å‚æ•°å€¼ </h3><br><p>  <code>flag.FlagSet</code>ä¸­çš„æ‰€æœ‰å‚æ•°<code>flag.FlagSet</code>åŒ…å«<code>flag.FlagSet</code>çš„å®ç°ï¼Œ <br> å®ƒå…·æœ‰<code>Set(string) error</code>æ–¹æ³•-ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæä¾›äº†æœºä¼š <br> è®¾ç½®<em>å€¼</em>çš„<em>å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼</em> ã€‚ </p><br><p> å®ƒä»ç„¶å¯ä»¥ä»¥é”®å€¼å¯¹çš„å½¢å¼ä»ä»»ä½•æ¥æºè¯»å–å€¼ï¼Œå¹¶ä¸” <br> è¿›è¡Œ<code>flag.Set(key, value)</code>è°ƒç”¨ã€‚ </p><br><blockquote> è¿™ä½¿æˆ‘ä»¬æœ‰æœºä¼šç”šè‡³ä¸ä½¿ç”¨å‘½ä»¤å‚æ•°çš„è¯­æ³• <br>  <code>flag</code>åŒ…ä¸­æè¿°çš„è¡Œã€‚ æ‚¨å¯ä»¥é€šè¿‡ä»»ä½•æ–¹å¼è§£æå‚æ•°ï¼Œ <br> ä¾‹å¦‚<a href="https://www.gnu.org/software/libc/manual/html_node/Argument-Syntax.html">posixç¨‹åºå‚æ•°</a> ã€‚ </blockquote><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { flags := flag.NewFlagSet(<span class="hljs-string"><span class="hljs-string">"my-app"</span></span>, flag.ExitOnError) <span class="hljs-comment"><span class="hljs-comment">// ... flags.String( "config", "/etc/app/config.json", "path to configuration file", ) flagutil.Parse(flags, // First, use posix arguments syntax instead of `flag`. // Just to illustrate that it is possible. flagutil.WithParser(&amp;pargs.Parser{ Args: os.Args[1:], }), // Then lookup for "config" flag value and try to // parse its value as a json configuration file. flagutil.WithParser(&amp;file.Parser{ PathFlag: "config", Syntax: &amp;json.Syntax{}, }), ) }</span></span></code> </pre> <br><p> å› æ­¤ï¼Œ <code>config.json</code>æ–‡ä»¶å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">4050</span></span>, <span class="hljs-attr"><span class="hljs-attr">"yoogle"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"endpoint"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://example.com"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timeout"</span></span>: <span class="hljs-string"><span class="hljs-string">"10s"</span></span> ... } }</code> </pre> <br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p> å½“ç„¶ï¼Œæˆ‘ä¸æ˜¯ç¬¬ä¸€ä¸ªè°ˆåˆ°è¿™ç§æ–¹æ³•çš„äººã€‚ è®¸å¤š <br> ä¸Šè¿°æƒ³æ³•åœ¨å‡ å¹´å‰å·²ç»è¢«ä¸€ç§æˆ–å¦ä¸€ç§æ–¹å¼ä½¿ç”¨ï¼Œå½“æ—¶ <br> æˆ‘åœ¨MailRuå·¥ä½œã€‚ </p><br><p> å› æ­¤ï¼Œä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„é…ç½®è€Œä¸æµªè´¹æ—¶é—´ <br> ç ”ç©¶ï¼ˆç”šè‡³ç¼–å†™ï¼‰ä¸‹ä¸€ä¸ªé…ç½®æ¡†æ¶ <br> ä»¥ä¸‹å†…å®¹ï¼š </p><br><ul><li> ä½¿ç”¨<code>flag</code>ä½œä¸ºå‚æ•°<strong>å®šä¹‰ç•Œé¢</strong> <br> è¯¥ç¨‹åº </li><li> åˆ†åˆ«å¯¼å‡ºæ¯ä¸ªè½¯ä»¶åŒ…çš„å‚æ•°ï¼Œè€Œæ— éœ€äº†è§£ç»“æ„å’Œ <br> ä¸€ç§ç¨åè·å¾—ä»·å€¼çš„æ–¹æ³• </li><li> åœ¨<code>main</code>å®šä¹‰å¦‚ä½•è¯»å–å€¼ï¼Œå‰ç¼€å’Œé…ç½®ç»“æ„ </li></ul><br><p>  <code>flagutil</code>åº“çš„<code>flagutil</code>æˆ‘å¯¹åº“çš„è®¤è¯† <br>  <a href="https://github.com/peterbourgon/ff">Peterbourgon / ff-</a>æˆ‘ä¸ä¼šå†™<code>flagutil</code> ï¼Œå¦‚æœä¸æ˜¯è¿™æ ·çš„è¯ <br> ä½¿ç”¨ä¸­çš„å·®å¼‚ã€‚ </p><br><p> æ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼ </p><br><h2 id="ssylki"> å‚è€ƒæ–‡çŒ® </h2><br><ul><li>  <a href="https://gbws.io/articles/configuration-in-go/">è‹±æ–‡ç‰ˆæ–‡ç« </a> </li><li>  <a href="https://golang.org/pkg/flag/">golang.org/pkg/flag</a> </li><li>  <a href="https://github.com/gobwas/flagutil">github.com/gobwas/flagutil</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479882/">https://habr.com/ru/post/zh-CN479882/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479870/index.html">æˆ‘ä»¬ä¸ä»…å¯ä»¥éšæ—¶éšåœ°æ›´æ”¹æ¡†æ¶å’Œå·¥ä½œèµ„æ–™ã€‚ PHP NNçš„ç¬¬äºŒä¸ªmitapä¼šå‘ç”Ÿä»€ä¹ˆ</a></li>
<li><a href="../zh-CN479874/index.html">æˆ‘æ˜¯å¦‚ä½•è¿›å…¥ThoughtWorksæˆ–è¿›è¡Œå…¸å‹é¢è¯•çš„</a></li>
<li><a href="../zh-CN479876/index.html">æ•°æ®ä¸­å¿ƒéœ€è¦æ•å¤´å—ï¼Ÿ</a></li>
<li><a href="../zh-CN479878/index.html">Wi-Fié€šç”¨TKï¼Œå¹¶é™„æœ‰è¯´æ˜</a></li>
<li><a href="../zh-CN479880/index.html">ä½¿ç”¨è“å›¾åˆ›å»ºç¾ä¸½çš„æ²»ç–—å»ºç­‘</a></li>
<li><a href="../zh-CN479884/index.html">è‡ªå®šä¹‰CI / CD for Unity</a></li>
<li><a href="../zh-CN479886/index.html">å¬è§‰ä»£æ›¿è§†è§‰ï¼šé‡æ–°é…ç½®å¤§è„‘ç¥ç»å…ƒä»¥é€‚åº”é»‘æš—</a></li>
<li><a href="../zh-CN479888/index.html">é«˜é€Ÿå¼¹æ€§å‹ç¼©ï¼ˆç»­ï¼‰</a></li>
<li><a href="../zh-CN479890/index.html">å®æ–½ç‰©è”ç½‘æ¦‚å¿µçš„é—®é¢˜å’Œä»»åŠ¡</a></li>
<li><a href="../zh-CN479892/index.html">å…³äºGradleæ’ä»¶ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤šçº¿ç¨‹å’Œç›‘è§†è‡ªåŠ¨åŒ–ï¼šYandex.Money metapçš„è§†é¢‘</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>