<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíæ üë®‚Äçüöí üéÉ Ein seltener Vertreter des Brute-Force-Typs: die Geschichte eines Angriffs üåÜ üå®Ô∏è ‚ò∏Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="W√§hrend wir daran arbeiteten, den Online-Shop eines unserer Kunden zu sch√ºtzen, stie√üen wir mehrmals auf einen merkw√ºrdigen Brute-Force-Angriff, der n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein seltener Vertreter des Brute-Force-Typs: die Geschichte eines Angriffs</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/414487/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vo/kn/q9/voknq91nj_iua4hv4kjg-vekpww.jpeg" width="500"></div><br><br>  W√§hrend wir daran arbeiteten, den Online-Shop eines unserer Kunden zu sch√ºtzen, stie√üen wir mehrmals auf einen merkw√ºrdigen Brute-Force-Angriff, der nicht so einfach zu kontern war.  Es basierte auf einer einfachen L√∂sung, die den Angriff von den Reihen ihrer Art unterschied.  Was sie war und wie wir uns immer noch gegen sie verteidigten, lesen Sie unter dem Schnitt. <br><a name="habracut"></a><br>  Wie Sie wissen, ist die ‚Äûklassische‚Äú Brute-Force ein Daten-Brute-Force-Angriff.  Beispielsweise werden bekannte Konten erfasst und Kennw√∂rter nach bestimmten Kriterien ausgew√§hlt, die entweder im laufenden Betrieb oder basierend auf gestohlenen W√∂rterb√ºchern generiert werden.  Dies ist die grundlegende Methode zum Hacken von Konten. <br><br>  Und in dem von mir beschriebenen Fall haben sich die Angreifer etwas anders verhalten.  Erstens verwendeten sie ein gro√ües Botnetz, das von mehreren hundert infizierten Computern auf verschiedene L√§nder verteilt war.  Im √úberwachungssystem sah alles so aus, als w√§ren es v√∂llig andere Computer oder Proxys, an denen echte Personen sa√üen und auf die Site zugegriffen haben.  Ein solcher Angriff kann lange Zeit unbemerkt bleiben. <br><br>  Das zweite Merkmal des Angriffs war neben seiner starken geografischen Verteilung die Aufz√§hlung nicht von Anmeldungen, sondern von Anmeldungen.  Die Angreifer verwendeten wahrscheinlich W√∂rterb√ºcher mit g√§ngigen Passw√∂rtern und gestohlenen Anmeldelisten.  Und zuerst wurde ein Login zum bekannten Passwort gef√ºhrt, dann ein anderes, drittes und so weiter.  Dies war der Situation sehr √§hnlich, in der sich normale Benutzer, die √ºber einen Anbieter verbunden sind, nicht mit ihren Kennw√∂rtern anmelden k√∂nnen.  Das ist auf den ersten Blick nichts Verbrecherisches.  Dar√ºber hinaus war der Zugriff auf die Ressource sehr selten - ein oder zwei pro Minute. <br><br>  Das dritte Merkmal des Angriffs war, dass sich das Botnetz sehr ‚Äûmenschlich‚Äú verhielt: Clients verarbeiteten JavaScript und akzeptierten Cookies. <br><br>  Aufgrund dieses Komplexes von Faktoren blieb der Angriff lange Zeit unbemerkt.  Als wir es dennoch entdeckten, stellten wir uns eine nicht triviale Frage: Wie k√∂nnen wir uns verteidigen?  Alle Botnet-Computer hatten keine besonderen Unterscheidungsmerkmale, mit Ausnahme eines bestimmten Fehlers im Benutzeragenten.  Wir haben den Angriff jedoch nicht aufgrund dieses Zeichens blockiert, da wir in diesem Fall die Aktionen des Angreifers nicht mehr sehen w√ºrden.  Es war notwendig, einige andere Anomalien hervorzuheben.  In Bezug auf IP-Adressen ist nichts Besonderes passiert.  Es ist auch unm√∂glich, Anmeldungen zu blockieren, bei denen eine gro√üe Anzahl erfolgloser Anmeldeversuche durchgef√ºhrt wird, da die H√§ufigkeit sehr gering ist und die Anmeldung nicht verschl√ºsselt wird.  Es gab nur einen Weg - Captcha einzuf√ºhren.  Aber der Kunde wollte das wirklich nicht, weil er glaubte, dass Captcha viele Kunden entfremden k√∂nnte.  Inzwischen ist es den Angreifern bereits gelungen, f√ºr einige Accounts die richtigen Kombinationen auszuw√§hlen. <br><br>  Sie sind sicherlich ratlos: Warum sollte jemand in die Konten von Kunden eines Online-Shops einbrechen?  Tatsache ist, dass auf Ihrem Konto Bonuspunkte gesammelt werden, mit denen Sie Rabatte auf Waren erhalten k√∂nnen.  Wahrscheinlich wollte jemand wirklich Bonuspunkte im Internet kaufen oder verkaufen. <br><br>  Infolgedessen haben wir den Client √ºberredet, das Captcha mit F5-Tools zu implementieren: Es sollte nach einer bestimmten Anzahl erfolgloser Eintr√§ge angezeigt worden sein.  Zun√§chst mussten jedoch die Kriterien f√ºr eine erfolgreiche Anmeldung im System konfiguriert werden.  Dies stellte sich als etwas komplizierter heraus, als es aussah, da die Ressource in einigen F√§llen f√ºr Anmeldeversuche denselben Antwortcode angibt.  Als Kriterium f√ºr den Erfolg der Anmeldung haben wir uns entschieden, die Client-Domain-Cookies zu senden. <br><br>  In der neuesten Version von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F5 ASM</a> wurde es m√∂glich, auf Auswahlversuche anhand der Ger√§te-ID zu reagieren - einer eindeutigen Browser-ID.  Der Seite wird ein JS-Code hinzugef√ºgt. Wenn der infizierte Computer diese Seite √∂ffnet, meldet er seine eindeutige Kennung.  Bei unseren Angreifern stellte sich heraus, dass die Ger√§te-ID des Browsers f√ºr jede IP-Adresse gleich war.  Das hei√üt, ein Browser, auf den von einer IP-Adresse aus zugegriffen wird. <br><br><img src="https://habrastorage.org/webt/kj/xo/qo/kjxoqoyue5-dnap-kxvqyxmmnfy.png"><br><br>  Daher k√∂nnen Sie das folgende Kriterium festlegen: Wenn innerhalb von 15 Minuten mehr als 5 erfolglose Anmeldeversuche von einem Browser aus durchgef√ºhrt werden, wird diesem Client ein Captcha angezeigt.  Wenn dies ein wirklich normaler Benutzer ist, wird er es l√∂sen und sich ruhig anmelden.  Falls der Browser JavaScript nicht unterst√ºtzt, haben wir Ausnahmen hinzugef√ºgt.  Um den Schutz nicht zu schw√§chen, haben wir ein anderes Kriterium verwendet: Wenn mehr als 20 erfolglose Anmeldeversuche von einer IP-Adresse aus durchgef√ºhrt werden, wird erneut ein Captcha angeboten.  Nochmals: F√ºr einen normalen Benutzer verursacht dies keine Probleme. <br><br>  Aber schon heute gibt es Methoden, um den Schutz mit Captcha zu umgehen.  Zum Beispiel senden Botnets Captchas an "Outsourcing" - nach China oder Indien, wo flei√üige Einheimische gegen eine geringe Geb√ºhr Captchas l√∂sen und Textwerte zur√ºckgeben.  In diesem Fall k√∂nnen Sie jedoch geeignete Ma√ünahmen ergreifen: Selbst wenn die Anmeldeversuche nicht erfolgreich sind, k√∂nnen Anmeldeversuche von einer bestimmten IP- oder Ger√§te-ID blockiert werden, wenn die angegebene Anzahl erfolgloser Versuche √ºberschritten wird. <br><br>  Als der Online-Shop das letzte Mal auf diese Weise angegriffen wurde, haben wir das Captcha verwaltet und es hat funktioniert.  Nach seiner Einf√ºhrung begann der Brute-Force-Angriff allm√§hlich zu verblassen und h√∂rte schlie√ülich auf.  Seitdem ist ungef√§hr ein Jahr vergangen - es gab keine R√ºckf√§lle. <br><br>  <i>Andrei Chernykh, Experte im Informationssicherheitszentrum Jet Infosystems</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414487/">https://habr.com/ru/post/de414487/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414477/index.html">Fallstricke bei der Auswahl eines LED-Bildschirms f√ºr einen Besprechungsraum oder einen Konferenzraum anstelle eines Projektors</a></li>
<li><a href="../de414479/index.html">D-Panthenol: ein Medikament f√ºr immer</a></li>
<li><a href="../de414481/index.html">Das PHP-Quiz am Freitag: einige Abenteuer des Programmierers Brad, eine seltsame Sequenz und Preise</a></li>
<li><a href="../de414483/index.html">Geben Sie Safe SQL in Kotlin ein</a></li>
<li><a href="../de414485/index.html">GNMT, episches Versagen oder Feinheiten der maschinellen √úbersetzung</a></li>
<li><a href="../de414489/index.html">Die USA planen, das Problem der Weltraumm√ºll ernsthaft anzugehen</a></li>
<li><a href="../de414493/index.html">So schreiben Sie in 5 Minuten einen intelligenten Vertrag f√ºr ICO</a></li>
<li><a href="../de414495/index.html">toString: Gro√üartig und schrecklich</a></li>
<li><a href="../de414497/index.html">Consulo UI API von der Idee bis zum Prototyp</a></li>
<li><a href="../de414499/index.html">Bericht des Club of Rome 2018, Kapitel 1.1.3: ‚ÄûEine leere Welt gegen einen vollen Frieden‚Äú</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>