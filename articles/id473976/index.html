<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤞🏾 💒 🤒 AWS Elasticsearch: Produk Cacat Secara fundamental 👉🏻 🦌 🎒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terjemahan Harga Nick 

 Saat ini saya sedang mengerjakan proyek logging besar yang awalnya dilaksanakan menggunakan AWS Elasticsearch. Setelah bekerj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>AWS Elasticsearch: Produk Cacat Secara fundamental</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473976/"><img src="https://habrastorage.org/webt/gr/2i/4f/gr2i4fdf6rxq5mh3uwosssdp4uq.jpeg"><br><br>  Terjemahan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Harga Nick</a> <br><br>  Saat ini saya sedang mengerjakan proyek logging besar yang awalnya dilaksanakan menggunakan AWS Elasticsearch.  Setelah bekerja dengan cluster backbone skala besar Elasticsearch selama beberapa tahun, saya benar-benar kagum dengan kualitas implementasi AWS dan tidak dapat memahami mengapa mereka tidak memperbaikinya atau setidaknya memperbaikinya. <br><a name="habracut"></a><br><h2>  Ringkasan </h2><br>  Elasticsearch menyimpan data dalam berbagai indeks yang Anda buat secara eksplisit atau yang dapat dibuat secara otomatis setelah data dikirim.  Entri dalam setiap indeks dibagi menjadi sejumlah pecahan tertentu, yang kemudian diseimbangkan antara node dalam cluster Anda (serata mungkin jika jumlah pecahan Anda tidak dibagi secara merata dengan jumlah node).  Ada dua jenis pecahan utama di ElasticSearch: pecahan dasar dan pecahan replika.  Pecahan replika memberikan toleransi kesalahan jika terjadi kegagalan simpul, dan pengguna dapat mengatur jumlah pecahan replika secara terpisah untuk setiap indeks. <br><br><h2>  Karya Elasticsearch standar </h2><br>  Elasticsearch - Ini elastis.  Kadang-kadang bisa sangat rumit, tetapi, secara umum, Anda dapat menambahkan node ke cluster atau menghapusnya.  Dan jika dalam kasus menghapus node ada jumlah replika yang sesuai, Elasticsearch akan mendistribusikan pecahan dan bahkan menyeimbangkan beban pada node dalam cluster.  Ini biasanya berhasil. <br><br>  Pemenuhan permintaan yang mahal kadang-kadang dapat menyebabkan jatuhnya node dan sejenisnya, tetapi sejumlah besar pengaturan membantu untuk mempertahankan pekerjaan.  Dengan jumlah pecahan replika yang cukup, jika simpul jatuh, ini tidak mempengaruhi pekerjaan secara keseluruhan. <br><br>  Standard Elasticsearch juga memiliki sejumlah add-on yang tersedia, termasuk X-Pack, fitur audit, ACL granular, pemantauan, dan peringatan.  Sebagian besar X-Pack baru-baru ini menjadi gratis, mungkin sebagai tanggapan terhadap kebijakan lisensi Splunk yang baru. <br><br><h2>  Pekerjaan Pencarian Elastik Amazon </h2><br>  Seperti biasa, Amazon mengambil kode sumber terbuka untuk bagian dari Elasticsearch, membuat persimpangan yang sulit dan mulai menjualnya sebagai layanannya sendiri, secara bertahap memperkenalkan versi fungsinya sendiri yang selama bertahun-tahun telah tersedia dengan satu atau lain cara dalam versi utama Elasticsearch. <br>  Produk Amazon tidak memiliki banyak hal, seperti: RBAC dan audit, yang sangat bermasalah bagi kami, karena kami menerima log dari tim yang berbeda dan ingin memisahkan mereka satu sama lain.  Saat ini, setiap pengguna yang memiliki akses ke Elasticsearch memiliki semua hak akses dan dapat secara tidak sengaja menghapus data orang lain, mengubah cara mereka direplikasi pada node dan sepenuhnya berhenti menerima data dengan menambahkan templat pengindeksan yang salah. <br><br>  Ini membuat frustrasi, tapi ini bukan masalah terbesar dengan layanan.  Pecahan Penyeimbang - konsep sentral dari Elasticsearch - tidak berfungsi dalam implementasi AWS, yang meniadakan hampir semua hal baik di Elasticsearch. <br><br>  Biasanya, ketika data ditambahkan ke node, satu dapat mengisi lebih dari yang lain.  Ini diharapkan karena tidak ada jaminan bahwa catatan yang dimuat akan berukuran sama atau bahwa jumlah pecahan akan selalu didistribusikan secara merata di semua node cluster.  Ini tidak kritis, karena Elasticsearch dapat menyeimbangkan kembali pecahan antar node, dan jika satu node benar-benar penuh, maka node lain akan dengan senang hati mulai menerima data alih-alih diisi. <br><br>  Ini tidak didukung di Amazon.  Beberapa node dapat mengisi (jauh) lebih cepat daripada yang lain. <br><br>  Selain itu, <b>di Amazon, jika satu simpul di gugus Elasticsearch Anda tidak memiliki cukup ruang kosong, seluruh gugus berhenti menerima data</b> , ia akan berhenti sepenuhnya.  Solusi Amazon adalah membiarkan pengguna melewati mimpi buruk dengan mengubah secara berkala jumlah pecahan dalam templat pengindeksan mereka, dan kemudian mengindeks ulang data yang dibuat sebelumnya ke dalam indeks baru, menghapus indeks sebelumnya dan, jika perlu, membalikkan pengindeksan data ke dalam struktur sebelumnya.  Ini sepenuhnya berlebihan, dan mensyaratkan, di samping biaya komputasi yang besar, salinan yang belum diproses dari data yang diunduh disimpan dengan catatan yang dianalisis, karena salinan yang tidak diproses akan diperlukan untuk pengindeksan ulang.  Dan, tentu saja, ini menggandakan jumlah memori yang dibutuhkan untuk pekerjaan "normal" pada AWS. <br><br>  "Ups!  Saya tidak cukup sering mengindeks ulang seluruh kluster, dan simpulnya penuh!  Apa yang harus dilakukan? " <br><br>  Anda memiliki dua opsi.  Pertama, hapus data sebanyak yang diperlukan untuk menghidupkan kembali kluster, dan kemudian mulai mengindeks kembali dengan harapan bahwa tidak ada yang akan berantakan.  Apakah Anda memiliki cadangan dari apa yang ingin Anda hapus? <br><br>  Opsi kedua adalah menambahkan lebih banyak node ke cluster atau mengubah ukuran yang sudah ada ke ukuran instance yang lebih besar. <br><br>  Tapi tunggu, bagaimana cara menambahkan node atau membuat perubahan jika pecahan tidak dapat diseimbangkan kembali? <br><br>  Solusi Amazon adalah penyebaran biru-hijau.  Mereka memutar seluruh cluster baru, menyalin seluruh konten dari cluster sebelumnya ke yang baru, dan kemudian beralih dan hancurkan cluster lama. <br><br>  Mengubah ukuran tugas seperti itu bisa memakan waktu berhari-hari, untuk kelompok besar, seperti yang dapat Anda bayangkan, menduplikasi beberapa triliun catatan bisa memakan waktu.  Ini juga menciptakan beban gila pada cluster yang ada (mungkin sudah melebihi kapasitas) dan benar-benar dapat menyebabkan cluster gagal.  Saya melakukan beberapa operasi serupa di lebih dari 30 cluster di AWS dan hanya sekali saya mengamati penyelesaian yang sukses dalam mode otomatis. <br><br>  Jadi, Anda mencoba mengubah ukuran cluster Anda, dan tugas tidak selesai.  Apa sekarang? <br><br><h2>  Interaksi Amazon </h2><br>  Tugas Anda mengubah ukuran cluster terganggu (untuk layanan yang Anda pilih untuk tidak berurusan dengan artikel seperti itu), sehingga Anda membuka tiket ke dukungan teknis AWS dengan prioritas tertinggi.  Tentu saja, mereka akan mengeluh tentang jumlah atau ukuran beling Anda dan akan menambahkan tautan ke "praktik terbaik" yang telah Anda baca 500 kali.  Dan kemudian Anda menunggu untuk diperbaiki.  Dan tunggu  Dan tunggu  Terakhir kali saya mencoba mengubah ukuran cluster, dan itu diblokir, yang menyebabkan kegagalan fungsi yang serius, butuh TUJUH HARI untuk mengembalikan semuanya secara online.  Mereka memulihkan cluster itu sendiri dalam beberapa hari, tetapi ketika semuanya berhenti, jelas bahwa node yang menjalankan Kibana telah kehilangan kontak dengan cluster utama.  Dukungan AWS menghabiskan empat hari lagi untuk mencoba memperbaiki sesuatu sambil bertanya-tanya apakah Kibana bekerja.  Mereka bahkan tidak tahu apakah mereka telah memperbaiki masalah, dan saya harus memeriksa apakah mereka telah memulihkan komunikasi antara sistem mereka sendiri.  Sejak itu saya berhenti melakukan apa pun selain menghapus data jika node penuh. <br><br>  Biaya organisasi kami di AWS sangat besar.  Ini memberi kami kesempatan untuk bertemu secara berkala dengan para ahli mereka di berbagai bidang, mendiskusikan strategi implementasi dan menangani berbagai masalah teknis.  Kami membuat janji dengan perwakilan Elasticsearch, di mana saya menghabiskan sebagian besar pertemuan menjelaskan dasar-dasar Elasticsearch dan menjelaskan ... keanehan ... dari produk mereka.  Pakar sangat terkejut bahwa semuanya runtuh ketika node penuh.  Jika pakar yang dikirim tidak mengetahui dasar-dasar produknya, tidak mengherankan bahwa tim pendukung memerlukan tujuh hari untuk melanjutkan kluster produksi. <br><br><h2>  Pikiran akhirnya </h2><br>  Dalam proyek logging, yang saya masukkan ke dalamnya, ada sebagian kesalahan arsitektur dan keputusan desain yang lemah yang sedang kami kerjakan.  Dan tentu saja, saya berharap AWS Elasticsearch berbeda dari produk aslinya.  Namun, dalam AWS Elasticsearch, banyak fungsi mendasar dinonaktifkan atau hilang sehingga memperburuk hampir semua masalah yang kita temui. <br><br>  Untuk cluster yang mudah digunakan dan kecil, AWS Elasticsearch bekerja cukup baik, tetapi untuk cluster berukuran petabyte, itu adalah mimpi buruk yang tak ada habisnya. <br><br>  Saya sangat ingin tahu mengapa implementasi Elasticsearch Amazon tidak dapat menyeimbangkan pecahan;  ini adalah fungsi Elasticsearch yang cukup mendasar.  Bahkan dengan keterbatasan dibandingkan dengan Elasticsearch utama, itu pasti akan menjadi produk yang dapat diterima untuk kelompok besar jika hanya berfungsi dengan baik.  Saya tidak bisa mengerti mengapa Amazon menawarkan sesuatu yang sangat rusak, dan mengapa mereka belum memperbaiki situasi dalam lebih dari dua tahun. <br><br>  Seperti yang disarankan orang lain, dan tampaknya masuk akal, perilaku ini adalah tanda implementasi AWS, yang dirancang sebagai cluster multi-tenant raksasa, berusaha memberikan isolasi agar terlihat seperti cluster yang berdiri sendiri untuk pengguna akhir.  Bahkan dengan opsi seperti data terenkripsi saja dan transfer data terenkripsi, ini tampaknya masuk akal.  Atau mungkin alat dan konfigurasi mereka hanyalah warisan dari arsitektur yang jauh sebelumnya. <br><br>  Dan, seperti yang dikatakan teman saya, cukup lucu bahwa mereka masih menyebutnya "Fleksibel" ketika Anda tidak dapat menambah atau menghapus node dari cluster Anda tanpa memutar yang baru dan mentransfer semua data Anda. <br><br>  Catatan kaki: ketika saya menulis teks ini, saya menemukan posting dua tahun lalu dengan banyak klaim serupa: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">read.acloud.guru/things-you-should-know-before-using-awss-elasticsearch-service-7cd70c9afb4f</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id473976/">https://habr.com/ru/post/id473976/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id473960/index.html">Strategi Pelokalan Konten</a></li>
<li><a href="../id473962/index.html">Mode gelap sekarang ada di mana-mana. Apakah ini sangat berguna? (di akhir post survey)</a></li>
<li><a href="../id473966/index.html">Atas permintaan Pengembang Tertanam: Mendeteksi Kesalahan di Amazon FreeRTOS</a></li>
<li><a href="../id473972/index.html">Atas perintah pengembang Tertanam: mencari bug di Amazon FreeRTOS</a></li>
<li><a href="../id473974/index.html">Intercom'19 - sebuah konferensi tentang otomatisasi komunikasi dari Voximplant akan diadakan pada 14 November</a></li>
<li><a href="../id473978/index.html">Seperti rasa sakit, rasa sakit, kasir sebagai layanan 2: 0</a></li>
<li><a href="../id473980/index.html">Teknologi dan dunia nyata: 4 Start-up yang mengubah masa depan desain interior</a></li>
<li><a href="../id473982/index.html">NB-IoT: bagaimana cara kerjanya? Bagian 3: SCEF - jendela akses tunggal ke layanan operator</a></li>
<li><a href="../id473984/index.html">Intisari Ilmu Data (Oktober 2019)</a></li>
<li><a href="../id473986/index.html">“Impian saya adalah melihat seseorang melalui pepohonan” - pendiri Lisa Alert tentang teknologi pencarian modern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>