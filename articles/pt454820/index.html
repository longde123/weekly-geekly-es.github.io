<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÇüèø üïì üêÖ Pesquisa do Azure ü•à ü•´ üíí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Se algum de seus projetos usar os dados armazenados no banco de dados Azhurov, √© bem poss√≠vel que voc√™ tenha a oportunidade de usar a pesquisa de dado...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pesquisa do Azure</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454820/"><p><img src="https://habrastorage.org/webt/dd/li/cx/ddlicxgiqvi5vlyllvf2hgklivs.jpeg"></p><br><p>  Se algum de seus projetos usar os dados armazenados no banco de dados Azhurov, √© bem poss√≠vel que voc√™ tenha a oportunidade de usar a pesquisa de dados usando a pesquisa do Azure.  Voc√™ pode pesquisar n√£o apenas por bancos de dados (Azure Cosmos DB, Banco de Dados SQL do Azure, SQL Server hospedado em uma VM do Azure), mas tamb√©m pelo Blob (Armazenamento de Blob do Azure, Armazenamento de Tabela do Azure). </p><br><p>  A pesquisa possui uma tarifa gratuita, que permite criar at√© tr√™s √≠ndices com um tamanho total de at√© 50 Mb.  A tarifa gratuita n√£o possui recursos de balanceamento de carga, mas √© bastante adequada para uso. </p><a name="habracut"></a><br><p> Lidar com a pesquisa me pareceu bastante simples (embora nem sempre seja √≥bvio).  Existem 3 tipos de objetos: fonte de dados, √≠ndice e indexador.  O objeto principal, talvez, √© o √≠ndice.  √â ele quem √© respons√°vel por como pesquisar e o que exatamente procurar.  A fonte de dados √© uma conex√£o de dados e o indexador √© um trabalho que atualiza os dados do √≠ndice. </p><br><p>  A interface do usu√°rio do portal permite importar dados e criar todos os tr√™s objetos.  A oportunidade estar√° de passagem e acrescentar√° recursos cognitivos √† pesquisa.  Se o banco de dados SQL estiver na assinatura, voc√™ poder√° selecion√°-lo ao criar a fonte de dados.  Embora a senha, por algum motivo, voc√™ ainda precise digitar.  Se voc√™ deseja usar o Cosmos DB, precisar√° inserir a cadeia de conex√£o manualmente.  N√£o se esque√ßa de indicar na linha e no banco de dados, adicionando no final da linha Database = YOUR_BASE_NAME </p><br><p>  Depois de escolher uma fonte de dados, voc√™ ser√° solicitado a usar os recursos de pesquisa cognitiva.  O conjunto de habilidades padr√£o ainda √© muito pequeno: voc√™ pode definir o idioma, extrair nomes, nomes de organiza√ß√µes, lugares e frases-chave.  H√° tamb√©m uma oportunidade interessante para determinar a natureza do texto para emo√ß√µes positivas ou negativas usando a detec√ß√£o de sentimentos.  Essa habilidade deve ser conveniente para uso com an√°lises de produtos em lojas online.  √â poss√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">criar sua pr√≥pria habilidade</a> usando a descri√ß√£o da API. </p><br><p><img src="https://habrastorage.org/webt/r6/wh/4x/r6wh4xtuxatvapppu0wxw2lh67k.png"></p><br><p>  Para arquivos enviados para o blob, o OCR (reconhecimento √≥ptico de caracteres) √© poss√≠vel.  √â poss√≠vel o reconhecimento de texto manuscrito (at√© agora apenas em ingl√™s) e impresso.  Usando servi√ßos cognitivos, √© poss√≠vel identificar v√°rios objetos na foto.  Por exemplo, lugares famosos ou celebridades. </p><br><p>  O pr√≥ximo passo √© criar um √≠ndice.  A √∫nica op√ß√£o para o <strong>modo de pesquisa</strong> hoje em dia √© "analysisInfixMatching" </p><br><p><img src="https://habrastorage.org/webt/aq/qg/6l/aqqg6ln6ptkzoqgpnizcp2cuezu.png"></p><br><p>  Nesse ponto, voc√™ pode marcar as caixas pr√≥ximas aos campos da sua tabela ou adicionar um novo campo ao √≠ndice.  Apenas no caso, explicarei as possibilidades dos campos: </p><br><p>  <strong>Recuper√°vel</strong> - o campo estar√° presente nos resultados da pesquisa <br>  <strong>Filtr√°vel</strong> - o valor do campo pode ser filtrado <br>  <strong>Classific√°vel</strong> - voc√™ pode classificar o resultado por este campo <br>  <strong>Facetable</strong> - um tipo de agrupamento de acordo com certas caracter√≠sticas.  Por exemplo, usando a seguinte express√£o facet = listPrice, values: 10 | 25 | 100 | 500 | 1000 | 2500, √© poss√≠vel obter a seguinte divis√£o dos resultados em grupos </p><br><p><img src="https://habrastorage.org/webt/pp/8d/wn/pp8dwnctx7vgllop2h-hsmboqqu.png"></p><br><p>  <strong>Pesquis√°vel</strong> - este campo pesquisar√° </p><br><p>  O campo <strong>Analisador</strong> sugere a escolha de um analisador para v√°rios idiomas.  2 vers√µes s√£o usadas - <em>Lucene</em> e <em>Microsoft</em> .  Para entender qual √© a diferen√ßa, voc√™ precisa entender qual √© a diferen√ßa entre os dois termos a seguir: </p><br><p>  <em>Stamming</em> √© o processo de encontrar a base de uma palavra para uma determinada palavra-fonte.  Caule (ingl√™s) - caule, caule, origem.  Stemming usa algoritmos.  Freq√ºentemente trunca as palavras removendo sufixos e termina√ß√µes, obtendo a base da palavra. <br>  <em>Lematiza√ß√£o</em> √© o processo de reduzir uma forma de palavra a um lema - sua forma normal (vocabul√°rio).  O lema √© a forma b√°sica can√¥nica da palavra.  A lematiza√ß√£o usa uma pesquisa de dicion√°rio contendo v√°rias formas de palavras. </p><br><p>  O analisador Lucene usa o stemming.  O analisador da Microsoft usa lematiza√ß√£o. <br>  Por padr√£o, se nada for selecionado, o Lucene ser√° usado.  Mas se voc√™ estiver procurando dados em um idioma espec√≠fico, √© indiscutivelmente melhor usar um analisador para esse idioma. </p><br><p>  <strong>Suggester</strong> - permite dar dicas com documentos contendo o texto digitado usando as letras iniciais da pesquisa. </p><br><p>  Se voc√™ estiver usando o testador na Pesquisa do Azure no aplicativo cliente, ter√° duas op√ß√µes para us√°-lo: o pr√≥prio <em>contador</em> ou o <em>preenchimento autom√°tico</em> .  Em resumo, o prompt sugere completamente toda a linha do campo da tabela e o preenchimento autom√°tico oferece apenas a conclus√£o de uma palavra ou express√£o a partir de algumas palavras.  O melhor artigo sobre as diferen√ßas entre os modos de prompt e preenchimento autom√°tico √© descrito no seguinte artigo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Preenchimento autom√°tico na Pesquisa do Azure agora em visualiza√ß√£o p√∫blica</a> Este artigo tem gifs muito visuais. </p><br><p>  No est√°gio de cria√ß√£o do <strong>indexador,</strong> voc√™ deve especificar uma <em>coluna de marca d'√°gua alta</em> .  Este √© um campo que muda toda vez que um registro √© alterado.  Geralmente, isso √© algo como um campo com a data da √∫ltima altera√ß√£o ou um campo _ts no Cosmos DB.  Durante a indexa√ß√£o, se o valor do campo for alterado, o √≠ndice tamb√©m ser√° alterado. </p><br><p><img src="https://habrastorage.org/webt/sb/-v/-y/sb-v-yttwlbx9lebmpzm5__wyjc.png"></p><br><p>  Excluir <strong>exclus√µes de faixas</strong> √© uma op√ß√£o para excluir entradas do √≠ndice automaticamente.  Mas para isso, voc√™ deve ter a exclus√£o virtual configurada no seu banco de dados.  Se voc√™ usar a exclus√£o suave, ao excluir um registro, ele n√£o ser√° exclu√≠do, mas simplesmente marcado como exclu√≠do.  A op√ß√£o padr√£o √© adicionar o campo isDeleted ao banco de dados e configur√°-lo como true se o registro for exclu√≠do. <br>  Como alternativa, sempre que voc√™ excluir uma entrada do banco de dados, poder√° enviar uma solicita√ß√£o de exclus√£o da pesquisa para a API de Pesquisa do Azure.  Nesse caso, a caixa de sele√ß√£o Exclus√µes do Trak pode ser omitida.  Mas eu realmente n√£o gosto dessa op√ß√£o, porque se a solicita√ß√£o de exclus√£o n√£o funcionar, o registro permanecer√° no √≠ndice.  Quanto a mim, n√£o h√° oportunidade suficiente para reconstruir o √≠ndice uma vez em um determinado per√≠odo de tempo completamente. </p><br><p>  Apesar de toda a conveni√™ncia do portal, ap√≥s a cria√ß√£o, voc√™ pode adicionar alguns novos campos ao √≠ndice, mas n√£o pode alterar os existentes.  O que fazer se voc√™ precisar mudar alguma coisa?  Voc√™ pode recriar o √≠ndice.  Exclua o existente e crie um novo contendo as altera√ß√µes necess√°rias.  Usar o portal para fazer isso √© uma tarefa bastante sombria.  Eu uso a API para esses fins.  Usando um aplicativo como o Postman, √© poss√≠vel obter o JSON do √≠ndice e us√°-lo para gravar uma solicita√ß√£o de cria√ß√£o de √≠ndice.  S√≥ √© necess√°rio fazer pequenas altera√ß√µes (por exemplo, remova os campos do sistema "@ odata.context" e "@ odata.etag"). </p><br><p>  Para trabalhar com a API, voc√™ precisa pegar a chave do portal, que deve ser adicionada ao cabe√ßalho de cada solicita√ß√£o da API.  A chave √© retirada aqui: </p><br><p><img src="https://habrastorage.org/webt/gb/4q/do/gb4qdotcdf2hz3d_busivo1tal4.png"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Uma consulta para obter dados do √≠ndice</a> √©: </p><br><pre><code class="plaintext hljs">GET https://[service name].search.windows.net/indexes/[index name]?api-version=[api-version]</code> </pre> <br><p>  <code>api-key: [admin key]</code> deve ser adicionada ao cabe√ßalho <code>api-key: [admin key]</code> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√â</a> poss√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">criar um √≠ndice</a> usando uma das duas consultas a seguir: </p><br><pre> <code class="plaintext hljs">POST https://[servicename].search.windows.net/indexes?api-version=[api-version] Content-Type: application/json api-key: [admin key]</code> </pre> <br><p>  ou </p><br><pre> <code class="plaintext hljs">PUT https://[servicename].search.windows.net/indexes/[index name]?api-version=[api-version]</code> </pre> <br><p>  No corpo, voc√™ deve especificar JSON com o conte√∫do do √≠ndice.  A vers√£o mais recente no momento √© 06-05-2019 e antes de ser usada por um longo per√≠odo de tempo 2017-11-11 </p><br><p>  Trabalhando com a API, voc√™ pode usar alguns recursos de pesquisa que n√£o est√£o dispon√≠veis no portal. </p><br><p>  Para dar prioridade a alguns campos na pesquisa, voc√™ pode usar <strong>perfis de pontua√ß√£o</strong> . </p><br><p>  O seguinte JSON adicionado √† solicita√ß√£o fornece ao campo "title" uma vantagem dupla sobre o campo "info": </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scoringProfiles"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"profileForTitle"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"document"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"weights"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, ‚Äúinfo<span class="hljs-attr"><span class="hljs-attr">": 1 } } ]</span></span></code> </pre> <br><p>  Al√©m da capacidade de priorizar alguns campos usando pesos, √© poss√≠vel usar algumas fun√ß√µes predefinidas: frescura, magnitude, dist√¢ncia e tag. </p><br><p>  <strong>O frescor √©</strong> usado apenas nos campos DateTime e permite que voc√™ exiba os registros mais recentes na pesquisa.  <strong>A magnitude √©</strong> usada com campos int e double.  Bem, e adequadamente, essa fun√ß√£o √© boa para usar com campos que armazenam pre√ßos, o n√∫mero de downloads e outras informa√ß√µes num√©ricas.  <strong>A dist√¢ncia √©</strong> usada apenas em campos como Edm.GeographyPoint e √© aumentada em uma pesquisa por dist√¢ncia de um local espec√≠fico.  Se a <strong>tag</strong> for especificada como o tipo de fun√ß√£o, os documentos que contenham tags que aparecem na cadeia de pesquisa ser√£o gerados na pesquisa. </p><br><p>  Uma das op√ß√µes mais populares √© pegar os documentos mais recentes em uma pesquisa como esta: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"scoringProfiles"</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"newDocs"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"functions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"freshness"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fieldName"</span></span>: <span class="hljs-string"><span class="hljs-string">"documentDate"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"boost"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interpolation"</span></span>: <span class="hljs-string"><span class="hljs-string">"quadratic"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"freshness"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"boostingDuration"</span></span>: <span class="hljs-string"><span class="hljs-string">"P7D"</span></span> } } ] } ]</code> </pre> <br><p>  Os documentos cujo campo documentDate cont√©m a data dos √∫ltimos sete dias ("P7D") ser√£o levantados. </p><br><p>  Depois de criar um perfil de pontua√ß√£o, voc√™ pode especificar seu nome em solicita√ß√µes.  Somente neste caso, os campos necess√°rios ser√£o gerados na pesquisa. </p><br><p>  Leia mais na documenta√ß√£o oficial: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Adicionar perfis de pontua√ß√£o a um √≠ndice do Azure Search</a> </p><br><h3 id="data-change-detection-policy">  Pol√≠tica de detec√ß√£o de altera√ß√µes de dados </h3><br><p>  A API fornece um pouco mais de recursos para a fonte de dados.  Como voc√™ pode ler acima, ao criar uma fonte de dados, voc√™ pode especificar um campo pelo qual determinar se os dados foram alterados.  Na forma de JSON, fica assim: </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"dataChangeDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.HighWaterMarkChangeDetectionPolicy"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"highWaterMarkColumnName"</span></span> : <span class="hljs-string"><span class="hljs-string">"[a rowversion or last_updated column name]"</span></span> }        soft delete     policy: <span class="hljs-string"><span class="hljs-string">"dataDeletionDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.SoftDeleteColumnDeletionDetectionPolicy"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"softDeleteColumnName"</span></span> : <span class="hljs-string"><span class="hljs-string">"IsDeleted"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"softDeleteMarkerValue"</span></span> : <span class="hljs-string"><span class="hljs-string">"true"</span></span> }</code> </pre> <br><p>  Se voc√™ usa o SQL Server e seu banco de dados oferece suporte ao acompanhamento de altera√ß√µes, os registros exclu√≠dos podem ser exclu√≠dos do √≠ndice automaticamente.  A especifica√ß√£o de highWaterMarkColumnName nesse caso n√£o √© necess√°ria.  Basta especificar SqlIntegratedChangeTrackingPolicy em vez de HighWaterMarkChangeDetectionPolicy </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"dataChangeDetectionPolicy"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"@odata.type"</span></span> : <span class="hljs-string"><span class="hljs-string">"#Microsoft.Azure.Search.SqlIntegratedChangeTrackingPolicy"</span></span> }</code> </pre> <br><p>  √â muito conveniente  Mas existem nuances que n√£o permitem aproveitar esse recurso completamente. </p><br><p>  Primeiro, SqlIntegratedChangeTrackingPolicy n√£o pode ser usado com visualiza√ß√µes.  Em segundo lugar, a tabela n√£o deve ter chaves prim√°rias compostas.  Escusado ser√° dizer que a vers√£o do SQL Server deve ser mais ou menos nova.  E, finalmente, o controle de altera√ß√µes deve estar ativado para o banco de dados e as tabelas usadas pela pesquisa.  Para o banco de dados, ele √© ativado assim: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> AdventureWorks2012 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> CHANGE_TRACKING = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> (CHANGE_RETENTION = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DAYS</span></span>, AUTO_CLEANUP = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  E para a mesa assim: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> Person.Contact <span class="hljs-keyword"><span class="hljs-keyword">ENABLE</span></span> CHANGE_TRACKING <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (TRACK_COLUMNS_UPDATED = <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>)</code> </pre> <br><p>  Mas isso n√£o √© tudo.  √â altamente recomend√°vel que voc√™ ative o isolamento de instant√¢neo para a base. </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> AdventureWorks2012 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> ALLOW_SNAPSHOT_ISOLATION <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span>;</code> </pre> <br><p>  Al√©m de dan√ßar com um pandeiro ao instalar o Change Traking para o banco de dados para mim, a desvantagem √© a incapacidade de usar visualiza√ß√µes.  Ent√£o, eu ainda geralmente tenho que usar o HighWaterMarkChangeDetectionPolicy </p><br><h3 id="poisk-po-dannym">  Pesquisa de dados </h3><br><p>  Por padr√£o, a pesquisa do Azure usa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sintaxe de consulta simples</a> .  Pode n√£o parecer surpreendente, mas √© bastante simples: </p><br><p>  <strong>wifi + luxo</strong> pesquisa pelas palavras wifi e luxo ao mesmo tempo <br>  <strong>"hotel de luxo" est√°</strong> procurando a frase <br>  <strong>wifi |</strong>  <strong>luxo est√°</strong> procurando a palavra wifi ou a palavra luxo <br>  <strong>wifi - luxo</strong> procura textos com a palavra wifi, mas sem a palavra luxo <br>  <strong>lux</strong> procura por palavras que come√ßam com lux </p><br><p>  √â poss√≠vel combinar regras de pesquisa usando par√™nteses.  Por exemplo, a regra <strong>motel + (wifi | luxo)</strong> pesquisa a palavra motel e a palavra wifi ou a palavra luxo </p><br><p>  √â bom que a Pesquisa do Azure possa usar a sintaxe do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lucene</a> .  Para us√°-lo, √© necess√°rio adicionar <strong>queryType = full √† consulta de</strong> pesquisa </p><br><p>  A diferen√ßa entre o Azure e a sintaxe cl√°ssica do Lucene √© apenas na aus√™ncia de intervalo. </p><br><p>  Portanto, na Pesquisa do Azure, voc√™ n√£o pode: <code>mod_date:[20020101 TO 20030101]</code> </p><br><p>  Mas na Pesquisa do Azure, voc√™ pode usar $ filter com sintaxe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ODATA</a> .  Aqui est√° um exemplo de filtro: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Scott"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"filter"</span></span>: <span class="hljs-string"><span class="hljs-string">"(age ge 25 and and lt 50) or surname eq 'Guthrie'"</span></span> }</code> </pre> <br><p>  Os filtros tamb√©m podem ser usados ‚Äã‚Äãcom sintaxe de consulta simples. </p><br><p>  No Lucene, a l√≥gica ‚Äúou‚Äù √© implementada usando <strong>OR</strong> ou <strong>||</strong> <br>  Ambos os valores podem ser encontrados especificando a instru√ß√£o "e" com: <strong>AND</strong> , <strong>&amp;&amp;</strong> ou <strong>+</strong> <br>  Para "not", voc√™ pode usar um dos seguintes: <strong>NOT ,!</strong>  ou <strong>-</strong> </p><br><p>  A instru√ß√£o "not" possui um recurso comum para sintaxe simples e Lucene.  Seu comportamento depende do modo de pesquisa, que pode ser definido em <strong>searchMode = all</strong> e em <strong>searchMode = any</strong> (esse valor √© usado por padr√£o).  Em qualquer modo, a pesquisa por wifi -luxury encontrar√° documentos com a palavra wifi ou documentos sem a palavra luxo.  No modo todos, pela mesma solicita√ß√£o, ele encontrar√° docas com a palavra wifi e simultaneamente sem a palavra luxo. </p><br><p>  Vejamos alguns recursos interessantes do Lucene. </p><br><p>  <strong>A pesquisa difusa</strong> permite pesquisar palavras que diferem da pesquisa por uma ou mais letras.  Ou seja, ajuda a lidar com erros de digita√ß√£o.  Por exemplo, uma pesquisa por "azul ~" ou "azul ~ 1" retornar√° voc√™ com "azul" e "azul" e at√© "cola".  Mas, ao mesmo tempo, uma pesquisa por "analista de neg√≥cios ~" significa neg√≥cios ou analista <br>  <strong>A proximidade</strong> permite procurar palavras pr√≥ximas.  Por exemplo, "hotel aeroporto" ~ 5 encontrar√° as palavras "hotel" e "aeroporto", que est√£o localizadas no texto a n√£o mais de 5 palavras uma da outra. <br>  <strong>O aumento de termos</strong> permite definir a prioridade de uma palavra na pesquisa.  Exemplo: "rock ^ 2 electronic" pesquisa as palavras rock e electronic, mas as entradas com a palavra rock na pesquisa ser√£o exibidas acima. <br>  <strong>Express√µes regulares</strong> - usando express√µes regulares.  Tudo aqui est√° de acordo com a documenta√ß√£o oficial do Lucene regex.  Voc√™ pode encontr√°-la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no seguinte link</a> .  Ao pesquisar, express√µes regulares devem ser colocadas entre barras "/".  Por exemplo, assim: / [mh] otel / </p><br><p>  Se sua sequ√™ncia de caracteres de pesquisa contiver caracteres especiais, eles dever√£o ser escapados com uma barra invertida.  Caracteres de exemplo a serem escapados: <strong>+ - &amp;&amp; ||!</strong>  <strong>() {} [] ^ "~ * ?: \ /</strong> <br>  A pesquisa pode ser feita usando uma solicita√ß√£o GET.  O exemplo oficial √© este: </p><br><pre> <code class="plaintext hljs">GET /indexes/hotels/docs?search=category:budget AND \"recently renovated\"^3&amp;searchMode=all&amp;api-version=2019-05-06&amp;querytype=full</code> </pre> <br><p>  Mas voc√™ pode usar uma solicita√ß√£o POST com o corpo.  Novamente, um exemplo oficial: </p><br><pre> <code class="plaintext hljs">POST /indexes/hotels/docs/search?api-version=2019-05-06 { "search": "category:budget AND \"recently renovated\"^3", "queryType": "full", "searchMode": "all" }</code> </pre> <br><p>  Se voc√™ estiver usando uma solicita√ß√£o GET ou POST com o tipo de dados application / x-www-form-urlencoded, precisar√° codificar caracteres n√£o seguros e reservados. </p><br><p>  S√≠mbolos  <strong>/?: @ = &amp;</strong> est√£o reservados <br>  Os caracteres <strong>`` &lt;&gt; #% {} | \ ^ ~ []</strong> n√£o s√£o seguros. <br>  Por exemplo, o s√≠mbolo # se tornar√°% 23 e o s√≠mbolo?  torna-se% 3F </p><br><h3 id="para-ssylok-dlya-razrabotchikov">  Alguns links para desenvolvedores. </h3><br><p>  Se o .NET for um desenvolvedor, voc√™ poder√° usar o pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Microsoft.Azure.Search</a> NuGet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">.</a> Al√©m disso, existem exemplos no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NodeJS</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Java</a> . </p><br><p>  Um exemplo de um aplicativo simples no .NET Core, voc√™ pode encontrar aqui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo de pesquisa do ASP.NET Core Azure</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt454820/">https://habr.com/ru/post/pt454820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt454806/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 9. O mundo f√≠sico dos switches. Parte 1</a></li>
<li><a href="../pt454808/index.html">Sobre espa√ßonaves e espa√ßo. Como criar um recurso alterando todo o produto ao longo do caminho</a></li>
<li><a href="../pt454810/index.html">Ar fresco em Marte: dobre uma mol√©cula de CO2 e obtenha oxig√™nio</a></li>
<li><a href="../pt454816/index.html">Configurando o pacote php-fpm + nginx no WSL</a></li>
<li><a href="../pt454818/index.html">Desafio Rekko - como conquistar o 2¬∫ lugar na competi√ß√£o pela cria√ß√£o de sistemas de recomenda√ß√£o</a></li>
<li><a href="../pt454824/index.html">O amplificador operacional mais simples em elementos discretos</a></li>
<li><a href="../pt454826/index.html">Reduza os backups em 99,5% com hashget</a></li>
<li><a href="../pt454828/index.html">Criando uma imagem em mosaico</a></li>
<li><a href="../pt454830/index.html">3 principais qualidades para um gerente de produto de sucesso: Alexander Belyaev</a></li>
<li><a href="../pt454832/index.html">Por que uma semana de trabalho de quatro dias √© um p√©ssimo conto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>