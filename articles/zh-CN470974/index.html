<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈵 🧡 ⛳️ 分析师掌握的被动DNS 👼🏽 🏐 ♿️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="域名系统（DNS）是一种电话簿，可将用户友好的名称（例如“ ussc.ru”）转换为IP地址。 由于DNS活动几乎存在于所有通信会话中，而与协议无关。 因此，DNS日志记录对于信息安全专家而言是宝贵的数据源，使他们可以检测异常或获取有关正在研究的系统的其他数据。 


 2004年，弗洛里安·韦默（...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>分析师掌握的被动DNS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470974/"><p> 域名系统（DNS）是一种电话簿，可将用户友好的名称（例如“ ussc.ru”）转换为IP地址。 由于DNS活动几乎存在于所有通信会话中，而与协议无关。 因此，DNS日志记录对于信息安全专家而言是宝贵的数据源，使他们可以检测异常或获取有关正在研究的系统的其他数据。 </p><br><p> 2004年，弗洛里安·韦默（Florian Weimer）提出了一种称为“被动DNS”的日志记录方法，该方法允许您通过索引和搜索功能来还原DNS数据更改的历史记录，从而可以访问以下数据： </p><br><ul><li> 域名名称 </li><li> 所请求域名的IP地址 </li><li> 答复日期和时间 </li><li> 回应类型 </li><li> 等 </li></ul><br><p> 从具有内置模块的递归DNS服务器或通过拦截负责该区域的DNS服务器的响应来收集被动DNS的数据。 </p><br><img src="https://habrastorage.org/webt/zt/vg/gj/ztvggj6s1bxlduk5nfyw7cv0dy4.png" alt="图片"><br><p>  <i>图1.被动DNS（摘自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ctovision.com</a> ）</i> </p><a name="habracut"></a><br><p> 被动DNS的独特之处在于，无需注册客户端的IP地址，这有助于保护用户隐私。 </p><br><p> 目前，有许多服务可提供对被动DNS数据的访问： </p><br><div class="scrollable-table"><table><tbody><tr><th></th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DNS数据库</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">病毒总数</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">被动总</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">章鱼</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安全追踪</a> </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">伞调查</a> </th></tr><tr><td>  <b>公司介绍</b> </td><td>  Farsight安全 </td><td> 病毒总数 </td><td> 风险号 </td><td> 安全DNS </td><td> 安全追踪 </td><td> 思科公司 </td></tr><tr><td>  <b>访问权限</b> </td><td> 根据要求 </td><td> 无需注册 </td><td> 免费注册 </td><td> 根据要求 </td><td> 无需注册 </td><td> 根据要求 </td></tr><tr><td>  <b>API</b> </td><td> 存在 </td><td> 存在 </td><td> 存在 </td><td> 存在 </td><td> 存在 </td><td> 存在 </td></tr><tr><td>  <b>客户可用性</b> </td><td> 存在 </td><td> 存在 </td><td> 存在 </td><td> 不见了 </td><td> 不见了 </td><td> 不见了 </td></tr><tr><td>  <b>开始收集数据</b> </td><td>  2010年 </td><td>  2013年 </td><td>  2009年 </td><td> 仅显示最近3个月 </td><td>  2008年 </td><td>  2006年 </td></tr></tbody></table></div><br><p>  <i>表1.可以访问被动DNS数据的服务</i> </p><br><h4> 使用被动DNS的选项 </h4><br><p> 使用被动DNS，可以在域名，NS服务器和IP地址之间建立连接。 这使您可以构建所研究系统的地图，并跟踪从第一次检测到当前时刻的此类地图变化。 </p><br><p> 被动DNS还有助于检测流量异常。 例如，跟踪NS区域中的变化以及A和AAAA之类的记录可以使您使用快速通量方法识别恶意站点，该方法旨在隐藏C＆C使其免受检测和阻止。 由于合法域名（用于负载平衡的域名除外）不会经常更改其IP地址，并且大多数合法区域很少更改其NS服务器。 </p><br><p> 与直接枚举字典中的子域相反，被动DNS甚至可以让您查找最奇特的域名，例如“ 222qmxacaiqaaaaazibq4aaidhmbqaaa0undefined7140c0.p.hoff.ru”。 另外，它有时还允许您查找网站的测试（和易受攻击）区域，开发人员资料等。 </p><br><h4> 使用被动DNS检查信件中的链接 </h4><br><p> 目前，垃圾邮件是攻击者入侵受害者计算机或窃取机密信息的主要方法之一。 让我们尝试使用被动DNS检查此类信件的链接，以评估此方法的有效性。 </p><br><img src="https://habrastorage.org/webt/ok/er/po/okerponr7oatd6mmgunqldthynk.jpeg" alt="图片"><br><p>  <i>图2.垃圾邮件</i> </p><br><p> 这封信的链接指向网站magnit-boss.rocks，该站点提供了自动收集奖金和收取资金的功能： </p><br><img src="https://habrastorage.org/webt/f2/i9/cc/f2i9ccb3lrwvrrkkzzcu-tnmxtk.png" alt="图片"><br><p>  <i>图3. magnit-boss.rocks上托管的页面</i> </p><br><p> 为了研究此站点，使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了Riskiq API</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">该API</a>已经拥有3个现成的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Python</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ruby</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rust</a>客户端。 </p><br><p> 首先，我们将学习此域名的整个历史，为此，我们使用以下命令： </p><br><p>  <i>pt-client pdns --query magnit-boss.rocks</i> </p><br><p> 此命令将显示有关与此域名关联的所有DNS解析的信息。 </p><br><img src="https://habrastorage.org/webt/m4/wn/f6/m4wnf6telpyggxepwd3fwcqlros.png" alt="图片"><br><p>  <i>图4. Riskiq API的响应</i> </p><br><p> 让我们将API的答案以更直观的形式呈现出来： </p><br><img src="https://habrastorage.org/webt/fi/jh/dp/fijhdp0-c8csxrlyejytmcydgr4.png" alt="图片"><br><p>  <i>图5.响应中的所有记录</i> </p><br><p> 为了进一步研究，在接收字母01.08.2019时使用此域名解析的IP地址，这些IP地址是以下地址92.119.113.112和85.143.219.65。 </p><br><p> 使用命令： </p><br><p>  <i>pt-client pdns --query</i> </p><br><p> 您可以获得与这些IP地址关联的所有域名。 <br>  IP地址92.119.113.112有42个唯一的域名解析为该IP地址，其中包括以下名称： </p><br><ul><li>  magnit-boss.club </li><li>  igrovie-avtomaty.me </li><li>  pro-x-audit.xyz </li><li>  zep3-www.xyz </li><li> 和其他 </li></ul><br><p>  IP地址85.143.219.65具有解析为该IP地址的44个唯一域名，其中包括以下名称： </p><br><ul><li>  cvv2.name（用于出售信用卡数据的网站） </li><li>  emaills.world </li><li>  www.mailru.space </li><li> 和其他 </li></ul><br><p> 与这些域名的连接可能暗示着网络钓鱼，但我们相信有好人，因此，我们将尝试获得332501.72卢布的奖金吗？ 点击“是”按钮后，网站要求我们从卡中转出300卢布以解锁帐户，然后将我们发送至as-torpay.info以输入数据。 </p><br><img src="https://habrastorage.org/webt/em/ng/e-/emnge-q11hjwa-v_km4fekbv5xc.png" alt="图片"><br><p>  <i>图6. Ac-pay2day.net主页</i> </p><br><p> 它看起来像合法的网站，有一个https证书，并且主页提供了将该付款系统连接到您的网站的功能，但是，所有连接的链接都无法使用。 此域名解析为仅1个IP地址-190.115.19.74。 反过来，它具有解析为该IP地址的1475个唯一域名，包括以下名称： </p><br><ul><li>  ac-pay2day.net </li><li>  ac-payfit.com </li><li>  as-manypay.com </li><li>  fletkass.net </li><li>  as-magicpay.com </li><li> 和其他 </li></ul><br><p> 正如我们所看到的，被动DNS使您能够快速有效地收集有关所调查资源的数据，甚至建立一种指纹，从而使您能够揭示从盗窃个人数据到接收到可能的销售点的整个方案。 </p><br><img src="https://habrastorage.org/webt/z_/wc/bc/z_wcbcwwi8zvjfp8zu7eyqbsrik.png" alt="图片"><br><p>  <i>图7.被调查系统的地图</i> </p><br><p> 并非所有事情都像我们想要的那样乐观。 例如，此类调查可以轻松地分解CloudFlare或类似服务。 数据库的有效性非常取决于通过该模块收集被动DNS数据的DNS查询的数量。 尽管如此，被动DNS还是为研究人员提供了更多信息的来源。 </p><br><p>  <em>作者：乌拉尔安全系统中心专家</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN470974/">https://habr.com/ru/post/zh-CN470974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN470954/index.html">在Ubuntu 18.04 LTS上安装Zimbra OSE 8.8.15和Zextras Suite Pro</a></li>
<li><a href="../zh-CN470958/index.html">Kubernetes中的活动探针可能很危险</a></li>
<li><a href="../zh-CN470962/index.html">布达佩斯JSConf 2019</a></li>
<li><a href="../zh-CN470964/index.html">木制玩具-铭文</a></li>
<li><a href="../zh-CN470966/index.html">肯·汤普森（Ken Thompson）的Unix密码</a></li>
<li><a href="../zh-CN470976/index.html">冰之歌（血腥企业）和火焰之歌（DevOps和IaC）</a></li>
<li><a href="../zh-CN470978/index.html">分析师市场研究：他们在哪里学习，使用什么工具以及赚多少钱</a></li>
<li><a href="../zh-CN470980/index.html">软件机器人（RPA）在银行业中解决的任务</a></li>
<li><a href="../zh-CN470982/index.html">使用PVS-Studio在Travis CI，Buddy和AppVeyor中分析提交和请求请求</a></li>
<li><a href="../zh-CN470984/index.html">使用PVS-Studio在Travis CI，Buddy和AppVeyor中分析提交和请求请求</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>