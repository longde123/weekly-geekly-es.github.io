<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåº ü§±üèæ üìö Em qual hardware analisar uma enorme quantidade de informa√ß√µes? ‚ÜñÔ∏è üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ üåç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somos Big Data no MTS e este √© o nosso primeiro post. Hoje, falaremos sobre quais tecnologias nos permitem armazenar e processar grandes dados, para q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Em qual hardware analisar uma enorme quantidade de informa√ß√µes?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ru_mts/blog/439498/">  Somos Big Data no MTS e este √© o nosso primeiro post.  Hoje, falaremos sobre quais tecnologias nos permitem armazenar e processar grandes dados, para que sempre haja recursos suficientes para an√°lises, e o custo da compra de ferro n√£o ultrapasse as alturas. <br><br>  Eles pensaram em criar o centro de Big Data no MTS em 2014: era necess√°rio escalar o armazenamento anal√≠tico cl√°ssico e os relat√≥rios de BI sobre ele.  Naquela √©poca, o mecanismo de processamento de dados e BI era SAS - isso acontecia historicamente.  E, embora as necessidades comerciais de armazenamento estivessem fechadas, com o tempo, a funcionalidade do BI e da an√°lise ad-hoc sobre o armazenamento anal√≠tico cresceu tanto que foi necess√°rio resolver o problema do aumento da produtividade, pois, ao longo dos anos, o n√∫mero de usu√°rios aumentou dez vezes e continuou a crescer. <br><br>  Como resultado do concurso, o sistema Teradata MPP apareceu no MTS, cobrindo as necessidades das telecomunica√ß√µes naquele momento.  Este foi o √≠mpeto para tentar algo mais popular e de c√≥digo aberto. <br><br><img src="https://habrastorage.org/webt/3w/vb/oq/3wvboq27onvunkfizv0cfquemou.jpeg" alt="imagem"><br><br>  <i>Na foto - a equipe do Big Data MTS no novo escrit√≥rio da Descartes em Moscou</i> <a name="habracut"></a><br><br>  O primeiro cluster era de 7 n√≥s.  Isso foi suficiente para testar v√°rias hip√≥teses de neg√≥cios e preencher os primeiros incha√ßos.  Os esfor√ßos n√£o foram em v√£o: o Big Data existe no MTS h√° tr√™s anos e agora a an√°lise de dados est√° envolvida em quase todas as √°reas funcionais.  A equipe cresceu de trezentos para duzentos. <br><br>  Quer√≠amos ter processos de desenvolvimento f√°ceis, testar rapidamente hip√≥teses.  Para fazer isso, s√£o necess√°rias tr√™s coisas: uma equipe com pensamento de inicializa√ß√£o, processos de desenvolvimento leves e infraestrutura desenvolvida.  Existem muitos lugares onde voc√™ pode ler e ouvir sobre o primeiro e o segundo, mas vale a pena falar sobre a infraestrutura desenvolvida separadamente, porque o legado e as fontes de dados que est√£o nas telecomunica√ß√µes s√£o importantes aqui.  Uma infraestrutura de dados desenvolvida n√£o est√° apenas construindo um data lake, uma camada de dados detalhada e uma camada de loja.  Tamb√©m inclui ferramentas e interfaces de acesso a dados, isolamento de recursos de computa√ß√£o para produtos e comandos, mecanismos para entrega de dados aos consumidores - tanto em tempo real quanto em lote.  E muito, muito mais. <br><br>  Todo esse trabalho se destacou em uma √°rea separada, que se dedica ao desenvolvimento de utilit√°rios e ferramentas de dados.  Essa √°rea √© chamada de plataforma de TI Big Data. <br><br><h3>  De onde vem o Big Data no MTS </h3><br>  O MTS possui muitas fontes de dados.  Uma das principais s√£o as esta√ß√µes base; atendemos a base de assinantes de mais de 78 milh√µes de assinantes na R√∫ssia.  Tamb√©m temos muitos servi√ßos que n√£o est√£o relacionados √† telecomunica√ß√£o e permitem que voc√™ receba dados mais vers√°teis (com√©rcio eletr√¥nico, integra√ß√£o de sistemas, Internet das coisas, servi√ßos em nuvem etc.) - toda a "n√£o telecomunica√ß√£o" j√° traz cerca de 20% de toda a receita). <br><br>  Resumidamente, nossa arquitetura pode ser representada como um gr√°fico: <br><br><img src="https://habrastorage.org/webt/ya/cf/mf/yacfmf3ruitbrvmrjlib6kqlywy.png" alt="imagem"><br><br>  Como voc√™ pode ver no gr√°fico, as fontes de dados podem fornecer informa√ß√µes em tempo real.  Usamos a camada de fluxo - podemos processar informa√ß√µes em tempo real, extrair dela alguns eventos que s√£o do nosso interesse e criar an√°lises sobre isso.  Para fornecer esse processamento de eventos, desenvolvemos uma implementa√ß√£o bastante padr√£o (do ponto de vista da arquitetura) usando Apache Kafka, Apache Spark e c√≥digo na linguagem Scala.  As informa√ß√µes obtidas como resultado dessa an√°lise podem ser consumidas tanto no MTS quanto no exterior: as empresas geralmente se interessam pelo fato de certas a√ß√µes dos assinantes. <br><br>  H√° tamb√©m um modo de carregar dados em lotes - camada de lote.  Geralmente, o download ocorre uma vez por hora em uma programa√ß√£o, usamos o Apache Airflow como agendador e os pr√≥prios processos de download em lote s√£o implementados em python.  Nesse caso, uma quantidade significativamente maior de dados √© carregada no Data Lake, o que √© necess√°rio para preencher o Big Data com dados hist√≥ricos, nos quais nossos modelos de ci√™ncia de dados devem ser treinados.  Como resultado, um perfil de assinante √© formado no contexto hist√≥rico com base nos dados de sua atividade de rede.  Isso nos permite obter estat√≠sticas preditivas e construir modelos de comportamento humano, at√© criar um retrato psicol√≥gico dele - temos um produto t√£o separado.  Esta informa√ß√£o √© muito √∫til, por exemplo, para empresas de marketing. <br><br>  Tamb√©m temos uma grande quantidade de dados que comp√µem o reposit√≥rio cl√°ssico.  Ou seja, agregamos informa√ß√µes sobre v√°rios eventos - usu√°rio e rede.  Todos esses dados an√¥nimos tamb√©m ajudam a prever com mais precis√£o os interesses e eventos do usu√°rio que s√£o importantes para a empresa - por exemplo, para prever poss√≠veis falhas no equipamento e solucionar problemas a tempo. <br><br><h3>  Hadoop </h3><br>  Se voc√™ olhar para o passado e se lembrar de como o big data apareceu em geral, deve-se notar que basicamente o ac√∫mulo de dados foi realizado para fins de marketing.  N√£o existe uma defini√ß√£o clara do que √© big data - s√£o gigabytes, terabytes, petabytes.  Imposs√≠vel desenhar uma linha.  Para alguns, o big data √© dezenas de gigabytes, para outros, petabytes. <br><br>  Aconteceu que, com o tempo, muitos dados foram acumulados em todo o mundo.  E, para realizar algum tipo de an√°lise mais ou menos significativa desses dados, os reposit√≥rios usuais que v√™m sendo desenvolvidos desde os anos 70 do s√©culo passado n√£o eram mais suficientes.  Quando o fluxo de informa√ß√µes come√ßou nos anos 2000, 10 e quando havia muitos dispositivos que tinham acesso √† Internet, quando a Internet das coisas apareceu, esses reposit√≥rios simplesmente n√£o conseguiam lidar conceitualmente.  A base desses reposit√≥rios foi a teoria relacional.  Ou seja, havia rela√ß√µes de diferentes formas que interagiam entre si.  Havia um sistema para descrever como construir e projetar reposit√≥rios. <br><br>  Quando tecnologias antigas falham, novas aparecem.  No mundo moderno, o problema da an√°lise de big data √© resolvido de duas maneiras: <br><br>  Criando sua pr√≥pria estrutura que permite processar grandes quantidades de informa√ß√µes.  Geralmente, esse √© um aplicativo distribu√≠do de muitas centenas de milhares de servidores - como o Google, Yandex, que criaram seus pr√≥prios bancos de dados distribu√≠dos que permitem trabalhar com um volume de informa√ß√µes t√£o grande. <br><br>  O desenvolvimento da tecnologia Hadoop √© uma estrutura de computa√ß√£o distribu√≠da, um sistema de arquivos distribu√≠dos que pode armazenar e processar uma quantidade muito grande de informa√ß√µes.  As ferramentas de ci√™ncia de dados s√£o principalmente compat√≠veis com o Hadoop e essa compatibilidade abre muitas possibilidades para an√°lises avan√ßadas de dados.  Muitas empresas, incluindo n√≥s, est√£o se movendo em dire√ß√£o ao ecossistema Hadoop de c√≥digo aberto. <br><br>  O cluster central do Hadoop est√° localizado em Nizhny Novgorod.  Ele acumula informa√ß√µes de quase todas as regi√µes do pa√≠s.  Em termos de volume, agora podem ser baixados cerca de 8,5 petabytes de dados l√°.  Tamb√©m em Moscou, temos clusters de RND separados, onde realizamos experimentos. <br><br>  Como temos cerca de mil servidores em diferentes regi√µes, onde realizamos an√°lises e planejamos expans√£o, surge a quest√£o da escolha certa de equipamentos para sistemas anal√≠ticos distribu√≠dos.  Voc√™ pode comprar equipamentos suficientes para armazenamento de dados, mas que n√£o s√£o adequados para an√°lises - simplesmente porque n√£o haver√° recursos suficientes, o n√∫mero de n√∫cleos da CPU e a RAM livre nos n√≥s.  √â importante encontrar um equil√≠brio para obter boas oportunidades de an√°lise e custos de equipamento n√£o muito altos. <br><br>  A Intel nos ofereceu diferentes op√ß√µes sobre como otimizar o trabalho com um sistema distribu√≠do, para que as an√°lises em nosso volume de dados possam ser obtidas por um pre√ßo razo√°vel.  Intel avan√ßa na tecnologia de unidade de estado s√≥lido SSD NAND  √â centenas de vezes mais r√°pido que um HDD comum.  Do que √© bom para n√≥s: o SSD, especialmente com a interface NVMe, fornece acesso r√°pido aos dados. <br><br>  Al√©m disso, a Intel lan√ßou os SSDs do servidor Intel Optane SSD com base no novo tipo de mem√≥ria n√£o vol√°til Intel 3D XPoint.  Eles lidam com cargas mistas intensivas no sistema de armazenamento e t√™m um recurso mais longo que os SSDs NAND regulares.  Por que √© bom para n√≥s: o Intel Optane SSD permite que voc√™ trabalhe de forma est√°vel em cargas pesadas e com baixa lat√™ncia.  Inicialmente, vimos o NAND SSD como um substituto para os discos r√≠gidos tradicionais, porque temos uma quantidade muito grande de dados movendo-se entre o disco r√≠gido e a RAM - e precis√°vamos otimizar esses processos. <br><br><h3>  Primeiro teste </h3><br>  O primeiro teste que realizamos em 2016.  Acabamos de pegar e tentar substituir o HDD por um r√°pido NAND SSD.  Para isso, solicitamos amostras do novo drive Intel - na √©poca era o DC P3700.  E eles executaram o teste padr√£o do Hadoop - um ecossistema que permite avaliar como o desempenho muda em diferentes condi√ß√µes.  Estes s√£o testes padronizados TeraGen, TeraSort, TeraValidate. <br><br><img src="https://habrastorage.org/webt/4t/rv/jg/4trvjgykt92_nv93z6nidrblw8g.png" alt="imagem"><br><br>  O TeraGen permite "gerar" dados artificiais de um determinado volume.  Por exemplo, pegamos 1 GB e 1 TB.  Com o TeraSort, classificamos essa quantidade de dados no Hadoop.  Esta √© uma opera√ß√£o bastante intensiva em recursos.  E o √∫ltimo teste - TeraValidate - permite garantir que os dados sejam classificados na ordem correta.  Ou seja, passamos por eles uma segunda vez. <br><br><img src="https://habrastorage.org/webt/dh/26/a8/dh26a8jyr-tzpravvfdpliwvz3m.png" alt="imagem"><br><br>  Como experi√™ncia, pegamos carros apenas com SSDs - ou seja, o Hadoop instalou apenas em SSDs sem usar discos r√≠gidos.  Na segunda vers√£o, usamos o SSD para armazenar arquivos tempor√°rios, HDD - para armazenar dados b√°sicos.  E na terceira vers√£o, os discos r√≠gidos foram usados ‚Äã‚Äãpara ambos. <br><br>  Os resultados desses experimentos n√£o foram muito agrad√°veis ‚Äã‚Äãpara n√≥s, porque a diferen√ßa nos indicadores de desempenho n√£o excedeu 10-20%.  Ou seja, percebemos que o Hadoop n√£o √© muito amig√°vel com SSDs em termos de armazenamento, porque inicialmente o sistema foi criado para armazenar grandes dados no HDD, e ningu√©m o otimizou especialmente para SSDs r√°pidos e caros.  E como o custo do SSD naquela √©poca era bastante alto, decidimos at√© agora n√£o entrar nessa hist√≥ria e nos dar bem com os discos r√≠gidos. <br><br><h3>  Segundo teste </h3><br>  Em seguida, a Intel lan√ßou novos SSDs Intel Optane do lado do servidor com base na mem√≥ria 3D XPoint.  Eles foram lan√ßados no final de 2017, mas as amostras estavam dispon√≠veis para n√≥s anteriormente.  Os recursos de mem√≥ria do 3D XPoint possibilitam o uso do Intel Optane SSD como uma extens√£o da RAM nos servidores.  Como j√° percebemos que n√£o seria f√°cil resolver o problema de desempenho do IO Hadoop no n√≠vel dos dispositivos de armazenamento em bloco, decidimos tentar uma nova op√ß√£o - expandir a RAM usando a Intel Memory Drive Technology (IMDT).  E no in√≠cio deste ano, fomos um dos primeiros no mundo a test√°-lo. <br><br>  Isso √© bom para n√≥s: √© mais barato que a RAM, o que permite coletar servidores com terabytes de RAM.  E como a RAM √© r√°pida o suficiente, voc√™ pode carregar grandes conjuntos de dados e analis√°-los.  Deixe-me lembr√°-lo de que a peculiaridade de nosso processo anal√≠tico √© que acessamos os dados v√°rias vezes.  Para fazer algum tipo de an√°lise, precisamos carregar o m√°ximo de dados poss√≠vel na mem√≥ria e "rolar" algum tipo de an√°lise desses dados v√°rias vezes. <br>  O laborat√≥rio de ingl√™s da Intel em Swindon nos alocou um cluster de tr√™s servidores, que durante os testes comparamos com nosso cluster de teste localizado no MTS. <br><br><img src="https://habrastorage.org/webt/ph/uc/1h/phuc1hd5_okqgdwgtzbskvvmngm.png" alt="imagem"><br><br>  Como pode ser visto no gr√°fico, de acordo com os resultados do teste, obtivemos resultados bastante bons. <br><br><img src="https://habrastorage.org/webt/nx/02/rz/nx02rzz8cratazithcmus9utpy8.png" alt="imagem"><br><br>  O mesmo TeraGen mostrou um aumento quase duplo na produtividade, o TeraValidate - em 75%.  Isso √© muito bom para n√≥s, porque, como eu disse, acessamos os dados que temos em nossa mem√≥ria v√°rias vezes.  Consequentemente, se obtivermos tal ganho de desempenho, ele nos ajudar√° especialmente na an√°lise de dados, especialmente em tempo real. <br><br>  Realizamos tr√™s testes sob diferentes condi√ß√µes.  100 GB, 250 GB e 500 GB.  E quanto mais usamos a mem√≥ria, o Intel Optane SSD com Intel Memory Drive Technology teve melhor desempenho.  Ou seja, quanto mais dados analisamos, mais obtemos efici√™ncia.  As an√°lises que ocorreram em mais n√≥s podem ocorrer em menos deles.  E tamb√©m temos uma quantidade bastante grande de mem√≥ria em nossas m√°quinas, o que √© muito bom para as tarefas de ci√™ncia de dados.  Com base nos resultados do teste, decidimos comprar essas unidades para trabalhar no MTS. <br><br>  Se voc√™ tamb√©m tiver que escolher e testar o hardware para armazenar e processar uma grande quantidade de dados, ser√° interessante para n√≥s ler quais dificuldades voc√™ encontrou e quais resultados teve: escreva nos coment√°rios. <br><br>  <i>Autores:</i> <i><br></i>  <i>Grigory Koval, chefe do Centro de Compet√™ncia em Arquitetura Aplicada do Departamento de Big Data do MTS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">grigory_koval</a></i> <i><br></i>  <i>Chefe da tribo de gerenciamento de dados do Departamento de Big Data MTS Dmitry Shostko <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">zloi_diman</a></i> <cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt439498/">https://habr.com/ru/post/pt439498/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt439486/index.html">Tipos de refer√™ncia do .NET vs tipos de valor. Parte 1</a></li>
<li><a href="../pt439488/index.html">Grava√ß√£o de v√≠deo de controle de qualidade Meetup</a></li>
<li><a href="../pt439490/index.html">Tipos de refer√™ncia do .NET vs tipos de valor. Parte 2</a></li>
<li><a href="../pt439492/index.html">10 dicas para ser um bom l√≠der t√©cnico</a></li>
<li><a href="../pt439496/index.html">Como o faturamento √© feito l√°: quando o cliente e o desenvolvedor falam idiomas diferentes</a></li>
<li><a href="../pt439500/index.html">Por que os captchas se tornam t√£o complicados</a></li>
<li><a href="../pt439502/index.html">Comportamento indefinido e verdade n√£o definida</a></li>
<li><a href="../pt439504/index.html">Sua equipe precisa de um engenheiro de dados?</a></li>
<li><a href="../pt439506/index.html">9 alternativas para uma equipe ruim (padr√£o de design)</a></li>
<li><a href="../pt439508/index.html">Mitap sobre desenvolvimento de c√≥digo aberto em Moscou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>