<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïå üé´ ‚õπüèª An√°lise de c√≥digo da plataforma CUBA usando o PVS-Studio üçÇ ü•ê üçù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Para programadores Java, existem ferramentas √∫teis para ajud√°-lo a escrever c√≥digo de alta qualidade, por exemplo, o poderoso ambiente de desenvolvime...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lise de c√≥digo da plataforma CUBA usando o PVS-Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/449022/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/89f/a3b/650/89fa3b6506fd8962c8996579f4dcc460.png" alt="Quadro 2"></div><br>  Para programadores Java, existem ferramentas √∫teis para ajud√°-lo a escrever c√≥digo de alta qualidade, por exemplo, o poderoso ambiente de desenvolvimento IntelliJ IDEA, SpotBugs gratuitos, analisadores PMD e outros.  Tudo isso j√° √© usado no desenvolvimento do projeto CUBA Platform, e nesta revis√£o dos defeitos de c√≥digo encontrados, mostrarei de que outra maneira voc√™ pode melhorar a qualidade do projeto usando o analisador de c√≥digo est√°tico PVS-Studio. <br><a name="habracut"></a><br><h2>  Sobre o projeto e o analisador </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A Plataforma CUBA</a> √© uma estrutura Java de alto n√≠vel para criar rapidamente aplicativos corporativos com uma interface da Web completa.  A plataforma abstrai o desenvolvedor de tecnologias heterog√™neas para que voc√™ possa se concentrar na solu√ß√£o de problemas de neg√≥cios, ao mesmo tempo, sem tornar imposs√≠vel trabalhar diretamente com eles.  O c√≥digo fonte √© retirado do reposit√≥rio no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O PVS-Studio</a> √© uma ferramenta para detectar erros e poss√≠veis vulnerabilidades no c√≥digo fonte de programas escritos em C, C ++, C # e Java.  Funciona em sistemas de 64 bits no Windows, Linux e macOS.  Para conveni√™ncia dos programadores Java, desenvolvemos plugins para Maven, Gradle e IntelliJ IDEA.  O projeto da plataforma CUBA foi facilmente verificado usando o plugin Gradle. <br><br><h2>  Erros nas condi√ß√µes </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A</a> express√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6007</a> 'StringUtils.isNotEmpty ("handleTabKey")' sempre √© verdadeira.  SourceCodeEditorLoader.java (60) <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadComponent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... String handleTabKey = element.attributeValue(<span class="hljs-string"><span class="hljs-string">"handleTabKey"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (StringUtils.isNotEmpty(<span class="hljs-string"><span class="hljs-string">"handleTabKey"</span></span>)) { resultComponent.setHandleTabKey(Boolean.parseBoolean(handleTabKey)); } .... }</code> </pre> <br>  Ap√≥s recuperar o valor do atributo de um elemento, a verifica√ß√£o desse valor n√£o √© executada.  Em vez disso, uma cadeia constante √© passada para a fun√ß√£o <i>isNotEmpty</i> , mas tivemos que passar a vari√°vel <i>handleTabKey</i> . <br><br>  H√° outro erro semelhante no arquivo AbstractTableLoader.java: <br><br><ul><li>  A express√£o V6007 'StringUtils.isNotEmpty ("editable")' sempre √© verdadeira.  AbstractTableLoader.java (596) </li></ul><br>  <b>Aviso 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A</a> express√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6007</a> 'previousMenuItemFlatIndex&gt; = 0' sempre √© verdadeira.  CubaSideMenuWidget.java (328) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> MenuItemWidget </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findNextMenuItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MenuItemWidget currentItem)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;MenuTreeNode&gt; menuTree = buildVisibleTree(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); List&lt;MenuItemWidget&gt; menuItemWidgets = menuTreeToList(menuTree); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> menuItemFlatIndex = menuItemWidgets.indexOf(currentItem); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> previousMenuItemFlatIndex = menuItemFlatIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (previousMenuItemFlatIndex &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> menuItemWidgets.get(previousMenuItemFlatIndex); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre> <br>  A fun√ß√£o <i>indexOf</i> pode retornar <i>-1</i> se o item n√£o for encontrado na lista.  Em seguida, um √© adicionado ao √≠ndice, ocultando a situa√ß√£o quando o elemento desejado est√° ausente.  Outro problema em potencial pode ser o fato de a vari√°vel <i>previousMenuItemFlatIndex</i> sempre ser maior ou igual a zero.  Se, por exemplo, a lista <i>menuItemWidgets</i> estiver vazia, ser√° poss√≠vel ir al√©m do limite da matriz. <br><br>  <b>Aviso 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6009</a> A fun√ß√£o 'delete' pode receber o valor '-1' enquanto se espera um valor n√£o negativo.  Argumento de inspe√ß√£o: 1. AbstractCollectionDatasource.java (556) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> DataLoadContextQuery </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createDataQuery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... StringBuilder orderBy = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (orderBy.length() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { orderBy.delete(orderBy.length() - <span class="hljs-number"><span class="hljs-number">2</span></span>, orderBy.length()); orderBy.insert(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">" order by "</span></span>); } .... }</code> </pre> <br>  No buffer de caracteres <i>orderBy,</i> os dois √∫ltimos caracteres ser√£o exclu√≠dos se o n√∫mero total for maior que zero, ou seja,  uma sequ√™ncia cont√©m um caractere ou mais.  Mas a posi√ß√£o inicial para excluir caracteres foi definida com um deslocamento de 2 caracteres.  Portanto, se <i>orderBy</i> consistir repentinamente em 1 caractere, uma tentativa de exclus√£o lan√ßar√° uma <i>StringIndexOutOfBoundsException</i> . <br><br>  <b>Aviso 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6013 Os</a> objetos 'masterCollection' e 'entidades' s√£o comparados por refer√™ncia.  Possivelmente uma compara√ß√£o de igualdade foi planejada.  CollectionPropertyContainerImpl.java (81) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setItems</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Nullable Collection&lt;E&gt; entities)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.setItems(entities); Entity masterItem = master.getItemOrNull(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (masterItem != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { MetaProperty masterProperty = getMasterProperty(); Collection masterCollection = masterItem.getValue(masterProperty.getName()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (masterCollection != entities) { updateMasterCollection(masterProperty, masterCollection, entities); } } }</code> </pre> <br>  Na fun√ß√£o <i>updateMasterCollection, os</i> valores das <i>entidades s√£o</i> copiados para <i>masterCollection</i> .  Antes disso, as cole√ß√µes eram comparadas por refer√™ncia, mas talvez elas fossem planejadas para serem comparadas por valor. <br><br>  <b>Aviso 5</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6013 Os</a> objetos 'value' e 'oldValue' s√£o comparados por refer√™ncia.  Possivelmente uma compara√ß√£o de igualdade foi planejada.  WebOptionsList.java (278) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isCollectionValuesChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collection&lt;I&gt; value, Collection&lt;I&gt; oldValue)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value != oldValue; }</code> </pre> <br>  Este exemplo √© semelhante ao anterior.  Aqui <i>√©CollectionValuesChanged</i> √© para comparar cole√ß√µes.  Talvez a compara√ß√£o por refer√™ncia tamb√©m n√£o seja o esperado. <br><br><h2>  Excesso de condi√ß√µes </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A</a> express√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6007</a> 'mask.charAt (i + deslocamento)! = PlaceHolder' sempre √© verdadeira.  DatePickerDocument.java (238) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateFormattedString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset, String text)</span></span></span><span class="hljs-function"> .... </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((mask.charAt(i + offset) == placeHolder)) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... } else if ((mask.charAt(i + offset) != placeHolder) &amp;&amp; // &lt;= (Character.isDigit(text.charAt(i)))) { .... } .... }</span></span></code> </pre> <br>  Na segunda compara√ß√£o, uma express√£o que √© oposta √† primeira √© verificada.  A segunda verifica√ß√£o pode ser removida para simplificar o c√≥digo. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A</a> express√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6007</a> 'conector == nulo' √© sempre falsa.  HTML5Support.java (169) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">validate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(NativeEvent event)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (connector == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { widget = widget.getParent(); connector = Util.findConnectorFor(widget); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.connector == connector) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (connector == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;= return false; } else if (connector.getWidget() instanceof VDDHasDropHandler) { return false; } return true; }</span></span></code> </pre> <br>  Ap√≥s a conclus√£o do <i>loop while</i> , o valor da vari√°vel do <i>conector</i> n√£o ser√° <i>nulo</i> ; portanto, a verifica√ß√£o redundante pode ser removida. <br><br>  Outro lugar suspeito em que os desenvolvedores devem prestar aten√ß√£o: <br><br><ul><li>  A express√£o V6007 'StringUtils.isBlank (strValue)' sempre √© verdadeira.  Param.java (818) </li></ul><br><h2>  C√≥digo inacess√≠vel em testes </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6019</a> C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  TransactionTest.java (283) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">throwException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(TEST_EXCEPTION_MSG); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testSuspendRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Transaction tx = cont.persistence().createTransaction(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { .... Transaction tx1 = cont.persistence().createTransaction(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { EntityManager em1 = cont.persistence().getEntityManager(); assertTrue(em != em1); Server server1 = em1.find(Server.class, server.getId()); assertNull(server1); throwException(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= tx1.commit(); // &lt;= } catch (Exception e) { // } finally { tx1.end(); } tx.commit(); } finally { tx.end(); } }</span></span></code> </pre> <br>  A fun√ß√£o <i>throwException</i> lan√ßa uma exce√ß√£o que <i>impede a</i> chamada para a fun√ß√£o <i>tx1.commit.</i>  Talvez essas linhas devam ser trocadas. <br><br>  Mais alguns lugares semelhantes em outros testes: <br><br><ul><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  TransactionTest.java (218) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  TransactionTest.java (163) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  TransactionTest.java (203) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  TransactionTest.java (137) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  UpdateDetachedTest.java (153) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  EclipseLinkDetachedTest.java (132) </li><li>  V6019 C√≥digo inacess√≠vel detectado.  √â poss√≠vel que haja um erro.  PersistenceTest.java (223) </li></ul><br><h2>  Argumentos de fun√ß√µes suspeitas </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6023 O</a> par√¢metro 'salt' √© sempre reescrito no corpo do m√©todo antes de ser usado.  BCryptEncryptionModule.java (47) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getHash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String content, String salt)</span></span></span><span class="hljs-function"> </span></span>{ salt = BCrypt.gensalt(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BCrypt.hashpw(content, salt); }</code> </pre> <br>  Na criptografia, <i>salt</i> √© uma sequ√™ncia de dados que s√£o passados ‚Äã‚Äãpara uma fun√ß√£o de hash junto com uma senha.  √â usado principalmente para prote√ß√£o contra pesquisas e ataques de dicion√°rio usando tabelas arco-√≠ris, al√©m de ocultar as mesmas senhas.  Leia mais: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sal (criptografia)</a> . <br><br>  Nesta fun√ß√£o, a linha √© esfregada imediatamente ap√≥s a entrada na fun√ß√£o.  Talvez ignorar o valor passado seja uma vulnerabilidade em potencial. <br><br>  <b>Aviso 2</b> <br><br>  Para a fun√ß√£o considerada, o analisador emite dois avisos ao mesmo tempo: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6023 O</a> par√¢metro 'offsetWidth' √© sempre reescrito no corpo do m√©todo antes de ser usado.  CubaSuggestionFieldWidget.java (433) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6023 O</a> par√¢metro 'offsetHeight' √© sempre reescrito no corpo do m√©todo antes de ser usado.  CubaSuggestionFieldWidget.java (433) </li></ul><br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offsetWidth, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offsetHeight)</span></span></span><span class="hljs-function"> </span></span>{ offsetHeight = getOffsetHeight(); .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (offsetHeight + getPopupTop() &gt; ....)) { .... } .... offsetWidth = containerFirstChild.getOffsetWidth(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (offsetWidth + getPopupLeft() &gt; ....)) { .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { left = getPopupLeft(); } setPopupPosition(left, top); }</code> </pre> <br>  C√≥digo divertido.  A fun√ß√£o aceita apenas duas vari√°veis: <i>offsetWidth</i> e <i>offsetHeight</i> , ambas s√£o substitu√≠das antes do uso. <br><br>  <b>Aviso 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6022 O</a> par√¢metro 'atalho' n√£o √© usado dentro do corpo do construtor.  DeclarativeTrackingAction.java (47) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DeclarativeTrackingAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String id, String caption, String description, String icon, String enable, String visible, String methodName, @Nullable String shortcut, ActionsHolder holder)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(id); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.caption = caption; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.description = description; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.icon = icon; setEnabled(enable == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || Boolean.parseBoolean(enable)); setVisible(visible == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || Boolean.parseBoolean(visible)); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.methodName = methodName; checkActionsHolder(holder); }</code> </pre> <br>  O valor do par√¢metro de <i>atalho</i> n√£o √© usado na fun√ß√£o.  A interface da fun√ß√£o pode estar desatualizada ou este aviso n√£o √© um erro. <br><br>  Mais alguns lugares semelhantes: <br><br><ul><li>  V6022 O par√¢metro 'type' n√£o √© usado dentro do corpo do construtor.  QueryNode.java (36) </li><li>  V6022 O par√¢metro 'text2' n√£o √© usado dentro do corpo do construtor.  MarkerAddition.java (22) </li><li>  V6022 O par√¢metro 'sele√ß√£o' n√£o √© usado dentro do corpo do construtor.  AceEditor.java (114) </li><li>  V6022 O par√¢metro 'options' n√£o √© usado dentro do corpo do construtor.  EntitySerialization.java (379) </li></ul><br><h2>  Fun√ß√µes diferentes com o mesmo c√≥digo </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6032</a> √â estranho que o corpo do m√©todo 'firstItemId' seja totalmente equivalente ao corpo de outro m√©todo 'lastItemId'.  ContainerTableItems.java (213), ContainerTableItems.java (219) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstItemId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;E&gt; items = container.getItems(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.isEmpty() ? <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : items.get(<span class="hljs-number"><span class="hljs-number">0</span></span>).getId(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lastItemId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;E&gt; items = container.getItems(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.isEmpty() ? <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : items.get(<span class="hljs-number"><span class="hljs-number">0</span></span>).getId(); }</code> </pre> <br>  As fun√ß√µes <i>firstItemId</i> e <i>lastItemId</i> t√™m a mesma implementa√ß√£o.  Provavelmente, no √∫ltimo, foi necess√°rio obter um elemento n√£o com o √≠ndice <i>0</i> , mas calcular o √≠ndice do √∫ltimo elemento. <br><br>  <b>Aviso 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6032</a> √â estranho que o corpo do m√©todo seja totalmente equivalente ao corpo de outro m√©todo.  SearchComboBoxPainter.java (495), SearchComboBoxPainter.java (501) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">paintBackgroundDisabledAndEditable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Graphics2D g)</span></span></span><span class="hljs-function"> </span></span>{ rect = decodeRect1(); g.setPaint(color53); g.fill(rect); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">paintBackgroundEnabledAndEditable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Graphics2D g)</span></span></span><span class="hljs-function"> </span></span>{ rect = decodeRect1(); g.setPaint(color53); g.fill(rect); }</code> </pre> <br>  Mais duas fun√ß√µes com implementa√ß√£o suspeitamente id√™ntica.  Atrevo-me a sugerir que em um deles era necess√°rio usar uma cor diferente da <i>cor53</i> . <br><br><h2>  Refer√™ncia nula </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6060</a> A refer√™ncia 'descriptionPopup' foi utilizada antes de ser verificada com rela√ß√£o a nulo.  SuggestPopup.java (252), SuggestPopup.java (251) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateDescriptionPopupPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = getAbsoluteLeft() + WIDTH; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = getAbsoluteTop(); descriptionPopup.setPopupPosition(x, y); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (descriptionPopup!=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { descriptionPopup.setPopupPosition(x, y); } }</code> </pre> <br>  Em apenas duas linhas, o autor conseguiu escrever um c√≥digo muito suspeito.  Primeiro, o m√©todo <i>setPopupPosition</i> √© chamado no objeto <i>descriptionPopup</i> e, em seguida, o objeto √© comparado a <i>nulo</i> .  Provavelmente, a primeira chamada para a fun√ß√£o <i>setPopupPosition</i> √© redundante e perigosa.  Parece que as consequ√™ncias da refatora√ß√£o com falha. <br><br>  <b>Advert√™ncias 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6060</a> A refer√™ncia 'tableModel' foi utilizada antes de ser verificada com rela√ß√£o a nulo.  DesktopAbstractTable.java (1580), DesktopAbstractTable.java (1564) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Column </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addRuntimeGeneratedColumn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String columnId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// store old cell editors / renderers TableCellEditor[] cellEditors = new TableCellEditor[tableModel.getColumnCount() + 1]; // &lt;= TableCellRenderer[] cellRenderers = new TableCellRenderer[tableModel.getColumnCount() + 1]; // &lt;= for (int i = 0; i &lt; tableModel.getColumnCount(); i++) { // &lt;= Column tableModelColumn = tableModel.getColumn(i); if (tableModel.isGeneratedColumn(tableModelColumn)) { // &lt;= TableColumn tableColumn = getColumn(tableModelColumn); cellEditors[i] = tableColumn.getCellEditor(); cellRenderers[i] = tableColumn.getCellRenderer(); } } Column col = new Column(columnId, columnId); col.setEditable(false); columns.put(col.getId(), col); if (tableModel != null) { // &lt;= tableModel.addColumn(col); } .... }</span></span></code> </pre> <br>  Uma situa√ß√£o semelhante existe nesta fun√ß√£o.  Ap√≥s in√∫meras chamadas para o objeto <i>tableModel</i> , √© feita uma verifica√ß√£o para <i>ver</i> se √© <i>nulo</i> ou n√£o. <br><br>  Outro exemplo: <br><br><ul><li>  V6060 A refer√™ncia 'tableModel' foi utilizada antes de ser verificada com rela√ß√£o a nulo.  DesktopAbstractTable.java (596), DesktopAbstractTable.java (579) </li></ul><br><h2>  Talvez um erro l√≥gico </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6026</a> Este valor j√° est√° atribu√≠do √† vari√°vel 'sortAscending'.  CubaScrollTableWidget.java (488) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sortColumn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sortAscending) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sortClickCounter &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// special case for initial revert sorting instead of reset sort order if (sortClickCounter == 0) { client.updateVariable(paintableId, "sortascending", false, false); } else { reloadDataFromServer = false; sortClickCounter = 0; sortColumn = null; sortAscending = true; // &lt;= client.updateVariable(paintableId, "resetsortorder", "", true); } } else { client.updateVariable(paintableId, "sortascending", false, false); } } else { if (sortClickCounter &lt; 2) { // special case for initial revert sorting instead of reset sort order if (sortClickCounter == 0) { client.updateVariable(paintableId, "sortascending", true, false); } else { reloadDataFromServer = false; sortClickCounter = 0; sortColumn = null; sortAscending = true; client.updateVariable(paintableId, "resetsortorder", "", true); } } else { reloadDataFromServer = false; sortClickCounter = 0; sortColumn = null; sortAscending = true; client.updateVariable(paintableId, "resetsortorder", "", true); } } .... }</span></span></code> </pre> <br>  Na primeira condi√ß√£o, a vari√°vel <i>sortAscending j√°</i> √© <i>verdadeira</i> , mas ainda recebe o mesmo valor.  Talvez isso seja um erro e deseje atribuir <i>falso</i> . <br><br>  Um exemplo semelhante de outro arquivo: <br><br><ul><li>  V6026 Este valor j√° est√° atribu√≠do √† vari√°vel 'sortAscending'.  CubaTreeTableWidget.java (444) </li></ul><br><h2>  Valores de retorno de fun√ß√µes estranhas </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6037</a> Um 'retorno' incondicional dentro de um loop.  QueryCacheManager.java (128) <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSingleResultFromCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(QueryKey queryKey, List&lt;View&gt; views)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Object id : queryResult.getResult()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (T) em.find(metaClass.getJavaClass(), id, views.toArray(....)); } .... }</code> </pre> <br>  O analisador detectou uma chamada incondicional √† <i>instru√ß√£o de retorno</i> na primeira itera√ß√£o do loop <i>for</i> .  Talvez isso seja um erro ou voc√™ precise reescrever o c√≥digo para usar a <i>instru√ß√£o if</i> . <br><br>  <b>Aviso 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6014</a> √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  DefaultExceptionHandler.java (40) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ErrorEvent event, App app)</span></span></span><span class="hljs-function"> </span></span>{ Throwable t = event.getThrowable(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> SocketException || ExceptionUtils.getRootCause(t) <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> SocketException) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ExceptionUtils.getThrowableList(t).stream() .anyMatch(o -&gt; o.getClass().getName().equals(<span class="hljs-string"><span class="hljs-string">"...."</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (StringUtils.contains(ExceptionUtils.getMessage(t), <span class="hljs-string"><span class="hljs-string">"...."</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } AppUI ui = AppUI.getCurrent(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ui == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (app.getConnection().getSession() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { showDialog(app, t); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { showNotification(app, t); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  Esta fun√ß√£o em todos os casos retorna <i>verdadeira</i> .  Mas aqui, na √∫ltima linha, implora o retorno do <i>falso</i> .  Talvez haja um erro. <br><br>  A lista inteira de fun√ß√µes suspeitas com c√≥digo semelhante: <br><br><ul><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  ErrorNodesFinder.java (31) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  FileDownloadController.java (69) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  IdVarSelector.java (73) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  IdVarSelector.java (48) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  IdVarSelector.java (67) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  IdVarSelector.java (46) </li><li>  V6014 √â estranho que esse m√©todo sempre retorne um e o mesmo valor.  JoinVariableNode.java (57) </li></ul><br>  <b>Aviso 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A</a> express√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6007</a> 'needReload' √© sempre falsa.  WebAbstractTable.java (2702) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleSpecificVariables</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;String, Object&gt; variables)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> needReload = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isUsePresentations() &amp;&amp; presentations != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { Presentations p = getPresentations(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p.getCurrent() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; p.isAutoSave(p.getCurrent()) &amp;&amp; needUpdatePresentation(variables)) { Element e = p.getSettings(p.getCurrent()); saveSettings(e); p.setSettings(p.getCurrent(), e); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> needReload; }</code> </pre> <br>  A fun√ß√£o retorna a vari√°vel <i>needReload</i> , cujo valor √© sempre <i>falso</i> .  Provavelmente, em uma das condi√ß√µes, eles esqueceram de adicionar o c√≥digo para alterar o valor da vari√°vel. <br><br>  <b>Aviso 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6062</a> Poss√≠vel recurs√£o infinita dentro do m√©todo 'isFocused'.  GwtAceEditor.java (189), GwtAceEditor.java (190) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">focus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">/*-{ this.focus(); }-*/</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isFocused</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.isFocused(); }</code> </pre> <br>  O analisador detectou uma fun√ß√£o chamada recursivamente sem uma condi√ß√£o para interromper a recurs√£o.  Esse arquivo tem muitas fun√ß√µes que s√£o marcadas com a palavra-chave <i>nativa</i> e cont√™m c√≥digo comentado.  Provavelmente, o arquivo est√° sendo substitu√≠do atualmente e em breve os desenvolvedores <i>prestar√£o</i> aten√ß√£o √† fun√ß√£o <i>isFocused</i> . <br><br><h2>  Avisos diversos </h2><br>  <b>Aviso 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6002</a> A instru√ß√£o switch n√£o cobre todos os valores da enumera√ß√£o 'Operation': ADD.  DesktopAbstractTable.java (665) <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Operation which caused the datasource change. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Operation { REFRESH, CLEAR, ADD, REMOVE, UPDATE } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDatasource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> CollectionDatasource datasource)</span></span></span><span class="hljs-function"> </span></span>{ .... collectionChangeListener = e -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (e.getOperation()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CLEAR: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> REFRESH: fieldDatasources.clear(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> UPDATE: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> REMOVE: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Object entity : e.getItems()) { fieldDatasources.remove(entity); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }; .... }</code> </pre> <br>  A <i>instru√ß√£o switch</i> n√£o aborda o valor de <i>ADD</i> .  √â o √∫nico n√£o revisado, por isso vale a pena verificar se √© um erro ou n√£o. <br><br>  <b>Aviso 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6021</a> A 'fonte' vari√°vel n√£o √© usada.  DefaultHorizontalLayoutDropHandler.java (177) <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleHTML5Drop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DragAndDropEvent event)</span></span></span><span class="hljs-function"> </span></span>{ LayoutBoundTransferable transferable = (LayoutBoundTransferable) event .getTransferable(); HorizontalLayoutTargetDetails details = (HorizontalLayoutTargetDetails) event .getTargetDetails(); AbstractOrderedLayout layout = (AbstractOrderedLayout) details .getTarget(); Component source = event.getTransferable().getSourceComponent(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= int idx = (details).getOverIndex(); HorizontalDropLocation loc = (details).getDropLocation(); if (loc == HorizontalDropLocation.CENTER || loc == HorizontalDropLocation.RIGHT) { idx++; } Component comp = resolveComponentFromHTML5Drop(event); if (idx &gt;= 0) { layout.addComponent(comp, idx); } else { layout.addComponent(comp); } if (dropAlignment != null) { layout.setComponentAlignment(comp, dropAlignment); } }</span></span></code> </pre> <br>  A vari√°vel de origem √© declarada e n√£o usada no c√≥digo.  Talvez, como outra vari√°vel <i>comp</i> do mesmo tipo, eles tenham esquecido de adicionar <i>fonte</i> ao <i>layout</i> . <br><br>  Mais fun√ß√µes com vari√°veis ‚Äã‚Äãn√£o utilizadas: <br><br><ul><li>  V6021 A 'fonte' vari√°vel n√£o √© usada.  DefaultHorizontalLayoutDropHandler.java (175) </li><li>  V6021 O valor √© atribu√≠do √† vari√°vel 'r', mas n√£o √© usado.  ExcelExporter.java (262) </li><li>  V6021 A vari√°vel 'over' n√£o √© usada.  DefaultCssLayoutDropHandler.java (49) </li><li>  V6021 A vari√°vel 'transfer√≠vel' n√£o √© usada.  DefaultHorizontalLayoutDropHandler.java (171) </li><li>  V6021 A vari√°vel 'transfer√≠vel' n√£o √© usada.  DefaultHorizontalLayoutDropHandler.java (169) </li><li>  V6021 A vari√°vel 'beanLocator' n√£o √© usada.  ScreenEventMixin.java (28) </li></ul><br>  <b>Aviso 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As</a> classes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V6054</a> n√£o devem ser comparadas pelo nome.  MessageTools.java (283) <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasPropertyCaption</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MetaProperty property)</span></span></span><span class="hljs-function"> </span></span>{ Class&lt;?&gt; declaringClass = property.getDeclaringClass(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (declaringClass == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; String caption = getPropertyCaption(property); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = caption.indexOf(<span class="hljs-string"><span class="hljs-string">'.'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; declaringClass.getSimpleName().equals(caption.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, i))) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br>  O analisador detectou uma situa√ß√£o ao comparar classes por nome.  Essa compara√ß√£o est√° incorreta porque, de acordo com a especifica√ß√£o, as classes da JVM t√™m um nome exclusivo apenas dentro do pacote.  Isso pode causar compara√ß√£o e execu√ß√£o incorretas do c√≥digo errado que foi planejado. <br><br><h2>  Feedback do desenvolvedor de plataforma CUBA </h2><br>  <i>Obviamente, em qualquer projeto importante, h√° bugs.</i>  <i>Por isso, concordamos com satisfa√ß√£o com a proposta da equipe do PVS-Studio de verificar nosso projeto.</i>  <i>O reposit√≥rio CUBA inclui garfos de algumas bibliotecas OSS de terceiros sob a licen√ßa Apache 2, e parece que precisamos prestar mais aten√ß√£o a esse c√≥digo, o analisador encontrou alguns problemas nessas fontes.</i>  <i>Agora usamos o SpotBugs como o analisador principal e ele n√£o encontra alguns problemas significativos encontrados pelo PVS-Studio.</i>  <i>Est√° na hora de escrever os cheques adicionais.</i>  <i>Muito obrigado √† equipe PVS-Studio pelo trabalho realizado.</i> <br><br>  Os desenvolvedores tamb√©m observaram que os avisos V6013 e V6054 s√£o falsos.  O c√≥digo foi escrito de forma intencional.  O analisador est√°tico foi projetado para detectar fragmentos de c√≥digo suspeitos e a probabilidade de encontrar um erro √© diferente para todas as inspe√ß√µes.  No entanto, √© f√°cil trabalhar com esses avisos usando o mecanismo conveniente para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">supress√£o em massa de avisos do analisador</a> sem modificar os arquivos de c√≥digo-fonte. <br><br>  Outra equipe do PVS-Studio n√£o pode ignorar a frase ‚Äú√© hora de escrevermos verifica√ß√µes adicionais‚Äù e n√£o deixar essa imagem :) <br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e2e/319/50d/e2e31950d545befb04ba1f2546583b8c.png" alt="Quadro 1"></div><br><h2>  Conclus√£o </h2><br>  O PVS-Studio ser√° um √≥timo complemento para o seu projeto existente para melhorar as ferramentas de qualidade de c√≥digo.  Especialmente se houver dezenas, centenas e milhares de funcion√°rios.  O PVS-Studio foi projetado n√£o apenas para encontrar erros, mas tamb√©m para corrigi-los.  Al√©m disso, n√£o estamos falando de edi√ß√£o autom√°tica de c√≥digo, mas de controle confi√°vel da qualidade do c√≥digo.  Em uma grande empresa, √© imposs√≠vel imaginar uma situa√ß√£o em que absolutamente todos os desenvolvedores verifiquem independentemente seu c√≥digo com v√°rias ferramentas, portanto, ferramentas como o PVS-Studio s√£o mais adequadas para essas empresas, onde o controle de qualidade do c√≥digo √© fornecido em todas as etapas do desenvolvimento, n√£o apenas para um programador comum. <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Se voc√™ deseja compartilhar este artigo com um p√∫blico que fala ingl√™s, use o link para a tradu√ß√£o: Svyatoslav Razmyslov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Analisando o c√≥digo da plataforma CUBA com o PVS-Studio</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449022/">https://habr.com/ru/post/pt449022/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449008/index.html">Registrando solicita√ß√µes HTTP no Spring Boot usando bobinas</a></li>
<li><a href="../pt449012/index.html">O mundo! Trabalho! iOS! Viva a oferta por 1 dia</a></li>
<li><a href="../pt449014/index.html">Advance Ethereum DAPP</a></li>
<li><a href="../pt449016/index.html">Esteganografia no sistema de arquivos de disco √≥ptico</a></li>
<li><a href="../pt449020/index.html">Analisando o c√≥digo da plataforma CUBA com o PVS-Studio</a></li>
<li><a href="../pt449024/index.html">"O Segredo do Terceiro Planeta" com gr√°ficos aprimorados de redes neurais</a></li>
<li><a href="../pt449026/index.html">Sistemas operacionais: tr√™s pe√ßas f√°ceis. Parte 4: Introdu√ß√£o ao Agendador (tradu√ß√£o)</a></li>
<li><a href="../pt449028/index.html">Raiva, barganha e depress√£o ao trabalhar com o InfluxDB</a></li>
<li><a href="../pt449032/index.html">Projetamos um sistema de extin√ß√£o de inc√™ndios por aspers√£o</a></li>
<li><a href="../pt449034/index.html">Citymobil - um manual para melhorar a disponibilidade em meio ao crescimento dos neg√≥cios para startups. Parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>