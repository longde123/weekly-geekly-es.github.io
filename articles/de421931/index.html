<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèø üë∫ üëÄ Auswirkungen des Spectre-, Meltdown- und Foreshadow-Schutzes auf die Leistung von Linux 4.19 üà∫ üë®üèø‚Äçüé® üçç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine der h√§ufigsten Fragen in letzter Zeit ist, wie sich der Schutz gegen Meltdown / Spectre und jetzt auch gegen L1TF / Foreshadow auf die Linux-Leis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Auswirkungen des Spectre-, Meltdown- und Foreshadow-Schutzes auf die Leistung von Linux 4.19</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421931/">  Eine der h√§ufigsten Fragen in letzter Zeit ist, wie sich der Schutz gegen Meltdown / Spectre und jetzt auch gegen L1TF / Foreshadow auf die Linux-Leistung auswirkt.  Der Start <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Linux 4.19-Kernel-</a> Entwicklung in diesem Monat hat nicht nur f√ºr x86_64, sondern auch f√ºr POWER / s390 / ARM das Feuer angeheizt.  Um einen allgemeinen √úberblick √ºber die Auswirkungen von Patches auf die Leistung zu erhalten, habe ich drei Intel Xeon-Systeme und zwei AMD EPYC-Systeme sowie eine virtuelle Maschine auf jeder Seite getestet, um die Standardleistung des Linux 4.19-Kernels mit und ohne entsprechende Patches zu bewerten. <br><br><img src="https://habrastorage.org/webt/ny/54/eb/ny54eb_sf-hbc3gnhnmicbijlus.jpeg"><br><a name="habracut"></a><br>  Auf allen Computern wurde ein System mit dem am vergangenen Wochenende ver√∂ffentlichten Linux-Kernel 4.19-rc1 installiert.  Zu den relevanten Patches unter Intel geh√∂ren die Seitentabellenisolation (PTI / KPTI) f√ºr Meltdown und verschiedene Spectre-Patches gegen spekulative Ausf√ºhrung von Befehlen, einschlie√ülich L√∂schen des __user-Zeigers mithilfe von Retpoline √ºber IBPB IBRS_FW, Patch f√ºr Speculative Store Bypass-Sicherheitsanf√§lligkeit mit prctl und seccomp und auch PTE-Inversion und bedingtes Cache-Leeren in virtuellen Maschinen - dies gilt f√ºr L1TF / Foreshadow. <br><br>  Standardm√§√üig bietet der Linux-Kernel keinen vollst√§ndigen Schutz vor Sicherheitsl√ºcken, indem die Intel HT / SMT-Unterst√ºtzung deaktiviert wird. Denken Sie also daran, wenn Sie virtuelle Maschinen verwenden und nicht vertrauensw√ºrdigen Code oder Benutzerzugriff auf die VM gew√§hren.  Wenn Sie den vollst√§ndigen Schutz ausw√§hlen und SMT deaktivieren, sind die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auswirkungen auf die Leistung</a> aufgrund der Halbierung der Anzahl verf√ºgbarer Threads <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">viel deutlicher</a> .  Cloud-Dienstanbieter scheinen Scheduler einfach so zu konfigurieren, dass SMT-Flows nicht durch Benutzer geleitet werden.  Dies vermeidet die offensichtlich enormen Kosten f√ºr die Deaktivierung von Hyper Threading.  Jetzt vergleichen wir nur den Schutz des Stock / Standard-Kernels. <br><br><img src="https://habrastorage.org/webt/kh/fe/dx/khfedx0pj97ldov-l55f4cidlwa.jpeg"><br><br>  AMD EPYC bietet standardm√§√üig nur Schutz f√ºr die entsprechenden Schwachstellen, die sie betreffen: Dies l√∂scht den __user-Zeiger f√ºr Spectre V1, AMD Retpoline IBPB f√ºr Spectre V2 und deaktiviert den Speculative Store Bypass (SSBD) f√ºr Spectre V4. <br><br><img src="https://habrastorage.org/webt/cq/ms/lw/cqmslwmsupwjqmyrsd1dwoypby0.jpeg"><br><br>  Nach dem Testen aller Konfigurationen auf dem Linux 4.19-rc1-Standardkernel wurden die Tests zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laufzeit</a> mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verschiedenen Schutzschaltern</a> wiederholt.  Alle Systeme wurden mit Ubuntu 18.04.1 LTS x86_64 mit Linux-Kernel 4.19-rc1 √ºber Ubuntu Mainline Kernel PPA, das neueste Mikrocode / BIOS, GCC 7.3 und EXT4-Dateisystem getestet. <br><br><img src="https://habrastorage.org/webt/ml/n5/ps/mln5psdiqvdrykijquh0shkve90.jpeg"><br><br>  Systemkonfigurationen im Test: <br><br><ul><li>  Intel Xeon E3-1280 v5 Skylake auf MSI Z170A SLI PLUS-Motherboard, 16 GB DDR4 und 256 GB Toshiba RD400 NVMe SSD. </li><li>  Intel Xeon E5-2687W v3 Haswell auf MSI X299 SLI PLUS-Motherboard, 32 GB DDR4 und 80 GB Intel 530 SATA 3.0 SSD. </li><li>  Zwei Intel Xeon Gold 6138 Tyan 1U-Racks mit 96 GB RAM und Samsung 970 EVO NVMe SSD 256 GB. </li><li>  Virtuelle KVM-Maschine auf dem oben genannten Xeon Gold-Server mit zwei Prozessoren.  Diese VM war der einzige aktive Prozess auf dem Computer und wurde f√ºr den Zugriff auf 80% der Kerne / Threads der CPU (64 Threads), 48 GB RAM und eine virtuelle Festplatte mit 118 GB konfiguriert.  W√§hrend des Tests wurde der Schwachstellenschutz sowohl auf dem Host als auch auf der VM deaktiviert. </li><li>  AMD EPYC 7601 auf einem Tyan 2U-Server mit 128 GB RAM und 280 GB Intel Optane 900p NVMe SSD. </li><li>  Die virtuelle KVM-Maschine auf dem oben genannten AMD EPYC 7601-Server. Sie hat Zugriff auf 80% der CPU-Kerne / Threads (52 Threads), 48 GB RAM und eine virtuelle Festplatte mit 120 GB. </li><li>  AMD EPYC 7551 Server auf einem Gigabyte MZ31-AR0 Motherboard mit 32 GB RAM und Samsung 960 EVO 256 GB NVMe SSD. </li></ul><br>  Offensichtlich sind die Konfigurationen der Maschinen unterschiedlich und sie sollen nicht miteinander verglichen werden, n√§mlich um den Ein / Aus-Schutz gegen Schwachstellen von Prozessoren auf dem Linux 4.19-Kernel zu √ºberpr√ºfen.  Aus Gr√ºnden der √úbersichtlichkeit werden daher alle Daten auf die Leistung jedes Systems normiert.  Alle Tests aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Phoronix Test Suite</a> . <br><br>  F√ºr den Artikel wurden Tests ausgew√§hlt, die sich auf Spectre / Meltdown beziehen, dh mit intensiven Input-Output- oder Kernel-Interaktionen.  Die Last liegt nur bei der CPU und h√§ngt nicht stark vom Prozessor-Cache ab. <br><br><img src="https://habrastorage.org/webt/oo/vi/ba/oovibakv98wgg-0sby352zo6718.jpeg"><br><br>  Das CompileBench-Profil ist wahrscheinlich der einfachste Weg, um die Auswirkungen von Spectre / Meltdown zu zeigen.  Auf dem Linux 4.19-Kernel weisen Intel-Prozessoren bei aktiviertem Schutz einen Leistungsabfall von 7 bis 16% auf, w√§hrend AMD-Prozessoren einen Leistungsabfall von 3 bis 4% aufweisen. <br><br><img src="https://habrastorage.org/webt/d3/n9/tp/d3n9tpig2tr9pxkzkhtkfoil-um.jpeg"><br><br>  Eine √§hnliche Situation bei Untertests beim Lesen eines kompilierten Baums.  Intel-Prozessoren weisen einen Leistungsabfall von 14 bis 15% auf, AMD-Prozessoren einen R√ºckgang von 4 bis 5%. <br><br><img src="https://habrastorage.org/webt/_y/u9/lz/_yu9lz69pephav9opkigeaxvtze.jpeg"><br><br>  Bei realen Aufgaben wie dem Kompilieren des Linux-Kernels betr√§gt der Leistungsunterschied etwa 2%. <br><br><img src="https://habrastorage.org/webt/sv/-x/ha/sv-xha-gkgnrdkktyibfovq9t8g.jpeg"><br><br>  Der Hackbench-Kernel-Scheduler-Benchmark leidet ebenfalls unter einer Sicherheitsaktivierung.  Bei Intel-Prozessoren ist die Leistung mit Ausnahme von Xeon Gold um etwa 20% reduziert.  AMD EPYC-Systeme machen keinen gro√üen Unterschied. <br><br><img src="https://habrastorage.org/webt/04/06/kd/0406kdun9xswkjy0waknggdgj08.jpeg"><br><br>  Der PostgreSQL-Datenbankserver ist eine der realen Anwendungen, die nach der Installation des Schutzes auf Prozessoren unter Leistungseinbu√üen litten.  In diesem speziellen Test betrug der Unterschied f√ºr Intel-Prozessoren 5-8% und f√ºr EPYC 1%. <br><br><img src="https://habrastorage.org/webt/d7/ht/z5/d7htz5ce483cindrcyaoszxhknq.jpeg"><br><br><img src="https://habrastorage.org/webt/_r/g7/gw/_rg7gw5len0ay5jnsascpkopmq8.jpeg"><br><br><img src="https://habrastorage.org/webt/wo/ol/ar/woolarputb09q2zbz83vexnrl5i.jpeg"><br><br>  Ein weiteres echtes Programm mit Leistungseinbu√üen aufgrund von Spectre / Meltdown ist der grafische Editor von GIMP.  Der Unterschied f√ºr Intel betr√§gt 5-10%, f√ºr AMD - 0-2%. <br><br><img src="https://habrastorage.org/webt/xc/q6/_w/xcq6_wirra5za2bncyixkzidug4.jpeg"><br><br>  Das Redis DBMS auf dem Intel Skylake E3 v5-System verlangsamt sich um 11% und auf anderen Intel-Prozessoren - um 5-7% betr√§gt der Unterschied zwischen AMD EPYC-Systemen 1-5%. <br><br><img src="https://habrastorage.org/webt/qm/s1/iu/qms1iupekz-mk2mbz4bvpcuj5nw.jpeg"><br><br>  Der Nginx-Webserver auf getesteten Xeon-Systemen im Linux 4.19-Kernel zeigte einen Leistungsunterschied von bis zu 20% und auf AMD EPYC - von 1-2% auf 6%. <br><br><img src="https://habrastorage.org/webt/f2/gx/io/f2gxio7epg4idsah433z4owp-yo.jpeg"><br><br>  Ebenso l√§uft der Apache-Webserver w√§hrend der Standardinstallation nach Aktivierung des Schutzes auf Intel-Prozessoren viel langsamer und auf AMD-Prozessoren praktisch ohne √Ñnderungen. <br><br><img src="https://habrastorage.org/webt/6x/az/ad/6xazadxauibjyqviwxdwesoex4s.jpeg"><br><br>  Im Test f√ºr die Geschwindigkeit beim Erstellen von OSBench-Dateien verlangsamt sich das System unter Intel Xeon um 13-16% und das EPYC-System um 6-9%. <br><br><img src="https://habrastorage.org/webt/jz/vx/g8/jzvxg8ciylrguvqbtfdd_2oy6uy.jpeg"><br><br>  Der Test zum Erstellen von Threads zeigt auch einen sp√ºrbaren Unterschied zwischen Intel- und AMD-Prozessoren. <br><br><img src="https://habrastorage.org/webt/uc/ic/nw/ucicnw3c70sjdmflrbaccejf1v4.jpeg"><br><br><img src="https://habrastorage.org/webt/aq/ge/nf/aqgenf8s9z88j9mdzb35eq340e8.jpeg"><br><br>  Beim Starten von Programmen und Erstellen von Prozessen gibt es einen kleineren, aber sp√ºrbaren Unterschied im Standardbetrieb des Linux 4.19-Kernels im Vergleich zum deaktivierten Schutz. <br><br>  So sieht es mit der Leistung von Prozessoren auf dem Linux 4.19-Kernel nach der Installation von Patches aus.  Beachten Sie, dass, wenn Ihre Systeme f√ºr unzuverl√§ssige Benutzer / Code offen sind, insbesondere in virtuellen Maschinen, m√∂glicherweise zus√§tzliche Aktionen zum Schutz erforderlich sind, z. B. l1tf = full, bis hin zum Deaktivieren von SMT / HT oder zum obligatorischen Leeren des L1-Cache verringert die Systemleistung weiter.  Die Wirkung dieser Schutzma√ünahmen gegen L1TF / Foreshadow wurde in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Artikel</a> ausf√ºhrlicher <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beschrieben</a> . <br><br>  Vielleicht werden wir in Zukunft √§hnliche Tests unter Linux 4.19 mit Desktop-Prozessoren und entsprechenden Workloads durchf√ºhren. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de421931/">https://habr.com/ru/post/de421931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de421921/index.html">Warum sollte ein IT-Spezialist ‚Äûwissen, was andere leben‚Äú?</a></li>
<li><a href="../de421923/index.html">Wir verstehen Designberufe</a></li>
<li><a href="../de421925/index.html">√úbersicht √ºber den 3D-Drucker Raise 3D Pro 2 Plus</a></li>
<li><a href="../de421927/index.html">√úberblick √ºber das Smartphone General Mobile GM8 Go: Ein t√ºrkischer Budget-Mitarbeiter mit Android 8.1 Oreo Go Edition</a></li>
<li><a href="../de421929/index.html">Ein Jahr vor dem Brexit: Gro√übritannien l√∂st das Problem des Arbeitskr√§ftemangels durch Robotik</a></li>
<li><a href="../de421933/index.html">Die Untersuchung der Dateisystem-Festplatte des DVR-Modells QCM-08DL</a></li>
<li><a href="../de421935/index.html">Erste Eindr√ºcke vom √úbergang von Ubuntu 16.04 LTS zu Ubuntu 18.04 LTS</a></li>
<li><a href="../de421937/index.html">Smart City im Inneren - ein Blick auf Huawei</a></li>
<li><a href="../de421939/index.html">Verwenden von SQL in Rails</a></li>
<li><a href="../de421945/index.html">Google und Mastercard schlie√üen ein geheimes Gesch√§ft ab, um Eink√§ufe in Gesch√§ften zu verfolgen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>