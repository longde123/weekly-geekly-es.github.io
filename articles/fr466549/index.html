<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèº üë©‚Äçüë©‚Äçüëß‚Äçüëß üôçüèΩ Principes g√©n√©raux de fonctionnement de QEMU-KVM üïí üíï üë®üèº‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ma compr√©hension actuelle: 

 1) KVM 
 KVM (Kernel-based Virtual Machine) - un hyperviseur (VMM - Virtual Machine Manager), fonctionnant comme un modu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Principes g√©n√©raux de fonctionnement de QEMU-KVM</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466549/"><img src="https://habrastorage.org/webt/ot/t0/n9/ott0n9wlbvlxmct3v_cftcgzimq.png" alt="image"><br><br>  Ma compr√©hension actuelle: <br><br><h2>  1) KVM </h2><br>  KVM (Kernel-based Virtual Machine) - un hyperviseur (VMM - Virtual Machine Manager), fonctionnant comme un module sur le syst√®me d'exploitation Linux.  Un hyperviseur est n√©cessaire pour ex√©cuter certains logiciels dans un environnement (virtuel) inexistant et en m√™me temps, cacher √† ce logiciel le v√©ritable mat√©riel physique sur lequel ce logiciel fonctionne.  L'hyperviseur agit comme une ¬´bande¬ª entre le mat√©riel physique (h√¥te) et le syst√®me d'exploitation virtuel (invit√©). <br><br>  Puisque KVM est un module standard du noyau Linux, il re√ßoit du noyau tous les nishtyaki requis (travail avec m√©moire, ordonnanceur, etc.).  Et en cons√©quence, en fin de compte, tous ces avantages vont aux invit√©s (car les invit√©s travaillent sur un hyperviseur qui fonctionne sur / dans le noyau Linux). <br><br>  KVM est tr√®s rapide, mais il ne suffit pas √† lui seul pour ex√©cuter un syst√®me d'exploitation virtuel, car  cela n√©cessite une √©mulation d'E / S.  Pour les E / S (processeur, lecteurs, r√©seau, vid√©o, PCI, USB, ports s√©rie, etc.) KVM utilise QEMU. <br><a name="habracut"></a><br><h2>  2) QEMU </h2><br>  QEMU (Quick Emulator) - un √©mulateur de divers appareils qui vous permet d'ex√©cuter des syst√®mes d'exploitation con√ßus pour une architecture sur une autre (par exemple, ARM -&gt; x86).  En plus du processeur, QEMU √©mule divers p√©riph√©riques: cartes r√©seau, disque dur, cartes vid√©o, PCI, USB, etc. <br><br>  Cela fonctionne comme ceci: <br><br>  Les instructions / code binaire (par exemple, ARM) sont convertis en un code interm√©diaire ind√©pendant de la plate-forme √† l'aide du convertisseur TCG (Tiny Code Generator), puis ce code binaire ind√©pendant de la plate-forme est converti en instructions / code cible (par exemple, x86). <br><br>  ARM -&gt; middleware -&gt; x86 <br><br>  En fait, vous pouvez ex√©cuter des machines virtuelles sur QEMU sur n'importe quel h√¥te, m√™me avec des mod√®les de processeur plus anciens qui ne prennent pas en charge Intel VT-x (Intel Virtualization Technology) / AMD SVM (AMD Secure Virtual Machine).  Cependant, dans ce cas, cela fonctionnera tr√®s lentement, car le binaire doit √™tre recompil√© √† la vol√©e deux fois √† l'aide de TCG (TCG est un compilateur Just-in-Time). <br><br>  C'est-√†-dire  QEMU lui-m√™me est m√©ga cool, mais il fonctionne tr√®s lentement. <br><br><h2>  3) Anneaux de protection </h2><br><img src="https://habrastorage.org/webt/q9/xd/ap/q9xdapkypgr_aglcqz9xryfm8kg.png" alt="image"><br><br>  Le code de programme binaire sur les processeurs ne fonctionne pas comme √ßa, mais est situ√© √† diff√©rents niveaux (anneaux de protection) avec diff√©rents niveaux d'acc√®s aux donn√©es, des plus privil√©gi√©s (anneau 0) aux plus limit√©s, sur-r√©glement√©s et ¬´avec des √©crous serr√©s¬ª (anneau 3 ) <br><br>  Le syst√®me d'exploitation (noyau OS) fonctionne sur Ring 0 (mode noyau) et peut faire n'importe quoi avec n'importe quelles donn√©es et p√©riph√©riques.  Les applications utilisateur fonctionnent au niveau Ring 3 (mode utilisateur) et n'ont pas le droit de faire ce qu'elles veulent, mais doivent √† la place demander √† chaque fois l'acc√®s pour effectuer une op√©ration (de cette mani√®re, les applications utilisateur n'ont acc√®s qu'√† leurs propres donn√©es et ne peuvent pas "Entrez dans" le bac √† sable de quelqu'un d'autre ").  Les anneaux 1 et 2 sont destin√©s aux conducteurs. <br><br>  Avant l'invention d'Intel VT-x / AMD SVM, les hyperviseurs fonctionnaient sur Ring 0, et les invit√©s travaillaient sur Ring 1. √âtant donn√© que Ring 1 ne dispose pas de droits suffisants pour le fonctionnement normal du syst√®me d'exploitation, puis √† chaque appel privil√©gi√© du syst√®me invit√©, l'hyperviseur devait modifier cet appel √† la vol√©e. et l'ex√©cuter sur Ring 0 (quelque chose comme QEMU fait).  C'est-√†-dire  le code binaire invit√© n'a <b><i>PAS</i></b> √©t√© ex√©cut√© directement sur le processeur, et √† chaque vol, il y a eu plusieurs modifications interm√©diaires. <br><br>  La surcharge √©tait importante et c'√©tait un gros probl√®me, puis les fabricants de processeurs, ind√©pendamment les uns des autres, ont publi√© un ensemble √©tendu d'instructions (Intel VT-x / AMD SVM) qui permettent d'ex√©cuter le code OS invit√© <b><i>DIRECTEMENT</i></b> sur le processeur h√¥te (en √©vitant toutes les √©tapes interm√©diaires co√ªteuses, comme c'√©tait avant). <br><br>  Avec l'av√®nement d'Intel VT-x / AMD SVM, un nouveau niveau sp√©cial Ring -1 (moins un) a √©t√© cr√©√©.  Et maintenant, l'hyperviseur y travaille, et les invit√©s travaillent sur Ring 0 et obtiennent un acc√®s privil√©gi√© au CPU. <br><br>  C'est-√†-dire  en cons√©quence: <br><br><ul><li>  l'h√¥te s'ex√©cute sur Ring 0 </li><li>  les clients travaillent au Ring 0 </li><li>  l'hyperviseur fonctionne sur Ring -1 </li></ul><br><h2>  4) QEMU-KVM </h2><br>  KVM fournit aux clients un acc√®s √† Ring 0 et utilise QEMU pour √©muler les E / S (processeur, disques, r√©seau, vid√©o, PCI, USB, ports s√©rie, etc. que les clients ¬´voient¬ª et utilisent). <br><br>  D'o√π le QEMU-KVM (ou KVM-QEMU) :) <br><br>  <i>CR√âDITS</i> <i><br></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une image pour attirer l'attention</a></i> <i><br></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anneaux de protection d'image</a></i> <br><br>  <i>PS Le texte de cet article a √©t√© initialement publi√© dans la cha√Æne Telegram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@RU_Voip</a> en r√©ponse √† la question de l'un des participants √† la cha√Æne.</i> <i><br><br></i>  <i>√âcrivez dans les commentaires dans quels endroits je ne comprends pas correctement le sujet ou s'il y a quelque chose √† compl√©ter.</i> <i><br><br></i>  <i>Je vous remercie!</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466549/">https://habr.com/ru/post/fr466549/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466537/index.html">Utilisation de modules JavaScript en production: situation actuelle. Partie 1</a></li>
<li><a href="../fr466539/index.html">Utilisation de modules JavaScript en production: situation actuelle. 2e partie</a></li>
<li><a href="../fr466541/index.html">Utilisation de DbTool pour amorcer des bases de donn√©es dans des applications .NET (Core)</a></li>
<li><a href="../fr466543/index.html">Les pr√™ts Habr Weekly # 17 / Sberbank seront approuv√©s par AI - effrayant, publicit√© dans les produits open source - douteux</a></li>
<li><a href="../fr466547/index.html">Bonne f√™te du programmeur</a></li>
<li><a href="../fr466551/index.html">Marionnettiste avec ES6 dans un n≈ìud et un navigateur, ou pourquoi Zora est le meilleur framework de test dans sa niche</a></li>
<li><a href="../fr466553/index.html">6 le√ßons tir√©es de la recherche d'une solution √† un probl√®me majeur sur gitlab.com. 2e partie</a></li>
<li><a href="../fr466555/index.html">6 le√ßons tir√©es de la recherche d'une solution √† un probl√®me majeur sur gitlab.com. Partie 1</a></li>
<li><a href="../fr466557/index.html">Comment cr√©er une mise en page pour le site et ne pas rester extr√™me</a></li>
<li><a href="../fr466559/index.html">Soit le nouveau Var</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>