<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåá üö∏ üõÄüèø Obteniendo FPGA en Python üçí üë©üèΩ‚Äçü§ù‚Äçüë®üèæ üßìüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La tecnolog√≠a FPGA (FPGA) actualmente est√° ganando gran popularidad. El n√∫mero de aplicaciones est√° creciendo: adem√°s de procesar se√±ales digitales, l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Obteniendo FPGA en Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439638/">  La tecnolog√≠a FPGA (FPGA) actualmente est√° ganando gran popularidad.  El n√∫mero de aplicaciones est√° creciendo: adem√°s de procesar se√±ales digitales, los FPGA tambi√©n se utilizan para acelerar el aprendizaje autom√°tico, en tecnolog√≠as blockchain, procesamiento de video y en IoT. <br><br>  Esta tecnolog√≠a tiene un inconveniente significativo: para la programaci√≥n, se utilizan lenguajes de descripci√≥n bastante complejos y espec√≠ficos de los equipos digitales Verilog y VHDL.  Esto complica la entrada de un reci√©n llegado a la FPGA y es dif√≠cil para un empleador encontrar un especialista con este conocimiento espec√≠fico en el mercado laboral.  Por otro lado, el popular lenguaje de programaci√≥n Python de alto nivel con el marco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MyHDL</a> hace que la programaci√≥n FPGA sea simple y agradable.  Adem√°s, las personas que conocen Python son un orden de magnitud m√°s especialistas con Verilog / VHDL.  Con una serie de art√≠culos, quiero mostrar lo f√°cil que es ingresar al campo de FPGA conociendo Python y comenzar a realizar proyectos FPGA realmente complejos en este lenguaje.  Observo que python no se ejecuta directamente en el FPGA, sino que es una herramienta para generar firmware. <br><a name="habracut"></a><br>  Primero, necesitamos la versi√≥n 3.6 de Python (en adelante, todas las operaciones se realizan en el sistema operativo Ubuntu 18.04). <br><br>  Instalar myhdl: <br><br><pre><code class="bash hljs">pip3 install myhdl</code> </pre> <br>  Como "¬°Hola mundo!"  Escribiremos un programa simple que haga que los LED se enciendan cuando se presione un bot√≥n.  En el mundo de los microprocesadores "¬°Hola Mundo!"  Este es un programa que parpadea con un LED, en el mundo FPGA Hello World es el parpadeo de miles de LED.  Solo hay cuatro LED en el tablero, por lo que solo los parpadearemos, dependiendo de la presi√≥n del bot√≥n.  Es importante tener en cuenta que todo el c√≥digo en FPGA, a diferencia de los microcontroladores, se ejecuta al mismo tiempo, todos los diodos se encienden y se apagan al mismo tiempo.  Y no secuencialmente en el caso de los microcontroladores.  La prueba utiliza la placa WaveShare OpenEPM1270 con placas Altera Max II EPM1270T144C5 a bordo. <br><br><img src="https://habrastorage.org/webt/-l/lk/c8/-llkc88kifaz0umesq_pctqoim4.jpeg"><br><br>  Crea un nuevo archivo de Python: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> myhdl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> randrange <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">led_blinker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(input1, led1, led2, led3, led4)</span></span></span><span class="hljs-function">:</span></span> @always_comb <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_off_led</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> input1 == <span class="hljs-number"><span class="hljs-number">1</span></span>: led1.next = <span class="hljs-number"><span class="hljs-number">1</span></span> led2.next = <span class="hljs-number"><span class="hljs-number">1</span></span> led3.next = <span class="hljs-number"><span class="hljs-number">0</span></span> led4.next = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: led1.next = <span class="hljs-number"><span class="hljs-number">0</span></span> led2.next = <span class="hljs-number"><span class="hljs-number">0</span></span> led3.next = <span class="hljs-number"><span class="hljs-number">1</span></span> led4.next = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> on_off_led</code> </pre><br>  Para saber si nuestro c√≥digo funciona correctamente, necesita una herramienta de verificaci√≥n.  De hecho, cualquier programa para FPGA es un procesador de se√±al digital, por lo que el desarrollador debe asegurarse de indicar correctamente qu√© hacer con el chip.  Esto se hace a trav√©s de la simulaci√≥n, para esto necesita instalar un programa que muestre las se√±ales procesadas.  Hay muchos de estos programas, pero en mi opini√≥n, el mejor GTKWave gratuito en este momento.  Se pone desde la terminal: <br><br><pre> <code class="bash hljs">sudo apt-get install gtkwave</code> </pre> <br>  A continuaci√≥n, en el archivo con el firmware, se debe describir el entorno de prueba.  Esta tambi√©n es una funci√≥n de Python: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> input1, led1, led2, led3, led4 = [Signal(bool(<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>)] test = led_blinker(input1, led1, led2, led3, led4) @always(delay(<span class="hljs-number"><span class="hljs-number">10</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> input1.next = randrange(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> test, gen</code> </pre><br>  Aqu√≠ el entorno de prueba genera una secuencia aleatoria de ceros y unos (se usa el m√≥dulo Python random). <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simulate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timesteps)</span></span></span><span class="hljs-function">:</span></span> tb = traceSignals(test) sim = Simulation(tb) sim.run(timesteps)</code> </pre><br>  E inicializamos el simulador, arrastrando la funci√≥n de entorno test_inverter all√≠.  Por lo tanto, obtenemos el inversor de mu√±eca ruso ‚Üí test_inverter ‚Üí simulate (tiempo en unidades arbitrarias). <br><br>  Despu√©s de ejecutar el script en la carpeta de trabajo, cree un archivo .vcd y ejec√∫telo a trav√©s de gtkwave, en el terminal: gtkwave test_invereter.vcd. <br><br><img src="https://habrastorage.org/webt/fr/qf/lv/frqflvkzfgc2s_7s2ct4bsr6lem.png"><br><br>  Como resultado, se gener√≥ una secuencia aleatoria de se√±ales de entrada input1 y c√≥mo la funci√≥n led_blinker proces√≥ estas se√±ales. <br><br>  Despu√©s de asegurarnos de que la l√≥gica funcionara exactamente como quer√≠amos, deber√≠amos incluir esta funci√≥n en FPGA.  Estoy acostumbrado a trabajar con chips de Intel (anteriormente Altera), esta secuencia de operaciones es similar para los chips de otros fabricantes con sistemas CAD adecuados.  Se crea un archivo binario en el chip FPGA, creado por el compilador del fabricante del chip, para Intel es Quartus, para Xilinx Vivado.  Los compiladores solo pueden trabajar con c√≥digo en VHDL / Verilog, por lo que el c√≥digo de Python debe traducirse a cualquiera de estos idiomas (no importa cu√°l). <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> input1, led1, led2, led3, led4 = [Signal(bool(<span class="hljs-number"><span class="hljs-number">0</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>)] toVerilog(led_blinker, input1, led1, led2, led3, led4) convert()</code> </pre><br>  En este ejemplo, el c√≥digo se traduce a Verilog.  El resultado est√° en el archivo led_blinker.v, y Quartus deber√° proporcionarlo para generar el firmware FPGA: <br><br><pre> <code class="vhdl hljs">module led_blinker ( input1, led1, led2, led3, led4 ); input input1; output led1; reg led1; output led2; reg led2; output led3; reg led3; output led4; reg led4; always @(input1) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: LED_BLINKER_ON_OFF_LED <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((input1 == <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> led1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; led2 = <span class="hljs-number"><span class="hljs-number">1</span></span>; led3 = <span class="hljs-number"><span class="hljs-number">0</span></span>; led4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> led1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; led2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; led3 = <span class="hljs-number"><span class="hljs-number">1</span></span>; led4 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> endmodule</code> </pre> <br>  En este enfoque para el desarrollo del firmware FPGA, puede ignorar este archivo y simplemente colocarlo en Quartus. <br><br>  Puede descargar Quartus desde <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fpgasoftware.intel.com</a> , necesitamos una versi√≥n gratuita de Lite, ser√° suficiente para nosotros.  Descargue el tama√±o de la versi√≥n b√°sica de 9 GB. <br><br>  Instalar Quartus no deber√≠a ser un problema para el usuario promedio de Linux.  Despu√©s de la instalaci√≥n, debe establecer algunos par√°metros en el sistema para poder usar el dispositivo para flashear el programa FPGA: el programador: <br><br>  1. Crear una regla de udev.  Para hacer esto, cree un nuevo archivo /etc/udev/rules.d/51-altera-usb-blaster.rules con el siguiente contenido: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># USB-Blaster SUBSYSTEM=="usb", ATTR{idVendor}=="09fb", ATTR{idProduct}=="6001", MODE="0666" SUBSYSTEM=="usb", ATTR{idVendor}=="09fb", ATTR{idProduct}=="6002", MODE="0666" SUBSYSTEM=="usb", ATTR{idVendor}=="09fb", ATTR{idProduct}=="6003", MODE="0666" # USB-Blaster II SUBSYSTEM=="usb", ATTR{idVendor}=="09fb", ATTR{idProduct}=="6010", MODE="0666" SUBSYSTEM=="usb", ATTR{idVendor}=="09fb", ATTR{idProduct}=="6810", MODE="0666"</span></span></code> </pre><br>  Reinicie udev usando udevadm: <br><br><pre> <code class="bash hljs">sudo udevadm control --reload</code> </pre> <br>  2. Permita el acceso no root al dispositivo USB-Blaster.  Para hacer esto, cree el archivo /etc/udev/rules.d/altera-usb-blaster.rules con la l√≠nea: <br><br><pre> <code class="bash hljs">ATTR{idVendor}==<span class="hljs-string"><span class="hljs-string">"09fb"</span></span>, ATTR{idProduct}==<span class="hljs-string"><span class="hljs-string">"6001"</span></span>, MODE=<span class="hljs-string"><span class="hljs-string">"666"</span></span></code> </pre> <br>  Esto le da acceso rw-rw-rw- al programador. <br><br>  3. Configure jtagd.  Quartus utiliza el demonio jtagd para trabajar, que asocia el software con un dispositivo programador.  Copie la descripci√≥n de su directorio con Quartus: <br><br><pre> <code class="bash hljs">sudo mkdir /etc/jtagd sudo cp &lt;Quartus install path&gt;/quartus/linux64/pgm_parts.txt /etc/jtagd/jtagd.pgm_parts</code> </pre> <br>  Ejecute Quartus y cree un nuevo proyecto "Archivo" - "Asistente de nuevo proyecto", escriba el nombre del proyecto. <br><br>  Luego, haga clic en Siguiente.  Y en el men√∫ Agregar archivos, conectamos el archivo Verilog generado con la extensi√≥n .v.  Por lo tanto, si el archivo verilog se edita desde un archivo python, Quartus lo recoger√° autom√°ticamente. A continuaci√≥n, llegaremos al men√∫ de selecci√≥n de dispositivos, en nuestro caso es MAX II EMP1270T144C5 y las pr√≥ximas dos veces.  El proyecto est√° creado. <br><br>  En el Navegador de proyectos, vaya al men√∫ de archivo y haga clic derecho en nuestro archivo verilog "Establecer como entidad de nivel superior". <br><br>  Compilamos el proyecto.  Ahora, en el men√∫ "Asignaciones-Pin Planner", configure los pines en el chip: <br><br><img src="https://habrastorage.org/webt/j1/tq/2x/j1tq2xs2vmum49hubukjqbamibs.png"><br><br>  Compilar de nuevo.  Ahora todo est√° listo para la programaci√≥n: Herramientas-Programador.  Conectamos el programador y la alimentaci√≥n a la placa, en la configuraci√≥n de hardware seleccionamos nuestro USB-Blaster, configuramos las casillas de verificaci√≥n como se muestra en la figura y comenzamos. <br><br><img src="https://habrastorage.org/webt/9i/ge/t2/9iget2ugm70gdnp1rt1w5egwbii.png"><br><br>  Despu√©s de que el programador inform√≥ exitoso.  Puedes ver el resultado en el tablero: <br><br><img src="https://habrastorage.org/webt/7c/z5/9j/7cz59jrtezjl8jku1jzol5sjfhm.gif"><br><br><h4>  Conclusi√≥n </h4><br>  Esta lecci√≥n describe c√≥mo crear un entorno de trabajo y el primer proyecto simple de FPGA en el lenguaje de programaci√≥n Python. <br><br>  Considerado: <br><br><ul><li>  c√≥mo instalar: <ul><li>  myHDL; </li><li>  GTKWave; </li><li>  Quartus </li></ul></li><li>  Programador USB Blaster configurado en Ubuntu; </li><li>  FPGA Proyecto FPGA desarrollado; </li><li>  Prueba y verificaci√≥n del proyecto; </li><li>  Compil√≥ un proyecto para FPGA; </li><li>  Proyecto subido a FPGA. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439638/">https://habr.com/ru/post/439638/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439624/index.html">¬øPor qu√© almacenar datos en √≥rbita?</a></li>
<li><a href="../439626/index.html">Experiencia desarrollando una aplicaci√≥n gratuita para coleccionistas OpenNumismat</a></li>
<li><a href="../439628/index.html">Actualizaci√≥n de datos paralelos en la API web ASP.NET</a></li>
<li><a href="../439632/index.html">C√≥mo configurar la implementaci√≥n continua para su proyecto: experiencia personal</a></li>
<li><a href="../439636/index.html">La crisis de conceptos para mejorar la seguridad vial y un nuevo concepto para resolverlo</a></li>
<li><a href="../439640/index.html">Vinyl ha vuelto y es diferente.</a></li>
<li><a href="../439642/index.html">Las trampas de Java. Parte 1</a></li>
<li><a href="../439644/index.html">Antienvejecimiento: terapia de reemplazo de c√©lulas madre y senol√≠ticos</a></li>
<li><a href="../439646/index.html">SoftBank Holding vende las acciones de Nvidia debido a la ca√≠da del precio, pero a√∫n as√≠ obtiene $ 3.3 mil millones</a></li>
<li><a href="../439652/index.html">C√≥mo transportar tu startup a EE. UU .: 4 pasos importantes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>