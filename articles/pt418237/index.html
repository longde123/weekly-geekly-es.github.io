<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöê üôã ‚úãüèø Desenvolvimento de aplicativos multilocat√°rios na plataforma em nuvem SAP na Neo, parte 2: autoriza√ß√£o e autentica√ß√£o üéûÔ∏è üõ≥Ô∏è ‚ö∞Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No segundo artigo da s√©rie sobre o desenvolvimento de aplicativos na plataforma SAP Cloud no ambiente Neo, abordaremos um dos aspectos mais importante...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de aplicativos multilocat√°rios na plataforma em nuvem SAP na Neo, parte 2: autoriza√ß√£o e autentica√ß√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sap/blog/418237/"> No segundo artigo da s√©rie sobre o desenvolvimento de aplicativos na plataforma SAP Cloud no ambiente Neo, abordaremos um dos aspectos mais importantes - gerenciamento de autoriza√ß√£o e autentica√ß√£o de usu√°rio. <br><br>  Neste artigo, mostraremos como estabelecer uma conex√£o entre o SAP Cloud Platform e o provedor de identidade (IDP) do cliente imagin√°rio ABC PetroCorp, al√©m de adicionar usu√°rios ao IDP.  A seguir, veremos como atribuir fun√ß√µes para usu√°rios da empresa cliente em um aplicativo espec√≠fico (do IDP), bem como configurar atributos SAML para sua transfer√™ncia do IDP para o aplicativo da plataforma em nuvem SCP. <br><a name="habracut"></a><br>  Na subconta do cliente fict√≠cio ABC PetroCorp <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do primeiro artigo</a> , uma assinatura dos aplicativos de monitoramento de polui√ß√£o SCP fornecidos pela ITeLO Consulting j√° est√° instalada.  Agora, o funcion√°rio da ABC PetroCorp precisa disponibilizar esse aplicativo para outros colegas. <br><br>  Um usu√°rio do SAP Cloud Platform pode conectar seu IDP corporativo √† plataforma em nuvem e configurar o gerenciamento de seguran√ßa e autentica√ß√£o para o aplicativo carregado no SCP. <br><br>  A ABC PetroCorp ativou o servi√ßo de autentica√ß√£o de identidade da SAP Cloud Platform, que fornece acesso aos processos, aplicativos e dados de neg√≥cios.  Este servi√ßo fornece um inquilino SCI, dentro do qual h√° um gerenciamento de configura√ß√£o de aplicativo e autoriza√ß√£o de usu√°rio. <br><br>  Emily, a hero√≠na imagin√°ria do primeiro artigo, tem acesso a esse inquilino da SCI - ela √© sua administradora e pode configurar a autoriza√ß√£o do usu√°rio em um aplicativo espec√≠fico.  Ela quer descobrir como criar essas configura√ß√µes usando o servi√ßo de autentica√ß√£o de identidade. <br><br>  Requisitos: <br><br><ul><li>  Uma conta SCP global produtiva (n√£o experimental) com o servi√ßo de autentica√ß√£o de identidade conectado a ela (como um IDP para a subconta ABC PetroCorp); </li><li>  O usu√°rio da subconta do cliente deve ser o administrador do inquilino da SCI, para que ele tenha acesso ao console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade. </li></ul><br>  Emily precisa concluir as seguintes etapas no console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade e no painel de controle do SCP para disponibilizar o aplicativo na plataforma em nuvem para outros funcion√°rios da ABC PetroCorp: <br><br>  <i>Etapa 1: estabelecer uma rela√ß√£o de confian√ßa entre o inquilino SCI e a subconta SCP.</i> <i><br></i>  <i>Etapa 2: importe os usu√°rios para o locat√°rio da SCI e atualize (inclua) os atributos necess√°rios.</i> <i><br></i>  <i>Etapa 3: atribua fun√ß√µes a usu√°rios no n√≠vel do aplicativo no SCP.</i> <i><br></i>  <i>Etapa 4: configure os atributos no inquilino SCI e no painel de controle do SCP para transferi-los para o aplicativo.</i> <i><br></i>  <i>Etapa 5: verificar as configura√ß√µes.</i> <br><br>  <b><i>Etapa 1: estabelecer uma rela√ß√£o de confian√ßa entre o inquilino SCI e a subconta SCP</i></b> <b><i><br></i></b> <br>  Emily √© administradora da subconta ABC PetroCorp e locat√°ria da SCI, o que lhe permite aplicar as configura√ß√µes necess√°rias para usar a locat√°ria da SCI como um "reposit√≥rio de usu√°rios" para o aplicativo de multilocat√°rio fornecido pelo provedor de consultoria ITeLO. <br><br>  Primeiro, Emily precisa estabelecer um relacionamento de confian√ßa entre o inquilino SCI e a subconta SCP do cliente ABC PetroCorp. <br><br>  Iremos para o console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade usando o link "https: //.accounts.ondemand.com/admin", onde √© o identificador do inquilino da SCI.  Esse link pode ser encontrado na carta de registro fornecida ao administrador do inquilino do servi√ßo de autentica√ß√£o de identidade.  O identificador de inquilino tamb√©m √© indicado l√°. <br><br>  O console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade √© o seguinte: <br><br><img src="https://habrastorage.org/webt/cp/co/sg/cpcosgfcvdxme2noud-nmpiu9z8.png"><br><br>  Em outra guia do navegador, abra o painel de controle da subconta do cliente "ABC PetroCorp" e v√° para a guia "Seguran√ßa" -&gt; "Confian√ßa". <br><br><img src="https://habrastorage.org/webt/6w/xx/m0/6wxxm0jlg4ba0p4j6cin6m2n4by.png"><br><br>  No menu "Trust Management" que √© aberto, v√° para a guia "Local Service Provider" e clique em "Edit". <br><br><img src="https://habrastorage.org/webt/8r/r5/gt/8rr5gt5cef-3zbr4bh-xwapupuu.png"><br><br>  Em seguida, executamos as seguintes etapas: <br><br><ul><li>  No campo "Tipo de configura√ß√£o", altere o tipo para "Personalizado"; </li><li>  Clique em "Gerar par de chaves" para criar uma chave e um certificado para a conta; </li><li>  Altere o valor no campo "Propaga√ß√£o principal" para "Ativar"; </li><li>  Clique em "Salvar". </li></ul><br><img src="https://habrastorage.org/webt/pj/i_/yt/pji_ytcjevq_bzd5odtcvdchclm.png"><br><br>  Clique em "Obter metadados" para baixar o arquivo de metadados no formato "xml", que cont√©m as configura√ß√µes descritas anteriormente.  Ser√° usado para criar confian√ßa com o inquilino da SCI. <br><br>  Vamos voltar ao console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade e ir para a guia "Aplicativos e recursos" -&gt; "Aplicativos" no menu √† esquerda.  Na √°rea "Aplicativos", clique no bot√£o "Adicionar" para indicar um novo aplicativo implantado na subconta "ABC PetroCorp". <br><br><img src="https://habrastorage.org/webt/en/a4/ow/ena4owiid3yz0_qdn5ch4c2vexe.png"><br><br>  Na janela exibida, digite o nome do aplicativo (por exemplo, ABC_PetroCorp_IDP) e clique em "Salvar".  Depois disso, um novo ponto ser√° criado no inquilino para o nosso aplicativo. <br><br>  No aplicativo criado, v√° para a guia "Confian√ßa" e selecione o par√¢metro "Configura√ß√£o do SAML 2.0". <br><br><img src="https://habrastorage.org/webt/oi/cy/fg/oicyfgksa9mue9msaysvy_7asyq.png"><br><br>  Na se√ß√£o "Definir a partir de metadados", clique em "Procurar" e selecione o arquivo de metadados no formato "xml", baixado anteriormente ao configurar a confian√ßa na subconta SCP.  Detalhes sobre a configura√ß√£o do SAML 2.0 ser√£o preenchidos automaticamente ap√≥s o download do arquivo.  Clique em ‚ÄúSalvar‚Äù - agora a configura√ß√£o do SAML 2.0 √© criada e salva para este aplicativo. <br><br><img src="https://habrastorage.org/webt/eu/dv/se/eudvsepyrbw9drrqhzl6ydstbhe.png"><br><br>  Volte ao ponto do aplicativo chamado ABC_PetroCorp_IDP no inquilino, clique em "URL inicial" e insira um URL como "https: // pollmonmonitoringui- &lt;nome da conta de subcategoria&gt; .dispatcher. &lt;Regi√£o_host&gt;". <br><br>  Esse URL pode ser encontrado na descri√ß√£o do aplicativo HTML5 no qual o cliente est√° inscrito (subconta "ABC PetroCorp").  Para fazer isso, acesse a subconta do cliente na guia "Aplicativos" -&gt; "Assinaturas" e selecione o aplicativo HTML5 assinado. <br><br><img src="https://habrastorage.org/webt/ys/6l/bb/ys6lbbnjrqqh1tnwwsfufr_tmpe.png"><br><br>  Na guia "Vis√£o geral" ser√° o URL que precisamos. <br><br><img src="https://habrastorage.org/webt/zx/sg/_j/zxsg_jrg0wntfrttlqjlv5l2q3y.png"><br><br>  Em seguida, retornamos ao ponto do aplicativo no inquilino da SCI, designamos o URL do aplicativo no "URL inicial" e clique em "Salvar". <br><br><img src="https://habrastorage.org/webt/rm/ie/od/rmieoddhrh-rj2wopqy9llz_dqm.png"><br><br>  Agora v√° para a guia "Aplicativos e recursos" -&gt; "Configura√ß√µes do inquilino" no console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade.  Na p√°gina de configura√ß√µes do inquilino, selecione "Configura√ß√£o SAML 2.0". <br><br><img src="https://habrastorage.org/webt/nj/yf/fx/njyffxlfgdvcp5y3m-nyeqznqde.png"><br><br>  Na janela que se abre, clique em "Baixar arquivo de metadados" para baixar o arquivo "xml" que cont√©m as configura√ß√µes de inquilino da SCI.  Ser√° usado no futuro para estabelecer confian√ßa com a subconta do cliente no SCP. <br><br>  Volte para a subconta ‚ÄúABC PetroCorp‚Äù e v√° para o menu ‚ÄúSeguran√ßa‚Äù -&gt; ‚ÄúConfian√ßa‚Äù, na janela que se abre, selecione a guia ‚ÄúProvedor de identidade de aplicativos‚Äù.  Clique em "Adicionar provedor de identidade confi√°vel" para adicionar detalhes sobre o inquilino da SCI. <br><br><img src="https://habrastorage.org/webt/ai/x9/yg/aix9ygszpkfu5bhbmalbvyj0hpk.png"><br><br>  Na guia "Geral", clique em "Procurar" e selecione o arquivo de metadados no formato "xml" baixado do console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade.  Os detalhes da configura√ß√£o s√£o preenchidos automaticamente ap√≥s o download do arquivo.  Desmarque a caixa "Somente para SSO iniciado por IDP" e clique em "Salvar". <br><br><img src="https://habrastorage.org/webt/il/ob/nw/ilobnwscixyn19_7dfsdjifo_pm.png"><br><br>  Agora, a rela√ß√£o de confian√ßa entre a subconta do cliente ABC PetroCorp e seu inquilino SCI foi estabelecida com sucesso.  As mesmas configura√ß√µes podem ser aplicadas √†s subcontas de outros clientes (por exemplo, para o cliente XYZ EnergyCorp). <br><br>  <i><b>Etapa 2: Importar usu√°rios para o inquilino SCI e atualizar (adicionar) os atributos necess√°rios</b></i> <i><b><br></b></i> <br>  Emily precisa garantir que os usu√°rios do aplicativo sejam registrados no IDP corporativo da ABC PetroCorp. <br><br>  Idealmente, um IDP corporativo (no nosso caso, um inquilino da SCI) j√° incluiria uma lista de todos os usu√°rios da empresa.  Para maior clareza, importamos alguns usu√°rios para o inquilino da SCI, ap√≥s o qual eles receber√£o permiss√µes apropriadas para acessar o aplicativo. <br>  As demonstra√ß√µes para o aplicativo s√£o armazenadas em um arquivo ‚Äúcsv‚Äù no github - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no Github</a> . <br><br>  Fa√ßa o download do arquivo ‚ÄúCSV‚Äù para ‚ÄúABC PetroCorp‚Äù no GitHub.  Dois usu√°rios s√£o indicados no arquivo "csv": <br><br><ul><li>  Supervisor ABCPlant: Este usu√°rio ser√° o gerente de uma planta espec√≠fica da ABC PetroCorp e s√≥ poder√° visualizar dados sobre sua planta; </li><li>  ABCAreaManager: Este usu√°rio ser√° o gerente de uma √°rea inteira, que pode incluir v√°rias plantas da ABC PetroCorp.  Ele poder√° visualizar dados de todas as plantas em sua √°rea. </li></ul><br><img src="https://habrastorage.org/webt/1g/jj/kg/1gjjkg_amk9yp8nu-ht9j8ju5yg.png"><br><br>  O arquivo .csv do ABC PetroCorp cont√©m endere√ßos de email de usu√°rio fict√≠cios.  Eles precisam ser substitu√≠dos por reais, desde que as cartas cheguem a eles para ativar as contas.  Por exemplo, se seu e-mail real for "john.smith@sap.com", ser√° necess√°rio substituir a designa√ß√£o &lt;&gt; por "john.smith" e &lt;&lt;inserir_your_company&gt;&gt; por "sap". <br><br><img src="https://habrastorage.org/webt/-g/z_/jt/-gz_jtxt7lwrrhkqrsrxggowp6s.png"><br><br>  V√° para o console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade e selecione a guia "Usu√°rios e autoriza√ß√µes" -&gt; "Importar usu√°rios".  Selecione o ponto de aplica√ß√£o criado anteriormente "ABC_PetroCorp_IDP" e clique em "Procurar", depois selecione o arquivo "ABCPetroCorp.csv" que descreve nossos usu√°rios de demonstra√ß√£o - e clique no bot√£o "Importar". <br><br><img src="https://habrastorage.org/webt/ah/dv/k2/ahdvk2otnkhjwdfueyubevzd0vk.png"><br><br>  Os usu√°rios devem ativar sua conta.  Para receber um e-mail com um link de ativa√ß√£o, voc√™ deve clicar em "Enviar" na janela "Enviar e-mails". <br><br>  Antes de ativar o usu√°rio, voc√™ precisa alterar algumas configura√ß√µes. <br>  V√° para a aba "Usu√°rios e autoriza√ß√µes" -&gt; "Gerenciamento de usu√°rios".  Dois usu√°rios apareceram nas listas de usu√°rios: "Area Manager" e "Plant Supervisor".  Eles s√£o identificados automaticamente como P000011 e P000010.  Esses identificadores podem ser usados ‚Äã‚Äãcomo logins para inserir o inquilino (e no aplicativo, quando todas as configura√ß√µes necess√°rias forem feitas). <br><br><img src="https://habrastorage.org/webt/kr/5n/ns/kr5nnsayi-h_uzenvlbkvzvttds.png"><br><br>  Vamos para o usu√°rio P000011 ou "Area Manager" e adicionar um nome que tamb√©m pode ser usado como um login para entrar.  Para fazer isso, clique no √≠cone de edi√ß√£o no campo "Informa√ß√µes pessoais" e preencha o "Nome de login" (no nosso caso, √© Johan). <br><br><img src="https://habrastorage.org/webt/cr/qa/vg/crqavg4m8ids9ec4eqifslnuwu0.png"><br><br>  Depois clique em "Salvar". <br><br>  Agora, vamos fazer o mesmo com o usu√°rio P000010 ou Supervisor de f√°brica, mas chame-o de Smith. <br><br><img src="https://habrastorage.org/webt/8-/yr/-k/8-yr-klcft-lnsvvfxtg_gyphfc.png"><br><br>  O usu√°rio do supervisor da planta deve poder exibir informa√ß√µes apenas sobre sua planta; em seguida, na se√ß√£o com informa√ß√µes da empresa, √© necess√°rio indicar o identificador da empresa (como esse identificador ser√° usado ser√° explicado na Etapa 4). <br><br>  Para fazer isso, v√° para a se√ß√£o "Informa√ß√µes da empresa" e insira o identificador da planta, ou seja, "101", no campo "Empresa". <br><br>  Agora, as informa√ß√µes sobre nossos usu√°rios foram alteradas.  Para ativ√°-los, v√° para as caixas de correio especificadas no arquivo ‚Äúcsv‚Äù e clique no link de ativa√ß√£o ou clique em ‚ÄúClique aqui para ativar sua conta‚Äù. <br><br><img src="https://habrastorage.org/webt/us/nr/jr/usnrjrph5ur5oawb8yamdoir3zg.png"><br><br>  Portanto, importamos com sucesso os usu√°rios para o inquilino da SCI, atualizamos as informa√ß√µes sobre eles e os ativamos. <br><br>  <b><i>Etapa 3: Atribuindo fun√ß√µes aos usu√°rios no n√≠vel do aplicativo no SAP Cloud Platform</i></b> <b><i><br></i></b> <br>  O aplicativo de monitoramento de polui√ß√£o de v√°rios inquilinos, criado por Robert da ITeLO Consulting, fornece duas fun√ß√µes predefinidas, PlantSupervisor e AreaManager, que controlam a autoriza√ß√£o do usu√°rio no aplicativo e determinam o que o usu√°rio final v√™. <br><br><ul><li>  Fun√ß√£o Supervisor da planta: Os usu√°rios a quem esta fun√ß√£o foi atribu√≠da poder√£o visualizar apenas os dados da planta identificada nas informa√ß√µes da empresa no inquilino da SCI. </li><li>  Fun√ß√£o "AreaManager": os usu√°rios a quem esta fun√ß√£o √© atribu√≠da poder√£o visualizar dados de todas as plantas em sua √°rea. </li></ul><br>  Vamos ver como a separa√ß√£o de fun√ß√µes √© alcan√ßada no n√≠vel do c√≥digo do projeto. <br><br>  Vamos para o arquivo web.xml localizado ao longo do caminho / monitora√ß√£o da polui√ß√£o <br>  /src/main/webapp/WEB-INF/web.xml ‚Äùna pasta do projeto. <br><br>  Abra o arquivo e verifique se as duas fun√ß√µes acima est√£o definidas no aplicativo. <br><br><img src="https://habrastorage.org/webt/vm/jy/4r/vmjy4ruivum6qlp-a2kw-6nsar4.png"><br><br>  Agora vamos ao arquivo ‚ÄúPollutionDataService.java‚Äù localizado no caminho ‚Äú/pollutionmonitoring/src/main/java/com/sap/hana/cloud/samples/pollutionmonitoring/api/PollutionDataService.java‚Äù do projeto e abra-o. <br><br>  O m√©todo "getCompanyPollutionData ()" √© indicado neste arquivo.  Permite verificar se o usu√°rio √© um administrador (gerente).  Se sim, o aplicativo exibe dados para todas as plantas; caso contr√°rio, os dados s√£o filtrados pelo ID da planta (id_idea).  Al√©m disso, o aplicativo exibir√° informa√ß√µes apenas para as plantas cujos identificadores correspondem aos indicados nas informa√ß√µes do usu√°rio. <br><br><img src="https://habrastorage.org/webt/wb/nr/-1/wbnr-1xbi_tiqah2efsv4444tn4.png"><br><br>  Para maior clareza, voc√™ pode consultar o m√©todo isUserAdmin (), que permite determinar por fun√ß√£o se um usu√°rio √© administrador (gerente) ou n√£o. <br><br><img src="https://habrastorage.org/webt/hg/az/25/hgaz25dqc9shpbzdjr8szqb81dc.png"><br><br>  Um algoritmo semelhante √© usado para extrair dados da planta de sistemas locais. <br><br><img src="https://habrastorage.org/webt/im/ds/qa/imdsqalrzqvuubw7e9lx1ppwgo0.png"><br><br>  Agora, Emily, como funcion√°ria da ABC PetroCorp, precisa identificar os gerentes de √°rea e de f√°brica, atribuindo a eles as fun√ß√µes apropriadas (ABCPlantSupervisor e ABCAreaManager) no aplicativo no SCP. <br><br>  Iremos para a subconta do cliente ABC PetroCorp e selecionaremos o aplicativo Java de monitoramento de polui√ß√£o fornecido pelo provedor ITeLO Consulting (ele est√° localizado na guia Aplicativos -&gt; guia Assinaturas). <br><br><img src="https://habrastorage.org/webt/py/ql/b_/pyqlb_s5jxwjw3amjgu3z2lzcus.png"><br><br>  Em seguida, v√° para a guia "Fun√ß√µes" (no n√≠vel do aplicativo). <br><br>  Na janela que √© aberta, uma lista de fun√ß√µes indicadas no aplicativo √© exibida.  Selecione a fun√ß√£o "PlantSupervisor" e clique em "Atribuir".  Na janela exibida, insira o ID do usu√°rio, indicado no locat√°rio da SCI como "ABCPlantSupervisor".  No nosso caso, o identificador desse usu√°rio ser√° P000010. <br><br>  Em seguida, selecione a fun√ß√£o "AreaManager" e clique em "Atribuir".  Na janela exibida, insira o identificador do usu√°rio indicado no inquilino da SCI como "ABCAreaManager" (no nosso caso, o identificador desse usu√°rio ser√° P000011). <br><br><img src="https://habrastorage.org/webt/pw/k2/qr/pwk2qre0nnl8iyytqg8szu9wwhc.png"><br><br>  Portanto, comparamos com √™xito os pap√©is do aplicativo com os usu√°rios correspondentes do ABC PetroCorp do locat√°rio da SCI. <br><br>  As mesmas configura√ß√µes podem ser aplicadas na subconta de outro cliente (por exemplo, ‚ÄúXYZ EnergyCorp‚Äù). <br><br>  <i><b>Etapa 4: configurando atributos no inquilino SCI e no painel de controle SCP para transferir para o aplicativo</b></i> <i><b><br></b></i> <br>  Robert da ITeLO Consulting programou o aplicativo multilocat√°rio de forma que ele precisa passar o identificador de usu√°rio do PlantSupervisor para a planta, para que os dados da planta possam ser filtrados na aplica√ß√£o para esse identificador de planta espec√≠fico. <br>  Nas etapas anteriores, adicionamos o identificador da planta ao usu√°rio "PlantSupervisor" no inquilino SCI no campo "Informa√ß√µes da empresa", que agora precisamos transferir para o aplicativo multilocat√°rio.  Em seguida, ele pode ser usado em um aplicativo para exibir dados relacionados a uma instala√ß√£o espec√≠fica.  O usu√°rio do AreaManager √© essencialmente um administrador que pode visualizar dados de todas as plantas. <br><br>  Vamos ver como isso √© organizado no n√≠vel do c√≥digo do aplicativo. <br><br>  Abra o arquivo ‚ÄúPollutionDataService.java‚Äù localizado no caminho ‚Äú/pollutionmonitoring/src/main/java/com/sap/hana/cloud/samples/pollutionmonitoring/api/PollutionDataService.java‚Äù no projeto. <br><br>  Este arquivo descreve o m√©todo getPlantId ().  Este m√©todo descreve a obten√ß√£o do nome de usu√°rio e a verifica√ß√£o do atributo "PLANT_ID", usado para filtrar os dados de polui√ß√£o e os dados da planta. <br><br><img src="https://habrastorage.org/webt/oo/5k/8f/oo5k8fcedmqrdjgd1qc3b1jink8.png"><br><br>  Podemos transferir atributos do usu√°rio do locat√°rio da SCI para o aplicativo por meio dos Atributos de Asser√ß√£o SAML.  Isso √© necess√°rio para que o atributo de usu√°rio do inquilino SCI que cont√©m informa√ß√µes da empresa seja lido pelo SCP no momento em que o usu√°rio efetua login.  O chamado "Atributo de asser√ß√£o" (atributo de aprova√ß√£o) definido para o usu√°rio precisa ser transferido para o aplicativo de monitoramento de polui√ß√£o. <br><br>  Para fazer isso, primeiro crie um "Atributo de asser√ß√£o" no locat√°rio da SCI e, em seguida - designe o atributo de aprova√ß√£o no atributo principal ("Atributo principal") na subconta "ABC PetroCorp", que pode ser lida pelo c√≥digo do aplicativo, como mostrado acima. <br><br>  V√° para o console de administra√ß√£o do servi√ßo de autentica√ß√£o de identidade e selecione a guia "Aplicativos e recursos" -&gt; "Aplicativos".  Selecione o aplicativo que precisamos (ABC_PetroCorp_IDP) e, na guia "Confian√ßa", clique em "Atributos de asser√ß√£o". <br><br><img src="https://habrastorage.org/webt/aj/vx/a1/ajvxa1wkg_edv7_a4s8peeug_ge.png"><br><br>  Uma lista de atributos existentes aparecer√°, precisamos de mais uma.  Para fazer isso, clique no bot√£o "Adicionar" e selecione o atributo "Empresa". <br><br>  Em seguida, adicionamos "plant_id" (diferencia mai√∫sculas de min√∫sculas) ao valor do atributo e clicamos em "Salvar". <br><br><img src="https://habrastorage.org/webt/gq/_0/g7/gq_0g7ulur1s6brsmvessvvt-2e.png"><br><br>  Agora v√° para a subconta ‚ÄúABC PetroCorp‚Äù no SCP e v√° para a aba ‚ÄúSeguran√ßa‚Äù -&gt; ‚ÄúConfian√ßa‚Äù.  Na janela "Trust Management", v√° para a guia "Application Identity Provider" e selecione o IdP associado √† subconta. <br><br><img src="https://habrastorage.org/webt/wd/bo/x8/wdbox8lmoxamqgwybxzrsugpmru.png"><br><br>  Na janela que se abre, v√° para a guia "Atributos" e clique em "Adicionar atributo baseado em asser√ß√£o".  No campo "Atributo de asser√ß√£o", inserimos o valor "plant_id" (como no inquilino da SCI) e no campo "Atributo principal", inserimos "PLANT_ID" (esse valor ser√° transferido para o aplicativo como o c√≥digo da instala√ß√£o) - e clique em "Salvar". <br><br>  Portanto, configuramos com sucesso os atributos no inquilino SCI e no painel de controle do SCP para transferi-los para o aplicativo. <br><br>  <b><i>Etapa 5: verificar as configura√ß√µes</i></b> <b><i><br></i></b>  Agora, Emily pode verificar se as configura√ß√µes de inquilino SCI (IdP) est√£o definidas corretamente para a subconta "ABC PetroCorp" no SCP e para o aplicativo que o provedor fornece. <br><br>  Para fazer isso, v√° para a subconta "ABC PetroCorp" e v√° para o aplicativo HTML5 "polui√ß√£omonitoringui" (est√° localizado na guia "Aplicativos" -&gt; "Assinaturas"). <br><br><img src="https://habrastorage.org/webt/ys/6l/bb/ys6lbbnjrqqh1tnwwsfufr_tmpe.png"><br><br>  Copie o link para o aplicativo.  Abra uma nova guia no navegador no modo de navega√ß√£o an√¥nima e insira um link para o aplicativo HTML5.  Uma janela aparecer√° para entrar no aplicativo, onde o nome indicado no inquilino da SCI ser√° exibido. <br><br>  Se tudo estiver configurado corretamente, voc√™ poder√° inserir o aplicativo nos usu√°rios de ‚ÄúAreaManager‚Äù e ‚ÄúPlantSupervisor‚Äù, indicados no inquilino da SCI. <br><br>  No nosso caso, o gerente da regi√£o √© o usu√°rio Johan (P000011) e o chefe da f√°brica √© Smith (P000010).  Voc√™ pode inserir o aplicativo nesses usu√°rios usando o nome de usu√°rio ou seu identificador como um logon. <br><br>  <i>Nota: ao entrar no aplicativo nesta fase, nenhum dado ser√° exibido.</i>  <i>Isso √© normal porque a configura√ß√£o ainda n√£o est√° conclu√≠da e o sistema local n√£o est√° conectado.</i> <i><br></i> <br><br>  Portanto, configuramos uma conex√£o de provedor de identidade (IDP) com nosso aplicativo de monitoramento de polui√ß√£o SCP.  Tamb√©m importamos usu√°rios e atribu√≠mos a eles as fun√ß√µes corretas para acessar o aplicativo, garantindo que as informa√ß√µes corretas da instala√ß√£o fossem transferidas para o aplicativo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418237/">https://habr.com/ru/post/pt418237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418225/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 7: Sandbox do Cliente Nativo Parte 2</a></li>
<li><a href="../pt418227/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 7: A Sandbox do Cliente Nativo, Parte 3</a></li>
<li><a href="../pt418229/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Aula 8: Modelo de Seguran√ßa de Rede, Parte 1</a></li>
<li><a href="../pt418233/index.html">Mnem√¥nicos da BMW para encontrar valores-limite</a></li>
<li><a href="../pt418235/index.html">Saga orquestrada ou como criar transa√ß√µes comerciais em servi√ßos com o banco de dados por padr√£o de servi√ßo</a></li>
<li><a href="../pt418239/index.html">48 megapixels para smartphone</a></li>
<li><a href="../pt418241/index.html">Por que Gauss? (100 maneiras de resolver o sistema de equa√ß√µes)</a></li>
<li><a href="../pt418243/index.html">A hist√≥ria popular da astronomia est√° errada</a></li>
<li><a href="../pt418245/index.html">Como n√£o desenvolver um projeto no Bitrix</a></li>
<li><a href="../pt418247/index.html">Acelere a multiplica√ß√£o da matriz 4x4 flutuante com SIMD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>