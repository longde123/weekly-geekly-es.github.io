<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥪 👶🏽 🦑 深度强化学习：如何教蜘蛛走路 🔒 🙍🏿 🛳️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今天，我将告诉您如何应用强化深度学习算法来控制机器人。 简而言之，我将告诉您如何创建“带有神经网络的黑匣子”，该黑匣子在输入端接受机器人体系结构，并输出可以在输出端对其进行控制的算法。 


 解决方案的核心是具有优势得分（通过通用优势估算 （GAE））的优势演员评论 （A2C）算法。 


 精简...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>深度强化学习：如何教蜘蛛走路</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483078/"><iframe width="560" height="315" src="https://www.youtube.com/embed/rxWmEnWR3jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> 今天，我将告诉您如何应用强化深度学习算法来控制机器人。 简而言之，我将告诉您如何创建“带有神经网络的黑匣子”，该黑匣子在输入端接受机器人体系结构，并输出可以在输出端对其进行控制的算法。 </p><br><p> 解决方案的核心是具有<b>优势</b>得分（通过<b>通用优势估算</b> （GAE））的<b>优势演员评论</b> （A2C）算法。 </p><br><p> 精简版包括数学，TensorFlow实现以及关于哪种步行算法的大量演示。 </p><br><a name="habracut"></a><p> 内容： </p><br>  - <a href="https://habr.com/ru/post/483078/">挑战</a> <br>  - <a href="https://habr.com/ru/post/483078/">为什么要进行强化学习？</a> <br>  - <a href="https://habr.com/ru/post/483078/">强化学习声明</a> <br>  - <a href="https://habr.com/ru/post/483078/">政策梯度</a> <br>  - <a href="https://habr.com/ru/post/483078/">对角高斯政策</a> <br>  - <a href="https://habr.com/ru/post/483078/">通过增加批评减少差异</a> <br>  - <a href="https://habr.com/ru/post/483078/">陷阱</a> <br><p>  - <a href="https://habr.com/ru/post/483078/">结论</a> </p><br><a name="problem"></a><h2> 挑战赛 </h2><br><p> 在本文中，我们将教机器人在MuJoCo模拟中行走。 我们将跳过创建机器人模型和环境的Python接口的步骤说明，因为 那里没有什么有趣的。 要了解，只需看一下MuJoCo本身的演示以及<a href="https://gym.openai.com/envs/">Gym OpenAI</a>中MuJoCo环境的来源。 </p><br><p> 在输入处，代理程序将具有来自MuJoCo的许多数字：相对位置，旋转角度，速度，机器人身体各部分的加速度等。 总共约有800个功能。 我们使用深度学习方法，不会理解它们的实际含义。 最主要的是，在这组数字中，将有足够的信息，以便业务代表可以了解他的情况。 </p><br><p> 在输出中，我们将期望18个数字-机器人的自由度数，这意味着固定肢体的铰链的旋转角度。 </p><br><p> 最后，特工的目标是使剧集的总<b>回报</b>最大化。 如果机器人崩溃或经过3000步（15秒），我们将结束该情节。 每一步骤将根据以下公式奖励代理商： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">d</span><span class="MJXp-mrow" id="MJXp-Span-13"><span class="MJXp-mtext" id="MJXp-Span-14">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">E</span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">p</span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mtext" id="MJXp-Span-25">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">b</span><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">E</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-34">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">d</span><span class="MJXp-mrow" id="MJXp-Span-45"><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">R</span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">p</span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">b</span><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">R</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">x</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;">∗</span><span class="MJXp-mn" id="MJXp-Span-78">1000</span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-80">0.5</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="95.81ex" height="2.419ex" viewBox="0 -780.1 41251.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-65" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-77" x="1317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-63" x="2033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6F" x="2467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="2952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="3831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="4709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6E" x="5239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-64" x="5839" y="0"></use><g transform="translate(6363,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-45" x="250" y="0"></use></g><g transform="translate(7377,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-45" x="3455" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6E" x="15432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-65" x="16032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-77" x="16499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-63" x="17215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6F" x="17649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="18134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="19013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="19891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6E" x="20421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-64" x="21021" y="0"></use><g transform="translate(21545,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-52" x="250" y="0"></use></g><g transform="translate(22554,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-52" x="3455" y="0"></use></g></g><g transform="translate(30354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-3D" x="31438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-44" x="32745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-65" x="33573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-6C" x="34040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-74" x="34338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-61" x="34700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-78" x="35229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-2217" x="36024" y="0"></use><g transform="translate(36747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-30" x="1501" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-2B" x="38971" y="0"></use><g transform="translate(39972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMAIN-35" x="779" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ newcommand {\ E} {\ mathop {\ mathbb {E}}} \ newcommand {\ R} {\ mathop {\ mathbb {R}}} r_t = \ Delta x * 1000 + 0.5 </script></p><p> 即 代理商的目标将增加其坐标 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,1500004,15700021,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhwJfsJhWL4ImGRyU3tHnsCpXKLVQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x </script> 并且直到情节结束才堕落。 </p><br><p> 因此，任务设置为： <b>查找功能</b> <math> </math><b><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">i</span><span class="MJXp-mrow" id="MJXp-Span-87"><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-92" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-93">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-94" style="color: red;">\到</span><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-98" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-99">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-3"> \ pi：\ R ^ {800} \到\ R ^ {18} </script></b>   <b>为此情节的回报将是最大的</b> 。 听起来不太对吗？  :)让我们看看<b>深度强化学习</b>如何<b>处理</b>此任务。 </p><br><a name="why-rl"></a><h2> 为什么要进行强化学习？ </h2><br><p> 解决步行机器人运动问题的现代方法包括经典机器人技术，包括<b>最佳控制</b>和<b>轨迹优化两部分</b> ：LQR，QP，凸优化。 阅读更多： <a href="https://dspace.mit.edu/handle/1721.1/110533">波士顿动力团队在Atlas上的帖子</a> 。 </p><br><p> 这些技术是一种“硬编码”，因为它们需要将任务的许多细节直接引入控制算法中。 它们中没有学习系统-优化是“当场”进行的。 </p><br><p> 另一方面，强化学习（以下简称RL）在算法中不需要假设，从而使该问题的解决方案更加通用和可扩展。 </p><br><a name="rl-formulation"></a><h2> 强化学习声明 </h2><br><img src="https://habrastorage.org/webt/i8/gl/yf/i8glyfujascwmexl2qu6sypmpt0.png"><br><p>  <a href="https://simple.wikipedia.org/wiki/Reinforcement_learning"><i>来源</i></a> </p><br><p> 在RL问题中，我们将主体与环境的相互作用视为一对对<b>（状态，奖励）</b>以及它们之间的过渡- <b>行动</b>的序列。 </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-100"><span class="MJXp-mrow" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">w</span><span class="MJXp-mrow" id="MJXp-Span-120"><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-mrow" id="MJXp-Span-124"><span class="MJXp-mo" id="MJXp-Span-125" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-129"><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-133" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-134"><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">w</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-msubsup" id="MJXp-Span-149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-151" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-152">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-155" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-156">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">w</span><span class="MJXp-mrow" id="MJXp-Span-168"><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">n</span><span class="MJXp-mo" id="MJXp-Span-173">−</span><span class="MJXp-mn" id="MJXp-Span-174">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-175"><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-179" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-184" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-185"><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-4">（s_0）\ xrightarrow {a_0}（s_1，r_1）\ xrightarrow {a_ {1}} ... \ xrightarrow {a_ {n-1}}（s_n，r_n）</script></p><p> 定义术语： </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-187"><span class="MJXp-mtext" id="MJXp-Span-188">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">i</span><span class="MJXp-mrow" id="MJXp-Span-191"><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-195" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-196"><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-201"><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> \ pi（a_t | s_t）</script>  - <b>政策</b> ，代理人行为策略，条件概率， </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-203"><span class="MJXp-msubsup" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-206" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">m</span><span class="MJXp-mtext" id="MJXp-Span-211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">i</span><span class="MJXp-mrow" id="MJXp-Span-214"><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">t</span><span class="MJXp-mrow" id="MJXp-Span-221"><span class="MJXp-mo" id="MJXp-Span-222" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-225" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mo" id="MJXp-Span-227" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> a_t \ sim \ pi（\ cdot | s_t）</script>  -从分布中将<b>动作</b>视为随机变量 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mtext" id="MJXp-Span-229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ pi </script>  ， <br>  <i>我们可以将政策视为一项职能</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">i</span><span class="MJXp-mrow" id="MJXp-Span-236"><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.278em; margin-right: 0.278em;">状</span></span><span class="MJXp-mrow" id="MJXp-Span-240"><span class="MJXp-mo" id="MJXp-Span-241" style="margin-left: 0.278em; margin-right: 0.278em;">态</span></span><span class="MJXp-mtext" id="MJXp-Span-242" style="color: red;">\到</span><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.278em; margin-right: 0.278em;">动</span></span><span class="MJXp-mrow" id="MJXp-Span-245"><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.278em; margin-right: 0.278em;">作</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ pi：状态\到动作</script></i>   <i>，但我们希望使代理行为随机化，以利于<b>探索</b> 。</i>  <i>即</i>  <i>很有可能我们没有完全执行代理选择的动作。</i> </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ tau </script>  -代理跟踪的轨迹，序列 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-252"><span class="MJXp-mrow" id="MJXp-Span-253"><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-255"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-257" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mrow" id="MJXp-Span-258"><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-262" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mrow" id="MJXp-Span-263"><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mrow" id="MJXp-Span-268"><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-273"><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10">（s_1，s_2，...，s_n）</script>  。 </li></ul><br><p> 代理的任务是使<b>预期收益</b>最大化： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">J</span><span class="MJXp-mrow" id="MJXp-Span-277"><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">i</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-285">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-286"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-288" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">u</span><span class="MJXp-mtext" id="MJXp-Span-293">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">m</span><span class="MJXp-mtext" id="MJXp-Span-297">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">R</span><span class="MJXp-mrow" id="MJXp-Span-302"><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-304">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">u</span><span class="MJXp-mrow" id="MJXp-Span-308"><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-312">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-315" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">u</span><span class="MJXp-mtext" id="MJXp-Span-320">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">m</span><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-327" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-329">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">u</span><span class="MJXp-msubsup" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">t</span><span class="MJXp-mo" id="MJXp-Span-336">=</span><span class="MJXp-mn" id="MJXp-Span-337">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-342" style="color: red;">\右</span><span class="MJXp-mo" id="MJXp-Span-343" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> J（\ pi）= \ E _ {\ tau \ sim \ pi} [R（\ tau）] = \ E _ {\ tau \ sim \ pi} \左[\ sum_ {t = 0} ^ n r_t \右] </script></p><p> 现在我们可以制定RL问题，找到： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-344"><span class="MJXp-mtext" id="MJXp-Span-345">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">p</span><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-349" style="vertical-align: 0.5em;">∗</span></span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">g</span><span class="MJXp-mtext" id="MJXp-Span-354">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">p</span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mrow" id="MJXp-Span-362" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">x</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-366" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">J</span><span class="MJXp-mrow" id="MJXp-Span-370"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">i</span><span class="MJXp-mrow" id="MJXp-Span-375"><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \ pi ^ * = arg \ mathop {max} _ \ pi J（\ pi）</script></p><p> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-377"><span class="MJXp-mtext" id="MJXp-Span-378">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">p</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-382" style="vertical-align: 0.5em;">∗</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ pi ^ * </script> 是最优政策。 </p><br><p> 在OpenAI的材料中阅读更多内容： <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">OpenAI Spinning Up</a> 。 </p><br><a name="policy-gradient"></a><h2> 政策梯度 </h2><br><p> 值得注意的是，将RL问题作为优化问题的严格说明使我们有机会使用已知的优化方法，例如<b>梯度下降</b> 。 试想一下，如果我们可以<b>通过模型参数获取预期的收益梯度，</b>那将是多么酷： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-383"><span class="MJXp-mtext" id="MJXp-Span-384">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">l</span><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">J</span><span class="MJXp-mrow" id="MJXp-Span-398"><span class="MJXp-mo" id="MJXp-Span-399" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">p</span><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-404" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">a</span><span class="MJXp-mrow" id="MJXp-Span-410"><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ nabla_ \ theta J（\ pi_ \ theta）</script>  。 在这种情况下，更新比例的规则很简单： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-412"><span class="MJXp-mtext" id="MJXp-Span-413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">a</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">t</span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-432">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">a</span><span class="MJXp-mtext" id="MJXp-Span-438">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">l</span><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-446">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">J</span><span class="MJXp-mrow" id="MJXp-Span-452"><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-454">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">p</span><span class="MJXp-msubsup" id="MJXp-Span-456"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-458" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">a</span><span class="MJXp-mrow" id="MJXp-Span-464"><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \ theta = \ theta_ {old} + \ alpha \ nabla_ \ theta J（\ pi_ \ theta）</script></p><p> 这正是所有<b>策略梯度</b>方法的想法。 这个梯度的严格结论有些严格。 我们不会在这里写它，但是会保留<a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">来自OpenAI</a>的<a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">精彩材料</a>的链接。 渐变如下所示： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-466"><span class="MJXp-mtext" id="MJXp-Span-467">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">l</span><span class="MJXp-msubsup" id="MJXp-Span-472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-474" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">J</span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-483">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">p</span><span class="MJXp-msubsup" id="MJXp-Span-485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-487" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">a</span><span class="MJXp-mrow" id="MJXp-Span-493"><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-495" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-496">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-499" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-500">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">u</span><span class="MJXp-mtext" id="MJXp-Span-504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">m</span><span class="MJXp-mtext" id="MJXp-Span-508">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">p</span><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-518" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-520">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">u</span><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">t</span><span class="MJXp-mo" id="MJXp-Span-527">=</span><span class="MJXp-mn" id="MJXp-Span-528">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-530">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">l</span><span class="MJXp-msubsup" id="MJXp-Span-535"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-537" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">a</span><span class="MJXp-mtext" id="MJXp-Span-543">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">g</span><span class="MJXp-mtext" id="MJXp-Span-547">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">p</span><span class="MJXp-msubsup" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-551" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">a</span><span class="MJXp-mrow" id="MJXp-Span-557"><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-561" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-562"><span class="MJXp-mo" id="MJXp-Span-563" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-566" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-567"><span class="MJXp-mo" id="MJXp-Span-568" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">R</span><span class="MJXp-mrow" id="MJXp-Span-570"><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-572">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">u</span><span class="MJXp-mrow" id="MJXp-Span-576"><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-578">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-582">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">t</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ nabla_ \ theta J（\ pi_ \ theta）= \ E _ {\ tau \ sim \ pi_ \ theta} \左[\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）R（\ tau）\ right] </script></p><p> 因此，我们模型的<b>损失</b>将是这样的： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">s</span><span class="MJXp-mo" id="MJXp-Span-590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-592">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">g</span><span class="MJXp-mrow" id="MJXp-Span-596"><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-598">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">p</span><span class="MJXp-msubsup" id="MJXp-Span-600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-602" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">a</span><span class="MJXp-mrow" id="MJXp-Span-608"><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-610"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-612" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-613"><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-615"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-617" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">R</span><span class="MJXp-mrow" id="MJXp-Span-623"><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-625">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">u</span><span class="MJXp-mrow" id="MJXp-Span-629"><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> loss =-\ log（\ pi_ \ theta（a_t | s_t））R（\ tau）</script></p><p> 回想一下 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">R</span><span class="MJXp-mrow" id="MJXp-Span-633"><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-635">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">u</span><span class="MJXp-mrow" id="MJXp-Span-639"><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-641" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-642">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">u</span><span class="MJXp-msubsup" id="MJXp-Span-645"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">t</span><span class="MJXp-mo" id="MJXp-Span-649">=</span><span class="MJXp-mn" id="MJXp-Span-650">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-654" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> R（\ tau）= \ sum_ {t = 0} ^ T r_t </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-655"><span class="MJXp-mtext" id="MJXp-Span-656">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">p</span><span class="MJXp-msubsup" id="MJXp-Span-658"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-660" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">a</span><span class="MJXp-mrow" id="MJXp-Span-666"><span class="MJXp-mo" id="MJXp-Span-667" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-670" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-671"><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-675" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-676"><span class="MJXp-mo" id="MJXp-Span-677" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ pi_ \ theta（a_t | s_t）</script>  -这是当她进入时我们模型的输出 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-678"><span class="MJXp-msubsup" id="MJXp-Span-679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-681" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> s_t </script>  。 出现负号是因为我们要最大化 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">J</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> J </script>  。 在训练过程中，我们将分批考虑梯度并添加梯度以减少<b>差异</b> （随机环境造成的数据噪声）。 </p><br><p> 这是一种称为<b>REINFORCE</b>的有效算法。 而且他知道如何为一些简单的环境找到解决方案。 例如， <a href="https://gym.openai.com/envs/CartPole-v1/">“ CartPole-v1”</a> 。 </p><br><p> 考虑代理代码： </p><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkDiscrete</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">20</span></span>, activation=tf.nn.relu) output_linear = tf.layers.dense(l1, units=action_space) output = tf.nn.softmax(output_linear) self.action_op = tf.squeeze(tf.multinomial(logits=output_linear,num_samples=<span class="hljs-number"><span class="hljs-number">1</span></span>), axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training output_log = tf.nn.log_softmax(output_linear) self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None], dtype=tf.int32) action_one_hot = tf.one_hot(self.action_ph, action_space) responsible_output_log = tf.reduce_sum(output_log * action_one_hot, axis=1) self.loss = -tf.reduce_mean(responsible_output_log * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss) actor = ActorNetworkDiscrete()</span></span></code> </pre> <br><p> 我们对此结构有一个小的感知器：（observation_space，10，action_space）[对于CartPole，这是（4，10，2）]。  <b>tf.multinomial</b>允许<b>您</b>选择随机加权的操作。 要采取行动，您需要致电： </p><br><pre> <code class="python hljs">action = sess.run(actor.action_op, feed_dict={actor.state_ph: observation})</code> </pre><br><p> 因此，我们将训练他： </p><br><pre> <code class="python hljs">batch_generator = generate_batch(environments, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, total reward] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]})</span></span></code> </pre><br><p> 批处理生成器在环境中运行代理并积累数据以进行培训。 批处理的元素是这种元组： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-684"><span class="MJXp-mrow" id="MJXp-Span-685"><span class="MJXp-mo" id="MJXp-Span-686" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-689" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-690"><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-694" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-695"><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">R</span><span class="MJXp-mrow" id="MJXp-Span-698"><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">u</span><span class="MJXp-mrow" id="MJXp-Span-704"><span class="MJXp-mo" id="MJXp-Span-705" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-706"><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22">（s_t，a_t，R（\ tau））</script>  。 </p><br><p> 编写好的生成器是一项单独的任务，其中主要的困难是与单个模拟步骤（甚至是MuJoCo）相比，调用<b>sess.run（）的</b>成本相对较高。 为了加快工作速度，您可以利用神经网络批量运行并使用许多并行环境这一事实。  <b>与在单个环境中相比，即使顺序地在一个线程中启动它们也将带来明显的加速。</b> </p><br><div class="spoiler">  <b class="spoiler_title">使用来自OpenAI基准的DummyVecEnv的生成器代码</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Vectorized environments with gym-like interface from baselines.common.vec_env.subproc_vec_env import SubprocVecEnv from baselines.common.vec_env.dummy_vec_env import DummyVecEnv def make_env(env_id, seed): def _f(): env = gym.make(env_name) env.reset() # Desync environments for i in range(int(200 * seed // environments_count)): env.step(env.action_space.sample()) return env return _f envs = [make_env(env_name, seed) for seed in range(environments_count)] # Can be switched to SubprocVecEnv to parallelize on cores # (for computationally heavy envs) envs = DummyVecEnv(envs) # Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py def discount_cumsum(x, coef): """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def generate_batch(envs, batch_size, replay_buffer_size): envs_number = envs.num_envs observations = [[0 for i in range(observation_space)] for i in range(envs_number)] # [state, action, discounted reward-to-go] replay_buffer = np.empty((0,3), np.float32) # [state, action, reward] rollout lists for every environment instance rollouts = [np.empty((0, 3)) for i in range(envs_number)] while True: history = {'reward': [], 'max_action': []} replay_buffer = replay_buffer[batch_size:] # Main sampling cycle while len(replay_buffer) &lt; replay_buffer_size: # Here policy acts in environments. Note that it chooses actions for all # environments in one batch, therefore expensive sess.run is called once. actions = sess.run(actor.action_op, feed_dict={actor.state_ph: observations}) observations_old = observations observations, rewards, dones, _ = envs.step(actions) history['max_action'].append(np.abs(actions).max()) time_point = np.array(list(zip(observations_old, actions, rewards))) for i in range(envs_number): # Regular python-like append rollouts[i] = np.append(rollouts[i], [time_point[i]], axis=0) # Process done==True environments if dones.all(): print('WARNING: envs are in sync!! This makes sampling inefficient!') done_indexes = np.arange(envs_number)[dones] for i in done_indexes: rewards_trajectory = rollouts[i][:, 2].copy() history['reward'].append(rewards_trajectory.sum()) rollouts[i][:, 2] = discount_cumsum(rewards_trajectory, coef=discount_factor) replay_buffer = np.append(replay_buffer, rollouts[i], axis=0) rollouts[i] = np.empty((0, 3)) # Shuffle before yield to become closer to iid np.random.shuffle(replay_buffer) # Truncate replay_buffer to get the most relevant feedback from environment replay_buffer = replay_buffer[:replay_buffer_size] yield replay_buffer[:batch_size], history # Make a test yield a = generate_batch(envs, 8, 64) # Makes them of equal lenght for i in range(10): next(a) next(a)[0]</span></span></code> </pre></div></div><br><p> 生成的代理可以在<b>动作空间有限的</b>环境中播放。 此格式不适合我们的任务。 控制机器人的代理必须从 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-708"><span class="MJXp-mtext" id="MJXp-Span-709">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-712" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ R ^ n </script> 在哪里 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> n </script>  -自由度数。  （ <a href="https://arxiv.org/abs/1910.07113">或者您可以将动作空间划分为多个空白，并获得具有离散输出的任务</a> ） </p><br><a name="diagonal-gaussian-policies"></a><h2> 对角高斯政策 </h2><br><p> 对<b>角高斯策略</b>方法的本质是使模型产生n维正态分布的参数，即 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-715"><span class="MJXp-mtext" id="MJXp-Span-716">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">m</span><span class="MJXp-msubsup" id="MJXp-Span-718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719" style="margin-right: 0.05em;">u</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-720" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ mu_ \ theta </script>  -垫子 等待和 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mtext" id="MJXp-Span-727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">m</span><span class="MJXp-msubsup" id="MJXp-Span-732"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-734" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ sigma_ \ theta </script>  -标准偏差。  <b>一旦代理需要采取行动，我们就会从模型中询问这些参数，并从该分布中获取一个随机变量。</b> 所以我们让代理退出 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-740"><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-744" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ R ^ n </script> 并使其随机。 最重要的是，在输出端固定了分配类之后，我们可以计算 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-745"><span class="MJXp-mtext" id="MJXp-Span-746" style="color: red;">\日</span><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mo" id="MJXp-Span-748" style="margin-left: 0.278em; margin-right: 0.278em;">志</span></span><span class="MJXp-mrow" id="MJXp-Span-749"><span class="MJXp-mo" id="MJXp-Span-750" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">p</span><span class="MJXp-msubsup" id="MJXp-Span-753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-755" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">a</span><span class="MJXp-mrow" id="MJXp-Span-761"><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-765" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-766"><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-768"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-770" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-771"><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-773"><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \日志（\ pi_ \ theta（a_t | s_t））</script> 因此政策梯度。 </p><br><p> 注意：可以固定 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-775"><span class="MJXp-mtext" id="MJXp-Span-776">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">m</span><span class="MJXp-msubsup" id="MJXp-Span-781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-783" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ sigma_ \ theta </script> 作为超参数，从而减小输出尺寸。 实践表明，这不会造成太大的伤害，但是相反，它可以稳定学习。 </p><br><p>  <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">阅读更多有关随机政策的信息</a> 。 </p><br><p> 代理代码： </p><br><pre> <code class="python hljs">epsilon = <span class="hljs-number"><span class="hljs-number">1e-8</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gaussian_loglikelihood</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, mu, log_std)</span></span></span><span class="hljs-function">:</span></span> pre_sum = <span class="hljs-number"><span class="hljs-number">-0.5</span></span> * (((x - mu) / (tf.exp(log_std) + epsilon))**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span> * log_std + np.log(<span class="hljs-number"><span class="hljs-number">2</span></span> * np.pi)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.reduce_sum(pre_sum, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkContinuous</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) mu = tf.layers.dense(l3, units=action_space) log_std = tf.get_variable(name=<span class="hljs-string"><span class="hljs-string">'log_std'</span></span>, initializer=<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * np.ones(action_space, std = tf.exp(log_std) self.action_op = mu + tf.random.normal(shape=tf.shape(mu)) * std <span class="hljs-comment"><span class="hljs-comment"># Training self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None, action_space], dtype=tf.float32) action_logprob = gaussian_loglikelihood(self.action_ph, mu, log_std) self.loss = -tf.reduce_mean(action_logprob * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p> 培训部分没有什么不同。 </p><br><p> 现在，我们终于可以看到REINFORCE将如何处理我们的任务。 此后，探员的目标是向右移动。 </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eH8cFxYHhQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> 缓慢但肯定地朝他的目标迈进。 </p><br><h3> 奖励去 </h3><br><p> 请注意，我们的渐变中还有其他成员。 即每一步 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> t </script> 在权衡对数梯度时，我们使用<b>整个轨迹</b>的总奖励。 因此，根据代理人过去的成就来评估其行为。 听起来不对，不是吗？ 所以这个 </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-791"><span class="MJXp-mtext" id="MJXp-Span-792">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">l</span><span class="MJXp-msubsup" id="MJXp-Span-797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-799" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">J</span><span class="MJXp-mrow" id="MJXp-Span-806"><span class="MJXp-mo" id="MJXp-Span-807" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-808">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">p</span><span class="MJXp-msubsup" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-812" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">a</span><span class="MJXp-mrow" id="MJXp-Span-818"><span class="MJXp-mo" id="MJXp-Span-819" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-821">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-824" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-825">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">u</span><span class="MJXp-mtext" id="MJXp-Span-829">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">m</span><span class="MJXp-mtext" id="MJXp-Span-833">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">p</span><span class="MJXp-msubsup" id="MJXp-Span-835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-837" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-843" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-845">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">u</span><span class="MJXp-msubsup" id="MJXp-Span-848"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-850"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">t</span><span class="MJXp-mo" id="MJXp-Span-852">=</span><span class="MJXp-mn" id="MJXp-Span-853">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-855">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">l</span><span class="MJXp-msubsup" id="MJXp-Span-860"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-862" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">a</span><span class="MJXp-mtext" id="MJXp-Span-868">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">g</span><span class="MJXp-mtext" id="MJXp-Span-872">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">p</span><span class="MJXp-msubsup" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-876" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">a</span><span class="MJXp-mrow" id="MJXp-Span-882"><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-886" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-887"><span class="MJXp-mo" id="MJXp-Span-888" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-891" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-892"><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-894">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">u</span><span class="MJXp-msubsup" id="MJXp-Span-897"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-899"><span class="MJXp-msup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-902" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-903">=</span><span class="MJXp-mn" id="MJXp-Span-904">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-908" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-911" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">t</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> \ nabla_ \ theta J（\ pi_ \ theta）= \ E _ {\ tau \ sim \ pi_ \ theta} \左[\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）\ sum_ {t'= 0} ^ T r_ {t'} \ right] </script></p><p> 会变成这个 </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-919"><span class="MJXp-mtext" id="MJXp-Span-920">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">l</span><span class="MJXp-msubsup" id="MJXp-Span-925"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-927" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">J</span><span class="MJXp-mrow" id="MJXp-Span-934"><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">p</span><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-940" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">a</span><span class="MJXp-mrow" id="MJXp-Span-946"><span class="MJXp-mo" id="MJXp-Span-947" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-949">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-952" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-953">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">u</span><span class="MJXp-mtext" id="MJXp-Span-957">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">m</span><span class="MJXp-mtext" id="MJXp-Span-961">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">p</span><span class="MJXp-msubsup" id="MJXp-Span-963"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-965" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">a</span></span></span><span class="MJXp-mtext" id="MJXp-Span-971" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-973">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">u</span><span class="MJXp-msubsup" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">t</span><span class="MJXp-mo" id="MJXp-Span-980">=</span><span class="MJXp-mn" id="MJXp-Span-981">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-983">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">l</span><span class="MJXp-msubsup" id="MJXp-Span-988"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-990" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">a</span><span class="MJXp-mtext" id="MJXp-Span-996">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">g</span><span class="MJXp-mtext" id="MJXp-Span-1000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">p</span><span class="MJXp-msubsup" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">a</span><span class="MJXp-mrow" id="MJXp-Span-1010"><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1014" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1015"><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1019" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1020"><span class="MJXp-mo" id="MJXp-Span-1021" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1022">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">u</span><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1027"><span class="MJXp-msup" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1030" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1031">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1039" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1040">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">t</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ nabla_ \ theta J（\ pi_ \ theta）= \ E _ {\ tau \ sim \ pi_ \ theta} \左[\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）\ sum_ {t'= t} ^ T r_ {t'} \ right] </script></p><p> 找到10个差异:) </p><br><p> 尽管这些成员的存在不会在数学上破坏任何东西，但它给我们带来了很大的噪音。 现在，在训练过程中，座席将仅注意<b>在特定操作后</b>获得的那些奖励。 </p><br><p> 由于这种改进，平均奖励有所增加。 其中一位特工学会了使用前肢来实现自己的目标： </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8sN-VaQsnVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="add-critic"></a><h2> 通过增加批评减少差异 </h2><br><p> 进一步改进的实质是减少由于介质状态之间的随机过渡而产生的噪声（方差）。 </p><br><p> 这将帮助我们添加一个<b>模型，</b>该<b>模型</b>将从状态开始<b>预测</b>代理商收到<b>的平均奖励金额</b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1047"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">s</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> s </script> 到轨迹的尽头，即 值函数。 </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1049"><span class="MJXp-msubsup" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1052" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">i</span><span class="MJXp-mrow" id="MJXp-Span-1055"><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">s</span><span class="MJXp-mrow" id="MJXp-Span-1058"><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1060" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1062"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1064" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">u</span><span class="MJXp-mtext" id="MJXp-Span-1069">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">m</span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1076" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">R</span><span class="MJXp-mrow" id="MJXp-Span-1079"><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1081">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">u</span><span class="MJXp-mrow" id="MJXp-Span-1085"><span class="MJXp-mo" id="MJXp-Span-1086" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-1087"><span class="MJXp-mo" id="MJXp-Span-1088" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1091" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">s</span><span class="MJXp-mtext" id="MJXp-Span-1094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">t</span><span class="MJXp-mo" id="MJXp-Span-1100" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1101" style="color: red;">\文</span><span class="MJXp-mrow" id="MJXp-Span-1102"><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0.278em; margin-right: 0.278em;">本</span></span><span class="MJXp-mrow" id="MJXp-Span-1104"><span class="MJXp-mo" id="MJXp-Span-1105" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1106"><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0.278em; margin-right: 0.278em;">值</span></span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-mo" id="MJXp-Span-1109" style="margin-left: 0.278em; margin-right: 0.278em;">函</span></span><span class="MJXp-mrow" id="MJXp-Span-1110"><span class="MJXp-mo" id="MJXp-Span-1111" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> V ^ \ pi（s）= \ E _ {\ tau \ sim \ pi} \左[R（\ tau）| s_0 = s \ right] \文本{-值函数} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1112"><span class="MJXp-msubsup" id="MJXp-Span-1113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1115" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">i</span><span class="MJXp-mrow" id="MJXp-Span-1118"><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">s</span><span class="MJXp-mrow" id="MJXp-Span-1121"><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">a</span><span class="MJXp-mrow" id="MJXp-Span-1124"><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1130" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-1131">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">u</span><span class="MJXp-mtext" id="MJXp-Span-1135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">m</span><span class="MJXp-mtext" id="MJXp-Span-1139">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1142" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">R</span><span class="MJXp-mrow" id="MJXp-Span-1145"><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1147">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">u</span><span class="MJXp-mrow" id="MJXp-Span-1151"><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-1153"><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1157" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">s</span><span class="MJXp-mrow" id="MJXp-Span-1160"><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-1162"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1164" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">a</span><span class="MJXp-mtext" id="MJXp-Span-1167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">t</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-1174" style="color: red;">\文</span><span class="MJXp-mrow" id="MJXp-Span-1175"><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0.278em; margin-right: 0.278em;">本</span></span><span class="MJXp-mrow" id="MJXp-Span-1177"><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1179"><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0.278em; margin-right: 0.278em;">动</span></span><span class="MJXp-mrow" id="MJXp-Span-1181"><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0.278em; margin-right: 0.278em;">作</span></span><span class="MJXp-mrow" id="MJXp-Span-1183"><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0.278em; margin-right: 0.278em;">值</span></span><span class="MJXp-mrow" id="MJXp-Span-1185"><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0.278em; margin-right: 0.278em;">函</span></span><span class="MJXp-mrow" id="MJXp-Span-1187"><span class="MJXp-mo" id="MJXp-Span-1188" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> Q ^ \ pi（s，a）= \ E _ {\ tau \ sim \ pi} \左[R（\ tau）| s_0 = s，a_0 = a \ right] \文本{-动作值函数} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1189"><span class="MJXp-msubsup" id="MJXp-Span-1190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1192" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">i</span><span class="MJXp-mrow" id="MJXp-Span-1195"><span class="MJXp-mo" id="MJXp-Span-1196" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">s</span><span class="MJXp-mrow" id="MJXp-Span-1198"><span class="MJXp-mo" id="MJXp-Span-1199" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">a</span><span class="MJXp-mrow" id="MJXp-Span-1201"><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1206" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">i</span><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">s</span><span class="MJXp-mrow" id="MJXp-Span-1212"><span class="MJXp-mo" id="MJXp-Span-1213" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">a</span><span class="MJXp-mrow" id="MJXp-Span-1215"><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1217" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1220" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">i</span><span class="MJXp-mrow" id="MJXp-Span-1223"><span class="MJXp-mo" id="MJXp-Span-1224" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">s</span><span class="MJXp-mrow" id="MJXp-Span-1226"><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1228" style="color: red;">\文</span><span class="MJXp-mrow" id="MJXp-Span-1229"><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0.278em; margin-right: 0.278em;">字</span></span><span class="MJXp-mrow" id="MJXp-Span-1231"><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1233"><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0.278em; margin-right: 0.278em;">优</span></span><span class="MJXp-mrow" id="MJXp-Span-1235"><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0.278em; margin-right: 0.278em;">势</span></span><span class="MJXp-mrow" id="MJXp-Span-1237"><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0.278em; margin-right: 0.278em;">函</span></span><span class="MJXp-mrow" id="MJXp-Span-1239"><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> A ^ \ pi（s，a）= Q ^ \ pi（s，a）-V ^ \ pi（s）\文字{-优势函数} </script></p><p> 如果我们的政策从特定状态开始游戏，则“价值”功能将显示预期收益。 与Q功能相同，只需修复第一个动作即可。 </p><br><h3> 提出批评 </h3><br><p> 这是使用奖励奖励时的外观： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1241"><span class="MJXp-mtext" id="MJXp-Span-1242">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">l</span><span class="MJXp-msubsup" id="MJXp-Span-1247"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1249" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">a</span><span class="MJXp-mtext" id="MJXp-Span-1255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">g</span><span class="MJXp-mtext" id="MJXp-Span-1259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">p</span><span class="MJXp-msubsup" id="MJXp-Span-1261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1262" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1263" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">a</span><span class="MJXp-mrow" id="MJXp-Span-1269"><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1273" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1274"><span class="MJXp-mo" id="MJXp-Span-1275" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1278" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1279"><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1281">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">u</span><span class="MJXp-msubsup" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1286"><span class="MJXp-msup" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1289" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1290">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1295" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1298" style="vertical-align: 0.5em;">′</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）\ sum_ {t'= t} ^ T r_ {t'} </script></p><p> 现在，对数梯度的系数不过是Value函数的样本。 </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1299"><span class="MJXp-mtext" id="MJXp-Span-1300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">u</span><span class="MJXp-msubsup" id="MJXp-Span-1303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-msup" id="MJXp-Span-1306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1308" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1309">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1317" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">m</span><span class="MJXp-msubsup" id="MJXp-Span-1322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1324" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">i</span><span class="MJXp-mrow" id="MJXp-Span-1327"><span class="MJXp-mo" id="MJXp-Span-1328" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1331" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1332"><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ sum_ {t'= t} ^ T r_ {t'} \ sim V ^ \ pi（s_t）</script></p><p> 我们用来自特定轨迹的一个样本权衡对数梯度，这不好。  <b>我们可以使用某些模型（例如神经网络）来近似值函数，并从中询问必要的值，从而减少方差。</b> 我们将此模型称为<b>批评家（批评）</b> ，并将与政策并行研究。 因此，梯度公式可以写成： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1334"><span class="MJXp-mtext" id="MJXp-Span-1335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">l</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">a</span><span class="MJXp-mtext" id="MJXp-Span-1348">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">g</span><span class="MJXp-mtext" id="MJXp-Span-1352">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">p</span><span class="MJXp-msubsup" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1356" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1360">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361">a</span><span class="MJXp-mrow" id="MJXp-Span-1362"><span class="MJXp-mo" id="MJXp-Span-1363" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1366" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1367"><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1371" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1372"><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">u</span><span class="MJXp-msubsup" id="MJXp-Span-1377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1379"><span class="MJXp-msup" id="MJXp-Span-1380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1382" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1383">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1387" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1388" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1391" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1392" style="color: red;">\大</span><span class="MJXp-mrow" id="MJXp-Span-1393"><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0.278em; margin-right: 0.278em;">约</span></span><span class="MJXp-mtext" id="MJXp-Span-1395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">l</span><span class="MJXp-msubsup" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1402" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">a</span><span class="MJXp-mtext" id="MJXp-Span-1408">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">g</span><span class="MJXp-mtext" id="MJXp-Span-1412">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">p</span><span class="MJXp-msubsup" id="MJXp-Span-1414"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1416" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">a</span><span class="MJXp-mrow" id="MJXp-Span-1422"><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1426" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1427"><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1430" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1431" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1432"><span class="MJXp-mo" id="MJXp-Span-1433" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-msubsup" id="MJXp-Span-1434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1436" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">i</span><span class="MJXp-mrow" id="MJXp-Span-1439"><span class="MJXp-mo" id="MJXp-Span-1440" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">u</span><span class="MJXp-mrow" id="MJXp-Span-1445"><span class="MJXp-mo" id="MJXp-Span-1446" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）\ sum_ {t'= t} ^ T r_ {t'} \大约\ nabla_ \ theta \ log \ pi_ \ theta（a_t | s_t）V ^ \ pi（\ tau）</script></p><p> 我们减少了方差，但同时，由于神经网络会产生近似误差，因此将<b>偏差</b>引入了算法。 但是在这种情况下的妥协是好的。 机器学习中的这种情况称为<b><a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229">偏差方差折衷</a></b> 。 </p><br><p> 评论家将对在环境中收集的奖励性样品进行价值函数回归分析。 作为误差函数，我们采用MSE。 即 损失看起来像这样： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1447"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">s</span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1453"><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mrow" id="MJXp-Span-1456" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">V</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1458" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1459">p</span><span class="MJXp-msubsup" id="MJXp-Span-1460"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1462" style="vertical-align: -0.4em;">p</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">i</span><span class="MJXp-mrow" id="MJXp-Span-1465"><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1469" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1470"><span class="MJXp-mo" id="MJXp-Span-1471" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1473">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">u</span><span class="MJXp-msubsup" id="MJXp-Span-1476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-msup" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1481" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1482">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1487" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1488"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1490" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1491"><span class="MJXp-mrow" id="MJXp-Span-1492" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1493" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1494" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> loss =（{V} ^ \ pi_ psi（s_t）-\ sum_ {t'= t} ^ T r_ {t'}）^ 2 </script></p><p> 验证码： </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CriticNetwork</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) output = tf.layers.dense(l3, units=<span class="hljs-number"><span class="hljs-number">1</span></span>) self.value_op = tf.squeeze(output, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training self.value_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.loss = tf.losses.mean_squared_error(self.value_ph, self.value_op) optimizer = tf.train.AdamOptimizer(learning_rate=critic_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p> 现在，训练周期如下所示： </p><br><pre> <code class="python hljs">batch_generator = generate_batch(envs, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, value, reward-to-go] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]}) # Train critic for j in range(10): _, critic_loss = sess.run([critic.update_op, critic.loss], feed_dict={critic.state_ph: batch[:, 0], critic.value_ph: batch[:, 3]})</span></span></code> </pre><br><p> 现在，该批处理包含另一个值，即由注释者在生成器中计算出的值。 <br> 即 批处理的类型是这样的： <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1495"><span class="MJXp-mrow" id="MJXp-Span-1496"><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1500" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1501"><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-1503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1505" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1506"><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-1508"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1509" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1510" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511">p</span><span class="MJXp-msubsup" id="MJXp-Span-1512"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1514" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">i</span><span class="MJXp-mrow" id="MJXp-Span-1518"><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1522" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1523"><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mrow" id="MJXp-Span-1525"><span class="MJXp-mo" id="MJXp-Span-1526" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mtext" id="MJXp-Span-1527">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">u</span><span class="MJXp-msubsup" id="MJXp-Span-1530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1532"><span class="MJXp-msup" id="MJXp-Span-1533"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1535" style="vertical-align: 0.5em;">′</span></span><span class="MJXp-mo" id="MJXp-Span-1536">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1539"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1541" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1544" style="vertical-align: 0.5em;">′</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1545"><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41">（s_t，a_t，V ^ \ pi_ \ psi（s_t），\ sum_ {t'= t} ^ T r_ {t'}）</script>  。 </p><br><p> 在周期中，没有什么东西会限制我们从<b>训练评论家到收敛</b> ，因此我们采取了几步梯度下降的方法，从而改善了Value函数的逼近度并减少了偏差。 但是，此方法需要大批量，以避免重新培训。  <b>关于学习政策的类似说法是不正确的。</b> 它应该从学习环境中获得即时反馈，否则我们可能会发现自己处以罚款政策以采取尚未采取的行动。 具有此属性的算法称为<b>on-policy</b> 。 </p><br><h3> 政策梯度基准 </h3><br><p> 可以证明，在梯度中，可以放很多其他有用的函数 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> t </script>  。 这些功能称为<b>基准</b> 。  （ <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">这一事实的结论</a> ）以下功能可以很好地作为基准： </p><br><img src="https://habrastorage.org/webt/c8/ah/l7/c8ahl70po6_pgcud0jxdfbmubi8.png"><br><p>  <i>资料来源： <a href="https://arxiv.org/pdf/1506.02438.pdf">GAE纸</a> 。</i> </p><br><p> 不同的基线会根据任务给出不同的结果。 通常， <b>优势函数</b>及其近似值可带来最大的利润。 </p><br><p> 这背后甚至还有一点直觉。 当我们使用Advantage时，我们会根据代理商认为其执行的操作的平均水平好坏多少的比例对代理商进行罚款。 代理在环境中发挥的越好， <b>他的标准</b>就<b>越高</b> 。 理想代理将发挥良好作用，并评估其所有动作，使其“优势”等于0，因此坡度等于0。 </p><br><h3> 通过价值函数评估优势 </h3><br><p> 回顾优势的定义： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1549"><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1552" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">i</span><span class="MJXp-mrow" id="MJXp-Span-1555"><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">s</span><span class="MJXp-mrow" id="MJXp-Span-1558"><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">a</span><span class="MJXp-mrow" id="MJXp-Span-1561"><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1564"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1566" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">i</span><span class="MJXp-mrow" id="MJXp-Span-1569"><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">s</span><span class="MJXp-mrow" id="MJXp-Span-1572"><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">a</span><span class="MJXp-mrow" id="MJXp-Span-1575"><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1577" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1580" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">i</span><span class="MJXp-mrow" id="MJXp-Span-1583"><span class="MJXp-mo" id="MJXp-Span-1584" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">s</span><span class="MJXp-mrow" id="MJXp-Span-1586"><span class="MJXp-mo" id="MJXp-Span-1587" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1588" style="color: red;">\文</span><span class="MJXp-mrow" id="MJXp-Span-1589"><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.278em; margin-right: 0.278em;">字</span></span><span class="MJXp-mrow" id="MJXp-Span-1591"><span class="MJXp-mo" id="MJXp-Span-1592" style="margin-left: 0em; margin-right: 0.111em;">−</span><span class="MJXp-mrow" id="MJXp-Span-1593"><span class="MJXp-mo" id="MJXp-Span-1594" style="margin-left: 0.278em; margin-right: 0.278em;">优</span></span><span class="MJXp-mrow" id="MJXp-Span-1595"><span class="MJXp-mo" id="MJXp-Span-1596" style="margin-left: 0.278em; margin-right: 0.278em;">势</span></span><span class="MJXp-mrow" id="MJXp-Span-1597"><span class="MJXp-mo" id="MJXp-Span-1598" style="margin-left: 0.278em; margin-right: 0.278em;">函</span></span><span class="MJXp-mrow" id="MJXp-Span-1599"><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0.278em; margin-right: 0.278em;">数</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43"> A ^ \ pi（s，a）= Q ^ \ pi（s，a）-V ^ \ pi（s）\文字{-优势函数} </script></p><p> 目前尚不清楚如何明确学习这种功能。 有一个技巧可以解决，它将把Advantage函数的计算减少到Value函数的计算。 </p><br><p> 定义 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1601"><span class="MJXp-mtext" id="MJXp-Span-1602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">t</span><span class="MJXp-msubsup" id="MJXp-Span-1607"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1615" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">V</span><span class="MJXp-mrow" id="MJXp-Span-1617"><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1619"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1621" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">t</span><span class="MJXp-mo" id="MJXp-Span-1623">+</span><span class="MJXp-mn" id="MJXp-Span-1624">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1625"><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1627" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628">V</span><span class="MJXp-mrow" id="MJXp-Span-1629"><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1633" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1634"><span class="MJXp-mo" id="MJXp-Span-1635" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ delta_t ^ V = r_t + V（s_ {t + 1}）-V（s_t）</script>  -时间差残差（ <b>TD-残差</b> ）。 不难得出这样的函数近似于Advantage的结论： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1636"><span class="MJXp-mtext" id="MJXp-Span-1637">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">E</span><span class="MJXp-mtext" id="MJXp-Span-1639" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-1640" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1644">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">t</span><span class="MJXp-msubsup" id="MJXp-Span-1646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">t</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">t</span><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1657" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1658">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">E</span><span class="MJXp-mtext" id="MJXp-Span-1660" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-1661" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1664" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">V</span><span class="MJXp-mrow" id="MJXp-Span-1667"><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1671" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1672">t</span><span class="MJXp-mo" id="MJXp-Span-1673">+</span><span class="MJXp-mn" id="MJXp-Span-1674">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1675"><span class="MJXp-mo" id="MJXp-Span-1676" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">V</span><span class="MJXp-mrow" id="MJXp-Span-1679"><span class="MJXp-mo" id="MJXp-Span-1680" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1681"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1683" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1684"><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1686" style="color: red;">\右</span><span class="MJXp-mo" id="MJXp-Span-1687" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">E</span><span class="MJXp-mtext" id="MJXp-Span-1691" style="color: red;">\左</span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">Q</span><span class="MJXp-mrow" id="MJXp-Span-1694"><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1696"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1698" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1699"><span class="MJXp-mo" id="MJXp-Span-1700" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-1701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1703" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1704"><span class="MJXp-mo" id="MJXp-Span-1705" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707">V</span><span class="MJXp-mrow" id="MJXp-Span-1708"><span class="MJXp-mo" id="MJXp-Span-1709" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1710"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1711" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1712" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1713"><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mtext" id="MJXp-Span-1715">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">t</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">A</span><span class="MJXp-mrow" id="MJXp-Span-1724"><span class="MJXp-mo" id="MJXp-Span-1725" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1728" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1729"><span class="MJXp-mo" id="MJXp-Span-1730" style="margin-left: 0.278em; margin-right: 0.278em;">，</span></span><span class="MJXp-msubsup" id="MJXp-Span-1731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1733" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1734"><span class="MJXp-mo" id="MJXp-Span-1735" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-45"> \ E \左[\ delta ^ V_t \ right] = \ E \左[r_t + V（s_ {t + 1}）-V（s_t）\右] = \ E \左[Q（s_t，a_t） -V（s_t）\ right] = A（s_t，a_t）</script></p><p> 这种概念上复杂的更改会引起代码中的变化不大。 现在，评论家将不提交价值函数，而是提交用于策略培训的优势评估。 </p><br><p> 生成的算法称为<b>Advantage Actor-Critic</b> 。 </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate_advantage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(states, rewards)</span></span></span><span class="hljs-function">:</span></span> values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + np.append(values[<span class="hljs-number"><span class="hljs-number">1</span></span>:], np.array([<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deltas, values</code> </pre><br><p> 可以观察到获得的作用剂有信心的步态和四肢的同步使用： </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GCbPl3dOLmQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3> 广义优势估计 </h3><br><p> 相对较新的文章（2018年），“ <a href="https://arxiv.org/pdf/1506.02438.pdf">使用广义优势估计的高维连续控制</a> ”，通过值函数提供了对优势的更有效评估。 它进一步减少了方差： </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1736"><span class="MJXp-msubsup" id="MJXp-Span-1737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-right: 0.05em;">A</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1740"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">E</span><span class="MJXp-mrow" id="MJXp-Span-1744"><span class="MJXp-mo" id="MJXp-Span-1745">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1746">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1747">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">a</span><span class="MJXp-mrow" id="MJXp-Span-1752"><span class="MJXp-mo" id="MJXp-Span-1753">，</span></span><span class="MJXp-mtext" id="MJXp-Span-1754">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1757">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1759">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760">a</span><span class="MJXp-mrow" id="MJXp-Span-1761"><span class="MJXp-mo" id="MJXp-Span-1762">）</span></span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1763" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1764">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">u</span><span class="MJXp-msubsup" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-1773">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770">l</span><span class="MJXp-mo" id="MJXp-Span-1771">=</span><span class="MJXp-mn" id="MJXp-Span-1772">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">y</span><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-1781">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">a</span><span class="MJXp-mtext" id="MJXp-Span-1787">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1791">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">a</span><span class="MJXp-msubsup" id="MJXp-Span-1794"><span class="MJXp-mrow" id="MJXp-Span-1795" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1796" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1797" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mtext" id="MJXp-Span-1798">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1799">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1801">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">t</span><span class="MJXp-msubsup" id="MJXp-Span-1803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">t</span><span class="MJXp-mo" id="MJXp-Span-1807">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">l</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> A_t ^ {GAE（\ gamma，\ lambda）} = \ sum_ {l = 0} ^ \ infty（\ gamma \ lambda）^ l \ delta ^ V_ {t + l} </script></p><p> 其中： </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1810"><span class="MJXp-mtext" id="MJXp-Span-1811">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1812">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1814">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">t</span><span class="MJXp-msubsup" id="MJXp-Span-1816"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1817" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1818">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1820" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1821"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1823" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">V</span><span class="MJXp-mrow" id="MJXp-Span-1826"><span class="MJXp-mo" id="MJXp-Span-1827" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1830" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">t</span><span class="MJXp-mo" id="MJXp-Span-1832">+</span><span class="MJXp-mn" id="MJXp-Span-1833">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1834"><span class="MJXp-mo" id="MJXp-Span-1835" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-1836" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">V</span><span class="MJXp-mrow" id="MJXp-Span-1838"><span class="MJXp-mo" id="MJXp-Span-1839" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-msubsup" id="MJXp-Span-1840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1842" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1843"><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ delta_t ^ V = r_t + V（s_ {t + 1}）-V（s_t）</script>  -TD残差 </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1845"><span class="MJXp-mtext" id="MJXp-Span-1846" style="color: red;">\伽</span><span class="MJXp-mrow" id="MJXp-Span-1847"><span class="MJXp-mo" id="MJXp-Span-1848" style="margin-left: 0.278em; margin-right: 0.278em;">玛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \伽玛</script>  -折扣系数（超参数）， </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1849"><span class="MJXp-mtext" id="MJXp-Span-1850">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ lambda </script>  -超参数。 </li></ul><br><p> 解释可以在出版物本身中找到。 </p><br><p> 实现方式： </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">discount_cumsum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, coef)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def estimate_advantage(states, rewards): values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + discount_factor * np.append(values[1:], np.array([0])) advantage = discount_cumsum(deltas, coef=lambda_factor * discount_factor) return advantage, values</span></span></code> </pre><br><p> 当使用小批量时，该算法会收敛到某些局部最优值。 在这里，特工用一只爪子当拐杖，其余的则推开： </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3f4rRbqnuxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> 在这里，特工没有使用跳跃，而只是快速地用四肢指法。 您还可以看到他的举止，如果他犹豫，他会转身继续跑步： </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/O5aJoj16ZDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> 最好的经纪人，他在本文的开头。 稳定的跳跃，在此期间所有四肢都脱出表面。 平衡能力的发展使代理能够在发生错误的情况下全速校正轨迹： </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xT9KKnpxxo8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="pitfalls"></a><h2> 陷阱 </h2><br><p> 机器学习以错误空间的大小而著称，该错误空间可能会产生并获得完全不起作用的算法。 但是RL将问题带到了一个全新的高度。 </p><br><img src="https://habrastorage.org/webt/rq/w0/fl/rqw0flwtyhb3getoyjwyraaf7na.png"><br><p>  <a href="http://ai.stanford.edu/~zayd/why-is-machine-learning-hard.html"><i>来源</i></a> </p><br><p> 这是在开发过程中遇到的一些困难。 </p><br><ol><li> 该算法对超参数非常敏感。 将学习率从3e-4更改为1e-4时，学习质量发生了变化。 画面发生了根本性的变化-从完全不收敛的算法到视频中的最佳算法。 </li><li> 批次的大小与DL的其他区域完全不同。 如果在图像分类中，您可以选择32-256个批次的大小，而增加它的结果不会有太大变化，那么最好花几千，3,000个工作来完成我们的任务，再者，从缺乏收敛性到好的算法。 </li><li> 学习最好运行几次，有时随机种子并不幸运。 </li><li> 在如此复杂的环境中学习需要花费大量时间，并且进步也不统一。 例如，学习了8个小时的最佳算法，其中3个算法的结果比随机基线差。 因此，在测试算法时，最好从较小的算法开始，例如健身房的玩具环境。 <img src="https://habrastorage.org/webt/ol/ml/yx/olmlyxvpvt8lroty8kllva2igz4.png"></li><li> 查找超参数和模型体系结构的一种好方法是浏览相关文章和实现。  （主要是不要再培训） </li></ol><br><p> 您可以从本文中了解有关Deep RL细微差别的更多信息： <a href="https://www.alexirpan.com/2018/02/14/rl-hard.html">深度强化学习尚不可行</a> 。 </p><br><a name="conclusion"></a><h2> 结论 </h2><br><p> 最终的算法令人信服地解决了该问题。 找到功能 <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mtext" id="MJXp-Span-1858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">i</span><span class="MJXp-mrow" id="MJXp-Span-1861"><span class="MJXp-mo" id="MJXp-Span-1862" style="margin-left: 0.278em; margin-right: 0.278em;">：</span></span><span class="MJXp-mtext" id="MJXp-Span-1863">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1864"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1866" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1867">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1868" style="color: red;">\到</span><span class="MJXp-mtext" id="MJXp-Span-1869">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1872" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1873">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ pi：\ R ^ {800} \到\ R ^ {18} </script>  ，灵活而自信地控制机器人。 </p><br><p> 逻辑上的继续将是研究A2C，PPO和TRPO算法的近亲。 它们提高了<b>样品效率</b> ，即 算法的收敛时间，它们能够解决更复杂的问题。 最近<a href="https://openai.com/blog/solving-rubiks-cube/">在机器人上组装了Rubik's Cube的</a>是PPO +自动域随机化。 </p><br><p> 在这里，您可以找到文章中的代码： <a href="https://github.com/LeonidMurashov/advantage-actor-critic-gae">repository</a> 。 </p><br><p> 我希望您喜欢这篇文章，并从深度强化学习今天能做的事情中得到启发。 </p><br><p>  <b>感谢您的关注！</b> </p><br><h2> 有用的链接： </h2><br><ul><li>  <a href="https://spinningup.openai.com/en/latest/index.html">欢迎使用Deep RL入门！</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse-fa17/index.html">CS 294：深度强化学习，2017年秋季</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse/">CS 285：深度强化学习，决策和控制</a> </li><li>  <a href="https://arxiv.org/pdf/1506.02438.pdf">使用广义优势估计的高维连续控制</a> </li><li>  <a href="https://github.com/openai/baselines/">OpenAI基线：强化学习算法的高质量实现</a> </li></ul><br><p>  <i>感谢<a href="https://habr.com/ru/users/pinkotter/" class="user_link">pinkotter</a> ， <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a>和<a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin</a> ， <a href="https://habr.com/ru/users/pollyfom/" class="user_link">pollyfom</a>和<a href="https://habr.com/ru/users/suriknik/" class="user_link">suriknik</a>为该项目提供的帮助。</i> <br>  <i>特别是， <a href="https://habr.com/ru/users/vambala/" class="user_link">Vambala</a>和<a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin</a>用于创建一个很酷的MuJoCo环境。</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483078/">https://habr.com/ru/post/zh-CN483078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483064/index.html">Vue是所有法规上最小的aka小博客</a></li>
<li><a href="../zh-CN483066/index.html">比尔·盖茨的传统五本书</a></li>
<li><a href="../zh-CN483068/index.html">流行的反作弊BattlEye的逆向工程</a></li>
<li><a href="../zh-CN483074/index.html">TensorRT 6.xxx-深度学习模型的高性能推理（对象检测和分段）</a></li>
<li><a href="../zh-CN483076/index.html">2020年用于Android App开发的顶级编程语言</a></li>
<li><a href="../zh-CN483082/index.html">漏洞搜寻效率提高7％</a></li>
<li><a href="../zh-CN483084/index.html">具有跟踪功能的相机</a></li>
<li><a href="../zh-CN483086/index.html">2019年业绩：哪些资产被证明是俄罗斯投资者最赚钱的</a></li>
<li><a href="../zh-CN483094/index.html">当我访问微软俄罗斯办公室时，我如何实现梦想</a></li>
<li><a href="../zh-CN483110/index.html">顿河畔罗斯托夫：2019年的IT公司，社区和活动</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>