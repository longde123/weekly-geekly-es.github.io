<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§öüèΩ üë®‚Äçüëß‚Äçüë¶ üë©üèæ‚Äçüíª Toda a verdade sobre o RTOS. Artigo 13. Estruturas de dados da tarefa e chamadas de API n√£o suportadas ü•ó üì† üë©üèΩ‚Äçüî¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste terceiro e √∫ltimo artigo de tarefas, examinarei as estruturas de dados do Nucleus SE e descreverei as chamadas da API do RTOS que n√£o s√£o implem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Toda a verdade sobre o RTOS. Artigo 13. Estruturas de dados da tarefa e chamadas de API n√£o suportadas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425353/"><img src="https://habrastorage.org/webt/a2/hi/au/a2hiaum17nhh6_ibldqgahpgaxo.jpeg"><br><br>  Neste terceiro e √∫ltimo artigo de tarefas, examinarei as estruturas de dados do Nucleus SE e descreverei as chamadas da API do RTOS que n√£o s√£o implementadas no Nucleus SE, al√©m de outros problemas de compatibilidade. <br><a name="habracut"></a><br>  Artigos anteriores da s√©rie: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 12.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servi√ßos para trabalhar com tarefas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 11.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tarefas: configura√ß√£o e introdu√ß√£o √† API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 10.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Agendador: recursos avan√ßados e preserva√ß√£o de contexto</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 9.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Agendador: implementa√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 8.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">N√∫cleo SE: Projeto Interno e Implanta√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo # 7</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">N√∫cleo SE: Introdu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 6.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Outros servi√ßos RTOS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 5.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intera√ß√£o e sincroniza√ß√£o de tarefas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 4.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tarefas, altern√¢ncia de contexto e interrup√ß√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo # 3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tarefas e planejamento</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RTOS: estrutura e modo em tempo real</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo 1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RTOS: introdu√ß√£o.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br><h2>  Estruturas de dados </h2><br>  As tarefas usam v√°rias estruturas de dados (na RAM e na ROM), que, como outros objetos do Nucleus SE, s√£o um conjunto de tabelas cujo tamanho corresponde ao n√∫mero de tarefas e par√¢metros selecionados. <br><br>  Eu recomendo que o c√≥digo do aplicativo acesse essas estruturas de dados usando fun√ß√µes da API, e n√£o diretamente.  Isso evita efeitos colaterais indesejados, incompatibilidade com vers√µes futuras do Nucleus SE e tamb√©m simplifica a portabilidade do aplicativo para o Nucleus RTOS.  Para uma melhor compreens√£o da opera√ß√£o do c√≥digo de chamada de servi√ßo e do processo de depura√ß√£o, √© fornecida abaixo uma descri√ß√£o detalhada das estruturas de dados. <br><br><h3>  Estruturas de dados do kernel hospedadas na RAM </h3><br>  Essas estruturas de dados incluem: <br><br>  <b>NUSE_Task_Context [] []</b> - uma matriz bidimensional do tipo <b>ADDR</b> , possui uma linha para cada tarefa.  O n√∫mero de colunas depende da arquitetura do controlador e √© determinado pelo s√≠mbolo <b>NUSE_REGISTERS</b> , definido em <b>nuse_types.h</b> .  Essa matriz √© usada pelo planejador para salvar o contexto de cada tarefa e foi descrita em detalhes na se√ß√£o "Salvando o contexto" do artigo 10.  N√£o criado se o agendador RTC for usado. <br>  <b>NUSE_Task_Signal_Flags []</b> - uma matriz do tipo <b>U8</b> , criada se os sinais estiverem ativados, e cont√©m 8 sinalizadores de sinal para cada tarefa.  Os sinais ser√£o discutidos em um dos seguintes artigos. <br>  <b>NUSE_Task_Timeout_Counter []</b> √© uma matriz do tipo <b>U16</b> , consiste em subtrair contadores para cada tarefa e √© criada se a chamada para a API <b>NUSE_Task_Sleep () estiver</b> ativada. <br>  <b>NUSE_Task_Status []</b> - uma matriz do tipo U8, cont√©m o status de cada tarefa - <b>NUSE_READY</b> ou status de suspens√£o.  Criado apenas se a suspens√£o da tarefa estiver ativada. <br>  <b>NUSE_Task_Blocking_Return []</b> - uma matriz do tipo U8, criada se o bloqueio de chamadas da API estiver ativado.  Ele cont√©m um c√≥digo de retorno que ser√° usado ap√≥s o bloqueio de chamadas da API.  Geralmente, cont√©m <b>NUSE_SUCCESS</b> ou c√≥digo indicando que o objeto foi redefinido (por exemplo, <b>NUSE_MAILBOX_WAS_RESET</b> ). <br>  <b>NUSE_Task_Schedule_Count []</b> - uma matriz do tipo <b>U16</b> , cont√©m um contador para cada tarefa e √© criada apenas se a contagem do planejador tiver sido ativada. <br><br>  <b>NUSE_Task_Context [] [] √©</b> inicializado principalmente por zeros, exceto para entradas correspondentes ao registro de status (registro de status, SR), contador de programa (contador de programa, PC) e ponteiro de pilha (ponteiro de pilha, SP), aos quais s√£o atribu√≠dos valores iniciais (consulte "Dados na ROM "abaixo), e todas as outras estruturas de dados <b>NUSE_Init_Task ()</b> recebem zeros ao iniciar o Nucleus SE.  Um dos artigos a seguir conter√° uma lista completa dos procedimentos de inicializa√ß√£o do Nucleus SE com sua descri√ß√£o. <br><br>  A seguir, s√£o definidas as estruturas de dados contidas no arquivo nuse_init.c. <br><br><img src="https://habrastorage.org/webt/fj/hr/le/fjhrlehn7si_hkt5lnnyk6dosno.jpeg"><br><br><h3>  Dados do usu√°rio da RAM </h3><br>  O usu√°rio deve definir uma pilha para cada tarefa (se o planejador RTC n√£o for usado).  Essas devem ser matrizes <b>ADDR</b> , geralmente definidas em <b>nuse_config.c</b> .  Endere√ßos e tamanhos de pilha devem ser colocados nas entradas de tarefa <b>NUSE_Task_Stack_Base []</b> e <b>NUSE_Task_Stack_Size [],</b> respectivamente (consulte Dados na ROM). <br><br><h3>  Dados ROM </h3><br>  Uma ROM armazena de uma a quatro estruturas de dados relacionadas √†s tarefas.  A quantidade exata depende dos par√¢metros selecionados: <br><br>  <b>NUSE_Task_Start_Address []</b> √© uma matriz do tipo <b>ADDR</b> que possui uma entrada para cada tarefa, que √© um ponteiro para o ponto de entrada de c√≥digo da tarefa. <br>  <b>NUSE_Task_Stack_Base []</b> √© uma matriz do tipo <b>ADDR</b> que possui uma entrada para cada tarefa, que √© um ponteiro para o endere√ßo base da pilha da tarefa.  Essa matriz √© criada se qualquer agendador diferente do RTC for usado. <br>  <b>NUSE_Task_Stack_Size []</b> √© uma matriz do tipo <b>U16</b> que possui uma entrada para cada tarefa, que mostra o tamanho da pilha da tarefa (em palavras).  Essa matriz √© criada se qualquer agendador diferente do RTC for usado. <br>  <b>NUSE_Task_Initial_State []</b> √© uma matriz do tipo <b>U8</b> , com uma entrada para cada tarefa, que mostra o estado inicial da tarefa.  Pode ser <b>NUSE_READY</b> ou <b>NUSE_PURE_SUSPEND</b> .  Essa matriz √© criada se o suporte ao estado inicial da tarefa estiver selecionado. <br><br>  Essas estruturas de dados s√£o declaradas e inicializadas (estaticamente) em <b>nuse_config.c</b> : <br><br><img src="https://habrastorage.org/webt/2g/pp/bu/2gppbu3zs8wc0gipo3kggntvxek.jpeg"><br><br><h3>  A quantidade de mem√≥ria para armazenar dados da tarefa (pegada de dados da tarefa) </h3><br>  Como todos os objetos principais do Nucleus SE, a quantidade de mem√≥ria necess√°ria para armazenar dados √© previs√≠vel. <br><br>  Tamanho da ROM (em bytes) necess√°rio para todas as tarefas do aplicativo: <br>  <b>NUSE_TASK_NUMBER * sizeof (ADDR)</b> <br><br>  Al√©m disso, se qualquer agendador diferente de RTC estiver selecionado: <br>  <b>NUSE_TASK_NUMBER * (tamanho (ADDR) +2)</b> <br><br>  Al√©m disso, se o suporte ao estado inicial da tarefa estiver selecionado: <br>  <b>NUSE_TASK_NUMBER</b> <br><br>  Para armazenar dados na RAM, a quantidade de mem√≥ria (em bytes) √© determinada pelos par√¢metros selecionados e pode ter um valor zero se nenhum dos par√¢metros for selecionado. <br>  Se um agendador diferente de RTC for selecionado: <br>  <b>NUSE_TASK_NUMBER * NUSE REGISTERS * sizeof (ADDR)</b> <br><br>  Al√©m disso, se o suporte ao sinal estiver selecionado: <br>  <b>NUSE_TASK_NUMBER</b> <br><br>  Al√©m disso, se a chamada para a API NUSE_Task_Sleep () estiver ativada: <br>  <b>NUSE_TASK_NUMBER * 2</b> <br><br>  Al√©m disso, se a suspens√£o da tarefa estiver ativada: <br>  <b>NUSE_TASK_NUMBER</b> <br><br>  Al√©m disso, se o bloqueio de chamadas da API estiver ativado: <br>  <b>NUSE_TASK_NUMBER</b> <br><br>  Al√©m disso, se o contador do planejador estiver ativado: <br>  <b>NUSE_TASK_NUMBER * 2</b> <br><br><h2>  Chamadas de API n√£o implementadas no Nucleus SE </h2><br>  Listados abaixo est√£o sete chamadas de API dispon√≠veis no Nucleus RTOS que n√£o s√£o implementadas no Nucleus SE. <br><br><h3>  Criar tarefa </h3><br>  Essa chamada de API cria uma tarefa do aplicativo.  O Nucleus SE n√£o precisa desse recurso porque as tarefas s√£o criadas estaticamente. <br><br>  Prot√≥tipo de chamada: <br><br>  <b>STATUS NU_Create_Task (tarefa NU_TASK *, nome CHAR *, VOID (* task_entry) (UNSIGNED, VOID *), args UNSIGNED, VOID * argv, endere√ßo_ Stack_ID, n√∫mero_da_ pilha, tamanho_da_ pilha, prioridade da op√ß√£o ,_slice de tempo UNSIGNED, prioridade da op√ß√£o</b> <br><br>  Par√¢metros: <br><br>  <b>task</b> - um ponteiro para um bloco de controle de tarefas do usu√°rio, pode ser usado como um identificador / link ("identificador") de uma tarefa em outras chamadas de API; <br>  <b>nome</b> - ponteiros para o nome da tarefa, uma cadeia de 7 caracteres com um zero final; <br>  <b>task_entry</b> - indica a fun√ß√£o de entrada para a tarefa; <br>  <b>argc</b> - elemento de dados <b>N√ÉO</b> <b>ASSINADO</b> que pode ser usado para passar informa√ß√µes iniciais para a tarefa; <br>  <b>argv</b> - um ponteiro que pode ser usado para transmitir informa√ß√µes para a tarefa; <br>  <b>stack_address</b> - define o setor inicial da mem√≥ria para a pilha de tarefas; <br>  <b>stack_size</b> - indica o n√∫mero de bytes na pilha; <br>  <b>prioridade</b> - indica o valor da prioridade da tarefa: de 0 a 255, onde n√∫meros mais baixos correspondem √† prioridade mais alta; <br>  <b>time_slice</b> - indica o n√∫mero m√°ximo de intervalos de tempo que podem decorrer durante esta tarefa.  Um valor de "0" desativa o tempo de corte para esta tarefa; <br>  <b>preempt</b> - indica se a tarefa √© suplantada ou n√£o.  Pode ter valores <b>NU_PREEMPT</b> e <b>NU_NO_PREEMPT</b> ; <br>  <b>auto_start</b> - mostra o estado inicial da tarefa.  <b>NU_START</b> significa que a tarefa est√° pronta para execu√ß√£o e <b>NU_NO_START significa</b> que a tarefa est√° suspensa. <br><br>  Valor de retorno: <br><br>  <b>NU_SUCCESS</b> - indica uma conclus√£o bem sucedida do servi√ßo; <br>  <b>NU_INVALID_TASK</b> - indica que o ponteiro para a unidade de controle de tarefas √© <b>NULL</b> ; <br>  <b>NU_INVALID_ENTRY</b> - indica que o ponteiro para a fun√ß√£o de entrada da tarefa √© <b>NULL</b> ; <br>  <b>NU_INVALID_MEMORY</b> - indica que o setor de mem√≥ria atribu√≠do pelo par√¢metro stack_address √© zero ( <b>NULL</b> ); <br>  <b>NU_INVALID_SIZE</b> - indica que o tamanho da pilha especificado √© insuficiente; <br>  <b>NU_INVALID_PREEMPT</b> - indica que o par√¢metro <b>preempt</b> <b>est√°</b> definido incorretamente; <br>  <b>NU_INVALID_START</b> - indica que o par√¢metro <b>auto_start est√°</b> definido incorretamente. <br><br><h3>  Excluir tarefa </h3><br>  Essa chamada de API exclui uma tarefa de aplicativo criada anteriormente que deve ser <i>conclu√≠da</i> ou <i>finalizada</i> .  Essa chamada tamb√©m n√£o √© necess√°ria para o Nucleus SE, pois as tarefas s√£o criadas estaticamente e n√£o podem ser exclu√≠das. <br><br>  Prot√≥tipo de chamada: <br><br>  <b>STATUS NU_Delete_Task (tarefa NU_TASK *);</b> <br><br>  Par√¢metros: <br><br>  <b>task</b> - ponteiro para o bloco de controle de tarefas <br><br>  Valor de retorno: <br><br>  <b>NU_SUCCESS</b> - indica uma conclus√£o bem sucedida do servi√ßo; <br>  <b>NU_INVALID_TASK</b> - indica que o ponteiro para a tarefa est√° definido incorretamente; <br>  <b>NU_INVALID_DELETE</b> - indica que a tarefa n√£o est√° no estado Conclu√≠do ou Terminado. <br><br><h3>  Obter indicadores de tarefas </h3><br>  Essa chamada de API comp√µe uma lista seq√ºencial de ponteiros para todas as tarefas no sistema.  N√£o √© necess√°rio no Nucleus SE, pois as tarefas s√£o identificadas usando um √≠ndice simples, n√£o um ponteiro. <br><br>  Prot√≥tipo de chamada: <br><br>  <b>UNSIGNED NU_Task_Pointers (NU_TASK ** pointer_list, UNSIGNED maximum_pointers);</b> <br><br>  Par√¢metros: <br><br>  <b>pointer_list</b> - ponteiro para uma matriz de ponteiros <b>NU_TASK</b> .  Essa matriz ser√° preenchida com ponteiros para as tarefas instaladas no sistema; <br>  <b>maximum_pointers</b> - o n√∫mero m√°ximo de ponteiros que podem ser colocados na matriz. <br><br>  Valor de retorno: <br><br>  O n√∫mero de ponteiros <b>NU_TASK</b> colocados na matriz. <br><br><h3>  Alterar prioridade da tarefa </h3><br>  Essa chamada de API atribui √† tarefa uma nova prioridade.  No Nucleus SE, isso n√£o √© obrigat√≥rio, pois as prioridades das tarefas s√£o constantes. <br><br>  Prot√≥tipo de chamada: <br><br>  <b>OPTION NU_Change_Priority (tarefa NU_TASK *, OPTION new_priority);</b> <br><br>  Par√¢metros: <br><br>  <b>tarefa</b> - um ponteiro para um bloco de controle de tarefas; <br>  <b>new_priority</b> - define a prioridade de 0 a 255. <br><br>  Valor de retorno: <br>  O valor da prioridade da tarefa anterior. <br><br><h3>  Alterar algoritmo de preemp√ß√£o de tarefa </h3><br>  Essa chamada de API altera a ordem de exclus√£o da tarefa.  O Nucleus SE n√£o precisa dele porque usa um algoritmo de agendamento mais simples. <br><br>  Prot√≥tipo de chamada: <br>  <b>OPTION NU_Change_Preemption (op√ß√£o antecipada de OPTION);</b> <br><br>  Par√¢metros: <br>  <b>preempt</b> - novo algoritmo <b>preemptivo</b> , aceita <b>NU_PREEMPT</b> ou <b>NU_NO_PREEMPT</b> <br><br>  Valor de retorno: <br>  O algoritmo anterior para excluir uma tarefa. <br><br><h3>  Alterar a fatia do tempo da tarefa </h3><br>  Essa chamada de API altera o intervalo de tempo de uma tarefa espec√≠fica.  O Nucleus SE n√£o precisa, pois as fatias de tempo da tarefa s√£o corrigidas. <br><br>  Prot√≥tipo de chamada: <br>  <b>UNSIGNED NU_Change_Time_Slice (tarefa NU_TASK *, UNSIGNED time_slice);</b> <br><br>  Par√¢metros: <br>  <b>tarefa</b> - um ponteiro para um bloco de controle de tarefas; <br>  <b>time_slice</b> - o n√∫mero m√°ximo de intervalos de tempo que podem decorrer durante esta tarefa; um valor zero desse campo desativa a quantiza√ß√£o de tempo para esta tarefa. <br><br>  Valor de retorno: <br>  O valor anterior do quantum de tempo da tarefa. <br><br><h3>  Finalizar tarefa </h3><br>  Essa chamada de API conclui uma tarefa espec√≠fica.  O N√∫cleo SE n√£o precisa disso porque o estado <i>Terminado</i> n√£o √© suportado. <br><br>  Prot√≥tipo de chamada: <br>  <b>ESTADO NU_Terminate_Task (NU_TASK * tarefa);</b> <br><br>  Par√¢metros: <br>  <b>task</b> - um ponteiro para um bloco de controle de tarefas. <br><br>  Valor de retorno: <br>  <b>NU_SUCCESS</b> - indica uma conclus√£o bem sucedida do servi√ßo; <br>  <b>NU_INVALID_TASK</b> - indica que o ponteiro da tarefa est√° incorreto. <br><br><h2>  Compat√≠vel com n√∫cleo RTOS </h2><br>  Ao desenvolver o Nucleus SE, um dos principais objetivos era garantir um alto n√≠vel de compatibilidade de c√≥digo com o Nucleus RTOS.  As tarefas n√£o s√£o exce√ß√£o e, do ponto de vista do usu√°rio, s√£o implementadas da mesma maneira que no Nucleus RTOS.  Em algumas √°reas incompat√≠veis, cheguei √† conclus√£o de que tal incompatibilidade seria aceit√°vel, uma vez que o c√≥digo final √© mais f√°cil de entender e pode usar a mem√≥ria com mais efici√™ncia.  No entanto, al√©m dessas incompatibilidades, o restante das chamadas da API do Nucleus RTOS pode ser usado quase diretamente como o Nucleus SE chama.  Um dos artigos a seguir fornecer√° mais detalhes sobre a transi√ß√£o do Nucleus RTOS para o Nucleus SE <br><br><h3>  Identificadores de objeto </h3><br>  No Nucleus RTOS, todos os objetos s√£o descritos por uma estrutura de dados (unidades de controle) que s√£o de um tipo espec√≠fico.  Um ponteiro para esta unidade de controle serve como um identificador para a tarefa.  No Nucleus SE, decidi que era necess√°ria uma abordagem diferente para o uso eficiente da mem√≥ria.  Todos os objetos do kernel s√£o descritos por um conjunto de tabelas na RAM e / ou ROM.  O tamanho dessas tabelas √© determinado pelo n√∫mero de tipos de objetos.  O identificador de um objeto espec√≠fico √© o √≠ndice nessas tabelas.  Ent√£o, eu defini <b>NUSE_TASK</b> como o equivalente a <b>U8</b> .  Uma vari√°vel desse tipo (n√£o um ponteiro) serve como um identificador para tarefas.  Essa √© uma pequena incompatibilidade que √© f√°cil descobrir se o c√≥digo √© portado para ou a partir do Nucleus RTOS.  Os identificadores de objetos geralmente s√£o armazenados e transmitidos inalterados. <br><br>  O n√∫cleo RTOS tamb√©m suporta a nomea√ß√£o de tarefas.  Esses nomes s√£o usados ‚Äã‚Äãapenas para depura√ß√£o.  Exclu√≠-os do Nucleus SE para economizar mem√≥ria. <br><br><h3>  Estados da tarefa </h3><br>  No Nucleus RTOS, as tarefas podem estar em um dos v√°rios estados: <i>Execu√ß√£o</i> , <i>Pronto</i> , <i>Suspenso</i> (o que leva √† incerteza: a tarefa est√° em espera ou bloqueada por uma chamada de API), <i>Encerrada</i> ou Conclu√≠da. <br><br>  O Nucleus SE tamb√©m suporta os estados <i>Executando</i> e <i>Pronto</i> .  Todas as tr√™s op√ß√µes <i>suspensas</i> s√£o suportadas opcionalmente.  N√£o h√° suporte para Terminado e Conclu√≠do.  Nenhuma chamada de API para concluir tarefas.  Uma fun√ß√£o de tarefa externa nunca deve retornar um valor expl√≠cita ou implicitamente (isso resultar√° em um estado <i>Finalizado</i> no Nucleus RTOS). <br><br><h3>  Chamadas de API n√£o realizadas </h3><br>  O n√∫cleo RTOS suporta 16 chamadas do escrit√≥rio para trabalhar com tarefas.  Destes, 7 n√£o est√£o implementados no Nucleus SE.  Sua descri√ß√£o e o motivo de sua exclus√£o est√£o descritos acima. <br><br>  No pr√≥ximo artigo, come√ßaremos a analisar o gerenciamento de mem√≥ria RTOS. <br><br>  <b>Sobre o autor:</b> Colin Walls trabalha na ind√∫stria eletr√¥nica h√° mais de trinta anos, dedicando a maior parte de seu tempo ao firmware.  Ele agora √© engenheiro de firmware na Mentor Embedded (uma divis√£o da Mentor Graphics).  Colin Walls frequentemente fala em confer√™ncias e semin√°rios, autor de v√°rios artigos t√©cnicos e dois livros sobre firmware.  Vive no Reino Unido.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Blog</a> profissional <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">de Colin</a> , e-mail: colin_walls@mentor.com. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt425353/">https://habr.com/ru/post/pt425353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt425343/index.html">25 ferramentas √∫teis do Kubernetes: implanta√ß√£o e gerenciamento</a></li>
<li><a href="../pt425345/index.html">Simplifica√ß√£o de nomes: 802.11ax torna-se Wi-Fi 6</a></li>
<li><a href="../pt425347/index.html">Dumping Mask: mito ou realidade</a></li>
<li><a href="../pt425349/index.html">O f√≥rum Positive Hack Days 9 ser√° realizado nos dias 21 e 22 de maio na Crocus Expo</a></li>
<li><a href="../pt425351/index.html">Programadores de bricolage perdem o emprego</a></li>
<li><a href="../pt425355/index.html">Classifica√ß√£o de seguran√ßa do projeto da OIC</a></li>
<li><a href="../pt425357/index.html">Como montamos uma pilha de tecnologia de 12 andares e n√£o enlouquecemos</a></li>
<li><a href="../pt425359/index.html">Os chineses usaram um microchip para controlar computadores americanos</a></li>
<li><a href="../pt425361/index.html">Bloqueio de conte√∫do, extens√£o para navegadores de cromo</a></li>
<li><a href="../pt425363/index.html">Dicas para estudantes programadores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>