<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèº üß° üëÄ Valentinstag-Anwendung auf Libgdx üë©üèª‚Äçüéì üê∂ üåº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jedes Jahr gibt es viele Artikel zum Valentinstag. Ich habe mich auch entschlossen, mich mit diesem Thema zu besch√§ftigen und etwas Originelles und Un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Valentinstag-Anwendung auf Libgdx</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440298/"><p>  Jedes Jahr gibt es viele Artikel zum Valentinstag.  Ich habe mich auch entschlossen, mich mit diesem Thema zu besch√§ftigen und etwas Originelles und Ungew√∂hnliches zu schaffen.  Die Idee war, eine einfache Android-Anwendung mit Herzen zu erstellen, die ihre physischen Modelle haben und miteinander interagieren.  Dann habe ich Text, Sounds, Partikel und einige andere Effekte hinzugef√ºgt.  Die resultierende App funktionierte und war ziemlich originell!  In diesem Artikel werde ich den Erstellungsprozess sowie die Funktionen und Fallstricke der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>libgdx-</strong></a> Bibliothek beschreiben. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/gk/-e/-e/gk-e-e7mizsnpdem8tw41jftqcc.png" alt="Valentinstag Herzen"></a>  . </p><a name="habracut"></a><br><h2 id="contents">  Inhalt </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Programme und Tools</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hallo Welt</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Allgemein</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texturen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schriftarten</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Physik</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Partikelsystem</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klingt</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fazit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode und ausf√ºhrbare Dateien</a> </li></ul><br><h2 id="programs-and-tools">  Programme und Tools </h2><br><p>  Um diese Idee umzusetzen, habe ich die folgenden Programme und Bibliotheken verwendet: </p><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>IntelliJ IDEA</strong></a> - eine IDE f√ºr plattform√ºbergreifende Anwendungen.  Alternativ k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android Studio</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eclipse verwenden</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>libgdx</strong></a> - eine plattform√ºbergreifende Java-Bibliothek (PC, Mac, Linux, Android) zur Entwicklung von Spielen und anderen grafischen Anwendungen.  Diese Bibliothek wird unter der Apache License 2.0 verteilt.  Einige Codefragmente wurden mit JNI optimiert (z. B. Box2d). </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>box2d-editor</strong></a> - ein Editor zum Erstellen physischer Modelle, die in der physischen Engine <code>box2d</code> , die in <code>libgdx</code> .  Hier wird es verwendet, um das Bild des Herzens mit seinem physischen Modell abzugleichen. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>Hiero-Bitmap-Schriftgenerator</strong></a> - ein Programm zum Konvertieren von Vektorschriftarten in Raster (da in <code>libgdx</code> nur Rasterschriftarten unterst√ºtzt werden). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>Partikeleditor</strong></a> - Ein Editor zum Erstellen von Partikelsystemen, der vom Ersteller von <code>libgdx</code> .  Es wird f√ºr Partikel im "Explosionseffekt" w√§hrend der Zerst√∂rung des Herzens verwendet. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><strong>Paint.NET</strong></a> - ein Bildeditor, mit dem das Bild des Herzens bearbeitet und der Hintergrund erstellt wurde. </li></ol><br><p>  Alle diese Programme und Komponenten sind frei verteilt, und dies ist ein gro√ües Plus.  Ich habe <code>libgdx</code> gew√§hlt, weil ich erstens bereits Erfahrung damit habe und zweitens mit <code>libgdx</code> in einem langsamen Android-Emulator keine Notwendigkeit besteht, da es plattform√ºbergreifend ist und das Testen von Anwendungen in einer nativen Java-Umgebung und das anschlie√üende Kompilieren erm√∂glicht sie f√ºr Android. </p><br><h2 id="hello-world">  Hallo Welt </h2><br><p>  Zun√§chst erkl√§re ich Ihnen in wenigen Worten, wie Sie libgdx-Projekte erstellen.  <code>gdx-setup.jar</code> mit <code>gdx-setup.jar</code> eine Projektvorlage (basierend auf Gradle), die Zielplattformen angibt.  Derzeit werden <code>Desktop</code> , <code>Android</code> , <code>Ios</code> , <code>Html</code> unterst√ºtzt.  Um ehrlich zu sein, habe ich die letzten beiden nicht ausprobiert, da ich kein iOS-Ger√§t habe und es einige Probleme mit HTML gibt, die ich noch nicht gel√∂st habe. </p><br><p><img src="https://habrastorage.org/webt/rv/de/yc/rvdeycxp2rfxx7duxqxnwaognva.png" alt="Projektsetup"></p><br><p>  Sie k√∂nnen auch die Erweiterungen ausw√§hlen, die Sie verwenden m√∂chten.  In unserem Fall ist dies die Box2d-Physikbibliothek. </p><br><p>  All dies wird jedoch im Wiki beschrieben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen eines libgdx-Projekts</a> . </p><br><p>  Nach der Generierung werden drei Ordner erstellt: </p><br><ul><li>  Kern </li><li>  Desktop </li><li>  android </li></ul><br><p>  In den letzten beiden werden <code>DesktopLauncher</code> und <code>AndroidLauncher</code> platziert, die folgenderma√üen aussehen: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DesktopLauncher</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] arg)</span></span></span><span class="hljs-function"> </span></span>{ LwjglApplicationConfiguration config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LwjglApplicationConfiguration(); config.width = <span class="hljs-number"><span class="hljs-number">800</span></span>; config.height = <span class="hljs-number"><span class="hljs-number">480</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LwjglApplication(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ValentinesDayHeartsApp(), config); } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidLauncher</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidApplication</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); AndroidApplicationConfiguration config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AndroidApplicationConfiguration(); initialize(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ValentinesDayHeartsApp(), config); } }</code> </pre> <br><p>  Es wird keinen Code mehr speziell f√ºr die Android-Plattform geben, was ein gro√üer Vorteil der ausgew√§hlten Bibliothek ist.  In der Konfiguration von <code>AndroidManifest.xml</code> nur noch Vibrationen zugelassen und der Ruhemodus deaktiviert werden (um zu verhindern, dass der Anwendungsstatus zur√ºckgesetzt wird).  Und stellen Sie auch die Landschaftsausrichtung so ein, dass die Welt nicht auf den Kopf gestellt wird: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.VIBRATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br><p>  und </p><br><pre> <code class="html hljs xml">android:screenOrientation="landscape"</code> </pre> <br><p>  Der allgemeine Code wird im Kernordner gespeichert.  Die Hauptklasse mit dem Namen <code>ValentinesDayHeartsApp</code> implementiert die <code>ApplicationListener</code> Schnittstelle (zur Behandlung von Initialisierungsereignissen, Rendering, Finalisierung und anderen Zust√§nden) und die <code>InputProcessor</code> Schnittstelle (zur Behandlung von Benutzereingaben). </p><br><p>  Das ist alles, das Skelett ist fertig!  Jetzt l√§uft unsere Anwendung sowohl auf dem PC als auch auf Android. </p><br><h2 id="general">  Allgemein </h2><br><p>  Das Projekt hat eine einfache Struktur: In der <code>ValentinesDayHeatsApp</code> Klasse werden die Methoden <code>create</code> , <code>render</code> , <code>touchDown</code> und <code>touchDown</code> √ºberschrieben.  Die Methode <code>create</code> initialisiert alle Ressourcen (Texturen, Schriftarten, Partikel, Sounds) und erstellt die physische Welt.  Bei der Rendermethode werden alle Objekte der Welt gerendert: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ updatePhysics(); updateBackground(); updateSprites(); updateParticles(); refresh(); renderBackground(); renderHearts(); renderFonts(); renderParticles(); }</code> </pre> <br><p>  Bei der <code>dispose</code> werden alle Ressourcen freigegeben.  Ja, ja, trotz der Tatsache, dass Java √ºber eine automatische Speicherbereinigung verf√ºgt, m√ºssen nicht verwaltete Ressourcen (Box2d-Objekte und einige andere) noch manuell freigegeben werden.  Die <code>touchDown</code> Methode wird durch Ber√ºhren oder Klicken ausgel√∂st.  Das funktioniert so: Wenn sich ein Ber√ºhrungspunkt mit einem Herzen schneidet, wird das Herz gel√∂scht.  Andernfalls wird im Ber√ºhrungspunkt ein neues Herz erstellt.  Das <code>Heart</code> Objekt hat die folgenden Eigenschaften: </p><br><ul><li>  <code>Body</code> - ein physikalisches Modell. </li><li>  <code>Sprite</code> - ein grafisches Modell (Sprite). </li><li>  <code>String</code> - Ein Text, der auf dem Herzen angezeigt wird. </li><li>  <code>Font</code> - eine Schriftart. </li><li>  <code>ParticleEffect</code> - Partikel, die beim Zerst√∂ren des Herzens entstehen. </li><li>  <code>BreakSound</code> - ein Ger√§usch der Zerst√∂rung des Herzens. </li></ul><br><p>  Als n√§chstes werde ich die Komponenten der Anwendung detaillierter beschreiben. </p><br><h2 id="textures">  Texturen </h2><br><p>  Zuerst musste ich das Herz finden oder zeichnen.  Gl√ºcklicherweise habe ich es leicht gegoogelt und dann ein wenig bearbeitet: ein Gl√ºhen und einen transparenten Hintergrund hinzugef√ºgt.  Um Texturen in <code>libgdx</code> zu laden, habe ich die <code>Texture</code> Klasse verwendet.  Da dieselbe Textur mehrmals verwendet werden kann, wurden zus√§tzliche <code>Sprite</code> Objekte verwendet.  Sie wurden mit der <code>render</code> gezeichnet.  Die Position des Sprites und der Winkel sind die Parameter des Renderns und das physikalische Modell des Herzens.  Zur Abwechslung habe ich beschlossen, die Herzen in verschiedenen Farben zu zeichnen.  Ich habe die HSL-Palette verwendet, mit der Farbton, S√§ttigung und Aufhellung manipuliert werden k√∂nnen, nicht Farbkomponenten wie RGB.  Die Formel f√ºr die Konvertierung von RGB -&gt; HSL und HSL -&gt; RGB ist leicht zu finden, und ich habe die Methoden aus dem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bearbeiten von Farben in .NET</a> unter Java verwendet.  Alle Konvertierungen erfolgen in den Methoden <code>prepareHeartsTextures</code> , <code>prepareHslData</code> und <code>generateHeartTexture</code> .  Hier ist das Beispiel: </p><br><pre> <code class="java hljs">Pixmap pixmap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Pixmap(fileHandle); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[][][] result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[pixmap.getWidth()][pixmap.getHeight()][<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pixmap.getWidth(); i++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; pixmap.getHeight(); j++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> color = pixmap.getPixel(i, j); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> r = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)((color &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>) / <span class="hljs-number"><span class="hljs-number">255.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> g = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)((color &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>) / <span class="hljs-number"><span class="hljs-number">255.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)((color &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>) / <span class="hljs-number"><span class="hljs-number">255.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> a = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(color &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>) / <span class="hljs-number"><span class="hljs-number">255.0f</span></span>; result[i][j] = ColorUtils.RgbToHsl(r, g, b, a); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result;</code> </pre> <br><p>  Leider startet die Android-App aufgrund der Erzeugung von Texturen mit unterschiedlichen Farbt√∂nen mit einer gewissen Verz√∂gerung. </p><br><h2 id="fonts">  Schriftarten </h2><br><p>  Da <code>libgdx</code> nur mit Raster-Schriftarten arbeiten kann, habe ich den <strong>Hiero Bitmap Font Generator</strong> (Version 5) verwendet, der Bilder aller Zeichen im PNG-Format erstellt, und die FNT-Datei, die Informationen zu den Koordinaten der einzelnen Zeichen im Bild enth√§lt.  Hier ist der Screenshot dieses Programms: </p><br><p><img src="https://habrastorage.org/webt/7j/sr/nd/7jsrnd3l69solhirkhq6yriv8he.png" alt="Bitmap-Schriftart-Tool"></p><br><p>  Nachdem die erforderlichen Dateien generiert wurden, kann die Schriftart in der libgdx-Anwendung wie folgt verwendet werden: </p><br><pre> <code class="java hljs">font = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BitmapFont( Gdx.files.internal(<span class="hljs-string"><span class="hljs-string">"data/Jura-Medium.fnt"</span></span>), Gdx.files.internal(<span class="hljs-string"><span class="hljs-string">"data/Jura-Medium.png"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); font.setColor(Color.WHITE);</code> </pre> <br><p>  Und dann rendern Sie es so: </p><br><pre> <code class="java hljs">font.draw(spriteBatch, heart.String, screenPosition.x, screenPosition.y);</code> </pre> <br><p>  Beim Rendern sind einige Schwierigkeiten aufgetreten: Beispielsweise kann die Schriftart nicht in einem Winkel gerendert werden, wie dies mit einem Sprite m√∂glich ist.  Um dieses Problem zu l√∂sen, m√ºssen Sie die Projektionsmatrix von <code>SpriteBatch</code> und die Schriftart dann wie folgt rendern: </p><br><pre> <code class="java hljs">Matrix4 projection = spriteBatch.getProjectionMatrix(); projection.setToOrtho2D(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, WorldWidth, WorldHeight); projection.translate(tmpVector1.x, tmpVector1.y, <span class="hljs-number"><span class="hljs-number">0</span></span>); projection.rotate(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, body.getAngle() / (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)Math.PI * <span class="hljs-number"><span class="hljs-number">180</span></span>); projection.translate(-tmpVector1.x, -tmpVector1.y, <span class="hljs-number"><span class="hljs-number">0</span></span>); Vector2 stringSize = heart.getStringSize(); tmpVector1.add(heart.Size.x / PhysWorldWidth * WorldWidth * CenterDisplacement.x - stringSize.x * <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, heart.Size.y / PhysWorldHeight * WorldHeight * CenterDisplacement.y + stringSize.y); spriteBatch.begin(); BitmapFont.BitmapFontData fontData = font.getData(); fontData.setScale(heart.Size.x * FontSizeHeartSizeCoef.x, heart.Size.y * FontSizeHeartSizeCoef.y); font.draw(spriteBatch, heart.String, tmpVector1.x, tmpVector1.y); fontData.setScale(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); spriteBatch.end();</code> </pre> <br><h2 id="physics">  Physik </h2><br><p>  Als Physik-Engine wurde <strong>box2d</strong> verwendet. </p><br><p>  Um das Bild des Herzens mit seinem physischen Modell <strong>abzugleichen</strong> , habe ich <strong>box2d-editor verwendet</strong> : </p><br><p><img src="https://habrastorage.org/webt/dp/yc/9r/dpyc9rtyakhh21j38vbtlndnw2a.png" alt="Physik-K√∂rper-Editor">  . </p><br><p>  Mit diesem Programm habe ich ein Polygon des Herzens erstellt, das automatisch in konvexe Polygone zerlegt wurde.  Das physikalische Modell ist ein Satz von Koordinaten dieser Polygone im JSON-Format. </p><br><p>  Au√üerdem wird diese Datei in unserer Anwendung verwendet (das Laden erfolgt in der <code>addHeart</code> Methode).  libgdx kann nur Dateien im Bin√§rformat laden.  Gl√ºcklicherweise wurde die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BodyEditorLoader.java-</a> Klasse gefunden, mit der das Modell auch aus JSON (dh Textdarstellung) geladen werden kann. </p><br><p>  Vergessen Sie nicht, die Dichte, Reibung und Elastizit√§t des K√∂rpers einzustellen: </p><br><pre> <code class="java hljs">FixtureDef fdef = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FixtureDef(); fdef.density = <span class="hljs-number"><span class="hljs-number">0.75f</span></span>; fdef.friction = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; fdef.restitution = <span class="hljs-number"><span class="hljs-number">0.4f</span></span>; bodyLoader.attachFixture(body, <span class="hljs-string"><span class="hljs-string">"Heart"</span></span>, fdef, newWidth); body.resetMassData();</code> </pre> <br><p>  Jetzt haben unsere Herzen eine physische H√ºlle! </p><br><p>  Damit die Herzen nicht vom Bildschirm fliegen, k√∂nnen wir vier statische Rechtecke an den Seiten unserer kleinen Welt hinzuf√ºgen.  Auf Mobilger√§ten ist es ratsam, die Schwerkraft basierend auf der Ger√§teorientierung einzustellen: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Gdx.app.getType() == ApplicationType.Android) { gravity.x = -Gdx.input.getPitch() / <span class="hljs-number"><span class="hljs-number">90.0f</span></span>; gravity.y = Gdx.input.getRoll() / <span class="hljs-number"><span class="hljs-number">90.0f</span></span>; gravity.mul(gravityCoef); world.setGravity(gravity); }</code> </pre> <br><h2 id="particle-system">  Partikelsystem </h2><br><p>  In <code>libgdx</code> wird das Partikelsystem mithilfe spezieller Dateien angegeben, die im Editor generiert werden k√∂nnen: </p><br><p><img src="https://habrastorage.org/webt/wn/au/jk/wnaujkjcqosjvqefms78wcxfiqm.png" alt="Partikeleditor">  . </p><br><p>  Wie Sie sehen k√∂nnen, verf√ºgt dieser Editor √ºber viele Einstellungen: Sie k√∂nnen verschiedene Texturen laden, die Lebensdauer, die Form der Verteilung, die Transparenz und andere Parameter √§ndern.  Ich habe herzf√∂rmige Partikel hergestellt, die erscheinen, wenn Sie auf den Bildschirm tippen und ein gro√ües physisches Herz zerst√∂ren.  In der Anwendung erfolgt das Arbeiten mit Partikeln wie folgt: </p><br><h3 id="initialization">  Initialisierung </h3><br><pre> <code class="java hljs">ParticleEffect effect = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParticleEffect(); effect.load(Gdx.files.internal(<span class="hljs-string"><span class="hljs-string">"data/destroy.p"</span></span>), Gdx.files.internal(<span class="hljs-string"><span class="hljs-string">"data"</span></span>));</code> </pre> <br><h3 id="beginning-of-the-life-cycle">  Beginn des Lebenszyklus </h3><br><p>  Es ist wichtig, den <code>start</code> nicht zu vergessen, ohne den die Partikel nicht angezeigt werden: </p><br><pre> <code class="java hljs">effect.setPosition(.., ..); effect.start();</code> </pre> <br><h2 id="sounds">  Klingt </h2><br><p>  Sounds werden wie folgt geladen: </p><br><pre> <code class="java hljs">sound = Gdx.audio.newSound(Gdx.files.internal(<span class="hljs-string"><span class="hljs-string">"path/to/file"</span></span>));</code> </pre> <br><p>  Und dann werden so gespielt: </p><br><pre> <code class="java hljs">sound.play(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre> <br><p>  Was k√∂nnte einfacher sein?  Es gibt jedoch auch Fallstricke.  Aus irgendeinem Grund k√∂nnen die Dateien nur im OGG-Format und mit einer Bitrate von <strong>96 kbit / s</strong> geladen werden. </p><br><h2 id="conclusion">  Fazit </h2><br><p>  Ich hoffe, dass die in diesem Artikel beschriebenen Techniken vielen von Ihnen bei der Entwicklung von Spielen mit <code>libgdx</code> .  Sie k√∂nnen den Quellcode und die Ressourcen verwenden.  Senden Sie Bewerbungen f√ºr den Valentinstag an Ihre Liebsten :) </p><br><p>  Es ist erw√§hnenswert, dass der auf den Herzen angezeigte Text in der Datei <code>data/words.txt</code> kann.  Es funktioniert auch ohne Neukompilierung. </p><br><h2 id="source-code-and-executables">  Quellcode und ausf√ºhrbare Dateien </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode</a> </li><li>  Plattform√ºbergreifende ausf√ºhrbare JAR-Datei: <a href="">ValentinesDayHearts-1.1.jar</a> </li><li>  APK-Datei f√ºr Android: <a href="">ValentinesDayHearts-1.1.apk</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440298/">https://habr.com/ru/post/de440298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440286/index.html">Perlin-Rauschen, prozedurale Inhaltsgenerierung und interessanter Raum</a></li>
<li><a href="../de440288/index.html">IoT-Sicherheit. Problem 1. Smartwatches, Fitness-Tracker und Waagen</a></li>
<li><a href="../de440292/index.html">Das Buch ‚ÄûEinheit in Aktion. Plattform√ºbergreifende Entwicklung in C #. 2nd int. Ausgabe ¬ª</a></li>
<li><a href="../de440294/index.html">MIDI-Router auf Raspberry Pi</a></li>
<li><a href="../de440296/index.html">6 Anwendungen f√ºr das industrielle IoT</a></li>
<li><a href="../de440300/index.html">10 Konsolenbefehle zur Diskussion von JavaScript-Code wie bei einem PRO</a></li>
<li><a href="../de440302/index.html">CRM - Erfolgskosten, Fehlerkosten, Betriebskosten</a></li>
<li><a href="../de440304/index.html">Interrupts von externen Ger√§ten in einem x86-System. Teil 3. Konfigurieren des Interrupt-Routings im Chipsatz anhand des Coreboot-Beispiels</a></li>
<li><a href="../de440306/index.html">Datenbankskalierung in hoch belasteten Systemen</a></li>
<li><a href="../de440308/index.html">Teilen und erobern oder langsam schreiben - schnell lesen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>