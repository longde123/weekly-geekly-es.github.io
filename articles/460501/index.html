<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§õüèΩ üóÉÔ∏è üôáüèΩ Ejemplo de implementaci√≥n de integraci√≥n continua con BuildBot ü§∞üèª ü§õüèæ üìÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(Imagen de Computerizer de Pixabay) 
 
 Hola 

 Mi nombre es Evgeny Cherkin , soy el programador del equipo de desarrollo de la empresa minera Polymet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ejemplo de implementaci√≥n de integraci√≥n continua con BuildBot</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460501/"><img src="https://habrastorage.org/webt/jj/-4/-g/jj-4-gindpovkdi6rbmzxax4yqu.jpeg" alt="Configuraci√≥n de prueba de BuildBot"><br>  <i>(Imagen de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Computerizer</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pixabay)</a></i> <i><br></i> <br>  Hola <br><br>  Mi nombre es <b>Evgeny Cherkin</b> , soy el programador del equipo de desarrollo de la empresa minera <b>Polymetal</b> . <br><br>  Al comenzar cualquier proyecto importante, comienza a pensar: "¬øQu√© software es mejor usar para su mantenimiento?".  Un proyecto de TI antes del lanzamiento de la pr√≥xima versi√≥n pasa por una serie de etapas.  Es bueno cuando la cadena de estos pasos est√° automatizada.  El proceso automatizado de lanzamiento de una nueva versi√≥n de un proyecto de TI se llama <i>Integraci√≥n continua</i> .  <b>BuildBot</b> result√≥ ser un buen ayudante para nosotros, implementando este proceso. <br><br>  En este art√≠culo, decid√≠ proporcionar una descripci√≥n general de las caracter√≠sticas de <b>BuildBot</b> .  ¬øDe qu√© es capaz este software?  ¬øC√≥mo acercarse a √©l y c√≥mo construir una RELACI√ìN DE TRABAJO EFECTIVA normal con √©l?  Tambi√©n puede aplicar nuestra experiencia a usted mismo creando en su m√°quina un servicio de trabajo para ensamblar y probar su proyecto. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Contenido</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td colspan="4" align="center"><h3>  Contenido </h3></td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">1. ¬øPor qu√© es BuildBot?</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2. Concepto liderado por BuildMaster</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">3. Instalaci√≥n</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">4. Primeros pasos</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5. Configuraci√≥n.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Receta paso a paso</a> </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.1 BuildmasterConfig</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.2 trabajadores</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.3 change_source</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.4 shedulers</a> </td></tr><tr><td colspan="2" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.5 BuildFactory</a> </td><td colspan="2" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.6 constructores</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6. Ejemplo de configuraci√≥n propia</a> </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6.1 En el camino a tu master.cfg</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6.2 Trabajar con svn</a> </td><td colspan="2">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6.3 Una carta para usted: los periodistas est√°n autorizados a declarar</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lo hicimos!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mis felicitaciones</a> </td></tr></tbody></table></div><br></div></div><br><a name="Why"></a><h3>  1. ¬øPor qu√© es BuildBot? </h3><hr><br>  Anteriormente en habr-e, me encontr√© con art√≠culos sobre la implementaci√≥n de la <i>integraci√≥n continua</i> usando <b>BuildBot</b> .  Por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> me pareci√≥ el m√°s informativo.  Hay otro ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√°s simple</a> .  Estos art√≠culos pueden ser sazonados con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un ejemplo del manual</a> , y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto es</a> despu√©s, en ingl√©s.  El coup√© es un buen punto de partida.  Despu√©s de leer estos art√≠culos, probablemente querr√° hacer algo en <b>BuildBot de inmediato</b> . <br><br>  Basta!  ¬øAlguien lo us√≥ en sus proyectos?  Resulta que s√≠, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muchos lo han</a> aplicado en sus tareas.  Puede encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ejemplos de</a> uso de <b>BuildBot</b> en los archivos de c√≥digo de Google. <br><br>  Entonces, ¬øcu√°l es la l√≥gica de las personas que usan <b>buildbot</b> ?  Despu√©s de todo, hay otras herramientas: <b>CruiseControl</b> y <b>Jenkins</b> .  Contestar√© de esta manera.  Para la mayor√≠a de las tareas, <b>Jenkins</b> realmente ser√° suficiente.  <b>BuildBot</b> , a su vez, es m√°s adaptable y las tareas all√≠ se resuelven tan f√°cilmente como en <b>Jenkins</b> .  El√≠gete a ti.  Pero como estamos buscando una herramienta para un proyecto objetivo en desarrollo, ¬øpor qu√© no elegir la que nos permite, a partir de simples pasos, obtener un sistema de compilaci√≥n que tenga interactividad y una interfaz √∫nica? <br><br>  Para aquellos cuyo proyecto objetivo est√° escrito en python, surge la pregunta: "¬øPor qu√© no elegir un sistema de integraci√≥n que tenga una interfaz clara en t√©rminos del lenguaje utilizado en el proyecto?".  Y luego es hora de presentar los beneficios de <b>BuildBot</b> . <br><blockquote>  Entonces, nuestro "cuarteto instrumental".  Para m√≠, <b>defin√≠</b> las cuatro caracter√≠sticas de <b>BuildBot</b> : <br><ol><li>  Este es un marco de c√≥digo abierto bajo la GPL </li><li>  Esto utiliza Python como herramienta de configuraci√≥n y describe las acciones requeridas. </li><li>  Esta es una oportunidad para recibir una respuesta de la m√°quina en la que se realiza el montaje. </li><li>  Estos son finalmente los requisitos m√≠nimos para el Host.  La implementaci√≥n requiere Python y Twisted, y no se requiere una m√°quina virtual o Java. </li></ol><br></blockquote><a name="Concepts"></a><h3>  2. Concepto liderado por BuildMaster </h3><hr><br><img src="https://habrastorage.org/webt/so/qs/u1/soqsu1skae_0xuktzdemfv-n3yq.png" alt="BuildBot BuildMaster"><br><br>  El centro de la arquitectura de distribuci√≥n de tareas es <b>BuildMaster</b> .  Es un servicio que: <br><br><ul><li>  <b>realiza un seguimiento de los</b> cambios en el √°rbol fuente del proyecto </li><li>  <b>env√≠a los</b> comandos que el servicio Worker deber√≠a ejecutar para construir un proyecto y probarlo </li><li>  <b>notifica a los</b> usuarios los resultados de las acciones tomadas </li></ul><br>  <b>BuildMaster se</b> configura a trav√©s del archivo <i>master.cfg</i> .  Este archivo est√° en la ra√≠z de <b>BuildMaster</b> .  M√°s adelante mostrar√© c√≥mo se crea esta ra√≠z.  El archivo <i>master.cfg en s√≠</i> contiene python, un script que usa llamadas <b>BuildBot</b> . <br><br>  El siguiente <b>BuildBot</b> m√°s importante se llama <b>Worker</b> .  Este servicio se puede ejecutar en un host diferente con un sistema operativo diferente, o tal vez en donde <b>est√° BuildMaster</b> .  Tambi√©n puede existir en un entorno virtual especialmente preparado con sus propios paquetes y variables.  Estos entornos virtuales se pueden preparar utilizando utilidades de python como <i>vertualenv, venv</i> . <br><br>  <b>BuildMaster</b> transmite comandos a cada <b>trabajador</b> , que, a su vez, los ejecuta.  Es decir, resulta que el proceso de compilaci√≥n y prueba del proyecto puede ir al <b>Trabajador</b> en Windows y en otro Trabajador en Linux. <br><br>  <i>El pago</i> del c√≥digo fuente del proyecto ocurre en cada <b>trabajador</b> . <br><br><a name="Install"></a><h3>  3. Instalaci√≥n </h3><hr><br>  Entonces vamos.  Usar√© Ubuntu 18.04 como el host.  En √©l <b>colocar√©</b> un <b>BuildMaster</b> -a y un <b>Worker</b> -a.  Pero primero necesitar√° instalar python3.7: <br><br><pre><code class="bash hljs">sudo apt-get update sudo apt-get install python3.7</code> </pre> <br>  Para aquellos que necesitan python3.7.2 en lugar de 3.7.1, pueden hacer lo siguiente: <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get software-properties-common sudo add-apt-repository ppa:deadsnakes/ppa sudo apt-get install python3.7 sudo ln -fs /usr/bin/python3.7 /usr/bin/python3 pip3 install --upgrade pip</code> </pre><br>  El siguiente paso es instalar <i>Twited</i> y <b>BuildBot</b> , as√≠ como paquetes que permitan la funcionalidad adicional <b>BuildBot</b> -a. <br><br><pre> <code class="bash hljs">/*   sudo        /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib/python3.7/dist-packages*/ <span class="hljs-comment"><span class="hljs-comment">#     Worker- sudo pip install twisted # twisted sudo pip install buildbot #BuildMaster #  pip install pysqlite3 #  sqllite    pip install jinja2 #framework  django,  web     pip install autobahn #Web c   BuildMaster-&gt;Worker pip install sqlalchemy sqlalchemy-migrate #     # Web  BuildBot-a pip install buildbot-www buildbot-grid-view buildbot-console-view buildbot-waterfall-view pip install python-dateutil #   web #         pip install buildbot-worker #Worker #  sudo pip install virtualenv # </span></span></code> </pre><br><a name="master"></a><h3>  4. Primeros pasos </h3><hr><br>  Es hora de crear un <b>BuildMaster</b> .  Lo tendremos en la carpeta <i>/ home / habr / master</i> . <br><pre> <code class="bash hljs">mkdir master buildbot create-master master <span class="hljs-comment"><span class="hljs-comment">#    </span></span></code> </pre> <br><a name="createworker"></a>  El proximo paso.  Crea un <b>trabajador</b> .  Lo tendremos en la carpeta <i>/ home / habr / worker</i> . <br><pre> <code class="bash hljs">mkdir worker buildbot-worker create-worker --<span class="hljs-built_in"><span class="hljs-built_in">umask</span></span>=0o22 --keepalive=60 worker localhost:4000 yourWorkerName password</code> </pre><br>  Cuando inicia <b>Worker</b> , de manera predeterminada crear√° una carpeta en <i>/ home / habr / worker</i> con el nombre del proyecto, que se especifica en <i>master.cfg</i> .  Y en la carpeta con el nombre del proyecto, crear√° el directorio de <i>compilaci√≥n</i> y luego se realizar√° el <i>pago</i> .  El directorio de trabajo para <b>Worker</b> ser√° el directorio <i>/ home / habr / yourProject / build</i> . <br><br>  <b>Llave de oro</b> <br>  Y ahora, para lo que escrib√≠ en el p√°rrafo anterior: el script que <b>Master</b> requerir√° que <b>Worker</b> haga de forma remota en este directorio no se ejecutar√°, ya que el script no tiene permiso para ejecutarse.  Para solucionar la situaci√≥n, necesitas una llave <a name="umask"></a>  <i>--umask = 0o22</i> , que impone una prohibici√≥n de escritura en este directorio, pero deja derechos de inicio.  Y solo necesitamos esto. <br><br>  <b>BuildMaster</b> y <b>Worker</b> establecen una conexi√≥n entre ellos.  Sucede que se interrumpe y <b>Worker</b> espera una respuesta de <b>BuildMaster</b> por alg√∫n tiempo.  Si no se recibe respuesta, la conexi√≥n se reinicia.  La clave <b>--keepalive = 60</b> es justo lo que necesita para indicar el tiempo despu√©s del cual se reinicia la <i>conexi√≥n</i> . <br><br><a name="Recept"></a><h3>  5. Configuraci√≥n.  Receta paso a paso </h3><hr><br>  <b>La</b> configuraci√≥n de <b>BuildMaster</b> se realiza en el lado de la m√°quina, donde <b>ejecutamos el</b> comando <i>create-master</i> .  En nuestro caso, este es el directorio <i>/ home / habr / master</i> .  El archivo de configuraci√≥n <i>master.cfg</i> a√∫n no existe, pero el comando en s√≠ ya ha creado el archivo <i>master.cmg.sample</i> .  <i>Debe</i> cambiarle el nombre en <i>master.cfg.sample</i> a <i>master.cfg</i> <br><pre> <code class="bash hljs">mv master.cfg.sample master.cfg</code> </pre> <br>  <i>Abramos</i> este <i>master.cfg</i> .  Y analizaremos en qu√© consiste.  Y despu√©s de eso intentaremos crear nuestro propio archivo de configuraci√≥n. <br><br><div class="spoiler">  <b class="spoiler_title">master.cfg</b> <div class="spoiler_text"><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>].append(changes.GitPoller( <span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'gitpoller-workdir'</span></span>, branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>, pollInterval=<span class="hljs-number"><span class="hljs-number">300</span></span>)) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"all"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>), treeStableTimer=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.ForceScheduler( name=<span class="hljs-string"><span class="hljs-string">"force"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) factory = util.BuildFactory() factory.addStep(steps.Git(repourl=<span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'incremental'</span></span>)) factory.addStep(steps.ShellCommand(command=[<span class="hljs-string"><span class="hljs-string">"trial"</span></span>, <span class="hljs-string"><span class="hljs-string">"hello"</span></span>], env={<span class="hljs-string"><span class="hljs-string">"PYTHONPATH"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span>})) c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append( util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>], factory=factory)) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'title'</span></span>] = <span class="hljs-string"><span class="hljs-string">"Hello World CI"</span></span> c[<span class="hljs-string"><span class="hljs-string">'titleURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"https://buildbot.github.io/hello-world/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'buildbotURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://localhost:8010/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'www'</span></span>] = dict(port=<span class="hljs-number"><span class="hljs-number">8010</span></span>, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c[<span class="hljs-string"><span class="hljs-string">'db'</span></span>] = { <span class="hljs-string"><span class="hljs-string">'db_url'</span></span> : <span class="hljs-string"><span class="hljs-string">"sqlite:///state.sqlite"</span></span>, }</code> </pre><br></div></div><br><a name="BC"></a><h4>  <u>5.1 BuildmasterConfig</u> </h4><br><pre> <code class="python hljs">c = BuildmasterConfig = {}</code> </pre> <br>  <i>BuildmasterConfig</i> : el diccionario b√°sico del archivo de configuraci√≥n.  Debe estar involucrado en el archivo de configuraci√≥n.  Para facilitar su uso, su alias <i>"c"</i> se ingresa en el c√≥digo de configuraci√≥n.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los</a> nombres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clave</a> en <i>c ["keyFromDist"]</i> son elementos fijos para interactuar con <b>BuildMaster</b> .  Debajo de cada clave, el objeto correspondiente se sustituye como un valor. <br><br><a name="Worker"></a><h4>  <u>5.2 trabajadores</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'workers'</span></span>] = [worker.Worker(<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>, <span class="hljs-string"><span class="hljs-string">"pass"</span></span>)]</code> </pre> <br>  Esta vez se√±alamos la lista de <b>trabajadores</b> de <b>BuildMaster</b> .  Creamos <b>Worker</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">arriba</a> especificando <i>su nombre de trabajador</i> y <i>contrase√±a</i> .  Ahora deben especificarse en lugar de <i>ejemplo-trabajador</i> y <i>pasar</i> . <br><br><a name="CS"></a><h4>  <u>5.3 change_source</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>].append(changes.GitPoller( <span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'gitpoller-workdir'</span></span>, branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>, pollInterval=<span class="hljs-number"><span class="hljs-number">300</span></span>))</code> </pre><br>  <i>Usando la</i> clave <i>change_source</i> del diccionario <i>c</i> , tenemos acceso a la lista donde desea colocar el objeto que sondea el repositorio con el c√≥digo fuente del proyecto.  El ejemplo utiliza el repositorio de Git, que se sondea con cierta periodicidad. <br><br>  El primer argumento es el camino a su repositorio. <br><br>  <i>workdir</i> es la ruta a la carpeta donde, en el lado del <b>trabajador</b> , en relaci√≥n con la ruta <i>/ home / habr / worker / yourProject / build,</i> git almacenar√° la versi√≥n local del repositorio. <br><br>  <i>La rama</i> contiene una rama espec√≠fica en el repositorio que debe ser monitoreada. <br><br>  <i>pollInterval</i> contiene el n√∫mero de segundos despu√©s de los cuales <b>BuildMaster sondear√°</b> los cambios en el repositorio. <br><br>  Existen varios m√©todos para rastrear los cambios en un repositorio de proyectos. <br><br>  El m√©todo m√°s f√°cil es el <i>sondeo</i> , lo que implica que <b>BuildMaster</b> sondea peri√≥dicamente el servidor con el repositorio.  Si <i>commit</i> refleja los cambios en el repositorio, <b>BuildMaster</b> con cierto retraso crear√° un objeto de <i>cambio</i> interno y lo enviar√° al controlador de eventos del <i>Programador</i> , que comenzar√° los pasos para compilar y probar el proyecto en <i>Worker</i> .  Entre estos pasos, se indicar√° la <i>actualizaci√≥n del</i> repositorio.  Es en <b>Worker donde</b> se crear√° una copia local del repositorio.  Los detalles de este proceso se divulgar√°n a continuaci√≥n en las siguientes dos secciones <b>( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.4</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5.5</a> )</b> . <br><br>  Un m√©todo a√∫n m√°s elegante para rastrear los cambios en el repositorio es enviar mensajes directamente desde el servidor en el que est√° ubicado a <b>BuildMaster</b> para cambiar los c√≥digos fuente del proyecto.  En este caso, tan pronto como el desarrollador realice una <i>confirmaci√≥n</i> , el servidor con el repositorio del proyecto enviar√° un mensaje a <b>BuildMaster</b> .  Y eso, a su vez, ser√° interceptado creando un objeto <i>PBChangeSource</i> .  Adem√°s, este objeto se transferir√° al <i>Programador</i> , que activa los pasos para el ensamblaje del proyecto y su prueba.  Una parte importante de este m√©todo es trabajar con scripts de <i>enlace de</i> servidor en el repositorio.  En el script de <b>enlace</b> responsable de manejar las acciones durante la <i>confirmaci√≥n</i> , debe llamar a la utilidad <i>sendchange</i> y especificar la direcci√≥n de red de <b>BuildMaster</b> .  Debe <i>especificar el</i> puerto de red que escuchar√° <i>PBChangeSource</i> .  <i>PBChangeSource</i> , por cierto, es parte de <b>BuildMaster</b> .  Este m√©todo requerir√° privilegios de <i>administrador</i> -a en el servidor donde se encuentra el repositorio del proyecto.  Primero necesitas hacer un repositorio de respaldo. <br><br><a name="shedulers"></a><h4>  <u>5.4 shedulers</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"all"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>), treeStableTimer=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.ForceScheduler( name=<span class="hljs-string"><span class="hljs-string">"force"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>]))</code> </pre><br>  <i>Los planificadores</i> son un elemento que act√∫a como un disparador que ejecuta toda la cadena de ensamblaje y prueba de un proyecto. <br><img src="https://habrastorage.org/webt/sh/1j/jo/sh1jjoo3rog47fsyjgqgorizyfs.png" alt="Buildbot shedulers"><br><br>  Esos cambios que fueron registrados por <i>change_source</i> se convirtieron durante la operaci√≥n de <b>BuildBot</b> -a en el objeto <i>Change</i> y ahora cada <i>Sheduler</i> basado en ellos crea solicitudes para comenzar el proceso de construcci√≥n del proyecto.  Sin embargo, tambi√©n determina cu√°ndo enviar estas solicitudes a la cola.  Objeto <a name="builder"></a>  <i>Builder</i> mantiene una cola de solicitudes y monitorea el estado del ensamblaje actual en un <b>Worker</b> -e separado.  <i>El</i> <b>generador</b> existe <b>tanto en BuildMaster</b> -e como en <b>Worker</b> -e.  Env√≠a una <i>compilaci√≥n</i> espec√≠fica de <b>BuildMaster</b> a <b>Worker</b> , una serie de pasos que deben seguirse. <br>  Vemos que en el ejemplo actual de tales <i>programadores</i> , se crean 2 piezas.  Adem√°s, cada uno tiene su propio tipo. <br><br>  <i>SingleBranchScheduler</i> es una de las clases de programaci√≥n m√°s populares.  Monitorea una rama y se activa por un cambio registrado en ella.  Cuando ve los cambios, puede posponer el env√≠o de una solicitud de construcci√≥n (posponer para el per√≠odo especificado en el par√°metro especial <i>treeStableTimer</i> ).  El <i>nombre</i> especifica el nombre de la programaci√≥n que se mostrar√° en la interfaz <b>BuildBot</b> -web.  Se establece un <i>filtro</i> en <i>ChangeFilter</i> , despu√©s de pasar por qu√© cambios en la rama solicitan la programaci√≥n para enviar una solicitud de compilaci√≥n.  El nombre <i>constructor</i> -a se especifica en <i>builderNames</i> , que especificaremos un poco m√°s adelante.  El nombre en nuestro caso ser√° el mismo que el nombre del proyecto: <i>yourProject</i> . <br><br>  <i>ForceScheduler es una</i> cosa muy simple.  Este tipo de programaci√≥n se activa con un clic del mouse a trav√©s de la interfaz <b>BuildBot</b> -web.  Los par√°metros tienen la misma esencia que en <i>SingleBranchScheduler</i> . <br><br>  <b>PS No. 3.</b>  <b>De repente es √∫til</b> <br>  <i>Peri√≥dico</i> es un cronograma que se activa a una frecuencia espec√≠fica de tiempo fijo.  Parece una llamada como esta <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> schedulers nightly = schedulers.Periodic(name=<span class="hljs-string"><span class="hljs-string">"daily"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"full-solaris"</span></span>], periodicBuildTimer=<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [nightly]</code> </pre><br><a name="buildfactory"></a><h4>  <u>5.5 BuildFactory</u> </h4><br><pre> <code class="python hljs">factory = util.BuildFactory() factory.addStep(steps.Git(repourl=<span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'incremental'</span></span>)) factory.addStep(steps.ShellCommand(command=[<span class="hljs-string"><span class="hljs-string">"trial"</span></span>, <span class="hljs-string"><span class="hljs-string">"hello"</span></span>], env={<span class="hljs-string"><span class="hljs-string">"PYTHONPATH"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span>}))</code> </pre><br>  <i>periodicBuildTimer</i> establece el tiempo de esta periodicidad en segundos. <br><br>  <i>BuildFactory</i> crea una <i>construcci√≥n</i> concreta, que el <i>constructor</i> luego env√≠a al <b>Trabajador</b> .  <i>BuildFactory</i> indica los pasos que debe seguir un <b>trabajador</b> .  Los pasos se agregan llamando al m√©todo <i>addStep.</i> <i><br></i> <br><br>  El primer paso agregado en este ejemplo es <i>git clean -d -f -f ‚Äìx</i> , luego <i>git checkout</i> .  Estas acciones est√°n integradas en el par√°metro del <i>m√©todo</i> , que no se indica claramente, pero implica el valor predeterminado de <i>fresh</i> .  El par√°metro <i>mode = 'incremental'</i> indica que los archivos del directorio donde se realiza el <i>chechout</i> , aunque faltan en el repositorio, permanecen intactos. <br><br>  El segundo paso agregado es llamar al script de <i>prueba</i> con el par√°metro <i>hello</i> en el lado <b>Worker</b> desde el directorio <i>/ home / habr / worker / yourProject / build</i> con la variable de entorno PATHONPATH = ... Para que pueda escribir sus propios scripts y ejecutarlos en el lado <b>Worker</b> -a a trav√©s del paso <i>util.ShellCommand</i> .  Estas secuencias de comandos se pueden colocar directamente en el repositorio.  Luego, durante el <i>chechout</i> , ir√°n a <i>/ home / habr / worker / yourProject / build</i> .  Sin embargo, hay dos "peros": <br><ol><li>  <b>El trabajador</b> debe crearse con el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>modificador --umask</i></a> para que no bloquee los derechos de ejecuci√≥n despu√©s del <i>pago</i> -a. </li><li>  Cuando <i>git empuja</i> estos scripts, es necesario especificar la propiedad <i>ejecutable</i> , de modo que con <i>chechout</i> -e Git no pierda el derecho de ejecutar el script. </li></ol><br><br><a name="builders"></a><h4>  <u>5.6 constructores</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append(util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>], factory=factory))</code> </pre><br>  Sobre lo que <i>Builder</i> fue descrito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .  Ahora hablar√© con m√°s detalle sobre c√≥mo crearlo.  <i>BuilderConfig</i> es un constructor de <i>constructores</i> .  Puede especificar varios constructores de este tipo en <i>c ['constructores']</i> , ya que esta es una lista de objetos de tipo <i>constructor</i> .  Ahora reescribiremos ligeramente el ejemplo de <b>BuildBot</b> , acerc√°ndolo a nuestra tarea. <br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append(util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"yourWorkerName"</span></span>], factory=factory))</code> </pre><br>  Ahora contar√© sobre los par√°metros <i>BuilderConfig</i> . <br><br>  <i>nombre</i> establece el <i>generador de</i> nombres -a.  Aqu√≠ lo llamamos <i>yourProject</i> .  Esto significa que en el <b>Worker se</b> <i>crear√°</i> esta ruta <i>/ home / habr / worker / yourProject / build</i> .  <i>Sheduler</i> busca un <i>constructor</i> con ese nombre. <br><br>  <i>nombres</i> de <b>trabajadores</b> contiene una lista de <b>trabajadores</b> .  Cada uno de los cuales debe agregarse a <i>c ['trabajadores']</i> . <br><br>  <i>factory</i> es la <i>compilaci√≥n</i> espec√≠fica con la que <i>est√°</i> asociado el <i>constructor</i> .  Enviar√° un objeto de <i>compilaci√≥n</i> a <b>Worker</b> para completar todos los pasos que componen esta <i>compilaci√≥n</i> -a. <br><br><a name="myconfig"></a><h3>  6. Ejemplo de configuraci√≥n propia </h3><hr><br>  Aqu√≠ est√° la arquitectura de un proyecto de muestra que propongo implementar a trav√©s de <b>BuildBot</b> <b><br></b>  . <br><br>  Usaremos <i>svn</i> como sistema de control de versiones.  El repositorio en s√≠ estar√° en una determinada nube.  Aqu√≠ est√° la direcci√≥n de esta nube <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">svn.host/svn/yourProject/trunk</a></i> .  En la nube debajo de <i>svn</i> hay un nombre de <i>usuario</i> : <i>usuario</i> , <i>contrase√±a</i> : cuenta de <i>contrase√±a</i> .  Las secuencias de comandos que son los pasos <i>build</i> -a tambi√©n se <i>ubicar√°n</i> en la rama <i>svn</i> , en una <i>carpeta buildbot / worker_linux</i> separada.  Estas secuencias de comandos est√°n en el repositorio con la propiedad <i>ejecutable</i> guardada. <br><br>  <b>BuildMaster</b> y <b>Worker</b> trabajan en el mismo host <i>project.host</i> .  <b>BuildMaster</b> almacena sus archivos en la carpeta <i>/ home / habr / master</i> .  <b>El trabajador</b> almacena la siguiente ruta <i>/ hogar / habr / trabajador</i> .  La comunicaci√≥n entre los procesos <b>BuildMaster</b> y <b>Worker</b> se <b>realiza a</b> trav√©s del puerto 4000 utilizando el protocolo <b>BuildBot</b> -a, es decir, el protocolo <i>'pb'</i> . <br><br>  El proyecto de destino est√° completamente escrito en python.  La tarea es rastrear sus cambios, crear un archivo ejecutable, generar documentaci√≥n, realizar pruebas.  En caso de falla, todos los desarrolladores deben enviar un mensaje al correo de que hay una acci√≥n fallida. <br><br>  Conectaremos el <b>mapeo</b> web <b>BuildBot</b> al puerto 80 para <i>project.host</i> .  Apatch es opcional.  La biblioteca <i>retorcida</i> ya tiene un servidor web, <b>BuildBot lo</b> usa. <br><br>  <b>Usaremos</b> <i>sqlite</i> para almacenar informaci√≥n interna para <b>BuildBot</b> . <br><br>  Para enviar por correo, necesita el host <i>smtp.your.domain</i> , que permite enviar correos electr√≥nicos desde <i>projectHost@your.domain</i> sin autenticaci√≥n.  Tambi√©n en el host ' <i>smtp</i> ' se escucha el protocolo en 1025. <br><br>  Hay dos personas involucradas en el proceso: <i>administrador</i> y <i>usuario</i> .  admin administra <b>BuildBot</b> .  usuario es la persona que comete el <i>compromiso</i> . <br><br>  Se genera un archivo <i>ejecutable a</i> trav√©s de <i>pyinstaller</i> .  La documentaci√≥n se genera a trav√©s de <i>doxygen</i> . <br><br>  Para esta arquitectura, escrib√≠ este <i>master.cfg</i> : <br><br><div class="spoiler">  <b class="spoiler_title">master.cfg</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, re <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> steps, util, schedulers, worker, changes, reporters c= BuildmasterConfig ={} c[<span class="hljs-string"><span class="hljs-string">'workers'</span></span>] = [ worker.Worker(<span class="hljs-string"><span class="hljs-string">'yourWorkerName'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span>) ] c[<span class="hljs-string"><span class="hljs-string">'protocols'</span></span>] = {<span class="hljs-string"><span class="hljs-string">'pb'</span></span>: {<span class="hljs-string"><span class="hljs-string">'port'</span></span>: <span class="hljs-number"><span class="hljs-number">4000</span></span>}} svn_poller = changes.SVNPoller(repourl=<span class="hljs-string"><span class="hljs-string">"https://svn.host/svn/yourProject/trunk"</span></span>, svnuser=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, svnpasswd=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, pollinterval=<span class="hljs-number"><span class="hljs-number">60</span></span>, split_file=util.svn.split_file_alwaystrunk ) c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = svn_poller hourlyscheduler = schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"your-project-schedulers"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), builderNames=[<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>], properties = {<span class="hljs-string"><span class="hljs-string">'owner'</span></span>: <span class="hljs-string"><span class="hljs-string">'admin'</span></span>} ) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [hourlyscheduler] checkout = steps.SVN(repourl=<span class="hljs-string"><span class="hljs-string">'https://svn.host/svn/yourProject/trunk'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, method=<span class="hljs-string"><span class="hljs-string">'fresh'</span></span>, username=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, password=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, haltOnFailure=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) projectHost_build = util.BuildFactory() cleanProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Clean"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/pyinstaller_project"</span></span>, <span class="hljs-string"><span class="hljs-string">"clean"</span></span>] ) buildProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Build"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/pyinstaller_project"</span></span>, <span class="hljs-string"><span class="hljs-string">"build"</span></span>] ) doxyProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Update Docs"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/gendoc"</span></span>, []] ) testProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Tests"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"python"</span></span>,<span class="hljs-string"><span class="hljs-string">"tests/utest.py"</span></span>], env={<span class="hljs-string"><span class="hljs-string">'PYTHONPATH'</span></span>: <span class="hljs-string"><span class="hljs-string">'.'</span></span>} ) projectHost_build.addStep(checkout) projectHost_build.addStep(cleanProject) projectHost_build.addStep(buildProject) projectHost_build.addStep(doxyProject) projectHost_build.addStep(testProject) c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [ util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>, workername=<span class="hljs-string"><span class="hljs-string">'yourWorkerName'</span></span>, factory=projectHost_build) ] template_html=<span class="hljs-string"><span class="hljs-string">u'''\ &lt;h4&gt;  : {{ summary }}&lt;/h4&gt; &lt;p&gt;   : {{ workername }}&lt;/p&gt; &lt;p&gt;: {{ projects }}&lt;/p&gt; &lt;p&gt;         : {{ buildbot_url }}&lt;/p&gt; &lt;p&gt;         : {{ build_url }}&lt;/p&gt; &lt;p&gt; WinSCP     c ip:xxx.xx.xxx.xx.   habr/password,   executable    ~/worker/yourProject/build/dist.&lt;/p&gt; &lt;p&gt;&lt;b&gt;    Buildbot&lt;/b&gt;&lt;/p&gt; '''</span></span> sendMessageToAll = reporters.MailNotifier(fromaddr=<span class="hljs-string"><span class="hljs-string">"projectHost@your.domain"</span></span>, sendToInterestedUsers=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, lookup=<span class="hljs-string"><span class="hljs-string">"your.domain"</span></span>, relayhost=<span class="hljs-string"><span class="hljs-string">"smtp.your.domain"</span></span>, smtpPort=<span class="hljs-number"><span class="hljs-number">1025</span></span>, mode=<span class="hljs-string"><span class="hljs-string">"warnings"</span></span>, extraRecipients=[<span class="hljs-string"><span class="hljs-string">'user@your.domain'</span></span>], messageFormatter=reporters.MessageFormatter( template=template_html, template_type=<span class="hljs-string"><span class="hljs-string">'html'</span></span>, wantProperties=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, wantSteps=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [sendMessageToAll] c[<span class="hljs-string"><span class="hljs-string">'title'</span></span>] = <span class="hljs-string"><span class="hljs-string">"The process of bulding"</span></span> c[<span class="hljs-string"><span class="hljs-string">'titleURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://project.host:80/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'buildbotURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://project.host"</span></span> c[<span class="hljs-string"><span class="hljs-string">'www'</span></span>] = dict(port=<span class="hljs-number"><span class="hljs-number">80</span></span>, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c[<span class="hljs-string"><span class="hljs-string">'db'</span></span>] = { <span class="hljs-string"><span class="hljs-string">'db_url'</span></span> : <span class="hljs-string"><span class="hljs-string">"sqlite:///state.sqlite"</span></span> }</code> </pre><br></div></div><br>  Primero necesitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">crear</a> <b>BuildMaster</b> y <b>Worker</b> -a.  Luego pegue este archivo <i>master.cfg</i> en <i>/ home / habr / master</i> . <br><br>  El siguiente paso es iniciar el servicio <b>BuildMaster</b> <br><pre> <code class="bash hljs">sudo buildbot start /home/habr/master</code> </pre><br>  Luego inicie el <b>trabajador</b> -un servicio <br><pre> <code class="bash hljs">buildbot-worker start /home/habr/worker</code> </pre><br>  Hecho  Ahora <b>Buildbot</b> har√° un seguimiento de los cambios y se <b>ejecutar√°</b> en <i>commit</i> en <i>svn</i> , siguiendo los pasos de <b>compilaci√≥n</b> y prueba del proyecto con la arquitectura anterior. <br><br>  A continuaci√≥n, describir√© algunas caracter√≠sticas del <i>master.cfg</i> anterior <i>.</i> <i><br></i> <br><br><a name="fails"></a><h4>  <u>6.1 En el camino a tu master.cfg</u> </h4><br>  Mientras escribe su <i>master.cfg, se cometer√°n</i> muchos errores, por lo que deber√° leer el archivo de registro.  Se almacena tanto en la <b>ruta</b> absoluta <b>BuildMaster</b> -ec <i>/home/habr/master/twistd.log</i> como en el lado <b>Worker</b> -a con la ruta absoluta <i>/home/habr/worker/twistd.log</i> .  A medida que lea el error y lo corrija, deber√° reiniciar el servicio <b>BuildMaster</b> -a.  Aqu√≠ se explica c√≥mo hacerlo: <br><pre> <code class="bash hljs">sudo buildbot stop /home/habr/master sudo buildbot upgrade-master /home/habr/master sudo buildbot start /home/habr/master</code> </pre><br><a name="svn"></a><h4>  <u>6.2 Trabajar con svn</u> </h4><br><pre> <code class="python hljs">svn_poller = changes.SVNPoller(repourl=<span class="hljs-string"><span class="hljs-string">"https://svn.host/svn/yourProject/trunk"</span></span>, svnuser=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, svnpasswd=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, pollinterval=<span class="hljs-number"><span class="hljs-number">60</span></span>, split_file=util.svn.split_file_alwaystrunk ) c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = svn_poller hourlyscheduler = schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"your-project-schedulers"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), builderNames=[<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>], properties = {<span class="hljs-string"><span class="hljs-string">'owner'</span></span>: <span class="hljs-string"><span class="hljs-string">'admin'</span></span>} ) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [hourlyscheduler] checkout = steps.SVN(repourl=<span class="hljs-string"><span class="hljs-string">'https://svn.host/svn/yourProject/trunk'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, method=<span class="hljs-string"><span class="hljs-string">'fresh'</span></span>, username=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, password=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, haltOnFailure=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br>  Primero, eche un vistazo a <i>svn_poller</i> .  Esta es la misma interfaz que sondea regularmente el repositorio una vez por minuto.  En este caso, <i>svn_poller</i> solo accede a la rama <i>troncal</i> .  El misterioso par√°metro <i>split_file = util.svn.split_file_alwaystrunk</i> establece las reglas: c√≥mo dividir la estructura de las carpetas <i>svn</i> en ramas.  Les ofrece formas relativas.  A su vez, <i>split_file_alwaystrunk</i> simplifica el proceso al decir que solo el <i>enlace</i> <i>troncal est√°</i> en el repositorio. <br><br>  En <i>Schedulers</i> , se <i>especifica ChangeFilter</i> , que ve <i>None</i> y asocia la rama <i>troncal de</i> acuerdo con la asociaci√≥n especificada a trav√©s de <i>split_file_alwaystrunk</i> .  Respondiendo a los cambios en el <i>tronco</i> , inicia el <i>generador</i> llamado <i>yourProject</i> . <br><br>  Aqu√≠ se necesitan <i>propiedades</i> para que el administrador reciba el bolet√≠n del ensamblaje y los resultados de las pruebas como propietario del proceso. <br><br>  El paso <i>build</i> -a <i>checkout</i> es capaz de eliminar completamente cualquier archivo que se encuentre en la versi√≥n local del repositorio de <b>Worker</b> .  A luego haga la <i>actualizaci√≥n</i> completa de <i>svn</i> .  El modo se configura a trav√©s del par√°metro <i>mode = full</i> , <i>method = fresh</i> .  El par√°metro <i>haltOnTailure</i> indica que si la <i>actualizaci√≥n de svn</i> <i>no</i> tiene <i>√©xito</i> , entonces se debe suspender todo el proceso de ensamblaje y prueba, ya que los pasos adicionales no tienen sentido. <br><br><a name="reporter"></a><h4>  <u>6.3 Una carta para usted: los periodistas est√°n autorizados a declarar</u> </h4><br>  <i>Reporteros</i> es un servicio de notificaci√≥n por correo. <br><pre> <code class="python hljs">template_html=<span class="hljs-string"><span class="hljs-string">u'''\ &lt;h4&gt;  : {{ summary }}&lt;/h4&gt; &lt;p&gt;   : {{ workername }}&lt;/p&gt; &lt;p&gt;: {{ projects }}&lt;/p&gt; &lt;p&gt;         : {{ buildbot_url }}&lt;/p&gt; &lt;p&gt;         : {{ build_url }}&lt;/p&gt; &lt;p&gt; WinSCP     c ip:xxx.xx.xxx.xx.   habr/password,   executable    ~/worker/yourProject/build/dist.&lt;/p&gt; &lt;p&gt;&lt;b&gt;    Buildbot&lt;/b&gt;&lt;/p&gt; '''</span></span> sendMessageToAll = reporters.MailNotifier(fromaddr=<span class="hljs-string"><span class="hljs-string">"projectHost@your.domain"</span></span>, sendToInterestedUsers=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, lookup=<span class="hljs-string"><span class="hljs-string">"your.domain"</span></span>, relayhost=<span class="hljs-string"><span class="hljs-string">"smtp.your.domain"</span></span>, smtpPort=<span class="hljs-number"><span class="hljs-number">1025</span></span>, mode=<span class="hljs-string"><span class="hljs-string">"warnings"</span></span>, extraRecipients=[<span class="hljs-string"><span class="hljs-string">'user@your.domain'</span></span>], messageFormatter=reporters.MessageFormatter( template=template_html, template_type=<span class="hljs-string"><span class="hljs-string">'html'</span></span>, wantProperties=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, wantSteps=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [sendMessageToAll]</code> </pre><br>  Puede enviar mensajes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">muchas maneras</a> . <br><br>  <i>MailNotifier</i> usa el correo para enviar notificaciones. <br><br>  <i>template_html</i> establece la plantilla de texto para el bolet√≠n.  Para crear marcas, use html.  Est√° modificado por el motor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>jinja2</i></a> (se puede comparar con <i>django</i> ).  <b>BuildBot</b> tiene un conjunto de variables, cuyos valores se sustituyen en la plantilla en el proceso de formar el texto del mensaje.  Estas variables est√°n inscritas en {{llaves dobles "}.  Entonces, por ejemplo, el <i>resumen</i> muestra el estado de las operaciones completadas, es decir, √©xito o fracaso.  Y los <i>proyectos</i> generar√°n su <i>proyecto</i> .  Entonces, usando comandos de control en <i>jinja2</i> , variables <i>BuildBot</i> y formateadores de cadenas de python, puede crear un mensaje muy informativo. <br><br>  <i>MailNotifier</i> contiene los siguientes argumentos. <br><br>  <i>fromaddr</i> : la direcci√≥n desde la cual todos recibir√°n el bolet√≠n. <br><br>  <i>sendToInterestedUsers</i> = True env√≠a un mensaje al propietario y al usuario que realiz√≥ la <i>confirmaci√≥n</i> . <br><br>  <i>b√∫squeda</i> : sufijo que se agregar√° a los nombres de los usuarios que reciben el bolet√≠n.  Por lo tanto, <i>admin</i> como usuario recibir√° el bolet√≠n en admin@your.domain. <br><br>  <i>relayhost</i> especifica el nombre de host en el que est√° abierto el servidor <i>smtp</i> , y <i>smptPort</i> especifica el n√∫mero de puerto en el que escucha el servidor <i>smtp</i> . <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode = "warning"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dice que el env√≠o de correos debe hacerse solo si hay al menos un paso de </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compilaci√≥n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que haya finalizado con un estado de falla o advertencia. En caso de √©xito, no se requiere correo. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extraRecipients</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> contiene una lista de las personas a las que se debe enviar el correo adem√°s del propietario y la persona que realiz√≥ el </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compromiso</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageFormatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un objeto que define el formato del mensaje, su plantilla y el conjunto de variables disponibles en </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jinja2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Par√°metros como </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wantProperties = True</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wantSteps = True</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> especifican este conjunto de variables disponibles. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with ['services'] = [sendMessageToAll]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> proporciona una lista de servicios, entre los cuales estar√° nuestro</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reportero</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="goodboy"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo hicimos! </font><font style="vertical-align: inherit;">Mis felicitaciones</font></font></h3><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Creamos nuestra propia configuraci√≥n y vimos la funcionalidad que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BuildBot</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es </font><b><font style="vertical-align: inherit;">capaz de hacer</font></b><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esto, creo, es suficiente para entender si esta herramienta es necesaria para crear su proyecto. </font><font style="vertical-align: inherit;">¬øEs interesante para ti? </font><font style="vertical-align: inherit;">¬øTe ser√° √∫til? </font><font style="vertical-align: inherit;">¬øEs conveniente trabajar con ellos? </font><font style="vertical-align: inherit;">Entonces escribo este art√≠culo por una buena raz√≥n.</font></font><br><br>  Y una cosa m√°s.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Me gustar√≠a que la comunidad profesional que usa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BuildBot</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sea ‚Äã‚Äãm√°s amplia, traduzca manuales y m√°s ejemplos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gracias a todos por su atenci√≥n.</font></font> Buena suerte </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460501/">https://habr.com/ru/post/460501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460491/index.html">Sensor de temperatura y humedad Arduino con env√≠o y trazado (Parte 1)</a></li>
<li><a href="../460493/index.html">"Aplicaciones asesinas" para PC de los a√±os 80: VisiCalc y WordStar</a></li>
<li><a href="../460495/index.html">Contenedor a canalizaci√≥n: CRI-O ahora es el valor predeterminado en OpenShift Container Platform 4</a></li>
<li><a href="../460497/index.html">Uso intuitivo de los m√©todos de Monte Carlo con cadenas de Markov.</a></li>
<li><a href="../460499/index.html">Tres ganadores del Premio Dijkstra: ¬øc√≥mo fueron Hydra 2019 y SPTDC 2019?</a></li>
<li><a href="../460503/index.html">Configuraci√≥n inal√°mbrica de Raspberry PI 3 B +</a></li>
<li><a href="../460505/index.html">Atrae tres cruces, o por qu√© los proyectos son tan dif√≠ciles de terminar a tiempo</a></li>
<li><a href="../460507/index.html">XEN y el futuro de la automoci√≥n: c√≥mo un hipervisor de c√≥digo abierto se convierte en un competidor de las soluciones automotrices comerciales</a></li>
<li><a href="../460509/index.html">C√≥mo los proxy residentes ayudan en los negocios: un caso real de uso de Infatica en Data Mining</a></li>
<li><a href="../460511/index.html">Ajuste PHP-FPM: uso de pm static para obtener el m√°ximo rendimiento</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>