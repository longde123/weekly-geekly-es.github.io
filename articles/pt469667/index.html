<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¶üèø üí≠ üë©‚Äçüë¶ Direitos do Linux (chown, chmod, SUID, GUID, sticky bit, ACL, umask) üë®‚Äçüë®‚Äçüë¶ üôéüèª üôÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal. Esta √© uma tradu√ß√£o de um artigo do RedHat RHCSA RHCE 7 RedHat Enterprise Linux 7 EX200 e EX300. 

 Por mim mesmo: espero que o artigo se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Direitos do Linux (chown, chmod, SUID, GUID, sticky bit, ACL, umask)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469667/">  Ol√° pessoal.  Esta √© uma tradu√ß√£o de um artigo do RedHat RHCSA RHCE 7 RedHat Enterprise Linux 7 EX200 e EX300. <br><br>  <b>Por mim mesmo:</b> espero que o artigo seja √∫til n√£o apenas para iniciantes, mas tamb√©m ajude administradores mais experientes a organizar seus conhecimentos. <br><br>  Ent√£o vamos l√°. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/95b/e9d/a00/95be9da00b36434d2b2445fe1379b5ae.png" alt="imagem"><br><a name="habracut"></a><br>  Para acessar arquivos no Linux, s√£o usadas permiss√µes.  Essas permiss√µes s√£o atribu√≠das a tr√™s objetos: um arquivo, um grupo e outro objeto (ou seja, todos os outros).  Neste artigo, voc√™ aprender√° como aplicar permiss√µes. <br><br>  O artigo come√ßa com uma revis√£o dos conceitos b√°sicos, ap√≥s o qual s√£o discutidas permiss√µes especiais e listas de controle de acesso (ACLs).  No final deste artigo, voc√™ aprender√° como configurar permiss√µes padr√£o por meio do umask, al√©m de gerenciar atributos avan√ßados do usu√°rio. <br><br><h2>  Gerenciamento de propriedade de arquivos </h2><br>  Antes de discutir as permiss√µes, voc√™ deve estar ciente da fun√ß√£o do propriet√°rio do arquivo e diret√≥rio.  Possuir arquivos e diret√≥rios √© vital para trabalhar com permiss√µes.  Nesta se√ß√£o, voc√™ aprender√° primeiro como pode ver o propriet√°rio.  Voc√™ aprender√° como alterar o propriet√°rio e o usu√°rio do grupo por arquivos e diret√≥rios. <br><br><h3>  Exibir propriet√°rio de um arquivo ou diret√≥rio </h3><br>  No Linux, cada arquivo e cada diret√≥rio tem dois propriet√°rios: um usu√°rio e um grupo. <br><br>  Esses propriet√°rios s√£o definidos quando o arquivo ou diret√≥rio √© criado.  O usu√°rio que cria o arquivo se torna o propriet√°rio desse arquivo e o grupo principal, que inclui o mesmo usu√°rio, tamb√©m se torna o propriet√°rio desse arquivo.  Para determinar se voc√™, como usu√°rio, possui direitos de acesso a um arquivo ou diret√≥rio, o shell verifica sua propriedade. <br><br>  <b>Isso acontece na seguinte ordem:</b> <br><br><ol><li>  O shell verifica se voc√™ possui o arquivo que deseja acessar.  Se voc√™ √© esse propriet√°rio, obt√©m permiss√µes e o shell para de verificar. </li><li>  Se voc√™ n√£o possui o arquivo, o shell verificar√° se voc√™ √© membro de um grupo que possui permiss√µes nesse arquivo.  Se voc√™ √© membro deste grupo, obt√©m acesso ao arquivo com as permiss√µes definidas para o grupo, e o shell para de verificar. </li><li>  Se voc√™ n√£o √© o usu√°rio nem o propriet√°rio do grupo, obt√©m os direitos de outros usu√°rios (Outros). </li></ol><br>  Para ver as atribui√ß√µes do propriet√°rio atual, voc√™ pode usar o <b>comando ls -l</b> .  Este comando mostra o grupo de usu√°rios e propriet√°rios.  Abaixo, voc√™ pode ver as configura√ß√µes do propriet√°rio dos diret√≥rios no diret√≥rio / home. <br><br><pre><code class="bash hljs">[root@server1 home]<span class="hljs-comment"><span class="hljs-comment"># ls -l total 8 drwx------. 3 bob bob 74 Feb 6 10:13 bob drwx------. 3 caroline caroline 74 Feb 6 10:13 caroline drwx------. 3 fozia fozia 74 Feb 6 10:13 fozia drwx------. 3 lara lara 74 Feb 6 10:13 lara drwx------. 5 lisa lisa 4096 Feb 6 10:12 lisa drwx------. 14 user user 4096 Feb 5 10:35 user</span></span></code> </pre> <br>  Usando o <b>comando ls,</b> voc√™ pode exibir o propriet√°rio dos arquivos neste diret√≥rio.  √Äs vezes, pode ser √∫til obter uma lista de todos os arquivos no sistema em que o usu√°rio ou grupo √© especificado como propriet√°rio.  Voc√™ pode usar o <b>find para isso</b> .  O <b>argumento find -user</b> pode ser usado para essa finalidade.  Por exemplo, o comando a seguir mostra todos os arquivos que possuem o usu√°rio linda especificado como propriet√°rio: <br><br><pre> <code class="bash hljs">find / -user linda</code> </pre> <br>  Voc√™ tamb√©m pode usar o <b>find</b> para procurar arquivos nos quais um grupo espec√≠fico os possui. <br><br>  Por exemplo, o comando a seguir pesquisa todos os arquivos pertencentes ao grupo de <i>usu√°rios</i> : <br><br><pre> <code class="bash hljs">find / -group users</code> </pre> <br><h3>  Mudan√ßa de propriedade </h3><br>  Para aplicar permiss√µes, a primeira coisa a considerar √© a propriedade.  Existe um <b>comando chown</b> para isso.  A sintaxe deste comando √© f√°cil de entender: <br><br><pre> <code class="bash hljs">chown  </code> </pre> <br>  Por exemplo, o comando a seguir altera o propriet√°rio do diret√≥rio / home / account para o usu√°rio linda: <br><br><pre> <code class="bash hljs">chown linda /home/account</code> </pre> <br>  O <b>comando chown</b> possui v√°rias op√ß√µes, uma das quais √© especialmente √∫til: <b>-R</b> .  Voc√™ pode adivinhar o que faz, porque esta op√ß√£o tamb√©m est√° dispon√≠vel para muitas outras equipes.  Isso permite que voc√™ defina recursivamente o propriet√°rio, o que permite definir o propriet√°rio do diret√≥rio atual e tudo mais abaixo.  O comando a seguir altera o propriet√°rio do diret√≥rio / home e tudo abaixo dele para lisa: <br><br>  Agora os propriet√°rios ficam assim: <br><br><pre> <code class="bash hljs">[root@localhost ~]<span class="hljs-comment"><span class="hljs-comment"># ls -l /home total 0 drwx------. 2 account account 62 Sep 25 21:41 account drwx------. 2 lisa lisa 62 Sep 25 21:42 lisa</span></span></code> </pre><br>  Execute: <br><br><pre> <code class="bash hljs">[root@localhost ~]<span class="hljs-comment"><span class="hljs-comment"># chown -R lisa /home/account [root@localhost ~]#</span></span></code> </pre><br>  Agora lisa tornou-se o propriet√°rio do diret√≥rio da conta: <br><br><pre> <code class="bash hljs">[root@localhost ~]<span class="hljs-comment"><span class="hljs-comment"># ls -l /home total 0 drwx------. 2 lisa account 62 Sep 25 21:41 account drwx------. 2 lisa lisa 62 Sep 25 21:42 lisa</span></span></code> </pre><br><h3>  Altera√ß√£o de propriet√°rio do grupo </h3><br>  Existem duas maneiras de alterar a propriedade do grupo.  Voc√™ pode fazer isso usando <b>chown</b> , mas existe um comando especial chamado <b>chgrp</b> que faz o trabalho.  Se voc√™ deseja usar o <b>comando chown</b> , use <b>.</b>  ou <b>:</b> antes do nome do grupo. <br><br>  O comando a seguir altera qualquer propriet√°rio do grupo / home / account para o grupo de contas: <br><br><pre> <code class="bash hljs">chown .account /home/account</code> </pre><br>  Voc√™ pode usar <b>chown</b> para alterar o propriet√°rio de um usu√°rio e / ou grupo de v√°rias maneiras.  Aqui est√£o alguns exemplos: <br><br><ul><li>  <b>chown lisa myfile1</b> define lisa como propriet√°ria de myfile1. </li><li>  <b>chown lisa.sales myfile</b> define o usu√°rio lisa como o propriet√°rio do arquivo myfile e tamb√©m define o grupo de vendas como o propriet√°rio do mesmo arquivo. </li><li>  <b>chown lisa: myfile de vendas √©</b> igual ao comando anterior. </li><li>  <b>chown .sales myfile</b> define o grupo de vendas como o propriet√°rio do arquivo myfile sem alterar o propriet√°rio do usu√°rio. </li><li>  <b>chown: myfile de vendas √©</b> igual ao comando anterior. </li></ul><br>  Voc√™ pode usar o comando <b>chgrp</b> para alterar o propriet√°rio do grupo.  Considere o exemplo a seguir, onde voc√™ pode usar o <b>chgrp para</b> definir o grupo de vendas como o propriet√°rio do diret√≥rio da conta: <br><br><pre> <code class="bash hljs">chgrp .sales /home/account</code> </pre> <br>  Como no <b>chown</b> , voc√™ pode usar a op√ß√£o <b>-R</b> no <b>chgrp</b> e tamb√©m alterar o propriet√°rio do grupo recursivamente. <br><br><h3>  Entendendo o propriet√°rio padr√£o </h3><br>  Voc√™ pode perceber que, quando o usu√°rio cria o arquivo, a propriedade padr√£o √© aplicada. <br>  O usu√°rio que cria o arquivo se torna automaticamente o propriet√°rio desse arquivo e o grupo principal desse usu√°rio se torna automaticamente o propriet√°rio desse arquivo.  Geralmente, √© um grupo especificado no arquivo / etc / passwd como o grupo principal do usu√°rio.  No entanto, se o usu√°rio for membro de v√°rios grupos, ele poder√° alterar o grupo principal efetivo. <br><br>  Para mostrar o grupo principal efetivo atual, o usu√°rio pode usar o comando <b>groups</b> : <br><br><pre> <code class="bash hljs">[root@server1 ~]<span class="hljs-comment"><span class="hljs-comment"># groups lisa lisa : lisa account sales</span></span></code> </pre><br>  Se o usu√°rio atual linda quiser alterar o grupo prim√°rio efetivo, ele usar√° o comando <b>newgrp</b> seguido pelo nome do grupo que deseja definir como o novo grupo prim√°rio efetivo.  Ap√≥s usar o comando <b>newgrp</b> , o grupo principal permanecer√° ativo at√© que o usu√°rio emita o <b>comando exit</b> ou efetue logout. <br><br>  A seguir, mostramos como lisa usa esse comando para que o grupo de vendas se torne o grupo principal: <br><br><pre> <code class="bash hljs">lisa@server1 ~]$ groups lisa account sales [lisa@server1 ~]$ newgrp sales [lisa@server1 ~]$ groups sales lisa account [lisa@server1 ~]$ touch file1 [lisa@server1 ~]$ ls -l total 0 -rw-r--r--. 1 lisa sales 0 Feb 6 10:06 file1</code> </pre><br>  Ap√≥s alterar o grupo principal atual, todos os novos arquivos criados pelo usu√°rio receber√£o esse grupo como grupo de propriet√°rios.Para retornar √† configura√ß√£o inicial do grupo principal, use <b>exit</b> . <br><br>  Para poder usar o comando <b>newgrp</b> , o usu√°rio deve ser um membro do grupo que ele deseja usar como prim√°rio.  Al√©m disso, a senha do grupo pode ser usada para o grupo usando o comando <b>gpasswd</b> .  Se o usu√°rio usar o comando <b>newgrp,</b> mas n√£o for membro do grupo de destino, o shell solicitar√° a senha do grupo.  Depois de inserir a senha correta do grupo, um novo grupo principal efetivo ser√° definido. <br><br><h2>  Gerenciamento de direitos fundamentais </h2><br>  O sistema de permiss√£o do Linux foi inventado na d√©cada de 1970.  Como as necessidades de computa√ß√£o eram limitadas naqueles anos, o sistema b√°sico de permiss√µes era bastante limitado.  Este sistema de permiss√£o usa tr√™s permiss√µes que podem ser aplicadas a arquivos e diret√≥rios.  Nesta se√ß√£o, voc√™ aprender√° como usar e alterar essas permiss√µes. <br><br><h3>  No√ß√µes b√°sicas sobre direitos de leitura, grava√ß√£o e execu√ß√£o </h3><br>  Tr√™s permiss√µes b√°sicas permitem ler, gravar e executar arquivos.  O efeito dessas permiss√µes difere quando aplicado a arquivos ou diret√≥rios.  Para um arquivo, a permiss√£o de leitura lhe d√° o direito de abrir o arquivo para leitura.  Portanto, voc√™ pode ler seu conte√∫do, mas isso significa que seu computador pode abrir o arquivo para fazer algo com ele. <br><br>  Um arquivo de programa que precise acessar uma biblioteca deve, por exemplo, ter acesso de leitura a essa biblioteca.  Daqui resulta que a permiss√£o de leitura √© a permiss√£o mais b√°sica necess√°ria para trabalhar com arquivos. <br><br>  Para um diret√≥rio, a leitura permite exibir o conte√∫do desse diret√≥rio.  Voc√™ deve saber que esta permiss√£o n√£o permite ler arquivos em um diret√≥rio.  As permiss√µes do Linux n√£o conhecem heran√ßa, e a √∫nica maneira de ler um arquivo √© usar permiss√µes de leitura para esse arquivo. <br><br>  Como voc√™ provavelmente pode adivinhar, a permiss√£o de grava√ß√£o, se aplicada ao arquivo, permite gravar no arquivo.  Em outras palavras, permite modificar o conte√∫do dos arquivos existentes.  No entanto, ele n√£o permite criar ou excluir novos arquivos ou alterar suas permiss√µes.  Para fazer isso, voc√™ precisa conceder permiss√£o de grava√ß√£o ao diret√≥rio em que deseja criar o arquivo.  Nos diret√≥rios, essa permiss√£o tamb√©m permite criar e excluir novos subdiret√≥rios. <br><br>  Permiss√£o de execu√ß√£o √© o que voc√™ precisa para executar o arquivo.  Ele nunca ser√° instalado por padr√£o, o que torna o Linux quase completamente imune a v√≠rus.  Somente algu√©m com permiss√µes de grava√ß√£o no diret√≥rio pode aplicar permiss√£o para executar. <br><br>  <b>A seguir, resume o uso de permiss√µes b√°sicas:</b> <br><br><img src="https://habrastorage.org/webt/rr/-a/ty/rr-atyy5ru2por4kcyrmd-x87n8.jpeg"><br><br><h2>  Usando chmod </h2><br>  Para gerenciar direitos, use o <b>comando chmod</b> .  Ao usar o <b>chmod,</b> voc√™ pode definir permiss√µes para o usu√°rio (usu√°rio), grupo (grupo) e outros (outros).  Voc√™ pode usar este comando em dois modos: modo relativo e modo absoluto.  No modo absoluto, tr√™s d√≠gitos s√£o usados ‚Äã‚Äãpara definir as permiss√µes b√°sicas. <br><br><img src="https://habrastorage.org/webt/3r/6l/va/3r6lvaw_mpvo7sxfsggtxik3ofs.jpeg"><br><br>  Ao definir permiss√µes, calcule o valor necess√°rio.  Se voc√™ deseja definir leitura, grava√ß√£o e execu√ß√£o para o usu√°rio, leitura e execu√ß√£o para o grupo e leitura e execu√ß√£o para outras pessoas no / somefile, use o seguinte <b>comando chmod</b> : <br><br><pre> <code class="bash hljs">chmod 755 /somefile</code> </pre> <br>  Quando voc√™ usa o <b>chmod</b> dessa maneira, todas as permiss√µes atuais s√£o substitu√≠das pelas permiss√µes definidas. <br><br>  Se voc√™ deseja alterar as permiss√µes relativas √†s atuais, voc√™ pode usar o <b>chmod</b> no modo relativo.  Ao usar o <b>chmod</b> no modo relativo, voc√™ est√° trabalhando com tr√™s indicadores para indicar o que deseja fazer: <br><br><ol><li>  Primeiro, voc√™ indica para quem deseja alterar as permiss√µes.  Para fazer isso, voc√™ pode escolher entre usu√°rio ( <b>u</b> ), grupo ( <b>g</b> ) e outros ( <b>o</b> ). </li><li>  Em seguida, voc√™ usa o operador para adicionar ou remover permiss√µes do modo atual ou defini-las completamente. </li><li>  No final, voc√™ usa <b>r</b> , <b>we</b> <b>ex</b> para indicar quais permiss√µes voc√™ deseja definir. </li></ol><br>  Ao alterar as permiss√µes no modo relativo, voc√™ pode pular a parte "para" para adicionar ou remover a permiss√£o para todos os objetos.  Por exemplo, este comando adiciona permiss√£o de execu√ß√£o para todos os usu√°rios: <br><br><pre> <code class="bash hljs">chmod +x somefile</code> </pre> <br>  Ao trabalhar no modo relativo, voc√™ tamb√©m pode usar comandos mais complexos.  Por exemplo, este comando adiciona permiss√£o de grava√ß√£o a um grupo e remove leituras para outras pessoas: <br><br><pre> <code class="bash hljs">chmod g+w,or somefile</code> </pre> <br>  Ao usar <b>chmod -R o + rx / data,</b> voc√™ define a permiss√£o de execu√ß√£o para todos os diret√≥rios, bem como para os arquivos no diret√≥rio / data.  Para definir permiss√£o para executar apenas em diret√≥rios, n√£o em arquivos, use <b>chmod -R o + rX / data</b> . <br><br>  X mai√∫sculo garante que os arquivos n√£o tenham permiss√£o para executar se o arquivo ainda n√£o tiver definido a permiss√£o de execu√ß√£o para alguns objetos.  Isso torna o X uma maneira mais inteligente de trabalhar com permiss√µes de execu√ß√£o;  isso evitar√° a instala√ß√£o dessa permiss√£o em arquivos onde n√£o √© necess√°ria. <br><br><h2>  Direitos estendidos </h2><br>  Al√©m das permiss√µes b√°sicas sobre as quais voc√™ acabou de ler, o Linux tamb√©m possui um conjunto de permiss√µes avan√ßadas.  Essas n√£o s√£o as permiss√µes padr√£o definidas por voc√™, mas √†s vezes fornecem uma adi√ß√£o √∫til.  Nesta se√ß√£o, voc√™ aprender√° o que s√£o e como configur√°-los. <br><br><h3>  No√ß√µes b√°sicas sobre permiss√µes estendidas de SUID, GUID e bits persistentes </h3><br>  Existem tr√™s permiss√µes avan√ßadas.  A primeira delas √© a permiss√£o para definir um identificador de usu√°rio (SUID).  Em alguns casos especiais, voc√™ pode aplicar essa permiss√£o aos arquivos execut√°veis.  Por padr√£o, o usu√°rio executando o execut√°vel executa o arquivo com suas pr√≥prias permiss√µes. <br><br>  Para usu√°rios comuns, isso geralmente significa que o uso do programa √© limitado.  No entanto, em alguns casos, o usu√°rio requer permiss√µes especiais apenas para executar uma tarefa espec√≠fica. <br><br>  Considere, por exemplo, uma situa√ß√£o em que o usu√°rio precise alterar a senha.  Para fazer isso, o usu√°rio deve escrever sua nova senha no arquivo / etc / shadow.  No entanto, este arquivo n√£o pode ser gravado por usu√°rios n√£o raiz: <br><br><pre> <code class="bash hljs">root@hnl ~]<span class="hljs-comment"><span class="hljs-comment"># ls -l /etc/shadow ----------. 1 root root 1184 Apr 30 16:54 /etc/shadow</span></span></code> </pre><br>  A resolu√ß√£o SUID oferece uma solu√ß√£o para esse problema.  No utilit√°rio / usr / bin / passwd, essa permiss√£o √© usada por padr√£o.  Isso significa que, quando a senha √© alterada, o usu√°rio obt√©m temporariamente privil√©gios de root, o que lhe permite gravar no arquivo / etc / shadow.  Voc√™ pode ver a resolu√ß√£o SUID com <b>ls -l</b> como <b>s</b> na posi√ß√£o em que normalmente espera ver <b>x</b> para obter permiss√µes de usu√°rio: <br><br><pre> <code class="bash hljs">[root@hnl ~]<span class="hljs-comment"><span class="hljs-comment"># ls -l /usr/bin/passwd -rwsr-xr-x. 1 root root 32680 Jan 28 2010 /usr/bin/passwd</span></span></code> </pre><br>  As permiss√µes SUID podem parecer √∫teis (e, em alguns casos, s√£o), mas ao mesmo tempo s√£o potencialmente perigosas.  Se usado incorretamente, voc√™ pode acidentalmente conceder permiss√µes de acesso root.  Portanto, recomendo us√°-lo apenas com extrema cautela. <br><br>  A maioria dos administradores nunca precisar√° us√°-lo;  voc√™ o ver√° apenas em alguns arquivos nos quais o sistema operacional deve defini-lo por padr√£o. <br><br>  A segunda permiss√£o especial √© o identificador de grupo (SGID).  Esta resolu√ß√£o tem dois efeitos.  Quando aplicado a um arquivo execut√°vel, fornece ao usu√°rio que est√° executando o arquivo as permiss√µes do propriet√°rio do grupo desse arquivo.  Assim, o SGID pode fazer mais ou menos o mesmo que o SUID.  No entanto, o SGID praticamente n√£o √© utilizado para esse fim. <br><br>  Assim como na permiss√£o SUID, o SGID √© aplicado a alguns arquivos do sistema como a configura√ß√£o padr√£o. <br><br>  Quando aplicado a um diret√≥rio, o SGID pode ser √∫til porque voc√™ pode us√°-lo para definir o propriet√°rio do grupo padr√£o para os arquivos e subdiret√≥rios criados neste diret√≥rio.  Por padr√£o, quando um usu√°rio cria um arquivo, seu grupo principal efetivo √© definido como o propriet√°rio do grupo para esse arquivo. <br><br>  Isso nem sempre √© muito √∫til, especialmente porque os usu√°rios do Red Hat / CentOS t√™m um grupo com o mesmo nome que o usu√°rio e do qual o usu√°rio √© o √∫nico membro.  Assim, por padr√£o, os arquivos que o usu√°rio cria ser√£o compartilhados. <br><br>  Imagine uma situa√ß√£o em que os usu√°rios de linda e lori trabalhem em contabilidade e sejam membros do grupo de <i>contas</i> .  Por padr√£o, esses usu√°rios s√£o membros do grupo privado dos quais s√£o o √∫nico membro.  No entanto, os dois usu√°rios s√£o membros do grupo de contas, mas tamb√©m como um par√¢metro do grupo secund√°rio. <br><br>  A situa√ß√£o padr√£o √© que, quando qualquer um desses usu√°rios cria um arquivo, o grupo principal se torna o propriet√°rio.  Portanto, por padr√£o, linda n√£o pode acessar os arquivos criados por lori e vice-versa.  No entanto, se voc√™ criar o diret√≥rio compartilhado de um grupo (digamos / groups / account) e verifique se a permiss√£o SGID √© aplicada a este diret√≥rio e se a conta do grupo est√° definida como o propriet√°rio do grupo, todos os arquivos criados nesse diret√≥rio e em todos os seus subdiret√≥rios , tamb√©m obtenha grupos de contas como o propriet√°rio padr√£o do grupo. <br><br>  Por esse motivo, a permiss√£o SGID √© uma permiss√£o muito √∫til para instala√ß√£o em diret√≥rios de grupos compartilhados. <br><br>  A permiss√£o SGID √© mostrada na sa√≠da <b>ls -ld</b> como <b>s</b> na posi√ß√£o em que voc√™ normalmente encontra permiss√£o para executar o grupo: <br><br><pre> <code class="bash hljs">[root@hnl data]<span class="hljs-comment"><span class="hljs-comment"># ls -ld account drwxr-sr-x. 2 root account 4096 Apr 30 21:28 account</span></span></code> </pre><br>  A terceira das permiss√µes especiais √© pegajosa.  Essa permiss√£o √© √∫til para proteger arquivos contra exclus√£o acidental em um ambiente em que v√°rios usu√°rios t√™m permiss√µes de grava√ß√£o no mesmo diret√≥rio.  Se um bit persistente for usado, um usu√°rio poder√° excluir um arquivo apenas se ele for o propriet√°rio do arquivo ou diret√≥rio em que o arquivo est√° localizado.  Por esse motivo, √© usado como a permiss√£o padr√£o para o diret√≥rio / tmp e tamb√©m pode ser √∫til para diret√≥rios de grupos compartilhados. <br><br>  Sem bits fixos, se um usu√°rio puder criar arquivos em um diret√≥rio, ele tamb√©m poder√° excluir arquivos desse diret√≥rio.  Em um ambiente de grupo p√∫blico, isso pode ser irritante.  Imagine os usu√°rios linda e lori, que t√™m permiss√µes de grava√ß√£o no diret√≥rio / data / account e recebem essas permiss√µes atrav√©s da associa√ß√£o ao grupo de contas.  Portanto, linda pode excluir arquivos criados por lori e vice-versa. <br><br>  Quando voc√™ usa bits fixos, o usu√°rio pode excluir arquivos apenas se uma das seguintes condi√ß√µes for verdadeira: <br><br><ul><li>  O usu√°rio √© o propriet√°rio do arquivo; </li><li>  O usu√°rio √© o propriet√°rio do diret√≥rio em que o arquivo est√° localizado. </li></ul><br>  Ao usar <b>ls -ld</b> , voc√™ pode ver bits pegajosos como <b>t</b> na posi√ß√£o em que geralmente v√™ permiss√£o de execu√ß√£o para outras pessoas: <br><br><pre> <code class="bash hljs">[root@hnl data]<span class="hljs-comment"><span class="hljs-comment"># ls -ld account/ drwxr-sr-t. 2 root account 4096 Apr 30 21:28 account/</span></span></code> </pre><br><h3>  Direitos aprimorados </h3><br>  Para aplicar SUID, SGID e bit pegajoso, voc√™ tamb√©m pode usar o <b>chmod</b> .  SUID tem um valor num√©rico de 4, SGID tem um valor num√©rico de 2 e bit pegajoso tem um valor num√©rico de 1. <br><br>  Se voc√™ deseja aplicar essas permiss√µes, precisar√° adicionar um argumento de quatro d√≠gitos ao <b>chmod</b> , cujo primeiro d√≠gito se refere a permiss√µes especiais.  A seguinte linha, por exemplo, adicionar√° permiss√£o SGID ao diret√≥rio e configurar√° rwx para o usu√°rio e rx para o grupo e outros: <br><br><pre> <code class="bash hljs">chmod 2755 /somedir</code> </pre> <br>  Isso √© bastante impratic√°vel se voc√™ precisar examinar as permiss√µes atuais definidas antes de trabalhar com o <b>chmod</b> no modo absoluto.  (Voc√™ corre o risco de sobrescrever permiss√µes, se n√£o o fizer.) Portanto, recomendo trabalhar no modo relativo, se voc√™ precisar aplicar alguma das permiss√µes especiais: <br><br><ol><li>  Para SUID, use <b>chmod u + s</b> . </li><li>  Para SGID, use <b>chmod g + s</b> . </li><li>  Para bits persistentes, use <b>chmod + te, em</b> seguida, o nome do arquivo ou diret√≥rio para o qual voc√™ deseja definir permiss√µes. </li></ol><br>  A tabela resume tudo o que √© importante saber sobre o gerenciamento de permiss√µes especiais. <br><br><img src="https://habrastorage.org/webt/ls/bk/1d/lsbk1dyrexjjgwx6g1__fws8ols.jpeg"><br><br><h3>  Exemplo de trabalho com direitos especiais </h3><br>  Neste exemplo, voc√™ usa permiss√µes especiais para tornar mais f√°cil para os membros da equipe compartilhar arquivos em um diret√≥rio de grupo compartilhado.  Voc√™ atribui o ID-bit do identificador de grupo definido, bem como o sticky bit, e v√™ que, ap√≥s a instala√ß√£o, s√£o adicionadas fun√ß√µes que facilitam o trabalho conjunto dos membros do grupo. <br><br><ol><li>  Abra o terminal onde voc√™ √© um usu√°rio linda.  Voc√™ pode criar um usu√°rio usando <b>useradd linda</b> , adicione a senha <b>passwd linda</b> . </li><li>  Crie um diret√≥rio / data e um subdiret√≥rio / data / sales na raiz com o comando <b>mkdir -p / data / sales</b> .  Execute <b>cd / data / sales</b> para ir para o diret√≥rio de vendas.  Execute <b>toque linda1</b> e <b>toque linda2</b> para criar dois arquivos vazios de propriedade de linda. </li><li>  Execute <b>su - lisa</b> para alternar o usu√°rio atual para lisa, que tamb√©m √© membro do grupo de vendas. </li><li>  Execute <b>cd / data / sales</b> e, nesse diret√≥rio, execute <b>ls -l</b> .  Voc√™ ver√° dois arquivos que foram criados por linda e pertencem ao grupo linda.  Execute <b>rm -f linda *</b> .  Isso excluir√° os dois arquivos. </li><li>  Execute o <b>toque lisa1</b> e <b>toque em lisa2</b> para criar dois arquivos que pertencem ao usu√°rio lisa. </li><li>  Execute <b>su -</b> para elevar seus privil√©gios ao n√≠vel raiz. </li><li>  Execute <b>chmod g + s, o + t / data / sales</b> para definir o GUID (bit de identificador de grupo) e o bit persistente no diret√≥rio do grupo compartilhado. </li><li>  Execute <b>su - linda</b> .  Em seguida, <b>toque em linda3</b> e <b>toque em linda4</b> .  Agora voc√™ deve ver que os dois arquivos criados pertencem ao grupo de vendas, que √© o propriet√°rio do grupo de diret√≥rios / data / sales. </li><li>  Execute <b>rm -rf lisa *</b> .  O Sticky Bit impede que esses arquivos sejam exclu√≠dos em nome de linda, pois voc√™ n√£o os possui.  Observe que se linda √© o propriet√°rio do diret√≥rio / data / sales, ele pode excluir esses arquivos de qualquer maneira! </li></ol><br><h2>  Gerenciando ACLs (setfacl, getfacl) no Linux </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesmo se os direitos estendidos discutidos acima adicionarem funcionalidade √∫til √† maneira como o Linux trabalha com permiss√µes, isso n√£o permite conceder permiss√µes a mais de um usu√°rio ou um grupo em um √∫nico arquivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As listas de controle de acesso oferecem esse recurso. </font><font style="vertical-align: inherit;">Al√©m disso, eles permitem que os administradores definam permiss√µes padr√£o de uma maneira complexa, na qual as permiss√µes definidas podem variar em diret√≥rios diferentes.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No√ß√µes b√°sicas sobre ACLs </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embora o subsistema ACL adicione grande funcionalidade ao seu servidor, ele tem uma desvantagem: nem todos os utilit√°rios o suportam. Portanto, voc√™ pode perder as configura√ß√µes da ACL ao copiar ou mover arquivos, e o software de backup pode n√£o fazer backup das configura√ß√µes da ACL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O utilit√°rio tar n√£o suporta ACLs. Para garantir que as configura√ß√µes da ACL n√£o sejam perdidas ao fazer backup, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">star em</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> vez de tar. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">star</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> trabalha com os mesmos par√¢metros que o tar; apenas adiciona suporte para configura√ß√µes de ACL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ tamb√©m pode fazer backup da ACL usando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que pode ser restaurado usando o comando setfacl. Para criar um backup, use</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl -R / directory&gt; file.acls</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Para restaurar as configura√ß√µes do arquivo de backup, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl --restore = file.acl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A falta de suporte com algumas ferramentas n√£o deve ser um problema. </font><font style="vertical-align: inherit;">As ACLs geralmente s√£o aplicadas aos diret√≥rios como uma medida estrutural, e n√£o a arquivos individuais. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portanto, n√£o haver√° muitos, mas apenas alguns, aplicados em locais inteligentes do sistema de arquivos. </font><font style="vertical-align: inherit;">Portanto, a restaura√ß√£o das ACLs originais com as quais voc√™ trabalhou √© relativamente f√°cil, mesmo que o seu software de backup n√£o as suporte.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preparando o sistema de arquivos para uma ACL </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de come√ßar a trabalhar com ACLs, pode ser necess√°rio preparar um sistema de arquivos para suportar ACLs. </font><font style="vertical-align: inherit;">Como os metadados do sistema de arquivos precisam ser expandidos, nem sempre h√° suporte padr√£o para ACLs no sistema de arquivos. </font><font style="vertical-align: inherit;">Se voc√™ receber a mensagem "opera√ß√£o n√£o suportada" ao configurar ACLs para o sistema de arquivos, seu sistema de arquivos pode n√£o ter suporte a ACL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para corrigir isso, voc√™ precisa adicionar a op√ß√£o de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">montagem acl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no arquivo / etc / fstab para que o sistema de arquivos seja montado com suporte a ACL por padr√£o.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Altere e visualize as configura√ß√µes da ACL com setfacl e getfacl </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para definir a ACL, voc√™ precisa do comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para ver as configura√ß√µes atuais da ACL, voc√™ precisa do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . O </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando ls -l</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√£o mostra nenhuma ACL existente; simplesmente mostra + ap√≥s a lista de permiss√µes, o que indica que as ACLs tamb√©m se aplicam ao arquivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Antes de configurar as ACLs, √© sempre √∫til mostrar as configura√ß√µes atuais da ACL usando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Abaixo, com um exemplo, voc√™ pode ver as permiss√µes atuais, como mostrado com </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ls -ld</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , assim como com </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se voc√™ olhar com bastante aten√ß√£o, ver√° que as informa√ß√µes mostradas s√£o exatamente as mesmas.</font></font><br><br><pre> <code class="bash hljs">[root@server1 /]<span class="hljs-comment"><span class="hljs-comment"># ls -ld /dir drwxr-xr-x. 2 root root 6 Feb 6 11:28 /dir [root@server1 /]# getfacl /dir getfacl: Removing leading '/' from absolute path names # file: dir # owner: root # group: root user::rwx group::rx other::rx</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado do comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , voc√™ pode ver abaixo que as permiss√µes s√£o mostradas para tr√™s objetos diferentes: usu√°rio, grupo e outros. Agora vamos adicionar uma ACL para conceder permiss√µes de leitura e execu√ß√£o ao grupo de vendas. O comando para isso √© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -mg: sales: rx / dir</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Nesse comando, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-m</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indica que as configura√ß√µes atuais da ACL devem ser alteradas. Depois disso, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g: sales: rx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diz √† equipe para configurar a ACL para ler e executar ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rx</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) as vendas do </font><font style="vertical-align: inherit;">grupo ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Abaixo, voc√™ pode ver a apar√™ncia do comando, bem como a sa√≠da do comando getfacl ap√≥s alterar as configura√ß√µes atuais da ACL.</font></font><br><br><pre> <code class="bash hljs">[root@server1 /]<span class="hljs-comment"><span class="hljs-comment"># setfacl -mg:sales:rx /dir [root@server1 /]# getfacl /dir getfacl: Removing leading '/' from absolute path names # file: dir # owner: root # group: root user::rwx group::rx group:sales:rx mask::rx other::rx</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora que voc√™ entende como configurar uma ACL de grupo, √© f√°cil entender a ACL para usu√°rios e outros usu√°rios. </font><font style="vertical-align: inherit;">Por exemplo, o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando setfacl -mu: linda: rwx / data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> concede permiss√µes ao usu√°rio linda no diret√≥rio / data, sem torn√°-lo o propriet√°rio e sem alterar o destino do propriet√°rio atual. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> possui muitos recursos e op√ß√µes. </font><font style="vertical-align: inherit;">Uma op√ß√£o √© especialmente importante, a op√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-R</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Se usada, esta op√ß√£o configura a ACL para todos os arquivos e subdiret√≥rios existentes no diret√≥rio em que voc√™ instala a ACL. </font><font style="vertical-align: inherit;">√â recomend√°vel que voc√™ sempre use essa op√ß√£o ao modificar ACLs para diret√≥rios existentes.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trabalhar com ACLs padr√£o </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um dos benef√≠cios do uso de ACLs √© que voc√™ pode conceder permiss√µes para v√°rios usu√°rios ou grupos em um diret√≥rio. Outra vantagem √© que voc√™ pode habilitar a heran√ßa trabalhando com a ACL padr√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao definir a ACL padr√£o, voc√™ define as permiss√µes que ser√£o definidas para todos os novos itens criados no diret√≥rio. Lembre-se de que a ACL padr√£o n√£o altera as permiss√µes para arquivos e subdiret√≥rios existentes. Para alter√°-los, voc√™ precisa adicionar uma ACL regular! </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso √© importante saber.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se voc√™ deseja usar a ACL para configurar o acesso de v√°rios usu√°rios ou grupos ao mesmo diret√≥rio, defina a ACL duas vezes. Primeiro, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -R -m</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para alterar a ACL dos arquivos atuais. Ent√£o use</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -md:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para cuidar de todos os novos elementos que tamb√©m ser√£o criados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para definir a ACL padr√£o, basta adicionar a op√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ap√≥s a op√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-m</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (o pedido √© importante!). Portanto, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -md: g: sales: rx / data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se desejar que o grupo de vendas tenha acesso de leitura e execu√ß√£o a qualquer coisa que ser√° criada no diret√≥rio / data. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao usar ACLs padr√£o, tamb√©m pode ser √∫til definir ACLs para outras pessoas. Isso geralmente n√£o faz muito sentido, porque voc√™ tamb√©m pode alterar as permiss√µes para outras pessoas usando o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chmod</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . No entanto, o que voc√™ n√£o pode fazer com o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chmod</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, isso indica os direitos que devem ser concedidos a outros usu√°rios para cada novo arquivo que ser√° criado. </font><font style="vertical-align: inherit;">Se voc√™ quiser que outros n√£o obtenham permiss√µes para qualquer coisa criada em / data, por exemplo, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -md: o :: - / data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ACLs e permiss√µes regulares nem sempre s√£o bem integradas. </font><font style="vertical-align: inherit;">Podem ocorrer problemas se voc√™ aplicar a ACL padr√£o a um diret√≥rio, ap√≥s o qual os itens foram adicionados a esse diret√≥rio e, em seguida, tentar alterar as permiss√µes normais. </font><font style="vertical-align: inherit;">As altera√ß√µes que se aplicam √†s permiss√µes regulares n√£o ser√£o bem refletidas na vis√£o geral da ACL. </font><font style="vertical-align: inherit;">Para evitar problemas, primeiro defina as permiss√µes normais, depois defina as ACLs padr√£o (e tente n√£o alter√°-las novamente).</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exemplo de gerenciamento avan√ßado de direitos usando ACLs </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste exemplo, voc√™ continuar√° trabalhando com os diret√≥rios / data / account e / data / sales que voc√™ criou anteriormente. </font><font style="vertical-align: inherit;">Nos exemplos anteriores, voc√™ garantiu que o grupo de vendas possui permiss√µes para / data / sales e o grupo de contas possui permiss√µes para / data / account. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro, verifique se o grupo de contas obt√©m permiss√µes de leitura no diret√≥rio / data / account e o grupo de vendas obt√©m permiss√µes de leitura no diret√≥rio / data / account. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em seguida, defina as ACLs padr√£o para garantir que todos os novos arquivos tenham permiss√µes definidas corretamente para todos os novos itens.</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abra um terminal. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Execute </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -mg: account: rx / data / sales</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setfacl -mg: sales: rx / data / account</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li>  <b>getfacl</b> ,  ,      ,   . </li><li>  <b>setfacl -md:g:account:rwx,g:sales:rx /data/sales</b> ,   ACL     sales. </li><li>  ACL     /data/account,  <b>setfacl -md:g:sales:rwx,g:account:rx /data/account</b> . </li><li> ,   ACL ,     /data/sales.  <b>touch /data/sales/newfile</b>   <b>getfacl /data/sales/newfile</b>    . </li></ol><br><h2>       umask </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Acima, voc√™ aprendeu como trabalhar com ACLs por padr√£o. Se voc√™ n√£o estiver usando uma ACL, h√° um par√¢metro de shell que define os direitos padr√£o que voc√™ receber√°: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (m√°scara reversa). Nesta se√ß√£o, voc√™ aprender√° como alterar as permiss√µes padr√£o usando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ provavelmente percebeu que quando voc√™ cria um novo arquivo, algumas permiss√µes padr√£o s√£o definidas. Essas permiss√µes s√£o determinadas pela configura√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esta op√ß√£o de shell se aplica a todos os usu√°rios no logon. O par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usa um valor num√©rico que √© subtra√≠do das permiss√µes m√°ximas que podem ser definidas automaticamente para o arquivo; a configura√ß√£o m√°xima para arquivos √© 666 e para diret√≥rios - 777.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, algumas exce√ß√µes se aplicam a esta regra. Voc√™ pode encontrar uma vis√£o geral completa das configura√ß√µes do </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> na tabela abaixo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dos d√≠gitos usados ‚Äã‚Äãem </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como no caso de argumentos num√©ricos para o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando chmod</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o primeiro d√≠gito refere-se √†s permiss√µes do usu√°rio, o segundo d√≠gito refere-se √†s permiss√µes do grupo e o √∫ltimo refere-se √†s permiss√µes padr√£o definidas para outros. O valor </font><font style="vertical-align: inherit;">padr√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de </font><font style="vertical-align: inherit;">022 fornece 644 para todos os novos arquivos e 755 para todos os novos diret√≥rios criados em seu servidor. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma vis√£o geral completa de todos os valores num√©ricos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">umask</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e seus resultados na tabela abaixo.</font></font><br><br><img src="https://habrastorage.org/webt/yi/l8/x0/yil8x0tn7hy6ecxndifimssztnk.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma maneira f√°cil de ver como o par√¢metro umask funciona √© o seguinte: comece com as permiss√µes padr√£o para o arquivo definido como 666 e subtraia umask para obter permiss√µes v√°lidas. Fa√ßa o mesmo para o diret√≥rio e suas permiss√µes padr√£o 777. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H√° duas maneiras de alterar a configura√ß√£o do umask: para todos os usu√°rios e para usu√°rios individuais. Se voc√™ deseja instalar umask para todos os usu√°rios, certifique-se de que a op√ß√£o umask seja levada em considera√ß√£o ao executar arquivos de ambiente shell, conforme especificado em / etc / profile. A abordagem correta √© criar um script de shell chamado umask.sh no diret√≥rio /etc/profile.d e especificar o umask que voc√™ deseja usar neste script de shell. Se umask for alterada neste arquivo, ela ser√° aplicada a todos os usu√°rios ap√≥s o login no servidor.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma alternativa para configurar umask por meio de / etc / profile e arquivos relacionados, onde √© aplicada a todos os usu√°rios no sistema, √© alterar as configura√ß√µes de umask em um arquivo chamado .profile, criado no diret√≥rio inicial de cada usu√°rio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As configura√ß√µes aplicadas neste arquivo s√£o aplicadas apenas a um usu√°rio individual; </font><font style="vertical-align: inherit;">portanto, esse √© um bom m√©todo se voc√™ precisar de mais detalhes. </font><font style="vertical-align: inherit;">Pessoalmente, gosto desse recurso para alterar o valor padr√£o umask do usu√°rio raiz para 027, enquanto usu√°rios regulares trabalham com o padr√£o umask 022.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trabalhando com Atributos Avan√ßados do Usu√°rio </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta √© a se√ß√£o final sobre direitos do Linux. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao trabalhar com permiss√µes, sempre h√° um relacionamento entre um objeto de usu√°rio ou grupo e as permiss√µes que esses objetos de usu√°rio ou grupo t√™m para o arquivo ou diret√≥rio. Um m√©todo alternativo de proteger arquivos em um servidor Linux √© trabalhar com atributos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os atributos fazem seu trabalho, independentemente do usu√°rio que acessa o arquivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como nas ACLs, os atributos do arquivo podem precisar incluir a op√ß√£o de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">montagem</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta √© a op√ß√£o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">user_xattr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Se voc√™ receber uma mensagem "opera√ß√£o n√£o suportada" ao trabalhar com atributos avan√ßados do usu√°rio, certifique-se de definir o par√¢metro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mount</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no arquivo / etc / fstab.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muitos atributos est√£o documentados. Alguns atributos est√£o dispon√≠veis, mas ainda n√£o foram implementados. N√£o os use; eles n√£o v√£o te trazer nada. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A seguir, est√£o os atributos mais √∫teis que voc√™ pode aplicar: </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo garante que o tempo de acesso ao arquivo do arquivo n√£o seja alterado. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geralmente, sempre que um arquivo √© aberto, o tempo de acesso ao arquivo deve ser gravado nos metadados do arquivo. Isso afeta negativamente o desempenho; portanto, para arquivos que s√£o acessados ‚Äã‚Äãregularmente, o atributo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pode ser usado para desativar esse recurso. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo permite adicionar, mas n√£o excluir, um arquivo. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ usar um sistema de arquivos que suporte a compacta√ß√£o no n√≠vel do volume, esse atributo do arquivo garantir√° que o arquivo ser√° compactado na primeira vez que o mecanismo de compacta√ß√£o for ativado. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo garante que as altera√ß√µes nos arquivos sejam gravadas no disco imediatamente e n√£o sejam armazenadas em cache em primeiro lugar. Esse √© um atributo √∫til em arquivos importantes do banco de dados, garantindo que eles n√£o sejam perdidos entre o cache do arquivo e o disco r√≠gido. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo garante que o arquivo n√£o seja salvo nos backups em que o utilit√°rio de despejo √© usado. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este atributo permite a indexa√ß√£o para o diret√≥rio em que est√° inclu√≠do. Isso fornece acesso mais r√°pido a arquivos para sistemas de arquivos primitivos, como o Ext3, que n√£o usam o banco de dados B-tree para acesso r√°pido a arquivos. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo torna o arquivo inalterado. Portanto, voc√™ n√£o pode fazer altera√ß√µes no arquivo, o que √© √∫til para arquivos que precisam de prote√ß√£o adicional. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este atributo garante que, no sistema de arquivos ext3, o arquivo seja gravado primeiro no log e depois nos blocos de dados no disco r√≠gido. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Substitua os blocos nos quais o arquivo foi salvo por 0 s ap√≥s a exclus√£o do arquivo. Isso garante que a recupera√ß√£o do arquivo n√£o seja poss√≠vel ap√≥s a exclus√£o. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vc</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este atributo armazena informa√ß√µes de exclus√£o. </font><font style="vertical-align: inherit;">Isso permite que voc√™ desenvolva um utilit√°rio que funciona com essas informa√ß√µes para salvar arquivos exclu√≠dos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ deseja aplicar atributos, pode usar o comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chattr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Por exemplo, use o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arquivo de chattr + s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para aplicar atributos a algum arquivo. </font><font style="vertical-align: inherit;">Precisa remover um atributo? </font><font style="vertical-align: inherit;">Em seguida, use </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chattr -s somefile</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e ele ser√° exclu√≠do. </font><font style="vertical-align: inherit;">Para obter uma vis√£o geral de todos os atributos usados ‚Äã‚Äãatualmente, use o </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando lsattr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sum√°rio </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste artigo, voc√™ aprendeu como trabalhar com permiss√µes. Voc√™ l√™ sobre tr√™s permiss√µes b√°sicas, permiss√µes avan√ßadas e como aplicar ACLs ao sistema de arquivos. Voc√™ tamb√©m aprendeu como usar o par√¢metro umask para aplicar permiss√µes padr√£o. No final deste artigo, voc√™ aprendeu como usar atributos avan√ßados do usu√°rio para aplicar uma camada adicional de seguran√ßa do sistema de arquivos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ gostou desta tradu√ß√£o, por favor escreva sobre ela nos coment√°rios. Haver√° mais motiva√ß√£o para fazer tradu√ß√µes √∫teis.</font></font><br><br><blockquote>        .          . <br><br>  ¬´ -          .¬ª   ¬´ -          .¬ª,    . <br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">berez</a> . <br></blockquote><br><blockquote> : <br>      ,  ,     ,     . <br><br> : <br>      ,  ,     ,       .      ,       ,    ,    . <br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">CryptoPirate</a> <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt469667/">https://habr.com/ru/post/pt469667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt469651/index.html">WIBAttack. A nova vulnerabilidade do cart√£o SIM √© realmente terr√≠vel?</a></li>
<li><a href="../pt469655/index.html">Por que voc√™ precisa de um servi√ßo de suporte que n√£o suporta?</a></li>
<li><a href="../pt469657/index.html">An√°lise: quais ativos de c√¢mbio trazem o maior retorno para investidores russos</a></li>
<li><a href="../pt469659/index.html">Carros RC: Introdu√ß√£o</a></li>
<li><a href="../pt469663/index.html">A hist√≥ria do DashaMail: do lan√ßamento de um clone de uma start-up de e-mail americana a brigas com investidores e um novo come√ßo</a></li>
<li><a href="../pt469669/index.html">Edward Snowden fala sobre por que ele se tornou um informante</a></li>
<li><a href="../pt469671/index.html">Por que voc√™ deve usar a linguagem Ada para programar seu sistema</a></li>
<li><a href="../pt469677/index.html">Tabagismo, estilo de vida saud√°vel, motiva√ß√£o e velocidade de desenvolvimento de software</a></li>
<li><a href="../pt469681/index.html">Lan√ßada a vers√£o final do TensorFlow 2.0</a></li>
<li><a href="../pt469683/index.html">Seguran√ßa Nuclear e Vigil√¢ncia por V√≠deo Industrial</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>