<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚Äçüöí üôè üë©‚Äçüë¶‚Äçüë¶ GAZ-66 Spielzeug auf dem Bedienfeld. Teil 1 üôç ü§πüèº üôáüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In den letzten Jahren wollte ich ein Spielzeug auf dem Bedienfeld haben und immer mit einem Video. Aber kaufen Sie nicht fertig, sondern machen Sie es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GAZ-66 Spielzeug auf dem Bedienfeld. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462283/"><img alt="Haupt" width="700" src="https://habrastorage.org/webt/rz/l8/s0/rzl8s0pnehcut_fbc7adfyu9kvy.jpeg"><br><p>  In den letzten Jahren wollte ich ein Spielzeug auf dem Bedienfeld haben und immer mit einem Video.  Aber kaufen Sie nicht fertig, sondern machen Sie es selbst.  Und am Ende habe ich mir ein solches Spielzeug bestellt, mit einem einfachen Steuerungssystem, aber gro√üem Modernisierungspotential.  Es dauerte ca. 9 Monate, bis alle Arbeiten von Anfang bis fast abgeschlossen waren.  Die meiste Zeit warteten Komponenten aus China. <br>  Ich schreibe gr√∂√ütenteils einen Artikel f√ºr mich selbst, damit ich in Zukunft nicht vergesse, was ich getan habe, wie, warum und warum. <br>  Es wird zwei Hauptteile enthalten: Hardware und Software und m√∂glicherweise einen weiteren Teil √ºber das Layout von Eisen.  Zun√§chst beschreibe ich die Hardware, von der ich gesammelt habe, auf welche Probleme ich gesto√üen bin und wie ich sie gel√∂st habe. </p><a name="habracut"></a><br><h3 id="1-apparatnaya-chast">  1. Hardware </h3><br><p>  Das System besteht aus einem Bedienfeld und Ger√§ten, die auf einer Schreibmaschine installiert sind.  Betrachten wir sie genauer. </p><br><h4 id="11-pult-upravleniya">  1.1 Systemsteuerung </h4><br><p>  Komponenten </p><br><ul><li>  Himbeer pi 3 </li><li>  ADS1115 ADC </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spielhut</a> </li></ul><br><h4 id="game-hat">  Spielhut </h4><br><p>  Spiel HAT wurde ausgew√§hlt, weil  Dies ist eine schl√ºsselfertige L√∂sung, die einen Bildschirm, einen Joystick und eine Tastatur kombiniert, die ausreichen, um die Maschine zu steuern. </p><br><img alt="Spielhut" width="400" src="https://habrastorage.org/webt/ku/cy/16/kucy16tjvivlokfhjnm1evobwis.jpeg"><br><p>  Der Joystick auf diesem Board ist KY-023.  Er entschied sich f√ºr anstelle des Lenkrads.  Es stellte sich jedoch heraus, dass Raspberry keinen ADC hat und die einzigen Werte, die daraus erhalten werden k√∂nnten, 0 und 1 sind, was f√ºr eine reibungslose Drehung der R√§der eindeutig nicht ausreicht. </p><br><img alt="KY-023" width="200" src="https://habrastorage.org/webt/kn/qb/oe/knqboerydcnmgjguaidv8ctyycg.jpeg"><br><h4 id="ads1115">  ADS1115 </h4><br><p>  Dieses Problem wurde vom ADS1115-Modul gel√∂st. </p><br><img alt="ADS1115" width="200" src="https://habrastorage.org/webt/_r/8n/f-/_r8nf-9rsvzupsigrs2f7q2k59a.jpeg"><br><p>  Das Modul wurde mit dem Game HAT verl√∂tet und mit 3M-Band daran befestigt.  Die Messwerte werden an den Mittelschenkeln der variablen Widerst√§nde am Joystick gemessen.  Es sieht so aus: </p><br><img alt="Mein Spielhut" width="600" src="https://habrastorage.org/webt/0v/zx/yt/0vzxythizaow9qadldo2mdvma7w.jpeg"><br><p>  Der Joystick ist ebenfalls in den Game HAT eingel√∂tet.  Die Dr√§hte sind mit den Game HAT-Anschl√ºssen verl√∂tet, die den Stromversorgungs- und I2C-Anschl√ºssen der Himbeere entsprechen.  Schaltplan: </p><br><img alt="Fernbedienung" width="800" src="https://habrastorage.org/webt/x3/7g/nc/x37gnce-kbcv8ec9shm0par52ai.jpeg"><br><p>  Damit ist die Hardware-Sammlung des Bedienfelds abgeschlossen.  √Ñu√üerlich hat er keine sichtbaren Ver√§nderungen erfahren. </p><br><h4 id="12-mashinka">  1.2 Maschine </h4><br><p>  Wie schrecklich alles unter der Haube aussieht: </p><br><img alt="Auto" width="800" src="https://habrastorage.org/webt/mi/mw/ii/mimwiiy-4lj44y5ag-lpmp4rfb8.jpeg"><br><p>  Lass es uns richtig machen. </p><br><p>  Komponenten </p><br><ul><li>  Himbeer pi 3 </li><li>  Himbeer-Pi-Kamera v2 NoIR </li><li>  PCA9685 PWM-Generator </li><li>  Mini-360-Abw√§rtswandler </li><li>  Laderegler BMS CF-4S30A-A </li><li>  Motorsteuerungstreiber L298N </li><li>  Meine Lichtsteuerkarte basiert auf dem L293-Treiber </li><li>  3 Lithium-Ionen-Batterien 18650 </li><li>  370 Motor </li><li>  DI-1181MG Servo </li></ul><br><h4 id="pitanie">  Ern√§hrung </h4><br><p>  Beginnen wir mit der Stromversorgung, die von drei 18650-Batterien geliefert wird, die in Reihe geschaltet sind und ~ 12 Volt liefern. <br>  Die Batterien werden √ºber die BMS CF-4S30A-A-Karte angeschlossen, damit sie auf dem Pokatushki aufgeladen und nicht auf Null entladen werden k√∂nnen. </p><br><img alt="4S 40A BMS" width="200" src="https://habrastorage.org/webt/xt/q0/_k/xtq0_k_ycvqpeuivas6r8jnbgpw.jpeg"><br><p>  Dieses Board ist jedoch f√ºr 4 Batterien ausgelegt und wurde f√ºr die Arbeit mit 3 Batterien √ºberarbeitet.  Warum wurde sie genommen und nicht 3S 40A BMS.  Weil sie zur Hand war. </p><br><p>  √Ñnderungsschema: </p><br><img alt="4S 40A BMS" width="450" src="https://habrastorage.org/webt/nl/li/-y/nlli-yxzn84k_lmtodkhozqaeog.jpeg"><br><p>  Diese Spannung speist den 370-Motor √ºber den L298N-Treiber. </p><br><img alt="370" width="300" src="https://habrastorage.org/webt/s6/9b/of/s69bof6t16zmpse8jn29at93ifa.jpeg"><br><img alt="L298N" width="300" src="https://habrastorage.org/webt/_l/vi/t4/_lvit4ox1-doo6kw8mjpixsvkny.jpeg"><br><p>  F√ºr die Stromversorgung der Himbeere wird die Spannung derselben Batterien verwendet, die jedoch vom Mini-360-Modul auf 5 Volt reduziert wird. </p><br><img alt="Mini-360" width="200" src="https://habrastorage.org/webt/ag/zn/ra/agznrap593x3j6t4doyakiukgzo.jpeg"><br><p>  Himbeere direkt auf den Beinen. </p><br><h4 id="dvizhenie">  Bewegung </h4><br><p>  Sprechen wir jetzt dar√ºber, wie das Auto f√§hrt.  Zur Steuerung des Lenkmechanismus wird ein DI-1181MG-Servoantrieb verwendet, der √ºber den PCA9685 gesteuert wird.  PCA9685 ist auch f√ºr die Steuerung des Motors verantwortlich, indem seine Geschwindigkeit und Drehrichtung √ºber den L298N-Treiber angepasst werden.  Raspberry steuert auch den PCA9685 am I2C-Bus.  Der PCA9685 wird mit einem Abw√§rtswandler mit 5 Volt betrieben.  Dies reicht f√ºr Servos und Motorsteuerung.  Der Motor ist an zwei L298N-Ausg√§nge angeschlossen, um die Leistung zu erh√∂hen. </p><br><img alt="DI-1181MG" width="170" src="https://habrastorage.org/webt/km/wm/_b/kmwm_b7oben_iuu1rhyntdu7bru.jpeg"><br><img alt="PCA9685" width="200" src="https://habrastorage.org/webt/zr/3k/k2/zr3kk2nhhqub8p63mmo0ghelcea.jpeg"><br><h4 id="video">  Video </h4><br><p>  F√ºr das Video, das ich mit Camera v2 NoIR verwendet habe, kann es problemlos mit Raspberry verbunden werden.  Es gab jedoch einige Verbesserungen.  Die Standardschlaufe der Kamera war 15 cm lang, was f√ºr Installationsarbeiten nicht ausreichte.  Diese Schleife ist ebenfalls nicht Standard, sie hat 15 Pins.  Auf aliexpress wollen die Chinesen f√ºr eine lange Schleife f√ºr diese Kamera mehr als 1000 Rubel.  Daher wurde ein Satz von 10 Standard-16-Pin-Schleifen f√ºr 300 Rubel gekauft.  Mithilfe der Hightech-Technologie f√ºr die Verwendung von B√ºroscheren wurde ein 15-poliges Kabel f√ºr die Kamera √ºberarbeitet. </p><br><img alt="Kamera" width="300" src="https://habrastorage.org/webt/1m/vl/am/1mvlamazfobyscudex2p3xx7d6i.jpeg"><br><img alt="Zeichenfolge" width="300" src="https://habrastorage.org/webt/-t/jp/uv/-tjpuv287l5c191kgkjdee_nawm.jpeg"><br><p>  Zum Zeitpunkt des Schreibens, im 2. Monat, warte ich auf die Halterung f√ºr die Kamera in der Kabine.  Bisher zeigt die Maschine nur die Decke) </p><br><h4 id="svet">  Das Licht </h4><br><p>  Die Maschine hat bereits regul√§res Licht installiert, bestehend aus Scheinwerfern mit 2 gelben LEDs.  Es bleibt nur, um sie anzutreiben. <br>  Das Licht wird √ºber mein Board gesteuert, das auf dem L293-Treiber basiert.  Die Stromversorgung der Dioden erfolgt √ºber einen Widerstand.  Die Platine wird mit LUT-Technologie hergestellt.  Es hat auch eine Reihe von Spuren f√ºr die Stromverkabelung. <br>  Es w√§re m√∂glich, PCA9685 zur Steuerung des Lichts zu verwenden. Zu der Zeit, als ich mein eigenes machte, wusste ich nichts √ºber PCA9685 und konnte darauf verzichten. </p><br><p>  Leiterplatte: </p><br><img alt="mein Fahrer" width="500" src="https://habrastorage.org/webt/i0/c1/qx/i0c1qxlmibkwb5yiph3ijkv7d0o.jpeg"><br><p>  Ich werde das allgemeine Verbindungsdiagramm vorstellen: </p><br><img alt="alle" src="https://habrastorage.org/webt/yi/45/63/yi4563ligy60oj5mzjg_-r2xb9k.jpeg"><br><p>  Aber das stand in der Schreibmaschine, bis ich kletterte)) </p><br><img alt="alt" width="200" src="https://habrastorage.org/webt/zh/i0/k8/zhi0k8fol1yt0e_wlnglzihgcvq.jpeg"><br><p>  Zum Zeitpunkt des Schreibens hatte ich bereits begonnen zu vergessen, was ich tat und wie.  Obwohl seit dem Berg nicht mehr als ein Monat vergangen ist. </p><br><p>  Alles ist in Hardware.  In meinem n√§chsten Artikel werde ich den Softwareteil des animierten Eisens beschreiben. </p><br><h3 id="blagodarnost">  Dankbarkeit </h3><br><p>  Meine Arbeitskollegen: Andrei und Nikolai f√ºr die Hilfe beim Eisen, Anton und Eugene f√ºr die Hilfe beim Video.  Samodelkin-22 f√ºr LUT meines Boards.  Und Murzik. </p><br><h3 id="ssylki">  Referenzen </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462283/">https://habr.com/ru/post/de462283/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462271/index.html">Sperrcode in iOS: Wie Apple von Verteidigung zu Verteidigung zur Bewachung einer einzelnen Grenze wechselte</a></li>
<li><a href="../de462273/index.html">Verwalten Sie Ihren Laptopst√§nder mit digispark</a></li>
<li><a href="../de462275/index.html">Einf√ºhrung in PVS-Studio Static Analyzer f√ºr Java</a></li>
<li><a href="../de462277/index.html">Technisches Release Mail.ru Group 2019</a></li>
<li><a href="../de462279/index.html">Konstruktion von Verhaltenstrichtern in der R-Sprache basierend auf Daten, die von der Yandex.Metrica Logs API erhalten wurden</a></li>
<li><a href="../de462293/index.html">Wie schnelle Entwicklungstechnologien zu unangenehmen Sicherheitsl√ºcken f√ºhren k√∂nnen</a></li>
<li><a href="../de462295/index.html">Die Verzeichnisgr√∂√üe ist unsere M√ºhe nicht wert</a></li>
<li><a href="../de462297/index.html">Habr Weekly # 12 / OneWeb, Stationen gegen Aggregatoren, Geh√§lter in der IT, "Liebes, wir t√∂ten das Internet" waren in der Russischen F√∂deration nicht erlaubt</a></li>
<li><a href="../de462299/index.html">Rundung auf das Ganze in .NET</a></li>
<li><a href="../de462301/index.html">Geheimnisse, Tipps, Tricks: So erstellen Sie eine coole Aktion f√ºr Google Assistant</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>