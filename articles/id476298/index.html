<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏈 👏🏾 🚠 Pergi melalui duri untuk sepeda, bagian satu: mempelajari dasar-dasar menyesuaikan debugger Visual Studio menggunakan plugin 🕣 👇🏼 🏴󠁧󠁢󠁳󠁣󠁴󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salah satu inovasi Visual Studio 2012 disertai dengan penampilan debugger kustom baru yang disebut Concord. Sistem komponennya memungkinkan plug-in VS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pergi melalui duri untuk sepeda, bagian satu: mempelajari dasar-dasar menyesuaikan debugger Visual Studio menggunakan plugin</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476298/"><img src="https://habrastorage.org/webt/kl/8o/1x/kl8o1xvmgggvg_ssk6tb72xz6se.png" align="right">  Salah satu inovasi Visual Studio 2012 disertai dengan penampilan debugger kustom baru yang disebut Concord.  Sistem komponennya memungkinkan plug-in VSIX untuk menyesuaikan perilaku debugger dan menulis alat baru yang peka konteks yang dapat menggunakan debugger untuk kebutuhan mereka.  API-nya menyediakan banyak fitur QOL, seperti mengatur di antara kode yang dikelola / tidak dikelola, integrasi tanpa batas dengan proses jarak jauh / lokal yang dibajak, dan banyak lagi.  Faktanya, hampir semua yang dapat dilakukan dalam IDE dapat dilakukan secara terprogram menggunakan Concord API!  Ubah nilai variabel tertentu dengan cepat, fungsi panggilan atas permintaan (atau secara khusus membuat program lewati panggilan ke mereka!), Plugin dapat mencari dengan PDB (!), Memotong langkah-demi-langkah dan bahkan modifikasi kode!  Buka kucing dan Anda akan belajar tentang inovasi yang tidak banyak diketahui di bidang konstruksi sepeda ini. <br><a name="habracut"></a><br>  Anda mungkin harus mulai dari awal.  Debugger mendeteksi komponen dengan membaca informasi dari file <i>vsdconfig yang</i> dirujuk oleh manifes dari plugin VSIX.  Pada gilirannya, <i>vsdconfig</i> menunjukkan antarmuka mana yang diimplementasikan oleh komponen plugin dan bagaimana menemukan komponen-komponen ini (tautan ke file .dll, yang menunjukkan kelas atau, dalam hal implementasi asli, menunjukkan CLSID. Saya akan memberikan contoh dalam C #).  Juga, pengidentifikasi unik (GUID) untuk setiap komponen diindikasikan, serta "level" -nya.  Level adalah apa yang menentukan dalam urutan apa plugin akan diproses, serta dalam konteks proses mana implementasi ini akan dimuat - ke dalam proses IDE atau ke dalam proses aplikasi debugged.  Ini disebabkan oleh kenyataan bahwa beberapa fungsionalitas hanya dapat berfungsi dalam konteks IDE, dan sebaliknya - hanya dalam konteks proses yang di-debug.  Beberapa fungsi API bekerja dengan cara yang sama di sana-sini.  Juga, sejumlah komponen memiliki aturan tata letak sendiri, karena mereka mungkin bergantung pada elemen debugger yang ada yang terletak di tingkat tetap mereka.  Untuk menghindari insiden, saya sarankan RTFM (https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.componentinterfaces?view=visualstudiosdk-2017) dan eksperimen independen dalam kotak pasir terpisah, yang tidak akan disayangkan hapus jika sesuatu terjadi (ini terhubung, sekali lagi, dengan nuansa seperti itu - dalam beberapa kasus bahkan tidak jelas mengapa perakitan atau tipe tidak memuat, karena saya masih tidak dapat menemukan di mana log akan muncul yang akan memberi sinyal masalah secara stabil. Kesalahan, misalnya, dengan merujuk pada ketergantungan yang tidak dapat dimuat ke proses target, mungkin muncul di st output  di-, atau tidak. Jadilah akuratno, sering-seringlah komit, <s>dan tidak duduk di belakang mabuk roda).</s> <br><br>  Daftar level adalah sebagai berikut (Saya akan memberikan teks dalam bahasa Inggris sehingga pembaca tidak memiliki insiden ketika melakukan tindakan RFTM): <br><br>  Level komponen IDE (nilai&gt; 100.000): <br><div class="scrollable-table"><table><tbody><tr><th>  Komponen </th><th>  Tingkat komponen </th></tr><tr><td>  AD7 AL </td><td>  1.000.000.000 </td></tr><tr><td>  Penyedia pembongkaran </td><td>  9.998.000 </td></tr><tr><td>  Stack Query - Komponen yang ingin menanyakan tumpukan panggilan </td><td>  9.997.000 </td></tr><tr><td>  Penyedia tumpukan </td><td>  9.996.000 </td></tr><tr><td>  Stack filter - tingkat di mana tumpukan dapat disaring dan dijelaskan </td><td>  9.995.000 </td></tr><tr><td>  Manajer breakpoint </td><td>  9.994.000 </td></tr><tr><td>  Evaluasi Ekspresi IDE </td><td>  9.992.000 </td></tr><tr><td>  Symbol Stack Walkers - stack walker yang membutuhkan akses ke simbol </td><td>  9,991,000 </td></tr><tr><td>  IDE SymbolProvider - Komponen yang memberikan informasi simbol ke seluruh debugger.  Jalur simbol tidak boleh digunakan di bawah level ini. </td><td>  1.999.000 </td></tr></tbody></table></div><br>  Tingkat komponen proses target (nilai &lt;99,999): <br><div class="scrollable-table"><table><tbody><tr><th>  Komponen </th><th>  Tingkat komponen </th></tr><tr><td>  Monitor Symbol Provider - Penyedia simbol ketika status simbolis dibangun pada komputer target (mis: penerjemah, kode yang dikompilasi / dikeluarkan secara dinamis) </td><td>  75.000 </td></tr><tr><td>  Breakpoint Condition Processor - Level ini untuk memproses kondisi breakpoint seperti ekspresi kondisi dan jumlah hit.  Di bawah titik ini semua peristiwa breakpoint fisik akan terlihat terlepas dari apakah mereka memiliki kondisi salah atau tidak. </td><td>  70.000 </td></tr><tr><td>  Monitor Penyedia Tugas - Ini adalah level untuk penggalian data tugas dalam proses target </td><td>  65.500 </td></tr><tr><td>  Monitor Evaluator Ekspresi </td><td>  65.000 </td></tr><tr><td>  Koordinasi Monitor - Komponen yang melakukan arbitrase di antara berbagai monitor untuk melangkah, breakpoint berdasarkan alamat asli, stack walk, dll. </td><td>  60.000 </td></tr><tr><td>  Monitor stack walker </td><td>  55.000 </td></tr><tr><td>  Custom Debug Monitor - Dicadangkan untuk monitor debug pihak ketiga yang ingin memanfaatkan layanan yang disediakan oleh monitor debug standar. </td><td>  40.500 </td></tr><tr><td>  Runtime Debug Monitor - Menyediakan inspeksi data dan kontrol pelaksanaan untuk kode yang dikelola / asli / skrip </td><td>  40.000 </td></tr><tr><td>  Monitor debug dasar </td><td>  10.000 </td></tr><tr><td>  Layanan Monitor Debug Dasar - menyediakan layanan utilitas untuk monitor debug dasar (mis: pembuatan proses) serta layanan pra-debugging (mis: enumerasi proses) </td><td>  1.000 </td></tr></tbody></table></div><br>  Selanjutnya, secara berurutan, proses membuat proyek.  Jika tidak ada nuansa penting, saya bisa menggambarkan proses ini minimal atau melewatkannya sama sekali, tetapi kenyataannya sangat berbeda - kita memerlukan sejumlah dependensi perpustakaan, serta alat untuk membuat file konfigurasi, yang karena alasan tertentu tidak didistribusikan dengan VisualStudio, tetapi tersedia hanya dengan nuget.  Bahkan, sekarang kita perlu beralih ke esensi.  Proses membuat dan menyiapkan proyek disusun sebagai berikut: <br><br><ol><li>  Buka Visual Studio.  Dalam kasus saya, Edisi Komunitas 2017 </li><li>  Proyek VSIX ( <i>Visual C # -&gt;</i> tab <i>Extensibility</i> , atau melalui pencarian).  Sebut saja "HelloVSIX" </li><li>  Tambahkan proyek perpustakaan kelas baru dalam solusi, dan menyebutnya "DebuggeePlugin" </li><li>  Kami menempatkan referensi pada proyek "DebuggeePlugin" di proyek "HelloVSIX" </li><li>  Kami menempatkan referensi ke majelis "Microsoft.VisualStudio.Debugger.Engine" di proyek DebuggeePlugin </li><li>  Tambahkan referensi untuk paket nuget Microsoft.VSSDK.Debugger.VSDConfigTool ke proyek "DebuggeePlugin".  Ini adalah alat kami untuk menghasilkan konfigurasi VSD. </li></ol><br>  Sekarang, kami siap membuat plugin kami melakukan sesuatu yang bermanfaat.  Mari kita lakukan hal paling sederhana yang dapat Anda lakukan - biarkan ia menampilkan MessageBox yang mengatakan "Hello VSIX" ketika proses target menemukan titik masuk.  Untuk melakukan ini, kita perlu membuat kelas yang mengimplementasikan antarmuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> , serta mengisi beberapa file konfigurasi.  Tambahkan kelas publik baru yang disebut DkmEntryPointNotificationService, dan mewarisi antarmuka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> , dan biarkan implementasi default untuk saat ini: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); } } }</code> </pre> <br>  Tambahkan file "DkmEntryPointNotificationService.vsdconfigxml" ke proyek "DebuggeePlugin".  Untuk setiap kelas yang dideklarasikan yang harus menerima pemberitahuan melalui implementasi antarmuka namespace Microsoft.VisualStudio.Debugger.ComponentInterfaces, Anda harus memiliki file seperti itu.  Omong-omong, dimungkinkan untuk mengimplementasikan beberapa antarmuka seperti itu sekaligus dalam satu kelas.  Sekarang kita perlu mengubah action build dari file ".vsdconfigxml" kita.  Untuk melakukan ini, Anda harus mengedit file proyek secara manual (saya serius).  Kami membongkar proyek DebuggeePlugin, dan membukanya dengan editor studio.  Kami perlu menemukan tag XLM berikut: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">None</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  dan pindahkan tag ini ke ItemGroup Anda sendiri, ubah jenisnya dari Tidak Ada menjadi VsdConfigXmlFiles: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VsdConfigXmlFiles</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Anda dapat menyimpan dan memuat kembali proyek. <br><br>  Sekarang, buka konfigurasi.  Hal pertama yang harus dilakukan: jika file vsdconfig.xsd ditambahkan ke proyek DebuggeePlugin, maka itu harus dihapus.  Kami akan menggantinya sekarang, karena lebih mudah untuk bekerja dengan teks mentah.  Buka DkmEntryPointNotificationService.vsdconfigxml dan ganti teks dengan yang berikut ini: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">^_^quot𘙮quot^_^</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AssemblyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NoFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IDkmEntryPointNotification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Dalam file semacam itu, kami akan diminta untuk menunjukkan hal-hal berikut: <br><br><ol><li>  ComponentId - nilai ini dapat dihasilkan menggunakan alat pembuatan GUID (Alat -&gt; CreateGUID) </li><li>  ComponentLevel adalah level komponen kami dalam hierarki.  Lihat tabel di atas dan bantu informasi tentang MSDN untuk memilih rentang nilai yang diinginkan. </li><li>  Assemblyname adalah nama pertemuan kami (bukan solusi!).  Dalam hal ini, akan ada DebuggeePlugin </li><li>  Nama Kelas - harus ditunjukkan termasuk namespace tempat kelas tersebut berada.  Dalam hal ini, DebuggeePlugin.DkmEntryPointNotificationService </li><li>  Array InterfaceGroup - setiap entri di dalamnya menunjukkan antarmuka yang diimplementasikan oleh komponen ini.  Di dalam setiap simpul InterfaceGroup, harus ada sub-simpul yang menunjukkan antarmuka umum untuk semua, dalam grup ini, filter, tetapi tentang filter nanti.  Sekarang kami hanya memiliki satu simpul Antarmuka, dan membawa nama antarmuka IdkmEntryPointNotification.  Jika kami memiliki beberapa antarmuka, akan ada beberapa node Interface. </li></ol><br>  Biarkan saya mengingatkan Anda bahwa untuk setiap kelas yang harus menerima pemberitahuan dari debugger, harus ada file seperti itu.  Tapi kesenangan tidak berakhir di sana.  Setiap file seperti itu, selanjutnya, dikumpulkan dalam file .vsdconfig di direktori output proyek.  Dan mereka harus dirujuk dalam manifes plugin.  Ini dilakukan sebagai berikut: <br><br><ol><li>  Setelah kita membentuk file ".vsdconfigxml", kita harus ... mengumpulkan solusinya sekali, kalau tidak kita tidak akan memiliki file .vsdconfig di direktori output proyek) </li><li>  Setelah itu, buka editor teks untuk file source.extension.vsixmanifest dan tambahkan kode berikut sebelum tag PackageManifest penutup: </li></ol><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Asset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggerEngineExtension"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.vsdconfig"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Jika, setelah tindakan selesai, file "DebuggeePlugin.vsdconfig" muncul di proyek HelloVSIX, itu harus <b>DIHAPUS DARI PROYEK</b> dan solusinya harus dikumpulkan lagi, jika tidak maka tidak akan diperbarui. <br><br>  Pekerjaan persiapan sudah selesai!  Anda dapat mulai men-debug plugin kami.  Ini dilakukan dengan memulai instance eksperimental VisualStudio (untuk proyek VSIX ini adalah target debug default, jadi tidak diperlukan langkah-langkah tambahan).  Sebenarnya, kita klik Debug-&gt; StartDebugging dan kita melihat contoh eksperimental dari VisualStudio.  Di dalamnya, secara default, plugin kami harus sudah diinstal.  Anda dapat memverifikasi ini melalui Alat-&gt; Ekstensi dan menu pembaruan. <br><br>  Karena kami menerapkan antarmuka IDkmEntryPointNotification, kami harus membuat proyek uji coba dalam contoh eksperimental VisualStudio.  Sebenarnya, kami membuat proyek baru, pilih <b>C ++ -&gt; Aplikasi Konsol</b> (pilih C ++, karena contoh berikut ini akan berisi spesifik C ++), sebut saja <b>VSIXTestApp</b> , jalankan tanpa perubahan apa pun, kumpulkan dan lihat bahwa contoh eksperimental kami berhenti melemparkan pengecualian di dalam metode DebuggeePlugin. DkmEntryPointNotificationService.OnEntryPoint.  Hebat!  Sekarang Anda perlu menunjukkan MessageBox.  Untuk melakukan ini, perlu menambahkan referensi berikut ke proyek DebuggeePlugin: <br><br><ul><li>  Microsoft.VisualStudio.Shell.15.0 </li><li>  Microsoft.VisualStudio.Shell.Interop </li><li>  Microsoft.VisualStudio.Shell.Interop.8.0 </li><li>  Microsoft.VisualStudio.OLE.Interop </li></ul><br>  Tambahkan dua penggunaan di awal file DkmEntryPointNotificationService.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop;</code> </pre><br>  Dan tambahkan panggilan ke metode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">VsShellUtilities.ShowMessageBox</a> di metode DkmEntryPointNotificationService.OnEntryPoint: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { VsShellUtilities.ShowMessageBox(Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, OLEMSGICON.OLEMSGICON_INFO, OLEMSGBUTTON.OLEMSGBUTTON_OK, OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST); } } }</code> </pre><br>  Kami membangun kembali, meluncurkan contoh eksperimental studio, meluncurkan proyek uji dan voila! <br><br>  Kami melihat bahwa instance uji dari studio membuat MessageBox! <br><br><img src="https://habrastorage.org/webt/2c/a7/fd/2ca7fdpdvkt3z_fscr76xskl7rk.png"><br><br>  Dan apa manfaatnya? <br><br>  Di sini kami belajar cara mengatur proyek VSIX yang berisi plug-in untuk Visual Studio debugger, dengan mempertimbangkan sebagian besar nuansa yang menghalangi hasil.  Ini adalah titik awal untuk pekerjaan yang lebih detail.  Pada artikel berikutnya, saya akan menunjukkan kepada Anda poin penting lainnya: bagaimana komunikasi antara IDE dan komponen target Debug dilakukan. <br><br>  Untuk bantuan lebih lanjut menggunakan Concord API, Anda dapat merujuk tidak hanya ke MSDN, tetapi juga ke repositori Microsoft berikut di github: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">github.com/microsoft/PTVS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" rel="nofollow">github.com/Microsoft/ConcordExtensibilitySamples</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id476298/">https://habr.com/ru/post/id476298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id476288/index.html">5 kerangka JS Top untuk pengembangan front-end pada tahun 2020. Bagian 2</a></li>
<li><a href="../id476290/index.html">Kesalahan dalam Menangani Express</a></li>
<li><a href="../id476292/index.html">SVG atau kanvas?</a></li>
<li><a href="../id476294/index.html">Jaringan game yang didistribusikan sebagai alternatif untuk GFN: bagaimana dan mengapa itu bisa lepas landas, di mana ia sudah bekerja di Federasi Rusia</a></li>
<li><a href="../id476296/index.html">21 November, Rapat Rekayasa Produk: Siapa Insinyur Produk?</a></li>
<li><a href="../id476300/index.html">Majalah Tram adalah bintang yang terang dan cepat pudar dari avant-garde anak-anak Rusia</a></li>
<li><a href="../id476304/index.html">Otentikasi dongle perangkat keras perangkat Linux pada sistem tingkat atas</a></li>
<li><a href="../id476306/index.html">Instruksi TelegramBot untuk membuat fungsionalitas dasar untuk bot. (Bagian 1)</a></li>
<li><a href="../id476308/index.html">5 Praktik Pengembangan Perangkat Lunak Teratas yang Diikuti pada tahun 2020</a></li>
<li><a href="../id476310/index.html">CRM wajah manusia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>