<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíã üöµüèæ üöô O processamento de erros irrecuper√°veis ‚Äã‚Äãno Swift üóùÔ∏è üë®üèº‚Äçü§ù‚Äçüë®üèª üåá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pref√°cio 


 Este artigo √© um exemplo de como podemos fazer pesquisas sobre o comportamento das fun√ß√µes da Swift Standard Library, construindo nosso c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O processamento de erros irrecuper√°veis ‚Äã‚Äãno Swift</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440884/"><h2 id="preface">  Pref√°cio </h2><br><p> Este artigo √© um exemplo de como podemos fazer pesquisas sobre o comportamento das fun√ß√µes da Swift Standard Library, construindo nosso conhecimento n√£o apenas na documenta√ß√£o da Biblioteca, mas tamb√©m em seu c√≥digo-fonte. </p><br><h2 id="unrecoverable-errors">  Erros irrecuper√°veis </h2><br><p>  Todos os eventos que os programadores chamam de "erros" podem ser separados em dois tipos. </p><br><ul><li>  Eventos causados ‚Äã‚Äãpor fatores externos, como uma falha na conex√£o de rede. </li><li>  Eventos causados ‚Äã‚Äãpor erro de um programador, como chegar a um caso de operador de switch que deve estar inacess√≠vel. </li></ul><a name="habracut"></a><br><p>  Os eventos do primeiro tipo s√£o processados ‚Äã‚Äãem um fluxo de controle regular.  Por exemplo, reagimos √† falha de rede mostrando uma mensagem para um usu√°rio e configurando um aplicativo para aguardar a recupera√ß√£o da conex√£o de rede. </p><br><p>  Tentamos descobrir e eliminar eventos do segundo tipo o mais cedo poss√≠vel antes que o c√≥digo seja produzido.  Uma das abordagens aqui √© executar algumas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verifica√ß√µes em tempo de execu√ß√£o, encerrando a execu√ß√£o do programa</a> em um estado depur√°vel e imprimir uma mensagem com uma indica√ß√£o de onde no erro ocorreu o c√≥digo. </p><br><p>  Por exemplo, um programador pode encerrar a execu√ß√£o se o inicializador necess√°rio n√£o foi fornecido, mas foi chamado.  Isso ser√° notado e corrigido invariavelmente durante a primeira execu√ß√£o de teste. </p><br><pre><code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">required</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>?(coder aDecoder: <span class="hljs-type"><span class="hljs-type">NSCoder</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">fatalError</span></span>(<span class="hljs-string"><span class="hljs-string">"init(coder:) has not been implemented"</span></span>) }</code> </pre> <br><p>  Outro exemplo √© a altern√¢ncia entre √≠ndices (vamos supor que, por algum motivo, voc√™ n√£o possa usar a enumera√ß√£o). </p><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> index { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">// something is done here case 1: // other thing is done here case 2: // and other thing is done here default: assertionFailure("Impossible index") }</span></span></code> </pre> <br><p>  Novamente, um programador causar√° falha durante a depura√ß√£o aqui, a fim de observar inevitavelmente um erro na indexa√ß√£o. </p><br><p>  Existem cinco fun√ß√µes de termina√ß√£o na Swift Standard Library (como no Swift 4.2). </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">precondition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> condition: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span>, <span class="hljs-number"><span class="hljs-number">_</span></span> message: <span class="hljs-meta"><span class="hljs-meta">@autoclosure</span></span> () -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">preconditionFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line) -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span></code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> condition: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span>, <span class="hljs-number"><span class="hljs-number">_</span></span> message: <span class="hljs-meta"><span class="hljs-meta">@autoclosure</span></span> () -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assertionFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line)</code> </pre> <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fatalError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message: @autoclosure </span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, file: <span class="hljs-type"><span class="hljs-type">StaticString</span></span> = #file, line: <span class="hljs-type"><span class="hljs-type">UInt</span></span> = #line) -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span></code> </pre> <br><p>  <strong>Qual das cinco fun√ß√µes de termina√ß√£o devemos preferir?</strong> </p><br><h2 id="source-code-vs-documentation">  C√≥digo-fonte vs documenta√ß√£o </h2><br><p>  Vamos dar uma olhada no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo fonte</a> .  Podemos ver o seguinte imediatamente: </p><br><ol><li>  Cada uma dessas cinco fun√ß√µes finaliza a execu√ß√£o do programa ou n√£o faz nada. </li><li>  Poss√≠vel encerramento ocorre de duas maneiras. <br><ul><li>  Com a impress√£o de uma mensagem de depura√ß√£o conveniente chamando <code>_assertionFailure(_:_:file:line:flags:)</code> . </li><li>  Sem a mensagem de depura√ß√£o, chamando <code>Builtin.condfail(error._value)</code> ou <code>Builtin.int_trap()</code> . </li></ul></li><li>  A diferen√ßa entre as cinco fun√ß√µes de termina√ß√£o est√° nas condi√ß√µes sob as quais todas as op√ß√µes acima acontecem. </li><li>  <code>fatalError(_:file:line)</code> chama <code>_assertionFailure(_:_:file:line:flags:)</code> incondicionalmente. </li><li>  As outras quatro fun√ß√µes finais avaliam as condi√ß√µes chamando as seguintes fun√ß√µes de avalia√ß√£o da configura√ß√£o.  (Eles come√ßam com um sublinhado, o que significa que s√£o internos e n√£o devem ser chamados diretamente por um programador que usa a Swift Standard Library). <br><ul><li> <code>_isReleaseAssertConfiguration()</code> </li> <li> <code>_isDebugAssertConfiguration()</code> </li> <li> <code>_isFastAssertConfiguration()</code> </li> </ul></li></ol><br><p>  Agora vamos olhar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o</a> .  Podemos ver o seguinte imediatamente. </p><br><ol><li>  <code>fatalError(_:file:line)</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">imprime incondicionalmente uma determinada mensagem e interrompe a execu√ß√£o</a> . </li><li>  Os efeitos das outras quatro fun√ß√µes de termina√ß√£o variam dependendo do sinalizador de compila√ß√£o usado: <code>-Onone</code> , <code>-O</code> , <code>-Ounchecked</code> .  Por exemplo, consulte a documenta√ß√£o <code>preconditionFailure(_:file:line:)</code> . </li><li>  Podemos definir esses sinalizadores de compila√ß√£o no Xcode atrav√©s da <code>SWIFT_OPTIMIZATION_LEVEL</code> compila√ß√£o do <code>SWIFT_OPTIMIZATION_LEVEL</code> . </li><li>  Tamb√©m sabemos na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o</a> do Xcode 10 que mais um sinalizador de otimiza√ß√£o - <code>-Osize</code> - √© introduzido. </li><li>  Portanto, temos os quatro sinalizadores de otimiza√ß√£o a serem considerados. <br><ul><li>  <code>-Onone</code> (n√£o otimize) </li><li>  <code>-O</code> (otimizar velocidade) </li><li>  <code>-Osize</code> (otimizar para tamanho) </li><li>  <code>-Ounchecked</code> (desative muitas verifica√ß√µes do compilador) </li></ul></li></ol><br><p>  Podemos concluir que a configura√ß√£o avaliada nas quatro fun√ß√µes de termina√ß√£o √© definida por esses sinalizadores de constru√ß√£o. </p><br><h2 id="running-configuration-evaluation-functions">  Executando fun√ß√µes de avalia√ß√£o de configura√ß√£o </h2><br><p>  Embora as fun√ß√µes de avalia√ß√£o de configura√ß√£o sejam projetadas para uso interno, algumas delas s√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√∫blicas para fins de teste</a> , e podemos test√°-las atrav√©s da CLI, fornecendo os seguintes comandos no Bash. </p><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'print(_isFastAssertConfiguration())'</span></span> &gt;conf.swift $ swift conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Onone conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -O conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Osize conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Ounchecked conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'print(_isDebugAssertConfiguration())'</span></span> &gt;conf.swift $ swift conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span> $ swift -Onone conf.swift <span class="hljs-literal"><span class="hljs-literal">true</span></span> $ swift -O conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Osize conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span> $ swift -Ounchecked conf.swift <span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br><p>  Esses testes e a inspe√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo fonte</a> nos levam √†s seguintes conclus√µes aproximadas. </p><br><p>  Existem tr√™s configura√ß√µes mutuamente exclusivas. </p><br><ul><li>  <em>A</em> configura√ß√£o da <em>libera√ß√£o</em> √© definida fornecendo um <code>-Osize</code> constru√ß√£o <code>-O</code> ou <code>-Osize</code> . </li><li>  <em>A</em> configura√ß√£o de <em>depura√ß√£o</em> √© definida fornecendo um <code>-Onone</code> constru√ß√£o <code>-Onone</code> ou nenhum sinalizador de otimiza√ß√£o. </li><li>  <code>_isFastAssertConfiguration()</code> √© avaliado como <code>true</code> se um <code>-Ounchecked</code> constru√ß√£o <code>-Ounchecked</code> estiver definido.  Embora essa fun√ß√£o tenha uma palavra "r√°pido" em seu nome, ela n√£o tem nada a ver com a otimiza√ß√£o do sinalizador de velocidade-O build. </li></ul><br><p>  <strong>Nota:</strong> essas conclus√µes n√£o s√£o a defini√ß√£o estrita de quando as compila√ß√µes de <em>depura√ß√£o</em> ou compila√ß√£o ocorrem.  √â uma quest√£o mais complexa.  Mas essas conclus√µes est√£o corretas para o contexto de finaliza√ß√£o do uso de fun√ß√µes. </p><br><h2 id="simplifying-the-picture">  Simplificando a imagem </h2><br><h3 id="-ounchecked"> <code>-Ounchecked</code> </h3> <br><p>  N√£o vamos ver para <strong>que <code>-Ounchecked</code> sinalizador <code>-Ounchecked</code></strong> (√© irrelevante aqui), mas <strong>qual √© o seu papel</strong> no contexto de finaliza√ß√£o do uso de fun√ß√µes. </p><br><ul><li>  A documenta√ß√£o para a <code>precondition(_:_:file:line:)</code> - <code>precondition(_:_:file:line:)</code> e <code>assert(_:_:file:line:)</code> diz: "Nas compila√ß√µes <code>-Ounchecked</code> , a condi√ß√£o n√£o √© avaliada, mas o otimizador pode assumir que sempre avalia como verdadeiro. N√£o atender a essa suposi√ß√£o √© um erro de programa√ß√£o grave ". </li><li>  A documenta√ß√£o para <code>preconditionFailure(_:file:line)</code> e <code>assertionFailure(_:file:line:)</code> diz: "Nas compila√ß√µes <code>-Ounchecked</code> , o otimizador pode assumir que essa fun√ß√£o nunca √© chamada. Falha em satisfazer essa suposi√ß√£o √© um erro de programa√ß√£o grave. " </li><li>  Podemos ver no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo fonte</a> que a avalia√ß√£o de <code>_isFastAssertConfiguration()</code> como <code>true</code> <strong>n√£o deve ocorrer</strong> .  (Se isso acontecer, estranho <code>_conditionallyUnreachable()</code> √© chamado. Consulte as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">linhas 136 e</a> <code>_conditionallyUnreachable()</code> ) </li></ul><br><p>  Falando mais diretamente, voc√™ <strong>n√£o deve permitir a acessibilidade</strong> das quatro fun√ß√µes de encerramento a seguir com o <code>-Ounchecked</code> build <code>-Ounchecked</code> definido para o seu programa. </p><br><ul><li> <code>precondition(_:_:file:line:)</code> </li> <li> <code>preconditionFailure(_:file:line)</code> </li> <li> <code>assert(_:_:file:line:)</code> </li> <li> <code>assertionFailure(_:file:line:)</code> </li> </ul><br><p>  Use apenas <code>fatalError(_:file:line)</code> ao aplicar <code>-Ounchecked</code> e ao mesmo tempo permitindo que o ponto do seu programa com a <code>fatalError(_:file:line)</code> possa ser alcan√ßada. </p><br><h3 id="the-role-of-a-condition-check">  O papel de uma verifica√ß√£o de condi√ß√£o </h3><br><p>  Duas das fun√ß√µes de termina√ß√£o permitem verificar condi√ß√µes.  A inspe√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo-fonte</a> nos permite ver que, se a condi√ß√£o falhar, o comportamento da fun√ß√£o √© o mesmo que o de seu respectivo primo: </p><br><ul><li>  <code>precondition(_:_:file:line:)</code> se torna <code>preconditionFailure(_:file:line)</code> , </li><li>  <code>assert(_:_:file:line:)</code> torna-se <code>assertionFailure(_:file:line:)</code> . </li></ul><br><p>  Esse conhecimento facilita an√°lises adicionais. </p><br><h3 id="release-vs-debug-configurations">  Configura√ß√µes de vers√£o versus depura√ß√£o </h3><br><p>  Eventualmente, mais documenta√ß√£o e inspe√ß√£o do c√≥digo-fonte nos permitem formular a tabela a seguir. </p><br><p><img src="https://habrastorage.org/webt/x3/tq/vs/x3tqvsckgpqpyxso3flqfhyyddo.png" alt="Terminando fun√ß√µes"></p><br><p>  Agora est√° claro que a escolha mais importante para um programador √© como deve ser o comportamento do programa <strong>no <em>lan√ßamento,</em></strong> se uma verifica√ß√£o em tempo de execu√ß√£o revelar um erro. </p><br><p>  O principal argumento aqui √© que <code>assert(_:_:file:line:)</code> e <code>assertionFailure(_:file:line:)</code> tornam o impacto da falha do programa menos grave.  Por exemplo, um aplicativo iOS pode ter corrompido a interface do usu√°rio (desde que algumas verifica√ß√µes importantes de tempo de execu√ß√£o falharam), mas n√£o falha. </p><br><p>  Mas esse cen√°rio pode n√£o ser o desejado.  Voc√™ tem uma escolha. </p><br><h2 id="never-return-type">  <code>Never</code> retornar tipo </h2><br><p>  <code>Never</code> √© usado como um tipo de fun√ß√£o de retorno que lan√ßa incondicionalmente um erro, intercepta√ß√µes ou n√£o termina normalmente.  Na verdade, esses tipos de fun√ß√µes n√£o retornam, <strong>nunca</strong> retornam. </p><br><p>  Entre as cinco fun√ß√µes de termina√ß√£o, apenas <code>preconditionFailure(_:file:line)</code> e <code>fatalError(_:file:line)</code> retornam <code>Never</code> porque apenas essas duas fun√ß√µes interrompem incondicionalmente as execu√ß√µes de programas e, portanto, nunca retornam. </p><br><p>  Aqui est√° um bom exemplo de como usar <code>Never</code> digite um aplicativo de linha de comando.  (Embora este exemplo n√£o use as fun√ß√µes de encerramento da Swift Standard Library, mas a fun√ß√£o C <code>exit()</code> padr√£o). </p><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printUsagePromptAndExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Never</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"Usage: command directory"</span></span>) exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-type"><span class="hljs-type">CommandLine</span></span>.argc == <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { printUsagePromptAndExit() } <span class="hljs-comment"><span class="hljs-comment">// ...</span></span></code> </pre> <br><p>  Se <code>printUsagePromptAndExit()</code> retornar <code>Void</code> vez de <code>Never</code> , voc√™ receber√° um erro de compila√ß√£o com a mensagem " <em>o corpo do 'guard' n√£o deve cair, considere usar um 'return' ou 'throw' para sair do escopo</em> ".  Ao usar <code>Never</code> voc√™ est√° dizendo antecipadamente que <strong>nunca</strong> sai do escopo e, portanto, o compilador n√£o fornecer√° um erro no momento da cria√ß√£o.  Caso contr√°rio, voc√™ deve adicionar <code>return</code> no final do bloco do c√≥digo de guarda, o que n√£o parece agrad√°vel. </p><br><h2 id="takeaways">  Para viagem </h2><br><ul><li>  N√£o importa qual fun√ß√£o de t√©rmino usar se voc√™ tiver certeza de que todas as suas verifica√ß√µes de tempo de execu√ß√£o s√£o relevantes apenas para a configura√ß√£o de <em>Depura√ß√£o</em> . </li><li>  Use apenas <code>fatalError(_:file:line)</code> ao aplicar <code>-Ounchecked</code> e ao mesmo tempo permitindo que o ponto do seu programa com a <code>fatalError(_:file:line)</code> possa ser alcan√ßada. </li><li>  Use <code>assert(_:_:file:line:)</code> e <code>assertionFailure(_:file:line:)</code> se voc√™ estiver preocupado que as verifica√ß√µes de tempo de execu√ß√£o possam falhar de alguma forma no lan√ßamento.  Pelo menos seu aplicativo n√£o trava. </li><li>  Use <code>Never</code> para tornar seu c√≥digo organizado. </li></ul><br><h2 id="useful-links">  Links √∫teis </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">V√≠deo da WWDC "What's New in Swift",</a> que <code>SWIFT_OPTIMIZATION_LEVEL</code> sobre a configura√ß√£o de compila√ß√£o <code>SWIFT_OPTIMIZATION_LEVEL</code> (a partir de 11 minutos). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como nunca funciona internamente no Swift</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>NSHipster's article about nature of Never</code></a> </li> <li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Discuss√£o dos F√≥runs Swift</a> sobre a sugest√£o de descontinuar <code>-Ounchecked</code> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440884/">https://habr.com/ru/post/pt440884/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440872/index.html">PostGIS e JPA</a></li>
<li><a href="../pt440874/index.html">Implementando o movimento livre de part√≠culas no ReactJS</a></li>
<li><a href="../pt440878/index.html">An√°lise da Web para empresas</a></li>
<li><a href="../pt440880/index.html">Os 10 principais sensores de IoT em 2019</a></li>
<li><a href="../pt440882/index.html">Fuja do Crypto Pro. Edi√ß√£o GOST 34.10-2012</a></li>
<li><a href="../pt440886/index.html">Exclus√£o suave na API REST</a></li>
<li><a href="../pt440888/index.html">Testes independentes do Baikal-T1 - o primeiro SoC russo de 28 nm - e do Conselho de Avalia√ß√£o BFK 3.1</a></li>
<li><a href="../pt440890/index.html">Patriotismo em jogos de computador: a opini√£o de um ex-jogador</a></li>
<li><a href="../pt440892/index.html">A inesperada efici√™ncia de sequ√™ncias quase aleat√≥rias</a></li>
<li><a href="../pt440894/index.html">Criando som para o Pathfinder: Kingmaker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>