<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏴󠁧󠁢󠁳󠁣󠁴󠁿 👩‍❤️‍💋‍👨 🤾 魅力Android。 有关移动自动化的信息报告 ⛹🏻 🍈 ✋🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="该文章代表Andrey Ivanov和Ekaterina Bateeva （ neifmetus）发表 
 
 移动应用程序的自动化是一个相对年轻的领域：有许多框架，许多项目都面临着选择最“快速，稳定，易于使用”的问题。 大约两年前，我们还面临着用于测试Android应用程序的新自动化工具的选择。 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>魅力Android。 有关移动自动化的信息报告</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/433756/">  <i>该文章代表Andrey Ivanov和Ekaterina <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Bateeva</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">neifmetus）发表</a></i> <i><br></i> <br> 移动应用程序的自动化是一个相对年轻的领域：有许多框架，许多项目都面临着选择最“快速，稳定，易于使用”的问题。 大约两年前，我们还面临着用于测试Android应用程序的新自动化工具的选择。 <br> 所有流行的工具都以某种方式基于UIAutomator和Espresso，因此我们决定以纯格式对其进行测试，并与相同的Appium（最受欢迎）和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">seeTest</a> （之前使用过的，当时付费产品中最好的）进行比较。 <br><br> 在Appium的优势中，可以区分通常的WebDriver API，即使用大多数流行语言和库的能力。 此外，它已在许多公司中广泛使用，并允许您直接为iOS和Android平台编写测试。 最后，这是一个免费的盒装解决方案-有什么更好的选择？ <br><br> 因此，我们认为，直到发现以下缺点： <br><ul><li>  Appium服务器的稳定性低 </li><li> 您无法与Activity的公共方法进行交互（在2018年，来自Badoo的Nikolai Abalov在他的文章中谈到了在Appium中创建后门，您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>阅读） </li><li> 浓缩咖啡测试的速度大大低于 </li></ul><br> 对我们而言，这些时刻至关重要，因此决定围绕Espresso整合我们自己的工具集，以构建用于测试移动应用程序的生态系统。 <br><br> 因此，选择了框架，剩下的就是查找其余组件： <br><ol><li>  <b>亚军</b> -应该允许并行运行测试并配置设备池 </li><li>  <b>记者</b> -必须提供可读的报告，任何团队成员均可使用 </li></ol><br><a name="habracut"></a><br><h3> 工具 </h3><br> 跑步者一切都很好，在github上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">翻了翻</a> ，选择了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">shazam / fork</a> 。 <br> 它使您可以方便地配置设备池，易于修改，生成简单的html报告。 在堆栈跟踪测试和视频崩溃的情况下，Logcat将应用于每个报告。 视频录制无法正常工作，所有视频均为1分钟长，有时会在视频上记录一些测试。 <br><br><img src="https://habrastorage.org/webt/no/8r/bn/no8rbnpyzl3jbwin2vgje6renfs.png" alt="图片"><br><br> 分支报告远非理想，最终用户仅凭其名称就无法理解测试中正在发生的事情，而没有手头的测试用例。 我想使用带有文件附件的步骤，使我能够构建报告。 寻找记者进行仪器测试，得到了汤匙和黄瓜的2种变体。 放弃这两个选项是因为一堆关于黄瓜的汤匙和bdd的屏幕截图无法完全解决问题... <br><br> 魅力似乎是该问题的最佳解决方案： <br><ul><li> 步骤的嵌套，使您可以构建报告 </li><li> 记录定制测试数据（屏幕截图，视频，任务编号，测试参数）的能力 </li><li> 报告的简要视图 </li></ul><br> 但有一个警告，Allure根本无法在Android上启动。 <br><br><h3> 魅力安卓 </h3><br> 结合以上内容，决定编写一个库，该库结合了Kotlin的简洁和优雅，Allure框架的优点，并且可以在Android手机上使用。 为了连接该库，请将依赖项添加到仪器测试所在的模块中： <br><pre><code class="kotlin hljs">dependencies { androidTestImplementation <span class="hljs-string"><span class="hljs-string">"ru.tinkoff.allure:allure-android:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$allureVersion</span></span></span><span class="hljs-string">@aar"</span></span> androidTestImplementation <span class="hljs-string"><span class="hljs-string">"ru.tinkoff.allure:allure-common:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$allureVersion</span></span></span><span class="hljs-string">"</span></span> androidTestImplementation <span class="hljs-string"><span class="hljs-string">"ru.tinkoff.allure:allure-model:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$allureVersion</span></span></span><span class="hljs-string">"</span></span> }</code> </pre> <br><br> 设置依赖关系后，我们需要将<b>AllureRunListener</b>注册到负责运行android测试的类。 <br><br> 有三种方法可以做到这一点： <br><ol><li> 添加到<b>build.gradle</b> <pre> <code class="kotlin hljs">testInstrumentationRunner <span class="hljs-string"><span class="hljs-string">"ru.tinkoff.allure.android.AllureAndroidRunner"</span></span></code> </pre> </li><li> 将<b>侦听器</b>添加到Runner onCreate中的参数（参数：捆绑） <pre> <code class="kotlin hljs">arguments.putCharSequence(<span class="hljs-string"><span class="hljs-string">"listener"</span></span>, AllureAndroidListener::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">)</span></span></code> </pre> </li><li> 直接从AllureAndroidRunner继承 </li></ol><br><br> 魅力报告基于步骤-步骤，即在测试过程中执行的基本操作。 引人入胜的<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Step</a></b>和<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Parameter</a></b>框架注释已替换为对step（）函数的直接调用。 <br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T : Any?&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">step</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(description: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">vararg</span></span></span></span><span class="hljs-function"><span class="hljs-params"> params: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Parameter</span></span></span></span><span class="hljs-function"><span class="hljs-params">, block: ()</span></span></span></span> -&gt; T): T</code> </pre> <br> 此函数不仅可以一次替换两个注释，还可以接受一个lambda，您应该在其中包装测试逻辑。 例如： <br><img src="https://habrastorage.org/webt/i8/ud/lu/i8udluoqbpinz6krznamfhaw0gs.png" alt="图片"><br><br> 开始测试后，为Allure2准备的json格式的报告将显示在电话的/ sdcard / allure-results文件夹中。 通过拉出结果 <br><pre> <code class="bash hljs">adb pull /sdcard/allure-results</code> </pre> <br> 我们可以生成报告 <br><pre> <code class="bash hljs">allure generate</code> </pre> <br><br> 在其他功能中，我们可以区分： <br><ul><li> 相互投资的能力 </li><li> 您可以在任何地方调用deviceScreenshot（标签：String）获取屏幕截图，该屏幕截图将在当前步骤中自动附加到报告中 </li><li>  FailshotRule（）-junit4 Rule，将在坠落前拍摄屏幕截图 </li></ul><br><br> 这是在Android平台上使用Allure的概述。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub上</a>提供了allure-android解决方案，您可以详细了解并参与开发。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN433756/">https://habr.com/ru/post/zh-CN433756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN433746/index.html">读模因的马尔瓦尔</a></li>
<li><a href="../zh-CN433748/index.html">如何以及为什么在git中偷树</a></li>
<li><a href="../zh-CN433750/index.html">我们如何在克拉斯诺亚尔斯克度过冬季学校“数字嵌入式系统”</a></li>
<li><a href="../zh-CN433752/index.html">疯狂的卡桑德（Crazy Cassander）谈俄罗斯游戏设计教育的细微差别</a></li>
<li><a href="../zh-CN433754/index.html">Slack禁止从克里米亚开户</a></li>
<li><a href="../zh-CN433758/index.html">仿生假体：通过设计自我表达</a></li>
<li><a href="../zh-CN433760/index.html">选举，选举...</a></li>
<li><a href="../zh-CN433762/index.html">您如何在商店中选择商品？</a></li>
<li><a href="../zh-CN433764/index.html">我们创建了用于深入分析Google Play商店中应用程序评级的工具</a></li>
<li><a href="../zh-CN433768/index.html">为什么Android开发人员讨厌Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>