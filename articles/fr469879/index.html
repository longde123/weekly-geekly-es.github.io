<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚭 👨🏼‍💻 💗 Double VPN en un clic. Comment diviser facilement l'adresse IP d'un point d'entrée et de sortie 👨‍👧‍👧 🖕🏾 👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR Cet article décrit la façon la plus simple de configurer un serveur VPN, dont l'adresse IP pour la connexion des clients VPN est différente de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Double VPN en un clic. Comment diviser facilement l'adresse IP d'un point d'entrée et de sortie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vdsina/blog/469879/"><img src="https://habrastorage.org/webt/gu/ux/_r/guux_rw3bw9b6_0h617yyow4xrq.png"><br><br>  <b>TL; DR</b> <i>Cet article décrit la façon la plus simple de configurer un serveur VPN, dont l'adresse IP pour la connexion des clients VPN est différente de l'adresse IP à partir de laquelle les clients accèdent à Internet.</i> <br><br>  Utilisez-vous un VPN pour protéger la confidentialité sur Internet et louez-vous votre propre serveur pour cela?  Êtes-vous le seul client qui se connecte à ce serveur dans le monde entier?  Est-il si difficile de trouver votre véritable adresse IP, pensez-vous?  Avec l'entrée en vigueur du paquet Spring, cela devient beaucoup plus facile. <br><br>  <b>Le double VPN</b> est un sujet populaire autour duquel il y a beaucoup de spéculations.  Souvent, ce terme est appelé une technologie complètement différente, mais il signifie presque toujours une connexion Internet et des points d'accès espacés au niveau des adresses IP.  Nous considérerons la façon la plus simple de configurer un serveur VPN dans ce mode, qui ne nécessite pas de configuration supplémentaire côté serveur et vous permet d'obtenir la vitesse maximale et la latence la plus faible. <br><a name="habracut"></a><br><h2>  Modèle de menace </h2><br>  Afin de vous protéger de quelque chose, vous devez comprendre clairement le modèle de menace.  Nous ne parlerons pas de nouvelles lois obligeant les fournisseurs à stocker tout le trafic client, mais nous pouvons certainement dire que les données de connexion, les soi-disant  Netflow, le stockage est assez simple, et cela a été fait avec succès depuis longtemps.  Autrement dit, le fait de connecter une adresse IP conditionnelle <b><code>1.1.1.1</code></b> à l'adresse <b><code>2.2.2.2</code></b> à un certain moment de la journée est enregistré. <br><br>  Ayant accès à de telles informations à l'échelle du fournisseur, de la ville ou du pays, il suffit simplement d'établir qui se cache derrière le VPN. <br><br>  Pour augmenter le niveau de confidentialité lors de l'utilisation d'un VPN, vous devez séparer le point de connexion et le point d'accès Internet au niveau IP.  Dans l'image ci-dessus, notre utilisateur est derrière la clôture sous le contrôle d'Irina Yarovoy.  Toutes les connexions passant par la clôture, se souvient Irina strictement.  L'utilisateur, en tant que citoyen décent, se connecte à l'adresse <b><code>good.citizen.vpn</code></b> , tandis qu'il revient de l'adresse <b><code>super.cool.guy.vpn</code></b> .  Par conséquent, pour Irina, ces deux connexions semblent déconnectées. <br><br><h2>  Que sont les VPN doubles? </h2><br>  Sous le nom de VPN «double», on entend souvent différentes choses, mais cela signifie presque toujours des nœuds de connexion et d'accès à Internet espacés géographiquement ou au niveau du réseau.  Parfois, ce n'est qu'une astuce marketing des fournisseurs de VPN, ce qui ne veut absolument rien dire, de tels services peuvent être appelés VPN «triples» et «quadruples». <br><br>  Nous analyserons les schémas les plus typiques utilisés dans la pratique. <br><br><h3>  VPN entre serveurs </h3><br>  La manière la plus courante.  Dans ce mode, le client établit une connexion VPN uniquement avec le premier serveur.  Le tunnel vers le second est configuré sur le premier serveur, et tout le trafic provenant du client va vers le deuxième serveur, etc.  Il peut y avoir plusieurs serveurs intermédiaires.  Dans ce cas, le tunnel entre les serveurs peut être installé en utilisant tout autre protocole que le protocole par lequel le client est connecté, par exemple IPsec, ou sans aucun cryptage, tel que GRE ou IPIP.  Dans ce mode, tous les serveurs intermédiaires <b>peuvent être vus dans la trace d'itinéraire</b> .  Il n'y a aucun moyen de vérifier exactement comment les serveurs intermédiaires côté client sont connectés, vous ne pouvez donc faire confiance qu'au fournisseur. <br><br>  Tout au long de la route de trafic, le MTU minimum (Maximum Transmission Unit) reste égal à la valeur du tout premier tunnel, et chaque serveur intermédiaire <b>a accès au trafic client décrypté</b> . <br><br><img src="https://habrastorage.org/webt/-f/k8/0p/-fk80pf8rdttoxn4tbpu7qcnopi.png"><br><br><h3>  VPN via proxy </h3><br>  Aussi une manière assez courante.  Souvent utilisé pour masquer le trafic VPN sous un protocole différent, par exemple en Chine.  Cette méthode est plus pratique qu'une chaîne de proxy, car en utilisant un VPN, il est facile d'acheminer tout le trafic système vers le tunnel.  Il existe également des outils pour intercepter les appels système des programmes et les rediriger vers des proxys: ProxyCap, Proxifier, mais ils sont moins stables car ils manquent parfois des requêtes et ils contournent le proxy ou fonctionnent incorrectement avec certains programmes. <br><br>  Dans ce mode, le serveur proxy n'est pas visible dans la trace de l'itinéraire. <br><br><img src="https://habrastorage.org/webt/hd/uf/ar/hdufardfsfqecwuasklqamx_fzw.png"><br><br><h3>  VPN dans VPN </h3><br>  La voie la plus paranoïaque et la plus lente: tous les tunnels montent côté client, les uns à l'intérieur des autres.  Cette méthode nécessite une configuration astucieuse des routes côté client et le lancement de tous les clients VPN dans le bon ordre.  C'est mauvais pour la latence et les performances, mais les serveurs intermédiaires n'ont pas accès au trafic ouvert du client.  Tous les frais généraux d'encapsulation sont résumés et la taille maximale de paquet (MTU) qui est finalement disponible pour le client diminue en fonction du nombre de tunnels.  Les serveurs intermédiaires ne sont pas visibles dans la trace de l'itinéraire. <br><br><img src="https://habrastorage.org/webt/1f/bc/_d/1fbc_dpm24jxomg-gtt-t4xhouu.png"><br><br><h2>  Configurer VDS </h2><br>  La façon la plus simple de configurer un VPN avec des points d'entrée et de sortie séparés est de connecter plusieurs adresses IP à un seul serveur virtuel.  Cette méthode vous permet d'obtenir une vitesse maximale et des retards minimaux, car en fait le trafic se termine sur un seul serveur.  Sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vdsina.ru,</a> vous pouvez le faire vous-même depuis le panneau de configuration.  Alors que IPv4 se termine partout, nous émettons des adresses IP supplémentaires même sur des serveurs pour 60 roubles! <br><br>  Nous analyserons la configuration du serveur étape par étape. <br><br><h3>  Choisissez un serveur </h3><br>  Nous commandons VDS avec un tarif adapté, dans le centre de données nécessaire.  Étant donné notre tâche, nous choisirons un centre de données plus loin, aux Pays-Bas;) <br><br><img src="https://habrastorage.org/webt/xf/jv/nt/xfjvntqtokkir7sgkqlzcctlgyq.png"><br><br><h3>  Connectez une adresse IP supplémentaire </h3><br>  Après avoir acheté une adresse IP supplémentaire, vous devez la configurer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">conformément aux instructions</a> . <br><br><img src="https://habrastorage.org/webt/um/er/ot/umerotsqubrxdreezekpld2jzyi.png"><br><br>  Pour plus de clarté, attribuez un enregistrement PTR à IP.  Il s'agit du nom de domaine qui sera visible lorsque l'adresse IP sera reconvertie en domaine.  Cela peut être n'importe quelle valeur, y compris un domaine inexistant. <br><br>  Pour des exemples, nous utiliserons les valeurs suivantes: <br><br><pre> <code class="bash hljs">xxx.xxx.38.220 — super.cool.guy.vpn <span class="hljs-comment"><span class="hljs-comment">#   ( ) xxx.xxx.39.154 — good.citizen.vpn #   ( )</span></span></code> </pre><br><img width="400" src="https://habrastorage.org/webt/mz/oh/uj/mzohujvwi-8-ahlpeuuaduo1rie.png"><br><br><h2>  Vérification de deux IP </h2><br>  Il est important de se rappeler que l'adresse IP initialement définie sur le serveur sera le point de sortie, donc la nouvelle adresse sera le point d'entrée.  Connectez-vous via SSH au serveur et vérifiez quelle adresse est utilisée comme externe. <br><br>  Pour ce faire, il est plus simple d'utiliser le service <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ifconfig.co</a> à partir de la console.  Lors d'une demande via curl, il renvoie l'adresse IP à partir de laquelle la demande a été effectuée. <br><br><pre> <code class="bash hljs">$ curl ifconfig.co xxx.xxx.38.220</code> </pre><br>  Les derniers chiffres montrent que notre adresse externe correspond vraiment au point de sortie.  Essayons de vérifier le bon fonctionnement de la deuxième IP comme point d'entrée.  Pour ce faire, utilisez simplement la fonction proxy SOCKS intégrée à SSH. <br><br>  Les commandes sont exécutées sur le client: <br><br><pre> <code class="bash hljs">ssh -D 9999 root@good.citizen.vpn <span class="hljs-comment"><span class="hljs-comment">#    curl -x socks5h://127.0.0.1:9999 ifconfig.co super.cool.guy.vpn</span></span></code> </pre><br>  La première commande établit une session SSH avec l'adresse good.citizen.vpn et active simultanément un proxy SOCKS dans cette session, qui est disponible sur le port local.  Le second effectue une requête HTTP normale via ce proxy. <br><blockquote>  Il est important de se rappeler que nos exemples utilisent des noms de domaine fictifs pour les requêtes.  Ils ne seront affichés qu'avec une résolution PTR et aucune demande complète ne pourra leur être adressée.  Par conséquent, à ce stade, vous devez accéder au serveur via l'adresse IP. </blockquote><h2>  Configuration du serveur IKEv2 </h2><br><div style="text-align:center;"><img width="700" src="https://habrastorage.org/webt/gg/tv/jr/ggtvjr7iq-tknhzeiv-3cdogqw0.png"></div><br><br>  IPsec IKEv2 est un protocole VPN moderne pris en charge par presque tous les systèmes d'exploitation prêts à l'emploi.  Il est utilisé comme protocole par défaut sous Windows, macOS et iOS.  Dans le même temps, il ne nécessite pas l'installation de logiciels tiers et dans la plupart des cas, fonctionne plus rapidement que OpenVPN.  Il y avait déjà des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">articles sur la configuration du serveur IKEv2 sur le concentrateur</a> , mais ils décrivent tous l'utilisation de certificats auto-signés et ne sont pas pratiques car ils vous obligent à installer le certificat racine du côté du client VPN. <br><br>  Nous analyserons un exemple de configuration de serveur à l'aide d'un certificat de confiance de Let's Encrypt.  Cela vous permet de ne pas installer de certificats racine superflus pour le client, mais d'émettre uniquement un nom d'utilisateur et un mot de passe. <br><br><h3>  Préparation du serveur </h3><br>  Nous utiliserons un serveur basé sur Ubuntu 18.04, mais l'instruction convient également à la plupart des distributions modernes. <br><br>  Nous mettons à jour le système et installons les packages nécessaires <br><br><pre> <code class="plaintext hljs">apt update &amp;&amp; apt upgrade apt install certbot strongswan libstrongswan-extra-plugins</code> </pre><br><h3>  Problème de certificat </h3><br>  Pour émettre un certificat approuvé, vous devez diriger le domaine réel vers l'adresse IP du point d'entrée.  Nous n'examinerons pas cet article en détail, car il dépasse le cadre de l'article.  À titre d'exemple, nous utiliserons le domaine fictif <b>good.citizen.vpn</b> <br><br>  Si vous avez déjà un serveur Web sur le serveur, utilisez la méthode appropriée pour émettre le certificat via certbot ou un autre client pour Let's Encrypt.  Cet exemple suppose que le port HTTP (80) n'est pas occupé. <br><br><pre> <code class="bash hljs">certbot certonly --standalone --agree-tos -d good.citizen.vpn</code> </pre><br>  Répondre aux questions de l'assistant?  nous recevrons un certificat et une clé signés <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># find /etc/letsencrypt/live/good.citizen.vpn/ /etc/letsencrypt/live/good.citizen.vpn/ /etc/letsencrypt/live/good.citizen.vpn/fullchain.pem /etc/letsencrypt/live/good.citizen.vpn/README /etc/letsencrypt/live/good.citizen.vpn/cert.pem /etc/letsencrypt/live/good.citizen.vpn/privkey.pem /etc/letsencrypt/live/good.citizen.vpn/chain.pem</span></span></code> </pre><br>  Pour l'authentification du serveur IKEv2, les mêmes certificats X.509 sont utilisés que pour <br>  Https  Pour que Strongswan puisse utiliser ces certificats, ils doivent être copiés dans le dossier /etc/ipsec.d. <br><br>  Voici comment les certificats doivent être localisés: <br><br><pre> <code class="plaintext hljs">cp /etc/letsencrypt/live/good.citizen.vpn/cert.pem /etc/ipsec.d/certs/ cp /etc/letsencrypt/live/good.citizen.vpn/privkey.pem /etc/ipsec.d/private/ cp /etc/letsencrypt/live/good.citizen.vpn/chain.pem /etc/ipsec.d/cacerts/</code> </pre><br>  Étant donné que les certificats letsencrypt sont réémis fréquemment, il n'est pas pratique de le faire manuellement.  Par conséquent, nous automatisons ce processus en utilisant le hook pour certbot. <br><br>  La tâche du script consiste à copier trois fichiers dans le dossier souhaité à chaque mise à jour du certificat, puis à envoyer la commande strongswan pour relire les certificats. <br><br>  Créez le fichier <b>/etc/letsencrypt/renewal-hooks/deploy/renew-copy.sh</b> et rendez-le exécutable. <br><br><pre> <code class="plaintext hljs">#!/bin/sh set -e for domain in $RENEWED_DOMAINS; do case $domain in good.citizen.vpn) daemon_cert_root=/etc/ipsec.d/ # Make sure the certificate and private key files are # never world readable, even just for an instant while # we're copying them into daemon_cert_root. umask 077 cp "$RENEWED_LINEAGE/cert.pem" "$daemon_cert_root/certs/" cp "$RENEWED_LINEAGE/chain.pem" "$daemon_cert_root/cacerts/" cp "$RENEWED_LINEAGE/privkey.pem" "$daemon_cert_root/private/" # Reread certificates /usr/sbin/ipsec reload /usr/sbin/ipsec purgecerts /usr/sbin/ipsec rereadall ;; esac done</code> </pre><br>  Maintenant, après chaque réédition du certificat, le script copiera les nouveaux fichiers dans les dossiers strongswan et enverra une commande au démon pour relire les certificats. <br><br><h3>  Configuration de Strongswan </h3><br>  Ajoutez la configuration strongswan /etc/ipsec.conf <br><br><pre> <code class="bash hljs">config setup <span class="hljs-comment"><span class="hljs-comment">#       uniqueids=no # Increase debug level # charondebug = ike 3, cfg 3 conn %default #       ike=aes256-sha256-modp1024,aes256-sha256-modp2048 #  ""  dpdaction=clear dpddelay=35s dpdtimeout=2000s keyexchange=ikev2 auto=add rekey=no reauth=no fragmentation=yes #compress=yes # left - local (server) side leftcert=cert.pem #      /etc/ipsec.d/certs/ leftsendcert=always #    leftsubnet=0.0.0.0/0 # right - remote (client) side eap_identity=%identity #   IP-  VPN- rightsourceip=10.0.1.0/24 rightdns=8.8.8.8,1.1.1.1 # Windows and BlackBerry clients usually goes here conn ikev2-mschapv2 rightauth=eap-mschapv2 # Apple clients usually goes here conn ikev2-mschapv2-apple rightauth=eap-mschapv2 leftid=good.citizen.vpn</span></span></code> </pre><br>  Les identifiants et mots de passe des clients VPN sont définis dans le fichier <b>/etc/ipsec.secrets</b> <br><br>  Dans ce fichier, vous devez également spécifier le nom de la clé privée que nous avons précédemment copiée à partir du dossier letsencrypt: <br><br><pre> <code class="plaintext hljs">#       /etc/ipsec.d/private/ : RSA privkey.pem #  VPN #  : EAP "" IrinaYarovaya : EAP "PleaseLoveMe123" Mizooleena : EAP "IwannaLoveToo3332"</code> </pre><br>  À ce stade, vous pouvez redémarrer le serveur strongswan et vérifier si la nouvelle configuration a été activée: <br><br><pre> <code class="plaintext hljs">$ systemctl restart strongswan $ ipsec statusall Virtual IP pools (size/online/offline): 10.0.1.0/24: 254/0/0 Listening IP addresses: xxx.xxx.38.220 Connections: ikev2-mschapv2: %any...%any IKEv2, dpddelay=35s ikev2-mschapv2: local: [CN=good.citizen.vpn] uses public key authentication ikev2-mschapv2: cert: "CN=good.citizen.vpn" ikev2-mschapv2: remote: uses EAP_MSCHAPV2 authentication with EAP identity '%any' ikev2-mschapv2: child: 0.0.0.0/0 === dynamic TUNNEL, dpdaction=clear ikev2-mschapv2-apple: %any...%any IKEv2, dpddelay=35s ikev2-mschapv2-apple: local: [good.citizen.vpn] uses public key authentication ikev2-mschapv2-apple: cert: "CN=good.citizen.vpn" ikev2-mschapv2-apple: remote: uses EAP_MSCHAPV2 authentication with EAP identity '%any' ikev2-mschapv2-apple: child: 0.0.0.0/0 === dynamic TUNNEL, dpdaction=clear</code> </pre><br>  Vous pouvez voir que la configuration est correctement activée et que le certificat est connecté.  À ce stade, vous pouvez déjà vous connecter au serveur VPN, mais il sera sans accès à Internet.  Pour libérer des clients sur Internet, vous devez activer le transfert et configurer NAT. <br><br><h3>  Configuration NAT </h3><br>  Nous activons les packages de transfert: <br><br><pre> <code class="plaintext hljs">echo "net.ipv4.ip_forward=1" &gt;&gt; /etc/sysctl.conf sysctl -p</code> </pre><br>  Activez NAT.  Il est important de garder à l'esprit qu'il ne s'agit là que d'un exemple de configuration minimale iptables.  Personnalisez le reste des règles selon vos besoins. <br><br>  <b>ethName0</b> - remplacez par votre nom d'interface <br>  <b>10.0.1.0/24</b> - la plage d'adresses IP qui seront émises aux clients VPN.  Nous l'avons demandé dans <b>/etc/ipsec.conf</b> <br>  <b>111.111.111.111</b> - l'adresse IP du point de sortie, dans notre exemple c'est l'adresse super.cool.guy.vpn <br><br><pre> <code class="plaintext hljs">iptables -t nat -A POSTROUTING -s 10.0.1.0/24 -o ethName0 -j SNAT --to-source 111.111.111.111</code> </pre><br><h3>  Débogage </h3><br>  À ce stade de la configuration, nous devrions obtenir un serveur pleinement fonctionnel auquel les clients peuvent déjà se connecter.  Avant de continuer, il est préférable de vérifier cela en vérifiant la connexion. <br><br>  En cas de problème de connexion, vous pouvez consulter le journal en temps réel: <br><br><pre> <code class="plaintext hljs">journalctl -f -u strongswan</code> </pre><br><h3>  Démarrage au démarrage </h3><br>  Si tout réussit, vous pouvez ajouter strongswan au démarrage au démarrage: <br><br><pre> <code class="plaintext hljs">systemctl enable strongswan</code> </pre><br><h3>  Enregistrement des règles iptables </h3><br>  Pour enregistrer les règles iptables après le redémarrage, il existe un package spécial <b>persistant iptables</b> .  Il est important de se rappeler qu'il enregistrera l'ensemble de règles actuel et l'ajoutera au démarrage. <br><br><pre> <code class="plaintext hljs">apt install iptables-persistent</code> </pre><br><h2>  Configuration client </h2><br>  La configuration côté client est extrêmement simple - il suffit d'indiquer au client l'adresse du serveur, le nom d'utilisateur et le mot de passe.  Pour macOS et iOS, vous pouvez créer des profils d'autoconfiguration qui suffiront à s'activer en deux clics. <br><br><div class="spoiler">  <b class="spoiler_title">Configuration de Windows</b> <div class="spoiler_text">  Dans les nouvelles versions de Windows, IKEv2 est configuré dans un simple assistant, accessible à partir du menu de connexion WiFi. <br><br><img src="https://habrastorage.org/webt/mu/hq/_r/muhq_rn7iubyixxxsislcmmqvzm.png"><br><br>  Windows ne définit pas de route par défaut pour une telle connexion, nous allons donc l'installer manuellement.  Dans les propriétés de la connexion VPN, allez dans les propriétés de TCP / IPv4 -&gt; en plus et cochez la case "Utiliser une passerelle sur un réseau distant" <br><br> <a href=""><img src="https://habrastorage.org/webt/ra/c5/_x/rac5_xi76rjiuadeswi3e1m8rug.png"></a> <br>  <sup>cliquable</sup> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Configuration de MacOS</b> <div class="spoiler_text">  MacOS prend en charge IKEv2 à partir de la version 10.11 (El Capitan).  La connexion est créée via le menu des paramètres réseau. <br><br><img src="https://habrastorage.org/webt/f4/ad/hk/f4adhkw9swpneyfo0jn9jgro9s4.png" alt="image"><br><br>  Ajoutez une nouvelle connexion.  Le nom de la connexion est n'importe quel nom arbitraire. <br><br><img src="https://habrastorage.org/webt/xc/ng/zq/xcngzqon0ilejqrl7hqla-8vbf4.png" alt="image"><br><br>  Pour authentifier un certificat, vous devez spécifier un nom de domaine.  Dans le même temps, dans le champ "Adresse du serveur", vous pouvez spécifier l'adresse IP du serveur et le domaine uniquement dans "ID distant", la résolution DNS ne sera pas effectuée pour la connexion et cela se produira un peu plus rapidement. <br><br><img src="https://habrastorage.org/webt/x4/c2/eq/x4c2eqk2waefy8woi_pnaa8o5uw.png" alt="image"><br><br>  Le nom d'utilisateur et le mot de passe sont spécifiés à partir du fichier <b>/etc/ipsec.secrets</b> <br><br><img src="https://habrastorage.org/webt/-p/gu/98/-pgu98eevkywzjzqjd7dfvq94zc.png" alt="image"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Configuration IOS</b> <div class="spoiler_text">  La configuration IOS peut être effectuée manuellement via l'assistant, mais il est beaucoup plus pratique d'utiliser le profil de configuration automatique de mobileconfig. <br><br>  Le réglage manuel a une signification similaire à celle du bureau macOS: <br><br>  <b>Paramètres -&gt; VPN -&gt; Ajouter une configuration VPN</b> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Profil de configuration automatique pour les appareils Apple</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sj/r2/up/sjr2up4rsqjjrxzltdldqrepnmk.png"><br>  Profils d'autoconfiguration .mobileconfig est un fichier XML avec des paramètres qui peuvent configurer n'importe quoi, des certificats SSL aux connexions VPN. <br><br>  L'utilisateur n'a qu'à cliquer sur le fichier et tous les paramètres nécessaires seront installés automatiquement. <br><br>  Exemple de configuration pour se connecter à notre serveur IKEv2. <br>  Pour configurer un fichier pour votre configuration, modifiez simplement quelques paramètres dans ce modèle: <br><br>  <b>AuthName</b> - nom d'utilisateur du fichier <b>/etc/ipsec.secrets</b> <br>  <b>AuthPassword</b> - mot de passe utilisateur <b>/etc/ipsec.secrets</b> <br>  <b>RemoteAddress</b> - adresse IP de domaine ou de serveur <br>  <b>RemoteIdentifier</b> - domaine pour lequel le certificat est émis <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadContent<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">array</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>IKEv2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Username and password from ipsec.secrets --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>AuthName<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>IrinaYarovaya<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>AuthPassword<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>PleaseLoveMe123<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Hostname or IP address of VPN server. Chosing IP address instead of DNS name can avoid issues with client DNS resolvers and speed up connection process. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>RemoteAddress<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>123.123.123.123<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- leftid in ipsec.conf --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>RemoteIdentifier<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>good.citizen.vpn<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>AuthenticationMethod<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>Certificate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>ChildSecurityAssociationParameters<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- in ipsec.conf this proposal is: ike=aes256-sha256-modp2048 --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>DiffieHellmanGroup<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>14<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>EncryptionAlgorithm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>AES-256<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>IntegrityAlgorithm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>SHA2-256<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>LifeTimeInMinutes<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1440<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>DeadPeerDetectionRate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- None (Disable) Low (keepalive sent every 30 minutes) Medium (keepalive sent every 10 minutes) High (keepalive sent every 1 minute) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>High<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>ExtendedAuthEnabled<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">true</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>IKESecurityAssociationParameters<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>DiffieHellmanGroup<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>14<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>EncryptionAlgorithm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>AES-256<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>IntegrityAlgorithm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>SHA2-256<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>LifeTimeInMinutes<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1440<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Always On OnDemand Rule Cen be disabled in connection preferences by "On Demand" checkbox http://www.v2ex.com/t/137653 https://developer.apple.com/library/mac/featuredarticles/iPhoneConfigurationProfileRef/Introduction/Introduction.html https://github.com/iphoting/ovpnmcgen.rb --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>OnDemandEnabled<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>OnDemandRules<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">array</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>Action<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>Connect<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">array</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>IPv4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>OverridePrimary<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadDescription<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>Configures VPN settings<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadDisplayName<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>VPN<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadIdentifier<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.vpn.managed.96C1C38F-D4D6-472E-BA90-9117ED8896B5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadType<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>com.apple.vpn.managed<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadUUID<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>96C1C38F-D4D6-472E-BA90-9117ED8896B5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadVersion<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- VPN connection name in Network Preferences --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>UserDefinedName<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>London VPN<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>VPNType<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>IKEv2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">array</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Set the name to whatever you like, it is used in the profile list on the device --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadDisplayName<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>My Super IKEv2 VPN<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- A reverse-DNS style identifier (com.example.myprofile, for example) that identifies the profile. This string is used to determine whether a new profile should replace an existing one or should be added. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadIdentifier<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>vpn.googd.citizen<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- A globally unique identifier, use uuidgen on Linux/Mac OS X to generate it --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadUUID<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>F3FAD91C-019C-4A79-87A1-CF334C583339<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadType<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>Configuration<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>PayloadVersion<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">integer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dict</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plist</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">Configuration Android</b> <div class="spoiler_text">  Malheureusement, Android est le seul des systèmes d'exploitation populaires qui ne dispose toujours pas d'une prise en charge intégrée pour IKEv2.  Pour vous connecter, vous pouvez utiliser le client officiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Strongswan de PlayMarket</a> <br></div></div><br><h2>  Résumé </h2><br>  Nous avons montré l'option de configuration de serveur la plus simple avec des points d'entrée et de sortie espacés.  Cette configuration vous permet d'obtenir la vitesse VPN maximale, car elle n'utilise pas de tunnels supplémentaires entre les serveurs, malgré le fait que les adresses IP des points d'entrée et de sortie se trouvent sur des sous-réseaux différents.  Cette approche vous permet d'expérimenter davantage en connectant plus de deux adresses IP au serveur. <br><br>  Le protocole IKEv2 est parfait pour l'utiliser sur le système d'exploitation de bureau pour le travail quotidien, car il est intégré de manière native au système et, toutes choses étant égales par ailleurs, vous permet d'obtenir plus de vitesse que via des programmes VPN tiers. <br><br><img src="https://habrastorage.org/webt/hi/b3/xj/hib3xjmkyohwf9yqp_irjum5tls.png"><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/ud/xv/wf/udxvwfcz80j3nug11rxaguqelww.png"><br></a> <br><h3>  Abonnez-vous à notre développeur Instagram </h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/e5/as/-l/e5as-ltfnotkemk2dsqngygimra.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr469879/">https://habr.com/ru/post/fr469879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr469865/index.html">700 employés et plusieurs continents: comment Alconost a construit un modèle commercial sans officier</a></li>
<li><a href="../fr469869/index.html">Pourquoi vous devriez overclocker la RAM (c'est facile!)</a></li>
<li><a href="../fr469871/index.html">Quand les claviers étaient des tables</a></li>
<li><a href="../fr469875/index.html">Comment protéger vos mots de passe en 2019</a></li>
<li><a href="../fr469877/index.html">Oh cette méthode de Newton</a></li>
<li><a href="../fr469881/index.html">Les trois premiers jours de la vie d'un billet sur Habré</a></li>
<li><a href="../fr469883/index.html">Est-il possible de programmer l'aléatoire?</a></li>
<li><a href="../fr469885/index.html">Désactiver la console locale lors de l'utilisation de x11vnc</a></li>
<li><a href="../fr469893/index.html">Maison avec des éléments de haute technologie pour un chat sans-abri</a></li>
<li><a href="../fr469901/index.html">Une brève histoire de la visualisation des données: de l'Antiquité au 17e siècle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>