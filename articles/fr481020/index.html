<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍⚕️ 🌑 💛 Écrire un simulateur de saisie tactile en utilisant du JavaScript pur: Partie 2 🤦🏿 🕔 👴🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour En prévision du début du cours "Fullstack JavaScript Developer", l' un de nos auteurs a décidé de partager son expérience dans la création d'u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Écrire un simulateur de saisie tactile en utilisant du JavaScript pur: Partie 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/481020/">  <i>Bonjour</i>  <i>En prévision du début du cours <a href="https://otus.pw/vdqp/">"Fullstack JavaScript Developer", l'</a> un de nos auteurs a décidé de partager son expérience dans la création d'un simulateur de saisie tactile.</i>  <i>Mais à notre tour, nous voulons vous montrer ce matériel et nous en partageons aujourd'hui la dernière partie.</i> <br><br><img src="https://habrastorage.org/webt/rp/lu/hn/rpluhno5aexsppsfajdqxhtlxr4.png"><br><hr><br>  La première partie peut être lue <a href="https://habr.com/ru/company/otus/blog/480118/">ici.</a> <br><a name="habracut"></a><br>  Bonjour à tous!  Nous continuons d'écrire un simulateur de frappe natif à l'aide de JavaScript natif.  Dans la dernière partie, vous et moi avons fait la logique principale de l'application, dans laquelle, en appuyant sur la touche Entrée, le premier niveau de vingt caractères a été chargé, qui lors de l'étude de la méthode d'impression tactile est l'un des premiers à être étudié (J, K, F, D).  La version de travail de la première version peut être consultée <a href="https://isakura13.bitbucket.io/playground/">ici</a> .  Cependant, nous avons encore quelques tâches pour améliorer l'application. <br><br><img src="https://habrastorage.org/webt/dz/et/b1/dzetb19x6wir8i2tokhbzqxkpoi.gif"><br><br>  Formulons le mandat pour comprendre exactement ce que nous voulons réaliser: <br><br>  <i>«Au début du jeu, après que l'utilisateur a appuyé sur la touche d'entrée invitante, qui se déplace de manière animée de gauche à droite, les premier au troisième niveaux sont chargés séquentiellement.</i>  <i>En appuyant sur le bon bouton, un signal de jeu positif est joué, en cas d'erreur, un signal de jeu négatif est joué.</i>  <i>Les premier et deuxième niveaux ont des symboles ordinaires, le troisième niveau est bonus, dans lequel les symboles sont spécialement destinés aux programmeurs (plutôt comiques).</i>  <i>À la fin du niveau, nous avons une fenêtre de résultats qui est écrite et tirée de <code>localStorage</code> , cette fenêtre affiche le nombre d'erreurs du joueur et l'heure de fin de la session de jeu.</i>  <i>En cas d'erreurs trop nombreuses, le son de la perte est joué, en cas de transition réussie vers le niveau suivant - une mélodie majeure. "</i> <br><br>  Bon, maintenant nous avons TK, commençons la programmation.  De toute évidence, notre base de code augmentera considérablement, ce qui signifie que pour faire face à beaucoup de code et importer les bibliothèques nécessaires, nous avons besoin de <code>webpack</code> .  Mais commençons par la mise en page et voyons quels changements se sont produits.  Je ne donnerai pas le contenu de <code>head</code> , car la seule chose qui a changé, c'est que maintenant nous <code>dist/code.js</code> javascript du <code>dist/code.js</code> traité par le <code>dist/code.js</code> , mais tout le reste reste le <code>dist/code.js</code> . <br><br>  Dans le corps de la page, j'ai ajouté une fenêtre modale qui n'est pas encore visible et dans laquelle nous écrirons les résultats du passage du jeu dans le <code>table</code> : <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"has-background-black-bis"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"modal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"modal-background has-background-link"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"modal-content has-background-white"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"is-size-4"</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"table"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">th</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"target_error"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"modal-close is-large"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"close"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Bien sûr, le fait que nous ayons une fenêtre modale directement sur la page cause une douleur physique aux amateurs de SPA - les cadres (après tout, ils aimeraient décomposer soigneusement tout cela en composants).  Mais je ne voulais pas peindre la génération de ce contenu en JS.  Regardons la prochaine partie de notre html: <br><br><pre> <code class="html hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hero is-primary is-large"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hero-head container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label is-size-4 has-text-white promo"</span></span></span><span class="hljs-tag">&gt;</span></span>   3000<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label is-size-4 has-text-danger has-text-centered name-level"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"error-panel is-hidden"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progress</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress is-danger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">max</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">progress</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hero-body has-background-black-bis main-board"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"columns"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"label is-size-2 has-text-white has-text-centered begin anim-elem"</span></span></span><span class="hljs-tag">&gt;</span></span>Press Enter to Start<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"buttons columns is-half is-centered"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  En fait, seulement trois choses ont changé depuis la dernière fois: maintenant il y a un nom pour le niveau que nous allons remplir à partir de js, le panneau d'erreur est initialement caché et le nom de l'application elle-même a changé. <br><br>  Au moment de démarrer JS, je vais juste ajouter un peu de CSS pour corriger un peu ce que je ne pouvais pas faire avec <code>Bulma</code> : <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">max-height</span></span>:<span class="hljs-number"><span class="hljs-number">40vh</span></span> <span class="hljs-meta"><span class="hljs-meta">!important</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.promo</span></span>{ <span class="hljs-attribute"><span class="hljs-attribute">margin-top</span></span>: <span class="hljs-number"><span class="hljs-number">1rem</span></span>; }</code> </pre><br>  Ok js.  J'ai écrit la configuration de webpack la plus simple.  De ce qui se trouve sur la première page de la documentation du <code>webpack</code> , il ne diffère qu'en présence de suivi des modifications dans les fichiers.  Pour la plupart, j'en ai besoin pour utiliser les importations dans le fichier <code>index.js</code> principal, et éventuellement avoir un fichier minifié: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"path"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: <span class="hljs-string"><span class="hljs-string">'./js/index.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'code.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(__dirname, <span class="hljs-string"><span class="hljs-string">'dist'</span></span>), }, <span class="hljs-attr"><span class="hljs-attr">watch</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, }</code> </pre><br>  Très bien, et maintenant nous pouvons passer à la structure js.  Pour les animations, j'ai décidé d'utiliser <code>anime.js</code> - bien que je comprenne bien que la quantité d'animation dont nous avons besoin peut être faite en CSS en 10 lignes.  Peut-être qu'à l'avenir, nous ajouterons plus d'animations, j'ai donc fait glisser tout le <code>anime.es.js</code> .  De plus, j'ai ajouté une fonction de génération de fichiers aléatoires à un fichier séparé - uniquement pour des raisons de commodité: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRandomInt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">max</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(max)); }</code> </pre><br>  J'ai alors décidé de mettre la fonction <code>showResult</code> dans un fichier séparé, qui était engagé dans le dessin des résultats après que l'utilisateur ait pu parcourir tout le jeu.  Il s'agit d'une fonction assez universelle qui prend le premier argument à l'entrée de l'élément qui sera écrit dans les informations de <code>localStorage</code> et qui vient d'être reçu, et le second - les informations qui doivent être écrites (dans notre cas, c'est le nombre d'erreurs du joueur).  De plus, j'ai implémenté des clés de tri à partir de <code>localStorage</code> , afin que les données de la table soient triées au moment de leur création.  Dans la deuxième partie de la fonction, le tableau affiche les données des tentatives précédentes du joueur.  Cependant, moins de mots, plus de code: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showResult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">target_El, content</span></span></span><span class="hljs-function">)</span></span>{ localStorage.setItem(+<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>, content); (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawOnLoad</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> temp_arr = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; localStorage.length; i++) { temp_arr.push(+localStorage.key(i)); } temp_arr.sort(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt; temp_arr.length; i++){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> item_time = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(temp_arr[i]); target_El.insertAdjacentHTML(<span class="hljs-string"><span class="hljs-string">'afterend'</span></span>, <span class="hljs-string"><span class="hljs-string">`&lt;th&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${item_time.getDate()}</span></span></span><span class="hljs-string"> / </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${item_time.getMonth()}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${item_time.getHours()}</span></span></span><span class="hljs-string"> : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${item_time.getMinutes()}</span></span></span><span class="hljs-string"> &lt;/th&gt; &lt;th&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${localStorage.getItem(</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">String</span></span></span></span><span class="hljs-string"><span class="hljs-subst">(temp_arr[i]))}</span></span></span><span class="hljs-string">&lt;/th&gt; `</span></span>); } })(); }</code> </pre><br>  Très bien, avec les fichiers supplémentaires terminés, nous pouvons enfin passer au fichier principal.  Nous faisons d'abord les importations: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> anime <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./anime.es"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> getRandomInt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./random"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> showResult <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"./showResult"</span></span>;</code> </pre><br>  Bibliothèques reçues.  Faisons une animation de notre inscription invitante depuis le tout début: <br><br><pre> <code class="javascript hljs">anime({ <span class="hljs-attr"><span class="hljs-attr">targets</span></span>: <span class="hljs-string"><span class="hljs-string">".anim-elem"</span></span>, <span class="hljs-attr"><span class="hljs-attr">translateX</span></span>: [<span class="hljs-number"><span class="hljs-number">-50</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>], <span class="hljs-attr"><span class="hljs-attr">easing</span></span>: <span class="hljs-string"><span class="hljs-string">"linear"</span></span>, <span class="hljs-attr"><span class="hljs-attr">direction</span></span>: <span class="hljs-string"><span class="hljs-string">"alternate"</span></span>, <span class="hljs-attr"><span class="hljs-attr">duration</span></span>: <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-attr"><span class="hljs-attr">loop</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> });</code> </pre><br>  Super!  Enfin, l'application elle-même.  J'ai décidé de déplacer toutes les données vers <code>json</code> pour représenter le serveur que ce jeu peut générer, par exemple, en hongrois, en russe ou en chinois simplifié - en bref, avec n'importe quel ensemble de caractères (mais avant cela, bien sûr, grandit et grandit).  Après avoir reçu des données lors de la <code>fetch</code> , la fonction elle-même est appelée de manière asynchrone, ce qui démarre notre jeu.  J'ai <code>gist.github</code> JSON sur <code>gist.github</code> (peut être vu <a href="">ici</a> ) <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_data</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ fetch( <span class="hljs-comment"><span class="hljs-comment">// "    ,   json" ) //     json  -     , //  -       .then(res =&gt; res.json()) .then(data =&gt; { //    ,     read_data(data); }) .catch(err =&gt; { console.warn(" "); console.warn(err.name); //   }); } get_data(); //      , ...      </span></span></code> </pre><br>  Comme le lecteur l'a déjà compris, dans notre fonction asynchrone <code>read_data</code> , toutes les autres fonctions du jeu seront localisées.  Par conséquent, le reste du code ira déjà à l'intérieur de cette fonction: <br><br><pre> <code class="plaintext hljs">var number_of_level = 0; //        0 var error_sound = new Audio("sounds/error_sound.wav"); var fail_sound = new Audio("sounds/fail_sound.wav"); //    var press_sound = new Audio("sounds/press_sound.wav"); var succes_sound = new Audio("sounds/succes_sound.wav"); //       .        </code> </pre><br>  J'ai trouvé des sons 8 bits dans des banques gratuites sur Internet.  Voyons maintenant les éléments que j'obtiens de l'arborescence DOM: <br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> modal = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">".modal"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      var target_error = document.querySelector(".target_error"); //          let error_panel = document.querySelector(".error-panel"); //    let begin = document.querySelector(".begin"); //    ,     enter   .      let progress = document.getElementById("prog"); //     let buttons = document.querySelector(".buttons"); //         let name_level = document.querySelector(".name-level"); //       let modal_close = document.querySelector(".modal-close"); // ,                document.addEventListener("keydown", StartGame, { once: true // once           //     ,      });</span></span></code> </pre><br>  Vient ensuite la fonction de démarrage du jeu.  Certains changements l'ont dépassée aussi - maintenant notre panneau d'erreur ne devient visible qu'au début du jeu, un son de clic est joué, l'inscription invitante est supprimée, et elle ne se cache pas (je l'ai fait pour une petite optimisation, car alors nous aurions joué une animation d'un élément invisible sur la page) , puis la fonction principale du jeu est appelée: <br><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StartGame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.key == <span class="hljs-string"><span class="hljs-string">"Enter"</span></span>) { error_panel.classList.remove(<span class="hljs-string"><span class="hljs-string">"is-hidden"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     press_sound.play(); begin.remove(); //    mainGame(); //    } }</span></span></code> </pre><br>  Ok, vient ensuite le dessin des lettres.  Toute la différence avec la version précédente est que nous prenons maintenant les données de l'objet JSON: <br><br><pre> <code class="plaintext hljs"> function drawBoard(info) { let str_arr = info.level_info[number_of_level].symbols; //    -     ,      webpack, .... name_level.innerHTML = info.level_info[number_of_level].name_level; let col_arr = info.symbol_colors; for (let i = 0; i &lt; 20; i++) { //    20  let rand = getRandomInt(str_arr.length); buttons.insertAdjacentHTML( "afterbegin", `&lt;button class='game-button button is-large ${col_arr[rand]}' id='${str_arr[rand]}'&gt; ${str_arr[rand]}&lt;/button&gt;` ); } }</code> </pre><br>  Ensuite, nous appelons la fonction du jeu principal avec des informations de JSON, que notre fonction asynchrone a toujours pris comme argument: <br><br><pre> <code class="plaintext hljs"> function mainGame() { drawBoard(information); document.addEventListener("keydown", press);</code> </pre><br>  Ensuite, la dernière fonction <code>press</code> dans notre code ira, dans laquelle nous déterminerons la perte et la victoire.  Si l'utilisateur a marqué trop d'erreurs, vous devez lui dire qu'il a perdu et jouer la mélodie responsable du "fiasco".  Une fin réussie du niveau se produit si la variable <code>count_right</code> gagne la valeur égale au nombre de caractères que nous générons (20).  Je suis conscient que la transition vers le niveau suivant peut se faire lorsque la longueur du tableau <code>elements_arr</code> devient égale à 0, mais pour l'instant nous avons une telle solution.  Si l'utilisateur a réussi les trois niveaux, un tableau de résultats s'affiche avec le nombre d'erreurs: <br><br><pre> <code class="plaintext hljs"> var errors_count = 0; var count_right = 0; function press(e) { let elements_arr = document.querySelectorAll(".game-button"); //      if (e.key == elements_arr[0].id) { //      querySelector,      elements_arr[0].remove(); count_right++; //    press_sound.play(); } else { errors_count++; //   error_sound.play(); progress.value = errors_count; //     if (errors_count &gt; 20) { //         ,   fail_sound.play(); //    name_level.innerHTML = ' !'; setTimeout(() =&gt; { window.location.reload(); //       }, 2500); } } if (count_right == 20) { count_right = 0; number_of_level++; if (number_of_level == 3) { //     3  modal.classList.add("is-active"); //     showResult(target_error, errors_count); modal_close.onclick = async function() { modal.classList.remove("is-active"); window.location.reload(); //,     ,    }; } succes_sound.play(); mainGame(); } } } //      ,   </code> </pre><br>  Ceci est la partie principale de notre article.  Si vous êtes intéressé par le code source de l'application, vous pouvez le trouver <a href="">ici</a> .  Si vous voulez jouer et voir notre application en action, bienvenue <a href="https://isakura13.bitbucket.io/playground2/">ici</a> .  Veuillez écrire tous les bugs et questions dans les commentaires ou immédiatement dans le référentiel des <code>issues</code> sur github. <br><br>  Il y a beaucoup plus à ajouter à l'application - ce sont des animations amusantes de lettres, de musique en arrière-plan (ou vous pouvez vous assurer que lorsque vous imprimez, différents sons sont émis pour forcer l'utilisateur à imprimer à un certain rythme).  Vous pouvez faire défiler les lettres et le mode vitesse - afin d'imprimer à temps et d'enregistrer la précision obtenue.  J'aimerais aussi voir un compte à rebours au début du niveau pour que le joueur puisse positionner correctement ses mains sur le clavier et se préparer.  En bref, il y a beaucoup d'idées (ainsi qu'une traduction très évidente de cette application dans React ou Vue), et j'espère que les Habrovsk conseilleront également quelque chose.  Merci à tous pour votre attention! <br><br>  Eh bien, nous attendons tout le monde sur le <a href="https://otus.pw/vdqp/">parcours</a> ! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481020/">https://habr.com/ru/post/fr481020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481010/index.html">16 conseils de développement pour Android dans Kotlin. 3e partie</a></li>
<li><a href="../fr481012/index.html">Ce que j'ai appris en 10 ans sur Stack Overflow</a></li>
<li><a href="../fr481014/index.html">Je / WE n'héberge pas Ayhor. Ou comment cracher face à l'industrie</a></li>
<li><a href="../fr481016/index.html">Expérience VonmoTrade. Partie 1: Échanges et technologie moderne</a></li>
<li><a href="../fr481018/index.html">Et encore une fois sur la protection des infrastructures virtuelles</a></li>
<li><a href="../fr481024/index.html">Pourquoi j'ai abandonné l'API Google Maps</a></li>
<li><a href="../fr481028/index.html">Guide d'organisation d'une connexion à distance à un automate industriel à l'aide d'OpenVPN</a></li>
<li><a href="../fr481030/index.html">Quel genre de cyberdec voudrais-je faire pour moi</a></li>
<li><a href="../fr481032/index.html">Pourquoi était-il possible de pirater? Probablement parce que l'attaquant</a></li>
<li><a href="../fr481034/index.html">Tunnel VPN direct entre ordinateurs via des fournisseurs NAT (sans VPS, en utilisant un serveur STUN et Yandex.Disk)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>