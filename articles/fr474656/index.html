<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔯 👨🏿‍🤝‍👨🏽 🤜🏾 Reversim MIPS et Golang - les bases de l'inverse. Résolution des problèmes de marche arrière avec r0ot-mi. 2e partie 🌥️ 🚮 👨🏿‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, nous traiterons de la décompilation du binaire MIPS dans Ghidra et inverserons le programme écrit en golang dans l'IDA. 

 Partie 1 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Reversim MIPS et Golang - les bases de l'inverse. Résolution des problèmes de marche arrière avec r0ot-mi. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474656/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/m1/pb/cc/m1pbccvddfkceg8p7pjztg2-uds.jpeg" alt="image"></div><br>  Dans cet article, nous traiterons de la décompilation du binaire MIPS dans Ghidra et inverserons le programme écrit en golang dans l'IDA. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1 - Décompilation C, C ++ et DotNet.</a> <br><br><div class="spoiler">  <b class="spoiler_title">Information organisationnelle</b> <div class="spoiler_text">  Surtout pour ceux qui veulent apprendre quelque chose de nouveau et se développer dans l'un des domaines de l'information et de la sécurité informatique, j'écrirai et parlerai des catégories suivantes: <br><br><ul><li>  PWN; </li><li>  cryptographie (Crypto); </li><li>  technologies de réseau (réseau); </li><li>  reverse (Reverse Engineering); </li><li>  stéganographie (Stegano); </li><li>  recherche et exploitation des vulnérabilités WEB. </li></ul><br>  En plus de cela, je partagerai mon expérience en criminalistique informatique, analyse de logiciels malveillants et micrologiciels, attaques sur les réseaux sans fil et les réseaux locaux, réalisation de pentests et écriture d'exploits. <br><a name="habracut"></a><br>  Afin que vous puissiez vous renseigner sur les nouveaux articles, logiciels et autres informations, j'ai créé une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">chaîne dans Telegram</a> et un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe pour discuter de tout problème</a> dans le domaine de l'ICD.  Aussi, je considérerai personnellement vos demandes, questions, suggestions et recommandations <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">personnelles et répondrai à tout le monde</a> . <br><br>  Toutes les informations sont fournies à des fins éducatives uniquement.  L'auteur de ce document n'assume aucune responsabilité pour tout dommage causé à quelqu'un du fait de l'utilisation des connaissances et des méthodes obtenues à la suite de l'étude de ce document. <br></div></div><br><h2>  ELF MIPS </h2><br><img src="https://habrastorage.org/webt/rg/r2/am/rgr2amf_jxqyrsho_eyt56lfca0.png" alt="image"><br><br>  Téléchargez et vérifiez le fichier. <br><br><img src="https://habrastorage.org/webt/ob/lo/pe/oblopea4hel6den3wiucv4erzjo.png" alt="image"><br><br>  Il s'agit d'un fichier exécutable 32 bits pour les processeurs d'architecture MIPS.  Pour résoudre ce problème, nous utiliserons Ghidra.  Ouvrez l'hydre, créez un nouveau projet et ajoutez-le à notre fichier exécutable. <br><br><img src="https://habrastorage.org/webt/18/3d/ew/183dew5szequssianc3r4b55z0e.png" alt="image"><br><br>  Ouvrez maintenant le fichier étudié et accédez à la fenêtre de l'arbre des symboles.  Dans la recherche, tapez main pour trouver le point d'entrée du programme. <br><br><img src="https://habrastorage.org/webt/sd/np/hx/sdnphx2ebzdgod4jrpquduccsmm.png" alt="image"><br><br>  Lorsque vous sélectionnez une fonction, elle s'ouvre immédiatement dans le décompilateur. <br><br><img src="https://habrastorage.org/webt/gr/4f/sl/gr4fsl54efw03aeweuldk77vi0m.png" alt="image"><br><br>  Convertissons le code. <br><br><img src="https://habrastorage.org/webt/ub/ks/wq/ubkswqmgh-vv6qstbgx2zohl7v0.png" alt="image"><br><br>  Nous voyons que 64 octets sont lus dans la variable local_54, renommons-la en entrée (raccourci clavier L) et en faisons un tableau de 64 caractères (raccourci clavier Ctrl + L).  Vous pouvez également renommer la variable sVar1. <br><br><img src="https://habrastorage.org/webt/gx/1d/za/gx1dzaj5jsr8vetg5hxcgfthdaq.png" alt="image"><br><br><img src="https://habrastorage.org/webt/om/uv/jf/omuvjfhtvcsxhbg9zc-yygcc6mw.png" alt="image"><br><br>  Après une certaine conversion, le code a commencé à être un peu plus beau. <br><br><img src="https://habrastorage.org/webt/gj/dj/m1/gjdjm1h-ibbxowdpyav8ak0w8ym.png" alt="image"><br><br>  Nous analysons le code.  La chaîne que nous entrons doit comporter 19 caractères.  À quelle position quel caractère doit être clair dans le code.  Dans ce cas, du 8 au 17 devrait être le symbole «i».  Nous récupérons, passons le mot de passe. <br><br><h2>  Golang basic </h2><br><img src="https://habrastorage.org/webt/vs/3m/fp/vs3mfptlmtcoe2cx-fngbntx1b8.png" alt="image"><br><br>  Dans cette mission, nous sommes fournis avec un fichier exécutable écrit en Go.  Vous pouvez même savoir quelle version.  Je jette l'IDA.  Il faut dire tout de suite que la fonction principale n'est pas appelée main, mais appelée main_main.  Par conséquent, nous effectuons une recherche par fonction et passons à la vraie principale. <br><br><img src="https://habrastorage.org/webt/al/ol/6r/alol6rddv5sb2bdvcrrlcnd2gii.png" alt="image"><br><br>  Analysons le code.  Commençons par le tout début. <br><br><img src="https://habrastorage.org/webt/qw/xc/bl/qwxcblutrdva_qolfdwf-73ly5a.png" alt="image"><br><br>  Il existe des définitions d'une entrée clé.  Le bloc de gauche est responsable de l'achèvement de la fonction main_main.  Considérez le bloc de gauche. <br><br><img src="https://habrastorage.org/webt/id/lz/ep/idlzep3vvdaygibfacul2lkk654.png" alt="image"><br><br>  La fonction fmt_Scanln est conçue pour lire une ligne depuis la console.  Nous observons également les données main_statictmp_2 déjà enregistrées dans le programme. <br><br><img src="https://habrastorage.org/webt/ck/ax/zl/ckaxzlujz6fujy7j0-_ll4jepnw.png" alt="image"><br><br>  Ensuite, la fonction runtime_stringtoslicebyte est appelée, selon le code, nous pouvons supposer qu'elle prend les 6 premiers octets de la ligne suivante. <br><br><img src="https://habrastorage.org/webt/r3/cc/we/r3ccwecgpj5xsryu0fpwxs7v1rk.png" alt="image"><br><br>  Key.ptr pointera vers le début de cette tranche.  Voyons ce qui vient ensuite. <br><br><img src="https://habrastorage.org/webt/g-/az/20/g-az20dafliwk5zbnh2v6nshe5w.png" alt="image"><br><br>  En fonction de la comparaison du registre annulé r9 et du registre rsi, où se trouve la longueur de l'entrée utilisateur.  De cela, nous pouvons conclure que r9 sera très probablement un compteur.  Regardons le bloc de droite, où ira le contrôle, après la vente sur la ligne que nous avons entrée. <br><br><img src="https://habrastorage.org/webt/mx/5j/06/mx5j06gmchi2gjdbrf-mcsb_hqm.png" alt="image"><br><br>  La fonction bytes_Compare est appelée, qui, selon le résultat de la comparaison, affiche l'une des lignes. <br><br><img src="https://habrastorage.org/webt/b7/cn/vr/b7cnvrhqs_fsqp-uatxwxlyjexa.png" alt="image"><br><br><img src="https://habrastorage.org/webt/we/yr/ux/weyruxmli0lx7o-cqirm-d21y-w.png" alt="image"><br><br>  Nous avons compris la sortie du programme, maintenant regardons les sauts de ligne (sur la branche de gauche). <br><br><img src="https://habrastorage.org/webt/ar/dg/o7/ardgo7e72wahuqkhplofgq8ra4q.png" alt="image"><br><br>  Le caractère de l'entrée utilisateur est entré dans le registre r10, puis il y a un tas de code complexe pour les comparaisons afin de contrôler les exceptions comme la division de panique et l'index de panique.  J'ai mis en évidence la branche d'exécution du programme. <br><br><img src="https://habrastorage.org/webt/ro/cu/hw/rocuhwupgwtuqpiztxbnmklvwss.png" alt="image"><br><br>  Ainsi, un octet d'une chaîne spécifiée statiquement est placé dans EDX et se dispute avec r10, où est l'octet de la tranche.  Ensuite, le compteur r9 augmente.  Deux blocs adjacents au milieu sont probablement nécessaires pour contrôler la longueur de la coupe. <br><br>  Combinons tout ensemble: la ligne entrée est contaminée par une tranche et comparée à une ligne spécifiée statiquement.  Prenons un proxy pour trouver le mot de passe correct. <br><br><img src="https://habrastorage.org/webt/ib/kk/7y/ibkk7yaax3jua88xifvef2c6u-o.png" alt="image"><br><br>  Nous obtenons la réponse.  La complexité de l'inverse des binaires Go est qu'il y a des facteurs de complication comme l'absence de caractère nul à la fin des lignes, la présentation de leurs types, le garbage collector, etc. <br><br>  C'est tout pour l'instant.  À suivre ... Vous pouvez nous rejoindre sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Telegram</a> .  Là, vous pouvez proposer vos propres sujets et voter sur le choix des sujets pour les articles suivants. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474656/">https://habr.com/ru/post/fr474656/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr474646/index.html">À propos des perspectives du format 360 Reality Audio, des photos d'oreille et des vieux oubliés</a></li>
<li><a href="../fr474648/index.html">Recrutement informatique. Recherche d'un équilibre processus / résultat</a></li>
<li><a href="../fr474650/index.html">Chariot de camion ROS. Partie 8. Nous contrôlons à partir du téléphone-ROS Control, GPS-node</a></li>
<li><a href="../fr474652/index.html">Arrêtez de ne pas faire votre travail</a></li>
<li><a href="../fr474654/index.html">Poignée de main SSH en termes simples.</a></li>
<li><a href="../fr474658/index.html">Douleur au poignet et souris d'ordinateur</a></li>
<li><a href="../fr474662/index.html">Test bêta: Devdiction for Developers - une plateforme pour apprendre l'anglais</a></li>
<li><a href="../fr474664/index.html">Pour augmenter l'attention, notre cerveau n'augmente pas la concentration, mais utilise des filtres d'information</a></li>
<li><a href="../fr474666/index.html">Comment ne pas réécrire un projet dans Rust</a></li>
<li><a href="../fr474668/index.html">Actions GitHub en tant que CI / CD pour un site sur un générateur statique et des pages GitHub</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>