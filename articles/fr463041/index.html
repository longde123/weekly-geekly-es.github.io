<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëêüèª üë®üèΩ‚ÄçüöÄ üë®‚Äçüéì D√©fini ou non d√©fini? Nuances de cr√©ation de tableaux en JavaScript üßïüèø üë©üèº‚Äç‚úàÔ∏è üê¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a quelques mois, je suis tomb√© sur une question int√©ressante sur stackoverflow , o√π, en bref, une personne voulait cr√©er une matrice 5x5 vide, et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©fini ou non d√©fini? Nuances de cr√©ation de tableaux en JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463041/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/uz/xt/cfuzxt6gszx356ckhbffnh21g9g.jpeg" alt="image"></div><br>  Il y a quelques mois, je suis tomb√© sur une question int√©ressante sur <i>stackoverflow</i> , o√π, en bref, une personne voulait cr√©er une matrice <i>5x5</i> vide, et en utilisant une m√©thode, il a r√©ussi, mais en utilisant une autre, il n'a pas r√©ussi.  Au cours de la discussion qui a suivi, des r√©flexions int√©ressantes ont √©t√© cit√©es √† ce sujet. <br><br>  Certes, la personne qui a pos√© la question, ainsi que ceux qui lui ont r√©pondu, n'ont pas pr√™t√© attention au fait qu'en fait la matrice ne pouvait pas √™tre cr√©√©e et le r√©sultat du calcul √©tait incorrect.  Tout cela m‚Äôint√©ressait, et j‚Äôai d√©cid√© de creuser un peu plus, puis de tirer des conclusions int√©ressantes, que je vais partager avec vous maintenant. <br><a name="habracut"></a><br>  <i>Remarque: J'ai √©galement r√©pondu dans le cadre de cette discussion, sous le surnom d' <i>AndreyGS</i> - l√†, j'ai r√©pondu assez bri√®vement, ici, je vais essayer de couvrir compl√®tement le probl√®me.</i> <br><br>  En g√©n√©ral, le d√©fi est de cr√©er un tableau.  Comment allons-nous proc√©der?  Curieusement, il existe diff√©rentes options, selon ce que nous voulons obtenir. <br><br>  Nous savons que les fonctions en JavaScript ont deux m√©thodes internes, <i>Call</i> et <i>Construct</i> .  Si nous utilisons le <i>nouveau</i> mot-cl√©, la m√©thode Construct est utilis√©e, qui cr√©e une nouvelle instance de l'objet, lui attribue <i>cette</i> r√©f√©rence, puis ex√©cute le corps de la fonction.  Toutes les fonctions n'ont pas cette m√©thode, mais pour nous, ce n'est pas si important en ce moment. <br><br>  Lors de la cr√©ation de tableaux, il y a une particularit√©: peu importe que nous <i>utilisions un tableau (...)</i> ou un <i>nouveau tableau (...)</i> - la sp√©cification <i>ECMAScript</i> ne les distingue pas et, de plus, les consid√®re comme √©quivalents. <br><br><pre><code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> The Array Constructor The Array constructor is the <span class="hljs-variable"><span class="hljs-variable">%Array%</span></span> intrinsic object and the initial value of the Array property of the global object. When called as a constructor it creates and initializes a new exotic Array object. When Array is called as a function rather than as a constructor, it also creates and initializes a new Array object. Thus the function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> Array(‚Ä¶) is equivalent to the object creation expression new Array(‚Ä¶) with the same arguments.</code> </pre> <br>  Par cons√©quent, je ne philosopherai pas malicieusement, et dans les exemples, je n'utiliserai que la <i>nouvelle construction Array (...)</i> , afin de ne confondre personne. <br><br>  Commen√ßons. <br><br>  Cr√©ez un tableau: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>);</code> </pre> <br>  Qu'avons-nous obtenu? <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // undefined</span></span></code> </pre> <br>  Hmm ... eh bien, en principe, il devrait en √™tre ainsi - nous avons d√©fini la longueur et obtenu cinq cellules vides, avec la valeur <i>non d√©finie</i> , qui peuvent √™tre travaill√©es davantage, non?  Certes, il y a quelques points qui me confondent.  Voyons √ßa. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>).map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>); }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ &lt;5 empty slots&gt; ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // undefined console.log(arr[0][0]); // TypeError: arr[0] is undefined</span></span></code> </pre> <br>  Comment se fait-il, apr√®s tout, que nous ayons d√ª obtenir une matrice, et dans chaque cellule, en cons√©quence, il devrait y avoir un tableau de 5 √©l√©ments ... <br><br>  Revenons √† la documentation <i>ECMAScript</i> et voyons ce qui y est √©crit concernant la m√©thode de cr√©ation de tableaux avec un argument: <br><br><pre> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span> Array (len) This description applies <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> and only <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the Array constructor is called with exactly one argument. <span class="hljs-number"><span class="hljs-number">1</span></span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>. <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: numberOfArgs = <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let newTarget be NewTarget. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable"><span class="hljs-variable">%ArrayPrototype%</span></span>"). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(proto). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let array be ArrayCreate(<span class="hljs-number"><span class="hljs-number">0</span></span>, proto). <span class="hljs-number"><span class="hljs-number">7</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(len) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> Number, then <span class="hljs-number"><span class="hljs-number">1</span></span>. Let defineStatus be CreateDataProperty(array, "<span class="hljs-number"><span class="hljs-number">0</span></span>", len). <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: defineStatus is true. <span class="hljs-number"><span class="hljs-number">3</span></span>. Let intLen be <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">8</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>. Let intLen be ToUint32(len). <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> intLen ‚â† len, throw a RangeError exception. <span class="hljs-number"><span class="hljs-number">9</span></span>. Let setStatus be <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span>(array, "length", intLen, true). <span class="hljs-number"><span class="hljs-number">10</span></span>. Assert: setStatus is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> an abrupt completion. <span class="hljs-number"><span class="hljs-number">11</span></span>. Return array.</code> </pre> <br>  Et, ce que nous voyons, il s'av√®re que l'objet est cr√©√©, la propri√©t√© <i>length</i> est cr√©√©e dans la proc√©dure ArrayCreate (point 6), la valeur de la propri√©t√© <i>length</i> est d√©finie (point 9), et qu'en est-il des cellules?  Mis √† part le cas sp√©cial o√π l'argument pass√© n'est pas un nombre et qu'un tableau est cr√©√© avec une seule cellule ¬´0¬ª avec la valeur correspondante (point 7), il n'y a pas un mot √† leur sujet ... Autrement dit, il y a == 5 longueur, mais il n'y a pas cinq cellules.  Oui, le compilateur nous confond lorsque nous essayons d'acc√©der √† une seule cellule, il indique que sa valeur n'est <i>pas d√©finie</i> , alors qu'elle ne l'est pas r√©ellement. <br><br>  Voici, √† titre de comparaison, la m√©thode de cr√©ation de tableaux avec plusieurs arguments envoy√©s au constructeur: <br><br><pre> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span> Array (...items ) This description applies <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> and only <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the Array constructor is called with <span class="hljs-built_in"><span class="hljs-built_in">at</span></span> least two arguments. When the Array function is called the following steps are taken: <span class="hljs-number"><span class="hljs-number">1</span></span>. Let numberOfArgs be the number of arguments passed to this function <span class="hljs-keyword"><span class="hljs-keyword">call</span></span>. <span class="hljs-number"><span class="hljs-number">2</span></span>. Assert: numberOfArgs ‚â• <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> NewTarget is undefined, let newTarget be the active function object, <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let newTarget be NewTarget. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let proto be GetPrototypeFromConstructor(newTarget, "<span class="hljs-variable"><span class="hljs-variable">%ArrayPrototype%</span></span>"). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(proto). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let array be ArrayCreate(numberOfArgs, proto). <span class="hljs-number"><span class="hljs-number">7</span></span>. ReturnIfAbrupt(array). <span class="hljs-number"><span class="hljs-number">8</span></span>. Let k be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">9</span></span>. Let items be a zero-origined List containing the argument items <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> order. <span class="hljs-number"><span class="hljs-number">10</span></span>. Repeat, while k &lt; numberOfArgs <span class="hljs-number"><span class="hljs-number">1</span></span>. Let Pk be ToString(k). <span class="hljs-number"><span class="hljs-number">2</span></span>. Let itemK be items[k]. <span class="hljs-number"><span class="hljs-number">3</span></span>. Let defineStatus be CreateDataProperty(array, Pk, itemK). <span class="hljs-number"><span class="hljs-number">4</span></span>. Assert: defineStatus is true. <span class="hljs-number"><span class="hljs-number">5</span></span>. Increase k by <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">11</span></span>. Assert: the value of array's length property is numberOfArgs. <span class="hljs-number"><span class="hljs-number">12</span></span>. Return array.</code> </pre> <br>  Ici, s'il vous pla√Æt - 10 points, la cr√©ation de ces m√™mes cellules. <br><br>  Et maintenant, que fait <i>Array.prototype.map ()</i> ensuite? <br><br><pre> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">22</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">15</span></span> Array.prototype.map ( callbackfn [ , thisArg ] ) <span class="hljs-number"><span class="hljs-number">1</span></span>. Let O be ToObject(this value). <span class="hljs-number"><span class="hljs-number">2</span></span>. ReturnIfAbrupt(O). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let len be ToLength(Get(O, "length")). <span class="hljs-number"><span class="hljs-number">4</span></span>. ReturnIfAbrupt(len). <span class="hljs-number"><span class="hljs-number">5</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> IsCallable(callbackfn) is false, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">6</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> thisArg was supplied, let T be thisArg; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> let T be undefined. <span class="hljs-number"><span class="hljs-number">7</span></span>. Let A be ArraySpeciesCreate(O, len). <span class="hljs-number"><span class="hljs-number">8</span></span>. ReturnIfAbrupt(A). <span class="hljs-number"><span class="hljs-number">9</span></span>. Let k be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">10</span></span>. Repeat, while k &lt; len <span class="hljs-number"><span class="hljs-number">1</span></span>. Let Pk be ToString(k). <span class="hljs-number"><span class="hljs-number">2</span></span>. Let kPresent be HasProperty(O, Pk). <span class="hljs-number"><span class="hljs-number">3</span></span>. ReturnIfAbrupt(kPresent). <span class="hljs-number"><span class="hljs-number">4</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> kPresent is true, then <span class="hljs-number"><span class="hljs-number">1</span></span>. Let kValue be Get(O, Pk). <span class="hljs-number"><span class="hljs-number">2</span></span>. ReturnIfAbrupt(kValue). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let mappedValue be <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>(callbackfn, T, ¬´kValue, k, O¬ª). <span class="hljs-number"><span class="hljs-number">4</span></span>. ReturnIfAbrupt(mappedValue). <span class="hljs-number"><span class="hljs-number">5</span></span>. Let status be CreateDataPropertyOrThrow (A, Pk, mappedValue). <span class="hljs-number"><span class="hljs-number">6</span></span>. ReturnIfAbrupt(status). <span class="hljs-number"><span class="hljs-number">5</span></span>. Increase k by <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">11</span></span>. Return A.</code> </pre> <br>  Article 7 - une copie du tableau d'origine est cr√©√©e, √† l'article 10, des it√©rations sont effectu√©es sur ses √©l√©ments, et, en particulier, l'article 10.2 v√©rifie s'il y a une cellule sp√©cifique dans le tableau source, de sorte qu'en cas de succ√®s, mappez (10.4) et cr√©er la cellule appropri√©e dans la copie - 10.4.5.  √âtant donn√© que 10.2 donne <i>false</i> pour chacune des <i>5</i> passes, aucune cellule de la copie retourn√©e du tableau ne sera cr√©√©e non plus. <br><br>  Donc, comment le constructeur de tableau et la m√©thode <i>Array.prototype.map () fonctionnent,</i> nous l'avons compris, mais la t√¢che est rest√©e comme avant non r√©solue, car la matrice n'a pas √©t√© construite.  <i>Function.prototype.apply ()</i> viendra √† la rescousse! <br>  Voyons tout de suite en action: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ undefined, undefined, undefined, undefined, undefined ] console.log(arr[0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr,"0")); // Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> <br>  Hourra, les cinq cellules sont clairement observ√©es ici, et la premi√®re cellule de test portant le num√©ro <i>¬´0¬ª</i> a √©galement un descripteur. <br><br>  Dans ce cas, le programme a fonctionn√© comme suit: <br><br><ol><li>  Nous avons appel√© la m√©thode <i>Function.prototype.apply ()</i> et lui avons transmis le contexte <i>nul</i> , et en tant que <i>nouveau</i> tableau <i>Array (5)</i> . </li><li>  <i>new Array (5) a</i> cr√©√© un tableau sans cellules, mais avec une longueur de <i>5</i> . </li><li>  <i>Function.prototype.apply () a</i> utilis√© la m√©thode interne de d√©composition du tableau en arguments s√©par√©s, par cons√©quent, a transmis cinq arguments avec des valeurs <i>non d√©finies</i> au constructeur <i>Array</i> . </li><li>  <i>Le tableau a</i> re√ßu <i>5</i> arguments avec des valeurs <i>non d√©finies</i> , les a ajout√©s aux cellules correspondantes. </li></ol><br>  Tout semble clair, sauf quelle est cette m√©thode interne de <i>Function.prototype.apply ()</i> , qui fait <i>5</i> arguments √† partir de rien - je sugg√®re √† nouveau de regarder la documentation <i>ECMAScript</i> : <br><br><pre> <code class="dos hljs"><span class="hljs-number"><span class="hljs-number">19</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Function.prototype.apply <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> IsCallable(func) is false, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> argArray is null or undefined, then Return <span class="hljs-keyword"><span class="hljs-keyword">Call</span></span>(func, thisArg). <span class="hljs-number"><span class="hljs-number">3</span></span>. Let argList be CreateListFromArrayLike(argArray). <span class="hljs-number"><span class="hljs-number">7</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">17</span></span> CreateListFromArrayLike (obj [, elementTypes] ) <span class="hljs-number"><span class="hljs-number">1</span></span>. ReturnIfAbrupt(obj). <span class="hljs-number"><span class="hljs-number">2</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> elementTypes was <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> passed, let elementTypes be (Undefined, Null, Boolean, String, Symbol, Number, Object). <span class="hljs-number"><span class="hljs-number">3</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(obj) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> Object, throw a TypeError exception. <span class="hljs-number"><span class="hljs-number">4</span></span>. Let len be ToLength(Get(obj, "length")). <span class="hljs-number"><span class="hljs-number">5</span></span>. ReturnIfAbrupt(len). <span class="hljs-number"><span class="hljs-number">6</span></span>. Let list be an empty List. <span class="hljs-number"><span class="hljs-number">7</span></span>. Let index be <span class="hljs-number"><span class="hljs-number">0</span></span>. <span class="hljs-number"><span class="hljs-number">8</span></span>. Repeat while index &lt; len a. Let indexName be ToString(index). b. Let next be Get(obj, indexName). c. ReturnIfAbrupt(next). d. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Type</span></span>(next) is <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> an element of elementTypes, throw a TypeError exception. e. <span class="hljs-built_in"><span class="hljs-built_in">Append</span></span> next as the last element of list. f. <span class="hljs-built_in"><span class="hljs-built_in">Set</span></span> index to index + <span class="hljs-number"><span class="hljs-number">1</span></span>. <span class="hljs-number"><span class="hljs-number">9</span></span>. Return list.</code> </pre> <br>  Nous regardons les points les plus int√©ressants: <br><br>  19.2.3.1 - paragraphe 3: cr√©ation d'une liste d'arguments √† partir d'un objet similaire √† un tableau (comme nous le rappelons, de tels objets devraient avoir une propri√©t√© length). <br><br>  7.3.17 - la m√©thode de cr√©ation de liste elle-m√™me.  Il v√©rifie si l'objet est ou non, et si oui, une demande pour le champ de <i>longueur</i> (paragraphe 4).  Ensuite, un index √©gal √† <i>¬´0¬ª est cr√©√©</i> (paragraphe 7).  Une boucle est cr√©√©e avec un incr√©ment de l'index √† la valeur prise dans le champ de <i>longueur</i> (paragraphe 8).  Dans ce cycle, nous nous r√©f√©rons aux valeurs des cellules du tableau transmis avec les indices correspondants (articles 8a et 8b).  Et comme nous nous en souvenons, lorsque vous acc√©dez √† la valeur d'une seule cellule dans un tableau dans lequel il n'y a en fait pas de cellules, cela donne toujours une valeur - <i>non d√©finie</i> .  La valeur r√©sultante est ajout√©e √† la fin de la liste des arguments (paragraphe 8e). <br><br>  Eh bien, maintenant que tout est en place, vous pouvez construire en toute s√©curit√© la matrice tr√®s vide. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)); }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// Array(5) [ (5) [‚Ä¶], (5) [‚Ä¶], (5) [‚Ä¶], (5) [‚Ä¶], (5) [‚Ä¶] ] console.log(arr[0]); // Array(5) [ undefined, undefined, undefined, undefined, undefined ] console.log(Object.getOwnPropertyDescriptor(arr,"0")); // Object { value: (5) [‚Ä¶], writable: true, enumerable: true, configurable: true } console.log(arr[0][0]); // undefined console.log(Object.getOwnPropertyDescriptor(arr[0],"0")); // Object { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> <br>  Maintenant, comme vous pouvez le voir, tout converge et semble assez simple: nous, comme nous le savons d√©j√†, cr√©ons un simple <i>tableau Array.apply (null, new Array (5))</i> vide puis passez-le √† la m√©thode map, qui cr√©e le m√™me tableau dans chacune des cellules. <br><br>  De plus, vous pouvez le rendre encore plus facile.  L'op√©rateur <i>spread</i> - <i>...</i> est apparu dans <i>ECMAScript6</i> , et, ce qui est typique, il fonctionne √©galement sp√©cifiquement avec les tableaux.  Par cons√©quent, nous pouvons simplement entrer: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...new <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...new <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>)));</code> </pre> <br>  ou nous allons le simplifier compl√®tement, m√™me si j'ai d√©j√† promis √† nouveau de ne pas toucher ... <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...Array(<span class="hljs-number"><span class="hljs-number">5</span></span>)).map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(...Array(<span class="hljs-number"><span class="hljs-number">5</span></span>)));</code> </pre>  <i>Remarque: ici, nous avons √©galement utilis√© des fonctions de fl√®che, car nous avons toujours affaire √† un op√©rateur d'√©talement qui apparaissait dans la m√™me sp√©cification qu'eux.</i> <br><br>  Nous n'entrerons pas dans le principe de l'op√©rateur de <i>spread</i> , cependant, pour le d√©veloppement g√©n√©ral, je crois que cet exemple √©tait √©galement utile. <br><br>  De plus, nous pouvons bien s√ªr cr√©er nos fonctions qui, en utilisant le tri <i>Function.prototype.apply ()</i> , cr√©eront des tableaux normaux pour nous avec des cellules vides, cependant, en comprenant les principes internes de JavaScript et, en cons√©quence, l'utilisation correcte et ad√©quate fonctions int√©gr√©es, est une base √† ma√Ætriser qui est une priorit√©.  Eh bien, et, bien s√ªr, c'est si simple, plus rapide et plus pratique. <br><br>  Et enfin, revenant √† cette m√™me question sur <i>stackoverflow</i> - l√†, je me souviens, la personne a consid√©r√© √† tort que la m√©thode qu'il a re√ßue a conduit √† la bonne r√©ponse, et qu'il a re√ßu une matrice <i>5x5</i> , cependant - une petite erreur s'est gliss√©e dedans. <br><br>  Il est entr√©: <br><br> <code>Array.apply(null, new Array(5)).map(function(){ <br> return new Array(5); <br> });</code> <br> <br>  Selon vous, quel sera le r√©sultat r√©el ici? <br><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  console.log (arr);  // Tableau (5) [(5) [...], (5) [...], (5) [...], (5) [...], (5) [...]] <br>  console.log (arr [0]);  // Array (5) [&lt;5 emplacements vides&gt;] <br>  console.log (Object.getOwnPropertyDescriptor (arr, "0"));  // Objet {valeur: (5) [...], inscriptible: vrai, √©num√©rable: vrai, configurable: vrai} <br>  console.log (arr [0] [0]);  // non d√©fini <br>  console.log (Object.getOwnPropertyDescriptor (arr [0], "0"));  // non d√©fini <br></div></div><br>  n'est-ce pas, ce n'est pas tout √† fait ce qu'il voulait ... <br><br>  R√©f√©rences: <br><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Sp√©cification de langue ECMAScript 2015</a> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Que fait Array.apply?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463041/">https://habr.com/ru/post/fr463041/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463027/index.html">Revue ind√©pendante de PVS-Studio (Linux, C ++)</a></li>
<li><a href="../fr463031/index.html">Vivez et apprenez. Partie 3. Formation continue ou √¢ge de l'√©ternel √©tudiant</a></li>
<li><a href="../fr463035/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 471 (07.23.2019-29.07.2019)</a></li>
<li><a href="../fr463037/index.html">Vous cherchez de l'inspiration, ou comment vous sortir de F</a></li>
<li><a href="../fr463039/index.html">Aspirateur manucure bricolage</a></li>
<li><a href="../fr463045/index.html">D√©tectez automatiquement les √©motions dans les conversations textuelles √† l'aide de r√©seaux de neurones</a></li>
<li><a href="../fr463055/index.html">√Ä propos des administrateurs, des devops, de la confusion sans fin et de la transformation DevOps au sein de l'entreprise</a></li>
<li><a href="../fr463057/index.html">Yii Framework 2 Droits personnalis√©s</a></li>
<li><a href="../fr463059/index.html">Trois vies en informatique et pas seulement</a></li>
<li><a href="../fr463061/index.html">R√®gles de pr√©paration des mises en page dans Figma</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>