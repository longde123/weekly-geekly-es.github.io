<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòø üé© üï∏Ô∏è Microinteracciones en iOS. Conferencia de Yandex ‚ÜôÔ∏è üë¥üèª üßëüèΩ‚Äçü§ù‚ÄçüßëüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace unas semanas, se celebr√≥ un evento especial de la comunidad CocoaHeads en la oficina de Yandex, m√°s grande que los mitaps tradicionales. El desar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Microinteracciones en iOS. Conferencia de Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/429580/">  Hace unas semanas, se celebr√≥ un evento especial de la comunidad CocoaHeads en la oficina de Yandex, m√°s grande que los mitaps tradicionales.  El desarrollador Anton Sergeyev habl√≥ en esta reuni√≥n y habl√≥ sobre el modelo de microinteracci√≥n que los dise√±adores de UX suelen usar, as√≠ como sobre c√≥mo poner en pr√°ctica las ideas.  Anton prest√≥ m√°s atenci√≥n a la animaci√≥n. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/JoVBQCwX8ys" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Es muy importante para m√≠ que fue un honor conocer a los invitados.  Veo aqu√≠ a aquellos con quienes he conocido por mucho tiempo, aquellos con quienes he conocido recientemente y aquellos con quienes a√∫n no me he reunido.  Bienvenido a CocoaHeads. <a name="habracut"></a><br><br>  Te contar√© sobre micro interacciones.  Esto es un poco de clickbait: somos ingenieros, desarrolladores, hablaremos m√°s sobre la parte del software, pero comenzaremos con un tema muy humanitario, como las micro interacciones.  Como resultado, aplicaremos este tema humanitario en la parte t√©cnica para aprender a dise√±ar de manera m√°s eficiente y simple componentes visuales muy peque√±os, como botones, cargadores peque√±os, barras.  Est√°n saturados de animaci√≥n, y el c√≥digo de animaci√≥n ramificado a menudo puede parecer muy complicado, es extremadamente dif√≠cil de mantener. <br><br>  Pero primero, un poco de distracci√≥n.  Pi√©nselo, ¬ørecuerda cu√°ndo decidi√≥ convertirse en desarrollador?  Claramente lo recuerdo.  Todo comenz√≥ con una mesa.  Una vez decid√≠ aprender ObjC.  Lenguaje de moda, divertido, as√≠, sin planes de largo alcance.  Al parecer, encontr√© un libro, Big Nerd Ranch, y comenc√© a leer cap√≠tulo por cap√≠tulo, haciendo cada ejercicio, revisando, leyendo, hasta que llegu√© a la mesa.  Luego, primero me familiaric√© con el patr√≥n de delegado, m√°s precisamente con su subespecie "Fuente de datos", fuente de datos.  Este paradigma me parece muy simple ahora: hay una fuente de datos, delegado, todo es simple.  Pero luego me dej√≥ alucinado: ¬øc√≥mo puedo separar una tabla de datos completamente diferentes?  Una vez viste una tabla en una hoja de papel en la que puedes poner un n√∫mero infinito de filas, datos completamente abstractos.  Me influy√≥ mucho.  Me di cuenta de que la programaci√≥n, el desarrollo tiene enormes oportunidades, y ser√° muy interesante aplicarlas.  Desde entonces, decid√≠ convertirme en desarrollador. <br><br>  Durante el desarrollo, se encontraron varios patrones.  Enormes, que se llaman arquitecturas que describen toda la aplicaci√≥n.  Peque√±os que caben en docenas en un peque√±o bot√≥n.  Es importante comprender que todos estos patrones no provienen del aire, sino del sector humanitario.  El mismo patr√≥n de delegado.  La delegaci√≥n apareci√≥ mucho antes de la programaci√≥n, y la programaci√≥n se hace cargo de todas estas cosas humanitarias para un trabajo m√°s eficiente. <br><br>  Hoy hablar√© sobre otro enfoque que se hace cargo de otra cosa humanitaria.  En particular, sobre micro interacciones. <br><br>  Todo comenz√≥ con un cargador.  En el trabajo anterior, antes de Yandex, tuve la tarea de repetir el cargador de dise√±o de materiales de Google.  Hay dos de ellos, uno indefinido, el otro definido.  Tuve la tarea de combinarlos en uno, ten√≠a que ser capaz de ser cierto e indefinido, pero hab√≠a requisitos estrictos, por lo que era extremadamente suave.  En cualquier momento, podemos movernos de un estado a otro, y todo debe ser animado de manera fluida y precisa. <br><br>  Soy un desarrollador inteligente, hice todo.  Obtuve m√°s de 1000 l√≠neas de c√≥digo de fideos incomprensible.  Funcion√≥, pero recib√≠ un comentario genial sobre la revisi√≥n del c√≥digo: "Realmente espero que nadie edite este c√≥digo".  Y para m√≠ es pr√°cticamente inadecuado.  Escrib√≠ un c√≥digo horrible.  Funcion√≥ bien, fue una de mis mejores animaciones, pero el c√≥digo fue horrible. <br><br>  Hoy tratar√© de describir el enfoque que encontr√© despu√©s de dejar ese trabajo. <br><br><img src="https://habrastorage.org/webt/w6/93/ez/w693ezlmyrpdyxgcxluxx0scxdo.jpeg"><br><br>  Comencemos con el tema m√°s humanitario: los modelos de microinteracci√≥n.  ¬øC√≥mo est√°n incrustados y, en general, d√≥nde est√°n ocultos en nuestras aplicaciones?  Continuemos usando este modelo en nuestro mundo t√©cnico.  Considere c√≥mo UIView, que se ocupa de la visualizaci√≥n y la animaci√≥n, c√≥mo funciona esto.  En particular, hablaremos mucho sobre el mecanismo de CAAction, que est√° estrechamente integrado y funciona con UIView, CALayer.  Y luego considere peque√±os ejemplos. <br><br>  Definici√≥n primero.  Aparentemente, al autor realmente le gust√≥ el prefijo "micro", pero no hay macro o nano interacciones, el tama√±o no importa.  Por simplicidad, los llamaremos simplemente interacciones.  Este es un modelo tan conveniente que le permite describir cualquier interacci√≥n con la aplicaci√≥n, de principio a fin.  Consta de cuatro puntos: un desencadenante, l√≥gica empresarial que debe implementarse en esta interacci√≥n, comentarios para transmitir algo al usuario y un cambio en el estado de la aplicaci√≥n. <br><br>  Contar√© una historia con tres roles diferentes.  Comenzar√© con el usuario, como lo m√°s importante en el desarrollo.  Cuando me estaba preparando para el informe, me enferm√©.  Necesitaba encontrar una farmacia y abr√≠ Yandex.Map.  Abr√≠ la aplicaci√≥n, la miro, me mira, pero no pasa nada.  Luego me di cuenta de que yo era el usuario, soy el principal, doy instrucciones sobre qu√© hacer con la aplicaci√≥n.  Me orient√©, hice clic en el bot√≥n "buscar", ingres√© en "farmacia", hice clic en "Aceptar", la aplicaci√≥n realiz√≥ el trabajo interno, encontr√≥ las farmacias necesarias que estaban a mi lado y las visualic√© en la pantalla. <br><br>  Busqu√© el correcto y descubr√≠ que, adem√°s de las farmacias, aparec√≠a un bot√≥n especial en la pantalla para construir una ruta.  Por lo tanto, la aplicaci√≥n se ha movido a un nuevo estado.  Hice clic en √©l y fui a la farmacia.  Entr√© en esta aplicaci√≥n por alguna raz√≥n: para encontrar una farmacia.  La alcanc√©.  Soy un usuario feliz <br><br>  Antes de que apareciera esta aplicaci√≥n, y pude buscar algo en ella, primero se desarroll√≥.  ¬øQu√© pens√≥ el dise√±ador de UX cuando se le ocurri√≥ este proceso?  Todo comenz√≥ con el hecho de que era necesario salir de una escena muda cuando el usuario y la aplicaci√≥n se miran, y no sucede nada.  Para esto, se necesitaba alg√∫n tipo de disparador.  Todo tiene un comienzo, y aqu√≠, tambi√©n, fue necesario comenzar en alguna parte. <br><br>  Se ha seleccionado el disparador: bot√≥n de b√∫squeda.  Al hacer clic en √©l, era necesario resolver el problema desde un punto de vista t√©cnico.  Solicite datos en el servidor, analice la respuesta, actualice de alguna manera el modelo, analice.  Solicite la posici√≥n actual de los usuarios y m√°s.  Entonces obtuvimos estos datos y sabemos exactamente d√≥nde est√°n todas las farmacias. <br><br>  Parece que fue posible terminar con esto.  Despu√©s de todo, resolvimos el problema, encontramos todas las farmacias.  Solo hay un problema: el usuario a√∫n no sabe nada sobre estas farmacias.  Necesita comunicarlo. <br><br>  De alguna manera empacar nuestra soluci√≥n a este problema y llevarlo a √©l en un paquete hermoso para que lo entienda.  Dio la casualidad de que los usuarios son personas, interact√∫an con el mundo exterior a trav√©s de los sentidos.  El estado actual de la tecnolog√≠a es tal que nosotros, como desarrolladores de aplicaciones m√≥viles, tenemos solo tres sentidos: visi√≥n, podemos mostrar algo en la pantalla, audici√≥n, podemos reproducir en los altavoces y una sensaci√≥n t√°ctil, podemos empujar al usuario en la mano. <br><br>  Pero el hombre es mucho m√°s funcional.  Pero el estado actual de la tecnolog√≠a es tal que por el momento solo podemos confiar en estos tres.  Y en este caso seleccionamos una pantalla, mostramos en el mapa las farmacias m√°s cercanas y con una lista con informaci√≥n m√°s detallada sobre estas farmacias.  Y parece que esto es exactamente todo, el usuario encontr√≥ farmacias y todo est√° bien. <br><br>  Pero hay un problema.  Cuando el usuario ingres√≥ a la aplicaci√≥n, se encontraba en un contexto en el que no sab√≠a d√≥nde estaban ubicadas las farmacias.  Y sus tareas eran encontrarla.  Pero ahora el contexto ha cambiado, √©l sabe d√≥nde est√°n las farmacias, ya no necesita buscarlas.  Ten√≠a la siguiente tarea: obtener instrucciones para llegar a la pr√≥xima farmacia.  Es por eso que necesitamos mostrar controles adicionales en la pantalla, en particular, este es un bot√≥n para construir una ruta, es decir, transferir la aplicaci√≥n a otro estado en el que est√© lista para aceptar nuevos desencadenantes para las pr√≥ximas interacciones nuevamente. <br><br>  Imag√≠nese, el dise√±ador de UX se le ocurri√≥ todo esto, llega al desarrollador y comienza a describir en colores c√≥mo el usuario hace clic en el bot√≥n, c√≥mo y qu√© sucede, c√≥mo se busca, c√≥mo el usuario est√° contento, c√≥mo aumentamos la DAU, etc.  La pila de preguntas no resueltas del desarrollador se desbord√≥ en otro lugar en la primera oraci√≥n, cuando mencionamos por primera vez el bot√≥n. <br><br>  Escucha pacientemente todo, y al final, cuando termina, dice que est√° bien, esto es genial, pero discutamos el bot√≥n.  Este es un elemento importante. <br><br>  Durante la discusi√≥n, resulta que el bot√≥n es inherentemente un disparador, contiene l√≥gica dentro de s√≠ mismo, por lo que puede recibir mensajes del sistema, en particular, sobre los clics del usuario en la pantalla.  En funci√≥n de este clic, puede iniciar una cadena de eventos, que comienza con el hecho de que el mismo bot√≥n env√≠a mensajes a diferentes objetos sobre la necesidad de iniciar varios procesos, en este caso, solicitar informaci√≥n en el servidor, un poco m√°s. <br><br>  Cuando se presiona, el bot√≥n cambia su estado, se presiona.  Cuando el usuario libera, deja de presionarse.  Es decir, proporciona comentarios al usuario para que comprenda qu√© esperar de este bot√≥n.  Y el bot√≥n se puede presionar, no presionar, activo o inactivo, en diferentes estados, y moverse de acuerdo con una l√≥gica diferente de un estado a otro. <br><br>  Por lo tanto, vimos que el mismo modelo de microinteracci√≥n, que consiste en un disparador, l√≥gica empresarial, retroalimentaci√≥n y cambios de estado, puede describir nuestra aplicaci√≥n en varias escalas, como en la escala de un caso de usuario completo, una gran b√∫squeda de la farmacia m√°s cercana, as√≠ que en t√©rminos de un peque√±o bot√≥n. <br><br>  Y este es un modelo muy conveniente que le permite simplificar la interacci√≥n dentro del equipo y describir mediante programaci√≥n cuatro entidades separadas: disparador, l√≥gica de negocios, retroalimentaci√≥n y cambio de estado.  Veamos qu√© nos proporciona UIKit para usarlo.  Y no solo proporciona, sino que usa.  Al implementar varias animaciones, los peque√±os componentes de las subclases de UIView, solo usa este mecanismo y no funciona de manera diferente. <br><br>  Comencemos con UIView, c√≥mo encaja en este modelo.  Luego consideraremos CALayer que nos brinda para apoyar estos estados, y consideraremos el mecanismo de acciones, el momento m√°s interesante. <br><br>  Comencemos con la UIView.  Lo usamos para mostrar algunos rect√°ngulos en la pantalla.  Pero, de hecho, UIView no sabe c√≥mo dibujarse, utiliza otro objeto CALayer para esto.  De hecho, UIView se compromete a recibir mensajes sobre tocar el sistema, as√≠ como sobre otras llamadas, sobre la API que definimos en nuestras subclases de UIView.  Por lo tanto, UIView implementa la l√≥gica de activaci√≥n, es decir, el lanzamiento de algunos procesos, recibiendo estos mensajes del sistema. <br><br>  UIView tambi√©n puede notificar a sus delegados sobre los eventos que han ocurrido, y tambi√©n enviar mensajes a los suscriptores, como, por ejemplo, hacer que UIControl subclases diferentes eventos.  De esta manera, se implementa la l√≥gica de negocios de esta UIView.  No todos tienen l√≥gica empresarial, muchos de ellos son solo elementos de visualizaci√≥n y no tienen retroalimentaci√≥n en el sentido de la l√≥gica empresarial. <br><br><img src="https://habrastorage.org/webt/ur/9o/tu/ur9otu78v5xkyy3knr8ze443pl8.jpeg"><br><br>  Analizamos dos puntos, un disparador y una l√≥gica empresarial.  ¬øY d√≥nde est√°n escondidos los comentarios y el cambio de estado en UIView?  Para entender esto, debemos recordar que UIView no existe por s√≠ mismo.  Cuando se crea, crea una capa de fondo, una subclase de CALayer. <br><br><img src="https://habrastorage.org/webt/_y/dw/wt/_ydwwtnnokhkvxeuj5kl02v4qaa.jpeg"><br><br>  Y se nombra a s√≠ mismo su delegado.  Para comprender c√≥mo UIView usa CALayer, puede existir en varios estados. <br><br>  ¬øC√≥mo distinguir un estado de otro?  Difieren en el conjunto de datos que deben almacenarse en alg√∫n lugar.  Consideraremos qu√© caracter√≠sticas nos proporciona CALayer para UIView, para que almacene el estado. <br><br><img src="https://habrastorage.org/webt/ls/2x/7f/ls2x7f_qs_-ysgeirsunqki1o7o.jpeg"><br><br>  Nuestra interfaz se est√° expandiendo un poco, la interacci√≥n entre UIView y CALayer, UIView tiene una tarea adicional: actualizar el repositorio dentro de CALayer. <br><br>  Un hecho poco conocido que pocas personas usan: CALayer puede comportarse como una matriz asociativa, lo que significa que podemos escribir datos arbitrarios en cualquier tecla de la siguiente manera: setValue (_: forKey :). <br><br><img src="https://habrastorage.org/webt/hy/l_/r9/hyl_r9663azms_wx4qlf1f12ctw.jpeg"><br><br>  Este m√©todo est√° presente en todas las subclases de NSObject, pero a diferencia de muchos otros, cuando se recibe una clave que no se anula, no se bloquea.  Y lo escribe correctamente, y luego podemos leerlo.  Esto es algo muy conveniente, que permite, sin crear subclases de CALayer, escribir datos all√≠ y luego leerlos, consultarlos.  Pero este es un repositorio simple muy primitivo, de hecho, un diccionario.  CALayer es mucho m√°s progresivo.  Es compatible con los estilos. <br><br>  Esto se implementa mediante la propiedad Style que tiene cualquier CALayer.  Por defecto, es nulo, pero podemos redefinirlo y usarlo. <br><br><img src="https://habrastorage.org/webt/ow/x1/ox/owx1ox1elo1_go_6jxikiuc6fws.jpeg"><br><br>  En general, este es un diccionario normal y nada m√°s, pero tiene una peculiaridad sobre c√≥mo CALayer trabaja con √©l, si solicitamos valor para Key, otro m√©todo que tiene NSObject.  Act√∫a de manera muy interesante, busca los valores necesarios en el diccionario de estilo de forma recursiva.  Si empaquetamos un estilo existente en un nuevo estilo con la tecla de estilo y escribimos algunas teclas all√≠, pero se ver√° de la siguiente manera. <br><br><img src="https://habrastorage.org/webt/xd/m3/z1/xdm3z1vyiscv35nd1jspq5aujve.jpeg"><br><br>  Primero, mire la ra√≠z, luego tierra adentro y as√≠ sucesivamente, hasta que tenga sentido.  Cuando el estilo se vuelve nulo, entonces no tiene sentido mirar m√°s all√°. <br><br>  De esta manera, UIView puede, utilizando la infraestructura que proporciona CALayer, organizar cambios de estado, actualizar el repositorio interno de CALayer, ya sea usando estilo, un repositorio muy poderoso que puede simular una pila, o usando una matriz asociativa regular, que tambi√©n es muy eficiente y muy √∫til. . <br><br>  Terminado con almacenamiento, comience con CAAction.  Te contar√© m√°s sobre √©l. <br><br><img src="https://habrastorage.org/webt/r7/ay/kz/r7aykzzyhz25wrbcddkax9-oyzm.jpeg"><br><br>  Hay una nueva tarea para UIView: solicitar acciones de CALayer.  ¬øQu√© son las acciones? <br><br><img src="https://habrastorage.org/webt/rk/yi/le/rkyile_6v-vwfrq0d98sgeq4obs.jpeg"><br><br>  CAAction es solo un protocolo que tiene un solo m√©todo: ejecutar.  A Apple generalmente le encantan los temas de cine, la acci√≥n aqu√≠ como "c√°mara, motor".  Este "motor" es solo una acci√≥n, y no solo se us√≥ ese nombre.  El m√©todo de ejecuci√≥n significa iniciar una acci√≥n que puede iniciar, ejecutar y finalizar, que es lo m√°s importante.  Este m√©todo es muy gen√©rico, solo tiene una cadena de eventos y todo lo dem√°s puede ser de cualquier tipo.  En ObjC, todo esto es id y un NSDictionary normal. <br><br><img src="https://habrastorage.org/webt/3u/q-/6z/3uq-6zsnqrcdp_ijgpmbvljcxui.jpeg"><br><br>  Hay clases dentro de UIKit que satisfacen el protocolo CAAction.  El primero es la animaci√≥n.  Primero, sabemos que la animaci√≥n se puede agregar a una capa, pero esto es algo de muy bajo nivel.  Una abstracci√≥n de alto nivel por encima es ejecutar una acci√≥n con los par√°metros necesarios con una capa. <br><br>  La segunda excepci√≥n importante es NSNull.  Sabemos que no puede ser llamado por ning√∫n m√©todo, pero cumple con el protocolo CAAction, y esto se hace para buscar convenientemente CAAction en capas. <br><br><img src="https://habrastorage.org/webt/nm/34/9d/nm349dj4-hpwpaf2jshz4bjr6ee.jpeg"><br><br>  Como dijimos antes, UIView es un delegado a CALayer, y uno de los m√©todos de delegado es action (for: forKey :).  La capa tiene un m√©todo, acci√≥n para Key. <br><br><img src="https://habrastorage.org/webt/xh/1s/wz/xh1swzwsz49zo9iythd65yntg5a.jpeg"><br><br>  Podemos llamarlo en cualquier momento en la capa, y en cualquier momento dar√° la acci√≥n correcta o nula, ya que tambi√©n puede dar.  El algoritmo es una b√∫squeda muy inusual.  El pseudoc√≥digo est√° escrito aqu√≠, echemos un vistazo a las l√≠neas.  Al recibir dicho mensaje, primero consulta con el delegado.  Un delegado puede devolver nulo, lo que significa que la b√∫squeda debe continuar en otro lugar, o puede devolver una acci√≥n v√°lida, un objeto v√°lido que satisfaga el protocolo CAAction.  Pero hay una regla l√≥gica: si devuelve NSNull, que satisface este protocolo, luego se convertir√° en nulo.  Es decir, si devolvemos Null, de hecho significar√° "dejar de buscar".  No hay acci√≥n y no es necesario. <br><br>  Pero hay lo siguiente.  Despu√©s de consultar con el delegado y el delegado regres√≥ nulo, continu√≥ buscando.  Primero, en el diccionario de acciones, que tiene la capa, y luego buscar√° recursivamente en el diccionario de estilos, donde tambi√©n puede haber un diccionario con la tecla de acciones, en el que se pueden escribir muchas acciones, y tambi√©n podr√° buscarlas recursivamente.  Si eso no funcion√≥, le pedir√° a la clase la acci√≥n predeterminada para el m√©todo Key, que est√° definido por CALayer y hasta hace poco devolvi√≥ algo, pero √∫ltimamente siempre devuelve nil en las √∫ltimas versiones de iOS. <br><br>  Entendi√≥ la teor√≠a.  Veamos c√≥mo se aplica todo en la pr√°ctica. <br><br>  Hay eventos, tienen claves, algunas acciones tienen lugar en estos eventos.  B√°sicamente, se pueden distinguir dos tipos diferentes de eventos.  El primero es la animaci√≥n de las propiedades almacenadas.  Supongamos que cuando llamamos Viewcolor = red en View, te√≥ricamente es posible animar. <br><br><img src="https://habrastorage.org/webt/2i/6p/sc/2i6pscholbhv-jvln05rlepz1ru.jpeg"><br><br>  ¬øQu√© informe sobre patrones sin circuito?  Dibuj√© una pareja.  UIView tiene alg√∫n tipo de interfaz que hemos definido para subclases o una que se recibe del sistema con eventos.  La tarea de UIView es solicitar la acci√≥n deseada, actualizar el almac√©n interno e iniciar la acci√≥n que ocurri√≥.  El orden es muy importante con respecto a la solicitud: acci√≥n, solo luego actualice la acci√≥n, y solo luego actualice la tienda y la acci√≥n. <br><br><img src="https://habrastorage.org/webt/b4/qu/mm/b4qumm17wvgwfhycn1ld3z7tuka.jpeg"><br><br>  ¬øQu√© sucede si en UIView actualizamos backgroundColor?  Sabemos que en UIView todo lo relacionado con la visualizaci√≥n en pantalla sigue siendo un proxy para CALayer.  Guarda en cach√© todo lo que recibe, por si acaso, pero al mismo tiempo todo transmite CALayer, y se ocupa de toda la l√≥gica en CALayer.  ¬øQu√© sucede dentro de CALayer cuando recibe una tarea para cambiar el fondo?  Aqu√≠ todo es un poco m√°s complicado. <br><br><img src="https://habrastorage.org/webt/wd/gd/-p/wdgd-peskdkf3x9pt9ta408lpa8.jpeg"><br><br>  Para empezar, pedir√° acci√≥n.  Y es importante comprender que la acci√≥n se solicitar√° primero.  Esto le permitir√° preguntar a CALayer sus valores actuales, incluido backgroundColor, en el momento de crear la acci√≥n, solo entonces la tienda se actualizar√°, y cuando la acci√≥n recibida reciba el comando de ejecuci√≥n, podr√° consultar CALayer y obtener nuevos valores.  Por lo tanto, poseer√° tanto lo antiguo como lo nuevo, y esto le permitir√° crear animaci√≥n, si es necesario. <br><br>  Pero hay una caracter√≠stica en UIView, si cambiamos el color de fondo en UIView, si hacemos esto en el bloque de animaci√≥n, entonces est√° animado, y si est√° fuera del bloque de animaci√≥n, no est√° animado. <br><br><img src="https://habrastorage.org/webt/nm/34/9d/nm349dj4-hpwpaf2jshz4bjr6ee.jpeg"><br><br>  Todo es muy simple, no hay magia.  Pero solo recuerde que UIView es un delegado de CALayer, tiene ese m√©todo.  Todo es muy sencillo. <br><br>  Si este m√©todo se ejecut√≥ en el bloque de animaci√≥n, devolver√° alg√∫n tipo de acci√≥n.  Si est√° fuera del bloque de animaci√≥n, este m√©todo devolver√° NSNull, lo que significa que no es necesario animar nada.      ,  CALayer      . <br><br>       ,  UIView   ,  .         .       ? <br><br><img src="https://habrastorage.org/webt/hb/bp/j_/hbbpj_qzzphg6b_dvw-mhbmceak.jpeg"><br><br>    ,   .  UIView   ,  read only,      ,  inheritedAnimationDuration.    .      ,      .      . <br><br>    ?          duration,      .        ,   run, ,      . <br><br><img src="https://habrastorage.org/webt/a6/4u/n9/a64un9twddqprjgzjvzwnppwnpk.jpeg"><br><br>       ,   CAAction,  backgroundcolor  opacity,     UIView .  ,      ,  ,  ,  .          .    setValue forKey    ,        ,     ,   ,       ,      ,   . <br><br>     ,       ,    ,   ,   . <br><br>    ‚Äî      . ,    ¬´¬ª  ¬´¬ª   .    . <br><br>    . <br><br><img src="https://habrastorage.org/webt/l6/je/7m/l6je7mjo7fnwwxyvfql1y-yuy0q.jpeg"><br><br>     . ,        ,         ,    .               UIView   CALayer,       ,    , CAAction, ,  ,   . <br><br><img src="https://habrastorage.org/webt/q6/uo/jq/q6uojqtnrhojwxpuuwzxtuentju.jpeg"><br><br><img src="https://habrastorage.org/webt/jg/ax/_s/jgax_s_wow82hbtxeax_29d3brw.jpeg"><br><br> ,     ,    ,       .            ,       .    . <br><br>    .   - . <br><br>             CAAction,    ,   .   ,    ,    ,  . <br><br><img src="https://habrastorage.org/webt/pa/0b/b8/pa0bb8gtuowzwknknhve-btxbsw.jpeg"><br><br>   ,       , ,    home,    .     ,    . ,      . <br><br><img src="https://habrastorage.org/webt/hw/5r/l8/hw5rl8bhdrs4fvmi503inw7iauq.jpeg"><br><br>      .   - . <br><br><img src="https://habrastorage.org/webt/bp/np/di/bpnpdiveiwjnqlxotgrvlr5egj8.jpeg"><br><br>   ,  -    , -   .     ,    ,    .     ,   . <br><br>      ,    ,      . <br><br><img src="https://habrastorage.org/webt/hj/ub/55/hjub55ptyxd7nbmmr9jur-zn3sy.jpeg"><br><br>   ,   CAAction      ,   .     ,   UIControl,  - ,   - ,     ,      ,  -   . <br><br> ,  .  ,  UIView  -,     ,   -   ,       ,   ,      . <br><br>    ‚Äî     .       . <br><br>   ?    .  ,          .      ‚Äî   .      activating,      inactive  active.        ,  ,        . <br><br><img src="https://habrastorage.org/webt/rz/lt/hw/rzlthwfk8lmduvkc_ltfagvorbk.jpeg"><br><br>    .   ,  onOrderIn  onOrderOut.  ,      UIKit,        . <br><br>  ,   -, ‚Äî ,    . <br><br><img src="https://habrastorage.org/webt/q4/8t/2v/q48t2v7xemofbmsmaydyaivlgqw.jpeg"><br><br>    .      UIView  ,      : isActive  progress.        .        CAAction,     . <br><br>   ,   .   ,  , 30 CAACtion,    .          ,   30 ,        NSNull.     15     15 .    .      ‚Äî  .   ,   ‚Äî      . <br><br> ,         .     . <br><br>   .  ,        ,    : , -,     . <br><br>       ,        , .            . ,  UIKit   ,      .   .     ,   ,          ,   .  Gracias por su atencion </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429580/">https://habr.com/ru/post/es429580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429568/index.html">Reduzca el tiempo de inactividad de Zimbra durante los bloqueos del servidor con Zextras Backup</a></li>
<li><a href="../es429570/index.html">Ense√±ar a un agente a jugar Mario Kart con filtros</a></li>
<li><a href="../es429572/index.html">Interceptar conversaciones privadas en Skype usando Devicelock DLP</a></li>
<li><a href="../es429574/index.html">Curso gratuito de Check Point para principiantes en CheckMates</a></li>
<li><a href="../es429578/index.html">¬øQu√© errores est√°n ocultos en el c√≥digo Infer.NET?</a></li>
<li><a href="../es429582/index.html">Indicador anal√≥gico de carga de la computadora</a></li>
<li><a href="../es429586/index.html">C√≥mo determinar el mejor momento para operar en el intercambio</a></li>
<li><a href="../es429588/index.html">Toda la verdad sobre RTOS. Art√≠culo # 20. Sem√°foros: servicios auxiliares y estructuras de datos</a></li>
<li><a href="../es429590/index.html">An√°lisis de voz para centros de llamadas basados ‚Äã‚Äãen SOLR</a></li>
<li><a href="../es429592/index.html">C√≥mo las tarjetas bancarias afectan la econom√≠a y por qu√© la bola blanca no despega</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>