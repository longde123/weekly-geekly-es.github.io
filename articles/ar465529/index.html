<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ ๐ฒ ๐ ุชุนููู ุนูู ุงูุญุฌุจ ๐ณ๏ธ โ๏ธ ๐จโ๐จ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชูุฏู ูุฐู ุงูููุงูุฉ ุฅูู ุฅุธูุงุฑ ููููุฉ ุงุณุชุฎุฏุงู Kotlin Coroutines ูุฅุฒุงูุฉ Reaxtive eXtensions (Rx) . 
 ููุงุฆุฏ 


 ููุจุฏุก ุ ุฏุนูุง ูููุฑ ูู ุฃุฑุจุนุฉ ููุงุฆุฏ ูู Coroutine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุนููู ุนูู ุงูุญุฌุจ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465529/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชูุฏู ูุฐู ุงูููุงูุฉ ุฅูู ุฅุธูุงุฑ ููููุฉ ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kotlin Coroutines</a> ูุฅุฒุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Reaxtive eXtensions (Rx)</a> . </p><br><h2 id="benefits" style=";text-align:right;direction:rtl">  ููุงุฆุฏ </h2><br><p style=";text-align:right;direction:rtl">  ููุจุฏุก ุ ุฏุนูุง ูููุฑ ูู ุฃุฑุจุนุฉ ููุงุฆุฏ ูู Coroutines ุนุจุฑ Rx: </p><br><h3 id="suspending-over-blocking" style=";text-align:right;direction:rtl">  ุชุนููู ุนูู ุงูุญุฌุจ </h3><br><p style=";text-align:right;direction:rtl">  ูุชุดุบูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุบูุฑ ุงููุญุธูุฑุฉ ุจุงุณุชุฎุฏุงู Rx ุ ููููู ูุชุงุจุฉ ุดูุก ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"><code class="kotlin hljs">Observable.interval(<span class="hljs-number"><span class="hljs-number">1</span></span>, TimeUnit.SECONDS) .subscribe { textView.text = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$it</span></span></span><span class="hljs-string"> seconds have passed"</span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุฎูู ูุนุงููุฉ ููุถูุน ุฌุฏูุฏ.  ุงูููุงุถูุน ูู ูุงุฆูุงุช ุซูููุฉ ูู ุญูุซ ุงูุฐุงูุฑุฉ ูุงูุฃุฏุงุก. </p><br><p style=";text-align:right;direction:rtl">  ููุงููุง ุฃูุฑ ุจุงูุบ ุงูุฃูููุฉ ูู ุนุงูู ุชุทููุฑ ุงููุญููู. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุชุญููู ููุณ ุงูุณููู ุจุงุณุชุฎุฏุงู ุงูููุชุทู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs">launch { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>){ textView.text = <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${it++}</span></span></span><span class="hljs-string"> seconds have passed"</span></span> delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>) } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูุฃุณุงุณ ุ Coroutines ูู ุฎููุท ุฎูููุฉ ุงููุฒู ูููููุง ูุง ููุดุฆ ุฃู ุฎูุท ุญูููู. <br>  ูุญู ููุง ูุณุชุฎุฏู ูุธููุฉ ุงูุชุฃุฎูุฑ ุบูุฑ ุงููุญุธูุฑุฉ () ุ ููู ูุธููุฉ ุชุนููู ุฎุงุตุฉ ูุง ุชููุน ุณูุณูุฉ ุงูุฑุณุงุฆู ูููููุง ุชุนูู Coroutine. <a name="habracut"></a></p><br><h3 id="natural-backpressure-handling-over-manual" style=";text-align:right;direction:rtl">  ุงูุถุบุท ุงูุฎููู ุงูุชุนุงูู ูุน ุฃูุซุฑ ูู ุฏููู </h3><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุถุบุท ุงูุฎููู ุนูุฏูุง ุชูุชุฌ ุงูููุงุฏ ุงููุงุจูุฉ ููููุงุญุธุฉ ุนูุงุตุฑ ุจุณุฑุนุฉ ุฃูุจุฑ ููุง ูุณุชููููุง ูุฑุงูุจููุง. <br>  ุฃุซูุงุก ุงุณุชุฎุฏุงู Rx ุ ุนููู ุชุญุฏูุฏ ููููุฉ ุชุนุงููู ูุน ุงูุถุบุท ุงูุฎููู ุจุดูู ุตุฑูุญ. <br>  ููุงู ุทุฑููุชุงู ุฃุณุงุณูุชุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ุงูุงุฎุชูุงู ุ ูุฎุงุฒู ุฃู ูุดุบูู ุงูููุงูุฐ </li><li style=";text-align:right;direction:rtl">  ูููุฐุฌ ุงูุณุญุจ ุงูุชูุงุนูู </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุญูู ุฃู Coroutines ูููู ุชุนููู ุฃููุง ุชููุฑ ุฅุฌุงุจุฉ ุทุจูุนูุฉ ููุชุนุงูู ูุน ุงูุถุบุท. <br>  ูุจุงูุชุงูู ุ ูุง ุชูุฌุฏ ุฅุฌุฑุงุกุงุช ุฅุถุงููุฉ ูุทููุจุฉ. </p><br><h3 id="sync-code-style-over-async" style=";text-align:right;direction:rtl">  ูุฒุงููุฉ ููุท ุงูููุฏ ุนูู ุงููุฒุงููุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุชุชูุซู ุงูุทุจูุนุฉ ุงูุฃุณุงุณูุฉ ูุชุทุจูู ุงูุฌูุงู ูู ุงูุฑุฏ ุนูู ุชุตุฑูุงุช ุงููุณุชุฎุฏู.  ูุฐุง ูู ุงูุณุจุจ ูู ุฃู ุงูุชูุงุนูุงุช ุงูุชูุงุนููุฉ ุณุชููู ุฎูุงุฑูุง ุฌูุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูุฌุจ ุนููู ูุชุงุจุฉ ุฑูุฒ ุจุฃุณููุจ ูุธููู.  ุฅุฐุง ููุช ุชุณุชุฎุฏู ุงููุชุงุจุฉ ุจุฃุณููุจ ุญุชูู ุ ููุฏ ูููู ุฐูู ุตุนุจุงู ุจุนุถ ุงูุดูุก. </p><br><p style=";text-align:right;direction:rtl">  ุจูููุง ูููููู Coroutines ูู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุบูุฑ ุงููุชุฒุงููุฉ ููุง ูู ูุงูุช ูุธุงุฆู ูุฒุงููุฉ ุนุงุฏูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showTextFromRemote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> text = remote.getText() textView.text = text }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุชู ุฃูุง ุฃุนูู ุจุฃุณููุจ ูุธููู ููุชุฑุฉ ุทูููุฉ ุ ูุง ุฒุงู ูู ุงูุฃุณูู ูุฑุงุกุฉ ูุชุตุญูุญ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุถุฑูุฑูุฉ. </p><br><h3 id="native-over-3rd-party-lib" style=";text-align:right;direction:rtl">  ููุงุทู ุนูู ุงูุทุฑู ุงูุซุงูุซ </h3><br><p style=";text-align:right;direction:rtl">  Coroutines ูู ููุฒุฉ ุงูุจูุงุก ุงูุฃุตูู ูู Kotlin. </p><br><p style=";text-align:right;direction:rtl">  ููุณ ูุฏูู ูุฅุถุงูุฉ ุฃู ุชุจุนูุงุช ุฅุถุงููุฉ.  ุญุงููุง ุ ูููู ูุฌููุน ุงูููุชุจุงุช ุงูุฑุฆูุณูุฉ ุงูุชุนุงูู ูุน coroutines. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุญุฏูุซูุฉ </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Api</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Get(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"users"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadUsers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> : List&lt;User&gt; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุบุฑูุฉ </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Dao</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Update</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">UserEntity</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ููููู ุฅูุดุงุก ุชุทุจูู ูุชู ุชุนูููู ุจุงููุงูู - ุจุฏุก ุทุจูุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู ุ ูู ุฎูุงู ุงููุฌุงู ูููุชูู ูู ุทุจูุฉ ุงูุจูุงูุงุช. </p><br><h2 id="app" style=";text-align:right;direction:rtl">  ุงูุชุทุจูู </h2><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุฅูู ุงูุนูู.  ุณูููู ุจุฅูุดุงุก ุชุทุจูู ุณูุฏ ุงูุชูุงุตูู ุงูููุงุณูููุฉ. <br>  ุณูู ุชุญุชูู ุงูุตูุญุฉ ุงูุฃููู ุนูู ูุงุฆูุฉ ูุง ุญุตุฑ ููุง ูู ุนูููุงุช ุงูุชุณููู. <br>  ุนูุฏ ุงูููุฑ ููู ุงูุนูุตุฑ ุ ุณููุชุญ ุตูุญุฉ ุชูุตูููุฉ. <br>  ุฃูุถูุง ุ ุณูุฏุนู ุงููุถุน ุบูุฑ ุงููุชุตู ุจุงูุฅูุชุฑูุช - ุณูุชู ุชุฎุฒูู ุฌููุน ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช. <br>  ุนูุงูุฉ ุนูู ุฐูู ุ ุณุฃุณุชุฎุฏู ุจููุฉ MVVM ุญูุซ ูุชู ูุนุจ ุฏูุฑ ViewModel ุจูุงุณุทุฉ Fragment ุจุฏูุงู ูู ViewModel ูู AAC.  ููุงู ุนุฏุฉ ุฃุณุจุงุจ: <br>  ุดุธุงูุง ุนุงุฏุฉ ูุง ุชููู ุฃุตูุน ุฌุฏุง - ููุท ุฑุจุท viewModel ุฅูู XML. </p><br><p style=";text-align:right;direction:rtl">  ูุง ูููู ุงูููุงู ุจููุฒุงุช ูุซู ุฅุนุฏุงุฏ ููู ุดุฑูุท ุงูุญุงูุฉ ูู AAC ViewModel - ุนููู ุชุดุบูู ุทุฑููุฉ ุงูุชุฌุฒุฆุฉ.  ุฅู ุงุณุชุฎุฏุงู ุงูุฌุฒุก ูู ViewModel ุณูุชูุญ ููุง ุชุฎุฒูู ุฌููุน ุงููุธุงุฆู ุฐุงุช ุงูุตูุฉ (ุฅุฏุงุฑุฉ ุดุงุดุฉ ูุงุญุฏุฉ ูุนููุฉ) ูู ูุตู ูุงุญุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฏุนูุง ููุดุฆ BaseViewModel: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseViewModel</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">B : BaseBindings, V : ViewDataBinding</span></span></span><span class="hljs-class">&gt; : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fragment</span></span></span></span>(), CoroutineScope <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> CoroutineScope(Dispatchers.IO){ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> layoutId: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindings: B <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> viewBinding: V <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState) retainInstance = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(inflater: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">LayoutInflater</span></span></span></span><span class="hljs-function"><span class="hljs-params">, container: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ViewGroup</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>: View? { viewBinding = DataBindingUtil.inflate(inflater, layoutId, container, <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewBinding.root } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onViewCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onViewCreated(view, savedInstanceState) viewBinding.lifecycleOwner = viewLifecycleOwner viewBinding.setVariable(BR.bindings, bindings) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { cancel() <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy() } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชูู ุจู ViewModel ุนูู ุฃูู CoroutineScope ุญุชู ูุชููู ูู ุจุฏุก ุชุดุบูู coroutines ุฏุงุฎู ููุงุฐุฌ ุงูุนุฑุถ ูุฃู ููุตูุฑุงุช ุชู ุฅุทูุงููุง ุณุชูุชุตุฑ ุนูู ุฏูุฑุฉ ุญูุงุฉ ุฌุฒุก ูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุญุฏุฏ ุจุดูู ุตุฑูุญ ุทุฑููุฉ <code>cancel()</code> ุฏูุฑุฉ ููุงูุฉ ุฏูุฑุฉ ุญูุงุฉ ุงููุทุงู ูุฅูุบุงุก ุฌููุน ุทูุจุงุช ุงูุชุดุบูู ูุชุฌูุจ ุชุณุฑุจ ุงูุฐุงูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุฏ ูููุง ุจุชุนููู <code>retainInstance = true</code> ุจุญูุซ ูุง ุชุชู ุฅุนุงุฏุฉ ุฅูุดุงุก ุฌุฒุก ูู ุชุบููุฑุงุช ุงูุชูููู ุญุชู ูุชููู ูู ุฅููุงู ุฌููุน ุงูุทูุจุงุช ุทูููุฉ ุงูุฃุฌู. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุถูุง ุ ูุชุนูู ุนูููุง ุชุนููู lifecycleOwner ุนูู ุงูุฑุจุท ูุชุดุบูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุจุท ุงูุจูุงูุงุช ุซูุงุฆู ุงูุงุชุฌุงู</a> . </p><br><h2 id="exception-handling" style=";text-align:right;direction:rtl">  ุงูุชุนุงูู ูุน ุงุณุชุซูุงุก </h2><br><p style=";text-align:right;direction:rtl">  ูููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุซุงุฆู</a> Coroutines: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Coroutine builders come in two flavors: propagating exceptions automatically (launch and actor) or exposing them to users (async and produce). The former treat exceptions as unhandled, similar to Java's Thread.uncaughtExceptionHandler</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃููุง ูุณุชุฎุฏู ุฃุฏุงุฉ ุฅูุดุงุก ุงูุฅุทูุงู ูู ูุนุธู ุงูุญุงูุงุช ุ ูุชุนูู ุนูููุง ุชุญุฏูุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoroutineExceptionHandler</a> <br>  CoroutineExceptionHandler ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoroutineContext.Element</a> ูุงูุฐู ูููู ุงุณุชุฎุฏุงูู ูุฅูุดุงุก ุณูุงู coroutine ุจุงุณุชุฎุฏุงู ุนุงูู ุงูุชุดุบูู plus. <br>  ุณูู ุฃุนูู ูุนุงูุฌ ุซุงุจุช ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> exceptionHandler = CoroutineExceptionHandler { _, throwable -&gt; Timber.e(throwable) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุบููุฑ BaseViewModel: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseViewModel</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">B : BaseBindings, V : ViewDataBinding</span></span></span><span class="hljs-class">&gt; : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fragment</span></span></span></span>(), CoroutineScope <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> CoroutineScope(Dispatchers.IO + exceptionHandler)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ููุง ุนูู ุฃู ุงุณุชุซูุงุก ุญุฏุซ ูู coroutine ุฃุทููุช ุฏุงุฎู ูุทุงู ViewModel ุณูุชู ุชุณููููุง ุฅูู ูุนุงูุฌ ูุนูู. <br>  ุจุนุฏ ุฐูู ุ ุฃุญุชุงุฌ ุฅูู ุฅุนูุงู API ู DAO ุงูุฎุงุตูู ุจู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeliveriesApi</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"deliveries"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDeliveries</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"offset"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Query(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"limit"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> limit: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: List&lt;DeliveryResponse&gt; } <span class="hljs-meta"><span class="hljs-meta">@Dao</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeliveryDao</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Query(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"SELECT * FROM </span></span><span class="hljs-subst"><span class="hljs-meta"><span class="hljs-meta-string"><span class="hljs-subst">${DeliveryEntity.TABLE_NAME}</span></span></span></span><span class="hljs-meta"><span class="hljs-meta-string">"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: DataSource.Factory&lt;<span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, DeliveryEntity&gt; <span class="hljs-meta"><span class="hljs-meta">@Insert(onConflict = OnConflictStrategy.REPLACE)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(delivery: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DeliveryEntity</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ุ ููุช ุจูุถุน ุนูุงูุฉ ุนูู ุงูุทุฑู ูุชุนููู ุ ุญุชู ูุชููู ููุท ูู ุฅุนูุงู ูุงุฆูุงุช ุงูุงุณุชุฌุงุจุฉ ุงููุชููุนุฉ.  ูุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ุฅูุบุงุก coroutine ุงูุฃุตู ุณูู ููุบู ููุงููุฉ ุงูุดุจูุฉ ูุฐูู. <br>  ุงูุดูุก ููุณู ุจุงููุณุจุฉ DAO. <br>  ุงููุฑู ุงููุญูุฏ ูู ุฃููุง ูุฑูุฏ ุชูููุฑ ุงููุฏุฑุฉ ุนูู ูุฑุงูุจุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช. <br>  ุฃุณูู ุทุฑููุฉ ูู ุงุณุชุฎุฏุงู ุฏุนู ุงูุจูุงูุงุช ุงููุจุงุดุฑุฉ ุงููุถููุฉ.  ูููู ุฅุฐุง ูุถุนูุง ุนูุงูุฉ ุนูู getAll () ููุนูู ุ ูุณูุคุฏู ุฐูู ุฅูู ุญุฏูุซ ุฎุทุฃ ูู ุงูุชุฑุฌูุฉ <br>  ุฎุทุฃ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Not sure how to convert a Cursor to this method's return type ...</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุง ูุญุชุงุฌ ุฅูู ุงูุชุนููู ุจุณุจุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุชูููุฐ ุทูุจุงุช Db ูู ุงูุฎูููุฉ ุงูุชุฑุงุถููุง </li><li style=";text-align:right;direction:rtl">  ูุชูุฌุฉ LiveData ุชุฏุฑู ุฏูุฑุฉ ุงูุญูุงุฉ ุจุญูุซ ูุง ูุญุชุงุฌ ุฅูู ุฅูุบุงุฆูุง ูุฏูููุง </li></ul><br><p style=";text-align:right;direction:rtl">  ุนูููุง ุฃู ูุฏูุฌ ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูุตุงุฏุฑ ุงูุจูุงูุงุช ุนู ุจุนุฏ ูุงููุญููุฉ. <br>  ูุฌุฏุฑ ุจูุง ุฃู ูุชุฐูุฑ - ูุฌุจ ุฃู ูููู ููุงู ููุทุฉ ูุงุญุฏุฉ ููุญูููุฉ. <br>  ูููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุตููู ุญุงููุง ุฎุงุฑุฌ</a> ุ ุณูููู ุงูุชุฎุฒูู ุงููุญูู.  ูุฐูู ุ ููุงุญุธ ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุนูุฏูุง ูุง ูููู ููุงู ุดูุก ูููู ุงุณุชุฑุฌุงุนู ุ ูุทูุจ ุงูุจูุงูุงุช ูู ุฌูุงุฒ ุงูุชุญูู ุนู ุจุนุฏ ูุฅุฏุฎุงููุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. <br>  ุณูู ููุฏู ูุฆุฉ ุงูุฅุฏุฑุงุฌ </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Listing</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">&gt;</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pagedList: LiveData&lt;PagedList&lt;T&gt;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dataState: LiveData&lt;DataState&gt;, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> refreshState: LiveData&lt;DataState&gt;, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> refresh: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> retry: () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> )</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ val ุจูุงุณุทุฉ ูุงู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  pagedList - ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูู PagedList ูุชูููู ุงูุชูุฑูุฑ ุงููุงููุงุฆู ููููููุฉ ูุน LiveData ูุชูููู ูุฑุงูุจุฉ ุงูุจูุงูุงุช </li><li style=";text-align:right;direction:rtl">  dataState - ูุงุญุฏุฉ ูู ุซูุงุซ ุญุงูุงุช ูููู ุฃู ุชููู ูููุง ุจูุงูุงุชูุง: ุงููุฌุงุญ ุ ุงูุชุดุบูู ุ ุงูุฎุทุฃ.  ูููููุฉ ุฃูุถูุง ุนูู LiveData ููุฑุงูุจุฉ ุงูุชุบููุฑุงุช </li><li style=";text-align:right;direction:rtl">  refreshState - ุนูุฏูุง ูููู ุจุชุดุบูู ุชุญุฏูุซ ุงูุจูุงูุงุช ูู ุฎูุงู ุงูุชูุฑูุฑ ุงูุณุฑูุน ุฅูู ุงูุชุญุฏูุซ ุ ูุญุชุงุฌ ุฅูู ุจุนุถ ุงูุฃุฏูุงุช ุงูุชู ูููุฒูุง ุจูู ููุงุญุธุงุช ุทูุจ ุงูุชุญุฏูุซ ูุชุนูููุงุช ุทูุจุงุช ุงูุตูุญุฉ ุงูุชุงููุฉ.  ุจุงููุณุจุฉ ููุฅุตุฏุงุฑ ุงูุณุงุจู ุ ููุฏ ุฃู ูุธูุฑ ุฎุทุฃ ูู ููุงูุฉ ุงููุงุฆูุฉ ุ ููู ุจุงููุณุจุฉ ูุฎุทุฃ ุงูุชุญุฏูุซ ุ ููุฏ ุฃู ูุธูุฑ ุฑุณุงูุฉ ุชูุณุช ูุฅุฎูุงุก ุฃุฏุงุฉ ุชุญููู. </li><li style=";text-align:right;direction:rtl">  refresh () - ุฑุฏ ุงูุงุชุตุงู ููุชู ุชุดุบููู ุนูุฏ ุงูุชูุฑูุฑ ุงูุณุฑูุน ููุชุญุฏูุซ </li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุงููุญุงููุฉ () - ุฑุฏ ุงูุงุชุตุงู ูุชุดุบูู ุฎุทุฃ ุชุญููู pagedList <br>  ุงูุชุงูู ุ ูููุฐุฌ ุนุฑุถ ุงููุงุฆูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeliveryListViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BaseViewModel</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DeliveryListBindings, DeliveryListBinding</span></span></span><span class="hljs-class">&gt;</span></span>(), DeliveryListBindings, DeliveryListItemBindings, DeliveryListErrorBindings { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> layoutId: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> = R.layout.delivery_list <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindings: DeliveryListBindings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> deliveryGateway: DeliveryGateway <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> inject { parametersOf(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> listing = deliveryGateway.getDeliveries() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dataState = listing.dataState <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> isRefreshing = Transformations.switchMap(listing.refreshState) { MutableLiveData(it == DataState.Loading) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onViewCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onViewCreated(view, savedInstanceState) setupList() setupRefresh() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> adapter = DeliveriesAdapter(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) viewBinding.deliveries.adapter = adapter viewBinding.deliveries.setHasFixedSize(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) listing.pagedList.observe(viewLifecycleOwner, Observer { adapter.submitList(it) }) listing.dataState.observe(viewLifecycleOwner, Observer { adapter.updateDataState(it) }) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupRefresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { listing.refreshState.observe(viewLifecycleOwner, Observer { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (it <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> DataState.Error) { Toast.makeText(context, it.message, LENGTH_SHORT).show() } }) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { listing.refresh() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDeliveryClicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(delivery: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Delivery</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { view?.findNavController()?.navigate(DeliveryListViewModelDirections.toDetails(delivery)) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRetryClicked</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { listing.retry() } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุจุฏุฃ ูู ุฅุนูุงู ุงููุตู. </p><br></li></ul><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ููุจู ูู ุดูุก DeliveryListBindings ู DeliveryListBinding.  ุงูุฃูู ูู ูุงุฌูุฉ ุงููุนููุฉ ูุฏููุง ููููุฐุฌ ุนุฑุถ ุงูุบุฑุงุก ูุน ุนุฑุถ XML.  ูุงูุซุงูู ูู ูุฆุฉ autogenerated ุนูู ุฃุณุงุณ XML.  ูุญุชุงุฌ ุฅูู ุงูุซุงููุฉ ูุถุจุท ูุงุฌูุฉ ุงูุฑุจุท ูุฏูุฑุฉ ุงูุญูุงุฉ ุนูู XML. </p><br><p style=";text-align:right;direction:rtl">  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุงูููุงุฑุณุงุช ุงูุฌูุฏุฉ ุงูุฅุดุงุฑุฉ ุฅูู ูุฌูุงุช ุงููุธุฑ ุจุงุณุชุฎุฏุงู ูุฐุง ุงูุฑุงุจุท ุงูููููุฏ ุชููุงุฆููุง ุจุฏูุงู ูู ุงุณุชุฎุฏุงู ูุงุฏุฉ kotlin ุงูุงุตุทูุงุนูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุฃู ูููู ุงูุฃูุฑ ูุฐูู ุนูุฏูุง ูุง ุชุชู ุงูุฅุดุงุฑุฉ ุฅูููุง ูู ุฎูุงู ุทุฑููุฉ ุงูุนุฑุถ ุงูุงุตุทูุงุนูุฉ ูู ุงูุนุฑุถ ุงูุญุงูู.  ูุน ุฑุจุท ุงูุจูุงูุงุช ุ ุณูู ุชูุดู ุจุณุฑุนุฉ ุญุชู ูู ูุฑุญูุฉ ุงูุชุฑุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุซู ุ ุซูุงุซ ูุงุฌูุงุช: DeliveryListBindings ุ DeliveryListItemBindings ุ DeliveryListErrorBindings. </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <em>DeliveryListBindings</em> - ุฑูุงุจุท ููุดุงุดุฉ ููุณูุง.  ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู ุนูู ุทุฑููุฉ ุชุญุฏูุซ () ุชุณูู ุนูู ุงูุชูุฑูุฑ ุงูุนููุฏู. </li><li style=";text-align:right;direction:rtl">  <em>DeliveryListItemBindings</em> - ุฑูุงุจุท ุนูุตุฑ ูู ุงููุงุฆูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ onClicked () </li><li style=";text-align:right;direction:rtl">  <em>DeliveryListErrorBindings</em> - ุฑูุงุจุท ุทุฑููุฉ ุนุฑุถ ุงูุฃุฎุทุงุก ุงูุชู ุชุนุฏ ุฃูุถูุง ุนูุตุฑ ุงููุงุฆูุฉ ุงููุนุฑูุถ ูู ุญุงูุฉ ุงูุฎุทุฃ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุญุชูู ุนูู ุทุฑููุฉ ุฅุนุงุฏุฉ ุงููุญุงููุฉ () </li></ol><br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ูุฅููุง ูุชุนุงูู ูุน ูู ุดูุก ูู ูููุฐุฌ ุงูุนุฑุถ ุงููุฑุฏู ูุธุฑูุง ูุฃูู ููุซู ุดุงุดุฉ ูุงุญุฏุฉ ูููู ุฃูุถูุง ูุชุจุน ูุจุฏุฃ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตู ุงููุงุฌูุฉ</a> </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูููุช ุงูุงูุชุจุงู ุจุดูู ุฎุงุต ุฅูู ูุฐุง ุงูุฎุท: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> deliveryGateway: DeliveryGateway <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> inject { parametersOf(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ <em>DeliveryGateway</em> ุฅูู ุชูููุฐ ุทูุจุงุช ุฎุงุฑุฌ ุงูุณูุณูุฉ ุงูุฑุฆูุณูุฉ.  ูุฐูู ุ ูุฅูู ูุญุชุงุฌ ุฅูุง ุฅูู ุงูุฅุนูุงู ุนู ุทุฑู ูุซู ุชุนููู ุฃู CoroutineScope ูุฅุทูุงู coroutines ุฌุฏูุฏุฉ ูู ูุฐุง ุงููุทุงู.  ุณูู ูุฎุชุงุฑ ุงูุทุฑููุฉ ุงูุซุงููุฉ ูุฃููุง ูุญุชุงุฌ ุฅูู LiveData ูู ุงูุจุฏุงูุฉ ููู ุซู ุณููุชุธุฑ ุงูุชุญุฏูุซุงุช ูููุง.  ุฅููุง ุชุดุจู ุฅูู ุญุฏ ุจุนูุฏ ุงูุงุดุชุฑุงู ูู ูุซูู liveData ุนูุฏูุง ููุฑุฑ ุฏูุฑุฉ ุญูุงุฉ ุงููุงูู (ูุงูุชู ุบุงูุจุงู ูุง ุชุดูุฑ ุฅูู "ูุฐุง").  ููุง ุจููุณ ุงูุทุฑููุฉ ุงูุชู ูุนุจุฑ ุจูุง "ูุฐุง" ุจุงุณู CoroutineScope </p><br><p style=";text-align:right;direction:rtl">  ุชุชููู ูุงุฌูุฉ CoroutineScope ูู ุญูู ูุญูุฏ - CoroutineContext.  ูู ุฌููุฑูุง ุ ุงููุทุงู ูุงูุณูุงู ููุง ููุณ ุงูุฃุดูุงุก.  ุงููุฑู ุจูู ุงูุณูุงู ูุงููุทุงู ูู ูู ุงูุบุฑุถ ุงูููุตูุฏ ููู. </p><br><p style=";text-align:right;direction:rtl">  ููุนุฑูุฉ ุงููุฒูุฏ ุญูู ูุฐุง ุฃูุฏ ุฃู ุฃูุตู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู</a> ูุฑููุงู ุฅููุฒุงุฑูู.  ูุฐูู ุ ุณูุคุฏู ุชูููุฑ ุงููุทุงู ุฅูู <em>DeliveryGateway</em> ุฃูุถูุง ุฅูู ุงุณุชุฎุฏุงู ููุณ ุงูุณูุงู.  ุนูู ูุฌู ุงูุชุญุฏูุฏ ููุถูุน ุ ูุธููุฉ ูุงูุงุณุชุซูุงุก ูุนุงูุฌ. <br>  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู DeliveryGateway ููุณูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeliveryBoundGateway</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> db: DataBase, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> api: DeliveriesApi, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> deliveryDao: DeliveryDao, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> coroutineScope: CoroutineScope ) : DeliveryGateway { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boundaryCallback = DeliveriesBoundaryCallback( api = api, coroutineScope = coroutineScope, handleResponse = { insertIntoDatabase(it) } ) <span class="hljs-meta"><span class="hljs-meta">@MainThread</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDeliveries</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: Listing&lt;Delivery&gt; { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> refreshTrigger = MutableLiveData&lt;<span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>&gt;() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> refreshState = Transformations.switchMap(refreshTrigger) { refresh() } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pagingConfig = Config( initialLoadSizeHint = PAGE_SIZE, pageSize = PAGE_SIZE, prefetchDistance = PAGE_SIZE ) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> deliveries = deliveryDao.getAll() .toLiveData( config = pagingConfig, boundaryCallback = boundaryCallback ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Listing( pagedList = deliveries, dataState = boundaryCallback.dataState, retry = { boundaryCallback.helper.retryAllFailed() }, refresh = { refreshTrigger.value = <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, refreshState = refreshState ) } <span class="hljs-comment"><span class="hljs-comment">/** * When refresh is called, we simply run a fresh network request and when it arrives, clear * the database table and insert all new items in a transaction. * &lt;p&gt; * Since the PagedList already uses a database bound data source, it will automatically be * updated after the database transaction is finished. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@MainThread</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">refresh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: LiveData&lt;DataState&gt; { boundaryCallback.refresh() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> dataState = MutableLiveData&lt;DataState&gt;() dataState.value = DataState.Loading coroutineScope.launch { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> deliveries = api.getDeliveries(<span class="hljs-number"><span class="hljs-number">0</span></span>, PAGE_SIZE) db.withTransaction { deliveryDao.clear() insertIntoDatabase(deliveries) } dataState.postValue(DataState.Loaded) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (throwable: Throwable) { Timber.w(throwable) dataState.postValue(DataState.Error(throwable.message)) } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dataState } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">suspend</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">insertIntoDatabase</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(deliveries: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">List</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">DeliveryResponse</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { deliveries.forEach { delivery -&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> entity = deliveryConverter.fromNetwork(delivery) deliveryDao.insert(entity) } } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> PAGE_SIZE = <span class="hljs-number"><span class="hljs-number">20</span></span> } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ููุง ูุจูู ูููู LiveData ูู ุงูุจุฏุงูุฉ ุซู ูุณุชุฎุฏู ุจูุงูุงุช ุชุญููู coroutines ูููุดุฑูุง ุนูู LiveData.  ุฃูุถูุง ุ ูุญู ูุณุชุฎุฏู ุชุทุจูู <em>PagedList.BoundaryCallback () ูุบุฑุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุญููุฉ ููุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุนู ุจูุนุฏ.</em>  <em>ุนูุฏูุง ูุตู ุฅูู ููุงูุฉ ูุงุฆูุฉ <em>ุงูุญุฏูุฏ</em> ุงูููุณูุฉ ุฅูู ุตูุญุงุช ูุชู ุชุดุบูู Callback ูุชุญููู ุงูุฌุฒุก ุงูุชุงูู ูู ุงูุจูุงูุงุช.</em> <br></p><p style=";text-align:right;direction:rtl">  ููุง ุชุฑูู ูุญู ูุณุชุฎุฏู coroutineScope ูุฅุทูุงู coroutines ุฌุฏูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ูุฐุง ุงููุทุงู ูุณุงูู ุฏูุฑุฉ ุญูุงุฉ ุงูุฌุฒุก - ุณูุชู ุฅูุบุงุก ุฌููุน ุงูุทูุจุงุช ุงููุนููุฉ ูู ุฑุฏ ุงูุงุชุตุงู <code>onDestroy()</code> . </p><br><p style=";text-align:right;direction:rtl">  ุตูุญุฉ ุชูุงุตูู ุงูุชุณููู ูุงุถุญุฉ ุชูุงููุง - ูุญู ููุท ููุฑุฑ ูุงุฆู ุงูุชุณููู ูู Parcelable ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ ุจุงุณุชุฎุฏุงู ูููู ุงูุชููู ุญูุธ ุงููููู ุงูุฅุถุงูู args.  ูู ุดุงุดุฉ ุงูุชูุงุตูู ุ ูู ุจุจุณุงุทุฉ ุจุฑุจุท ุฅุนุทุงุก ูุงุฆู ุฅูู XML. </p><br><pre style=";text-align:right;direction:rtl"> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeliveryViewModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BaseViewModel</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DeliveryBindings, DeliveryBinding</span></span></span><span class="hljs-class">&gt;</span></span>(), DeliveryBindings { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> layoutId: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> = R.layout.delivery <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindings: DeliveryBindings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> args: DeliveryViewModelArgs <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> navArgs() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onViewCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onViewCreated(view, savedInstanceState) viewBinding.delivery = args.delivery viewBinding.image.clipToOutline = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre> <br><h2 id="contact-me" style=";text-align:right;direction:rtl">  ุงุชุตู ุจู </h2><br><p style=";text-align:right;direction:rtl">  ููุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุงุจุท</a> ูููุฏ github ุงููุตุฏุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุงููุง ูุณููุง ุจูู ูู ุชุฑู ุงูุชุนูููุงุช ููุชุญ ุงููุถุงูุง. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar465529/">https://habr.com/ru/post/ar465529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar465519/index.html">ูุนุฑุถ ูููุญุชุฑููู // Movement.Expo</a></li>
<li><a href="../ar465521/index.html">Fly-fly-petal ... ุฃู ูุตุฉ ุญูู ููููุฉ ููุงู ูุตูู UX ุจุชุฑููุฌ ููุชุฌู ุนูู Instagram</a></li>
<li><a href="../ar465523/index.html">ุซุนุจุงู ุขุฎุฑ Android ูุน Kivy ุ Python</a></li>
<li><a href="../ar465525/index.html">ุชูุงุฑูุฑ ุงููุญููู ุนูู Oracle BI EE 12c - ูุงุญุฏ ุ ุงุซูุงู ุ ุซูุงุซุฉ. ุงููููุฌูุฉ ูู ุฏูุฑุฉ Oracle BI EE 12c CAD</a></li>
<li><a href="../ar465527/index.html">ุงูุฑุญูุฉ ุงูุทูููุฉ ูู RFC 4357 ุฅูู RFC 8645 ุฃู ููููุฉ ุฅุฏุงุฑุฉ ููุงุชูุญ ุงูุชุดููุฑ</a></li>
<li><a href="../ar465531/index.html">ุชูุฑูุบ ููุงุฆู ูุชุฏุงุฎูุฉ ูู ุนูู ุบูุฑ ูุณูู</a></li>
<li><a href="../ar465535/index.html">ุงูุฐู ูููุฐ IPv6 ุ ููุง ูุนูู ุชุทูุฑูุง</a></li>
<li><a href="../ar465537/index.html">ูุงูุฏูุณ: ููุฒู ุฐูู ุจุงูุบ</a></li>
<li><a href="../ar465539/index.html">766 ูู - ููู ุฑูู ููุงุณู ุฌุฏูุฏ ููุฌููุนุฉ LoRaWAN</a></li>
<li><a href="../ar465541/index.html">ูู Enterprise ุฅูู SMB: ูุดุงุฑู ุชุฌุฑุจุชูุง ูู ุชูููู ุญููู ุงูุดุฑูุงุช ููุดุฑูุงุช ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ ูุน ุชุณููู ุงูุฏุฎู ุจุงุณุชุฎุฏุงู ูููุฐุฌ SaaS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>