<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕟 👨🏼‍🎓 👩🏾 Pourquoi les graphiques de trafic "mentent" 🤟🏽 🙆🏼 🚴🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Être engagé dans la protection contre les attaques DDoS  Il est amené sur le site du client pour effectuer des tests de charge, des tests de défense e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pourquoi les graphiques de trafic "mentent"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441694/"> Être engagé dans la protection contre les attaques DDoS <img src="https://habrastorage.org/webt/gk/gq/zh/gkgqzhzw83sguowwwuo2dx9sdfk.png" alt="Différents graphiques basés sur les mêmes données" width="350" align="right">  Il est amené sur le site du client pour effectuer des tests de charge, des tests de défense et aider à repousser les attaques.  Souvent, vous observez une situation où les graphiques dans différents systèmes diffèrent sur le même trafic.  Une brève explication de «penser différemment» n'inspire pas confiance.  Par conséquent, il a décrit les raisons d'un article séparé.  Cet article sera utile aux débutants en ingénierie du fonctionnement du réseau et à ceux qui doivent gérer des plannings. <br><br>  Les raisons de la divergence des témoignages ont été divisées en trois groupes: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Compter</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. Collecte et stockage</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. Affichage</a> <br><a name="habracut"></a><br><a name="1"></a><h2>  <font color="#38a5d3">1. Compter</font> </h2><br>  Je vais commencer par la principale raison de l'écart et qui est le plus souvent négligée. <br><br>  1. Les ingénieurs pensent souvent que la taille minimale du "paquet" est de 64 octets. <br>  2. L'équipement réseau considère différemment la quantité d'informations transmises. <br><br><img src="https://habrastorage.org/webt/fz/td/yt/fztdyt2phekpdkjlhpxcjnic84i.png">  Les sources d'erreur et les réponses sont dans cette image. <br><br><a name="2"></a><h3>  <font color="#38a5d3">1.1 RTFM</font> </h3><br>  Rappel de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">structure d'en-tête Ethernet</a> <br><br><img src="https://habrastorage.org/webt/yy/s0/qi/yys0qi7tlv5y9mhtdsgwvdtjnh8.png"><br><br>  Par exemple, nous ferons des calculs pour 10 GbE.  Grâce à une interface 10 GbE, un maximum de <b>1 000 000 000 de</b> bits passent (10 ^ 10). <br><br>  Convertir la taille des en-têtes d'octets en bits <br><table><tbody><tr><th></th><th>  octets </th><th>  bits </th></tr><tr><td>  Taille de l'en-tête L1 </td><td>  20 </td><td>  160 </td></tr><tr><td>  Taille de l'en-tête MAC L2 </td><td>  14 </td><td>  112 </td></tr><tr><td>  Taille L2 FCS </td><td>  4 </td><td>  32 </td></tr><tr><td>  Taille du VLAN L2 </td><td>  4 </td><td>  32 </td></tr><tr><td>  Charge utile min </td><td>  46 </td><td>  368 </td></tr><tr><td>  Charge utile max </td><td>  1500 </td><td>  12000 </td></tr><tr><td>  <b>Total</b> </td></tr><tr><td>  Charge utile minimale sans VLAN </td><td>  <b>84</b> </td><td>  <b>672</b> </td></tr><tr><td>  Charge utile minimale avec VLAN </td><td>  88 </td><td>  704 </td></tr><tr><td>  Charge utile maximale sans VLAN </td><td>  <b>1538</b> </td><td>  <b>12304</b> </td></tr><tr><td>  Charge utile maximale avec VLAN </td><td>  1542 </td><td>  12336 </td></tr></tbody></table><br>  * L'utilisation de technologies de superposition sur le réseau de transport affecte la taille initiale de la <abbr title="Unité de données de protocole">PDU</abbr> , ce qui réduit le maximum de pps. <br>  ** Pour un exemple a pris VLAN.  Le traitement des trames avec des ID vlan sur les interfaces réseau peut varier.  Certains augmentent le MTU, d'autres réduisent la taille maximale autorisée de la charge utile. <br><br>  Nous calculons la vitesse maximale et minimale dans la <abbr title="Unité de données de protocole">PDU</abbr> par seconde avec l'utilisation complète de l'interface (wire-speed) <br><br><table><tbody><tr><td>  Pps max </td><td>  <b>14880952</b> .38 </td></tr><tr><td>  Pps max avec VLAN </td><td>  14204545.45 </td></tr><tr><td>  Min pps </td><td>  <b>812743</b> .8231 </td></tr><tr><td>  Min pps avec VLAN </td><td>  810635.5383 </td></tr></tbody></table><br><br>  C'est-à-dire  grâce à l'interface 10 GbE, le nombre maximal de passages ~ 14,88 Mpps.  Pour faciliter la mémorisation, nous l'appelons un zigapack. <br><br>  J'attire également l'attention sur le fait que les pps max et min pps diffèrent de plus de <b>18 fois</b> .  Pour cette raison, lorsque vous envisagez des solutions antiDDoS, vous devez faire attention aux performances dans Mpps.  Souvent, les fournisseurs revendiquent des performances en Gbps, silencieux dans les paquets.  La description des méthodes d'évaluation des performances des systèmes de protection fait l'objet d'un article volumineux distinct. <br><br><a name="3"></a><h3>  <font color="#38a5d3">1.2 Caractéristiques du comptage de la taille des PDU</font> </h3><br><img src="https://habrastorage.org/webt/fz/td/yt/fztdyt2phekpdkjlhpxcjnic84i.png"><br>  L'équipement réseau peut lire la taille de la <abbr title="Unité de données de protocole">PDU</abbr> à différents niveaux et exclure les champs du comptage.  Ensembles fréquents de champs pour compter: <br><br><ul><li>  L2 données ou paquet IP len </li><li>  Données L2 + en-tête MAC </li><li>  Données L2 + en-tête MAC + <abbr title="Séquence de vérification de trame">FCS</abbr> (somme de contrôle CRC) </li></ul><br>  Maintenant, nous calculons les lectures sur le graphique lors de l'attaque de TCP SYN Flood sur wirepeed sans et en utilisant vlan. <br><br><table><tbody><tr><th rowspan="2"></th><th rowspan="2">  Taille PDU <br>  (octets) </th><th colspan="2">  Multiplicateur Gbps </th></tr><tr><th>  10 <sup>9</sup> </th><th>  2 <sup>30</sup> </th></tr><tr><td>  Pps sans vlan = 14880952.38 </td><td></td><td></td><td></td></tr><tr><td>  L1 </td><td>  84 </td><td>  10 </td><td>  9.313225746 </td></tr><tr><td>  L2 </td><td>  64 </td><td>  <b>7.6190</b> 47619 </td><td>  7.095791045 </td></tr><tr><td>  L2 sans FCS </td><td>  60 </td><td>  <b>7.1428 57143</b> </td><td>  6.652304104 </td></tr><tr><td>  Données L2 (IP + TCP) </td><td>  40 </td><td>  4.761904762 </td><td>  4.434869403 </td></tr><tr><td>  Pps avec vlan = 14204545.45 </td><td></td><td></td><td></td></tr><tr><td>  L1 </td><td>  88 </td><td>  10 </td><td>  9.313225746 </td></tr><tr><td>  L2 </td><td>  68 </td><td>  7.727272727 </td><td>  7.196583531 </td></tr><tr><td>  L2 sans FCS </td><td>  64 </td><td>  7.272727273 </td><td>  6.773255088 </td></tr><tr><td>  Données L2 (IP + TCP) </td><td>  40 </td><td>  4.545454545 </td><td>  4.23328443 </td></tr></tbody></table><br>  Ainsi, avec l'utilisation complète de l'interface 10 GbE sur le graphique, vous pouvez observer une vitesse de 4,43 Gbps. <br><br>  Par conséquent, lorsque vous comparez des valeurs de vitesse dans différents systèmes, vous devez comprendre comment la taille de la PDU est prise en compte.  Pour simplifier la comparaison, nous avons fait une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">calculatrice</a> pour nous-mêmes, montrant la vitesse lors du comptage des différents en-têtes. <br><br>  Les deux autres groupes de causes suivants affectent le lissage des pics et s'appliquent à tous les graphiques de vitesse. <br><br><a name="4"></a><h2>  <font color="#38a5d3">2. Collecte et stockage</font> </h2><br><a name="5"></a><h3>  <font color="#38a5d3">2.1 Fréquence de contre-interrogation</font> </h3><br>  Compteurs généralement interrogés montrant la valeur absolue des octets et des paquets traités.  Pour afficher la vitesse, vous devez calculer la dérivée. <br><br>  La précision du graphique dépend fortement de la fréquence d'interrogation du compteur.  Moins souvent, plus la moyenne est élevée.  Par exemple, il est habituel pour les opérateurs de prendre des valeurs toutes les cinq minutes.  Par conséquent, avec les attaques Pulse Wave DDoS, les profils de graphique dans le système de surveillance et le système de filtrage seront très différents. <br><br><a name="6"></a><h3>  <font color="#38a5d3">2.2 Consolidation des données (politique de conservation)</font> </h3><br>  Souvent, l'approche de la base de données cyclique (rrd) est utilisée pour stocker les valeurs de compteur.  Afin d'économiser des ressources, les données pour différentes périodes sont stockées avec une précision différente.  Plus loin dans le passé, plus les valeurs sont clairsemées, plus la moyenne est grande. <br><br>  Différents systèmes peuvent avoir des politiques de rétention différentes, par conséquent, en regardant rétrospectivement les graphiques, vous pouvez observer différentes valeurs. <br><br><a name="7"></a><h2>  <font color="#38a5d3">3. Affichage</font> </h2><br><a name="8"></a><h3>  <font color="#38a5d3">3.1 Nombre de points sur le graphique</font> </h3><br>  Habituellement, sur le graphique, il y a une limite sur le nombre de points affichés.  S'il y a plus de points pendant la période demandée, alors lors de l'affichage les points sont consolidés.  Le plus souvent, les points voisins sont consolidés en un seul avec une valeur moyenne.  Cette moyenne lisse les pics. <br><br>  Exemple illustratif: <br><br><img src="https://habrastorage.org/webt/lm/ku/-v/lmku-vsnnsqaayqo8fa-y-pobj0.gif"><br><br><a name="9"></a><h3>  <font color="#38a5d3">3.2 Consoles binaires</font> </h3><br>  Une différence supplémentaire dans les lectures est ajoutée par les outils de dessin de graphique.  Pour les graphiques en bits, ils peuvent utiliser différents degrés pour afficher le même préfixe.  Vous pouvez en savoir plus sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">en.wikipedia.org/wiki/</a> <br><br><a name="10"></a><h3>  <font color="#38a5d3">3.3 Unités</font> </h3><br>  Fondamentalement, les compteurs de l'équipement réseau affichent la quantité d'informations traitées en octets.  S'il n'est pas converti, le graphique affichera la vitesse en Bps (octets par seconde) et non en bps (bits par seconde). <br><br><a name="11"></a><h2>  <font color="#38a5d3">Conclusion</font> </h2><br>  Les graphiques sont un outil utile et informatif.  En regardant le bon ensemble de graphiques, vous pouvez trouver rapidement des réponses à de nombreuses questions.  Mais lorsque vous travaillez avec des graphiques, vous devez comprendre les nuances, en particulier lors de la corrélation des graphiques de différents systèmes.  Par conséquent, la première fois que vous regardez le tableau, découvrez: <br><br><ul><li>  ce qui se passe et comment; </li><li>  comment est-il conservé; </li><li>  comme affiché. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr441694/">https://habr.com/ru/post/fr441694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr441684/index.html">Prédictions: les nuages ​​vont changer 2019</a></li>
<li><a href="../fr441686/index.html">Comment nous avons implémenté le cache sur la base de données Tarantool</a></li>
<li><a href="../fr441688/index.html">Les jeux changent le monde: comment Hellblade attire l'attention sur les problèmes des personnes atteintes de maladie mentale</a></li>
<li><a href="../fr441690/index.html">Vous n'avez pas besoin de blockchain: huit cas d'utilisation bien connus et pourquoi ils ne fonctionnent pas</a></li>
<li><a href="../fr441692/index.html">Comment couvrir les pistes de la blockchain? Notre concept de mélangeur de transactions</a></li>
<li><a href="../fr441696/index.html">L'histoire de Cyrillic LiveJournal: comment la direction russe a écrasé l'essor des blogs en russe</a></li>
<li><a href="../fr441698/index.html">Déconnecter: que se passe-t-il lorsque vous vous retirez de Facebook?</a></li>
<li><a href="../fr441700/index.html">Comment un puzzle pour enfants aide à révéler les secrets du magnétisme</a></li>
<li><a href="../fr441702/index.html">Sur le stockage des données personnelles, Roskomnadzor et les sites de rencontres</a></li>
<li><a href="../fr441704/index.html">Pourquoi vous ne devriez pas attendre les manifestations morales des robots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>