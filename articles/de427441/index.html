<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚧 🕎 👩🏼‍🏭 Konvergenz mit Kubernetes 🤛🏼 ⛩️ 🖐🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vollständige Standardisierung 


 Ich bereitete dieses Material für meine Rede auf der Konferenz vor und fragte unseren technischen Direktor, was das ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Konvergenz mit Kubernetes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/427441/"><h3 id="totalnaya-standartizaciya">  Vollständige Standardisierung </h3><br><p>  Ich bereitete dieses Material für meine Rede auf der Konferenz vor und fragte unseren technischen Direktor, was das Hauptmerkmal von Kubernetes für unsere Organisation sei.  Er antwortete: </p><br><blockquote>  Die Entwickler selbst verstehen nicht, wie viel zusätzliche Arbeit sie geleistet haben. </blockquote><p>  Anscheinend war er von dem kürzlich gelesenen Buch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Factfulness“</a> inspiriert - es ist schwierig, geringfügige und kontinuierliche Veränderungen zum Besseren zu bemerken, und wir verlieren ständig unsere Fortschritte aus den Augen. </p><br><p>  Der Wechsel zu Kubernetes ist aber definitiv nicht unerheblich. </p><br><p><img src="https://habrastorage.org/webt/72/vu/bn/72vubnen7dnspn7tp9wmy2if9cu.png"></p><a name="habracut"></a><br><p> Fast 30 unserer Teams führen alle oder einige Workloads in den Clustern aus.  Etwa 70% unseres HTTP-Datenverkehrs wird von Anwendungen in Kubernetes-Clustern generiert.  Dies ist wahrscheinlich die größte Technologiekonvergenz seit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meinem Eintritt</a> in das Unternehmen, nachdem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Forward 2010 uSwitch gekauft hat</a> , als wir von .NET und physischen Servern auf AWS und von einem monolithischen System auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microservices umgestiegen sind</a> . </p><br><p>  Und alles ging sehr schnell.  Ende 2017 nutzten alle Teams ihre AWS-Infrastruktur.  Sie richten Load Balancer, EC2-Instanzen, ECS-Cluster-Updates und ähnliches ein.  Etwas mehr als ein Jahr verging und alles änderte sich. </p><br><p>  Wir haben ein Minimum an Zeit für die Konvergenz aufgewendet. Infolgedessen hat Kubernetes uns bei der Lösung dringender Probleme geholfen - unsere Cloud wuchs, die Organisation wurde komplizierter und wir hatten Probleme, neue Mitarbeiter in Teams zu integrieren.  Wir haben die Organisation nicht geändert, um Kubernetes zu verwenden.  Im Gegenteil - wir haben Kubernetes verwendet, um die Organisation zu ändern. </p><br><p>  Die Entwickler haben vielleicht keine großen Änderungen bemerkt, aber die Daten sprechen für sich.  Dazu später mehr. </p><br><hr><br><p>  Vor vielen Jahren war ich auf einer Clojure-Konferenz und hörte einen Vortrag von Michael Nygard <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">über Architektur, der nicht in seinen endgültigen Zustand gebracht werden kann</a> .  Er öffnete meine Augen.  Ein ordentliches und ordentliches System sieht karikiert aus, wenn es Fernsehgeschäfte mit Küchenartikeln und der groß angelegten Softwarearchitektur vergleicht - das vorhandene System sieht aus wie ein dummes Messer, und anstelle von geraden Scheiben kommt eine Art Brei heraus.  Ohne ein neues Messer gibt es nichts, woran man denken könnte. </p><br><p>  Hier geht es darum, wie Organisationen dreijährige Projekte lieben: Das erste Jahr ist die Entwicklung und Vorbereitung, das zweite Jahr ist die Implementierung, das dritte ist die Rückkehr.  In einem Vortrag sagt er, dass solche Projekte normalerweise kontinuierlich durchgeführt werden und selten das Ende des zweiten Jahres erreichen (oft aufgrund der Übernahme durch ein anderes Unternehmen und einer Änderung der Richtung und Strategie), so dass die übliche Architektur ist </p><br><blockquote>  Schichtung des Wandels in einem gewissen Anschein von Stabilität. </blockquote><p>  Und uSwitch ist ein gutes Beispiel. </p><br><p>  Wir sind aus vielen Gründen zu AWS gewechselt - unser System konnte Spitzenlasten nicht bewältigen, und die Organisation wurde durch ein zu starres System und eng verwandte Teams behindert, die für bestimmte Projekte gebildet und durch Spezialisierung unterteilt wurden. </p><br><p>  Wir wollten nicht alles beenden, alle Systeme übertragen und neu beginnen.  Wir haben neue Dienste mit Proxy über den vorhandenen Load Balancer erstellt und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die alte</a> Anwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">schrittweise gedrosselt</a> .  Wir wollten sofort die Rückkehr zeigen und führten in der ersten Woche A / B-Tests der ersten Version des neuen Service in der Produktion durch.  Infolgedessen nahmen wir langfristige Produkte und begannen, aus Entwicklern, Designern, Analysten usw. Teams für sie zu bilden. Und wir sahen sofort das Ergebnis.  Im Jahr 2010 schien dies eine echte Revolution zu sein. </p><br><p>  Jahr für Jahr haben wir neue Teams, Dienste und Anwendungen hinzugefügt und das monolithische System schrittweise „erwürgt“.  Die Teams entwickelten sich schnell - jetzt arbeiteten sie unabhängig voneinander und bestanden aus Spezialisten in allen notwendigen Bereichen.  Wir haben die Teaminteraktionen für Produktversionen minimiert.  Wir haben nur für die Konfiguration des Load Balancers mehrere Befehle zugewiesen. </p><br><p>  Die Teams selbst wählten Entwicklungsmethoden, Tools und Sprachen.  Wir haben ihnen eine Aufgabe gestellt, und sie haben selbst eine Lösung gefunden, weil sie sich in dieser Angelegenheit am besten auskennen.  Mit AWS sind diese Änderungen einfacher geworden. </p><br><p>  Wir haben uns intuitiv an die Prinzipien der Programmierung gehalten - Teams, die lose miteinander verbunden sind, werden weniger wahrscheinlich kommunizieren und wir müssen keine wertvollen Ressourcen für die Koordination ihrer Arbeit aufwenden.  All dies wird in dem kürzlich veröffentlichten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Buch Accelerate</a> großartig beschrieben. </p><br><p>  Als Ergebnis haben wir, wie Michael Nygard beschrieben hat, ein System mit vielen Ebenen von Änderungen erhalten - einige Systeme wurden mit Puppet automatisiert, andere mit Terraform, irgendwo haben wir ECS verwendet, irgendwo EC2. </p><br><p>  2012 waren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wir stolz auf unsere Architektur, die leicht geändert werden konnte</a> , um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zu experimentieren</a> , erfolgreiche Lösungen zu finden und diese zu entwickeln. </p><br><p>  Aber 2017 haben wir festgestellt, dass sich viel geändert hat. </p><br><hr><br><p>  AWS ist jetzt viel komplexer als im Jahr 2010. Es bietet eine Vielzahl von Optionen und Funktionen - aber nicht ohne Konsequenzen.  Heute muss jedes Team, das mit EC2 arbeitet, eine VPC, eine Netzwerkkonfiguration und vieles mehr auswählen. </p><br><p>  Wir haben dies selbst erlebt - Teams begannen sich zu beschweren, dass sie immer mehr Zeit für die Wartung der Infrastruktur aufwenden, z. B. für die Aktualisierung von Instanzen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in AWS ECS-Clustern</a> , EC2-Maschinen, den Wechsel von ELB-Balancern zu ALB usw. </p><br><p>  Mitte 2017 forderte ich bei einer Firmenveranstaltung alle auf, ihre Arbeit zu standardisieren, um die Gesamtqualität der Systeme zu verbessern.  Ich habe die abgedroschene Eisberg-Metapher verwendet, um zu zeigen, wie wir Software erstellen und warten: </p><br><p><img src="https://habrastorage.org/webt/sn/ci/pt/sncipt6axzuuqa2pcqxrpbcwzh0.png"></p><br><p>  Ich sagte, dass die meisten Teams in unserem Unternehmen Services oder Produkte erstellen und sich auf Problemlösung, Anwendungscode, Plattformen und Bibliotheken usw. konzentrieren sollten. In dieser Reihenfolge.  Unter Wasser bleibt noch viel Arbeit - Integration von Protokollen, Verbesserung der Beobachtbarkeit, Verwaltung von Geheimnissen usw. </p><br><p>  Zu dieser Zeit befasste sich jedes Team von Anwendungsentwicklern mit fast dem gesamten Eisberg und traf alle Entscheidungen selbst - Auswahl der Sprache, der Entwicklungsumgebung, des Bibliotheks- und Metriktools, des Betriebssystems, des Instanztyps und des Speichers. </p><br><p>  Am Fuße der Pyramide hatten wir eine Amazon Web Services-Infrastruktur.  Es sind jedoch nicht alle AWS-Services gleich.  Sie verfügen über ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Backend-as-a-Service (BaaS)</a> , beispielsweise zur Authentifizierung und Datenspeicherung.  Und es gibt andere, relativ niedrige Dienste wie EC2.  Ich wollte die Daten studieren und verstehen, dass die Teams Grund zur Beschwerde haben und wirklich mehr Zeit damit verbringen, mit Low-Level-Diensten zu arbeiten und viele nicht die wichtigsten Entscheidungen zu treffen. </p><br><p>  Ich habe die Dienste in Kategorien unterteilt, mithilfe von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CloudTrail</a> alle verfügbaren Statistiken gesammelt und dann <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mithilfe von BigQuery</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Athena</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ggplot2 festgestellt</a> , wie sich die Situation für Entwickler in letzter Zeit geändert hat.  Das Wachstum für Dienste wie RDS, Redshift usw. halten wir für wünschenswert (und erwartet) und das Wachstum für EC2, CloudFormation usw. - umgekehrt. </p><br><p><img src="https://habrastorage.org/webt/dd/bd/-f/ddbd-fy5t4wzicbekukgyx_lji0.png"></p><br><p>  Jeder Punkt im Diagramm zeigt das 90. (rot), 80. (grün) und 50. (blau) Perzentil für die Anzahl der <strong>Dienste auf niedriger Ebene</strong> , die unsere Mitarbeiter für einen bestimmten Zeitraum jede Woche in Anspruch genommen haben.  Ich habe Glättungslinien hinzugefügt, um den Trend zu zeigen. </p><br><p>  Obwohl wir bei der Bereitstellung von Software, beispielsweise mithilfe von Containern und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Amazon ECS</a> , Abstraktionen auf höherer Ebene anstrebten, verwendeten unsere Entwickler regelmäßig immer mehr AWS-Services und abstrahierten nicht ausreichend von den Schwierigkeiten bei der Verwaltung von Systemen.  In zwei Jahren hat sich die Anzahl der Dienstleistungen für 50% der Beschäftigten verdoppelt und für 20% fast verdreifacht. </p><br><p>  Dies begrenzte das Wachstum unseres Unternehmens.  Die Teams suchten Autonomie, aber wie kann man neue Leute einstellen?  Wir brauchten starke Anwendungs- und Produktentwickler und Kenntnisse über das immer ausgefeilter werdende AWS-System. </p><br><hr><br><p>  Wir wollten unsere Teams erweitern und gleichzeitig die Prinzipien bewahren, mit denen wir erfolgreich waren: Autonomie, minimale Koordination und Self-Service-Infrastruktur. </p><br><p>  Mit Kubernetes haben wir dies mit anwendungsorientierten Abstraktionen und der Fähigkeit erreicht, Cluster mit minimaler Teamkoordination zu verwalten und zu konfigurieren. </p><br><h3 id="abstrakcii-s-fokusom-na-prilozheniya">  Anwendungsorientierte Abstraktionen </h3><br><p>  Kubernetes-Konzepte lassen sich leicht mit der Sprache des Anwendungsentwicklers abgleichen.  Angenommen, Sie verwalten Anwendungsversionen als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bereitstellung</a> .  Sie können mehrere Replikate hinter dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dienst</a> ausführen und sie über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ingress</a> HTTP <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zuordnen</a> .  Über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Benutzerressourcen können</a> Sie diese Sprache je nach Bedarf erweitern und spezialisieren. </p><br><p>  Teams arbeiten effizienter mit diesen Abstraktionen.  Grundsätzlich enthält dieses Beispiel alles, was Sie zum Bereitstellen und Ausführen einer Webanwendung benötigen.  Der Rest ist Kubernetes. </p><br><p>  Im Bild mit dem Eisberg befinden sich diese Konzepte auf Wasserspiegel und kombinieren die Aufgaben des Entwicklers von oben mit der Plattform unten.  Das Cluster-Management-Team kann einfache und unbedeutende Entscheidungen treffen (über die Verwaltung von Metriken, die Protokollierung usw.) und gleichzeitig mit den Entwicklern über Wasser dieselbe Sprache sprechen. </p><br><p>  Im Jahr 2010 hatte uSwitch traditionelle Teams für die Wartung eines monolithischen Systems, und zuletzt hatten wir eine IT-Abteilung, die unser AWS-Konto teilweise verwaltete.  Es scheint mir, dass das Fehlen gemeinsamer Konzepte die Arbeit dieses Teams ernsthaft behinderte. </p><br><p>  Versuchen Sie, etwas Nützliches zu sagen, wenn Ihr Vokabular, Ihre Load Balancer und Ihre Subnetze nur EC2-Instanzen enthalten.  Es war schwierig oder sogar unmöglich, das Wesentliche der Anwendung zu beschreiben.  Es könnte sich um ein Debian-Paket, die Bereitstellung über Capistrano usw. handeln.  Wir konnten die Anwendung nicht in einer allen gemeinsamen Sprache beschreiben. </p><br><p>  Anfang der 2000er Jahre arbeitete ich bei ThoughtWorks in London.  Beim Interview wurde mir geraten, Eric Evans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">'Problemorientiertes Entwerfen</a> zu lesen.  Auf dem Heimweg kaufte ich ein Buch und begann im Zug zu lesen.  Seitdem erinnere ich mich in fast jedem Projekt und System an sie. </p><br><p>  Eines der Hauptkonzepte des Buches ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einzige Sprache,</a> in der verschiedene Teams kommunizieren.  Kubernetes bietet Entwicklern und Infrastrukturwartungsteams eine einheitliche Sprache, und dies ist einer der Hauptvorteile.  Darüber hinaus kann es um weitere Themenbereiche und Geschäftsbereiche erweitert und ergänzt werden. </p><br><p>  Die Kommunikation in einer gemeinsamen Sprache ist produktiver, aber wir müssen die Interaktion zwischen den Teams so weit wie möglich einschränken. </p><br><h3 id="neobhodimyy-minimum-vzaimodeystviya">  Notwendiges Minimum an Interaktion </h3><br><p>  Die Autoren von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Accelerate</a> heben die Merkmale einer lose gekoppelten Architektur hervor, mit der IT-Teams effizienter arbeiten: </p><br><blockquote>  Im Jahr 2017 hing der Erfolg der kontinuierlichen Lieferung davon ab, ob das Team: <br>  Ändern Sie die Struktur Ihres Systems ernsthaft ohne die Erlaubnis der Verwaltung. <br>  Ändern Sie ernsthaft die Struktur Ihres Systems, ohne darauf zu warten, dass andere Teams ihre ändern, und ohne unnötige Arbeit für andere Teams zu verursachen. <br>  Führen Sie ihre Aufgaben aus, ohne ihre Arbeit mit anderen Teams zu kommunizieren oder zu koordinieren. <br>  Bereitstellen und Freigeben eines Produkts oder einer Dienstleistung bei Bedarf, unabhängig von anderen damit verbundenen Diensten. <br>  Führen Sie die meisten Tests bei Bedarf ohne integrierte Testumgebung durch. </blockquote><p>  Wir brauchten zentralisierte Software-Multi-Tenant-Cluster für alle Teams, wollten aber gleichzeitig diese Eigenschaften beibehalten.  Wir haben das Ideal noch nicht erreicht, aber wir versuchen so gut wir können: </p><br><ul><li>  Wir haben mehrere Arbeitscluster, und die Teams selbst entscheiden, wo die Anwendung ausgeführt werden soll.  Wir verwenden noch keinen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verbund</a> (wir warten auf AWS-Unterstützung), aber wir haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Envoy</a> für den Lastausgleich auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ingress-</a> Balancern in verschiedenen Clustern.  Wir automatisieren die meisten dieser Aufgaben mithilfe der Pipeline für die kontinuierliche Bereitstellung (wir haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Drone</a> ) und anderer AWS-Services. </li><li>  Alle Cluster haben den gleichen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Namespace</a> .  Etwa eine für jedes Team. </li><li>  Wir steuern den Zugriff auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Namespaces</a> über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RBAC</a> (rollenbasierte Zugriffskontrolle).  Zur Authentifizierung und Autorisierung verwenden wir die Corporate Identity in Active Directory. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cluster werden automatisch skaliert</a> und wir bemühen uns, die Startzeit des Knotens zu optimieren.  Es dauert immer noch ein paar Minuten, aber im Allgemeinen verzichten wir auch bei großen Arbeitslasten auf Koordination. </li><li>  Anwendungen werden automatisch basierend auf Metriken auf Anwendungsebene von Prometheus skaliert.  Entwicklungsteams steuern die automatische Skalierung ihrer Anwendung anhand von Abfragemetriken pro Sekunde, Vorgängen pro Sekunde usw. Dank der automatischen Skalierung des Clusters bereitet das System Knoten vor, wenn die Nachfrage die Funktionen des aktuellen Clusters überschreitet. </li><li>  Wir haben Go mit einem Befehlszeilentool namens <strong>u geschrieben</strong> , das die Befehlsauthentifizierung in Kubernetes standardisiert, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vault verwendet</a> , Anforderungen für temporäre AWS-Anmeldeinformationen anfordert und so weiter. </li></ul><br><p><img src="https://habrastorage.org/webt/oy/qv/bm/oyqvbm7x1orfe2kpjxubpis6r60.png"></p><br><p>  Ich bin mir nicht sicher, ob wir mit Kubernetes mehr Autonomie haben, aber es blieb definitiv auf einem hohen Niveau, und gleichzeitig haben wir einige Probleme beseitigt. </p><br><hr><br><p>  Der Wechsel zu Kubernetes war schnell.  Das Diagramm zeigt die Gesamtzahl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Namespaces</a> (ungefähr gleich der Anzahl der Befehle) in unseren Arbeitsclustern.  Der erste erschien im Februar 2017. </p><br><p><img src="https://habrastorage.org/webt/ux/y_/q_/uxy_q_hravmwkjhead1bgzkspz4.png"></p><br><p>  Wir hatten Gründe, uns zu beeilen - wir wollten die kleinen Teams, die sich auf ihr Produkt konzentrieren, vor Sorgen um die Infrastruktur bewahren. </p><br><p>  Das erste Team erklärte sich bereit, zu Kubernetes zu wechseln, wenn der Anwendungsserver aufgrund falscher Logrotate-Einstellungen keinen Speicherplatz mehr hatte.  Der Übergang dauerte nur wenige Tage, und sie machten sich wieder an die Arbeit. </p><br><p>  Vor kurzem haben Teams auf Kubetnetes umgestellt, um die Tools zu verbessern.  Kubernetes-Cluster vereinfachen die Integration mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hashicorp Vault</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Google Cloud Trace</a> und ähnlichen Tools.  <em>Alle</em> unsere Teams erhalten noch effektivere Funktionen. </p><br><hr><br><p>  Ich habe bereits ein Diagramm mit Perzentilen der Anzahl der Dienste gezeigt, die unsere Mitarbeiter von Ende 2014 bis 2017 jede Woche in Anspruch genommen haben.  Und hier ist eine Fortsetzung dieses Diagramms bis heute. </p><br><p><img src="https://habrastorage.org/webt/o7/fa/mu/o7famum8vaa0uuuw5e2ynah0-ay.png"></p><br><p>  Wir haben Fortschritte bei der Verwaltung des komplexen AWS-Frameworks erzielt.  Ich bin froh, dass jetzt die Hälfte der Mitarbeiter das Gleiche tut wie Anfang 2015.  Wir haben 4-6 Mitarbeiter im Cloud-Computing-Team, etwa 10% der Gesamtzahl - es ist nicht verwunderlich, dass sich das 90. Perzentil fast nicht bewegt hat.  Aber ich hoffe auch hier auf Fortschritte. </p><br><p>  Abschließend werde ich darüber sprechen, wie sich unser Entwicklungszyklus verändert hat, und noch einmal an das kürzlich gelesene Accelerate-Buch erinnern. </p><br><p>  Das Buch erwähnt zwei Lean-Entwicklungsmetriken: Vorlaufzeit und Paketgröße.  Die Vorlaufzeit wird von der Anfrage bis zur Lieferung der fertigen Lösung berücksichtigt.  Die Paketgröße ist der Arbeitsaufwand.  Je kleiner die Packungsgröße, desto effizienter die Arbeit: </p><br><blockquote>  Je kleiner das Paket, desto kürzer der Produktionszyklus, weniger Prozessvariabilität, weniger Risiken, Kosten und Kosten, wir erhalten schneller Feedback, arbeiten effizienter, wir haben mehr Motivation, wir versuchen schneller fertig zu werden und verschieben die Lieferung seltener. </blockquote><p>  Das Buch schlägt vor, die Größe von Paketen anhand der Bereitstellungshäufigkeit zu messen. Je häufiger die Bereitstellung erfolgt, desto kleiner sind die Pakete. </p><br><p>  Wir haben Daten für <em>einige</em> Bereitstellungen.  Die Daten sind nicht ganz korrekt - einige Teams senden Releases direkt an den Hauptzweig des Repositorys, andere verwenden andere Mechanismen.  Dies schließt nicht alle Anträge ein, aber Daten für 12 Monate können als Richtwerte angesehen werden. </p><br><p><img src="https://habrastorage.org/webt/dt/vt/53/dtvt53s-2o7-w9rs-7qx6dhnydc.png"></p><br><p>  Das Scheitern in der dreißigsten Woche ist Weihnachten.  Im Übrigen nimmt die Bereitstellungshäufigkeit zu, was bedeutet, dass die Paketgröße abnimmt.  Von März bis Mai 2018 hat sich die Häufigkeit der Veröffentlichungen fast verdoppelt, und in letzter Zeit stellen wir manchmal mehr als hundert Ausgaben pro Tag her. </p><br><p>  Der Wechsel zu Kubernetes ist nur ein Teil unserer Strategie zur Standardisierung, Automatisierung und Verbesserung von Tools.  Höchstwahrscheinlich haben all diese Faktoren die Häufigkeit der Freisetzungen beeinflusst. </p><br><p>  Accelerate spricht auch über die Beziehung zwischen der Bereitstellungshäufigkeit und der Anzahl der Mitarbeiter und darüber, wie schnell ein Unternehmen arbeiten kann, wenn mehr Mitarbeiter eingestellt werden.  Die Autoren betonen die Grenzen verwandter Architekturen und Teams: </p><br><blockquote>  Es wird traditionell angenommen, dass die Erweiterung eines Teams die Gesamtproduktivität erhöht, aber die Produktivität einzelner Entwickler verringert. </blockquote><p>  Wenn wir dieselben Daten zur Häufigkeit von Bereitstellungen verwenden und ein Diagramm der Abhängigkeit von der Anzahl der Benutzer erstellen, können wir sehen, dass wir die Häufigkeit von Releases erhöhen können, selbst wenn wir mehr Mitarbeiter haben. </p><br><p><img src="https://habrastorage.org/webt/xc/ti/xf/xctixfjqbqgkbdooamerhtg3d_e.png"></p><br><p>  Am Anfang des Artikels erwähnte ich das Buch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Factfulness</a> (das unseren CTO inspirierte).  Der Übergang zu Kubernetes ist für unsere Entwickler zur bedeutendsten und schnellsten Konvergenz der Technologie geworden.  Wir bewegen uns in kleinen Schritten, und es ist leicht zu bemerken, wie sehr sich alles zum Besseren verändert hat.  Es ist gut, dass wir Daten haben, und sie zeigen, dass wir erreicht haben, was wir wollen - unsere Mitarbeiter sind an ihrem Produkt beteiligt und treffen wichtige Entscheidungen auf ihrem Gebiet. </p><br><p>  Früher war es gut für uns.  Wir hatten Microservices, AWS, gut etablierte Teams für Produkte, Entwickler, die für ihre Dienstleistungen in der Produktion verantwortlich waren, lose gekoppelte Teams und Architektur.  Ich habe 2012 in dem Bericht <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Unser Zeitalter der Aufklärung“</a> („Unser Zeitalter der Aufklärung“) auf einer Konferenz darüber gesprochen.  Der Perfektion sind jedoch keine Grenzen gesetzt. </p><br><p>  Am Ende möchte ich ein anderes Buch zitieren - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Scale</a> .  Ich habe kürzlich damit begonnen und es gibt ein interessantes Fragment zum Energieverbrauch in komplexen Systemen: </p><br><blockquote>  Um Ordnung und Struktur in einem sich entwickelnden System aufrechtzuerhalten, ist ein ständiger Energiezufluss erforderlich, der zu Störungen führt.  Um das Leben zu erhalten, müssen wir daher die ganze Zeit essen, um die unvermeidliche Entropie zu besiegen. <br>  Wir bekämpfen die Entropie, indem wir mehr Energie für Wachstum, Innovation, Wartung und Reparatur bereitstellen, was mit zunehmendem Alter des Systems schwieriger wird. Dieser Kampf ist die Grundlage für ernsthafte Diskussionen über Alterung, Sterblichkeit, Nachhaltigkeit und Selbstversorgung eines Systems, sei es eines lebenden Organismus , Unternehmen oder Gesellschaft. </blockquote><p>  Ich denke, Sie können hier IT-Systeme hinzufügen.  Ich hoffe, dass unsere letzten Bemühungen die Entropie auch für eine Weile aufrechterhalten werden. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427441/">https://habr.com/ru/post/de427441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427431/index.html">Wie Android funktioniert, Teil 4</a></li>
<li><a href="../de427433/index.html">Verkehrsausgleich in den IP-Netzen des Betreibers</a></li>
<li><a href="../de427435/index.html">STM32H7 - Uhreinstellung ohne HAL</a></li>
<li><a href="../de427437/index.html">Verbindungsserver konfigurieren: MS SQL Server und Teradata</a></li>
<li><a href="../de427439/index.html">Die ganze Wahrheit über RTOS. Artikel 16. Signale</a></li>
<li><a href="../de427443/index.html">Vivisektion des Erfolgs</a></li>
<li><a href="../de427447/index.html">PVS-Studio unterstützt die GNU Arm Embedded Toolchain</a></li>
<li><a href="../de427449/index.html">Wie man Tensorflow versteht und nicht stirbt und sogar etwas über ein Auto lehrt</a></li>
<li><a href="../de427451/index.html">Verbinden Sie phpStorm-Tasks mit Bitrix24</a></li>
<li><a href="../de427453/index.html">Wie ich die Tonübertragung auf dem Raspberry Pi gemacht habe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>