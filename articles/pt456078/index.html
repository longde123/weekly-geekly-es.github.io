<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úùÔ∏è üéâ üêÄ Proje√ß√£o de conflito corporativo na conectividade de rede üëäüèº üéì üèüÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um conflito corporativo surgiu em 10/06/2019 devido a um aumento no custo de entrega de SMS para usu√°rios da rede Vimpelcom pelo Mail.RU Group. Como r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Proje√ß√£o de conflito corporativo na conectividade de rede</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456078/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cp/8x/ty/cp8xty7ejmoaj8gl7q7uhikmku0.png" alt="imagem"></div><br>  Um conflito corporativo surgiu em 10/06/2019 devido a um aumento no custo de entrega de SMS para usu√°rios da rede Vimpelcom pelo Mail.RU Group.  Como resposta, o Mail.RU Group deixou de "atender" os canais IP russos diretos √† rede Vimpelcom. <br><br>  Abaixo est√° uma breve an√°lise da situa√ß√£o da perspectiva de um engenheiro de rede. <br><br>  <b>Atualiza√ß√£o</b> : 14/06/2019 18:45 - √™nfase nas rotas russas para a rede VimpelCom, conclus√µes ajustadas, acrescentou uma explica√ß√£o de <b>Sergey Kubasov (CIO Vkontakte)</b> . <br>  <b>Atualiza√ß√£o</b> : 14/06/2019 19:48 - √© adicionada uma descri√ß√£o do m√©todo para restringir a distribui√ß√£o de rotas ao longo da rota russa "curta" via Rostelecom, MTS, RETN.NET .. <br>  <b>Atualiza√ß√£o</b> : 15/06/2019 09:39 - Mail.ru bloqueou seu espelho. <br>  <b>Atualiza√ß√£o</b> : 18/06/2019 10:10 - Depyning acabou.  O VimpelCom e o Mail.RU Group levantaram sess√µes diretas de BGP. <br><br><a name="habracut"></a><br>  Introdut√≥rio: <br>  O VimpelCom possui um sistema aut√¥nomo AS3216, o restante (8402 - Internet residencial, 16345 - Internet m√≥vel) est√° localizado em 3216. <br><br>  Grupo Mail.RU - sistemas aut√¥nomos AS47541, AS47542 e AS47764.  O principal gerador de conte√∫do √© 47542, o chamado  CDN VKONTAKTE (filmes, m√∫sica).  Todos os sistemas aut√¥nomos s√£o independentes um do outro (da posi√ß√£o de um sistema aut√¥nomo externo). <br><br>  Primeiro, vamos olhar a situa√ß√£o da rede Vimpelcom.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Looking Glass Vimpelcom</a> nos ajudar√° nisso. <br><br>  N√≥s olhamos para o primeiro sistema aut√¥nomo - AS47541. <br><br><pre><code class="perl hljs"><span class="hljs-number"><span class="hljs-number">2914</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span> <span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span> (metric <span class="hljs-number"><span class="hljs-number">10500</span></span>) (<span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">30</span></span>, localpref <span class="hljs-number"><span class="hljs-number">87</span></span>, valid, internal, best, group-best, import-candidate, import suspect Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2865394342</span></span> Community: <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">410</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">1214</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">2213</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">3200</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3103</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">50078</span></span></code> </pre> <br>  O AS-PATH cont√©m dois sistemas aut√¥nomos - 2914 (NTT) e 47541 (VKONTAKTE-SPB-AS). <br>  A m√©trica localpref √© definida como 87, que, conforme descrito no RIPE DB para o objeto AS3216, corresponde ao emparelhamento internacional. <br><blockquote>  ... <br>  observa√ß√µes: As rotas internacionais de pares obt√™m prefer√™ncia local no <br>  observa√ß√µes: intervalo de 81-89. <br>  ... </blockquote>  A comunidade 3216: 3000 e 3216: 3103 (origem - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RIPE DB for AS3216</a> ) tamb√©m confirma as mesmas informa√ß√µes: <br><blockquote>  ... <br>  observa√ß√µes: 3216: 3000 Recebido de um uplink ou ponto internacional, especificamente: <br>  ... <br>  observa√ß√µes: 3216: 3103 AMS-IX <br>  ... </blockquote>  Ou seja, a Vimpelcom v√™ a rota para VKontakte atrav√©s do cruzamento europeu. <br><br>  Vamos ver outra autonomia do VKontakte - 47542 (VKONTAKTE-MSK-CDN-AS). <br><br><div class="spoiler">  <b class="spoiler_title">Tudo √© parecido.</b> <div class="spoiler_text"><pre> <code class="perl hljs"> <span class="hljs-number"><span class="hljs-number">2914</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span> <span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span> (metric <span class="hljs-number"><span class="hljs-number">10500</span></span>) (<span class="hljs-number"><span class="hljs-number">79.104</span></span>.<span class="hljs-number"><span class="hljs-number">32.251</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">30</span></span>, localpref <span class="hljs-number"><span class="hljs-number">87</span></span>, valid, internal, best, group-best, import-candidate, import suspect Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2865394338</span></span> Community: <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">410</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">1214</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">2213</span></span> <span class="hljs-number"><span class="hljs-number">2914</span></span>:<span class="hljs-number"><span class="hljs-number">3200</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3103</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47541</span></span>:<span class="hljs-number"><span class="hljs-number">50078</span></span></code> </pre> <br></div></div><br>  E o Mail.ru?  Vamos dar uma olhada no AS47764 (mailru-as). <br><br><pre> <code class="perl hljs"> <span class="hljs-number"><span class="hljs-number">3356</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span> <span class="hljs-number"><span class="hljs-number">194.67</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">215</span></span> (metric <span class="hljs-number"><span class="hljs-number">10501</span></span>) (<span class="hljs-number"><span class="hljs-number">194.67</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">215</span></span>) Origin IGP, metric <span class="hljs-number"><span class="hljs-number">0</span></span>, localpref <span class="hljs-number"><span class="hljs-number">77</span></span>, valid, internal, best, group-best, import-candidate Received Path ID <span class="hljs-number"><span class="hljs-number">0</span></span>, Local Path ID <span class="hljs-number"><span class="hljs-number">1</span></span>, version <span class="hljs-number"><span class="hljs-number">2867605667</span></span> Community: <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3000</span></span> <span class="hljs-number"><span class="hljs-number">3216</span></span>:<span class="hljs-number"><span class="hljs-number">3007</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">123</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">519</span></span> <span class="hljs-number"><span class="hljs-number">3356</span></span>:<span class="hljs-number"><span class="hljs-number">2094</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">40000</span></span> <span class="hljs-number"><span class="hljs-number">47764</span></span>:<span class="hljs-number"><span class="hljs-number">50077</span></span></code> </pre> <br>  O VimpelCom v√™ o Mail.ru via as3356 (operador de n√≠vel 3, n√≠vel 1 de uplink).  Esta informa√ß√£o √© confirmada pelo localpref 77: <br><blockquote>  ... <br>  observa√ß√µes: As rotas da Uplink recebem prefer√™ncia local na faixa de 71 a 79. <br>  coment√°rios: √öltima atualiza√ß√£o: fevereiro de 2012 ... </blockquote>  e comunidade (3216: 3000 e 3216: 3007): <br><blockquote>  ... <br>  observa√ß√µes: 3216: 3000 Recebido de um uplink ou ponto internacional, especificamente: <br>  ... <br>  observa√ß√µes: 3216: 3007 comunica√ß√µes de n√≠vel 3 <br>  ... </blockquote><br>  A partir das informa√ß√µes recebidas, pode-se observar que o tr√°fego da rede Vimpelcom no VKontakte e MailRu √© distribu√≠do atrav√©s de conex√µes europ√©ias de acordo com as rotas recebidas pelo protocolo BGP.  N√£o h√° rotas alternativas atrav√©s de conex√µes russas no Looking Glass.  Nenhuma medida foi encontrada para redirecionar artificialmente o tr√°fego por rotas conscientemente piores. <br><br>  E como o grupo Mail.ru v√™ a rede VimpelCom? <br>  Usaremos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Looking Glass do Mail</a> .  <b>Atualiza√ß√£o</b> : na manh√£ de 15/06/2019 Looking Glass n√£o funciona, quando solicitado o 500¬∫ erro √© emitido: <img src="https://habrastorage.org/getpro/habr/post_images/515/c79/93c/515c7993ccd0f3d6bd9a5a20d3078ee9.png" alt="imagem"><br><br>  Dos roteadores do AS47764 (mailru-as): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#6: Received by speaker 0 Advertised to peers (in unique update groups): 188.93.60.188 1299 1299 1273 3216 3216 217.20.147.250 (metric 100) from 217.20.147.250 (217.20.147.253) Origin IGP, metric 500, localpref 200, valid, internal, best, group-best Received Path ID 0, Local Path ID 0, version 1172721494 Community: 1299:20000 47764:701 47764:41100 47764:41108 47764:50077</span></span></code> </pre> <br><br>  O AS-PATH cont√©m AS1299 (Telia, operador Tier1, uplink Mail.RU) e as1273 (Vodafon, operador Tier1, uplink Vimpelcom). <br><br>  O LocalPreference 200 √© o padr√£o para interfaces externas Mail.ru (https://net.mail.ru/bgp.html), e o MED 500 corresponde a tudo o que √© recebido n√£o de uma interface direta, n√£o de IX-s, e n√£o de ponto a ponto. <br><br>  Mas por que n√£o existem rotas locais atrav√©s das operadoras de telecomunica√ß√µes russas ??? <br>  Eles s√£o, mas sua prioridade √© "n√£o-padr√£o"! <br>  Aqui est√° o percurso atrav√©s da Rostelecom (as12389): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#1: Received by speaker 0 Not advertised to any peer 12389 3216 46.61.178.149 from 46.61.178.149 (213.59.207.79) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 12389:5 12389:6 12389:1100 12389:1105 12389:1277 47764:701 47764:41100 47764:41104 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  Aqui est√° atrav√©s do megafone (as31133): <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#2: Received by speaker 0 Not advertised to any peer 31133 3216 78.25.77.41 from 78.25.77.41 (10.222.253.97) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 31133:300 31133:46170 47764:701 47764:41100 47764:41105 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  Aqui √© atrav√©s do RET.NO: <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#3: Received by speaker 0 Not advertised to any peer 9002 9002 3216 87.245.253.24 from 87.245.253.24 (87.245.225.1) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 9002:9002 9002:64667 47764:701 47764:41100 47764:41101 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  E mesmo atrav√©s do MTS! <pre> <code class="perl hljs"> Path <span class="hljs-comment"><span class="hljs-comment">#5: Received by speaker 0 Not advertised to any peer 8359 3216 212.188.61.105 from 212.188.61.105 (195.34.52.77) Origin IGP, metric 500, localpref 199, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 8359:200 8359:609 8359:5012 47764:701 47764:41100 47764:41103 47764:50077 Origin-AS validity: not-found</span></span></code> </pre> <br>  A m√©trica localpref para essas rotas russas √© subestimada, ou seja, as rotas s√£o degradadas em compara√ß√£o com as estrangeiras! <br><br>  Al√©m disso, o <b>Mail.Ru Group pro√≠be a</b> distribui√ß√£o de seus prefixos √† Vimpelcom atrav√©s de operadoras russas! <br><br>  RET.NO (http://lg.retn.net/): <br>  Os an√∫ncios do Mail.RU Group incluem a comunidade 3216: 65535. <br><div class="spoiler">  <b class="spoiler_title">Conclus√£o da LG RET.NO</b> <div class="spoiler_text">  inet.0: 762737 destinos, 1734826 rotas (762708 ativo, 222780 holddown, 277 oculto) <br>  94.100.176.0/20 (1 entrada, 1 anunciado) <br>  * Prefer√™ncia BGP: 170 / -201 <br>  ... <br>  ... <br>  Caminho AS: 47764 I <br>  Caminho AS: gravado <br>  Comunidades: 3216: 65535 9002: 64667 9002: 65530 <br>  ... <br></div></div><br>  O Vimpelcom n√£o aceita rotas marcadas por essa comunidade em sua rede.  Trecho do RIPE DB por AS3216: <br><blockquote>  ... <br>  Coment√°rios: Comminuties internos s√£o atribu√≠dos apenas internamente. <br>  coment√°rios: Eles est√£o no intervalo 3216: 0000-3216: 4999 e 3216: 6000-3216: 65535 <br>  coment√°rios: e sempre s√£o exclu√≠dos das atualiza√ß√µes recebidas na fronteira <br>  observa√ß√µes: roteadores. <br>  ... </blockquote><br>  Em dire√ß√£o ao Rostelecom (http://lg.ip.rt.ru) O Mail.RU Group oferece rotas semelhantes √† comunidade 12389: 8350. <br><div class="spoiler">  <b class="spoiler_title">Conclus√£o da LG Rostelecom</b> <div class="spoiler_text">  94.100.176.0/20 via 217.107.65.1 em eth0.9 [sr2 2019-06-13] * (100 /?) [AS47764i] <br>  Tipo: unifica√ß√£o unicast BGP <br>  BGP.origin: IGP <br>  BGP.as_path: 47764 <br>  BGP.next_hop: 213.59.207.78 <br>  BGP.med: 0 <br>  BGP.local_pref: 850 <br>  Comunidade: (12389.1) (12389.1100) (12389.1105) (12389.1277) (12389.8350) (12389.8380) (47764.1) (47764.40000) (47764.50077) <br>  BGP.originator_id: 213.59.207.78 <br>  BGP.cluster_list: 95.167.88.79 95.167.88.49 95.167.88.17 <br></div></div><br>  De acordo com as entradas no RIPE DB para o objeto as12389, essa comunidade significa "n√£o anunciar na rede as3216": <blockquote>  ... <br>  observa√ß√µes: |  12389: 835y Ao anunciar na GoldenTelecom (AS3216) | <br>  ... <br>  observa√ß√µes: |  ... y = 0 - n√£o anuncie | <br>  ... </blockquote><br>  Da mesma forma, em rela√ß√£o ao MTS (http://lg.mtu.ru): <div class="spoiler">  <b class="spoiler_title">Conclus√£o da LG MTS</b> <div class="spoiler_text">  Entrada da tabela de roteamento BGP para 94.100.176.0/20, vers√£o 161717219 <br>  Caminhos: (2 dispon√≠veis, melhor # 1, padr√£o da tabela) <br>  Multipath: eBGP <br>  Anunciado para atualizar grupos: <br>  6 <br>  47764, (recebido e usado) <br>  195.34.52.77 (m√©trica 16) de 195.34.52.181 (195.34.52.181) <br>  IGP de origem, m√©trica 0, localpref 140, v√°lido, interno, melhor <br>  Comunidade: 8359: 2120 8359: 2150 8359: 5500 8359: 55277 <br>  Originador: 195.34.52.77, Lista de clusters: 83.59.83.59 <br>  47764, (recebido e usado) <br>  195.34.52.77 (m√©trica 16) de 195.34.52.182 (195.34.52.182) <br>  IGP de origem, m√©trica 0, localpref 140, v√°lido, interno <br>  Comunidade: 8359: 2120 8359: 2150 8359: 5500 8359: 55277 <br>  Originador: 195.34.52.77, Lista de clusters: 83.59.2.77 <br></div></div><br>  Comunidade 8359: 2120 significa: <blockquote>  ... <br>  observa√ß√µes: 8359: 212x ao anunciar a Sovam (Beeline) <br>  ... <br>  observa√ß√µes: x = 0 - n√£o anunciar <br>  ... </blockquote><br>  Voc√™ n√£o pode olhar para os an√∫ncios do Mail.RU Group em dire√ß√£o √† Megafon - este √∫ltimo n√£o possui Espelho. <br><br>  Vamos ver o AS47541 (VKONTAKTE-SPB-AS). <br><br><div class="spoiler">  <b class="spoiler_title">A conclus√£o √© grande demais.</b> <div class="spoiler_text"><pre> <code class="perl hljs"> Router: a9922-e-<span class="hljs-number"><span class="hljs-number">5</span></span> Command: show ip bgp <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> Last switch-over Thu Apr <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>:09 <span class="hljs-number"><span class="hljs-number">2018</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> year, <span class="hljs-number"><span class="hljs-number">10</span></span> weeks, <span class="hljs-number"><span class="hljs-number">6</span></span> hours, <span class="hljs-number"><span class="hljs-number">9</span></span> minutes ago Fri Jun <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>:<span class="hljs-number"><span class="hljs-number">34</span></span>:<span class="hljs-number"><span class="hljs-number">20.791</span></span> MSK BGP routing table entry <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">17</span></span> Versions: Process bRIB/RIB SendTblVer Speaker <span class="hljs-number"><span class="hljs-number">913059757</span></span> <span class="hljs-number"><span class="hljs-number">913059757</span></span> Last Modified: May <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">05</span></span>:<span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">38.536</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>y03w Paths: (<span class="hljs-number"><span class="hljs-number">6</span></span> available, best <span class="hljs-comment"><span class="hljs-comment">#4) Advertised to update-groups (with more than one peer): 0.2 Advertised to peers (in unique update groups): 188.93.60.188 Path #1: Received by speaker 0 Not advertised to any peer 1299 1273 3216 3216 87.240.191.235 (metric 31) from 87.240.191.235 (87.240.191.235) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 1299:431 1299:4000 1299:20000 1299:20002 1299:20200 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41111 47541:50078 Path #2: Received by speaker 0 Not advertised to any peer 1299 1273 3216 3216 87.240.191.248 (metric 31) from 87.240.191.248 (87.240.191.248) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 1299:431 1299:4000 1299:20000 1299:20002 1299:20200 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41111 47541:50078 Path #3: Received by speaker 0 Not advertised to any peer 174 6762 3216 3216 87.240.191.249 (metric 31) from 87.240.191.249 (87.240.191.249) Origin IGP, metric 5000, localpref 150, valid, internal Received Path ID 0, Local Path ID 0, version 0 Community: 174:21100 174:22005 47541:701 47541:41100 47541:41108 47541:50078 Path #4: Received by speaker 0 Advertised to update-groups (with more than one peer): 0.2 Advertised to peers (in unique update groups): 188.93.60.188 174 6762 3216 3216 149.6.169.113 from 149.6.169.113 (38.28.1.236) Origin IGP, metric 5000, localpref 150, valid, external, best, group-best Received Path ID 0, Local Path ID 0, version 913059757 Community: 174:21100 174:22005 47541:701 47541:41100 47541:41108 47541:50078 Origin-AS validity: not-found Path #5: Received by speaker 0 Not advertised to any peer 1273 1273 3216 3216 195.89.114.197 from 195.89.114.197 (195.2.1.107) Origin IGP, metric 5005, localpref 150, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 1273:12752 3216:2001 3216:2999 3216:4100 47541:701 47541:41100 47541:41110 47541:50078 Origin-AS validity: not-found Path #6: Received by speaker 0 Not advertised to any peer 3356 3356 3216 3216 3216 213.242.69.69 from 213.242.69.69 (4.69.177.130) Origin IGP, metric 5000, localpref 150, valid, external Received Path ID 0, Local Path ID 0, version 0 Community: 3216:2001 3216:2999 3216:4100 3356:2 3356:22 3356:100 3356:123 3356:503 3356:2067 47541:701 47541:41100 47541:41107 47541:50078 Origin-AS validity: not-found</span></span></code> </pre> </div></div><br>  AS-PATH aponta para AS174 - Cogent (uplink Mail.RU, Tier1) e, em seguida, AS6762 - Telecom Italia (uplink Vimpelcom).  Prefer√™ncia local em todos os lugares 150, mas em todas as articula√ß√µes externas, independentemente das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pol√≠ticas escritas</a> . <br><br>  Vamos ver o AS47542 (VKONTAKTE-MSK-CDN-AS). <br><pre> <code class="perl hljs"> Router: mx96<span class="hljs-number"><span class="hljs-number">0</span></span>-m9-<span class="hljs-number"><span class="hljs-number">0</span></span> Command: op lg-sh-bgp prefix <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">87.240</span></span>.<span class="hljs-number"><span class="hljs-number">191.222</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Best <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">95.142</span></span>.<span class="hljs-number"><span class="hljs-number">204.251</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Inactive-reason: Interior &gt; Exterior &gt; Exterior via Interior</code> </pre> <br>  E a partir do segundo roteador: <pre> <code class="perl hljs"> Router: mx96<span class="hljs-number"><span class="hljs-number">0</span></span>-m9-<span class="hljs-number"><span class="hljs-number">1</span></span> Command: op lg-sh-bgp prefix <span class="hljs-number"><span class="hljs-number">81.211</span></span>.<span class="hljs-number"><span class="hljs-number">56.202</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">87.240</span></span>.<span class="hljs-number"><span class="hljs-number">191.224</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Best <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> LP:<span class="hljs-number"><span class="hljs-number">151</span></span> MED: NH:<span class="hljs-number"><span class="hljs-number">95.142</span></span>.<span class="hljs-number"><span class="hljs-number">204.250</span></span> AS path: <span class="hljs-number"><span class="hljs-number">47541</span></span> I Communities: Accepted Inactive-reason: Interior &gt; Exterior &gt; Exterior via Interior</code> </pre> <br>  Somente rotas padr√£o (0.0.0.0/0).  Esta situa√ß√£o foi explicada por um funcion√°rio da avidez do Grupo Mail.RU, pelo qual ele agradece.  Em resumo: o segmento de Moscou da rede VKontakte est√° armazenando em cache (em vez de gerar), cuja tarefa √© otimizar a velocidade de download de conte√∫do popular e exigido.  Cuidando de usu√°rios, sim. <br><br>  Se n√£o houver rota para nenhuma rede, essa rede n√£o ser√° atendida pelos servidores de cache.  Portanto, a otimiza√ß√£o da velocidade do download n√£o funciona e os usu√°rios sofrem.  Mas aqui √© necess√°rio enfatizar - os usu√°rios n√£o s√£o apenas seus, mas tamb√©m o VimpelCom. <br><br>  <b>Conclus√µes:</b> <br><br><ol><li>  Do Vimpelcom, o tr√°fego para o Mail.RU Group √© distribu√≠do naturalmente.  Nenhum redirecionamento artificial por meio de manipula√ß√µes de prefer√™ncia local detectadas </li><li>  <b>No grupo Mail.RU, h√° manipula√ß√µes com prefixos Vimpelcom</b> .  Nas rotas existentes para a rede Vimpelcom atrav√©s de operadores russos, as prioridades s√£o subestimadas em compara√ß√£o com rotas atrav√©s de operadores estrangeiros de N√≠vel 1. </li><li>  Os gerentes da comunidade BGP foram adicionados √†s rotas transferidas para os operadores russos (MTS, Rostelecom, RETN.NET) do Mail.RU Group para restringir sua distribui√ß√£o √† Vimpelcom </li></ol><br>  Por que o Mail.RU Group prioriza rotas pela Europa?  Por que o Mail.RU Group pro√≠be uma conex√£o dom√©stica curta com o Vimpelcom? <br><br>  √â mais barato para eles?  Direcionar tr√°fego atrav√©s de canais estrangeiros e pagar moeda para tirvans? <br>  Ou existe um desejo de desviar o tr√°fego para que n√£o seja t√£o conveniente lev√°-lo, n√£o √©? <br>  Isso √© desconhecido para o engenheiro de rede ... <br><br>  <b>Resultados de depyring:</b> <br>  17/06/2019 Sess√µes de BGP entre Vimpelcom e Mail.RU Group foram levantadas: <br>  AS47764 (Mail.RU): <br><img src="https://habrastorage.org/webt/8s/pl/gk/8splgktg26dnwc_4ihehoprx8-k.png" alt="imagem"><br><br>  AS47541 (Vk): <br><img src="https://habrastorage.org/getpro/habr/post_images/867/0b4/829/8670b482948ddb6df8d498e43d9dbd73.png" alt="imagem"><br><br>  AS47542 (Vk CDN): <br><img src="https://habrastorage.org/webt/vm/fc/8z/vmfc8zpjdbimpe1eox2qi7ojndi.png" alt="imagem"><br><br>  Quem iniciou o levantamento das sess√µes √© desconhecido. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt456078/">https://habr.com/ru/post/pt456078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt456064/index.html">Outubro Abordagens revolucion√°rias de seguran√ßa</a></li>
<li><a href="../pt456068/index.html">5 erros chumbo iniciante</a></li>
<li><a href="../pt456070/index.html">Como atrair usu√°rios para o portal de autoatendimento</a></li>
<li><a href="../pt456072/index.html">Dav1d - o decodificador AV1 mais r√°pido agora no Firefox por padr√£o</a></li>
<li><a href="../pt456076/index.html">Meetup sobre PyDaCon no grupo Mail.ru: 22 de junho</a></li>
<li><a href="../pt456082/index.html">Como desenvolvemos recomenda√ß√µes personalizadas de produtos</a></li>
<li><a href="../pt456084/index.html">Kubernetes 1.15: Vis√£o geral dos destaques</a></li>
<li><a href="../pt456086/index.html">Storyboards para iOS: an√°lise dos pr√≥s e contras, melhores pr√°ticas</a></li>
<li><a href="../pt456088/index.html">Problemas de an√°lise de big data</a></li>
<li><a href="../pt456090/index.html">Introdu√ß√£o ao teste de unidade no Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>