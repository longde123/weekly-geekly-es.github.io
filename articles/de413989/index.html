<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛕 🚵🏼 🤾🏿 Das Buch „Hacking: The Art of Exploit. 2nd ed. ” 🤙 🤘🏽 ☝🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jeder Programmierer ist im Wesentlichen ein Hacker. Schließlich wurde Hacking zunächst als Suche nach einer geschickten und nicht offensichtlichen Lös...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das Buch „Hacking: The Art of Exploit. 2nd ed. ”</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/413989/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/v1/y_/wo/v1y_wo0l3qbzeakw1hmembve6lk.jpeg" align="left" alt="Bild"></a>  Jeder Programmierer ist im Wesentlichen ein Hacker.  Schließlich wurde Hacking zunächst als Suche nach einer geschickten und nicht offensichtlichen Lösung bezeichnet.  Das Verständnis der Programmierung hilft Ihnen beim Auffinden von Schwachstellen, und das Erkennen von Schwachstellen hilft Ihnen beim Erstellen von Programmen, sodass viele Hacker beides gleichzeitig tun.  Es gibt interessante nicht standardmäßige Bewegungen sowohl bei Techniken zum Schreiben eleganter Programme als auch bei Techniken zum Auffinden von Schwachstellen. <br><br>  Wo soll ich anfangen?  Um Speicher mithilfe von Pufferüberläufen zu überschreiben, auf einen Remote-Server zuzugreifen und Verbindungen abzufangen, müssen Sie in C und Assembler programmieren, Shell-Code- und Prozessorregister verwenden, sich mit Netzwerkinteraktionen und -verschlüsselung vertraut machen und vieles mehr. <br><br>  Egal wie sehr wir an Wunder glauben wollen, die Software und Computernetzwerke, von denen unser tägliches Leben abhängt, weisen Schwachstellen auf. <br><br>  Eine Welt ohne Hacker ist eine Welt ohne Neugier und innovative Lösungen.  (John Erickson) <br><a name="habracut"></a><br><h3>  <b>Gegenmaßnahmen</b> </h3><br>  Es gibt so einen Frosch - einen schrecklichen Listolaz (Phyllobates terribilis).  Ihre Hautdrüsen enthalten das stärkste Gift.  Berühren Sie es einfach, um eine tödliche Vergiftung zu bekommen.  Ein solch wirksames Mittel erklärt sich aus der Tatsache, dass diese Frösche sich von bestimmten Arten von Schlangen ernähren, die eine Immunität gegen Gift entwickelt haben.  Allmählich wurde das Gift der Frösche immer stärker.  Infolge einer solchen gemeinsamen Entwicklung haben die schrecklichen Blattkletterer keine anderen natürlichen Feinde mehr.  Ähnliches passiert mit Hackern.  Die Techniken, die sie erfunden haben, sind seit langem bekannt, so dass die Entstehung von Gegenmaßnahmen ganz natürlich ist.  Als Reaktion darauf suchen Hacker nach Wegen, um Abwehrmechanismen zu umgehen und zu zerstören, was zur Schaffung neuer Verteidigungstechniken führt. <br><br>  Dieser Zyklus der Suche nach Maßnahmen und Gegenmaßnahmen ist sehr nützlich.  Viren und Würmer verursachen zahlreiche Probleme und bringen große Verluste für das Geschäft mit sich. Gleichzeitig zwingen sie Entwickler, Vergeltungsmaßnahmen zu ergreifen, um die aufgetretenen Probleme zu lösen.  Würmer replizieren sich selbst mit Software-Schwachstellen von geringer Qualität.  Fehler bleiben im Laufe der Jahre oft unbemerkt, und relativ harmlose Würmer wie CodeRed oder Sasser zwingen Entwickler, sie zu beheben.  Dieser Prozess kann mit Windpocken verglichen werden, die besser für die Krankheit in der Kindheit und nicht im Erwachsenenalter geeignet sind, wenn sie katastrophale Folgen haben können.  Wenn Internet-Würmer nicht die allgemeine Aufmerksamkeit auf Sicherheitslücken gelenkt hätten, würden diese Lücken für Angriffe mit weitaus böswilligeren Zwecken als der einfachen Selbstreproduktion offen bleiben.  Auf diese Weise tragen Würmer und Viren zur langfristigen Sicherheit bei.  Es gibt jedoch aktivere Methoden: Techniken, die versuchen, die Ergebnisse eines Angriffs aufzuheben oder völlig unmöglich zu machen.  Das Konzept der „Gegenmaßnahmen“ ist eher vage. Diese Wörter können technische Sicherheitsmittel, ein Regelwerk, ein Programm oder nur einen aufmerksamen Systemadministrator bedeuten.  Gegenmaßnahmen werden bedingt in zwei Gruppen unterteilt: Versuch, einen Angriff zu erkennen und die Sicherheitsanfälligkeit zu schützen. <br><br><h3>  0x610 Angriffserkennungs-Tool </h3><br>  Gegenmaßnahmen der ersten Gruppe laufen darauf hinaus, das Eindringen rechtzeitig zu bemerken und irgendwie darauf zu reagieren.  Der Erkennungsprozess kann auf beliebige Weise implementiert werden - vom Administrator, der die Systemprotokolle liest, bis zu Programmen, die den Netzwerkverkehr analysieren.  Manchmal besteht die Reaktion auf eine Invasion darin, die Verbindung automatisch zu trennen oder den Prozess zu schließen, und manchmal muss der Administrator den gesamten Inhalt der Konsole sorgfältig untersuchen. <br><br>  Bekannte Methoden zum Ausnutzen von Sicherheitslücken sind für den Systemadministrator nicht so gefährlich wie diejenigen, die er noch nicht kennt.  Je früher ein Eindringen erkannt werden kann, desto eher beginnt die Arbeit damit und desto wahrscheinlicher ist es, dass er lokalisiert wird.  Einbruch, der seit Monaten ignoriert wird, gibt Anlass zur Sorge. <br><br>  Um das Eindringen zu erkennen, müssen Sie vorhersehen, was der Angreifer tun wird.  Hier finden Sie Informationen darüber, was genau überwacht werden muss.  Detektoren suchen in Protokollen, Netzwerkpaketen und sogar im Programmspeicher nach bekannten Angriffsmustern.  Wenn ein Eindringen festgestellt wird, können Sie dem Hacker den Zugriff auf den Computer entziehen, das beschädigte Dateisystem mithilfe einer Sicherung wiederherstellen und die Sicherheitslücke identifizieren und beheben.  Mit den heute verfügbaren Sicherungs- und Wiederherstellungsfunktionen sind Gegenmaßnahmen, die sich auf die Angriffserkennung reduzieren, sehr effektiv. <br><br>  Erkennung bedeutet für einen Angreifer, alles zu kontern, was er tut.  Natürlich ist es nicht immer möglich, einen Angriff sofort zu bemerken, daher gibt es eine Reihe von "Grab and Run" -Szenarien, in denen die Tatsache der Erkennung nicht wichtig ist, aber selbst in diesen Fällen ist es besser, keine Spuren zu hinterlassen.  Geheimhaltung ist eine der wertvollsten Eigenschaften von Hackern.  Wenn Sie durch Ausnutzen von Sicherheitslücken Zugriff auf die Befehlsshell mit Administratorrechten erhalten, können Sie alles auf dem System tun. Wenn Sie es schaffen, eine Erkennung zu vermeiden, weiß niemand von Ihrer Anwesenheit.  Es ist die Kombination von Zulässigkeit mit Unsichtbarkeit, die Hacker gefährlich macht.  Sie können problemlos Kennwörter und Daten im Netzwerk abfangen, Lesezeichen zu Programmen für den nachfolgenden nicht autorisierten Zugriff hinzufügen und andere Netzwerkknoten angreifen.  Um im Schatten zu bleiben, sollte der Hacker verstehen, welche Erkennungsmethoden in einem bestimmten Fall verwendet werden.  Wenn Sie genau wissen, wonach sie suchen, können Sie bestimmte Muster der Ausnutzung der Sicherheitsanfälligkeit vermeiden oder Ihre Aktionen als gültig tarnen.  Der treibende Faktor für den Zyklus der gemeinsamen Entwicklung von Erkennungswerkzeugen und -techniken, die es ermöglichen, unbemerkt zu bleiben, sind Ideen, die auf der anderen Seite noch nicht vorgekommen sind. <br><br><h3>  0x620 Systemdämonen </h3><br>  Gegenmaßnahmen gegen Hacker und ihre Problemumgehungen lassen sich jedoch am besten anhand eines praktischen Beispiels diskutieren.  Jetzt betrachten wir einen Angriff auf ein Serverprogramm, das eingehende Verbindungen akzeptiert.  Unter UNIX-ähnlichen Betriebssystemen sind Systemdämonen für diese Kriterien geeignet.  Ein Daemon ist ein Programm, das im Hintergrund ausgeführt wird und in gewisser Weise vom Steuerterminal getrennt ist.  Der Begriff wurde in den 1960er Jahren von Hackern des Massachusetts Institute of Technology geprägt.  Der Prototyp war ein Fabelwesen, das Moleküle nach einem mentalen Experiment des Physikers James Maxwell sortierte.  Der Maxwell-Dämon besaß eine übernatürliche Fähigkeit, komplexe Aufgaben leicht auszuführen, was gegen den zweiten Hauptsatz der Thermodynamik verstieß.  In ähnlicher Weise führen Linux-Systemdämonen unermüdlich Aufgaben wie das Gewähren des Zugriffs auf SSH und das Verwalten von Systemprotokollen aus.  Dämonennamen enden normalerweise mit d, was ihre Natur betont: zum Beispiel sshd oder syslogd. <br><br>  Eine kleine Bearbeitung verwandelt tinyweb.c aus Abschnitt 0x427 in eine realistische Ähnlichkeit mit einem Systemdämon.  Die neue Version des Codes enthält die Funktion daemon (), die einen neuen Hintergrundprozess auslöst.  Es wird von vielen Linux-Systemdämonprozessen verwendet.  Hier ist die ihr gewidmete Seite aus dem Verzeichnis: <br><br>  DAEMON (3) Linux-Programmierreferenz DAEMON (3) <br><br>  NAME <br>  Daemon - im Hintergrund ausführen <br>  Syntaxis <br><br><pre><code class="hljs vbscript">#include &lt;unistd.h&gt; <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> daemon(<span class="hljs-built_in"><span class="hljs-built_in">int</span></span> nochdir, <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> noclose);</code> </pre> <br>  BESCHREIBUNG <br><br>  Die Funktion daemon () trennt das Programm vom Steuerterminal und startet <br>  sie im Hintergrund als Systemdämon. <br>  Mit einem Argument ungleich Null, nochdir, ändert die Funktion daemon () das aktuelle Arbeitsverzeichnis. <br>  auf der Wurzel ("/"). <br>  Mit nullose leitet die Funktion daemon () Threads um <br>  Standardeingabe, Standardausgabe und Fehler in / dev / null. <br>  RÜCKGABEWERT <br><br>  (Diese Funktion erzeugt eine Kopie des Prozesses, und wenn fork () erfolgreich ist <br>  Das übergeordnete Element führt _exit (0) aus, sodass nur weitere Fehler sichtbar sind <br>  untergeordneter Prozess.) Wenn erfolgreich, wird Null zurückgegeben.  Bei Fehler die Funktion <br>  daemon () gibt -1 zurück und weist der globalen Variablen errno die Fehlernummer zu <br>  aus der Funktionsbibliothek fork (2) und setsid (2). <br><br>  System-Daemons haben kein Steuerterminal, daher wird der Code für den neuen tinywebd-Daemon in das Logbuch ausgegeben.  Dämonen werden normalerweise durch Signale gesteuert.  Die neue Version von tinyweb sollte in der Lage sein, ein Abschlusssignal zu empfangen, um das Programm korrekt zu beenden. <br><br><h3>  0x621 Signalübersicht </h3><br>  Signale ermöglichen die prozessübergreifende Kommunikation unter UNIX.  Nachdem ein Signal von einem Prozess empfangen wurde, unterbricht das Betriebssystem seine Ausführung, um den Signalhandler aufzurufen.  Jedes Signal hat eine eigene Nummer und einen eigenen Handler.  Wenn Sie beispielsweise die Tastenkombination Strg + C drücken, wird ein Interrupt-Signal gesendet, dessen Handler das auf dem Steuerterminal geöffnete Programm beendet, auch wenn es in eine Endlosschleife eingetreten ist. <br><br>  Sie können Ihre eigenen Signalhandler erstellen und diese mit der Funktion signal () registrieren.  Schauen wir uns einen Code an, in dem mehrere Handler für einige Signale registriert sind und im Hauptteil eine Endlosschleife vorhanden ist. <br><br><pre> <code class="hljs smalltalk">signal_example.c <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdio.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;stdlib.h&gt; <span class="hljs-symbol"><span class="hljs-symbol">#include</span></span> &lt;signal.h&gt; /*    signal.h * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGHUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">C</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>  (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+\) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGILL</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTRAP</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGABRT</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>  * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGBUS</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGFPE</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>     * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGKILL</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>   <span class="hljs-number"><span class="hljs-number">1</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSEGV</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>   * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGPIPE</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>    ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGALRM</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>   ,  alarm() * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTERM</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>  (  kill) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCHLD</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGCONT</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> ,    * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGSTOP</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>  (  ) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>   [] (<span class="hljs-type"><span class="hljs-type">Ctrl</span></span>+<span class="hljs-type"><span class="hljs-type">Z</span></span>) * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTIN</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>       * <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">SIGTTOU</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>       */ /*   */ void signal_handler(int signal) { printf(<span class="hljs-comment"><span class="hljs-comment">"  %d\t"</span></span>, signal); if (signal == <span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGTSTP (Ctrl-Z)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGQUIT (Ctrl-\\)"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR1"</span></span>); else if (signal == <span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>) printf(<span class="hljs-comment"><span class="hljs-comment">"SIGUSR2"</span></span>); printf(<span class="hljs-comment"><span class="hljs-comment">"\n"</span></span>); } void sigint_handler(int x) { printf(<span class="hljs-comment"><span class="hljs-comment">" Ctrl-C (SIGINT)   \nExiting.\n"</span></span>); exit(<span class="hljs-number"><span class="hljs-number">0</span></span>); } int main() { /* <span class="hljs-type"><span class="hljs-type">Registering</span></span> signal handlers */ signal(<span class="hljs-type"><span class="hljs-type">SIGQUIT</span></span>, signal_handler); //  signal_handler() signal(<span class="hljs-type"><span class="hljs-type">SIGTSTP</span></span>, signal_handler); //    signal(<span class="hljs-type"><span class="hljs-type">SIGUSR1</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGUSR2</span></span>, signal_handler); signal(<span class="hljs-type"><span class="hljs-type">SIGINT</span></span>, sigint_handler); //  sigint_handler()  <span class="hljs-type"><span class="hljs-type">SIGINT</span></span> while(<span class="hljs-number"><span class="hljs-number">1</span></span>) {} //   }</code> </pre> <br>  Wenn ein kompiliertes Programm ausgeführt wird, werden Signalhandler registriert, und dann tritt das Programm in eine Endlosschleife ein.  Trotzdem unterbrechen eingehende Signale die Ausführung und wenden sich an registrierte Handler.  Das Folgende sind Beispiele für die Anwendung von Signalen, die vom Steuerterminal aktiviert werden können.  Nach Abschluss der Funktion signal_handler () kehrt die Steuerung zur unterbrochenen Schleife zurück, während die Funktion sigint_handler () das Programm beendet. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o signal_example signal_example.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">20</span></span> SIGTSTP (Ctrl-Z)   <span class="hljs-number"><span class="hljs-number">3</span></span> SIGQUIT (Ctrl-\)  Ctrl-C (SIGINT)    Exiting. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Mit dem Befehl kill können Sie eine ganze Reihe von Signalen an einen Prozess senden.  Standardmäßig sendet es ein Abschlusssignal (SIGTERM).  Durch Hinzufügen der Option -l wird eine Liste aller möglichen Signale angezeigt.  Mal sehen, wie das auf einem anderen Terminal laufende Programm signal_example die Signale SIGUSR1 und SIGUSR2 sendet. <br><br><pre> <code class="hljs powershell">reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-l</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>) SIGHUP       <span class="hljs-number"><span class="hljs-number">2</span></span>) SIGINT       <span class="hljs-number"><span class="hljs-number">3</span></span>) SIGQUIT      <span class="hljs-number"><span class="hljs-number">4</span></span>) SIGILL <span class="hljs-number"><span class="hljs-number">5</span></span>) SIGTRAP      <span class="hljs-number"><span class="hljs-number">6</span></span>) SIGABRT      <span class="hljs-number"><span class="hljs-number">7</span></span>) SIGBUS       <span class="hljs-number"><span class="hljs-number">8</span></span>) SIGFPE <span class="hljs-number"><span class="hljs-number">9</span></span>) SIGKILL     <span class="hljs-number"><span class="hljs-number">10</span></span>) SIGUSR1     <span class="hljs-number"><span class="hljs-number">11</span></span>) SIGSEGV     <span class="hljs-number"><span class="hljs-number">12</span></span>) SIGUSR2 <span class="hljs-number"><span class="hljs-number">13</span></span>) SIGPIPE     <span class="hljs-number"><span class="hljs-number">14</span></span>) SIGALRM     <span class="hljs-number"><span class="hljs-number">15</span></span>) SIGTERM     <span class="hljs-number"><span class="hljs-number">16</span></span>) SIGSTKFLT <span class="hljs-number"><span class="hljs-number">17</span></span>) SIGCHLD     <span class="hljs-number"><span class="hljs-number">18</span></span>) SIGCONT     <span class="hljs-number"><span class="hljs-number">19</span></span>) SIGSTOP     <span class="hljs-number"><span class="hljs-number">20</span></span>) SIGTSTP <span class="hljs-number"><span class="hljs-number">21</span></span>) SIGTTIN     <span class="hljs-number"><span class="hljs-number">22</span></span>) SIGTTOU     <span class="hljs-number"><span class="hljs-number">23</span></span>) SIGURG      <span class="hljs-number"><span class="hljs-number">24</span></span>) SIGXCPU <span class="hljs-number"><span class="hljs-number">25</span></span>) SIGXFSZ     <span class="hljs-number"><span class="hljs-number">26</span></span>) SIGVTALRM   <span class="hljs-number"><span class="hljs-number">27</span></span>) SIGPROF     <span class="hljs-number"><span class="hljs-number">28</span></span>) SIGWINCH <span class="hljs-number"><span class="hljs-number">29</span></span>) SIGIO       <span class="hljs-number"><span class="hljs-number">30</span></span>) SIGPWR      <span class="hljs-number"><span class="hljs-number">31</span></span>) SIGSYS      <span class="hljs-number"><span class="hljs-number">34</span></span>) SIGRTMIN <span class="hljs-number"><span class="hljs-number">35</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">1</span></span>  <span class="hljs-number"><span class="hljs-number">36</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">2</span></span>  <span class="hljs-number"><span class="hljs-number">37</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">3</span></span>  <span class="hljs-number"><span class="hljs-number">38</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">39</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">5</span></span>  <span class="hljs-number"><span class="hljs-number">40</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">6</span></span>  <span class="hljs-number"><span class="hljs-number">41</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">7</span></span>  <span class="hljs-number"><span class="hljs-number">42</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">43</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">9</span></span>  <span class="hljs-number"><span class="hljs-number">44</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">45</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">46</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">47</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">48</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">49</span></span>) SIGRTMIN+<span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-14</span></span> <span class="hljs-number"><span class="hljs-number">51</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-13</span></span> <span class="hljs-number"><span class="hljs-number">52</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-11</span></span> <span class="hljs-number"><span class="hljs-number">54</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-9</span></span>  <span class="hljs-number"><span class="hljs-number">56</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-8</span></span>  <span class="hljs-number"><span class="hljs-number">57</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-7</span></span>  <span class="hljs-number"><span class="hljs-number">58</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-6</span></span> <span class="hljs-number"><span class="hljs-number">59</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-5</span></span>  <span class="hljs-number"><span class="hljs-number">60</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-4</span></span>  <span class="hljs-number"><span class="hljs-number">61</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-3</span></span>  <span class="hljs-number"><span class="hljs-number">62</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-2</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span>) SIGRTMAX<span class="hljs-literal"><span class="hljs-literal">-1</span></span>  <span class="hljs-number"><span class="hljs-number">64</span></span>) SIGRTMAX reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> ps a | grep signal_example <span class="hljs-number"><span class="hljs-number">24491</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span>    R+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">17</span></span> ./signal_example <span class="hljs-number"><span class="hljs-number">24512</span></span> pts/<span class="hljs-number"><span class="hljs-number">1</span></span>    S+     <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> grep signal_example reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-10</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-12</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span> kill <span class="hljs-literal"><span class="hljs-literal">-9</span></span> <span class="hljs-number"><span class="hljs-number">24491</span></span> reader@hacking:~/booksrc <span class="hljs-variable"><span class="hljs-variable">$</span></span></code> </pre> <br>  Am Ende sendet der Befehl kill -9 ein SIGKILL-Signal.  Der Signalhandler kann nicht geändert werden, daher wird der Befehl kill -9 immer zum Beenden von Prozessen verwendet.  Das auf einem anderen Terminal gestartete Programm signal_example zeigt an, dass die Signale abgefangen und der Prozess zerstört wurde. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./signal_example   <span class="hljs-number"><span class="hljs-number">10</span></span>       SIGUSR1   <span class="hljs-number"><span class="hljs-number">12</span></span>       SIGUSR2 Killed reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Die Signale selbst sind sehr einfach, aber die Interaktion zwischen Prozessen kann schnell zu einem komplexen Netz von Abhängigkeiten werden.  Glücklicherweise werden in unserem tinyweb-Daemon Signale nur zum korrekten Herunterfahren verwendet, und alles wird sehr einfach implementiert. <br><br><h3>  0x622 Tinyweb Daemon </h3><br>  Die neue Version von tinywebd ist ein Systemdämon, der im Hintergrund ohne Steuerterminal gestartet wird.  Die Ausgabedaten werden mit Zeitstempeln in das Logbuch geschrieben, und das Programm selbst wartet darauf, dass das SIGTERM-Signal die Arbeit korrekt abschließt. <br><br>  Die am Original vorgenommenen Änderungen sind nicht sehr bedeutsam, ermöglichen jedoch eine realistischere Untersuchung des Ausnutzungsprozesses der Sicherheitsanfälligkeit.  Neue Codefragmente sind fett gedruckt. <br><br><pre> <code class="hljs pgsql">tinywebd.c #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/socket.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;netinet/<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;arpa/<span class="hljs-type"><span class="hljs-type">inet</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/<span class="hljs-keyword"><span class="hljs-keyword">types</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;sys/stat.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;fcntl.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;<span class="hljs-type"><span class="hljs-type">time</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;signal.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "hacking-network.h" #define PORT <span class="hljs-number"><span class="hljs-number">80</span></span> // ,     #define WEBROOT "./webroot" //   - #define LOGFILE "/var/log/tinywebd.log" //    <span class="hljs-type"><span class="hljs-type">int</span></span> logfd, sockfd; //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span>, struct sockaddr_in *, <span class="hljs-type"><span class="hljs-type">int</span></span>); <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span>); //         //  <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(<span class="hljs-type"><span class="hljs-type">int</span></span>); //        //       <span class="hljs-type"><span class="hljs-type">void</span></span> handle_shutdown(<span class="hljs-type"><span class="hljs-type">int</span></span> signal) { <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, " .\n", <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(sockfd); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-type"><span class="hljs-type">int</span></span> main(<span class="hljs-type"><span class="hljs-type">void</span></span>) { <span class="hljs-type"><span class="hljs-type">int</span></span> new_sockfd, yes=<span class="hljs-number"><span class="hljs-number">1</span></span>; struct sockaddr_in host_addr, client_addr; //    socklen_t sin_size; logfd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(LOGFILE, O_WRONLY|O_CREAT|O_APPEND, S_IRUSR|S_IWUSR); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(logfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  ");  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((sockfd = socket(PF_INET, SOCK_STREAM, <span class="hljs-number"><span class="hljs-number">0</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)        fatal(" "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(<span class="hljs-type"><span class="hljs-type">int</span></span>)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   SO_REUSEADDR"); printf("  tiny web.\n"); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(daemon(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) //    fatal("   "); signal(SIGTERM, handle_shutdown);   //    handle_shutdown signal(SIGINT, handle_shutdown);   //    handle_shutdown <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, ".\n", <span class="hljs-number"><span class="hljs-number">15</span></span>); host_addr.sin_family = AF_INET;       //    host_addr.sin_port = htons(PORT);     //  ,    host_addr.sin_addr.s_addr = INADDR_ANY; //    IP memset(&amp;(host_addr.sin_zero), <span class="hljs-string"><span class="hljs-string">'\0'</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bind(sockfd, (struct sockaddr *)&amp;host_addr, sizeof(struct sockaddr)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("  "); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">listen</span></span>(sockfd, <span class="hljs-number"><span class="hljs-number">20</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal("   "); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) { //   accept sin_size = sizeof(struct sockaddr_in); new_sockfd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;sin_size); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(new_sockfd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) fatal(" "); handle_connection(new_sockfd, &amp;client_addr, logfd); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*         *         FD. *    -,    *   .     . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> handle_connection(<span class="hljs-type"><span class="hljs-type">int</span></span> sockfd, struct sockaddr_in *client_addr_ptr, <span class="hljs-type"><span class="hljs-type">int</span></span> logfd) { unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *ptr, request[<span class="hljs-number"><span class="hljs-number">500</span></span>], resource[<span class="hljs-number"><span class="hljs-number">500</span></span>], log_buffer[<span class="hljs-number"><span class="hljs-number">500</span></span>]; <span class="hljs-type"><span class="hljs-type">int</span></span> fd, length; length = recv_line(sockfd, request); sprintf(log_buffer, " %s:%d \"%s\"\t", inet_ntoa(client_addr_ptr-&gt;sin_addr), ntohs(client_addr_ptr-&gt;sin_port), request); ptr = strstr(request, " HTTP/"); //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //    HTTP  strcat(log_buffer, "  HTTP!\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *ptr = <span class="hljs-number"><span class="hljs-number">0</span></span>; //      URL ptr = <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>; //  ptr  <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span> (           //  ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "GET ", <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> ptr = request+<span class="hljs-number"><span class="hljs-number">4</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(strncmp(request, "HEAD ", <span class="hljs-number"><span class="hljs-number">5</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) //  HEAD ptr = request+<span class="hljs-number"><span class="hljs-number">5</span></span>; // ptr -  URL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>) { //     strcat(log_buffer, "  !\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //    ptr,     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ptr[strlen(ptr) - <span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-string"><span class="hljs-string">'/'</span></span>)   //  ,                                        //  <span class="hljs-string"><span class="hljs-string">'/'</span></span>, strcat(ptr, "index.html");   //    <span class="hljs-string"><span class="hljs-string">'index.html'</span></span> strcpy(resource, WEBROOT);   //  resource                                            //  strcat(resource, ptr);   //      fd = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(resource, O_RDONLY, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fd == <span class="hljs-number"><span class="hljs-number">-1</span></span>) { //     strcat(log_buffer, " 404 Not Found\n");           send_string(sockfd, "HTTP/1.0 404 NOT FOUND\r\n");                send_string(sockfd, "Server: Tiny webserver\r\n\r\n");                send_string(sockfd, "&lt;html&gt;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;                                     &lt;/head&gt;");            send_string(sockfd, "&lt;body&gt;&lt;h1&gt;URL not found&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;                                     \r\n"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {       //      strcat(log_buffer, " 200 OK\n");             send_string(sockfd, "HTTP/1.0 200 OK\r\n");           send_string(sockfd, "Server: Tiny webserver\r\n\r\n");            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(ptr == request + <span class="hljs-number"><span class="hljs-number">4</span></span>) { //    <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (length = get_file_size(fd)) == <span class="hljs-number"><span class="hljs-number">-1</span></span>)          fatal("     ");     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( (ptr = (unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> *) malloc(length)) == <span class="hljs-keyword"><span class="hljs-keyword">NULL</span></span>)          fatal("      ");          <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>(fd, ptr, length);  //              send(sockfd, ptr, length, <span class="hljs-number"><span class="hljs-number">0</span></span>);  //              free(ptr);  //      } <span class="hljs-keyword"><span class="hljs-keyword">close</span></span>(fd); //   } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>  /        } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>     } //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>    HTTP <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(logfd); length = strlen(log_buffer); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(logfd, log_buffer, length); //    shutdown(sockfd, SHUT_RDWR); //    } <span class="hljs-comment"><span class="hljs-comment">/*         *    .    -1. */</span></span> <span class="hljs-type"><span class="hljs-type">int</span></span> get_file_size(<span class="hljs-type"><span class="hljs-type">int</span></span> fd) { struct stat stat_struct; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(fstat(fd, &amp;stat_struct) == <span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span>) stat_struct.st_size; } <span class="hljs-comment"><span class="hljs-comment">/*          *   . */</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-type"><span class="hljs-type">timestamp</span></span>(fd) { time_t now; struct tm *time_struct; <span class="hljs-type"><span class="hljs-type">int</span></span> length; <span class="hljs-type"><span class="hljs-type">char</span></span> time_buffer[<span class="hljs-number"><span class="hljs-number">40</span></span>]; <span class="hljs-type"><span class="hljs-type">time</span></span>(&amp;now); //       time_struct = <span class="hljs-built_in"><span class="hljs-built_in">localtime</span></span>((const time_t *)&amp;now); //    tm length = strftime(time_buffer, <span class="hljs-number"><span class="hljs-number">40</span></span>, "%m/%d/%Y %H:%M:%S&gt; ", time_struct); <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(fd, time_buffer, length); //       }</code> </pre> <br>  Dieses Programm erstellt einen doppelten Prozess, der im Hintergrund ausgeführt wird, zusammen mit Zeitstempeln in die Protokolldatei schreibt und nach dem Empfang des entsprechenden Signals korrekt beendet wird.  Der Protokolldateideskriptor und der Socket, die die Verbindung akzeptieren, werden als globale Variablen deklariert, damit die Funktion handle_shutdown () ihre Arbeit korrekt ausführen kann.  Es ist als Rückruf-Handler für Vervollständigungs- und Interrupt-Signale definiert, der sicherstellt, dass das Programm durch den Befehl kill beendet wird. <br><br>  Hier ist das Ergebnis des Kompilierens, Ausführens und Vervollständigens des Programms.  Beachten Sie die Zeitstempel im Protokoll und die Abschlussmeldung, die angezeigt wurde, nachdem das Programm das entsprechende Signal empfangen und die Funktion handle_shutdown () aufgerufen hat. <br><br><pre> <code class="hljs ruby">reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ gcc -o tinywebd tinywebd.c reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chown root ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo chmod u+s ./tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./tinywebd   tiny web. reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ./webserver_id <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> The web server <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> is Tiny webserver reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ ps ax <span class="hljs-params"><span class="hljs-params">| grep tinywebd 25058 ? Ss 0:00 ./tinywebd 25075 pts/3 R+ 0:00 grep tinywebd reader@hacking:~/booksrc $ kill 25058 reader@hacking:~/booksrc $ ps ax |</span></span> grep tinywebd <span class="hljs-number"><span class="hljs-number">25121</span></span> pts/<span class="hljs-number"><span class="hljs-number">3</span></span> R+ <span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span> grep tinywebd reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ cat /var/log/tinywebd.log <span class="hljs-symbol"><span class="hljs-symbol">cat:</span></span> /var/log/tinywebd.<span class="hljs-symbol"><span class="hljs-symbol">log:</span></span> Permission denied reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $ sudo cat /var/log/tinywebd.log <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">55</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">45</span></span>&gt; . <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">00</span></span>&gt;  <span class="hljs-number"><span class="hljs-number">127.0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">38127</span></span> <span class="hljs-string"><span class="hljs-string">"HEAD / HTTP/1.0"</span></span> <span class="hljs-number"><span class="hljs-number">200</span></span> OK <span class="hljs-number"><span class="hljs-number">07</span></span>/<span class="hljs-number"><span class="hljs-number">22</span></span>/<span class="hljs-number"><span class="hljs-number">2007</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">57</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">21</span></span>&gt;  . reader@hacking<span class="hljs-symbol"><span class="hljs-symbol">:~/booksrc</span></span> $</code> </pre> <br>  Das neue Programm tinywebd verarbeitet HTTP-Inhalte wie das ursprüngliche Programm tinyweb, verhält sich jedoch wie ein Systemdämon, da es kein Steuerterminal hat und die Ausgabe in eine Protokolldatei erfolgt.  Beide Programme sind für denselben Pufferüberlauf anfällig - dies ist jedoch nur der Anfang dieser Sicherheitsanfälligkeit.  Nachdem wir tinywebd als Ziel des Angriffs ausgewählt haben, werde ich Ihnen zeigen, wie Sie eine Erkennung vermeiden können, nachdem Sie eine andere Maschine betreten haben. <br><br>  »Weitere Informationen zum Buch finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Website des Herausgebers</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inhalt</a> <br>  » <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auszug</a> <br><br>  20% Rabatt auf Gutschein für Habrozhitel - <b>Hacking</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413989/">https://habr.com/ru/post/de413989/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413977/index.html">Aufbau eines erweiterten Virenschutzsystems für ein kleines Unternehmen. Teil 3</a></li>
<li><a href="../de413979/index.html">Mitap "Wie leite ich Gilden und Gemeinschaften?" von Tutu.ru und AgileVerse</a></li>
<li><a href="../de413981/index.html">Sicherheitswoche 21: Hunderte von Adobe Flash-Schwachstellen</a></li>
<li><a href="../de413983/index.html">Cavium ThunderX2-Evaluierung: Der Arm Server-Traum wird wahr (Teil 3)</a></li>
<li><a href="../de413987/index.html">Red Hogwarts. Serie 7. Studenten</a></li>
<li><a href="../de413991/index.html">Patche mich, wenn du kannst: wie wir die Produktion debuggen. Teil 2</a></li>
<li><a href="../de413995/index.html">Technische Konferenzen für uns: unsere Erfahrungen, Fehler und Erfolge</a></li>
<li><a href="../de413997/index.html">Intel 32-Bit-Prozessoren: 3 bis 4 - Nutzloser Friday Longride</a></li>
<li><a href="../de414001/index.html">Wie man in einer sich verändernden Welt der Entwicklung überlebt</a></li>
<li><a href="../de414003/index.html">Die Züge sind unterschiedlich. Sehr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>