<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèñÔ∏è üë©üèΩ‚Äçü§ù‚Äçüë®üèø üß° Sobre o modelo de rede em jogos para iniciantes ü§ê üë©üèΩ‚Äçüé® üë©‚Äçüë©‚Äçüëß‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nas √∫ltimas duas semanas, tenho trabalhado em um mecanismo de rede para o meu jogo. Antes disso, eu n√£o sabia nada sobre tecnologias de rede em jogos,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sobre o modelo de rede em jogos para iniciantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467025/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/69e/de3/6bb/69ede36bb7e48411280ffad409751c0d.png" alt="imagem"></div><br>  Nas √∫ltimas duas semanas, tenho trabalhado em um mecanismo de rede para o meu jogo.  Antes disso, eu n√£o sabia nada sobre tecnologias de rede em jogos, ent√£o li muitos artigos e realizei muitos experimentos para entender todos os conceitos e poder escrever meu pr√≥prio mecanismo de rede. <br><br>  Neste guia, gostaria de compartilhar com voc√™ v√°rios conceitos que voc√™ precisa aprender antes de escrever seu pr√≥prio mecanismo de jogo, bem como os melhores recursos e artigos para aprend√™-los. <br><br>  Em geral, existem dois tipos principais de arquiteturas de rede: ponto a ponto e cliente-servidor.  Na arquitetura ponto a ponto (p2p), os dados s√£o transferidos entre qualquer par de players conectados e, na arquitetura cliente-servidor, os dados s√£o transmitidos apenas entre os players e o servidor. <br><br>  Embora a arquitetura ponto a ponto ainda seja usada em alguns jogos, o padr√£o √© cliente-servidor: √© mais f√°cil de implementar, requer uma largura de canal menor e facilita a prote√ß√£o contra trapa√ßas.  Portanto, neste guia, focaremos na arquitetura cliente-servidor. <br><a name="habracut"></a><br>  Em particular, estamos mais interessados ‚Äã‚Äãem servidores autorit√°rios: nesses sistemas, o servidor est√° sempre certo.  Por exemplo, se um jogador pensa que ele est√° em coordenadas (10, 5) e o servidor diz que ele est√° em (5, 3), o cliente deve substituir sua posi√ß√£o pela posi√ß√£o transmitida pelo servidor e n√£o vice-versa.  O uso de servidores autorit√°rios facilita o reconhecimento de trapaceiros. <br><br>  Existem tr√™s componentes principais nos sistemas de rede de jogos: <br><br><ul><li>  Protocolo de Transporte: como os dados s√£o transferidos entre os clientes e o servidor. </li><li>  Protocolo de aplica√ß√£o: o que √© transferido dos clientes para o servidor e do servidor para os clientes e em que formato. </li><li>  L√≥gica do aplicativo: como os dados transmitidos s√£o usados ‚Äã‚Äãpara atualizar o status dos clientes e do servidor. </li></ul><br>  √â muito importante entender o papel de cada parte e as dificuldades associadas. <br><br><h1>  Protocolo de transporte </h1><br>  O primeiro passo √© escolher um protocolo para o transporte de dados entre o servidor e os clientes.  Existem dois protocolos da Internet para isso: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TCP</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UDP</a> .  Mas voc√™ pode criar seu pr√≥prio protocolo de transporte com base em um deles ou usar a biblioteca na qual eles s√£o usados. <br><br><h2>  Comparando TCP e UDP </h2><br>  O TCP e o UDP s√£o baseados em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">IP</a> .  O IP permite transferir um pacote da origem para o destinat√°rio, mas n√£o garante que o pacote enviado chegue mais cedo ou mais tarde ao destinat√°rio, que ele chegue ao menos uma vez e que a sequ√™ncia de pacotes chegue na ordem correta.  Al√©m disso, um pacote pode conter apenas um tamanho de dados limitado especificado pelo valor da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MTU</a> . <br><br>  O UDP √© apenas uma camada fina sobre o IP.  Portanto, tem as mesmas limita√ß√µes.  Por outro lado, o TCP possui muitos recursos.  Ele fornece uma conex√£o confi√°vel e ordenada entre dois n√≥s com verifica√ß√£o de erros.  Portanto, o TCP √© muito conveniente e √© usado em muitos outros protocolos, por exemplo, em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HTTP</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FTP</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SMTP</a> .  Mas todos esses recursos t√™m um pre√ßo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>atraso</em></a> . <br><br>  Para entender por que essas fun√ß√µes podem causar um atraso, voc√™ precisa entender como o TCP funciona.  Quando o n√≥ de envio encaminha o pacote para o n√≥ de recebimento, espera receber uma confirma√ß√£o (ACK).  Se depois de um certo tempo ele n√£o o receber (porque o pacote ou a confirma√ß√£o foi perdida ou por outros motivos), ele reenviar√° o pacote.  Al√©m disso, o TCP garante que os pacotes sejam recebidos na ordem correta; portanto, at√© que um pacote perdido seja recebido, todos os outros pacotes n√£o poder√£o ser processados, mesmo que j√° tenham sido recebidos pelo n√≥ de recebimento. <br><br>  Mas, como voc√™ provavelmente entende, o atraso nos jogos multiplayer √© muito importante, especialmente em g√™neros ativos como o FPS.  √â por isso que muitos jogos usam o UDP com seu pr√≥prio protocolo. <br><br>  Um protocolo nativo baseado em UDP pode ser mais eficiente que o TCP por v√°rios motivos.  Por exemplo, pode marcar alguns pacotes como confi√°veis ‚Äã‚Äãe outros como n√£o confi√°veis.  Portanto, ele n√£o se importa se o pacote n√£o confi√°vel chegou ao receptor.  Ou pode processar v√°rios fluxos de dados para que um pacote perdido em um fluxo n√£o diminua a velocidade dos fluxos restantes.  Por exemplo, pode haver um fluxo para entrada do jogador e outro fluxo para mensagens de bate-papo.  Se uma mensagem de bate-papo que n√£o cont√©m dados urgentes for perdida, ela n√£o diminuir√° a velocidade da entrada, o que √© urgente.  Ou, um protocolo propriet√°rio pode implementar confiabilidade de maneira diferente da do TCP, a fim de ser mais eficiente nos videogames. <br><br>  Ent√£o, se o TCP √© uma porcaria, criaremos nosso pr√≥prio protocolo de transporte baseado no UDP? <br><br>  Tudo √© um pouco mais complicado.  Embora o TCP seja quase sub√≥timo para sistemas de rede de jogos, ele pode funcionar muito bem no seu jogo e economizar seu tempo valioso.  Por exemplo, atraso pode n√£o ser um problema para um jogo baseado em turnos ou um jogo que s√≥ pode ser jogado em LANs, onde h√° muito menos atrasos e perda de pacotes do que na Internet. <br><br>  Muitos jogos de sucesso, incluindo World of Warcraft, Minecraft e Terraria, usam TCP.  No entanto, a maioria dos FPS usa protocolos propriet√°rios baseados em UDP, ent√£o falaremos mais sobre eles abaixo. <br><br>  Se voc√™ decidir usar o TCP, verifique se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o algoritmo Nagle est√°</a> desativado, porque ele armazena em buffer os pacotes antes do envio, o que significa que aumenta o atraso. <br><br>  Para saber mais sobre as diferen√ßas entre UDP e TCP no contexto de jogos multiplayer, voc√™ pode ler o artigo de Glenn Fiedler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823015049/"><em>UDP vs.</em></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823015049/"><em>TCP</em></a> <br><br><h2>  Protocolo pr√≥prio </h2><br>  Ent√£o, voc√™ deseja criar seu pr√≥prio protocolo de transporte, mas n√£o sabe por onde come√ßar?  Voc√™ tem sorte, porque Glenn Fiedler escreveu dois artigos incr√≠veis sobre isso.  Voc√™ encontrar√° muitos pensamentos inteligentes neles. <br><br>  O primeiro artigo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823012240/"><em>Networking for Game Programmers</em></a> 2008, √© mais simples que o segundo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823014904/"><em>Building A Game Network Protocol</em></a> 2016.  Eu recomendo que voc√™ comece com um mais antigo. <br><br>  Lembre-se de que Glenn Fiedler √© um grande defensor do uso de seu pr√≥prio protocolo UDP.  E depois de ler seus artigos, voc√™ certamente superar√° a opini√£o dele de que o TCP tem s√©rias desvantagens nos videogames e deseja implementar seu pr√≥prio protocolo. <br><br>  Mas se voc√™ √© novo na rede, fa√ßa um favor a si mesmo e use o TCP ou uma biblioteca.  Para implementar com sucesso seu pr√≥prio protocolo de transporte, primeiro voc√™ precisa aprender muito. <br><br><h2>  Bibliotecas de rede </h2><br>  Se voc√™ precisar de algo mais eficiente que o TCP, mas n√£o quiser se preocupar em implementar seu pr√≥prio protocolo e entrar em muitos detalhes, poder√° usar a biblioteca de rede.  Existem muitos deles: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">yojimbo</a> Glenn Fiedler </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RakNet</a> , que n√£o √© mais suportado, mas seu fork do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SLikeNet</a> parece ainda estar ativo. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ENet</a> √© uma biblioteca criada para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cubo</a> FPS multiusu√°rio </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GameNetworkingSockets da Valve</a> </li></ul><br>  Eu n√£o tentei todos eles, mas prefiro o ENet, porque √© f√°cil de usar e confi√°vel.  Al√©m disso, ela possui documenta√ß√£o clara e um tutorial para iniciantes. <br><br><h2>  Protocolo de Transporte: Conclus√£o </h2><br>  Para resumir: existem dois protocolos principais de transporte: TCP e UDP.  O TCP possui muitos recursos √∫teis: confiabilidade, solicita√ß√£o de pacotes, detec√ß√£o de erros.  O UDP n√£o tem tudo isso, mas o TCP, por sua natureza, aumentou atrasos que s√£o inaceit√°veis ‚Äã‚Äãpara alguns jogos.  Ou seja, para garantir baixas lat√™ncias, voc√™ pode criar seu pr√≥prio protocolo baseado em UDP ou usar uma biblioteca que implemente o protocolo de transporte UDP e seja adaptada para videogames para v√°rios jogadores. <br><br>  A escolha entre TCP, UDP e a biblioteca depende de v√°rios fatores.  Em primeiro lugar, pelas necessidades do jogo: ele precisa de baixas lat√™ncias?  Segundo, a partir dos requisitos do protocolo de aplica√ß√£o: ele precisa de um protocolo confi√°vel?  Como veremos na pr√≥xima parte, voc√™ pode criar um protocolo de aplicativo para o qual um protocolo n√£o confi√°vel √© bastante adequado.  Por fim, voc√™ ainda precisa considerar a experi√™ncia do desenvolvedor do mecanismo de rede. <br><br>  Eu tenho duas dicas: <br><br><ul><li>  Maximize o protocolo de transporte do restante do aplicativo para que ele possa ser facilmente substitu√≠do sem reescrever o c√≥digo inteiro. </li><li>  N√£o fa√ßa otimiza√ß√£o prematura.  Se voc√™ n√£o √© um especialista em rede e n√£o tem certeza se precisa de seu pr√≥prio protocolo de transporte baseado em UDP, pode come√ßar com o TCP ou uma biblioteca que fornece confiabilidade e, em seguida, testar e medir o desempenho.  Se voc√™ tiver problemas e tiver certeza de que o motivo est√° no protocolo de transporte, talvez seja a hora de criar seu pr√≥prio protocolo de transporte. </li></ul><br>  No final desta parte, recomendo que voc√™ leia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20190519135537/"><em>Introdu√ß√£o √† programa√ß√£o de jogos multiplayer de</em></a> Brian Hook, que aborda muitos dos t√≥picos discutidos aqui. <br><br><h1>  Protocolo de aplica√ß√£o </h1><br>  Agora que podemos trocar dados entre clientes e o servidor, precisamos decidir quais dados transferir e em qual formato. <br><br>  O esquema cl√°ssico √© que os clientes enviam entradas ou a√ß√µes ao servidor e o servidor envia o estado atual do jogo aos clientes. <br><br>  O servidor n√£o envia um estado completo, mas filtrado, com entidades pr√≥ximas ao player.  Ele faz isso por tr√™s raz√µes.  Primeiro, o estado geral pode ser muito grande para transmiss√£o de alta frequ√™ncia.  Em segundo lugar, os clientes est√£o interessados ‚Äã‚Äãprincipalmente em dados visuais e de √°udio, porque a maior parte da l√≥gica do jogo √© simulada no servidor do jogo.  Em terceiro lugar, em alguns jogos, o jogador n√£o precisa conhecer certos dados, por exemplo, a posi√ß√£o do oponente no outro extremo do mapa, porque, caso contr√°rio, ele pode cheirar pacotes e saber exatamente para onde se mover para mat√°-lo. <br><br><h2>  Serializa√ß√£o </h2><br>  O primeiro passo √© converter os dados que queremos enviar (estado de entrada ou jogo) em um formato adequado para transmiss√£o.  Esse processo √© chamado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>serializa√ß√£o</em></a> . <br><br>  Imediatamente se pensa em usar um formato leg√≠vel por humanos, como JSON ou XML.  Mas ser√° completamente ineficaz e em v√£o ocupar√° a maior parte do canal. <br><br>  Em vez disso, √© recomend√°vel usar um formato bin√°rio muito mais compacto.  Ou seja, os pacotes conter√£o apenas alguns bytes.  Aqui voc√™ precisa considerar o problema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>da ordem dos bytes</em></a> , que pode diferir em computadores diferentes. <br><br>  Voc√™ pode usar uma biblioteca para serializar dados, por exemplo: <br><br><ul><li>  Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FlatBuffers</a> </li><li>  Tempestade de areia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap'n Proto</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cereal por</a> Shane Grant e Randolph Voorhees </li></ul><br>  Apenas verifique se a biblioteca cria arquivos port√°teis e cuida da ordem dos bytes. <br><br>  Uma solu√ß√£o independente pode ser uma implementa√ß√£o independente, n√£o √© particularmente complicada, especialmente se voc√™ usar uma abordagem orientada a dados no c√≥digo.  Al√©m disso, permitir√° executar otimiza√ß√µes que nem sempre s√£o poss√≠veis ao usar a biblioteca. <br><br>  Glenn Fiedler escreveu dois artigos sobre serializa√ß√£o: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823004533/"><em>ler e escrever pacotes</em></a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823015044/"><em>estrat√©gias de serializa√ß√£o</em></a> . <br><br><h2>  Compress√£o </h2><br>  A quantidade de dados transferidos entre clientes e o servidor √© limitada pela largura de banda do canal.  A compacta√ß√£o de dados permite transferir mais dados em cada instant√¢neo, aumentar a taxa de atualiza√ß√£o ou simplesmente reduzir os requisitos de canal. <br><br><h3>  Bit embalagem </h3><br>  A primeira t√©cnica √© a embalagem de bits.  Consiste em usar exatamente o n√∫mero de bits necess√°rio para descrever o valor desejado.  Por exemplo, se voc√™ tiver uma enumera√ß√£o que possa ter 16 valores diferentes, em vez de um byte inteiro (8 bits), poder√° usar apenas 4 bits. <br><br>  Glenn Fiedler explica como implementar isso na segunda parte do artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823004533/"><em>Pacotes de leitura e grava√ß√£o</em></a> . <br><br>  O empacotamento de bits funciona especialmente bem com a amostragem, que ser√° o t√≥pico da pr√≥xima se√ß√£o. <br><br><h3>  Discretiza√ß√£o </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>A discretiza√ß√£o</em></a> √© uma t√©cnica de compacta√ß√£o com perdas que usa apenas um subconjunto dos valores poss√≠veis para codificar um valor.  A maneira mais f√°cil de implementar a discretiza√ß√£o √© arredondar n√∫meros de ponto flutuante. <br><br>  Glenn Fiedler (novamente!) Mostra como aplicar a amostragem na pr√°tica em seu artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823021121/">Snapshot Compression</a> . <br><br><h3>  Algoritmos de compress√£o </h3><br>  A pr√≥xima t√©cnica ser√£o algoritmos de compacta√ß√£o sem perdas. <br><br>  Aqui, na minha opini√£o, os tr√™s algoritmos mais interessantes que voc√™ precisa conhecer: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Codifica√ß√£o de Huffman</a> com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo</a> pr√©-calculado que √© extremamente r√°pido e pode dar bons resultados.  Foi usado para compactar pacotes no mecanismo de rede Quake3. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O zlib</a> √© um algoritmo de compacta√ß√£o de uso geral que nunca aumenta a quantidade de dados.  Como pode ser visto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> , ele tem sido usado em muitas aplica√ß√µes.  Pode ser redundante para atualizar estados.  Mas pode ser √∫til se voc√™ precisar enviar ativos, textos longos ou al√≠vio para os clientes a partir do servidor. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A c√≥pia de s√©ries</a> √© provavelmente o algoritmo de compacta√ß√£o mais simples, mas √© muito eficaz para determinados tipos de dados e pode ser usado como uma etapa de pr√©-processamento antes do zlib.  √â especialmente adequado para comprimir terrenos constitu√≠dos por ladrilhos ou voxels, nos quais muitos elementos vizinhos s√£o repetidos. </li></ul><br><h3>  Compress√£o delta </h3><br>  A t√©cnica de compacta√ß√£o mais recente √© a compacta√ß√£o delta.  Est√° no fato de que apenas diferen√ßas entre o estado atual do jogo e o √∫ltimo estado recebido pelo cliente s√£o transmitidas. <br><br>  Foi usado pela primeira vez no mecanismo de rede Quake3.  Aqui est√£o dois artigos que explicam como us√°-lo: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20190628180906/"><em>O modelo de rede Quake3 de</em></a> Brian Hook </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>Revis√£o do c√≥digo-fonte do Quake 3: modelo de rede</em></a> Fabien Sanglar [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tradu√ß√£o de</a> artigo sobre Habr√©, consulte a se√ß√£o "Modelo de rede"] </li></ul><br>  Glenn Fiedler tamb√©m o usou na segunda parte de seu artigo sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823021121/"><em>Snapshot Compression</em></a> . <br><br><h2>  Criptografia </h2><br>  Al√©m disso, pode ser necess√°rio criptografar a transfer√™ncia de informa√ß√µes entre clientes e o servidor.  Existem v√°rias raz√µes para isso: <br><br><ul><li>  privacidade / confidencialidade: as mensagens s√≥ podem ser lidas pelo destinat√°rio e nenhuma outra pessoa que cheira a rede pode l√™-las. </li><li>  autentica√ß√£o: uma pessoa que deseja desempenhar o papel de jogador deve conhecer sua chave. </li><li>  preven√ß√£o de trapa√ßa: ser√° muito mais dif√≠cil para jogadores mal-intencionados criarem seus pr√≥prios pacotes de trapa√ßa, eles ter√£o que reproduzir o esquema de criptografia e encontrar a chave (que muda a cada conex√£o). </li></ul><br>  Eu recomendo fortemente o uso da biblioteca para isso.  Eu sugiro usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">libsodium</a> porque √© especialmente simples e tem √≥timos tutoriais.  De particular interesse √© o tutorial de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">troca de chaves</a> , que permite gerar novas chaves a cada nova conex√£o. <br><br><h2>  Protocolo de Aplica√ß√£o: Conclus√£o </h2><br>  Terminaremos com o protocolo do aplicativo.  Acredito que a compacta√ß√£o √© completamente opcional e a decis√£o de us√°-la depende apenas do jogo e da largura de banda necess√°ria.  Criptografia, na minha opini√£o, √© obrigat√≥ria, mas no primeiro prot√≥tipo voc√™ pode ficar sem ela. <br><br><h1>  L√≥gica de aplica√ß√£o </h1><br>  Agora, podemos atualizar o estado no cliente, mas podemos encontrar problemas com atrasos.  Depois de entrar, o jogador precisa aguardar a atualiza√ß√£o do estado do jogo do servidor para ver qual o impacto que ele teve no mundo. <br><br>  Al√©m disso, entre duas atualiza√ß√µes de estado, o mundo √© completamente est√°tico.  Se a taxa de atualiza√ß√£o dos estados for baixa, os movimentos ficar√£o muito tr√™mulos. <br><br>  Existem v√°rias t√©cnicas para reduzir o impacto desse problema e, na pr√≥xima se√ß√£o, falarei sobre elas. <br><br><h2>  Atraso nas t√©cnicas de suaviza√ß√£o </h2><br>  Todas as t√©cnicas descritas nesta se√ß√£o s√£o discutidas em detalhes na s√©rie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>Multiplayer em ritmo acelerado, de</em></a> Gabriel Gambetta.  Eu recomendo a leitura desta grande s√©rie de artigos.  Ele tamb√©m possui uma demonstra√ß√£o interativa que permite ver como essas t√©cnicas funcionam na pr√°tica. <br><br>  A primeira t√©cnica √© aplicar a entrada diretamente, sem aguardar uma resposta do servidor.  Isso √© chamado <em>de previs√£o do lado do cliente</em> .  No entanto, quando o cliente recebe a atualiza√ß√£o do servidor, ele deve verificar se sua previs√£o estava correta.  Se n√£o for assim, ele s√≥ precisar√° alterar seu estado de acordo com o recebido do servidor, porque o servidor √© autorit√°rio.  Esta t√©cnica foi usada pela primeira vez no Quake.  Voc√™ pode ler mais sobre isso no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em>Revis√£o do c√≥digo do Quake Engine por</em></a> Fabien Sanglar [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tradu√ß√£o</a> para Habr√©]. <br><br>  O segundo conjunto de t√©cnicas √© usado para facilitar a movimenta√ß√£o de outras entidades entre duas atualiza√ß√µes de estado.  Existem duas maneiras de resolver esse problema: interpola√ß√£o e extrapola√ß√£o.  No caso de interpola√ß√£o, os dois √∫ltimos estados s√£o tomados e a transi√ß√£o de um para o outro √© mostrada.  Sua desvantagem √© que causa uma pequena fra√ß√£o do atraso, porque o cliente sempre v√™ o que aconteceu no passado.  A extrapola√ß√£o est√° prevendo onde as entidades agora devem se basear no √∫ltimo estado recebido pelo cliente.  Sua desvantagem √© que, se a entidade mudar completamente a dire√ß√£o do movimento, haver√° um grande erro entre a previs√£o e a posi√ß√£o real. <br><br>  A √∫ltima t√©cnica mais avan√ßada, √∫til apenas no FPS √© a <em>compensa√ß√£o de atraso</em> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao usar a compensa√ß√£o de atraso, o servidor leva em considera√ß√£o os atrasos do cliente quando dispara em um alvo. Por exemplo, se um jogador completou um tiro na cabe√ßa em sua tela, mas, na realidade, seu objetivo foi devido a um atraso em outro lugar, seria desonesto negar a um jogador o direito de matar por causa de um atraso. Portanto, o servidor retrocede o tempo at√© o momento em que o jogador disparou para simular o que o jogador viu na tela e verificar a colis√£o entre o tiro e o alvo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Glenn Fiedler (como sempre!) Escreveu um artigo de 2004 na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823005028/"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Network Physics (2004)</font></font></em></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que lan√ßou as bases para sincronizar simula√ß√µes de f√≠sica entre um servidor e um cliente. Em 2014, ele escreveu uma nova s√©rie de artigos de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823004853/"><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Networking Physics</font></font></em></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que descreviam outras t√©cnicas para sincronizar simula√ß√µes de f√≠sica.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem tamb√©m dois artigos no wiki da Valve, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rede de Multijogadores de Origem</font></font></em></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todos de Compensa√ß√£o de Lat√™ncia no Projeto e Otimiza√ß√£o de Protocolo no Jogo Cliente / Servidor</font></font></em></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que discutem a compensa√ß√£o de atraso.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preven√ß√£o de trapa√ßa </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem duas t√©cnicas principais para evitar trapa√ßas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeiro: complicar o envio de pacotes maliciosos por trapaceiros. </font><font style="vertical-align: inherit;">Como mencionado acima, a criptografia √© uma boa maneira de implement√°-la. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segundo: um servidor autorit√°rio deve receber apenas comandos / entradas / a√ß√µes. </font><font style="vertical-align: inherit;">O cliente n√£o deve poder alterar o estado no servidor, exceto enviando entrada. </font><font style="vertical-align: inherit;">Ent√£o, toda vez que a entrada √© recebida, o servidor deve verificar sua validade antes de aplic√°-la.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L√≥gica de Aplica√ß√£o: Conclus√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu recomendo que voc√™ implemente um m√©todo de simular grandes atrasos e baixas taxas de atualiza√ß√£o para poder testar o comportamento do seu jogo em condi√ß√µes prec√°rias, mesmo quando o cliente e o servidor estiverem executando no mesmo computador. </font><font style="vertical-align: inherit;">Isso simplificar√° bastante a implementa√ß√£o de t√©cnicas de suaviza√ß√£o de retardo.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outros recursos √∫teis </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Se voc√™ deseja explorar outros recursos nos modelos de rede, pode encontr√°-los aqui: </font></font><br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20190328001900/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blog de Glenn Fiedler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - vale a pena ler o blog inteiro, possui muitos √≥timos artigos. </font><font style="vertical-align: inherit;">Todos os artigos sobre tecnologias de rede </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823014743/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coletados </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://web.archive.org/web/20180823014743/"><font style="vertical-align: inherit;">aqui</font></a><font style="vertical-align: inherit;"> .</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Awesome Game Networking</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de M. Fatih MAR √© uma lista detalhada de artigos e v√≠deos sobre os mecanismos de rede de videogames.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki do r / gamedev subreddit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tamb√©m possui muitos links √∫teis.</font></font></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt467025/">https://habr.com/ru/post/pt467025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt467015/index.html">JWT: ataque de assinatura digital vs ataque de MAC</a></li>
<li><a href="../pt467017/index.html">O que √© o HED / MRSD e para que serve?</a></li>
<li><a href="../pt467019/index.html">Projetando pain√©is para o site de com√©rcio eletr√¥nico de an√°lise da web. Parte 3: Canal SEO</a></li>
<li><a href="../pt467021/index.html">Como o rob√¥ da consci√™ncia se comunica com os clientes</a></li>
<li><a href="../pt467023/index.html">Criamos um plugin na Grafana para monitorar o k8s: j√° na loja oficial da Grafana</a></li>
<li><a href="../pt467029/index.html">Grigory Petrov: trabalhando com uma rede em Ruby</a></li>
<li><a href="../pt467033/index.html">Uma sele√ß√£o de artigos t√©cnicos interessantes do Chaos Communication Camp 2019</a></li>
<li><a href="../pt467035/index.html">Projetando pain√©is para o site de com√©rcio eletr√¥nico de an√°lise da web. Parte 4: Canal do Youtube</a></li>
<li><a href="../pt467037/index.html">Factoring: como conseguir dinheiro para cadeiras</a></li>
<li><a href="../pt467039/index.html">Como conduzir uma revis√£o de c√≥digo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>