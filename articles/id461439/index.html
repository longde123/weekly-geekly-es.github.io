<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ¼ ğŸ‘‹ğŸ¼ ğŸ‘ğŸ¼ Memulai perpustakaan komponen React dan TypeScript ğŸ§‘ğŸ»â€ğŸ¤â€ğŸ§‘ğŸ» ğŸ™…ğŸ¾ ğŸšµğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagian besar pekerjaan saya, saya menulis backend, tetapi beberapa hari yang lalu ada tugas untuk memulai perpustakaan komponen pada React. Beberapa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memulai perpustakaan komponen React dan TypeScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461439/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/57/zc/nc57zcknvdousryimpgxxqsiz1i.jpeg"></div><br><p>  Sebagian besar pekerjaan saya, saya menulis backend, tetapi beberapa hari yang lalu ada tugas untuk memulai perpustakaan komponen pada React.  Beberapa tahun yang lalu, ketika versi Bereaksi adalah sekecil pengalaman saya dalam pengembangan front-end, saya sudah mengambil pendekatan untuk proyektil dan ternyata dengan kikuk dan kikuk.  Dengan mempertimbangkan kematangan ekosistem Bereaksi saat ini dan pengalaman saya yang berkembang, saya terinspirasi kali ini untuk melakukan semuanya dengan baik dan nyaman.  Sebagai hasilnya, saya memiliki blank untuk perpustakaan masa depan, dan agar tidak melupakan apa pun dan mengumpulkan semuanya di satu tempat, artikel lembar contekan ini ditulis, yang juga akan membantu mereka yang tidak tahu harus mulai dari mana.  Mari kita lihat apa yang saya lakukan. </p><a name="habracut"></a><br><p>  <strong><em>TL / DR: Kode untuk pustaka siap-pakai dapat dilihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a></em></strong> </p><br><p>  Masalahnya dapat didekati dari dua sisi: </p><br><ol><li>  Temukan starter-kit, boilerplate atau generator cli yang sudah jadi </li><li>  Kumpulkan semuanya sendiri </li></ol><br><p>  Metode pertama baik untuk memulai dengan cepat, ketika Anda benar-benar tidak ingin berurusan dengan mengkonfigurasi dan menghubungkan paket-paket yang diperlukan.  Juga, opsi ini cocok untuk pemula yang tidak tahu harus mulai dari mana dan apa perbedaan antara perpustakaan dan aplikasi reguler. </p><br><p>  Pada awalnya saya pergi dengan cara pertama, tetapi kemudian saya memutuskan untuk memperbarui dependensi dan mempercepat beberapa paket, dan kemudian semua jenis kesalahan dan inkonsistensi dihujani.  Akibatnya, ia menyingsingkan lengan bajunya dan melakukan semuanya sendiri.  Tapi saya akan menyebutkan generator perpustakaan. </p><br><h2 id="create-react-library">  Buat pustaka reaksi </h2><br><p>  Sebagian besar pengembang yang berurusan dengan React telah mendengar tentang starter aplikasi React yang nyaman yang memungkinkan Anda untuk meminimalkan konfigurasi proyek dan memberikan default yang masuk akal - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Create React App</a> (CRA).  Pada prinsipnya, ini bisa digunakan untuk perpustakaan ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ada artikel tentang HabrÃ©</a> ).  Namun, struktur proyek dan pendekatan untuk pengembangan ui-kit sedikit berbeda dari SPA biasa.  Kita memerlukan direktori terpisah dengan kode sumber komponen (src), kotak pasir untuk pengembangan dan debugging (contoh), alat dokumentasi dan demonstrasi ("showcase") dan direktori terpisah dengan file yang disiapkan untuk ekspor (dist).  Juga, komponen perpustakaan tidak akan ditambahkan ke aplikasi SPA, tetapi akan diekspor melalui file indeks.  Memikirkannya, saya pergi mencari dan dengan cepat menemukan paket CRA serupa - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Creat React Library</a> (CRL). </p><br><p>  CRL, seperti CRA, adalah utilitas CLI yang "mudah digunakan".  Dengan menggunakannya, Anda dapat menghasilkan proyek.  Ini akan berisi: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Rollup yang</a> dikonfigurasi untuk membangun modul cjs dan es dan peta sumber dengan dukungan untuk modul css </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">babel</a> untuk transpilasi dalam ES5 </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bercanda</a> untuk tes </li><li>  KetikScript (TS) sebagai opsi yang ingin kita gunakan </li></ul><br><p>  Untuk menghasilkan proyek perpustakaan, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kita</a> dapat melakukannya ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">npx</a> memungkinkan kita untuk tidak menginstal paket secara global): </p><br><pre><code class="bash hljs">npx create-react-library</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Kami menjawab pertanyaan yang diajukan.</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/wd/ql/qq/wdqlqqfmjrgntiqz6zphcdyccdw.png" alt="Pertanyaan CLR"></p></div></div><br><p>  Dan sebagai hasil dari utilitas, kami mendapatkan proyek perpustakaan komponen yang dihasilkan dan siap-pakai. </p><br><div class="spoiler">  <b class="spoiler_title">Dengan struktur tertentu</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/vs/d4/l2/vsd4l2o2g1wn3n0folb_yr30ui8.png" alt="Pohon clr"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Dan kemudian ada yang tidak beres ...</b> <div class="spoiler_text"><p>  Dependensi agak ketinggalan zaman hari ini, jadi saya memutuskan untuk memperbarui semuanya ke versi terbaru menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">npm-check</a> : </p><br><pre> <code class="bash hljs">npx npm-check -u</code> </pre> <br><p>  Fakta menyedihkan lainnya adalah bahwa aplikasi sandbox di direktori <code>example</code> dihasilkan dalam js.  Anda harus menulis ulang secara manual ke TypeScript, menambahkan <code>tsconfig.json</code> dan beberapa dependensi (misalnya, <code>typescript</code> sendiri dan <code>@types</code> dasar). </p><br><p>  Juga paket <code>react-scripts-ts</code> dinyatakan <code>deprecated</code> dan tidak lagi didukung.  Sebagai gantinya, Anda harus menginstal <code>react-scripts</code> , karena untuk beberapa saat sekarang CRA (yang paket <code>react-scripts</code> reaksinya) mendukung TypeScript dari kotak (menggunakan Babel 7). </p><br><p>  Akibatnya, saya tidak menguasai cara menarik <code>react-scripts</code> pada gagasan saya tentang perpustakaan.  Sejauh yang saya ingat, Jest dari paket ini membutuhkan opsi compiler <code>isolatedModules</code> <code>d.ts</code> , yang bertentangan dengan keinginan saya untuk menghasilkan dan mengekspor <code>d.ts</code> dari perpustakaan (semua ini entah bagaimana terkait dengan keterbatasan Babel 7, yang digunakan oleh Jest dan <code>react-scripts</code> untuk mengkompilasi TS )  Jadi saya membuat <code>eject</code> untuk <code>react-scripts</code> , melihat hasilnya dan merapikan semuanya dengan tangan saya, yang akan saya tulis nanti. </p></div></div><br><h2 id="tsdx">  tsdx </h2><br><p>  Terima kasih kepada pengguna <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">StanEgo</a> , yang berbicara tentang alternatif yang sangat baik untuk Buat React Library - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tsdx</a> .  Cli-utility ini juga mirip dengan CRA dan dalam satu perintah akan menciptakan dasar untuk perpustakaan Anda dengan Rollup, TS, Prettier, husky, Jest dan React yang sudah dikonfigurasi.  Dan Bereaksi datang sebagai opsi.  Cukup sederhana untuk dilakukan: </p><br><pre> <code class="bash hljs">npx tsdx create mytslib</code> </pre> <br><p>  Dan sebagai hasilnya, versi segar dari paket yang diperlukan akan diinstal dan semua pengaturan dibuat.  Dapatkan proyek seperti CRL.  Perbedaan utama dari CRL adalah Zero-config.  Yaitu, konfigurasi Rollup disembunyikan dari kami di tsdx (sama seperti CRA). </p><br><p>  Setelah menjalankan dokumentasi dengan cepat, saya tidak menemukan metode yang disarankan untuk konfigurasi yang lebih baik atau sesuatu seperti eject seperti pada CRA.  Setelah melihat masalah proyek, saya menemukan bahwa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sejauh ini tidak ada kemungkinan seperti itu</a> .  Untuk beberapa proyek, ini bisa menjadi kritis, dalam hal ini Anda harus bekerja sedikit dengan tangan Anda.  Jika Anda tidak membutuhkannya, maka tsdx adalah cara yang bagus untuk memulai dengan cepat. </p><br><h2 id="beryom-upravlenie-v-svoi-ruki">  Kendalikan ke tangan kita sendiri </h2><br><p>  Tetapi bagaimana jika Anda pergi ke jalan kedua dan mengumpulkan semuanya sendiri?  Jadi, mari kita mulai dari awal.  Jalankan <code>npm init</code> dan hasilkan <code>package.json</code> untuk pustaka.  Tambahkan beberapa informasi tentang paket kami di sana.  Sebagai contoh, kami menulis versi minimum untuk node dan npm di bidang <code>engines</code> .  File yang dikumpulkan dan diekspor akan ditempatkan di direktori <code>dist</code> .  Kami menunjukkan ini di bidang <code>files</code> .  Kami membuat pustaka komponen reaksi, jadi kami bergantung pada pengguna untuk memiliki paket yang diperlukan - kami <code>peerDependencies</code> dalam bidang <code>peerDependencies</code> versi minimum versi <code>react</code> dan <code>react-dom</code> . </p><br><p>  Sekarang instal paket <code>react</code> dan <code>react-dom</code> dan tipe yang diperlukan (karena kita akan melihat komponen pada TypeScript) sebagai devDependencies (seperti semua paket di artikel ini): </p><br><pre> <code class="bash hljs">npm install --save-dev react react-dom @types/react @types/react-dom</code> </pre> <br><p>  Pasang TypeScript: </p><br><pre> <code class="bash hljs">npm install --save-dev typescript</code> </pre> <br><p>  Mari kita buat file konfigurasi untuk kode utama dan tes: <code>tsconfig.json</code> dan <code>tsconfig.test.json</code> .  <code>target</code> kami akan di <code>es5</code> , kami akan menghasilkan <code>sourceMap</code> , dll.  Daftar lengkap opsi yang memungkinkan dan artinya dapat ditemukan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> .  Jangan lupa untuk <code>include</code> direktori sumber di dalam <code>include</code> , dan tambahkan <code>node_modules</code> dan direktori <code>dist</code> dalam <code>exclude</code> .  Di <code>package.json</code> kami mengindikasikan di bidang <code>typings</code> tempat untuk mendapatkan tipe untuk pustaka kami - <code>dist/index</code> . </p><br><p>  Buat direktori <code>src</code> untuk komponen sumber perpustakaan.  Tambahkan segala macam hal kecil, seperti <code>.gitignore</code> , <code>.editorconfig</code> , file dengan lisensi dan <code>README.md</code> . </p><br><h3 id="rollup">  Rollup </h3><br><p>  Kami akan menggunakan Rollup untuk perakitan, seperti yang disarankan oleh CRL.  Paket dan konfigurasi yang diperlukan, saya juga memata-matai CRL.  Secara umum, saya mendengar pendapat bahwa Rollup baik untuk perpustakaan, dan Webpack untuk aplikasi.  Namun, saya tidak mengkonfigurasi Webpack (apa yang CRA lakukan untuk saya), tetapi Rollup benar-benar bagus, sederhana dan indah. </p><br><p>  Pasang: </p><br><pre> <code class="bash hljs">npm install --save-dev rollup rollup-plugin-babel rollup-plugin-commonjs rollup-plugin-node-resolve rollup-plugin-peer-deps-external rollup-plugin-postcss rollup-plugin-typescript2 rollup-plugin-url @svgr/rollup</code> </pre> <br><p>  Di <code>package.json</code> tambahkan bidang dengan distribusi kumpulan pustaka yang dikumpulkan, seperti yang disarankan <code>rollup</code> kepada kami - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pkg.module</a> : </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"module"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span>, <span class="hljs-string"><span class="hljs-string">"jsnext:main"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/index.es.js"</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Buat file konfigurasi rollup.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> typescript <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-typescript2'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> commonjs <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-commonjs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> external <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-peer-deps-external'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> postcss <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-postcss'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> resolve <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-node-resolve'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> url <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'rollup-plugin-url'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> svgr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@svgr/rollup'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pkg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./package.json'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> { <span class="hljs-attr"><span class="hljs-attr">input</span></span>: <span class="hljs-string"><span class="hljs-string">'src/index.tsx'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.main, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'cjs'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">file</span></span>: pkg.module, <span class="hljs-attr"><span class="hljs-attr">format</span></span>: <span class="hljs-string"><span class="hljs-string">'es'</span></span>, <span class="hljs-attr"><span class="hljs-attr">exports</span></span>: <span class="hljs-string"><span class="hljs-string">'named'</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourcemap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ external(), postcss({ <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">extract</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">minimize</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">sourceMap</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), url(), svgr(), resolve(), typescript({ <span class="hljs-attr"><span class="hljs-attr">rollupCommonJSResolveHack</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">clean</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }), commonjs() ] };</code> </pre> </div></div><br><p>  Konfigurasi adalah file js, atau lebih tepatnya objek yang diekspor.  Di bidang <code>input</code> , tentukan file tempat ekspor untuk perpustakaan kami terdaftar.  <code>output</code> - menggambarkan harapan kami pada output - di mana modul untuk dikompilasi dalam format dan di mana meletakkannya. </p><br><div class="spoiler">  <b class="spoiler_title">Selanjutnya muncul bidang dengan daftar dan konfigurasi plugin</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-peer-deps-external</a> - memungkinkan Anda untuk mengecualikan <code>peerDependencies</code> dari <code>bundle</code> untuk mengurangi ukurannya.  Ini masuk akal, karena <code>peerDependencies</code> diharapkan dari pengguna perpustakaan. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-postcss</a> - mengintegrasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PostCss</a> dan Rollup.  Di sini kita menonaktifkan css-modules, termasuk css dalam paket ekspor dari pustaka kita, memperkecil dan mengaktifkan pembuatan sourceMap.  Jika Anda tidak mengekspor css selain yang digunakan oleh komponen perpustakaan, maka <code>extract</code> dapat dihindari - css yang diperlukan dalam komponen akan ditambahkan ke tag kepala pada halaman sebagaimana diperlukan pada akhirnya.  Namun, dalam kasus saya, perlu untuk mendistribusikan beberapa css tambahan (kotak, warna, dll), dan klien harus secara eksplisit menghubungkan perpustakaan css-bundle ke dirinya sendiri. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-url</a> - memungkinkan Anda untuk mengekspor berbagai sumber daya, seperti gambar </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">svgr</a> - mengubah svg menjadi komponen Bereaksi </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-node-</a> resol - menentukan lokasi modul pihak ketiga di node_modules </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-typescript2</a> - menghubungkan compiler TypeScript dan menyediakan kemampuan untuk mengkonfigurasinya </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">rollup-plugin-commonjs</a> - mengonversi modul dependensi commonjs menjadi modul sehingga dapat dimasukkan dalam bundel </li></ul></div></div><br><p>  Tambahkan perintah di bidang <code>scripts</code> <code>package.json</code> untuk membangun ( <code>"build": "rollup -c"</code> ) dan mulai perakitan dalam mode-menonton selama pengembangan ( <code>"start": "rollup -c -w &amp;&amp; npm run prettier-watch"</code> ) . </p><br><h3 id="pervyy-komponent-i-eksportnyy-fayl">  Komponen pertama dan ekspor file </h3><br><p>  Sekarang kita akan menulis komponen reaksi paling sederhana untuk memeriksa cara kerja perakitan kami.  Setiap komponen di pustaka akan ditempatkan di direktori terpisah di direktori induk - <code>src/components/ExampleComponent</code> .  Direktori ini akan berisi semua file yang terkait dengan komponen - <code>tsx</code> , <code>css</code> , <code>test.tsx</code> dan sebagainya. <br>  Mari kita membuat beberapa file gaya untuk komponen dan file <code>tsx</code> dari komponen itu sendiri. </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class ExampleComponent */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface Props { <span class="hljs-comment"><span class="hljs-comment">/** * Simple text prop **/</span></span> text: string; } <span class="hljs-comment"><span class="hljs-comment">/** My First component */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExampleComponent</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Props</span></span></span><span class="hljs-class">&gt; </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { text } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"test"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Example Component: {text} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Coool!</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">p</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ExampleComponent;</code> </pre> </div></div><br><p>  Juga di <code>src</code> Anda perlu membuat file dengan tipe yang umum untuk perpustakaan, di mana suatu tipe akan dideklarasikan untuk css dan svg (diintip di CRL). </p><br><div class="spoiler">  <b class="spoiler_title">typings.d.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * Default CSS definition for typescript, * will be overridden with file-specific definitions by rollup */</span></span> declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.css'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> content: { [className: string]: string }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> content; } interface SvgrComponent extends React.FunctionComponent&lt;React.SVGAttributes&lt;SVGElement&gt;&gt; {} declare <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> <span class="hljs-string"><span class="hljs-string">'*.svg'</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgUrl: string; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> svgComponent: SvgrComponent; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> svgUrl; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { svgComponent <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactComponent }; }</code> </pre> </div></div><br><p>  Semua komponen dan css yang diekspor harus ditentukan dalam file ekspor.  Kami memilikinya - <code>src/index.tsx</code> .  Jika beberapa css tidak digunakan dalam proyek dan tidak terdaftar sebagai bagian dari yang diimpor ke <code>src/index.tsx</code> , maka akan dibuang dari majelis, yang baik-baik saja. </p><br><div class="spoiler">  <b class="spoiler_title">src / index.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent, Props } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'./export.css'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { ExampleComponent, Props };</code> </pre> </div></div><br><p>  Sekarang Anda dapat mencoba membangun pustaka - <code>npm run build</code> .  Sebagai hasilnya, <code>rollup</code> memulai dan mengumpulkan pustaka kita menjadi bundel, yang akan kita temukan di direktori <code>dist</code> . </p><br><p>  Selanjutnya, kami menambahkan beberapa alat untuk meningkatkan kualitas proses pengembangan kami dan hasilnya. </p><br><h3 id="zabyvaem-o-formatirovanii-koda-s-prettier">  Lupa pemformatan kode dengan Prettier </h3><br><p>  Saya benci dalam review kode untuk menunjukkan format yang ceroboh atau tidak standar untuk sebuah proyek, dan bahkan lebih memperdebatkannya.  Kelemahan seperti itu secara alami harus diperbaiki, tetapi pengembang harus fokus pada apa dan bagaimana kode dilakukan, bukan pada tampilannya.  Perbaikan ini adalah kandidat pertama untuk otomatisasi.  Ada paket bagus untuk tugas ini - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lebih cantik</a> .  Pasang itu: </p><br><pre> <code class="bash hljs">npm install --save-dev prettier</code> </pre> <br><p>  Tambahkan konfigurasi untuk sedikit perbaikan aturan pemformatan. </p><br><div class="spoiler">  <b class="spoiler_title">.prettierrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"tabWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"singleQuote"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"jsxBracketSameLine"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"arrowParens"</span></span>: <span class="hljs-string"><span class="hljs-string">"always"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"printWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"semi"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bracketSpacing"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }</code> </pre> </div></div><br><p>  Anda dapat melihat arti dari aturan yang tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> .  WebStrom setelah membuat file konfigurasi itu sendiri akan menyarankan menggunakan <code>prettier</code> ketika mulai memformat melalui IDE.  Untuk mencegah pemformatan menghabiskan waktu, tambahkan <code>/node_modules</code> dan <code>/dist</code> ke pengecualian menggunakan file <code>.prettierignore</code> (formatnya mirip dengan <code>.gitignore</code> ).  Sekarang Anda dapat menjalankan <code>prettier</code> dengan menerapkan aturan pemformatan ke kode sumber: </p><br><pre> <code class="bash hljs">prettier --write <span class="hljs-string"><span class="hljs-string">"**/*"</span></span></code> </pre> <br><p>  Agar tidak menjalankan perintah secara eksplisit setiap kali dengan tangan Anda dan untuk memastikan bahwa kode dari pengembang proyek lainnya juga akan diformat <code>prettier</code> , tambahkan proses yang <code>prettier</code> pada <code>precommit-hook</code> untuk file yang ditandai sebagai <code>staged</code> (via <code>git add</code> ).  Untuk itu, kita perlu dua alat.  Pertama, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hasky</a> , bertanggung jawab untuk menjalankan perintah apa pun sebelum melakukan, mendorong, dll.  Dan kedua, ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">lint-bertahap</a> , yang dapat menjalankan berbagai linter pada file <code>staged</code> .  Kita hanya perlu menjalankan satu baris untuk mengirimkan paket-paket ini dan menambahkan perintah peluncuran ke <code>package.json</code> : </p><br><pre> <code class="bash hljs">npx mrm lint-staged</code> </pre> <br><p>  Kami tidak bisa menunggu untuk memformat sebelum melakukan, tetapi pastikan bahwa <code>prettier</code> terus bekerja pada file yang dimodifikasi dalam proses pekerjaan kami.  Ya, kami membutuhkan paket lain - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">onchange</a> .  Ini memungkinkan Anda untuk memantau perubahan pada file dalam proyek dan segera menjalankan perintah yang diperlukan untuk mereka.  Pasang: </p><br><pre> <code class="bash hljs">npm install --save-dev --save-exact onchange</code> </pre> <br><p>  Kemudian kita menambahkan perintah bidang <code>scripts</code> di <code>package.json</code> : </p><br><pre> <code class="json hljs"><span class="hljs-string"><span class="hljs-string">"prettier-watch"</span></span>: <span class="hljs-string"><span class="hljs-string">"onchange 'src/**/*' -- prettier --write {{changed}}"</span></span></code> </pre> <br><p>  Mengenai hal ini, semua perselisihan tentang pemformatan dalam proyek dapat dianggap ditutup. </p><br><h3 id="izbegaem-oshibok-s-eslint">  Menghindari Kesalahan dengan ESLint </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ESLint</a> telah lama menjadi standar dan dapat ditemukan di hampir semua proyek js dan ts.  Dia akan membantu kita juga.  Dalam konfigurasi ESLint, saya percaya CRA, jadi ambil saja paket yang diperlukan dari CRA dan colokkan ke pustaka kami.  Selain itu, tambahkan konfigurasi untuk TS dan <code>prettier</code> (untuk menghindari konflik antara <code>ESLint</code> dan <code>prettier</code> ): </p><br><pre> <code class="bash hljs">npm install --save-dev eslint eslint-config-react-app eslint-loader eslint-plugin-flowtype eslint-plugin-import eslint-plugin-jsx-a11y eslint-plugin-react eslint-plugin-react-hooks @typescript-eslint/eslint-plugin @typescript-eslint/parser babel-eslint eslint-config-prettier eslint-plugin-prettier</code> </pre> <br><p>  <code>ESLint</code> menggunakan file konfigurasi. </p><br><div class="spoiler">  <b class="spoiler_title">.eslintrc.json</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"extends"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"plugin:@typescript-eslint/recommended"</span></span>, <span class="hljs-string"><span class="hljs-string">"react-app"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier"</span></span>, <span class="hljs-string"><span class="hljs-string">"prettier/@typescript-eslint"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"@typescript-eslint"</span></span>, <span class="hljs-string"><span class="hljs-string">"react"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"rules"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/no-empty-interface"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-function-return-type"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@typescript-eslint/explicit-member-accessibility"</span></span>: <span class="hljs-string"><span class="hljs-string">"off"</span></span> } }</code> </pre> </div></div><br><p>  Tambahkan perintah <code>lint</code> - <code>eslint src/**/* --ext .ts,.tsx --fix</code> ke bidang <code>scripts</code> dari <code>package.json</code> .  Sekarang Anda dapat menjalankan eslint melalui <code>npm run lint</code> . </p><br><h3 id="testiruem-s-jest">  Menguji dengan Jest </h3><br><p>  Untuk menulis unit test untuk komponen pustaka, instal dan konfigurasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jest</a> , pustaka pengujian dari facebook.  Namun sejak itu  kita mengkompilasi TS bukan melalui babel 7, tetapi melalui tsc, maka kita perlu menginstal paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ts-jest</a> juga: </p><br><pre> <code class="bash hljs">npm install --save-dev jest ts-jest @types/jest</code> </pre> <br><p>  Agar lelucon menerima impor css atau file lain dengan benar, Anda harus menggantinya dengan mokami.  Buat direktori <code>__mocks__</code> dan buat dua file di sana. <br>  <code>styleMock.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = {};</code> </pre> <br><p>  <code>fileMock.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-string"><span class="hljs-string">'test-file-stub'</span></span>;</code> </pre> <br><p>  Sekarang buat konfigurasi gurauan. </p><br><div class="spoiler">  <b class="spoiler_title">jest.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">preset</span></span>: <span class="hljs-string"><span class="hljs-string">'ts-jest'</span></span>, <span class="hljs-attr"><span class="hljs-attr">testEnvironment</span></span>: <span class="hljs-string"><span class="hljs-string">'node'</span></span>, <span class="hljs-attr"><span class="hljs-attr">moduleNameMapper</span></span>: { <span class="hljs-string"><span class="hljs-string">'\\.(css|less|sass|scss)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/styleMock.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'\\.(gif|ttf|eot|svg)$'</span></span>: <span class="hljs-string"><span class="hljs-string">'&lt;rootDir&gt;/__mocks__/fileMock.ts'</span></span> } };</code> </pre> </div></div><br><p>  Kami akan menulis tes paling sederhana untuk <code>ExampleComponent</code> kami di direktori-nya. </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.test.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'is truthy'</span></span>, () =&gt; { expect(ExampleComponent).toBeTruthy(); }); });</code> </pre> </div></div><br><p>  Tambahkan <code>test</code> - <code>npm run lint &amp;&amp; jest</code> perintah <code>npm run lint &amp;&amp; jest</code> ke bidang <code>scripts</code> <code>package.json</code> .  Untuk keandalan, kami juga akan menggerakkan linter.  Sekarang Anda dapat menjalankan tes kami dan memastikan mereka lulus - <code>npm run test</code> .  Dan agar tes tidak jatuh ke <code>dist</code> selama perakitan, tambahkan bidang <code>exclude</code> di plugin konfigurasi <code>Rollup</code> untuk <code>exclude</code> - <code>['src/**/*.test.(tsx|ts)']</code> .  Tentukan tes yang berjalan dalam <code>husky pre-commit hook</code> sebelum menjalankan <code>lint-staged</code> - <code>"pre-commit": "npm run test &amp;&amp; lint-staged"</code> . </p><br><h3 id="razrabatyvaem-dokumentiruem-i-lyubuemsya-komponentami-s-storybook">  Merancang, mendokumentasikan, dan mengagumi komponen dengan Storybook </h3><br><p>  Setiap perpustakaan membutuhkan dokumentasi yang baik untuk penggunaannya yang sukses dan produktif.  Adapun perpustakaan komponen antarmuka, tidak hanya saya ingin membaca tentang mereka, tetapi juga untuk melihat tampilannya, dan yang terbaik adalah menyentuh dan mengubahnya.  Untuk mendukung Daftar Keinginan tersebut, ada beberapa solusi.  Saya dulu menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Styleguidist</a> .  Paket ini memungkinkan Anda untuk menulis dokumentasi dalam format penurunan harga, serta menyisipkan contoh komponen Bereaksi yang dijelaskan di dalamnya.  Selanjutnya, dokumentasi dikumpulkan dan darinya diperoleh katalog situs-showcase, di mana Anda dapat menemukan komponen, membaca dokumentasi tentangnya, mencari tahu tentang parameternya, dan juga menyodokkan tongkat ke dalamnya. </p><br><p>  Namun, kali ini saya memutuskan untuk melihat lebih dekat kompetitornya - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Storybook</a> .  Saat ini sepertinya lebih kuat dengan sistem plugin-nya.  Selain itu, ia terus berkembang, memiliki komunitas besar, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">akan segera</a> mulai membuat halaman dokumentasinya menggunakan file penurunan harga.  Keuntungan lain dari Storybook adalah itu adalah kotak pasir - lingkungan untuk pengembangan komponen yang terisolasi.  Ini berarti bahwa kita tidak memerlukan aplikasi sampel lengkap untuk pengembangan komponen (seperti yang disarankan CRL).  Dalam buku cerita kami menulis <code>stories</code> - file ts di mana kami mentransfer komponen kami dengan beberapa <code>props</code> input ke fungsi khusus (lebih baik untuk melihat kode untuk membuatnya lebih jelas).  Akibatnya, aplikasi showcase dikumpulkan dari <code>stories</code> - <code>stories</code> ini. </p><br><p>  Jalankan skrip yang menginisialisasi buku cerita: </p><br><pre> <code class="bash hljs">npx -p @storybook/cli sb init</code> </pre> <br><p>  Sekarang berteman dengan TS.  Untuk melakukan ini, kita memerlukan beberapa paket lagi, dan pada saat yang sama kita akan menambahkan beberapa add-on yang bermanfaat: </p><br><pre> <code class="bash hljs">npm install --save-dev awesome-typescript-loader @types/storybook__react @storybook/addon-info react-docgen-typescript-loader @storybook/addon-actions @storybook/addon-knobs @types/storybook__addon-info @types/storybook__addon-knobs webpack-blocks</code> </pre> <br><p>  Script membuat direktori dengan konfigurasi <code>storybook</code> - <code>.storybook</code> dan contoh direktori yang kami hapus dengan kejam.  Dan di direktori konfigurasi kita mengubah <code>addons</code> ekstensi dan <code>config</code> ke <code>ts</code> .  Kami menambahkan addons ke file <code>addons.ts</code> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-actions/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-links/register'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/register'</span></span>;</code> </pre> <br><p>  Sekarang, Anda perlu membantu buku cerita menggunakan konfigurasi webpack di direktori <code>.storybook</code> . </p><br><div class="spoiler">  <b class="spoiler_title">webpack.config.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ config }</span></span></span><span class="hljs-function">) =&gt;</span></span> { config.module.rules.push({ <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(ts|tsx)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>.resolve(<span class="hljs-string"><span class="hljs-string">'awesome-typescript-loader'</span></span>) }, <span class="hljs-comment"><span class="hljs-comment">// Optional { loader: require.resolve('react-docgen-typescript-loader') } ] }); config.resolve.extensions.push('.ts', '.tsx'); return config; };</span></span></code> </pre> </div></div><br><p>  Mari kita sedikit mengubah <code>config.ts</code> config, menambahkan dekorator untuk menghubungkan add-on ke semua cerita kita. </p><br><div class="spoiler">  <b class="spoiler_title">config.ts</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { configure } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { addDecorator } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withInfo } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-info'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withKnobs } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// automatically import all files ending in *.stories.tsx const req = require.context('../src', true, /\.stories\.tsx$/); function loadStories() { req.keys().forEach(req); } configure(loadStories, module); addDecorator(withInfo); addDecorator(withKnobs);</span></span></code> </pre> </div></div><br><p>  Kami akan menulis <code>story</code> pertama kami di direktori komponen <code>ExampleComponent</code> </p><br><div class="spoiler">  <b class="spoiler_title">ExampleComponent.stories.tsx</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { storiesOf } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { ExampleComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./ExampleComponent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { text } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@storybook/addon-knobs/react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> stories = storiesOf(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>); stories.add(<span class="hljs-string"><span class="hljs-string">'ExampleComponent'</span></span>, () =&gt; &lt;ExampleComponent text={text('text', 'Some text')} /&gt;, { info: { inline: true }, text: ` ### Notes Simple example component ### Usage ~~~js &lt;ExampleComponent text="Some text" /&gt; ~~~ ` });</code> </pre> <br><p>  Kami menggunakan addons: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kenop</a> - memungkinkan perubahan alat peraga secara real-time dalam komponen yang ditampilkan di Storybook.  Untuk melakukan ini, bungkus alat peraga dalam fungsi khusus dalam cerita </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">info</a> - memungkinkan Anda untuk menambahkan dokumentasi dan deskripsi alat peraga ke halaman cerita </li></ul></div></div><br><p>  Sekarang perhatikan bahwa skrip inisialisasi buku cerita menambahkan perintah buku cerita ke <code>package.json</code> kami.  Gunakan untuk <code>npm run storybook</code> .  Storybook akan berkumpul dan berjalan di <code>http://localhost:6006</code> .  Jangan lupa menambahkan pengecualian untuk modul <code>typescript</code> dalam <code>Rollup</code> config - <code>'src/**/*.stories.tsx'</code> . </p><br><h3 id="razrabatyvaem">  Kami sedang berkembang </h3><br><p>  Jadi, setelah mengelilingi diri Anda dengan banyak alat yang praktis dan mempersiapkannya untuk bekerja, Anda dapat mulai mengembangkan komponen baru.  Setiap komponen akan ditempatkan di direktori dalam <code>src/components</code> dengan nama komponen.  Ini akan berisi semua file yang terkait dengannya - css, komponen itu sendiri dalam file tsx, tes, cerita.  Kami memulai buku cerita, membuat cerita untuk komponen, dan di sana kami menulis dokumentasi untuknya.  Kami membuat tes dan tes.  Ekspor-impor komponen jadi ditulis dalam <code>index.ts</code> . </p><br><p>  Selain itu, Anda dapat masuk ke <code>npm</code> dan menerbitkan perpustakaan Anda sebagai paket npm baru.  Dan Anda dapat menghubungkannya langsung dari repositori git dari master dan cabang lainnya.  Misalnya, untuk benda kerja saya, Anda dapat melakukan: </p><br><pre> <code class="bash hljs">npm i -s git+https://github.com/jmorozov/react-library-example.git</code> </pre> <br><p>  Sehingga dalam aplikasi konsumen perpustakaan di direktori <code>node_modules</code> hanya ada isi direktori <code>dist</code> dalam keadaan berkumpul, Anda perlu menambahkan perintah <code>"prepare": "npm run build"</code> ke bidang <code>scripts</code> . </p><br><p>  Juga, terima kasih kepada TS, penyelesaian otomatis di IDE akan berfungsi. </p><br><h2 id="podvodim-itogi">  Untuk meringkas </h2><br><p>  Pada pertengahan 2019, Anda dapat dengan cepat mulai mengembangkan pustaka komponen Anda pada React dan TypeScript, menggunakan alat pengembangan yang praktis.  Hasil ini dapat dicapai baik dengan bantuan utilitas otomatis, dan dalam mode manual.  Cara kedua lebih disukai jika Anda membutuhkan paket saat ini dan lebih banyak kontrol.  Hal utama adalah mengetahui di mana harus menggali, dan dengan bantuan contoh dalam artikel ini, saya harap ini menjadi lebih mudah. </p><br><p>  Anda juga dapat mengambil benda kerja yang dihasilkan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . </p><br><p>  Di antara hal-hal lain, saya tidak berpura-pura menjadi kebenaran tertinggi dan, secara umum, saya terlibat dalam front-end sejauh.  Anda dapat memilih paket alternatif dan opsi konfigurasi dan juga berhasil membuat pustaka komponen Anda.  Saya akan senang jika Anda membagikan resep Anda di komentar.  Selamat coding! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id461439/">https://habr.com/ru/post/id461439/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id461425/index.html">Bagaimana menjadi manajer produk dan berkembang lebih jauh</a></li>
<li><a href="../id461431/index.html">"Suka dan tidak suka": DNS over HTTPS</a></li>
<li><a href="../id461433/index.html">Menggunakan Identity Server 4 di Net Core 3.0</a></li>
<li><a href="../id461435/index.html">Pengenalan emosi menggunakan jaringan saraf convolutional</a></li>
<li><a href="../id461437/index.html">370 bola lampu</a></li>
<li><a href="../id461441/index.html">Laporan tentang kondisi penyimpanan menggunakan R. Komputasi paralel, grafik, xlsx, email dan semua ini</a></li>
<li><a href="../id461443/index.html">Pasca-analisis: apa yang diketahui tentang serangan terbaru pada jaringan server kunci SKS Keyserver crypto</a></li>
<li><a href="../id461447/index.html">Epik tentang administrator sistem sebagai spesies yang terancam punah</a></li>
<li><a href="../id461449/index.html">PhpStorm 2019.2: PHP 7.4 Typed Properties, Duplicate Finder, EditorConfig, Shell Scripts, dan Lainnya</a></li>
<li><a href="../id461451/index.html">Hari kedua saya dengan Haiku: senang, tetapi belum siap untuk pergi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>