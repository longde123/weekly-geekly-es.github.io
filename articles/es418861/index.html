<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧜🏿 ⛸️ ↪️ ReactOS ahora comienza con una partición BTRFS 🧐 🔴 🚶🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! En esta serie, continuamos haciéndonos amigos intensamente con el controlador WinBtrfs y ReactOS. 


 ¿Este es tu Windows? 

 Comencemos en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ReactOS ahora comienza con una partición BTRFS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/reactos/blog/418861/">  Hola Habr!  En esta serie, continuamos haciéndonos amigos intensamente con el controlador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WinBtrfs</a> y ReactOS. <br><br><img src="https://habrastorage.org/webt/is/zl/yu/iszlyufhm-cbubmu-loymwhvq2i.png"><br>  <i><font color="gray">¿Este es tu Windows?</font></i> <br><a name="habracut"></a><br>  Comencemos en orden.  Después de la publicación <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">anterior</a> , se implementó un mini controlador para el gestor de arranque FreeLoader, que permite leer archivos de la sección BTRFS en modo de solo lectura.  El primer problema me esperaba aquí: BTRFS es un sistema de archivos que distingue entre mayúsculas y minúsculas.  Aquí, para buscar la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estructura de inodo</a> (esta estructura contiene información básica sobre el archivo), el hash del nombre del archivo se usa en el directorio, esto le permite recorrer las rutas sin extraer todos los archivos contenidos en el directorio. <br><br>  Sin embargo, en el mundo de Windows, algo como un registro de nombre de archivo es de poca preocupación para nadie, por lo que las rutas a los controladores necesarios para cargar el sistema operativo se pueden escribir en el registro en absolutamente cualquier registro. <br><br>  En este momento, este problema se resuelve con <a href="">muletas</a> viejas y buenas: cuando solicita buscar un archivo, System32 y SYSTEM32 se reemplazan por system32, lo mismo con la carpeta de controladores.  Hasta ahora, estoy pensando cómo podría hacerlo de manera competente.  Lo más probable es que cargue una lista completa de archivos en un directorio cada vez y haga una búsqueda que no distinga entre mayúsculas y minúsculas: el cargador de velocidad no será especialmente visible en el gestor de arranque. <br><br><img src="https://habrastorage.org/webt/29/da/yb/29daybb7cweex3nccthfhwmqdc0.png"><br><br>  El cargador lee los archivos, las muletas se endurecen, seguimos adelante. <br><br>  Desarrollé el código del gestor de arranque en una máquina virtual Bochs, porque es lo más conveniente para hacerlo.  Pero ella (como resultó) tiene problemas para iniciar ReactOS, por lo que tuve que transferirme al VirtualBox habitual. <br><br>  Y luego otra emboscada me estaba esperando, por alguna razón, el sector de arranque no funcionó.  Al final resultó que, hay algunos problemas en la implementación de la interrupción INT 13h AH = 42h (lectura extendida desde el disco), por lo que esta función no puede leer más de 8 sectores a la vez. <br><br>  Y finalmente, el primer mensaje de error (¡ni siquiera es un BSOD!) <br><br><img src="https://habrastorage.org/webt/ui/ai/fg/uiaifg7-3jpkjoebdkxct-uu4qm.png"><br><br>  La excepción con STATUS_ACCESS_VIOLATION provino del subsistema WinSxS, que se toma principalmente de Wine.  Hubo que dedicar un par de días a la causa de la ocurrencia, ya que todas las bibliotecas se cargan a través de WinSxS, y hay muchas de ellas al inicio.  Al final, resultó que el problema no estaba en WinSxS (fuch), sino en la llamada al sistema NtQueryDirectoryFile. <br><br>  WinSxS a menudo usa esta función para buscar manifiestos por máscara (realizando consultas como: "* _Microsoft.Windows.Common-Controls_6595b64144ccf1df_6.0. *. * _ * _ *. Manifest"), y un error relacionado con el procesamiento de crept en el controlador WinBtrfs Máscaras que comienzan con un asterisco.  Puede ver una solicitud de extracción muy simple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . <br><br>  Sorprendentemente, esto fue suficiente para completar la instalación y arrancar desde el escritorio <br><br><img src="https://habrastorage.org/webt/9f/kn/yg/9fknyg3c0tyshqoitbpukzmildo.png"><br>  <i><font color="gray">Quizás el primer arranque del mundo desde el controlador WinBtrfs.</font></i>  <i><font color="gray">La primera implementación de mi corrección también tuvo errores, lo que provocó que los gráficos fueran a algún lado y no cargaran imágenes.</font></i> <br><br>  En realidad, el sistema arranca e incluso funciona (aunque la estabilidad no es la misma que en la última <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">versión 0.4.9</a> ). <br><br>  Pero los problemas aún están llenos: <br><br><ul><li>  No es compatible con archivos de intercambio.  En términos generales, en Linux los archivos de intercambio en discos btrfs tampoco son compatibles, y el parche ha estado suspendido durante varios años.  Pero WinBtrfs sí los admite.  Tenemos una implementación ligeramente diferente del administrador de memoria que en Windows, que requiere otra llamada al sistema que aún no está disponible en WinBtrfs. </li><li>  Escribe errores y desbordamiento de memoria.  Me las arreglé para arreglar un par de tales, por ejemplo, al instalar el cliente Git.  Descubriremos dónde fluye la memoria. </li><li>  BSOD en apagado y reinicio.  El parche ya está esperando aprobación </li></ul><br>  Hasta el final, GSoC se quedó un poco, planea solucionar más errores y resolver el problema con el archivo de intercambio (pero esto es después del final del programa). <br><br>  Bueno, aquellos que quieran apoyar el desarrollo de esta característica pueden unirse a las pruebas y el desarrollo del controlador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WinBtrfs</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418861/">https://habr.com/ru/post/es418861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418851/index.html">Cómo comprar la ilusión de seguridad en forma de relojes inteligentes para niños</a></li>
<li><a href="../es418853/index.html">Detalles sobre la actualización de Testigos segregados y las consecuencias de su adopción en Bitcoin</a></li>
<li><a href="../es418855/index.html">Abrir el seminario web "Creación de una aplicación en Webpack + React + Express"</a></li>
<li><a href="../es418857/index.html">Preparación de certificados SSL para la instalación</a></li>
<li><a href="../es418859/index.html">Algunas características de PowerShell al usar cuentas de usuario</a></li>
<li><a href="../es418863/index.html">Comprender los accesorios de renderizado con un ejemplo</a></li>
<li><a href="../es418867/index.html">Programación dinámica en problemas olímpicos</a></li>
<li><a href="../es418869/index.html">Más fácil de lo que parece. Capítulos 9-10</a></li>
<li><a href="../es418871/index.html">Kegel Elvie Smart Trainer para fortalecer los músculos íntimos: por qué lo necesita</a></li>
<li><a href="../es418873/index.html">Casi complicado. Parte 3, continuamos creando una "casa inteligente" inalámbrica. Basado en la tecnología Z-Wave y el software MajorDoMo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>