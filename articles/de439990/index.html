<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë¶üèø üßëüèº‚Äçü§ù‚Äçüßëüèª üßïüèæ Das Buch ‚ÄûPragmatische KI. Maschinelles Lernen und Cloud-Technologie üôåüèª üíè üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habrozhiteli! Dieses Noah-Geschenkbuch richtet sich an alle, die sich f√ºr KI, maschinelles Lernen, Cloud Computing und eine beliebige Kombinatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Das Buch ‚ÄûPragmatische KI. Maschinelles Lernen und Cloud-Technologie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/439990/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/d4/ws/jo/d4wsjoavuxtao33cfirxxzcf85q.jpeg" align="left" alt="Bild"></a>  Hallo habrozhiteli!  Dieses Noah-Geschenkbuch richtet sich an alle, die sich f√ºr KI, maschinelles Lernen, Cloud Computing und eine beliebige Kombination von Datenthemen interessieren.  Sowohl Programmierer als auch einfach f√ºrsorgliche Technikfreaks finden hier n√ºtzliche Informationen.  Codebeispiele finden Sie in Python.  Es behandelt viele fortgeschrittene Themen wie die Verwendung von Cloud-Plattformen (wie AWS, GCP und Azure) sowie Techniken des maschinellen Lernens und die Implementierung von KI.  Jedi, die Python, Cloud Computing und ML flie√üend beherrschen, finden auch viele n√ºtzliche Ideen f√ºr sich, die sie sofort in ihrer aktuellen Arbeit anwenden k√∂nnen. <br><br>  Wir laden Sie ein, einen Auszug aus dem Buch "Erstellen eines intelligenten Slack-Bots in AWS" zu lesen. <br><a name="habracut"></a><br>  Die Menschen haben lange davon getr√§umt, ein ‚Äûk√ºnstliches Leben‚Äú zu schaffen.  Meistens ist dies durch das Erstellen von Bots m√∂glich.  Bots werden zu einem immer wichtigeren Bestandteil unseres t√§glichen Lebens, insbesondere seit dem Aufkommen von Siri von Apple und Alexa von Amazon.  In diesem Kapitel werden wir alle Geheimnisse der Erstellung von Bots enth√ºllen. <br><br><h3>  Bot-Erstellung </h3><br>  Um den Bot zu erstellen, verwenden wir die Slack-Bibliothek f√ºr die Python-Sprache (https://github.com/slackapi/python-slackclient).  Um mit Slack zu beginnen, m√ºssen Sie ein Identifikationstoken generieren.  Im Allgemeinen ist es sinnvoll, mit solchen Markern eine Umgebungsvariable zu exportieren.  Ich mache das oft in virtualenv und erhalte so automatisch Zugriff darauf, wenn es in der aktuellen Umgebung ausgef√ºhrt wird.  Dazu m√ºssen Sie das Dienstprogramm virtualenv ein wenig ‚Äûknacken‚Äú, indem Sie das Aktivierungsskript bearbeiten. <br><br>  Wenn Sie die Variable Slack in das Skript ~ / .env / bin / enable exportieren, sieht sie wie folgt aus. <br><br>  Und nur zur Information, wenn Sie mit den neuesten Innovationen Schritt halten m√∂chten, wird empfohlen, das neue offizielle Python-Dienstprogramm zum Verwalten der Umgebung zu verwenden - pipenv (https://github.com/pypa/pipenv): <br><br><pre><code class="plaintext hljs">_OLD_VIRTUAL_PATH="$PATH" PATH="$VIRTUAL_ENV/bin:$PATH" export PATH SLACK_API_TOKEN=&lt;Your Token Here&gt; export SLACK_API_TOKEN</code> </pre> <br>  Es ist praktisch, mit dem Befehl printenv der Betriebssysteme OS X und Linux zu √ºberpr√ºfen, ob die Umgebungsvariable festgelegt ist.  Danach k√∂nnen Sie das folgende kurze Skript verwenden, um das Senden einer Nachricht zu √ºberpr√ºfen: <br><br><pre> <code class="plaintext hljs">import os from slackclient import SlackClient slack_token = os.environ["SLACK_API_TOKEN"] sc = SlackClient(slack_token) sc.api_call( "chat.postMessage", channel="#general", text="Hello from my bot! :tada:" )</code> </pre> <br>  Es ist auch erw√§hnenswert, dass das Dienstprogramm pipenv die empfohlene L√∂sung ist, die die Funktionen der Dienstprogramme pip und virtualenv in einer Komponente kombiniert.  Es ist zu einem neuen Standard geworden, daher ist es sinnvoll, ihn unter dem Gesichtspunkt der Paketverwaltung zu betrachten. <br><br><h3>  Konvertieren Sie die Bibliothek in das Befehlszeilenprogramm </h3><br>  Wie bei den anderen Beispielen in diesem Buch ist es eine gute Idee, unseren Code in ein Befehlszeilenprogramm zu konvertieren, um das Testen neuer Ideen zu vereinfachen.  Es ist erw√§hnenswert, dass viele unerfahrene Entwickler oft keine Befehlszeilentools bevorzugen, sondern andere L√∂sungen, zum Beispiel, einfach in Jupiter-Notebooks arbeiten.  Ich werde f√ºr kurze Zeit die Rolle des Anwalts des Teufels spielen und eine Frage stellen, die die Leser m√∂glicherweise haben: ‚ÄûWarum brauchen wir Befehlszeilenprogramme in einem Projekt, das auf Jupiter-Notizb√ºchern basiert?  Ist es nicht der Sinn von Jupiter-Notizbl√∂cken, die Befehlsshell und die Befehlszeile unn√∂tig zu machen? "  Das Hinzuf√ºgen eines Befehlszeilenprogramms zu einem Projekt ist gut, da Sie damit schnell verschiedene Eingabeoptionen ausprobieren k√∂nnen.  Jupiter-Notebook-Codebl√∂cke akzeptieren keine Eingaben. In gewissem Sinne handelt es sich dabei um Skripte mit fest verdrahteten Daten. <br><br>  Viele Befehlszeilenprogramme auf GCP- und AWS-Plattformen sind nicht zuf√§llig vorhanden: Sie bieten Flexibilit√§t und Funktionen, die auf grafischen Oberfl√§chen nicht verf√ºgbar sind.  Eine wunderbare Sammlung von Aufs√§tzen zu diesem Thema des Science-Fiction-Schriftstellers Neal Stephenson hei√üt ‚ÄûAm Anfang ... gab es eine Befehlszeile‚Äú.  Darin sagt Stevenson: "GUIs verursachen einen erheblichen zus√§tzlichen Aufwand f√ºr jede, selbst die kleinste Softwarekomponente, die die Programmierumgebung vollst√§ndig ver√§ndert."  Er beendet die Sammlung mit den Worten: ‚Äû... das Leben ist eine sehr schwierige und schwierige Sache;  Keine Schnittstelle wird das √§ndern.  und jeder, der anders denkt, ist ein Simpleton ... "Hart genug, aber meine Erfahrung zeigt, dass es wahr genug ist.  Das Leben mit der Kommandozeile wird besser.  Probieren Sie es aus und Sie m√∂chten nicht zur GUI zur√ºckkehren. <br><br>  Dazu verwenden wir das unten gezeigte Klickpaket.  Das Senden von Nachrichten √ºber die neue Benutzeroberfl√§che ist sehr einfach. <br><br><pre> <code class="plaintext hljs">./clibot.py send --message "from cli" sending message from cli to #general</code> </pre> <br>  Abbildung 7.1 zeigt die Standardwerte sowie die benutzerdefinierte Nachricht des Dienstprogramms cli. <br><br><pre> <code class="plaintext hljs">#!/usr/bin/env python import os import click from slackclient import SlackClient SLACK_TOKEN = os.environ["SLACK_API_TOKEN"] def send_message(channel="#general", message="Hello from my bot!"): """   """ slack_client = SlackClient(SLACK_TOKEN) res = slack_client.api_call( "chat.postMessage", channel=channel, text=message ) return res @click.group() @click.version_option("0.1") def cli(): """      """ @cli.command("send") @click.option("--message", default="Hello from my bot!", help="text of message") @click.option("--channel", default="#general", help="general channel") def send(channel, message): click.echo(f"sending message {message} to {channel}") send_message(channel, message=message) if __name__ == '__main__': cli()</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/qy/2v/vqqy2vqmojumwcz9xf1b4vriiws.png" alt="Bild"></div><br><h3>  Mit dem AWS Step Functions-Service bringen wir den Bot auf eine neue Ebene </h3><br>  Nachdem Sie Kommunikationskan√§le zum Senden von Nachrichten an Slack erstellt haben, k√∂nnen Sie unseren Code verbessern: F√ºhren Sie ihn nach einem Zeitplan aus und verwenden Sie ihn f√ºr n√ºtzliche Aktionen.  Der AWS Step Functions Service ist daf√ºr hervorragend geeignet.  Im n√§chsten Abschnitt wird unser Slack-Bot lernen, die Sportseiten von Yahoo!  NBA-Spieler rufen ihren Geburtsort ab und senden diese Daten an Slack. <br><br>  Abbildung 7.2 zeigt eine vorgefertigte Schritt-f√ºr-Schritt-Funktion in Aktion.  Der erste Schritt besteht darin, die URLs des NBA-Spielerprofils zu extrahieren, und der zweite darin, die Beautiful Soup-Bibliothek zu verwenden, um den Geburtsort jedes Spielers zu finden.  Nach Abschluss der Schritt-f√ºr-Schritt-Funktion werden die Ergebnisse an Slack zur√ºckgesendet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ug/z0/nd/ugz0ndjwda5knhyl8txo4tm9pyw.png" alt="Bild"></div><br>  AWS Lambda und Chalice k√∂nnen verwendet werden, um die einzelnen Teile der Arbeit innerhalb einer Schrittfunktion zu koordinieren.  Mit Lambda (https://aws.amazon.com/lambda/) kann der Benutzer Funktionen in AWS ausf√ºhren, und mit dem Chalice-Framework (http://chalice.readthedocs.io/en/latest/) k√∂nnen Sie serverlose Anwendungen in Python erstellen.  Hier sind einige Voraussetzungen: <br><br><ul><li>  Der Benutzer muss √ºber ein AWS-Konto verf√ºgen. </li><li>  Der Benutzer ben√∂tigt Anmeldeinformationen, um die API verwenden zu k√∂nnen. </li><li>  Die Lambda-Rolle (von Chalice erstellt) muss √ºber eine Richtlinie mit den Berechtigungen verf√ºgen, die zum Aufrufen der entsprechenden AWS-Services erforderlich sind, z. B. S3. </li></ul><br><h3>  Konfigurieren Sie die IAM-Anmeldeinformationen </h3><br>  Detaillierte Anweisungen zum Einrichten von AWS-Anmeldeinformationen finden Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">boto3.readthedocs.io/en/latest/guide/configuration.html</a> .  Informationen zum Exportieren von AWS-Variablen unter Windows- und Linux-Betriebssystemen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">finden Sie hier</a> .  Es gibt viele M√∂glichkeiten, Anmeldeinformationen zu konfigurieren, aber Benutzer von virtualenv k√∂nnen AWS-Anmeldeinformationen in einer lokalen virtuellen Umgebung im Skript / bin / enabled ablegen: <br><br><pre> <code class="plaintext hljs">#  AWS AWS_DEFAULT_REGION=us-east-1 AWS_ACCESS_KEY_ID=xxxxxxxx AWS_SESSION_TOKEN=xxxxxxxx</code> </pre> <br><br><pre> <code class="plaintext hljs">#  export AWS_DEFAULT_REGION export AWS_ACCESS_KEY_ID export AWS_DEFAULT_REGION</code> </pre> <br>  Arbeite mit Kelch.  Chalice verf√ºgt √ºber ein Befehlszeilenprogramm mit vielen verf√ºgbaren Befehlen: <br><br><pre> <code class="plaintext hljs">Usage: chalice [OPTIONS] COMMAND [ARGS]... Options: --version Show the version and exit. --project-dir TEXT The project directory. Defaults to CWD --debug / --no-debug Print debug logs to stderr. --help Show this message and exit. Commands: delete deploy gen-policy generate-pipeline Generate a cloudformation template for a... generate-sdk local logs new-project package url</code> </pre> <br>  Der Code in der Vorlage app.py kann durch die Funktionen des Lambda-Dienstes ersetzt werden.  AWS Chalice ist insofern praktisch, als es die M√∂glichkeit bietet, zus√§tzlich zu Webdiensten eigenst√§ndige Lambda-Funktionen zu erstellen.  Dank dieser Funktionalit√§t k√∂nnen Sie mehrere Lambda-Funktionen erstellen, sie einer schrittweisen Funktion zuordnen und sie wie Lego-W√ºrfel zusammenf√ºhren. <br><br>  Sie k√∂nnen beispielsweise einfach eine geplante Lambda-Funktion erstellen, die eine beliebige Aktion ausf√ºhrt: <br><br><pre> <code class="plaintext hljs">@app.schedule(Rate(1, unit=Rate.MINUTES)) def every_minute(event): """,    """ #   Slack</code> </pre> <br>  Um die Interaktion mit dem Bot f√ºr das Web-Scraping herzustellen, m√ºssen Sie mehrere Funktionen erstellen.  Am Anfang der Datei gibt es Importe und eine Reihe von Variablen werden deklariert: <br><br><pre> <code class="plaintext hljs">import logging import csv from io import StringIO import boto3 from bs4 import BeautifulSoup import requests from chalice import (Chalice, Rate) APP_NAME = 'scrape-yahoo' app = Chalice(app_name=APP_NAME) app.log.setLevel(logging.DEBUG)</code> </pre> <br>  Der Bot muss m√∂glicherweise einige der Daten in S3 speichern.  Die folgende Funktion verwendet Boto, um die Ergebnisse in einer CSV-Datei zu speichern: <br><br><pre> <code class="plaintext hljs">def create_s3_file(data, name="birthplaces.csv"): csv_buffer = StringIO() app.log.info(f"Creating file with {data} for name") writer = csv.writer(csv_buffer) for key, value in data.items(): writer.writerow([key,value]) s3 = boto3.resource('s3') res = s3.Bucket('aiwebscraping').\ put_object(Key=name, Body=csv_buffer.getvalue()) return res</code> </pre> <br>  Die Funktion fetch_page verwendet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Beautiful Soup-Bibliothek</a> , um eine HTML-Seite zu analysieren, die sich gem√§√ü der NBA-Statistik-URL befindet, und gibt ein Suppenobjekt zur√ºck: <br><br><pre> <code class="plaintext hljs">def fetch_page(url="https://sports.yahoo.com/nba/stats/"): """ URL Yahoo""" #       #  Beautiful Soup app.log.info(f"Fetching urls from {url}") res = requests.get(url) soup = BeautifulSoup(res.content, 'html.parser') return soup</code> </pre> <br>  Die Funktionen get_player_links und fetch_player_urls erhalten Links zu URLs des Spielerprofils: <br><br><pre> <code class="plaintext hljs">def get_player_links(soup): """   URL    URL     'a'       'nba/players' """ nba_player_urls = [] for link in soup.find_all('a'): link_url = link.get('href') #  if link_url: if "nba/players" in link_url: print(link_url) nba_player_urls.append(link_url) return nba_player_urls def fetch_player_urls(): """ URL """ soup = fetch_page() urls = get_player_links(soup) return urls</code> </pre> <br>  Als N√§chstes rufen wir in der Funktion find_birthplaces den Geburtsort des Players von den Seiten ab, die sich unter diesen URLs befinden: <br><br><pre> <code class="plaintext hljs">def find_birthplaces(urls): """       NBA  Yahoo""" birthplaces = {} for url in urls: profile = requests.get(url) profile_url = BeautifulSoup(profile.content, 'html.parser') lines = profile_url.text res2 = lines.split(",") key_line = [] for line in res2: if "Birth" in line: #print(line) key_line.append(line) try: birth_place = key_line[0].split(":")[-1].strip() app.log.info(f"birth_place: {birth_place}") except IndexError: app.log.info(f"skipping {url}") continue birthplaces[url] = birth_place app.log.info(birth_place) return birthplaces</code> </pre> <br>  Nun kommen wir zu den Funktionen von Kelch.  Bitte beachten Sie: F√ºr das Chalice-Framework muss der Standardpfad erstellt werden: <br><br><pre> <code class="plaintext hljs">#     HTTP- @app.route('/') def index(): """ URL""" app.log.info(f"/ Route: for {APP_NAME}") return {'app_name': APP_NAME}</code> </pre> <br>  Die folgende Lambda-Funktion ist eine Route, die eine HTTP-URL mit einer zuvor geschriebenen Funktion verbindet: <br><br><pre> <code class="plaintext hljs">@app.route('/player_urls') def player_urls(): """ URL """ app.log.info(f"/player_urls Route: for {APP_NAME}") urls = fetch_player_urls() return {"nba_player_urls": urls}</code> </pre> <br>  Die folgenden Lambda-Funktionen sind eigenst√§ndig und k√∂nnen innerhalb einer Schritt-f√ºr-Schritt-Funktion aufgerufen werden: <br><br><pre> <code class="plaintext hljs">#   Lambda @app.lambda_function() def return_player_urls(event, context): """  Lambda,  URL """ app.log.info(f"standalone lambda 'return_players_urls'\ {APP_NAME} with {event} and {context}") urls = fetch_player_urls() return {"urls": urls} #   Lambda @app.lambda_function() def birthplace_from_urls(event, context): """   """ app.log.info(f"standalone lambda 'birthplace_from_urls'\ {APP_NAME} with {event} and {context}") payload = event["urls"] birthplaces = find_birthplaces(payload) return birthplaces #   Lambda @app.lambda_function() def create_s3_file_from_json(event, context): """  S3      JSON""" app.log.info(f"Creating s3 file with event data {event}\ and context {context}") print(type(event)) res = create_s3_file(data=event) app.log.info(f"response of putting file: {res}") return True</code> </pre> <br>  Wenn Sie die resultierende Chalice-Anwendung lokal ausf√ºhren, werden die folgenden Ergebnisse angezeigt: <br><br><pre> <code class="plaintext hljs">‚Üí scrape-yahoo git:(master) ÔÄ∑ chalice local Serving on 127.0.0.1:8000 scrape-yahoo - INFO - / Route: for scrape-yahoo 127.0.0.1 - - [12/Dec/2017 03:25:42] "GET / HTTP/1.1" 200 - 127.0.0.1 - - [12/Dec/2017 03:25:42] "GET /favicon.ico" scrape-yahoo - INFO - / Route: for scrape-yahoo 127.0.0.1 - - [12/Dec/2017 03:25:45] "GET / HTTP/1.1" 200 - 127.0.0.1 - - [12/Dec/2017 03:25:45] "GET /favicon.ico" scrape-yahoo - INFO - /player_urls Route: for scrape-yahoo scrape-yahoo - INFO - https://sports.yahoo.com/nba/stats/ https://sports.yahoo.com/nba/players/4563/ https://sports.yahoo.com/nba/players/5185/ https://sports.yahoo.com/nba/players/3704/ https://sports.yahoo.com/nba/players/5012/ https://sports.yahoo.com/nba/players/4612/ https://sports.yahoo.com/nba/players/5015/ https://sports.yahoo.com/nba/players/4497/ https://sports.yahoo.com/nba/players/4720/ https://sports.yahoo.com/nba/players/3818/ https://sports.yahoo.com/nba/players/5432/ https://sports.yahoo.com/nba/players/5471/ https://sports.yahoo.com/nba/players/4244/ https://sports.yahoo.com/nba/players/5464/ https://sports.yahoo.com/nba/players/5294/ https://sports.yahoo.com/nba/players/5336/ https://sports.yahoo.com/nba/players/4390/ https://sports.yahoo.com/nba/players/4563/ https://sports.yahoo.com/nba/players/3704/ https://sports.yahoo.com/nba/players/5600/ https://sports.yahoo.com/nba/players/4624/ 127.0.0.1 - - [12/Dec/2017 03:25:53] "GET /player_urls" 127.0.0.1 - - [12/Dec/2017 03:25:53] "GET /favicon.ico"</code> </pre> <br>  F√ºhren Sie zum Bereitstellen der Anwendung den Befehl chalice deploy aus: <br><br><pre> <code class="plaintext hljs">‚Üí scrape-yahoo git:(master) ÔÄ∑ chalice deploy Creating role: scrape-yahoo-dev Creating deployment package. Creating lambda function: scrape-yahoo-dev Initiating first time deployment. Deploying to API Gateway stage: api https://bt98uzs1cc.execute-api.us-east-1.amazonaws.com/api/</code> </pre> <br>  Dank der Befehlszeilenschnittstelle f√ºr HTTP (https://github.com/jakubroztocil/httpie) rufen wir die HTTP-Route von AWS auf und extrahieren die in / api / player_urls verf√ºgbaren Links: <br><br><pre> <code class="plaintext hljs">‚Üí scrape-yahoo git:(master) ÔÄ∑ http \ https://&lt;a lambda route&gt;.amazonaws.com/api/player_urls HTTP/1.1 200 OK Connection: keep-alive Content-Length: 941 Content-Type: application/json Date: Tue, 12 Dec 2017 11:48:41 GMT Via: 1.1 ba90f9bd20de9ac04075a8309c165ab1.cloudfront.net (CloudFront) X-Amz-Cf-Id: ViZswjo4UeHYwrc9e-5vMVTDhV_Ic0dhVIG0BrDdtYqd5KWcAuZKKQ== X-Amzn-Trace-Id: sampled=0;root=1-5a2fc217-07cc12d50a4d38a59a688f5c X-Cache: Miss from cloudfront x-amzn-RequestId: 64f24fcd-df32-11e7-a81a-2b511652b4f6 { "nba_player_urls": [ "https://sports.yahoo.com/nba/players/4563/", "https://sports.yahoo.com/nba/players/5185/", "https://sports.yahoo.com/nba/players/3704/", "https://sports.yahoo.com/nba/players/5012/", "https://sports.yahoo.com/nba/players/4612/", "https://sports.yahoo.com/nba/players/5015/", "https://sports.yahoo.com/nba/players/4497/", "https://sports.yahoo.com/nba/players/4720/", "https://sports.yahoo.com/nba/players/3818/", "https://sports.yahoo.com/nba/players/5432/", "https://sports.yahoo.com/nba/players/5471/", "https://sports.yahoo.com/nba/players/4244/", "https://sports.yahoo.com/nba/players/5464/", "https://sports.yahoo.com/nba/players/5294/", "https://sports.yahoo.com/nba/players/5336/", "https://sports.yahoo.com/nba/players/4390/", "https://sports.yahoo.com/nba/players/4563/", "https://sports.yahoo.com/nba/players/3704/", "https://sports.yahoo.com/nba/players/5600/", "https://sports.yahoo.com/nba/players/4624/" ] }</code> </pre> <br>  Eine weitere bequeme M√∂glichkeit, mit Lambda-Funktionen zu arbeiten, besteht darin, sie direkt √ºber das Click-Paket und die Python Boto-Bibliothek aufzurufen. <br><br>  Wir k√∂nnen ein neues Befehlszeilenprogramm namens wscli.py erstellen (kurz f√ºr Web-Scraping-Befehlszeilenschnittstelle - ‚ÄûBefehlszeilenschnittstelle f√ºr Web-Scraping‚Äú).  Im ersten Teil des Codes konfigurieren wir die Protokollierung und importieren die Bibliotheken: <br><br><pre> <code class="plaintext hljs">#!/usr/bin/env python import logging import json import boto3 import click from pythonjsonlogger import jsonlogger #  log = logging.getLogger(__name__) log.setLevel(logging.INFO) LOGHANDLER = logging.StreamHandler() FORMMATTER = jsonlogger.JsonFormatter() LOGHANDLER.setFormatter(FORMMATTER) log.addHandler(LOGHANDLER)</code> </pre> <br>  Die folgenden drei Funktionen dienen zur Verbindung mit der Lambda-Funktion √ºber invoke_lambda: <br><br><pre> <code class="plaintext hljs">### API Boto Lambda def lambda_connection(region_name="us-east-1"): """   Lambda""" lambda_conn = boto3.client("lambda", region_name=region_name) extra_msg = {"region_name": region_name, "aws_service": "lambda"} log.info("instantiate lambda client", extra=extra_msg) return lambda_conn def parse_lambda_result(response): """     Boto   JSON""" body = response['Payload'] json_result = body.read() lambda_return_value = json.loads(json_result) return lambda_return_value def invoke_lambda(func_name, lambda_conn, payload=None, invocation_type="RequestResponse"): """  Lambda""" extra_msg = {"function_name": func_name, "aws_service": "lambda", "payload":payload} log.info("Calling lambda function", extra=extra_msg) if not payload: payload = json.dumps({"payload":"None"}) response = lambda_conn.invoke(FunctionName=func_name, InvocationType=invocation_type, Payload=payload ) log.info(response, extra=extra_msg) lambda_return_value = parse_lambda_result(response) return lambda_return_value</code> </pre> <br>  Wir verpacken die Funktion invoke_lambda mit dem Python-Paket, um Click-Befehlszeilenprogramme zu erstellen.  Bitte beachten Sie, dass wir den Standardwert f√ºr die Option --func festlegen, die die zuvor bereitgestellte Lambda-Funktion verwendet: <br><br><pre> <code class="plaintext hljs">@click.group() @click.version_option("1.0") def cli(): """     -""" @cli.command("lambda") @click.option("--func", default="scrape-yahoo-dev-return_player_urls", help="name of execution") @click.option("--payload", default='{"cli":"invoke"}', help="name of payload") def call_lambda(func, payload): """  Lambda ./wscli.py lambda """ click.echo(click.style("Lambda Function invoked from cli:", bg='blue', fg='white')) conn = lambda_connection() lambda_return_value = invoke_lambda(func_name=func, lambda_conn=conn, payload=payload) formatted_json = json.dumps(lambda_return_value, sort_keys=True, indent=4) click.echo(click.style( "Lambda Return Value Below:", bg='blue', fg='white')) click.echo(click.style(formatted_json,fg="red")) if __name__ == "__main__": cli()</code> </pre> <br>  Die von diesem Dienstprogramm angezeigten Ergebnisse √§hneln dem Aufrufen der HTTP-Schnittstelle: <br><br><pre> <code class="plaintext hljs">‚Üí X ./wscli.py lambda \ --func=scrape-yahoo-dev-birthplace_from_urls\ --payload '{"url":["https://sports.yahoo.com/nba/players/4624/",\ "https://sports.yahoo.com/nba/players/5185/"]}' Lambda Function invoked from cli: {"message": "instantiate lambda client", "region_name": "us-east-1", "aws_service": "lambda"} {"message": "Calling lambda function", "function_name": "scrape-yahoo-dev-birthplace_from_urls", "aws_service": "lambda", "payload": "{\"url\":[\"https://sports.yahoo.com/nba/players/4624/\", \"https://sports.yahoo.com/nba/players/5185/\"]}"} {"message": null, "ResponseMetadata": {"RequestId": "a6049115-df59-11e7-935d-bb1de9c0649d", "HTTPStatusCode": 200, "HTTPHeaders": {"date": "Tue, 12 Dec 2017 16:29:43 GMT", "content-type": "application/json", "content-length": "118", "connection": "keep-alive", "x-amzn-requestid": "a6049115-df59-11e7-935d-bb1de9c0649d", "x-amzn-remapped-content-length": "0", "x-amz-executed-version": "$LATEST", "x-amzn-trace-id": "root=1-5a3003f2-2583679b2456022568ed0682;sampled=0"}, "RetryAttempts": 0}, "StatusCode": 200, "ExecutedVersion": "$LATEST", "Payload": "&lt;botocore.response.StreamingBody object at 0x10ee37dd8&gt;", "function_name": "scrape-yahoo-dev-birthplace_from_urls", "aws_service": "lambda", "payload": "{\"url\":[\"https://sports.yahoo.com/nba/players/4624/\", \"https://sports.yahoo.com/nba/players/5185/\"]}"} Lambda Return Value Below: { "https://sports.yahoo.com/nba/players/4624/": "Indianapolis", "https://sports.yahoo.com/nba/players/5185/": "Athens" }</code> </pre> <br><h3>  Beenden Sie die Erstellung einer Schritt-f√ºr-Schritt-Funktion </h3><br>  Der letzte Schritt beim Erstellen einer schrittweisen Funktion, wie in der AWS-Dokumentation (https://docs.aws.amazon.com/step-functions/latest/dg/tutorial-creating-activity-state-machine.html) beschrieben, ist das Erstellen mit Webschnittstelle der Zustandsmaschinenstruktur im JSON-Format (JavaScript Object Notation).  Der folgende Code demonstriert diese Pipeline, beginnend mit den urspr√ºnglichen Lambda-Funktionen zum Scrapen von Yahoo!, Speichern von Daten in einer S3-Datei und schlie√ülich zum Senden von Inhalten an Slack: <br><br><pre> <code class="plaintext hljs">{ "Comment": "Fetch Player Urls", "StartAt": "FetchUrls", "States": { "FetchUrls": { "Type": "Task", "Resource": \ "arn:aws:lambda:us-east-1:561744971673:\ function:scrape-yahoo-dev-return_player_urls", "Next": "FetchBirthplaces" }, "FetchBirthplaces": { "Type": "Task", "Resource": \ "arn:aws:lambda:us-east-1:561744971673:\ function:scrape-yahoo-dev-birthplace_from_urls", "Next": "WriteToS3" }, "WriteToS3": { "Type": "Task", "Resource": "arn:aws:lambda:us-east-1:\ 561744971673:function:scrape-yahoo-dev-create_s3_file_from_json", "Next": "SendToSlack" }, "SendToSlack": { "Type": "Task", "Resource": "arn:aws:lambda:us-east-1:561744971673:\ function:send_message", "Next": "Finish" }, "Finish": { "Type": "Pass", "Result": "Finished", "End": true } } }</code> </pre> <br>  In Abb.  7.2 Die Ausf√ºhrung des ersten Teils dieser Pipeline wurde gezeigt.  Es ist √§u√üerst n√ºtzlich, die Zwischenergebnisse der Zustandsmaschine zu sehen.  Dar√ºber hinaus ist die M√∂glichkeit der Echtzeit√ºberwachung jedes Teils der Zustandsmaschine zum Debuggen sehr praktisch. <br><br>  Abbildung 7.3 zeigt eine vollst√§ndige Pipeline mit den Schritten zum Schreiben in eine S3-Datei und zum Senden von Inhalten an Slack.  Es bleibt nur zu entscheiden, wie dieses Scraping-Dienstprogramm ausgef√ºhrt werden soll - in einem bestimmten Zeitintervall oder als Reaktion auf ein Ereignis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xx/dx/at/xxdxatrmwvkk7fdafgiqno9i_fs.png" alt="Bild"></div><br><h3>  Zusammenfassung </h3><br>  In diesem Kapitel wurden Ihnen viele erstaunliche Konzepte zum Erstellen von KI-Anwendungen vorgestellt.  Es wurden das Dienstprogramm Slack Bot und Web Scraping erstellt, die dann mithilfe von serverlosen Diensten von AWS verbunden wurden.  Sie k√∂nnen einem solchen anf√§nglichen Framework noch viel mehr hinzuf√ºgen - zum Beispiel die Lambda-Funktion zum Verarbeiten von in nat√ºrlichen Sprachen geschriebenen Texten zum Lesen von Webseiten und zum Abrufen ihrer kurzen Inhalte oder den Clustering-Algorithmus ohne Lehrer, der neue NBA-Spieler nach beliebigen Attributen gruppieren w√ºrde. <br><br>  ¬ªWeitere Informationen zum Buch finden Sie auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Website des Herausgebers</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Inhalt</a> <br>  ¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Auszug</a> <br><br>  20% Rabatt auf Gutschein f√ºr Kuriere - <b>Geschenk</b> <br><br>  PS: 7% der Kosten des Buches flie√üen in die √úbersetzung neuer Computerb√ºcher. Die Liste der B√ºcher, die der Druckerei √ºbergeben wurden, finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439990/">https://habr.com/ru/post/de439990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439980/index.html">Docker lernen, Teil 3: Docker-Dateien</a></li>
<li><a href="../de439982/index.html">React Tutorial, Teil 16: Die vierte Phase der Arbeit an einer TODO-Anwendung, Ereignisverarbeitung</a></li>
<li><a href="../de439984/index.html">React Tutorial, Teil 17: Die f√ºnfte Phase der Arbeit an einer TODO-Anwendung, √Ñndern des Status von Komponenten</a></li>
<li><a href="../de439986/index.html">Chips VS Bedrohungen f√ºr die Containerisierungstechnologie</a></li>
<li><a href="../de439988/index.html">Technosph√§re f√ºnf Jahre</a></li>
<li><a href="../de439994/index.html">XAMPP - Einrichtung des virtuellen Servers</a></li>
<li><a href="../de440002/index.html">Wie kann man Unternehmenssoftware verkaufen und √ºberleben?</a></li>
<li><a href="../de440008/index.html">Erh√∂hen des Go-Fehlerinhalts - github.com/ztrue/tracerr</a></li>
<li><a href="../de440010/index.html">Reagieren gegen Angular: Wie eine Bibliothek mit einem Framework konkurrieren kann</a></li>
<li><a href="../de440012/index.html">Produktfallstudien und -praktiken auf der Epic Growth Conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>