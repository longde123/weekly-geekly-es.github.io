<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úçüèª üíâ üìö Chasse aux menaces avec Cisco Visibility üí™ ‚ÜóÔ∏è üëê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imaginez que vous lisez un article dans Kommersant qu'un package complet pour les attaques contre les banques Pegasus a √©t√© rendu public sur Internet....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chasse aux menaces avec Cisco Visibility</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/417345/"> Imaginez que vous <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lisez</a> un article dans Kommersant qu'un package complet pour les attaques contre les banques Pegasus a √©t√© rendu public sur Internet.  Vous voudrez probablement savoir si vous avez √©galement √©t√© pris dans la distribution et si du code malveillant se trouve sur votre r√©seau.  D'une part, vous disposez d'un tas de journaux et d'√©v√©nements de s√©curit√© provenant de divers moyens de protection, et d'autre part, vous pouvez recevoir des informations sur les menaces dans le cadre d'un abonnement √† tout service Threat Intelligence payant ou gratuit (par exemple, de BI.ZONE, State Security Service ou FinCERT).  D'une part, vous avez beaucoup de donn√©es √† analyser, mais vous ne savez pas si elles ont des traces de ce que vous recherchez.  En revanche, vous avez des informations sur les traces (c'est-√†-dire des indicateurs de compromis), mais vous ne savez pas √† quel point elles sont applicables √† vous.  Vous devez combiner ces deux ensembles de donn√©es en impl√©mentant ce que l'on appelle commun√©ment la chasse aux menaces ou en trouvant des traces d'attaques dans votre infrastructure.  Voyons comment vous pouvez automatiser cette t√¢che avec la solution gratuite Cisco Visibility r√©cemment publi√©e. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="image"><a name="habracut"></a><br><br>  Vous ne savez pas par o√π commencer?  O√π chercher les traces d'une menace qui vous int√©resse?  Voici une feuille vierge et dans Cisco Visibility, elle ressemble √† ceci: <br><br><img src="https://habrastorage.org/webt/hz/ql/ie/hzqlieayft079i9gry1wg5jmjzw.png" alt="image"><br><br>  Dans cette fen√™tre, vous chargez tout ce que vous recherchez.  Prenons l'exemple de TeslaCrypt (dans la vie r√©elle, au lieu de TeslaCrypt, vous substituerez toute autre menace dont vous aurez besoin pour trouver des traces ou prouver son absence pendant la chasse aux menaces).  Vous devez d'abord rassembler tous les indicateurs de compromis pour lesquels vous utilisez les services Threat Intelligence existants.  Par exemple, vous obtenez des donn√©es TeslaCrypt sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le blog Cisco Talos</a> .  Vous avez 9 indicateurs devant vous - adresses IP, hachages de fichiers malveillants et domaines que le chiffreur d√©ploy√© contacte afin de recevoir des commandes suppl√©mentaires et de payer la ran√ßon en crypto-monnaie.  Vous chargez tous ces indicateurs dans Cisco Visibility: <br><br><img src="https://habrastorage.org/webt/sq/vr/v1/sqvrv1qyfiqbw6jiwvlamctaxlg.png" alt="image"><br><br>  Ici, vous devez faire une petite digression.  Cisco Visibility fonctionne d√©sormais avec les donn√©es de Cisco AMP for Endpoints, c'est-√†-dire avec une solution de classe EDR (Endpoint Detection and Response) install√©e sur les ordinateurs personnels et mobiles ex√©cutant Windows, Linux, MacOS, Android et iOS.  Par cons√©quent, la chasse aux menaces avec Cisco Visibility est d√©sormais effectu√©e sur les appareils d'extr√©mit√©, qui sont cibl√©s √† 70% par les attaquants. <br><br><img src="https://habrastorage.org/webt/km/fw/iu/kmfwiu5ky9hdr11hrqxiuwrpsao.png" alt="image"><br><br>  Que voyons-nous apr√®s le chargement des indicateurs dans Cisco Visibility?  La zone principale de l'√©cran est occup√©e par le graphique des relations, qui refl√®te les interactions entre les indicateurs de compromis, les √©v√©nements de s√©curit√© collect√©s √† partir de l'infrastructure du client et l'environnement externe.  Vous pouvez mettre l'image √† l'√©chelle pour avoir une id√©e g√©n√©rale de l'image de ce qui se passe. <br><br><img src="https://habrastorage.org/webt/ad/kz/kk/adkzkkzagihootdjg2_kalsyabe.png" alt="image"><br><br>  Au-dessus du graphique des interactions se trouve un panneau qui affiche un r√©sum√© de tous les points d'int√©r√™t pour nous: <br><br><ul><li>  Buts ou sacrifices.  En cliquant sur ce champ, vous recevrez imm√©diatement une liste de tous les n≈ìuds de votre r√©seau sur lesquels se trouvent les pistes que vous recherchez.  C'est exactement ce dont vous avez besoin pour comprendre l'ampleur de la catastrophe et combien vous en avez souffert.  Si aucun n≈ìud n'est affich√© ici, vous n'avez aucun n≈ìud impliqu√© dans l'attaque. </li><li>  Empreintes.  En cliquant sur ce champ, vous obtiendrez une liste des pistes que vous recherchez, avec une coloration en surbrillance qui refl√®te le fait que ces pistes se trouvent dans les bases de donn√©es Cisco Threat Intelligence. </li><li>  Indicateurs.  En cliquant sur ce champ, vous verrez les mod√®les de comportement trouv√©s dans votre infrastructure qui correspondent aux traces que vous recherchez. </li><li>  Domaines, hachages, adresses IP et URL.  Ces champs affichent les traces correspondantes. </li><li>  Modules  Cet √©l√©ment de menu refl√®te la liste des modules √† l'aide desquels les donn√©es ont √©t√© enrichies et des traces d'attaques ont √©t√© d√©tect√©es.  Il existe plusieurs de ces modules et ils incluent √† la fois des solutions Cisco (par exemple, Cisco ThreatGrid, Cisco Umbrella, Cisco AMP Global Intelligence, Talos Intelligence) et des solutions tierces (par exemple, VirusTotal).  La liste de ces modules s'allonge. </li></ul><br><br><img src="https://habrastorage.org/webt/2c/gc/d_/2cgcd_-ebsbncdvvjipkwvorxny.png" alt="image"><br><br>  Etant donn√© que les agents AMP4E peuvent √™tre install√©s sur des centaines et des milliers d'ordinateurs, nous ne nous int√©ressons pas √† tous, mais seulement √† ceux qui ¬´sont pass√©s sous la distribution¬ª (s'ils l'ont fait, bien s√ªr).  En cliquant sur le champ Cible, nous obtenons une liste des n≈ìuds o√π des traces de la menace ont √©t√© trouv√©es.  Dans notre cas, ce n'est qu'un n≈ìud. <br><br><img src="https://habrastorage.org/webt/xb/dy/ir/xbdyirqf-1ga43virsmb8i9rbmk.png" alt="image"><br><br>  En cliquant sur le nom de ce n≈ìud, on obtient imm√©diatement l'aire du graphe d'interactions, qui refl√®te toutes les connexions entre les traces souhait√©es et le n≈ìud compromis. <br><br><img src="https://habrastorage.org/webt/4g/kh/yb/4gkhybixr3knbccch9sy-3eq7ro.png" alt="image"><br><br>  Il est imm√©diatement clair que seule une petite partie de l'infrastructure a √©t√© affect√©e, sur laquelle vous pouvez vous concentrer. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="image"><br><br>  Les traces trouv√©es ont √©t√© enrichies √† l'aide de divers modules, y compris des solutions tierces (dans ce cas, VirusTotal).  Cela nous permet d'√™tre plus confiants dans les r√©sultats de l'analyse, puisque la confirmation des traces trouv√©es a √©t√© obtenue de diverses sources de Threat Intelligence.  Dans ce cas, l'enqu√™te a √©t√© enrichie de donn√©es TI provenant de 5 sources: <br><br><img src="https://habrastorage.org/webt/al/y5/rm/aly5rmv0lqhgzsn6wajemvfymvu.png" alt="image"><br><br>  De nombreux indicateurs de compromis, c'est-√†-dire des sch√©mas comportementaux, ont √©t√© trouv√©s par rapport aux traces recherch√©es (19): <br><br><img src="https://habrastorage.org/webt/md/px/07/mdpx07llwqdd8bbajl2djtijqom.png" alt="image"><br><br>  La zone de l'√©cran ¬´Sightings Timeline¬ª nous montre une chronologie refl√©tant deux probl√®mes importants - quand les traces ont √©t√© trouv√©es dans notre infrastructure locale et quand elles ont √©t√© trouv√©es √† l'ext√©rieur de l'entreprise, dans le monde (les 30 derniers jours sont affich√©s afin de ne pas conduire les analystes trop loin du moment actuel )  Une telle comparaison des deux chronologies nous permet de conclure si l'activit√© malveillante est globale (et nous venons de tomber sous des distributions comme beaucoup d'autres) ou si elle √©tait focale, con√ßue sp√©cifiquement pour nous. <br><br><img src="https://habrastorage.org/webt/bg/7t/el/bg7telzembuqnsjn2tsb_ok-pk8.png" alt="image"><br><br>  Tout en bas de l'√©cran, nous verrons une section o√π vous pouvez obtenir les d√©tails de chaque piste, artefact, indicateur de compromis trouv√© et opter pour une analyse plus d√©taill√©e.  Veuillez noter que parmi toutes les traces que nous recherchons, nous n'en avons rencontr√© qu'une seule dans notre r√©seau - le hachage du fichier malveillant. <br><br><img src="https://habrastorage.org/webt/iq/k1/7b/iqk17bn0jjq1phhsycrhsjwum9e.png" alt="image"><br><br>  Par exemple, voici √† quoi ressemblent les informations sur les fichiers malveillants d√©tect√©s dans notre infrastructure avec le hachage correspondant.  Cependant, il convient de pr√™ter attention √† un point aussi important.  Pour chaque piste, nous voyons plusieurs onglets.  Le premier d'entre eux est les jugements.  On y trouve des r√©f√©rences √† divers modules qui ont ¬´vu¬ª ces traces √† un moment donn√©.  Par exemple, nous voyons que dans la base de donn√©es VirusTotal il y a un hachage correspondant et il est reconnu par diff√©rents moteurs antivirus.  Est-ce √† dire que cette menace se trouve dans notre r√©seau?  Pas encore.  Il s'agit peut-√™tre d'un ancien malware qui n'est plus valide.  Par exemple, dans le champ Expiration, il peut y avoir une note que cette trace a √©t√© enregistr√©e pour la derni√®re fois ¬´dans la nature¬ª il y a deux mois. <br><br><img src="https://habrastorage.org/webt/ia/yw/ds/iaywdsihkz8zhjjwb17hav3qpfc.png" alt="image"><br><br>  L'onglet Verdict (derni√®re phrase) est beaucoup plus important, ce qui nous permet de tirer une conclusion finale (en √©valuant diff√©rentes donn√©es, dont le r√©sultat pond√©r√© est affich√© sur l'onglet Verdict) sur la pr√©sence ou l'absence d'une menace dans notre infrastructure. <br><br><img src="https://habrastorage.org/webt/li/kb/n4/likbn4bx17o9cq1uyozhayjyxjk.png" alt="image"><br><br>  L'onglet Observations nous montre les artefacts par menace et o√π ils ont √©t√© d√©couverts: <br><br><img src="https://habrastorage.org/webt/ti/gv/de/tigvdeoqymwnpirye-snmwama9s.png" alt="image"><br><br>  L'onglet Indicateurs affiche une description d√©taill√©e de chaque indicateur inh√©rent aux traces d√©tect√©es: <br><br><img src="https://habrastorage.org/webt/qw/8t/f_/qw8tf_j1jbaqvtqasvf_qyeayfw.png" alt="image"><br><br>  Veuillez noter que nous avons une interaction avec Tor, la suppression des copies de sauvegarde, la reconnaissance antivirus et la cr√©ation d'un grand nombre d'artefacts, etc.  Dans nos bases de donn√©es Threat Intelligence, nous analysons environ 1000 indicateurs diff√©rents. <br><br><img src="https://habrastorage.org/webt/x6/qm/og/x6qmogkcwjcc-tiotzjnzgvajxc.png" alt="image"><br><br>  Apr√®s avoir re√ßu des informations sur les traces d'une attaque trouv√©es dans notre infrastructure, nous pouvons mener une enqu√™te plus d√©taill√©e en utilisant les outils qui ont fourni les donn√©es initiales √† Cisco Visibility.  Par exemple, nous pouvons ex√©cuter AMP for Endpoints afin d'obtenir une analyse d√©taill√©e d'un √©v√©nement sp√©cifique, ce qui a permis de d√©tecter une menace. <br><br><img src="https://habrastorage.org/webt/ap/zd/s8/apzds89cfirq4mbtiqopzjzim-k.png" alt="image"><br><br>  Nous voyons l'ensemble de ce qui se passe.  Fichier malveillant cr√©√© par le processus explorer.exe √† 20h00, heure de Moscou, le 15 juillet.  Nous voyons o√π se trouve ce fichier et les valeurs de ses hachages selon diff√©rents algorithmes (SHA1 et MD5). <br><br><img src="https://habrastorage.org/webt/dk/a8/6g/dka86gxg9965skwqvay02uehgyw.png" alt="image"><br><br>  En utilisant la technologie de s√©curit√© r√©trospective et le m√©canisme de visualisation de Device Trajectory, nous pouvons visualiser toutes les actions r√©alis√©es ou r√©alis√©es par le fichier qui nous int√©resse.  Dans ce cas, nous voyons que l'objet fichier t.exe cr√©√© par le processus explorer.exe a lanc√© l'utilitaire Windows compl√®tement l√©gal - vssadmin.exe, qui g√®re les clich√©s instantan√©s et, entre autres, est souvent utilis√© par les chiffreurs pour les supprimer (de sorte qu'il ne peut pas √™tre restaur√© donn√©es chiffr√©es).  Si vous regardez la description de TeslaCrypt, nous verrons que ce chiffreur utilise vssadmin dans ses activit√©s. <br><br><img src="https://habrastorage.org/webt/dr/se/pu/drsepug7_ofjtv-4usydyseb4dq.png" alt="image"><br><br>  Soit dit en passant, nous avons r√©cemment mis √† jour le m√©canisme de trajectoire des p√©riph√©riques et maintenant, il semble un peu diff√©rent: <br><br><img src="https://habrastorage.org/webt/eg/bi/zt/egbiztnnll_m0roakbxmb44iztq.png" alt="image"><br><br>  Dans l'exemple ci-dessus, le fichier t.exe n'a pas √©t√© bloqu√© et n'a pas √©t√© mis en quarantaine, bien que ce soit exactement ce que fait AMP for Endpoints dans la vie r√©elle.  Mais pour les besoins de cet article, AMP4E fonctionne en mode audit, ce qui vous permet de surveiller les √©v√©nements, mais pas de les bloquer.  Soit dit en passant, si PowerShell √©tait lanc√© √† la place de vssadmin (√©galement un outil d'administration syst√®me compl√®tement l√©gal), nous verrions cela et les param√®tres de ligne de commande utilis√©s dans PowerShell. <br><br>  Donc, en bref, cela ressemble √† travailler avec Cisco Visibility tout en recherchant des traces de menaces dans l'infrastructure locale et en enrichissant les √©v√©nements de s√©curit√© existants avec des donn√©es provenant de diverses sources de Threat Intelligence. <br><br>  PS: Cisco Visibility est bas√© sur le mod√®le Cisco Threat Intelligence (CTIM) que nous avons d√©velopp√©, qui, √† son tour, est bas√© sur la norme de communication Threat Intelligence - STIX.  Mais contrairement √† STIX, le mod√®le CTIM ne se concentre pas sur la formalisation du format des donn√©es sur les menaces, mais sur le processus de collecte, de stockage et d'analyse de ces donn√©es.  Sur la base de l'API Cisco Threat Intelligence (c'est un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">projet open source</a> et il peut √™tre utilis√© dans vos solutions), nous pr√©voyons d'√©largir la liste des sources avec lesquelles nous travaillerons, √† la fois en termes de r√©ception d'√©v√©nements de s√©curit√© et en termes de r√©ception de donn√©es Threat Intelligence.  De plus, nous pr√©voyons d'ajouter √† Cisco Visibility la possibilit√© de travailler non seulement avec des indicateurs atomiques de compromis (IP, hachage, domaine, URL), mais √©galement avec des donn√©es de vuln√©rabilit√© (CVE), des programmes de configuration (CWE) et une base de donn√©es de mod√®les d'attaque (CAPEC) et une base de connaissances sur les m√©thodes, tactiques et proc√©dures des attaquants (ATT &amp; CK).  Ce travail est en cours. <br><br>  PPS: Au d√©but de la note, j'√©tais un peu rus√©.  Cisco Visibility est en effet une solution gratuite, mais pour l'utiliser, vous devez au moins avoir Cisco AMP for Endpoints install√© dans votre organisation (et o√π obtenir les donn√©es pour la chasse aux menaces?).  Il est √©galement souhaitable (mais pas n√©cessaire) d'avoir acc√®s aux services Cisco Threat Grid (sandbox) et Cisco Umbrella (analyse DNS).  Dans ces cas, il sera possible d'effectuer une analyse plus approfondie des menaces (traces et indicateurs) d√©j√† dans les services sp√©cifi√©s lanc√©s depuis Cisco Visibility.  Et bien s√ªr, vous devez avoir acc√®s √† des services Threat Intelligence externes qui s'int√®grent √† Cisco Visibility.  Jusqu'√† pr√©sent, il ne s'agit que de VirusTotal (mais nous ne sommes pas en reste et nous augmenterons leur nombre), acc√®s auquel tout le monde peut acc√©der. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417345/">https://habr.com/ru/post/fr417345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417329/index.html">Vous et Brad Pitt √™tes √† 99%</a></li>
<li><a href="../fr417331/index.html">Security Week 26: Spectre mis √† jour, maintenant un enregistrement de bon go√ªt</a></li>
<li><a href="../fr417333/index.html">√âvaluation sociale</a></li>
<li><a href="../fr417337/index.html">Principes de fonctionnement et caract√©ristiques d'application du swap atomique</a></li>
<li><a href="../fr417339/index.html">3DTouch - √âchelles sur iPhone: ach√®vement</a></li>
<li><a href="../fr417349/index.html">√âchange de donn√©es et √©quations diff√©rentielles</a></li>
<li><a href="../fr417353/index.html">L'Allemagne approuve l'utilisation de trains de piles √† combustible √† hydrog√®ne</a></li>
<li><a href="../fr417355/index.html">Calvitie: th√©orie et pratique du traitement, partie 2 ¬´M√™me la prostate a des amygdales, des prostaglandines¬ª</a></li>
<li><a href="../fr417357/index.html">Ordinateurs de bureau ¬´√Ä propos des TI¬ª. Histoire des jeux sur ordinateur</a></li>
<li><a href="../fr417359/index.html">S√©curit√© de l'information? Non pas entendu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>