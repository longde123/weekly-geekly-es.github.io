<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèø üë©üèº‚Äçüîß üìí Protocolo MQTT y proyecto de cliente abierto MQTT en Delphi üôÄ üßñüèø ü§™</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El protocolo MQTT se usa para mensajes en Internet de las cosas. En primer lugar, es interesante porque es compatible con los mayores proveedores de s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Protocolo MQTT y proyecto de cliente abierto MQTT en Delphi</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/388231/"><img align="left" src="https://habrastorage.org/files/335/d26/6d4/335d266d4c4943fcb2b3dd3c3aec0cef.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El protocolo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se usa para mensajes en Internet de las cosas. </font><font style="vertical-align: inherit;">En primer lugar, es interesante porque es compatible con los mayores proveedores de servicios en la nube, como IBM, Microsoft, Amazon. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puede obtener una cuenta en estos servicios de forma gratuita, configurar un servicio para recibir mensajes MQTT all√≠ y ver la vida de sus dispositivos a trav√©s de estos servicios, por ejemplo, en un hogar inteligente. </font><font style="vertical-align: inherit;">Adem√°s, a trav√©s de estos servicios, los dispositivos pueden comunicarse entre s√≠. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se incluye una demostraci√≥n de la conexi√≥n del cliente al servicio MQTT de la nube IBM Bluemix.</font></font><br>
<br>
<a name="habracut"></a><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Breve descripci√≥n</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MQTT es extremadamente primitivo: con un encabezado corto, sin control de integridad, no impone ninguna restricci√≥n en la estructura, codificaci√≥n o esquema de datos. </font><font style="vertical-align: inherit;">El √∫nico requisito de datos en cada paquete es que deben ir acompa√±ados de un identificador para el canal de informaci√≥n. </font><font style="vertical-align: inherit;">Este identificador en la especificaci√≥n se llama Nombre del tema o un tema m√°s simple. </font><font style="vertical-align: inherit;">Los datos se transmiten a los paquetes a trav√©s de TCP. </font><font style="vertical-align: inherit;">La cantidad de datos en un paquete puede ser de un byte a 268,435,455 bytes. </font><font style="vertical-align: inherit;">Muy flexible! </font><font style="vertical-align: inherit;">Aunque los servicios de nube p√∫blica imponen restricciones m√°s estrictas, hasta varios kilobytes.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El protocolo MQTT requiere un intermediario de datos. </font><font style="vertical-align: inherit;">Esta es la idea central de la tecnolog√≠a. </font><font style="vertical-align: inherit;">Todos los dispositivos env√≠an datos solo al agente y tambi√©n reciben datos de √©l. </font><font style="vertical-align: inherit;">Un corredor es un programa que act√∫a como un servidor TCP con una base de datos din√°mica.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La base de datos del agente en particular contiene una tabla con todos los paquetes recibidos con indexaci√≥n por temas de estos paquetes. </font><font style="vertical-align: inherit;">Al recibir el paquete, el agente lo env√≠a a todos los dispositivos en la red de acuerdo con su suscripci√≥n. </font><font style="vertical-align: inherit;">Para que el dispositivo reciba algo del intermediario, debe suscribirse al tema. </font><font style="vertical-align: inherit;">Los temas surgen din√°micamente con la suscripci√≥n o con la llegada de un paquete con este tema. </font><font style="vertical-align: inherit;">Tambi√©n puede darse de baja del tema. </font><font style="vertical-align: inherit;">Por lo tanto, los temas son un mecanismo conveniente para organizar relaciones de diferentes tipos: uno a muchos, muchos a uno y muchos a muchos. </font><font style="vertical-align: inherit;">Si el paquete no tiene un suscriptor, se descarta. </font><font style="vertical-align: inherit;">Si el suscriptor no est√° conectado, el paquete se elimina inmediatamente en la base de datos del intermediario o espera a que el suscriptor se conecte durante un tiempo especificado en la configuraci√≥n. </font><font style="vertical-align: inherit;">El comportamiento est√° determinado por el atributo QoS del paquete.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øQu√© m√°s es importante aqu√≠?</font></font></h1> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Los dispositivos son los primeros en establecer contacto con un corredor. Es decir los dispositivos pueden estar ubicados detr√°s de traductores de direcciones de red (NAT) y pueden no tener direcciones IP est√°ticas y esto no interferir√° con la comunicaci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ SSL se puede usar para cifrar el tr√°fico. Pero puede trabajar sin SSL incluso con los servicios de IBM, lo que facilita la depuraci√≥n. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ En casos extremadamente dif√≠ciles, los corredores MQTT le permiten conectarse a ellos a trav√©s del protocolo WebSocket en el puerto 80. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ El puerto del protocolo MQTT est√°ndar tambi√©n se puede cambiar arbitrariamente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Tanto el cliente / clientes con una interfaz gr√°fica de usuario como el agente pueden ubicarse en la misma computadora. Es decir La soluci√≥n puede ser absolutamente local y escalarse a global con un solo clic.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Los diferentes corredores pueden conectarse entre s√≠ suscribi√©ndose a mensajes entre ellos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ El concepto de temas encaja bien con la tecnolog√≠a de base de datos NoSQL. </font><font style="vertical-align: inherit;">Con el mismo prop√≥sito, los servicios en la nube alientan a los usuarios a usar la codificaci√≥n de datos JSON.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proyectos abiertos</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La elecci√≥n de los corredores MQTT es bastante grande. Pero, curiosamente, pr√°cticamente no hay clientes convenientes con una interfaz de usuario de Windows en Windows. Y tal cliente para dominar el protocolo MQTT es simplemente necesario porque hay muchos matices pr√°cticos del trabajo de los corredores m√°s all√° del alcance de las especificaciones, y todos ellos deben estudiarse y probarse de alguna manera. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se decidi√≥ implementar el cliente MQTT en Delphi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Google for Delphi solo puede ofrecer el componente TMQTTClient. Pero este es un componente antiguo y que no funciona. La mayor√≠a de los otros clientes escritos en Java, Erlang, Haskell, Javscript en Delphi son muy dif√≠ciles de integrar. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontramos el √∫nico proyecto adecuado - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Escrito en puro C-i. </font><font style="vertical-align: inherit;">Se compila para diferentes sistemas operativos. </font><font style="vertical-align: inherit;">Tiene scripts de generaci√≥n de proyectos para Visual Studio. </font><font style="vertical-align: inherit;">A la salida de Windows obtenemos archivos dll con la implementaci√≥n de la funcionalidad de cliente y agente. </font><font style="vertical-align: inherit;">El uso de C es alentador en t√©rminos de velocidad. </font><font style="vertical-align: inherit;">Y las bibliotecas din√°micas escritas en C se conectan f√°cilmente a los programas de Delphi. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Delphi, representado por Embarcadero RAD Studio XE8, es una herramienta muy poderosa para crear interfaces de usuario flexibles y convenientes para Windows, especialmente si est√° equipado con DevExpress, TeeChart, RxLib, FireDAC, etc.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Herramientas necesarias</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Necesitaremos el entorno de desarrollo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS Visual Studio 2015</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Compilar√° el proyecto </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y todos los proyectos de apoyo de los que depende </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Alternativamente, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Windows</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se puede compilar usando el paquete </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cygwin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero Visual Studio parec√≠a m√°s conveniente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para generar archivos de proyecto de Visual Studio, debe descargar e instalar la utilidad </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmake</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fuente </font></font><b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cmake.org</font></font></a></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Y, por supuesto, necesita </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAD Studio XE8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Adem√°s, en RAD Studio, se debe instalar la </font><font style="vertical-align: inherit;">versi√≥n del </font><font style="vertical-align: inherit;">paquete de componentes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DevExpress VCL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no inferior a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14.2.2</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Aunque esto no es de importancia fundamental, el dise√±o de la interfaz de usuario se puede rehacer f√°cilmente para los componentes est√°ndar de RAD Studio.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procedimiento de instalaci√≥n de software</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mosquitto depende de varios proyectos de terceros, estos son: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSSL v 1.0.2e</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fuente: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://slproweb.com/download/Win32OpenSSL-1_0_2e.exe</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
‚Ä¢ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pthreads v 2.9.1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fuente: </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ftp://sourceware.org/pub/pthreads-win32/pthreads-w32-2-9-1-release.zip</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
‚Ä¢ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Libwebsockets v 1.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Fuente: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/warmcat/libwebsockets</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Descargue estos proyectos. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compilamos </font><b><font style="vertical-align: inherit;">OpenSSL</font></b><font style="vertical-align: inherit;"> , pero tomamos inmediatamente los dos archivos necesarios desde all√≠: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libeay32.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ssleay32.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del directorio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . A menudo sucede que ya est√°n instalados en la computadora desde otros proyectos. Esto debe ser verificado. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pthreads</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tampoco </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">compilamos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero tomamos el archivo </font><b><font style="vertical-align: inherit;">pthreadVC2.dll</font></b><font style="vertical-align: inherit;"> ya compilado </font><font style="vertical-align: inherit;">del directorio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dll \ x86</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Libwebsockets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> viene sin archivos precompilados y sin un proyecto para Visual Studio, pero tiene un archivo de configuraci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMakeLists.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En este caso, utilizando la utilidad </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cmake</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font><font style="vertical-align: inherit;">generamos el archivo de proyecto de Visual Studio en un directorio separado (directorio libwebsockets_VS_proj). Y luego abriendo el archivo de proyecto generado en Visual Studio compilamos. Obtenemos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> archivo </font><b><font style="vertical-align: inherit;">websockets.dll que necesitamos</font></b><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de todos los pasos anteriores, puede compilar el proyecto </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Aqu√≠, primero debe generar el archivo de proyecto de Visual Studio (directorio Mosquitto_VS_proj) desde el archivo de configuraci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CMakeLists.txt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adjunto </font><font style="vertical-align: inherit;">. El proyecto generado no funciona del todo, tendr√° que cambiar las rutas a algunos archivos de encabezado y bibliotecas externas, incluir algunas macros en el proyecto y modificar ligeramente los textos fuente. Como resultado, obtenemos el archivo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para simplificar, todos los archivos y la estructura de directorios con los proyectos mencionados est√°n contenidos en el archivo adjunto al art√≠culo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Junto con la biblioteca del cliente, la compilaci√≥n del proyecto </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos proporciona el archivo ejecutable del agente MQTT: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, obtenemos de inmediato tanto el cliente como el agente MQTT, es decir, </font><font style="vertical-align: inherit;">casi todo lo que necesita para organizar un Internet efectivo de las cosas.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear un proyecto de cliente MQTT en Delphi</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para integrar la biblioteca </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.dll</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en Delphi, </font><font style="vertical-align: inherit;">debe crear un m√≥dulo de declaraciones de funciones de biblioteca en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Object Pascal</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Para ello, la conversi√≥n de archivos se ha realizado </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto.h</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> archivo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MOSQUITTO.PAS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El proyecto del cliente es muy simple, consta de solo 4 archivos de origen. </font><font style="vertical-align: inherit;">El cliente demuestra la conexi√≥n y desconexi√≥n, formando un testamento ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Will</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), enviando datos con el paquete </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH al</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intermediario, recibiendo datos con el paquete </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del intermediario, suscribi√©ndose y cancelando la suscripci√≥n.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El programa guarda todos los atributos de conexi√≥n, referidos por el t√©rmino perfil en la tabla de perfil almacenada en el disco. </font><font style="vertical-align: inherit;">Los registros de los paquetes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PUBLISH</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recibidos y enviados tambi√©n se guardan en el disco por separado </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©todo de uso del cliente</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ejecute el archivo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMQTTC.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Con el fin de tener a alguien para comunicar el equipo corredor de prueba de funcionamiento </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Run_mosquitto.cmd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el directorio </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto_1_4_5_bin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Por conveniencia, el corredor est√° configurado para conectarse sin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SSL</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y verificaci√≥n de contrase√±a. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Complete los campos como en la captura de pantalla. </font></font><br>
<br>
<img width="1000" src="https://habrastorage.org/files/6df/303/805/6df303805cb246feb6acc16236e0277a.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La contrase√±a y el nombre de usuario son opcionales. En el navegador, haga clic en el bot√≥n de confirmaci√≥n para guardar los datos en la tabla. Luego haga clic en el bot√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conectar</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de la conexi√≥n, los comandos de publicaci√≥n y suscripci√≥n estar√°n disponibles. Los comandos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PING</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cliente </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mosquitto</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> genera de forma autom√°tica.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para que el cliente obtenga algo, debe volver a ejecutar el programa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMQTTC.exe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> con un identificador de cliente diferente y suscribir un cliente para recibir datos de otro.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Con√©ctese a IBM Bluemix</font></font></h1><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lo primero que debe hacer es obtener una cuenta en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Despu√©s de recibir una cuenta, vamos a nuestro panel de control en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aqu√≠ debe cambiar inmediatamente a la regi√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> los </font><b><font style="vertical-align: inherit;">EE</font></b><font style="vertical-align: inherit;"> . </font><b><font style="vertical-align: inherit;">UU</font></b><font style="vertical-align: inherit;"> . Para hacer esto, haga clic en el icono de la cuenta en la esquina superior derecha y cambie el valor en el campo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regi√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hay tres regiones en total, pero </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US South</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le brinda la oportunidad de experimentar la mayor√≠a de los servicios. Luego, crea el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">espacio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . La pantalla deber√≠a verse como un disparo de abajo. Aqu√≠, se </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la organizaci√≥n </font><i><font style="vertical-align: inherit;">INDEMSYS</font></i><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Space </font></font></b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">INDEMSYS SPACE</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<img width="800" src="https://habrastorage.org/files/e8e/a9d/daf/e8ea9ddaf89c47b299f6766b5012948c.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora haga clic en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CAT√ÅLOGO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el men√∫ superior. Bajamos al fondo y elegimos</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fundaci√≥n Internet de las Cosas</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<img width="800" src="https://habrastorage.org/files/b34/edd/4d1/b34edd4d15b848cb9a70d5b53a218538.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No cambiamos los campos propuestos de forma predeterminada y hacemos clic en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear </font></font></b><br>
<img width="800" src="https://habrastorage.org/files/615/b4f/d12/615b4fd125b44adebeba93ec77725d8e.png"><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of Things Foundation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; este es un servicio que incluye el agente </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y la interfaz de usuario. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Despu√©s de crear en la ventana que aparece, haga clic en el bot√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lanzar panel de control</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img width="800" src="https://habrastorage.org/files/b9e/00f/6e1/b9e00f6e1f7d4381ab7d95220998f722.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este es un panel de control de IoT. Ahora necesitamos crear dispositivos. Haz clic en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregar dispositivo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En los cuadros de di√°logo que aparecen, cree un tipo de dispositivo ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Crear tipo de dispositivo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). D√©le el nombre Tipo1, no complete los campos restantes por simplicidad. Haga clic en Siguiente -&gt; Siguiente -&gt; Crear -&gt; Siguiente. D√© el nombre al dispositivo Dispositivo1. Siguiente Siguiente -&gt; Siguiente -&gt; Siguiente -&gt; Agregar. Como resultado, obtenemos la siguiente ventana:</font></font><br>
<img width="800" src="https://habrastorage.org/files/ce8/dcc/0b2/ce8dcc0b2a7f41d39f1545be3a0ee014.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eso es todo, aqu√≠ tenemos todos los detalles para conectar nuestro primer dispositivo al </font><font style="vertical-align: inherit;">agente </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MQTT </font></font></b><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Probaremos si nuestro cliente puede conectarse a √©l. Ingrese los detalles en la ventana del cliente. </font></font><br>
<img width="1000" src="https://habrastorage.org/files/23e/469/94b/23e46994b94b4621b8aeb93a17fd5c5e.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como puede ver, el cliente se conect√≥ con √©xito a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Aqu√≠ debe prestar atenci√≥n al nombre del host. Comienza con la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">identificaci√≥n de</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> la </font><b><font style="vertical-align: inherit;">organizaci√≥n</font></b><font style="vertical-align: inherit;"> obtenida al crear la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of Things Foundation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . El campo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID de usuario</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tambi√©n </font><font style="vertical-align: inherit;">es </font><font style="vertical-align: inherit;">compuesto y est√° codificado como: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID de organizaci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;: &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tipo de dispositivo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;: &lt; </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ID de dispositivo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &gt;. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> campo </font><b><font style="vertical-align: inherit;">Nombre de usuario</font></b><font style="vertical-align: inherit;"> contiene una cadena fija</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">use-token-auth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los temas de mensaje para el agente de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bluemix</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a diferencia del agente de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mosquitto,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no pueden contener datos arbitrarios. </font><font style="vertical-align: inherit;">Est√°n codificados de acuerdo con ciertas reglas. </font><font style="vertical-align: inherit;">Estas reglas deben estudiarse en la documentaci√≥n de la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet of Things Foundation</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">La captura de pantalla muestra uno de los posibles temas v√°lidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Repositorio del proyecto: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/Indemsys/Delphi_MQTT_mosquitto</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es388231/">https://habr.com/ru/post/es388231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es388221/index.html">Seagate: Winchesters se quedar√° con nosotros por otros 20 a√±os.</a></li>
<li><a href="../es388223/index.html">Memorias de un robot infrahumano, cap√≠tulos 1-2, segundo intento</a></li>
<li><a href="../es388225/index.html">¬øQu√© es la cristalograf√≠a evolutiva y por qu√© est√° el futuro detr√°s de ella? Casi complicado</a></li>
<li><a href="../es388227/index.html">Investigaci√≥n de infograf√≠a: tienda electr√≥nica de a√±o nuevo en l√≠nea</a></li>
<li><a href="../es388229/index.html">Uso de iRidium para controlar sistemas de automatizaci√≥n basados ‚Äã‚Äãen el protocolo Z-Wave</a></li>
<li><a href="../es388233/index.html">Viaje a trav√©s de la Rusia microelectr√≥nica (parte acad√©mica)</a></li>
<li><a href="../es388235/index.html">Volkswagen propuso medidas correctivas para motores diesel adoptadas por funcionarios europeos</a></li>
<li><a href="../es388237/index.html">La polic√≠a del Reino Unido cre√≥ una "banda de karaoke" de tres entusiastas de karaoke de edad avanzada</a></li>
<li><a href="../es388241/index.html">¬øPor qu√© las empresas realizan OPI? Pros y contras</a></li>
<li><a href="../es388243/index.html">Vigilancia dom√©stica y visualizaci√≥n remota a trav√©s de Internet.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>