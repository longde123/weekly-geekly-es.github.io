<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòî üë©üèº‚ÄçüöÄ ü§æ Programaci√≥n para ingenieros de redes: trabajar con la configuraci√≥n üïπÔ∏è üì∞ ü•ó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Incluso en una buena red, desde el punto de vista del dise√±o, de vez en cuando es necesario realizar trabajos para actualizar las configuraciones de c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programaci√≥n para ingenieros de redes: trabajar con la configuraci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413427/">  Incluso en una buena red, desde el punto de vista del dise√±o, de vez en cuando es necesario realizar trabajos para actualizar las configuraciones de ciertas entidades.  Entre las razones m√°s convincentes y anticipadas para tal actividad, se puede observar que la migraci√≥n coordina los planos f√≠sico y l√≥gico, el desarrollo de la red como parte del proceso de evoluci√≥n tecnol√≥gica, la armonizaci√≥n de la arquitectura de los segmentos conectados y la soluci√≥n de problemas de crecimiento.  De hecho, el ciclo de vida de una red casi siempre consiste en cambios con uno u otro nivel de riesgo y un efecto distorsionado en un servicio, en cuya evaluaci√≥n no se puede ignorar el factor humano.  Aunque ser√° bastante apropiado generalizar esta descripci√≥n a la mayor√≠a de las √°reas de la actividad humana, el funcionamiento de las redes de comunicaci√≥n tiene algunas caracter√≠sticas que merecen comprensi√≥n, o al menos atenci√≥n, los elementos de las redes de comunicaci√≥n est√°n en comunicaci√≥n estrecha, interact√∫an estrechamente y se vuelven no solo directos, sino tambi√©n indirectos. impacto el uno en el otro.  Por lo tanto, una estrategia competente del trabajo en curso solo ser√° m√°s productiva si se apoya en mecanismos que reduzcan, en la medida de lo posible, la probabilidad de errores humanos.  En el pr√≥ximo art√≠culo de la serie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Por qu√© deber√≠an programar los ingenieros de red",</a> hablar√© sobre las opciones para usar la automatizaci√≥n en una tarea de este tipo. <br><a name="habracut"></a><br>  En muchos "iniciadores" en la arquitectura de red, los t√©rminos redes a gran escala y redes jer√°rquicas se usan casi como sin√≥nimos, con respecto al dise√±o de un dominio IGP, se indica un dise√±o simple y, a primera vista, comprensible: dividir un dominio en dominios.  Al mismo tiempo, el umbral de saturaci√≥n es una cuesti√≥n puramente individual; en algunos casos, mil enrutadores modernos pueden coexistir normalmente en una regi√≥n IGP; de lo contrario, trescientos son suficientes para reducir significativamente las caracter√≠sticas operativas.  En su mayor parte, este umbral est√° determinado por los protocolos impuestos al IGP, por lo tanto, en condiciones de cierta variabilidad e incertidumbre de los l√≠mites y la escala de la red futura, el "bisonte" de la industria encuentra una forma m√°s flexible de construir un dominio plano con la posterior migraci√≥n de sus partes formadas a √°reas separadas.  En otras palabras, si no puede "mirar ma√±ana ma√±ana", construya una red plana y div√≠dala ante la aparici√≥n de los primeros signos de degradaci√≥n del tiempo de convergencia o complejidad de explotaci√≥n excesiva, porque la ausencia de una jerarqu√≠a sigue siendo mejor que la incorrecta elegida bajo incertidumbre estructura [1, 2, 3]. <br><br>  Descripciones bastante generales y ejemplos abstractos, supongamos que estamos tratando con una regi√≥n demasiado grande del dominio OSPFv2, cuya topolog√≠a de las fibras / canales f√≠sicos ya permite discernir los l√≠mites de las regiones futuras en la estructura amorfa.  No soy partidario de cambiar algo seg√∫n el principio de "todo o nada", puede suceder que debido a circunstancias imprevistas el espacio de oportunidades se vuelva demasiado estrecho y los riesgos esperados sean demasiado grandes.  Cambiar la regi√≥n OSPFv2 es una operaci√≥n destructiva, por lo tanto, el esquema m√°s directo del proceso de migraci√≥n, que consiste en transferir enrutadores secuencialmente a una nueva regi√≥n a lo largo del futuro, es conveniente en todas las topolog√≠as.  Afortunadamente, hace alg√∫n tiempo, en las recomendaciones para el desarrollo de OSPF, se describi√≥ la posibilidad de construir conectividad en varias √°reas [4].  Aprovechando esta oportunidad, podemos dividir la migraci√≥n en tres etapas: <br><br><ol><li>  Construyendo conectividad adicional (secundaria) en una nueva √°rea </li><li>  Transferencia de un √°rea nueva al modo principal, y la antigua a adicional </li><li>  Eliminar la conectividad dentro del alcance anterior </li></ol><br>  En la primera etapa, la topolog√≠a de la nueva regi√≥n se est√° expandiendo gradualmente; en la segunda, la topolog√≠a de la regi√≥n anterior se est√° reduciendo.  Sujeto a la congruencia de las topolog√≠as de las √°reas antiguas y nuevas, obtenemos un enrutamiento constante entre los nodos traducidos y no traducidos, y esto, a su vez, permite dividir las etapas en sub-etapas independientes, en cada una de las cuales se puede trabajar con alguna parte de los nodos.  Es aconsejable abordar la elecci√≥n de los nodos para el trabajo en el marco de la sub-etapa desde el punto de vista de la utilizaci√≥n real de los canales en una red en particular para evitar la recarga en el borde de las √°reas antiguas y nuevas.  A pesar de que el art√≠culo est√° dedicado a la programaci√≥n, creo que no ser√≠a superfluo decir algunas palabras sobre el comportamiento de los protocolos impuestos a IGP en el contexto de los dominios cambiantes.  LDP se comporta de manera bastante predecible; la traducci√≥n fluida se logra al proporcionar conectividad IP entre las direcciones de transporte y las sesiones de interfaz.  Debido al hecho de que BGP es un protocolo muy flexible, debe prestar mucha atenci√≥n a este avi√≥n.  Es bueno si BGP no introduce libertades especiales en los nodos traducidos en forma de cambios en las preferencias locales u otros criterios que determinan la decisi√≥n de enrutamiento local inconsistente entre los nodos.  En otras palabras, el comportamiento de BGP tambi√©n es predecible si la selecci√≥n de ruta dentro de la regi√≥n no contradice la siguiente regla de ruta IGP.  Hay un punto sutil asociado con el trabajo de RSVP durante el per√≠odo de tiempo de la coexistencia de dos √°reas.  El hecho de llenar la tabla TED de dos fuentes con visibilidad diferente arroja la base para pensar, por ejemplo, puede perder los mecanismos FRR hasta que se complete el trabajo.  Esto puede suceder si los enrutadores con mayor visibilidad, que se encuentran en dos √°reas, calculan ERO a trav√©s de un enrutador con menos visibilidad, es decir  a trav√©s de un segmento de red traducido sin informaci√≥n topol√≥gica sobre otra √°rea.  Esto no se puede llamar un desastre, ya que el camino finalmente se establecer√°, pero no debe olvidarse de ello.  El arte especial requiere combinar el trabajo de introducir jerarqu√≠as IGP con el mismo tipo de trabajo en el plano BGP, por ejemplo, migrando la malla completa a reflectores de ruta.  La introducci√≥n de jerarqu√≠as en diferentes planos es mejor llevarse a cabo secuencialmente, lo mismo, en mi opini√≥n, se aplica a todas las cosas que ocultan informaci√≥n de enrutamiento, el resumen es m√°s f√°cil de construir sobre una base estable de IGP jer√°rquico que combinar estas etapas. <br><br>  Entonces, tenemos un plan general, y si a√∫n no ha cambiado de opini√≥n, pensemos en una implementaci√≥n de software en Pyez, algo como este en la figura. <br><br><img src="https://habrastorage.org/webt/xm/0v/4s/xm0v4shfndzjxnvn1rirhmajgdq.png" alt="imagen"><br><br>  Cada hermoso √≥valo puede ser una entidad de software separada, es decir  algo que hace el trabajo y prepara los datos para el siguiente paso.  Los datos iniciales significan informaci√≥n de la red, por ejemplo, para preparar la configuraci√≥n de una nueva √°rea OSPF, debe obtener los nombres de las interfaces activas que pertenecen al √°rea anterior y su peso, lo que significa que necesitaremos habilidades para trabajar con tablas y vistas de Operaci√≥n.  Estos conceptos se pueden encontrar en un art√≠culo anterior de la serie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Programaci√≥n para ingenieros de redes: el primer caso"</a> .  En la primera etapa, el generador guarda en los archivos los comandos necesarios para activar la nueva √°rea, en la segunda, para eliminar la antigua y transferir la nueva al modo principal, en la tercera, el comando para eliminar la antigua √°rea.  Mirando hacia el futuro, dir√© que para este art√≠culo intencionalmente no uso visualizadores de plantillas como Jinja2.  Para no distraerse del tema de destino, el c√≥digo se escribe lo m√°s simple posible.  Si alguien est√° interesado en la documentaci√≥n en el enlace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Documentaci√≥n Jinja2"</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Paso C√≥digo de generaci√≥n de configuraci√≥n</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) yml = <span class="hljs-string"><span class="hljs-string">''' --- OSPFInterface: rpc: get-ospf-interface-information args: area: '0.0.0.200' detail: True item: ospf-interface view: OSPFInterfaceView OSPFInterfaceView: fields: name: interface-name type: interface-type cost: interface-cost '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) ospf_interfaces = OSPFInterface(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st1-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-string"><span class="hljs-string">'ge'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interface.name ): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st2-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.250'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ospf_interface <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ospf_interfaces: f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' secondary'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' interface-type p2p'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ospf_interface.cost != <span class="hljs-string"><span class="hljs-string">'0'</span></span>): f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.250 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) f_st1.write(<span class="hljs-string"><span class="hljs-string">'set protocols ospf area 0.0.0.200 interface '</span></span> + ospf_interface.name + <span class="hljs-string"><span class="hljs-string">' metric '</span></span> + ospf_interface.cost + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'st3-'</span></span> + node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_st1: f_st1.write(<span class="hljs-string"><span class="hljs-string">'delete protocols ospf area 0.0.0.200'</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>)</code> </pre> <br></div></div><br>  Para mayor claridad, lo arm√© en una red de este tipo en vMX. <br><br><img src="https://habrastorage.org/webt/mk/hr/6i/mkhr6ig4wjo3n4hxkswba2xej4q.png" alt="imagen"><br><br>  vMX es un enrutador de software con todas las funciones de Juniper Networks, que repite en gran medida el comportamiento de su antiguo hermano de hierro MX.  No es que se tratara de un producto que deba presentarse, solo es √∫til tener estas cosas a mano para programar ejercicios o pruebas de laboratorio.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La versi√≥n de prueba</a> se puede descargar aqu√≠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Descarga de prueba de vMX"</a> , y las instrucciones de instalaci√≥n en este enlace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Preparaci√≥n del sistema para instalar vMX"</a> . <br><br>  Los enrutadores bb, abr1 y abr2 forman la regi√≥n cero, los enrutadores r1, r2, r3 y r4 deben moverse de la regi√≥n 200 a la 250. <br><br><div class="spoiler">  <b class="spoiler_title">lab @ bb&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { passive; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ abr1&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ abr2&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } } area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">lab @ r1&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r2&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r3&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">lab @ r4&gt; mostrar protocolos de configuraci√≥n</b> <div class="spoiler_text"><pre> <code class="1c hljs">bgp { group int { type internal; local-address <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.71</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.65</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.66</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.67</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.68</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.69</span></span>; neighbor <span class="hljs-number"><span class="hljs-number">10.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.70</span></span>; } } ospf { area <span class="hljs-number"><span class="hljs-number">0.0</span></span>.<span class="hljs-number"><span class="hljs-number">0.200</span></span> { interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">1.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">2.0</span></span> { interface-type p2p; } interface ge-<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span>/<span class="hljs-number"><span class="hljs-number">3.0</span></span> { interface-type p2p; } interface lo0.<span class="hljs-number"><span class="hljs-number">0</span></span> { interface-type p2p; } } }</code> </pre> <br></div></div><br>  Para el enrutador r2, se generar√° el siguiente conjunto de comandos. <br><br><div class="spoiler">  <b class="spoiler_title">Para la primera etapa</b> <div class="spoiler_text">  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 1.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 1.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 1.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 2.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 2.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 2.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 3.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf interfaz 0.0.0.250 ge-0/0 / 3.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 3.0 m√©trica 1</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para la segunda etapa</b> <div class="spoiler_text">  <i>eliminar protocolos √°rea ospf 0.0.0.200</i> <i><br></i>  <i>eliminar protocolos √°rea ospf 0.0.0.250</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 1.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 1.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 1.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 1.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 1.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 2.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 2.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 2.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 2.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 2.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf interfaz 0.0.0.250 ge-0/0 / 3.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 3.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 3.0 interfaz tipo p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz ge-0/0 / 3.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz ge-0/0 / 3.0 m√©trica 1</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.250 interfaz lo0.0 tipo de interfaz p2p</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz lo0.0 secundaria</i> <i><br></i>  <i>establecer protocolos √°rea ospf 0.0.0.200 interfaz lo0.0 tipo de interfaz p2p</i> <i><br></i> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Para la tercera etapa</b> <div class="spoiler_text">  <i>eliminar protocolos √°rea ospf 0.0.0.200</i> <i><br></i> <br></div></div><br>  Como ya escrib√≠, los elementos de la red tienen un estado interno, alrededor y dentro de ellos sucede constantemente algo, independientemente de si lo queremos o no.  La ocurrencia de eventos como la falla del transceptor, un corte de energ√≠a en un nodo o una interrupci√≥n en un canal √≥ptico debe darse por sentado y tenerse en cuenta durante el trabajo.  Propongo prestar atenci√≥n a este hecho en el contexto de la elecci√≥n de la verificaci√≥n del √©xito de las etapas de migraci√≥n.  No importa cu√°n parad√≥jico pueda sonar, en este caso no es necesario que verifiquemos si el vecindario OSPF apareci√≥ en esta o aquella interfaz, ya que las razones de su ausencia pueden estar en un plano completamente diferente.  Adem√°s de lo anterior, un error o inexactitud siempre puede entrar en los datos de origen, por ejemplo, en forma de una interfaz olvidada que debe eliminarse, pero que actualmente est√° buscando en el "vac√≠o".  En el proceso de generar inspecciones, es √∫til subir un nivel para mirar la red desde el punto de vista de los servicios prestados y los protocolos impuestos, ya que, en √∫ltima instancia, el estado de solo estas cosas hace posible tomar una decisi√≥n informada sobre el √©xito de una etapa en particular.  Pocos clientes aceptan art√≠culos p√∫blicos basados ‚Äã‚Äãen los resultados de su trabajo, por lo que prepar√© un entorno virtual para la demostraci√≥n.  Dentro de este entorno, me limitar√© a verificar el estado de las sesiones BGP, que se crean de forma individual entre enrutadores, estos ser√°n nuestros servicios y servicios impuestos.  Si, despu√©s del trabajo, se cumplen las condiciones para su rendimiento en forma de conectividad IP cada uno con cada uno, entonces hay razones para creer que el trabajo fue exitoso.  En proyectos reales, las comprobaciones generalmente se limitan al volumen de servicios y protocolos impuestos, que se designa como negocio cr√≠tico en una red determinada.  Esto no se aplica a la programaci√≥n, sin embargo, no puedo dejar de centrarme en este tema, ya que la elecci√≥n del criterio de √©xito es la clave para un buen descanso despu√©s del trabajo realizado. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de verificaci√≥n de sesi√≥n BGP</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> yml = <span class="hljs-string"><span class="hljs-string">''' --- BGPGroup: rpc: get-bgp-group-information args: group-name: 'int' item: bgp-group view: BGPGroupView BGPGroupView: fields: count: peer-count established: established-count '''</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) node_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.68'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.69'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.70'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.71'</span></span>] abr_list = [<span class="hljs-string"><span class="hljs-string">'10.83.20.66'</span></span>, <span class="hljs-string"><span class="hljs-string">'10.83.20.67'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list + abr_list: ddev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) bgp_group = BGPGroup(ddev).get() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> group <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> bgp_group: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (group.count != group.established): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'bgp connection lost'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'dont panic!'</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Resultados de su trabajo.</b> <div class="spoiler_text">  DEPURACI√ìN: obtener conexi√≥n ssh a 10.83.20.68 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.68 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.68 llamada r1 <br>  no se asuste! <br>  DEPURACI√ìN - obteniendo conexi√≥n ssh a 10.83.20.69 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.69 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.69 llamada r2 <br>  no se asuste! <br>  DEPURACI√ìN: obtener conexi√≥n ssh a 10.83.20.70 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.70 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.70 llamada r3 <br>  no se asuste! <br>  DEPURACI√ìN - obteniendo conexi√≥n ssh a 10.83.20.71 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.71 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.71 llamada r4 <br>  no se asuste! <br>  DEPURACI√ìN: obtener conexi√≥n ssh a 10.83.20.66 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.66 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.66 llamada abr1 <br>  no se asuste! <br>  DEPURACI√ìN - obteniendo conexi√≥n ssh a 10.83.20.67 <br>  DEPURACI√ìN: conexi√≥n ssh al host 10.83.20.67 establecida <br>  DEPURACI√ìN - se estableci√≥ la conexi√≥n 10.83.20.67 llamada abr2 <br>  no se asuste! <br></div></div><br>  Hasta ahora, hablamos principalmente sobre alg√∫n tipo de cosas de red, pero a√∫n no dije una palabra sobre el c√≥digo del programa, que parece ser el centro de atenci√≥n en un art√≠culo con este nombre.  En primer lugar, me parece que los pensamientos son mucho m√°s importantes que el c√≥digo, habiendo formalizado entidades en la cabeza, un ingeniero podr√° convertirlas en una herramienta y expresarlas en forma de c√≥digo.  En segundo lugar, no quiero repetirme, todo lo que puede no parecer obvio en estos ejemplos, as√≠ como el conocimiento m√≠nimo necesario para comenzar a trabajar con Python y Pyez, est√°n contenidos en el art√≠culo anterior de la serie.  En tercer lugar, el c√≥digo de preparaci√≥n de la configuraci√≥n lleva a cabo su trabajo, que se llama fuera de l√≠nea y no tiene un efecto inmediato en la red, por lo que es poco probable que cause alg√∫n inter√©s.  Las cosas son algo diferentes con el c√≥digo de implementaci√≥n de la fase de implementaci√≥n; el desarrollo de estos procedimientos plantea las siguientes preguntas: <br><br><ul><li>  ¬øC√≥mo verificar que el int√©rprete perciba adecuadamente todo el volumen de comandos? </li><li>  ¬øC√≥mo verificar que se hayan aplicado los cambios realizados a la configuraci√≥n? </li><li>  ¬øC√≥mo implementar un esquema de configuraci√≥n transaccional? </li><li>  ¬øC√≥mo deshacer la configuraci√≥n en caso de p√©rdida de control? </li><li>  ¬øC√≥mo limpiar si el int√©rprete informa un error durante la transferencia de comandos? </li></ul><br>  Cuanta m√°s atenci√≥n se preste a estos temas, menos sorpresas se servir√°n en la etapa de ejecuci√≥n.  Imagine la molestia de un error de sintaxis que describe una pol√≠tica de enrutamiento cuando los clasificadores de esta pol√≠tica solo son parcialmente aprobados por el int√©rprete.  Si no controla l√≠nea por l√≠nea el proceso de fusi√≥n de esta pol√≠tica con la configuraci√≥n actual, puede poner el equipo en un estado inadecuado con un clic de un bot√≥n.  Por lo tanto, me adhiero a aproximadamente ese bloque del diagrama de la etapa de ejecuci√≥n. <br><br><img src="https://habrastorage.org/webt/ou/kz/8q/oukz8qzqdaq9oqp6weqsg9-xpu4.png" alt="imagen"><br><br>  Armado con la documentaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Pyez</a> , se compil√≥ el siguiente c√≥digo de cargador de configuraci√≥n universal, que puede usar en su trabajo diario, tal como lo uso en el m√≠o. <br><br><div class="spoiler">  <b class="spoiler_title">conf_change.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> yaml <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.factory.factory_loader <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FactoryLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Device <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.utils.config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> copy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> traceback <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnpr.junos.exception <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os.path yml = <span class="hljs-string"><span class="hljs-string">''' --- VersionInfo: rpc: get-software-information item: software-information view: VersionInfoView VersionInfoView: fields: name: host-name '''</span></span> Device.auto_probe = <span class="hljs-number"><span class="hljs-number">3</span></span> ip_f_name = <span class="hljs-string"><span class="hljs-string">'ip-list-1.txt'</span></span> cur_stage=<span class="hljs-string"><span class="hljs-string">'2'</span></span> globals().update(FactoryLoader().load(yaml.load(yml))) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTestOSPF</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF : at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d_conf = p_dev.cli(<span class="hljs-string"><span class="hljs-string">"show configuration | display set"</span></span>).split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) ret_val = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> set_found = <span class="hljs-number"><span class="hljs-number">0</span></span> c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(c_path, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f: c_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'delete '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c_line): set_found = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (c_line <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> d_conf) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (c_line != <span class="hljs-string"><span class="hljs-string">''</span></span>)): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doTestOSPF found missing line '</span></span> + c_line ret_val = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> f.close() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (set_found == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (f_do == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret_val <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doTestOSPF : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node, f_do)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> doTestOSPF(p_dev, p_node, f_do) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">close_dev</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(d)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: d.close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- close_dev : connection to cant be closed. ex:'</span></span> + str(ex) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getConnection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_host, p_user)</span></span></span><span class="hljs-function">:</span></span> acc = {<span class="hljs-string"><span class="hljs-string">'lab'</span></span>: <span class="hljs-string"><span class="hljs-string">'lab123'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- getting ssh connection to '</span></span> + p_host l_dev = Device(host=p_host, user=p_user, password=acc[p_user], auto_probe=<span class="hljs-number"><span class="hljs-number">2</span></span>, gather_facts=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, port=<span class="hljs-number"><span class="hljs-number">22</span></span>) l_dev.open() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (l_dev.connected): l_dev.timeout = <span class="hljs-number"><span class="hljs-number">900</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh cionnection to host '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' established'</span></span> v = VersionInfo(l_dev).get() <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- connection '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' named '</span></span> + l_dev.facts[<span class="hljs-string"><span class="hljs-string">'hostname'</span></span>] + <span class="hljs-string"><span class="hljs-string">' established '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> l_dev <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> Exception(<span class="hljs-string"><span class="hljs-string">' DEBUG --- ssh connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- getConnection : connection to '</span></span> + p_host + <span class="hljs-string"><span class="hljs-string">' was not established. ex:'</span></span> + str(ex) traceback.print_exc() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCompare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCompare at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.diff() == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCompare : conf.diff at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doLoad at '</span></span> + p_node c_path = <span class="hljs-string"><span class="hljs-string">'st'</span></span> + cur_stage + <span class="hljs-string"><span class="hljs-string">'-'</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">'.txt'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (os.path.isfile(c_path)): p_conf.load(path=c_path, format=<span class="hljs-string"><span class="hljs-string">'set'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doLoad : cant load config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doRollback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_r)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doRollback at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_conf.rollback(rb_id=p_r) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doRollback : cant rollback config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommitCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommitCheck at '</span></span> + p_node p_conf.commit_check() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommitCheck : cant config commit check config to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_conf, p_node, p_confirm_m=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doCommit at '</span></span> + p_node commit_res = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (p_confirm_m == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): commit_res = p_conf.commit(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: commit_res = p_conf.commit(confirm=p_confirm_m, timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (commit_res == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> CommitError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> c_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : cant config commit at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(c_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> RpcTimeoutError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> t_ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doCommit : config was commited at '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' with the following ex:'</span></span> + str(t_ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doJob</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p_dev, p_node)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob at '</span></span> + p_node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( p_dev == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : connection to '</span></span> + p_node + <span class="hljs-string"><span class="hljs-string">' is None'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> Config(p_dev) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> conf: is_compare = doCompare(conf, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : at config compare '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_compare == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : configuration locked at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- starting to do config changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doLoad(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.load '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commit check at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommitCheck(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.doCommitCheck failed at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after load at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> commit_m = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- commiting changes at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(conf, node, commit_m) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : conf.commit '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( doCompare(conf, node) != <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- doJob : doing rollback after commit at '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' deleting :'</span></span> + str(conf.diff()) doRollback(conf, node, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ex: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">' DEBUG --- ERROR --- doJob : cant do job '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' ex:'</span></span> + str(ex) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> node_list = [] result_list = {} <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(ip_f_name, <span class="hljs-string"><span class="hljs-string">"r"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f_ip: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> f_ip: c_ip_line = line.replace(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'\r\n'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c_ip_line != <span class="hljs-string"><span class="hljs-string">''</span></span>): node_list.append(c_ip_line) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> node_list: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ************************************ '</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking '</span></span> + node result_list.setdefault(node, {}) cur_dev = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) is_test = doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- error'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf exist'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'nn'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_test == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- conf not exist, doing change'</span></span> is_job = doJob(cur_dev, node) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- cant do job at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( is_job == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- done job at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- going sleep at '</span></span> + node time.sleep(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- checking job status '</span></span> + node cur_dev_confirm = getConnection(node, <span class="hljs-string"><span class="hljs-string">'lab'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( cur_dev_confirm != <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doTest(cur_dev, node, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- commiting the configuration at '</span></span> + node <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doCommit(Config(cur_dev_confirm), node) != <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant commit the configuration at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- configuration commited at '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'done'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant find conf after job '</span></span> + node result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev_confirm) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">'FLOW -- ERROR cant access '</span></span> + node + <span class="hljs-string"><span class="hljs-string">' for commiting'</span></span> result_list.setdefault(node, {}).setdefault(<span class="hljs-string"><span class="hljs-string">'status'</span></span>, <span class="hljs-string"><span class="hljs-string">'not_done'</span></span>) close_dev(cur_dev) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> result_list</code> </pre><br></div></div><br>  Y los resultados de su trabajo en tres etapas. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"> <code>Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:19:30) [MSC v.1500 32 bit (Intel)] on win32 <br> Type "copyright", "credits" or "license()" for more information. <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface ge-0/0/3.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/0.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/1.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/2.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 secondary <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface ge-0/0/3.0 metric 1 <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.250 interface lo0.0 interface-type p2p <br> DEBUG --- doTestOSPF found missing line set protocols ospf area 0.0.0.200 interface lo0.0 secondary <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br> ==== RESTART: C:\Users\and_andreev\Desktop\tools\lab-case2\conf_change.py ==== <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.66 <br> DEBUG --- doCompare at 10.83.20.66 <br> DEBUG --- starting to do config changes at 10.83.20.66 <br> DEBUG --- doLoad at 10.83.20.66 <br> DEBUG --- commit check at 10.83.20.66 <br> DEBUG --- doCommitCheck at 10.83.20.66 <br> DEBUG --- commiting changes at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- done job at 10.83.20.66 <br> FLOW -- going sleep at 10.83.20.66 <br> FLOW -- checking job status 10.83.20.66 <br> DEBUG --- getting ssh connection to 10.83.20.66 <br> DEBUG --- ssh cionnection to host 10.83.20.66 established <br> DEBUG --- connection 10.83.20.66 named abr1 established <br> DEBUG --- doTestOSPF : at 10.83.20.66 <br> FLOW -- commiting the configuration at 10.83.20.66 <br> DEBUG --- doCommit at 10.83.20.66 <br> FLOW -- configuration commited at 10.83.20.66 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.67 <br> DEBUG --- doCompare at 10.83.20.67 <br> DEBUG --- starting to do config changes at 10.83.20.67 <br> DEBUG --- doLoad at 10.83.20.67 <br> DEBUG --- commit check at 10.83.20.67 <br> DEBUG --- doCommitCheck at 10.83.20.67 <br> DEBUG --- commiting changes at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- done job at 10.83.20.67 <br> FLOW -- going sleep at 10.83.20.67 <br> FLOW -- checking job status 10.83.20.67 <br> DEBUG --- getting ssh connection to 10.83.20.67 <br> DEBUG --- ssh cionnection to host 10.83.20.67 established <br> DEBUG --- connection 10.83.20.67 named abr2 established <br> DEBUG --- doTestOSPF : at 10.83.20.67 <br> FLOW -- commiting the configuration at 10.83.20.67 <br> DEBUG --- doCommit at 10.83.20.67 <br> FLOW -- configuration commited at 10.83.20.67 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.68 <br> DEBUG --- doCompare at 10.83.20.68 <br> DEBUG --- starting to do config changes at 10.83.20.68 <br> DEBUG --- doLoad at 10.83.20.68 <br> DEBUG --- commit check at 10.83.20.68 <br> DEBUG --- doCommitCheck at 10.83.20.68 <br> DEBUG --- commiting changes at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- done job at 10.83.20.68 <br> FLOW -- going sleep at 10.83.20.68 <br> FLOW -- checking job status 10.83.20.68 <br> DEBUG --- getting ssh connection to 10.83.20.68 <br> DEBUG --- ssh cionnection to host 10.83.20.68 established <br> DEBUG --- connection 10.83.20.68 named r1 established <br> DEBUG --- doTestOSPF : at 10.83.20.68 <br> FLOW -- commiting the configuration at 10.83.20.68 <br> DEBUG --- doCommit at 10.83.20.68 <br> FLOW -- configuration commited at 10.83.20.68 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.69 <br> DEBUG --- doCompare at 10.83.20.69 <br> DEBUG --- starting to do config changes at 10.83.20.69 <br> DEBUG --- doLoad at 10.83.20.69 <br> DEBUG --- commit check at 10.83.20.69 <br> DEBUG --- doCommitCheck at 10.83.20.69 <br> DEBUG --- commiting changes at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- done job at 10.83.20.69 <br> FLOW -- going sleep at 10.83.20.69 <br> FLOW -- checking job status 10.83.20.69 <br> DEBUG --- getting ssh connection to 10.83.20.69 <br> DEBUG --- ssh cionnection to host 10.83.20.69 established <br> DEBUG --- connection 10.83.20.69 named r2 established <br> DEBUG --- doTestOSPF : at 10.83.20.69 <br> FLOW -- commiting the configuration at 10.83.20.69 <br> DEBUG --- doCommit at 10.83.20.69 <br> FLOW -- configuration commited at 10.83.20.69 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.70 <br> DEBUG --- doCompare at 10.83.20.70 <br> DEBUG --- starting to do config changes at 10.83.20.70 <br> DEBUG --- doLoad at 10.83.20.70 <br> DEBUG --- commit check at 10.83.20.70 <br> DEBUG --- doCommitCheck at 10.83.20.70 <br> DEBUG --- commiting changes at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- done job at 10.83.20.70 <br> FLOW -- going sleep at 10.83.20.70 <br> FLOW -- checking job status 10.83.20.70 <br> DEBUG --- getting ssh connection to 10.83.20.70 <br> DEBUG --- ssh cionnection to host 10.83.20.70 established <br> DEBUG --- connection 10.83.20.70 named r3 established <br> DEBUG --- doTestOSPF : at 10.83.20.70 <br> FLOW -- commiting the configuration at 10.83.20.70 <br> DEBUG --- doCommit at 10.83.20.70 <br> FLOW -- configuration commited at 10.83.20.70 <br> FLOW -- ************************************ <br> FLOW -- checking 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- conf not exist, doing change <br> DEBUG --- doJob at 10.83.20.71 <br> DEBUG --- doCompare at 10.83.20.71 <br> DEBUG --- starting to do config changes at 10.83.20.71 <br> DEBUG --- doLoad at 10.83.20.71 <br> DEBUG --- commit check at 10.83.20.71 <br> DEBUG --- doCommitCheck at 10.83.20.71 <br> DEBUG --- commiting changes at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- done job at 10.83.20.71 <br> FLOW -- going sleep at 10.83.20.71 <br> FLOW -- checking job status 10.83.20.71 <br> DEBUG --- getting ssh connection to 10.83.20.71 <br> DEBUG --- ssh cionnection to host 10.83.20.71 established <br> DEBUG --- connection 10.83.20.71 named r4 established <br> DEBUG --- doTestOSPF : at 10.83.20.71 <br> FLOW -- commiting the configuration at 10.83.20.71 <br> DEBUG --- doCommit at 10.83.20.71 <br> FLOW -- configuration commited at 10.83.20.71 <br> {'10.83.20.70': {'status': 'done'}, '10.83.20.71': {'status': 'done'}, '10.83.20.67': {'status': 'done'}, '10.83.20.66': {'status': 'done'}, '10.83.20.69': {'status': 'done'}, '10.83.20.68': {'status': 'done'}} <br> &gt;&gt;&gt; <br></code> <br></div></div><br><ol><li>  El protocolo completo de enrutamiento IS-IS - Hannes Gredler, Walter Goralski </li><li>  OSPF  Anatom√≠a de un protocolo de enrutamiento de Internet - John T. Moy </li><li>  Fusiones y migraciones de redes: dise√±o e implementaci√≥n de Junos - Gonzalo G√≥mez Herrero, Jan Anton Bernal Van Der Ven </li><li>  OSPF adyacencia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">m√∫ltiples √°reas</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tools.ietf.org/html/rfc5185</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413427/">https://habr.com/ru/post/es413427/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413415/index.html">L√≠mites de concurrencia adaptativa en Netflix</a></li>
<li><a href="../es413417/index.html">Eficiencia energ√©tica: los enfoques que probamos en Rusia</a></li>
<li><a href="../es413419/index.html">Resumen de noticias de PostgreSQL. Edici√≥n No. 7</a></li>
<li><a href="../es413421/index.html">Posibles incertidumbres en la carrera de un programador</a></li>
<li><a href="../es413423/index.html">Soluciones de acceso remoto en Mars IS</a></li>
<li><a href="../es413429/index.html">Estamos escribiendo un complemento para recibir certificados de comod√≠n Let's Encrypt</a></li>
<li><a href="../es413431/index.html">Talleres sobre desarrollo de contratos inteligentes sobre Solidez</a></li>
<li><a href="../es413433/index.html">El 65% de los profesionales de TI rusos quieren trabajar en el extranjero.</a></li>
<li><a href="../es413435/index.html">La herencia m√°s all√° de la gen√©tica</a></li>
<li><a href="../es413437/index.html">El mensajero de todo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>