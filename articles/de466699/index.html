<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèΩ üîó ü§¶üèø Z√§hmen von Vertrauensprotokollen - OAuth-Authentifizierung mit InterSystems IRIS üßñüèº ü§öüèæ ü¶É</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie k√∂nnen Computer in Ihrer Abwesenheit einander vertrauen und gleichzeitig Sicherheit und Datenschutz gew√§hrleisten? 



 - Trockener Martini. In ei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Z√§hmen von Vertrauensprotokollen - OAuth-Authentifizierung mit InterSystems IRIS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intersystems/blog/466699/">  <b>Wie k√∂nnen Computer in Ihrer Abwesenheit einander vertrauen und gleichzeitig Sicherheit und Datenschutz gew√§hrleisten?</b> <br><br><img src="https://habrastorage.org/webt/wn/au/eu/wnaueun6knwbjc4anclcexjbfwi.jpeg"><br><br>  - Trockener Martini.  In einem gro√üen Glas. <br>  - Oui, Monsieur.  [Ja, Monsieur (Fr.)] <br>  "Nur eine Sekunde, nicht alle."  Drei Finger von Gordon, einer von Wodka, ein halber Finger von Kina Lyklet.  In einem Shaker gut schlagen und dann eine gro√üe Zitronenscheibe hineinlegen.  Erinnerst du dich? <br><br>  Jan Fleming, Casino Royale, 1953 <br><br><h2>  Teil 1. OAuth 2.0- und OpenID Connect-Geschichten </h2><br>  Universal und anscheinend im 21. Jahrhundert hei√üt OAuth + OIDC das beliebteste Paket von Open-Access-Delegierungs- und Authentifizierungsprotokollen.  Besser f√ºr den Massengebrauch haben sich bisher nichts ausgedacht.  Sie sind besonders bei Front-End-Anbietern beliebt, da sie auf HTTP (S) -Protokollen aufbauen und den JWT-Container ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JSON Web Token</a> ) verwenden.  OpenID Connect verwendet OAuth f√ºr seine Arbeit oder mit anderen Worten, OIDC ist ein Wrapper f√ºr OAuth. <br><br>  OpenID - ein offener Standard f√ºr die Authentifizierung und die Erstellung digitaler Identifikationssysteme ist f√ºr Entwickler nicht neu.  In diesem Jahr wird er 14 Jahre alt.  In der aktuellen dritten Version lautet der vollst√§ndige Name OpenID Connect oder ist k√ºrzer als OIDC.  Es ist sowohl in der Web- und Mobilentwicklung als auch in Unternehmenssystemen beliebt. <br><a name="habracut"></a><br>  Sein Partner, der OAuth Open Access Delegation Standard, wird 12 Jahre alt.  Und 9 Jahre nach Erscheinen des entsprechenden RFC 5849-Standards werden wir uns auf die moderne Version des OAuth 2.0-Protokolls und den aktuellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RFC 6749 verlassen</a> .  Denken Sie daran, dass OAuth 2.0 nicht mit seinem Vorg√§nger OAuth 1.0 kompatibel ist. <br><blockquote> OAuth - ein offenes Protokoll (Schema, Transport) zum Delegieren des Zugriffs, das es Dritten erm√∂glicht, eingeschr√§nkten Zugriff auf die gesch√ºtzten Ressourcen des Benutzers zu gew√§hren, ohne dass sie (Drittanbieter) die Anmeldung und das Kennwort von RFC 6749 √ºbertragen m√ºssen <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oauth.net</a> ist die f√ºhrende OAuth-Website von Aaron Parecki <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oauth.com</a> - OAuth <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tutorial</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Testumgebung</a> <br><br>  Open ID Connect (OIDC) ist ein offener Standard f√ºr dezentrale Identifikationssysteme, mit dem der Benutzer mithilfe von Diensten von Drittanbietern ein einziges Konto f√ºr die Identifizierung auf einer Vielzahl nicht verwandter Internetressourcen erstellen kann, OAuth-Nachrichten und einen JWT-Container f√ºr die sichere Kommunikation verwendet. <br></blockquote>  Genau genommen ist OAuth kein Protokoll, sondern ein Satz von Regeln (Schema) zum Trennen und √úbertragen von Benutzeridentifikationsvorg√§ngen an einen separaten vertrauensw√ºrdigen Server, wenn die Architektur der Zugriffssteuerungsabgrenzung in Softwaresystemen implementiert wird. <br><br>  Und Achtung, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OAuth kann nichts √ºber einen bestimmten Benutzer sagen</a> !  Weder wer er ist, noch wo er jetzt ist, noch ob er jetzt am Computer arbeitet oder nicht.  Dann ist es jedoch m√∂glich, ohne Eingreifen des Benutzers mit bereits ausgestellten Zugriffstoken mit Systemen zu interagieren.  Dies ist ein wichtiger Punkt. <br><blockquote>  Es kann n√ºtzlich sein: <br><br><ul><li>  OAuth l√§sst sich perfekt mit der Verwendung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">XACML-</a> Attributzugriffsbeschreibungssprache kombinieren </li><li>  OAuth setzt auch auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">User-Managed Access</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UMA</a> ) </li></ul><br>  Die gemeinsame Nutzung von OAuth + OIDC + UMA erm√∂glicht die Implementierung von Systemen zur sicheren Identifizierung und Zugriffskontrolle (Identity and Access Management - IdM, IAM) in verschiedenen Themenbereichen, zum Beispiel: <br><br><ul><li>  Verwenden des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HEART-</a> Profils (Health Relationship Trust) der pers√∂nlichen Daten eines Patienten in der Medizin </li><li>  auf CIAM-Kundenidentifikationsplattformen (Consumer Identity and Access Management) f√ºr Fertigungs- und Handelsunternehmen </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Personalisierung digitaler Zertifikate von Smart Devices</a> in IoT-Systemen (Internet of Things) </li></ul></blockquote><img src="https://habrastorage.org/webt/pf/dt/vf/pfdtvf4d6obgfiom0tizekdsjis.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ein neuer Venn der Zugriffskontrolle f√ºr die API-Wirtschaft</a> <br><br>  Speichern Sie personenbezogene Daten vor allem nicht am selben Ort wie der Rest des Systems.  Separate physische Authentifizierung und Autorisierung.  Und noch besser - geben Sie der Person den gesamten Ausweis pers√∂nlich und bewahren Sie ihn niemals bei sich auf.  Vertrauen Sie dem Ger√§tebesitzer. <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apple sagte,</a> welche pers√∂nlichen Daten Russen in Russland speichern.  Dies ist der Name, die Adresse, die E-Mail-Adresse und die Telefonnummer.  Aber Nachrichten, Fotos usw. Die Menschen selbst vertrauen der iCloud-Cloud (die sich nicht in Russland befindet). <br></blockquote><h2>  Teil 2. Kurzspiel ‚ÄûVertrauen und Authentifizierung‚Äú </h2><br>  Daher haben wir beschlossen, dass es nicht unumg√§nglich ist, die pers√∂nlichen Daten unserer lieben Benutzer weder in unserer Anwendung noch in einem einzigen Speicher zusammen mit einer funktionierenden Datenbank zu speichern.  Das hei√üt, sie haben einen zuverl√§ssigen Treuh√§nder ausgew√§hlt, der uns diesen Service bietet.  Wenn also Seine Majest√§t der Benutzer erscheint, bieten wir den folgenden Dialog. <br><br>  Schauspieler: <br><br><ul><li>  Benutzer </li><li>  Client-Anwendung </li><li>  Identit√§tsdienst </li><li>  Ressourcenserver </li></ul><br>  Die Aktion findet in einem Browser auf dem Computer des Benutzers statt.  Alle Charaktere sind seit langem miteinander vertraut.  Der Benutzer hat ein pers√∂nliches Konto im Identit√§tsdienst.  Die Client-Anwendung hat einen unterzeichneten g√ºltigen Vertrag mit dem Identifikationsdienst und den gegenseitigen Schnittstellen.  Der Ressourcenserver vertraut dem Identit√§tsdienst bei der Ausgabe von Zugriffsschl√ºsseln an alle Betroffenen, die er identifizieren kann. <br><br>  Benutzer (P): (durch Starten einer webbasierten Client-Anwendung) Sehr geehrte Client-Anwendung, ich ben√∂tige "diese Ressource". <br>  Client-Anwendung (K): Sehr geehrter Benutzer, legen Sie zuerst den Schl√ºssel f√ºr "diese Ressource" vor.  Ohne Schl√ºssel ist der Zugriff auf "diese Ressource" geschlossen. <br>  P: Ich habe keinen solchen Schl√ºssel. <br>  K: Dann werde ich Sie vor√ºbergehend zu einem Identifikationsdienst wechseln, mit dem wir eine Vereinbarung zur Ausgabe von Schl√ºsseln f√ºr den Ressourcenserver getroffen haben.  (leitet P. an den Identifikationsdienst weiter) <br>  Identifikationsdienst (I): Sehr geehrter Benutzer, bitte sagen Sie mir, wer Sie sind und welche Schl√ºssel Sie ben√∂tigen. <br>  P: Ich, Ytsuken User User, das Passwort ist so und so, ich m√∂chte Zugriff auf "diese Ressource" erhalten. <br>  Und: Danke, Genosse Jtsuken.  Die Authentifizierung war erfolgreich und Ihre Identifikation wird √ºberpr√ºft.  Hier ist der Schl√ºssel zu ‚Äûdieser Ressource‚Äú (P. leitet zur√ºck zu K.) <br>  P: Client, ich habe Ihnen den Schl√ºssel zu der ‚ÄûRessource‚Äú gebracht, die ich brauche. <br>  K: Danke Benutzer.  Der Schl√ºssel ist richtig.  Hier ist die "Ressource", die Sie angefordert haben. <br><br>  Der Vorhang.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Er√∂ffnungssinfonie von Richard Strauss</a> aus dem Film ‚ÄûSpace Odyssey of 2001‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">spielt</a> <br><br><h2>  Teil 3. Echter Autorisierungsdienst </h2><br>  Kommen wir jetzt zur Sache.  Wir haben drei Aufgaben auf der Tagesordnung: die Charaktere zu ernennen, die B√ºhne vorzubereiten und das St√ºck zu spielen.  Und auf der InterSystems IRIS-Plattform wird alles auf einmal entschieden.  Dies ist jedoch nicht erforderlich. Sie k√∂nnen nach eigenem Ermessen ein Design von verschiedenen Plattformen zusammenstellen.  Beispiel: In dieser Kombination: OAuth Keycloak-Server + OAuth-Client und OAuth-Ressource in IRIS.  Mit anderen Worten: <br><br><ol><li>  Konfigurieren und starten Sie den OAuth-Server mit der Registrierung unseres Demo-Clients. </li><li>  Richten Sie einen Demo-OAuth-Client ein, indem Sie ihn mit dem OAuth-Server und den Webressourcen verbinden. </li><li>  Entwickeln Sie Clientanwendungen, die OAuth verwenden k√∂nnen.  Sie k√∂nnen Java, Python, C #, NodeJS verwenden.  Das Folgende ist ein Beispiel f√ºr einen Anwendungscode in ObjectScript. </li></ol><br><blockquote>  Die Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Entwicklergemeinde</a> enth√§lt eine ausf√ºhrliche Anleitung von Daniel Kutak in drei Teilen mit Beispielen f√ºr die Verwendung von OAuth in IRIS f√ºr verschiedene Anwendungen, die auf CSP basieren ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> ). </blockquote>  Es gibt viele Einstellungen in OAuth.  Schreiben Sie sich daher selbst Checklisten - dies ist die korrekteste Anwendung f√ºr sie.  Beispiele und Leerzeichen unten. <br><blockquote>  Wo bekomme ich fertiges InterSystems IRIS f√ºr ein Beispiel?  Jedem stehen mindestens zwei Optionen zur Verf√ºgung: <br><br>  Holen Sie sich einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorgefertigten vorkonfigurierten Cloud-IRIS-Server</a> auf der InterSystems Learning Services-Schulungsplattform im Abschnitt InterSystems Learning Labs. <br><br>  Installieren Sie einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorgefertigten Docker-Container</a> .  Lesen Sie mehr im Artikel - eine schrittweise Anleitung f√ºr Anf√§nger des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Startens von IRIS mit Docker-</a> Entwicklern oder, die ein Video bevorzugen, eine Screencast-Anleitung zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwickeln von L√∂sungen mit InterSystems IRIS mit Docker und VSCode</a> </blockquote><h3>  1-1 Konfigurieren des OAuth-Servers </h3><br>  Wir gehen in das IRIS-Verwaltungsportal und w√§hlen den Abschnitt aus: <br><br>  Systemadministration &gt;&gt; Sicherheit &gt;&gt; OAuth 2.0 &gt;&gt; Server <br><br>  Als n√§chstes wird in jedem Absatz ein Name f√ºr die Einstellungszeile und gegebenenfalls √ºber den Doppelpunkt ein Beispiel oder eine Erkl√§rung angegeben. <br><br><img src="https://habrastorage.org/webt/9g/k4/by/9gk4bywq0a0dkkkprpu5wbnempo.png"><br><br>  <b>Registerkarte "Allgemeine Einstellungen":</b> <br>  Beschreibung: optional, zum Beispiel "Autorisierungsserver" <br>  Der Generatorendpunkt (im Folgenden CTG) ist der Hostname: DNS-Name Ihres Servers <br>  Unterst√ºtzte Berechtigungstypen (w√§hlen Sie mindestens einen aus): <br>  Autorisierungscode <br>  Implizit <br>  Anmeldeinformationen: Ressource, Eigent√ºmer, Passwort <br>  Kundenanmeldeinformationen <br>  SSL / TLS-Konfiguration: oauthserver <br><br>  <b>Registerkarte "Berechtigungen":</b> <br>  F√ºgen Sie unterst√ºtzte Volumes hinzu: z. B. scope1 und scope2 <br><br>  <b>Registerkarte Intervalle:</b> <br>  Zugriffsschl√ºsselintervall: 3600 <br>  Autorisierungscode-Intervall: 60 <br>  Schl√ºsselintervall aktualisieren: 86400 <br>  Sitzungsunterbrechungsintervall: 86400 <br>  G√ºltigkeitsdauer des Client-Schl√ºssels: 0 <br><br>  <b>Registerkarte "JWT-Einstellungen":</b> <br>  Eingabealgorithmus: RS512 <br>  Schl√ºsselverwaltungsalgorithmus: RSA-OAEP <br>  Algorithmus zur Inhaltsverschl√ºsselung: A256CBC-HS512 <br><br>  <b>Registerkarte "Customizing":</b> <br>  Identifizieren Sie die Klasse:% OAuth2.Server.Authenticate <br>  √úberpr√ºfen Sie die Benutzerklasse:% OAuth2.Server.Validate <br>  Sitzungsdienstklasse: OAuth2.Server.Session <br>  Generieren Sie die Schl√ºsselklasse:% OAuth2.Server.JWT <br>  Anpassungs-Namespace:% SYS <br>  Anpassungsrollen (w√§hlen Sie mindestens eine aus):% DB_IRISSYS und% Manager <br><br>  Speichern. <br><br><h3>  1-2 Registrieren Sie den Client auf dem OAuth-Server </h3><br><img src="https://habrastorage.org/webt/ae/gu/pz/aegupzlmpoucnqfa4vu-f2gcgq0.png"><br><br>  Schaltfl√§che "Kundenbeschreibung" &gt;&gt; Schaltfl√§che "Kundenbeschreibung erstellen": <br><br>  <b>Registerkarte "Allgemeine Einstellungen":</b> <br>  Name: KUNDE <br>  Beschreibung: beliebig <br>  Client-Typ: Vertraulich <br>  URLs umleiten: Die R√ºckgabeadresse in unserer Anwendung nach der Authentifizierung <br>  Unterst√ºtzte Berechtigungstypen <br>  Autorisierungscode: ja <br>  Implizit <br>  Anmeldeinformationen: Ressource, Eigent√ºmer, Passwort <br>  Kundenanmeldeinformationen <br>  JWT-Autorisierung <br>  Unterst√ºtzte Antworttypen <br>  Code <br>  id_token <br>  id_token Schl√ºssel <br>  Token <br>  Berechtigungsart: Einfach <br><br>  <b>Registerkarte "Client-Anmeldeinformationen":</b> Automatisch ausgef√ºllt <br><br>  <b>Registerkarte "Kundeninformationen":</b> <br>  URL starten: <br>  Anmeldebildschirm <br>  Kundenname <br>  Logo URL <br>  URL der Client-Startseite <br>  Richtlinien-URL <br>  Service-URL-Bedingungen <br><br><h3>  2-1 Konfigurieren der Bindung auf dem OAuth-Server-Client </h3><br>  Systemadministration &gt;&gt; Sicherheit &gt;&gt; OAuth 2.0 &gt;&gt; Client <br><br><img src="https://habrastorage.org/webt/xq/hu/3r/xqhu3rquzsfni1tsfgwtfkhzvew.png"><br><br>  Erstellen Sie eine Serverbeschreibung: <br>  Generatorendpunkt: Entnehmen Sie den allgemeinen Serverparametern, siehe oben <br>  SSL / TLS-Konfiguration: W√§hlen Sie aus der Liste der vorkonfigurierten <br><br>  Der Inhalt der verbleibenden Felder wird automatisch vom Server heruntergeladen. Sie k√∂nnen sie jedoch auch manuell konfigurieren: <br><br>  Autorisierungsserver <br>  Autorisierungsendpunkt: CTG + / autorisieren <br>  Schl√ºsselendpunkt: CTG + / Token <br>  Benutzerinformationsendpunkt: CTG + / Benutzerinfo <br>  Wichtiger Endpunkt der Eigendiagnose: CTG + / Widerruf <br>  Schl√ºsselwiderrufsendpunkt: CTG + / Selbstbeobachtung <br>  JSON-Web-Token-Einstellungen (JWT) <br>  Andere Quelle neben der dynamischen Registrierung: W√§hlen Sie JWKS aus der URL <br>  URL: CTG + / jwks <br><br><img src="https://habrastorage.org/webt/ic/7e/x4/ic7ex4khfgskgdqf_jpsdivgj_o.png"><br><br>  Aus dieser Liste ist beispielsweise ersichtlich (scopes_supported und Claims_supported), dass der Server dem OAuth-Client verschiedene Informationen √ºber den Benutzer bereitstellen kann.  Beachten Sie au√üerdem, dass Sie den Benutzer bei der Implementierung Ihrer Anwendung fragen m√ºssen, welche Daten er freigeben m√∂chte.  In unserem Beispiel werden wir nur von scope1 um Erlaubnis gebeten. <br><br>  Speichern. <br><br>  Wenn ein Fehler bei der Anzeige von SSL auftritt, gehen Sie zu den Einstellungen: <br>  Systemadministration &gt;&gt; Sicherheit &gt;&gt; SSL / TSL-Konfiguration <br><br><h3>  2-2 Konfigurieren des OAuth-Clients </h3><br>  Systemadministration &gt;&gt; Sicherheit &gt;&gt; OAuth 2.0 &gt;&gt; Client &gt;&gt; Client-Konfiguration &gt;&gt; Client-Konfiguration erstellen <br><br><img src="https://habrastorage.org/webt/kd/e_/4w/kde_4wyvqd60yomyyudfzdotu_q.png"><br><br>  <b>Registerkarte "Allgemein":</b> <br>  Anwendungsname: Demo-Client <br>  Client-Name: Demo-Client <br>  Beschreibung: optional <br>  Aktiviert: Ja <br>  Client-Typ: Vertraulich <br>  SSL / TCL-Konfiguration: oauthclient <br>  Client-Weiterleitungs-URL: DNS-Name Ihres Servers <br>  Erforderliche Berechtigungsarten <br>  Autorisierungscode: ja <br>  Implizit <br>  Anmeldeinformationen: Ressource, Eigent√ºmer, Passwort <br>  Kundenanmeldeinformationen <br>  JWT-Autorisierung <br>  Berechtigungsart: Einfach <br><br>  <b>Registerkarte "Kundeninformationen":</b> <br>  Anmeldebildschirm <br>  Logo URL <br>  URL der Client-Startseite <br>  Richtlinien-URL <br>  Service-URL-Bedingungen <br>  Standardvolume: Wir verwenden die zuvor auf dem Server angegebenen, z. B. scope1 <br>  Kontakt-E-Mail-Adressen (durch Komma getrennt) <br>  Maximales Standardalter (in Sekunden) <br><br>  <b>Registerkarte "JWT-Einstellungen":</b> <br>  JSON-Web-Token-Einstellungen (JWT) <br>  Erstellen von JWT-Einstellungen aus X509-Anmeldeinformationen <br>  IDToken-Algorithmen <br>  Unterzeichnung: RS256 <br>  Verschl√ºsselung: A256CBC <br>  Schl√ºssel: RSA-OAEP <br>  Userinfo-Algorithmen <br>  Zugriff auf Token-Algorithmen <br>  Abfragealgorithmen <br><br>  <b>Registerkarte "Client-Anmeldeinformationen":</b> <br>  Id  Client: von demjenigen, der bei der Registrierung des Clients auf dem Server ausgestellt wurde (siehe oben) <br>  Kundenausweis ausgestellt <br>  Client-Geheimnis: von dem, das bei der Registrierung des Clients auf dem Server ausgegeben wurde (siehe oben) <br>  Das Client-Geheimnis l√§uft ab <br>  Kundenregistrierungs-URI <br><br>  Speichern. <br><br><h2>  Teil 4. Code </h2><br>  Erstellen wir eine minimalistische Webanwendung mit OAuth-Berechtigung und REST. <br><blockquote>  Bei der Arbeit verl√§sst sich OAuth darauf, dass die Kommunikationskan√§le zwischen den Teilnehmern an der Interaktion (Server, Clients, Webanwendung, Benutzerbrowser, Ressourcenserver) irgendwie gesch√ºtzt sind.  Am h√§ufigsten wird diese Rolle von SSL / TLS gespielt.  OAuth funktioniert aber auch auf unsicheren Kan√§len.  Beispielsweise verwendet der Keycloak-Server standardm√§√üig das HTTP-Protokoll und ist nicht gesch√ºtzt.  Dies vereinfacht die Entwicklung und das Debuggen w√§hrend der Entwicklung.  Bei der tats√§chlichen Nutzung von OAuth-Diensten muss der Kanalschutz unbedingt aktiviert sein - dies wird in der Keycloak-Dokumentation aufgezeichnet.  InterSystems IRIS-Entwickler verfolgen einen strengeren Ansatz f√ºr OAuth - SSL / TSL ist erforderlich.  Die einzige Vereinfachung besteht darin, dass Sie selbstsignierte Zertifikate oder den in IRIS integrierten PKI-Dienst (Systemadministration &gt;&gt; Sicherheit &gt;&gt; Public Key System) verwenden k√∂nnen. </blockquote>  Die Benutzerautorisierung wird mit der expliziten Angabe von zwei Parametern √ºberpr√ºft - dem Namen Ihrer Anwendung und dem vom OAuth-Server und im OAuth-Client unterst√ºtzten Volume (G√ºltigkeitsbereich - Ich frage mich, wie ich ihn auf Russisch richtig benennen kann?): <br><br><pre><code class="plaintext hljs">Parameter OAUTH2APPNAME = "OAuthClient"; set isAuthorized = ##class(%SYS.OAuth2.AccessToken).IsAuthorized( ..#OAUTH2APPNAME, .sessionId, "scope1", .accessToken, .idtoken, .responseProperties, .error)</code> </pre> <br>  In Ermangelung einer Genehmigung bereiten wir einen Link zu einer Anfrage zur Benutzeridentifikation vor und erhalten von ihm die Erlaubnis, mit unserer Anwendung zu arbeiten.  Hier m√ºssen wir nicht nur den Anwendungsnamen und das angeforderte Volume (Bereich) angeben, die auf dem OAuth-Server und im OAuth-Client registriert sind, sondern auch einen Backlink, an den die Webanwendung den Benutzer zur√ºckgeben soll. <br><br><pre> <code class="plaintext hljs">Parameter OAUTH2CLIENTREDIRECTURI = "https://52773b-76230063.labs.learning.intersystems.com/oauthclient/" set url = ##class(%SYS.OAuth2.Authorization).GetAuthorizationCodeEndpoint( ..#OAUTH2APPNAME, "scope1", ..#OAUTH2CLIENTREDIRECTURI, .properties, .isAuthorized, .sc)</code> </pre><br>  Wir verwenden den integrierten IRIS-Authentifizierungsdienst und registrieren dementsprechend Benutzer auf dem OAuth-IRIS-Server.  Zum Beispiel reicht es aus, dem Benutzer nur einen Benutzernamen und ein Passwort festzulegen. Sie m√ºssen keine weiteren Einstellungen im Konto vornehmen. <br><br>  Wenn der Benutzer √ºber den empfangenen Link √ºbertragen wird, f√ºhrt der Server das Benutzeridentifizierungsverfahren durch und fordert von ihm die Erlaubnis an, mit Anmeldeinformationen in der Webanwendung zu arbeiten. Au√üerdem speichert er das Ergebnis in seiner globalen OAuth2.Server.Session im Bereich% SYS: <br><br><img src="https://habrastorage.org/webt/dj/ih/ve/djihveewmoifbr9knths77mq-vi.png"><br><br><img src="https://habrastorage.org/webt/jb/ib/qz/jbibqzzejdf-gzo03bfcxdlkjjg.png"><br><br>  3. Demonstrieren Sie die Daten eines autorisierten Benutzers.  Nach erfolgreichem Abschluss der Prozeduren verf√ºgen wir beispielsweise √ºber ein Zugriffstoken.  Lass es uns verstehen: <br><br><pre> <code class="plaintext hljs">set valid = ##class(%SYS.OAuth2.Validation).ValidateJWT( .#OAUTH2APPNAME, accessToken, "scope1", .aud, .JWTJsonObject, .securityParameters, .sc )</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Vollst√§ndiger Arbeitscode eines Beispiels f√ºr die Arbeit mit OAuth:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Class OAuthClient.REST Extends %CSP.REST { Parameter OAUTH2APPNAME = "OAuthClient"; Parameter OAUTH2CLIENTREDIRECTURI = "https://52773b-76230063.labs.learning.intersystems.com/oauthclient/"; // to keep sessionId Parameter UseSession As Integer = 1; XData UrlMap [ XMLNamespace = "http://www.intersystems.com/urlmap" ] { &lt;Routes&gt; &lt;Route Method="GET" Url = "/" Call = "Do" /&gt; &lt;/Routes&gt; } ClassMethod Do() As %Status { // Check for accessToken set isAuthorized = ##class(%SYS.OAuth2.AccessToken).IsAuthorized( ..#OAUTH2APPNAME, .sessionId, "scope1", .accessToken, .idtoken, .responseProperties, .error) // to show accessToken if isAuthorized { set valid = ##class(%SYS.OAuth2.Validation).ValidateJWT( ..#OAUTH2APPNAME, accessToken, "scope1", .aud, .JWTJsonObject, .securityParameters, .sc ) &amp;html&lt; Hello!&lt;br&gt; &gt; w "You access token = ", JWTJsonObject.%ToJSON() &amp;html&lt; &lt;/html&gt; &gt; quit $$$OK } // perform the process of user and client identification and get accessToken set url = ##class(%SYS.OAuth2.Authorization).GetAuthorizationCodeEndpoint( ..#OAUTH2APPNAME, "scope1", ..#OAUTH2CLIENTREDIRECTURI, .properties, .isAuthorized, .sc) if $$$ISERR(sc) { w "error handling here" quit $$$OK } // url magic correction: change slashes in the query parameter to its code set urlBase = $PIECE(url, "?") set urlQuery = $PIECE(url, "?", 2) set urlQuery = $REPLACE(urlQuery, "/", "%2F") set url = urlBase _ "?" _ urlQuery &amp;html&lt; &lt;html&gt; &lt;h1&gt;  IRIS   OAuth2&lt;/h1&gt; &lt;a href = "#(url)#"&gt;  &lt;b&gt;IRIS&lt;/b&gt;&lt;/a&gt; &lt;/html&gt; &gt; quit $$$OK } }</code> </pre><br></div></div><br>  Aktivieren Sie bei Bedarf erweiterte Debugging-Nachrichten auf dem OAuth-Server und dem OAuth-Client.  Nachrichten werden in den globalen ISCLOG im Bereich% SYS geschrieben.  Geben Sie Ihr IRIS-Terminal ein (oder installieren und verwenden Sie ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Web-Terminal</a> ): <br><br><pre> <code class="plaintext hljs">set ^%ISCLOG = 5 set ^%ISCLOG("Category", "OAuth2") = 5 set ^%ISCLOG("Category", "OAuth2Server") = 5</code> </pre><br>  <a href="">Weitere Informationen finden</a> Sie in der IRIS-Dokumentation <a href="">Verwenden von OAuth 2.0 und OpenID Connect</a> . <br><br>  Schlussfolgerungen: <br><br><ol><li>  OAuth hilft bei der physischen und geografischen Trennung von Diensten mit Benutzeranmeldeinformationen und "funktionierenden" Datenbanken.  Und dadurch den Schutz von Identifikationsdaten st√§rken und erforderlichenfalls die Anforderungen der Gesetze zum Schutz personenbezogener Daten verschiedener L√§nder erf√ºllen. </li><li>  Mit OAuth k√∂nnen Sie dem Benutzer die M√∂glichkeit geben, gleichzeitig sicher von mehreren Ger√§ten aus zu arbeiten und seine pers√∂nlichen Daten minimal auf verschiedene Dienste und Anwendungen zu √ºbertragen.  Sie nehmen nicht nur ‚Äûredundante‚Äú Informationen √ºber Benutzer in ihren Diensten auf, sondern f√ºhren auch eine depersonalisierte Datenverarbeitung in ihren Diensten durch. </li><li>  Wenn Sie InterSystems IRIS verwenden, verf√ºgen Sie √ºber einen vollst√§ndigen Satz vorgefertigter Tools zum Testen und Bereitstellen von OAuth- und OIDC-Diensten, sowohl eigenst√§ndig als auch in Zusammenarbeit mit Softwareprodukten von Drittanbietern. </li></ol><br><blockquote>  Welche Branchen nutzen die InterSystems IRIS-Plattform am h√§ufigsten? <br>  F√ºr die Automatisierung des Gesundheitswesens, im Finanzsektor, f√ºr E-Government-Projekte, in der Logistik, im Einzelhandel und in vielen anderen Branchen. <br><br>  Wenn Sie sich f√ºr die Aufgaben der Automatisierung des Gesundheitswesens interessieren, beachten Sie den FHIR-Standard.  InterSystems IRIS for Health (eine spezielle Version der InterSystems IRIS-Plattform) unterst√ºtzt den FHIR-Standard f√ºr Integration und Anwendungsentwicklung </blockquote>  Wie Sie oben sehen k√∂nnen, sind alle OAuth-Funktionen leicht zug√§nglich und vollst√§ndig einsatzbereit.  Bei Bedarf k√∂nnen Sie die Handlerklassen und Benutzeroberfl√§chen durch Ihre eigenen ersetzen.  OAuth-Server- und Clienteinstellungen k√∂nnen aus Konfigurationsdateien vorgenommen werden, anstatt das Verwaltungsportal zu verwenden. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466699/">https://habr.com/ru/post/de466699/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466685/index.html">Geld sehen</a></li>
<li><a href="../de466689/index.html">So erstellen Sie Zeichenklassen in der mobilen MMO-Aktion</a></li>
<li><a href="../de466691/index.html">Also alle gleich RAML oder OAS (Swagger)?</a></li>
<li><a href="../de466693/index.html">Wenn Sie nicht in die IT eingeben</a></li>
<li><a href="../de466697/index.html">Monaden in Erlang</a></li>
<li><a href="../de466701/index.html">Let's Encrypt bedient fast 30% der Domains</a></li>
<li><a href="../de466705/index.html">Vivaldi Beta f√ºr Android - Echter Browser</a></li>
<li><a href="../de466709/index.html">Entwicklung einer monolithischen Unix-√§hnlichen OS-C-Bibliothek (2)</a></li>
<li><a href="../de466711/index.html">Sicherheitsl√ºcke DaOffice darf jeden Benutzer aus dem sozialen Netzwerk entfernen</a></li>
<li><a href="../de466713/index.html">Ist es in 1C m√∂glich, die Technologie externer Komponenten nicht zu beobachten? Oder wie man Kollegen mit 1C gratuliert?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>