<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍✈️ 🗺️ 👩🏽‍🤝‍👩🏼 Docker et Kubernetes dans des environnements exigeants en matière de sécurité 🚻 ⏬ 🧒🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Remarque perev. : L'article original a été écrit par un ingénieur suédois - Christian Abdelmassih, qui aime l'architecture au niveau de l'entreprise, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker et Kubernetes dans des environnements exigeants en matière de sécurité</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/440504/"> <i><b>Remarque</b></i>  <i><b>perev.</b></i>  <i>: L'article original a été écrit par un ingénieur suédois - Christian Abdelmassih, qui aime l'architecture au niveau de l'entreprise, la sécurité informatique et le cloud computing.</i>  <i>Récemment, il a obtenu une maîtrise en informatique et est pressé de partager son travail - une thèse de maîtrise, ou plutôt une partie de celle-ci, consacrée aux problèmes d'isolement d'une application conteneurisée [et lancée dans Kubernetes].</i>  <i>En tant que «client» pour lequel ce travail de recherche a été préparé, il agit tout autant que la police de son pays d'origine.</i> <br><br><img src="https://habrastorage.org/webt/_8/ys/gr/_8ysgrs-atvkocc6r8jpzyzzu1g.jpeg"><br><br>  L'orchestration de conteneurs et l'informatique native dans le cloud sont devenues très populaires ces dernières années.  Leur adaptation a atteint un niveau tel que même les entreprises financières, les banques et le secteur public s'y intéressent.  Par rapport à d'autres entreprises, elles se distinguent par des exigences importantes dans le domaine de la sécurité de l'information et de l'informatique. <a name="habracut"></a><br><br>  L'un des aspects importants est la façon dont les conteneurs peuvent être utilisés dans les environnements de production et en même temps, la séparation du système entre les applications peut être maintenue.  Étant donné que ces organisations utilisent des environnements de cloud privé basés sur la virtualisation au-dessus du métal nu, la perte d'une telle isolation lors de la migration vers un environnement avec des conteneurs orchestrés est inacceptable.  Compte tenu de ces limites, ma thèse a été écrite et la police suédoise est considérée comme un client cible. <br><br>  La problématique spécifique de l'étude considérée dans la thèse est: <br><br><blockquote>  Comment la démarcation des applications est-elle prise en charge dans Docker et Kubernetes par rapport aux machines virtuelles exécutées au-dessus de l'hyperviseur ESXi fonctionnant sur du métal nu? </blockquote><br>  Ce problème nécessite une étude approfondie.  Pour commencer, regardez le dénominateur commun - les applications. <br><br><h2>  Les applications Web prêtent à confusion </h2><br>  Vulnérabilités dans les applications Web - un véritable zoo de vecteurs d'attaque.  Les risques les plus importants sont présentés dans le Top 10 de l'OWASP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2013</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2017</a> ).  Ces ressources aident à éduquer les développeurs à réduire les risques typiques.  Cependant, même si les développeurs ont écrit du code sans faille, l'application peut toujours être vulnérable - par exemple, grâce aux dépendances des packages. <br><br>  David Gilbertson a écrit une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">grande histoire</a> sur la façon dont vous pouvez injecter du code via un package malveillant distribué, par exemple, dans le cadre de NPM pour les applications basées sur Node.js.  Pour détecter les vulnérabilités, vous pouvez utiliser des scanners de dépendance, mais ils ne font que <i>réduire le</i> risque, mais ne l'éliminent pas complètement. <br><br>  Même si vous créez des applications sans dépendances tierces, il est toujours irréaliste de croire que l'application ne deviendra jamais vulnérable. <br><br>  <b>En raison de ces risques, nous ne pouvons pas dire que les applications Web sont sûres.</b> <br><br>  Au lieu de cela, respectez une stratégie de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>défense en profondeur</b></a> (DID).  Jetons un œil au niveau supérieur: les conteneurs et les machines virtuelles. <br><br><h2>  Conteneurs contre machines virtuelles - une histoire d'isolement </h2><br>  Un conteneur est un environnement d'espace utilisateur isolé qui est souvent implémenté en utilisant les capacités du noyau.  Par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Docker</a> utilise pour cela les espaces de noms, les groupes de contrôle et les capacités Linux.  En ce sens, l'isolement des conteneurs Docker est <b>très différent</b> des machines virtuelles lancées par des hyperviseurs de type 1 <i>(c'est-à-dire travaillant directement sur le matériel; hyperviseurs nus)</i> . <br><br>  La différenciation pour de telles machines virtuelles peut être implémentée à un niveau aussi bas que dans le matériel réel, par exemple, via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Intel VT</a> .  Les conteneurs Docker, à leur tour, s'appuient sur le noyau Linux pour la démarcation.  Cette différence est très importante à prendre en compte lorsqu'il s'agit d' <i>attaques en couches inférieures</i> . <br><br>  Si un attaquant est capable d'exécuter du code dans une machine virtuelle ou un conteneur, il peut potentiellement atteindre un niveau inférieur en effectuant une <i>attaque d'échappement</i> . <br><br><img src="https://habrastorage.org/webt/36/hl/_c/36hl_cjove9e7ufmr4g7f3vcq5q.png"><br>  <i>selon que les conteneurs ou les machines virtuelles sont utilisés sur le matériel, la différenciation est mise en œuvre à différents niveaux d'infrastructure.</i> <br><br>  La possibilité de telles attaques a été prouvée pour l'hyperviseur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VMware ESXi</a> lors du concours de hacker Pwn2Own 2017, ainsi que pour GeekPwn2018.  Le résultat a été une paire de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2017–4902</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2018–6981</a> ) qui peuvent être utilisés dans les attaques de couche inférieure pour <b>quitter les machines</b> <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">virtuelles</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">échappement de machine virtuelle</a> )</i> .  Les machines virtuelles sur serveurs de fer ne garantissent pas une sécurité absolue, même si elles utilisent la technologie pour différencier le niveau de fer. <br><br>  D'un autre côté, si nous regardons les vecteurs d'attaque sur un hyperviseur nu-métal par rapport au noyau Linux, il est évident que ce dernier a une surface d'attaque beaucoup plus grande - en raison de sa taille [noyau Linux] et de sa gamme de capacités.  Une surface d'attaque plus grande implique plus de vecteurs d'attaque potentiels pour les environnements cloud utilisant l'isolement des conteneurs.  Cela se manifeste par l'attention croissante portée aux <i>attaques d'échappement de conteneurs</i> , qui ont été rendues possibles grâce aux exploits du noyau (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2016–5195</a> <i>[c.</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-à-</a> <i>d. Dirty COW - approx. Transl.]</i> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2017–1000405</a> ) <br><br>  Des modules comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SELinux</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AppArmor</a> peuvent être utilisés pour augmenter l'isolation <b>à l'intérieur du</b> conteneur.  Malheureusement, de tels mécanismes de sécurité dans le noyau n'empêchent pas les attaques d'échappement sur le noyau lui-même.  Ils ne limiteront les actions possibles de l'attaquant que si le dépassement des limites n'est <i>pas possible</i> .  Si nous voulons gérer les sorties à l'extérieur du conteneur, un mécanisme d'isolement <b>à l'extérieur du</b> conteneur ou même du noyau <b>est</b> nécessaire.  Par exemple, un bac à sable <i>(bac à sable)</i> ! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gVisor</a> est un sandbox pour le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">runtime</a> du conteneur, dont le code a été ouvert par Google et qui ajoute un noyau supplémentaire entre le conteneur et le noyau du système d'exploitation.  Ce type de sandbox peut améliorer la situation avec des attaques de conteneurs hors limites qui ont lieu <i>au niveau du noyau</i> .  Cependant, les principaux exploits ne sont qu'un des outils de l'attaquant. <br><br>  Pour voir comment d'autres attaques peuvent conduire à des résultats similaires, vous devez regarder une image plus générale de la façon dont les conteneurs sont utilisés à l'ère du cloud. <br><br><h2>  L'effet de l'orchestration des conteneurs sur l'isolement </h2><br>  Pour gérer les conteneurs s'exécutant dans des environnements avec de nombreux nœuds, ils introduisent l'orchestration, dans laquelle Kubernetes donne le rôle principal.  Il s'avère que les bogues d'orchestrateur peuvent également affecter l'isolement des conteneurs. <br><br>  Tim Allclair a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fait</a> une merveilleuse présentation à KubeCon 2018, dans laquelle il a noté quelques surfaces d'attaque.  Dans son rapport, il <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mentionne</a> un exemple ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2017-1002101</a> ), comment les bogues d'orchestration peuvent affecter l'isolement - dans ce cas, grâce à la possibilité de monter de l'espace disque en dehors du pod.  Les vulnérabilités de ce type sont très problématiques, car  peut contourner le bac à sable dans lequel le conteneur est emballé. <br><br>  En introduisant Kubernetes, nous avons élargi la surface d'attaque.  Il comprend des systèmes hébergés sur le maître Kubernetes.  L'un d'eux est le serveur API Kubernetes, où ils ont récemment découvert une vulnérabilité qui pourrait autoriser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des</a> privilèges <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">excessifs</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CVE-2018–1002105</a> ).  Étant donné que la surface d'attaque du maître Kubernetes dépasse le cadre de ma thèse, cette vulnérabilité particulière n'est pas prise en compte. <br><br>  Pourquoi les attaques par évasion sont-elles si importantes?  Les conteneurs ont permis d'exécuter de nombreuses applications co-hébergées dans le même système d'exploitation.  Il y avait donc un risque associé à l'isolement des applications.  Si une application critique et une autre application vulnérable s'exécutent sur le même hôte, un attaquant pourrait accéder à une application critique via une attaque contre une application vulnérable. <br><br>  Selon le type de données avec lesquelles l'organisation travaille, leur fuite peut nuire non seulement à l'organisation elle-même, mais également aux individus et à l'ensemble du pays.  Comme vous vous en souvenez, nous parlons du secteur public, des finances, des banques ... - une fuite peut sérieusement affecter la vie des gens. <br><br>  L'orchestration de conteneurs peut-elle même être utilisée dans de tels environnements?  Avant d'entamer une réflexion plus approfondie, une évaluation des risques doit être effectuée. <br><br><h2>  Quel risque est acceptable? </h2><br>  Avant d'introduire des mesures de sécurité, il est important de réfléchir au type d'informations que l'organisation essaie réellement de protéger.  La décision de savoir si des mesures supplémentaires sont nécessaires pour empêcher d'éventuelles attaques d'échappement sur les conteneurs dépend des données avec lesquelles l'organisation travaille et des services qu'elle fournit. <br><br>  À long terme, cela signifie que pour obtenir la possibilité de quitter le conteneur sur un hôte <i>correctement configuré</i> protégé par le sandbox du conteneur, l'attaquant doit: <br><br><ol><li>  exécuter du code dans un conteneur, par exemple, par injection de code ou en utilisant des vulnérabilités dans le code d'application; </li><li>  profiter d'une autre vulnérabilité, zero-day, ou pour laquelle un correctif n'a pas encore été appliqué pour quitter le conteneur même <i>s'il existe un sandbox</i> . </li></ol><br>  Comme vous pouvez le deviner, une organisation qui ne considère pas un tel scénario comme acceptable devrait travailler avec des données ou offrir des services très exigeants en matière de <b>confidentialité</b> , d' <b>intégrité</b> et / ou d' <b>accessibilité</b> . <br><br>  Étant donné que la thèse est consacrée à de tels clients, la perte de l'isolement du système en sortant du conteneur n'est pas autorisée, car  ses conséquences sont trop importantes.  Quelles mesures peuvent être prises pour améliorer l'isolement?  Pour monter d'un niveau dans l'échelle d'isolement, vous devez également regarder les bacs à sable dans lesquels le noyau du système d'exploitation est enveloppé, c'est-à-dire  machines virtuelles! <br><br>  Les technologies de virtualisation qui utilisent des hyperviseurs hébergés amélioreront la situation, mais nous voulons limiter <i>encore plus la</i> surface d'attaque.  Par conséquent, examinons les hyperviseurs installés sur le fer et voyons vers quoi ils nous mèneront. <br><br><h2>  Hyperviseurs sur le fer </h2><br>  Une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">étude de l'</a> Agence suédoise suédoise de recherche pour la défense a examiné les risques de virtualisation en relation avec les forces armées suédoises.  Sa conclusion a parlé des avantages de ces technologies pour l'armée, même avec les exigences de sécurité strictes et les risques que la virtualisation apporte. <br><br>  À cet égard, nous pouvons dire que la virtualisation est utilisée (dans une certaine mesure) dans l'industrie de la défense, car elle comporte <b>des risques acceptables</b> .  Étant donné que les agences et les entreprises de l'industrie de la défense sont l'un des clients les plus exigeants en matière de sécurité informatique, nous pouvons également affirmer que le risque acceptable pour eux signifie qu'il est acceptable pour les clients considérés dans la thèse.  Et tout cela - malgré les sorties potentielles au-delà de la machine virtuelle, discutées ci-dessus. <br><br>  Si nous décidons d'utiliser ce type de bac à sable pour les conteneurs, il y a quelques éléments à considérer dans le contexte des spécificités natives du cloud. <br><br><h2>  Noeuds sandbox pour machines virtuelles </h2><br>  L'idée est que les nœuds du cluster Kubernetes sont des machines virtuelles qui utilisent la virtualisation matérielle.  Étant donné que les machines virtuelles joueront le rôle de sandbox pour les conteneurs qui s'exécutent dans des pods, chaque nœud peut être considéré comme un environnement protégé par sandbox. <br><br>  Remarque importante à propos de ces bacs à sable dans le contexte des bacs à sable de conteneur déjà mentionnés: cette approche vous permet de placer plusieurs conteneurs dans un bac à sable.  Cette flexibilité vous permet de réduire les frais généraux par rapport au cas où chaque conteneur a son propre bac à sable.  Comme chaque sandbox apporte son propre système d'exploitation, nous voulons réduire leur nombre tout en maintenant l'isolement. <br><br><img src="https://habrastorage.org/webt/wg/2t/jr/wg2tjra8xh9y_i7vlyygm7vulzy.png"><br>  <i>Les machines virtuelles installées sur le matériel - nœuds de cluster - agissent comme des sandbox pour les conteneurs.</i>  <i>Les conteneurs s'exécutant sur différentes machines virtuelles sont délimités avec un niveau de risque acceptable.</i>  <i>Cependant, cela ne s'applique pas aux conteneurs s'exécutant sur la même machine virtuelle.</i> <br><br>  Cependant, étant donné que Kubernetes est capable de changer le placement des gousses pour diverses raisons, ce qui peut <b>ruiner l'idée d'utiliser des bacs à sable</b> , il sera nécessaire d'ajouter des restrictions sur le mécanisme de placement des gousses communes.  Vous pouvez atteindre le résultat souhaité de plusieurs manières. <br><br>  Au moment de la rédaction, Kubernetes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v1.13</a> ) prend en charge trois méthodes principales pour contrôler la planification et / ou le lancement des pods: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NodeSelector</a> &amp; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NodeAffinity</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Taints &amp; tolérances</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PodAffinity &amp; PodAntiAffinity</a> . </li></ul><br>  La ou les méthodes à utiliser dépendent de l'application de l'organisation.  Cependant, il est important de noter que les méthodes diffèrent dans leur capacité à éliminer les pods après leur entrée dans la phase d'exécution.  Maintenant, seules les souillures sont capables de cela - grâce à l'action <code>NoExecute</code> .  Si vous ne traitez pas ce moment de quelque façon que ce soit et que certaines étiquettes changent, tout peut entraîner une colocalisation indésirable. <br><br><h2>  Conformité aux exigences de colocalisation </h2><br>  La thèse propose l'idée d'utiliser un système de classification qui montre comment la sensibilité se reflète dans la colocalisation.  L'idée est d'utiliser la relation 1: 1 entre le conteneur et le pod et de déterminer la colocalisation des pods en fonction de la classification des applications conteneurisées. <br><br>  Pour plus de simplicité et de réutilisabilité, le système de classification en 3 étapes suivant est utilisé: <br><br><ul><li>  <b>Classe O</b> : l'application n'est pas sensible et n'a pas d'exigences d'isolement.  Il peut être placé sur tous les nœuds n'appartenant à aucune autre classe. </li><li>  <b>Classe PG</b> <i>(groupe privé)</i> : une application, avec un ensemble d'autres applications, forme un groupe privé pour lequel un nœud dédié est requis.  Une application ne peut être hébergée que sur des nœuds de classe PG qui ont l'identifiant de groupe privé correspondant. </li><li>  <b>Classe P</b> <i>(privée)</i> : une application nécessite un nœud privé et séparé et ne peut être placée que sur des nœuds vides de sa classe (P). </li></ul><br>  Pour répondre aux exigences de colocalisation pour de nombreuses applications classifiées, des taches et des tolérances sont utilisées, avec lesquelles chaque nœud est affecté à une classe, et PodAffinity pour appliquer des restrictions supplémentaires pour les pods avec des applications de classe P ou PG. <br><br>  Cet exemple simplifié montre comment les souillures et les tolérances peuvent être utilisées pour implémenter le contrôle de colocalisation: <br><br><img src="https://habrastorage.org/webt/ul/qj/ec/ulqjecbgz60kuw7upls5jyrxpik.gif"><br><br>  <i>Les pods 2 et 3 contiennent des applications d'un groupe privé, et l'application sur le pod 1 est plus sensible et nécessite un nœud dédié.</i> <br><br>  Cependant, les classes P et PG nécessiteront des règles d'affinité supplémentaires pour garantir que les demandes de démarcation sont exécutées à mesure que le cluster et les applications hébergées se développent.  Voyons comment vous pouvez implémenter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ces règles</a> pour différentes classes: <br><br><pre> <code class="plaintext hljs"># Class P affinity: podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" namespaces: ["default"] labelSelector: matchExpressions: - key: non-existing-key operator: DoesNotExist</code> </pre> <br>  Les règles d'affinité pour les applications de classe P nécessitent des nœuds dédiés.  Dans ce cas, le pod ne sera pas planifié si le pod se ferme sans <code>non-existing-key</code> .  Tout fonctionnera jusqu'à ce qu'un seul pod ait cette clé. <br><br><pre> <code class="plaintext hljs"># Class PG affinity: podAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchLabels: class-pg-group-1: foobar podAntiAffinity: requiredDuringSchedulingIgnoredDuringExecution: - topologyKey: "kubernetes.io/hostname" labelSelector: matchExpressions: - key: class-pg-group-1 operator: DoesNotExist</code> </pre> <br>  Pour les applications de classe PG, les règles d'affinité co-hébergent les pods qui ont un identifiant de groupe <code>class-pg-group-1</code> et sur les nœuds qui ont des pods sans identifiant. <br><br>  Une telle approche nous permettra d'utiliser un système de classification pour délimiter les conteneurs en fonction des exigences pertinentes d'une application conteneurisée. <br><br>  Qu'avons-nous obtenu? <br><br><h2>  Conclusion </h2><br>  Nous avons envisagé un moyen d'implémenter des bacs à sable basés sur l'hyperviseur de type 1 (c'est-à-dire lancé sur du métal nu) pour créer des nœuds dans les clusters Kubernetes et présenté un système de classification qui définit les exigences de délimitation des applications conteneurisées.  Si nous comparons cette approche avec les autres solutions envisagées, elle présente des avantages en termes d’isolation du système. <br><br>  Une conclusion importante est que la stratégie d'isolement <i>limite la propagation des</i> attaques d'échappement au conteneur.  <b>En d'autres termes, le fait de laisser le conteneur seul n'est pas empêché, mais ses effets sont atténués.</b>  De toute évidence, cela s'accompagne de difficultés supplémentaires qui doivent être prises en compte lors de comparaisons similaires. <br><br>  Pour utiliser la méthode spécifiée dans un environnement cloud et fournir une évolutivité, des exigences supplémentaires seront imposées à l'automatisation.  Par exemple, pour automatiser la création de machines virtuelles et leur utilisation dans le cluster Kubernetes.  La chose la plus importante sera la mise en œuvre et la vérification de la classification <b>répandue</b> des demandes. <br><br>  Cela fait partie de ma thèse sur l' <b>isolement d'une application conteneurisée</b> . <br><br>  Pour éviter qu'un attaquant qui se déconnecte du conteneur sur un nœud n'attaque les services d'autres nœuds, il est nécessaire de considérer <i>les attaques propagées par le réseau</i> .  Pour prendre en compte ces risques, ma thèse propose une <b><i>segmentation du réseau de clusters</i></b> et introduit des architectures cloud, dont l'une dispose d'un <b>pare-feu matériel</b> . <br><br>  Ceux qui le souhaitent peuvent se familiariser avec le document complet - le texte de la thèse est accessible au public: « <a href="">Container Orchestration in Security Demanding Environments at the Swedish Police Authority</a> ». <br><br><h2>  PS du traducteur </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vulnérabilité CVE-2019-5736 dans runc, permettant d'obtenir des privilèges root sur l'hôte</a> "; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">9 meilleures pratiques de sécurité chez Kubernetes</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">11 façons de (ne pas) devenir une victime du piratage Kubernetes</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comprendre RBAC chez Kubernetes</a> »; </li><li>  « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OPA et SPIFFE - Deux nouveaux projets au CNCF pour la sécurité des applications cloud</a> »; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vulnerable Docker VM - un jeu de puzzle virtuel par Docker et pentesting</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440504/">https://habr.com/ru/post/fr440504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440490/index.html">Biomodule 1-2</a></li>
<li><a href="../fr440492/index.html">La Corée du Sud abandonnera les voitures électriques et la construction de nouvelles centrales nucléaires</a></li>
<li><a href="../fr440498/index.html">La police de Moscou recevra des points avec reconnaissance faciale</a></li>
<li><a href="../fr440500/index.html">D'abord</a></li>
<li><a href="../fr440502/index.html">Comment lancer votre podcast, un guide pour débutants</a></li>
<li><a href="../fr440506/index.html">La sonde en orbite lunaire de la NASA a pris de nouvelles photos de la station chinoise Chang'e 4 - de plus en plus claire</a></li>
<li><a href="../fr440508/index.html">Comment perdre votre passe-temps et en faire une entreprise en ligne réussie aux États-Unis</a></li>
<li><a href="../fr440510/index.html">Qui développe des commutateurs 400GbE pour les centres de données</a></li>
<li><a href="../fr440512/index.html">Factorielles divisibles</a></li>
<li><a href="../fr440514/index.html">Qui peuplera le pays des cyborgs? Le statut de développement de la société Motorika a parlé du statut futur de l'île Russky</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>