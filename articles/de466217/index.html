<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍🚒 🤸🏻 🤟🏼 Generieren von Dokumenten mit ONLYOFFICE DocumentBuilder 🌁 🏁 🤜🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. 


 Ich möchte über ein Dienstprogramm namens DocumentBuilder sprechen, mit dem Sie Dokumente, Tabellen und Präsentationen erstellen und a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Generieren von Dokumenten mit ONLYOFFICE DocumentBuilder</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466217/"><p><img src="https://habrastorage.org/webt/i8/j3/kd/i8j3kdtzriyrkwbhkbqbbpozbik.png"></p><br><p>  Hallo Habr. </p><br><p>  Ich möchte über ein Dienstprogramm namens DocumentBuilder sprechen, mit dem Sie Dokumente, Tabellen und Präsentationen erstellen und anhand des Beispiels zum Erstellen eines Lebenslaufs aus Vorlagen zeigen können, wie Sie damit Ihre Probleme lösen können. </p><br><p>  Der Builder funktioniert wie folgt: Sie schreiben Code in js mit speziellen Methoden aus der Dokumentation, geben ihn an das Dienstprogramm weiter und sammeln das Dokument.  Oder sammelt nicht, wenn es Fehler gibt. </p><a name="habracut"></a><br><p>  Die Verwendung eines Builders ist ratsam, wenn Sie Aufgaben des folgenden Typs lösen möchten: </p><br><ul><li>  Sie müssen viele Dokumente mit kleinen Abweichungen oder Dokumente erstellen, die auf vielen Daten basieren. </li><li>  Sie müssen die Generierung von Dokumenten in jeden Dienst integrieren. </li></ul><br><p>  Es gibt Dienste, mit denen Sie einen Lebenslauf erstellen können: Der Benutzer füllt die erforderlichen Felder aus, und das System generiert ein Dokument und gibt es dem Benutzer.  Dies ist ein Beispiel für die Verwendung des Builders. </p><br><p>  Als Werkzeuge werde ich Node.js (Express) verwenden. </p><br><p>  Plan: </p><br><ol><li>  Der Benutzer gibt Daten in das Formular auf der Seite im Browser ein, das Formular wird an den Server gesendet. </li><li>  Auf dem Node.js-Server wird basierend auf Benutzerdaten ein Skript für den Builder erstellt. </li><li>  Node.js gibt das Skript an den Builder weiter. </li><li>  Der Builder erstellt ein Dokument mithilfe eines Skripts. </li><li>  Node.js gibt den Link zum Dokument an den Benutzer zurück. </li></ol><br><h2 id="sozdanie-formy">  Formularerstellung </h2><br><p>  Erstellen Sie zunächst ein Formular, in das der Benutzer seine Daten eingibt.  Das Formular enthält 8 Felder: "Vollständiger Name", "Telefonnummer", "E-Mail", "Profil", "Abschluss", "Universität", "Ort", "Jahr", "Fähigkeit".  Das Fertigkeitsfeld kann geklont werden. </p><br><p>  Erstellen Sie eine index.html-Datei und fügen Sie den Vorlagencode hinzu. </p><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill-name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill-name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"full name"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone-number"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone-number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"phone number"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"profile"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"profile"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Insert a brief description of yourself"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"education"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"degree"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"university"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"university"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"location"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"date"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skills"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skill"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"new-skill"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"skill"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onkeyup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add_skill_by_enter(event)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add_skill()"</span></span></span><span class="hljs-tag">&gt;</span></span>+<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Hier benutze ich zwei Funktionen: add_skill_by_enter (event) und add_skill ().  Sie werden benötigt, um mehrere Felder durch Drücken der Taste + oder Enter hinzuzufügen.  Ich werde diese Funktionen etwas später beschreiben. </p><br><p>  Fügen Sie eine Schaltfläche hinzu, um das Formular an den Server zu senden: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sendForm()"</span></span></span><span class="hljs-tag">&gt;</span></span>Send<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Jetzt werden wir Funktionen für die Arbeit mit dem Formular schreiben. </p><br><p>  Die erste Funktion ist add_skill () </p><br><pre> <code class="javascript hljs">add_skill = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> newSkill = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"new-skill"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newSkill.value === <span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   ,       const div = document.createElement("div"); .// div const span = document.createElement("span"); //   const button = document.createElement("button"); //    span.innerText += newSkill.value; //   span   newSkill.value = ''; //      newSkill.focus(); //        button.innerText += "-"; button.onclick = () =&gt; { //      div.remove(); }; div.appendChild(span); //  span  div div.appendChild(button); //   document.getElementsByClassName('skills')[0].appendChild(div); //     }; add_skill_by_enter() add_skill_by_enter = (event) =&gt; { if (event.code === "Enter") { //  ,      enter add_skill(); } };</span></span></code> </pre> <br><p>  Wir fügen eine einfache Funktion hinzu, um Daten aus den Feldern zu sammeln und an den Server zu senden. </p><br><pre> <code class="javascript hljs"> get_skill_values = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> skills = []; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'new-skill'</span></span>).value !== <span class="hljs-string"><span class="hljs-string">''</span></span>) { skills.push(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'new-skill'</span></span>).value); } <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementsByClassName(<span class="hljs-string"><span class="hljs-string">'skillfield'</span></span>)).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">current_element</span></span></span><span class="hljs-function"> =&gt;</span></span> { skills.push(current_element.innerHTML); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> skills; }; sendForm() sendForm = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { fetch(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: { <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify({ <span class="hljs-attr"><span class="hljs-attr">userData</span></span>: { <span class="hljs-attr"><span class="hljs-attr">fillName</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'fill-name'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">phoneNumber</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'phone-number'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'email'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">profile</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'profile'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">education</span></span>: { <span class="hljs-attr"><span class="hljs-attr">degree</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'degree'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">university</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'university'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">location</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'location'</span></span>).value, <span class="hljs-attr"><span class="hljs-attr">year</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'year'</span></span>).value, }, <span class="hljs-attr"><span class="hljs-attr">skills</span></span>: get_skill_values() } }) }).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> { location.replace(<span class="hljs-string"><span class="hljs-string">'/'</span></span> + response.filename); <span class="hljs-comment"><span class="hljs-comment">//  ,       }) .catch(error =&gt; console.error('Error:', error)); };</span></span></code> </pre> <br><h2 id="servernaya-chast-dlya-raboty-s-formoy">  Die Serverseite für die Arbeit mit dem Formular </h2><br><p>  Ich schreibe den Serverteil auf Express.  Die Verbindung aller Bibliotheken, die Serverkonfiguration und die Beschreibung der Get- und Post-Methoden sehen folgendermaßen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bodyParser = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'body-parser'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> app = express(); app.use(bodyParser.json()); app.get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { res.sendFile(path.join(__dirname + <span class="hljs-string"><span class="hljs-string">'/index.html'</span></span>)); }); app.post(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { <span class="hljs-comment"><span class="hljs-comment">//        }); app.listen(3000, () =&gt; console.log(`Example app listening on port ${3000}!`));</span></span></code> </pre> <br><p>  Express ausführen: <br> <code>node main.js</code> </p> <br><p>  Öffnen Sie die Adresse im Browser: <br> <code>http:localhost:3000</code> </p> <br><p>  Wir sehen das erstellte Formular.  Wir füllen es mit beliebigen Daten: <br><img src="https://habrastorage.org/webt/v9/qo/sq/v9qosqh3l4ppxfrt-zulcv1fyce.png"></p><br><p>  Wir bekommen folgendes json: </p><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"userData"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"fillName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Rotatyy Dmitryi"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"phoneNumber"</span></span>:<span class="hljs-string"><span class="hljs-string">"89879879898"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"flamine@list.ru"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"profile"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hi, my name is Joe\nAnd I work in a button factory\nI got a wife and two kids\nOne day, my boss says, “Joe, are you busy?”\nI said, “no”\n“Then push this button with your right hand”"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"Russia"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"city"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"education"</span></span>:{<span class="hljs-attr"><span class="hljs-attr">"degree"</span></span>:<span class="hljs-string"><span class="hljs-string">"Master of Pupets"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"university"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhny novgorod state technical university"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"location"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-attr"><span class="hljs-attr">"year"</span></span>:<span class="hljs-string"><span class="hljs-string">"2015-05-02"</span></span>},<span class="hljs-attr"><span class="hljs-attr">"skills"</span></span>:[<span class="hljs-string"><span class="hljs-string">"apple.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"vintage.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"zerg.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"css"</span></span>,<span class="hljs-string"><span class="hljs-string">"html"</span></span>,<span class="hljs-string"><span class="hljs-string">"linux"</span></span>]}};</code> </pre> <br><p>  Jetzt müssen Sie ein Skript für den Builder schreiben.  Ich habe die Vorlage verwendet, die Google Text &amp; Tabellen anbietet (Lebenslaufvorlage). </p><br><p>  Diese Vorlage sieht folgendermaßen aus: <br><img src="https://habrastorage.org/getpro/habr/post_images/0a0/488/bbe/0a0488bbe082407d850b2fe37bd5704f.png" alt="Bild"></p><br><p>  Mit diesen Daten und der Vorlage müssen Sie ein Skript erstellen, mit dem der Builder das Dokument erstellt. </p><br><p>  Hierfür gibt es verschiedene Möglichkeiten. Am einfachsten ist es, die Desktop-Version der ONLYOFFICE-Editoren herunterzuladen und ein Makro zu schreiben, mit dem das Dokument anhand der Daten erstellt wird.  Fügen Sie dann dem Makro das Erstellen und Speichern der Datei hinzu - Sie erhalten ein Skript für den Builder.  Dies funktioniert, da Makros und der Builder dieselbe API verwenden. <br><img src="https://habrastorage.org/webt/0n/qo/ee/0nqoeewn2so-cv6gvwwdlvpywls.png"></p><br><h2 id="sozdanie-skripta-dlya-bildera">  Erstellen eines Skripts für einen Builder </h2><br><p>  Wir beginnen mit der Initialisierung des Seitenobjekts und dem Hinzufügen der vom Benutzer stammenden Daten: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Document = Api.GetDocument(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = {<span class="hljs-string"><span class="hljs-string">"userData"</span></span>:{<span class="hljs-string"><span class="hljs-string">"fillName"</span></span>:<span class="hljs-string"><span class="hljs-string">"Rotatyy Dmitryi"</span></span>,<span class="hljs-string"><span class="hljs-string">"phoneNumber"</span></span>:<span class="hljs-string"><span class="hljs-string">"89879879898"</span></span>,<span class="hljs-string"><span class="hljs-string">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"flamine@list.ru"</span></span>,<span class="hljs-string"><span class="hljs-string">"profile"</span></span>:<span class="hljs-string"><span class="hljs-string">"Hi, my name is Joe\nAnd I work in a button factory\nI got a wife and two kids\nOne day, my boss says, “Joe, are you busy?”\nI said, “no”\n“Then push this button with your right hand”"</span></span>,<span class="hljs-string"><span class="hljs-string">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"Russia"</span></span>,<span class="hljs-string"><span class="hljs-string">"city"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-string"><span class="hljs-string">"education"</span></span>:{<span class="hljs-string"><span class="hljs-string">"degree"</span></span>:<span class="hljs-string"><span class="hljs-string">"Master of Pupets"</span></span>,<span class="hljs-string"><span class="hljs-string">"university"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhny novgorod state technical university"</span></span>,<span class="hljs-string"><span class="hljs-string">"location"</span></span>:<span class="hljs-string"><span class="hljs-string">"Nizhniy Novgorod"</span></span>,<span class="hljs-string"><span class="hljs-string">"year"</span></span>:<span class="hljs-string"><span class="hljs-string">"2015-05-02"</span></span>},<span class="hljs-string"><span class="hljs-string">"skills"</span></span>:[<span class="hljs-string"><span class="hljs-string">"apple.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"vintage.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"zerg.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"css"</span></span>,<span class="hljs-string"><span class="hljs-string">"html"</span></span>,<span class="hljs-string"><span class="hljs-string">"linux"</span></span>]}};</code> </pre> <br><p>  Jetzt müssen Sie den Absatz mit dem vollständigen Benutzernamen hinzufügen.  Es ist fett geschrieben und dieser Absatz hat einen Zeilenabstand von 1,15. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> paragraph = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.GetElement(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       FullName_style = Document.CreateStyle("FullName"); //    FullName_style.GetTextPr().SetFontSize(28); //    FullName_style.GetTextPr().SetBold(true); //  bold paragraph.SetStyle(FullName_style); //      paragraph.SetSpacingLine(1.15 * 240, "auto"); //    paragraph.AddText(data.userData.fillName); //    </span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Wir fügen auch die restlichen Absätze hinzu:</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Country and city const CountryCity_style = Document.CreateStyle("CountryCity"); CountryCity_style.GetTextPr().SetFontSize(20); CountryCity_style.GetTextPr().SetCaps(true); CountryCity_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.country + ', ' + data.userData.city); paragraph.SetStyle(CountryCity_style); paragraph.SetSpacingAfter(0); Document.Push(paragraph); // phone number const PhoneNumber_style = Document.CreateStyle("PhoneNumber"); PhoneNumber_style.GetTextPr().SetFontSize(20); PhoneNumber_style.GetParaPr().SetSpacingAfter(0); PhoneNumber_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.phoneNumber); paragraph.SetStyle(PhoneNumber_style); Document.Push(paragraph); // email const Email_style = Document.CreateStyle("Email"); Email_style.GetTextPr().SetFontSize(18); Email_style.GetParaPr().SetSpacingAfter(0); Email_style.GetTextPr().SetBold(true); paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.email); paragraph.SetStyle(Email_style); Document.Push(paragraph); // SectionHeader style const SectionHeader = Document.CreateStyle("SectionHeader"); SectionHeader.GetTextPr().SetBold(true); SectionHeader.GetTextPr().SetColor(247, 93, 93, false); SectionHeader.GetTextPr().SetFontSize(28); SectionHeader.GetParaPr().SetSpacingBefore(1.33 * 240); SectionHeader.GetParaPr().SetSpacingLine(1 * 240, "auto"); // add header Profile: paragraph = Api.CreateParagraph(); paragraph.AddText("Profile:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add profile text: paragraph = Api.CreateParagraph(); paragraph.AddText(data.userData.profile) Document.Push(paragraph); // add header Education: paragraph = Api.CreateParagraph(); paragraph.AddText("Education:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add education year: const EducationYear_style = Document.CreateStyle("EducationYear"); EducationYear_style.GetTextPr().SetColor(102, 102, 102); EducationYear_style.GetTextPr().SetFontSize(18); EducationYear_style.GetParaPr().SetSpacingAfter(0); paragraph = Api.CreateParagraph(); paragraph.SetStyle(EducationYear_style); paragraph.AddText(data.userData.education.year) Document.Push(paragraph); // add education university: paragraph = Api.CreateParagraph(); run = Api.CreateRun(); run.AddText(data.userData.education.university) run.AddText(', ') run.AddText(data.userData.education.location) run.SetBold(true); paragraph.AddElement(run); run = Api.CreateRun(); run.AddText(' – ' + data.userData.education.degree) paragraph.AddElement(run); Document.Push(paragraph); // add header Skills: paragraph = Api.CreateParagraph(); paragraph.AddText("Skills:") paragraph.SetStyle(SectionHeader); Document.Push(paragraph); // add skills text: paragraph = Api.CreateParagraph(); const skills = data.userData.skills.map(x =&gt; ' ' + x).toString(); paragraph.AddText(skills) Document.Push(paragraph);</span></span></code> </pre> </div></div><br><p>  Durch Ausführen dieses Skripts erhalten wir das folgende Dokument: <br><img src="https://habrastorage.org/webt/jt/bu/c3/jtbuc3bitzmanxfyvddrmrohi_8.png"></p><br><p>  Jetzt ist es Zeit, Funktionen hinzuzufügen, um Skriptcode in eine Datei zu schreiben und ein Dokument zu generieren. </p><br><p>  Wir generieren das Skript -&gt; schreiben in die Datei -&gt; geben die Datei an den Builder weiter -&gt; geben den Link zur Datei an den Benutzer zurück. </p><br><p>  Wir fügen eine Verbindung von Add-Ons hinzu, um mit Dateien zu arbeiten und Befehle mit Node.js auszuführen. Außerdem erstellen wir einen "öffentlichen" Ordner und machen ihn öffentlich: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {exec} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'child_process'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>); app.use(express.static(<span class="hljs-string"><span class="hljs-string">'public'</span></span>));</code> </pre> <br><p>  Die Funktion zum Generieren von Text mit einem Skript ist sehr einfach: Sie gibt einfach eine Zeichenfolge mit dem gesamten Code für den Builder zurück, während Benutzerdaten hinzugefügt werden.  Es ist wichtig, am Ende jeder Zeile ein Zeilenumbruchzeichen einzufügen, da sonst nichts funktioniert. </p><br><pre> <code class="javascript hljs">generate_script = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> first_template = <span class="hljs-string"><span class="hljs-string">'builder.CreateFile("docx");\n'</span></span> + <span class="hljs-string"><span class="hljs-string">'const Document = Api.GetDocument();\n'</span></span>; first_template += <span class="hljs-string"><span class="hljs-string">'const data = '</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(data) + <span class="hljs-string"><span class="hljs-string">';\n'</span></span>; first_template += <span class="hljs-string"><span class="hljs-string">'let paragraph = Document.GetElement(0);\n'</span></span> + <span class="hljs-string"><span class="hljs-string">'FullName_style = Document.CreateStyle("FullName");\n'</span></span> + ....   ~~~~~~~~~~~ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first_template; };</code> </pre> <br><p>  Jetzt müssen Sie das Skript in eine Datei schreiben und dem Builder übergeben.  Tatsächlich wird die gesamte Arbeit mit dem Builder auf die Tatsache reduziert, dass der Befehl <code>documentbuilder path/script.js   Node.js</code> </p><br><p>  Wir schreiben eine Build-Funktion, die dies erledigt: </p><br><pre> <code class="javascript hljs">build = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> filename = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random().toString(<span class="hljs-number"><span class="hljs-number">36</span></span>).substring(<span class="hljs-number"><span class="hljs-number">7</span></span>) + <span class="hljs-string"><span class="hljs-string">'.docx'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    let script = generate_script(data); script += 'builder.SaveFile("docx", "' + __dirname + '/public/' + filename + '");\n' + 'builder.CloseFile();'; fs.writeFile('public/' + filename + 'js', script, () =&gt; { exec('documentbuilder ' + 'public/' + filename + 'js', () =&gt; { res.send({'filename': filename }); }); }); };</span></span></code> </pre> <br><p>  Fügen Sie der Erstellungsmethode einen Aufruf hinzu (req.body, res);  bei post Anfrage </p><br><pre> <code class="javascript hljs">app.post(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, (req, res) =&gt; { build(req.body, res); });</code> </pre> <br><p>  Und du bist fertig.  Für alle Fälle habe ich hier den vollständigen Beispielcode gepostet. </p><br><p>  So können Sie ONLYOFFICE DocumentBuilder in eine Webanwendung einbetten. </p><br><p>  Ich hoffe, dass trotz zahlreicher Vereinfachungen alles klar ist.  Ich habe nur den erforderlichen Mindestcode verwendet, um zu zeigen, wie alles funktioniert. </p><br><p>  Im Moment gibt es Gedanken, das Dienstprogramm zu beenden und das Spektrum der zu lösenden Probleme zu erweitern.  Ich wäre Ihnen dankbar, wenn Sie die tatsächlichen Fälle der Erstellung von Dokumenten (natürlich auch von Tabellen mit Präsentationen) in den Kommentaren oder in PM teilen würden. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466217/">https://habr.com/ru/post/de466217/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466201/index.html">Wie man die Wissenschaft in der IT verlässt und Tester wird: die Geschichte einer Karriere</a></li>
<li><a href="../de466203/index.html">Techdir-Tag in St. Petersburg. Bier, Pizza, zwei Mikrofone</a></li>
<li><a href="../de466211/index.html">Projekt Mainline in Android 10</a></li>
<li><a href="../de466213/index.html">4 Schritte zum Erstellen eines Kandidatenprofils</a></li>
<li><a href="../de466215/index.html">Modellorientiertes Design. Erstellung eines zuverlässigen Modells am Beispiel eines Luftfahrtwärmetauschers</a></li>
<li><a href="../de466223/index.html">Saubere Zersetzung</a></li>
<li><a href="../de466227/index.html">Knotenorientierte Programmierung</a></li>
<li><a href="../de466229/index.html">Wie man zehn Schachteln Watte kauft und keinen Fehler macht</a></li>
<li><a href="../de466231/index.html">ShIoTiny und die umliegende Welt: Anschließen von Sensoren an Binäreingänge, Kontaktsprung und andere Probleme</a></li>
<li><a href="../de466235/index.html">Munch in einem äquidistanten Scan und Meyerhold, der den Roten Platz zerstörte - Denis Semenov auf VR-Kunst</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>