<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèΩ üòÜ üóûÔ∏è Automatisieren mit Jenkins das Erstellen und Rollen von Artefakten von Metadatenmodellartefakten f√ºr Tabellen im Repository üö≠ üñêüèΩ üö§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alles begann mit der Tatsache, dass wir schnell und korrekt EDWEX-, JSON- und DDL-Strukturen bilden und diese dann auf verschiedenen Konturen relation...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisieren mit Jenkins das Erstellen und Rollen von Artefakten von Metadatenmodellartefakten f√ºr Tabellen im Repository</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/428101/">  Alles begann mit der Tatsache, dass wir schnell und korrekt EDWEX-, JSON- und DDL-Strukturen bilden und diese dann auf verschiedenen Konturen relationaler Datenbanken rollen mussten.  Mit Konturen meine ich Abk√ºrzungen, die jeder kennt - DEV, TST, UAT, PRD. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/169/a9a/387/169a9a387c429ecc2c76fa39abb3527f.jpg"><br><br>  Zu dieser Zeit haben wir fast alles manuell erledigt: Wir haben DDL generiert und edwex und json basierend auf Metadaten aus der Oracle-Datenbank gesammelt.  Es gibt viele Eingabeparameter.  Wenn Sie eine verpassen, werden Sie eine Entit√§t falsch bilden.  Und da der gesamte Bildungsprozess konsistent und kontinuierlich war, wird der Fehler erst ganz am Ende erkannt.  Lesen Sie unter dem Schnitt, wie wir alle Fehler automatisiert und √ºberwunden haben. <br><a name="habracut"></a><br><h2>  Ein bisschen √ºber Infrastruktur </h2><br>  Bevor wir die Daten in die Tabellen relationaler Datenbanken eintragen, m√ºssen wir sie aus der Quelle akzeptieren - in einem beliebigen Format, beispielsweise in Excel.  Daten von der Quelle, die den internen Mechanismus verwenden, werden nach Hadoop (Data Lake) transportiert.  In Hive ist das Hive-Add-On installiert. Mithilfe dieser Funktion k√∂nnen wir den Inhalt von Dateien mithilfe einer SQL-√§hnlichen Syntax anzeigen. <br><br>  Um die Daten in Data Lake in Form von Tabellen zu √ºbertragen, ben√∂tigen wir json's, die auf Basis von Metadaten gebildet werden.  Um Daten im Excel-Format zu analysieren, m√ºssen wir EDWEX-Dateien erstellen.  EDWEX-Dateien (EDW_EXTRACTOR) sind bestimmte Artefakte, die Tabellens√§tze mit dem Namen sowie Felds√§tze f√ºr jede dieser Tabellen enthalten, die auf der Grundlage von Metadaten erstellt werden.  Abh√§ngig von der Modellversion und der Quell-ID variieren die Felder.  Die Bildung von DDL ist erforderlich, um die Tabellen selbst in der Hive-Datenbank auf der Ebene der Betriebsdaten und in der Greenplum-Datenbank auf der Ebene der detaillierten und aggregierten Daten zu erstellen.  Das hei√üt, die Daten werden in erster Linie an Hive √ºbertragen, bei Bedarf gefiltert und an Greenplum √ºbertragen, um anschlie√üend Daten zu bearbeiten und darauf basierend Storefronts zu erstellen. <br><br><div class="spoiler">  <b class="spoiler_title">Beispiel f√ºr ein Edwex-Artefakt</b> <div class="spoiler_text">  pack - enth√§lt eine Reihe von Tabellen <br>  Daten - enth√§lt eine Reihe von Feldern <br><br>  pack.edwex: <br><br><pre><code class="sql hljs">1 Table_1 User Table_1 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 2 Table_2 User Table_2 curbid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 3 Table_3 User Table_3 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm')</code> </pre> <br><br>  data.edwex: <br><br><pre> <code class="sql hljs">1 1 CHARGE_ID NUMBER 38 0 1 2 SVC_ID NUMBER 38 0 1 3 VND_ID NUMBER 38 0 1 4 PRICE NUMBER 38 5 1 5 QUANTITY NUMBER 38 5 1 6 BASE NUMBER 38 5 1 7 TAX NUMBER 38 5 1 8 TOTAL NUMBER 38 5 1 9 TAX_RATE NUMBER 38 5 1 10 TAX_IN VARCHAR 1 1 11 CHARGE_KIND VARCHAR 3 1 12 PRIVILEGE_ID NUMBER 38 0 1 13 CHARGE_REF_ID NUMBER 38 0 1 14 EBID NUMBER 38 0 1 15 INVOICE_ID NUMBER 38 0 1 16 ZERO_STATE_ID NUMBER 38 0 1 17 USER_ID NUMBER 38 0 1 18 BID NUMBER 38 0 1 19 QUANTITY_REAL NUMBER 38 5 2 1 CURBID NUMBER 38 0 2 2 USER_ID NUMBER 38 0 2 3 VND_ID NUMBER 38 0 2 4 APPBID NUMBER 38 0 2 5 SVC_ID NUMBER 38 0 2 6 DEBT NUMBER 38 5 2 7 INSTDEBT NUMBER 38 5 3 1 INVOICE_ID NUMBER 38 0 3 2 INVOICE_DATE DATE 3 3 INVOICE_NUM VARCHAR 64 3 4 INVOICE_NUM_N NUMBER 38 5 3 5 BASE NUMBER 38 5 3 6 TAX NUMBER 38 5 3 7 TOTAL NUMBER 38 5 3 8 PREPAID VARCHAR 1 3 9 EXPLICIT VARCHAR 1 3 10 VND_ID NUMBER 38 0 3 11 ADV_PAYMENT_ID NUMBER 38 0 3 12 MDBID NUMBER 38 0 3 13 BID NUMBER 38 0 3 14 USER_ID NUMBER 38 0 3 15 ZERO_STATE_ID NUMBER 38 0 3 16 ACTIVE_SUM NUMBER 38 5 3 17 SPLIT_VND NUMBER 38 5 3 18 PRECREATED VARCHAR 1</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Beispiel f√ºr ein Json-Artefakt</b> <div class="spoiler_text"><pre> <code class="java hljs">Table.json: { <span class="hljs-string"><span class="hljs-string">"metadata"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"true"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"svc_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"vnd_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"price"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"6"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"base"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"8"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"total"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"9"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_rate"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_in"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"11"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_kind"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"12"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"privilege_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"13"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_ref_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"14"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ebid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"15"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"invoice_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"zero_state_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"17"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"18"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"bid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"19"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity_real"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> } ], <span class="hljs-string"><span class="hljs-string">"ctlPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"  ctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"errPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    "</span></span>, <span class="hljs-string"><span class="hljs-string">"inPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    hdfs"</span></span>, <span class="hljs-string"><span class="hljs-string">"outSchema"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"outTable"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"isPartitioned"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"sourceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"id  "</span></span> }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Beispiel DDL-Artefakte</b> <div class="spoiler_text">  Tabellenschema √§ndern.GP_000001_TABLE in Z_GP_000001_TABLE_20180807 umbenennen; <br>  Tabellenschema erstellen.GP_000001_TABLE <br>  ( <br><br>  `load_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `Preis` DEZIMAL (38,5), <br>  `Menge` DEZIMAL (38,5), <br>  `base` DECIMAL (38,5), <br>  `tax` DECIMAL (38.5), <br>  `total` DECIMAL (38,5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `load_kind` STRING, <br>  `privileg_id` DECIMAL (38.0), <br>  `load_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `rechnungs_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `quantity_real` DECIMAL (38.5), <br>  `load_dttm` TIMESTAMP, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  REIHENFORMAT BEGRENZTE FELDER BEENDET DURCH '\ t' <br>  GESPEICHERT ALS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  LAGE 'Weg zur Bildung in HDFS' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  in Schema einf√ºgen.GP_000001_TABLE (`Charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `Preis`, <br>  `Menge`, <br>  `base`, <br>  "Steuer", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `load_kind`, <br>  `privileg_id`, <br>  `load_ref_id`, <br>  "ebid", <br>  `rechnungs_ID`, <br>  `zero_state_id`, <br>  `user_id`, <br>  Gebot <br>  `quantity_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  W√§hlen Sie `load_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `Preis`, <br>  `Menge`, <br>  `base`, <br>  "Steuer", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `load_kind`, <br>  `privileg_id`, <br>  `load_ref_id`, <br>  "ebid", <br>  `rechnungs_ID`, <br>  `zero_state_id`, <br>  `user_id`, <br>  Gebot <br>  `quantity_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 aus Schema.Z_GP_000001_TABLE_20180807; <br><br>  Tabellenschema √§ndern.GP_000001_TABLE in Z_GP_000001_TABLE_20180807 umbenennen; <br>  Tabellenschema erstellen.GP_000001_TABLE <br>  ( <br><br>  `load_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `Preis` DEZIMAL (38,5), <br>  `Menge` DEZIMAL (38,5), <br>  `base` DECIMAL (38,5), <br>  `tax` DECIMAL (38.5), <br>  `total` DECIMAL (38,5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `load_kind` STRING, <br>  `privileg_id` DECIMAL (38.0), <br>  `load_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `rechnungs_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `quantity_real` DECIMAL (38.5), <br>  `load_dttm` TIMESTAMP, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  REIHENFORMAT BEGRENZTE FELDER BEENDET DURCH '\ t' <br>  GESPEICHERT ALS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  LAGE 'Weg zur Bildung in HDFS' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  in Schema einf√ºgen.GP_000001_CPA_CHARGE (`Charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `Preis`, <br>  `Menge`, <br>  `base`, <br>  "Steuer", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `load_kind`, <br>  `privileg_id`, <br>  `load_ref_id`, <br>  "ebid", <br>  `rechnungs_ID`, <br>  `zero_state_id`, <br>  `user_id`, <br>  Gebot <br>  `quantity_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  W√§hlen Sie `load_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `Preis`, <br>  `Menge`, <br>  `base`, <br>  "Steuer", <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `load_kind`, <br>  `privileg_id`, <br>  `load_ref_id`, <br>  "ebid", <br>  `rechnungs_ID`, <br>  `zero_state_id`, <br>  `user_id`, <br>  Gebot <br>  `quantity_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 aus Schema.Z_GP_000001_TABLE_20180807; <br></div></div><br><h2>  So automatisieren Sie </h2><br>  Um das Problem zu l√∂sen, haben wir verwendet: <br><br><ul><li>  Jenkins - als Orchester und Werkzeug zur Umsetzung des CI-Prozesses. <br></li><li>  Python - implementiert Funktionen und Unit-Tests. <br></li><li>  SQL - um auf die Metadatendatenbank zuzugreifen. <br></li><li>  Shell-Skript - zum Kopieren von Artefakten zwischen Verzeichnissen und zum Erstellen von Skripten in Multijob-Projekten, die auf dem Jenkins-Server ausgef√ºhrt werden. <br></li></ul><br>  Zun√§chst arbeiten wir mit einer gro√üen Anzahl von Quellen. Daher √ºbergeben wir die IDs der Quellen mithilfe des Shell-Skripts als Startparameter an SQL-Funktionen, um sie zu identifizieren.  Die resultierenden SQL-Funktionen werden anschlie√üend automatisch in der Metadatendatenbank ausgef√ºhrt.  Basierend auf den verf√ºgbaren Metadaten bilden diese Funktionen eine Datei mit einer Liste neuer SQL-Funktionen f√ºr jede der Quelltabellen, sodass wir sie anschlie√üend im ausf√ºhrbaren Programm aufrufen k√∂nnen.  Das Ergebnis der Ausf√ºhrung der generierten Funktionen ist die √úbertragung der DDL-, JSON- oder EDWEX-Werte auf den Ausgabeparameter. <br><br>  Hier verbindet sich Python mit allen ausf√ºhrbaren Funktionen und Unit-Tests.  Bevor eines der Module zum Rollen von Artefakten mithilfe von Komponententests gestartet wird, wird die korrekte Parameter√ºbertragung √ºberpr√ºft, um Python-Skripte auszuf√ºhren.  Tests √ºberpr√ºfen nicht nur die Richtigkeit der Eingabeparameter, sondern auch deren Vorhandensein im Metadatenmodul, die Gr√∂√üe der erstellten Dateien und das Datum ihrer Erstellung.  Tests √ºberwachen auch die Anzahl der neu erstellten Artefakte und die Anzahl der vorhandenen Artefakte.  Daher optimieren wir die Verwendung von Serverressourcen, da wir nur neue Dateien zum Rollen verwenden und vorhandene Modelle nicht erneut installieren. <br><br>  Und erst nach erfolgreichem Bestehen aller Pr√ºfungen wird ein Python-Programm ausgef√ºhrt, das die erforderlichen Artefakte erstellt und das Ergebnis in die erforderlichen Projektordner auf dem Server zerlegt.  Python leitet die generierten JSON-Dateien nicht nur in Verzeichnisse, sondern bildet auch Strukturen in Data Lake, damit die Daten korrekt geladen werden.  Beim Generieren von DDL-Artefakten werden diese nicht nur f√ºr eine sp√§tere Analyse und Wiederverwendung gespeichert, sondern k√∂nnen auch mithilfe neuer Modelle und Strukturen, die im Metadatenmodul angegeben sind, sofort in der Datenbank installiert werden.  Auf diese Weise k√∂nnen Sie in kurzer Zeit Hunderte von Tabellen ohne manuelle Arbeit erstellen. <br><br><h2>  Und wo ist Jenkins hier? </h2><br>  Jenkins tritt ein, wenn es notwendig ist, alle diese Prozesse visuell √ºber eine Schnittstelle zu verwalten. <br><br>  Dieses Tool wurde ausgew√§hlt, weil es: <br><br><ul><li>  deckt den Bedarf an Automatisierung der Montage und Installation vollst√§ndig ab <br></li><li>  Mit dieser Option k√∂nnen Sie einen Mechanismus zum Zusammensetzen von Artefakten mit der Implementierung des Selbsttestprozesses entwerfen <br></li><li>  Erm√∂glicht die einfache Verwaltung von Jobstarts und die √úberwachung der Ausf√ºhrung f√ºr eine Person, die weit von der Programmierung entfernt ist <br></li><li>  Mit dieser Option k√∂nnen Sie den Protokollierungsmechanismus so konfigurieren, dass das Ergebnis der Ausf√ºhrung f√ºr jede Person im Team verst√§ndlich ist.  Das Problem in der Baugruppe wird explizit angegeben oder der Vorgang wird erfolgreich abgeschlossen. <br></li></ul><br>  Um die Aufgaben zu l√∂sen, haben wir mehrere Multijob-Projekte erstellt.  Diese Art von Projekt wurde verwendet, da es mit einem einzigen Start parallel zu anderen Jobs arbeiten kann.  Jeder Job ist f√ºr die Implementierung seines Funktionsblocks verantwortlich.  Deshalb haben wir den sequentiellen Prozess des Erhaltens von Artefakten durch autonome parallele ersetzt.  Alles beginnt separat: die Bildung von EDWEX, JSON, DDL, die Bildung der Struktur in HIVE, die Installation von Tabellenstrukturen in der Datenbank.  Wir analysieren das Ergebnis in verschiedenen Stadien der Bildung von Artefakten und starten bei Erfolg weitere Aktionen. <br><br>  Der Jenkins-Teil wird ohne viele Tricks implementiert.  <b>String-</b> oder <b>Run-</b> Parameter werden an die Eingabe gesendet, um den Python-Code zu starten.  <b>Der</b> Parameter <b>String</b> ist ein Fenster zur Eingabe eines Werts vom Typ str vor dem Start.  <b>Der Ausf√ºhrungsparameter</b> kann im <b>laufenden Betrieb</b> zur Ausf√ºhrung an einen anderen Job √ºbertragen werden. Dazu reicht es aus, nur anzugeben, aus welchem ‚Äã‚ÄãProjekt die empfangene Variable √ºbernommen werden muss.  Au√üerdem wird ein Knoten als separater Parameter f√ºr die Ausf√ºhrung √ºbergeben.  Hier wird gerade die Aufteilung in Laufzeiten auf DEV, TST, UAT, PRD implementiert.  Ein separater Job wurde verwendet, um die empfangenen EDWEX-Dateien mit der Revisionsnummer an SVN zu √ºbertragen, um Versionen der ge√§nderten Strukturen verfolgen zu k√∂nnen. <br><br>  Eine Beispielschnittstelle in Jenkins: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00f/250/8c5/00f2508c5c04082a8b753041e471fe14.png"><br><br>  Das Ergebnis der Jobausf√ºhrung ist die Erstellung und Installation der erforderlichen Artefakte, deren √úbertragung an SVN und die Erstellung eines HTML-Berichts, der den Erfolg des Bestehens von Komponententests sowie die Ergebnisse der Zusammenstellung und Installation von Artefakten anzeigt.  Jobs k√∂nnen einzeln mit Ihren H√§nden oder im automatischen Modus ausgef√ºhrt werden, nachdem zuvor eine Ausf√ºhrungskette erstellt wurde. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/324/549/50f/32454950f7eb0476ca4cc753715c4472.png"><br>  <i>Architektur des Montage- und Installationsmechanismus</i> <br><br><h3>  Zusammenfassend </h3><br>  Es wurde viel Arbeit geleistet, um die Bildung von Artefakten zu automatisieren.  Zuvor mussten Sie manuell auf den Server klettern, Shell-Skripte ausf√ºhren und dann die Daten lange Zeit mit Ihren H√§nden studieren und bearbeiten.  Klicken Sie nun einfach auf die Schaltfl√§che Start, geben Sie die ID des Quellsystems, die Modellnummer und die Ausf√ºhrungsschleife an.  Mit Hilfe von Jenkins war es m√∂glich, den gesamten Montage- und Installationsmechanismus von Artefakten in unabh√§ngige Stufen zu strukturieren und zu zerlegen.  Die notwendigen √úberpr√ºfungen wurden hinzugef√ºgt, bevor mit der Bildung von Artefakten und deren Integration begonnen wurde.  Die empfangenen Artefakte werden automatisch an SVN √ºbertragen, was die Arbeit mit verwandten Teams von Systemanalysten und Datenmodellierern vereinfacht.  Es werden √úberpr√ºfungen durchgef√ºhrt, um Leerlaufstarts der Artefaktbildung zu vermeiden und deren Richtigkeit zu best√§tigen. <br><br>  Infolgedessen haben wir den zeitaufw√§ndigen Prozess des Zusammenstellens und Installierens von Modellartefakten von mehreren Stunden auf einige Minuten reduziert.  Und vor allem haben sie das Auftreten von Fehlern aufgrund des menschlichen Faktors beseitigt, die unweigerlich in einem komplexen Routineprozess auftraten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428101/">https://habr.com/ru/post/de428101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428089/index.html">"Testerkalender" f√ºr Oktober. Feedback: wie es passiert</a></li>
<li><a href="../de428091/index.html">Wie ein Praktikant das weltweit beliebteste Videospiel oder die Windows-Spielhistorie erstellt hat</a></li>
<li><a href="../de428095/index.html">Marktforschung f√ºr Webstudios und digitale Agenturen</a></li>
<li><a href="../de428097/index.html">Rekursives Routing in MikroTik √ºber von DHCP zugewiesene Gateways</a></li>
<li><a href="../de428099/index.html">Was haben gew√∂hnliche Kleider und die bevorstehende 5G-√Ñra gemeinsam?</a></li>
<li><a href="../de428103/index.html">Mitap in St. Petersburg: Data Engineering und mehr</a></li>
<li><a href="../de428105/index.html">Blogger empfiehlt: Einfluss auf das Marketing</a></li>
<li><a href="../de428107/index.html">Containerisierung von Angular 6 SPA-Vorlagen ASP .NET Core 2.1-Anwendungen</a></li>
<li><a href="../de428109/index.html">Unternehmenswand</a></li>
<li><a href="../de428111/index.html">Arithmetik beliebiger Genauigkeit in Erlang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>