<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¦ ğŸ’ ğŸŒƒ Apache Kafkaå’ŒSpark Streamingçš„æµå¼ä¼ è¾“ ğŸ’´ ğŸ‘¨ğŸ¼â€ğŸ”¬ ğŸ›¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå°†ä½¿ç”¨Apark Kafkaä½¿ç”¨Spark Streamingå¤„ç†æ¶ˆæ¯æµï¼Œå¹¶å°†å¤„ç†ç»“æœå†™å…¥AWS RDSäº‘æ•°æ®åº“ã€‚ 

 æƒ³è±¡ä¸€ä¸‹ï¼ŒæŸä¸ªä¿¡è´·æœºæ„å°†æˆ‘ä»¬çš„ä»»åŠ¡è®¾ç½®ä¸ºåœ¨å…¶æ‰€æœ‰åˆ†æ”¯æœºæ„ä¸­å³æ—¶å¤„ç†ä¼ å…¥äº¤æ˜“ã€‚ å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œä»¥ä¾¿å¿«é€Ÿè®¡ç®—å›½åº“çš„æœªå¹³ä»“è´§å¸å¤´å¯¸ï¼Œé™é¢æˆ–äº¤...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apache Kafkaå’ŒSpark Streamingçš„æµå¼ä¼ è¾“</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451160/"> å“ˆHaï¼ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå°†ä½¿ç”¨Apark Kafkaä½¿ç”¨Spark Streamingå¤„ç†æ¶ˆæ¯æµï¼Œå¹¶å°†å¤„ç†ç»“æœå†™å…¥AWS RDSäº‘æ•°æ®åº“ã€‚ <br><br> æƒ³è±¡ä¸€ä¸‹ï¼ŒæŸä¸ªä¿¡è´·æœºæ„å°†æˆ‘ä»¬çš„ä»»åŠ¡è®¾ç½®ä¸ºåœ¨å…¶æ‰€æœ‰åˆ†æ”¯æœºæ„ä¸­å³æ—¶å¤„ç†ä¼ å…¥äº¤æ˜“ã€‚ å¯ä»¥æ‰§è¡Œæ­¤æ“ä½œï¼Œä»¥ä¾¿å¿«é€Ÿè®¡ç®—å›½åº“çš„æœªå¹³ä»“è´§å¸å¤´å¯¸ï¼Œé™é¢æˆ–äº¤æ˜“çš„è´¢åŠ¡ç»“æœç­‰ã€‚ <br><br> å¦‚ä½•åœ¨ä¸ä½¿ç”¨é­”æœ¯å’Œé­”æœ¯çš„æƒ…å†µä¸‹å®æ–½æ­¤æ¡ˆä¾‹-æˆ‘ä»¬åœ¨åˆ èŠ‚ä¸‹é˜…è¯»ï¼ èµ°å§ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5w/sb/8v/5wsb8vvncrzhysct-pd6oqraqky.jpeg"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼ˆå›¾ç‰‡æ¥æºï¼‰</a> <br><a name="habracut"></a><br><h2> å¼•è¨€ </h2><br> å½“ç„¶ï¼Œå®æ—¶å¤„ç†å¤§å‹æ•°æ®é˜µåˆ—ä¸ºåœ¨ç°ä»£ç³»ç»Ÿä¸­ä½¿ç”¨æä¾›äº†å……è¶³çš„æœºä¼šã€‚ æœ€å—æ¬¢è¿çš„ç»„åˆä¹‹ä¸€æ˜¯Apache Kafkaå’ŒSpark Streamingä¸²è”ï¼Œå…¶ä¸­Kafkaåˆ›å»ºä¼ å…¥æ¶ˆæ¯åŒ…çš„æµï¼ŒSpark Streamingåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å¤„ç†è¿™äº›åŒ…ã€‚ <br><br> ä¸ºäº†æé«˜åº”ç”¨ç¨‹åºçš„å®¹é”™èƒ½åŠ›ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ£€æŸ¥ç‚¹-æ£€æŸ¥ç‚¹ã€‚ ä½¿ç”¨æ­¤æœºåˆ¶ï¼Œå½“Spark Streamingæ¨¡å—éœ€è¦æ¢å¤ä¸¢å¤±çš„æ•°æ®æ—¶ï¼Œå®ƒä»…éœ€è¦è¿”å›åˆ°æœ€åä¸€ä¸ªæ§åˆ¶ç‚¹å¹¶ä»è¯¥ç‚¹æ¢å¤è®¡ç®—ã€‚ <br><br><h2> æ­£åœ¨å¼€å‘çš„ç³»ç»Ÿæ¶æ„ </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/od/ef/zc/odefzciug8ckvim4-ei6pdg49tw.png"></div><br><br> ä½¿ç”¨çš„ç»„ä»¶ï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>Apache Kafka</b></a>æ˜¯å…·æœ‰å‘å¸ƒå’Œè®¢é˜…åŠŸèƒ½çš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿã€‚ é€‚ç”¨äºç¦»çº¿å’Œåœ¨çº¿æ¶ˆæ¯æ¶ˆè´¹ã€‚ ä¸ºäº†é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼ŒKafkaæ¶ˆæ¯å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œå¹¶åœ¨ç¾¤é›†å†…å¤åˆ¶ã€‚  Kafkaç³»ç»Ÿå»ºç«‹åœ¨ZooKeeperåŒæ­¥æœåŠ¡ä¹‹ä¸Šï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>Apache Spark Streaming-</b></a>ç”¨äºå¤„ç†æµæ•°æ®çš„Sparkç»„ä»¶ã€‚ å½“æ•°æ®æµè¢«è§£é‡Šä¸ºå°æ•°æ®åŒ…çš„è¿ç»­åºåˆ—æ—¶ï¼Œä½¿ç”¨å¾®æ‰¹å¤„ç†ä½“ç³»ç»“æ„æ„å»ºSpark Streamingæ¨¡å—ã€‚  Spark Streamingä»å„ç§æ¥æºæ¥æ”¶æ•°æ®ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆæˆå°æ•°æ®åŒ…ã€‚ å®šæœŸåˆ›å»ºæ–°è½¯ä»¶åŒ…ã€‚ åœ¨æ¯ä¸ªæ—¶é—´é—´éš”çš„å¼€å§‹ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åŒ…ï¼Œå¹¶ä¸”åœ¨æ­¤æ—¶é—´é—´éš”å†…æ¥æ”¶åˆ°çš„æ‰€æœ‰æ•°æ®éƒ½å°†åŒ…å«åœ¨è¯¥æ•°æ®åŒ…ä¸­ã€‚ åœ¨é—´éš”ç»“æŸæ—¶ï¼Œæ•°æ®åŒ…åœæ­¢å¢é•¿ã€‚ é—´éš”çš„å¤§å°ç”±ç§°ä¸ºæ‰¹å¤„ç†é—´éš”çš„å‚æ•°ç¡®å®šã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>Apache Spark SQL-</b></a>å°†å…³ç³»å¤„ç†ä¸SparkåŠŸèƒ½ç¼–ç¨‹ç»“åˆåœ¨ä¸€èµ·ã€‚ ç»“æ„åŒ–æ•°æ®æ˜¯æŒ‡å…·æœ‰æ¨¡å¼çš„æ•°æ®ï¼Œå³æ‰€æœ‰è®°å½•çš„ä¸€ç»„å­—æ®µã€‚  Spark SQLæ”¯æŒæ¥è‡ªå„ç§ç»“æ„åŒ–æ•°æ®æºçš„è¾“å…¥ï¼Œå¹¶ä¸”ç”±äºæä¾›äº†æ¶æ„ä¿¡æ¯ï¼Œå®ƒå¯ä»¥æœ‰æ•ˆåœ°ä»…æ£€ç´¢æ‰€éœ€çš„è®°å½•å­—æ®µï¼Œå¹¶æä¾›DataFrame APIï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><b>AWS RDS</b></a>æ˜¯ä¸€ç§ç›¸å¯¹ä¾¿å®œçš„åŸºäºäº‘çš„å…³ç³»æ•°æ®åº“ï¼Œä¸€ç§ç®€åŒ–äº†é…ç½®ï¼Œæ“ä½œå’Œæ‰©å±•çš„WebæœåŠ¡ï¼Œç”±Amazonç›´æ¥ç®¡ç†ã€‚ </li></ul><br><h2> å®‰è£…å¹¶å¯åŠ¨KafkaæœåŠ¡å™¨ </h2><br> åœ¨ç›´æ¥ä½¿ç”¨Kafkaä¹‹å‰ï¼Œæ‚¨éœ€è¦ç¡®ä¿Javaå¯ç”¨ï¼Œå› ä¸º  JVMç”¨äºå·¥ä½œï¼š <br><br><pre><code class="bash hljs">sudo apt-get update sudo apt-get install default-jre java -version</code> </pre> <br> åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ä»¥ä½¿ç”¨Kafkaï¼š <br><br><pre> <code class="bash hljs">sudo useradd kafka -m sudo passwd kafka sudo adduser kafka sudo</code> </pre><br> æ¥ä¸‹æ¥ï¼Œä»Apache Kafkaå®˜æ–¹ç½‘ç«™ä¸‹è½½å‘è¡Œç‰ˆï¼š <br><br><pre> <code class="bash hljs">wget -P /YOUR_PATH <span class="hljs-string"><span class="hljs-string">"http://apache-mirror.rbc.ru/pub/apache/kafka/2.2.0/kafka_2.12-2.2.0.tgz"</span></span></code> </pre> <br> è§£å‹ç¼©ä¸‹è½½çš„æ¡£æ¡ˆï¼š <br><pre> <code class="bash hljs">tar -xvzf /YOUR_PATH/kafka_2.12-2.2.0.tgz ln -s /YOUR_PATH/kafka_2.12-2.2.0 kafka</code> </pre><br> ä¸‹ä¸€æ­¥æ˜¯å¯é€‰çš„ã€‚ äº‹å®æ˜¯é»˜è®¤è®¾ç½®ä¸å…è®¸å®Œå…¨ä½¿ç”¨Apache Kafkaçš„æ‰€æœ‰åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼Œåˆ é™¤å¯ä»¥å‘å…¶å‘å¸ƒæ¶ˆæ¯çš„ä¸»é¢˜ï¼Œç±»åˆ«ï¼Œç»„ã€‚ è¦æ›´æ”¹æ­¤è®¾ç½®ï¼Œè¯·ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š <br><br><pre> <code class="bash hljs">vim ~/kafka/config/server.properties</code> </pre> <br> å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶æœ«å°¾ï¼š <br><br><pre> <code class="bash hljs">delete.topic.enable = <span class="hljs-literal"><span class="hljs-literal">true</span></span></code> </pre> <br> åœ¨å¯åŠ¨KafkaæœåŠ¡å™¨ä¹‹å‰ï¼Œæ‚¨éœ€è¦å¯åŠ¨ZooKeeperæœåŠ¡å™¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Kafkaå‘è¡Œç‰ˆéšé™„çš„è¾…åŠ©è„šæœ¬ï¼š <br><br><pre> <code class="bash hljs">Cd ~/kafka bin/zookeeper-server-start.sh config/zookeeper.properties</code> </pre><br>  ZooKeeperæˆåŠŸå¯åŠ¨åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬å¯åŠ¨KafkaæœåŠ¡å™¨ï¼š <br><br><pre> <code class="bash hljs">bin/kafka-server-start.sh config/server.properties</code> </pre> <br> åˆ›å»ºä¸€ä¸ªåä¸ºTransactionçš„æ–°ä¸»é¢˜ï¼š <br><br><pre> <code class="bash hljs">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 3 --topic transaction</code> </pre> <br> ç¡®ä¿å·²åˆ›å»ºå…·æœ‰æ­£ç¡®æ•°é‡çš„åˆ†åŒºå’Œå¤åˆ¶çš„ä¸»é¢˜ï¼š <br><br><pre> <code class="bash hljs">bin/kafka-topics.sh --describe --zookeeper localhost:2181</code> </pre> <br><img src="https://habrastorage.org/webt/s5/gh/bu/s5ghbuswhb0dcc0pmlvu_uloes4.png"><br><br> æˆ‘ä»¬å°†é”™è¿‡ä¸ºæ–°åˆ›å»ºçš„ä¸»é¢˜æµ‹è¯•ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„æ—¶é—´ã€‚ æœ‰å…³å¦‚ä½•æµ‹è¯•å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…å®˜æ–¹æ–‡æ¡£- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‘é€ä¸€äº›æ¶ˆæ¯</a> ã€‚ å¥½å§ï¼Œæˆ‘ä»¬ç»§ç»­ä½¿ç”¨KafkaProducer APIç”¨Pythonç¼–å†™ç”Ÿäº§å™¨ã€‚ <br><br><h2> åˆ¶ç‰‡äººå†™ä½œ </h2><br> ç”Ÿäº§è€…å°†ç”Ÿæˆéšæœºæ•°æ®-æ¯ç§’100æ¡æ¶ˆæ¯ã€‚ éšæœºæ•°æ®æ˜¯æŒ‡ç”±ä¸‰ä¸ªå­—æ®µç»„æˆçš„å­—å…¸ï¼š <br><br><ul><li>  <b>åˆ†æ”¯æœºæ„</b> -ä¿¡è´·æœºæ„çš„é”€å”®ç‚¹åç§°ï¼› </li><li>  <b>è´§å¸</b> -äº¤æ˜“è´§å¸ï¼› </li><li>  <b>é‡‘é¢</b> -äº¤æ˜“é‡‘é¢ã€‚ å¦‚æœè¯¥é‡‘é¢æ˜¯é“¶è¡Œè´­ä¹°çš„è´§å¸ï¼Œåˆ™é‡‘é¢å°†ä¸ºæ­£æ•°ï¼›å¦‚æœæ˜¯é”€å”®ï¼Œåˆ™é‡‘é¢å°†ä¸ºè´Ÿæ•°ã€‚ </li></ul><br> ç”Ÿäº§è€…çš„ä»£ç å¦‚ä¸‹ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy.random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> choice, randint <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_random_value</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> new_dict = {} branch_list = [<span class="hljs-string"><span class="hljs-string">'Kazan'</span></span>, <span class="hljs-string"><span class="hljs-string">'SPB'</span></span>, <span class="hljs-string"><span class="hljs-string">'Novosibirsk'</span></span>, <span class="hljs-string"><span class="hljs-string">'Surgut'</span></span>] currency_list = [<span class="hljs-string"><span class="hljs-string">'RUB'</span></span>, <span class="hljs-string"><span class="hljs-string">'USD'</span></span>, <span class="hljs-string"><span class="hljs-string">'EUR'</span></span>, <span class="hljs-string"><span class="hljs-string">'GBP'</span></span>] new_dict[<span class="hljs-string"><span class="hljs-string">'branch'</span></span>] = choice(branch_list) new_dict[<span class="hljs-string"><span class="hljs-string">'currency'</span></span>] = choice(currency_list) new_dict[<span class="hljs-string"><span class="hljs-string">'amount'</span></span>] = randint(<span class="hljs-number"><span class="hljs-number">-100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new_dict</code> </pre><br> æ¥ä¸‹æ¥ï¼Œä½¿ç”¨sendæ–¹æ³•ï¼Œä»¥æ‰€éœ€çš„ä¸»é¢˜ï¼Œä»¥JSONæ ¼å¼å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kafka <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KafkaProducer producer = KafkaProducer(bootstrap_servers=[<span class="hljs-string"><span class="hljs-string">'localhost:9092'</span></span>], value_serializer=<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x:dumps(x).encode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>), compression_type=<span class="hljs-string"><span class="hljs-string">'gzip'</span></span>) my_topic = <span class="hljs-string"><span class="hljs-string">'transaction'</span></span> data = get_random_value() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: future = producer.send(topic = my_topic, value = data) record_metadata = future.get(timeout=<span class="hljs-number"><span class="hljs-number">10</span></span>) print(<span class="hljs-string"><span class="hljs-string">'--&gt; The message has been sent to a topic: \ {}, partition: {}, offset: {}'</span></span> \ .format(record_metadata.topic, record_metadata.partition, record_metadata.offset )) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(<span class="hljs-string"><span class="hljs-string">'--&gt; It seems an Error occurred: {}'</span></span>.format(e)) <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>: producer.flush()</code> </pre><br> è¿è¡Œè„šæœ¬æ—¶ï¼Œæˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­æ”¶åˆ°ä»¥ä¸‹æ¶ˆæ¯ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_e/3g/zj/_e3gzjrmsycjb8ntjmur6ztaspw.png"></div><br> è¿™æ„å‘³ç€ä¸€åˆ‡éƒ½å¯ä»¥æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼å·¥ä½œ-ç”Ÿäº§è€…ç”Ÿæˆå¹¶å‘é€æ¶ˆæ¯åˆ°æˆ‘ä»¬éœ€è¦çš„ä¸»é¢˜ã€‚ <br><br> ä¸‹ä¸€æ­¥æ˜¯å®‰è£…Sparkå¹¶å¤„ç†æ­¤æ¶ˆæ¯æµã€‚ <br><br><h2> å®‰è£…Apache Spark </h2><br>  <b>Apache Spark</b>æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½çš„é«˜æ€§èƒ½é›†ç¾¤è®¡ç®—å¹³å°ã€‚ <br><br> åœ¨æ€§èƒ½æ–¹é¢ï¼ŒSparkè¶…è¶Šäº†MapReduceæ¨¡å‹çš„æµè¡Œå®ç°ï¼ŒåŒæ—¶ä¸ºæ›´å¹¿æ³›çš„è®¡ç®—ç±»å‹æä¾›äº†æ”¯æŒï¼ŒåŒ…æ‹¬äº¤äº’å¼æŸ¥è¯¢å’Œæµå¤„ç†ã€‚ é€Ÿåº¦åœ¨å¤„ç†å¤§é‡æ•°æ®ä¸­èµ·ç€é‡è¦ä½œç”¨ï¼Œå› ä¸ºé€Ÿåº¦ä½¿æ‚¨æ— éœ€èŠ±è´¹å‡ åˆ†é’Ÿæˆ–å‡ ä¸ªå°æ—¶å°±å¯ä»¥è¿›è¡Œäº¤äº’å¼å·¥ä½œã€‚  Sparkå¦‚æ­¤é«˜é€Ÿçš„æœ€å¤§ä¼˜åŠ¿ä¹‹ä¸€å°±æ˜¯å…¶æ‰§è¡Œå†…å­˜ä¸­è®¡ç®—çš„èƒ½åŠ›ã€‚ <br><br> è¯¥æ¡†æ¶æ˜¯ç”¨Scalaç¼–å†™çš„ï¼Œå› æ­¤å¿…é¡»é¦–å…ˆå®‰è£…å®ƒï¼š <br><br><pre> <code class="bash hljs">sudo apt-get install scala</code> </pre> <br> ä»å®˜æ–¹ç½‘ç«™ä¸‹è½½Sparkå‘è¡Œç‰ˆï¼š <br><br><pre> <code class="bash hljs">wget <span class="hljs-string"><span class="hljs-string">"http://mirror.linux-ia64.org/apache/spark/spark-2.4.2/spark-2.4.2-bin-hadoop2.7.tgz"</span></span></code> </pre> <br> è§£å‹ç¼©æ¡£æ¡ˆï¼š <br><br><pre> <code class="bash hljs">sudo tar xvf spark-2.4.2/spark-2.4.2-bin-hadoop2.7.tgz -C /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/spark</code> </pre> <br> åœ¨bashæ–‡ä»¶ä¸­æ·»åŠ Sparkçš„è·¯å¾„ï¼š <br><br><pre> <code class="bash hljs">vim ~/.bashrc</code> </pre> <br> é€šè¿‡ç¼–è¾‘å™¨æ·»åŠ ä»¥ä¸‹è¡Œï¼š <br><br><pre> <code class="bash hljs">SPARK_HOME=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/spark <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=<span class="hljs-variable"><span class="hljs-variable">$SPARK_HOME</span></span>/bin:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre><br> å¯¹bashrcè¿›è¡Œæ›´æ”¹åï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bashrc</code> </pre> <br><h2>  AWS PostgreSQLéƒ¨ç½² </h2><br> å‰©ä¸‹çš„å·¥ä½œå°±æ˜¯éƒ¨ç½²æ•°æ®åº“ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†ä»æµä¸­ä¸Šä¼ å·²å¤„ç†çš„ä¿¡æ¯ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨AWS RDSæœåŠ¡ã€‚ <br><br> è½¬åˆ°æ§åˆ¶å°AWS-&gt; AWS RDS-&gt;æ•°æ®åº“-&gt;åˆ›å»ºæ•°æ®åº“ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/os/m7/dgosm7dwnh3fr-uksjdt_xpltsk.png"></div><br> é€‰æ‹©PostgreSQLï¼Œç„¶åå•å‡»ä¸‹ä¸€æ­¥æŒ‰é’®ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3y/d_/8r/3yd_8rsz2swfgaxaafpkyizthac.png"></div><br> å› ä¸º æœ¬ç¤ºä¾‹ä»…å‡ºäºæ•™è‚²ç›®çš„è€Œç†è§£ï¼Œæˆ‘ä»¬å°†â€œè‡³å°‘â€ä½¿ç”¨å…è´¹æœåŠ¡å™¨ï¼ˆFree Tierï¼‰ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fn/6p/5b/fn6p5bjyitndy_ozs2cdcw_ssi0.png"></div><br> æ¥ä¸‹æ¥ï¼Œåœ¨Free Tierå—ä¸­æ‰“å‹¾ï¼Œç„¶åå°†è‡ªåŠ¨ä¸ºæˆ‘ä»¬æä¾›t2.microç±»çš„å®ä¾‹-å°½ç®¡å¾ˆå¼±ï¼Œä½†å®ƒæ˜¯å…è´¹çš„ï¼Œéå¸¸é€‚åˆæˆ‘ä»¬çš„ä»»åŠ¡ï¼š <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mj/jh/wg/mjjhwg3cknoehrq8wyxk3uw5v74.png"></div><br> æ¥ä¸‹æ¥æ˜¯éå¸¸é‡è¦çš„äº‹æƒ…ï¼šæ•°æ®åº“å®ä¾‹çš„åç§°ï¼Œä¸»ç”¨æˆ·çš„åç§°åŠå…¶å¯†ç ã€‚ è®©æˆ‘ä»¬å‘½åå®ä¾‹ï¼šmyHabrTestï¼Œä¸»ç”¨æˆ·ï¼š <b>habr</b> ï¼Œå¯†ç ï¼š <b>habr12345</b> ï¼Œç„¶åå•å‡»ä¸‹ä¸€æ­¥æŒ‰é’®ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lg/jt/mf/lgjtmfdfst0pvqthojb_bdpeohc.png"></div><br><br> ä¸‹ä¸€é¡µåŒ…å«ä»å¤–éƒ¨è´Ÿè´£æˆ‘ä»¬çš„æ•°æ®åº“æœåŠ¡å™¨å¯ç”¨æ€§ï¼ˆå…¬å…±å¯è®¿é—®æ€§ï¼‰å’Œç«¯å£å¯ç”¨æ€§çš„å‚æ•°ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/40/z9/q7/40z9q7owar5kpnimyzrdj5laqgs.png"></div><br> è®©æˆ‘ä»¬ä¸ºVPCå®‰å…¨ç»„åˆ›å»ºä¸€ä¸ªæ–°é…ç½®ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿä»å¤–éƒ¨é€šè¿‡ç«¯å£5432ï¼ˆPostgreSQLï¼‰è®¿é—®æˆ‘ä»¬çš„æ•°æ®åº“æœåŠ¡å™¨ã€‚ <br><br> åœ¨å•ç‹¬çš„æµè§ˆå™¨çª—å£ä¸­ï¼Œè½¬åˆ°VPCä»ªè¡¨æ¿-&gt;å®‰å…¨ç»„-&gt;åˆ›å»ºå®‰å…¨ç»„éƒ¨åˆ†ä¸­çš„AWSæ§åˆ¶å°ï¼š <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fl/2i/ne/fl2inejlgnghwsh3itdrlcywdsu.png"></div><br> è®¾ç½®å®‰å…¨ç»„çš„åç§°-PostgreSQLï¼Œä¸€ä¸ªæè¿°ï¼ŒæŒ‡ç¤ºè¯¥ç»„åº”ä¸å“ªä¸ªVPCå…³è”ï¼Œç„¶åå•å‡»åˆ›å»ºæŒ‰é’®ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/js/8r/tv/js8rtvp8tudwjtpgso6xota5h-g.png"></div><br> å¡«å†™ç«¯å£5432çš„æ–°åˆ›å»ºçš„å…¥ç«™è§„åˆ™ç»„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ æ‚¨ä¸å¿…æŒ‡å®šæ‰‹åŠ¨ç«¯å£ï¼Œè€Œæ˜¯ä»â€œç±»å‹â€ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©PostgreSQLã€‚ <br><br> ä¸¥æ ¼æ¥è¯´ï¼Œå€¼:: / 0è¡¨ç¤ºæ¥è‡ªä¸–ç•Œå„åœ°çš„æœåŠ¡å™¨çš„ä¼ å…¥æµé‡çš„å¯ç”¨æ€§ï¼Œè¿™å¹¶ä¸å®Œå…¨æ­£ç¡®ï¼Œä½†æ˜¯ä¸ºäº†åˆ†æç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ge/8j/bn/ge8jbntssnooajc8so36h0tjo80.png"></div><br> è¿”å›æµè§ˆå™¨é¡µé¢ï¼Œæ‰“å¼€â€œé…ç½®é«˜çº§è®¾ç½®â€ï¼Œç„¶ååœ¨â€œ VPCå®‰å…¨ç»„-&gt;é€‰æ‹©ç°æœ‰VPCå®‰å…¨ç»„-&gt; PostgreSQLâ€éƒ¨åˆ†ä¸­è¿›è¡Œé€‰æ‹©ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nk/ae/-s/nkae-ste1tp3wgvmyilicvwlk8e.png"></div><br> æ¥ä¸‹æ¥ï¼Œåœ¨æ•°æ®åº“é€‰é¡¹-&gt;æ•°æ®åº“åç§°-&gt;éƒ¨åˆ†ä¸­ï¼Œè®¾ç½®åç§°<b>-habrDB</b> ã€‚ <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œé™¤äº†ç¦ç”¨å¤‡ä»½ï¼ˆå¤‡ä»½ä¿ç•™æœŸ-0å¤©ï¼‰ï¼Œç›‘è§†å’ŒPerformance Insightså¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™å…¶ä½™å‚æ•°ã€‚ å•å‡»<b>åˆ›å»ºæ•°æ®åº“</b>æŒ‰é’®ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ex/1p/po/ex1ppogq_vdsk3nnvywm7l8vq8i.png"></div><br><h2> æµå¤„ç†ç¨‹åº </h2><br> æœ€åä¸€æ­¥å°†æ˜¯Spark-jobsçš„å¼€å‘ï¼Œå®ƒå°†æ¯ä¸¤ç§’é’Ÿå¤„ç†ä¸€æ¬¡ä»Kafkaæ”¶åˆ°çš„æ–°æ•°æ®ï¼Œå¹¶å°†ç»“æœè¾“å…¥æ•°æ®åº“ã€‚ <br><br> å¦‚ä¸Šæ‰€è¿°ï¼Œæ£€æŸ¥ç‚¹æ˜¯SparkStreamingä¸­çš„ä¸»è¦æœºåˆ¶ï¼Œå¿…é¡»å¯¹å…¶è¿›è¡Œé…ç½®ä»¥æä¾›å®¹é”™èƒ½åŠ›ã€‚ æˆ‘ä»¬å°†ä½¿ç”¨æ§åˆ¶ç‚¹ï¼Œå¹¶ä¸”åœ¨è¿‡ç¨‹ä¸¢å¤±çš„æƒ…å†µä¸‹ï¼ŒSpark Streamingæ¨¡å—å°†ä»…éœ€è¦è¿”å›åˆ°æœ€åä¸€ä¸ªæ§åˆ¶ç‚¹å¹¶ä»è¯¥æ§åˆ¶ç‚¹æ¢å¤è®¡ç®—ä»¥æ¢å¤ä¸¢å¤±çš„æ•°æ®ã€‚ <br><br> æ‚¨å¯ä»¥é€šè¿‡åœ¨å®¹é”™ï¼Œå¯é çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆä¾‹å¦‚HDFSï¼ŒS3ç­‰ï¼‰ä¸­è®¾ç½®ç›®å½•æ¥å¯ç”¨æ£€æŸ¥ç‚¹ï¼Œåœ¨è¯¥æ–‡ä»¶ç³»ç»Ÿä¸­å°†ä¿å­˜æ£€æŸ¥ç‚¹ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹æ–¹æ³•å®Œæˆæ­¤æ“ä½œï¼š <br><br><pre> <code class="python hljs">streamingContext.checkpoint(checkpointDirectory)</code> </pre> <br> åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼Œå³ï¼Œå¦‚æœå­˜åœ¨checkpointDirectoryï¼Œåˆ™å°†ä»æ§åˆ¶ç‚¹æ•°æ®é‡æ–°åˆ›å»ºä¸Šä¸‹æ–‡ã€‚ å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼ˆå³é¦–æ¬¡æ‰§è¡Œï¼‰ï¼Œåˆ™è°ƒç”¨functionToCreateContextå‡½æ•°ä»¥åˆ›å»ºæ–°ä¸Šä¸‹æ–‡å¹¶é…ç½®DStreamsï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.streaming <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StreamingContext context = StreamingContext.getOrCreate(checkpointDirectory, functionToCreateContext)</code> </pre><br> ä½¿ç”¨KafkaUtilsåº“çš„createDirectStreamæ–¹æ³•åˆ›å»ºä¸€ä¸ªDirectStreamå¯¹è±¡ä»¥è¿æ¥åˆ°â€œäº‹åŠ¡â€ä¸»é¢˜ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyspark.streaming.kafka <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KafkaUtils sc = SparkContext(conf=conf) ssc = StreamingContext(sc, <span class="hljs-number"><span class="hljs-number">2</span></span>) broker_list = <span class="hljs-string"><span class="hljs-string">'localhost:9092'</span></span> topic = <span class="hljs-string"><span class="hljs-string">'transaction'</span></span> directKafkaStream = KafkaUtils.createDirectStream(ssc, [topic], {<span class="hljs-string"><span class="hljs-string">"metadata.broker.list"</span></span>: broker_list})</code> </pre><br> è§£æJSONæ ¼å¼çš„ä¼ å…¥æ•°æ®ï¼š <br><br><pre> <code class="python hljs">rowRdd = rdd.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> w: Row(branch=w[<span class="hljs-string"><span class="hljs-string">'branch'</span></span>], currency=w[<span class="hljs-string"><span class="hljs-string">'currency'</span></span>], amount=w[<span class="hljs-string"><span class="hljs-string">'amount'</span></span>])) testDataFrame = spark.createDataFrame(rowRdd) testDataFrame.createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"treasury_stream"</span></span>)</code> </pre><br> ä½¿ç”¨Spark SQLï¼Œæˆ‘ä»¬è¿›è¡Œäº†ç®€å•çš„åˆ†ç»„å¹¶å°†ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ï¼š <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> from_unixtime(<span class="hljs-keyword"><span class="hljs-keyword">unix_timestamp</span></span>()) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> curr_time, t.branch <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> branch_name, t.currency <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> currency_code, <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(amount) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> batch_value <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> treasury_stream t <span class="hljs-keyword"><span class="hljs-keyword">group</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> t.branch, t.currency</code> </pre><br> è·å–æŸ¥è¯¢æ–‡æœ¬å¹¶é€šè¿‡Spark SQLè¿è¡Œå®ƒï¼š <br><br><pre> <code class="python hljs">sql_query = get_sql_query() testResultDataFrame = spark.sql(sql_query) testResultDataFrame.show(n=<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre><br> ç„¶åï¼Œæˆ‘ä»¬å°†æ¥æ”¶åˆ°çš„èšåˆæ•°æ®ä¿å­˜åˆ°AWS RDSä¸­çš„è¡¨ä¸­ã€‚ è¦å°†èšåˆç»“æœä¿å­˜åˆ°æ•°æ®åº“è¡¨ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨DataFrameå¯¹è±¡çš„writeæ–¹æ³•ï¼š <br><br><pre> <code class="python hljs">testResultDataFrame.write \ .format(<span class="hljs-string"><span class="hljs-string">"jdbc"</span></span>) \ .mode(<span class="hljs-string"><span class="hljs-string">"append"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"driver"</span></span>, <span class="hljs-string"><span class="hljs-string">'org.postgresql.Driver'</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"url"</span></span>,<span class="hljs-string"><span class="hljs-string">"jdbc:postgresql://myhabrtest.ciny8bykwxeg.us-east-1.rds.amazonaws.com:5432/habrDB"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"dbtable"</span></span>, <span class="hljs-string"><span class="hljs-string">"transaction_flow"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"user"</span></span>, <span class="hljs-string"><span class="hljs-string">"habr"</span></span>) \ .option(<span class="hljs-string"><span class="hljs-string">"password"</span></span>, <span class="hljs-string"><span class="hljs-string">"habr12345"</span></span>) \ .save()</code> </pre><br><blockquote> å…³äºå»ºç«‹ä¸AWS RDSçš„è¿æ¥çš„å‡ å¥è¯ã€‚ æˆ‘ä»¬åœ¨â€œéƒ¨ç½²AWS PostgreSQLâ€æ­¥éª¤ä¸­ä¸ºå…¶åˆ›å»ºäº†ç”¨æˆ·å’Œå¯†ç ã€‚ å¯¹äºæ•°æ®åº“æœåŠ¡å™¨URLï¼Œè¯·ä½¿ç”¨â€œç«¯ç‚¹â€ï¼Œè¯¥ç«¯ç‚¹æ˜¾ç¤ºåœ¨â€œè¿æ¥æ€§å’Œå®‰å…¨æ€§â€éƒ¨åˆ†ä¸­ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9n/sj/jd/9nsjjdun0hdy5qtwqub0xhvzunk.png"></div></blockquote><br> ä¸ºäº†æ­£ç¡®è¿æ¥Sparkå’ŒKafkaï¼Œæ‚¨åº”è¯¥ä½¿ç”¨<b>spark-streaming-kafka-0-8_2.11å·¥ä»¶</b>é€šè¿‡smark-submitè¿è¡Œä½œä¸šã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å°†å·¥ä»¶ä¸PostgreSQLæ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œæˆ‘ä»¬å°†é€šè¿‡--packagesè¿›è¡Œä¼ è¾“ã€‚ <br><br> ä¸ºäº†æé«˜è„šæœ¬çš„çµæ´»æ€§ï¼Œæˆ‘ä»¬è¿˜æå–äº†æ¶ˆæ¯æœåŠ¡å™¨çš„åç§°ä»¥åŠè¦ä»ä¸­æ¥æ”¶æ•°æ®ä½œä¸ºè¾“å…¥å‚æ•°çš„ä¸»é¢˜ã€‚ <br><br> å› æ­¤ï¼Œè¯¥å¯åŠ¨å¹¶æµ‹è¯•ç³»ç»Ÿäº†ï¼š <br><br><pre> <code class="bash hljs">spark-submit \ --packages org.apache.spark:spark-streaming-kafka-0-8_2.11:2.0.2,\ org.postgresql:postgresql:9.4.1207 \ spark_job.py localhost:9092 transaction</code> </pre><br> ä¸€åˆ‡é¡ºåˆ©ï¼ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨åº”ç”¨ç¨‹åºå·¥ä½œæœŸé—´ï¼Œæ¯2ç§’æ˜¾ç¤ºä¸€æ¬¡æ–°çš„èšåˆç»“æœï¼Œå› ä¸ºåœ¨åˆ›å»ºStreamingContextå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å°†æ‰¹å¤„ç†é—´éš”è®¾ç½®ä¸º2ç§’ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/q1/25/cfq125zpzkyldktsuvdo175fazy.png"></div><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹æ•°æ®åº“è¿›è¡Œç®€å•æŸ¥è¯¢ï¼Œä»¥æ£€æŸ¥<b>transaction_flow</b>è¡¨ä¸­çš„è®°å½•ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7j/j9/qm/7jj9qmf4zpter3jkbblrmiqni2s.png"></div><br><h2> ç»“è®º </h2><br> æœ¬æ–‡ç ”ç©¶äº†ä½¿ç”¨Spark Streamingä»¥åŠApache Kafkaå’ŒPostgreSQLè¿›è¡Œæµä¿¡æ¯å¤„ç†çš„ç¤ºä¾‹ã€‚ éšç€æ¥è‡ªå„ç§æ¥æºçš„æ•°æ®çš„å¢é•¿ï¼Œå¾ˆéš¾é«˜ä¼°Spark Streamingå¯¹äºåˆ›å»ºæµåº”ç”¨ç¨‹åºå’Œå®æ—¶è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„å®ç”¨ä»·å€¼ã€‚ <br><br> æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHubçš„</a>æˆ‘çš„å­˜å‚¨åº“ä¸­æ‰¾åˆ°å®Œæ•´çš„æºä»£ç ã€‚ <br><br> æˆ‘å‡†å¤‡æ„‰å¿«åœ°è®¨è®ºæœ¬æ–‡ï¼ŒæœŸå¾…æ‚¨çš„è¯„è®ºï¼Œä¹Ÿå¸Œæœ›å¯¹æ‰€æœ‰ç›¸å…³è¯»è€…æå‡ºå»ºè®¾æ€§çš„æ‰¹è¯„ã€‚ <br><br> ç¥ä½ æˆåŠŸï¼ <br><br>  <b>PS</b>æœ€åˆè®¡åˆ’ä½¿ç”¨æœ¬åœ°PostgreSQLæ•°æ®åº“ï¼Œä½†æ˜¯ç”±äºæˆ‘å¯¹AWSçš„çƒ­çˆ±ï¼Œæˆ‘å†³å®šå°†æ•°æ®åº“æ”¾åœ¨äº‘ä¸­ã€‚ åœ¨å…³äºè¯¥ä¸»é¢˜çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨AWS Kinesiså’ŒAWS EMRåœ¨AWSä¸­å®ç°ä¸Šè¿°æ•´ä¸ªç³»ç»Ÿã€‚ å…³æ³¨æ–°é—»ï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451160/">https://habr.com/ru/post/zh-CN451160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451148/index.html">å›¾å½¢è¯­è¨€ä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹</a></li>
<li><a href="../zh-CN451150/index.html">å¦‚æœå¯ä»¥çš„è¯ï¼Œèµ¶ä¸Šæˆ‘ã€‚ ç®¡ç†å‘˜ç‰ˆæœ¬</a></li>
<li><a href="../zh-CN451152/index.html">é—¨ç”µè·¯ä¸­çš„ç”µé˜»æˆ–æ­£ç¡®çš„æ–¹æ³•</a></li>
<li><a href="../zh-CN451154/index.html">æœ¬åœ°è‡ªæ²»æ•°æ®é‡‡é›†ç³»ç»Ÿï¼ˆç»­ï¼‰</a></li>
<li><a href="../zh-CN451158/index.html">ç”µè·¯ã€‚ ç”µè·¯ç±»å‹</a></li>
<li><a href="../zh-CN451162/index.html">çº é”™-å›½é™…å•ä½åˆ¶ï¼ˆSIï¼‰å½“å‰å’Œæ–°ç‰ˆæœ¬ä¸­çš„ç‰©ç†å¸¸æ•°</a></li>
<li><a href="../zh-CN451164/index.html">ä½¿ç”¨Pythonå¯»æ‰¾å…è´¹çš„åœè½¦ä½</a></li>
<li><a href="../zh-CN451166/index.html">ç”¨äºAIå’ŒMOç³»ç»Ÿçš„æ–°å­˜å‚¨åº“å°†æä¾›ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN451170/index.html">æ°å¤«Â·è´ä½æ–¯ï¼ˆJeff Bezosï¼‰å®£å¸ƒäº†å¾æœæœˆçƒçš„è®¡åˆ’</a></li>
<li><a href="../zh-CN451172/index.html">æœ±è‰å¨…ï¼šåŠŸèƒ½å’Œç»“æ„å³åŠŸèƒ½</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>