<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñáÔ∏è üåÅ üîõ 5. Punto de control al m√°ximo. IPS Parte 1 üõ≥Ô∏è üí´ üïù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuando con nuestra serie de tutoriales de Check Point. Esta vez discutiremos uno de mis temas favoritos, a saber, IPS (Sistema de prevenci√≥n de i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>5. Punto de control al m√°ximo. IPS Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/415083/"><img src="https://habrastorage.org/webt/3a/dd/2t/3add2tmx4aj28yvsjr2yjkuokq8.png"><br><br>  Continuando con nuestra serie de tutoriales de Check Point.  Esta vez discutiremos uno de mis temas favoritos, a saber, <b>IPS (Sistema de prevenci√≥n de intrusiones)</b> en ruso: un sistema de prevenci√≥n de intrusiones.  ¬°Adem√°s, el √©nfasis est√° en la prevenci√≥n (es decir, la prevenci√≥n)!  Uno de los credos principales de Check Point es: " <i>¬°Prevenimos, no detectamos!</i>  "  Personalmente, estoy de acuerdo con esta posici√≥n.  ¬øDe qu√© sirve la detecci√≥n si fue atacado por un encriptador, por ejemplo?  Una computadora encriptada le dir√° que hubo un ataque.  En las realidades actuales es necesario cuidar Prevent.  Y IPS aqu√≠ puede ayudar muy bien. <br><br>  Sin embargo, recientemente ha habido un descuido de esta clase de protecci√≥n, diciendo que " <i>IPS ya no es relevante y no tiene sentido usarlo</i> ".  En mi opini√≥n, esta opini√≥n es un error imperdonable.  En realidad, en esta lecci√≥n intentar√© describir los principales conceptos err√≥neos existentes sobre IPS.  Luego, como parte del laboratorio, le mostrar√© c√≥mo IPS ayuda a fortalecer la seguridad de su red.  Y, por supuesto, intentar√© decirle c√≥mo aprovechar al m√°ximo esta √∫til herramienta, qu√© configuraciones debe buscar y qu√© necesita recordar, incluido IPS. <br><br>  La lecci√≥n result√≥ ser muy larga, as√≠ que la divid√≠ en dos partes.  La primera parte ser√° puramente te√≥rica, y la segunda ya est√° totalmente dedicada a la pr√°ctica en forma de trabajo de laboratorio.  Espero que sea interesante. <br><br>  <i>Spoiler: al final del art√≠culo, una lecci√≥n en video si es m√°s conveniente para alguien mirar en lugar de leer.</i> <a name="habracut"></a><br><br><h3>  Una breve historia de IPS </h3><br><img src="https://habrastorage.org/webt/vy/kf/ra/vykfraotwx8zq1mrshjrlgzkp5i.png"><br><br>  Me gustar√≠a comenzar con algunas caracter√≠sticas hist√≥ricas.  De hecho, IPS es un caso especial de <b>IDS</b> ( <b>Sistema de detecci√≥n de intrusiones</b> - <b>Sistema de detecci√≥n de intrusiones</b> o SOV, como se llama brevemente en Rusia). <br><br>  La idea de crear un IDS surgi√≥ despu√©s de la publicaci√≥n del art√≠culo " <b>Monitoreo y vigilancia de amenazas de seguridad inform√°tica</b> " por James Anderson, ¬°ya en <b>1980</b> !  Un art√≠culo bastante entretenido y lo m√°s importante para este d√≠a. <br><br>  Despu√©s de 6 a√±os, en <b>1986</b> , Dorothy Denning y Peter Neumann publicaron el primer <b>modelo te√≥rico de IDS</b> , que probablemente sigue siendo la base de los sistemas modernos.  Luego hubo bastantes desarrollos diferentes, pero todos ellos b√°sicamente se redujeron al uso de tres m√©todos de detecci√≥n de intrusos: <br><br><ul><li>  An√°lisis de firma </li><li>  An√°lisis heur√≠stico; </li><li>  Detecci√≥n de anomal√≠as. </li></ul><br>  Quiz√°s uno de los momentos clave en el desarrollo de IDS fue la aparici√≥n de la biblioteca <b>libpcap</b> en <b>1998</b> .  Desarrollado por sus muchachos del Laboratorio Nacional.  Lawrence en Berkeley.  En el mismo a√±o, el sniffer de paquetes <b>APE</b> se desarroll√≥ utilizando el paquete libpcap.  Un mes despu√©s, APE pas√≥ a llamarse el conocido <b>Snort</b> .  El autor de Snort es <b>Martin R√∂sch</b> . <br><br>  <b>Sourcefire</b> se fund√≥ m√°s tarde (en 2001) y el proyecto Snort continu√≥ su r√°pido desarrollo como parte de Sourcefire y se convirti√≥ pr√°cticamente en el est√°ndar entre las soluciones IDS.  Snort es de c√≥digo abierto, que es utilizado por la mayor√≠a de los fabricantes modernos de soluciones de seguridad de la informaci√≥n (especialmente las empresas nacionales). <br><br>  En <b>2003</b> , Gartner se√±al√≥ la ineficiencia de IDS y la necesidad de cambiar a sistemas IPS (es decir, cambiar el detector para evitar).  Despu√©s de eso, los desarrolladores de IDS comenzaron a equipar sus soluciones con el modo IPS.  Snort puede funcionar naturalmente tanto en IDS como en modo IPS (es decir, para prevenir). <br><br>  Por supuesto, tambi√©n vale la pena se√±alar el r√°pido crecimiento de otro proyecto de c√≥digo abierto: <b>Suricata</b> .  Este proyecto fue fundado por inmigrantes de Snort.  La primera versi√≥n beta fue en <b>2009</b> .  El responsable del desarrollo es la Open Information Security Foundation (OISF).  Por el momento, Suricata es una soluci√≥n muy popular (aunque todav√≠a es inferior a Snort en popularidad).  De hecho, a menudo se usan juntos. <br><br>  En <b>2013</b> , Sourcefire fue adquirido por <b>Cisco</b> .  Al mismo tiempo, Snort contin√∫a siendo un proyecto de c√≥digo abierto, y su versi√≥n comercial se vende bajo la marca Cisco FirePower.  Con su permiso, no hablaremos sobre las diferencias entre las versiones gratuitas y propietarias.  Un punto interesante  En 2005, Check Point intent√≥ comprar SourceFire por $ 225 millones, pero el gobierno de los Estados Unidos no aprob√≥ este acuerdo.  Y como dije antes, Cisco compr√≥ SourceFire en 2013 por hasta $ 2.7 mil millones.  Buen aumento de precios durante 8 a√±os) m√°s de 12 veces. <br><br>  Naturalmente, enumer√© solo una peque√±a parte de las soluciones.  Al mismo tiempo, se desarroll√≥ una gran cantidad de soluciones comerciales propietarias (Check Point es una de ellas).  La mayor√≠a de las veces, IPS era parte de una soluci√≥n UTM o NGFW, con menos frecuencia como una pieza de hardware independiente (Cisco IPS es un excelente ejemplo). <br><br><h3>  IPS en redes corporativas </h3><br>  Ahora, si toca el historial de distribuci√≥n de soluciones IPS en redes corporativas, obtendr√° la siguiente imagen: <br><br><img src="https://habrastorage.org/webt/pq/nm/oy/pqnmoyki-iid8w9dszbgygm5iuw.png"><br><br>  A principios de la d√©cada de 2000, las empresas se mostraron muy esc√©pticas ante esta nueva clase de soluciones de seguridad.  La mayor√≠a de la gente pensaba que IPS era algo ex√≥tico que realmente no era necesario. <br>  Despu√©s de 2005, la mayor√≠a se dio cuenta de los beneficios y la necesidad de IPS.  El auge de las implementaciones en todo el mundo ha comenzado. <br><br>  Para 2010, IPS se hab√≠a convertido en la herramienta est√°ndar esencial de facto para proteger la red corporativa. <br><br>  M√°s cerca de 2015, el mercado de IPS se ha enfriado relativamente.  IPS era est√°ndar en casi todas las soluciones UTM / NGFW.  Todos cambiaron a SIEM, protecci√≥n contra ataques dirigidos, sandboxes, honpots, etc.  Al mismo tiempo, olvidando por completo la importancia de IPS.  Pero discutiremos esto un poco m√°s. <br><br>  Ahora que tenemos un poco de conocimiento actualizado sobre la historia de IPS, me gustar√≠a discutir un punto m√°s.  A saber, clases de IPS.  En una aproximaci√≥n aproximada, todas las soluciones IPS se pueden dividir en dos clases: <br><br><ul><li>  <b>NIPS</b> funciona a nivel de red, es decir  escanea el tr√°fico que pasa / transita. </li><li>  <b>HIPS</b> funciona a nivel de computadora del usuario, es decir  con el tr√°fico que est√° destinado directamente a esta computadora, bueno, o bien el host mismo genera. </li></ul><br>  Hoy discutiremos exactamente la primera opci√≥n. <br><br><h3>  Dos opciones para usar NIPS </h3><br>  Veamos el uso arquitect√≥nico de IPS.  Aqu√≠, tambi√©n, todo es bastante simple, hay dos opciones para usar IPS de red: <br><br><img src="https://habrastorage.org/webt/el/sj/qk/elsjqkumb2qvw_dqycyrc2o1k5y.png"><br><br><ol><li>  <b>Modo en l√≠nea</b> .  En ruso, lo llamamos "en la brecha".  Es decir  El tr√°fico de red real pasa por IPS.  IPS en este caso funciona como un puente normal (es decir, en el segundo nivel del modelo OSI).  Este modo es el m√°s √≥ptimo en t√©rminos de protecci√≥n.  En caso de un ataque, IPS puede bloquear inmediatamente la sesi√≥n y la computadora del atacante.  Por supuesto, hay aspectos negativos en forma de respuestas falsas positivas, bueno, es decir  falsos positivos cuando IPS bloquea el tr√°fico normal.  Pero este es un tema separado, lo discutiremos un poco m√°s adelante. </li><li>  <b>Modo promiscuo</b> .  Nuevamente, en ruso: modo de monitoreo.  Como regla, en este modo, IPS se "cuelga" en el puerto SPAN, que "refleja" el dispositivo ¬°COPIAR!  tr√°fico  En esta opci√≥n, IPS se convierte autom√°ticamente en IDS, ya que  ya no funciona con tr√°fico real y no tiene forma de bloquear ataques r√°pidamente.  Es decir  Esta es una mala opci√≥n cuando se requiere la m√°xima seguridad. </li></ol><br>  No consideraremos en detalle las caracter√≠sticas de la aplicaci√≥n de un r√©gimen particular.  Este es un tema bastante amplio que va m√°s all√° del alcance de nuestra lecci√≥n.  Centr√©monos mejor en el modo en l√≠nea, ya que  Es √©l quien en la mayor√≠a de los casos se utiliza en Check Point. <br><br><h3>  IPS en dispositivos UTM.  Flujo de paquetes </h3><br><img src="https://habrastorage.org/webt/n2/ae/bd/n2aebdexigphzibvuqhvrqjmopq.png"><br><br>  Desde el punto de vista del procesamiento del tr√°fico, el firewall primero verifica los paquetes y, si las listas de acceso correspondientes lo permiten, solo entonces el IPS se enciende y comienza a verificar el tr√°fico que pasa.  En realidad, este algoritmo de procesamiento de tr√°fico revela la diferencia conceptual entre el Firewall y el Sistema de prevenci√≥n de intrusiones. <br><br>  ‚ÄúEl <i>cortafuegos busca evitar el paso de un tr√°fico.</i>  <i>IPS funciona con tr√°fico ya pasado</i> ". <br><br>  Esto es l√≥gico no solo en t√©rminos de seguridad, sino tambi√©n en t√©rminos de rendimiento.  ¬øPor qu√© investigar el tr√°fico que un cortafuegos puede eliminar r√°pidamente con costos m√≠nimos de recursos?  Esta es la cuesti√≥n de si poner IPS frente al firewall.  Definitivamente no!  Solo imagine cu√°nto tr√°fico "restante" se transmitir√° a √©l desde diferentes bots que escanean todo en Internet. <br><br>  Bueno, ah√≠ es donde terminamos nuestra digresi√≥n l√≠rica prolongada.  Pasemos a los conceptos err√≥neos t√≠picos de IPS.  Intentar√© desacreditarlos usando Check Point como ejemplo. <br><br><h3>  Conceptos err√≥neos t√≠picos de IPS </h3><br><h4>  1. IPS solo protege contra ataques de capa de red </h4><br>  Quiz√°s este es el mito m√°s com√∫n.  Hist√≥ricamente, por supuesto, IPS principalmente protegido contra ataques de red, como escaneos de puertos, fuerza bruta, algunos tipos de ddos ‚Äã‚Äãy, por supuesto, la lucha contra las anomal√≠as.  Sin embargo!  ¬°Muchos todav√≠a no saben que IPS puede verificar los archivos descargados!  Y si el archivo contiene exploit, IPS bloquear√° su descarga m√°s r√°pido que Anti-Virus, porque  IPS funciona en un flujo de tr√°fico y Anti-Virus se ve obligado a esperar hasta que se descargue todo el archivo en el b√∫fer.  Es decir  IPS comprueba archivos como pdf, doc, xls y mucho m√°s.  Definitivamente lo mostrar√© en el laboratorio.  Por lo tanto, el IPS incluido aumentar√° significativamente la protecci√≥n de sus usuarios que descargan varios archivos de Internet.  ¬°No descuides este nivel adicional de protecci√≥n! <br><br><h4>  2. IPS ya no es relevante y no protege contra nada </h4><br>  Otro mito popular.  Por supuesto, recientemente los hackers profesionales han estado tratando de no usar herramientas de ataque cl√°sicas, como escaneo de puertos, fuerza bruta, etc.  Y todo porque tales ataques se notan de inmediato y generan una gran cantidad de alertas en las defensas cl√°sicas.  Sin embargo!  Esto ocurre solo en ataques muy complejos y espec√≠ficos, cuando un verdadero profesional se ocupa del asunto.  El 99% de todos los ataques exitosos son bots automatizados que escanean la red en busca de vulnerabilidades conocidas, que luego explotan.  ¬°IPS lo ve todo!  Adem√°s, recordando nuevamente wannacry, despu√©s de descubrir esta vulnerabilidad, Check Point emiti√≥ una firma IPS en solo un par de d√≠as.  Microsoft lanz√≥ el parche mucho m√°s tarde (en un par de semanas, por lo que recuerdo).  El IPS incluido con las firmas actuales refleja perfectamente los ataques autom√°ticos que a√∫n prevalecen (y es poco probable que algo cambie en el futuro cercano). <br><br><h4>  3. IPS no necesita ser actualizado con frecuencia </h4><br>  En realidad, en el p√°rrafo anterior, dije que el IPS incluido con las firmas ACTUALES proporciona protecci√≥n contra ataques autom√°ticos.  Por alguna raz√≥n, muchos creen que solo las bases de datos antivirus deben actualizarse regularmente, mientras se olvidan por completo de IPS.  Pero las firmas para IPS aparecen o se actualizan literalmente todos los d√≠as.  Por ejemplo, puede usar el recurso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Check Point</a> .  Como puede ver, solo en los √∫ltimos d√≠as se han lanzado varias firmas nuevas.  O se actualizaron los creados anteriormente. <br>  IPS con bases de datos actualizadas es muy importante.  Como dije antes, las firmas IPS salen m√°s r√°pido que los parches de los proveedores.  Si tiene firmas antiguas, entonces su IPS simplemente est√° reduciendo el tr√°fico y desperdiciando recursos del sistema.  Y no les creas a los fabricantes nacionales de OWL, quienes dicen que actualizar una vez al mes es normal (como regla general, establecen ese per√≠odo y probablemente se deba al hecho de que usan bases de datos Snort, que se actualizan con un retraso de 30 d√≠as para la versi√≥n gratuita) . <br><br><h4>  4. IPS reduce significativamente el rendimiento del dispositivo </h4><br>  ¬øQu√© puedo decir sobre este mito?  Si y no  Por supuesto, la inclusi√≥n de IPS aumenta la carga tanto en el procesador como en la RAM.  Pero no todo es tan dram√°tico como se cree com√∫nmente.  Un gran aumento en la carga cuando se activa IPS generalmente se manifiesta en dos casos: <br><br><ol><li>  Usted (o usted) seleccion√≥ incorrectamente la soluci√≥n.  Ya sea en l√≠nea de hardware o soluci√≥n virtual.  Esta es la pregunta de que todo debe ser probado antes de comprar.  Nuevamente, mucho depende de qui√©n seleccione la soluci√≥n.  Presta especial atenci√≥n a esto.  Utilice con cuidado las hojas de datos en los dispositivos.  Indica necesariamente el ancho de banda del dispositivo cuando IPS est√° habilitado.  Bueno, una vez m√°s, Check Point tiene una herramienta de dimensionamiento que proporciona recomendaciones muy realistas para un modelo adecuado.  ¬°Aseg√∫rese de usar el tama√±o!  Si no tiene acceso a esta herramienta, pregunte a sus socios. </li><li>  La segunda raz√≥n m√°s com√∫n para aumentar la carga debido a IPS es que se incluyen demasiadas firmas.  Este es uno de los extremos del uso de IPS cuando absolutamente todas las firmas disponibles est√°n habilitadas, debido al hecho de que inicialmente no est√° claro cu√°les son necesarias.  Este error muy grave conduce a un dispositivo de arranque simplemente salvaje y muchos falsos positivos.  Habi√©ndose encontrado con esto, muchos administradores deciden deshabilitar IPS, porque  con ella, la puerta de enlace simplemente se "dobla".  Como ser  Bueno, primero debes determinar qu√© es exactamente lo que vas a proteger.  Es l√≥gico suponer que si tiene un servidor de correo basado en Linux en su DMZ, entonces probablemente no deber√≠a incluir firmas para este segmento relacionadas con Microsoft, MacOS, Android, Wordpress, etc.  Creo que el significado general es claro.  <b>Trillar el tr√°fico con todas las firmas indiscriminadamente es muy costoso</b> .  Para que IPS pueda utilizar los recursos de manera eficiente, debe habilitar solo las firmas necesarias y desactivar las innecesarias.  Eso suena facil.  Pero la implementaci√≥n parece muy complicada.  A partir de aqu√≠ crece el siguiente mito. </li></ol><br><h4>  5. IPS es dif√≠cil de configurar </h4><br>  Esta es en parte la opini√≥n justa que ha tenido lugar.  De hecho, muchas soluciones IPS siguen siendo muy dif√≠ciles de aprender.  Pero esto no se trata de Chess Point.  Vamos en orden.  ¬øC√≥mo se ve una firma por lo general?  Esto suele ser algo como: <br><br>  <i>IGSS SCADA ListAll Function Desbordamiento de b√∫fer</i> <i><br></i>  <i>WebGate Multiple Products WESPMonitor Stack Buffer Desbordamiento</i> <br><br>  Y trate de averiguar qu√© tipo de firma es, para qu√© sirve, cu√°nto la activar√° la puerta de enlace, ¬øqu√© tan cr√≠tica es?  Afortunadamente, Check Point tiene una descripci√≥n detallada de cada firma.  La descripci√≥n es visible directamente en SmartConsole y no tiene que buscar en Google cada nombre.  Adem√°s, por conveniencia, Check Point ha asignado varias etiquetas a cada firma: <br><br><ul><li>  <b>Gravedad</b> (es decir, el nivel de peligro que puede cerrar esta firma); </li><li>  <b>Nivel de confianza</b> (el nivel de confiabilidad de la firma, es decir, cu√°l es la probabilidad de la adecuaci√≥n del funcionamiento de esta firma. Esta es una caracter√≠stica muy importante, especialmente para el an√°lisis de comportamiento) </li><li>  <b>Impacto en el rendimiento</b> (esta etiqueta muestra cu√°nto cargar√° el dispositivo una firma fuertemente habilitada) </li><li>  <b>Proveedor</b> : puede filtrar las firmas por proveedor (por ejemplo, vulnerabilidades asociadas con todos los productos de Adobe o Microsoft) </li><li>  <b>Producto</b> : es posible filtrar por producto (por ejemplo, Microsoft Office o WordPress). </li></ul><br>  Las etiquetas Proveedor y Producto a veces se cruzan, porque  Con bastante frecuencia, una empresa tiene un solo producto. <br><br>  Con estas etiquetas, puede generar r√°pidamente una lista de firmas que desea incluir.  Y para esto no es necesario tener siete tramos en la frente.  Bueno, por supuesto, antes de eso necesita hacer una peque√±a auditor√≠a de la red y comprender qu√© software usan sus empleados. <br>  Discutiremos el trabajo con estas etiquetas con m√°s detalle en el laboratorio. <br><br><h4>  6. Trabajar con IPS es un trabajo tedioso y rutinario. </h4><br>  He dicho muchas veces que la seguridad de la informaci√≥n no es un resultado, sino un proceso continuo.  No puede configurar el sistema una vez y olvidarse de √©l.  Necesita refinamiento continuo y sistem√°tico.  Lo mismo ocurre con IPS.  Y aqu√≠ generalmente surgen dificultades.  Casi cualquier sistema IPS m√°s o menos adecuado genera una gran cantidad de registros.  Suelen verse as√≠: <br><br><img src="https://habrastorage.org/webt/ou/9n/it/ou9nitvretgmdziruunlzteqkbs.png"><br><br>  Ahora imagine que estos registros han acumulado varios miles en una semana.  ¬øC√≥mo los analizas?  ¬øC√≥mo entender qu√© eventos ocurren con mayor frecuencia?  ¬øQu√© firmas podr√≠an necesitar desactivarse o qu√© hosts podr√≠an bloquearse en el nivel de firewall? <br><br>  Por supuesto, los registros del punto de control se ven m√°s atractivos y claros: <br><br><img src="https://habrastorage.org/webt/l6/jy/8e/l6jy8ehf8ehy6oerims44-wr_ac.png"><br><br>  Aqu√≠ puede ver la <b>gravedad</b> y el <b>impacto en el rendimiento</b> y el <b>nivel de confianza</b> .  Sin embargo, esto no resuelve el problema de analizar una cantidad tan grande de eventos.  Como regla general, los sistemas SIEM que est√°n dise√±ados para agregar, correlacionar y realizar un an√°lisis inicial de eventos se recuerdan aqu√≠.  Afortunadamente, Check Point tiene un sistema SIEM incorporado: <b>Smart Event</b> .  Esta hoja le permite ver registros de IPS en forma procesada y agregada: <br><br><img src="https://habrastorage.org/webt/eg/is/up/egisupog0fn_qord5qc7z7urad8.png"><br><br>  Como saben, esto ya es mucho m√°s f√°cil de trabajar.  El principal valor de SIEM es que este sistema le permite "ver" su seguridad en t√©rminos cuantitativos.  En cualquier trabajo, necesita ver el resultado y aqu√≠ es mucho m√°s f√°cil concentrarse en los n√∫meros.  En nuestro ejemplo, vemos que hay un n√∫mero bastante grande de registros con la <b>gravedad del nivel cr√≠tico</b> .  Es con ellos que necesitas comenzar a trabajar.  Adem√°s, vemos que la mayor cantidad de eventos est√°n relacionados con la firma <b>GNU Bash Remote Code Execution</b> .  El an√°lisis debe comenzar con estos eventos.  Habiendo ca√≠do a√∫n m√°s, podemos determinar: <br><br><ul><li>  ¬øQu√© hosts est√°n atacando? </li><li>  ¬øQu√© host est√° atacando? </li><li>  ¬øDe qu√© pa√≠s viene el ataque? </li></ul><br>  Puede resultar que la firma se active por el tr√°fico generado por nuestro nodo interno.  Esta es una ocasi√≥n para el juicio.  O est√° realmente infectado o es un falso positivo.  A continuaci√≥n, tratamos al host o desactivamos esta firma espec√≠ficamente para este host. <br><br>  Si el ataque proviene de una red externa, tal vez todos estos registros sean creados por un solo nodo atacante (lo m√°s probable es que sea alg√∫n tipo de bot), y de alg√∫n Singapur.  En este caso, podemos agregar este host (o toda la red de Singapur) a la lista de bloqueo para que est√© bloqueado en el nivel del firewall y no llegue al procesamiento del tr√°fico IPS. <br><br>  Tambi√©n podemos notar que la firma captura ataques para distribuciones de Linux, mientras que el host de Windows puede ser atacado.  En este caso, tambi√©n ser√≠a l√≥gico deshabilitar las firmas de Linux espec√≠ficamente para este host. <br><br>  Como puede ver, el proceso se asemeja a cierta investigaci√≥n.  Despu√©s de tal optimizaci√≥n constante, la carga en la puerta de enlace disminuir√° significativamente, porque: <br><br><ol><li>  Parte de los hosts atacantes se bloquear√°n en el nivel del firewall; </li><li>  Las firmas innecesarias que consumen recursos ser√°n deshabilitadas. </li></ol><br>  Al mismo tiempo, SmartEvent le permite ver inmediatamente el resultado en forma de un n√∫mero decreciente de registros.  Esta es solo esa caracter√≠stica cuantitativa que muestra la efectividad de nuestro trabajo realizado.  Idealmente, deber√≠amos deshacernos del llamado "ruido" y ver solo eventos IPS realmente importantes (es decir, ataques reales) en los registros. <br><br>  Adem√°s, ¬°todo el proceso de investigar y agregar hosts a la lista de bloqueo puede automatizarse!  R80.10 introdujo una API completa que le permite integrarse con soluciones de terceros.  Ya escrib√≠ un art√≠culo en el centro sobre la API en s√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Check Point R80.10 API.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gesti√≥n a trav√©s de CLI, scripts y m√°s.</a> <br>  Adem√°s, mi colega Gleb Ryaskin public√≥ instrucciones detalladas sobre la integraci√≥n de Check Point y Splunk - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Check Point API + Splunk.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Automatizaci√≥n de la protecci√≥n contra ataques a la red</a> . <br><br>  No solo hay una parte te√≥rica, sino tambi√©n pr√°ctica, con un ejemplo de ataque y la adici√≥n autom√°tica de un host a la lista de bloqueo.  No seas perezoso, mira. <br><br>  Sobre esto propongo terminar nuestra parte te√≥rica.  En la pr√≥xima lecci√≥n, nos espera mucho trabajo de laboratorio. <br><br><h3>  Parte te√≥rica en formato de video tutorial </h3><br><iframe width="560" height="315" src="https://www.youtube.com/embed/T05pm2J7Mbc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Si est√° interesado en otros materiales en Check Point, aqu√≠ encontrar√° una gran selecci√≥n ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Check Point. Una selecci√≥n de materiales √∫tiles de TS Solution</a> ).  Tambi√©n puede suscribirse a nuestros canales ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">YouTube</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">VK</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Telegram</a> ) para no perderse nuevos art√≠culos, cursos y seminarios. <br><br>  Puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">encontrar</a> m√°s informaci√≥n sobre los modelos de interruptor Extreme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede realizar una auditor√≠a gratuita de la configuraci√≥n de seguridad de Check Point </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠.</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415083/">https://habr.com/ru/post/es415083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415069/index.html">Otra b√∫squeda de un sue√±o. RTS + eyetracker manos de estudiantes</a></li>
<li><a href="../es415071/index.html">El objetivo es m√°s importante que el c√≥digo</a></li>
<li><a href="../es415073/index.html">C√≥mo la sala de producci√≥n cambi√≥ a la energ√≠a libre del sol</a></li>
<li><a href="../es415075/index.html">La tercera versi√≥n de reCAPTCHA funciona en segundo plano sin ser notada por los usuarios.</a></li>
<li><a href="../es415079/index.html">Una m√©trica para gobernarlos a todos: ¬øhay una √∫nica m√©trica universal?</a></li>
<li><a href="../es415085/index.html">¬øQu√© es CISSP, c√≥mo obtenerlo, no perderlo y por qu√© no es necesario?</a></li>
<li><a href="../es415087/index.html">[CASO] Impresi√≥n 3D SLA en una f√°brica de electr√≥nica de barcos</a></li>
<li><a href="../es415091/index.html">Rust 1.27 Lanzamiento</a></li>
<li><a href="../es415093/index.html">PVP: por qu√© inyectar pegamento por v√≠a intravenosa</a></li>
<li><a href="../es415153/index.html">Los requisitos ideales est√°n volviendo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>