<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òòÔ∏è ü§õüèΩ üßëüèæ Analyse de sentiment de prototype avec Python et TextBlob üë©üèø‚Äçü§ù‚Äçüë©üèº ‚õ©Ô∏è üíï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Qu'est-ce qui est important pour une √©quipe de d√©veloppement qui commence tout juste √† construire un syst√®me d'apprentissage automatique? Architecture...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analyse de sentiment de prototype avec Python et TextBlob</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457168/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/8l/ir/g2/8lirg2klkrmofom9vhhcgldh-qo.jpeg" alt="image"></div><br>  Qu'est-ce qui est important pour une √©quipe de d√©veloppement qui commence tout juste √† construire un syst√®me d'apprentissage automatique?  Architecture, composants, capacit√©s de test utilisant l'int√©gration et les tests unitaires, r√©alisez un prototype et obtenez les premiers r√©sultats.  Et suite √† l'√©valuation de l'apport de main-d'≈ìuvre, la planification de l'√©laboration et de la mise en ≈ìuvre. <br><br>  Cet article se concentrera sur le prototype.  Qui a √©t√© cr√©√© quelque temps apr√®s avoir parl√© avec le chef de produit: pourquoi ne pas ¬´toucher¬ª au Machine Learning?  En particulier, la PNL et l'analyse des sentiments? <br><a name="habracut"></a><br>  "Pourquoi pas?"  Ai-je r√©pondu.  Pourtant, je fais du d√©veloppement backend depuis plus de 15 ans, j'aime travailler avec les donn√©es et r√©soudre les probl√®mes de performances.  Mais je devais encore d√©couvrir ¬´√† quelle profondeur le terrier du lapin¬ª. <br><br><h2>  S√©lectionnez les composants </h2><br>  Afin de d√©crire en quelque sorte l'ensemble des composants qui impl√©mentent la logique de notre noyau ML, regardons un exemple simple de la mise en ≈ìuvre de l'analyse des sentiments, l'un des nombreux disponibles sur GitHub. <br><br><div class="spoiler">  <b class="spoiler_title">Un exemple d'analyse des sentiments en Python</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> nltk <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( datasets, model_selection, feature_extraction, linear_model ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extract_features</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(corpus)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">'''Extract TF-IDF features from corpus'''</span></span> <span class="hljs-comment"><span class="hljs-comment"># vectorize means we turn non-numerical data into an array of numbers count_vectorizer = feature_extraction.text.CountVectorizer( lowercase=True, # for demonstration, True by default tokenizer=nltk.word_tokenize, # use the NLTK tokenizer stop_words='english', # remove stop words min_df=1 # minimum document frequency, ie the word must appear more than once. ) processed_corpus = count_vectorizer.fit_transform(corpus) processed_corpus = feature_extraction.text.TfidfTransformer().fit_transform( processed_corpus) return processed_corpus data_directory = 'movie_reviews' movie_sentiment_data = datasets.load_files(data_directory, shuffle=True) print('{} files loaded.'.format(len(movie_sentiment_data.data))) print('They contain the following classes: {}.'.format( movie_sentiment_data.target_names)) movie_tfidf = extract_features(movie_sentiment_data.data) X_train, X_test, y_train, y_test = model_selection.train_test_split( movie_tfidf, movie_sentiment_data.target, test_size=0.30, random_state=42) # similar to nltk.NaiveBayesClassifier.train() model = linear_model.LogisticRegression() model.fit(X_train, y_train) print('Model performance: {}'.format(model.score(X_test, y_test))) y_pred = model.predict(X_test) for i in range(5): print('Review:\n{review}\n-\nCorrect label: {correct}; Predicted: {predict}'.format( review=X_test[i], correct=y_test[i], predict=y_pred[i] ))</span></span></code> </pre> <br></div></div><br>  L'analyse de tels exemples est un d√©fi distinct pour le d√©veloppeur. <br>  Seulement 45 lignes de code et 4 (quatre, Karl!) Blocs logiques √† la fois: <br><br><ol><li>  T√©l√©chargement des donn√©es pour la formation du mod√®le (lignes 25-26) </li><li>  Pr√©paration des donn√©es t√©l√©charg√©es - extraction d'entit√©s (lignes 31 √† 34) </li><li>  Cr√©ation et formation d'un mod√®le (lignes 36-39) </li><li>  Test d'un mod√®le form√© et sortie des r√©sultats (lignes 41-45) </li></ol><br>  Chacun de ces points m√©rite un article distinct.  Et cela n√©cessite certainement une inscription dans un module s√©par√©.  Au moins pour les besoins des tests unitaires. <br><br>  S√©par√©ment, il convient de souligner les √©l√©ments de la pr√©paration des donn√©es et de la formation des mod√®les. <br>  Dans chacune des fa√ßons de rendre le mod√®le plus pr√©cis, des centaines d'heures de travail scientifique et d'ing√©nierie sont investies. <br><br>  Heureusement, afin de d√©marrer rapidement avec la PNL, il existe une solution toute faite - les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">biblioth√®ques</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NLTK</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TextBlob</a> .  Le second est un wrapper sur NLTK qui fait la corv√©e - fait l'extraction des fonctionnalit√©s de l'ensemble de formation, puis forme le mod√®le √† la premi√®re demande de classification. <br><br>  Mais avant de former le mod√®le, vous devez pr√©parer des donn√©es pour celui-ci. <br><br><h2>  Pr√©paration des donn√©es </h2><br><h3>  T√©l√©charger les donn√©es </h3><br>  Si nous parlons du prototype, le chargement des donn√©es √† partir d'un fichier CSV / TSV est √©l√©mentaire.  Vous appelez simplement la fonction <b>read_csv</b> depuis la biblioth√®que pandas: <br><br><pre> <code class="plaintext hljs">import pandas as pd data = pd.read_csv(data_path, delimiter)</code> </pre><br>  Mais ce ne seront pas des donn√©es pr√™tes √† l'emploi dans le mod√®le. <br><br>  Tout d'abord, si nous ignorons un peu le format csv, il est facile de s'attendre √† ce que chaque source fournisse des donn√©es avec ses propres caract√©ristiques, et donc nous avons besoin d'une sorte de pr√©paration des donn√©es d√©pendante de la source.  M√™me pour le cas le plus simple d'un fichier CSV, pour simplement l'analyser, nous devons conna√Ætre le d√©limiteur. <br><br>  De plus, vous devez d√©terminer quelles entr√©es sont positives et lesquelles sont n√©gatives.  Bien entendu, ces informations sont indiqu√©es dans l'annotation aux jeux de donn√©es que nous voulons utiliser.  Mais le fait est que dans un cas, le signe de pos / neg est 0 ou 1, dans l'autre, c'est un vrai / faux logique, dans le troisi√®me, c'est juste une cha√Æne pos / neg, et dans certains cas, un tuple d'entiers de 0 √† 5 Ce dernier est pertinent pour le cas de la classification multiclasse, mais qui a dit qu'un tel ensemble de donn√©es ne pouvait pas √™tre utilis√© pour la classification binaire?  Il vous suffit d'identifier correctement la fronti√®re des valeurs positives et n√©gatives. <br><br>  Je voudrais essayer le mod√®le sur diff√©rents ensembles de donn√©es, et il est n√©cessaire qu'apr√®s la formation, le mod√®le renvoie le r√©sultat dans un seul format.  Et pour cela, ses donn√©es h√©t√©rog√®nes doivent √™tre r√©unies sous une forme unique. <br><br>  Donc, il y a trois fonctions dont nous avons besoin au stade du chargement des donn√©es: <br><br><ol><li>  La connexion √† la source de donn√©es est pour CSV, dans notre cas, elle est impl√©ment√©e √† l'int√©rieur de la fonction read_csv; </li><li>  Prise en charge des fonctionnalit√©s de format; </li><li>  Pr√©paration pr√©liminaire des donn√©es. </li></ol><br>  Voici √† quoi cela ressemble dans le code. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-comment"><span class="hljs-comment"># linear algebra import pandas as pd # data processing, CSV file I/O (eg pd.read_csv) import logging log = logging.getLogger() class CsvSentimentDataLoader(): def __init__(self, file_path, delim, text_attr, rate_attr, pos_rates): self.data_path = file_path self.delimiter = delim self.text_attr = text_attr self.rate_attr = rate_attr self.pos_rates = pos_rates def load_data(self): #     csv  tsv  data = pd.read_csv(self.data_path, self.delimiter) data.head() #   , #      data = data[[self.text_attr, self.rate_attr]] #    #     'pos'  'neg' data[self.rate_attr] = np.where( data[self.rate_attr].isin(self.pos_rates), 'pos', 'neg') return data</span></span></code> </pre><br>  La classe <b>CsvSentimentDataLoader a</b> √©t√© <b>cr√©√©e</b> , laquelle dans le constructeur est transmise le chemin vers csv, le s√©parateur, les noms du texte et les attributs de classification, ainsi qu'une liste de valeurs qui conseillent la valeur positive du texte. <br><br>  Le chargement lui-m√™me se produit dans la m√©thode <b>load_data</b> . <br><br><h3>  Nous divisons les donn√©es en ensembles de test et de formation </h3><br>  Ok, nous avons t√©l√©charg√© les donn√©es, mais nous devons toujours les diviser en ensembles de formation et de test. <br><br>  Cela se fait avec la fonction <b>train_test_split</b> de la biblioth√®que <b>sklearn</b> .  Cette fonction peut prendre beaucoup de param√®tres en entr√©e, d√©terminant comment exactement cet ensemble de donn√©es sera divis√© en train et test.  Ces param√®tres affectent de mani√®re significative la formation et les ensembles de tests r√©sultants, et il nous sera probablement utile de cr√©er une classe (appelons-la SimpleDataSplitter) qui g√©rera ces param√®tres et agr√©gera l'appel √† cette fonction. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-comment"><span class="hljs-comment"># to split the training and testing data import logging log = logging.getLogger() class SimpleDataSplitter(): def __init__(self, text_attr, rate_attr, test_part_size=.3): self.text_attr = text_attr self.rate_attr = rate_attr self.test_part_size = test_part_size def split_data(self, data): x = data[self.text_attr] y = data[self.rate_attr] x_train, x_test, y_train, y_test = train_test_split( x, y, test_size = self.test_part_size) return x_train, x_test, y_train, y_test</span></span></code> </pre><br>  D√©sormais, cette classe inclut l'impl√©mentation la plus simple qui, lorsqu'elle est divis√©e, ne prendra en compte qu'un seul param√®tre: le pourcentage d'enregistrements √† prendre comme ensemble de test. <br><br><h3>  Jeux de donn√©es </h3><br>  Pour former le mod√®le, j'ai utilis√© des jeux de donn√©es disponibles gratuitement au format CSV: <br><br><ul><li>  Amazon Alexa Reviews Data Set, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">disponible chez Kaggle</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ensemble de donn√©es sur les phrases √©tiquet√©es Sentiment</a> de l'Universit√© de Californie </li></ul><br>  Et pour le rendre encore plus pratique, pour chacun des ensembles de donn√©es, j'ai cr√©√© une classe qui charge les donn√©es du fichier CSV correspondant et les divise en ensembles de formation et de test. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CsvSentimentDataLoader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> web.data.splitters <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleDataSplitter, TdIdfDataSplitter log = logging.getLogger() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AmazonAlexaDataset</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.file_path = os.path.normpath(os.path.join(os.path.dirname(__file__), <span class="hljs-string"><span class="hljs-string">'amazon_alexa/train.tsv'</span></span>)) self.delim = <span class="hljs-string"><span class="hljs-string">'\t'</span></span> self.text_attr = <span class="hljs-string"><span class="hljs-string">'verified_reviews'</span></span> self.rate_attr = <span class="hljs-string"><span class="hljs-string">'feedback'</span></span> self.pos_rates = [<span class="hljs-number"><span class="hljs-number">1</span></span>] self.data = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.train = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.test = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> loader = CsvSentimentDataLoader(self.file_path, self.delim, self.text_attr, self.rate_attr, self.pos_rates) splitter = SimpleDataSplitter(self.text_attr, self.rate_attr, test_part_size=<span class="hljs-number"><span class="hljs-number">.3</span></span>) self.data = loader.load_data() x_train, x_test, y_train, y_test = splitter.split_data(self.data) self.train = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_train, y_train)] self.test = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(x_test, y_test)]</code> </pre><br>  Oui, pour le chargement des donn√©es, il s'est av√©r√© un peu plus de 5 lignes de code dans l'exemple d'origine. <br>  Mais il est d√©sormais possible de cr√©er de nouveaux ensembles de donn√©es en jonglant avec les sources de donn√©es et en formant des algorithmes de pr√©paration des ensembles. <br><br>  De plus, les composants individuels sont beaucoup plus pratiques pour les tests unitaires. <br><br><h2>  Nous formons le mod√®le </h2><br>  Le mod√®le apprend depuis un certain temps.  Et cela doit √™tre fait une fois, au d√©but de l'application. <br>  √Ä ces fins, un petit wrapper a √©t√© cr√©√© qui vous permet de t√©l√©charger et de pr√©parer les donn√©es, ainsi que de former le mod√®le au moment de l'initialisation de l'application. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextBlobWrapper</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log = logging.getLogger() self.is_model_trained = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> self.classifier = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization started'</span></span>) self.ensure_model_is_trained() self.log.info(<span class="hljs-string"><span class="hljs-string">'&gt;&gt;&gt;&gt;&gt; TextBlob initialization completed'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ensure_model_is_trained</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.is_model_trained: ds = SentimentLabelledDataset() ds.load_data() <span class="hljs-comment"><span class="hljs-comment"># train the classifier and test the accuracy self.classifier = NaiveBayesClassifier(ds.train) acr = self.classifier.accuracy(ds.test) self.log.info(str.format('&gt;&gt;&gt;&gt;&gt; NaiveBayesClassifier trained with accuracy {}', acr)) self.is_model_trained = True return self.classifier</span></span></code> </pre><br>  Nous obtenons d'abord des donn√©es de formation et de test, puis nous proc√©dons √† l'extraction des fonctionnalit√©s, et enfin nous formons le classificateur et v√©rifions la pr√©cision sur l'ensemble de test. <br><br><h2>  Test </h2><br>  Lors de l'initialisation, nous obtenons un journal, √† en juger par lequel, les donn√©es ont √©t√© t√©l√©charg√©es et le mod√®le a √©t√© form√© avec succ√®s.  Et entra√Æn√© avec une tr√®s bonne pr√©cision (pour commencer) - 0,8878. <br><br><img src="https://habrastorage.org/webt/nl/hw/pt/nlhwptjx8xnwfao2anynttvbr1u.png" alt="image"><br><br>  Ayant re√ßu de tels chiffres, j'√©tais tr√®s enthousiaste.  Mais ma joie, malheureusement, n'a pas √©t√© longue.  Le mod√®le form√© sur cet ensemble est un optimiste imp√©n√©trable et, en principe, n'est pas en mesure de reconna√Ætre les commentaires n√©gatifs. <br><br>  La raison en est dans les donn√©es de l'ensemble de formation.  Le nombre d'avis positifs dans l'ensemble est sup√©rieur √† 90%.  En cons√©quence, avec une pr√©cision du mod√®le d'environ 88%, les avis n√©gatifs tombent simplement dans les 12% attendus de classifications incorrectes. <br><br>  En d'autres termes, avec un tel ensemble de formation, il est tout simplement impossible de former le mod√®le √† reconna√Ætre les commentaires n√©gatifs. <br><br>  Pour vraiment m'en assurer, j'ai fait un test unitaire qui ex√©cute la classification s√©par√©ment pour 100 phrases positives et 100 phrases n√©gatives d'un autre ensemble de donn√©es - pour les tests, j'ai pris l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ensemble</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">donn√©es Sentiment Labeled Sentences</a> de l'Universit√© de Californie. <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta"> @loggingtestcase.capturelogs(None, level='INFO') def test_classifier_on_separate_set(self, logs): tb = TextBlobWrapper() # Going to be trained on Amazon Alexa dataset ds = SentimentLabelledDataset() # Test dataset ds.load_data() # Check poisitives true_pos = 0 data = ds.data.to_numpy() seach_mask = np.isin(data[:, 1], ['pos']) data = data[seach_mask][:100] for e in data[:]: # Model train will be performed on first classification call r = tb.do_sentiment_classification(e[0]) if r == e[1]: true_pos += 1 self.assertLessEqual(true_pos, 100) print(str.format('\n\nTrue Positive answers - {} of 100', true_pos))</span></span></code> </pre><br>  L'algorithme pour tester la classification des valeurs positives est le suivant: <br><br><ul><li>  T√©l√©charger les donn√©es de test; </li><li>  Prenez 100 messages √©tiquet√©s ¬´pos¬ª </li><li>  Nous ex√©cutons chacun d'eux √† travers le mod√®le et comptons le nombre de r√©sultats corrects </li><li>  Affichez le r√©sultat final dans la console. </li></ul><br>  De m√™me, un d√©compte est effectu√© pour les commentaires n√©gatifs. <br><br><div class="spoiler">  <b class="spoiler_title">R√©sultat</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/79/lj/px/79ljpxifxo5sl1kpdt_h0q4zd58.png" alt="image"><br></div></div><br>  Comme pr√©vu, tous les commentaires n√©gatifs ont √©t√© reconnus comme positifs. <br><br>  Et si vous entra√Ænez le mod√®le sur l'ensemble de donn√©es utilis√© pour les tests - <b>Sentiment √©tiquet√©</b> ?  L√†, la r√©partition des commentaires n√©gatifs et positifs est exactement de 50 √† 50. <br><br><div class="spoiler">  <b class="spoiler_title">Modifiez le code et testez, ex√©cutez</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tj/cw/oo/tjcwoocc2qodmbd5zl7emwqt8ve.png" alt="image"><br></div></div><br>  Quelque chose d√©j√†.  La pr√©cision r√©elle de 200 entr√©es provenant d'un ensemble tiers est de 76%, tandis que la pr√©cision de la classification des commentaires n√©gatifs est de 79%. <br><br>  Bien s√ªr, 76% le feront pour un prototype, mais pas assez pour la production.  Cela signifie que des mesures suppl√©mentaires seront n√©cessaires pour am√©liorer la pr√©cision de l'algorithme.  Mais c'est un sujet pour un autre rapport. <br><br><h2>  R√©sum√© </h2><br>  Premi√®rement, nous avons obtenu une application avec une douzaine de classes et plus de 200 lignes de code, ce qui est l√©g√®rement plus que l'exemple d'origine de 30 lignes.  Et vous devez √™tre honn√™te - ce ne sont que des indices sur la structure, la premi√®re clarification des limites de la future application.  Prototype. <br><br>  Et ce prototype a permis de r√©aliser √† quel point la distance entre les approches du code est du point de vue des sp√©cialistes du Machine Learning et du point de vue des d√©veloppeurs d'applications traditionnelles.  Et c'est, √† mon avis, la principale difficult√© pour les d√©veloppeurs qui d√©cident d'essayer le machine learning. <br><br>  La prochaine chose qui peut mettre un d√©butant dans une stupeur - les donn√©es ne sont pas moins importantes que le mod√®le s√©lectionn√©.  Cela a √©t√© clairement d√©montr√©. <br><br>  De plus, il reste toujours la possibilit√© qu'un mod√®le form√© sur certaines donn√©es se montre inad√©quatement sur d'autres, ou √† un moment donn√© sa pr√©cision commencera √† se d√©grader. <br>  En cons√©quence, des mesures sont n√©cessaires pour surveiller l'√©tat du mod√®le, la flexibilit√© lors de l'utilisation des donn√©es, les capacit√©s techniques pour ajuster l'apprentissage √† la vol√©e.  Et ainsi de suite. <br><br>  Quant √† moi, tout cela doit √™tre pris en compte lors de la conception de l'architecture et des processus de d√©veloppement des b√¢timents. <br><br>  En g√©n√©ral, le "trou du lapin" √©tait non seulement tr√®s profond, mais aussi extr√™mement habilement pos√©.  Mais d'autant plus int√©ressant pour moi, en tant que d√©veloppeur, d'√©tudier ce sujet √† l'avenir. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457168/">https://habr.com/ru/post/fr457168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457152/index.html">Conf√©rence DEFCON 25. Garry Kasparov. "La derni√®re bataille du cerveau." Partie 1</a></li>
<li><a href="../fr457154/index.html">Conception d'application r√©active pour chaque utilisateur</a></li>
<li><a href="../fr457156/index.html">Quels peuvent √™tre les syst√®mes informatiques du futur</a></li>
<li><a href="../fr457160/index.html">Mon approche pour impl√©menter des d√©l√©gu√©s en C ++: appeler une fonction avec des param√®tres inconnus √† l'ex√©cution</a></li>
<li><a href="../fr457164/index.html">Navigation dans une application multiplateforme .NET Core avec enregistrement de l'√©tat sur le disque en utilisant l'exemple de ReactiveUI et Avalonia</a></li>
<li><a href="../fr457172/index.html">ScreenLogger - sourire, une cam√©ra cach√©e vous emm√®ne</a></li>
<li><a href="../fr457178/index.html">Conception et fabrication des processeurs: conception du processeur</a></li>
<li><a href="../fr457180/index.html">Le site officiel Node.js est maintenant en russe</a></li>
<li><a href="../fr457182/index.html">Langue REXX, 40e anniversaire</a></li>
<li><a href="../fr457184/index.html">Cr√©ez dynamiquement robots.txt pour les sites ASP.NET Core</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>