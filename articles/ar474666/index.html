<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ’¼ ğŸ” ğŸ¤°ğŸ¾ ÙƒÙŠÙ Ù„Ø§ Ù„Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Ø§Ù„ØµØ¯Ø£ ğŸ‘©ğŸ¼â€ğŸš’ ğŸ’¹ ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ø¨Ù…Ø¬Ø±Ø¯ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø£Ù„Ù… ÙÙŠ Borrow-Checker ÙˆØ¥Ø¯Ø±Ø§Ùƒ Ø£Ù† Rust ÙŠØªÙŠØ­ Ù„Ùƒ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø£Ø´ÙŠØ§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ®ÙŠÙ„Ù‡Ø§ (ÙˆØ£Ø­ÙŠØ§Ù†Ù‹Ø§ ØªÙƒÙˆÙ† Ø®Ø·Ø±Ø©) Ø¨Ù„ØºØ§Øª Ø£Ø®Ø±Ù‰ ØŒ Ù‚Ø¯ ØªÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ Ø£ÙŠØ¶Ù‹Ø§ Ù†ÙØ³ Ø§Ù„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ÙƒÙŠÙ Ù„Ø§ Ù„Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Ø§Ù„ØµØ¯Ø£</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474666/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img align="right" width="320" src="https://habrastorage.org/webt/dr/uk/dk/drukdkvyoebpgesff5zb_o1zplm.png">  Ø¨Ù…Ø¬Ø±Ø¯ ØªØ¬Ø§ÙˆØ² Ø­Ø¯ Ø§Ù„Ø£Ù„Ù… ÙÙŠ <em>Borrow-Checker</em> ÙˆØ¥Ø¯Ø±Ø§Ùƒ Ø£Ù† Rust ÙŠØªÙŠØ­ Ù„Ùƒ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø£Ø´ÙŠØ§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ®ÙŠÙ„Ù‡Ø§ (ÙˆØ£Ø­ÙŠØ§Ù†Ù‹Ø§ ØªÙƒÙˆÙ† Ø®Ø·Ø±Ø©) Ø¨Ù„ØºØ§Øª Ø£Ø®Ø±Ù‰ ØŒ Ù‚Ø¯ ØªÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ Ø£ÙŠØ¶Ù‹Ø§ Ù†ÙØ³ Ø§Ù„Ø±ØºØ¨Ø© Ø§Ù„ØªÙŠ Ù„Ø§ ØªÙ‚Ø§ÙˆÙ… ÙÙŠ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¥Ø¹Ø§Ø¯Ø© ÙƒØªØ§Ø¨Ø© ÙƒÙ„ Ø´ÙŠØ¡ Ø¥Ù„Ù‰ Rust</a> .  Ø¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ… Ù…Ù† Ø£Ù†Ù‡ ÙÙŠ Ø£ÙØ¶Ù„ Ø§Ù„Ø£Ø­ÙˆØ§Ù„ ØŒ ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± ØºÙŠØ± Ù…Ù†ØªØ¬ (Ø¬Ù‡ÙˆØ¯ ØªØ¨Ø¯ÙŠØ¯ Ù„Ø§ Ù…Ø¹Ù†Ù‰ Ù„Ù‡Ø§ Ù„Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹) ØŒ ÙˆÙ„ÙƒÙ†Ù‡ ÙÙŠ Ø£Ø³ÙˆØ£ Ø§Ù„Ø£Ø­ÙˆØ§Ù„ ÙŠØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ Ø§Ù†Ø®ÙØ§Ø¶ ÙÙŠ Ø¬ÙˆØ¯Ø© Ø§Ù„ÙƒÙˆØ¯ (Ø¨Ø¹Ø¯ ÙƒÙ„ Ø´ÙŠØ¡ ØŒ Ù„Ù…Ø§Ø°Ø§ ØªØ¹ØªØ¨Ø± Ù†ÙØ³Ùƒ Ø£ÙƒØ«Ø± Ø®Ø¨Ø±Ø© ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙƒØªØ¨Ø© Ù…Ù† Ù…Ø¤Ù„ÙÙ‡Ø§ Ø§Ù„Ø£ØµÙ„ÙŠØŸ) </p><br><p style=";text-align:right;direction:rtl">  Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ù…ÙÙŠØ¯ ØªÙˆÙÙŠØ± ÙˆØ§Ø¬Ù‡Ø© Ø¢Ù…Ù†Ø© Ù„Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ù…Ù† Ø®Ù„Ø§Ù„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒÙˆØ¯. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù†Ù‚ÙˆÙ… Ø¨ØªØ¬Ù…ÙŠØ¹ chmlib-sys</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙƒØªØ§Ø¨Ø© ØºÙ„Ø§Ù Ø¢Ù…Ù† ÙÙŠ Ø§Ù„ØµØ¯Ø£</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ù„Ø§Ø³Ù…</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„ØªØµÙÙŠØ©</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù‚Ø±Ø§Ø¡Ø© Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ù„Ù</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø£Ø¶Ù Ø£Ù…Ø«Ù„Ø©</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¬Ø¯ÙˆÙ„ Ù…Ø­ØªÙˆÙŠØ§Øª Ù…Ù„Ù CHM</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØªÙØ±ÙŠØº Ù…Ù„Ù CHM Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø±Øµ</a> <br>  â€¢ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ù…Ø§Ø°Ø§ Ø¨Ø¹Ø¯ØŸ</a> </p><br><blockquote style=";text-align:right;direction:rtl">  ÙŠÙ†Ø§Ù‚Ø´ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‚Ø§Ù„ Ù…Ø´Ø±ÙˆØ¹ Ø­Ù‚ÙŠÙ‚ÙŠ.  ÙƒØ§Ù† Ø¹Ù„ÙŠÙ‘ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ù† Ù…Ù„ÙØ§Øª CHM Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ØŒ Ù„ÙƒÙ† Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ ÙˆÙ‚Øª Ù„ÙÙ‡Ù… Ø§Ù„ØªÙ†Ø³ÙŠÙ‚.  Ø§Ù„ÙƒØ³Ù„ Ù‡Ùˆ Ù…Ø­Ø±Ùƒ Ø§Ù„ØªÙ‚Ø¯Ù…. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ÙŠØªÙ…</strong> Ù†Ø´Ø± <strong>ØµÙ†Ø¯ÙˆÙ‚ chmlib</strong> Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ crates.io</a> ØŒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙˆÙŠØªÙˆÙØ±</a> ÙƒÙˆØ¯ Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¹Ù„Ù‰ GitHub</a> .  Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª Ø£Ù†Ù‡Ø§ Ù…ÙÙŠØ¯Ø© Ø£Ùˆ ÙˆØ¬Ø¯Øª Ù…Ø´ÙƒÙ„Ø§Øª ÙÙŠÙ‡Ø§ ØŒ ÙØ£Ø®Ø¨Ø±Ù†ÙŠ Ø¨Ø°Ù„Ùƒ Ù…Ù† <a href="">Ø®Ù„Ø§Ù„ bugtracker</a> . </blockquote><br><h2 id="pervye-shagi" style=";text-align:right;direction:rtl">  Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø£ÙˆÙ„Ù‰ </h2><br><p style=";text-align:right;direction:rtl">  Ø¨Ø§Ø¯Ø¦ Ø°ÙŠ Ø¨Ø¯Ø¡ ØŒ ÙŠØ¬Ø¯Ø± ÙÙ‡Ù… ÙƒÙŠÙ ØªÙ… ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…ÙƒØªØ¨Ø© ÙÙŠ Ø§Ù„Ø£ØµÙ„. </p><br><blockquote style=";text-align:right;direction:rtl">  Ù‡Ø°Ø§ Ù„Ù† ÙŠØ¹Ù„Ù…Ùƒ ÙÙ‚Ø· ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ØŒ ÙˆÙ„ÙƒÙ† Ø£ÙŠØ¶Ù‹Ø§ ÙŠØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ³ÙŠØ±.  Ø¥Ø°Ø§ ÙƒÙ†Øª Ù…Ø­Ø¸ÙˆØ¸Ù‹Ø§ ØŒ ÙØ³ØªØ¬Ø¯ Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª ÙˆØ£Ù…Ø«Ù„Ø© Ø¬Ø§Ù‡Ø²Ø©. <br><br>  <strong>Ù„Ø§ ØªØ®Ø·ÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø®Ø·ÙˆØ©!</strong> </blockquote><p style=";text-align:right;direction:rtl"> Ø³Ù†Ø¹Ù…Ù„ Ù…Ø¹ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CHMLib</a> ØŒ Ù…ÙƒØªØ¨Ø© C Ù„Ù‚Ø±Ø§Ø¡Ø© <em>Ù…Ù„ÙØ§Øª ØªØ¹Ù„ÙŠÙ…Ø§Øª HTML Ø§Ù„Ù…ØªØ±Ø¬Ù…Ø© Ù…Ù† Microsoft</em> ( <code>.chm</code> ). </p><br><p style=";text-align:right;direction:rtl">  Ù„Ù†Ø¨Ø¯Ø£ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯ ÙˆØªÙˆØµÙŠÙ„ CHMLib ÙƒÙˆØ­Ø¯Ø© ÙØ±Ø¹ÙŠØ© git: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ git init chmlib &amp;&amp; cd chmlib Initialized empty Git repository in /home/michael/Documents/chmlib/.git/ $ touch README.md Cargo.toml $ cargo new --lib chmlib Created library `chmlib` package $ cargo new --lib chmlib-sys Created library `chmlib-sys` package $ cat Cargo.toml [workspace] members = ["chmlib", "chmlib-sys"] $ git submodule add git@github.com:jedwing/CHMLib.git vendor/CHMLib Cloning into '/home/michael/Documents/chmlib/vendor/CHMLib'... remote: Enumerating objects: 99, done. remote: Total 99 (delta 0), reused 0 (delta 0), pack-reused 99 Receiving objects: 100% (99/99), 375.51 KiB | 430.00 KiB/s, done. Resolving deltas: 100% (45/45), done.</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ø£Ù„Ù‚Ù Ù†Ø¸Ø±Ø© Ø¹Ù„Ù‰ Ù…Ø§ Ø¨Ø¯Ø§Ø®Ù„ <code>tree</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ tree vendor/CHMLib vendor/CHMLib â”œâ”€â”€ acinclude.m4 â”œâ”€â”€ AUTHORS â”œâ”€â”€ ChangeLog â”œâ”€â”€ ChmLib-ce.zip â”œâ”€â”€ ChmLib-ds6.zip â”œâ”€â”€ configure.in â”œâ”€â”€ contrib â”‚ â””â”€â”€ mozilla_helper.sh â”œâ”€â”€ COPYING â”œâ”€â”€ Makefile.am â”œâ”€â”€ NEWS â”œâ”€â”€ NOTES â”œâ”€â”€ README â””â”€â”€ src â”œâ”€â”€ chm_http.c â”œâ”€â”€ chm_lib.c â”œâ”€â”€ chm_lib.h â”œâ”€â”€ enum_chmLib.c â”œâ”€â”€ enumdir_chmLib.c â”œâ”€â”€ extract_chmLib.c â”œâ”€â”€ lzx.c â”œâ”€â”€ lzx.h â”œâ”€â”€ Makefile.am â”œâ”€â”€ Makefile.simple â””â”€â”€ test_chmLib.c 2 directories, 23 files</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠØ¨Ø¯Ùˆ Ø£Ù† Ø§Ù„Ù…ÙƒØªØ¨Ø© ØªØ³ØªØ®Ø¯Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GNU Autotools</a> Ù„Ù„Ø¨Ù†Ø§Ø¡.  Ù‡Ø°Ø§ Ù„ÙŠØ³ Ø¬ÙŠØ¯Ù‹Ø§ ØŒ Ù„Ø£Ù† Ø¬Ù…ÙŠØ¹ Ù…Ø³ØªØ®Ø¯Ù…ÙŠ ØµÙ†Ø¯ÙˆÙ‚ chmlib (ÙˆÙ…Ø³ØªØ®Ø¯Ù…ÙŠÙ‡) Ø³ÙŠØ­ØªØ§Ø¬ÙˆÙ† Ø¥Ù„Ù‰ ØªØ«Ø¨ÙŠØª Autotools. </p><br><blockquote style=";text-align:right;direction:rtl">  Ø³Ù†Ø­Ø§ÙˆÙ„ Ø§Ù„ØªØ®Ù„Øµ Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„ØªØ¨Ø¹ÙŠØ© "Ø§Ù„Ù…Ø¹Ø¯ÙŠØ©" Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØ¯ "C" ÙŠØ¯ÙˆÙŠÙ‹Ø§ ØŒ Ù„ÙƒÙ† Ø§Ù„Ù…Ø²ÙŠØ¯ Ø¹Ù† Ø°Ù„Ùƒ Ù„Ø§Ø­Ù‚Ù‹Ø§. </blockquote><p style=";text-align:right;direction:rtl">  ØªØ­ØªÙˆÙŠ Ù…Ù„ÙØ§Øª lzx.h Ùˆ lzx.c Ø¹Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚ Ù„ÙˆØºØ§Ø±ÙŠØªÙ… Ø¶ØºØ· <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LZX</a> .  Ø¨Ø´ÙƒÙ„ Ø¹Ø§Ù… ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø£ÙØ¶Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙˆØ¹ Ù…Ù† Ù…ÙƒØªØ¨Ø© liblzx Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ­Ø¯ÙŠØ«Ø§Øª Ù…Ø¬Ø§Ù†Ù‹Ø§ ÙˆÙƒÙ„ Ø°Ù„Ùƒ ØŒ Ù„ÙƒÙ† Ø±Ø¨Ù…Ø§ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø£Ø³Ù‡Ù„ ØªØ¬Ù…ÙŠØ¹ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨ØºØ¨Ø§Ø¡. </p><br><p style=";text-align:right;direction:rtl">  ÙŠØ¨Ø¯Ùˆ Ø£Ù† enum_chmLib.cØŒ enumdir_chmLib.cØŒ extract_chmLib.c Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø§Øª chm_enumerate ()ØŒ chm_enumerate_dir ()ØŒ chm_retrieve_object ().  ÙˆØ³ÙˆÙ ÙŠØ£ØªÙŠ ÙÙŠ Ù…ØªÙ†Ø§ÙˆÙ„ Ø§Ù„ÙŠØ¯ÙŠÙ† ... </p><br><p style=";text-align:right;direction:rtl">  ÙŠØ­ØªÙˆÙŠ Ø§Ù„Ù…Ù„Ù test_chmLib.c Ø¹Ù„Ù‰ Ù…Ø«Ø§Ù„ Ø¢Ø®Ø± ØŒ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø© Ø§Ø³ØªØ®Ø±Ø§Ø¬ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ù…Ù„Ù CHM Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø±Øµ. </p><br><p style=";text-align:right;direction:rtl">  ÙŠÙ‚ÙˆÙ… chm_http.c Ø¨ØªÙ†ÙÙŠØ° Ø®Ø§Ø¯Ù… HTTP Ø¨Ø³ÙŠØ· ÙŠØ¹Ø±Ø¶ Ù…Ù„Ù .chm ÙÙŠ Ø§Ù„Ù…Ø³ØªØ¹Ø±Ø¶.  Ù‡Ø°Ø§ ØŒ Ø±Ø¨Ù…Ø§ ØŒ Ù„Ù† ÙŠÙƒÙˆÙ† Ù…ÙÙŠØ¯Ø§. </p><br><p style=";text-align:right;direction:rtl">  Ù„Ø°Ù„Ùƒ Ù‚Ù…Ù†Ø§ Ø¨ØªØ³ÙˆÙŠØ© ÙƒÙ„ Ù…Ø§ Ù‡Ùˆ Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ø¨Ø§Ø¦Ø¹ / CHMLib / src.  Ù‡Ù„ Ø³Ù†Ø¬Ù…Ø¹ Ø§Ù„Ù…ÙƒØªØ¨Ø©ØŸ </p><br><p style=";text-align:right;direction:rtl">  Ø¨ØµØ±Ø§Ø­Ø© ØŒ Ø£Ù†Ù‡Ø§ ØµØºÙŠØ±Ø© Ø¨Ù…Ø§ ÙŠÙƒÙÙŠ Ù„ØªØ·Ø¨ÙŠÙ‚ Ø·Ø±ÙŠÙ‚Ø© ÙƒØ²Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ clang chm_lib.c enum_chmLib.c -o enum_chmLib /usr/bin/ld: /tmp/chm_lib-537dfe.o: in function `chm_close': chm_lib.c:(.text+0x8fa): undefined reference to `LZXteardown' /usr/bin/ld: /tmp/chm_lib-537dfe.o: in function `_chm_decompress_region': chm_lib.c:(.text+0x18ca): undefined reference to `LZXinit' /usr/bin/ld: /tmp/chm_lib-537dfe.o: in function `_chm_decompress_block': chm_lib.c:(.text+0x2900): undefined reference to `LZXreset' /usr/bin/ld: chm_lib.c:(.text+0x2a4b): undefined reference to `LZXdecompress' /usr/bin/ld: chm_lib.c:(.text+0x2abe): undefined reference to `LZXreset' /usr/bin/ld: chm_lib.c:(.text+0x2bf4): undefined reference to `LZXdecompress' clang: error: linker command failed with exit code 1 (use -v to see invocation)</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø­Ø³Ù†Ø§ ØŒ Ø±Ø¨Ù…Ø§ Ù„Ø§ ØªØ²Ø§Ù„ Ù‡Ù†Ø§Ùƒ Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ù‡Ø°Ø§ LZX ... </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ clang chm_lib.c enum_chmLib.c lzx.c -o enum_chmLib</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ù‡ ... ÙƒÙ„ Ø´ÙŠØ¡ØŸ </p><br><p style=";text-align:right;direction:rtl">  Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ù…Ù„ Ø§Ù„Ø´ÙØ±Ø© ØŒ Ù‚Ù…Øª Ø¨ØªÙ†Ø²ÙŠÙ„ Ù…Ø«Ø§Ù„ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ curl http://www.innovasys.com/static/hs/samples/topics.classic.chm.zip \ -o topics.classic.chm.zip $ unzip topics.classic.chm.zip Archive: topics.classic.chm.zip inflating: output/compiled/topics.classic.chm $ file output/compiled/topics.classic.chm output/compiled/topics.classic.chm: MS Windows HtmlHelp Data</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ù‰ ÙƒÙŠÙ ÙŠØ¹Ø§Ù„Ø¬ enum_chmLib Ø°Ù„Ùƒ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ ./enum_chmLib output/compiled/topics.classic.chm output/compiled/topics.classic.chm: spc start length type name === ===== ====== ==== ==== 0 0 0 normal dir / 1 5125797 4096 special file /#IDXHDR ... 1 4944434 11234 normal file /BrowserView.html ... 0 0 0 normal dir /flash/ 1 532689 727 normal file /flash/expressinstall.swf 0 0 0 normal dir /Images/Commands/RealWorld/ 1 24363 1254 normal file /Images/Commands/RealWorld/BrowserBack.bmp ... 1 35672 1021 normal file /Images/Employees24.gif ... 1 3630715 200143 normal file /template/packages/jquery-mobile/script/ jquery.mobile-1.4.5.min.js ... 0 134 1296 meta file ::DataSpace/Storage/MSCompressed/Transform/ {7FC28940-9D31-11D0-9B27-00A0C91E9C7C}/ InstanceData/ResetTable</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠØ§ Ø±Ø¨ ØŒ <em>Ø­ØªÙ‰ Ù‡Ù†Ø§</em> Ù…Ø³Ø¬ Â¯ \ _ (ãƒ„) _ / Â¯ </p><br><h2 id="sobiraem-chmlib-sys" style=";text-align:right;direction:rtl">  Ø¨Ù†Ø§Ø¡ chmlib- ØªÙ…ÙŠØ² Ø§Ù„ÙƒÙ„ÙŠØ© </h2><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¢Ù† Ù†Ø­Ù† Ù†Ø¹Ø±Ù Ù…Ø§ ÙŠÙƒÙÙŠ Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… CHMLib ÙÙŠ <strong>Ù‚ÙØµ</strong> chmlib <strong>-sys</strong> ØŒ ÙˆÙ‡Ùˆ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© ØŒ ÙˆØ±Ø¨Ø·Ù‡Ø§ Ù…Ø¹ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ Rast ØŒ ÙˆÙˆØ§Ø¬Ù‡Ø© Ù„ÙˆØ¸Ø§Ø¦Ù C. </p><br><p style=";text-align:right;direction:rtl">  Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ¨Ø© ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ÙƒØªØ§Ø¨Ø© Ù…Ù„Ù <code>build.rs</code> .  Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ØµÙ†Ø¯ÙˆÙ‚ <strong>cc</strong> ØŒ</a> Ø³ÙŠØªØµÙ„ Ø¨Ø§Ù„Ù…ØªØ±Ø¬Ù… C ÙˆÙŠÙ‚ÙˆÙ… Ø¨Ø§Ù„ØµØ¯Ø§Ù‚Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ Ø­ØªÙ‰ ÙŠØ¹Ù…Ù„ ÙƒÙ„ Ø´ÙŠØ¡ Ù…Ø¹Ù‹Ø§ ÙƒÙ…Ø§ ÙŠÙ†Ø¨ØºÙŠ. </p><br><blockquote style=";text-align:right;direction:rtl">  Ù†Ø­Ù† Ù…Ø­Ø¸ÙˆØ¸ÙˆÙ† Ù„Ø£Ù†Ù†Ø§ Ù†Ø³ØªØ·ÙŠØ¹ ØªØ­ÙˆÙŠÙ„ Ù…Ø¹Ø¸Ù… Ø§Ù„Ø£Ø¹Ù…Ø§Ù„ Ø¥Ù„Ù‰ Ø³Ù… Ù…ÙƒØ¹Ø¨ ØŒ ÙˆÙ„ÙƒÙ† ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø­ÙŠØ§Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø£Ù…Ø± Ø£ÙƒØ«Ø± ØµØ¹ÙˆØ¨Ø©.  Ø§Ù‚Ø±Ø£ Ø§Ù„Ù…Ø²ÙŠØ¯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ÙÙŠ ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ø§Ù„Ù†ØµÙŠØ© Ù„Ù„ØªØ¬Ù…ÙŠØ¹</a> . </blockquote><p style=";text-align:right;direction:rtl">  Ø£ÙˆÙ„Ø§Ù‹ Ø£Ø¶Ù <strong>cc</strong> ÙƒØªØ¨Ø¹ÙŠØ© Ù„Ù€ chmlib-sys: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cd chmlib-sys $ cargo add --build cc Updating 'https://github.com/rust-lang/crates.io-index' index Adding cc v1.0.46 to build-dependencies</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø«Ù… Ù†ÙƒØªØ¨ <code>build.rs</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib-sys/build.rs use cc::Build; use std::{env, path::PathBuf}; fn main() { let project_dir = PathBuf::from(env::var("CARGO_MANIFEST_DIR").unwrap()) .canonicalize() .unwrap(); let root_dir = project_dir.parent().unwrap(); let src = root_dir.join("vendor").join("CHMLib").join("src"); Build::new() .file(src.join("chm_lib.c")) .file(src.join("lzx.c")) .include(&amp;src) .warnings(false) .compile("chmlib"); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªØ­ØªØ§Ø¬ Ø£ÙŠØ¶Ù‹Ø§ Ø¥Ù„Ù‰ Ø¥Ø®Ø¨Ø§Ø± Cargo Ø¨Ø£Ù† Ø±ÙˆØ§Ø¨Ø· chmlib-sys Ø¥Ù„Ù‰ Ù…ÙƒØªØ¨Ø© chmlib.  Ø«Ù… ÙŠØ¶Ù…Ù† Cargo Ø£Ù†Ù‡ ÙÙŠ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„ØªØ¨Ø¹ÙŠØ© Ø¨Ø£ÙƒÙ…Ù„Ù‡ ÙŠÙˆØ¬Ø¯ Ø±Ù ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· ØŒ Ø§Ø¹ØªÙ…Ø§Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©.  ÙŠØ¤Ø¯ÙŠ Ø°Ù„Ùƒ Ø¥Ù„Ù‰ ØªØ¬Ù†Ø¨ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ø§Ù„ØºØ§Ù…Ø¶Ø© Ø­ÙˆÙ„ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ù…ØªÙƒØ±Ø±Ø© Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ØºÙŠØ± Ø§Ù„Ù…Ù‚ØµÙˆØ¯ Ù„Ù„Ù…ÙƒØªØ¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="diff hljs"><span class="hljs-comment"><span class="hljs-comment">--- a/chmlib-sys/Cargo.toml +++ b/chmlib-sys/Cargo.toml @@ -3,7 +3,13 @@ name = "chmlib-sys" version = "0.1.0" authors = ["Michael Bryan &lt;michaelfbryan@gmail.com&gt;"] edition = "2018" description = "Raw bindings to the CHMLib C library" license = "LGPL" repository = "https://github.com/Michael-F-Bryan/chmlib" +links = "chmlib" +build = "build.rs" [dependencies] [build-dependencies] cc = { version = "1.0" }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ù†Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙŠ ØªÙ… ØªØµØ¯ÙŠØ±Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Ù…ÙƒØªØ¨Ø© chmlib Ø­ØªÙ‰ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ Ù…Ù† Rast. </p><br><p style=";text-align:right;direction:rtl">  ÙˆÙ„Ù‡Ø°Ø§ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„ØºØ±Ø¶ ÙŠÙˆØ¬Ø¯</a> Ù…Ø´Ø±ÙˆØ¹ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">bindgen</a> Ø§Ù„Ø±Ø§Ø¦Ø¹.  ÙŠØªÙ… Ø¥Ø¹Ø·Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ø±Ø£Ø³ C Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ØŒ ÙˆÙŠØªÙ… Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ù…Ù„Ù Ø°Ùˆ Ø±ÙˆØ§Ø¨Ø· FFI Ù„Ù€ Rast. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cargo install bindgen $ bindgen ../vendor/CHMLib/src/chm_lib.h \ -o src/lib.rs \ --raw-line '#![allow(non_snake_case, non_camel_case_types)]' $ head src/lib.rs /* automatically generated by rust-bindgen */ #![allow(non_snake_case, non_camel_case_types)] pub const CHM_UNCOMPRESSED: u32 = 0; pub const CHM_COMPRESSED: u32 = 1; pub const CHM_MAX_PATHLEN: u32 = 512; pub const CHM_PARAM_MAX_BLOCKS_CACHED: u32 = 0; pub const CHM_RESOLVE_SUCCESS: u32 = 0; pub const CHM_RESOLVE_FAILURE: u32 = 1; $ tail src/lib.rs extern "C" { pub fn chm_enumerate_dir( h: *mut chmFile, prefix: *const ::std::os::raw::c_char, what: ::std::os::raw::c_int, e: CHM_ENUMERATOR, context: *mut ::std::os::raw::c_void, ) -&gt; ::std::os::raw::c_int; }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  Ø£ÙˆØµÙŠ Ø¨Ø´Ø¯Ø© Ø¨Ù‚Ø±Ø§Ø¡Ø© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Bindgen</a> Ø¥Ø°Ø§ ÙƒÙ†Øª Ø¨Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ Ø¥ØµÙ„Ø§Ø­ Ø´ÙŠØ¡ Ù…Ø§ ÙÙŠ Ø§Ù„Ø¹Ø§Ø¯Ù… Ø§Ù„Ø®Ø§Øµ Ø¨Ù‡. </blockquote><p style=";text-align:right;direction:rtl">  ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø±Ø­Ù„Ø© ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ù…ÙÙŠØ¯ ÙƒØªØ§Ø¨Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¯Ø®Ø§Ù† Ø§Ù„Ø°ÙŠ Ø³ÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ¹Ù…Ù„ Ø¨Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ ÙˆØ£Ù†Ù‡ ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø¨Ø§Ù„ÙØ¹Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ¸Ø§Ø¦Ù Ù…ÙƒØªØ¨Ø© C Ø§Ù„Ø£ØµÙ„ÙŠØ©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib-sys/tests/smoke_test.rs //    Path  char*     . //  , OsStr ( Path)  Windows  [u16]  , //        char*. #![cfg(unix)] use std::{ffi::CString, os::unix::ffi::OsStrExt, path::Path}; #[test] fn open_example_file() { let project_dir = Path::new(env!("CARGO_MANIFEST_DIR")); let sample_chm = project_dir.parent().unwrap().join("topics.classic.chm"); let c_str = CString::new(sample_chm.as_os_str().as_bytes()).unwrap(); unsafe { let handle = chmlib_sys::chm_open(c_str.as_ptr()); assert!(!handle.is_null()); chmlib_sys::chm_close(handle); } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠÙ‚ÙˆÙ„ <code>cargo test</code> Ø£Ù† ÙƒÙ„ Ø´ÙŠØ¡ ÙŠØ¨Ø¯Ùˆ Ø¬ÙŠØ¯Ù‹Ø§: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cargo test Finished test [unoptimized + debuginfo] target(s) in 0.03s Running ~/chmlib/target/debug/deps/chmlib_sys-2ffd7b11a9fd8437 running 1 test test bindgen_test_layout_chmUnitInfo ... ok test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out Running ~/chmlib/target/debug/deps/smoke_test-f7be9810412559dc running 1 test test open_example_file ... ok test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out Doc-tests chmlib-sys running 0 tests test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out</code> </pre> <br><h2 id="pishem-bezopasnuyu-obyortku-na-rust" style=";text-align:right;direction:rtl">  ÙƒØªØ§Ø¨Ø© ØºÙ„Ø§Ù Ø¢Ù…Ù† ÙÙŠ Rust </h2><br><p style=";text-align:right;direction:rtl">  <em>Ù…Ù† Ø§Ù„Ù†Ø§Ø­ÙŠØ© Ø§Ù„ÙÙ†ÙŠØ© ÙˆØ§Ù„ØªÙ‚Ù†ÙŠØ© ØŒ</em> ÙŠÙ…ÙƒÙ†Ù†Ø§ Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ CHMLib Ù…Ù† Ø§Ù„Ø±Ø§Ø³ØªØ§ ØŒ ÙˆÙ„ÙƒÙ† Ù‡Ø°Ø§ ÙŠØªØ·Ù„Ø¨ ÙƒÙˆÙ…Ø© <strong>ØºÙŠØ± Ø¢Ù…Ù†Ø©</strong> .  Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù‡Ø°Ø§ Ø§Ù„Ø£Ù…Ø± Ù…ÙÙŠØ¯Ù‹Ø§ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù…Ø±ÙƒØ¨Ø© ØªÙ… Ø§Ø®ØªØ±Ø§Ù‚Ù‡Ø§ ØŒ ÙˆÙ„ÙƒÙ† Ù„Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚. ÙŠØ³ØªØ­Ù‚ Ø§Ù„Ø£Ù…Ø± ÙƒØªØ§Ø¨Ø© ØºÙ„Ø§Ù Ø¢Ù…Ù† Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´ÙØ±Ø§Øª ØºÙŠØ± Ø§Ù„Ø¢Ù…Ù†Ø©. </p><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù†Ø¸Ø±Øª Ø¥Ù„Ù‰ ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª chmlib-sys Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code>cargo doc --open</code> ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø±Ø¤ÙŠØ© Ø§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙŠ ØªØ£Ø®Ø° <strong><code>*mut ChmFile</code></strong> ÙƒÙˆØ³ÙŠØ·Ø© Ø£ÙˆÙ„Ù‰.  Ù‡Ø°Ø§ ÙŠØ´Ø¨Ù‡ Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø§Ù„ÙŠØ¨. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">CHMLib Ø±Ø£Ø³ Ø§Ù„Ù…Ù„Ù</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* $Id: chm_lib.h,v 1.10 2002/10/09 01:16:33 jedwin Exp $ */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * chm_lib.h - CHM archive manipulation routines * * ------------------- * * * * author: Jed Wing &lt;jedwin@ugcs.caltech.edu&gt; * * version: 0.3 * * notes: These routines are meant for the manipulation of microsoft * * .chm (compiled html help) files, but may likely be used * * for the manipulation of any ITSS archive, if ever ITSS * * archives are used for any other purpose. * * * * Note also that the section names are statically handled. * * To be entirely correct, the section names should be read * * from the section names meta-file, and then the various * * content sections and the "transforms" to apply to the data * * they contain should be inferred from the section name and * * the meta-files referenced using that name; however, all of * * the files I've been able to get my hands on appear to have * * only two sections: Uncompressed and MSCompressed. * * Additionally, the ITSS.DLL file included with Windows does * * not appear to handle any different transforms than the * * simple LZX-transform. Furthermore, the list of transforms * * to apply is broken, in that only half the required space * * is allocated for the list. (It appears as though the * * space is allocated for ASCII strings, but the strings are * * written as unicode. As a result, only the first half of * * the string appears.) So this is probably not too big of * * a deal, at least until CHM v4 (MS .lit files), which also * * incorporate encryption, of some description. * ***************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * * * This program is free software; you can redistribute it and/or modify * * it under the terms of the GNU Lesser General Public License as * * published by the Free Software Foundation; either version 2.1 of the * * License, or (at your option) any later version. * * * ***************************************************************************/</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> INCLUDED_CHMLIB_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> INCLUDED_CHMLIB_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> __cplusplus extern </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"C"</span></span></span><span class="hljs-meta"> { #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* RWE 6/12/1002 */</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> PPC_BSTR #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;wtypes.h&gt; #endif #ifdef WIN32 #ifdef __MINGW32__ #define __int64 long long #endif typedef unsigned __int64 LONGUINT64; typedef __int64 LONGINT64; #else typedef unsigned long long LONGUINT64; typedef long long LONGINT64; #endif /* the two available spaces in a CHM file */ /* NB: The format supports arbitrarily many spaces, but only */ /* two appear to be used at present. */ #define CHM_UNCOMPRESSED (0) #define CHM_COMPRESSED (1) /* structure representing an ITS (CHM) file stream */ struct chmFile; /* structure representing an element from an ITS file stream */ #define CHM_MAX_PATHLEN (512) struct chmUnitInfo { LONGUINT64 start; LONGUINT64 length; int space; int flags; char path[CHM_MAX_PATHLEN+1]; }; /* open an ITS archive */ #ifdef PPC_BSTR /* RWE 6/12/2003 */ struct chmFile* chm_open(BSTR filename); #else struct chmFile* chm_open(const char *filename); #endif /* close an ITS archive */ void chm_close(struct chmFile *h); /* methods for ssetting tuning parameters for particular file */ #define CHM_PARAM_MAX_BLOCKS_CACHED 0 void chm_set_param(struct chmFile *h, int paramType, int paramVal); /* resolve a particular object from the archive */ #define CHM_RESOLVE_SUCCESS (0) #define CHM_RESOLVE_FAILURE (1) int chm_resolve_object(struct chmFile *h, const char *objPath, struct chmUnitInfo *ui); /* retrieve part of an object from the archive */ LONGINT64 chm_retrieve_object(struct chmFile *h, struct chmUnitInfo *ui, unsigned char *buf, LONGUINT64 addr, LONGINT64 len); /* enumerate the objects in the .chm archive */ typedef int (*CHM_ENUMERATOR)(struct chmFile *h, struct chmUnitInfo *ui, void *context); #define CHM_ENUMERATE_NORMAL (1) #define CHM_ENUMERATE_META (2) #define CHM_ENUMERATE_SPECIAL (4) #define CHM_ENUMERATE_FILES (8) #define CHM_ENUMERATE_DIRS (16) #define CHM_ENUMERATE_ALL (31) #define CHM_ENUMERATOR_FAILURE (0) #define CHM_ENUMERATOR_CONTINUE (1) #define CHM_ENUMERATOR_SUCCESS (2) int chm_enumerate(struct chmFile *h, int what, CHM_ENUMERATOR e, void *context); int chm_enumerate_dir(struct chmFile *h, const char *prefix, int what, CHM_ENUMERATOR e, void *context); #ifdef __cplusplus } #endif #endif /* INCLUDED_CHMLIB_H */</span></span></span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  Ù„Ù†Ø¨Ø¯Ø£ Ø¨Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØŒ Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ¯Ø¹ÙŠ chm_open () ÙÙŠ Ø§Ù„Ù…Ù†Ø´Ø¦ ØŒ Ùˆ chm_close () ÙÙŠ Ø§Ù„Ù…Ø¯Ù…Ø±. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chm_open</span></span></span></span>(filename: *<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c_char) -&gt; *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> chmFile; <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chm_close</span></span></span></span>(h: *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> chmFile);</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù„ØªØ¨Ø³ÙŠØ· Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ØŒ Ù†Ø³ØªØ®Ø¯Ù… <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø¥Ø±Ù‡Ø§Ø¨ Ù‡Ø°Ø§</strong></a> ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠÙ‚ÙˆÙ… Ø¨ØªÙ†ÙÙŠØ° <code>std::error::Error</code> ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cd chmlib $ cargo add thiserror</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¢Ù† ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…Ø¹Ø±ÙØ© ÙƒÙŠÙÙŠØ© ØªØ­ÙˆÙŠÙ„ <code>std::path::Path</code> Ø¥Ù„Ù‰ <code>*const c_char</code> .  Ù„Ø³ÙˆØ¡ Ø§Ù„Ø­Ø¸ ØŒ Ù‡Ø°Ø§ Ù„ÙŠØ³ Ø¨Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø³Ù‡Ù„ Ø¨Ø³Ø¨Ø¨ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ù†ÙƒØ§Øª</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ù…Ø®ØªÙ„ÙØ©</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ø§Ù„Ù…ØªÙˆØ§ÙÙ‚Ø©</a> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs use thiserror::Error; use std::{ffi::CString, path::Path}; #[cfg(unix)] fn path_to_cstring(path: &amp;Path) -&gt; Result&lt;CString, InvalidPath&gt; { use std::os::unix::ffi::OsStrExt; let bytes = path.as_os_str().as_bytes(); CString::new(bytes).map_err(|_| InvalidPath) } #[cfg(not(unix))] fn path_to_cstring(path: &amp;Path) -&gt; Result&lt;CString, InvalidPath&gt; { //  ,  Windows CHMLib  CreateFileA(),   //       ASCII.   ...   // ,          ? let rust_str = path.as_os_str().as_str().ok_or(InvalidPath)?; CString::new(rust_str).map_err(|_| InvalidPath) } #[derive(Error, Debug, Copy, Clone, PartialEq)] #[error("Invalid Path")] pub struct InvalidPath;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¢Ù† ØªØ­Ø¯ÙŠØ¯ Ù‡ÙŠÙƒÙ„ <strong>ChmFile</strong> .  ÙŠÙ‚ÙˆÙ… Ø¨ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ø´Ø± ØºÙŠØ± ÙØ§Ø±ØºØ© Ø¥Ù„Ù‰ chmlib_sys :: chmFile.  Ø¥Ø°Ø§ Ø£Ø±Ø¬Ø¹Øª chm_open () Ù…Ø¤Ø´Ø±Ù‹Ø§ Ø®Ø§Ù„ÙŠÙ‹Ø§ ØŒ ÙÙ‡Ø°Ø§ ÙŠØ¹Ù†ÙŠ Ø£Ù†Ù‡Ø§ Ù„Ø§ ØªØ³ØªØ·ÙŠØ¹ ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¨Ø³Ø¨Ø¨ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø®Ø·Ø£. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs use std::{ffi::CString, path::Path, ptr::NonNull}; #[derive(Debug)] pub struct ChmFile { raw: NonNull&lt;chmlib_sys::chmFile&gt;, } impl ChmFile { pub fn open&lt;P: AsRef&lt;Path&gt;&gt;(path: P) -&gt; Result&lt;ChmFile, OpenError&gt; { let c_path = path_to_cstring(path.as_ref())?; // ,   c_path  unsafe { let raw = chmlib_sys::chm_open(c_path.as_ptr()); match NonNull::new(raw) { Some(raw) =&gt; Ok(ChmFile { raw }), None =&gt; Err(OpenError::Other), } } } } impl Drop for ChmFile { fn drop(&amp;mut self) { unsafe { chmlib_sys::chm_close(self.raw.as_ptr()); } } } /// The error returned when we are unable to open a [`ChmFile`]. #[derive(Error, Debug, Copy, Clone, PartialEq)] pub enum OpenError { #[error("Invalid path")] InvalidPath(#[from] InvalidPath), #[error("Unable to open the ChmFile")] Other, }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ØªØ³Ø±Ø¨ Ù„Ù„Ø°Ø§ÙƒØ±Ø© ØŒ Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ· ØªØ­Øª <strong>Valgrind</strong> .  Ø³ÙˆÙ ÙŠÙ‚ÙˆÙ… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ChmFile ÙˆØ¥Ø·Ù„Ø§Ù‚Ù‡ Ø¹Ù„Ù‰ Ø§Ù„ÙÙˆØ±. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs #[test] fn open_valid_chm_file() { let sample = sample_path(); //   let chm_file = ChmFile::open(&amp;sample).unwrap(); //      drop(chm_file); } fn sample_path() -&gt; PathBuf { let project_dir = Path::new(env!("CARGO_MANIFEST_DIR")); let sample = project_dir.parent().unwrap().join("topics.classic.chm"); assert!(sample.exists()); sample }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙŠÙ‚ÙˆÙ„ Valgrind Ø¥Ù†Ù‡ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø°Ø§ÙƒØ±Ø© Ù…ÙÙ‚ÙˆØ¯Ø©: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ valgrind ../target/debug/deps/chmlib-8d8c740d578324 open_valid_chm_file ==8953== Memcheck, a memory error detector ==8953== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al. ==8953== Using Valgrind-3.14.0 and LibVEX; rerun with -h for copyright info ==8953== Command: ~/chmlib/target/debug/deps/chmlib-8d8c740d578324 open_valid_chm_file ==8953== running 1 test test tests::open_valid_chm_file ... ok test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out ==8953== ==8953== HEAP SUMMARY: ==8953== in use at exit: 0 bytes in 0 blocks ==8953== total heap usage: 249 allocs, 249 frees, 43,273 bytes allocated ==8953== ==8953== All heap blocks were freed -- no leaks are possible ==8953== ==8953== For counts of detected and suppressed errors, rerun with: -v ==8953== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)</code> </pre> <br><h3 id="poisk-elementov-po-imeni" style=";text-align:right;direction:rtl">  Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø§Ù„Ø§Ø³Ù… </h3><br><p style=";text-align:right;direction:rtl">  Ø§Ù„ØªØ§Ù„ÙŠ ÙÙŠ Ø§Ù„Ø³Ø·Ø± Ù‡Ùˆ ÙˆØ¸ÙŠÙØ© chm_resolve_object (): </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CHM_RESOLVE_SUCCESS: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CHM_RESOLVE_FAILURE: <span class="hljs-built_in"><span class="hljs-built_in">u32</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* resolve a particular object from the archive */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-string"><span class="hljs-string">"C"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chm_resolve_object</span></span></span></span>( h: *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> chmFile, objPath: *<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> c_char, ui: *<span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> chmUnitInfo ) -&gt; c_int;</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ø¯ ØªÙØ´Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨Ø­Ø« ØŒ Ù„Ø°Ù„Ùƒ ØªÙ‚ÙˆÙ… chm_resolve_object () Ø¨Ø¥Ø±Ø¬Ø§Ø¹ Ø±Ù…Ø² Ø®Ø·Ø£ Ù„Ù„Ø¥Ø¨Ù„Ø§Øº Ø¹Ù† Ø§Ù„Ù†Ø¬Ø§Ø­ Ø£Ùˆ Ø§Ù„ÙØ´Ù„ ØŒ ÙˆØ³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­ÙˆÙ„ Ø§Ù„ÙƒØ§Ø¦Ù† Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø°ÙŠ ØªÙ… ØªÙ…Ø±ÙŠØ±Ù‡ Ø¥Ù„Ù‰ <strong>chmUnitInfo</strong> . </p><br><p style=";text-align:right;direction:rtl">  ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†ÙˆØ¹ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>std::mem::MaybeUninit</code></a> ÙÙ‚Ø· <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>std::mem::MaybeUninit</code></a> Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© Ø®Ø§Ø±Ø¬ <strong>ui</strong> . </p><br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø¢Ù† ØŒ Ø¯Ø¹Ù†Ø§ Ù†ØªØ±Ùƒ Ø¨Ù†ÙŠØ© UnitInfo ÙØ§Ø±ØºØ© - Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ù…ÙƒØ§ÙØ¦ Ø§Ù„ØµØ¯Ø£ Ù„Ù‡ÙŠÙƒÙ„ chmUnitInfo C.  Ø³Ù†Ø¶ÙŠÙ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¹Ù†Ø¯Ù…Ø§ Ù†Ø¨Ø¯Ø£ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† ChmFile. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs impl ChmFile { ... /// Find a particular object in the archive. pub fn find&lt;P: AsRef&lt;Path&gt;&gt;(&amp;mut self, path: P) -&gt; Option&lt;UnitInfo&gt; { let path = path_to_cstring(path.as_ref()).ok()?; unsafe { //   chmUnitInfo   let mut resolved = MaybeUninit::&lt;chmlib_sys::chmUnitInfo&gt;::uninit(); //  -  let ret = chmlib_sys::chm_resolve_object( self.raw.as_ptr(), path.as_ptr(), resolved.as_mut_ptr(), ); if ret == chmlib_sys::CHM_RESOLVE_SUCCESS { //    "resolved"   Some(UnitInfo::from_raw(resolved.assume_init())) } else { None } } } } #[derive(Debug)] pub struct UnitInfo; impl UnitInfo { fn from_raw(ui: chmlib_sys::chmUnitInfo) -&gt; UnitInfo { UnitInfo } }</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  Ù„Ø§Ø­Ø¸ Ø£Ù† ChmFile :: find () ÙŠÙ‚Ø¨Ù„ <strong><code>&amp;mut self</code></strong> ØŒ Ø¹Ù„Ù‰ Ø§Ù„Ø±ØºÙ… Ù…Ù† Ø£Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Rast Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØºÙŠÙŠØ± ØµØ±ÙŠØ­ ÙÙŠ Ø§Ù„Ø­Ø§Ù„Ø©.  Ø§Ù„Ø­Ù‚ÙŠÙ‚Ø© Ù‡ÙŠ Ø£Ù† ØªØ·Ø¨ÙŠÙ‚ C ÙŠØ³ØªØ®Ø¯Ù… ÙƒÙ„ Ø£Ù†ÙˆØ§Ø¹ fseek () Ù„Ù„ØªÙ†Ù‚Ù„ Ø­ÙˆÙ„ Ø§Ù„Ù…Ù„Ù ØŒ ÙˆØ¨Ø§Ù„ØªØ§Ù„ÙŠ ÙØ¥Ù† Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© Ù„Ø§ ØªØ²Ø§Ù„ ØªØªØºÙŠØ± Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø­Ø«. </blockquote><p style=";text-align:right;direction:rtl">  Ø¯Ø¹ÙˆÙ†Ø§ Ù†ØªØ­Ù‚Ù‚ Ù…Ù† ChmFile :: find () ÙÙŠ Ø§Ù„Ù…Ù„Ù Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠ Ø§Ù„Ø°ÙŠ Ù‚Ù…Ù†Ø§ Ø¨ØªÙ†Ø²ÙŠÙ„Ù‡ Ù…Ø³Ø¨Ù‚Ù‹Ø§: </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs #[test] fn find_an_item_in_the_sample() { let sample = sample_path(); let chm = ChmFile::open(&amp;sample).unwrap(); assert!(chm.find("/BrowserView.html").is_some()); assert!(chm.find("doesn't exist.txt").is_none()); }</span></span></code> </pre> <br><h3 id="obhod-elementov-po-filtru" style=";text-align:right;direction:rtl">  ØªØµÙÙŠØ© Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø§Ù„ØªÙØ§ÙÙŠØ© </h3><br><p style=";text-align:right;direction:rtl">  ÙŠÙˆÙØ± CHMLib ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙŠØ§Øª Ù…Ù„Ù CHM Ù…Ù† Ø®Ù„Ø§Ù„ Ù…Ø±Ø´Ø­ Ù‚Ù†Ø§Ø¹ Ø¨Øª. </p><br><p style=";text-align:right;direction:rtl">  Ø®Ø° ØµÙ†Ø¯ÙˆÙ‚ Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø¨Øª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ù‚Ù†Ø¹Ø© ÙˆØ§Ù„Ø£Ø¹Ù„Ø§Ù…: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cargo add bitflags Updating 'https://github.com/rust-lang/crates.io-index' index Adding bitflags v1.2.1 to dependencies</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙˆØ­Ø¯Ø¯ Ø®Ø§Ù†Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± <strong>ØªØµÙÙŠØ©</strong> Ø§Ø³ØªÙ†Ø§Ø¯Ù‹Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ø«ÙˆØ§Ø¨Øª Ù…Ù† chm_lib.h: </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs bitflags::bitflags! { pub struct Filter: c_int { /// A normal file. const NORMAL = chmlib_sys::CHM_ENUMERATE_NORMAL as c_int; /// A meta file (typically used by the CHM system). const META = chmlib_sys::CHM_ENUMERATE_META as c_int; /// A special file (starts with `#` or `$`). const SPECIAL = chmlib_sys::CHM_ENUMERATE_SPECIAL as c_int; /// It's a file. const FILES = chmlib_sys::CHM_ENUMERATE_FILES as c_int; /// It's a directory. const DIRS = chmlib_sys::CHM_ENUMERATE_DIRS as c_int; } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø­ØªØ§Ø¬ Ø£ÙŠØ¶Ù‹Ø§ Ø¥Ù„Ù‰ Ù…Ø­ÙˆÙ„ <code>extern "C"</code> Ù„Ø¥ØºÙ„Ø§Ù‚Ø§Øª Rastovyh ØŒ ÙˆØ§Ù„Ø°ÙŠ ÙŠÙ…ÙƒÙ† ØªÙ…Ø±ÙŠØ±Ù‡ Ø¥Ù„Ù‰ C ÙÙŠ Ø´ÙƒÙ„ Ù…Ø¤Ø´Ø± Ø¥Ù„Ù‰ Ø¯Ø§Ù„Ø©: </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs unsafe extern "C" fn function_wrapper&lt;F&gt;( file: *mut chmlib_sys::chmFile, unit: *mut chmlib_sys::chmUnitInfo, state: *mut c_void, ) -&gt; c_int where F: FnMut(&amp;mut ChmFile, UnitInfo) -&gt; Continuation, { //      FFI- let result = panic::catch_unwind(|| { //   ManuallyDrop    `&amp;mut ChmFile` //        ( double-free). let mut file = ManuallyDrop::new(ChmFile { raw: NonNull::new_unchecked(file), }); let unit = UnitInfo::from_raw(unit.read()); //  state      let closure = &amp;mut *(state as *mut F); closure(&amp;mut file, unit) }); match result { Ok(Continuation::Continue) =&gt; { chmlib_sys::CHM_ENUMERATOR_CONTINUE as c_int }, Ok(Continuation::Stop) =&gt; chmlib_sys::CHM_ENUMERATOR_SUCCESS as c_int, Err(_) =&gt; chmlib_sys::CHM_ENUMERATOR_FAILURE as c_int, } }</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  ÙŠØ­ØªÙˆÙŠ <code>function_wrapper</code> Ø¹Ù„Ù‰ Ø±Ù…Ø² ØºÙŠØ± Ø¢Ù…Ù† ØµØ¹Ø¨ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ÙŠØ¬Ø¨ Ø£Ù†</strong> ÙŠØ´ÙŠØ± Ù…Ø¤Ø´Ø± <code>state</code> Ø¥Ù„Ù‰ Ù…Ø«ÙŠÙ„ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ F. </li><li style=";text-align:right;direction:rtl">  Ø±Ù…Ø² Ø§Ù„Ø±Ø§Ø³ØªØ§ ØªÙ†ÙÙŠØ°Ù‡Ø§ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥ØºÙ„Ø§Ù‚ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØ³Ø¨Ø¨ Ø§Ù„Ø°Ø¹Ø±.  Ù„Ø§ ÙŠÙ†Ø¨ØºÙŠ Ø£Ù† ÙŠØ¹Ø¨Ø± Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø¨ÙŠÙ† Rast Ùˆ C ØŒ Ù„Ø£Ù† Ø§Ù„ØªØ±ÙˆÙŠØ¬ Ø§Ù„Ù…ÙƒØ¯Ø³ Ø¨Ù„ØºØ§Øª Ù…Ø®ØªÙ„ÙØ© Ù‡Ùˆ Ø³Ù„ÙˆÙƒ ØºÙŠØ± Ù…Ø­Ø¯Ø¯.  ÙŠØ¬Ø¨ Ø§Ø¹ØªØ±Ø§Ø¶ Ø§Ù„Ø°Ø¹Ø± Ø§Ù„Ù…Ø­ØªÙ…Ù„ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… <code>std::panic::catch_unwind()</code> . </li><li style=";text-align:right;direction:rtl">  ÙŠØªÙ… Ø£ÙŠØ¶Ù‹Ø§ ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ø´Ø± Ø¥Ù„Ù‰ chmlib_sys :: chmFile Ù…Ø±Øª Ø¥Ù„Ù‰ function_wrapper ÙÙŠ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ChmFile.  Ø®Ù„Ø§Ù„ Ù…Ø¯Ø© Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© ØŒ ÙŠØ¬Ø¨ Ø¹Ù„ÙŠÙƒ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ ÙÙ‚Ø· Ù‡Ùˆ Ø§Ù„Ø°ÙŠ ÙŠÙ…ÙƒÙ†Ù‡ Ù…Ø¹Ø§Ù„Ø¬Ø© chmlib_sys :: chmFile ØŒ ÙˆØ¥Ù„Ø§ ÙÙ‚Ø¯ ØªØ­Ø¯Ø« Ø­Ø§Ù„Ø© Ø³Ø¨Ø§Ù‚. </li><li style=";text-align:right;direction:rtl">  ÙŠØ­ØªØ§Ø¬ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚ Ø¥Ù„Ù‰ ØªÙ…Ø±ÙŠØ± <code>&amp;mut ChmFile</code> ØŒ ÙˆÙ„Ù‡Ø°Ø§ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø¦Ù† Ù…Ø¤Ù‚Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØ¯Ø³ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯.  ÙˆÙ…Ø¹ Ø°Ù„Ùƒ ØŒ Ø¥Ø°Ø§ ÙƒØ§Ù† destructor ChmFile ÙŠØ¹Ù…Ù„ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø© ØŒ ÙØ³ÙŠØªÙ… ØªØ­Ø±ÙŠØ± chmlib_sys :: chmFile ÙÙŠ ÙˆÙ‚Øª Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ù‹Ø§.  Ù„Ø­Ù„ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© ØŒ ÙŠÙˆØ¬Ø¯ <code>std::mem::ManuallyDrop</code> . </li></ul><br></blockquote><p style=";text-align:right;direction:rtl">  Ù‡Ø°Ø§ Ù‡Ùˆ ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… <code>ChmFile::for_each()</code> Ù„ØªØ·Ø¨ÙŠÙ‚ <code>ChmFile::for_each()</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs impl ChmFile { ... /// Inspect each item within the [`ChmFile`]. pub fn for_each&lt;F&gt;(&amp;mut self, filter: Filter, mut cb: F) where F: FnMut(&amp;mut ChmFile, UnitInfo) -&gt; Continuation, { unsafe { chmlib_sys::chm_enumerate( self.raw.as_ptr(), filter.bits(), Some(function_wrapper::&lt;F&gt;), &amp;mut cb as *mut _ as *mut c_void, ); } } /// Inspect each item within the [`ChmFile`] inside a specified directory. pub fn for_each_item_in_dir&lt;F, P&gt;( &amp;mut self, filter: Filter, prefix: P, mut cb: F, ) where P: AsRef&lt;Path&gt;, F: FnMut(&amp;mut ChmFile, UnitInfo) -&gt; Continuation, { let path = match path_to_cstring(prefix.as_ref()) { Ok(p) =&gt; p, Err(_) =&gt; return, }; unsafe { chmlib_sys::chm_enumerate_dir( self.raw.as_ptr(), path.as_ptr(), filter.bits(), Some(function_wrapper::&lt;F&gt;), &amp;mut cb as *mut _ as *mut c_void, ); } } }</span></span></code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  Ù„Ø§Ø­Ø¸ ÙƒÙŠÙÙŠØ© ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø¹Ù„Ù…Ø© F Ù…Ø¹ Ø¯Ø§Ù„Ø© function_wrapper Ø§Ù„Ø¹Ø§Ù…Ø©.  ØºØ§Ù„Ø¨Ù‹Ø§ Ù…Ø§ ØªØ³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø¹Ù†Ø¯Ù…Ø§ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªÙ…Ø±ÙŠØ± Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµØ¯Ø£ Ø¹Ø¨Ø± FFI Ø¥Ù„Ù‰ Ø±Ù…Ø² Ø¨Ù„ØºØ© Ø£Ø®Ø±Ù‰. </blockquote><br><h3 id="chtenie-soderzhimogo-faylov" style=";text-align:right;direction:rtl">  Ù‚Ø±Ø§Ø¡Ø© Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ù„Ù </h3><br><p style=";text-align:right;direction:rtl">  Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø© Ø§Ù„ØªÙŠ Ù†Ø­ØªØ§Ø¬Ù‡Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù ÙØ¹Ù„ÙŠÙ‹Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… chm_retrieve_object (). </p><br><p style=";text-align:right;direction:rtl">  ØªÙ†ÙÙŠØ°Ù‡ Ù‡Ùˆ ØªØ§ÙÙ‡Ø© Ø¬Ø¯Ø§.  ÙŠØ´Ø¨Ù‡ Ù‡Ø°Ø§ Ø³Ù…Ø© std :: io :: Read Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ÙŠØ© ØŒ Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø¥Ø²Ø§Ø­Ø© Ù…Ù„Ù ØµØ±ÙŠØ­. </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs impl ChmFile { ... pub fn read( &amp;mut self, unit: &amp;UnitInfo, offset: u64, buffer: &amp;mut [u8], ) -&gt; Result&lt;usize, ReadError&gt; { let mut unit = unit.0.clone(); let bytes_written = unsafe { chmlib_sys::chm_retrieve_object( self.raw.as_ptr(), &amp;mut unit, buffer.as_mut_ptr(), offset, buffer.len() as _, ) }; if bytes_written &gt;= 0 { Ok(bytes_written as usize) } else { Err(ReadError) } } } #[derive(Error, Debug, Copy, Clone, PartialEq)] #[error("The read failed")] pub struct ReadError;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¨Ø§Ù„Ø·Ø¨Ø¹ ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø¬ÙŠØ¯ Ø£Ù† ÙŠÙƒÙˆÙ† Ù„Ø¯ÙŠÙƒ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø£ÙƒØ«Ø± ØªÙØµÙŠÙ„Ø§Ù‹ Ù…Ù† "ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©" ØŒ ÙˆÙ„ÙƒÙ† Ø¥Ø°Ø§ Ø­ÙƒÙ…Ù†Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø´ÙØ±Ø© Ø§Ù„Ù…ØµØ¯Ø± ØŒ ÙØ¥Ù† chm_retrieve_object () Ù„Ø§ ÙŠÙ…ÙŠØ² Ø¨Ø´ÙƒÙ„ Ø®Ø§Øµ Ø¨ÙŠÙ† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Ø¥Ø±Ø¬Ø§Ø¹ 0 Ø¹Ù†Ø¯ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø› </li><li style=";text-align:right;direction:rtl">  Ø¨Ø¥Ø±Ø¬Ø§Ø¹ 0 Ù„Ù„ÙˆØ³Ø§Ø¦Ø· ØºÙŠØ± Ø§Ù„ØµØ§Ù„Ø­Ø©: Ù…Ø¤Ø´Ø±Ø§Øª ÙØ§Ø±ØºØ© Ø£Ùˆ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø­Ø¯ÙˆØ¯Ø› </li><li style=";text-align:right;direction:rtl">  Ø¥Ø±Ø¬Ø§Ø¹ âˆ’1 Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù†Ø¸Ø§Ù… (ÙˆÙŠÙ…Ù„Ø£ errno) Ø› </li><li style=";text-align:right;direction:rtl">  ØªÙ‚ÙˆÙ… Ø¨Ø¥Ø±Ø¬Ø§Ø¹ âˆ’1 Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø¶ØºØ· ØŒ Ø¯ÙˆÙ† Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø¨ÙŠÙ† ØªÙ„Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ùˆ ØŒ Ø¹Ù„Ù‰ Ø³Ø¨ÙŠÙ„ Ø§Ù„Ù…Ø«Ø§Ù„ ØŒ Ø¹Ø¯Ù… Ø§Ù„Ù‚Ø¯Ø±Ø© Ø¹Ù„Ù‰ ØªØ®ØµÙŠØµ Ø°Ø§ÙƒØ±Ø© Ù„Ù…Ø®Ø²Ù† Ù…Ø¤Ù‚Øª Ù…Ø¤Ù‚Øª Ø¹Ø¨Ø± malloc (). </li></ul><br><p style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø®ØªØ¨Ø§Ø± ChmFile :: read () Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„ÙØ§Øª Ø°Ø§Øª Ù…Ø­ØªÙˆÙŠØ§Øª Ù…Ø¹Ø±ÙˆÙØ©: </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/src/lib.rs #[test] fn read_an_item() { let sample = sample_path(); let mut chm = ChmFile::open(&amp;sample).unwrap(); let filename = "/template/packages/core-web/css/index.responsive.css"; //        let item = chm.find(filename).unwrap(); //      let mut buffer = vec![0; item.length() as usize]; let bytes_written = chm.read(&amp;item, 0, &amp;mut buffer).unwrap(); //      assert_eq!(bytes_written, item.length() as usize); // ...  ,    let got = String::from_utf8(buffer).unwrap(); assert!(got.starts_with( "html, body, div#i-index-container, div#i-index-body" )); }</span></span></code> </pre> <br><h2 id="dobavlyaem-primery" style=";text-align:right;direction:rtl">  Ø£Ø¶Ù Ø£Ù…Ø«Ù„Ø© </h2><br><p style=";text-align:right;direction:rtl">  Ù„Ù‚Ø¯ ØºØ·ÙŠÙ†Ø§ Ù…Ø¹Ø¸Ù… ÙˆØ§Ø¬Ù‡Ø§Øª Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…ÙƒØªØ¨Ø© CHMLib ÙˆÙƒØ«ÙŠØ± Ù…Ù†Ù‡Ø§ Ù‚Ø¯ Ø§Ù†ØªÙ‡Ù‰ Ù…Ù† Ø°Ù„Ùƒ ØŒ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø£Ù† Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù†Ù‚Ù„ Ø³ØªÙƒØªÙ…Ù„ Ø¨Ù†Ø¬Ø§Ø­.  ÙˆÙ…Ø¹ Ø°Ù„Ùƒ ØŒ Ø³ÙŠÙƒÙˆÙ† Ù…Ù† Ø§Ù„Ø¬ÙŠØ¯ Ø¬Ø¹Ù„ Ø±ÙÙ†Ø§ Ø£ÙƒØ«Ø± Ø³Ù‡ÙˆÙ„Ø© ÙÙŠ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….        â€”  ,    Rust  Go       ( ,  <em>rustdoc</em>  <em>godoc</em>     ). </p><br><p style=";text-align:right;direction:rtl">  ,  CHMLib    ,        . </p><br><p style=";text-align:right;direction:rtl">       , ,         . </p><br><h3 id="oglavlenie-chm-fayla" style=";text-align:right;direction:rtl">  CHM- </h3><br><p style=";text-align:right;direction:rtl">    CHM-         . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">   </b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* $Id: enum_chmLib.c,v 1.7 2002/10/09 12:38:12 jedwin Exp $ */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * enum_chmLib.c - CHM archive test driver * * ------------------- * * * * author: Jed Wing &lt;jedwin@ugcs.caltech.edu&gt; * * notes: This is a quick-and-dirty test driver for the chm lib * * routines. The program takes as its input the paths to one * * or more .chm files. It attempts to open each .chm file in * * turn, and display a listing of all of the files in the * * archive. * * * * It is not included as a particularly useful program, but * * rather as a sort of "simplest possible" example of how to * * use the enumerate portion of the API. * ***************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * * * This program is free software; you can redistribute it and/or modify * * it under the terms of the GNU Lesser General Public License as * * published by the Free Software Foundation; either version 2.1 of the * * License, or (at your option) any later version. * * * ***************************************************************************/</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"chm_lib.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; /* * callback function for enumerate API */ int _print_ui(struct chmFile *h, struct chmUnitInfo *ui, void *context) { static char szBuf[128]; memset(szBuf, 0, 128); if(ui-&gt;flags &amp; CHM_ENUMERATE_NORMAL) strcpy(szBuf, "normal "); else if(ui-&gt;flags &amp; CHM_ENUMERATE_SPECIAL) strcpy(szBuf, "special "); else if(ui-&gt;flags &amp; CHM_ENUMERATE_META) strcpy(szBuf, "meta "); if(ui-&gt;flags &amp; CHM_ENUMERATE_DIRS) strcat(szBuf, "dir"); else if(ui-&gt;flags &amp; CHM_ENUMERATE_FILES) strcat(szBuf, "file"); printf(" %1d %8d %8d %s\t\t%s\n", (int)ui-&gt;space, (int)ui-&gt;start, (int)ui-&gt;length, szBuf, ui-&gt;path); return CHM_ENUMERATOR_CONTINUE; } int main(int c, char **v) { struct chmFile *h; int i; for (i=1; i&lt;c; i++) { h = chm_open(v[i]); if (h == NULL) { fprintf(stderr, "failed to open %s\n", v[i]); exit(1); } printf("%s:\n", v[i]); printf(" spc start length type\t\t\tname\n"); printf(" === ===== ====== ====\t\t\t====\n"); if (! chm_enumerate(h, CHM_ENUMERATE_ALL, _print_ui, NULL)) printf(" *** ERROR ***\n"); chm_close(h); } return 0; }</span></span></span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  _print_ui()    Rust.         UnitInfo  ,      ,     . </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/examples/enumerate-items.rs fn describe_item(item: UnitInfo) { let mut description = String::new(); if item.is_normal() { description.push_str("normal "); } else if item.is_special() { description.push_str("special "); } else if item.is_meta() { description.push_str("meta "); } if item.is_dir() { description.push_str("dir"); } else if item.is_file() { description.push_str("file"); } println!( " {} {:8} {:8} {}\t\t{}", item.space(), item.start(), item.length(), description, item.path().unwrap_or(Path::new("")).display() ); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  main()       ,  ,   describe_item()  ChmFile::for_each(). </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/examples/enumerate-items.rs fn main() { let filename = env::args() .nth(1) .unwrap_or_else(|| panic!("Usage: enumerate-items &lt;filename&gt;")); let mut file = ChmFile::open(&amp;filename).expect("Unable to open the file"); println!("{}:", filename); println!(" spc start length type\t\t\tname"); println!(" === ===== ====== ====\t\t\t===="); file.for_each(Filter::all(), |_file, item| { describe_item(item); Continuation::Continue }); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">          : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cargo run --example enumerate-items topics.classic.chm &gt; rust-example.txt $ cd vendor/CHMLib/src $ clang chm_lib.c enum_chmLib.c lzx.c -o enum_chmLib $ cd ../../.. $ ./vendor/CHMLib/src/enum_chmLib topics.classic.chm &gt; c-example.txt $ diff -u rust-example.txt c-example.txt $ echo $? 0</code> </pre> <br><p style=";text-align:right;direction:rtl"> diff ,   ,   ,     ,    .    -   ,     diff. </p><br><pre style=";text-align:right;direction:rtl"> <code class="diff hljs">diff --git a/chmlib/examples/enumerate-items.rs b/chmlib/examples/enumerate-items.rs index e68fa58..ef855ac 100644 --- a/chmlib/examples/enumerate-items.rs +++ b/chmlib/examples/enumerate-items.rs @@ -36,6 +36,10 @@ fn describe_item(item: UnitInfo) { description.push_str("file"); } + if item.length() % 7 == 0 { + description.push_str(" :)"); + } + println!( " {} {:8} {:8} {}\t\t{}", item.space(),</code> </pre> <br><p style=";text-align:right;direction:rtl">     : </p><br><pre style=";text-align:right;direction:rtl"> <code class="diff hljs">$ cargo run --example enumerate-items topics.classic.chm &gt; rust-example.txt $ diff -u rust-example.txt c-example.txt --- rust-example.txt 2019-10-20 16:51:53.933560892 +0800 +++ c-example.txt 2019-10-20 16:40:42.007053966 +0800 @@ -1,9 +1,9 @@ topics.classic.chm: spc start length type name <span class="hljs-comment"><span class="hljs-comment">=== ===== ====== ==== ==== - 0 0 0 normal dir :) / + 0 0 0 normal dir / 1 5125797 4096 special file /#IDXHDR - 0 0 0 special file :) /#ITBITS + 0 0 0 special file /#ITBITS 1 5104520 148 special file /#IVB 1 5132009 1227 special file /#STRINGS 0 1430 4283 special file /#SYSTEM @@ -13,9 +13,9 @@ ...</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> ! </p><br><h3 id="raspakovka-chm-fayla-na-disk" style=";text-align:right;direction:rtl">  CHM-   </h3><br><p style=";text-align:right;direction:rtl">  ,     CHMLib,   Â«Â»   . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">   </b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* $Id: extract_chmLib.c,v 1.4 2002/10/10 03:24:51 jedwin Exp $ */</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * extract_chmLib.c - CHM archive extractor * * ------------------- * * * * author: Jed Wing &lt;jedwin@ugcs.caltech.edu&gt; * * notes: This is a quick-and-dirty chm archive extractor. * ***************************************************************************/</span></span> <span class="hljs-comment"><span class="hljs-comment">/*************************************************************************** * * * This program is free software; you can redistribute it and/or modify * * it under the terms of the GNU Lesser General Public License as * * published by the Free Software Foundation; either version 2.1 of the * * License, or (at your option) any later version. * * * ***************************************************************************/</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"chm_lib.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; #ifdef WIN32 #include &lt;windows.h&gt; #include &lt;direct.h&gt; #define mkdir(X, Y) _mkdir(X) #define snprintf _snprintf #else #include &lt;unistd.h&gt; #include &lt;sys/stat.h&gt; #include &lt;sys/types.h&gt; #endif struct extract_context { const char *base_path; }; static int dir_exists(const char *path) { #ifdef WIN32 /* why doesn't this work?!? */ HANDLE hFile; hFile = CreateFileA(path, FILE_LIST_DIRECTORY, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL); if (hFile != INVALID_HANDLE_VALUE) { CloseHandle(hFile); return 1; } else return 0; #else struct stat statbuf; if (stat(path, &amp;statbuf) != -1) return 1; else return 0; #endif } static int rmkdir(char *path) { /* * strip off trailing components unless we can stat the directory, or we * have run out of components */ char *i = strrchr(path, '/'); if(path[0] == '\0' || dir_exists(path)) return 0; if (i != NULL) { *i = '\0'; rmkdir(path); *i = '/'; mkdir(path, 0777); } #ifdef WIN32 return 0; #else if (dir_exists(path)) return 0; else return -1; #endif } /* * callback function for enumerate API */ int _extract_callback(struct chmFile *h, struct chmUnitInfo *ui, void *context) { LONGUINT64 ui_path_len; char buffer[32768]; struct extract_context *ctx = (struct extract_context *)context; char *i; if (ui-&gt;path[0] != '/') return CHM_ENUMERATOR_CONTINUE; /* quick hack for security hole mentioned by Sven Tantau */ if (strstr(ui-&gt;path, "/../") != NULL) { /* fprintf(stderr, "Not extracting %s (dangerous path)\n", ui-&gt;path); */ return CHM_ENUMERATOR_CONTINUE; } if (snprintf(buffer, sizeof(buffer), "%s%s", ctx-&gt;base_path, ui-&gt;path) &gt; 1024) return CHM_ENUMERATOR_FAILURE; /* Get the length of the path */ ui_path_len = strlen(ui-&gt;path)-1; /* Distinguish between files and dirs */ if (ui-&gt;path[ui_path_len] != '/' ) { FILE *fout; LONGINT64 len, remain=ui-&gt;length; LONGUINT64 offset = 0; printf("--&gt; %s\n", ui-&gt;path); if ((fout = fopen(buffer, "wb")) == NULL) { /* make sure that it isn't just a missing directory before we abort */ char newbuf[32768]; strcpy(newbuf, buffer); i = strrchr(newbuf, '/'); *i = '\0'; rmkdir(newbuf); if ((fout = fopen(buffer, "wb")) == NULL) return CHM_ENUMERATOR_FAILURE; } while (remain != 0) { len = chm_retrieve_object(h, ui, (unsigned char *)buffer, offset, 32768); if (len &gt; 0) { fwrite(buffer, 1, (size_t)len, fout); offset += len; remain -= len; } else { fprintf(stderr, "incomplete file: %s\n", ui-&gt;path); break; } } fclose(fout); } else { if (rmkdir(buffer) == -1) return CHM_ENUMERATOR_FAILURE; } return CHM_ENUMERATOR_CONTINUE; } int main(int c, char **v) { struct chmFile *h; struct extract_context ec; if (c &lt; 3) { fprintf(stderr, "usage: %s &lt;chmfile&gt; &lt;outdir&gt;\n", v[0]); exit(1); } h = chm_open(v[1]); if (h == NULL) { fprintf(stderr, "failed to open %s\n", v[1]); exit(1); } printf("%s:\n", v[1]); ec.base_path = v[2]; if (! chm_enumerate(h, CHM_ENUMERATE_ALL, _extract_callback, (void *)&amp;ec)) printf(" *** ERROR ***\n"); chm_close(h); return 0; }</span></span></span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">               . ,     . </p><br><p style=";text-align:right;direction:rtl">     extract().    ,              . </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/examples/extract.rs fn extract( root_dir: &amp;Path, file: &amp;mut ChmFile, item: &amp;UnitInfo, ) -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; { if !item.is_file() || !item.is_normal() { //      return Ok(()); } let path = match item.path() { Some(p) =&gt; p, //     ,   None =&gt; return Ok(()), }; let mut dest = root_dir.to_path_buf(); // :  CHM       (  "/"), //     root_dir     "/". dest.extend(path.components().skip(1)); //     if let Some(parent) = dest.parent() { fs::create_dir_all(parent)?; } let mut f = File::create(dest)?; let mut start_offset = 0; // CHMLib      &amp;[u8]    (, //      ),       //      let mut buffer = vec![0; 1 &lt;&lt; 16]; loop { let bytes_read = file.read(item, start_offset, &amp;mut buffer)?; if bytes_read == 0 { //     break; } else { //      start_offset += bytes_read as u64; f.write_all(&amp;buffer)?; } } Ok(()) }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  main()  ,  extract(),         . </p><br><pre style=";text-align:right;direction:rtl"> <code class="rust hljs"><span class="hljs-comment"><span class="hljs-comment">// chmlib/examples/extract.rs fn main() { let args: Vec&lt;_&gt; = env::args().skip(1).collect(); if args.len() != 2 || args.iter().any(|arg| arg.contains("-h")) { println!("Usage: extract &lt;chm-file&gt; &lt;out-dir&gt;"); return; } let mut file = ChmFile::open(&amp;args[0]).expect("Unable to open the file"); let out_dir = PathBuf::from(&amp;args[1]); file.for_each(Filter::all(), |file, item| { match extract(&amp;out_dir, file, &amp;item) { Ok(_) =&gt; Continuation::Continue, Err(e) =&gt; { eprintln!("Error: {}", e); Continuation::Stop }, } }); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">      CHM-    HTML-,      -. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cargo run --example extract -- ./topics.classic.chm ./extracted $ tree ./extracted ./extracted â”œâ”€â”€ default.html â”œâ”€â”€ BrowserForward.html ... â”œâ”€â”€ Images â”‚ â”œâ”€â”€ Commands â”‚ â”‚ â””â”€â”€ RealWorld â”‚ â”‚ â”œâ”€â”€ BrowserBack.bmp ... â”œâ”€â”€ script â”‚ â”œâ”€â”€ _community â”‚ â”‚ â””â”€â”€ disqus.js â”‚ â”œâ”€â”€ hs-common.js ... â””â”€â”€ userinterface.html $ firefox topics.classic/default.html ( default.html  Firefox)</code> </pre> <br><p style=";text-align:right;direction:rtl">  JavaScript   ( -    Microsoft Help),   ,     . </p><br><h2 id="chto-dalshe" style=";text-align:right;direction:rtl">  Ù…Ø§ Ø§Ù„ØªØ§Ù„ÙŠØŸ </h2><br><p style=";text-align:right;direction:rtl">  chmlib    ,    ,     crates.io. </p><br><p style=";text-align:right;direction:rtl">        : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">    ChmFile::for_each()  ChmFile::for_each_item_in_dir() ,          ,     . </li><li style=";text-align:right;direction:rtl">   ,          ChmFile       <code>Continuation::Continue</code>   . ,     <code>F: FnMut(&amp;mut ChmFile, UnitInfo) -&gt; C</code>  <code>C: Into&lt;Continuation&gt;</code> ,    <code>impl From&lt;()&gt; for Continuation</code> . </li><li style=";text-align:right;direction:rtl">      (,     extract())      ChmFile::for_each()   .         <code>impl&lt;E&gt; From&lt;Result&lt;(), E&gt;&gt; for Continuation where E: Error + 'static</code> . </li><li style=";text-align:right;direction:rtl"> -               <code>std::fs::File</code> .      ,     ChmFile::read()     - <code>std::io::Writer</code> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar474666/">https://habr.com/ru/post/ar474666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar474654/index.html">Ù…ØµØ§ÙØ­Ø© SSH Ø¨ÙƒÙ„Ù…Ø§Øª Ø¨Ø³ÙŠØ·Ø©.</a></li>
<li><a href="../ar474656/index.html">Reversim MIPS Ùˆ Golang - Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ø¹ÙƒØ³. Ø­Ù„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ù„Ù„Ø§Ù†Ø¹ÙƒØ§Ø³ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… r0ot-mi. Ø§Ù„Ø¬Ø²Ø¡ 2</a></li>
<li><a href="../ar474658/index.html">Ø£Ù„Ù… Ø§Ù„Ù…Ø¹ØµÙ… ÙˆÙØ¦Ø±Ø§Ù† Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</a></li>
<li><a href="../ar474662/index.html">Ø§Ø®ØªØ¨Ø§Ø± ØªØ¬Ø±ÙŠØ¨ÙŠ: Devdiction for Developers - Ù…Ù†ØµØ© Ù„ØªØ¹Ù„Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</a></li>
<li><a href="../ar474664/index.html">Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ù†ØªØ¨Ø§Ù‡ ØŒ ÙØ¥Ù† Ø¹Ù‚ÙˆÙ„Ù†Ø§ Ù„Ø§ ØªØ²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ±ÙƒÙŠØ² ØŒ ÙˆÙ„ÙƒÙ†Ù‡Ø§ ØªØ³ØªØ®Ø¯Ù… Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</a></li>
<li><a href="../ar474668/index.html">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª GitHub Ù…Ø«Ù„ CI / CD Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ù…ÙˆÙ„Ø¯ Ø«Ø§Ø¨Øª ÙˆØµÙØ­Ø§Øª GitHub</a></li>
<li><a href="../ar474672/index.html">React ØŒ JSX ØŒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ­Ø¯Ø§Øª ES (Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ) ÙÙŠ Ù…Ø³ØªØ¹Ø±Ø¶ Ø¨Ø¯ÙˆÙ† Webpack</a></li>
<li><a href="../ar474674/index.html">Ø¢Ù„Ø© Ø§Ù„Ø±Ø¤ÙŠØ© ÙˆØ§Ù„Ø·Ø¨</a></li>
<li><a href="../ar474676/index.html">Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„ØªÙØ§Ø¹Ù„ Ù„Ù…Ø¦Ø§Øª Ø§Ù„Ø¢Ù„Ø§Ù Ù…Ù† Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„ÙØ±ÙŠØ¯Ø© Ø¹Ù„Ù‰ GPU ØŒ ÙÙŠ GLES3 Ùˆ WebGL2</a></li>
<li><a href="../ar474678/index.html">Ù‚Ø§Ù…Øª Ù…Ø¬Ù…ÙˆØ¹Ø© Ø®Ø±ÙˆÙ†ÙˆØ³ Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªÙˆØ¯Ø¹ Ù…ÙˆØ­Ø¯ Ø¨Ø£Ù…Ø«Ù„Ø© ÙÙˆÙ„ÙƒØ§Ù†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>