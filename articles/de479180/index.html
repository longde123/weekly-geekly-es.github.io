<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ≥Ô∏è üßòüèø üêî Erstellung eines Discord-bot auf .NET Core mit Bereitstellung auf einem VPS-Server ‚úåüèø üíÉüèª üêΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Khabrovchans! 

 Heute lesen Sie einen Artikel, in dem erkl√§rt wird, wie Sie einen Bot mit C # unter .NET Core erstellen und auf einen Remote-Se...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellung eines Discord-bot auf .NET Core mit Bereitstellung auf einem VPS-Server</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479180/"><img src="https://habrastorage.org/webt/4w/ke/1l/4wke1lscvblbtnjbp5xuoziadhe.jpeg"><br><br>  Hallo Khabrovchans! <br><br>  Heute lesen Sie einen Artikel, in dem erkl√§rt wird, wie Sie einen Bot mit C # unter .NET Core erstellen und auf einen Remote-Server √ºbertragen. <br><br>  Der Artikel besteht aus einem Hintergrund, einer Vorbereitungsphase, dem Schreiben von Logik und dem √úbertragen eines Bots auf einen Remote-Server. <br><br>  Ich hoffe, dieser Artikel wird vielen Anf√§ngern helfen. <br><a name="habracut"></a><br><h2>  Hintergrund </h2><br>  Alles begann in einer schlaflosen Herbstnacht, die ich auf dem Discord-Server verbracht habe.  Da ich vor relativ kurzer Zeit zu ihm kam, begann ich ihn von oben bis unten zu studieren.  Nachdem ich den Textkanal ‚ÄûJobs‚Äú gefunden hatte, wurde ich interessiert, √∂ffnete ihn und fand unter den Vorschl√§gen, die f√ºr mich nicht interessant waren: <br><br>  <i>"Programmierer (Bot-Entwickler)</i> <i><br></i>  <i><b>Anforderungen:</b></i> <i><br><br></i> <ul><li>  <i>Kenntnisse in Programmiersprachen;</i> </li><li>  <i>Selbstlernf√§higkeit.</i> </li></ul> <i><br></i>  <i>W√ºnsche:</i> <i><br><br></i> <ul><li>  <i>F√§higkeit, den Code eines anderen zu verstehen;</i> </li><li>  <i>Kenntnis der Funktionsweise von DISCORD.</i> </li></ul> <i><br></i>  <i><b>Aufgaben:</b></i> <i><br><br></i> <ul><li>  <i>Bot-Entwicklung;</i> </li><li>  <i>Support und Wartung des Bot.</i> </li></ul> <i><br></i>  <i><b>Ihr Nutzen:</b></i> <i><br><br></i> <ul><li>  <i>Die F√§higkeit, das von Ihnen gew√ºnschte Projekt zu unterst√ºtzen und zu beeinflussen;</i> </li><li>  <i>Sammeln von Teamerfahrung;</i> </li><li>  <i>Eine Gelegenheit, vorhandene F√§higkeiten zu demonstrieren und zu verbessern. ‚Äú</i> </li></ul> <i><br></i> <br>  Es hat mich sofort interessiert.  Ja, sie haben nicht f√ºr diese Arbeit bezahlt, aber sie haben keine Verpflichtungen von Ihnen gefordert, und dies wird im Portfolio nicht √ºberfl√ºssig sein.  Also schrieb ich an den Serveradministrator und er bat mich, einen Bot zu schreiben, der Spielerstatistiken in World of Tanks anzeigt. <br><br><h2>  Vorbereitungsphase </h2><br><img src="https://habrastorage.org/webt/vq/ff/5x/vqff5x8bux4bpoyns8pqaemchyk.jpeg"><br>  <b>Discrod</b> <br>  Bevor Sie beginnen, unseren Bot zu schreiben, m√ºssen Sie ihn f√ºr Discord erstellen.  Sie m√ºssen: <br><br><ol><li>  Melden Sie sich bei Discord <a href="https://discordapp.com/developers/applications/">an</a> </li><li>  Klicken Sie auf der Registerkarte "Anwendungen" auf die Schaltfl√§che "Neue Anwendung" und benennen Sie den Bot </li><li>  Holen Sie sich das Bot-Token, indem Sie sich bei Ihrem Bot anmelden und in der Liste "Einstellungen" die Registerkarte "Bot" finden </li><li>  Token irgendwo speichern </li></ol><br>  <b>Wargaming</b> <br><br>  Sie m√ºssen auch eine Anwendung in Wargaming erstellen, um auf die Wargaming-API zugreifen zu k√∂nnen.  Auch hier ist alles einfach: <br><br><ol><li>  √úber <a href="https://developers.wargaming.net/">diesen Link gelangen</a> wir zum Wargaming-Konto </li><li>  Gehen Sie zu "Meine Anwendungen" und klicken Sie auf die Schaltfl√§che "Neue Anwendung hinzuf√ºgen", geben Sie den Namen der Anwendung an und w√§hlen Sie ihren Typ aus </li><li>  Speichern Sie die Anwendungs-ID </li></ol><br>  <b>Software</b> <br><br>  Es gibt bereits Wahlfreiheit.  Jemand benutzt Visual Studio, jemand Rider, jemand ist im Allgemeinen m√§chtig und schreibt Code in Vim (echte Programmierer benutzen immer noch nur die Tastatur, oder?).  Um die Discord-API jedoch nicht zu implementieren, k√∂nnen Sie die inoffizielle C # -Bibliothek ‚ÄûDSharpPlus‚Äú verwenden.  Es kann entweder von NuGet aus installiert werden oder indem Sie die Quelle selbst aus dem Repository abrufen. <br><br><div class="spoiler">  <b class="spoiler_title">F√ºr diejenigen, die nicht wissen oder vergessen haben, wie man Anwendungen von NuGet installiert.</b> <div class="spoiler_text">  <b>Anleitung f√ºr Visual Studio</b> <br><br><ol><li>  Gehen Sie zur Registerkarte Projekt - NuGet Package Management. </li><li>  Klicken Sie auf die √úberpr√ºfung und geben Sie "DSharpPlus" in das Suchfeld ein. </li><li>  Wir w√§hlen und installieren das Framework. </li><li>  GEWINN! </li></ol><br></div></div><br>  Die Vorbereitungsphase ist beendet, Sie k√∂nnen mit dem Schreiben des Bots fortfahren. <br><br><h2>  Rechtschreiblogik </h2><br><img src="https://habrastorage.org/webt/zp/3o/ul/zp3oulxjmfdxgw3mxatiw6eqq1u.png"><br><br>  Wir werden nicht die gesamte Logik der Anwendung betrachten, sondern nur zeigen, wie man mit dem Abfangen von Nachrichten durch den Bot arbeitet und wie man mit der Wargaming-API arbeitet. <br><br>  Die Arbeit mit dem Discord-Bot erfolgt √ºber die Funktion static async Task MainTask (string [] args). <br>  Um diese Funktion aufzurufen, m√ºssen Sie sich in Main registrieren <br><br><pre><code class="plaintext hljs">MainTask(args).ConfigureAwait(false).GetAwaiter().GetResult();</code> </pre> <br>  Als n√§chstes m√ºssen Sie Ihren Bot initialisieren: <br><br><pre> <code class="cs hljs">discord = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DiscordClient(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DiscordConfiguration { Token = token, TokenType = TokenType.Bot, UseInternalLogHandler = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, LogLevel = LogLevel.Debug });</code> </pre> <br>  Wobei Token das Token Ihres Bots ist. <br>  Dann schreiben wir durch das Lambda die notwendigen Befehle, die der Bot ausf√ºhren soll: <br><pre> <code class="cs hljs">discord.MessageCreated += <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> e =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> message = e.Message.Content; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message.StartsWith(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> e.Message.RespondAsync(‚ÄúHello, ‚Äù + e.Author.Username); } };</code> </pre><br>  Where e.Author.Username - Abrufen des Benutzernamens. <br><br>  Wenn Sie also eine Nachricht senden, die mit &amp; beginnt, hei√üt Sie der Bot willkommen. <br><br>  Am Ende dieser Funktion m√ºssen Sie sich registrieren, bis discord.ConnectAsync ();  und warten auf Task.Delay (-1); <br><br>  Auf diese Weise k√∂nnen Sie Befehle im Hintergrund ausf√ºhren, ohne den Hauptthread zu belegen. <br><br>  Nun m√ºssen Sie sich mit der Wargaming-API befassen.  Hier ist alles einfach - schreiben Sie CURL-Anforderungen, erhalten Sie die Antwort in Form von JSON-Zeichenfolgen, ziehen Sie die erforderlichen Daten von dort heraus und nehmen Sie Manipulationen an ihnen vor. <br><br><div class="spoiler">  <b class="spoiler_title">Ein Beispiel f√ºr die Arbeit mit WargamingAPI</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Player </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FindPlayer</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> searchNickname</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//https://api.worldoftanks.ru/wot/account/list/?application_id=y0ur_a@@_id_h3r3search=nickname urlRequest = resourceMan.GetString("url_find_player") + appID + "&amp;search=" + searchNickname; Player player = null; string resultResponse = GetResponse(urlRequest); dynamic parsed = JsonConvert.DeserializeObject(resultResponse); string status = parsed.status; if (status == "ok") { int count = parsed.meta.count; if (count &gt; 0) { player = new Player { Nickname = parsed.data[0].nickname, Id = parsed.data[0].account_id }; } else { throw new PlayerNotFound("  "); } } else { string error = parsed.error.message; if (error == "NOT_ENOUGH_SEARCH_LENGTH") { throw new PlayerNotFound("   "); } else if (error == "INVALID_SEARCH") { throw new PlayerNotFound(" "); } else if (error == "SEARCH_NOT_SPECIFIED") { throw new PlayerNotFound(" "); } else { throw new Exception("Something went wrong."); } } return player; }</span></span></code> </pre><br></div></div><br>  Achtung!  Es wird dringend davon abgeraten, alle Token und Anwendungs-IDs im Klartext zu speichern!  Zumindest - Discord verbietet diese Token, wenn sie das weltweite Netzwerk erreichen, maximal - der Bot beginnt, b√∂swillige Benutzer zu verwenden. <br><br><h2>  Auf dem VPS-Server bereitstellen </h2><br><img src="https://habrastorage.org/webt/yq/k3/6g/yqk36gjlwxnrbo_ssc422vejtyi.jpeg"><br><br>  Nachdem Sie mit dem Bot fertig sind, m√ºssen Sie ihn auf einen Server stellen, der st√§ndig rund um die Uhr l√§uft.  Dies liegt an der Tatsache, dass der Bot auch funktioniert, wenn Ihre Anwendung funktioniert.  Sobald Sie die Anwendung ausschalten, schl√§ft Ihr Bot ein. <br><br>  Auf dieser Welt gibt es viele VPS-Server, sowohl unter Windows als auch unter Linux. In den meisten F√§llen ist Linux jedoch um ein Vielfaches g√ºnstiger zu hosten. <br><br>  Auf dem Discord-Server wurde ich von vscale.io beraten, und ich habe auf Ubuntu sofort einen virtuellen Server darauf erstellt und den Bot hochgeladen.  Ich werde nicht beschreiben, wie diese Seite funktioniert, aber ich werde sofort mit den Bot-Einstellungen fortfahren. <br><br>  Zun√§chst m√ºssen Sie die erforderliche Software installieren, mit der unser in .NET Core geschriebener Bot ausgef√ºhrt wird.  <a href="https://docs.microsoft.com/ru-ru/dotnet/core/install/linux-package-manager-ubuntu-1804">Wie das geht, wird hier beschrieben</a> . <br><br>  Als N√§chstes m√ºssen Sie den Bot auf einen Git-Dienst wie GitHub und dergleichen hochladen und auf einen VPS-Server klonen oder Ihren Bot auf andere Weise herunterladen.  Beachten Sie, dass Sie nur eine Konsole haben, es wird keine GUI geben.  Absolut. <br><br>  Nachdem Sie Ihren Bot heruntergeladen haben, m√ºssen Sie ihn ausf√ºhren.  Dazu m√ºssen Sie: <br><br><ul><li>  Stellen Sie alle Abh√§ngigkeiten wieder her: dotnet restore </li><li>  Build-Anwendung: dotnet build name_project.sln -c Release </li><li>  Wechseln Sie zu der erstellten DLL. </li><li>  dotnet name_of_file.dll </li></ul><br>  Herzlichen Gl√ºckwunsch!  Dein Bot l√§uft.  Leider belegt der Bot die Konsole und es wird nicht einfach sein, den VPS-Server zu verlassen.  Im Falle eines Neustarts des Servers m√ºssen Sie den Bot erneut starten.  Es gibt ein paar M√∂glichkeiten, aus der Situation herauszukommen.  Alle von ihnen beziehen sich auf den Start beim Serverstart: <br><br><ul><li>  Skriptlauf zu /etc/init.d hinzuf√ºgen </li><li>  Erstellen Sie einen Dienst, der beim Start gestartet wird. </li></ul><br>  Ich sehe keinen Sinn darin, sie zu beschreiben, alles ist im Internet ausreichend detailliert beschrieben. <br><br><h2>  Schlussfolgerungen </h2><br>  Ich bin froh, dass ich diesen Auftrag angenommen habe.  Dies war meine erste Erfahrung in der Bot-Entwicklung, und ich bin froh, dass ich neue Kenntnisse in C # und in der Arbeit mit Linux erworben habe. <br><br>  Link zum Discord - Server.  <a href="https://discord.gg/yprre9">F√ºr diejenigen, die Wargaming-Spiele spielen.</a> <br>  <a href="https://github.com/hunterlan/WargamingStatistics">Link zum Repository, in dem sich der Discord Bot befindet.</a> <br>  <a href="https://github.com/DSharpPlus/DSharpPlus">Link zum DSharpPlus-Repository.</a> <br>  Vielen Dank f√ºr Ihre Aufmerksamkeit! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479180/">https://habr.com/ru/post/de479180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479166/index.html">Schreiben Sie Ihr Capped Expirationd-Modul f√ºr Tarantool</a></li>
<li><a href="../de479168/index.html">So erstellen Sie eine RESTful-API auf der Symfony 5 + -API-Plattform f√ºr ein MODX-Projekt</a></li>
<li><a href="../de479170/index.html">Wochenendlesung: Audio Digest von Streaming-Diensten und der Musikindustrie</a></li>
<li><a href="../de479176/index.html">Die Modder haben 15 Jahre damit verbracht, die Ritter der Alten Republik 2 zu reparieren</a></li>
<li><a href="../de479178/index.html">Deanonymisierung elliptischer Datensatztransaktionen</a></li>
<li><a href="../de479182/index.html">Das √úben der Vorbereitung von Fremdw√∂rtern mit Sprachausgabe zum Auswendiglernen im Anki-Programm</a></li>
<li><a href="../de479184/index.html">Probleml√∂sung mit pwnable.kr 26 - ascii_easy. Wir besch√§ftigen uns ein f√ºr alle Mal mit ROP-Ger√§ten von Grund auf</a></li>
<li><a href="../de479186/index.html">√úber die Struktur des Parallel-Computing oder die Argumente gegen den "Go" -Operator</a></li>
<li><a href="../de479188/index.html">Die Summe aller nat√ºrlichen Zahlen: 1 + 2 + 3 + 4 + .... Teil 2</a></li>
<li><a href="../de479192/index.html">Steroid Hypervisor: FreeBSD + ZFS + cbsd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>