<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôãÔ∏è üë©üèº‚Äçü§ù‚Äçüë®üèΩ üìù Cet article contient trop d'eau. üå≠ üë©üèª‚Äçüè≠ ü§≥üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬´Nous commen√ßons √† d√©velopper un nouveau jeu et nous avons besoin d'eau fra√Æche. Pouvez-vous faire √ßa? " 


 - m'a demand√©. ¬´Oui, pas question! Bien s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cet article contient trop d'eau.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451604/">  ¬´Nous commen√ßons √† d√©velopper un nouveau jeu et nous avons besoin d'eau fra√Æche.  Pouvez-vous faire √ßa? " <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/iilqtDkeIBE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - m'a demand√©.  ¬´Oui, pas question!  Bien s√ªr que je peux, ¬ªai-je r√©pondu, mais ma voix tremblait tra√Ætreusement.  ¬´Et aussi sur Unity?¬ª - et il m'est apparu clairement qu'il y avait beaucoup de travail √† faire. <br><a name="habracut"></a><br>  Donc, un peu d'eau.  Jusqu'√† ce moment, je n'avais pas vu Unity, exactement comme C #, alors j'ai d√©cid√© de faire un prototype sur les outils que je connaissais: C ++ et DX9.  Ce que je savais et pouvais pratiquer dans la pratique √† ce moment-l√†, c'√©tait les textures de d√©filement des normales pour former la surface, et la cartographie de d√©placement primitive bas√©e sur elles.  Il a fallu imm√©diatement tout changer absolument.  Forme anim√©e r√©aliste de la surface de l'eau.  Ombrage compliqu√© (fortement).  G√©n√©ration de mousse.  Syst√®me LOD attach√© √† la cam√©ra.  J'ai commenc√© √† chercher des informations sur Internet pour savoir comment faire tout cela. <br><br>  Le premier point, bien s√ªr, √©tait une compr√©hension de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la simulation des eaux oc√©aniques</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jerry Tessendorf</a> . <br><br>  Les t√©l√©avertisseurs acad√©miques avec un tas de formules abstruses ne m'ont jamais √©t√© donn√©s beaucoup, donc apr√®s quelques lectures, j'ai peu compris.  Les principes g√©n√©raux √©taient clairs: chaque image est g√©n√©r√©e par une carte des hauteurs utilisant la transform√©e de Fourier rapide, qui, en fonction du temps, change doucement de forme pour former une surface d'eau r√©aliste.  Mais comment et quoi compter je ne savais pas.  J'ai lentement explor√© la sagesse du calcul de la FFT sur les shaders en D3D9, et le code source avec un article quelque part dans la nature d'Internet, que j'ai essay√© de trouver pendant une heure, mais en vain (malheureusement), m'a vraiment aid√©.  Le premier r√©sultat a √©t√© obtenu (effrayant comme une guerre nucl√©aire): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tdfwF1R81O4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Les succ√®s initiaux ont plu, et le transfert d'eau vers Unity a commenc√© avec son ach√®vement. <br><br>  Plusieurs exigences ont √©t√© avanc√©es pour l'eau dans le jeu sur les batailles navales: <br><br><ul><li>  Look r√©aliste.  Beau comme raccourcis rapproch√©s et √©loign√©s, mousse dynamique, dispersion, etc. </li><li>  Prise en charge de diverses conditions m√©t√©orologiques: calme, temp√™te et conditions interm√©diaires.  Changement d'heure. </li><li>  Physique de la flottabilit√© des navires sur une surface simul√©e, objets flottants. </li><li>  Comme le jeu est multijoueur, l'eau doit √™tre la m√™me pour tous les participants √† la bataille. </li><li>  Dessin de surface: zones dessin√©es du vol des noyaux de vol√©e, mousse de l'entr√©e des noyaux dans l'eau. </li></ul><br><h3>  G√©om√©trie </h3><br>  Il a √©t√© d√©cid√© de construire une structure en forme d'arbre, avec un centre autour de la cam√©ra, qui est reconstruite discr√®tement lorsque l'observateur se d√©place.  Pourquoi discret?  Si vous d√©placez le maillage en douceur avec la cam√©ra ou utilisez la reprojection de l'espace d'√©cran comme dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rendu d'eau en temps r√©el - pr√©sentant le concept de grille projet√©e</a> , puis dans les plans √† long terme, en raison de la r√©solution insuffisante du maillage g√©om√©trique, les polygones ¬´sauteront¬ª vers le haut et vers le bas.  C'est tr√®s frappant.  L'image ondule.  Pour surmonter cela, il faut soit augmenter consid√©rablement la r√©solution du polygone de maille d'eau, soit ¬´aplatir¬ª la g√©om√©trie sur de longues distances, soit construire et d√©placer les polygones de sorte que ces d√©placements ne soient pas visibles.  Notre eau est progressive (hehe) et j'ai choisi la troisi√®me voie.  Comme dans toute technique similaire (particuli√®rement famili√®re √† tous ceux qui ont cr√©√© un terrain dans les jeux), vous devez vous d√©barrasser des jonctions en T aux fronti√®res des transitions de niveaux de d√©tail.  Pour r√©soudre ce probl√®me, au d√©part 3 types de quads avec des param√®tres de pavage donn√©s sont calcul√©s: <br><br><img src="https://habrastorage.org/webt/al/df/nw/aldfnwtnd2iihq2np9juxe5lvjm.jpeg"><br><br>  Le premier type est destin√© aux quads qui ne sont pas des transitions pour r√©duire les d√©tails.  Aucun des deux c√¥t√©s n'a un nombre de sommets r√©duit de 2 fois.  Le deuxi√®me type est pour les quadrats limites, mais pas angulaires.  Le troisi√®me type est le quadrilat√®re angulaire.  Le maillage final de l'eau est construit en tournant et en mettant √† l'√©chelle ces trois types de mailles. <br><br>  Voici √† quoi ressemble un rendu avec une couleur diff√©rente des niveaux d'eau LOD. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/JycUZlod3xs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Les premi√®res images montrent la connexion de deux niveaux de d√©tails diff√©rents. <br><br>  La vid√©o en tant que cadre est remplie de quads d'eau: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/VldNrYKLb0w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Permettez-moi de vous rappeler que c'√©tait il y a longtemps (et pas vrai).  D√©sormais, de mani√®re plus optimale et flexible, vous pouvez le faire directement sur le GPU (GPU Pro 5. Quadtrees sur le GPU).  Et il dessinera en un seul appel, et la tessellation peut augmenter le d√©tail. <br><br>  Plus tard, le projet est pass√© au D3D11, mais les mains n'ont pas atteint la mise √† niveau de cette partie du rendu oc√©anique. <br><br><h3>  G√©n√©ration de forme d'onde </h3><br>  Pour cela, nous avons besoin d'une transformation de Fourier rapide.  Pour la r√©solution (n√©cessaire) s√©lectionn√©e de la texture de la vague (appelons cela pour l'instant, je vais vous expliquer quelles donn√©es y sont stock√©es), nous pr√©parons les donn√©es initiales en utilisant les param√®tres d√©finis par les artistes (force, direction du vent, d√©pendance des vagues sur la direction du vent et autres).  Tout cela doit √™tre introduit dans les soi-disant formules.  Spectre de Phillips  Nous modifions les donn√©es initiales obtenues pour chaque trame en tenant compte du temps et effectuons la FFT sur celles-ci.  En sortie, nous obtenons un pavage de texture dans toutes les directions qui contient le d√©calage des sommets du maillage plat.  Pourquoi pas juste une carte des hauteurs?  Si vous ne stockez que le d√©calage en hauteur, le r√©sultat sera une masse "bouillonnante" irr√©aliste, qui ne ressemble qu'√† distance √† la mer: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/2234r1xpuI8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Si nous consid√©rons les d√©placements pour les trois coordonn√©es, de belles ondes r√©alistes ¬´nettes¬ª seront g√©n√©r√©es: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tFhKaV1u-AY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Une texture anim√©e ne suffit pas.  Le carrelage est visible, pas assez de d√©tails dans un avenir proche.  Nous prenons l'algorithme d√©crit et faisons non pas une, mais 3 textures g√©n√©r√©es par fft.  Le premier est les grosses vagues.  Il d√©finit la forme d'onde de base et est utilis√© pour la physique.  Le second est des ondes moyennes.  Et enfin, le plus petit.  3 g√©n√©rateurs FFT (la 4√®me option est le mix final): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/gqxbAOS4sGM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Les param√®tres des couches sont d√©finis ind√©pendamment les uns des autres, et les textures r√©sultantes sont m√©lang√©es dans le shader d'eau dans la forme d'onde finale.  Parall√®lement aux d√©calages, des cartes normales de chaque couche sont √©galement g√©n√©r√©es. <br><br>  L '"uniformit√©" de l'eau pour tous les participants √† la bataille est assur√©e par la synchronisation des param√®tres oc√©aniques au d√©but de la bataille.  Ces informations sont transmises par le serveur √† chaque client. <br><br><h3>  Mod√®le de flottabilit√© physique </h3><br>  Puisqu'il fallait faire non seulement une belle photo, mais aussi le comportement r√©aliste des navires.  Et compte tenu √©galement du fait qu'une mer orageuse (grosses vagues) devait √™tre pr√©sente dans le jeu, une autre t√¢che qui devait √™tre r√©solue √©tait d'assurer la flottabilit√© des objets √† la surface de la mer g√©n√©r√©e.  J'ai d'abord essay√© de relire le GPU √† la texture de la vague.  Mais, comme il est rapidement devenu clair que toute la physique du combat naval doit √™tre effectu√©e sur le serveur, la mer, ou plut√¥t sa premi√®re couche, qui d√©finit la forme d'onde, doit √©galement √™tre lue sur le serveur (et, tr√®s probablement, il n'y a pas de rapide et / ou compatible GPU), il a √©t√© d√©cid√© d'√©crire une copie fonctionnelle compl√®te du g√©n√©rateur GPU FFT sur le CPU sous la forme d'un plug-in C ++ natif pour Unity.  Je n'ai pas impl√©ment√© l'algorithme FFT moi-m√™me et l'ai utilis√© dans la biblioth√®que Intel Performance Primitives (IPP).  Mais toute la liaison et le post-traitement des r√©sultats ont √©t√© effectu√©s par moi, suivis d'une optimisation sur SSE et d'une parall√©lisation par threads.  Cela comprenait la pr√©paration du tableau de donn√©es pour la FFT chaque trame, et la conversion finale des valeurs calcul√©es en une carte de d√©calage d'onde. <br><br>  Il y avait une autre caract√©ristique int√©ressante de l'algorithme, qui √©tait bas√©e sur les exigences de la physique de l'eau.  Ce qu'il fallait, c'√©tait une fonction permettant d'obtenir rapidement la hauteur des vagues √† un point donn√© du monde.  C'est logique, car c'est la base pour construire la flottabilit√© de n'importe quel objet.  Mais, comme √† la sortie du processeur FFT nous obtenons offsetmap, pas heightmap, la s√©lection habituelle de la texture ne nous a pas donn√© la hauteur des vagues si n√©cessaire.  Pour plus de simplicit√©, consid√©rez l'option 2D: <br><br><img src="https://habrastorage.org/webt/u6/ec/pe/u6ecpek-vcazrjpgh4ygxwhon2g.jpeg"><br><br>  Pour former une vague, les texels (√©l√©ments de texture repr√©sent√©s par des lignes verticales) contiennent un vecteur (fl√®ches) qui d√©finit le d√©calage du sommet du maillage plat (points bleus) dans le sens de sa position finale (la pointe de la fl√®che).  Supposons que nous prenions ces donn√©es et essayions d'en extraire la hauteur de l'eau au point qui nous int√©resse.  Par exemple, nous devons conna√Ætre la hauteur en hB.  Si nous prenons le vecteur texel tB, nous obtenons alors un d√©calage vers un point proche de hC, qui peut √™tre tr√®s diff√©rent de ce dont nous avons besoin.  Il existe deux options pour r√©soudre ce probl√®me: √† chaque demande de hauteur, v√©rifiez l'ensemble des texels adjacents jusqu'√† ce que nous trouvions celui qui a un d√©calage par rapport √† la position qui nous int√©resse.  Dans notre exemple, nous trouvons que le texel tA contient le d√©calage le plus proche.  Mais cette approche ne peut pas √™tre qualifi√©e de rapide.  Le balayage du rayon du texel n'est pas clair sur la taille (et si la mer orageuse ou calme, les d√©placements peuvent varier consid√©rablement) peut prendre beaucoup de temps. <br><br>  La deuxi√®me option - apr√®s avoir calcul√© la carte de d√©calage, convertissez-la en carte de hauteur en utilisant l'approche de diffusion.  Cela signifie que pour chaque vecteur de d√©calage, nous √©crivons la hauteur de l'onde qu'il d√©finit au point o√π il est d√©cal√©.  Ce sera un tableau de donn√©es distinct, qui sera utilis√© pour obtenir la hauteur au point d'int√©r√™t.  En utilisant notre illustration, la cellule tB contiendra la hauteur hB obtenue √† partir du vecteur tA ‚Üí hB.  Il y a encore une fonctionnalit√©.  La cellule tA ne contiendra pas de valeur valide, car aucun vecteur ne s'y d√©place.  Pour combler ces "trous", un passage est fait pour les remplir de valeurs voisines. <br><br>  Voici √† quoi cela ressemble si vous effectuez la visualisation des d√©placements √† l'aide de vecteurs (rouge - grand d√©calage, vert - petit): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/uBk8F55lR74" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Le reste est simple.  Le plan de la ligne de flottaison conditionnelle est r√©gl√© pour le navire.  Sur celui-ci, une grille rectangulaire de points d'√©chantillonnage est d√©termin√©e, qui d√©finit les lieux d'application des forces poussant hors de l'eau pour le navire.  Ensuite, pour chaque point, nous v√©rifions s'il est sous l'eau ou non en utilisant la carte de la hauteur de l'eau d√©crite ci-dessus.  Si le point est sous l'eau, appliquez alors la force verticale jusqu'√† la coque physique du corps √† ce point, mise √† l'√©chelle par la distance du point √† la surface de l'eau.  Si au-dessus de l'eau, nous ne faisons rien, la gravit√© fera tout pour nous.  En fait, les formules y sont un peu plus compliqu√©es (toutes pour le r√©glage fin du comportement du navire), mais le principe de base est le suivant.  Dans la vid√©o de visualisation de la flottabilit√© ci-dessous, les cubes bleus sont les emplacements des √©chantillons, et les lignes qui les s√©parent sont la magnitude de la force poussant hors de l'eau. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mwNRIKbRdpQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Dans l'impl√©mentation du serveur, il y a un autre point d'optimisation int√©ressant.  Il n'est pas n√©cessaire de simuler diff√©rentes eaux pour diff√©rentes instances de combat si elles passent dans les m√™mes conditions m√©t√©orologiques (les m√™mes param√®tres du simulateur FFT).  La d√©cision logique a donc √©t√© de cr√©er un pool de simulateurs, auxquels les unit√©s de combat r√©pondent aux demandes d'obtention d'eau simul√©e avec les param√®tres donn√©s.  Si les param√®tres sont les m√™mes dans plusieurs cas, la m√™me eau y retournera.  Ceci est impl√©ment√© √† l'aide de l'API Memor Mapped File.  Lorsque le simulateur FFT est cr√©√©, il donne acc√®s √† ses donn√©es en exportant des descripteurs des blocs n√©cessaires.  L'instance de serveur, au lieu de lancer un vrai simulateur, lance un "mannequin" qui donne simplement les donn√©es ouvertes par ces descripteurs.  Il y avait quelques bugs amusants li√©s √† cette fonctionnalit√©.  En raison d'erreurs de comptage des r√©f√©rences, le simulateur a √©t√© d√©truit, mais le fichier mapp√© en m√©moire est actif pendant qu'au moins une poign√©e est ouverte.  Les donn√©es ont cess√© de se mettre √† jour (il n'y a pas de simulateur) et l'eau s'est ¬´arr√™t√©e¬ª. <br><br>  C√¥t√© client, nous avons besoin d'informations sur la forme d'onde pour calculer la p√©n√©tration des noyaux dans les syst√®mes d'onde et de particules et de mousse.  Les dommages sont calcul√©s sur le serveur et l√†, il est √©galement n√©cessaire de d√©terminer correctement si le c≈ìur est entr√© dans l'eau (la vague peut fermer le navire, en particulier en cas de temp√™te).  Ici, il est d√©j√† n√©cessaire de faire le tra√ßage de la carte de hauteur par analogie comme cela se fait dans le mappage de parallaxe ou les effets SSAO. <br><br><h3>  Ombrage </h3><br>  En principe, comme ailleurs.  Les r√©flexions, les r√©fractions, la diffusion souterraine sont malicieusement malax√©es, en tenant compte de la profondeur du fond, nous prenons en compte l'effet de Fresnel, nous consid√©rons le sp√©culaire.  Nous consid√©rons la diffusion des cr√™tes en fonction de la position du soleil.  La mousse est g√©n√©r√©e comme suit: cr√©ez un ¬´point de mousse¬ª sur les cr√™tes des vagues (utilisez la hauteur comme m√©trique), puis appliquez les points nouvellement cr√©√©s aux points des images pr√©c√©dentes tout en r√©duisant leur intensit√©.  Ainsi, nous obtenons un maculage de taches de mousse sous la forme d'une queue √† partir d'une cr√™te ondul√©e. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MyzFcwr641g" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Nous utilisons la texture ¬´taches¬ª obtenue comme masque auquel nous m√©langons les textures des bulles, des taches, etc. Nous obtenons un motif dynamique de mousse assez r√©aliste √† la surface des vagues.  Ce masque est cr√©√© pour chaque couche FFT (je vous le rappelle, nous en avons 3), et dans le mix final ils se m√©langent tous. <br><br>  La vid√©o ci-dessus montre un masque en mousse.  Les premi√®re et deuxi√®me couches.  Je modifie les param√®tres du g√©n√©rateur et le r√©sultat est visible sur la texture. <br><br>  Et une vid√©o d'une mer orageuse l√©g√®rement maladroite.  Ici, vous pouvez voir clairement la forme d'onde, les capacit√©s du g√©n√©rateur et la mousse: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MAPUbmV4BAA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Dessin d'eau </h3><br>  Image d'utilisation: <br><br><img src="https://habrastorage.org/webt/zz/gz/1p/zzgz1pslmj1tg5si7o8mwnxqjye.jpeg"><br><br>  Utilis√© pour: <br><br><ul><li>  Marqueurs, visualisation de la zone d'expansion des noyaux. </li><li>  Dessin de mousse au point o√π les noyaux ont touch√© l'eau. </li><li>  Sillage mousseux du navire </li><li>  Extraire l'eau sous le navire pour √©liminer l'effet des vagues qui inondent le pont et la cale inond√©e. </li></ul><br>  Le cas de base √©vident est la texturation projective.  Il a √©t√© mis en ≈ìuvre.  Mais il y a des exigences suppl√©mentaires.  Esp√®ces voisines - savon en raison d'une r√©solution insuffisante (vous pouvez augmenter, mais pas √† l'infini), et je veux que ces dessins projectifs sur l'eau soient bien visibles.  O√π le m√™me probl√®me est-il r√©solu?  C'est vrai, dans les ombres (carte d'ombre).  Comment est-elle r√©solue l√†-bas?  √Ä droite, les Shadow Maps en cascade (division parall√®le).  Nous mettrons √©galement cette technologie en service et l'appliquerons √† notre t√¢che.  Nous divisons le tronc de la cam√©ra en N (3-4 g√©n√©ralement) sous-cro√ªtes.  Pour chacun, nous construisons un rectangle descriptif dans le plan horizontal.  Pour chacun de ces rectangles, nous construisons une matrice de projection orthographique et dessinons tous les objets d'int√©r√™t pour chacune de ces cam√©ras ortho.  Chacune de ces cam√©ras dessine dans une texture distincte, puis, dans le shader oc√©anique, nous les combinons en une seule image projective solide. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/etG8tddmbmk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  J'ai donc mis un √©norme avion avec une texture de drapeau sur la mer: <br><br><img src="https://habrastorage.org/webt/pd/uk/jr/pdukjrlnug2wu4debjrhlxbdxrc.jpeg"><br><br>  Voici ce que contiennent les scissions: <br><br><img src="https://habrastorage.org/webt/ez/dw/nm/ezdwnm3u85dzpavd5iz8e2u9q2k.jpeg"><br><br>  En plus des images habituelles, il est n√©cessaire de dessiner un masque suppl√©mentaire en mousse (pour les traces de navires et les endroits de frappe de noyaux) exactement de la m√™me mani√®re, ainsi qu'un masque pour √©vacuer l'eau sous les navires.  C'est beaucoup de cam√©ras et de nombreuses all√©es.  Au d√©but, cela a fonctionn√© de mani√®re si frein√©e, mais ensuite, apr√®s √™tre pass√© au D3D11, en utilisant la ¬´propagation¬ª de la g√©om√©trie dans le shader g√©om√©trique et en dessinant chaque copie dans une cible de rendu distincte via SV_RenderTergetArrayIndex, il a √©t√© possible d'acc√©l√©rer consid√©rablement cet effet. <br><br><h3>  Am√©liorations et mises √† niveau </h3><br>  D3D11 est les mains tr√®s libres dans de nombreux moments.  Apr√®s √™tre pass√© √† celui-ci et √† Unity 5, j'ai cr√©√© un g√©n√©rateur FFT sur les shaders de calcul.  Visuellement, rien n'a chang√©, mais c'est devenu un peu plus rapide.  La traduction de l'erreur de calcul de la texture des r√©flexions d'un rendu de cam√©ra √† part enti√®re √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la</a> technologie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Screen Space Planar Reflections a</a> donn√© une bonne am√©lioration des performances.  J'ai √©crit sur l'optimisation des objets de surface de l'eau ci-dessus, mais mes mains n'ont pas atteint le transfert du maillage au GPU Quadtree. <br><br>  Beaucoup pourrait √™tre fait de mani√®re plus optimale et plus simple.  Par exemple, ne cl√¥turez pas les jardins avec un simulateur de processeur, mais ex√©cutez simplement l'option GPU sur un serveur avec un p√©riph√©rique WARP (logiciel) d3d.  Les tableaux de donn√©es ne sont pas tr√®s volumineux. <br><br>  Eh bien, en g√©n√©ral, en quelque sorte.  Au moment o√π le d√©veloppement a commenc√©, tout √©tait moderne et cool.  Maintenant, il est d√©j√† hors de propos √† certains endroits.  Il existe plus de mat√©riaux disponibles, m√™me il existe un analogue similaire √† github: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Crest</a> .  La plupart des jeux qui ont des mers utilisent une approche similaire. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr451604/">https://habr.com/ru/post/fr451604/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr451594/index.html">Guide du rapport PHP Russie 2019</a></li>
<li><a href="../fr451596/index.html">Cardinal gris .NET - John Galloway</a></li>
<li><a href="../fr451598/index.html">Unit Fairy Magic Fairy: DSL en C #</a></li>
<li><a href="../fr451600/index.html">Comment r√©diger une lettre de motivation lorsque vous cherchez un emploi aux √âtats-Unis: 7 conseils</a></li>
<li><a href="../fr451602/index.html">Nous √©tudions MITRE ATT & CK. Matrices mobiles: acc√®s aux appareils. Partie 1</a></li>
<li><a href="../fr451606/index.html">Histoire d'Internet: d√©labrement, partie 2</a></li>
<li><a href="../fr451610/index.html">Semaine de la s√©curit√© 20: d√©sactivation des extensions Firefox</a></li>
<li><a href="../fr451614/index.html">¬´Ce dont nous discutons en Russie est √©galement pertinent en Occident¬ª: entretien avec Denis Neklyudov</a></li>
<li><a href="../fr451618/index.html">CampusInsight: de la surveillance de l'infrastructure √† l'analyse de l'exp√©rience utilisateur</a></li>
<li><a href="../fr451620/index.html">Autorisation automatique sur la carte Strava Heatmap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>