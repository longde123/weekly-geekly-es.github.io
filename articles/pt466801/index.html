<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬆️ 👩 🔰 Ignorando o limite de pesquisa do LinkedIn ao jogar com a API ⛽️ 🚴🏿 👩🏾‍🤝‍👩🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[Como minha extensão recebeu muita atenção do público estrangeiro, traduzi meu artigo original para o inglês] . 

 Limite 
 Por ser uma rede profissio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ignorando o limite de pesquisa do LinkedIn ao jogar com a API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466801/"> <i><b>[Como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">minha extensão</a> recebeu muita atenção do público estrangeiro, traduzi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">meu artigo original</a> para o inglês]</b></i> . <br><br><h2>  Limite </h2><br>  Por ser uma rede profissional com a melhor classificação, o LinkedIn, infelizmente, para contas gratuitas, tem uma limitação como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Limite de Uso Comercial</a> (CUL).  Muito provavelmente, você, como eu até recentemente, nunca encontrou e nunca ouviu falar sobre isso. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/36d/2b0/822/36d2b0822beb23f8e1da5b49772ac608.png" alt="imagem"><br><br>  O objetivo da CUL é que, quando você pesquisa pessoas fora de suas conexões / rede com muita frequência, seus resultados de pesquisa são limitados, com apenas três perfis sendo exibidos em vez de 1000 (100 páginas com 10 perfis por página, por padrão).  Com que frequência é medido ninguém sabe, não há métricas precisas;  o algoritmo decide com base em suas ações - com que frequência você pesquisou e quantas conexões adicionou.  A CUL gratuita é redefinida à meia-noite PST no primeiro dia de cada mês e você obtém seus 1000 resultados de pesquisa novamente, para quem sabe quanto tempo.  Obviamente, as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">contas Premium não possuem esse limite</a> . <br><br>  No entanto, não faz muito tempo, comecei a mexer com a pesquisa do LinkedIn por algum projeto de estimação e, de repente, fiquei preso a essa CUL.  Obviamente, eu não gostei muito;  afinal, eu não uso a pesquisa para fins comerciais.  Então, meu primeiro pensamento foi explorar esse limite e tentar contorná-lo. <br><br>  [Esclarecimentos importantes - todos os materiais de origem neste artigo são apresentados apenas para fins informativos e educacionais.  O autor não incentiva seu uso para fins comerciais.] <br><a name="habracut"></a><br><br><h4>  <b>Atualização importante - o LinkedIn levou em consideração esse backdoor e, recentemente, eles o corrigiram.</b>  <b>O backdoor e o plug-in não funcionam mais.</b> </h4><br><br><h2>  Estudando o problema </h2><br>  O que obtivemos: em vez de 10 perfis com paginação, a ferramenta de pesquisa mostra apenas 3, que são seguidos por uma "recomendação" para comprar uma conta Premium e, em seguida, você vê outros perfis desfocados não clicáveis. <br><br>  O primeiro que você tem como desenvolvedor é abrir as Ferramentas do desenvolvedor do navegador para examinar esses perfis ocultos / desfocados - talvez você possa remover alguns estilos responsáveis ​​pelo desfoque ou extrair os dados do bloco de layout / marcação.  Mas, como era de se esperar, esses perfis são mostrados apenas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">imagens de espaço reservado</a> e não contêm dados. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fe/2a7/9b9/3fe2a79b9a50985fc30cfbf4ba55e2d4.png" alt="imagem"><br><br>  Ok, agora vamos a uma guia Rede e verificamos se os resultados de pesquisa alternativos realmente retornam apenas 3 perfis.  Então, encontramos a consulta na qual estamos interessados ​​- “/ api / search / blended” - e analisamos a resposta. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b67/99a/525/b6799a525858d563e5c6ae6545d580b9.png" alt="imagem"><br><br>  Os perfis estão contidos no array `included`, mas também já existem 15 entidades nele.  Nesse caso, os três primeiros são os objetos com dados adicionais - cada objeto contém informações sobre um perfil específico (por exemplo, se o perfil for Premium). <br><br>  Os próximos 12 perfis são reais - na verdade, são esses resultados de pesquisa, dos quais apenas três serão mostrados para nós.  Como você já pode imaginar, o LinkedIn exibe apenas os perfis que receberam as informações adicionais (os três primeiros objetos).  Por exemplo, se você explorar a resposta de pesquisa do perfil sem limite, serão retornadas 28 entidades - 10 objetos com informações adicionais e 18 perfis. <br><br><div class="spoiler">  <b class="spoiler_title">Resposta para um perfil sem limite</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/4d3/5d1/41f/4d35d141fdd5f3669f37646efa86a897.jpg" alt="imagem"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2da/429/bbc/2da429bbc6c33213050f52394ebbd72e.png" alt="imagem"><br></div></div><br><blockquote>  Ainda não tenho certeza do motivo pelo qual são retornados mais de 10 perfis, enquanto 10 são solicitados e eles não são exibidos a um usuário - você não os verá nem na próxima página.  Se você analisar o URL da solicitação, verá essa contagem = 10 (quantos perfis retornar na resposta, 49 é o máximo). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4bd/cfc/81f/4bdcfc81fe9dce6105e89e8a01ca03d6.png" alt="imagem"><br><br>  Quaisquer comentários sobre este assunto serão muito apreciados. </blockquote><br><h2>  Experimentação </h2><br>  Ok, agora sabemos o mais importante com certeza - a resposta vem com mais perfis do que o LinkedIn nos mostra.  Assim, podemos obter mais dados, apesar da CUL.  Vamos tentar extrair a API diretamente do console, usando buscar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38e/b0d/45d/38eb0d45d5d750318b67bb3850838eba.png" alt="imagem"><br><br>  Como esperado, obtemos o erro 403.  Esse é um problema de segurança - aqui não enviamos um token <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">CSRF</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">CSRF na Wikipedia</a> ).  Em poucas palavras, é um token exclusivo que é adicionado a cada solicitação, verificado no lado do servidor quanto à autenticidade. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ea/b67/8a0/9eab678a04635e1a79f43e9111ad68b4.png" alt="imagem"><br><br>  Você pode copiá-lo de qualquer outra solicitação bem-sucedida ou de cookies, onde estiver armazenado no campo 'JSESSIONID'. <br><br><div class="spoiler">  <b class="spoiler_title">Onde encontrar um token</b> <div class="spoiler_text">  Título de qualquer outro pedido: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0ea/c65/081/0eac650813223c60cfdf1553d830ec8e.png" alt="imagem"><br><br>  A partir dos cookies, diretamente no console: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07f/52f/ead/07f52feada033d8b7f00bd16bd592858.png" alt="imagem"><br></div></div><br>  Vamos tentar de novo;  desta vez, passamos as configurações para buscar.  Nas configurações, especificamos nosso token CSRF como um parâmetro no cabeçalho. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/56c/cab/e62/56ccabe62b3d01f43277586f8d9c1def.png" alt="imagem"><br><br>  Sucesso, todos os 10 perfis são retornados.  : tada: <br><blockquote>  Devido à diferença nos cabeçalhos, a estrutura de resposta difere um pouco do que vem na solicitação original.  Você pode obter a mesma estrutura exata se adicionar 'Accept:' application / vnd.linkedin.normalized + json + 2.1 'em nosso objeto, próximo ao token CSRF. <br><br><div class="spoiler">  <b class="spoiler_title">Amostra de uma resposta com o cabeçalho adicionado</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/aa7/d8c/48e/aa7d8c48e6ec3f8145f99ddd2d09e2b6.png" alt="imagem"><br></div></div><br>  Mais sobre o cabeçalho Accept </blockquote><br><h2>  O que vem a seguir? </h2><br>  Agora você pode editar (manual ou automaticamente) o parâmetro `start` que especifica o índice, a partir do qual podemos receber 10 perfis (por padrão = 0) de todo o resultado da pesquisa.  Em outras palavras, incrementando-o em 10 após cada solicitação, obtemos nossa paginação usual, 10 perfis por página. <br><br>  Nesta fase, tenho dados e liberdade suficientes para continuar trabalhando no projeto pet.  Mas seria um pecado não tentar exibir esses dados imediatamente, pois estavam em minhas mãos.  Não vamos mergulhar no Ember usado para o frontend.  Como o JQuery foi integrado no site, você pode extrair da memória o conhecimento da sintaxe básica e criar o seguinte em alguns minutos. <br><br><div class="spoiler">  <b class="spoiler_title">Código JQuery</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* render the block, receive profile data, and insert the block in the profiles' list, using this data */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createProfileBlock = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ headline, publicIdentifier, subline, title }</span></span></span><span class="hljs-function">) =&gt;</span></span> { $(<span class="hljs-string"><span class="hljs-string">'.search-results__list'</span></span>).append( <span class="hljs-string"><span class="hljs-string">`&lt;li class="search-result search-result__occluded-item ember-view"&gt; &lt;div class="search-entity search-result search-result--person search-result--occlusion-enabled ember-view"&gt; &lt;div class="search-result__wrapper"&gt; &lt;div class="search-result__image-wrapper"&gt; &lt;a class="search-result__result-link ember-view" href="/in/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${publicIdentifier}</span></span></span><span class="hljs-string">/"&gt; &lt;figure class="search-result__image"&gt; &lt;div class="ivm-image-view-model ember-view"&gt; &lt;img class="lazy-image ivm-view-attr__img--centered EntityPhoto-circle-4 presence-entity__image EntityPhoto-circle-4 loaded" src="http://www.userlogos.org/files/logos/give/Habrahabr3.png" /&gt; &lt;/div&gt; &lt;/figure&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class="search-result__info pt3 pb4 ph0"&gt; &lt;a class="search-result__result-link ember-view" href="/in/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${publicIdentifier}</span></span></span><span class="hljs-string">/"&gt; &lt;h3 class="actor-name-with-distance search-result__title single-line-truncate ember-view"&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${title.text}</span></span></span><span class="hljs-string"> &lt;/h3&gt; &lt;/a&gt; &lt;p class="subline-level-1 t-14 t-black t-normal search-result__truncate"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${headline.text}</span></span></span><span class="hljs-string">&lt;/p&gt; &lt;p class="subline-level-2 t-12 t-black--light t-normal search-result__truncate"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${subline.text}</span></span></span><span class="hljs-string">&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;li&gt;`</span></span> ); }; <span class="hljs-comment"><span class="hljs-comment">// fetch data and render the profiles const fetchProfiles = () =&gt; { // token const csrf = 'ajax:9082932176494192209'; // bject with the request settings, pass the token const settings = { headers: { 'csrf-token': csrf } } // request URL, with a dynamic start index at the end const url = `https://www.linkedin.com/voyager/api/search/blended?count=10&amp;filters=List(geoRegion-%3Ejp%3A0,network-%3ES,resultType-%3EPEOPLE)&amp;origin=FACETED_SEARCH&amp;q=all&amp;queryContext=List(spellCorrectionEnabled-%3Etrue,relatedSearchesEnabled-%3Etrue)&amp;start=${nextItemIndex}`; /* make a request, for each profile in the response call the block rendering, and then increment the starting index by 10 */ fetch(url, settings).then(response =&gt; response.json()).then(data =&gt; { data.elements[0].elements.forEach(createProfileBlock); nextItemIndex += 10; }); }; // delete all profiles from the list $('.search-results__list').find('li').remove(); // insert the 'download profiles' button $('.search-results__list').after('&lt;button id="load-more"&gt;Load More&lt;/button&gt;'); // add the functionality to the button $('#load-more').addClass('artdeco-button').on('click', fetchProfiles); // set the default profile index for the request window.nextItemIndex = 0;</span></span></code> </pre> </div></div><br>  Se você executar essas ações diretamente no console da página de pesquisa, adicionará um botão que carrega 10 novos perfis cada vez que clicar nele e os renderiza como uma lista.  Obviamente, você precisará alterar um token e um URL adequadamente para os necessários.  O bloco de perfil conterá um nome, cargo, local, um link para o perfil e uma imagem de espaço reservado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/548/2ea/771/5482ea771d31bcf646fd4a9fb0da255a.png" alt="imagem"><br><br>  Conclusão <br>  Portanto, com o mínimo de esforço, conseguimos encontrar um ponto fraco e recuperar nossa opção de pesquisa sem limitações.  Foi o suficiente para analisar os dados e seu caminho e analisar a própria consulta. <br><br>  Não posso dizer que esse é um problema sério para o LinkedIn, pois não representa ameaça.  O pior que pode acontecer é uma perda de lucro devido a esse "desvio", que permite que você não compre uma conta Premium.  Talvez a resposta desse servidor seja necessária para que as outras partes do site funcionem corretamente, ou isso é simplesmente a preguiça da falta de recursos dos desenvolvedores, o que não permite um desempenho melhor (a CUL apareceu em janeiro de 2015, antes que não houvesse limite. de todo). <br><br><h2>  PS </h2><br><div class="spoiler">  <b class="spoiler_title">Ps antigo</b> <div class="spoiler_text">  Claro, o código jQuery é um exemplo bastante primitivo de recursos.  Atualmente, criei uma extensão do navegador para atender às minhas necessidades.  Ele adiciona botões de controle e renderiza perfis completos com fotos, um botão de convite e conexões mútuas.  Além disso, coleta dinamicamente filtros de locais, empresas e outras coisas e extrai um token dos cookies.  Então você não precisa codificar nada.  Além disso, a extensão adiciona campos de configurações adicionais, por exemplo, "quantos perfis solicitar de uma vez, até 49". <br><br><img src="https://habrastorage.org/webt/px/bb/6o/pxbb6o6qum-tnad0h7tcr6y_gja.png" alt="exemplo"><br><br>  Ainda estou trabalhando nessa extensão e pretendo disponibilizá-la ao público. <br>  Envie-me uma mensagem se estiver interessado. <br></div></div><br>  Pela demanda popular de lançar essa extensão como produto de código aberto, criei uma extensão do navegador e a publiquei para uso público (gratuito e mesmo sem mineradores).  Ele possui não apenas a funcionalidade de desvio de limite, mas também alguns outros recursos.  Você pode dar uma olhada e fazer o download aqui - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">adam4leos.github.io</a> <br><br>  Como esta é uma versão alfa, não hesite em me avisar sobre bugs, suas idéias ou até mesmo sobre um <br>  UI legal chapado.  Continuo melhorando a extensão e publicarei novas versões periodicamente. <br><br><h4>  <b>Atualização importante - o LinkedIn levou em consideração esse backdoor e, recentemente, eles o corrigiram.</b>  <b>O backdoor e o plug-in não funcionam mais.</b> </h4></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466801/">https://habr.com/ru/post/pt466801/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466781/index.html">Redes neurais em tempo real para rastreamento manual</a></li>
<li><a href="../pt466785/index.html">O que as montanhas ensinam: a escolha de um especialista em TI</a></li>
<li><a href="../pt466787/index.html">Pesquisa de texto completo no Android</a></li>
<li><a href="../pt466793/index.html">Startups no futebol russo: elas existem</a></li>
<li><a href="../pt466799/index.html">Maltego está mais perto do corpo. Parte 2</a></li>
<li><a href="../pt466803/index.html">Slurm DevOps. 3º dia. ELK, ChatOps, SRE. E a oração secreta do desenvolvedor</a></li>
<li><a href="../pt466805/index.html">Por que no futuro as naves espaciais serão feitas por extrusão</a></li>
<li><a href="../pt466807/index.html">Python, devorando o mundo: como um projeto paralelo de um desenvolvedor, tornou-se uma linguagem de programação popular</a></li>
<li><a href="../pt466809/index.html">O círculo está fechado. Como as mitaps me ajudaram a encontrar um emprego dos sonhos</a></li>
<li><a href="../pt466811/index.html">Histórico e alternativas à plataforma .NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>