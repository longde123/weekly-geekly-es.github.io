<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèÆ üë¥ üö´ Linux: Entfernen des Sperrpools / dev / random üö≤ ü§¥üèø ü§¶üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie Sie wissen, hat / dev / random, ein kryptografisch starker Pseudozufallszahlengenerator (CSPRNG), ein unangenehmes Problem - das Blockieren. Diese...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Linux: Entfernen des Sperrpools / dev / random</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/484736/"> Wie Sie wissen, hat / dev / random, ein kryptografisch starker Pseudozufallszahlengenerator (CSPRNG), ein unangenehmes Problem - das Blockieren.  Dieser Artikel beschreibt, wie man es l√∂st. <br><br>  In den letzten Monaten wurden die Mittel zur Erzeugung von Zufallszahlen im Kernel leicht √ºberarbeitet, die Probleme in diesem Subsystem wurden jedoch √ºber einen l√§ngeren <a href="https://lwn.net/Kernel/Index/">Zeitraum hinweg</a> gel√∂st.  Die <a href="https://lwn.net/Articles/802360/">letzten √Ñnderungen</a> wurden vorgenommen, um zu verhindern, dass der Systemaufruf getrandom () w√§hrend des Systemstarts f√ºr l√§ngere Zeit blockiert wird. Der Grund daf√ºr war jedoch das Verhalten des blockierenden zuf√§lligen Pools.  Ein neuer Patch w√ºrde diesen Pool entfernen und sollte voraussichtlich zum Hauptkern gehen. <br><br>  Andy Lutomirski ver√∂ffentlichte Ende Dezember die dritte Version des Patches.  Es nimmt <i>"zwei grundlegende semantische √Ñnderungen an den zuf√§lligen Linux-APIs vor".</i>  Der Patch f√ºgt dem Systemaufruf getrandom () das neue Flag GRND_INSECURE hinzu (obwohl Lutomirsky es als getentropy () bezeichnet, das in glibc mithilfe von getrandom () mit festen Flags implementiert wird).  Dieses Flag erzwingt, dass der Aufruf immer die angeforderte Datenmenge zur√ºckgibt, ohne jedoch zu garantieren, dass die Daten zuf√§llig sind.  Der Kernel wird einfach sein Bestes tun, um die besten Zufallsdaten zu liefern, die er zu einem bestimmten Zeitpunkt hat.  <i>"Wahrscheinlich ist das Beste, was Sie tun k√∂nnen, es" INSECURE "</i> (unsicher) zu nennen, um zu verhindern, dass es f√ºr Dinge verwendet wird, die Sicherheit ben√∂tigen." <a name="habracut"></a><br><br>  Patches entfernen auch den blockierenden Pool.  Derzeit unterst√ºtzt der Kernel zwei Pools von Zufallsdaten, von denen einer / dev / random und der andere / dev / urandom entspricht, wie in diesem <a href="https://lwn.net/Articles/658497/">Artikel von</a> 2015 <a href="https://lwn.net/Articles/658497/">beschrieben</a> .  Ein Blocking Pool ist ein Pool f√ºr / dev / random;  Der Lesevorgang f√ºr dieses Ger√§t wird blockiert (dh sein Name), bis vom System eine ausreichende Entropie erfasst wurde, um die Anforderung zu erf√ºllen.  Weitere Lesevorg√§nge aus dieser Datei werden ebenfalls blockiert, wenn nicht gen√ºgend Entropie im Pool vorhanden ist. <br><br>  Das Entfernen des Sperrpools bedeutet, dass sich das Lesen von / dev / random wie getrandom () verh√§lt, wobei der Flags-Wert auf Null gesetzt ist (und das Flag GRND_RANDOM in noop verwandelt).  Nach der Initialisierung des kryptografischen Zufallszahlengenerators (CRNG) wird beim Lesen von / dev / random und Aufrufen von getrandom (..., 0) die angeforderte Menge an Zufallsdaten nicht blockiert und zur√ºckgegeben. <br><br>  Lutomirsky sagt: <i>‚ÄûIch glaube, der Linux-Blocking-Pool ist veraltet.</i>  <i>CRNG Linux generiert eine Ausgabe, die selbst f√ºr die Schl√ºsselgenerierung gut genug ist.</i>  <i>Der Sperrpool ist in keiner Weise st√§rker und erfordert viel Infrastruktur von zweifelhaftem Wert, um ihn zu erhalten. ‚Äú</i> <br><br>  Die √Ñnderungen wurden mit dem Ziel vorgenommen, sicherzustellen, dass vorhandene Programme nicht wirklich darunter leiden. Tats√§chlich werden Probleme mit dem langen Warten auf Dinge wie das Generieren von GnuPG-Schl√ºsseln kleiner. <br><br>  <i>‚ÄûDiese Serien sollten keine bestehenden Programme verletzen.</i>  <i>/ dev / urandom bleibt unver√§ndert.</i>  <i>/ dev / random blockiert immer noch direkt nach dem Laden, aber es blockiert weniger als zuvor.</i>  <i>getentropy () mit vorhandenen Flags gibt ein Ergebnis zur√ºck, das f√ºr den Zweck genauso praktisch ist wie zuvor. "</i> <br><br>  Lutomirsky merkte an, dass die Frage offen bleibt, ob der Kern die sogenannten ‚Äûwahren Zufallszahlen‚Äú liefern sollte, was zum Teil vom blockierenden Kern h√§tte getan werden m√ºssen.  Er sieht daf√ºr nur einen Grund: "Einhaltung staatlicher Standards."  Lutomirsky schlug vor, dass der Kernel dies √ºber eine v√∂llig andere Schnittstelle bereitstellen oder in den Benutzerbereich √ºbertragen sollte, damit er nicht verarbeitete Ereignismuster abrufen kann, die zum Erstellen eines solchen Sperrpools verwendet werden k√∂nnen. <br><br>  Stephan M√ºller schlug vor, mit seinem <a href="https://lwn.net/ml/linux-kernel/2722222.P16TYeLAVu%40positron.chronox.de/">Patch-</a> Set f√ºr den Linux-Zufallszahlengenerator (LRNG) (Version 26 ist derzeit verf√ºgbar) echte Zufallszahlen f√ºr Anwendungen bereitzustellen, die diese ben√∂tigen.  LRNG "entspricht in vollem Umfang den Anforderungen der" Empfehlungen zu den Entropiequellen f√ºr die Erzeugung von Zufallsbits "SP800-90B" und ist damit eine L√∂sung f√ºr das Problem der staatlichen Standards. <br>  Matthew Garrett lehnte den Begriff "echte Zufallsdaten" ab und stellte fest, dass ausw√§hlbare Ger√§te im Prinzip so genau modelliert werden k√∂nnen, dass sie vorhersehbar sind: "Wir nehmen hier keine Quantenereignisse auf." <br><br>  M√ºller antwortete, dass der Begriff aus dem deutschen Standard AIS 31 stammt, um einen Zufallszahlengenerator zu beschreiben, der nur das Ergebnis "mit der gleichen Geschwindigkeit erzeugt, mit der die zugrunde liegende Rauschquelle Entropie erzeugt". <br><br>  Zus√§tzlich zu den Missverst√§ndnissen der Terminologie f√ºhrt das Vorhandensein eines Sperrpools, wie von den LRNG-Patches vorgeschlagen, einfach zu verschiedenen Problemen, zumindest wenn er ohne Berechtigungen verf√ºgbar ist. <br><br>  Wie Lutomirsky sagte: <i>‚ÄûDies l√∂st das Problem nicht.</i>  <i>Wenn zwei verschiedene Benutzer dumme Programme wie gnupg ausf√ºhren, ersch√∂pfen sie sich gegenseitig.</i>  <i>Ich sehe, dass es derzeit zwei Hauptprobleme mit / dev / random gibt: Es ist anf√§llig f√ºr DoS (d. H. Ressourcenverbrauch, sch√§dliche Einfl√ºsse oder √§hnliches), und da es keine Berechtigungen erfordert, um es zu verwenden, ist es auch Missbrauch unterworfen.</i>  <i>Gnupg ist falsch, es ist ein v√∂lliger Zusammenbruch.</i>  <i>Wenn wir eine neue nichtprivilegierte Schnittstelle hinzuf√ºgen, die Gnupg und √§hnliche Programme verwenden, werden wir wieder verlieren. ‚Äú</i> <br><br>  M√ºller stellte fest, dass das Hinzuf√ºgen von getrandom () GnuPG nun die Verwendung dieser Schnittstelle erm√∂glicht, da dies die notwendige Garantie daf√ºr bietet, dass der Pool initialisiert wurde.  Aufgrund von Gespr√§chen mit dem GnuPG-Entwickler Werner Koch ist M√ºller der Ansicht, dass die Garantie der einzige Grund ist, warum GnuPG derzeit direkt aus / dev / random liest.  Wenn es jedoch eine nichtprivilegierte Schnittstelle gibt, die einem Denial-of-Service (ab heute / dev / random) unterliegt, wird sie laut Lutomirsky von einigen Anwendungen missbraucht. <br><br>  Theodore Yue Tak Ts'o, der Entwickler des Linux-Subsystems f√ºr Zufallszahlen, scheint seine Meinung √ºber die Notwendigkeit eines Sperrpools ge√§ndert zu haben.  Er sagte, dass das L√∂schen dieses Pools die Idee, dass Linux einen echten Zufallszahlengenerator (TRNG) hat, effektiv loswerden w√ºrde: <i>"Dies ist kein Unsinn, da dies genau das ist, was * BSD immer getan hat."</i> <br><br>  Er ist auch besorgt dar√ºber, dass die Bereitstellung des TRNG-Mechanismus lediglich als Lockmittel f√ºr Anwendungsentwickler dienen wird und glaubt, dass es angesichts der verschiedenen von Linux unterst√ºtzten Hardwaretypen in der Realit√§t nicht m√∂glich ist, TRNG im Kernel zu garantieren.  Selbst die M√∂glichkeit, mit Ger√§ten zu arbeiten, die auf Root-Rechten basieren, wird das Problem nicht l√∂sen: <i>"Anwendungsentwickler geben aus Sicherheitsgr√ºnden an, dass ihre Anwendung als Root installiert wird, da nur so auf" wirklich gute "Zufallszahlen zugegriffen werden kann."</i> <br><br>  M√ºller fragte, ob Cao sich geweigert habe, den von ihm selbst seit langem vorgeschlagenen Sperrpool umzusetzen.  Cao erwiderte, dass er die Lutomirsky-Patches nehmen wolle und lehnte es aktiv ab, dem Kernel eine blockierende Schnittstelle hinzuzuf√ºgen. <br><br>  <i>‚ÄûDer Kernel kann keine Garantie daf√ºr geben, ob die Ger√§uschquelle ordnungsgem√§√ü charakterisiert wurde.</i>  <i>Das einzige, was ein GPG- oder OpenSSL-Entwickler bekommen kann, ist das vage Gef√ºhl, dass TRUERANDOM "besser" ist, und da sie mehr Sicherheit wollen, werden sie zweifellos versuchen, es zu verwenden.</i>  <i>Irgendwann wird es blockiert, und wenn ein anderer intelligenter Benutzer (vielleicht ein Distributionsspezialist) es in das Init-Skript einf√ºgt und die Systeme nicht mehr funktionieren, m√ºssen sich die Benutzer nur bei Linus Torvalds beschweren. ‚Äú</i> <br><br>  Cao bef√ºrwortet auch, Kryptographen und solchen, die TRNG wirklich ben√∂tigen, die M√∂glichkeit zu geben, ihre eigene Entropie im Benutzerbereich zu sammeln, damit sie sie nach Belieben verwenden k√∂nnen.  Er sagt, dass die Entropieerfassung kein Prozess ist, der vom Kernel auf allen Arten von Hardware durchgef√ºhrt werden kann, die von ihm unterst√ºtzt werden. Au√üerdem kann der Kernel selbst den Entropiebetrag, der von verschiedenen Quellen bereitgestellt wird, nicht sch√§tzen. <br><br>  <i>‚ÄûDer Kernel sollte nicht verschiedene Rauschquellen miteinander mischen und nat√ºrlich nicht behaupten, er wisse, wie viele Entropiebits er erh√§lt, wenn er versucht, ein f√ºr den h√§sslichen Benutzer einfaches‚Äû ruckeliges Entropiespiel ‚Äúauf einer CPU-Architektur zu spielen "IOT / Embedded-F√§lle, in denen alles nicht mit einem einzelnen Master-Generator synchronisiert ist, wenn es keine CPU-Anweisung zum Umordnen oder Umbenennen des Registers usw. gibt."</i> <i><br><br></i>  <i>‚ÄûWir k√∂nnen √ºber die Bereitstellung von Tools sprechen, die versuchen, diese Berechnungen durchzuf√ºhren, aber solche Dinge sollten an der Ausr√ºstung jedes Benutzers durchgef√ºhrt werden, was f√ºr die meisten Benutzer des Distributionskits einfach unpraktisch ist.</i>  <i>Wenn dies nur f√ºr Kryptografen gedacht ist, lassen Sie es in ihrem Benutzerbereich geschehen.</i>  <i>Und lassen Sie uns GPG, OpenSSL usw. nicht vereinfachen, damit alle sagen: "Wir wollen" echte Zuf√§lligkeit "und sind uns √ºber nichts weniger einig."</i>  <i>Wir k√∂nnen dar√ºber sprechen, wie wir Kryptographen Schnittstellen bereitstellen, damit diese die erforderlichen Informationen √ºber den Zugriff auf prim√§re, getrennte und benannte Rauschquellen erhalten und sich m√∂glicherweise die Rauschquelle in einer Bibliothek oder einer Anwendung im Benutzerbereich authentifizieren kann. ‚Äú</i> <br><br>  Es wurde ein wenig dar√ºber diskutiert, wie eine solche Schnittstelle aussehen k√∂nnte, da beispielsweise f√ºr einige Ereignisse Sicherheitsrisiken bestehen.  Cao stellte fest, dass Tastatur-Scan-Codes (dh Tastatureingaben) im Rahmen der Entropiesammlung in den Pool gemischt werden: "Die √úbertragung in den Benutzerraum, selbst durch einen privilegierten Systemaufruf, w√§re zumindest unvern√ºnftig."  Es ist m√∂glich, dass andere Ereignis-Timings eine Art Informationsleck √ºber Seitenkan√§le verursachen k√∂nnen. <br><br>  Daher besteht das Gef√ºhl, dass das langj√§hrige Problem des Linux-Zufallszahlen-Subsystems auf dem Weg zu einer L√∂sung ist.  Die √Ñnderungen, die das Zufallszahlensubsystem in letzter Zeit vorgenommen hat, f√ºhrten tats√§chlich nur zu DoS-Problemen bei seiner Verwendung.  Jetzt gibt es effektive M√∂glichkeiten, die besten Zufallszahlen zu ermitteln, die der Kernel bereitstellen kann.  Wenn TRNG f√ºr Linux immer noch w√ºnschenswert ist, muss dieses Manko in Zukunft behoben werden, aber h√∂chstwahrscheinlich nicht im Kernel selbst. <br><br><h3>  Ein bisschen Werbung :) </h3><br>  Vielen Dank f√ºr Ihren Aufenthalt bei uns.  M√∂gen Sie unsere Artikel?  M√∂chten Sie weitere interessante Materialien sehen?  Unterst√ºtzen Sie uns, indem Sie eine Bestellung aufgeben oder Ihren Freunden <a href="https://ua-hosting.company/cloudvps/nl">Cloud-basiertes VPS f√ºr Entwickler ab 4,99 US-Dollar</a> empfehlen, ein <b>einzigartiges Analogon zu Einstiegsservern, das wir f√ºr Sie erfunden haben:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">Die ganze Wahrheit √ºber VPS (KVM) E5-2697 v3 (6 Kerne) 10 GB DDR4 480 GB SSD 1 Gbit / s ab 19 Dollar oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verf√ºgbar). <br><br>  <b>Dell R730xd 2-mal billiger im Equinix Tier IV-Rechenzentrum in Amsterdam?</b>  Nur wir haben <b><a href="https://ua-hosting.company/serversnl">2 x Intel TetraDeca-Core Xeon 2 x E5-2697v3 2,6 GHz 14C 64 GB DDR4 4 x 960 GB SSD 1 Gbit / s 100 TV ab 199 US-Dollar</a> in den Niederlanden!</b>  <b><b>Dell R420 - 2x E5-2430 2,2 GHz 6C 128 GB DDR3 2x960 GB SSD 1 Gbit / s 100 TB - ab 99 US-Dollar!</b></b>  Lesen Sie mehr √ºber <a href="https://habr.com/company/ua-hosting/blog/329618/">das Erstellen von Infrastruktur-Bldg.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">Klasse mit Dell R730xd E5-2650 v4 Servern f√ºr 9.000 Euro f√ºr einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de484736/">https://habr.com/ru/post/de484736/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de484724/index.html">Neuigkeiten aus der Welt von OpenStreetMap Nr. 494 (21.12.2019-06.01.2020)</a></li>
<li><a href="../de484728/index.html">Mystery Shopper von CityMobile</a></li>
<li><a href="../de484730/index.html">Dell Inspiron 7490: Leichtmetall-Laptop f√ºr jeden Tag mit hervorragender Autonomie</a></li>
<li><a href="../de484732/index.html">Was ist VMware und warum ist die Kompatibilit√§t mit SSDs wichtig?</a></li>
<li><a href="../de484734/index.html">Was auf der CES im 19. und 20. Jahrhundert h√§tte pr√§sentiert werden k√∂nnen</a></li>
<li><a href="../de484738/index.html">Exemplarische Vorgehensweise f√ºr die kontinuierliche Integration von Laravel 6 in Google Cloud Run</a></li>
<li><a href="../de484740/index.html">Sicherheitswoche 04: Kryptoprobleme in Windows 10</a></li>
<li><a href="../de484744/index.html">Wie ich 2D-Schatten in Unity gemacht habe</a></li>
<li><a href="../de484750/index.html">Schizophrenie: ein Blick nach</a></li>
<li><a href="../de484752/index.html">Schreiben eines Laptop-Treibers f√ºr Spa√ü und Gewinn oder Festschreiben des Kernels, auch wenn Sie nicht so schlau sind</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>