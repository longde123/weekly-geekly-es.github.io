<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§ ğŸ–²ï¸ ğŸ± Implementasi tingkat rendah dari trif prefix tree di PHP ğŸ“ƒ ğŸ¤œğŸ¿ ğŸ¤¾ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kata Pengantar 
 Implementasi PHP trie yang dijelaskan di sini membuat kamus terlalu gemuk sejauh ini, yang karenanya membutuhkan waktu cukup lama unt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementasi tingkat rendah dari trif prefix tree di PHP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416191/"><h2>  Kata Pengantar </h2><br>  Implementasi PHP trie yang dijelaskan di sini membuat kamus terlalu gemuk sejauh ini, yang karenanya membutuhkan waktu cukup lama untuk dimuat ke dalam memori, yang meningkatkan kecepatan kerjanya.  Kecepatan pencarian ~ 80 ribu kata per detik.  Kamus ini dibuat dari daftar lemmas kamus opencorpora.org dan mencakup 389844 kata.  Dalam bentuk yang tidak terkompresi, kamus berbobot ~ 150mb, dan gzip ~ 6mb terkompresi.  Namun, hasil kinerja yang cukup bagus membuktikan bahwa dalam PHP murni Anda dapat membuat pohon awalan trie yang berfungsi penuh. <br><a name="habracut"></a><br>  Saya meminta para programmer terlebih dahulu untuk membuat kritikus sastra agar tidak menulis komentar jahat.  Artikel ini harus menarik bagi pemula, seperti saya sendiri.  Terlalu malas membaca, Anda bisa langsung melihat kode di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">github</a> . <br><br><h2>  Bagaimana semuanya dimulai </h2><br>  Untuk beberapa waktu sekarang saya telah menetas ide untuk menulis analisa morfologis untuk proyek PHP saya, yang akan dapat dengan cepat melakukan analisis morfologis kata-kata yang diberikan, serta mengubah kata-kata menjadi bentuk morfologis yang diinginkan. <br><br>  PHP sudah memiliki perpustakaan serupa yang disebut phpmorhy.  Ini bekerja cukup cepat dan saya akan menggunakannya dan tidak akan menciptakan apa pun, tetapi kompiler kamus di dalamnya dibuat sebagai aplikasi non-PHP yang terpisah, yang membuat saya tidak mungkin menggunakan perpustakaan ini.  Perpustakaan itu sendiri dibangun berdasarkan kamus AOT yang telah lama ditunggu-tunggu, yang semakin mengurangi kegunaannya. <br><br>  Berminggu-minggu dan berbulan-bulan berlalu, saya membaca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebuah artikel oleh</a> Khabrovchanin, lalu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebuah artikel oleh</a> I. Segalovich tentang algoritma morfologis yang cepat untuk mesin pencari, kemudian banyak artikel yang berbeda. <br><br>  Sedikit demi sedikit, saya telah matang untuk menulis <s>lunapark</s> saya sendiri <s>dengan blackjack dan tulang-tulang seorang</s> penganalisa morfologis.  Saya pikir: " <i>Ya, kemajuan telah melangkah maju, dalam PHP Anda sudah dapat menguraikan genom manusia!</i> " <br><br>  Saya mengambil kamus opencorpora.org, memasukkannya ke mysql dan mendapatkan kecepatan pencarian 2 ribu kata per detik.  Saya pikir perlu memuat kamus ke dalam memori.  Dan di sini ternyata bahwa untuk memiliki struktur data reguler tersedia di PHP seperti array atau objek, Anda perlu menyimpan sekitar 3 GB RAM untuk kamus 3 juta.  Semua implementasi php trie yang saya temui hanya cocok sebagai tutorial untuk menunjukkan logika kerja, karena mereka sendiri dibangun di atas struktur penyimpanan data PHP asli. <br><br><h2>  Perangkat penyimpanan kamus dan prinsip operasi </h2><br>  Di mana pun saya bisa membaca, mendengarkan, atau melihat pohon awalan trie, tidak dijelaskan dengan tepat bagaimana data akan disimpan dalam memori.  Di sini kita memiliki simpul, dan inilah pewarisnya, dan inilah bendera akhir kata, yang tidak diperlihatkan di bawah tenda.  Karena itu, saya harus menemukan metode penyimpanan sendiri. <br><br>  Seperti yang Anda tahu, pohon awalan trie terdiri dari node.  Node menyimpan awalan, tautan ke simpul berikutnya (keturunan), dan penunjuk ke fakta bahwa awalan ini adalah yang terakhir dalam rantai.  Orang India mengatakan dengan cukup cerdas tentang trie di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Node dalam implementasi trie saya adalah blok data dengan panjang tetap 154 â€‹â€‹byte.  6 byte pertama (48 bit) berisi bit mask dari ahli waris.  46 bit pertama adalah alfabet Rusia, angka, tanda kutip, tanda hubung dan apostrof.  Apostrof ditambahkan karena dalam kamus opencorpora.org ada kata "cote d'ivoire", yang menggunakan tanda apostrof.  Bit ke-47 digunakan untuk menyimpan kata end flag.  148 byte berikut setelah bitmask digunakan untuk menyimpan referensi ke pewaris node.  3 byte per karakter (46 * 3 = 148). <br><br>  Node disimpan sebagai data biner dalam sebuah string.  Akses ke bagian yang diinginkan dilakukan menggunakan fungsi substr () dan membongkar berikutnya () membongkar. <br><br>  Menggunakan node dengan panjang tetap menyederhanakan proses pengalamatan.  Untuk beralih ke node yang diinginkan, cukup mengetahui nomor seri (id) dan panjang node.  Kami mengalikan nomor seri dengan panjang dan mencari offset relatif ke awal baris - semuanya sangat sederhana. <br><br><h4>  gbr.  1 Skema Penyimpanan </h4><br><img src="https://habrastorage.org/webt/z_/m8/yg/z_m8yg9qtvtn5niwisxq_tjehsa.png"><br><br><h2>  Kekurangan </h2><br>  Skema penyimpanan yang digunakan menyederhanakan pengalamatan, tetapi memakan banyak ruang.  Penyimpanan 380 ribu kata membutuhkan lebih dari satu juta node.  154 byte * 1.000.000 node = 146,86 megabita.  Yaitu  sekitar 400 byte per kata.  Jika Anda menulis kata-kata dalam file teks sederhana yang disandikan dalam utf8, maka 380 ribu kata yang sama ini dapat dimuat dalam 16 megabita. <br><br><h2>  Paket </h2><br>  Untuk menggunakan memori lebih rasional, saya ingin beralih ke panjang variabel variabel, maka sebagai tautan saya harus merekam bukan id node, tetapi lokasinya dalam byte.  Lokasi tautan ke simpul yang diinginkan akan ditentukan sebagai berikut.  Pada contoh kata "abv." <br><br>  Huruf "a" adalah yang pertama dalam alfabet, oleh karena itu, simpulnya juga yang pertama, masing-masing, offset 0. Baca 6 byte, mulai dari 0. <br><br><pre><code class="php hljs">$str = substr($dic, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>);</code> </pre> <br>  Buka kemasan garis: <br><br><pre> <code class="php hljs">$mask = (ord($str[<span class="hljs-number"><span class="hljs-number">5</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">40</span></span>) + (ord($str[<span class="hljs-number"><span class="hljs-number">4</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">32</span></span>) + (ord($str[<span class="hljs-number"><span class="hljs-number">3</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (ord($str[<span class="hljs-number"><span class="hljs-number">2</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (ord($str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + ord($str[<span class="hljs-number"><span class="hljs-number">0</span></span>]);</code> </pre> <br>  Kami melihat topeng bit ke-2 (huruf "b") <br><br><pre> <code class="php hljs">bit_get($mask, <span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre> <br>  Bit diatur, sekarang kita menghitung jumlah bit yang dinaikkan di dalam mask menjadi 2. Katakanlah bit dari huruf "a" juga dinaikkan pada node kita, jadi bit kita dari huruf "b" akan menjadi bit kedua yang diangkat.  Hitung offset untuk membaca tautan <br><br><pre> <code class="php hljs">$offset = <span class="hljs-number"><span class="hljs-number">6</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> <br>  6 byte topeng + 3 byte, yang menempati tautan pertama, ternyata 9 byte.  Kami membaca seutas tali yang diinginkan. <br><br><pre> <code class="php hljs">$str = substr($dic, $offset, <span class="hljs-number"><span class="hljs-number">3</span></span>);</code> </pre> <br>  Buka kemasan tautan: <br><br><pre> <code class="php hljs">$ref = (ord($str[<span class="hljs-number"><span class="hljs-number">2</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (ord($str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + ord($str[<span class="hljs-number"><span class="hljs-number">0</span></span>]);</code> </pre> <br>  Pergi ke simpul berikutnya dan ulangi semuanya lagi.  Dalam surat terakhir, kami memeriksa keberadaan 47 bit di topeng, jika diatur, ada kata pencarian di trie kami. <br><br>  Saya berharap bahwa mungkin untuk mempertahankan kecepatan setidaknya 50 ribu kata per detik. <br><br><h2>  Ucapan Terima Kasih </h2><br>  Saya ingin mengucapkan terima kasih kepada para peserta forum nulled.cc dan php.ru atas bantuan mereka dengan fungsi bitwise. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id416191/">https://habr.com/ru/post/id416191/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id416179/index.html">Sebuah pintu yang menyapa kita dengan nama dan hanya terbuka untuk karyawan departemen</a></li>
<li><a href="../id416181/index.html">Modulasi Amplitudo pada Jari</a></li>
<li><a href="../id416183/index.html">Pengujian Data: Persyaratan dan Level</a></li>
<li><a href="../id416187/index.html">Mengikuti pertemuan "PostgreSQL 11 Fitur Baru" (Bagian 2)</a></li>
<li><a href="../id416189/index.html">Perawatan Scrum "mekanis". Bagian 3. Pekerjaan SM</a></li>
<li><a href="../id416193/index.html">Bagaimana robot dapat bekerja dengan manusia bersama (dan bukan sebaliknya)</a></li>
<li><a href="../id416195/index.html">Dijkstra untuk waktu linier</a></li>
<li><a href="../id416197/index.html">Mesin untuk program DARPA baru berhasil lulus tes</a></li>
<li><a href="../id416199/index.html">Penyelidikan fajar mengirim tembakan terperinci bintik putih Ceres: ini adalah soda biasa</a></li>
<li><a href="../id416201/index.html">3 game papan sci-fi keren dalam Bahasa Inggris</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>