<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïØÔ∏è üë©‚Äçüé§ üéÑ Eigene Videoplattform oder wie man viele Computerressourcen beansprucht. Teil 1 üî∂ üë®üèΩ‚Äçüíº ü¶é</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auf dem Foto - das erste fliegende Allrad. Quelle 

 Aufgrund der Verf√ºgbarkeit der erforderlichen Dienste ist das Posten von Videos im Netzwerk heute...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eigene Videoplattform oder wie man viele Computerressourcen beansprucht. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436568/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/il/db/l0/ildbl0rgeufxd3tgzdstzyosr5a.jpeg" width="500"></div>  <sub>Auf dem Foto - das erste fliegende Allrad.</sub>  <sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a></sub> <br><br>  Aufgrund der Verf√ºgbarkeit der erforderlichen Dienste ist das Posten von Videos im Netzwerk heute keine schwierige Aufgabe.  Es gibt jedoch nicht so viele Materialien zur internen Struktur solcher Systeme, insbesondere im russischsprachigen Segment. <br><br>  Ich bin seit einiger Zeit am Design und der Entwicklung einer hochwertigen Videoplattform beteiligt.  In diesem Artikel m√∂chte ich jene Momente beschreiben, die ich selbst zu Beginn der Entwicklung wissen m√∂chte. <br><br>  Der Artikel beansprucht keinen F√ºhrungsstatus. Ich werde versuchen, nur interessante oder nicht offensichtliche Punkte zu beschreiben, die sich auf die Verarbeitung und Bereitstellung von HTML5-basierten Videoinhalten auswirken. <br>  Das Material richtet sich an Personen, die sich bereits mit dem Thema befassen oder nach einer Aufschl√ºsselung der Abk√ºrzungen, Begriffe und Konzepte suchen. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der zweite Teil.</a> <br><a name="habracut"></a><br><h3>  Formatieren </h3><br>  H264 Trotz seiner Beliebtheit stellt sich heraus, dass es nicht √ºberall funktioniert - einige Browser bieten keine Unterst√ºtzung.  Gl√ºcklicherweise funktioniert VP8 / 9 auf modernen Ger√§ten fast √ºberall dort, wo H264 nicht unterst√ºtzt wird.  VP9 ist vorzuziehen, da  Ich habe keine √§lteren Versionen von Decodern gesehen, die VP8 k√∂nnen, aber nicht VP9 oder H264.  VP9 bietet eine vergleichbare Bildqualit√§t wie H264, wenn die Bitrate um ~ 30% niedriger ist - dies ist wichtig, um die Belastung der Kan√§le zu verringern.  Wenn die Verwendung des MPEG-Codecs m√∂glicherweise rechtliche Anspr√ºche hat (eine sehr komplizierte Geschichte), ist VP9 damit gut zurechtgekommen.  Zwar ist die Codierungsgeschwindigkeit von VP9 um eine Gr√∂√üenordnung niedriger, daher m√ºssen mehr Ressourcen f√ºr seine Verarbeitung zugewiesen werden. <br><br>  Wenn alte Ger√§te unterst√ºtzt werden m√ºssen, die mit H264 High nicht umgehen k√∂nnen, k√∂nnen Sie als drittes Format 480p H264 Main mit einer niedrigeren Bitrate hinzuf√ºgen. <br><br>  Hi10P ist aufgrund der schlechten Hardware-Dekodierungsunterst√ºtzung massiv besser nicht zu verwenden. <br>  F√ºr H265 sind nat√ºrlich Lizenzgeb√ºhren erforderlich, was nicht jedermanns Sache ist. <br><br><h3>  Weich gegen hart </h3><br>  Hardware-Encoder nutzen die meisten erweiterten Funktionen der Codecs nicht (spart Platz auf Chips) und geben nicht optimal codierte Dateien aus.  Die Auswahl des Formats ist begrenzt, nicht alle k√∂nnen mit Codierungsparametern konfiguriert werden - oft gibt es von den Werten, die das Ergebnis wirklich beeinflussen, nur eine Bitrate, und selbst das wird sehr eigenartig wahrgenommen.  Wenn alles so gemacht wird, wie es sollte, k√∂nnen Sie auf normalen Chips ein v√∂llig vern√ºnftiges Ergebnis mit einer linearen (Auswirkung in dynamischen Szenen) und einer etwas h√∂heren Bitrate erzielen. <br><br>  Und damit der Hardware-Encoder funktioniert, ben√∂tigen Sie nat√ºrlich ein Ger√§t - eine Grafikkarte oder einen Prozessor mit einem Videokern, der nicht auf allen Servern vorhanden ist. <br><br>  Aber sie sind schnell.  Sehr.  Im Vergleich zur Softwareverarbeitung kann die Geschwindigkeit einige hundert Mal so hoch werden, dass die Festplatten-E / A m√∂glicherweise nicht mehr ausreicht. <br><br>  Die Verarbeitung mit Hardwaremethoden h√§ngt stark vom L√∂sungsanbieter ab. Jeder Anbieter verf√ºgt √ºber eigene Bibliotheken und Dienstprogramme, und es stehen zahlreiche Optionen zur Auswahl: Intel Quick Sync, NVenc, AMD VCE. <br><br>  Bei der Softwareverarbeitung gibt es keine derartigen Einschr√§nkungen, und bei gleichwertiger Bitrate ist das Ergebnis besser.  F√ºr die Arbeit mit verschiedenen Formaten und Codecs gibt es ffmpeg;  "Apparatschiks" haben keinen solchen Luxus (mit Vorbehalt). <br><br><h3>  Videoqualit√§tskriterien </h3><br>  Um die Zielqualit√§t zu bestimmen, ist es am einfachsten, BPP-Bits pro Pixel einzulesen.  Diese Einstellung ist unabh√§ngig von Aufl√∂sung, Bildrate und Dauer.  Ber√ºcksichtigen Sie dabei bereits die Bitrate nach der Formel <br><pre><code class="plaintext hljs">BPP * Framerate * Width * Height</code> </pre>  Die besten BPP-Werte werden am besten durch unabh√§ngige Experimente f√ºr das Video ausgew√§hlt, das Sie verarbeiten m√∂chten.  Ein guter Anfangswert f√ºr H264 liegt bei 0,09 bps.  Bei Hochleistungscodecs wie H265 und VP9 kann dieser Parameter proportional zum vergleichenden Komprimierungsverh√§ltnis reduziert werden.  Au√üerdem kann der BPP f√ºr hochaufl√∂sende Videos leicht reduziert werden  Die Effizienz von Codecs nimmt mit der Aufl√∂sung leicht zu. Bei dieser Korrektur m√ºssen Sie jedoch die Aufl√∂sung des Codierungsabschnitts ber√ºcksichtigen (Slices, eine Funktion von Codecs, mit der Sie Videos mit halbunabh√§ngigen fraktionalen Aufl√∂sungsbl√∂cken codieren k√∂nnen). <br><br>  F√ºr die durch die obige Formel erhaltene Bitrate ist es ratsam, die Maximalwerte basierend auf der erwarteten Internetgeschwindigkeit des Clients vorab festzulegen. Nur wenige Menschen k√∂nnen ein sehr hochwertiges, aber st√§ndig gepuffertes Video bequem ansehen. <br><br>  Aus diesem Grund ist es unpraktisch, Q-Parameter von Codecs (Qualit√§tspapageien) zu verwenden - feste Werte ergeben eine unvorhersehbare endg√ºltige Bitrate. <br><br>  maxRate ist besser mit einem Rand gemacht, weil  Codecs halten die erforderlichen Werte m√∂glicherweise selbst bei Codierung mit zwei Durchg√§ngen nicht genau ein. <br><br>  Um die Qualit√§t dynamischer Szenen aufrechtzuerhalten, ist es besser, den VBR-Modus von Codecs zu aktivieren. MinRate ist jedoch besser, mindestens 90% der Gesamtbitrate festzulegen, damit Ratenspitzen nicht zu Pufferunterl√§ufen f√ºhren. <br><br>  Dienstprogramme wie Intel VPA, ffprobe und Python sind bei der Qualit√§tskontrolle hilfreich.  Mit letzterem ist es zweckm√§√üig, Vergleiche zwischen der Quelle und dem konvertierten Video anzustellen und beliebige Metriken wie die durchschnittliche Abweichung von Pixeln zu lesen. <br><br>  Die Berechnung von PSNR und SSIM ist in der Praxis aufgrund psychovisueller Optimierungen, die standardm√§√üig in Codecs enthalten sind, √§u√üerst ineffizient.  Wenn Sie diese Metriken mehr oder weniger angemessen berechnen m√∂chten, k√∂nnen Sie Optimierungen √ºber deaktivieren <pre> <code class="plaintext hljs">-tune [psnr|ssim]</code> </pre>  Die endg√ºltige Datei unterscheidet sich nat√ºrlich von der ohne diese Flags. <br><br><h3>  Vorschau </h3><br>  Das Hauptproblem beim Generieren von Miniaturbildern ist eine unscharfe Quelle.  Die Definition und Suche nach klaren Bildern ist eine nicht triviale und ressourcenintensive Aufgabe.  Gl√ºcklicherweise ist die L√∂sung f√ºr dieses Problem in den meisten Codecs im Videokodierungsprozess enthalten.  Sie k√∂nnen den Keyframe nehmen, der einer bestimmten Position am n√§chsten liegt. Von allen Frames, die ihn umgeben, ist er der klarste.  In ffmpeg kann dies folgenderma√üen geschehen: <br><br><pre> <code class="plaintext hljs">-ss [] -vf \"select='eq(pict_type,PICT_TYPE_I)'\" -vsync vfr</code> </pre> <br>  Standard-Encoder werden nicht optimal komprimiert. Nach dem Empfang des Bildes ist es daher besser, es mit etwas wie optipng zu quetschen, wodurch bei FHD-Voransichten durchschnittlich 500 KB eingespart werden. <br><br>  Hochaufl√∂sende Bilder werden am besten interlaced gemacht.  Daher werden wir die Gr√∂√üe leicht erh√∂hen (um 5-10%), aber die Anzeigezeit auf der Ladeseite erheblich verk√ºrzen. <br><br>  Der Artikel hat sich bereits als dicht herausgestellt, und ich habe Zweifel, dass alle Informationen in einem gro√üen Text zusammengefasst werden m√ºssen.  Wenn Sie daran interessiert sind, dieses Thema fortzusetzen, schreiben Sie in die Kommentare oder markieren Sie in der Umfrage. <br><br>  Die Plattform ist geschlossen, aber Sie k√∂nnen ihre Arbeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier sehen</a> . <br><br>  <sub>* Ich habe keine Beziehung zu den Autoren der jeweiligen Websites und kann deren Ansichten und Meinungen nicht teilen.</sub>  <sub>Ich kann die Entscheidungen dar√ºber, wem und wie der Zugriff auf den Code gew√§hrt wird, nicht kommentieren.</sub> <br><br>  Bereit, Fragen zu beantworten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436568/">https://habr.com/ru/post/de436568/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436554/index.html">√úbertragen Sie 30.000 Codezeilen von Flow nach TypeScript</a></li>
<li><a href="../de436556/index.html">Jobs in einem deutschen Unternehmen - wie bewerbe ich mich und bekomme keine Ablehnung?</a></li>
<li><a href="../de436558/index.html">Alles Gute zum 18. Geburtstag, Wikipedia; Wir feiern das Erwachsenwerden eines guten Projekts</a></li>
<li><a href="../de436560/index.html">Kryptografische Protokolle f√ºr die elektronische Abstimmung</a></li>
<li><a href="../de436564/index.html">Wie ProGuard funktioniert</a></li>
<li><a href="../de436570/index.html">Programmierer Exorzismus</a></li>
<li><a href="../de436572/index.html">Skolkovo Cybersecurity Challenge 2019 Wettbewerb f√ºr Cybersecurity-Projekte</a></li>
<li><a href="../de436578/index.html">Pers√∂nlicher Sicherheitspreis f√ºr Direktoren gro√üer IT-Unternehmen pro Jahr</a></li>
<li><a href="../de436584/index.html">Runet Management Law - Umsetzung von Bestimmungen und Verantwortungsbereichen</a></li>
<li><a href="../de436586/index.html">JS Battle: Wie ich meine Bewertung geschrieben habe ()</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>