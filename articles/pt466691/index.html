<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè£ üë©‚Äçüë©‚Äçüëß ü§ûüèΩ Ent√£o, todos da mesma RAML ou OEA (Swagger)? üëù üë©üèø‚Äçü§ù‚Äçüë®üèΩ üéç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No mundo din√¢mico dos microsservi√ßos, tudo pode mudar - qualquer componente pode ser reescrito em outro idioma usando diferentes estruturas e arquitet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ent√£o, todos da mesma RAML ou OEA (Swagger)?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/466691/">  No mundo din√¢mico dos microsservi√ßos, tudo pode mudar - qualquer componente pode ser reescrito em outro idioma usando diferentes estruturas e arquitetura.  Somente os contratos devem permanecer inalterados, para que seja poss√≠vel interagir com o microsservi√ßo a partir do exterior de maneira permanente, independentemente das metamorfoses internas.  E hoje falaremos sobre o nosso problema de escolher um formato para descrever contratos e compartilhar artefatos encontrados. <br><br><img src="https://habrastorage.org/webt/x2/vf/ry/x2vfryzr_9r4fmxsm1ggh7xsskg.jpeg"><br><a name="habracut"></a><br>  O post foi preparado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anna Melekhova</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vladimir Lapatin</a> <br><br>  <b>Microsservi√ßos.</b>  Ao desenvolver o Acronis Cyber ‚Äã‚ÄãCloud, percebemos que n√£o pod√≠amos fugir deles.  E projetar um microsservi√ßo √© imposs√≠vel sem formalizar um contrato, que √© a interface de um microsservi√ßo. <br><br>  Mas quando um produto cont√©m mais de um componente, e o desenvolvimento de um contrato se torna uma atividade regular, voc√™ involuntariamente come√ßa a pensar em otimizar o processo.  Torna-se √≥bvio que a interface (contrato) e a implementa√ß√£o (microsservi√ßo) devem corresponder um ao outro, que componentes diferentes devem fazer as mesmas coisas da mesma forma e que, sem uma ado√ß√£o centralizada de todas essas decis√µes, cada equipe ser√° for√ßada a gastar tempo para obt√™-las repetidas vezes . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58e/abe/9a0/58eabe9a07a07742389fbc3de927d6a5.jpg" alt="imagem"><br>  <i>Layout de microsservi√ßo da Amazon do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tweet</a> de Werner Vogelis, Amazon CTO</i> <br>  Qual √© o dilema?  De fato, existem duas maneiras pelas quais os microsservi√ßos interagem - HTTP Rest e gRPC do Google.  N√£o querendo se envolver na pilha de tecnologias do Google, escolhemos o HTTP Rest.  As anota√ß√µes dos contratos HTTP REST s√£o descritas com mais freq√º√™ncia em um dos dois formatos: RAML e OEA, anteriormente conhecido como Swagger, portanto, cada equipe de desenvolvimento enfrenta a necessidade de escolher um dos padr√µes.  Mas, como se viu, fazer essa escolha pode ser muito dif√≠cil. <br><br><h3>  Por que anota√ß√µes? </h3><br>  √â necess√°ria uma anota√ß√£o para que um usu√°rio externo possa descobrir facilmente o que pode ser feito com o seu servi√ßo atrav√©s de sua interface HTTP.  Ou seja, em um n√≠vel b√°sico, a anota√ß√£o deve conter pelo menos uma lista de recursos dispon√≠veis, seus m√©todos HTTP, corpos de solicita√ß√£o, uma lista de par√¢metros, uma indica√ß√£o dos cabe√ßalhos necess√°rios e suportados, bem como c√≥digos de retorno e formatos de resposta.  Um elemento extremamente importante da anota√ß√£o do contrato √© sua descri√ß√£o verbal (‚Äúo que acontece se voc√™ adicionar esse par√¢metro de consulta √† solicita√ß√£o?‚Äù, ‚ÄúNesse caso, o c√≥digo 400 retornar√°?‚Äù) <br><br>  No entanto, quando se trata de desenvolver um grande n√∫mero de microsservi√ßos, quero obter benef√≠cios adicionais das anota√ß√µes escritas.  Por exemplo, com base no RAML / Swagger, voc√™ pode gerar o c√≥digo do cliente e do servidor em um grande n√∫mero de linguagens de programa√ß√£o.  Voc√™ tamb√©m pode receber automaticamente a documenta√ß√£o do microsservi√ßo e envi√°-la para o portal do desenvolvedor :). <br><br><img src="https://habrastorage.org/webt/l2/b1/lt/l2b1ltgjao7oeoqqvvrpkv0hnhg.png"><br>  <i>Um exemplo de descri√ß√£o de contrato estruturado</i> <br><br>  Menos comum √© a pr√°tica de testar microsservi√ßos com base em descri√ß√µes de contrato.  Se voc√™ escreveu uma anota√ß√£o e um componente, pode criar um autoteste que verifique a adequa√ß√£o do servi√ßo com v√°rios tipos de dados de entrada.  O servi√ßo retorna um c√≥digo de resposta que n√£o est√° descrito na anota√ß√£o?  Ser√° capaz de processar corretamente dados incorretamente intencionais? <br><br>  Al√©m disso, a implementa√ß√£o de alta qualidade n√£o apenas dos contratos em si, mas tamb√©m das ferramentas para visualizar anota√ß√µes facilita o trabalho com o microsservi√ßo.  Ou seja, se o arquiteto descreveu qualitativamente o contrato, seus projetistas e desenvolvedores implementar√£o o servi√ßo em outros produtos sem custos adicionais de tempo. <br><br>  Para a opera√ß√£o de ferramentas adicionais, a RAML e a OEA t√™m a capacidade de adicionar metadados que n√£o s√£o fornecidos pelo padr√£o ( <a href="">por exemplo, isso √© feito na OEA</a> ). <br><br>  Em geral, o campo da criatividade na aplica√ß√£o de contratos para microsservi√ßos √© enorme ... pelo menos teoricamente <br><br><h3>  Compara√ß√£o de um ouri√ßo com uma cobra </h3><br>  Atualmente, a √°rea de desenvolvimento priorit√°rio da Acronis √© o desenvolvimento da Acronis Cyber ‚Äã‚ÄãPlatform.  Acronis Cyber ‚Äã‚ÄãPlatform - esses s√£o novos pontos de integra√ß√£o de servi√ßos de terceiros com o Acronis Cyber ‚Äã‚ÄãCloud e parte do agente.  Embora nossas APIs internas descritas em RAML estivessem bem conosco, a necessidade de publicar a API novamente levantou a quest√£o da escolha: qual padr√£o de anota√ß√£o √© melhor usar em nosso trabalho? <br><br>  Inicialmente, parecia haver duas solu√ß√µes - esses eram os desenvolvimentos mais comuns do RAML e do Swagger (ou OEA).  Mas, de fato, as alternativas s√£o pelo menos n√£o 2, mas 3 ou mais. <br><br>  Por um lado, existe o RAML - uma linguagem poderosa e eficaz.  Ele implementa bem a hierarquia e a heran√ßa; portanto, esse formato √© mais adequado para grandes empresas que precisam de muitas descri√ß√µes - ou seja, n√£o um produto, mas muitos microsservi√ßos que possuem partes comuns de contratos - esquemas de autentica√ß√£o, os mesmos tipos de dados, corpos de erro. <br><br>  Mas o desenvolvedor de RAML, Mulesoft, ingressou no cons√≥rcio Open API que est√° desenvolvendo o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://www.google.com/url%3Fq%3D">Swagger</a> .  Portanto, a RAML suspendeu seu desenvolvimento.  Para imaginar o formato do evento, imagine que os mantenedores dos principais componentes do Linux foram trabalhar na Microsoft.  Essa situa√ß√£o cria os pr√©-requisitos para o uso do Swagger, que est√° se desenvolvendo dinamicamente e, na √∫ltima terceira vers√£o, praticamente alcan√ßa a RAML em termos de flexibilidade e funcionalidade. <br><br><h3>  Se n√£o fosse por um, mas ... </h3><br>  Como se viu, nem todos os utilit√°rios de c√≥digo aberto foram atualizados para a vers√£o OAS 3.0.  Para microsservi√ßos no Go, o mais cr√≠tico ser√° a falta de adapta√ß√£o do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">go-swagger</a> √† vers√£o mais recente do padr√£o.  No entanto, a diferen√ßa entre o Swagger 2 e o Swagger 3 √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">enorme</a> .  Por exemplo, na terceira vers√£o, os desenvolvedores: <br><br><ul><li>  descri√ß√£o aprimorada dos esquemas de autentica√ß√£o </li><li>  suporte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">completo</a> para o esquema JSON </li><li>  bombeado a capacidade de adicionar exemplos </li></ul><br>  A situa√ß√£o √© engra√ßada: ao escolher um padr√£o, voc√™ precisa considerar o RAML, o Swagger 2 e o Swagger 3 como alternativas separadas.  No entanto, apenas o Swagger 2 tem um bom suporte para o kit de ferramentas OpenSource.  A RAML √© muito flex√≠vel ... e complexa, e o Swagger 3 √© pouco suportado pela comunidade; portanto, voc√™ precisa usar ferramentas propriet√°rias ou solu√ß√µes comerciais, que geralmente s√£o muito caras. <br><br>  Ao mesmo tempo, se houver muitos recursos interessantes no Swagger, como o portal pronto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">editor.swagger.io</a> , no qual voc√™ pode baixar a anota√ß√£o e obter sua visualiza√ß√£o com uma descri√ß√£o detalhada, links e links, n√£o h√° essa possibilidade de uma RAML mais fundamental e menos amig√°vel.  Sim, voc√™ pode procurar algo entre os projetos no GitHub, encontrar um anal√≥gico l√° e implant√°-lo voc√™ mesmo.  No entanto, em qualquer caso, algu√©m precisar√° oferecer suporte ao portal, o que n√£o √© t√£o conveniente para as necessidades b√°sicas de teste ou uso.  Al√©m disso, o swagger √© mais "sem princ√≠pios", bem ou liberal - ele pode ser gerado a partir de coment√°rios no c√≥digo, que, obviamente, contraria o princ√≠pio da API primeiro e n√£o √© suportado por nenhum dos utilit√°rios de RAML, <br><br>  Ao mesmo tempo, come√ßamos a trabalhar com RAML como uma linguagem mais flex√≠vel e, como resultado, tivemos que fazer muito com nossas pr√≥prias m√£os.  Por exemplo, um dos projetos usa o utilit√°rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ramlfications</a> em testes de unidade, que suporta apenas RAML 0.8.  Ent√£o eu tive que adicionar muletas para que o utilit√°rio pudesse "comer" a vers√£o 1.0 da RAML. <br><br><h3>  Preciso escolher? </h3><br>  Tendo nos envolvido na adi√ß√£o de um ecossistema de solu√ß√µes para RAML, chegamos √† conclus√£o de que precisamos converter RAML para Swagger 2 e j√° executamos toda a automa√ß√£o, verifica√ß√£o, teste e otimiza√ß√£o subsequente nele.  Essa √© uma boa maneira de aproveitar a flexibilidade do RAML e o suporte √†s ferramentas da comunidade do Swagger. <br><br>  Para resolver esse problema, existem duas ferramentas OpenSource que devem garantir a convers√£o de contratos: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">oas-raml-converter</a> agora √© um utilit√°rio n√£o suportado.  No processo de trabalhar com ela, descobrimos que ela tem v√°rios problemas com RAMLs complexas que est√£o "espalhadas" por um grande n√∫mero de arquivos.  Este programa √© escrito em JavaScript e executa uma travessia recursiva da √°rvore de sintaxe.  Devido √† digita√ß√£o din√¢mica, fica dif√≠cil entender esse c√≥digo, por isso decidimos n√£o perder tempo escrevendo patches para um utilit√°rio que est√° morrendo. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O webapi-parser</a> √© uma ferramenta da mesma empresa, que afirma estar pronta para converter tudo e tudo e em qualquer dire√ß√£o.  At√© o momento, foi anunciado o suporte para RAML 0.8, RAML 1.0 e Swagger 2.0.  No entanto, no momento do nosso estudo, o utilit√°rio era <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">EXTREMAMENTE</a> bruto e inutiliz√°vel.  Os desenvolvedores criam um tipo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RI</a> , que permitir√° adicionar rapidamente novos padr√µes no futuro.  Mas, por enquanto, tudo isso simplesmente n√£o funciona. </li></ol><br>  E estas n√£o s√£o todas as dificuldades que encontramos.  Uma das etapas do nosso pipeline √© verificar se a RAML do reposit√≥rio est√° correta em rela√ß√£o √† especifica√ß√£o.  Tentamos v√°rios utilit√°rios.  Surpreendentemente, todos eles amaldi√ßoaram nossas anota√ß√µes em lugares diferentes e com palavr√µes completamente diferentes.  E nem sempre √© o caso :). <br><br>  No final, decidimos pelo projeto agora obsoleto, que tamb√©m tem v√°rios problemas (√†s vezes fica fora do azul, tem problemas ao trabalhar com express√µes regulares).  Assim, n√£o encontramos uma maneira de resolver as tarefas de valida√ß√£o e convers√£o com base em ferramentas gratuitas e decidimos usar um utilit√°rio comercial.  No futuro, quando as ferramentas OpenSource se tornarem mais desenvolvidas, a solu√ß√£o desse problema poder√° se tornar mais f√°cil.  Enquanto isso, o tempo e o trabalho envolvidos no ‚Äúacabamento‚Äù nos pareciam mais significativos do que o custo de um servi√ßo comercial. <br><br><h3>  Conclus√£o </h3><br>  Depois de tudo isso, quer√≠amos compartilhar nossa experi√™ncia e observar que, antes de escolher uma ferramenta para descrever contratos, voc√™ precisa determinar claramente o que deseja e qual or√ßamento est√° pronto para investir.  Se voc√™ esquecer o OpenSource, agora h√° um grande n√∫mero de servi√ßos e produtos que ajudar√£o voc√™ a verificar, converter, validar.  Mas eles s√£o caros e, √†s vezes, muito caros.  Para uma grande empresa, esses custos s√£o toler√°veis, mas para uma startup, pode se tornar um grande fardo. <br><br>  Defina um conjunto de ferramentas que voc√™ usar√° mais tarde.  Por exemplo, se voc√™ apenas precisar exibir o contrato, ser√° mais f√°cil usar o Swagger 2, que possui uma API bonita, porque na RAML voc√™ precisa levantar e manter o servi√ßo. <br>  Quanto mais tarefas voc√™ tiver, maior ser√° a necessidade de ferramentas, e elas ser√£o diferentes para diferentes plataformas, e √© melhor se familiarizar imediatamente com as vers√µes dispon√≠veis para fazer uma escolha que minimize seus custos no futuro. <br><br>  Mas vale a pena reconhecer que todos os ecossistemas que existem hoje s√£o imperfeitos.  Portanto, se a empresa possui f√£s que gostam de trabalhar em RAML, porque ‚Äúpermite expressar seus pensamentos com mais flexibilidade‚Äù ou, pelo contr√°rio, preferem o Swagger, porque ‚Äú√© mais compreens√≠vel‚Äù, √© melhor deix√°-los trabalhar naquilo que desejam. Estamos acostumados e desejamos, porque as ferramentas de qualquer um dos formatos precisam ser finalizadas com um arquivo. <br><br>  Quanto √† nossa experi√™ncia, nos posts a seguir, falaremos sobre que tipo de verifica√ß√£o est√°tica e din√¢mica realizamos com base em nossa arquitetura RAML-Swagger, bem como que documenta√ß√£o geramos a partir de contratos e como tudo funciona. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466691/">https://habr.com/ru/post/pt466691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466679/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 49. Introdu√ß√£o ao EIGRP</a></li>
<li><a href="../pt466681/index.html">Treinamento Cisco 200-125 CCNA v3.0. Dia 50. Configurando o EIGRP</a></li>
<li><a href="../pt466683/index.html">Eventos digitais em Moscou, de 9 a 15 de setembro</a></li>
<li><a href="../pt466685/index.html">Vendo dinheiro</a></li>
<li><a href="../pt466689/index.html">Como criar classes de caracteres no MMO m√≥vel</a></li>
<li><a href="../pt466693/index.html">Se voc√™ n√£o entrar no departamento de TI</a></li>
<li><a href="../pt466697/index.html">M√¥nadas em Erlang</a></li>
<li><a href="../pt466699/index.html">Domesticar protocolos de confian√ßa - autentica√ß√£o OAuth com o InterSystems IRIS</a></li>
<li><a href="../pt466701/index.html">Let's Encrypt serve quase 30% dos dom√≠nios</a></li>
<li><a href="../pt466705/index.html">Vivaldi Beta para Android - Navegador Real</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>