<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∫ üë®üèª‚Äçüîß üë©üèª‚Äçüéì Sortir du spa Rabbit Hole avec des rails modernes ü§∂ üõåüèø üßïüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR: Le sentier SPA est sombre et plein d'horreurs. Vous pouvez les combattre sans crainte ... ou choisir un autre chemin qui vous m√®nera au bon en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sortir du spa Rabbit Hole avec des rails modernes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417875/"> TL; DR: Le sentier SPA est sombre et plein d'horreurs.  Vous pouvez les combattre sans crainte ... ou choisir un autre chemin qui vous m√®nera au bon endroit: les Rails modernes. <br><br><img src="https://habrastorage.org/webt/bm/nz/o6/bmnzo6gdhrpqqdufks3kgylhxjw.jpeg"><br><br>  Je me souviens avoir pens√© que Rails se concentrait sur le mauvais objectif lorsque DHH a annonc√© Turbolinks en 2012.  J'ai ensuite √©t√© convaincu que le temps de r√©ponse instantan√© pendant l'interaction avec l'utilisateur √©tait la cl√© d'une exp√©rience utilisateur sup√©rieure.  En raison des retards du r√©seau, cette interactivit√© n'est possible que si vous minimisez la d√©pendance au r√©seau et, au lieu d'appels r√©seau, conservez la majeure partie de l'√©tat sur le client. <br><br>  Je pensais que c'√©tait n√©cessaire pour les applications sur lesquelles je travaillais.  Et avec cette opinion, j'ai essay√© de nombreuses approches et cadres pour impl√©menter le m√™me mod√®le: les applications monopages (SPA).  Je pensais que SPA est l'avenir.  Quelques ann√©es plus tard, je ne suis pas s√ªr de l'avenir, mais je veux d√©finitivement trouver une alternative. <br><a name="habracut"></a><br><h2>  Trou de lapin SPA </h2><br>  Une application d'une page est une application JavaScript qui, une fois t√©l√©charg√©e, prend le contr√¥le sans avoir √† recharger la page: rendu, r√©ception des donn√©es du serveur, traitement de l'interaction utilisateur, mise √† jour de l'√©cran ... <br><br>  Ces applications sont plus natives que les pages Web traditionnelles, o√π l'application d√©pend du serveur.  Par exemple, si vous utilisez Trello, vous remarquerez peut-√™tre la rapidit√© avec laquelle les cartes sont cr√©√©es. <br><br>  Bien s√ªr, une grande responsabilit√© s'accompagne d'une grande force.  Dans les applications Web traditionnelles, votre application serveur comprend un mod√®le de domaine et des r√®gles m√©tier, une technologie d'acc√®s aux donn√©es pour travailler avec une base de donn√©es et une couche contr√¥leur pour contr√¥ler la fa√ßon dont les pages HTML sont assembl√©es en r√©ponse aux requ√™tes HTTP. <br><br>  C SPA est un peu plus compliqu√©.  Vous avez toujours besoin d'une application serveur qui inclut votre mod√®le de domaine et vos r√®gles, un serveur Web, une base de donn√©es et une sorte de technologie d'acc√®s aux donn√©es ... et un tas de choses suppl√©mentaires en plus: <br><br>  Pour le serveur: <br><br><ul><li>  Une API qui r√©pond aux besoins de vos clients en mati√®re de donn√©es </li><li>  Un syst√®me de s√©rialisation JSON pour l'√©change de donn√©es avec le client et un syst√®me de mise en cache qui le prend en charge </li></ul><br>  Pour le nouveau client JavaScript: <br><br><ul><li>  Syst√®me de mod√®les pour convertir des donn√©es en HTML </li><li>  Pr√©sentation de votre mod√®le de domaine et de vos r√®gles </li><li>  La couche d'acc√®s aux donn√©es dans l'application cliente pour le transfert de donn√©es vers le serveur </li><li>  Syst√®me de mise √† jour des vues lorsque les donn√©es changent </li><li>  Un syst√®me pour relier les URL et les √©crans (j'esp√®re que vous n'utiliserez pas une seule adresse pour tout, cela ne ressemble pas √† une application Web) </li><li>  Un syst√®me pour coller tous les composants n√©cessaires √† l'affichage des √©crans et obtenir des donn√©es pour cela </li><li>  Nouveaux mod√®les et architecture pour tout organiser quand </li><li>  Syst√®me de gestion des erreurs, de journalisation, de suivi des exceptions, etc. </li><li>  Syst√®me de g√©n√©ration de JSON pour les requ√™tes serveur </li><li>  Cadre de test automatis√© prenant en charge votre SPA </li><li>  Un ensemble suppl√©mentaire de tests pour l'√©criture et le support </li><li>  Un ensemble suppl√©mentaire d'outils pour assembler, empaqueter et d√©ployer une nouvelle application </li></ul><br>  En somme, avec SPA vous aurez une autre demande de support.  Et un nouvel ensemble de probl√®mes √† r√©soudre.  Et notez que vous ne pouvez pas remplacer une application par une autre.  Vous avez toujours besoin de l'application serveur (maintenant elle rendra JSON au lieu de HTML). <br><br>  Si vous n'avez jamais travaill√© avec SPA, vous pouvez sous-estimer les difficult√©s que vous rencontrerez.  Je le sais parce que j'ai fait les m√™mes erreurs dans le pass√©.  Rendre JSON?  Je peux le supporter.  Un mod√®le d'objet de domaine riche en JavaScript?  √áa a l'air dr√¥le.  Et, vous savez, ce cadre r√©soudra tous ces probl√®mes.  Super g√¢teau! <br><br>  <b>Faux.</b> <br><br><h2>  API et √©change de donn√©es. </h2><br>  La communication entre votre nouvelle application et le serveur est un probl√®me complexe. <br><br>  Il existe deux forces oppos√©es: <br><br><ul><li>  Vous souhaiterez effectuer le moins de demandes de serveur possible afin d'am√©liorer les performances. </li><li>  La conversion d'un seul enregistrement en JSON est simple.  Mais m√©langer de grands mod√®les de divers enregistrements pour minimiser le nombre de requ√™tes n'est pas du tout.  Vous devrez d√©velopper soigneusement une logique de s√©rialisation pour optimiser le nombre de requ√™tes de base de donn√©es et maintenir les performances au niveau. </li></ul><br>  De plus, vous devez penser √† ce que vous souhaitez t√©l√©charger et quand le faire pour chacun de leurs √©crans.  Je veux dire, vous avez besoin d'un √©quilibre entre le bootstrap, ce dont vous avez besoin imm√©diatement et ce qui peut √™tre charg√© paresseusement, et d√©velopper une API qui vous permet de le faire. <br><br>  Certaines normes peuvent aider ici.  API JSON pour standardiser le format JSON;  ou GraphQL, pour s√©lectionner uniquement les donn√©es n√©cessaires, aussi complexes que n√©cessaire, dans une seule requ√™te.  Mais aucun d'eux ne vous sauvera de: <br><ul><li>  L'√©laboration de chaque √©change de donn√©es </li><li>  Impl√©mentation de requ√™tes pour s√©lectionner efficacement les donn√©es sur le serveur </li></ul><br>  Et ces deux aspects repr√©sentent une quantit√© de travail suppl√©mentaire suffisante. <br><br><h2>  Temps de d√©marrage </h2><br>  Les gens ont l'habitude d'associer les SPA √† la vitesse, mais la v√©rit√© est que les charger rapidement n'est pas si facile.  Il y a plusieurs raisons √† cela: <br><br><ul><li>  Une application a besoin de donn√©es avant de rendre quelque chose, et il faut du temps pour analyser une quantit√© suffisamment importante de JavaScript. </li><li>  Au-del√† de la demande HTTP initiale pour t√©l√©charger l'application, vous devez g√©n√©ralement effectuer une ou plusieurs demandes pour obtenir les donn√©es JSON n√©cessaires au rendu de l'√©cran. </li><li>  Le client doit convertir JSON en HTML afin d'afficher au moins quelque chose.  Selon le p√©riph√©rique et la quantit√© de JSON √† convertir, cela peut entra√Æner des retards notables. </li></ul><br>  Cela ne signifie pas qu'il est impossible de forcer le SPA √† se charger rapidement.  Je dis simplement que c'est difficile et que vous devez vous en occuper, car cela ne viendra pas avec l'architecture SPA. <br><br>  Par exemple, Discourse, un SPA bas√© sur Ember, a des temps de chargement fantastiques, mais entre autres, ils pr√©chargent une grande quantit√© de donn√©es JSON dans le cadre du HTML initial afin de ne pas faire de demandes suppl√©mentaires.  Et je constate que l'√©quipe Discourse est folle dans le bon sens de la vitesse et que ses comp√©tences sont bien au dessus de la moyenne.  Pensez-y avant de pouvoir facilement reproduire le m√™me dans votre SPA. <br><br>  Une solution ambitieuse √† ce probl√®me est le JavaScript isomorphe: affichez votre page de d√©marrage sur le serveur et donnez-la rapidement au client, tandis qu'en arri√®re-plan du SPA, il se charge et prend le contr√¥le total lorsqu'il est pr√™t. <br><br>  Cette approche n√©cessite d'ex√©cuter le runtime JavaScript sur le serveur, et ce n'est pas non plus sans probl√®mes techniques.  Par exemple, les d√©veloppeurs doivent prendre en compte les √©v√©nements de chargement SPA lorsque le processus de chargement change. <br><br>  J'aime la possibilit√© de r√©utiliser le code dans cette id√©e, mais je n'ai pas vu d'impl√©mentation qui me permettrait d'aller dans la direction oppos√©e.  De plus, ce processus de rendu de page me semble tr√®s dr√¥le: <br><br>  - Serveur: demande au serveur API <br>  - Serveur: requ√™te de base de donn√©es <br>  - Serveur: g√©n√©rer JSON <br>  - Serveur: convertir JSON en HTML <br>  - Client: afficher le HTML initial <br>  - Client: t√©l√©charger SPA <br>  - Client: analyser le HTML initial et s'abonner aux √©v√©nements DOM <br><br>  Pourriez-vous simplement demander les donn√©es de la base de donn√©es, g√©n√©rer le code HTML et commencer √† travailler? <br><br>  Ce n'est pas tout √† fait juste, car vous ne serez pas SPA et parce que la majeure partie de cette magie est cach√©e derri√®re le cadre, mais cela me semble toujours faux. <br><br><h2>  L'architecture </h2><br>  D√©velopper des applications avec une interface utilisateur riche est difficile.  Tout cela parce que c'est l'un des probl√®mes qui a inspir√© l'√©mergence d'une approche orient√©e objet et de nombreux mod√®les de conception. <br><br>  La gestion du statut du client est difficile.  Les sites Web traditionnels se concentrent g√©n√©ralement sur les √©crans √† responsabilit√© unique qui perdent leur √©tat au red√©marrage.  Dans SPA, l'application est charg√©e de s'assurer que toutes les mises √† jour d'√©tat et d'√©cran pendant l'utilisation sont coh√©rentes et passent sans probl√®me. <br><br>  En pratique, si vous avez commenc√© √† √©crire JavaScript en petites portions pour am√©liorer l'interaction, alors dans SPA, vous devrez √©crire des tonnes de code JavaScript suppl√©mentaire.  Ici, vous devez vous assurer que vous faites tout correctement. <br><br>  Il existe autant d'architectures diff√©rentes que de frameworks SPA: <br><br><ul><li>  La plupart des frameworks diff√®rent du mod√®le MVC traditionnel.  Ember s'est d'abord inspir√© de Cocoa MVC, mais a beaucoup chang√© son mod√®le de programmation dans les versions r√©centes. </li><li>  Il y a une tendance que les d√©veloppeurs pr√©f√®rent les composants plut√¥t que la s√©paration traditionnelle du contr√¥leur et de la pr√©sentation (certains frameworks, comme Ember et Angular, ont adopt√© cette approche dans les versions r√©centes).  Tous les frameworks impl√©mentent une sorte de liaison de donn√©es unidirectionnelle.  La liaison double face est d√©conseill√©e en raison des effets secondaires qu'elle peut apporter. </li><li>  La plupart des frameworks incluent un syst√®me de routage qui vous permet de mapper des URL et des √©crans et d√©termine comment instancier des composants pour le rendu.  Il s'agit d'une approche Web unique qui n'existe pas sur les interfaces de bureau traditionnelles. </li><li>  La plupart des frameworks s√©parent les mod√®les HTML du code JavaScript, mais React m√©lange la g√©n√©ration HTML et JavaScript et le fait assez bien, compte tenu de son utilisation g√©n√©ralis√©e.  Il existe √©galement un battage m√©diatique autour de l'int√©gration de CSS dans JavaScript.  Facebook, avec son architecture Flux, a √† peu pr√®s influenc√© l'industrie, et les conteneurs comme Redux, vuex, etc. en sont fortement influenc√©s. </li></ul><br>  De tous les frameworks que j'ai vus, Ember est mon pr√©f√©r√©.  J'adore sa constance et le fait qu'il soit plut√¥t t√™tu.  J'aime aussi son mod√®le de programmation dans les versions r√©centes, combinant MVC traditionnel, composants et routage. <br><br>  En revanche, je suis fortement contre le camp Flux / Redux.  J'ai vu tellement de gens intelligents les utiliser que j'ai fait tout mon possible pour l'√©tudier et le comprendre, et pas une seule fois.  Je ne peux pas m'emp√™cher de secouer la t√™te de frustration quand je vois le code.  Je ne me vois pas heureux en √©crivant un tel code. <br><br>  Enfin, je ne peux pas supporter le m√©lange de HTML et CSS dans des composants pleins de logique JavaScript.  Je comprends quel probl√®me cela r√©sout, mais les probl√®mes que cette approche apporte ne valent pas la peine. <br><br>  Laissons de c√¥t√© les pr√©f√©rences personnelles, l'essentiel est que si vous choisissez le chemin SPA, vous aurez un probl√®me tr√®s difficile: cr√©er correctement l'architecture de votre nouvelle application.  Et l'industrie est assez loin de s'entendre sur la fa√ßon de proc√©der.  Chaque ann√©e, de nouveaux frameworks, mod√®les et versions de frameworks apparaissent, ce qui modifie l√©g√®rement le mod√®le de programmation.  Vous devrez √©crire et maintenir une tonne de code en fonction de votre choix architectural, alors pensez-y correctement. <br><br><h2>  Duplication de code </h2><br>  Lorsque vous travaillez avec SPA, vous rencontrerez probablement une duplication de code. <br><br>  Pour votre logique SPA, vous souhaiterez cr√©er un mod√®le riche d'objets repr√©sentant votre domaine et votre logique m√©tier.  Et vous avez toujours besoin de la m√™me chose pour la logique du serveur.  Et c'est une question de temps avant de commencer √† copier le code. <br><br>  Par exemple, supposons que vous travaillez avec des factures.  Vous avez probablement une classe Invoice en JavaScript qui contient une m√©thode totale qui r√©sume le prix de tous les √©l√©ments afin que vous puissiez rendre la valeur.  Sur le serveur, vous aurez √©galement besoin de la classe Facture avec la m√©thode totale pour calculer ce co√ªt afin de l'envoyer par e-mail.  Tu vois?  Les classes client et serveur Invoice impl√©mentent la m√™me logique.  Duplication de code. <br><br>  Comme indiqu√© ci-dessus, JavaScript isomorphe pourrait att√©nuer ce probl√®me, ce qui faciliterait la r√©utilisation du code.  Et je dis au niveau, car la correspondance entre le client et le serveur n'est pas toujours 1-√†-1.  Vous voudrez √™tre s√ªr qu'un certain code ne quitte jamais le serveur.  Une grande quantit√© de code n'a de sens que pour le client.  De plus, certains aspects sont simplement diff√©rents (par exemple, l'√©l√©ment serveur peut enregistrer des donn√©es dans la base de donn√©es et le client peut utiliser l'API distante).  La r√©utilisation du code, m√™me si possible, est un probl√®me complexe. <br><br>  Vous pouvez parier que vous n'avez pas besoin d'un mod√®le riche dans votre SPA et que vous allez plut√¥t travailler directement avec des objets JSON / JavaScript, r√©partissant la logique entre les composants de l'interface utilisateur.  Maintenant, vous avez la m√™me duplication de code m√©lang√©e √† votre code d'interface utilisateur, bonne chance avec cela. <br><br>  Et la m√™me chose se produit si vous voulez des mod√®les de rendu HTML entre le serveur et le client.  Par exemple, pour le r√©f√©rencement, que diriez-vous de g√©n√©rer des pages sur le serveur pour les moteurs de recherche?  Vous devrez r√©√©crire vos mod√®les sur le serveur et vous assurer qu'ils sont synchronis√©s avec le client.  Encore une fois la duplication de code. <br><br>  La n√©cessit√© de reproduire la logique des mod√®les sur le serveur et le client, d'apr√®s mon exp√©rience, est √† l'origine du malheur croissant des programmeurs.  Faire cela une fois est normal.  Lorsque vous faites cela pour la 20e fois, vous vous agripperez la t√™te.  Apr√®s avoir fait cela pour la 50e fois, vous vous demanderez si toutes ces pi√®ces SPA sont n√©cessaires. <br><br><h2>  Fragilit√© </h2><br>  D'apr√®s mon exp√©rience, le d√©veloppement de bons SPA est une t√¢che beaucoup plus compliqu√©e que l'√©criture d'applications Web avec g√©n√©ration de serveur. <br><br>  Tout d'abord, peu importe votre prudence, peu importe le nombre de tests que vous √©crivez.  Plus vous √©crivez de code, plus vous aurez de bugs.  Et SPA repr√©sente (d√©sol√©, si je pousse fort) une √©norme pile de code pour l'√©criture et le support. <br><br>  Deuxi√®mement, comme mentionn√© ci-dessus, le d√©veloppement d'une interface graphique riche est compliqu√© et se traduit par des syst√®mes complexes compos√©s de nombreux √©l√©ments interagissant les uns avec les autres.  Plus le syst√®me que vous cr√©ez est complexe, plus vous avez de bogues.  Et par rapport aux applications Web traditionnelles utilisant MVC, la complexit√© du SPA est tout simplement folle. <br><br>  Par exemple, pour maintenir la coh√©rence sur le serveur, vous pouvez utiliser des restrictions dans la base de donn√©es, la validation du mod√®le et les transactions.  Si quelque chose ne va pas, vous r√©pondez avec un message d'erreur.  Chez le client, tout est l√©g√®rement plus compliqu√©.  Tant de choses peuvent mal tourner car il se passe trop de choses.  Il se peut que certains enregistrements soient enregistr√©s avec succ√®s et d'autres non.  Peut-√™tre que vous vous √™tes d√©connect√© au milieu d'une sorte d'op√©ration.  Vous devez vous assurer que l'interface utilisateur reste coh√©rente et que l'application se remet d'une erreur.  Tout cela est possible, bien s√ªr, mais beaucoup plus compliqu√©. <br><br><h2>  D√©fis organisationnels </h2><br>  Cela peut para√Ætre idiot, mais pour d√©velopper un SPA, vous avez besoin de d√©veloppeurs qui savent quoi en faire.  Dans le m√™me temps, vous ne devez pas sous-estimer la complexit√© du SPA, vous ne devez pas penser qu'un d√©veloppeur Web exp√©riment√© avec la bonne motivation et la bonne compr√©hension peut √©crire un grand SPA √† partir de z√©ro.  Vous avez besoin des bonnes comp√©tences et de l'exp√©rience, ou vous attendez √† ce que des erreurs importantes soient commises.  Je le sais parce que c'est exactement mon cas. <br><br>  C'est peut-√™tre un d√©fi plus important pour votre entreprise que vous ne le pensez.  L'approche SPA encourage les √©quipes hautement sp√©cialis√©es au lieu des √©quipes de g√©n√©ralistes: <br><br><ul><li>  Les frameworks SPA sont des logiciels complexes qui n√©cessitent d'innombrables heures d'exp√©rience pour √™tre productifs.  Seules les personnes de votre entreprise qui passent ces heures sur le code pourront prendre en charge ces applications. </li><li>  Les infrastructures SPA n√©cessitent des API bien pens√©es et productives.  R√©pondre √† ces exigences n√©cessite un ensemble de comp√©tences compl√®tement diff√©rent de celles qui n√©cessitent un travail avec SPA. </li></ul><br>  Les chances sont que vous vous retrouverez avec des gens qui ne peuvent pas travailler avec SPA, et qui ne peuvent pas travailler c√¥t√© serveur, simplement parce qu'ils ne savent pas comment. <br><br>  Cette sp√©cialisation peut √™tre id√©ale pour Facebook ou Google et leurs √©quipes compos√©es de plusieurs couches de troupes d'ing√©nierie.  Mais sera-ce bon pour votre √©quipe de 6 personnes? <br><br><h2>  Rails modernes </h2><br>  Il y a 3 choses qui vont dans les Rails modernes qui peuvent changer d'avis sur le d√©veloppement d'applications Web modernes: <br><ul><li>  l'un d'eux est Turbolinks et ceci est une explosion c√©r√©brale </li><li>  l'autre est un vieil ami qui est ignor√© aujourd'hui: r√©ponses SJR et simples requ√™tes AJAX pour le rendu </li><li>  et le dernier a √©t√© ajout√© r√©cemment: Stimulus </li></ul><br>  Il est difficile de comprendre ce que c'est d'appliquer une approche sans jouer avec.  Par cons√©quent, je ferai quelques r√©f√©rences √† Basecamp dans les sections suivantes.  Je n'ai rien √† voir avec Basecamp, sauf en tant qu'utilisateur heureux.  Quant √† cet article, ce n'est qu'un bon exemple en direct de Rails modernes que vous pouvez essayer gratuitement. <br><br><h2>  Turbolinks </h2><br>  L'id√©e derri√®re Turbolinks est simple: acc√©l√©rer votre application en rempla√ßant compl√®tement les rechargements de page par des requ√™tes AJAX qui remplacent l'√©l√©ment ``.  La sorcellerie int√©rieure qui fait ce travail est cach√©e.  En tant que d√©veloppeur, vous pouvez vous concentrer sur la programmation traditionnelle c√¥t√© serveur. <br><br>  Turbolinks est inspir√© de pjax et a subi plusieurs r√©visions. <br><br>  J'avais l'habitude de m'inqui√©ter de ses performances.  J'avais tort.  L'acc√©l√©ration est √©norme.  Ce qui m'a convaincu, c'est comment je l'ai utilis√© dans le projet, mais vous pouvez simplement essayer la version d'essai dans Basecamp et jouer avec.  Essayez de cr√©er un projet avec certains √©l√©ments, puis parcourez-les en cliquant sur les sections.  Cela vous donnera une bonne id√©e de l'apparence de Turbolinks. <br><br>  Je ne pense pas que Turbolinks soit tout simplement incroyable avec sa nouveaut√© (pjax - 8 ans).  Ou sa sophistication technique.  Je suis √©tonn√© de voir comment une id√©e simple peut augmenter votre productivit√© d'un ordre de grandeur par rapport √† l'alternative au SPA. <br><br>  Permettez-moi de souligner certains des probl√®mes qu'il r√©sout: <br><br><ul><li>  √âchange de donn√©es.  Vous ne l'avez pas.  Pas besoin de s√©rialiser JSON, de cr√©er des API ou de penser aux demandes de donn√©es qui r√©pondent aux besoins des clients en termes de performances. </li><li>  Charge initiale.  Contrairement au SPA, cette approche stimule des temps de chargement rapides (par conception).  Pour rendre l'√©cran, vous pouvez obtenir les donn√©es dont vous avez besoin directement √† partir de la base de donn√©es.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Et interroger efficacement des donn√©es √† partir de bases de donn√©es relationnelles ou mettre en cache du HTML sont des probl√®mes bien r√©solus. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture: Vous n'avez pas besoin d'une architecture complexe pour organiser votre code JavaScript. </font><font style="vertical-align: inherit;">Il vous suffit de vous concentrer sur l'architecture correcte de votre application serveur, ce que vous devez toujours faire lorsque vous utilisez SPA.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le MVC sur le serveur, dans la version utilis√©e par Rails et de nombreux autres frameworks, est beaucoup plus simple que n'importe lequel des mod√®les utilis√©s pour la riche architecture GUI: obtenez une demande, travaillez avec la base de donn√©es pour la satisfaire et affichez la page HTML comme r√©ponse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enfin, la limitation qui est toujours remplac√©e a un effet merveilleux: vous pouvez vous concentrer sur le rendu initial des pages au lieu de mettre √† jour certaines sections (ou de mettre √† jour certaines conditions dans le monde SPA). </font><font style="vertical-align: inherit;">Dans le cas g√©n√©ral, il fait tout.</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Duplication de code. </font><font style="vertical-align: inherit;">Il n'y a qu'une seule vue de votre application qui r√©side sur le serveur. </font><font style="vertical-align: inherit;">Votre mod√®le de domaine, ses r√®gles, les √©crans d'application, etc. </font><font style="vertical-align: inherit;">Pas besoin de dupliquer les concepts dans le client.</font></font></li><li> .    SPA, JavaScript            ,    .  ,         ,    ,   . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que je ne parle pas de probl√®mes de nommage, mais de les r√©soudre. Par exemple, la r√©hydratation GraphQL ou SPA sont des solutions super intelligentes pour des probl√®mes tr√®s complexes. Mais que se passe-t-il si, au lieu d'essayer de trouver une solution, vous vous mettez dans une situation o√π ces probl√®mes n'existent pas? Il s'agit d'un changement d'approche du probl√®me. Et il m'a fallu des ann√©es pour appr√©cier pleinement la capacit√© de cette approche √† r√©soudre des probl√®mes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bien s√ªr, Turbolinks n'est pas une solution miracle sans tracas. Le plus gros probl√®me est qu'il peut casser le code JavaScript existant:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turbolinks est livr√© avec son √©v√©nement de ¬´chargement de page¬ª personnalis√©, et les plugins existants qui reposent sur des chargements de page r√©guliers ne fonctionneront pas. </font><font style="vertical-align: inherit;">Aujourd'hui, il existe de meilleures fa√ßons d'ajouter un comportement au DOM, mais les widgets h√©rit√©s ne fonctionneront pas s'ils ne sont pas adapt√©s.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code JavaScript qui modifie le DOM doit √™tre idempotent car il peut √™tre ex√©cut√© plusieurs fois. </font><font style="vertical-align: inherit;">Encore une fois, cela invalide beaucoup de JavaScript existant.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La vitesse est excellente, mais ce n'est pas tout √† fait comme dans SPA, qui peut g√©rer certaines interactions sans charger le serveur. </font><font style="vertical-align: inherit;">Je parlerai plus en d√©tail des compromis plus tard.</font></font></li></ul><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rendu AJAX et r√©ponses SJR </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous vous souvenez quand le rendu HTML via Ajax √©tait en vogue il y a 15 ans? </font><font style="vertical-align: inherit;">Devinez quoi? </font><font style="vertical-align: inherit;">C'est toujours un excellent outil dans votre arsenal:</font></font><br><ul><li>   HTML       DOM,   ( 100 ). </li><li>    HTML  ,              . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez voir comment cette approche est ressentie dans Basecamp en ouvrant votre menu de profil en cliquant sur le bouton en haut √† droite: </font></font><br><br><img src="https://habrastorage.org/webt/yc/6b/th/yc6bth2x9on2cvks1r34w937xey.gif"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ouvre instantan√©ment. Du c√¥t√© du d√©veloppement, vous n'avez pas √† vous soucier de la s√©rialisation JSON et du c√¥t√© client. Vous pouvez simplement afficher ce fragment sur le serveur, en utilisant toutes les fonctionnalit√©s de Rails. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un outil similaire que Rails a inclus au fil des ans est les r√©ponses JavaScript c√¥t√© serveur (SJR). Ils vous permettent de r√©pondre aux demandes Ajax (g√©n√©ralement des soumissions de formulaire) avec JavaScript qui est ex√©cut√© par le client. Il offre les m√™mes avantages que le rendu AJAX des extraits de code HTML: il s'ex√©cute tr√®s rapidement, vous pouvez r√©utiliser le code c√¥t√© serveur et vous pouvez acc√©der directement √† la base de donn√©es pour cr√©er une r√©ponse.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez voir comment cela se produit si vous allez dans Basecamp et essayez de cr√©er une nouvelle t√¢che. </font><font style="vertical-align: inherit;">Apr√®s avoir cliqu√© sur ¬´Ajouter une t√¢che¬ª, le serveur enregistre la t√¢che et r√©pond avec un fragment JavaScript qui ajoute une nouvelle t√¢che au DOM. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je pense que de nombreux d√©veloppeurs regardent aujourd'hui le rendu AJAX et les r√©ponses SJR avec m√©pris. </font><font style="vertical-align: inherit;">Je m'en souviens aussi. </font><font style="vertical-align: inherit;">Ils sont un outil et, en tant que tels, peuvent √™tre abus√©s. </font><font style="vertical-align: inherit;">Mais lorsqu'il est utilis√© correctement, c'est une excellente solution. </font><font style="vertical-align: inherit;">Laissez-vous offrir une grande exp√©rience utilisateur et une interactivit√© √† un prix tr√®s bas. </font><font style="vertical-align: inherit;">Malheureusement, comme Turbolinks, ils sont difficiles √† √©valuer si vous n'avez pas encore combattu le SPA.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Stimulus </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stimulus est un framework JavaScript publi√© il y a quelques mois. </font><font style="vertical-align: inherit;">Il ne se soucie pas du rendu ou de la gestion des √©tats bas√©e sur JavaScript. </font><font style="vertical-align: inherit;">Au lieu de cela, c'est juste une fa√ßon agr√©able et moderne d'organiser JavaScript, que vous utilisez pour ajouter du HTML:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il utilise MutationObserver pour lier le comportement au DOM, ce qui signifie qu'il ne se soucie pas de la fa√ßon dont le code HTML appara√Æt sur la page. </font><font style="vertical-align: inherit;">Bien s√ªr, cela fonctionne tr√®s bien avec Turbolinks.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il vous fera √©conomiser une tonne de code passe-partout pour attacher le comportement au DOM, pour attacher des gestionnaires d'√©v√©nements aux √©v√©nements et pour placer des √©l√©ments dans le conteneur sp√©cifi√©. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il vise √† rendre votre code HTML lisible et compr√©hensible, ce qui est bien si vous avez d√©j√† rencontr√© le probl√®me de savoir quelle partie de JavaScript agit sur ce fichu √©l√©ment. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il encourage la persistance dans les DOM. </font><font style="vertical-align: inherit;">Encore une fois, cela signifie qu'il ne se soucie pas de la fa√ßon dont le code HTML est g√©n√©r√©, ce qui convient √† de nombreux sc√©narios, y compris Turbolinks.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous acceptez le chemin Rails, votre JavaScript se concentrera sur la modification du code HTML c√¥t√© serveur et l'am√©lioration de l'interaction (avec un peu de JavaScript). </font><font style="vertical-align: inherit;">Stimulus est con√ßu pour organiser un tel code. </font><font style="vertical-align: inherit;">Ce n'est pas un syst√®me SPA et ne pr√©tend pas en √™tre un. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai utilis√© Stimulus dans plusieurs projets et j'aime vraiment √ßa. </font><font style="vertical-align: inherit;">Il √©limine un tas de code standard, il est construit sur les derni√®res normes Web et se lit tr√®s bien. </font><font style="vertical-align: inherit;">Et quelque chose que j'aime particuli√®rement: c'est maintenant la fa√ßon standard de faire quelque chose qui devait encore √™tre r√©solu dans chaque application.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jeu de compromis </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Turbolinks est g√©n√©ralement vendu comme ¬´B√©n√©ficiez de tous les avantages du SPA sans aucun inconv√©nient¬ª. </font><font style="vertical-align: inherit;">Je ne pense pas que ce soit compl√®tement vrai:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les applications construites √† l'aide de Rails modernes semblent rapides, mais SPA r√©pondra toujours plus rapidement aux interactions ind√©pendantes du serveur. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe des sc√©narios dans lesquels SPA a plus de sens. </font><font style="vertical-align: inherit;">Si vous devez offrir un haut niveau d'interactivit√©, vous devez g√©rer un grand nombre d'√©tats, ex√©cuter une logique complexe c√¥t√© client, etc. Le framework SPA vous facilitera la vie.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, le d√©veloppement est un jeu de compromis. </font><font style="vertical-align: inherit;">Et dans ce jeu:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modern Rails vous permet de cr√©er des applications assez rapides et superbes. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour une grande vari√©t√© d'applications, Rails vous permet d'impl√©menter les m√™mes fonctions avec moins de code et moins de complexit√©. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je crois qu'avec Rails, vous pouvez obtenir 90% de ce que SPA offre avec 10% d'effort. </font><font style="vertical-align: inherit;">En termes de performances, Rails tue SPA. </font><font style="vertical-align: inherit;">Quant √† UX, je pense que de nombreux d√©veloppeurs font la m√™me erreur que moi, en supposant que SPA UX est in√©gal√©.</font></font> Ce n'est pas le cas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En fait, comme discut√© ci-dessus, vous savez mieux ce que vous faites lors de la cr√©ation de votre SPA, ou UX sera en fait pire. </font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je regarde les entreprises accepter massivement les cadres SPA et voir d'innombrables articles sur la fa√ßon de faire des choses fantaisistes de style SPA. Je pense qu'il existe de nombreuses ¬´utilisations du mauvais outil pour le travail¬ª, car je crois fermement que les types d'applications qui justifient l'utilisation du SPA sont limit√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et je dis qu'ils le justifient parce que les SPA sont complexes. En tout cas, j'esp√®re vous en avoir convaincu. Je ne dis pas qu'il est impossible de cr√©er de grandes applications SPA ou que les applications Rails modernes sont grandes par d√©finition, une seule approche est super compliqu√©e et l'autre est beaucoup plus simple. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lors de la pr√©paration de cet article, je suis tomb√© sur ce tweet:</font></font><br><br><img src="https://habrastorage.org/webt/px/54/rc/px54rc9odiplrsororeiozro--c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela m'a fait rire parce que je choisirais les premi√®res options si l'alternative n'√©tait pas justifi√©e. Il est √©galement un repr√©sentant du genre de pens√©e des d√©veloppeurs qui aiment la complexit√© et y prosp√®rent, m√™me en pensant que d'autres personnes avec des crit√®res diff√©rents sont fous. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apr√®s de nombreuses ann√©es, j'ai r√©alis√© que la complexit√© est souvent un choix. Mais dans le monde de la programmation, il est √©tonnamment difficile de choisir la simplicit√©. Nous appr√©cions tellement la complexit√© que l'acceptation de la simplicit√© nous fait souvent penser diff√©remment, ce qui est par d√©finition difficile.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'oubliez pas que vous pouvez vous d√©barrasser des ennuis. </font><font style="vertical-align: inherit;">Si vous choisissez le chemin SPA, assurez-vous qu'il est justifi√© et que vous comprenez les probl√®mes. </font><font style="vertical-align: inherit;">Si vous n'√™tes pas s√ªr, exp√©rimentez diff√©rentes approches et voyez par vous-m√™me. </font><font style="vertical-align: inherit;">Facebook ou Google, √† leur √©chelle, n'ont peut-√™tre pas le luxe de prendre de telles d√©cisions, mais vous le pouvez probablement. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et si vous √™tes un d√©veloppeur Rails qui a quitt√© Rails il y a de nombreuses ann√©es, je vous recommande d'y revenir. </font><font style="vertical-align: inherit;">Je pense que vous serez ravis.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417875/">https://habr.com/ru/post/fr417875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417865/index.html">Accessibilit√© Android - un loup d√©guis√© en mouton? Conf√©rence Yandex</a></li>
<li><a href="../fr417867/index.html">Comment √©valuer la dur√©e d'un projet informatique et quand cela ne vaut pas la peine de le faire</a></li>
<li><a href="../fr417869/index.html">Comment d√©boguer WebRTC</a></li>
<li><a href="../fr417871/index.html">√Ä la ligne d'arriv√©e du tourisme suborbital</a></li>
<li><a href="../fr417873/index.html">Fa√ßons de cr√©er des fen√™tres pop-up</a></li>
<li><a href="../fr417877/index.html">Comment Tinder cache (l√©g√®rement) votre position</a></li>
<li><a href="../fr417879/index.html">Comment passer des examens de Microsoft gratuitement [par exemple, un r√©cent concours]</a></li>
<li><a href="../fr417881/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end des deux derni√®res semaines n ¬∞ 323 (8-22 juillet 2018)</a></li>
<li><a href="../fr417883/index.html">Cr√©ation d'un dialogue pour choisir une sonnerie</a></li>
<li><a href="../fr417885/index.html">√Ä propos de M et de V et un peu de C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>