<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☄️ ⚪️ 👩🏾‍🤝‍👩🏼 Gatsby.js en detalle ➿ 🙏🏼 🤷🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Como sabes, no puedes llegar muy lejos en algunas repeticiones solo, por lo que debes profundizar en cualquier tecnología para aprender a escribir alg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Gatsby.js en detalle</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442298/"><p><img src="https://habrastorage.org/webt/05/2c/ll/052cllvfmcuw_rru5rhjwhxxqem.jpeg"></p><br><p>  Como sabes, no puedes llegar muy lejos en algunas repeticiones solo, por lo que debes profundizar en cualquier tecnología para aprender a escribir algo que valga la pena.  Este artículo analiza los detalles de <strong>Gatsby.js</strong> , <strong>cuyo</strong> conocimiento le permitirá crear y mantener sitios web y blogs complejos. </p><a name="habracut"></a><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Artículo anterior</a> sobre cómo crear y publicar un blog personal utilizando JAM-stack </blockquote><p>  Temas discutidos a continuación: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estructura de la página y enrutamiento</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Componentes, plantillas y su interacción</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Trabajar con datos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Complementos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Estilo de aplicación</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Optimización SEO usando react-casco</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Configuración PWA</a> </li></ul><br><h2 id="podgotovka">  Preparación </h2><br><div class="spoiler">  <b class="spoiler_title">Instalar Gatsby en PC</b> <div class="spoiler_text"><pre><code class="bash hljs">yarn global add gatsby-cli</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Clonando un Proyecto Mínimo</b> <div class="spoiler_text"><pre> <code class="bash hljs"> npx gatsby new gatsby-tutorial https://github.com/gatsbyjs/gatsby-starter-hello-world <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> gatsby-tutorial</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Inicialización de repositorio</b> <div class="spoiler_text"><pre> <code class="bash hljs"> git init git add . git commit -m <span class="hljs-string"><span class="hljs-string">"init commit"</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Control de salud</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> yarn start</code> </pre> <br><p>  Si no hay errores en la consola y en el navegador a lo largo de la ruta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000,</a> verá "¡Hola, mundo!"  significa que todo funciona correctamente.  Puede intentar cambiar el contenido del archivo <em>/src/pages/index.js</em> para verificar la recarga en caliente. </p></div></div><br><h2 id="struktura-stranic-i-routing">  Estructura de la página y enrutamiento </h2><br><p>  Para crear una página en Gatsby, simplemente coloque el nuevo archivo en la carpeta <em>/ src / pages</em> y se compilará en una página HTML separada.  <strong>Es importante tener en cuenta que la ruta a esta página corresponderá a la ruta real con el nombre</strong> .  Por ejemplo, agregue algunas páginas más: </p><br><pre> <code class="plaintext hljs">src └── pages ├── about.js ├── index.js └── tutorial ├── part-four.js ├── part-one.js ├── part-three.js ├── part-two.js └── part-zero.js</code> </pre><br><p>  El contenido aún no es importante, por lo que cualquier texto puede usarse para distinguir entre páginas. </p><br><pre> <code class="plaintext hljs">import React from "react"; export default () =&gt; &lt;div&gt;Welcome to tutorial/part-one&lt;/div&gt;;</code> </pre> <br><p>  Comprobar en el navegador: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000 / tutorial / parte uno</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000 / about</a> </li></ul><br><p>  De esta manera, al estructurar archivos, puede resolver inmediatamente los problemas de enrutamiento. </p><br><blockquote>  También hay una <strong>API createPage</strong> especial con la que puede controlar de manera más flexible las rutas y los nombres de las páginas, pero para trabajar con ella necesitamos comprender el funcionamiento de los datos en Gatsby, por lo que lo consideraremos un poco más adelante en el artículo. </blockquote><p>  Combina las páginas creadas usando los enlaces, para esto usamos el componente <code>&lt;Link /&gt;</code> del paquete Gatsby, que fue creado específicamente para la navegación interna.  Para todos los enlaces externos, use la etiqueta <code>&lt;a&gt;</code> normal. </p><br><p>  <em>/src/pages/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; export default () =&gt; ( &lt;div&gt; &lt;ul&gt; &lt;li&gt; &lt;Link to="/about"&gt;about&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-zero"&gt;Part #0&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-one"&gt;Part #1&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-two"&gt;Part #2&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-three"&gt;Part #3&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-four"&gt;Part #4&lt;/Link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; );</code> </pre> <br><blockquote>  <code>&lt;Link&gt;</code> debajo del capó tiene un mecanismo muy complicado para optimizar la carga de la página y, por lo tanto, se utiliza en lugar de <code>&lt;a&gt;</code> para navegar por el sitio.  Más detalles se pueden encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . </blockquote><p><img src="https://habrastorage.org/webt/no/ev/fj/noevfjkjdbel6tonxughcn6mkfq.gif" alt="navegación"></p><br><p>  Se crean páginas, se agregan enlaces, resulta que la navegación ha finalizado. </p><br><h2 id="komponenty-shablony-i-ih-vzaimodeystvie">  Componentes, plantillas y su interacción </h2><br><p>  Como sabes, en cualquier proyecto siempre hay elementos repetitivos, para sitios web es un encabezado, pie de página, barra de navegación.  Además, las páginas, independientemente del contenido, se crean de acuerdo con una determinada estructura, y dado que <strong>Gatsby</strong> es un compilador de <strong>React</strong> , se utiliza el mismo enfoque de componentes para resolver estos problemas. </p><br><p>  Cree los componentes para el encabezado y el panel de navegación: </p><br><p>  <em>/src/components/header.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; /** *         *  ,     React-. *      ,    *  " ".     *    ""  GraphQL  gatsby- */ import logoSrc from "../images/logo.png"; export default () =&gt; ( &lt;header&gt; &lt;Link to="/"&gt; &lt;img src={logoSrc} alt="logo" width="60px" height="60px" /&gt; &lt;/Link&gt; That is header &lt;/header&gt; );</code> </pre> <br><p>  <em>/src/components/sidebar.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link } from "gatsby"; export default () =&gt; ( &lt;div&gt; &lt;ul&gt; &lt;li&gt; &lt;Link to="/about"&gt;about&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-zero"&gt;Part #0&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-one"&gt;Part #1&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-two"&gt;Part #2&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-three"&gt;Part #3&lt;/Link&gt; &lt;/li&gt; &lt;li&gt; &lt;Link to="/tutorial/part-four"&gt;Part #4&lt;/Link&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; );</code> </pre> <br><p>  y agregarlos a <em>/src/pages/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import Header from "../components/header"; import Sidebar from "../components/sidebar"; export default () =&gt; ( &lt;div&gt; &lt;Header /&gt; &lt;Sidebar /&gt; &lt;h1&gt;Index page&lt;/h1&gt; &lt;/div&gt; );</code> </pre> <br><p>  Comprobamos: </p><br><p><img src="https://habrastorage.org/webt/bg/l6/jn/bgl6jndogi4j0qzvm9q0jvsiglk.jpeg" alt="index_page"></p><br><p>  Todo funciona, pero necesitamos importar el encabezado y la barra lateral en cada página por separado, lo que no es muy conveniente, y para resolver este problema es suficiente crear un componente de diseño y envolver cada página con él. </p><br><blockquote>  Diseño Gatsby == contenedor de reacción <br>  <em>sí, no es igualdad estricta, porque es "casi" lo mismo</em> </blockquote><p>  <em>/src/components/layout.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import Header from "./header"; import Sidebar from "./sidebar"; export default ({ children }) =&gt; ( &lt;&gt; &lt;Header /&gt; &lt;div style={{ margin: `0 auto`, maxWidth: 650, backgroundColor: `#eeeeee` }} &gt; &lt;Sidebar /&gt; {children} &lt;/div&gt; &lt;/&gt; );</code> </pre> <br><p>  <em>/src/pages/index.js</em> (y todas las demás páginas) </p><br><pre> <code class="plaintext hljs">import React from "react"; import Layout from "../components/layout"; export default () =&gt; ( &lt;Layout&gt; &lt;h1&gt;Index page&lt;/h1&gt; &lt;/Layout&gt; );</code> </pre> <br><p>  Hecho, mira el navegador: </p><br><p><img src="https://habrastorage.org/webt/9p/9v/wo/9p9vwogkf2px--00mtzbgz2ke64.gif" alt="maquetacion"></p><br><blockquote>  ¿Por qué el proyecto contiene todos los nombres de archivo con una letra minúscula?  Para empezar, determinemos que el espacio de nombres para <strong>React</strong> proviene del hecho de que "cada archivo es una clase, y la clase siempre está en mayúscula".  En <strong>Gatsby, los</strong> archivos aún contienen clases, pero hay un "pero": "cada archivo es una página potencial y su nombre es la URL de esta página".  La comunidad llegó a la conclusión de que enlaces como <code>http://domain.com/User/Settings</code> no son <em>comme-il-faut</em> y kebab-case aprobado para nombres de archivos. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Estructura de archivo</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> src ├── components │ ├── header.js │ ├── layout.js │ └── sidebar.js ├── images │ └── logo.png └── pages ├── about.js ├── index.js └── tutorial ├── part-eight.js ├── part-five.js ├── part-four.js ├── part-one.js ├── part-seven.js ├── part-six.js ├── part-three.js ├── part-two.js └── part-zero.js</code> </pre> </div></div><br><h2 id="rabota-s-dannymi">  Trabajar con datos </h2><br><p>  Ahora que la estructura del sitio está lista, puede continuar con el llenado de contenido.  El enfoque clásico de "código duro" no se adaptaba a los creadores de la pila JAM, así como al "contenido de procesamiento de solicitudes AJAX" y, por lo tanto, sugirieron llenar los sitios con contenido en tiempo de compilación.  En el caso de <strong>Gatsby</strong> , <strong>GraphQL</strong> es responsable de esto, lo que le permite trabajar convenientemente con flujos de datos de cualquier fuente. </p><br><blockquote>  Es imposible hablar de GraphQL en pocas palabras, por lo que es recomendable estudiarlo usted mismo o esperar mi próximo artículo.  Puede leer más sobre trabajar con GraphQL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aquí</a> . </blockquote><p>  Para trabajar con <strong>GraphQL</strong> , desde la segunda versión, el paquete <code>gatsby</code> tiene un componente <code>gatsby</code> que se puede usar tanto en páginas como en componentes simples, y esta es su principal diferencia con respecto a su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">consulta de página</a> predecesora.  Hasta ahora, nuestro sitio no está conectado a ninguna fuente de datos, así que tratemos de mostrar los metadatos de la página, por ejemplo, y luego pasemos a cosas más complejas. </p><br><p>  Para crear una <code>query</code> debe abrir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http: // localhost: 8000 / ___ graphql</a> , y usar la barra lateral con la documentación para encontrar los datos disponibles sobre el sitio, y no se olvide de la finalización automática. </p><br><p><img src="https://habrastorage.org/webt/qw/im/yd/qwimydi9eummj2mlkdpuzxdlg_0.gif" alt="graphql"></p><br><p>  <em>/src/components/sidebar.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; export default () =&gt; ( &lt;StaticQuery query={graphql` { allSitePage { edges { node { id path } } } } `} render={({ allSitePage: { edges } }) =&gt; ( &lt;ul&gt; {edges.map(({ node: { id, path } }) =&gt; ( &lt;li key={id}&gt; &lt;Link to={path}&gt;{id}&lt;/Link&gt; &lt;/li&gt; ))} &lt;/ul&gt; )} /&gt; );</code> </pre> <br><p>  Ahora, mediante la <code>query</code> obtenemos datos sobre las páginas que mostramos en el panel de navegación, y no tenemos que preocuparnos por el hecho de que el enlace no coincidirá con el nombre, porque todos los datos se recopilan automáticamente. </p><br><p><img src="https://habrastorage.org/webt/nc/pk/6l/ncpk6l8hirx9guim5am6ikgpfvo.jpeg" alt="queried_navigation_panel"></p><br><p>  De hecho, estos son todos los datos que pueden estar en nuestro sitio sin usar complementos de terceros y sin el viejo "código duro", así que pasamos al siguiente tema de nuestro artículo: los complementos. </p><br><h2 id="plaginy">  Complementos </h2><br><p>  En esencia, Gatsby es un compilador con un montón de cosas, que son complementos.  Utilizándolos, puede personalizar el procesamiento de ciertos archivos, tipos de datos y varios formatos. </p><br><p>  Cree el archivo <em>/gatsby-config.js</em> en el nivel raíz de la aplicación.  que es responsable de la configuración del compilador en su conjunto e intenta configurar el primer complemento para trabajar con archivos: </p><br><p>  Instalación del complemento: </p><br><pre> <code class="bash hljs">yarn add gatsby-source-filesystem</code> </pre> <br><p>  Configuración en el archivo <em>/gatsby-config.js:</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } } ], }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Más detalles sobre el archivo de arriba</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> /** * gatsby-config.js     *     JS *     */ module.exports = { /** *  'plugins'  pipeline  * ,      */ plugins: [ /** *        , *         */ `gatsby-example-plugin`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } } ], }</code> </pre> </div></div><br><p>  ¿Recuerdas que hablamos sobre la importación de imágenes "correctas" en <strong>Gatsby</strong> ? </p><br><p>  <em>/src/components/header.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; export default () =&gt; ( &lt;StaticQuery query={graphql` { allFile(filter: { name: { eq: "logo" } }) { edges { node { publicURL } } } } `} render={({ allFile: { edges: [ { node: { publicURL } } ] } }) =&gt; ( &lt;header&gt; &lt;Link to="/"&gt; &lt;img src={publicURL} alt="logo" width="60px" height="60px" /&gt; &lt;/Link&gt; That is header &lt;/header&gt; )} /&gt; );</code> </pre> <br><p>  Nada ha cambiado en el sitio, pero ahora la imagen se sustituye con GraphQL, en lugar de una simple importación de paquete web.  A primera vista, puede parecer que los diseños son demasiado complejos y fueron gestos innecesarios, pero no nos apresuremos a sacar conclusiones, porque la cosa está en los mismos complementos.  Por ejemplo, si decidimos publicar miles de fotos en el sitio, en cualquier caso, tuvimos que pensar en optimizar la carga de todo el contenido, y para no construir nuestro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proceso de carga diferida</a> desde cero, simplemente agregaríamos un complemento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gatsby-image</a> que optimizaría la carga de todos imágenes importadas usando la <code>query</code> . </p><br><p>  Instalación de complementos para diseñar: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-typography react-typography typography typography-theme-noriega node-sass gatsby-plugin-sass gatsby-plugin-styled-components styled-components babel-plugin-styled-components</code> </pre> <br><p>  <em>gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, // add style plugins below `gatsby-plugin-typography`, `gatsby-plugin-sass`, `gatsby-plugin-styled-components` ] };</code> </pre> <br><blockquote>  En el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sitio web oficial</a> puede encontrar un complemento para todos los gustos. </blockquote><br><h2 id="stilizaciya-prilozheniya">  Estilo de aplicación </h2><br><p>  Comencemos a diseñar la aplicación usando varios enfoques.  En el paso anterior, ya instalamos complementos para trabajar con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SASS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">styled-components</a> y la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">typography.js</a> , aunque es importante tener en cuenta que css.modules son compatibles desde el primer momento. </p><br><p>  Comencemos con los estilos globales, que, como otras cosas relacionadas con todo el sitio, deben configurarse en el archivo <em>/gatsby-browser.js</em> : </p><br><pre> <code class="plaintext hljs">import "./src/styles/global.scss";</code> </pre> <br><blockquote>  Más acerca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gatsby-browser.js</a> </blockquote><p>  <em>/src/styles/global.scss</em> </p><br><pre> <code class="plaintext hljs">body { background-color: lavenderblush; }</code> </pre> <br><p>  Por varias razones, las tendencias de los últimos años se están inclinando hacia el enfoque "CSS en JS", por lo que no debe abusar de los estilos globales y es mejor limitarse a indicar la fuente y las clases reutilizadas.  Este proyecto en particular planea usar <strong>Typography.js</strong> para estos fines, por lo que los estilos globales permanecerán vacíos. </p><br><p>  Es posible que haya notado cambios en la apariencia del sitio después de agregar <code>gatsby-plugin-typography</code> a la configuración; esto se debe a que se aplicó su valor predeterminado predeterminado y ahora lo configuraremos nosotros mismos. </p><br><p>  <em>/src/utils/typography.js</em> </p><br><pre> <code class="plaintext hljs">import Typography from "typography"; import theme from "typography-theme-noriega"; const typography = new Typography(theme); export default typography;</code> </pre> <br><blockquote>  Puede seleccionar cualquier otro ajuste preestablecido de la <a href="">lista</a> o crear uno propio utilizando la API del paquete ( <a href="">ejemplo de la</a> configuración del sitio web oficial de Gatsby) </blockquote><p>  <em>/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">module.exports = { plugins: [ { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography` } }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components` ] };</code> </pre> <br><p>  Y dependiendo del preajuste seleccionado, el estilo global del sitio cambiará.  Decide qué enfoque establecer para ti estilos globales, es una cuestión de preferencias y diferencias personales desde un punto de vista técnico, pero pasamos a los componentes de estilo usando componentes con <strong>estilo</strong> : </p><br><p>  Agregue un archivo con variables globales <em>/src/utils/vars.js</em> </p><br><pre> <code class="plaintext hljs">export const colors = { main: `#663399`, second: `#fbfafc`, main50: `rgba(102, 51, 153, 0.5)`, second50: `rgba(251, 250, 252, 0.5)`, textMain: `#000000`, textSecond: `#ffffff`, textBody: `#222222` };</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">/src/components/header.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; import styled from "styled-components"; import { colors } from "../utils/vars"; const Header = styled.header` width: 100%; height: 3em; display: flex; justify-content: space-between; align-items: center; background-color: ${colors.main}; color: ${colors.textSecond}; padding: 0.5em; `; const Logo = styled.img` border-radius: 50%; height: 100%; `; const logoLink = `height: 100%;`; export default () =&gt; ( &lt;StaticQuery query={graphql` { allFile(filter: { name: { eq: "logo" } }) { edges { node { publicURL } } } } `} render={({ allFile: { edges: [ { node: { publicURL } } ] } }) =&gt; ( &lt;Header&gt; That is header &lt;Link to="/" css={logoLink}&gt; &lt;Logo src={publicURL} alt="logo" /&gt; &lt;/Link&gt; &lt;/Header&gt; )} /&gt; );</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">/src/components/sidebar.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react" import { Link, StaticQuery, graphql } from "gatsby" import styled from "styled-components" import { colors } from "../utils/vars" const Sidebar = styled.section` position: fixed; left: 0; width: 20%; height: 100%; display: flex; flex-direction: column; justify-content: center; background-color: ${colors.second}; color: ${colors.textMain}; ` const navItem = ` display: flex; align-items: center; margin: 0 1em 0 2em; padding: 0.5em 0; border-bottom: 0.05em solid ${colors.mainHalf}; postion: relative; color: ${colors.textBody}; text-decoration: none; &amp;:before { content: ''; transition: 0.5s; width: 0.5em; height: 0.5em; position: absolute; left: 0.8em; border-radius: 50%; display: block; background-color: ${colors.main}; transform: scale(0); } &amp;:last-child { border-bottom: none; } &amp;:hover { &amp;:before { transform: scale(1); } } ` export default () =&gt; ( &lt;StaticQuery query={graphql` { allSitePage { edges { node { id, path } } } } `} render={({ allSitePage: { edges } }) =&gt; ( &lt;Sidebar&gt; { edges.map(({ node: { id, path } }) =&gt; ( &lt;Link to={path} key={id} css={navItem} &gt;{id}&lt;/Link&gt; )) } &lt;/Sidebar&gt; )} /&gt; )</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/qf/1w/i6/qf1wi6f95fjjjx794g8qvujbksw.gif" alt="estilizado"></p><br><p>  Los elementos ya existentes están estilizados y es hora de asociar contenido con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Contentful</a> , conectar el complemento de margen y generar páginas usando la <strong>API createPages</strong> . </p><br><blockquote>  Lea más sobre cómo vincular Gatsby y Contentful en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">artículo anterior.</a> </blockquote><br><div class="spoiler">  <b class="spoiler_title">Estructura de mis datos con Contentful</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> [ { "id": "title", "type": "Symbol" }, { "id": "content", "type": "Text", }, { "id": "link", "type": "Symbol", }, { "id": "orderNumber", "type": "Integer", } ]</code> </pre> </div></div><br><p>  Instalación del paquete: </p><br><pre> <code class="bash hljs">yarn add dotenv gatsby-source-contentful gatsby-transformer-remark</code> </pre> <br><p>  <em>/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">if (process.env.NODE_ENV === "development") { require("dotenv").config(); } module.exports = { plugins: [ `gatsby-transformer-remark`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/`, } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography`, }, }, { resolve: `gatsby-source-contentful`, options: { spaceId: process.env.CONTENTFUL_SPACE_ID, accessToken: process.env.CONTENTFUL_ACCESS_TOKEN, }, }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components`, ], }</code> </pre> <br><p>  Elimine la carpeta <em>/ src / pages</em> con todos los archivos dentro y cree un nuevo archivo para administrar los nodos en Gatsby: </p><br><p>  <em>/gatsby-node.js</em> </p><br><pre> <code class="plaintext hljs">const path = require(`path`); /** *  ,      *       */ exports.createPages = ({ graphql, actions }) =&gt; { /** *        *        *    */ const { createPage } = actions; return graphql(` { allContentfulArticle { edges { node { title link content { childMarkdownRemark { html } } } } } } `).then(({ data: { allContentfulArticle: { edges } } }) =&gt; { /** *       *  createPage()    *      */ edges.forEach(({ node }) =&gt; { createPage({ path: node.link, component: path.resolve(`./src/templates/index.js`), context: { slug: node.link } }); }); }); };</code> </pre> <br><blockquote>  Más acerca de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gatsby-node.js</a> </blockquote><p>  Cree un archivo de plantilla que será la base de las páginas generadas. <br>  <em>/src/templates/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { graphql } from "gatsby"; import Layout from "../components/layout"; export default ({ data: { allContentfulArticle: { edges: [ { node: { content: { childMarkdownRemark: { html } } } } ] } } }) =&gt; { return ( &lt;Layout&gt; &lt;div dangerouslySetInnerHTML={{ __html: html }} /&gt; &lt;/Layout&gt; ); }; export const query = graphql` query($slug: String!) { allContentfulArticle(filter: { link: { eq: $slug } }) { edges { node { title link content { childMarkdownRemark { html } } } } } } `;</code> </pre> <br><blockquote>  ¿Por qué el <code>&lt;StaticQuery /&gt;</code> no se usa aquí?  Lo que pasa es que no admite variables para construir una solicitud, pero necesitamos usar la variable <code>$slug</code> desde el contexto de la página. </blockquote><br><div class="spoiler">  <b class="spoiler_title">Actualizando la lógica en la barra de navegación</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> import React from "react"; import { Link, StaticQuery, graphql } from "gatsby"; import styled from "styled-components"; import { colors } from "../utils/vars"; const Sidebar = styled.section` position: fixed; left: 0; width: 20%; height: 100%; display: flex; flex-direction: column; justify-content: center; background-color: ${colors.second}; color: ${colors.textMain}; `; const navItem = ` display: flex; align-items: center; margin: 0 1em 0 2em; padding: 0.5em 0; border-bottom: 0.05em solid ${colors.main50}; postion: relative; color: ${colors.textBody}; text-decoration: none; &amp;:before { content: ''; transition: 0.5s; width: 0.5em; height: 0.5em; position: absolute; left: 0.8em; border-radius: 50%; display: block; background-color: ${colors.main}; transform: scale(0); } &amp;:last-child { border-bottom: none; } &amp;:hover { &amp;:before { transform: scale(1); } } `; export default () =&gt; ( &lt;StaticQuery query={graphql` { allContentfulArticle(sort: { order: ASC, fields: orderNumber }) { edges { node { title link orderNumber } } } } `} render={({ allContentfulArticle: { edges } }) =&gt; ( &lt;Sidebar&gt; {edges.map(({ node: { title, link, orderNumber } }) =&gt; ( &lt;Link to={link} key={link} css={navItem}&gt; {orderNumber}. {title} &lt;/Link&gt; ))} &lt;/Sidebar&gt; )} /&gt; );</code> </pre> </div></div><br><p><img src="https://habrastorage.org/webt/fn/bc/fs/fnbcfsl-qbdzkh1murfclmr7itk.gif" alt="datos"></p><br><h2 id="seo-optimizaciya">  Optimización SEO </h2><br><p>  En el aspecto técnico, el sitio puede considerarse listo, así que trabajemos con sus metadatos.  Para hacer esto, necesitamos los siguientes complementos: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-react-helmet react-helmet</code> </pre> <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">react-helmet</a> genera <code>&lt;head&gt;...&lt;/head&gt;</code> para páginas HTML y, junto con el renderizado de Gatsby, es una herramienta poderosa y conveniente para trabajar con SEO. </blockquote><p>  <em>/src/templates/index.js</em> </p><br><pre> <code class="plaintext hljs">import React from "react"; import { graphql } from "gatsby"; import { Helmet } from "react-helmet"; import Layout from "../components/layout"; export default ({ data: { allContentfulArticle: { edges: [ { node: { title, content: { childMarkdownRemark: { html } } } } ] } } }) =&gt; { return ( &lt;Layout&gt; &lt;Helmet&gt; &lt;meta charSet="utf-8" /&gt; &lt;title&gt;{title}&lt;/title&gt; &lt;/Helmet&gt; &lt;div dangerouslySetInnerHTML={{ __html: html }} /&gt; &lt;/Layout&gt; ); }; export const query = graphql` query($slug: String!) { allContentfulArticle(filter: { link: { eq: $slug } }) { edges { node { title link content { childMarkdownRemark { html } } } } } } `;</code> </pre> <br><p>  Ahora el <code>title</code> sitio siempre coincidirá con el título del artículo, lo que afectará significativamente la publicación del sitio en los resultados de búsqueda específicamente para este problema.  Aquí puede agregar fácilmente <code>&lt;meta name="description" content=" "&gt;</code> con una descripción de cada artículo por separado, lo que permite al usuario comprender de qué se trata el artículo en la página de búsqueda, en general, todas las funciones de SEO ahora están disponibles y son manejables Un lugar </p><br><p><img src="https://habrastorage.org/webt/_7/l2/ht/_7l2hthmllnqdgycorxhaz2v_mw.png" alt="seo"></p><br><h2 id="nastroyka-pwa">  Configuración PWA </h2><br><p>  <strong>Gatsby está</strong> diseñado para ofrecer un rendimiento de primera clase listo para usar.  Se ocupa de los problemas de separación y minimización de código, así como la optimización en forma de precarga en segundo plano, procesamiento de imágenes, etc., para que el sitio que cree tenga un alto rendimiento sin ninguna configuración manual.  Estas características de rendimiento son una parte importante del soporte de un enfoque progresivo de aplicaciones web. </p><br><p>  Pero además de todo lo anterior, hay tres criterios básicos para un sitio que lo definen como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PWA</a> : </p><br><ul><li>  protocolo https </li><li>  presencia de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">manifest.json</a> </li><li>  acceso sin conexión al sitio debido a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">los trabajadores del servicio</a> </li></ul><br><p>  Gatsby no puede resolver el primer punto, ya que el <em>dominio</em> , el <em>alojamiento</em> y el <em>protocolo</em> son problemas de implementación y no de desarrollo, pero puedo recomendar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Netlify</a> , que resuelve el problema https de forma predeterminada. </p><br><p>  Pasamos a los elementos restantes, para esto instalaremos dos complementos: </p><br><pre> <code class="bash hljs">yarn add gatsby-plugin-manifest gatsby-plugin-offline</code> </pre> <br><p>  y configúrelos <em>/src/gatsby-config.js</em> </p><br><pre> <code class="plaintext hljs">if (process.env.NODE_ENV === "development") { require("dotenv").config(); } module.exports = { plugins: [ { resolve: `gatsby-plugin-manifest`, options: { name: `GatsbyJS translated tutorial`, short_name: `GatsbyJS tutorial`, start_url: `/`, background_color: `#f7f0eb`, theme_color: `#a2466c`, display: `standalone`, icon: `public/favicon.ico`, include_favicon: true } }, `gatsby-plugin-offline`, `gatsby-transformer-remark`, { resolve: `gatsby-source-filesystem`, options: { name: `images`, path: `${__dirname}/src/images/` } }, { resolve: `gatsby-plugin-typography`, options: { pathToConfigModule: `src/utils/typography` } }, { resolve: `gatsby-source-contentful`, options: { spaceId: process.env.CONTENTFUL_SPACE_ID, accessToken: process.env.CONTENTFUL_ACCESS_TOKEN } }, `gatsby-plugin-sass`, `gatsby-plugin-styled-components`, `gatsby-plugin-react-helmet` ] };</code> </pre> <br><p>  Puede personalizar su manifiesto utilizando la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentación</a> , así como personalizar la estrategia de los trabajadores del servicio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sobrescribiendo la configuración del complemento</a> . </p><br><p>  No notará ningún cambio en el modo de desarrollo, pero el sitio ya cumple con los últimos requisitos del mundo web, y cuando esté alojado en https: // dominio no será igual. </p><br><h2 id="vyvod">  Conclusión </h2><br><p>  Hace un par de años, cuando encontré por primera vez los problemas de poner las aplicaciones React en Internet, su soporte y actualización de contenido, no podía imaginar que ya existía un enfoque JAM-stack en el mercado que simplifica todos estos procesos, y ahora no me sorprenderé. simplicidad  Gatsby resuelve la mayoría de los problemas que afectan el rendimiento del sitio simplemente "fuera de la caja", y si comprende un poco más sobre las complejidades de personalizarlo según sus necesidades, puede obtener indicadores del 100% para todos los elementos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lighthouse</a> , lo que afecta significativamente la entrega del sitio en los motores de búsqueda (por al menos en Google). </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Repositorio con proyecto</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/442298/">https://habr.com/ru/post/442298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442286/index.html">Los oftalmólogos rusos hablaron sobre la visión biónica. La nueva aplicación móvil demuestra el trabajo del ciber</a></li>
<li><a href="../442288/index.html">Radiación: fuentes</a></li>
<li><a href="../442290/index.html">Hacer ST-Link V2.1 a partir de ST-Link V2 chino</a></li>
<li><a href="../442292/index.html">Pasantía de Sberseasons: Python, UX / UI, datos y mucho más para estudiantes</a></li>
<li><a href="../442294/index.html">Lo que Oleg Artamonov está un poco equivocado</a></li>
<li><a href="../442300/index.html">Miro y escucho donde quiero. Integrando Chromecast en una aplicación de Android</a></li>
<li><a href="../442304/index.html">Smartphones plegables: ¿y las aplicaciones?</a></li>
<li><a href="../442306/index.html">Cómo vender un git a otro git</a></li>
<li><a href="../442310/index.html">Firmware básico de Sonoff a través de Raspberry Pi</a></li>
<li><a href="../442312/index.html">DoT para distribución RPZ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>