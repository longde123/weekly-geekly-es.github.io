<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ป ๐ฉ๐ผโ๐ ๐ ุฎูู ุจุฑุฌ ุงูุฏูุงุน ูู ุงููุญุฏุฉ: ุณููุงุฑูููุงุช ูููุฌุงุช ูู ุงูุฃุนุฏุงุก ๐ฉโ๐ณ ๐ ๐ง</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[ุงูุฃุฌุฒุงุก ุงูุฃููู ูุงูุซุงููุฉ ูุงูุซุงูุซุฉ ูุงูุฑุงุจุนุฉ ูู ุงูุจุฑูุงูุฌ ุงูุชุนูููู] 



- ุฏุนู ุฃุนุฏุงุก ุงูุฃุญุฌุงู ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ ูุงููุจูุฑุฉ. 
- ุฅูุดุงุก ุณููุงุฑูููุงุช ุงููุนุจุฉ ูุน ููุฌ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฎูู ุจุฑุฌ ุงูุฏูุงุน ูู ุงููุญุฏุฉ: ุณููุงุฑูููุงุช ูููุฌุงุช ูู ุงูุฃุนุฏุงุก</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466855/" style=";text-align:right;direction:rtl">  [ุงูุฃุฌุฒุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุซุงููุฉ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุซุงูุซุฉ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุฑุงุจุนุฉ</a> ูู ุงูุจุฑูุงูุฌ ุงูุชุนูููู] <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฏุนู ุฃุนุฏุงุก ุงูุฃุญุฌุงู ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ ูุงููุจูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุณููุงุฑูููุงุช ุงููุนุจุฉ ูุน ููุฌุงุช ูุชุนุฏุฏุฉ ูู ุงูุฃุนุฏุงุก. </li><li style=";text-align:right;direction:rtl">  ูุตู ุชูููู ุงูุฃุตูู ูุญุงูุฉ ุงููุนุจ. </li><li style=";text-align:right;direction:rtl">  ุจุฏุก ุ ูููุฉ ุ ูุงูููุฒ ุ ูุงููุฒููุฉ ูุชุณุฑูุน ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุณููุงุฑูููุงุช ุชูุฑุงุฑ ูุง ููุงูุฉ ููุง. </li></ul><br>  ูุฐุง ูู ุงูุฌุฒุก ุงูุฎุงูุณ ูู ุณูุณูุฉ ูู ุงูุฏุฑูุณ ุญูู ุฅูุดุงุก ูุนุจุฉ ุจุณูุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏูุงุน ุนู ุงูุจุฑุฌ</a> .  ูู ุฐูู ุ ุณูู ูุชุนูู ููููุฉ ุฅูุดุงุก ุณููุงุฑูููุงุช ุงููุนุจ ุงูุชู ุชููุฏ ููุฌุงุช ูู ุงูุฃุนุฏุงุก ุงููุฎุชููุฉ. <br><br>  ุชู ุฅูุดุงุก ุงูุจุฑูุงูุฌ ุงูุชุนูููู ูู ุงููุญุฏุฉ 2018.4.6f1. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b12/6aa/945/b126aa94582cc44651853c3ee69be82b.jpg" width="512" height="256"></div><br>  <i>ูู ุงูุญุตูู ุนูู ูุฑูุญ ุฌุฏุง.</i> <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  ุงููุฒูุฏ ูู ุงูุฃุนุฏุงุก </h2><br>  ููุณ ูู ุงููุซูุฑ ููุงูุชูุงู ุฅูุดุงุก ููุณ ุงูููุนุจ ุงูุฃุฒุฑู ูู ูู ูุฑุฉ.  ุณุชููู ุงูุฎุทูุฉ ุงูุฃููู ูุฏุนู ุณููุงุฑูููุงุช ุงููุนุจ ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ูู ุฏุนู ุนุฏุฉ ุฃููุงุน ูู ุงูุฃุนุฏุงุก. <br><br><h3 style=";text-align:right;direction:rtl">  ุชููููุงุช ุงูุนุฏู </h3><br>  ููุงู ุทุฑู ุนุฏูุฏุฉ ูุฌุนู ุงูุฃุนุฏุงุก ูุฑูุฏูู ูู ููุนู ุ ููููุง ูู ูุนูููุฏ ุฐูู: ููุญู ูุตูููู ุนูู ุฃููู ุตุบุงุฑ ููุชูุณุทูู ููุจูุฑูู.  ููุถุน ุนูุงูุฉ ุนูููุง ุ ูู ุจุฅูุดุงุก ุชุนุฏุงุฏ <code>EnemyType</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> EnemyType { Small, Medium, Large }</code> </pre> <br>  ูู ุจุชุบููุฑ <code>EnemyFactory</code> ุจุญูุซ ูุฏุนู ุฌููุน ุฃููุงุน ุงูุฃุนุฏุงุก ุงูุซูุงุซุฉ ุจุฏูุงู ูู ูุงุญุฏ.  ููู ุงูุฃุนุฏุงุก ุงูุซูุงุซุฉ ุ ููุงู ุญุงุฌุฉ ุฅูู ุญููู ุงูุชูููู ููุณูุง ุ ูุฐูู ูุถูู ูุฆุฉ ูุชุฏุงุฎูุฉ <code>EnemyConfig</code> ุชุญุชูู ุนูู ูู ูููู ุ ุซู ูุถูู ุซูุงุซุฉ ุญููู ุงูุชูููู ูู ูุฐุง ุงูููุน ุฅูู ุงููุตูุน.  ูุธุฑูุง ูุฃู ูุฐู ุงููุฆุฉ ุชุณุชุฎุฏู ููุท ููุชููุฆุฉ ููู ูุณุชุฎุฏููุง ูู ุฃู ููุงู ุขุฎุฑ ุ ููููู ุจุจุณุงุทุฉ ุฌุนู ุญููููุง ุนุงูุฉ ุญุชู ูุชููู ุงููุตูุน ูู ุงููุตูู ุฅูููุง.  <code>EnemyConfig</code> ููุณูุง ููุณุช ูุทููุจุฉ ูุชููู ุนูููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemyFactory</span></span> : <span class="hljs-title"><span class="hljs-title">GameObjectFactory</span></span> { [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemyConfig</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Enemy prefab = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; [FloatRangeSlider(<span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">2f</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> FloatRange scale = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FloatRange(<span class="hljs-number"><span class="hljs-number">1f</span></span>); [FloatRangeSlider(<span class="hljs-number"><span class="hljs-number">0.2f</span></span>, <span class="hljs-number"><span class="hljs-number">5f</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> FloatRange speed = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FloatRange(<span class="hljs-number"><span class="hljs-number">1f</span></span>); [FloatRangeSlider(<span class="hljs-number"><span class="hljs-number">-0.4f</span></span>, <span class="hljs-number"><span class="hljs-number">0.4f</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> FloatRange pathOffset = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FloatRange(<span class="hljs-number"><span class="hljs-number">0f</span></span>); } [SerializeField] EnemyConfig small = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, medium = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>, large = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; โฆ }</code> </pre> <br>  ุฏุนููุง ุฃูุถูุง ูุฌุนู ุงูุตุญุฉ ูุงุจูุฉ ููุชุฎุตูุต ููู ุนุฏู ุ ูุฃูู ูู ุงูููุทูู ุฃู ูููู ููุฃุนุฏุงุก ุงููุจุงุฑ ุฃูุซุฑ ูู ุงูุฃุนุฏุงุก. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">FloatRangeSlider(10f, 1000f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> FloatRange health = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FloatRange(<span class="hljs-number"><span class="hljs-number">100f</span></span>);</code> </pre> <br>  ุฃุถู ูุนููุฉ ูุชุงุจุฉ ุฅูู <code>Get</code> ุจุญูุซ ููููู ุงูุญุตูู ุนูู ููุน ูุนููู ุ ูุณูููู ุงูููุน ุงูุงูุชุฑุงุถู ูุชูุณุทูุง.  ุณูุณุชุฎุฏู ุงูููุน ููุญุตูู ุนูู ุงูุชูููู ุงูุตุญูุญ ุ ูุงูุฐู ูู ุฃุฌูู ุทุฑููุฉ ูููุตูุฉ ูููุฏุฉ ุ ููู ุซู ุฅูุดุงุก ุงูุนุฏู ูุชููุฆุชู ููุง ูุงู ูู ูุจู ุ ููุท ูุน ูุณูุทุฉ ุงูุตุญุฉ ุงููุถุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">EnemyConfig </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetConfig</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemyType type</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EnemyType.Small: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> small; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EnemyType.Medium: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> medium; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> EnemyType.Large: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> large; } Debug.Assert(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">"Unsupported enemy type!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Enemy </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Get</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemyType type = EnemyType.Medium</span></span></span><span class="hljs-function">)</span></span> { EnemyConfig config = GetConfig(type); Enemy instance = CreateGameObjectInstance(config.prefab); instance.OriginFactory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; instance.Initialize( config.scale.RandomValueInRange, config.speed.RandomValueInRange, config.pathOffset.RandomValueInRange, config.health.RandomValueInRange ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> instance; }</code> </pre> <br>  ุฃุถู ุงููุนููุฉ ุงููุทููุจุฉ ููุตุญุฉ ุฅูู <code>Enemy.Initialize</code> ูุชุนููู ุงูุตุญุฉ ุจุฏูุงู ูู ุชุญุฏูุฏูุง ุญุณุจ ุญุฌู ุงูุนุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> scale, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> speed, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pathOffset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> health </span></span></span><span class="hljs-function">)</span></span> { โฆ Health = health; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุฎูู ุชุตููู ุฃุนุฏุงุก ูุฎุชูููู </h3><br>  ููููู ุงุฎุชูุงุฑ ุชุตููู ุงูุฃุนุฏุงุก ุงูุซูุงุซุฉ ุ ููู ูู ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุณุฃุนูู ุฌุงูุฏูู ุนูู ุชุญููู ุฃูุตู ูุฏุฑ ูู ุงูุจุณุงุทุฉ.  ููุฏ ูุณุฎุช ุงูุฌุงูุฒุฉ ุงูุฃุตููุฉ ููุนุฏู ูุงุณุชุฎุฏูุชูุง ูู ุฌููุน ุงูุฃุญุฌุงู ุงูุซูุงุซุฉ ุ ุบูุฑุช ุงููุงุฏุฉ ููุท: ุงูุฃุตูุฑ ููุตุบูุฑ ูุงูุฃุฒุฑู ูููุชูุณุท โโูุงูุฃุญูุฑ ููุฃูุจุฑ.  ูู ุฃุบูุฑ ูููุงุณ ุงูููุนุจ ุงูุฌุงูุฒ ุ ููููู ุงุณุชุฎุฏูุช ุชูููู ูููุงุณ ุงููุตูุน ูุถุจุท ุงูุฃุจุนุงุฏ.  ุฃูุถูุง ุ ุจูุงุกู ุนูู ุงูุญุฌู ุ ููุช ุจุฒูุงุฏุฉ ุตุญุชูู ูุชูููู ุงูุณุฑุนุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/bd7/070/231/bd707023151022e921c5b6956bb20c02.png" width="320" height="348"></div><br>  <i>ูุตูุน ููุฃุนุฏุงุก ููุนุจุงุช ูู ุซูุงุซุฉ ุฃุญุฌุงู.</i> <br><br>  ุฃุณุฑุน ุทุฑููุฉ ูู <code>Game.SpawnEnemy</code> ุงูุฃููุงุน ุงูุซูุงุซุฉ ูู ุงููุนุจุฉ ุนู ุทุฑูู ุชุบููุฑ <code>Game.SpawnEnemy</code> ุจุญูุซ ูุญุตู ุนูู ููุน ุนุดูุงุฆู ูู ุงูุนุฏู ุจุฏูุงู ูู ุงูููุน ุงูุฃูุณุท. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SpawnEnemy</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GameTile spawnPoint = board.GetSpawnPoint(Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, board.SpawnPointCount)); Enemy enemy = enemyFactory.Get((EnemyType)(Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>))); enemy.SpawnOn(spawnPoint); enemies.Add(enemy); }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/537/73b/b92/53773bb9299a8ec9c56b485718049e5b.png" width="230" height="230"></div><br>  <i>ุฃุนุฏุงุก ูู ุฃููุงุน ูุฎุชููุฉ.</i> <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุนุฏูุฏ ูู ุงููุตุงูุน </h3><br>  ุงูุขู ูุตูุน ุงูุฃุนุฏุงุก ูุถุน ุงููุซูุฑ ูู ุงูุฃุนุฏุงุก ุงูุซูุงุซุฉ.  ูููู ุงููุตูุน ุงูุญุงูู ุจุฅูุดุงุก ููุนุจุงุช ูู ุซูุงุซุฉ ุฃุญุฌุงู ุ ููู ูุง ุดูุก ูููุนูุง ูู ุฅูุดุงุก ูุตูุน ุขุฎุฑ ููุชุฌ ุดูุฆูุง ุขุฎุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฌุงูุงุช ูู ุซูุงุซุฉ ุฃุญุฌุงู.  ูููููุง ุชุบููุฑ ุงูุฃุนุฏุงุก ุงูุฐูู ุชู ุฅูุดุงุคูุง ุนู ุทุฑูู ุชุนููู ูุตูุน ุขุฎุฑ ูู ุงููุนุจุฉ ุ ูุจุงูุชุงูู ุงูุงูุชูุงู ุฅูู ููุถูุน ูุฎุชูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/65f/7e5/330/65f7e5330945ea654f1caef579fe567f.png" width="230" height="230"></div><br>  <i>ุฃุนุฏุงุก ูุฑููุฉ.</i> <br><br><h2 style=";text-align:right;direction:rtl">  ููุฌุงุช ุงูุฃุนุฏุงุก </h2><br>  ุงูุฎุทูุฉ ุงูุซุงููุฉ ูู ุฅูุดุงุก ุณููุงุฑูููุงุช ุงููุนุจ ูู ุฑูุถ ูุถุน ุงูุฃุนุฏุงุก ุจุชุฑุฏุฏ ุซุงุจุช.  ูุฌุจ ุฅูุดุงุก ุงูุฃุนุฏุงุก ูู ููุฌุงุช ูุชุชุงููุฉ ุญุชู ููุชูู ุงูุจุฑูุงูุฌ ุงููุตู ุฃู ูุฎุณุฑ ุงููุงุนุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุณูุณู ุงูุฎูู </h3><br>  ุชุชููู ููุฌุฉ ุงูุฃุนุฏุงุก ูู ูุฌููุนุฉ ูู ุงูุฃุนุฏุงุก ุงูุชู ูุชู ุฅูุดุงุคูุง ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุญุชู ุชูุชูู ุงูููุฌุฉ.  ูููู ุฃู ุชุญุชูู ุงูููุฌุฉ ุนูู ุฃููุงุน ูุฎุชููุฉ ูู ุงูุฃุนุฏุงุก ุ ููููู ุฃู ูุฎุชูู ุงูุชุฃุฎูุฑ ุจูู ุฅูุดุงุฆูุง.  ุญุชู ูุง ูุนูุฏ ุงูุชูููุฐ ุ ุณูุจุฏุฃ ุจุชุณูุณู ุงูุชูุฑูุฎ ุงูุจุณูุท ุงูุฐู ูุฎูู ููุณ ุงูููุน ูู ุงูุฃุนุฏุงุก ุจุชุฑุฏุฏ ุซุงุจุช.  ุซู ุณุชููู ุงูููุฌุฉ ูุฌุฑุฏ ูุงุฆูุฉ ุจูุฐู ุงูุชุณูุณูุงุช. <br><br>  ูุชูููู ูู ุชุณูุณู ุ ูู ุจุฅูุดุงุก ูุฆุฉ <code>EnemySpawnSequence</code> .  ูุธุฑูุง ูุฃูู ูุนูุฏ ุฌุฏูุง ุ ุถุนู ูู ููู ูููุตู.  ูุฌุจ ุฃู ูุนุฑู ุงูุชุณูุณู ุงููุตูุน ุงูุฐู ุณูุชู ุงุณุชุฎุฏุงูู ูููุน ุงูุนุฏู ุงูุฐู ุณูุชู ุฅูุดุงุคู ูุนุฏุฏูู ูุชูุฑุงุฑูู.  ูุชุจุณูุท ุงูุชูููู ุ ุณูุฌุนู ุงููุนููุฉ ุงูุฃุฎูุฑุฉ ูููุฉ ุ ูุงูุชู ุชุญุฏุฏ ููุฏุงุฑ ุงูููุช ุงูุฐู ูุฌุจ ุฃู ููุฑ ูุจู ุฅูุดุงุก ุงูุนุฏู ุงูุชุงูู.  ูุงุญุธ ุฃู ูุฐุง ุงูููุฌ ูุณูุญ ูู ุจุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ูุตุงูุน ุงูุนุฏู ูู ุงูููุฌุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemySpawnSequence</span></span> { [SerializeField] EnemyFactory factory = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; [SerializeField] EnemyType type = EnemyType.Medium; [SerializeField, Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> amount = <span class="hljs-number"><span class="hljs-number">1</span></span>; [SerializeField, Range(<span class="hljs-number"><span class="hljs-number">0.1f</span></span>, <span class="hljs-number"><span class="hljs-number">10f</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cooldown = <span class="hljs-number"><span class="hljs-number">1f</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุงูุฃููุงุฌ </h3><br>  ููุฌุฉ ูู ูุฌููุนุฉ ุจุณูุทุฉ ูู ุชุณูุณู ุฎูู ุงูุนุฏู.  ูู ุจุฅูุดุงุก ููุน <code>EnemyWave</code> EnemyWave ูู ูุจุฏุฃ ุจุชุณูุณู ููุงุณู ูุงุญุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [CreateAssetMenu] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemyWave</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { [SerializeField] EnemySpawnSequence[] spawnSequences = { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EnemySpawnSequence() }; }</code> </pre> <br>  ุงูุขู ูููููุง ุฎูู ููุฌุงุช ูู ุงูุฃุนุฏุงุก.  ุนูู ุณุจูู ุงููุซุงู ุ ุฎููุช ููุฌุฉ ุชููุฏ ูุฌููุนุฉ ูู ุงูุฃุนุฏุงุก ุงูููุนุจุฉ ุ ุจุฏุกูุง ูู ุนุดุฑุฉ ุฃุนุฏุงุก ุตุบุงุฑูุง ุ ุจุชุฑุฏุฏ ุงุซููู ูู ุงูุซุงููุฉ.  ูุชุจุนูุง ุฎูุณุฉ ูุชูุณุทุงุช ุ ูุชู ุฅูุดุงุคูุง ูุฑุฉ ูุงุญุฏุฉ ูู ุงูุซุงููุฉ ุ ูุฃุฎูุฑุงู ุ ุนุฏู ูุงุญุฏ ูุจูุฑ ูุน ุชููู ููุฏุฉ ุฎูุณ ุซูุงูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b16/af3/47f/b16af347f057760db35703515642db89.png" width="320" height="376"></div><br>  <i>ููุฌุฉ ูู ููุนุจุงุช ูุชุฒุงูุฏุฉ.</i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ูููููู ุฅุถุงูุฉ ุชุฃุฎูุฑ ุจูู ุงูุชุณูุณูุงุชุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ููููู ุชูููุฐู ุจุดูู ุบูุฑ ูุจุงุดุฑ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฃุฏุฎู ุชุฃุฎูุฑูุง ูุฏุชู ุฃุฑุจุน ุซูุงูู ุจูู ููุนุจุงุช ุตุบูุฑุฉ ููุชูุณุทุฉ ุงูุญุฌู ุ ููู ุจุชูููู ุนุฏุฏ ููุนุจุงุช ุตุบูุฑุฉ ุจููุฏุงุฑ ูุงุญุฏ ุ ูุฃุฏุฎู ุชุณูุณู ููุนุจ ุตุบูุฑ ูุงุญุฏ ูุน ุชููู ููุฏุฉ ุฃุฑุจุน ุซูุงูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/59b/ff4/3f9/59bff43f9a71002c0bd562f270b755ea.png" width="320" height="272"></div><br>  <i>ุฃุฑุจุน ุซูุงู ุชุฃุฎูุฑ ุจูู ููุนุจุงุช ุตุบูุฑุฉ ููุชูุณุทุฉ.</i> </div></div><br><h3 style=";text-align:right;direction:rtl">  ุณููุงุฑูููุงุช </h3><br>  ูุชู ุฅูุดุงุก ุณููุงุฑูู ุงููุนุจ ูู ุณูุณูุฉ ูู ุงูุฃููุงุฌ.  ููุฐุง ุงูุบุฑุถ ุ ูู ุจุฅูุดุงุก <code>GameScenario</code> ุฃุตู <code>GameScenario</code> ูุงุญุฏุฉ ูู ุงูููุฌุงุช ุ ุซู ุงุณุชุฎุฏูู ูุฅูุดุงุก ุงูุณููุงุฑูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; [CreateAssetMenu] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameScenario</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { [SerializeField] EnemyWave[] waves = {}; }</code> </pre> <br>  ุนูู ุณุจูู ุงููุซุงู ุ ููุช ุจุฅูุดุงุก ุณููุงุฑูู ุจู ููุฌุชุงู ูู ุงูุฃุนุฏุงุก ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ (MSC) ุ ุฃููุงู ูุน ููุนุจุงุช ุ ุซู ูุน ูุฑุงุช. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/796/df0/73b/796df073b24d092d35093b6e56b8be79.png" width="320" height="142"></div><br>  <i>ุงูุณููุงุฑูู ูุน ููุฌุชูู ูู MSC.</i> <br><br><h3 style=";text-align:right;direction:rtl">  ุญุฑูุฉ ุชุณูุณู </h3><br>  ุชูุณุชุฎุฏู ุฃููุงุน ุงูุฃุตูู ูู ุฅูุดุงุก ุจุฑุงูุฌ ูุตูุฉ ุ ูููู ูุธุฑูุง ูุฃููุง ุฃุตูู ุ ูุฌุจ ุฃู ุชุญุชูู ุนูู ุจูุงูุงุช ูุง ุชุชุบูุฑ ุฃุซูุงุก ุงููุนุจุฉ.  ููุน ุฐูู ุ ูููุถู ูุฏููุง ูู ุงูุณููุงุฑูู ุ ูุญุชุงุฌ ุจุทุฑููุฉ ูุง ุฅูู ุชุชุจุน ุญุงูุชููุง.  ุฅุญุฏู ุงูุทุฑู ูู ุชูุฑุงุฑ ุงูุฃุตูู ุงููุณุชุฎุฏูุฉ ูู ุงููุนุจุฉ ุจุญูุซ ูุชุนูุจ ุงูุชูุฑุงุฑ ุญุงูุชูุง.  ููููุง ูุณูุง ุจุญุงุฌุฉ ุฅูู ุชูุฑุงุฑ ุงูุฃุตู ุจุฃูููู ุ ูุงูุฏููุฉ ููุท ูุฑูุงุจุท ุงูุฃุตู ูุงููุฉ.  ูุฐูู ุฏุนููุง ููุดุฆ ูุฆุฉ ูููุตูุฉ <code>State</code> ุ ุฃููุงู ูู <code>EnemySpawnSequence</code> .  ูุธุฑูุง ูุฃูู ููุทุจู ููุท ุนูู ุชุณูุณู ุ ูุฅููุง ูุฌุนูู ูุชุฏุงุฎููุง.  ุชููู ุตุงูุญุฉ ููุท ุนูุฏูุง ุชุญุชูู ุนูู ุฅุดุงุฑุฉ ุฅูู ุชุณูุณู ุ ูุฐูู ุณูููุญู ุทุฑููุฉ ูููุดุฆ ูุน ูุนููุฉ ุชุณูุณู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/18c/752/4fd/18c7524fdac87c062a6c683bbdee1866.png" width="315" height="50"></div><br>  <i>ููุน ุญุงูุฉ ูุชุฏุงุฎูุฉ ูุดูุฑ ุฅูู ุชุณูุณูู.</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemySpawnSequence</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">State</span></span> { EnemySpawnSequence sequence; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemySpawnSequence sequence</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sequence = sequence; } } }</code> </pre> <br>  ุนูุฏูุง ูุฑูุฏ ุฃู ูุจุฏุฃ ุงูุชุญุฑู ููุฃูุงู ูู ุชุณูุณู ุ ูุญุชุงุฌ ุฅูู ูุณุฎุฉ ุฌุฏูุฏุฉ ูู ุงูุญุงูุฉ ููุฐุง ุงูุบุฑุถ.  ุฃุถู ุชุณูุณูุงุช ุฅูู ุทุฑููุฉ <code>Begin</code> ุ ูุงูุชู ุชููู ุจุจูุงุก ูุฅุฑุฌุงุน ุงูุญุงูุฉ.  ุจูุถู ูุฐุง ุ ุณูููู ูู ูู ูุชุตู ุจู <code>Begin</code> ูุณุคููุงู ุนู ูุทุงุจูุฉ ุงูุญุงูุฉ ุ ูุณูุธู ุงูุชุณูุณู ููุณู ุจูุง ุฌูุณูุฉ.  ุณูููู ูู ุงููููู ุงูุชูุฏู ุจุงูุชูุงุฒู ุนุฏุฉ ูุฑุงุช ูู ููุณ ุงูุชุณูุณู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemySpawnSequence</span></span> { โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Begin</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> State(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">State</span></span> { โฆ } }</code> </pre> <br>  ูู ุฃุฌู ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุงูุณุงุฎูุฉ ุ ุชุญุชุงุฌ ุฅูู ุฌุนูู ูุงุจูุงู ููุชุณูุณู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">System.Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">State</span></span> { โฆ }</code> </pre> <br>  ุนูุจ ูุฐุง ุงูููุฌ ูู ุฃูู ูู ูู ูุฑุฉ ูููู ุจุชุดุบูู ุชุณูุณู ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ูุงุฆู ุญุงูุฉ ุฌุฏูุฏ.  ูููููุง ุชุฌูุจ ุชุฎุตูุต ุงูุฐุงูุฑุฉ ูู ุฎูุงู ุฌุนููุง ุจููุฉ ุจุฏูุงู ูู ุงููุตู.  ูุฐุง ุฃูุฑ ุทุจูุนู ุทุงููุง ุธูุช ุงูุญุงูุฉ ุตุบูุฑุฉ.  ููุท ุถุน ูู ุงุนุชุจุงุฑู ุฃู ุงูุญุงูุฉ ูู ููุน ูููุฉ.  ุนูุฏ ููููุง ุ ูุชู ูุณุฎูุง ุ ูุฐูู ุชุชุจุนูุง ูู ููุงู ูุงุญุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">System.Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> State { โฆ }</code> </pre> <br>  ุชุชููู ุญุงูุฉ ุงูุชุณูุณู ูู ุฌุงูุจูู ููุท: ุนุฏุฏ ุงูุฃุนุฏุงุก ุงููุชููุฏุฉ ูุชุทูุฑ ููุช ุงูุฅููุงู ุงููุคูุช.  ูุถูู ุทุฑููุฉ <code>Progress</code> ุ ูุงูุชู ุชุฒูุฏ ูู ูููุฉ ุงูุฅููุงู ุงููุคูุช ุจุญููู ุฏูุชุง ุงูููุช ุ ุซู <code>Game.Update</code> ุนูุฏ ุงููุตูู ุฅูู ุงููููุฉ <code>Game.Update</code> ุ ุนูู ุบุฑุงุฑ ูุง ูุญุฏุซ ูุน ููุช ุงูุชูููุฏ ูู <code>Game.Update</code> .  ุณูููู ุจุฒูุงุฏุฉ ุนุฏุฏ ุงูุฃุนุฏุงุก ูู ูู ูุฑุฉ ูุญุฏุซ ูุฐุง.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฌุจ ุฃู ุชุจุฏุฃ ูููุฉ ุงูุฅููุงู ุงููุคูุช ุจุงููููุฉ ุงููุตูู ุจุญูุซ ููุดุฆ ุงูุชุณูุณู ุฃุนุฏุงุก ุฏูู ุชููู ูุคูุช ูู ุงูุจุฏุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cooldown; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemySpawnSequence sequence</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sequence = sequence; count = <span class="hljs-number"><span class="hljs-number">0</span></span>; cooldown = sequence.cooldown; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { cooldown += Time.deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (cooldown &gt;= sequence.cooldown) { cooldown -= sequence.cooldown; count += <span class="hljs-number"><span class="hljs-number">1</span></span>; } }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/50c/aba/5e5/50caba5e50d89e05a6cb9a631feb1c6d.png" width="315" height="74"></div><br>  <i>ุงูุฏููุฉ ุชุญุชูู ููุท ุนูู ุงูุจูุงูุงุช ุงููุงุฒูุฉ.</i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ูููููู ุงููุตูู ุฅูู EnemySpawnSequence.cooldown ูู ุงูุฏููุฉุ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุนู ุ ูุฃูู ูุชู ุชุนููู <code>State</code> ูู ููุณ ุงููุทุงู.  ูุฐูู ุ ุชุนุฑู ุงูุฃููุงุน ุงููุชุฏุงุฎูุฉ ุนู ุงูุฃุนุถุงุก ุงูุฎุงุตูู ููุฃููุงุน ุงูุชู ุชุญุชูู ุนูููุง. </div></div><br>  ูุฌุจ ุฃู ูุณุชูุฑ ุงูุชูุฏู ุญุชู ูุชู ุฅูุดุงุก ุงูุนุฏุฏ ุงููุทููุจ ูู ุงูุฃุนุฏุงุก ูููุชูู ุงูุชููู ุงููุคูุช.  ูู ูุฐู ุงููุฑุญูุฉ ุ ูุฌุจ ุฃู ูุจูุบ <code>Progress</code> ุนู ุงูุงูุชูุงู ุ ูููู ุนูู ุงูุฃุฑุฌุญ ุณูููุฒ ููููุงู ููู ุงููููุฉ.  ูุฐูู ุ ูู ูุฐู ุงููุญุธุฉ ูุฌุจ ุฃู ูุนูุฏ ุงูููุช ุงูุฅุถุงูู ูู ุฃุฌู ุงุณุชุฎุฏุงูู ููุฏูุง ูู ุงูุชุณูุณู ุงูุชุงูู.  ููู ูุนูู ูุฐุง ุ ุชุญุชุงุฌ ุฅูู ุชุญููู ุฏูุชุง ุงูููุช ุฅูู ูุนููุฉ.  ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุงูุฅุดุงุฑุฉ ุฅูู ุฃููุง ูู ููุชู ุจุนุฏ ุ ููููู ุชุญููู ุฐูู ูู ุฎูุงู ุฅุฑุฌุงุน ูููุฉ ุณุงูุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime</span></span></span><span class="hljs-function">)</span></span> { cooldown += deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (cooldown &gt;= sequence.cooldown) { cooldown -= sequence.cooldown; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &gt;= sequence.amount) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cooldown; } count += <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1f</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุฎูู ุฃุนุฏุงุก ูู ุฃู ููุงู </h3><br>  ูู ุฃุฌู ุชุณูุณู ุชูุฑุฎ ุงูุฃุนุฏุงุก ุ ูุญุชุงุฌ ุฅูู ุชุญููู <code>Game.SpawnEnemy</code> ุฅูู ุทุฑููุฉ ุซุงุจุชุฉ ุนุงูุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SpawnEnemy</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemyFactory factory, EnemyType type</span></span></span><span class="hljs-function">)</span></span> { GameTile spawnPoint = instance.board.GetSpawnPoint( Random.Range(<span class="hljs-number"><span class="hljs-number">0</span></span>, instance.board.SpawnPointCount) ); Enemy enemy = factory.Get(type); enemy.SpawnOn(spawnPoint); instance.enemies.Add(enemy); }</code> </pre> <br>  ูุธุฑูุง ูุฃู <code>Game</code> ููุณูุง ูู ุชุนุฏ ุชูุดุฆ ุฃุนุฏุงุก ุ ููููููุง ุฅุฒุงูุฉ ูุตูุน ุงูุนุฏู ูุณุฑุนุฉ ุงูุฅูุดุงุก ูุนูููุฉ ุงูุชุฑููุฌ ููุฅุจุฏุงุน ูุฑูุฒ ุฅูุดุงุก ุงูุนุฏู ูู <code>Update</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { }</code> </pre> <br>  ุณูู ูุฏุนู <code>Game.SpawnEnemy</code> ูู <code>EnemySpawnSequence.State.Progress</code> ุจุนุฏ ุฒูุงุฏุฉ ุนุฏุฏ ุงูุฃุนุฏุงุก. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime</span></span></span><span class="hljs-function">)</span></span> { cooldown += deltaTime; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (cooldown &gt;= sequence.cooldown) { โฆ count += <span class="hljs-number"><span class="hljs-number">1</span></span>; Game.SpawnEnemy(sequence.factory, sequence.type); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1f</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ููุฌุฉ ุงูุชูุฏู </h3><br>  ุฏุนููุง ูุชุจุน ููุณ ุงูููุฌ ูู ุงูุชุญุฑู ุนูู ุทูู ุชุณูุณู ููุง ูู ุงูุญุงู ุนูุฏ ุงูุชุญุฑู ุนูู ุทูู ููุฌุฉ ูุงููุฉ.  ุฏุนูุง ูุนุทู <code>EnemyWave</code> ุทุฑููุฉ <code>Begin</code> ุงูุฎุงุตุฉ ุจู ุ ูุงูุชู ุชูุฑุฌุน ูุณุฎุฉ ุฌุฏูุฏุฉ ูู ุจููุฉ <code>State</code> ุงููุชุฏุงุฎูุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชุญุชูู ุงูุญุงูุฉ ุนูู ูุคุดุฑ ุงูููุฌุฉ ูุญุงูุฉ ุงูุชุณูุณู ุงููุดุท ุงูุฐู ูุจุฏุฃ ุจู ูุน ุจุฏุงูุฉ ุงูุชุณูุณู ุงูุฃูู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9eb/9f8/bc7/9eb9f8bc7769dd0c65624802ac2a97b8.png" width="315" height="128"></div><br>  <i>ุญุงูุฉ ููุฌุฉ ุชุญุชูู ุนูู ุญุงูุฉ ุงูุชุณูุณู.</i> <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">EnemyWave</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { [SerializeField] EnemySpawnSequence[] spawnSequences = { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EnemySpawnSequence() }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Begin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> State(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> State { EnemyWave wave; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index; EnemySpawnSequence.State sequence; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">EnemyWave wave</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.wave = wave; index = <span class="hljs-number"><span class="hljs-number">0</span></span>; Debug.Assert(wave.spawnSequences.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"Empty wave!"</span></span>); sequence = wave.spawnSequences[<span class="hljs-number"><span class="hljs-number">0</span></span>].Begin(); } } }</code> </pre> <br>  ูุถูู ุฃูุถูุง ุฃุณููุจ <code>Progress</code> <code>EnemyWave.State</code> ุ ูุงูุฐู ูุณุชุฎุฏู ุงูููุฌ ููุณู ููุง ูุงู ูู ูุจู ุ ูุน ุชุบููุฑุงุช ุจุณูุทุฉ.  ูุจุฏุฃ ุจุงูุชุญุฑู ุนูู ุทูู ุงูุชุณูุณู ุงููุดุท ูุงุณุชุจุฏุงู ุฏูุชุง ุงูููุช ููุชูุฌุฉ ููุฐู ุงูุฏุนูุฉ.  ุจูููุง ูุชุจูู ููุช ุ ูุฅููุง ููุชูู ุฅูู ุงูุชุณูุณู ุงูุชุงูู ุ ุฅุฐุง ุชู ุงููุตูู ุฅููู ุ ููุญุฑุฒ ุชูุฏููุง ููู.  ุฅุฐุง ูู ูุชุจู ุฃู ุชุณูุณู ุ ูุฅููุง ูุนูุฏ ุงูููุช ุงููุชุจูู ุ  ุจุฅุฑุฌุงุน ูููุฉ ุณุงูุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaTime</span></span></span><span class="hljs-function">)</span></span> { deltaTime = sequence.Progress(deltaTime); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (deltaTime &gt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++index &gt;= wave.spawnSequences.Length) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deltaTime; } sequence = wave.spawnSequences[index].Begin(); deltaTime = sequence.Progress(deltaTime); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1f</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุนุฒูุฒ ุงููุตู </h3><br>  ุฅุถุงูุฉ <code>GameScenario</code> ููุณ ุงููุนุงูุฌุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุชุญุชูู ุงูุญุงูุฉ ุนูู ูุคุดุฑ ุงูููุฌุฉ ูุญุงูุฉ ุงูููุฌุฉ ุงููุดุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameScenario</span></span> : <span class="hljs-title"><span class="hljs-title">ScriptableObject</span></span> { [SerializeField] EnemyWave[] waves = {}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> State </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Begin</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> State(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> State { GameScenario scenario; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index; EnemyWave.State wave; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameScenario scenario</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scenario = scenario; index = <span class="hljs-number"><span class="hljs-number">0</span></span>; Debug.Assert(scenario.waves.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"Empty scenario!"</span></span>); wave = scenario.waves[<span class="hljs-number"><span class="hljs-number">0</span></span>].Begin(); } } }</code> </pre> <br>  ูุธุฑูุง ูุฃููุง ูู ุงููุณุชูู ุงูุฃุนูู ุ ูุง ุชุชุทูุจ ุทุฑููุฉ <code>Progress</code> ูุนููุฉ ูููููู ุงุณุชุฎุฏุงู <code>Time.deltaTime</code> ูุจุงุดุฑุฉ.  ูุง ูุญุชุงุฌ ุฅูู ุฅุฑุฌุงุน ุงูููุช ุงููุชุจูู ุ ููููุง ุจุญุงุฌุฉ ุฅูู ุฅุธูุงุฑ ูุง ุฅุฐุง ูุงู ุงูุจุฑูุงูุฌ ุงููุตู ููุชูููุง.  ุณูุนูุฏ <code>false</code> ุจุนุฏ ููุงูุฉ ุงูููุฌุฉ ุงูุฃุฎูุฑุฉ <code>true</code> ูุฅุธูุงุฑ ุฃู ุงูุจุฑูุงูุฌ ุงููุตู ูุง ูุฒุงู ูุดุทูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> deltaTime = wave.Progress(Time.deltaTime); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (deltaTime &gt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++index &gt;= scenario.waves.Length) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } wave = scenario.waves[index].Begin(); deltaTime = wave.Progress(deltaTime); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู </h3><br>  ูุชุดุบูู ุจุฑูุงูุฌ ูุตู <code>Game</code> ุ ูุฃูุช ุจุญุงุฌุฉ ุฅูู ุญูู ุชูููู ุงูุจุฑูุงูุฌ ุงููุตู ูุชุชุจุน ุญุงูุชู.  ุณูููู ููุท ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูู Awake ูุชุดุบูู <code>Update</code> ุนููู ุญุชู ูุชู <code>Update</code> ุญุงูุฉ ุจููุฉ ุงููุนุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField</span></span>] GameScenario scenario = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; GameScenario.State activeScenario; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { board.Initialize(boardSize, tileContentFactory); board.ShowGrid = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; activeScenario = scenario.Begin(); } โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { โฆ activeScenario.Progress(); enemies.GameUpdate(); Physics.SyncTransforms(); board.GameUpdate(); nonEnemies.GameUpdate(); }</code> </pre> <br>  ุงูุขู ุณูุชู ุฅุทูุงู ุงูุจุฑูุงูุฌ ุงููุตู ุงูููููู ูู ุจุฏุงูุฉ ุงููุนุจุฉ.  ุณูุชู ุงูุชุฑููุฌ ููุง ุญุชู ุงูุงูุชูุงุก ุ ูุจุนุฏ ุฐูู ูู ูุญุฏุซ ุดูุก. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/mk/x0/uf/mkx0ufxshpgvy29wjr_nxdmneu4.gif"></div><br>  <i>ุชุณุงุฑุน ููุฌุชุงู 10 ูุฑุงุช.</i> <br><br><h2 style=";text-align:right;direction:rtl">  ุจุฏุก ูููุงูุฉ ุงูุฃูุนุงุจ </h2><br>  ูููููุง ุฅุนุงุฏุฉ ุฅูุชุงุฌ ุณููุงุฑูู ูุงุญุฏ ุ ููู ุจุนุฏ ุงูุชูุงูู ูู ูุธูุฑ ุฃุนุฏุงุก ุฌุฏุฏ.  ููู ุชุณุชูุฑ ุงููุนุจุฉ ุ ูุญุชุงุฌ ุฅูู ุชูููู ุจุฏุก ุณููุงุฑูู ุฌุฏูุฏ ุ ุฅูุง ูุฏูููุง ุฃู ูุฃู ุงููุงุนุจ ููุฏ / ูุงุฒ.  ููููู ุฃูุถูุง ุชูููุฐ ุงุฎุชูุงุฑ ูู ุจูู ุนุฏุฉ ุณููุงุฑูููุงุช ุ ูููู ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ูู ูููุฑ ููู. <br><br><h3 style=";text-align:right;direction:rtl">  ุจุฏุงูุฉ ูุนุจุฉ ุฌุฏูุฏุฉ </h3><br>  ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุญุชุงุฌ ุฅูู ูุฑุตุฉ ูุจุฏุก ูุนุจุฉ ุฌุฏูุฏุฉ ูู ุฃู ููุช ูุญุฏุฏ.  ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชุนููู ุงูุญุงูุฉ ุงูุญุงููุฉ ููุนุจุฉ ุจุฃููููุง ุ ุฃู ุฃููุง ุณูุถุทุฑ ุฅูู ุฅุนุงุฏุฉ ุชุนููู ุงูุนุฏูุฏ ูู ุงููุงุฆูุงุช.  ุฃููุงู ุ ุฃุถู ุทุฑููุฉ <code>Clear</code> ุฅูู <code>GameBehaviorCollection</code> ุงูุชู ุชุณุชุฎุฏู ุฌููุน ุชุตุฑูุงุชูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; behaviors.Count; i++) { behaviors[i].Recycle(); } behaviors.Clear(); }</code> </pre> <br>  ูุฐุง ูุดูุฑ ุฅูู ุฃูู ูููู ุงูุชุฎูุต ูู ุฌููุน ุงูุณููููุงุช ุ ูููู ูุฐุง ููุณ ูู ุงูุญุงู ุญุชู ุงูุขู.  <code>GameBehavior</code> ูุฐุง ุงูุนูู ุ ุฃุถู ุทุฑููุฉ <code>Recycle</code> ูุฌุฑุฏุฉ ุฅูู <code>GameBehavior</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">abstract</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Recycle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>;</code> </pre> <br>  ูุฌุจ ุฃู ุชุชุฌุงูุฒ ุทุฑููุฉ <code>Recycle</code> ุงูุฎุงุตุฉ <code>WarEntity</code> ุจุดูู ุตุฑูุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Recycle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { originFactory.Reclaim(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br>  ููุณ ูุฏู <code>Enemy</code> ุจุนุฏ ุทุฑููุฉ <code>Recycle</code> ุ ูุฐุง ุฃุถูู.  ูู ูุง ุนููู ูุนูู ูู ุฅุฌุจุงุฑ ุงููุตูุน ุนูู ุฅุนุงุฏุชู.  ุซู ูุฏุนู <code>Recycle</code> ุฃูููุง ูุตููุง ูุจุงุดุฑุฉ ุฅูู ุงููุตูุน. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameUpdate</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Health &lt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { Recycle(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } progress += Time.deltaTime * progressFactor; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (progress &gt;= <span class="hljs-number"><span class="hljs-number">1f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tileTo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Recycle(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } โฆ } โฆ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Recycle</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { OriginFactory.Reclaim(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }</code> </pre> <br>  ุชุญุชุงุฌ <code>GameBoard</code> ุฃูุถูุง ุฅูู ุฅุนุงุฏุฉ <code>GameBoard</code> ุ ูุฐุง ุฏุนูุง ูุนุทููุง ุทุฑููุฉ <code>Clear</code> ุ ุงูุชู ุชูุฑุบ ุฌููุน ุงููุฑุจุนุงุช ุ <code>GameBoard</code> ุถุจุท ุฌููุน ููุงุท ุงูุฅูุดุงุก ูุชุญุฏูุซ ุงููุญุชูู ุ ุซู ุชููู ุจุชุนููู ููุงุท ุงูุจุฏุงูุฉ ูุงูููุงูุฉ ุงูููุงุณูุฉ.  ุจุนุฏ ุฐูู ุ ุจุฏูุงู ูู ุชูุฑุงุฑ ุงูุดูุฑุฉ ุ ูููููุง ุงูุงุชุตุงู ุจู <code>Clear</code> ูู ููุงูุฉ <code>Initialize</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> Vector2Int size, GameTileContentFactory contentFactory </span></span></span><span class="hljs-function">)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">0</span></span>; y &lt; size.y; y++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; size.x; x++, i++) { โฆ } } Clear(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (GameTile tile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tiles) { tile.Content = contentFactory.Get(GameTileContentType.Empty); } spawnPoints.Clear(); updatingContent.Clear(); ToggleDestination(tiles[tiles.Length / <span class="hljs-number"><span class="hljs-number">2</span></span>]); ToggleSpawnPoint(tiles[<span class="hljs-number"><span class="hljs-number">0</span></span>]); }</code> </pre> <br>  ุงูุขู ูููููุง ุฅุถุงูุฉ ุฃุณููุจ <code>BeginNewGame</code> ุฅูู <code>Game</code> ุ ูุฅููุงุก ุงูุฃุนุฏุงุก ุ ูุงููุงุฆูุงุช ุงูุฃุฎุฑู ูุงูุญูู ุ ุซู ุจุฏุก ุชุดุบูู ุจุฑูุงูุฌ ูุตู ุฌุฏูุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginNewGame</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { enemies.Clear(); nonEnemies.Clear(); board.Clear(); activeScenario = scenario.Begin(); }</code> </pre> <br>  ุณูุชุตู ุจูุฐู ุงูุทุฑููุฉ ูู <code>Update</code> ุฅุฐุง ุถุบุทุช ุนูู B ูุจู ุงูุงูุชูุงู ุฅูู ุงูุจุฑูุงูุฌ ุงููุตู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.B)) { BeginNewGame(); } activeScenario.Progress(); โฆ }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุฎุณุงุฑุฉ </h3><br>  ุงููุฏู ูู ุงููุนุจุฉ ูู ูุฒููุฉ ุฌููุน ุงูุฃุนุฏุงุก ูุจู ุฃู ูุตู ุนุฏุฏ ูุนูู ูููู ุฅูู ุงูููุทุฉ ุงูุฃุฎูุฑุฉ.  ูุนุชูุฏ ุนุฏุฏ ุงูุฃุนุฏุงุก ุงููุงุฒููู ูุจุฏุก ุญุงูุฉ ุงููุฒููุฉ ุนูู ุงูุญุงูุฉ ุงูุตุญูุฉ ุงูุฃูููุฉ ููุงุนุจ ุ ูุงูุชู ุณูุถูู ููุง ุญูู ุชููุฆุฉ <code>Game</code> .  ุจูุง ุฃููุง ูุนูู ุงูุฃุนุฏุงุก ุ ูุณูู ูุณุชุฎุฏู ุนุฏุฏูุง ุตุญูุญูุง ูููุณ ุชุนููููุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(0, 100)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> startingPlayerHealth = <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4f3/9c5/11a/4f39c511ab9d362b1cc7e55610a317aa.png" width="320" height="38"></div><br>  <i>ูู ุงูุจุฏุงูุฉ ุ ูุฏู ุงููุงุนุจ 10 ุตุญุฉ.</i> <br><br>  ูู ุญุงูุฉ Awake ุฃู ุจุฏุงูุฉ ูุนุจุฉ ุฌุฏูุฏุฉ ุ ูููู ุจุชุนููู ุงููููุฉ ุงูุฃูููุฉ ูุตุญุฉ ุงููุงุนุจ ุงูุญุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> playerHealth; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { playerHealth = startingPlayerHealth; โฆ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BeginNewGame</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { playerHealth = startingPlayerHealth; โฆ }</code> </pre> <br>  ุฃุถู ุทุฑููุฉ <code>EnemyReachedDestination</code> ุซุงุจุชุฉ ุนุงูุฉ <code>EnemyReachedDestination</code> ูุชููู ุงูุฃุนุฏุงุก ูู ุฅุฎุจุงุฑ <code>Game</code> ุจุฃููู ูุตููุง ุฅูู ููุทุฉ ุงูููุงูุฉ.  ุนูุฏูุง ูุญุฏุซ ูุฐุง ุ ููู ูู ุตุญุฉ ุงููุงุนุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EnemyReachedDestination</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { instance.playerHealth -= <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br>  ุงุณุชุฏุนุงุก ูุฐู ุงูุทุฑููุฉ ูู <code>Enemy.GameUpdate</code> ูู ุงูููุช ุงูููุงุณุจ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tileTo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { Game.EnemyReachedDestination(); Recycle(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  ุงูุขู ูููููุง ุงูุชุญูู ูู ุญุงูุฉ ุงููุฒููุฉ ูู <code>Game.Update</code> .  ุฅุฐุง ูุงูุช ุตุญุฉ ุงููุงุนุจ ุชุณุงูู ุฃู ุชูู ุนู ุงูุตูุฑ ุ ูุชู ุชุดุบูู ุญุงูุฉ ุงููุฒููุฉ.  ูุญู ุจุจุณุงุทุฉ ุชุณุฌูู ูุฐู ุงููุนูููุงุช ูุงูุจุฏุก ููุฑุง ูุนุจุฉ ุฌุฏูุฏุฉ ูุจู ุงููุถู ูุฏูุง.  ููููุง ุณููุนู ุฐูู ููุท ุจุตุญุฉ ุฃูููุฉ ุฅูุฌุงุจูุฉ.  ูุฐุง ูุณูุญ ููุง ุจุงุณุชุฎุฏุงู 0 ูุตุญุฉ ุฃูููุฉ ุ ููุง ูุฌุนู ูู ุงููุณุชุญูู ุฃู ูุฎุณุฑู.  ูุฐูู ุณูููู ูู ุงูููุงุณุจ ุจุงููุณุจุฉ ููุง ูุงุฎุชุจุงุฑ ุงููุตูุต. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerHealth &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; startingPlayerHealth &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Defeat!"</span></span>); BeginNewGame(); } activeScenario.Progress();</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ููุฒ </h3><br>  ุงูุจุฏูู ูููุฒููุฉ ูู ุงููุตุฑ ุงูุฐู ูุชุญูู ูู ููุงูุฉ ุงูุณููุงุฑูู ุ ุฅุฐุง ูุงู ุงููุงุนุจ ูุง ูุฒุงู ุนูู ููุฏ ุงูุญูุงุฉ.  ููุฐุง ูู ุ ุนูุฏูุง ุชููู ูุชูุฌุฉ <code>GameScenario.Progess</code> <code>false</code> ุ ูุนุฑุถ ุฑุณุงูุฉ ุงููุตุฑ ูู ุงูุณุฌู ุ ูุจุฏุฃ ูุนุจุฉ ุฌุฏูุฏุฉ ุ ููุชุญุฑู ููุฑูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (playerHealth &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Defeat!"</span></span>); BeginNewGame(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!activeScenario.Progress()) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Victory!"</span></span>); BeginNewGame(); activeScenario.Progress(); }</code> </pre> <br>  ููุน ุฐูู ุ ุณูุฃุชู ุงููุตุฑ ุจุนุฏ ููุงูุฉ ุงููููุฉ ุงูุฃุฎูุฑุฉ ุ ุญุชู ูู ูุงู ูุง ูุฒุงู ููุงู ุฃุนุฏุงุก ูู ุงูููุฏุงู.  ูุญุชุงุฌ ุฅูู ุชุฃุฌูู ุงููุตุฑ ุญุชู ุชุฎุชูู ุฌููุน ุงูุฃุนุฏุงุก ุ ููู ูุง ูููู ุชุญูููู ุนู ุทุฑูู ุงูุชุญูู ููุง ุฅุฐุง ูุงูุช ูุฌููุนุฉ ุงูุฃุนุฏุงุก ูุงุฑุบุฉ.  ูุญู ููุชุฑุถ ุฃู ูุฏููุง ุฎุงุตูุฉ <code>IsEmpty</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!activeScenario.Progress() &amp;&amp; enemies.IsEmpty) { Debug.Log(<span class="hljs-string"><span class="hljs-string">"Victory!"</span></span>); BeginNewGame(); activeScenario.Progress(); }</code> </pre> <br>  ุฅุถุงูุฉ ุงูุฎุงุตูุฉ ุงููุทููุจุฉ ุฅูู <code>GameBehaviorCollection</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> IsEmpty =&gt; behaviors.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุฑุงูุจุฉ ุงูููุช </h3><br>  ูููู ุฃูุถูุง ุจุชูููุฐ ููุฒุฉ ุฅุฏุงุฑุฉ ุงูููุช ุ ุญูุซ ุณูุณุงุนุฏ ุฐูู ูู ุงูุงุฎุชุจุงุฑ ูุบุงูุจูุง ูุง ูููู ูุธููุฉ ุงููุนุจ.  ููุจุฏุก ุ ุงุณูุญ ูู <code>Game.Update</code> ุจุงูุชุญูู ูู ูุฌูุฏ ูุณุงูุฉ ุ ูุงุณุชุฎุฏู ูุฐุง ุงูุญุฏุซ ูุชูููู / ุชุนุทูู <code>Game.Update</code> ูู ุงููุนุจุฉ.  ูููู ุงูููุงู ุจุฐูู ุนู ุทุฑูู ุชุจุฏูู ููู <code>Time.timeScale</code> ุจูู ุตูุฑ ููุงุญุฏ.  ูุฐุง ูู ูุบูุฑ ููุทู ุงููุนุจุฉ ุ ููู ุณูุฌุนู ูู ุงููุงุฆูุงุช ูุชุฌูุฏุฉ ูู ููุงููุง.  ุฃู ููููู ุงุณุชุฎุฏุงู ูููุฉ ุตุบูุฑุฉ ุฌุฏูุง ุจุฏูุงู ูู 0 ุ ุนูู ุณุจูู ุงููุซุงู 0.01 ุ ูุฅูุดุงุก ุญุฑูุฉ ุจุทูุฆุฉ ููุบุงูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> pausedTimeScale = <span class="hljs-number"><span class="hljs-number">0f</span></span>; โฆ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { โฆ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.Space)) { Time.timeScale = Time.timeScale &gt; pausedTimeScale ? pausedTimeScale : <span class="hljs-number"><span class="hljs-number">1f</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.B)) { BeginNewGame(); } โฆ }</code> </pre> <br> -,   <code>Game</code>    ,     . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(1f, 10f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> playSpeed = <span class="hljs-number"><span class="hljs-number">1f</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/b5d/641/4e9/b5d6414e9cd53d7ac89c5c1b3699b806.png" width="320" height="38"></div><br> <i> .</i> <br><br>           ,     .         . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Input.GetKeyDown(KeyCode.Space)) { Time.timeScale = Time.timeScale &gt; pausedTimeScale ? pausedTimeScale : playSpeed; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Time.timeScale &gt; pausedTimeScale) { Time.timeScale = playSpeed; }</code> </pre> <br><h2 style=";text-align:right;direction:rtl">   </h2><br>          .     ,           .      , ,      ,          . <br><br><h3 style=";text-align:right;direction:rtl">     </h3><br>   <code>GameScenario</code>      ,      1.   ,      .     ,    ,     ,  ,    . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(0, 10)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cycles = <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d0c/5d0/9df/d0c5d09dfd50e0e088c1848aaa32d531.png" width="320" height="38"></div><br> <i>   .</i> <br><br>  <code>GameScenario.State</code>    . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cycle, index; EnemyWave.State wave; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameScenario scenario</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scenario = scenario; cycle = <span class="hljs-number"><span class="hljs-number">0</span></span>; index = <span class="hljs-number"><span class="hljs-number">0</span></span>; wave = scenario.waves[<span class="hljs-number"><span class="hljs-number">0</span></span>].Begin(); }</code> </pre> <br>  <code>Progress</code>       ,   <code>false</code> ,      .            . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> deltaTime = wave.Progress(Time.deltaTime); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (deltaTime &gt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++index &gt;= scenario.waves.Length) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++cycle &gt;= scenario.cycles &amp;&amp; scenario.cycles &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } index = <span class="hljs-number"><span class="hljs-number">0</span></span>; } wave = scenario.waves[index].Begin(); deltaTime = wave.Progress(deltaTime); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  </h3><br>       ,        .    ,    .    ,          .            . <br><br>   <code>GameScenario</code>       .             . ,   0.5      ร1,     ร1.5,  ร2,  ร2.5,   . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">SerializeField, Range(0f, 1f)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cycleSpeedUp = <span class="hljs-number"><span class="hljs-number">0.5f</span></span>;</code> </pre> <br>        <code>GameScenario.State</code> .     1         .     <code>Time.deltaTime</code>    . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> timeScale; EnemyWave.State wave; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">State</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GameScenario scenario</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.scenario = scenario; cycle = <span class="hljs-number"><span class="hljs-number">0</span></span>; index = <span class="hljs-number"><span class="hljs-number">0</span></span>; timeScale = <span class="hljs-number"><span class="hljs-number">1f</span></span>; wave = scenario.waves[<span class="hljs-number"><span class="hljs-number">0</span></span>].Begin(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Progress</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> deltaTime = wave.Progress(timeScale * Time.deltaTime); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (deltaTime &gt;= <span class="hljs-number"><span class="hljs-number">0f</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++index &gt;= scenario.waves.Length) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++cycle &gt;= scenario.cycles &amp;&amp; scenario.cycles &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } index = <span class="hljs-number"><span class="hljs-number">0</span></span>; timeScale += scenario.cycleSpeedUp; } wave = scenario.waves[index].Begin(); deltaTime = wave.Progress(deltaTime); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre> <br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qv/-d/3s/qv-d3srpikyuiorxx9vjk06wir8.gif"></div><br> <i>      ;    .</i> <br><br>       ?      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Patreon</a> ! <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" rel="nofollow">  PDF</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar466855/">https://habr.com/ru/post/ar466855/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar466839/index.html">ูุตุฉ ุฅูุดุงุก ููุฑุชูู ูููุงูุฏุฑ. ุงูุฌุฒุก 1/3</a></li>
<li><a href="../ar466841/index.html">ููุงุฐุง ูุณุงุฏุฉ ุงูุชุฏูุฆุฉ ุ ุฅุฐุง ูุงู ููุงู ุฌูุงุฒ ููุจููุชุฑ ูุญููู: ุฏุฑุงุณุฉ ุงูููุงููุฉ ุงูุญุฑุงุฑูุฉ ุนูู ุงููุณุชูู ุงูุฐุฑู</a></li>
<li><a href="../ar466845/index.html">ููุงุจูุฉ ุนูุณูุฉ: ูุง ูู ุงูุฃุณุฆูุฉ ุงูุชู ุชุทุฑุญูุง ุงูุดุฑูุฉุ</a></li>
<li><a href="../ar466849/index.html">noexcept-ctcheck ุฃู ุจุนุถ ูุญุฏุงุช ุงููุงูุฑู ุงูุจุณูุทุฉ ููุณุงุนุฏุฉ ุงููุชุฑุฌู ุนูู ูุชุงุจุฉ ุฑูุฒ noexcept</a></li>
<li><a href="../ar466851/index.html">ุฎุท Agilex - 10nm Intel FPGA</a></li>
<li><a href="../ar466857/index.html">ุชูููุฐ ุชุทุจูู ุงูุฎูููุฉ ูู iOS 13</a></li>
<li><a href="../ar466859/index.html">ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุงุชุญุงุฏ AD ูุชุฎููู ุงููุณุชุฎุฏููู AWS ูุน ุชูุฒูุน ุงูุญููู</a></li>
<li><a href="../ar466861/index.html">ููููุฉ ุงููุฑูุจ ูู ุงููุงูุน ุจุงุณุชุฎุฏุงู hackathon</a></li>
<li><a href="../ar466863/index.html">ุฅุนุฏุงุฏ ุงูุฎุท ุงูููุงุฑุจ</a></li>
<li><a href="../ar466865/index.html">ูู ุงูุชุธุงุฑ ุงูุฃูู ูู ููููุจุฑ: ุญุธุฑ ุฃู ุชูููู ุงูุนููุงุช ุงููุดูุฑุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>