<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëêüèΩ üßí üç∑ Aplikasi menu bar untuk macOS üè£ üë©üèæ‚Äçü§ù‚Äçüë®üèø üà∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aplikasi yang terletak di bilah menu sudah lama dikenal pengguna macOS. Beberapa aplikasi ini memiliki bagian "normal", yang lain hanya terletak di bi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aplikasi menu bar untuk macOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447754/"> Aplikasi yang terletak di bilah menu sudah lama dikenal pengguna macOS.  Beberapa aplikasi ini memiliki bagian "normal", yang lain hanya terletak di bilah menu. <br>  Dalam panduan ini, Anda akan menulis aplikasi yang menampilkan beberapa kutipan dari orang-orang terkenal di jendela sembulan.  Dalam proses membuat aplikasi ini, Anda akan belajar: <br><br><ul><li>  menetapkan ikon aplikasi di bilah menu </li><li>  jadikan aplikasi hanya di-host di bilah menu </li><li>  tambahkan menu kustom </li><li>  perlihatkan jendela sembulan atas permintaan pengguna dan sembunyikan jika perlu, menggunakan <b>Pemantauan Acara</b> </li></ul><br><blockquote>  <b>Catatan:</b> panduan ini mengasumsikan bahwa Anda terbiasa dengan Swift dan macOS. </blockquote><a name="habracut"></a><br><h2>  Memulai </h2><br>  Luncurkan Xcode.  Selanjutnya, pada menu <b>File / New / Project ...</b> , pilih template <b>macOS / Application / Cocoa App</b> dan klik <b>Next</b> . <br><br>  Pada layar berikutnya, masukkan Kutipan sebagai <b>Nama Produk</b> , pilih <b>Nama</b> <b>Organisasi</b> dan <b>Pengidentifikasi Organisasi Anda</b> .  Kemudian pastikan Swift dipilih sebagai bahasa aplikasi dan kotak centang <b>Use Storyboards</b> dicentang.  Hapus centang pada <b>Buat Aplikasi Berbasis Dokumen</b> , <b>Gunakan Data Inti</b> , <b>Sertakan tes Unit</b> dan <b>Sertakan kotak centang Tes UI</b> . <br><br><img src="https://habrastorage.org/webt/4c/_f/g6/4c_fg6hmxqq0k_vqkm8-zqrt_ok.png"><br><br>  Terakhir, klik <b>Next</b> lagi, tentukan lokasi untuk menyimpan proyek dan klik <b>Buat</b> . <br>  Setelah proyek baru dibuat, buka <b>AppDelegate.swift</b> dan tambahkan properti berikut ke kelas: <br><br><pre><code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> statusItem = <span class="hljs-type"><span class="hljs-type">NSStatusBar</span></span>.system.statusItem(withLength:<span class="hljs-type"><span class="hljs-type">NSStatusItem</span></span>.squareLength)</code> </pre> <br>  Di sini kita buat di bilah menu Item Status (ikon aplikasi) panjang tetap yang akan terlihat oleh pengguna. <br><br>  Maka kita perlu menetapkan gambar kita ke item baru ini di menu bar sehingga kita dapat membedakan aplikasi baru kita. <br><br>  Di navigator proyek, buka Aset.xcassets, <a href="">unggah gambar</a> dan seret ke katalog aset. <br><br>  Pilih gambar dan buka inspektur atribut.  Ubah opsi <b>Render As</b> ke <b>Templat Gambar</b> . <br><br> <a href=""><img src="https://habrastorage.org/webt/wv/es/-o/wves-ouas8duyvk97fki1swuedk.png"></a> <br><br>  Jika Anda menggunakan gambar Anda sendiri, pastikan bahwa gambar itu hitam dan putih dan konfigurasikan sebagai <b>gambar Templat</b> sehingga ikon tampak hebat pada bilah menu gelap dan terang. <br><br>  Kembali ke <b>AppDelegate.swift</b> , dan tambahkan kode berikut ke <b>applicationDidFinishLaunching (_ :)</b> <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> button = statusItem.button { button.image = <span class="hljs-type"><span class="hljs-type">NSImage</span></span>(named:<span class="hljs-type"><span class="hljs-type">NSImage</span></span>.<span class="hljs-type"><span class="hljs-type">Name</span></span>(<span class="hljs-string"><span class="hljs-string">"StatusBarButtonImage"</span></span>)) button.action = #selector(printQuote(<span class="hljs-number"><span class="hljs-number">_</span></span>:)) }</code> </pre> <br>  Di sini kita menetapkan ikon aplikasi yang baru saja kita tambahkan ke ikon aplikasi dan menetapkan <b>tindakan</b> ketika kita mengkliknya. <br><br>  Tambahkan metode berikut ke kelas: <br><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printQuote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quoteText = <span class="hljs-string"><span class="hljs-string">"Never put off until tomorrow what you can do the day after tomorrow."</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quoteAuthor = <span class="hljs-string"><span class="hljs-string">"Mark Twain"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"\(quoteText) ‚Äî \(quoteAuthor)"</span></span>) }</code> </pre> <br>  Metode ini hanya mencetak kutipan ke konsol. <br><br>  Perhatikan <b>arahan</b> metode <b>objc</b> .  Ini memungkinkan Anda menggunakan metode ini sebagai respons terhadap klik tombol. <br><br>  Bangun dan jalankan aplikasi, dan Anda akan melihat aplikasi baru di bilah menu.  Hore! <br>  Setiap kali Anda mengklik ikon di bilah menu, perkataan Mark Twain yang terkenal ditampilkan di konsol Xcode. <br><br><h2>  Kami menyembunyikan jendela utama dan ikon di dok </h2><br>  Ada beberapa hal kecil yang perlu kita lakukan sebelum berhadapan langsung dengan fungsi: <br><br><ul><li>  hapus ikon dock </li><li>  hapus jendela utama aplikasi yang tidak perlu </li></ul><br>  Untuk menghapus ikon dok, buka <b>Info.plist</b> .  Tambahkan kunci <b>Application is agent (UIElement) baru</b> dan tetapkan nilainya ke <b>YES</b> . <br><br><img src="https://habrastorage.org/webt/-c/g_/pn/-cg_pnrysiiynfs2xfab8fyblhk.png"><br><br>  Sekarang saatnya berurusan dengan jendela aplikasi utama. <br><br><ul><li>  buka <b>Main.storyboard</b> </li><li>  pilih <b>adegan Window Controller</b> dan hapus </li><li>  <b>Lihat adegan Controller controller</b> , kami akan segera menggunakannya </li></ul><br><br> <a href=""><img src="https://habrastorage.org/webt/td/1q/vr/td1qvrwqe8qpgp2xvadbifvu_4o.png"></a> <br><br>  Bangun dan jalankan aplikasi.  Sekarang aplikasi tidak memiliki jendela utama dan ikon yang tidak perlu di dok.  Hebat! <br><br><h2>  Tambahkan menu ke Item Status </h2><br>  Respons satu klik jelas tidak cukup untuk aplikasi serius.  Cara termudah untuk menambah fungsionalitas adalah dengan menambahkan menu.  Tambahkan fungsi ini di akhir <b>AppDelegate</b> . <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constructMenu</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> menu = <span class="hljs-type"><span class="hljs-type">NSMenu</span></span>() menu.addItem(<span class="hljs-type"><span class="hljs-type">NSMenuItem</span></span>(title: <span class="hljs-string"><span class="hljs-string">"Print Quote"</span></span>, action: #selector(<span class="hljs-type"><span class="hljs-type">AppDelegate</span></span>.printQuote(<span class="hljs-number"><span class="hljs-number">_</span></span>:)), keyEquivalent: <span class="hljs-string"><span class="hljs-string">"P"</span></span>)) menu.addItem(<span class="hljs-type"><span class="hljs-type">NSMenuItem</span></span>.separator()) menu.addItem(<span class="hljs-type"><span class="hljs-type">NSMenuItem</span></span>(title: <span class="hljs-string"><span class="hljs-string">"Quit Quotes"</span></span>, action: #selector(<span class="hljs-type"><span class="hljs-type">NSApplication</span></span>.terminate(<span class="hljs-number"><span class="hljs-number">_</span></span>:)), keyEquivalent: <span class="hljs-string"><span class="hljs-string">"q"</span></span>)) statusItem.menu = menu }</code> </pre> <br>  Dan kemudian tambahkan panggilan ini di akhir <b>applicationDidFinishLaunching (_ :)</b> <br><br><pre> <code class="swift hljs">constructMenu()</code> </pre> <br>  Kami membuat <b>NSMenu</b> , menambahkan 3 instance <b>NSMenuItem</b> ke dalamnya, dan mengatur menu ini sebagai menu ikon aplikasi. <br><br>  Beberapa poin penting: <br><br><ul><li>  <b>Judul</b> item menu adalah teks yang muncul di menu.  Tempat yang bagus untuk melokalkan aplikasi (jika perlu). </li><li>  <b>aksi</b> , seperti <b>aksi</b> tombol atau kontrol lainnya, adalah metode yang dipanggil ketika pengguna mengklik item menu </li><li>  <b>keyEquivalent</b> adalah pintasan keyboard yang dapat Anda gunakan untuk memilih item menu.  Huruf kecil menggunakan <b>Cmd</b> sebagai pengubah, dan huruf kecil menggunakan <b>Cmd + Shift</b> .  Ini hanya berfungsi jika aplikasi berada di paling atas dan aktif.  Dalam kasus kami, perlu bahwa menu atau jendela lain terlihat, karena aplikasi kita tidak memiliki ikon di dok </li><li>  <b>separatorItem</b> adalah item menu tidak aktif dalam bentuk garis abu-abu antara elemen lain.  Gunakan untuk grup </li><li>  <b>printQuote</b> adalah metode yang sudah Anda tentukan di <b>AppDelegate</b> , dan <b>terminasi</b> adalah metode yang ditentukan oleh <b>NSApplication</b> . </li></ul><br>  Luncurkan aplikasi dan Anda akan melihat menu dengan mengklik ikon aplikasi. <br><br><img src="https://habrastorage.org/webt/-w/2v/lv/-w2vlv2nfi_vxgosiihbqd19m5g.png"><br><br>  Coba klik pada menu - memilih <b>Print Quote</b> akan menampilkan penawaran di konsol Xcode, dan <b>Quit Quotes</b> mengakhiri aplikasi. <br><br><h2>  Tambahkan sembulan </h2><br>  Anda melihat betapa mudahnya menambahkan menu dari kode, tetapi menampilkan kutipan di konsol Xcode jelas bukan yang diharapkan pengguna dari aplikasi.  Sekarang kita akan menambahkan controller tampilan sederhana untuk menampilkan kutipan dengan cara yang benar. <br><br>  Buka menu <b>File / New / File ...</b> , pilih template <b>macOS / Source / Cocoa Class</b> dan klik <b>Next</b> . <br><br> <a href=""><img src="https://habrastorage.org/webt/m5/vd/7w/m5vd7wewsgjt16zajhbas3ca9mi.png"></a> <br><br><ul><li>  <b>beri</b> nama kelas <b>QuotesViewController</b> </li><li>  membuat pewaris <b>NSViewController</b> </li><li>  pastikan kotak centang <b>Juga buat file XIB untuk antarmuka pengguna</b> tidak dicentang </li><li>  atur bahasa ke Swift </li></ul><br>  Terakhir, klik <b>Next</b> lagi, pilih lokasi untuk menyimpan file, dan klik <b>Buat</b> . <br>  Sekarang buka <b>Main.storyboard</b> .  Rentangkan <b>View Controller Scene</b> dan pilih <b>View Controller instance</b> . <br><br> <a href=""><img src="https://habrastorage.org/webt/c4/dd/em/c4ddemmj9moxiu_whrzl7ilme_4.png"></a> <br><br>  Pertama-tama pilih <b>Inspektur Identitas</b> dan ubah kelas menjadi <b>QuotesViewController</b> , lalu atur <b>Storyboard ID</b> ke <b>QuotesViewController</b> <br><br>  Sekarang tambahkan kode berikut ke akhir file <b>QuotesViewController.swift</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuotesViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// MARK: Storyboard instantiation static func freshController() -&gt; QuotesViewController { //1. let storyboard = NSStoryboard(name: NSStoryboard.Name("Main"), bundle: nil) //2. let identifier = NSStoryboard.SceneIdentifier("QuotesViewController") //3. guard let viewcontroller = storyboard.instantiateController(withIdentifier: identifier) as? QuotesViewController else { fatalError("Why cant i find QuotesViewController? - Check Main.storyboard") } return viewcontroller } }</span></span></code> </pre> <br>  Apa yang terjadi di sini: <br><br><ol><li>  kami mendapatkan tautan ke <b>Main.storyboard</b> . </li><li>  buat <b>pengidentifikasi adegan</b> yang cocok dengan yang baru saja kita instal di atas. </li><li>  buat instance dari <b>QuotesViewController</b> dan kembalikan. </li></ol><br>  Anda membuat metode ini, jadi sekarang semua orang yang menggunakan <b>QuotesViewController</b> tidak perlu tahu bagaimana itu dibuat.  Itu hanya bekerja. <br><br>  Perhatikan <b>fatalError</b> di dalam pernyataan <b>penjaga</b> .  Bisa menyenangkan untuk menggunakannya atau <b>pernyataan Kegagalan</b> sehingga jika ada sesuatu yang salah dalam pengembangan, Anda sendiri, dan anggota tim pengembangan lainnya, mengetahui. <br><br>  Sekarang kembali ke <b>AppDelegate.swift</b> .  Tambahkan properti baru. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> popover = <span class="hljs-type"><span class="hljs-type">NSPopover</span></span>()</code> </pre> <br>  Kemudian ganti <b>pplicationDidFinishLaunching (_ :) dengan</b> kode berikut: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applicationDidFinishLaunching</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> aNotification: Notification)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> button = statusItem.button { button.image = <span class="hljs-type"><span class="hljs-type">NSImage</span></span>(named:<span class="hljs-type"><span class="hljs-type">NSImage</span></span>.<span class="hljs-type"><span class="hljs-type">Name</span></span>(<span class="hljs-string"><span class="hljs-string">"StatusBarButtonImage"</span></span>)) button.action = #selector(togglePopover(<span class="hljs-number"><span class="hljs-number">_</span></span>:)) } popover.contentViewController = <span class="hljs-type"><span class="hljs-type">QuotesViewController</span></span>.freshController() }</code> </pre><br>  Anda telah mengubah aksi klik untuk memanggil metode <b>togglePopover (_ :)</b> , yang akan kami tulis sedikit kemudian.  Selain itu, alih-alih mengonfigurasi dan menambahkan menu, kami mengonfigurasi jendela sembulan yang akan menampilkan sesuatu dari <b>QuotesViewController</b> . <br><br>  Tambahkan tiga metode berikut ke <b>AppDelegate</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">togglePopover</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> popover.isShown { closePopover(sender: sender) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { showPopover(sender: sender) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showPopover</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sender: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> button = statusItem.button { popover.show(relativeTo: button.bounds, of: button, preferredEdge: <span class="hljs-type"><span class="hljs-type">NSRectEdge</span></span>.minY) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closePopover</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sender: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { popover.performClose(sender) }</code> </pre> <br>  <b>showPopover ()</b> menunjukkan munculan.  Anda cukup menunjukkan dari mana asalnya, macOS memposisikannya dan menggambar panah, seolah-olah itu muncul dari menu bar. <br><br>  <b>closePopover ()</b> baru saja menutup popup, dan <b>togglePopover ()</b> adalah metode yang menunjukkan atau menyembunyikan popup, tergantung pada <b>kondisinya</b> . <br><br>  Luncurkan aplikasi dan klik ikonnya. <br><br><img src="https://habrastorage.org/webt/j6/gu/oq/j6guoqowcbou3xwtqr2cdunm4ns.png"><br><br>  Semuanya baik-baik saja, tetapi di mana isinya? <br><br><h2>  Kami menerapkan Pengendali Tampilan Penawaran </h2><br>  Pertama, Anda membutuhkan model untuk menyimpan kutipan dan atribut.  Buka menu <b>File / New / File ...</b> dan pilih <b>template macOS / Source / Swift File</b> , lalu <b>Next</b> .  Beri nama file <b>Penawaran</b> dan klik <b>Buat</b> . <br><br>  Buka file <b>Quote.swift</b> dan tambahkan kode berikut ke dalamnya: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quote</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> text: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> author: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> all: [<span class="hljs-type"><span class="hljs-type">Quote</span></span>] = [ <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"Never put off until tomorrow what you can do the day after tomorrow."</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Mark Twain"</span></span>), <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"Efficiency is doing better what is already being done."</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Peter Drucker"</span></span>), <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"To infinity and beyond!"</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Buzz Lightyear"</span></span>), <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"May the Force be with you."</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Han Solo"</span></span>), <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"Simplicity is the ultimate sophistication"</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Leonardo da Vinci"</span></span>), <span class="hljs-type"><span class="hljs-type">Quote</span></span>(text: <span class="hljs-string"><span class="hljs-string">"It's not just what it looks like and feels like. Design is how it works."</span></span>, author: <span class="hljs-string"><span class="hljs-string">"Steve Jobs"</span></span>) ] } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quote</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomStringConvertible</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> description: <span class="hljs-type"><span class="hljs-type">String</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"\"\(text)\" ‚Äî \(author)"</span></span> } }</code> </pre> <br>  Di sini kita mendefinisikan struktur kutipan sederhana dan properti statis yang mengembalikan semua kutipan.  Karena kami membuat <b>kutipan yang</b> sesuai dengan protokol <b>CustomStringConvertible</b> , kami dapat dengan mudah mendapatkan teks yang diformat dengan mudah. <br><br>  Ada kemajuan, tetapi kami masih membutuhkan kontrol untuk menampilkan semua ini. <br><br><h2>  Tambahkan elemen antarmuka </h2><br>  Buka Main.storyboard dan tarik keluar 3 tombol ( <b>Push Button</b> ) dan label ( <b>Multiline Label)</b> pada pengontrol tampilan. <br><br>  Posisikan tombol dan label sehingga terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/1v/ry/2_/1vry2_ydfrxoqiqdsklo2uouwne.png"><br><br>  Pasang tombol kiri ke tepi kiri dengan celah 20 dan tengah secara vertikal. <br>  Pasang tombol kanan ke tepi kanan dengan celah 20 dan tengah secara vertikal. <br>  Pasang tombol bawah ke tepi bawah dengan celah 20 dan tengah secara horizontal. <br>  Pasang tepi kiri dan kanan tanda ke tombol dengan celah 20, di tengah secara vertikal. <br><br> <a href=""><img src="https://habrastorage.org/webt/jl/zi/tl/jlzitledfqmcexzv636ya6ir6sq.png"></a> <br><br>  Anda akan melihat beberapa kesalahan tata letak, karena tidak ada informasi yang cukup untuk <b>tata letak otomatis</b> untuk mengetahuinya. <br><br>  Tetapkan <b>Prioritas Memeluk Konten Horizontal</b> ke 249 untuk memungkinkan label untuk mengubah ukuran. <br><br> <a href=""><img src="https://habrastorage.org/webt/a6/qp/s0/a6qps0r2_vobhsjkbcfiqohklgc.png"></a> <br><br>  Sekarang lakukan hal berikut: <br><br><ul><li>  atur <b>gambar</b> tombol kiri ke <b>NSGoLeftTemplate</b> dan hapus <b>judulnya</b> </li><li>  atur <b>gambar</b> tombol kanan ke <b>NSGoRightTemplate</b> dan hapus <b>judulnya</b> </li><li>  atur <b>judul</b> tombol di bawah ini ke <b>Quit Quotes</b> . </li><li>  atur <b>perataan teks</b> label ke tengah. </li><li>  pastikan <b>Line Break</b> pada label diatur ke <b>Word Wrap</b> . </li></ul><br><br>  Sekarang buka <b>QuotesViewController.swift</b> dan tambahkan kode berikut untuk implementasi kelas <b>QuotesViewController</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textLabel: <span class="hljs-type"><span class="hljs-type">NSTextField!</span></span></code> </pre> <br><br>  Tambahkan ekstensi ini ke implementasi kelas.  Sekarang di <b>QuotesViewController.swift ada</b> dua ekstensi kelas. <br><br><pre> <code class="swift hljs"><span class="hljs-comment"><span class="hljs-comment">// MARK: Actions extension QuotesViewController { @IBAction func previous(_ sender: NSButton) { } @IBAction func next(_ sender: NSButton) { } @IBAction func quit(_ sender: NSButton) { } }</span></span></code> </pre> <br>  Kami baru saja menambahkan <b>outlet</b> untuk label yang akan kami gunakan untuk menampilkan kutipan, dan 3 metode rintisan yang akan kami sambungkan dengan tombol. <br><br><h2>  Menghubungkan kode dengan Interface Builder </h2><br>  Catatan: Xcode telah menempatkan lingkaran di sebelah kiri kode Anda - di sebelah kata kunci <b>IBAction</b> dan <b>IBOutlet</b> . <br><br><img src="https://habrastorage.org/webt/kv/48/k_/kv48k_pvgucw0v1jexqsna44dda.png"><br><br>  Kami akan menggunakannya untuk menghubungkan kode ke UI. <br><br>  Sambil menahan tombol <b>alt</b> , klik <b>Main.storyboard</b> di <b>navigator proyek</b> .  Dengan demikian, <b>storyboard</b> terbuka di <b>Asisten Editor</b> di sebelah kanan, dan kode di sebelah kiri. <br><br>  Seret lingkaran ke kiri <b>textLabel</b> ke label pada <b>pembuat antarmuka</b> .  Dengan cara yang sama, gabungkan metode <b>sebelumnya</b> , <b>berikutnya,</b> dan <b>keluar</b> dengan tombol kiri, kanan, dan bawah. <br><br> <a href=""><img src="https://habrastorage.org/webt/7-/qu/yb/7-quybzu1bexw545popvn_mbeea.png"></a> <br><br>  Luncurkan aplikasi Anda. <br><br><img src="https://habrastorage.org/webt/tr/b2/6w/trb26wseu6kdpeyqyjdbeojwoxu.png"><br><br>  Kami menggunakan ukuran sembulan default.  Jika Anda ingin popup yang lebih besar atau lebih kecil, cukup ubah ukurannya di <b>storyboard</b> . <br><br><h2>  Menulis kode untuk tombol </h2><br>  Jika Anda belum menyembunyikan <b>Asisten Editor</b> , klik <b>Cmd-Return</b> atau <b>Vew&gt; Editor Standar&gt; Tampilkan Editor Standar</b> <br><br>  Buka <b>QuotesViewController.swift</b> dan tambahkan properti berikut ke implementasi kelas: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quotes = <span class="hljs-type"><span class="hljs-type">Quote</span></span>.all <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> currentQuoteIndex: <span class="hljs-type"><span class="hljs-type">Int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">didSet</span></span> { updateQuote() } }</code> </pre> <br>  Properti <b>kutipan</b> berisi semua kutipan, dan <b>currentQuoteIndex</b> adalah indeks kutipan yang saat ini sedang ditampilkan.  <b>CurrentQuoteIndex</b> juga memiliki <b>pengamat properti</b> untuk memperbarui konten label dengan kutipan baru ketika indeks berubah. <br><br>  Sekarang tambahkan metode berikut: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() currentQuoteIndex = <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateQuote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { textLabel.stringValue = <span class="hljs-type"><span class="hljs-type">String</span></span>(describing: quotes[currentQuoteIndex]) }</code> </pre> <br>  Saat tampilan dimuat, kami menetapkan indeks kutipan ke 0, yang pada gilirannya mengarah ke pembaruan ke antarmuka.  <b>updateQuote ()</b> cukup memperbarui label teks untuk menampilkan penawaran.  sesuai <b>sekarangQuoteIndex</b> . <br><br>  Akhirnya, perbarui metode ini dengan kode berikut: <br><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@IBAction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">previous</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender: NSButton)</span></span></span></span> { currentQuoteIndex = (currentQuoteIndex - <span class="hljs-number"><span class="hljs-number">1</span></span> + quotes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>) % quotes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> } <span class="hljs-meta"><span class="hljs-meta">@IBAction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender: NSButton)</span></span></span></span> { currentQuoteIndex = (currentQuoteIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>) % quotes.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> } <span class="hljs-meta"><span class="hljs-meta">@IBAction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender: NSButton)</span></span></span></span> { <span class="hljs-type"><span class="hljs-type">NSApplication</span></span>.shared.terminate(sender) }</code> </pre> <br>  Metode <b>berikutnya ()</b> dan <b>sebelumnya ()</b> menggilir semua kutipan.  <b>berhenti</b> menutup aplikasi. <br><br>  Luncurkan aplikasi: <br><br><img src="https://habrastorage.org/webt/wi/qh/ju/wiqhjuzkw5c8f7bmtofythu147k.png"><br><br><h2>  Pemantauan acara </h2><br>  Ada satu hal lagi yang diharapkan pengguna dari aplikasi kita - sembunyikan jendela sembul ketika pengguna mengklik di suatu tempat di luarnya.  Untuk melakukan ini, kita memerlukan mekanisme yang disebut <b>macOS global event monitor</b> . <br><br>  Buat file Swift baru, sebut saja <b>EventMonitor</b> , dan ganti kontennya dengan kode berikut: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Cocoa public class EventMonitor { private var monitor: Any? private let mask: NSEvent.EventTypeMask private let handler: (NSEvent?) -&gt; Void public init(mask: NSEvent.EventTypeMask, handler: @escaping (NSEvent?) -&gt; Void) { self.mask = mask self.handler = handler } deinit { stop() } public func start() { monitor = NSEvent.addGlobalMonitorForEvents(matching: mask, handler: handler) } public func stop() { if monitor != nil { NSEvent.removeMonitor(monitor!) monitor = nil } } }</code> </pre> <br>  Saat menginisialisasi turunan dari kelas ini, kami memberikannya masker acara yang akan kami dengarkan (seperti penekanan tombol, gulungan roda mouse, dll.) Dan pengendali acara. <br>  Ketika kita siap untuk mulai mendengarkan, <b>mulai ()</b> panggil <b>addGlobalMonitorForEventsMatchingMask (_: handler :)</b> , yang mengembalikan objek yang kita simpan.  Segera setelah peristiwa yang terkandung dalam topeng terjadi, sistem memanggil penangan Anda. <br><br>  Untuk berhenti memantau acara, <b>removeMonitor</b> <b>()</b> disebut in <b>stop ()</b> dan kami menghapus objek dengan <b>menyetelnya</b> ke nil. <br><br>  Yang tersisa bagi kami adalah memanggil <b>start ()</b> dan <b>stop ()</b> pada waktu yang tepat.  Kelas juga memanggil <b>stop ()</b> pada deinitializer untuk membersihkan. <br><br><h2>  Menghubungkan Monitor Acara </h2><br>  Buka <b>AppDelegate.swift untuk</b> terakhir kalinya dan tambahkan properti baru: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eventMonitor: <span class="hljs-type"><span class="hljs-type">EventMonitor?</span></span></code> </pre> <br>  Kemudian tambahkan kode ini untuk mengonfigurasi <b>acara monitor</b> di akhir <b>applicationDidFinishLaunching (_ :)</b> <br><br><pre> <code class="swift hljs">eventMonitor = <span class="hljs-type"><span class="hljs-type">EventMonitor</span></span>(mask: [.leftMouseDown, .rightMouseDown]) { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] event <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> strongSelf = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, strongSelf.popover.isShown { strongSelf.closePopover(sender: event) } }</code> </pre> <br>  Ini akan menginformasikan aplikasi Anda ketika Anda mengklik tombol kiri atau kanan.  Harap dicatat: pawang tidak akan dipanggil untuk menanggapi klik mouse di dalam aplikasi Anda.  Inilah sebabnya mengapa popup tidak akan ditutup saat Anda mengklik di dalamnya. <br><br>  Kami menggunakan referensi yang <b>lemah</b> untuk <b>diri sendiri</b> untuk menghindari bahaya dari siklus tautan yang kuat antara <b>AppDelegate</b> dan <b>EventMonitor</b> . <br><br>  Tambahkan kode berikut di akhir metode <b>showPopover (_ :)</b> : <br><br><pre> <code class="swift hljs">eventMonitor?.start()</code> </pre><br>  Di sini kita mulai memantau acara ketika jendela sembul muncul. <br><br>  Sekarang tambahkan kode di akhir metode <b>closePopover (_ :)</b> : <br><br><pre> <code class="swift hljs">eventMonitor?.stop()</code> </pre><br>  Di sini kita mengakhiri pemantauan ketika popup ditutup. <br><br>  Aplikasi sudah siap! <br><br><h2>  Kesimpulan </h2><br>  <a href="">Di sini</a> Anda akan menemukan kode lengkap untuk proyek ini. <br><br>  Anda telah belajar cara mengatur menu dan pop-up di aplikasi yang terletak di bilah menu.  Mengapa tidak bereksperimen dengan banyak tag atau teks berformat untuk mendapatkan tanda kutip yang lebih baik?  Atau hubungkan backend untuk menerima penawaran dari Internet?  Atau Anda ingin menggunakan keyboard untuk bernavigasi di antara kutipan? <br><br>  Tempat yang baik untuk penelitian adalah dokumentasi resmi: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">NSMenu</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">NSPopover</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">NSStatusItem</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447754/">https://habr.com/ru/post/id447754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447736/index.html">Drone video - tren baru di jejaring sosial</a></li>
<li><a href="../id447738/index.html">Julian Assange ditangkap oleh polisi Inggris</a></li>
<li><a href="../id447742/index.html">Apa metodologi DevOps dan siapa yang membutuhkannya</a></li>
<li><a href="../id447744/index.html">Climbing Elbrus - Pengintaian dalam pertempuran. Bagian Teknis 2. Mengganggu, pengecualian, pengatur waktu sistem</a></li>
<li><a href="../id447746/index.html">Logika bisnis basis data dengan SchemaKeeper</a></li>
<li><a href="../id447784/index.html">Musik di Hari Kosmonautika</a></li>
<li><a href="../id447786/index.html">Latar Belakang: Robot Fedor, apa yang Anda?</a></li>
<li><a href="../id447788/index.html">Kami membuat agregator berita dengan fokus pada cryptocurrency - intwt.com</a></li>
<li><a href="../id447790/index.html">Belajar menulis kontrak pintar pada RIDE dan RIDE4DAPPS. Bagian 1 (Dompet Multiuser)</a></li>
<li><a href="../id447792/index.html">Pola Gelap dan Hukum: Bagaimana Regulator AS Mencoba Mengontrol Mekanika Produk dan Mengurangi Pengaruh Perusahaan Teknologi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>