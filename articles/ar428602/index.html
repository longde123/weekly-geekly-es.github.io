<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👈🏿 ⚓️ 🙁 تعلم التكتيكات العدائية والتقنيات والمعارف المشتركة (ATT @ CK). تكتيكات المؤسسة. الجزء 4 😠 🍍 ⚠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="تصعيد الامتياز 
 روابط لجميع الأجزاء: 
 الجزء 1. الحصول على الوصول الأولي (الوصول الأولي) 
 الجزء 2. التنفيذ 
 الجزء 3. التثبيت (المثابرة) 
 الجزء 4. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>تعلم التكتيكات العدائية والتقنيات والمعارف المشتركة (ATT @ CK). تكتيكات المؤسسة. الجزء 4</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428602/" style=";text-align:right;direction:rtl"><h1 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تصعيد الامتياز</a> </h1><br>  <b>روابط لجميع الأجزاء:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 1. الحصول على الوصول الأولي (الوصول الأولي)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 2. التنفيذ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 3. التثبيت (المثابرة)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 4. تصعيد الامتياز</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 5. التهرب من الدفاع</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 6. الحصول على بيانات الاعتماد (وصول بيانات الاعتماد)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 7. الاكتشاف</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 8. الحركة الجانبية</a> <br><br>  تصعيد الامتياز هو نتيجة الإجراءات التي تسمح لمهاجم أو برنامج ضار بالحصول على مستوى أعلى من الأذونات في النظام أو الشبكة التي تمت مهاجمتها.  تصف تقنيات تصعيد الامتياز الطرق التي يمكن من خلالها للخصم ، بعد الحصول على وصول غير مخول إلى نظام مهاجم ، استخدام "نقاط ضعف" مختلفة للنظام أن يحصل على حقوق المسؤول المحلي أو النظام أو الجذر.  يمكن اعتبار استخدام المهاجمين لحسابات المستخدمين الذين لديهم حقوق الوصول إلى أنظمة أو أذونات معينة لأداء عمليات معينة تصعيدًا في الامتيازات. <br><a name="habracut"></a><br>  <i>المؤلف غير مسؤول عن العواقب المحتملة لتطبيق المعلومات الواردة في المقالة ، ويعتذر أيضًا عن عدم الدقة المحتمل في بعض الصيغ والمصطلحات.</i>  <i>المعلومات المنشورة هي رواية مجانية لمحتويات <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MITER ATT &amp; CK</a> .</i> <br><br>  من المهم إلغاء تضمين بعض التقنيات الموضحة في مصفوفة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ATT @ CK في</a> وقت واحد في عدة مراحل من سلسلة الهجوم ، على سبيل المثال ، يمكن استخدام اعتراض بحث DLL لتأمين الوصول عن طريق التنفيذ غير المصرح به لـ DLL ضار ولزيادة الامتيازات من خلال تشغيل DLL في العملية ، العمل في سياق مستخدم أكثر امتيازًا. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">معالجة الوصول إلى الرمز المميز</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المستخدم ، المسؤول <br>  <i>الوصف:</i> يمكن للمهاجمين استخدام رموز الوصول لتنفيذ الإجراءات في سياقات أمان المستخدم أو النظام المختلفة ، وبالتالي تجنب الكشف عن النشاط الضار.  يمكن للخصم استخدام وظائف Windows API لنسخ رموز الدخول من العمليات الحالية (سرقة الرمز) ، لذلك يجب أن يكون في سياق مستخدم مميز (على سبيل المثال ، مسؤول).  تُستخدم سرقة رموز الوصول عادة لرفع الامتيازات من مستوى المسؤول إلى مستوى النظام.  يمكن للخصم أيضًا استخدام رمز وصول إلى الحساب للمصادقة على نظام بعيد ، إذا كان هذا الحساب لديه الأذونات اللازمة على النظام البعيد. <br>  فكّر في عدة طرق لإساءة استخدام رموز الدخول: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  سرقة وانتحال الرموز.  انتحال الرموز المميزة هو قدرة نظام التشغيل على بدء سلاسل رسائل في سياق أمان بخلاف سياق العملية التي ينتمي إليها هذا الخيط.  بمعنى آخر ، يسمح لك تجسيد الرموز المميزة بتنفيذ أي إجراءات نيابة عن مستخدم آخر.  يمكن للخصم تكرار رمز وصول باستخدام وظيفة <i>DuplicateTokenEX</i> واستخدام <i>ImpersonateLoggedOnUser</i> لاستدعاء مؤشر ترابط في سياق مستخدم قام بتسجيل الدخول ، أو استخدام <i>SetThreadToken</i> لتعيين رمز وصول إلى دفق. </li><li style=";text-align:right;direction:rtl">  قم بإنشاء عملية باستخدام رمز وصول.  يمكن للمهاجم إنشاء رمز وصول باستخدام وظيفة <i>DuplicateTokenEX</i> ثم استخدامه مع <i>CreateProcessWithTokenW</i> لإنشاء عملية جديدة يتم تشغيلها في سياق المستخدم المنتحل. </li><li style=";text-align:right;direction:rtl">  الحصول على رموز الدخول وانتحال هويتها.  يمكن للخصم ، الذي لديه اسم مستخدم وكلمة مرور ، إنشاء جلسة تسجيل دخول باستخدام وظيفة واجهة برمجة تطبيقات <i>LogonUser</i> ، والتي ستعيد نسخة من رمز الوصول إلى الجلسة لجلسة جديدة ، ثم تستخدم <i>وظيفة SetThreadToken</i> لتعيين رمز مميز إلى سلسلة المحادثات.  Metasploit Meterpreter و CobaltStrike لديهم أدوات للتعامل مع رموز الوصول لرفع الامتيازات. </li></ul><br>  <i>توصيات الحماية: من</i> أجل الاستفادة الكاملة من التكتيكات المذكورة أعلاه ، يجب أن يكون لدى المهاجم حقوق مسؤول النظام ، لذلك لا تنس تحديد امتيازات المستخدمين العاديين.  يمكن لأي مستخدم خداع رموز الدخول إذا كان لديه بيانات اعتماد شرعية.  تقييد قدرة المستخدمين والمجموعات على إنشاء رموز وصول: <br>  <i>GPO: تكوين الكمبيوتر&gt; [السياسات]&gt; إعدادات Windows&gt; إعدادات الأمان&gt; السياسات المحلية&gt; تعيين حقوق المستخدم: إنشاء كائن مميز</i> <br>  حدد أيضًا من يمكنه استبدال رموز العملية للخدمات المحلية أو خدمات الشبكة: <br>  <i>GPO: تكوين الكمبيوتر&gt; [السياسات]&gt; إعدادات Windows&gt; إعدادات الأمان&gt; السياسات المحلية&gt; تعيين حقوق المستخدم: استبدال رمز مستوى العملية</i> <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعديل الملفات التنفيذية للتطبيقات "ميزات إمكانية الوصول في Windows" (ميزات إمكانية الوصول)</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المسؤول <br>  <i>الوصف:</i> يمكن تشغيل تطبيقات إمكانية الوصول (مكبر الشاشة ولوحة المفاتيح على الشاشة وما إلى ذلك) باستخدام تركيبات المفاتيح قبل قيام المستخدم بتسجيل الدخول إلى النظام.  يمكن للمهاجم استبدال ملفات بدء التشغيل لهذه البرامج أو تغيير طريقة إطلاقها وفتح وحدة تحكم الأوامر أو الحصول على باب خلفي دون تسجيل الدخول. <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ sethc.exe</i> - يتم تشغيله عن طريق الضغط على مفتاح Shift 5 أضعاف ؛ </li><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ utilman.exe</i> - تم إطلاقه بالضغط على تركيبة Win + U. </li></ul><br>  في WinXP والإصدارات الأحدث ، يمكن استبدال sethc.exe و utilman.exe ، على سبيل المثال ، بـ cmd.exe ، ثم عند الضغط على تركيبة المفاتيح المطلوبة ، يبدأ cmd.exe قبل دخول Windows بامتيازات النظام. <br>  في Vista والإصدارات الأحدث ، تحتاج إلى تغيير مفتاح التسجيل الذي يقوم بتكوين cmd.exe أو برنامج آخر كمصحح أخطاء ، على سبيل المثال ، لـ ultiman.exe.  بعد تحرير التسجيل والضغط على تركيبة المفاتيح المطلوبة على شاشة تسجيل الدخول أو عند الاتصال بالمضيف عبر RDP ، سيتم تنفيذ cmd.exe بحقوق النظام. <br>  هناك أيضًا برامج Windows التي يمكن استخدامها لتطبيق تقنية الهجوم هذه: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ osk.exe ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ Magnify.exe ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ Narrator.exe ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ DisplaySwitch.exe ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>C: \ Windows \ System32 \ AtBroker.exe.</i> </li></ul><br>  <i>توصيات الأمان: قم</i> بتكوين بداية المصادقة الإلزامية على الشبكة للمستخدمين عن بُعد قبل إنشاء جلسة RDP وعرض شاشة تسجيل الدخول ( <i>ممكّنة افتراضيًا في Windows Vista والإصدارات الأحدث</i> ).  استخدم بوابة سطح المكتب البعيد لإدارة الاتصالات وتكوين أمان RDP. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعديل مفتاح DLLs AppCert</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> مسؤول النظام <br>  <i>الوصف:</i> يتم تحميل مكتبات DLL المحددة في قيمة مفتاح AppCertDLLs في كل عملية تستدعي وظائف API المستخدمة بشكل متكرر: <i>CreateProcess و CreateProcessAsUser و CreateProcessWithLoginW و CreateProcessWithTokenW و WinExec</i> .  يمكن إساءة استخدام قيمة AppCertDLLs الرئيسية عن طريق التسبب في تحميل DLL ضار وتشغيل عمليات معينة.  يتم تخزين AppCertDLLs في مفتاح التسجيل التالي: <br>  <i>HKEY_LOCAL_MACHINE \ System \ CurrentControlSet \ Control \ Session Manager</i> . <br><br>  <i>توصيات الحماية:</i> استخدم جميع الوسائل الممكنة لحظر البرامج التي قد تكون خطيرة وتنزيل ملفات DLL غير المعروفة ، مثل AppLocker و DeviceGuard. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تعديل مفتاح DLLs AppInit</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> مسؤول النظام <br>  <i>الوصف:</i> يتم تحميل مكتبات DLL المحددة في قيمة مفتاح AppInit_DLLs في كل عملية يقوم بتحميل user32.dll.  عمليا ، هذا هو كل برنامج تقريبا. <br>  يتم تخزين AppInit_DLLs في مفاتيح التسجيل التالية: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>HKEY_LOCAL_MACHINE \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Windows ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>HKEY_LOCAL_MACHINE \ Software \ Wow6432Node \ Microsoft \ Windows NT \ CurrentVersion \ Windows.</i> </li></ul><br>  يمكن إساءة استخدام قيمة AppInit_DLLs لتجاوز الامتيازات عن طريق تحميل ملفات DLL الضارة وبدء عمليات معينة.  تم تعطيل وظيفة AppInit_DLLs في نظام التشغيل Windows 8 والإصدارات الأحدث عند تنشيط التمهيد الآمن. <br><br>  <i>توصيات الحماية:</i> ضع في اعتبارك استخدام إصدار نظام تشغيل قبل Windows 8 وتمكين التمهيد الآمن.  استخدم جميع أنواع الوسائل لحظر البرامج التي يُحتمل أن تكون خطرة وتنزيل ملفات DLL غير المعروفة ، مثل AppLocker و DeviceGuard. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">إساءة استخدام النظام الفرعي لتوافق التطبيقات (تطبيق Shimming)</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المسؤول <br>  <i>الوصف:</i> <i>تم</i> إنشاء <i>البنية التحتية / إطار عمل توافق تطبيقات Microsoft Windows</i> لضمان توافق البرامج مع تحديثات Windows وتغييرات رمز نظام التشغيل.  يستخدم نظام التوافق ما يسمى shim ("gaskets") - المكتبات التي تعمل كعازل بين البرنامج ونظام التشغيل.  باستخدام ذاكرة التخزين المؤقت الرقائق ، يحدد النظام الحاجة إلى حشوات الرقائق (المخزنة كقاعدة بيانات .sdb).  تقوم ملفات sdb المختلفة بتخزين إجراءات مختلفة لاعتراض رمز التطبيق ومعالجته ثم إعادة توجيهه إلى نظام التشغيل.  يتم تخزين قائمة جميع حشوات الرقائق المثبتة بواسطة المثبت (sdbinst.exe) بشكل افتراضي في: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>٪ WINDIR٪ \ AppPatch \ sysmain.sdb</i> ؛ </li><li style=";text-align:right;direction:rtl">  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ InstalledSDB</i> . </li></ul><br>  يتم تخزين قواعد بيانات الرقائق المخصصة في: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>٪ WINDIR٪ \ AppPatch [64] \ مخصص ؛</i> </li><li style=";text-align:right;direction:rtl">  <i>HKLM \ Software \ Microsoft \ Windows NT \ CurrentVersion \ AppCompatFlags \ Custom</i> . </li></ul><br>  لضمان الحماية في وضع المستخدم ، يتم استبعاد القدرة على تغيير نواة نظام التشغيل باستخدام shim-gaskets ، ويلزم حقوق المسؤول لتثبيتها.  ومع ذلك ، يمكن استخدام بعض منصات الرقائق لتجاوز التحكم في حساب المستخدم (UAC) وحقن DLL وتعطيل <a href="">منع تنفيذ البيانات</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ومعالجة استثناء Srtucture</a> ، بالإضافة إلى عناوين الذاكرة المعترضة.  يمكن للمهاجم الذي يستخدم حشوات منع التسرب زيادة الامتيازات ، وتثبيت الأبواب الخلفية ، وتعطيل حماية نظام التشغيل ، مثل Windows Defender. <br><br>  <i>توصيات الحماية:</i> لا توجد طرق عديدة لمنع تلمع التطبيق.  لا يوصى بتعطيل توافق التطبيقات لتجنب مشاكل استقرار نظام التشغيل.  أصدرت Microsoft <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KB3045645</a> ، والتي ستزيل علامة "الرفع التلقائي" في ملف sdbinst.exe لمنع استخدام نظام الرقائق لتجاوز UAC. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تجاوز التحكم في حساب المستخدم</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المستخدم ، المسؤول <br>  <i>الوصف:</i> هناك العديد من الطرق لتجاوز UAC ، والتي يتم تنفيذها الأكثر شيوعًا في مشروع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">UACMe</a> .  يتم اكتشاف طرق جديدة لتجاوز UAC بانتظام ، مثل إساءة استخدام تطبيق النظام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">eventvwr.exe</a> ، والذي يمكنه تنفيذ ملف ثنائي أو برنامج نصي مرتفع.  يمكن أيضًا تضمين البرامج الضارة في العمليات الموثوقة التي تتيح UAC من خلالها تصعيد الامتيازات دون مطالبة المستخدم. <br>  لتجاوز UAC باستخدام eventvwr.exe ، يتم تعديل المفتاح في سجل Windows: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ mscfile \ shell \ open \ command</i> . <br>  لتجاوز UAC باستخدام sdclt.exe ، يتم تعديل المفاتيح الموجودة في تسجيل Windows: <br>  <i>[HKEY_CURRENT_USER] \ Software \ Microsoft \ Windows \ CurrentVersion \ App Paths \ control.exe ؛</i> <i><br></i>  <i>[HKEY_CURRENT_USER] \ Software \ Classes \ exefile \ shell \ runas \ command \ replaceCommand.</i> <br><br>  <i>توصيات الحماية:</i> قم بإزالة المستخدمين من مجموعة المسؤولين المحليين على الأنظمة المحمية.  إن أمكن ، قم بتمكين أعلى مستوى من الحماية في إعدادات UAC. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اعتراض البحث في DLL (اختطاف طلب بحث DLL)</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المستخدم ، المسؤول ، النظام <br>  <i>الوصف:</i> تتمثل التقنية في استغلال الثغرات الأمنية في الخوارزمية للعثور على ملفات DLL التي تحتاجها للعمل ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MSA2269637</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بواسطة التطبيقات</a> .  غالبًا ما يكون دليل بحث DLL هو دليل العمل الخاص بالبرنامج ، لذا يمكن للمهاجمين استبدال DLL المصدر بآخر ضار بنفس اسم الملف. <br>  يمكن تنفيذ الهجمات عن بعد على عمليات بحث DLL عندما يقوم البرنامج بتثبيت دليله الحالي في دليل بعيد ، على سبيل المثال ، مشاركة شبكة.  أيضًا ، يمكن للمهاجمين تغيير طريقة البحث عن ملفات DLL وتحميلها مباشرةً عن طريق استبدال ملفات .manifest أو. المحلية ، التي تصف معلمات بحث DLL.  إذا كان البرنامج الذي تمت مهاجمته يعمل بمستوى عالي من الامتيازات ، فسيتم أيضًا تنفيذ ملف DLL الخبيث الذي تم تحميله به بحقوق عالية.  في هذه الحالة ، يمكن استخدام التقنية لزيادة الامتيازات من المستخدم إلى المسؤول أو النظام. <br><br>  <i>توصيات الحماية:</i> منع تحميل DLL عن بُعد (يتم تمكينه افتراضيًا في Windows Server 2012+ ومتاح مع تحديثات XP + و Server 2003+).  تمكين وضع البحث الآمن لـ DLL ، والذي يقصر أدلة البحث على الدلائل مثل <i>٪ SYSTEMROOT٪</i> قبل إجراء بحث DLL في دليل التطبيق الحالي. <br>  تمكين وضع البحث الآمن DLL: <br>  <i>تكوين الكمبيوتر&gt; [السياسات]&gt; قوالب الإدارة&gt; MSS (القديم): MSS: (SafeDllSearchMode) تمكين وضع البحث الآمن DLL.</i> <br>  مفتاح التسجيل المقابل: <br>  <i>HKLM \ SYSTEM \ CurrentControlSet \ Control \ Session Manager \ SafeDLLSearchMode.</i> <br><br>  ضع في اعتبارك مراجعة نظام محمي لإصلاح أوجه القصور في DLL باستخدام أدوات مثل PowerUP في PowerSploit.  لا تنس حظر البرامج الضارة والخطيرة المحتملة ، بالإضافة إلى اتباع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">توصيات Microsoft</a> . <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اعتراض بحث Dylib (اختطاف Dylib)</a> </h3><br>  <i>النظام:</i> macOS <br>  <i>الحقوق:</i> المستخدم <br>  الوصف: تعتمد التقنية على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الثغرات الأمنية في خوارزميات البحث في مكتبة dylib الديناميكية على نظامي macOS و OS X.</a>  خلاصة القول هي تحديد dylib الذي يقوم التطبيق المهاجم بتحميله ثم وضع الإصدار الضار من dylib الذي يحمل نفس الاسم في دليل العمل الخاص بالتطبيق.  سيؤدي ذلك إلى تحميل التطبيق dylib ، الموجود في دليل عمل البرنامج.  في هذه الحالة ، سيتم تنفيذ Dylib الخبيث بحقوق الوصول للتطبيق الذي تمت مهاجمته. <br><br>  نصائح أمنية <i>:</i> منع المستخدمين من كتابة الملفات إلى دلائل بحث dylib.  تدقيق الثغرات الأمنية باستخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Dylib Hijacking Scanner</a> من Objective-See. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">استغلال تصعيد الامتياز</a> </h3><br>  <i>النظام:</i> Windows و Linux و macOS <br>  <i>الحقوق:</i> المستخدم <br>  <i>الوصف:</i> يمكن للمعارضين زيادة الامتيازات في النظام المهاجم باستخدام نقاط الضعف في البرامج. <br><br>  <i>توصيات الحماية:</i> تحديثات برامج منتظمة لجميع محطات العمل والخوادم ومعدات الشبكة والأجهزة الأخرى المتصلة بالشبكة المحمية.  تحليل أنواع التهديدات ونقاط الضعف وبرامج الاستغلال التي يمكن استخدامها ضد المنظمة المحمية.  يوصى أيضًا بأنظمة الحماية من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الاستغلال</a> مثل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Windows Defender Exploit Guard (WDEG)</a> لنظام التشغيل Windows 10 أو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مجموعة أدوات تجربة التخفيف المحسنة (EMET)</a> للإصدارات السابقة من Windows. <br><br>  h3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">EWM Injection (حقن ذاكرة النافذة الإضافية)</a> <br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> مسؤول النظام <br>  <i>الوصف:</i> التقنية هي إساءة استخدام ذاكرة النوافذ الإضافية ، والتي تسمى ذاكرة النافذة الإضافية (EWM).  حجم EWM هو 40 بايت ، مناسب لتخزين مؤشر 32 بت وغالبًا ما يستخدم للإشارة إلى الإجراءات.  يمكن للبرامج الخبيثة أثناء سلسلة الهجوم وضع مؤشر للشفرة الضارة في EWM ، والذي سيتم إطلاقه لاحقًا من خلال عملية التطبيق المصاب. <br><br>  <i>توصيات الحماية:</i> نظرًا لأن تقنيات حقن EWM تستند إلى إساءة استخدام وظائف تطوير نظام التشغيل ، يجب توجيه جهود الحماية لمنع بدء البرامج الضارة والأدوات الضارة.  من الممارسات الجيدة تحديد وحظر البرامج التي يُحتمل أن تكون خطرة باستخدام AppLocker أو تطبيقات القائمة البيضاء أو تطبيق سياسات تقييد البرامج. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مساوئ الأذونات على مستوى نظام الملفات (ضعف أذونات نظام الملفات)</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> المستخدم ، المسؤول <br>  <i>الوصف:</i> جوهر التقنية هو استبدال الملفات القابلة للتنفيذ التي يتم تشغيلها تلقائيًا من خلال عمليات مختلفة (على سبيل المثال ، عند تشغيل نظام التشغيل أو في وقت معين ، إذا تم تكوين حقوق الملفات القابلة للتنفيذ بشكل غير صحيح).  بعد الانتحال ، سيتم تشغيل الملف الضار بحقوق العملية ، لذلك إذا كانت العملية ذات مستوى وصول أعلى ، فسيكون المهاجم قادرًا على تصعيد الامتيازات.  في هذه التقنية ، يمكن للمهاجمين محاولة معالجة الملفات الثنائية لخدمة Windows. <br>  يرتبط نوع آخر من الهجوم بنواقص الخوارزميات في عمل مثبِّتات الاستخراج الذاتي.  أثناء عملية التثبيت ، غالبًا ما يقوم المثبتون بفك حزم الملفات المفيدة المختلفة ، بما في ذلك .dll و .exe ، في الدليل٪ TEMP٪ ، ومع ذلك ، قد لا يقوموا بتعيين الأذونات المناسبة لتقييد الوصول إلى الملفات غير المعبأة ، مما يسمح للمهاجمين بالانتحال للملفات ، و ونتيجة لذلك ، قم بزيادة الامتيازات أو تجاوز التحكم في الحساب ، مثل  يعمل بعض المثبتات بامتيازات موسعة. <br><br>  <i>توصيات الحماية:</i> تقييد امتيازات الحساب بحيث يمكن للمسؤولين فقط إدارة الخدمات والتفاعل مع الملفات الثنائية التي تستخدمها الخدمات.  تعطيل خيارات تصعيد امتياز UAC للمستخدمين القياسيين.  يتم تخزين إعدادات UAC في مفتاح التسجيل التالي: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>[HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Policies \ System]</i> . </li></ul><br>  لرفض طلبات تصعيد الامتيازات تلقائيًا ، يجب عليك إضافة مفتاح: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>"ConsentPromptBehaviorUser" = الكلمة المزدوجة: 00000000.</i> </li></ul><br>  للتحكم في عمل المثبتات ، تحتاج إلى إضافة مفتاح: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>"EnableInstallerDetection" = dword: 00000001</i> ، الأمر الذي سيتطلب كلمة مرور لتثبيت البرامج. </li></ul><br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اعتراض مكالمات ميزة واجهة برمجة تطبيقات Windows (ربط)</a> </h3><br>  <i>النظام:</i> Windows <br>  <i>الحقوق:</i> مسؤول النظام <br>  <i>الوصف:</i> يتم عادة تخزين وظائف Windows API في مكتبات DLL.  تقنية التثبيت هي إعادة توجيه المكالمات إلى وظائف API من خلال: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إجراءات الخطاف - الإجراءات المضمنة في نظام التشغيل والتي تنفذ التعليمات البرمجية عندما يتم استدعاء الأحداث المختلفة ، على سبيل المثال ، ضغطات المفاتيح أو تحريك الماوس ؛ </li><li style=";text-align:right;direction:rtl">  تعديلات على جدول العنوان (IAT) ، الذي يخزن المؤشرات على وظائف API.  سيسمح لك هذا بـ "خداع" التطبيق المهاجم ، مما يجبره على تشغيل وظيفة ضارة ؛ </li><li style=";text-align:right;direction:rtl">  التغيير المباشر للوظيفة (الربط) ، حيث يتم تغيير أول 5 بايت من الوظيفة ، بدلاً من ذلك يتم إدخال الانتقال إلى وظيفة ضارة أو وظيفة أخرى يحددها المهاجم. </li></ul><br>  مثل عمليات الحقن ، يمكن للمهاجمين استخدام التثبيت لتنفيذ التعليمات البرمجية الضارة ، وإخفاء تنفيذها ، والوصول إلى ذاكرة العملية التي تمت مهاجمتها وزيادة الامتيازات.  يمكن للمهاجمين التقاط مكالمات API التي تتضمن المعلمات التي تحتوي على بيانات المصادقة.  عادةً ما يستخدم الربط مجموعة أدوات لإخفاء النشاط الضار في النظام. <br><br> <i>  :</i>         ,              ,   .              .   hooking-       SetWindowsHookEx  SetWinEventHook,   ,    . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">IFEO- (Image File Execution Options Injection)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , System <br> <i>:</i>  Image File Execution Options (IFEO)      ,     : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <i>HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options/[executable]</i> </li><li style=";text-align:right;direction:rtl"> <i>HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\[executable]</i> ,  <i>[executable]</i> —     . </li></ul><br>  ,  <i>[executable]</i>     ,       .     IFEO    ,  ,          . <br><br> <i>  :</i>         ,  -       , ,  .      IFEO-        .           <i>Debug_process</i>  <i>Debug_only_this_process</i> . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  (Launch Daemon)</a> &gt; </h3><br> <i>:</i> macOS <br> <i>:</i>  <br> <i>:</i>           — Launch Daemon,   plist-.     Launchd    ()  plist-    : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> /System/Library/LaunchDeamons; </li><li style=";text-align:right;direction:rtl"> /Library/LaunchDeamons. </li></ul><br> Launch Daemon     ,      root,       .  plist-   root:while,    ,   ,     .      ,   plist, ,  ,           . <br><br> <i>  :</i>   ,       Launch Daemon.       plist-      KnockKnock. <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  (New Service)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , System <br> <i>:</i>    ,          .        ,    .       ,     System.      ,          Windows API       Windows  PowerShell. <br><br> <i>  :</i>       ,       .  AppLocker  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Software Restriction Policy</a> . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  (Path Interception)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , , system <br> <i>:</i>          ,        .     : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  .                , , <i>C:\Program Files\service.exe</i> ,       <i>C:\Program.exe</i> ,  Windows         . </li><li style=";text-align:right;direction:rtl">    .    PATH  <i>C:\example</i>  <i>c:\Windows\System32</i>    <i>C:\example\net.exe</i> ,     net,   <i>C:\example\net.exe</i> ,   <i>c:\Windows\System32\net.exe</i> . </li><li style=";text-align:right;direction:rtl">    (Search order hijacking).        , Windows,  ,        ,      . ,  «example.exe»    cmd.exe      net use.       example.exe  net.exe       <i>c:\Windows\System32\net.exe</i> .  ,     net.com     net.exe,  Windows  net.com     ,     PATHEXT. </li></ul><br> <i>        DLL    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DLL Search Hijacking</a> .</i> <br><br> <i>  :</i>   ,    , ,  PATH,    .           .     ,    ,      ,    .          :\    Windows,         . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  Plist (Plist Modification)</a> </h3><br> <i>:</i> macOS <br> <i>:</i> ,  <br> <i>:</i>    plist-,            .   plist,   <i>/Library/Preferences</i>    ,  plist  <i>~/Library/Preferences</i>    . <br><br> <i>  :</i>    plist,      . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> Port Monitors    (Port Monitors)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , System <br> <i>:</i>      DLL   System    Windows       (Spoolsv.exe).      Spoolsv.exe      (port monitor) —  DLL-,     LAN, USB, LPT  COM-      .  DLL   <i>C:\windows\system32</i>    : <br> <i>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Monitors</i> . <br> Port Monitor     API  AddMonitor       . <br><br> <i>  :</i>   -       . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    (Process Injection),</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ten Process Injection Techniques</a> </h3><br> <i>:</i> Windows, Linux, macOS <br> <i>:</i> , , system, root <br> <i>:</i>   —           .             , /  , ,  .             .          ,      .          . <br><br> <b>Windows</b> <br> • DLL-.       DLL           (Remote thread — ,        ).  ,      DLL,      CreateRemoteTread,       LoadLibrary   . <br> • PE- (Portable executable injection)        PE-,   DLL  EXE.        -   ,              . <br> •    (Thread execution hijacking)          DLL    .   Process Hollowing,     . <br> •      (Asynchronous Procedure Call (APC) injection)       APC- (APC Queue)  .    APC-,   «   (Earle Bird injection)»,                   APC. AtomBombing —    ,   APC    ,       (Global atom table). <br> •      (Thread Local Storage (TLS) injection)        PE-      . <br><br> <b>Mac  Linux</b> <br> •   LD_RPELOAD, LD_LIBRARY_PATH (Linux), DYLIB_INSERT_LIBRARIES (macOS X)     dlfcn (API)       ( )  ,          API   . <br> •   Ptrace             . <br> • /proc/[pid]/mem          /  ,      -   . <br> •  VDSO (Virtual dynamic shared object)          ELF,     linux-vdso.so. <br>             ,              .            . <br><br> <i>  :</i>                         .              .    - ,   AppLocker.  Yama         ptrace,   ptrace   .         ,       .     SELinux, grsecurity, AppArmor. <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  SID- (SID-History Injection)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> ,  <br> <i>:</i>  ,           SID,    objectSID.  SID     sIDHistory,     ,      . ,    ,    SID-History   SID,            ,    . <br><br> <i>  :</i>   Windows Server  2003       SID (SID Filtering),       SID,   ,       ,    . <br>    SID: <br> •  SIDHistory     ()      : <i>netdom trust /domain: /EnableSIDHistory:no</i> ; <br> •  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SID Filter Quarantining</a> .  ,  ,  SID,    ,       . SID Filter Quarantining        : <i>netdom trust /domain: /quarantine:yes</i> . <br>  SID Filtering      .     ,       ,             ,    SID Filtering    . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  (Scheduled Task)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , ,  <br> <i>:</i>    at, schtasks    Windows        ,        .      ,  ,      RPC,        .        .          System        . <br><br> <i>  :</i>   .  ,    PowerUP  PowerSploit,           .       System,      " <i>    </i> "    " <i>  :   </i> ". <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">      (Service Registry Permissions Weakness)</a> </h3><br> <i>:</i> Windows <br> <i>:</i> , System <br> <i>:</i>          Windows  ,     ,      ,                — sc.exe, PowerShell  Reg.      ,    , , FailureCommand,  ,          .     <i>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services</i> . <br><br> <i>  :</i> ,          ,    .     - , , Windows AppLocker. <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Setuid  Setgid</a> </h3><br> <i>:</i> Linux, macOS <br> <i>:</i>  <br> <i>:</i> Setuid  Setgid —      Unix-,             .       root,   ,      sudo,     Setuid  Setgid.     Setuid  Setgid   shell escape (,     -       )       Setuid  Setgid       .      ls -l     «s»  «x».  chmod    Setuid  Setgid    <i>chmod 4777 []</i>  <i>chmod u + s []</i> . <br><br> <i>  :</i>       Setuid  Setgid  . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  (Startup Items)</a> </h3><br> <i>:</i> macOS <br> <i>:</i>  <br> <i>:</i>    ,       macOS Sierra,      StartupItems        root    . StartupItems —    <i>/Library/Startupitems</i> ,      StartupParameters.plist.          : <i>/Library/Startupitems/[MyStartupItem]</i> . <br><br> <i>  :</i>   StartupItems  ,      <i>/Library/Startupitems/</i>     . <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Sudo</a> </h3><br> <i>:</i> Linux, macOS <br> <i>:</i>  <br> <i>:</i>      Sudo              .  Sudo    <i>/etc/sudoers</i> ,       .  sudoers            ,                . ,   sudoers   ,      : <i>username ALL=(ALL) NOPASSWD: ALL</i> . <br><br> <i>  :</i>  sudoers    ,        Sudo. Auditd  Linux     ,     ID    ( ,    sudo). <br><br><h3 style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Sudo Caching</a> </h3><br>  <i>النظام:</i> Linux و macOS <br>  <i>الحقوق:</i> المستخدم <br>  <i>الوصف:</i> برامج ضارة مختلفة ، مثل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><i>OCX Proton Malware</i></a> ، يمكنها إساءة استخدام إعدادات sudo لتنفيذ التعليمات البرمجية كجذر دون إدخال كلمة مرور.  منذ أن تم إنشاء مجموعة أدوات sudo لإدارة النظام ، فإنها تحتوي على بعض الوظائف المفيدة مثل <i>timestamp_timeout</i> - تخزن هذه المعلمة مقدار الوقت بالدقائق بين بداية sudo التي لن يطالب خلالها الأمر بكلمة مرور الجذر.  تمكن سودو من تخزين بيانات الاعتماد لبعض الوقت.  يتم تخزين الطابع الزمني لبداية سودو الأخيرة في <i>/ var / db / sudo</i> ويستخدم لتحديد المهلة المحددة.  بالإضافة إلى ذلك ، هناك متغير <i>tty_tickets</i> يعالج كل جلسة طرفية جديدة على حدة ، لذلك لن تؤثر المهلة في مثيل واحد من وحدة التحكم على المهلة في مثيل آخر. <br><br>  <i>توصيات الحماية:</i> قم بتعيين المعلمة <i>timestamp_timeout = 0</i> بحيث يتطلب النظام كلمة مرور الجذر في كل مرة يتم تشغيل sudo.  قم <i>بتشغيل</i> المعلمة <i>tty_tickets</i> لمنع تنفيذ الهجوم من خلال جلسات سطر الأوامر. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">حسابات صالحة</a> </h3><br>  <i>الوصف:</i> يمكن للمهاجمين سرقة بيانات اعتماد حساب مستخدم أو خدمة معينة باستخدام بيانات اعتماد الوصول ، والتقاط بيانات الاعتماد في عملية الاستخبارات باستخدام الهندسة الاجتماعية.  يمكن استخدام بيانات الاعتماد المخترقة لتجاوز أنظمة التحكم في الوصول والوصول إلى الأنظمة البعيدة والخدمات الخارجية ، مثل VPN و OWA و Remote Desktop أو للحصول على امتيازات مرتفعة على أنظمة ومناطق محددة من الشبكة.  إذا نجح السيناريو ، يمكن للمهاجمين رفض البرامج الضارة لجعل من الصعب اكتشافها.  أيضًا ، يمكن للمهاجمين إنشاء حسابات باستخدام أسماء وكلمات مرور محددة مسبقًا للحفاظ على الوصول الاحتياطي في حالة محاولات فاشلة لاستخدام وسائل أخرى. <br><br>  <i>توصيات الحماية:</i> قم <i>بتطبيق</i> سياسة كلمة المرور ، واتبع التوصيات لتصميم وإدارة شبكة الشركة للحد من استخدام الحسابات المميزة على جميع المستويات الإدارية.  التحقق المنتظم من المجال والحسابات المحلية وحقوقهم من أجل تحديد تلك التي يمكن أن تسمح للمهاجمين بالوصول على نطاق واسع.  مراقبة نشاط الحساب باستخدام أنظمة SIEM. <br><br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قذيفة الويب</a> </h3><br>  <i>النظام:</i> Windows و Linux و macOS <br>  <i>الوصف:</i> يمكن للمهاجم استخدام Web Shell كبوابة للوصول إلى شبكتك أو الوصول الزائد إلى النظام الذي تمت مهاجمته ، كآلية احتياطية للتأمين في حالة الكشف عن قنوات الوصول الرئيسية وحجبها في البيئة التي تمت مهاجمتها. <br><br>  <i>توصيات الحماية:</i> تأكد من تحديث خوادم الويب الخارجية بانتظام وأنه لا توجد نقاط ضعف معروفة تسمح للمهاجمين بتحميل ملف أو نص برمجي إلى الخادم مع التنفيذ اللاحق.  تحقق من أن أذونات الحسابات والمجموعات التي لها حقوق إدارة الخادم لا تتطابق مع الحسابات الموجودة على الشبكة الداخلية والتي يمكن استخدامها لتسجيل الدخول إلى خادم الويب أو تشغيل shell على الويب أو تثبيته على خادم الويب.  يصعب اكتشاف Web Shell بسبب  إنهم لا يبدؤون الاتصالات ويمكن أن يكون جانب الخادم الخاص بهم صغيرًا وغير ضار ، على سبيل المثال ، يبدو إصدار PHP الخاص بـ China Chopper Web shell كخط: <br>  <i>[؟ php <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">Eval</a> ($ _POST ['password']) ؛]</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar428602/">https://habr.com/ru/post/ar428602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar428590/index.html">التفاعلات الدقيقة والمطالبات الدقيقة في الواجهة</a></li>
<li><a href="../ar428592/index.html">التوقف عن توظيف "المديرين الفعالين". إنهم ليسوا عديمي الفائدة فحسب ، بل ضارين</a></li>
<li><a href="../ar428596/index.html">قام Elon Musk بطرد مديري مشاريع الإنترنت عبر الأقمار الصناعية Starlink بسبب عدم الامتثال للمواعيد النهائية</a></li>
<li><a href="../ar428598/index.html">الشبكات العصبية العميقة لتقييم المكالمات التلقائي</a></li>
<li><a href="../ar428600/index.html">المؤثرات الخاصة SSDs أو ما كان مفقودًا في التعديل - مراجعة محرك HyperX FURY RGB</a></li>
<li><a href="../ar428604/index.html">بطولة علوم البيانات على الإنترنت</a></li>
<li><a href="../ar428606/index.html">"فهم كيفية عمل النظام سمح للكثير من القرصنة": Roy Beniosef على تطوير Android</a></li>
<li><a href="../ar428608/index.html">اتفقت الحيازات الإعلامية مع Yandex على إزالة المواد المقرصنة</a></li>
<li><a href="../ar428610/index.html">مفارقة وقت الانتظار ، أو لماذا تتأخر حافلي دائمًا؟</a></li>
<li><a href="../ar428612/index.html">وظائف النظام الأعلى في JavaScript: ما هي؟</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>