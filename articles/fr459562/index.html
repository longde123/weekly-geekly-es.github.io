<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕛 🗝️ 🛄 Programmation différenciable ℹ️ 📜 👳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avec quatre paramètres, je peux demander à un éléphant, et avec cinq je peux lui faire bouger sa trompe. 
 - John Von Neumann 

 L'idée de " programma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programmation différenciable</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459562/"><p><img src="https://habrastorage.org/webt/fv/8k/s8/fv8ks8cvj64dyqlstu1vi9znbv8.jpeg"></p><br><blockquote>  Avec quatre paramètres, je peux demander à un éléphant, et avec cinq je peux lui faire bouger sa trompe. <br>  - John Von Neumann </blockquote><p>  L'idée de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">programmation différenciable</a> " est très populaire dans le monde de l'apprentissage automatique.  Pour beaucoup, il n'est pas clair si ce terme reflète un réel changement dans la façon dont les chercheurs comprennent l'apprentissage automatique, ou s'il s'agit simplement d'un (autre) changement de nom de «l'apprentissage en profondeur».  Cet article explique les nouveautés de la programmation différenciée (ou ∂P) dans la table d'apprentissage automatique. </p><br><p>  Plus important encore, la programmation différenciée est le changement opposé à la direction de l'apprentissage en profondeur;  des modèles de plus en plus paramétrés aux modèles plus simples qui utilisent davantage la structure du problème. </p><br><p>  Ensuite, nous parcourons une toile de texte sans intérêt, nous voulons découvrir ce qu'est l'auto-différenciation, et même la remplir à partir d'une catapulte! </p><a name="habracut"></a><br><h2 id="brute-force-with-benefits">  Force brute avec avantages </h2><br><p>  La différenciation est une idée de base qui fait le succès de l'apprentissage en profondeur.  Là où la recherche par force brute de plusieurs centaines de paramètres de modèle serait trop coûteuse, les gradients permettent une traversée pseudo-aléatoire de parties intéressantes de l'espace des paramètres et trouvent un bon ensemble.  En réalisant un algorithme aussi naïf, nous obtenons une bonne généralité, mais il est loin d'être évident que nous devons différencier, par exemple, le travail avec des séquences en traduction de langue, mais tout se révèle simple, nous montrons un peu d'ingéniosité. </p><br><p>  Qu'en est-il des neurones biologiques et <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3C3;</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.873ex" height="2.66ex" viewBox="0 -832 8556.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-3C3" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-28" x="2403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-57" x="2792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="4091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-6F" x="4641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-69" x="5127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-73" x="5472" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-78" x="5942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-2B" x="6736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-62" x="7737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-29" x="8167" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>σ</mo></mrow><mo stretchy="false">(</mo><mi>W</mi><mtext>&nbsp;</mtext><mi>f</mi><mi>o</mi><mi>i</mi><mi>s</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> y = σ (W \ fois x + b) </script>  ?  Il n'y a rien de spécial dans cette formule;  Il s'agit d'un exemple simple et flexible d'une fonction non linéaire hautement paramétrique.  En fait, c'est probablement la pire caractéristique dans la plupart des cas.  Une couche du réseau neuronal, en principe, peut classer des images de chats, mais uniquement en utilisant une astuce relativement peu intéressante.  <strong>Cela fonctionne parfaitement!</strong>  - mais les petits caractères avertissent que vous pourriez avoir besoin de plus de paramètres que d'atomes dans l'univers.  Pour que ce travail fonctionne, vous devez coder la structure problématique du modèle - c'est là qu'il commence à ressembler davantage à la programmation traditionnelle. </p><br><p>  Par exemple, les <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ConvNets</a></em> ont un énorme avantage sur le perceptron, car ils fonctionnent avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">les noyaux d'images</a> , qui sont connus pour utiliser l'invariance de traduction.  Visage - c'est le visage, qu'il soit affiché dans le coin supérieur gauche de l'image ou au centre, mais là où le perceptron doit étudier ce cas dans chaque cas, le noyau peut immédiatement répondre à n'importe quelle partie de l'image.  Il est difficile d'analyser les réseaux convolutionnels en termes statistiques, mais il est beaucoup plus facile de les considérer comme une version automatique de ce que les experts en traitement d'images ont écrit à la main.  Le noyau de l'image est le premier programme différenciable le plus simple. </p><br><h2 id="encoding-structure-redux">  Structure d'encodage, Redux </h2><br><p>  Les boîtes à outils ML prennent de plus en plus en charge la différenciation algorithmique (AD), ce qui nous permet de différencier les modèles à l'aide de boucles, de branches et de récursivité - ou de tout programme basé sur un ensemble de primitives mathématiques différenciables.  Cela a conduit à une architecture plus complexe: les modèles PNL sont de plus en plus comme des analyseurs de grammaire classiques avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">des</a> modèles à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">pile augmentée</a> , et vous pouvez même différencier un analogue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">d'une machine de Turing</a> ou un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">interpréteur de langage de programmation</a> . </p><br><p>  La dernière étape franchie par la programmation différenciée consiste à ne plus considérer la multiplication matricielle, la convolution et le <em>RNN</em> comme des éléments fondamentaux de l'apprentissage en profondeur, mais uniquement comme des cas particuliers.  Nous pouvons appliquer des méthodes d'apprentissage approfondi à toute fonction différenciable paramétrée <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.418ex" height="2.66ex" viewBox="0 -832 1902 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-29" x="1512" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> f (x) </script>  .  Des fonctions aussi complexes que les simulateurs physiques ou les traceurs de rayons peuvent également être différenciées et optimisées.  Même <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">l'informatique quantique</a> peut s'intégrer dans cette structure. </p><br><p><img src="https://habrastorage.org/webt/8i/pk/fa/8ipkfaovyvmrkrgev-dnc85atm8.png"></p><br><p>  Les scientifiques utilisent depuis longtemps des modèles mécanistes qui se situent entre la programmation explicite et l'apprentissage automatique.  Les équations différentielles à paramètres libres utilisées en physique, épidémiologie ou pharmacodynamique sont équivalentes aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">réseaux de neurones</a> dans tout sauf la terminologie.  Ils visent simplement à fournir des fonctionnalités beaucoup plus étroites, car c'est tellement plus simple. </p><br><p>  Un progrès vraiment puissant est le suivant: la différenciation omniprésente signifie que toutes ces méthodes se connectent comme des briques <em>lego</em> . <br>  Au lieu d'écrire toujours de nouveaux programmes pour ML, nous pouvons réutiliser des programmes existants en utilisant des moteurs physiques dans des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">modèles de robotique d'</a> apprentissage profond.  Là où les algorithmes d'apprentissage par renforcement modernes doivent construire un modèle détaillé du monde extérieur basé uniquement sur ce pour quoi ils seront récompensés (sons comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">la force brute</a> ), nous pouvons plutôt simplement appliquer une connaissance détaillée et précise des systèmes physiques avant même que l'apprentissage ne commence. </p><br><p>  Même les domaines les plus matures de l'apprentissage en profondeur ne sont pas en reste;  après le noyau de convolution, la prochaine étape naturelle pour les modèles d'images est un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">traceur de rayons différenciable</a> .  Le rendu 3D contient beaucoup de connaissances structurelles sur la façon dont les scènes sont affichées en pixels, qui continueront de jouer un rôle dans notre cuisine.  Disons qu'un modèle prend des décisions dans un environnement simulé affiché en pixels, que le modèle utilise comme entrée.  En principe, nous pouvons maintenant rendre l'ensemble du cycle différenciable, ce qui nous permettra de voir directement l'influence de l'environnement sur les décisions du modèle et vice versa.  Cela peut augmenter considérablement la puissance d'un environnement simulé réaliste pour les modèles d'entraînement, tels que les voitures à conduite automatique. </p><br><p>  Comme en science, les modèles hybrides peuvent être plus efficaces et résoudre certains des compromis entre l'apprentissage en profondeur et la programmation explicite.  Par exemple, un planificateur de trajectoire de vol de drone peut avoir un composant de réseau neuronal qui ne peut apporter que des modifications légèrement correctives à un programme explicite fiable, faisant analyser son comportement général, tout en s'adaptant aux données empiriques.  Cela est également bon pour l'interprétabilité: les paramètres des modèles mécanistes et des simulations ont généralement des interprétations physiques claires, donc si le modèle évalue les paramètres à l'intérieur, il fait une déclaration claire sur ce qui, à son avis, se passe à l'extérieur. </p><br><p>  Si tout cela est si merveilleux, pourquoi tout le monde n'a-t-il pas abandonné et s'est-il précipité pour apprendre à se différencier?  Malheureusement, les limites des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">cadres existants</a> rendent difficile la construction de modèles d'une telle complexité et il est impossible de réutiliser la richesse des connaissances intégrées dans le code scientifique existant.  La nécessité de réimplémenter les moteurs physiques à partir de zéro dans un langage de modélisation très limité transforme un script de dix lignes en un projet de recherche pluriannuel.  Mais les progrès du langage et de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">technologie de compilation</a> , en particulier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">la différenciation automatique</a> , nous rapprochent du Saint Graal: "différenciez simplement mon moteur de jeu, s'il vous plaît." </p><br><h2 id="itak-chto-takoe-differenciruemoe-programmirovanie">  Qu'est-ce donc que la programmation différenciée? </h2><br><p>  La programmation différenciée vous permet d'appliquer des méthodes d'apprentissage approfondi à des programmes existants complexes, en réutilisant avec eux une énorme quantité de connaissances intégrées.  Apprentissage en profondeur, statistiques, programmation et science - tout ce qui essaie de dire sa parole dans la modélisation du monde qui nous entoure - il est temps de tout combiner, de le rapprocher comme des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">particules dans un collisionneur de hadrons</a> .  Cela améliorera à la fois les modèles actuels et permettra d'appliquer le ML dans les domaines où ses limites actuelles - soit l'interprétabilité ou les exigences de calcul et de données - les rendent individuellement inapplicables. </p><br><h2 id="differenciruemye-problemy-upravleniya">  Problèmes de gestion différenciables </h2><br><p>  Ensuite, nous montrons que la différentiabilité peut apporter des tâches de gestion simples mais classiques, dans lesquelles nous utilisons généralement le renforcement par apprentissage (RL) comme boîte noire.  Les modèles différenciables (modèles ∂P) révèlent non seulement des stratégies de contrôle beaucoup plus efficaces, mais apprennent également plusieurs ordres de grandeur plus rapidement.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Le code est disponible</a> pour étude - dans la plupart des cas, il apprend en quelques secondes sur n'importe quel ordinateur portable. </p><br><h2 id="sleduyte-za-gradientom">  Suivez le dégradé </h2><br><p>  La différenciation est ce qui est la force motrice à presque toutes les étapes de l'apprentissage en profondeur;  pour cette fonction <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.672ex" height="2.66ex" viewBox="0 -832 3733.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="1831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-28" x="2382" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-78" x="2771" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-29" x="3344" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"> y = f (x) </script>  nous utilisons le gradient <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>y</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.061ex" height="2.419ex" viewBox="0 -780.1 4332 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-79" x="523" y="0"></use></g><g transform="translate(3236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-78" x="523" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>y</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ frac {dy} {dx} </script> pour savoir comment un changement de <code>x</code> affectera <code>y</code> .  Malgré la nature mathématique, les gradients sont en fait un concept très général et intuitif.  Oubliez les formules que vous avez dû regarder à l'école;  faisons quelque chose de plus amusant, comme jeter quelque chose le long d'un chemin parabolique. </p><br><p><img src="https://habrastorage.org/webt/hy/uu/qr/hyuuqrkomuhvvl8h_wxnqlzkfas.gif"></p><br><p>  Lorsque nous lançons des projectiles à l'aide d'un tir à trois coups, notre <code>x</code> (entrée) représente le réglage (par exemple, la taille du contrepoids ou l'angle d'éjection), et <code>y</code> est la distance que le projectile parcourt avant l'atterrissage.  Si vous essayez de viser, le dégradé vous dit quelque chose de très utile - augmenter ou diminuer un certain paramètre.  Pour maximiser la distance, suivez simplement le gradient. </p><br><p>  OK, mais comment obtenir le bon paramètre?  Mais à l'aide d'une chose délicate appelée <a href="" rel="nofollow">différenciation algorithmique</a> , qui vous permet de différencier non seulement les formules simples que vous avez apprises à l'école, mais également les programmes de toute complexité - par exemple, notre <a href="" rel="nofollow">simulateur Trebuchet</a> .  En conséquence, nous pouvons prendre un simulateur simple écrit en Julia et un package diff <a href="" rel="nofollow">diff DiffEq</a> sans étude approfondie, et obtenir des gradients pour cela en un seul appel de fonction. </p><br><pre> <code class="julia hljs"><span class="hljs-comment"><span class="hljs-comment"># what you did in school gradient(x -&gt; 3x^2 + 2x + 1, 5) # (32,) # something a little more advanced gradient((wind, angle, weight) -&gt; Trebuchet.shoot(wind, angle, weight), -2, 45, 200) # (4.02, -0.99, 0.051)</span></span></code> </pre> <br><h2 id="throwing-stuff">  Lancer des trucs </h2><br><p>  Nous devons cibler le trébuchet sur la cible, en utilisant des gradients pour affiner l'angle d'éjection;  C'est ce qu'on appelle l'estimation des paramètres, et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">nous avons déjà examiné des exemples similaires</a> .  Nous pouvons rendre la tâche plus intéressante en passant à la méta-méthode: au lieu de viser le trébuchet sur une cible, nous optimisons le réseau neuronal, qui peut le cibler sur n'importe quelle cible.  Voici comment cela fonctionne: un réseau de neurones accepte deux entrées, une distance cible en mètres et une vitesse actuelle du vent.  Dans le réseau, les paramètres du trébuchet sont définis (la masse du contrepoids et l'angle de déclenchement), qui sont transmis au simulateur, qui calcule la distance parcourue.  Ensuite, nous comparons avec notre objectif et parcourons toute la chaîne pour ajuster le poids du réseau.  Notre «ensemble de données» est un ensemble de cibles et de vitesses de vent sélectionnées au hasard. </p><br><p><img src="https://habrastorage.org/webt/nc/gz/7w/ncgz7wwykokoutzvfgyrm4xbspm.png"></p><br><p>  Une bonne caractéristique de ce modèle simple est que l'apprentissage est rapide car nous avons exprimé exactement ce que nous voulons du modèle d'une manière complètement différentiable.  Au départ, cela ressemble à ceci: </p><br><p><img src="https://habrastorage.org/webt/au/8a/-d/au8a-dfq1ud9_fhdcrbvzapfedi.gif"></p><br><p>  Après environ cinq minutes de formation (sur le même cœur de processeur de mon ordinateur portable), cela ressemble à ceci: </p><br><p><img src="https://habrastorage.org/webt/ta/wu/lr/tawulrzggnp09s7qwcyykbhqeqs.gif"></p><br><p>  Si vous voulez influencer la trajectoire, augmentez la vitesse du vent: </p><br><p><img src="https://habrastorage.org/webt/qq/9m/dg/qq9mdgrns5hqcpzedeoh1-htrua.gif"></p><br><p>  Dévié de 16 cm, soit environ 0,3%.  Que diriez-vous de viser directement le trébuchet?  C'est facile à faire avec une descente de gradient, étant donné que nous avons des gradients.  Cependant, il s'agit d'un processus itératif lent qui prend environ 100 ms à chaque fois.  Au contraire, le fonctionnement d'un réseau de neurones prend 5 μs (vingt mille fois plus vite) avec une légère perte de précision.  Cette astuce, appelée «inversion de fonction approximative par gradients», est très courante et peut être utilisée non seulement avec des systèmes dynamiques, mais aussi avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">un algorithme de transfert de style rapide</a> . </p><br><p>  Il s'agit du problème de gestion le plus simple possible que nous utilisons principalement à des fins d'illustration.  Mais nous pouvons appliquer les mêmes méthodes de manière plus avancée aux problèmes classiques de RL. </p><br><h2 id="cart-meet-pole">  Chariot, rencontrer le pôle </h2><br><p>  Un défi de gestion plus reconnaissable est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">CartPole</a> , le «Bonjour tout le monde» pour l'apprentissage par renforcement.  Le défi est d'apprendre à équilibrer le pilier vertical en poussant sa base à gauche ou à droite.  Notre configuration est généralement similaire à celle de Trebuchet: l' <a href="" rel="nofollow">implémentation de Julia</a> nous permet de considérer directement les récompenses reçues par l'environnement comme des pertes.  ∂P nous permet de passer en toute transparence d'un modèle simple à un modèle RL. </p><br><p><img src="https://habrastorage.org/webt/ik/wp/0y/ikwp0y4qhogsybm3rakwiyxwfuc.png"></p><br><p>  Un lecteur astucieux peut remarquer un accroc.  La zone d'action pour le plancher - un décalage vers la gauche ou la droite - est discrète et donc non différenciable.  Nous résolvons ce problème en introduisant une discrétisation différenciable, définie <a href="" rel="nofollow">comme suit</a> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>f&amp;#xA0;(x)&amp;#xA0;=&amp;#xA0;\&amp;#xA0;left&amp;#xA0;\&amp;#xA0;{\&amp;#xA0;begin&amp;#xA0;{matrix}&amp;#xA0;\,&amp;#xA0;1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;\&amp;#xA0;geqslant0&amp;#xA0;\\&amp;#xA0;-1,&amp;#xA0;\,&amp;#xA0;x&amp;#xA0;&amp;lt;0&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{matrix}&amp;#xA0;\&amp;#xA0;right.</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>f&nbsp;(x)&nbsp;=&nbsp;\&nbsp;left&nbsp;\&nbsp;{\&nbsp;begin&nbsp;{matrix}&nbsp;\,&nbsp;1,&nbsp;\,&nbsp;x&nbsp;\&nbsp;geqslant0&nbsp;\\&nbsp;-1,&nbsp;\,&nbsp;x&nbsp;&lt;0&nbsp;\&nbsp;end&nbsp;{matrix}&nbsp;\&nbsp;right.</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> f (x) = \ left \ {\ begin {matrix} \, 1, \, x \ geqslant0 \\ -1, \, x <0 \ end {matrix} \ right. </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>f</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.445ex" height="2.419ex" viewBox="0 -780.1 6219.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="523" y="0"></use></g><g transform="translate(3289,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-78" x="523" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-3D" x="4662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMAIN-31" x="5719" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>d</mi><mi>x</mi></mrow><mo>=</mo><mn>1</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ frac {df} {dx} = 1 </script></p><br><p>  En d'autres termes, nous faisons en sorte que le dégradé se comporte comme si <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/459562/&amp;usg=ALkJrhiNTFllQw57wykrf54GlHEOc5vklQ#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> f </script>  était une fonction identique.  Étant donné à quel point l'idée mathématique de différentiabilité est déjà utilisée en ML, il n'est peut-être pas surprenant que nous puissions simplement tromper ici;  pour l'entraînement, tout ce dont nous avons besoin est un signal pour informer notre marche pseudo-aléatoire autour de l'espace des paramètres, et le reste, ce sont les détails.  Les résultats parlent d'eux-mêmes.  Dans les cas où les méthodes RL doivent être formées sur des centaines d'épisodes avant de résoudre le problème, les modèles ∂P n'ont besoin que d'environ 5 épisodes pour finalement gagner. </p><br><p><img src="https://habrastorage.org/webt/7t/eq/hj/7teqhjn1f4rdicydv4iiqjasirm.gif"></p><br><h2 id="the-pendulum--backprop-through-time">  Le pendule et le backprop à travers le temps </h2><br><p>  Un objectif important pour le RL <em>(apprentissage par renforcement)</em> est de gérer la rémunération différée lorsqu'une action ne nous aide pas à améliorer les résultats de plusieurs étapes consécutives.  Lorsque l'environnement est différenciable, ∂P permet de former l'agent à la rétropropagation dans le temps, comme dans un réseau récursif!  Dans ce cas, l'état de l'environnement devient un «état caché» qui change entre les pas de temps. </p><br><p><img src="https://habrastorage.org/webt/uy/od/mb/uyodmbo3grxrwkyawrgfol0nujo.png"></p><br><p>  Pour démontrer cette technique, nous considérons un modèle de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">pendule</a> , où la tâche consiste à faire pivoter le pendule jusqu'à ce qu'il soit debout et à le maintenir en équilibre instable.  C'est difficile pour les modèles RL;  après environ 20 épisodes d'entraînement, le problème est résolu, mais souvent le chemin vers la solution n'est clairement pas optimal.  En revanche, BPTT peut battre le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">classement des leaders</a> RL dans un épisode de formation.  Il est instructif d'observer le déroulement de cet épisode;  au début de l'enregistrement, la stratégie est aléatoire et le modèle s'améliore avec le temps.  Le rythme d'apprentissage est presque alarmant. </p><br><p><img src="https://habrastorage.org/webt/jm/wm/nh/jmwmnhr9nts4ki257ywtittvgck.gif"></p><br><p>  Le modèle est bien adapté pour l'usinage de n'importe quel angle initial et a quelque chose de proche de la stratégie optimale.  Au redémarrage, le modèle ressemble à ceci. </p><br><p><img src="https://habrastorage.org/webt/bu/7f/t3/bu7ft3bzofjrdumbfqvvwqr0nz8.gif"></p><br><p>  Ce n'est que le début;  nous obtiendrons un réel succès en appliquant le <em>DP</em> aux environnements avec lesquels RL est généralement trop difficile à travailler, où des simulations et des modèles riches existent déjà (comme dans la plupart des sciences de l'ingénieur et des sciences naturelles), et où l'interprétabilité est un facteur important (comme en médecine). </p><br><h2 id="the-map-is-not-the-territory">  La carte n'est pas le territoire </h2><br><p>  Une limitation de ces modèles de jouets est qu'ils assimilent l'environnement d'apprentissage simulé à l'environnement de test;  Bien sûr, le monde réel n'est pas différenciable.  Dans un modèle plus réaliste, la simulation nous donne un modèle de comportement brut qui est affiné avec des données.  Ces données informent, par exemple, des effets simulés du vent, ce qui, à son tour, améliore la qualité des gradients que le simulateur transmet au contrôleur.  Les modèles peuvent même faire partie de la passe directe du contrôleur, ce qui lui permet d'affiner ses prévisions sans avoir à étudier la dynamique du système à partir de zéro.  L'apprentissage de ces nouvelles architectures rendra les travaux futurs passionnants. </p><br><h2 id="coda">  Coda </h2><br><p>  L'idée de base est que la programmation différenciable, dans laquelle nous écrivons simplement un programme numérique arbitraire et l'optimisons à l'aide de gradients, est un moyen puissant de créer de meilleurs modèles et architectures similaires à l'apprentissage en profondeur, en particulier lorsque nous avons une grande bibliothèque de programmes différenciables à portée de main. .  Les modèles décrits ne sont que des aperçus, mais nous espérons qu'ils donneront une idée de la façon dont ces idées peuvent être mises en œuvre de manière plus réaliste. </p><br><p>  Tout comme la programmation fonctionnelle implique de raisonner et d'exprimer des algorithmes à l'aide de modèles fonctionnels, la programmation différenciable implique d'exprimer des algorithmes à l'aide de modèles différenciables.  La communauté d'apprentissage en profondeur a déjà développé de nombreux modèles de conception de ce type, par exemple, pour gérer les problèmes de gestion ou une structure de données cohérente et arborescente.  Au fur et à mesure que la zone se développe, beaucoup plus sera inventé, et à la suite de ces programmes, même les architectures d'apprentissage en profondeur les plus avancées auront l'air grossières et arriérées. </p><br><h3 id="ssylki">  Les références </h3><br><ul><li>  Sources d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">abord</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">deuxième</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Wikipédia</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Différenciation automatique;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article sur habr</a> </li><li>  <a href="" rel="nofollow">Différenciation automatique;</a>  <a href="" rel="nofollow">paquet fini</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Différenciation automatique;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">fais-le toi-même</a> </li></ul><br><p><img src="https://habrastorage.org/webt/f2/4o/pr/f24oprfnnrnguwwb03xcyo__xx4.gif"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr459562/">https://habr.com/ru/post/fr459562/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr459550/index.html">Sauvegarde, Partie 5: Test de Bacula et Veeam Backup pour Linux</a></li>
<li><a href="../fr459552/index.html">Comment perdre l'accès au système en direct en tâtonnant simplement le code source</a></li>
<li><a href="../fr459554/index.html">Gardez une trace des modifications de fichiers à l'aide de Alerting OpenDistro for Elasticsearch</a></li>
<li><a href="../fr459558/index.html">Comment commencer à utiliser le mode utilisateur sous Linux</a></li>
<li><a href="../fr459560/index.html">Capacités des centres de données de conteneurs: centre de commutation prêt à l'emploi au Myanmar en 50 jours</a></li>
<li><a href="../fr459564/index.html">Ce que les développeurs doivent savoir sur l'entreprise</a></li>
<li><a href="../fr459568/index.html">Lettre verticale dans l'informatique moderne</a></li>
<li><a href="../fr459570/index.html">Beeline montre des annonces à Google bot. Bot mécontent</a></li>
<li><a href="../fr459574/index.html">Plongez dans les espaces de noms Linux, partie 2</a></li>
<li><a href="../fr459576/index.html">Extensions Google Chrome utiles pour le programmeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>