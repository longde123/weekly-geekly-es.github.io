<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÜüèª üëâüèø üë®‚Äçüë¶ Am√©lioration des performances du syst√®me de vid√©osurveillance et pr√©vention des plantages üò± üîê üéê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De toute √©vidence, il vaut mieux pr√©venir la maladie que la traiter plus tard. 

 Avec la construction de syst√®mes vid√©o, tout est exactement pareil. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Am√©lioration des performances du syst√®me de vid√©osurveillance et pr√©vention des plantages</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/macroscop/blog/412791/"> De toute √©vidence, il vaut mieux pr√©venir la maladie que la traiter plus tard. <br><br>  Avec la construction de syst√®mes vid√©o, tout est exactement pareil.  Au lieu de chercher des raisons et de r√©soudre les probl√®mes d'affichage / d'enregistrement / d'archivage pendant l'utilisation, il est pr√©f√©rable de r√©fl√©chir un peu plus longtemps et soigneusement au stade de la conception pour √©viter de futurs probl√®mes. <br><br>  Notre support technique est actif, tr√®s actif.  Elle conseille, aide √† la mise en place et, bien s√ªr, r√©sout les probl√®mes des syst√®mes vid√©o.  Souvent, ces probl√®mes sont visibles dans l'environnement logiciel, mais ils ne sont pas li√©s √† Macroscop.  Le syst√®me vid√©o est multi-composants, si quelque chose se casse ou ne fonctionne tout simplement pas correctement, l'utilisateur ne verra pas qu'une partie s'est d√©t√©rior√©e.  Il verra que des secousses sont apparues dans la vid√©o en temps r√©el, et des "trous" sont apparus dans les archives.  Est-ce √† dire que le probl√®me vient du logiciel?  Souvent, la raison est compl√®tement diff√©rente. <br><br><img src="https://habrastorage.org/webt/4p/2l/d-/4p2ld-taaiydceuzg-kdpov88bm.jpeg"><br><a name="habracut"></a><br>  √âtant donn√© que les appels au support technique de Macroscop (comme cela sera expliqu√© plus loin) dans 40% des cas ne sont pas li√©s aux performances du logiciel, nous avons d√©cid√© de mener un petit programme √©ducatif sur la planification et la construction de syst√®mes vid√©o.  Et dire pourquoi il est important de ne pas l√©siner sur le temps et l'argent √† ces √©tapes, et que se passera-t-il si vous ne le faites pas.  Nous parlerons √©galement de l'√©vidence.  Mais l'exp√©rience montre que <b>comprendre et faire sont deux choses diff√©rentes</b> . <br><br>  Commen√ßons par l'apparence du probl√®me.  Visuellement, un signal indiquant que quelque chose ne va pas dans le syst√®me peut √™tre: <br><br><ol><li>  Absence de connexion √† la cam√©ra.  Vous ne voyez tout simplement pas la vid√©o de la cam√©ra en temps r√©el et vous n'en recevez pas d'archive. </li><li>  Affichage vid√©o fluide (secousses / acc√©l√©ration / retard). </li><li>  Places vides ("trous") dans l'archive.  Il semble que l'enregistrement √©tait en cours, mais il n'y a pas de vid√©o dans les archives. </li><li>  Artefacts.  Sur la vid√©o appara√Æt ce qui n'√©tait pas r√©ellement (√† condition que les forces d'un autre monde n'aient pas contribu√© √† cela). </li></ol><br><img src="https://habrastorage.org/webt/-k/ho/n_/-khon_enrwhilupsa4ctfsjrqyo.jpeg"><br><br>  Qu'est-ce qui peut provoquer des violations? <br><br><h2>  <i>R√©seau</i> </h2><br>  Si la vid√©o n'est pas venue de la cam√©ra vers le serveur, du serveur elle n'est pas all√©e au client ou au stockage, le canal de communication est le plus souvent √† bl√¢mer.  Il peut ne pas √™tre assez large, pas assez stable, pas lisible (il ne sait pas comment hi√©rarchiser correctement quand il y a beaucoup d'informations diverses). <br><br>  Par cons√©quent, la premi√®re chose √† laquelle vous devez faire attention au d√©but est la largeur du futur canal de communication.  <b>Il est calcul√©</b> simplement - nous prenons toutes les cam√©ras du futur syst√®me, d√©terminons combien de Mbit d'informations chacune enverra chaque seconde (pour cela, nous devons comprendre quelle qualit√© d'enregistrement est requise - r√©solution, fr√©quence, format), nous prenons en compte si la vid√©o sera affich√©e (√† partir du nombre de cam√©ras et combien de moniteurs), nous augmentons de 10 √† 15% le trafic technique et comprenons o√π et quelle bande passante sera n√©cessaire. <br><br>  Il est pr√©f√©rable de <b>dessiner un sch√©ma du</b> futur syst√®me.  Cela peut √™tre fait, entre autres, √† l'aide de programmes sp√©ciaux (Graphical Network Simulator 3, par exemple), ils aideront aux calculs et √† l'identification des ¬´goulots d'√©tranglement¬ª qui n√©cessitent une attention particuli√®re.  Il s'agit d'un outil simple et √©vident, mais en pratique, peu de gens l'utilisent.  Surtout chez les installateurs d√©butants. <br><br>  <b>S√©parez</b> le r√©seau de vid√©osurveillance du r√©seau de t√©l√©phonie, d'Internet et de tout autre syst√®me.  Pour que le syst√®me vid√©o qui supprime l'infraction ne perd pas dans la lutte pour le trafic avec YouTube, que 10 employ√©s de votre entreprise ont d√©cid√© de regarder √† ce moment-l√†, vous devez lui attribuer une cha√Æne distincte. <br><br>  Les r√©seaux peuvent √™tre divis√©s physiquement et logiquement.  Dans le premier cas, vous installez un √©quipement s√©par√© et posez des c√¢bles s√©par√©s, dans le second, vous s√©lectionnez des commutateurs avec prise en charge VLAN.  En pratique, du point de vue des param√®tres, il est plus facile de se s√©parer physiquement s'il y a une possibilit√© d'engager des co√ªts suppl√©mentaires. <br><br>  Il est important de calculer la <b>puissance lors du choix de l'√©quipement r√©seau</b> .  Un fabricant peut revendiquer une plus grande bande passante des ports du commutateur, mais cela ne garantit pas que le processeur du p√©riph√©rique r√©seau supportera tout ce volume de donn√©es. <br><br>  Le r√©seau doit non seulement √™tre bien pens√©, mais aussi <b>assembl√© efficacement</b> .  Il s'agit du banal: l'utilisateur a un cordon de raccordement mal compress√©, ce qui entra√Æne une perte de connexion ou des ruptures dans l'archive.  Il n'est pas possible de trouver un tel probl√®me pas si rapidement, car, en r√®gle g√©n√©rale, la derni√®re chose √† v√©rifier les performances de bagatelles telles que les cordons de raccordement ou les sockets de routeur est. <br><br><h2>  <i>Syst√®mes de stockage de donn√©es</i> </h2><br>  Il est important de ne pas oublier de calculer la <b>largeur de canal</b> n√©cessaire entre le serveur et le stockage connect√© au r√©seau.  Il est souvent n√©glig√©. <br><br>  Pour que les syst√®mes de stockage puissent g√©rer l'enregistrement de la quantit√© entrante d'informations provenant du syst√®me vid√©o, il est n√©cessaire de calculer la <b>quantit√© de m√©moire</b> n√©cessaire et d'√©valuer les <b>IOPS</b> (param√®tre responsable du nombre d'op√©rations d'entr√©e-sortie effectu√©es par les syst√®mes de stockage par seconde).  Cela peut √™tre fait √† l'aide de programmes sp√©ciaux (Iometer, IOzone, FIO, CrystalDiskMark). <br><br>  Si le syst√®me est multi-serveur, nous recommandons qu'au lieu d'un stockage de plus grande capacit√©, choisissez un volume l√©g√®rement plus petit pour √©viter une charge excessive. <br><br><h2>  <i>Antivirus et pare-feu</i> </h2><br>  En r√®gle g√©n√©rale, les pare-feu et les logiciels antivirus affectent le fonctionnement du syst√®me vid√©o, car ils interf√®rent avec le trafic r√©seau.  Il peut √©galement s'agir de Windows Defender, du pare-feu Windows, du pare-feu mat√©riel, etc. <br><br>  Vous pouvez d√©sactiver un logiciel antivirus, mais simplement exclure un pare-feu sans modifier la configuration g√©n√©rale du syst√®me lorsqu'il est d√©j√† construit (en particulier lorsqu'il s'agit d'un syst√®me volumineux et complexe).  Nous devons reconstruire l'ensemble du r√©seau.  Par cons√©quent, il est √† l'avance de prendre soin de <b>d√©sactiver ou d'exclure</b> du syst√®me de vid√©osurveillance tous les logiciels et appareils susceptibles de limiter la r√©ception ou la transmission des donn√©es.  Souvent, m√™me la mise en place d '¬´exceptions¬ª ne limite pas compl√®tement l'acc√®s de telles solutions au trafic vid√©o. <br><br><h2>  <i>√âquipement</i> </h2><br>  En plus de l'√©vidence (les cam√©ras, les serveurs, le stockage devraient fonctionner), il y a certains points dans les param√®tres mat√©riels, qui sont √©galement souhaitables √† consid√©rer.  Assurez-vous de v√©rifier que vos ordinateurs <b>ne passent pas en mode d'√©conomie d'√©nergie</b> .  Sinon, le syst√®me fonctionnera, mais le r√©seau aura une faible priorit√©, de sorte que certaines donn√©es des cam√©ras risquent de ne pas venir.  De plus, il sera tr√®s difficile de trouver la cause, car d√®s que vous commencerez √† chercher, tout fonctionnera miraculeusement. <br><br>  Lorsque vous choisissez des cam√©ras IP dans un projet, faites attention au protocole de transfert de donn√©es avec lequel elles fonctionnent.  Pour minimiser les pertes, choisissez une connexion <b>TCP</b> (bonne, elle est beaucoup plus courante que les autres).  Ensuite, en cas d'erreurs de r√©seau, une demande r√©p√©t√©e d'informations de la cam√©ra se produira et, avec une forte probabilit√©, elle sera relev√©e avec un l√©ger retard, non perceptible par l'utilisateur. <br><br>  Parfois, des probl√®mes surviennent parce que l'utilisateur demande <b>plusieurs flux</b> √† la fois √† la cam√©ra et que la cam√©ra ne r√©siste pas √† cela.  Les fabricants donnent rarement leurs recommandations concernant le nombre de flux, vous devez donc ici le v√©rifier empiriquement. <br>  La cam√©ra install√©e elle-m√™me peut ne pas fonctionner correctement et envoyer des vid√©os avec des artefacts au serveur.  Pour v√©rifier que le probl√®me est dans la cam√©ra et non dans le logiciel du syst√®me vid√©o, vous pouvez par exemple utiliser un lecteur VLC: si des artefacts sont observ√©s dans le lecteur, la raison doit √™tre recherch√©e dans la cam√©ra elle-m√™me.  Vous devez d'abord vous assurer que le syst√®me vid√©o et le lecteur vid√©o sont transmis en utilisant le m√™me protocole. <br><br>  Si vous ne pouvez pas fournir un canal de communication suffisamment large, vous pouvez <b>r√©duire le d√©bit binaire</b> sur les cam√©ras.  Pour ce faire, dans les param√®tres, r√©duisez la fr√©quence d'images ou la qualit√© d'enregistrement, utilisez des cam√©ras avec des formats de compression modernes (h.264 +, h.265 +), la technologie zipstream.  De plus, la grande majorit√© a la possibilit√© d'utiliser un d√©bit binaire variable: lorsqu'il n'y a pas de mouvement dans la trame, moins d'informations sont transmises, lorsque le mouvement d√©marre, la qualit√© d'enregistrement et la quantit√© de donn√©es augmentent. <br><br><h2>  <i>Comment trouver un probl√®me?</i> </h2><br>  Si un probl√®me survient n√©anmoins, les √©tapes suivantes peuvent √™tre prioritaires pour diagnostiquer la cause: <br><br><ol><li>  Acc√©dez au gestionnaire de t√¢ches et v√©rifiez la charge globale du syst√®me. </li><li>  V√©rifiez l'√©tat physique de l'√©quipement (si l'alimentation est coup√©e, si quelqu'un a cass√© le c√¢ble, si les cam√©ras fonctionnent, etc.). </li><li>  V√©rifiez si l'antivirus est d√©sactiv√©. </li><li>  Profitez <b>des</b> fonctionnalit√©s d' <b>autodiagnostic</b> de Macroscop.  L'autodiagnostic affiche des messages d'erreur et donne des recommandations sur la fa√ßon de les r√©soudre vous-m√™me. </li></ol><br>  Tout cela peut √™tre fait par l'administrateur syst√®me sans l'intervention de sp√©cialistes externes. <br><br>  Si la raison n'est pas trouv√©e et que vous ne pouvez pas r√©soudre le probl√®me vous-m√™me, vous devez contacter le support technique.  La premi√®re chose que nous v√©rifions lorsque nous traitons le probl√®me des retards, des artefacts ou de la perte de connexion est le r√©seau entre la cam√©ra et le serveur.  Pour ce faire, nous utilisons des programmes sp√©ciaux (Iperf), ainsi qu'un test ping.  Nous envoyons uniquement une requ√™te ping √† un gros paquet de donn√©es, car la vid√©o est 99% plus √©lev√©e que le volume de donn√©es maximum autoris√© d'un paquet standard (MTU). <br><br>  <i>Exemple</i> : ping -l 5000 -t (ping infini avec un paquet de 5000 octets). <br><br>  Nous envoyons un paquet de donn√©es, le r√©cup√©rons et estimons la perte.  Et ils sont g√©n√©ralement inacceptables.  M√™me 1% des images perdues entra√Ænent divers effets n√©gatifs - des artefacts, des pertes dans l'archive, des secousses en temps r√©el √† une d√©connexion compl√®te de la cam√©ra. <br>  De m√™me, un probl√®me de canal de communication entre le serveur et les ordinateurs clients peut √™tre diagnostiqu√©. <br><br>  Macroscop enregistre √©galement le fonctionnement du syst√®me et les journaux aident beaucoup √† r√©duire la zone de recherche de probl√®mes pour nos sp√©cialistes.  Gr√¢ce aux fonctions de diagnostic, le logiciel identifie les probl√®mes de violation de la s√©quence de paquets envoy√©s par la cam√©ra au serveur, d'acc√®s au serveur, de sous-syst√®me de d√©codage, d'autorisation, de lancement de services et d'enregistrement. <br><br>  Ce ne sont que quelques options pour v√©rifier l'√©tat et trouver les sources du probl√®me, mais dans la plupart des cas, ces outils sont suffisants pour diagnostiquer la cause.  Sinon, une √©tude individuelle commence et une v√©rification minutieuse. <br><br><h2>  <i>Pensez √† l'avance</i> </h2><br>  Comme dans beaucoup d'autres, dans le cas d'un syst√®me vid√©o, un certain nombre de probl√®mes peuvent √™tre √©vit√©s simplement en √©tant s√ªr au stade de la conception.  Calculez √† l'avance les param√®tres du r√©seau, s√©lectionnez des √©quipements un peu plus productifs que les calculs l'exigent, achetez des consommables de haute qualit√© et faites attention √† leur installation, √©coutez les recommandations des √©quipementiers et des d√©veloppeurs de logiciels que vous choisissez, contactez le support technique ou les pr√©ventes si vous √™tes des questions ou des doutes. <br><br>  En g√©n√©ral, plus vous pr√™tez attention au syst√®me vid√©o au tout d√©but, moins il en aura besoin pendant de nombreuses ann√©es d'utilisation. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412791/">https://habr.com/ru/post/fr412791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412781/index.html">Un fan de NES a permis de lancer des jeux SNES sur la console</a></li>
<li><a href="../fr412783/index.html">Installation du proxy MTProto Telegram √† partir de la source sur Centos 7</a></li>
<li><a href="../fr412785/index.html">Master of Management et Freelancer. L'histoire en trois parties</a></li>
<li><a href="../fr412787/index.html">Int√©gration de Git dans un syst√®me de d√©veloppement d'entreprise</a></li>
<li><a href="../fr412789/index.html">¬´Aide au travail¬ª: comment rendre les robots de chat plus intelligents</a></li>
<li><a href="../fr412793/index.html">MassTransit, Saga et RabbitMQ pour l'impl√©mentation d'un gestionnaire de processus</a></li>
<li><a href="../fr412795/index.html">Et tirons les conclusions de la discussion de l'article "Qu'est-ce qui ne va pas avec le retour des Geektimes √† Habr"</a></li>
<li><a href="../fr412797/index.html">√Ä propos des dangers du CDN, des services et des polices de Google</a></li>
<li><a href="../fr412799/index.html">Toujours en contact: Mango Talker - messenger et softphone</a></li>
<li><a href="../fr412801/index.html">√âtude: des pirates informatiques volent des millions de dollars en raison de la faible s√©curit√© des √©changes de crypto-monnaie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>