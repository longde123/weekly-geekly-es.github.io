<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêí üêë üöµüèø Wir schreiben den FPGA-Loader in LabVIEW. Teil 1 üèπ ‚ÑπÔ∏è üñïüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die meisten "normalen" Programmierer haben, gelinde gesagt, eine zweideutige Einstellung zur LabVIEW- Technologie. Hier kann man lange und ohne Erfolg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir schreiben den FPGA-Loader in LabVIEW. Teil 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427529/"><img src="https://habrastorage.org/webt/2m/nu/6l/2mnu6ljkhtj-pydr_chsebgpp_i.jpeg"><br><p><br>  Die meisten "normalen" Programmierer haben, gelinde gesagt, eine zweideutige Einstellung zur <strong>LabVIEW-</strong> Technologie.  Hier kann man lange und ohne Erfolg streiten.  Die Situation wird durch die Tatsache versch√§rft, dass es im Netzwerk viele Beispiele f√ºr LabVIEW-Programme gibt, die sich jedoch alle an Anf√§nger richten und sich auf "Oh, sehen Sie, wie einfach es ist, verbinden Sie die Drehung mit dem Indikator, drehen Sie den Knopf, √§ndern Sie die Nummer" oder bestenfalls auf die Grafik im Zyklus beschr√§nken Es wird eine Zufallszahl oder ein Sinus angezeigt. All dies wird von einer w√ºtenden Oberfl√§che in Form von riesigen Kippschaltern, Drehkn√∂pfen und Messuhren begleitet.  Pers√∂nlich √§rgert mich dieser Ansatz der bewussten Vereinfachung.  In einer kurzen Artikelserie werde ich versuchen, den Leser in den Prozess der Entwicklung von Anwendungssoftware bei LabVIEW einzuf√ºhren.  Um dem Themenbereich nicht viel Zeit zu widmen, verwenden wir den detaillierten Algorithmus zum Hochladen der Konfigurationsdatei auf das FPGA √ºber FTDI im MPSSE-Modus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Herunterladen der Konfiguration auf das FPGA √ºber USB oder Zerlegen von FTDI MPSSE</a> ).  In diesem Artikel werde ich zeigen, wie der gleiche FPGA-Loader implementiert wird, jedoch in der LabVIEW-Sprache. </p><a name="habracut"></a><br><p>  Wie oben erw√§hnt, sind der FPGA-Ladealgorithmus im SP-Modus (Serial Passive) und das Prinzip des FTDI-Betriebs im vorherigen Artikel ausf√ºhrlich beschrieben.  Ich werde mich nicht wiederholen.  Wir glauben, dass der Algorithmus getestet und als passend erkannt wird.  Und ja, nehmen wir an, der Leser ist zumindest oberfl√§chlich mit dem LabVIEW-Konzept vertraut und kennt sich mit klassischer Programmierung bestens aus. </p><br><p>  Obwohl das Erstellen eines Bootloaders nicht viel Zeit in Anspruch nimmt, konnte die Beschreibung des Prozesses nicht in das Volumen eines Artikels passen, sodass es eine kleine Serie geben wird.  Da die Phase der Experimente bereits abgeschlossen ist und ich von der Funktionsf√§higkeit des Algorithmus √ºberzeugt bin, werde ich mir erlauben, mit der Entwicklung √ºber die Benutzeroberfl√§che zu beginnen.  Im ersten Artikel werden wir die Loader-Benutzeroberfl√§che erstellen und die Programmstruktur implementieren.  In der zweiten - √ºber die FTDI-Treiber-DLL implementieren wir das Laden der * .rbf-Datei in das FPGA. </p><br><p>  F√ºr die Produktivit√§t der Konversation ist es nicht √ºberfl√ºssig, sich an die in LabVIEW verwendete Terminologie zu erinnern.  In LabVIEW wird das Anwendungsprogramm als virtuelles Instrument, auch als VI bezeichnet, auch als virtuelles Instrument oder kurz VI bezeichnet.  Der VP hat zwei ‚ÄûSeiten‚Äú: das Frontpanel, auf dem sich die Bedienelemente und Anzeigen befinden, und das Blockdiagramm (Blockdiagramm), auf dem diese Elemente miteinander verbunden sind und die Funktionen und Datenverarbeitungsabl√§ufe implementiert sind.  In der Regel hat ein VP eine hierarchische Struktur. Alle VPs in einem VP der obersten Ebene werden normalerweise als Subger√§t oder SubVI bezeichnet. </p><br><h2 id="interfeys-polzovatelya">  Benutzeroberfl√§che </h2><br><p>  Unsere Anwendung sollte die Konfigurationsdatei in das FPGA laden.  Gleichzeitig meinen wir, dass mehrere FTDIs gleichzeitig an einen Computer angeschlossen werden k√∂nnen und einige von ihnen m√∂glicherweise zum Konfigurieren von FPGAs verwendet werden k√∂nnen.  Ich schlage vor, eine Ger√§teauswahl aus der Dropdown-Liste zu treffen und eine Datei √ºber eine Schaltfl√§che mit einer Pfadausgabe auszuw√§hlen.  Um den Download zu starten, f√ºgen Sie die Schaltfl√§che "Programm" hinzu.  Eine virtuelle LED zeigt den Status des Vorgangs an.  Starten Sie LabVIEW. </p><br><p>  F√ºgen Sie die erforderlichen Elemente zur Frontplatte (Frontplatte) hinzu.  Ich werde den "Silber" -Stil f√ºr den VP verwenden.  Die folgende Abbildung zeigt das Ergebnis aller Elemente in ihrem urspr√ºnglichen Zustand.  Bei Bedarf sind sie in der Palette recht leicht zu finden. </p><br><img src="https://habrastorage.org/webt/qq/os/bt/qqosbtkepb8n5fe2l3_qnz309q8.png"><br><p><br>  Wir bearbeiten Elemente: Wir √ºbertragen, dehnen, wir f√ºgen Inschriften hinzu - wir bringen sie in die gew√ºnschte Form.  Hier ist in der Tat die Hand des Designers erforderlich, aber wie ich k√∂nnte: </p><br><img src="https://habrastorage.org/webt/wd/sp/iz/wdspizcngovsuygvcmkofpnepjw.png"><br><p><br>  Und das Blockdiagramm: </p><br><img src="https://habrastorage.org/webt/l0/g_/hi/l0g_hij_xwkzm3n-sfrqe6pfypg.png"><br><p><br>  Ich ziehe deine Aufmerksamkeit auf mich.  Jedes Element verf√ºgt √ºber zwei Eigenschaften, die den Namen bestimmen - Beschriftung und Beschriftung. </p><br><img src="https://habrastorage.org/webt/pi/xi/r9/pixir9kcyslk2iscflmbtfxtpmq.png"><br><p><br>  Die erste Eigenschaft legt den Namen des Elements fest. Unter diesem Namen wird es im Blockdiagramm angezeigt.  Die Beschriftung kann im Gegensatz zur Beschriftung w√§hrend der Ausf√ºhrung des VIs nicht ge√§ndert werden.  In Verbindung mit dieser Funktion empfehle ich, dass Sie die Beschriftung in Ihren VIs auf der Vorderseite ausblenden und Beschriftung anzeigen.  √úberlegen Sie sich f√ºr Label einen aussagekr√§ftigen Namen als Variable in einer klassischen Programmiersprache, vorzugsweise in einem lateinischen Layout.  F√ºr Caption f√ºhren wir einen menschenorientierten Namen ein. Dieser kann sehr lang sein, Leerzeichen enthalten und bei Bedarf auf Russisch.  Mit LabVIEW k√∂nnen Sie die Anzeigeschriftart f√ºr die Beschriftung anpassen.  Ich muss sagen, dass uns niemand zwingt, uns mit der Bildunterschrift anzulegen: Jede Inschrift kann an jedem freien Ort direkt auf <abbr title="Frontplatte">FP angebracht</abbr> werden. </p><br><p> Wir implementieren die VP-Operation nach dem klassischen Schema: While-Schleifen- und Ereignishandler.  F√ºgen Sie dem Blockdiagramm eine <code>While</code> Schleife (Programmierung -&gt; Strukturen -&gt; While-Schleife) und eine Event-Handler-Struktur (Programmierung -&gt; Strukturen -&gt; Ereignisstruktur) hinzu. </p><br><div class="spoiler">  <b class="spoiler_title">Kurze Hilfe zur Ereignisstruktur</b> <div class="spoiler_text"><p>  Die Struktur wartet auf das Eintreten des Ereignisses, dann wird der entsprechende Handler ausgef√ºhrt.  Die Struktur von Ereignissen hat ein oder mehrere Unterdiagramme - Ereignishandler, die sogenannten F√§lle, von denen einer ausgef√ºhrt wird, wenn ein Ereignis auftritt.  Mit dem Terminal in der oberen linken Ecke k√∂nnen Sie die Anzahl der Millisekunden angeben, in denen die Struktur ein Ereignis erwartet.  Wenn w√§hrend dieser Zeit kein Ereignis aufgetreten ist, wird das Unterdiagramm ‚ÄûTimeout‚Äú ausgef√ºhrt.  Der Standardwert ist minus 1, was bedeutet, dass das Zeitlimit nie abl√§uft. </p><br><img src="https://habrastorage.org/webt/ol/qj/uo/olqjuooy0reae8un_fyw5bs2l78.png"><br><br><ol><li>  Die Ereignisauswahlbezeichnung gibt an, welche Ereignisse den aktuellen Fall ausl√∂sen.  Um andere Handler anzuzeigen, k√∂nnen Sie auf den Abw√§rtspfeil neben dem Ereignisnamen klicken. </li><li>  Das <code>timeout</code> Terminal legt die Anzahl der Millisekunden fest, die auf ein Ereignis gewartet werden sollen.  Wenn der Wert nicht -1 ist, muss das Timeout-Subdiagramm implementiert werden. </li><li>  Ein Terminal zur Eingabe dynamischer Ereignisse.  Dieses Terminal wird standardm√§√üig nicht angezeigt.  Um es anzuzeigen, w√§hlen Sie im Kontextmen√º "Dynamische Ereignisterminals anzeigen". </li><li>  Ereignisdatenknoten.  Wenn ein Ereignis eintritt, generiert LabVIEW Daten, die diesem Ereignis zugeordnet sind.  Dieser Knoten stellt diese Daten dem Handler zur Verf√ºgung.  Mit der Maus k√∂nnen Sie die Gr√∂√üe des Knotens vertikal √§ndern und die erforderlichen Elemente ausw√§hlen.  Einige Daten wie <code>Type</code> und <code>Time</code> sind allen Ereignissen gemeinsam, andere wie <code>Char</code> und <code>VKey</code> h√§ngen von der Art des konfigurierten Ereignisses ab. </li><li>  Der Ereignisfilterknoten definiert Ereignisdaten, die Sie √§ndern k√∂nnen, bevor die Benutzeroberfl√§che diese Daten verarbeitet.  Dieser Knoten wird nur in den Handlern angezeigt, in denen Filterung verf√ºgbar ist.  Sie k√∂nnen Elemente vom Ereignisdatenknoten zum Ereignisfilterknoten verbinden und √§ndern.  Sie k√∂nnen diese Ereignisse auch √§ndern, indem Sie die neuen Werte mit den Knotenterminals verbinden.  Kann ich die Reaktion der Schnittstelle auf das Ereignis vollst√§ndig abbrechen, wenn ich <code>true</code> an das <code>Discard?</code> Terminal <code>Discard?</code>  .  Wenn Sie den Wert nicht mit dem Filterelement verbinden, bleibt dieses Datenelement unver√§ndert. </li><li>  Wie die <code>Case</code> unterst√ºtzt die Ereignisstruktur Tunnel.  Wenn Sie in einem Fall einen Tunnel hinzuf√ºgen, wird dieser automatisch f√ºr jeden Handler erstellt.  Standardm√§√üig m√ºssen jedoch die Ausgabetunnel der Ereignisstruktur nicht in jedem Handler verbunden werden.  Alle nicht verbundenen Tunnel verwenden den Standardwert f√ºr den Tunneldatentyp.  Dies kann m√∂glicherweise zu schwer zu erkennenden Fehlern f√ºhren.  Sie k√∂nnen den Modus zur√ºckgeben, in dem der Tunnel in allen Handlern verkabelt werden soll. W√§hlen Sie dazu im Kontextmen√º "Standard verwenden, wenn nicht verdrahtet". </li></ol></div></div><br><p>  Zun√§chst k√ºmmern wir uns darum, wie der Zyklus endet und das Programm beendet.  Am einfachsten ist es, eine Stopp-Schaltfl√§che hinzuzuf√ºgen, die den Zyklus stoppt. Meiner Meinung nach ist es jedoch √ºblich, das Programm mit einem roten Kreuz in der oberen Ecke des Fensters zu beenden. <br>  F√ºgen Sie der <code>Event Structure</code> den entsprechenden Handler hinzu.  W√§hlen Sie im Kontextmen√º "Ereignisfall hinzuf√ºgen".  W√§hlen Sie als Quelle des Ereignisses "Dieses VI" aus. Das Ereignis zeigt "Panel schlie√üen?" An. </p><br><div class="spoiler">  <b class="spoiler_title">Ereignisse bearbeiten</b> <div class="spoiler_text"><p> <a href=""><img src="https://habrastorage.org/webt/bt/xo/qv/btxoqvdb2l67eohk78xrvwnhgcg.png"></a> <br>  <em>Klickbares Bild</em> </p></div></div><br><p>  Bitte beachten Sie, dass bei Auswahl von "Panel schlie√üen" (ohne Frage) dieses Ereignis ohne Filter ist und nicht r√ºckg√§ngig gemacht werden kann.  Und wenn Sie eine Frage haben und dann auf das Kreuz klicken, k√∂nnen wir die Kontrolle √ºbernehmen und das Programm unabh√§ngig korrekt vervollst√§ndigen.  Im "Panel schlie√üen?"  Durch den Tunnel verbinden wir die Boolesche Konstante <code>true</code> mit dem Terminal, um die <code>while</code> zu stoppen.  Eingabe "Verwerfen?"  dienen auch <code>true</code> . </p><br><p>  Jetzt gibt es keine offensichtliche Nuance: Wenn das aktuelle VI nicht in der LabVIEW-Umgebung, sondern in Form einer kompilierten Anwendung gestartet wird, wird durch Klicken auf das Kreuz das Fenster nicht geschlossen, sondern die Anwendung gestoppt, die wir nicht ben√∂tigen.  Um dieses Problem zu l√∂sen, pr√ºfen wir nach Abschluss des Hauptzyklus, ob wir uns in der Entwicklungsumgebung oder im Programmiermodus befinden. Wenn wir uns noch im Programmiermodus befinden, beenden wir die Anwendung.  Verwenden Sie den Eigenschaftsknoten (Programmierung -&gt; Anwendungssteuerung -&gt; Eigenschaftsknoten), um zu verstehen, wo das aktuelle VI ausgef√ºhrt wird.  Dieser Knoten bietet Zugriff auf die Eigenschaften eines Objekts unter Bezugnahme auf dieses Objekt.  In diesem Fall sollten wir einen Link zur gesamten Anwendung erhalten.  W√§hlen Sie die <code>VI Server Reference</code> aus derselben Palette aus.  Nachdem die Konstante auf das Blockdiagramm gesetzt wurde, m√ºssen Sie ihren Typ in <code>This Application</code> √§ndern (linke Maustaste).  Wir verbinden die resultierende Verkn√ºpfung mit dem Eigenschaftsknoten.  W√§hlen Sie die <code>Application:Kind Property</code> Eigenschaft <code>Application:Kind Property</code> - Gibt den Typ des LabVIEW-Systems zur√ºck, in dem das aktuelle VI ausgef√ºhrt wird.  Wir verbinden die Ausgabe der Eigenschaft mit der Fallstruktur, f√ºgen den Fall "Laufzeitsystem" hinzu, in dem wir die Anwendung <code>Quit LabVIEW</code> ( <code>Quit LabVIEW</code> ).  Damit dieser Block nach dem Zyklus und nicht vorher ausgef√ºhrt werden kann, verbinden wir den Eingangsanschlussfehler mit dem Zyklus durch den Tunnel. </p><br><p> <a href=""><img width="720" src="https://habrastorage.org/webt/il/nm/ty/ilnmtyv89c3yv-nogcksavitbnu.png"></a> <br>  <em>Klickbares Bild</em> </p><br><p>  Wenn Sie das Programm starten, k√∂nnen Sie es stoppen, indem Sie auf das Kreuz des Fensters klicken.  Das gestartete Programm sieht folgenderma√üen aus: </p><br><img src="https://habrastorage.org/webt/pv/9e/za/pv9ezax9jrro78shza6coogtu_4.png"><br><p><br>  Meiner Meinung nach viel √ºberfl√ºssig.  Gehen Sie zu den VI-Eigenschaften (Men√º Datei -&gt; VI-Eigenschaften), w√§hlen Sie die Kategorie "Fensterdarstellung" und legen Sie Benutzerdefiniert fest. </p><br><p>  Schalten Sie die Anzeige des Men√ºs aus (es bleibt im Bearbeitungsmodus), deaktivieren Sie die Bildlaufleiste und blenden Sie die Symbolleiste aus, wenn die Anwendung ausgef√ºhrt wird (Symbolleiste beim Ausf√ºhren anzeigen).  Wir verbieten die Gr√∂√üen√§nderung des Fensters, wir erlauben das Minimieren und Minimieren des Fensters.  Das ist besser: </p><br><img src="https://habrastorage.org/webt/a9/mg/u-/a9mgu-7km4wqkzj_rgdmc4mgfse.png"><br><p><br>  Nat√ºrlich lohnt es sich, die Beschriftung "National Instruments. LabVIEW Evaluation Software" zu entfernen, aber ich m√∂chte noch keine Lizenz f√ºr einen Heimcomputer kaufen. Wir werden die Beschriftung in Kauf nehmen und die 45-t√§gige Testphase verwalten. </p><br><p>  Nat√ºrlich k√∂nnen Sie die Hintergrundfarbe und jedes Element anpassen, Schriftarten ausw√§hlen, aber ich bin kein Designer, aber irgendetwas sagt mir, dass ich es nur noch schlimmer machen werde. </p><br><h2 id="spisok-priborov">  Instrumentenliste </h2><br><p>  Der VP sollte dem Benutzer eine Liste der an den Computer angeschlossenen Ger√§te anbieten, die f√ºr die FPGA-Firmware geeignet sind, damit der Benutzer das gew√ºnschte ausw√§hlen kann.  In der FTD2XX-Bibliothek sind die Funktionen <code>FT_CreateDeviceInfoList</code> und <code>FT_GetDeviceInfoDetail</code> f√ºr diesen Zweck vorgesehen.  Wie in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Artikel</a> erl√§utert, k√∂nnen Treiberbibliotheken zur Verwendung der FTD2XX-API verwendet werden.  LabVIEW verf√ºgt √ºber einen praktischen Mechanismus f√ºr die Interaktion mit dynamischen Bibliotheken - den Knoten "Funktionsknoten der Anrufbibliothek" finden Sie in der Palette "Konnektivit√§t -&gt; Bibliotheken und ausf√ºhrbare Dateien".  Der Funktionsaufrufknoten sollte konfiguriert sein: Geben Sie zun√§chst den Pfad zur DLL an (Registerkarte "Funktion"). <code>FT_CreateDeviceInfoList</code> durchsucht das System die Bibliothek und fordert Sie auf, den Funktionsnamen in der Liste "Funktionsname" auszuw√§hlen. <code>FT_CreateDeviceInfoList</code> Sie <code>FT_CreateDeviceInfoList</code> und rufen Sie die Konvention auf <strong>stdcall (WINAPI)</strong> .  Zweitens m√ºssen Sie auf der Registerkarte "Parameter" eine Liste von Funktionsparametern eingeben, wobei das erste Element der Liste der R√ºckgabewert ist.  Hier w√§re es sch√∂n, die Dokumentation f√ºr die API oder die Header-Datei zu beachten.  Beim Einstellen von Parametern im Bereich "Funktionsprototyp" wird der Prototyp der importierten Funktion angezeigt.  Wenn die Signatur aus der Dokumentation mit dem konfigurierten Prototyp √ºbereinstimmt, klicken Sie auf OK. </p><br><p>  Angenommen, das Scannen sollte einmal pro Sekunde durchgef√ºhrt werden.  Wir platzieren den Aufrufknoten in der Struktur des Ereignishandlers auf der Registerkarte "Timeout" und setzen die Wartezeit auf 1000 ms.  Wir f√ºgen Indikatoren zu den Knotenpins hinzu. Wenn alles korrekt ausgef√ºhrt wurde, sollte beim Starten des VIs die Anzahl der mit FTDI verbundenen Ger√§te angezeigt werden: </p><br><div class="spoiler">  <b class="spoiler_title">Frontplatte und Blockschaltbild</b> <div class="spoiler_text"><p> <a href=""><img width="720" src="https://habrastorage.org/webt/sc/pg/fr/scpgfrpwkg3gi5hepnez6b8l_nc.png"></a> <br>  <em>Klickbares Bild</em> </p><br><img src="https://habrastorage.org/webt/v7/cy/fu/v7cyfuon36rdj3wxlwoaotzt_2c.png"></div></div><br><p>  Erstellen Sie auf √§hnliche Weise einen Knoten f√ºr die Funktion <code>FT_GetDeviceInfoDetail</code> .  Der Prototyp der Funktion ist: </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">FTD2XX_API FT_STATUS WINAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FT_GetDeviceInfoDetail</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD dwIndex, LPDWORD lpdwFlags, LPDWORD lpdwType, LPDWORD lpdwID, LPDWORD lpdwLocId, LPVOID lpSerialNumber, LPVOID lpDescription, FT_HAN</span></span></span></span></code> </pre> <br><p>  Bei der Beschreibung der Parameter ist zu beachten, dass <code>lpdwFlags</code> , <code>lpdwType</code> , <code>lpdwID</code> , <code>lpdwLocId</code> als Zeiger auf <code>uint32</code> .  Die Parameter <code>lpSerialNumber</code> und <code>lpDescription</code> sind die Essenz von Byte-Strings ( <code>char</code> Arrays mit einem Null-Terminator).  Parameter dieser Art im Aufrufknoten k√∂nnen auf verschiedene Arten formatiert werden. Sie k√∂nnen sie in ein Array von 8-Bit-W√∂rtern eingeben. Ich halte es jedoch f√ºr am bequemsten, sofort anzuzeigen, dass es sich um eine Zeichenfolge handelt, und die erwartete Gr√∂√üe festzulegen.  In diesem Fall ist die Ausgabe sofort eine g√ºltige ‚ÄûLabyrinth‚Äú -Linie und es sind keine zus√§tzlichen Transformationen erforderlich. </p><br><img src="https://habrastorage.org/webt/zi/n8/8t/zin88t8hl5je5csuxcq7l_bbk9c.png"><br><p>  Bibliotheksfunktion aufrufen </p><br><p>  Diese Funktion gibt Informationen √ºber die <code>dwIndex</code> Seriennummer zur√ºck.  Wenn mehrere FTDIs an den Computer angeschlossen sind, muss die Funktion in einer Schleife aufgerufen werden, um die Informationen f√ºr jeden Konverter zu lesen.  Die Anzahl der Iterationen der Schleife wird uns von der vorherigen Funktion <code>FT_CreateDeviceInfoList</code> . </p><br><div class="spoiler">  <b class="spoiler_title">Frontplatte und Blockschaltbild</b> <div class="spoiler_text"><p> <a href=""><img width="720" src="https://habrastorage.org/webt/sr/2a/gq/sr2agqtusiwcn3tcttwqbncllgk.png"></a> <br>  <em>Klickbares Bild</em> </p><br><img src="https://habrastorage.org/webt/t9/dg/tl/t9dgtlw3lapeklhbi4y3tzca0lm.png"></div></div><br><p>  Es gibt eine unangenehme Eigenschaft: Alle Ports des Anrufknotens m√ºssen mindestens einseitig verbunden sein.  Daher wird in der Schleife ein Tunnel f√ºr die Ausgangsanschl√ºsse erstellt, die wir nicht verwenden werden. </p><br><p>  <code>Types</code> Typ-Array enth√§lt FTDI-Chip-Typen. Wir ben√∂tigen sie, um die Auswahl auf diejenigen zu beschr√§nken, die MPSSE unterst√ºtzen und m√∂glicherweise f√ºr die FPGA-Programmierung verwendet werden k√∂nnen.  Das Arbeiten mit "magischen Zahlen" ist jedoch unpraktisch - ich schlage vor, FTDI-Typen in Form von <code>enum</code> anzuordnen.  Dar√ºber hinaus befindet sich eine solche <code>enum</code> bereits in der Header-Datei ftd2xx.h.  In LabVIEW k√∂nnen Sie zwei Steuerelemente verwenden, um eine Aufz√§hlung zu erstellen: den Textring und die Aufz√§hlung selbst.  Beide enthalten Listen von Zeichenfolgen mit numerischen Werten, zwischen denen Sie wechseln k√∂nnen.  Der Hauptunterschied besteht darin, dass "Aufz√§hlung" erfordert, dass die numerischen Werte ganzzahlige fortlaufende Zahlen sind, w√§hrend der "Textring" mehr Freiheit bietet - Sie k√∂nnen beliebige Werte angeben. </p><br><div class="spoiler">  <b class="spoiler_title">Aufz√§hlung.</b>  <b class="spoiler_title">Sch√∂pfung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v9/ye/ik/v9yeik6iwgvetbpoa2wcf9b0kn8.png"><br><p>  <em>Wir geben die Werte manuell ein, es ist schade, dass es keine Funktion zum Importieren von <code>enum</code> aus C gibt</em> </p><br><img src="https://habrastorage.org/webt/en/jd/4r/enjd4rvd8snxw6fhtstrinlcvey.png"><br><p>  <em>Auf der Vorderseite sieht diese Anzeige so aus</em> </p><br><img src="https://habrastorage.org/webt/yc/t6/er/yct6erqkpta8o-a4mnp7vfbty7w.png"><br><p>  <em>Ausw√§hlen eines Wertes durch Klicken mit der linken Maustaste</em> </p></div></div><br><p>  Um alle zuk√ºnftigen Instanzen der erstellten Liste zu verkn√ºpfen und zu synchronisieren, ist es zweckm√§√üig, "Make Type Def" zu verwenden.  (Auswahl √ºber das Item-Kontextmen√º).  Als Ergebnis wird ein benutzerdefinierter Datentyp erstellt.  Der neue Typ wird in einer separaten Datei mit der Erweiterung * .ctl abgelegt.  Durch Bearbeiten dieser Datei werden alle Instanzen dieses Elements ge√§ndert.  Ich denke, es lohnt sich nicht zu erkl√§ren, wie bequem dies sein kann.  Der Zugriff auf die Definitionsdatei kann √ºber das Kontextmen√º der Instanz erfolgen, indem Sie "Open Type Def" ausw√§hlen. Im selben Men√º sollten Sie die Elemente "Auto-Update from Type Def" beachten.  und "Vom Typ Def trennen". </p><br><p>  Wir √§ndern den <code>FTDI Type</code> Indikator in ein Array von Indikatoren vom <code>FTDI Type</code> Als Ergebnis wird beim <code>FTDI Type</code> des <code>FTDI Type</code> der Typ des angeschlossenen Konverters angezeigt: </p><br><img src="https://habrastorage.org/webt/zy/07/zy/zy07zy2phqs7mc_q8a4hur1hunw.png"><br><p>  <em>Drei Ger√§te gefunden</em> </p><br><p>  Es ist leicht zu bemerken, dass die Funktionalit√§t des resultierenden Codes im Fall "Timeout" vollst√§ndig ist, daher kann er in eine separate SubVI verschoben werden.  W√§hlen Sie die Elemente aus, die auf das Subger√§t √ºbertragen werden sollen, und w√§hlen Sie im Hauptmen√º Bearbeiten die Option "SubVI erstellen". </p><br><div class="spoiler">  <b class="spoiler_title">Blockdiagramm mit erstelltem Unterinstrument</b> <div class="spoiler_text"><p>  Alle Indikatoren blieben erhalten, und anstelle der Anrufknoten wurde ein neues VI mit einem Standardsymbol gebildet. <br> <a href=""><img src="https://habrastorage.org/webt/wz/oo/ba/wzoobavcvisx9kmmntke3m_2pxe.png"></a> <br>  <em>Klickbares Bild</em> </p></div></div><br><p>  Durch Doppelklicken auf das neue SubVI wird das Bearbeitungsfenster ge√∂ffnet.  Zun√§chst speichern wir es und geben einen aussagekr√§ftigen Namen, zum Beispiel "FT_GetDeviceInfo".  Richten Sie E / A-Terminals ein.  Verwenden Sie dazu den Connector-Bereich: </p><br><img src="https://habrastorage.org/webt/1e/fs/gw/1efsgw6lcoaoauj-qguyus4fbn4.png"><br><p>  Das Bedienfeld besteht aus einer Reihe von Anschl√ºssen, die den Bedienelementen und Anzeigen VI entsprechen. </p><br><p>  Wenn Sie auf dem Anschlussfeld ein Terminal ausw√§hlen, wird das entsprechende Element auf dem Bedienfeld hervorgehoben.  Wenn Sie ein leeres Terminal ausw√§hlen und dann auf ein Element auf der Vorderseite klicken, wird das Element an das Terminal angeh√§ngt, sollte jedoch zuvor keinem anderen Terminal zugewiesen werden.  Im Kontextmen√º k√∂nnen Sie die Klemmen einzeln oder f√ºr alle gleichzeitig von den Elementen trennen, Sie k√∂nnen das Muster des Panels als Ganzes √§ndern. </p><br><p>  Mir gef√§llt nicht, wie die Terminals beim Erstellen des aktuellen SubVI zugewiesen wurden, daher w√§hle ich "Alle Terminals trennen" und markiere es manuell.  Ich empfehle, die Eingangsanschl√ºsse links und den Ausgang rechts zu platzieren. Der optionale Eingang kann oben und der optionale Ausgang unten platziert werden.  Dies gew√§hrleistet eine gute Lesbarkeit des Codes und eine gute visuelle Reihenfolge im Blockdiagramm. </p><br><p>  Um Fehler zu kontrollieren, erstellen Sie zwei zus√§tzliche Elemente: <code>Error in</code> und <code>Error out</code> .  Das Thema der Fehlerkontrolle von LabVIEW ist sehr umfangreich und geht √ºber den Rahmen dieses Artikels hinaus. Daher beschr√§nken wir uns auf ein Minimum an Erkl√§rungen und halten uns an das "Do as I" -Prinzip.  Wir erstellen also zwei Terminals f√ºr Fehler - Eingabe und Ausgabe. </p><br><div class="spoiler">  <b class="spoiler_title">Es ist bequem, sie √ºber das Kontextmen√º zu erstellen</b> <div class="spoiler_text"><p>  Klicken Sie mit der rechten Maustaste auf das Fehlerterminal eines beliebigen Knotens: </p><br><img src="https://habrastorage.org/webt/ul/ew/re/ulewre7rct2swn34bhqejv3kg24.png"></div></div><br><p>  In LabVIEW ist es √ºblich, den Eingangsanschluss des Fehlers unten links im Anschlussfeld und den Ausgangsanschluss unten rechts zu platzieren. </p><br><p>  Es ist bequemer, die Ausgabe in einer Struktur zu kombinieren.  F√ºr die Ausgabe werden zwei Arrays erstellt: Das erste Array enth√§lt alle gefundenen FTDI-Ger√§te, das zweite Array enth√§lt nur diejenigen, die MPSSE k√∂nnen und theoretisch zur Konfiguration von FPGAs verwendet werden k√∂nnen. </p><br><p>  Der letzte Schliff beim Erstellen eines Subinstruments ist das Konfigurieren des Symbols.  Durch Doppelklicken auf das Symbol in der oberen rechten Ecke des Fensters wird der Editor gestartet.  Wir versuchen, ein aussagekr√§ftiges Bild zu erstellen, mit dem wir den Zweck des Ger√§ts im Blockdiagramm eindeutig interpretieren k√∂nnen. </p><br><div class="spoiler">  <b class="spoiler_title">FT_GetDeviceInfo.vi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/l1/hy/sd/l1hysdhgshztti7xczw7tjmbex0.png"><br><p>  <em>Frontplatte</em> </p><br><img src="https://habrastorage.org/webt/a4/ba/5w/a4ba5wwquuv-coxuxpxzjo8xwio.png"><br><p>  <em>Blockdiagramm</em> </p><br><p>  Und so sieht der Fall ‚ÄûTimeout‚Äú aus, nachdem die Dinge in Ordnung gebracht wurden: <br> <a href=""><img src="https://habrastorage.org/webt/ea/yu/6d/eayu6ddx32eq_easysclsqqp7pg.png"></a> <br>  <em>Klickbares Bild</em> </p></div></div><br><p>  Bis zu diesem Zeitpunkt war die Dropdown-Liste mit dem Namen "Ger√§t ausw√§hlen" leer, jetzt haben wir die Daten, um sie zu f√ºllen.  Wir erstellen einen Eigenschaftsknoten f√ºr die Liste mit der Eigenschaft "Strings []" (Kontextmen√º -&gt; Erstellen -&gt; Eigenschaftsknoten -&gt; Strings []).  Jede Eigenschaft ist beschreibbar und lesbar. Der aktuelle Modus wird im Kontextmen√º des Eigenschaftsknotens ausgew√§hlt.  Beim Erstellen eines Knotens werden die Eigenschaften standardm√§√üig zum Lesen konfiguriert.  Zum Schreiben √§ndern: "Zum Schreiben √§ndern". </p><br><p>  W√§hlen Sie aus dem Array von Strukturen das Array mit der Beschreibung aus und geben Sie es an <code>Strings[]</code> .  Sie k√∂nnen ein Array mithilfe der <code>For Loop</code> ausw√§hlen. </p><br><p>  Nachdem Sie das VI gestartet haben und die linke Taste am Element "Ger√§t ausw√§hlen" gedr√ºckt haben, k√∂nnen Sie das Ger√§t f√ºr die Konfiguration angeben.  In diesem Fall wird die Liste der Ger√§te zweimal pro Sekunde aktualisiert.  Nat√ºrlich w√§re es m√∂glich, die Eigenschaft nur zu aktualisieren, wenn die Liste aktualisiert wurde, aber bisher f√ºhrt dies zu einer unn√∂tigen Unordnung des Blockdiagramms. </p><br><div class="spoiler">  <b class="spoiler_title">Was ist passiert?</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_t/gh/i7/_tghi7fjgo0hhb6thtdcosvfp1m.png"><br><p>  <em>Frontplatte</em> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/x6/wo/3v/x6wo3v0sqbdvwzhksbg4kghoeho.png"></a> <br>  <em>Klickbares Bild</em> </p><br><p>  Fr√ºher habe ich vergessen, eine so interessante Funktion zu erw√§hnen: Die For-Schleife muss die Anzahl der Iterationen nicht explizit angeben. Es reicht aus, einen Eingabetunnel des Arrays zu erstellen, und die Schleife wird f√ºr jedes Element ausgef√ºhrt. Dieses Verhalten √§hnelt der <strong><code>foreach</code></strong> in C ++ 11.  Sie m√ºssen jedoch vorsichtig sein, wenn mehr als ein Array am Schleifeneingang ankommt. </p></div></div><br><p>  F√ºgen Sie in der Ereignisstruktur einen Handler zum Dr√ºcken der Schaltfl√§che "Programm" hinzu.  Wir haben zwar kein VI, das f√ºr das Laden der Datei in das FPGA verantwortlich ist, aber wir werden ein Subger√§t "stub" machen.  Angenommen, es wird der Pfad zur Konfigurationsdatei und zum FTDI-Deskriptor als Eingabe verwendet und gem√§√ü den Ergebnissen der Operation wird der Firmware-Status zur√ºckgegeben: erfolgreich oder nicht.  Und um es interessanter zu machen, die Programmoberfl√§che zu testen, werden wir diesen Status zuf√§llig machen. </p><br><div class="spoiler">  <b class="spoiler_title">Stub FT_MPSSE_SP_FPGA.vi</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/xl/qf/gyxlqf-hzbjik3667nmzga5bf6g.png"><br><p>  <em>Frontplatte</em> </p><br><img src="https://habrastorage.org/webt/f_/qz/kw/f_qzkwjrp7nqvo9yfgl0o9ovidw.png"><br><p>  <em>Blockdiagramm</em> </p></div></div><br><p>  Wir werden den FTDI-Deskriptor √ºber die Eigenschaft list (Kontextmen√º -&gt; Erstellen -&gt; Eigenschaftsknoten -&gt; Ringtext -&gt; Text) an die Stub-Eingabe √ºbergeben. Um den Dateipfad zum Element "Dateipfad" zu √ºbertragen, erstellen Sie eine lokale Variable (Kontextmen√º -&gt; Erstellen -&gt; Lokal Variable) und setzen Sie es auf read (Change To Read).  Und verbinden Sie den Statusausgang direkt mit der <code>Status</code> .  Die Schaltfl√§che <code>Programm</code> wird in die Ereignisbehandlungsroutine gezogen.  Es wird empfohlen, Elemente, f√ºr die das Ereignis konfiguriert ist, in Handlern zu platzieren. Wenn Sie jetzt auf dieses Element im Bedienfeld doppelklicken, wird nicht nur das entsprechende Element im Blockdiagramm angezeigt, sondern auch der diesem Element zugeordnete Ereignishandler. </p><br><p>  Durch Dr√ºcken der Taste "Programm" wird die Anzeige entweder gr√ºn (Erfolg) oder dunkelgr√ºn (nicht Erfolg).  Nicht zu klar.  √Ñndern Sie in den Indikatoreigenschaften die Farbe "Aus" in Rot.  So ist es besser.  Wenn die Anzeige gr√ºn ist, k√∂nnen wir sagen, dass das FPGA auf dem ausgew√§hlten Ger√§t durch eine Datei konfiguriert wird, deren Pfad im Fenster angezeigt wird: </p><br><img src="https://habrastorage.org/webt/wl/le/re/wllerexz4zkxjzemfyspv_3yyoo.png"><br><p>  <em>Frontplatte</em> </p><br><p>  Diese Aussage wird jedoch falsch, wenn wir die Datei ge√§ndert oder ein anderes Ger√§t ausgew√§hlt haben.  Gleichzeitig k√∂nnen wir den Indikator nicht rot f√§rben, da kein Programmierfehler aufgetreten ist.  Im Falle einer Datei- oder Ger√§te√§nderung ist es zweckm√§√üig zu betonen, dass der Indikatorwert nicht relevant ist - verdunkeln Sie ihn.  Hierzu k√∂nnen Sie die Indikator-Eigenschaft <code>Disabled</code> verwenden.  Diese Eigenschaft kann drei Werte annehmen. <code>Enabled</code> - Bei normaler Anzeige kann der Benutzer das Objekt steuern.  <code>Disabled</code> - Das Objekt wird wie gewohnt auf der Vorderseite angezeigt, der Benutzer kann das Objekt jedoch nicht steuern.  <code>Disabled and Grayed Out</code> - Das Objekt wird auf der Vorderseite dunkel angezeigt, und der Benutzer kann das Objekt nicht steuern. </p><br><p>  Wir erstellen Ereignishandler f√ºr die <code>Devices list</code> und den <code>File Path</code> , verdunkeln in ihnen die Statusanzeige und weisen im Handler der Eigenschaft <code>Enabled</code> Schaltfl√§che "Programm" zu. </p><br><div class="spoiler">  <b class="spoiler_title">Was ist passiert?</b> <div class="spoiler_text"><p> <a href=""><img src="https://habrastorage.org/webt/59/xl/da/59xldabidafiphelnavil1h3iue.png"></a> <br>  <em>"Programm" -Handler: Wert√§nderung.</em> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/i4/xm/sx/i4xmsxdxklfiusfqfamtyqxpoog.png"></a> <br>  <em>Ger√§telisten-Handler: Wert√§nderung</em> </p><br><img src="https://habrastorage.org/webt/w3/58/dn/w358dn13xtxn61o6o5frte7-gsk.png"><br><p>  <em>So sieht die abgedunkelte Anzeige aus</em> </p></div></div><br><p>  Machen wir die Suche nach der Konfigurationsdatei f√ºr den Benutzer bequem - wir konfigurieren das Dateiansichtsfenster.  Gehen Sie zu den Eigenschaften des <code>File Path</code> Elements, geben Sie auf der Registerkarte "Optionen durchsuchen" die Eingabeaufforderung "Musterbezeichnung" ein, geben Sie den Dateitypfilter (Muster) und den Namen f√ºr die Schaltfl√§che (Schaltfl√§chentext) an. </p><br><div class="spoiler">  <b class="spoiler_title">Dateiauswahlfenster</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/vf/i2/yc/vfi2ycpuj_lhydbcp1jebbjb0ni.png"><br><p>  <em>Es werden nur rbf-Dateien angezeigt</em> </p><br><img src="https://habrastorage.org/webt/1-/w3/e8/1-w3e8dg3uauxccfq8-buzrs75y.png"></div></div><br><p>  Das Erstellen einer Benutzeroberfl√§che kann als abgeschlossen betrachtet werden. </p><br><img src="https://habrastorage.org/webt/tm/5w/oq/tm5woq3kwnfgmo38klp_5qxenug.png"><br><p>  <em>Bootloader ausf√ºhren</em> </p><br><h2 id="s-chem-poznakomilis-segodnya">  Was hast du heute getroffen? </h2><br><p>  In diesem Artikel habe ich als Beispiel f√ºr die Erstellung einer funktional vollst√§ndigen Anwendung mit einer minimalistischen Oberfl√§che versucht, verschiedene Ans√§tze f√ºr die Arbeit in LabVIEW aufzuzeigen. </p><br><p>  Infolgedessen haben wir folgende Punkte angesprochen: </p><br><ul><li>  Festlegen der Eigenschaften der virtuellen Appliance.       . </li><li>   :   . </li><li>    . </li><li>  . </li><li>    dll. </li><li>    . </li></ul><br><p>         API FTD2XX   MPSSE.     . </p><br><h2 id="materialy-po-teme">  Verwandte Materialien </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">     USB   FTDI MPSSE</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">labview_mpsse</a> .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   </a> .    </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Software Application Development D2XX Programmer's Guide</a> .   API D2XX. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427529/">https://habr.com/ru/post/de427529/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427519/index.html">@Kubernetes Meetup bei Mail.Ru Group: 29. Oktober und immer</a></li>
<li><a href="../de427521/index.html">Durchbruchspreis 2019. Die Gewinner des Milner, Brin und Zuckerberg Science Award werden bekannt gegeben.</a></li>
<li><a href="../de427523/index.html">Absicherungserfolg</a></li>
<li><a href="../de427525/index.html">Intel Core 9th Gen in Zahlen und Benchmarks</a></li>
<li><a href="../de427527/index.html">10 Tricks f√ºr erweitertes Dashboarding in Splunk. Teil 2</a></li>
<li><a href="../de427531/index.html">Von Sibirien nach Zypern und zur√ºck - die Geschichte eines gescheiterten Auswanderers</a></li>
<li><a href="../de427533/index.html">Smartwatches, die nicht aufgeladen werden m√ºssen. Gibt es viele von ihnen?</a></li>
<li><a href="../de427535/index.html">Wir starten eine kollektive Auswahl an L√∂sungen</a></li>
<li><a href="../de427537/index.html">So werden Sie ein erfolgreicher Produktmanager: Kurse, in denen Sie gerade geschult werden</a></li>
<li><a href="../de427539/index.html">Das letzte Mal in Europa stellt die Uhr f√ºr die Winterzeit ein</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>