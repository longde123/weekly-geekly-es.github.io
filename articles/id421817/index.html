<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚕 🔱 ☎️ Bekerja dengan formulir di React.js menggunakan alat dasar 👸🏽 👨🏼‍🔬 ⚒️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendahuluan 


 Saat mengerjakan React.js, saya sering harus berurusan dengan pemrosesan formulir. Redux-Form , React-Redux-Form melewati tangan saya,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bekerja dengan formulir di React.js menggunakan alat dasar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421817/"><h3>  Pendahuluan </h3><br><p>  Saat mengerjakan React.js, saya sering harus berurusan dengan pemrosesan formulir.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Redux-Form</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">React-Redux-Form</a> melewati tangan saya, tetapi tidak ada satu pun perpustakaan yang benar-benar memuaskan saya.  Saya tidak suka bahwa keadaan formulir disimpan dalam <i>peredam</i> , dan setiap peristiwa melewati <i>pembuat tindakan</i> .  Juga, menurut Dan Abramov, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"keadaan formulir secara inheren fana dan lokal, jadi Anda tidak perlu melacaknya di Redux (atau perpustakaan Flux apa pun)."</a> </p><br><p>  Saya perhatikan bahwa dalam React-Redux-Form ada komponen <b>LocalForm</b> yang memungkinkan Anda untuk bekerja tanpa redux, tetapi menurut pendapat saya, tidak masuk akal untuk menginstal perpustakaan 21.9kB dan menggunakannya kurang dari setengah. </p><br><p>  Saya tidak menentang perpustakaan bernama, dalam kasus tertentu mereka tidak tergantikan.  Misalnya, ketika komponen pihak ketiga yang tidak terkait dengan formulir tergantung pada data yang dimasukkan.  Tetapi dalam artikel saya, saya ingin mempertimbangkan bentuk yang tidak perlu redux. </p><br><p>  Saya mulai menggunakan <i>status</i> komponen lokal, dan kesulitan baru muncul: jumlah kode meningkat, komponen hilang keterbacaan, banyak duplikasi muncul. </p><a name="habracut"></a><br><p>  Solusinya adalah konsep Komponen Orde Tinggi.  Singkatnya, HOC adalah fungsi yang menerima input komponen dan mengembalikannya diperbarui dengan integrasi alat peraga tambahan atau modifikasi.  Baca lebih lanjut tentang HOC di situs web resmi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">React.js</a> .  Tujuan menggunakan konsep HOC adalah untuk membagi komponen menjadi dua bagian, salah satunya akan bertanggung jawab untuk logika, dan yang kedua - untuk tampilan. </p><br><h3>  Pembuatan formulir </h3><br><p>  Sebagai contoh, kami akan membuat formulir umpan balik sederhana di mana akan ada 3 bidang: nama, email, telepon. </p><br><p>  Untuk kesederhanaan, kami menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Create-React-App</a> .  Instal secara global: </p><br><pre><code class="bash hljs">npm i -g create-react-app</code> </pre> <br><p>  kemudian buat aplikasi Anda di folder bentuk murni </p><br><pre> <code class="bash hljs">create-react-app pure-form</code> </pre> <br><p>  Selain itu, instal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tipe-prop</a> dan nama kelas, mereka akan berguna bagi kita di masa depan: </p><br><pre> <code class="bash hljs">npm i prop-types classnames -S</code> </pre> <br><p>  Buat dua folder <i>/ komponen</i> dan <i>/ wadah</i> .  Folder <i>/ components</i> akan berisi semua komponen yang bertanggung jawab untuk tampilan.  Di folder <i>/ container</i> , komponen yang bertanggung jawab untuk logika. </p><br><p>  Di folder <i>/ components</i> , buat file <strong>Input.jsx</strong> di mana kami mendeklarasikan komponen umum untuk semua input.  Adalah penting pada tahap ini untuk tidak lupa meresepkan <strong>ProptTypes</strong> dan <strong>defaultProps dengan</strong> <strong>cara yang</strong> berkualitas, menyediakan kemungkinan untuk menambahkan kelas kustom, dan juga mewarisinya dari PureComponent untuk optimisasi. <br>  Hasilnya adalah: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { PureComponent } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cx <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'classnames'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PropTypes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'prop-types'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Input</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PureComponent</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { name, error, labelClass, inputClass, placeholder, ...props } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{cx(</span></span></span></span><span class="xml"><span class="hljs-tag">'</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">label</span></span></span></span><span class="xml"><span class="hljs-tag">', !!</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">labelClass</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">labelClass</span></span></span></span><span class="xml"><span class="hljs-tag">)} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id-</span></span></span></span><span class="xml"><span class="hljs-tag">${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">}`} &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"span"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{placeholder}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{cx(</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">input</span></span></span></span><span class="xml"><span class="hljs-tag">', !!</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">inputClass</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">inputClass</span></span></span></span><span class="xml"><span class="hljs-tag">, !!</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">' )} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{name}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag">`</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id-</span></span></span></span><span class="xml"><span class="hljs-tag">${</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">}`} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onFocus</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleFocus}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onBlur</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleBlur}</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...props</span></span></span></span><span class="xml"><span class="hljs-tag">} /&gt;</span></span></span><span class="xml"> {!!error &amp;&amp; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"errorText"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{error}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">label</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); } } Input.defaultProps = { type: 'text', error: '', required: false, autoComplete: 'off', labelClass: '', inputClass: '', }; Input.propTypes = { value: PropTypes.string.isRequired, name: PropTypes.string.isRequired, onChange: PropTypes.func.isRequired, placeholder: PropTypes.string.isRequired, error: PropTypes.string, type: PropTypes.string, required: PropTypes.bool, autoComplete: PropTypes.string, labelClass: PropTypes.string, inputClass: PropTypes.string, }; export default Input;</span></span></code> </pre><br><p>  Selanjutnya, di folder <i>/ komponen</i> , buat file <b>Form.jsx</b> , di mana komponen yang berisi formulir akan dideklarasikan.  Kami akan menerima semua metode untuk bekerja dengan itu melalui alat peraga, serta <i>nilai</i> untuk input, jadi <i>negara</i> tidak diperlukan di sini.  Kami mendapatkan: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PropTypes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'prop-types'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Input <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./Input'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FormWrapper <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../containers/FormWrapper'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Form</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ render() { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { username, email, phone }, errors, handleInput, handleSubmit, } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div className="openBill"&gt; &lt;form className="openBillForm" onSubmit={handleSubmit}&gt; &lt;Input key="username" value={username} name="username" onChange={handleInput} placeholder="" error={errors.username} required /&gt; &lt;Input key="phone" value={phone} name="phone" onChange={handleInput} placeholder="" error={errors.phone} required /&gt; &lt;Input key="email" value={email} type="email" name="email" onChange={handleInput} placeholder=" " error={errors.email} required /&gt; &lt;button type="submit" className="submitBtn"&gt;   &lt;/button&gt; &lt;/form&gt; &lt;/div&gt; ); } } Form.propTypes = { data: PropTypes.shape({ username: PropTypes.string.isRequired, phone: PropTypes.string.isRequired, email: PropTypes.string.isRequired, }).isRequired, errors: PropTypes.shape({ username: PropTypes.string.isRequired, phone: PropTypes.string.isRequired, email: PropTypes.string.isRequired, }).isRequired, handleInput: PropTypes.func.isRequired, handleSubmit: PropTypes.func.isRequired, }; export default FormWrapper(Form);</code> </pre><br><h3>  Penciptaan HOC </h3><br><p>  Di folder <i>/ penampung</i> , buat file <b>FormWrapper.jsx</b> .  Kami mendeklarasikan fungsi di dalam, yang mengambil komponen <b>WrappedComponent</b> sebagai argumen dan mengembalikan kelas <b>WrappedForm</b> .  Metode render kelas ini mengembalikan <b>WrappedComponent</b> dengan <b>alat peraga yang</b> diintegrasikan ke dalamnya.  Cobalah untuk menggunakan deklarasi fungsi klasik, ini akan menyederhanakan proses debugging. </p><br><p>  Di kelas <b>WrappedForm,</b> buat <i>status</i> : <i>isFetching</i> - bendera untuk mengendalikan permintaan asinkron, <i>data</i> - objek dengan nilai input, <i>kesalahan</i> - objek untuk menyimpan kesalahan.  <i>Status yang</i> dideklarasikan <b>diteruskan</b> ke <b>WrappedComponent</b> .  Dengan demikian, implementasi penyimpanan negara formulir ke tingkat atas diimplementasikan, yang membuat kode lebih mudah dibaca dan transparan. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Wrapper</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WrappedComponent</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FormWrapper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">isFetching</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">username</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: { <span class="hljs-attr"><span class="hljs-attr">username</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, }, }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">WrappedComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.state</span></span></span></span><span class="xml"><span class="hljs-tag">} /&gt;</span></span></span><span class="xml">; } }; }</span></span></code> </pre><br><p>  Tetapi implementasi seperti itu tidak universal, karena untuk setiap formulir Anda harus membuat bungkus sendiri.  Anda dapat meningkatkan sistem ini dan menanamkan HOC di dalam fungsi lain yang akan membentuk nilai-nilai keadaan awal. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDefaultValues</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState, requiredFields</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Wrapper</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WrappedComponent</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WrappedForm</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ state = { <span class="hljs-attr"><span class="hljs-attr">isFetching</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: initialState, <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: requiredFields, }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">WrappedComponent</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.state</span></span></span></span><span class="xml"><span class="hljs-tag">} {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.props</span></span></span></span><span class="xml"><span class="hljs-tag">} /&gt;</span></span></span><span class="xml">; } }; }; }</span></span></code> </pre><br><p>  Dalam fungsi ini, Anda dapat melewati tidak hanya nilai awal <i>negara</i> , tetapi umumnya semua parameter.  Misalnya, atribut dan metode yang dengannya dimungkinkan untuk membuat formulir di <b>Form.jsx</b> .  Contoh implementasi seperti itu akan menjadi topik untuk artikel selanjutnya. </p><br><p>  Di file <b>Form.jsx, kami</b> mendeklarasikan nilai <i>status</i> awal dan meneruskannya ke HOC: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {    <span class="hljs-attr"><span class="hljs-attr">username</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,    <span class="hljs-attr"><span class="hljs-attr">phone</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,    <span class="hljs-attr"><span class="hljs-attr">email</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> FormWrapper(initialState, initialState)(Form);</code> </pre><br><p>  Mari kita buat metode <i>handleInput</i> untuk memproses nilai yang dimasukkan ke dalam input.  Dia menerima <i>acara</i> dari mana kami mengambil <i>nilai</i> dan <i>nama</i> dan kami mentransfernya ke <i>setState</i> .  Karena nilai input disimpan dalam objek <i>data</i> , <i>kami</i> memanggil fungsi di <i>setState</i> .  Bersamaan dengan menyimpan nilai yang diperoleh, kami nol penyimpanan kesalahan bidang variabel.  Kami mendapatkan: </p><br><pre> <code class="javascript hljs">handleInput = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { value, name } = event.currentTarget; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data, errors }</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { ...data, [name]: value, }, <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: { ...errors, [name]: <span class="hljs-string"><span class="hljs-string">''</span></span>, }, })); };</code> </pre><br><p>  Sekarang kita akan membuat metode <i>handeSubmit</i> untuk memproses formulir dan menampilkan data di konsol, tetapi sebelum itu kita harus melewati validasi.  Kami hanya akan memvalidasi bidang yang wajib diisi, yaitu semua kunci objek this.state.errors.  Kami mendapatkan: </p><br><pre> <code class="javascript hljs">handleSubmit = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> {    e.preventDefault();    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { data } = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state;    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isValid = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(data).reduce( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sum, item</span></span></span><span class="hljs-function">) =&gt;</span></span> sum &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.validate(item, data[item]),    <span class="hljs-literal"><span class="hljs-literal">true</span></span>    ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isValid) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data); } };</code> </pre><br><p>  Menggunakan metode pengurangan, kami memilah-milah semua bidang yang diperlukan.  Pada setiap iterasi, metode <i>validasi</i> dipanggil, di mana kita memberikan sepasang <i>nama</i> , <i>nilai</i> .  Di dalam metode, pemeriksaan dilakukan untuk kebenaran data yang dimasukkan, yang hasilnya mengembalikan tipe Boolean.  Jika setidaknya satu pasangan nilai tidak lulus validasi, maka variabel <i>isValid</i> akan menjadi <i>salah</i> dan data tidak akan ditampilkan ke konsol, mis. Formulir tidak akan diproses.  Kasus sederhana dipertimbangkan di sini - cek untuk formulir yang tidak kosong.  Metode <i>validasi</i> : </p><br><br><pre> <code class="javascript hljs">validate = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, value</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value.trim()) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ errors }</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">errors</span></span>: { ...errors, [name]: <span class="hljs-string"><span class="hljs-string">'    '</span></span>, }, }), () =&gt; <span class="hljs-literal"><span class="hljs-literal">false</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } };</code> </pre><br><p>  Baik metode handleSubmit dan handleInput harus diteruskan ke <i>WrappedComponent</i> : </p><br><pre> <code class="javascript hljs">render() {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (    <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">WrappedComponent</span></span></span></span><span class="xml"><span class="hljs-tag">    {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.state</span></span></span></span><span class="xml"><span class="hljs-tag">}       {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...this.props</span></span></span></span><span class="xml"><span class="hljs-tag">}     </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">handleInput</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleInput}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">handleSubmit</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.handleSubmit}</span></span></span></span><span class="xml"><span class="hljs-tag">    /&gt;</span></span></span><span class="xml"> ); }</span></span></code> </pre><br><p>  Sebagai hasilnya, kami mendapatkan formulir umpan balik siap pakai, dengan validasi sederhana dan output kesalahan.  Pada saat yang sama, kami menghapus bagian logis dari komponen yang bertanggung jawab untuk tampilan. </p><br><h3>  Kesimpulan </h3><br><p>  Jadi, kami melihat contoh dasar pembuatan HOC untuk formulir pemrosesan.  Saat membuat formulir, hanya input sederhana yang digunakan, tanpa elemen kompleks, seperti daftar drop-down, kotak centang, tombol radio, dan lainnya.  Jika tersedia, Anda mungkin harus membuat metode pemrosesan acara tambahan. </p><br><p>  Tulis pertanyaan dan komentar di komentar ke artikel atau ke email saya. <br><br>  Contoh lengkap dapat ditemukan di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bentuk reaksi murni</a> . <br><br></p><p>  Terima kasih atas perhatian anda! </p><p></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id421817/">https://habr.com/ru/post/id421817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id421805/index.html">Pencelupan dalam pengembangan pada Ethereum. Bagian 0: tidak perlu blockchain</a></li>
<li><a href="../id421807/index.html">Ikut serta dalam pengujian publik layanan pencarian kerentanan situs web Positive Technologies</a></li>
<li><a href="../id421809/index.html">API Java EE Concurrency</a></li>
<li><a href="../id421811/index.html">IETF telah mengusulkan standar baru untuk pengiriman pesan - apa yang perlu Anda ketahui</a></li>
<li><a href="../id421815/index.html">Logam cair di laptop enam bulan kemudian</a></li>
<li><a href="../id421819/index.html">Stack ELK untuk menyimpan log aplikasi Django</a></li>
<li><a href="../id421821/index.html">Kami menggunakan mosaik, pikselasi, dan topeng geometri Voronoi di shader untuk menghias situs</a></li>
<li><a href="../id421823/index.html">Bagaimana kami membawa X-Ray x64</a></li>
<li><a href="../id421827/index.html">Apa yang harus dibaca tentang Java sekarang?</a></li>
<li><a href="../id421829/index.html">Anomali Frango - romansa fantastis dengan orang-orang nyata dari IT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>