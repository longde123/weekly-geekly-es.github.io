<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è¨ üôéüèø üõ∞Ô∏è Guide de la liste des interfaces sur MikroTik üì≠ üññüèΩ üõ¢Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Des listes d'interfaces sont apparues dans MikroTik RouterOS depuis longtemps, mais par observation, tout le monde ne les conna√Æt pas et ne les utilis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Guide de la liste des interfaces sur MikroTik</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419327/">  Des listes d'interfaces sont apparues dans MikroTik RouterOS depuis longtemps, mais par observation, tout le monde ne les conna√Æt pas et ne les utilise donc pas. <br><br><h2>  La description </h2><br>  Qu'est-ce qui ressort clairement du nom - Liste des interfaces, identique aux listes d'adresses, uniquement avec les interfaces.  Ne le confondez pas avec les ponts et les interfaces de d√©limitation, ce sont trois technologies diff√©rentes pour des t√¢ches diff√©rentes.  Cette fonctionnalit√© est apparue il y a environ un an et est pr√©sente dans toutes les versions actuelles (actuelles et correctives) de RouterOS 6. <br><br>  La principale chose √† retenir: les interfaces dans les listes restent ind√©pendantes, le trafic ne commencera pas √† les traverser (comme dans le cas du pont) et ne sera pas parall√©lis√© (comme dans le cas de la d√©limitation), c'est ridicule pour vous, mais il y a des sages. <br><a name="habracut"></a><br><h2>  Listes standard </h2><br>  [Interfaces] -&gt; [Liste des interfaces] -&gt; [Listes] <br>  Par d√©faut, il existe trois listes: toutes, aucune, dynamiques.  Avec les deux premiers, tout est clair, la dynamique est actuellement peupl√©e √† partir de certaines connexions ppp et D√©tecter Internet. <br><br>  Option console: <br><br><pre><code class="hljs kotlin">/<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">list</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">print</span></span></span></span></code> </pre> <br>  <b>Cr√©ez votre liste</b> <br>  [Interfaces] -&gt; [Liste des interfaces] -&gt; [Listes] -&gt; [+] <br>  nom - nom <br>  include - inclut les interfaces de la liste sp√©cifi√©e dans la nouvelle liste <br>  exclude - exclut les interfaces de la liste sp√©cifi√©e de la nouvelle liste <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/o8/7u/ei/o87ueiwn9n0infdw2bhp2xx9fla.png"></div><br>  Option console: <br><br><pre> <code class="hljs cs">/<span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">list</span></span> <span class="hljs-title"><span class="hljs-title">add</span></span> <span class="hljs-title"><span class="hljs-title">name</span></span>=test</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Inclure un exemple</b> <div class="spoiler_text">  Les interfaces suivantes sont disponibles pour acc√©der √† Internet: <br>  ether1-wan (v√©ritable ip) <br>  ether2-wan (v√©ritable ip) <br>  l2tp-vpn1 (ip gris) <br>  l2tp-vpn2 (ip gris) <br><br>  √Ä partir des deux premiers, nous attendons des connexions entrantes de l'ext√©rieur, √† partir du second, s'ils le font, alors nous ne sommes pas int√©ress√©s. <br><br>  Les interfaces ether1-wan et ether2-wan sont combin√©es dans une liste de wan.  Lignes vertes. <br><br>  Les interfaces l2tp-vpn1 et l2tp-vpn2 sont combin√©es dans une liste vpn.  Lignes rouges. <br><br>  La liste inet contient (inclut) wan et vpn.  Lignes noires. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hr/v7/yc/hrv7yclcksuwd13nk2pzqcbe7lq.png"></div><br>  Maintenant, dans le pare-feu, vous pouvez diviser le trafic entrant (et passant du c√¥t√© wan / vpn) avec wan et vpn et √©crire des r√®gles distinctes, et le filtre sortant (et passant du c√¥t√© wan / vpn) ensemble (il y aura tr√®s probablement un banal √©tabli, nouveau) via inet . <br><br>  Un exemple est maladroit, mais je n'en ai pas d'autre. <br></div></div><br><h2>  Ajout d'interfaces </h2><br>  Vous pouvez ajouter n'importe quelle interface: ethernet, wlan, bridge, vlan, vpn, vif, ... Tout se fait depuis le menu principal [Listes d'interfaces]. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ts/hf/3o/tshf3op7znm8obwadjr2lmsauqe.png"></div><br>  Option console: <br><br><pre> <code class="hljs cmake">/interface <span class="hljs-keyword"><span class="hljs-keyword">list</span></span> member add interface=ether1 <span class="hljs-keyword"><span class="hljs-keyword">list</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">test</span></span></code> </pre> <br><h2>  Utilisation dans le filtre de pare-feu </h2><br>  L'application principale est de simplifier les r√®gles du pare-feu, disons que vous avez un hub vpn et que vous devez configurer les r√®gles pour le trafic passant, mais soyez aussi clair que possible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oj/0d/nw/oj0dnwl132fwezywphoqywsif_i.png"></div><br>  Avant: <br><br>  V√©rifiez dans l'interface, envoyez √† la cha√Æne-1. <br>  Dans la cha√Æne 1, v√©rifiez l'interface, envoyez √† la cha√Æne 2. <br>  Dans la cha√Æne 2, nous avons √©tabli les r√®gles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/z9/ja/qez9jawzudxpqwsg11hfq8hj8mg.png"></div><br>  Et donc pour chaque interface.  4 connexions - 8 r√®gles, 8 connexions - 16 r√®gles.  Les connexions sont-elles dynamiques?  Vous pouvez sortir et utiliser tous les ppp, les jeter dans chain-1, puis revenir 'vous avez besoin d'interfaces suppl√©mentaires de chain-1. <br><br>  Maintenant: <br><br>  Nous ajoutons toutes les interfaces √† une liste et cr√©ons une r√®gle avec la m√™me liste d'entr√©e d'interface et la liste d'interface de sortie, qui se transf√®re en cha√Ænes avec des r√®gles de filtrage.  Il est devenu nettement plus court. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/my/m3/cemym38bkxwc9gr08bkecjvfcii.png"></div><br>  <i>Il y a un inconv√©nient dans ce sch√©ma, si vous regardez le ¬´plus t√¥t¬ª, alors pour chaque interface, les sous-r√©seaux d'adresses sont attendus sur l'interface, dans le nouveau sch√©ma, vous pouvez conduire toutes les interfaces dans la liste d'adresses, mais les adresses des sous-r√©seaux ne seront plus clairement connect√©es aux interfaces.</i> <br><br>  Un autre exemple est que vous avez plusieurs fournisseurs et que vous √™tes trop paresseux pour dupliquer les r√®gles de chacun: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_t/sz/bx/_tszbx0l1jgo5eenl9ro07by7l8.png"></div><br><h2>  Utilisation dans le pare-feu nat </h2><br>  Lorsque les listes d'interfaces viennent d'appara√Ætre, sur le forum mikrotik s'est plaint du travail des listes d'interfaces en nat, maintenant il semble avoir √©t√© r√©par√©.  J'ai d√©cid√© d'enqu√™ter <br><br>  Banc d'essai: <br><br><img src="https://habrastorage.org/webt/e8/ko/ye/e8koyeez2ohyxyitrjoj9ycdheg.png"><br>  <i>Le sch√©ma n'a pas suffisamment d'adresses pour le m√™me</i> <br><br>  R√©sultats: <br><br>  Cha√Æne src-nat: <br>  * mascarade - fonctionne.  En fonction de l'interface de sortie, remplacez l'ip correspondante. <br>  * src-nat - fonctionne.  Remplace l'adresse IP sp√©cifi√©e uniquement pour l'interface sur laquelle cette adresse IP est pr√©sente. <br>  * m√™me - fonctionne.  De m√™me avec src-nat. <br><br>  Cha√Æne dst-nat: <br><br>  * redirection - fonctionne. <br>  * dst-nat - fonctionne.  Y compris en combinaison avec la mascarade. <br>  * netmap - fonctionne.  Si vous l'utilisez au lieu de dst-nat.  Lorsqu'il est utilis√© comme pr√©vu, il fonctionne √©galement. <br><br><h2>  Utilisation dans le pare-feu mangle </h2><br>  √áa marche.  Par exemple, si vous devez marquer tout le trafic entrant provenant des interfaces pour l'arborescence de files d'attente. <br><br><h2>  Utilisation dans les profils VPN </h2><br>  Nous rappelons un exemple avec vpn r√©gional.  La cinqui√®me r√©gion a √©t√© ajout√©e et vous l'ajoutez manuellement √† la liste des interfaces, mais vous pouvez le faire plus facilement et sp√©cifier dans le profil vpn quelle liste l'interface sera plac√©e lors de la connexion, qu'elle soit contraignante ou cr√©√©e automatiquement lorsque le client d√©connecte l'interface de la liste supprim√©.  Pour le vpn sortant, cela fonctionne √©galement. <br><br>  [PPP] -&gt; [Profils] <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8m/vh/sh/8mvhsh4bgd0y2k0hykyvf2jyywc.png"></div><br>  Tout va bien, mais il y a un bug (au moment de la publication, version RoS 6.42.6).  Si vous avez cr√©√© une liaison et l'avez ajout√©e statiquement √† la liste sp√©cifi√©e dans les profils, la connexion ne sera pas √©tablie.  Dans les journaux (serveur) sera quelque chose comme ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gz/kx/ye/gzkxyeja-4c0hmcbrzkokqbmity.png"></div><br><h2>  Utilisation en bridge </h2><br>  Vous pouvez sp√©cifier la liste des interfaces en tant que membre du pont, mais seules les interfaces capables de travailler sur la couche 2 (ethernet, wlan, bounding, eoip, ovpn-ethernet, ...) seront ajout√©es, √† l'exception des autres ponts. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fl/ne/k2/flnek2nq-wlt7ebooedlaccvxn4.png"></div><br><h2>  D√©tecter Internet </h2><br>  La fonctionnalit√© est apparue dans la version actuelle du firmware et n'est pas encore pr√™te √† l'emploi. <br>  [Interfaces] -&gt; [D√©tecter intranet] <br>  * D√©tecter la liste des interfaces - une liste avec les interfaces sur lesquelles les contr√¥les seront effectu√©s. <br>  * Liste des interfaces LAN - une liste √† laquelle toutes les interfaces couche2 actives sont ajout√©es.  Obtenez le statut LAN. <br>  * Liste des interfaces WAN - une liste √† laquelle toutes les interfaces tunnels lte et vpn sont ajout√©es.  S'interface √©galement avec le statut LAN qui n'a pas de serveur DHCP et √† partir duquel l'adresse 8.8.8.8 est disponible.  En plus de tout, mikrotik ajoutera un client DHCP √† l'interface pour essayer d'obtenir automatiquement les param√®tres. <br>  * Liste des interfaces Internet - une liste des interfaces avec le statut Wan, si cloud.mikrotik.com opin0000 est disponible aupr√®s d'eux.  Rev√©rifiant toutes les minutes, apr√®s 3 tentatives infructueuses, l'interface revient √† l'√©tat Wan.  Modifiez l'adresse de v√©rification, ou les intervalles ne peuvent pas. <br><br>  [Statuts d'interface] - r√©sultats des tests. <br><br>  C'est ainsi que cela devrait fonctionner, mais dans la pratique, les demandes de cloud.mikrotik.com ne sont pas envoy√©es.  Nous attendons et esp√©rons que: ils le r√©pareront;  supprimer les restrictions;  ajouter la possibilit√© d'ex√©cuter des scripts lors du changement de l'√©tat de l'interface. <br><br><div class="spoiler">  <b class="spoiler_title">Cap de spoiler</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/3a/lk/lu/3alkluuy0cepvpkwqbyra0_txus.png"></div></div><br><h2>  Autre </h2><br>  Dans la branche actuelle, MikroTik a d√©cid√© qu'il valait mieux utiliser la liste d'interfaces et maintenant les options suivantes sont configur√©es via des listes d'interfaces, au lieu d'interfaces sp√©cifiques: <br>  * [IP] -&gt; [Voisins] -&gt; [Param√®tres de d√©couverte] <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eu/go/at/eugoatfefz1tapspzq9aaujzlu8.png"></div><br>  * [Outils] -&gt; [MAC-Server] -&gt; [Mac-Telnet Server] &amp; [Mac-Winbox Server] <br><img src="https://habrastorage.org/webt/pf/bx/gr/pfbxgrlkcsrorvbwweyi7png9ps.png"><img src="https://habrastorage.org/webt/nv/jk/cc/nvjkccfj5qcpk_n31qetk2zqo8e.png"><br>  Apr√®s la mise √† niveau, n'oubliez pas de reconfigurer. <br><br><h2>  Scripts et cli </h2><br>  Vous pouvez rencontrer une situation o√π l'une des interfaces de la liste devient inconnue (si vous supprimez l'interface avant de la supprimer de la liste) et je n'ai personnellement pas pu trouver un moyen de supprimer simplement (sans effacer la liste enti√®re et en remplissant) une telle interface √† l'aide de cli et de scripts.  Si quelqu'un sait - √©crivez dans les commentaires. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ra/iy/hh/raiyhhhvhno-5p3troq4-dfflma.png"></div><br>  C‚Äôest tout.  J'esp√®re que dans le monde il y aura moins de configurations avec l'union d'interfaces en bridge afin de r√©duire les r√®gles du pare-feu. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419327/">https://habr.com/ru/post/fr419327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419315/index.html">Dur√©e de vie du moteur apr√®s la mort d'une fus√©e</a></li>
<li><a href="../fr419319/index.html">Comment d√©marrer Istio en utilisant Kubernetes en production. Partie 1</a></li>
<li><a href="../fr419321/index.html">SamsPcbGuide Partie 7: Tra√ßage des lignes de signal Paires diff√©rentielles</a></li>
<li><a href="../fr419323/index.html">Installer Kubernetes sur Hetzner Cloud</a></li>
<li><a href="../fr419325/index.html">Relocaliser un √©tudiant en France</a></li>
<li><a href="../fr419329/index.html">√âv√©nements num√©riques √† Moscou du 6 au 12 ao√ªt</a></li>
<li><a href="../fr419331/index.html">Le Continuum de Haken: un instrument √©lectronique √† r√©activit√© acoustique</a></li>
<li><a href="../fr419333/index.html">Tic Tac Toe sur DNS</a></li>
<li><a href="../fr419335/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 325 (30 juillet - 5 ao√ªt 2018)</a></li>
<li><a href="../fr419339/index.html">Les d√©fis de Boeing et les succ√®s de SpaceX √† la conf√©rence du Groupe consultatif de la s√©curit√© a√©rospatiale</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>