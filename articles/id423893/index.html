<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🔬 🔕 🚎 Hello World untuk menerima data dari perangkat Bluetooth (BLE) melalui C # 🚳 ☄️ ♂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Selamat siang 

 Beberapa minggu yang lalu, saya dihadapkan dengan masalah bahwa tidak ada artikel normal dan modern tentang menerima data dengan Blue...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hello World untuk menerima data dari perangkat Bluetooth (BLE) melalui C #</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423893/">  Selamat siang <br><br>  Beberapa minggu yang lalu, saya dihadapkan dengan masalah bahwa tidak ada artikel normal dan modern tentang <u>menerima data dengan Bluetooth</u> .  Dan saya harus mengotak-atik untuk memahami di mana untuk memulai dan bagaimana melakukannya sama sekali.  Dan agar orang tidak mengulangi kesalahan saya, berikut adalah esai singkat tentang cara melakukan ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2w/rn/sg/2wrnsgxlvrbxisf6_zpf-psqlp0.png"></div><br><a name="habracut"></a><br>  Tapi pertama-tama, beberapa kata-kata menyedihkan, yang umumnya perlu.  Dunia modern semakin tenggelam dalam ideologi Internet segala sesuatu.  Sekarang semuanya berinteraksi satu sama lain, kulkas dengan kompor, setrika dengan penyedot debu, dll.  Banyak kebisingan dinaikkan karena EKG di Apple Watch, tetapi monitor tekanan darah modern, monitor detak jantung, termometer telah lama mampu mengirimkan data melalui Bluetooth.  Dan semua ini entah bagaimana perlu dihubungkan ke satu jaringan.  Dan elemen kunci dalam jaringan ini adalah, apa pun yang dikatakan, komputer.  Dalam hal ini, tugas muncul untuk menerima data dari perangkat tertentu melalui Bluetooth. <br><br>  Untuk memulainya, apa yang sudah kita miliki dan apa yang memperburuk pencarian solusi.  Dan kami memiliki aplikasi yang ditulis dalam <i>.Net Core</i> .  Apa esensi dari aplikasi ini tidak penting, untuk kesederhanaan kami akan menganggap bahwa kami hanya memiliki konsol di <i>.Net Core</i> .  Nah, perangkat itu akan disebut huruf <b>N.</b> <br><br>  Upaya pertama untuk menemukan sesuatu yang berfungsi dengan Bluetooth melalui C # akan mengarah ke pustaka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">32feet</a> . <br><br>  Dalam paket NuGet, sepertinya <i>32feet.NET</i> . <br><br>  Dan dia, omong-omong, dalam edisi produk terbarunya, bahkan menemukan perangkat Bluetooth, tetapi bukan standar BLE [seperti yang ternyata kemudian].  Misalnya, OnePlus 5T yang sama telah dicari secara stabil, tetapi perangkat <b>N yang</b> diperlukan tidak.  Sejalan dengan ini, jawaban resmi penulis ditemukan bahwa perpustakaannya tidak berinteraksi dengan BLE pada prinsipnya, dan tidak ada gunanya mencoba.  Meskipun ada versi awal <i>InTheHand.Devices.Bluetooth</i> pada Github yang seharusnya mendukung BLE, semuanya berubah begitu banyak dan tidak ada dokumentasi sama sekali sehingga bahkan tidak berfungsi untuk menyusun proyek dengan ide-ide yang diambil dari <i>32feet.NET</i> . <br><br>  Penelitian baru membawa saya ke solusi yang lebih standar, yaitu <i>Universal Windows Platform</i> ( <i>UWP</i> ).  Dalam mengembangkan platform ini, <i>Microsoft</i> , yang dianut oleh gagasan fleksibilitas dan aplikasi tunggal untuk komputer dan telepon, mencoba dan melakukan interaksi dengan Bluetooth.  Dan di sini semuanya berjalan dengan baik, tapi ... Kami memiliki proyek di <i>.Net Core</i> ... Dan tidak ada yang bisa dilakukan tentang itu. <br><br>  Saya harus mengatakan <i>segera</i> bahwa itu tidak mungkin untuk menemukan solusi untuk interaksi perpustakaan <i>UWP</i> dengan <i>.Net Core</i> dan proyek harus dialihkan ke <i>4.7.1.</i>  , manfaatnya tidak sulit.  Meskipun ada pemikiran bagaimana meninggalkan proyek di <i>.Net Core</i> dan misalnya membuat layanan Windows terpisah dengan transfer data melalui pipa bernama (pipa bernama) atau meningkatkan layanan <i>WCF</i> dan menjalin interaksi dengannya, tetapi dalam kasus kami itu tidak masuk akal. <br><br><hr><br>  Jadi pada akhirnya kita memiliki sebelum memulai: <br><br><ul><li>  Proyeksikan pada <i>4.7.1.</i> </li><li>  Win10 telah diperbarui ke <i>Versi 10.0.17134 Build 17134.</i> </li></ul><br>  Pertama, Anda perlu menghubungkan beberapa perpustakaan dengan pena, yaitu <br><br><ul><li>  “Windows dari Platform Windows Universal” <br>  <i>C: \ Program Files (x86) \ Windows Kits \ 10 \ UnionMetadata \ 10.0.17134.0 \ Windows.winmd</i> </li><li>  "System.Runtime.WindowsRuntime" <br>  <i>C: \ Program Files (x86) \ Assemblies Referensi \ Microsoft \ Framework \ .NETCore \ v4.5 \ System.Runtime.WindowsRuntime.dll</i> </li></ul><br>  Dan sebenarnya semuanya, maka pekerjaan dengan perangkat itu sendiri melewati dokumentasi tanpa masalah. <br>  Berinteraksi dengan BLE melalui kelas BluetoothLEAdvertisementWatcher <br>  Tetapi kita tidak boleh lupa bahwa tanpa API perangkat itu sendiri, sesuatu yang masuk akal untuk dilakukan tidak akan berfungsi. <br><br>  Berikut ini contoh kode saya tentang cara mendapatkan data dari perangkat. <br><br>  Kode ini dirancang untuk memastikan bahwa perangkat telah ditambahkan (terhubung). <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BluetoothObserver</span></span> { BluetoothLEAdvertisementWatcher Watcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Watcher = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BluetoothLEAdvertisementWatcher() { ScanningMode = BluetoothLEScanningMode.Active }; Watcher.Received += Watcher_Received; Watcher.Stopped += Watcher_Stopped; Watcher.Start(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> isFindDevice { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Watcher_Received</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BluetoothLEAdvertisementWatcher sender, BluetoothLEAdvertisementReceivedEventArgs args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isFindDevice) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (args.Advertisement.LocalName.Contains(<span class="hljs-string"><span class="hljs-string">"deviceName"</span></span>)) { isFindDevice = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; BluetoothLEDevice bluetoothLeDevice = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> BluetoothLEDevice.FromBluetoothAddressAsync(args.BluetoothAddress); GattDeviceServicesResult result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> bluetoothLeDevice.GetGattServicesAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.Status == GattCommunicationStatus.Success) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> services = result.Services; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> services) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!service.Uuid.ToString().StartsWith(<span class="hljs-string"><span class="hljs-string">"serviceName"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } GattCharacteristicsResult characteristicsResult = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> service.GetCharacteristicsAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (characteristicsResult.Status == GattCommunicationStatus.Success) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> characteristics = characteristicsResult.Characteristics; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> characteristic <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> characteristics) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!characteristic.Uuid.ToString().StartsWith(<span class="hljs-string"><span class="hljs-string">"characteristicName"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } GattCharacteristicProperties properties = characteristic.CharacteristicProperties; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (properties.HasFlag(GattCharacteristicProperties.Indicate)) { characteristic.ValueChanged += Characteristic_ValueChanged; GattWriteResult status = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> characteristic.WriteClientCharacteristicConfigurationDescriptorWithResultAsync(GattClientCharacteristicConfigurationDescriptorValue.Indicate); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (properties.HasFlag(GattCharacteristicProperties.Read)) { GattReadResult gattResult = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> characteristic.ReadValueAsync(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gattResult.Status == GattCommunicationStatus.Success) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reader = DataReader.FromBuffer(gattResult.Value); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] input = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[reader.UnconsumedBufferLength]; reader.ReadBytes(input); <span class="hljs-comment"><span class="hljs-comment">// input } } } } } } } } private void Characteristic_ValueChanged(GattCharacteristic sender, GattValueChangedEventArgs args) { var reader = DataReader.FromBuffer(args.CharacteristicValue); byte[] input = new byte[reader.UnconsumedBufferLength]; reader.ReadBytes(input); // input } private void Watcher_Stopped(BluetoothLEAdvertisementWatcher sender, BluetoothLEAdvertisementWatcherStoppedEventArgs args) { ; } }</span></span></code> </pre> <br>  Terima kasih atas perhatian anda </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423893/">https://habr.com/ru/post/id423893/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423879/index.html">Apakah mudah untuk menambahkan fitur baru ke kerangka lama? Pilihan tepung pada contoh pengembangan SObjectizer</a></li>
<li><a href="../id423881/index.html">Apa tukang las untuk optik (bagian dua)</a></li>
<li><a href="../id423885/index.html">Undangan untuk pertunjukan cahaya dan orang dalam kecil dari platform Circle of Light di Moskow</a></li>
<li><a href="../id423889/index.html">Kekecewaan saya pada perangkat lunak</a></li>
<li><a href="../id423891/index.html">Pohon Ekspresi Pengembangan Perusahaan</a></li>
<li><a href="../id423895/index.html">Anda tidak perlu pengacara. Tapi itu tidak pasti</a></li>
<li><a href="../id423897/index.html">Kiat Berguna untuk Menggunakan HyperLynx DDR Wizard untuk Analisis QDR4</a></li>
<li><a href="../id423901/index.html">Saat kecepatan dan penskalaan diperlukan: server perangkat iOS yang didistribusikan</a></li>
<li><a href="../id423903/index.html">Perendaman dalam AD: kami menganalisis serangan lanjutan pada Microsoft Active Directory dan cara mendeteksi mereka</a></li>
<li><a href="../id423905/index.html">Pengembang tetap tidak dikenal. Kuliah Yandex</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>