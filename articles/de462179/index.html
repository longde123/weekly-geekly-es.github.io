<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🤝‍👨🏻 ⛔️ ⛔️ F-Strings oder wie man den Code etwas schneller und lesbarer macht 🖖🏿 👲 🤔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Python bietet drei Möglichkeiten zum Formatieren von Zeichenfolgen. Eine davon ist besser als die anderen. Aber lasst uns nicht weiterkommen - über we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>F-Strings oder wie man den Code etwas schneller und lesbarer macht</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462179/"><img src="https://habrastorage.org/webt/mq/77/12/mq7712kpaxqkzvpwfsor7b6cjbw.jpeg"><br><br>  Python bietet drei Möglichkeiten zum Formatieren von Zeichenfolgen. Eine davon ist besser als die anderen.  Aber lasst uns nicht weiterkommen - über welche Art von Formatierung sprechen wir?  Jedes Mal, wenn wir einen Benutzer mit seinem Namen begrüßen möchten, müssen wir eine Zeichenfolge mit einem Namen in die Vorlagenzeichenfolge einfügen.  Die nützlichsten Protokolleinträge enthalten auch Variablenwerte.  Und hier ist ein Beispiel: <br><br><pre><code class="python hljs">integer = <span class="hljs-number"><span class="hljs-number">42</span></span> string = <span class="hljs-string"><span class="hljs-string">'FORTY_TWO'</span></span> print(<span class="hljs-string"><span class="hljs-string">'string number %s, or simply %d'</span></span> % (string, integer)) print(<span class="hljs-string"><span class="hljs-string">'string number {}, or simply {}'</span></span>.format(string, integer)) print(<span class="hljs-string"><span class="hljs-string">f'string number </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{string}</span></span></span><span class="hljs-string">, or simply </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{integer}</span></span></span><span class="hljs-string">'</span></span>)</code> </pre> <br>  Die erste Methode, die mit dem Operator% formatiert wurde, kam in Python von C - sie ahmt die Funktion printf nach.  Diese Methode war die erste in Python und ist nach wie vor die einzige (im Artikel beschrieben) in Python Version 2.5 und darunter. <br><br>  Der zweite Weg ist die str.format-Methode, die zur integrierten String-Klasse gehört.  Es wurde mit Python 3.0 geliefert und auf Version 2.6 portiert.  Diese Methode wurde mit einer umfassenderen Syntax <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">empfohlen</a> . <br><br>  Die dritte Methode, f-string, wurde in Python Version 3.6 veröffentlicht.  Wie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PEP-0498 erläutert</a> , wurde die Schaffung einer neuen Methode zum Formatieren von Zeichenfolgen durch die Mängel bestehender Methoden motiviert, die die Autoren als fehleranfällig, nicht flexibel genug und nicht elegant charakterisieren: <br><blockquote>  Dieses PEP basiert auf dem Wunsch, Zeichenfolgen in Python einfacher zu formatieren.  Die vorhandenen Formatierungsmethoden sind entweder fehleranfällig, unflexibel oder umständlich. </blockquote>  Wir haben also drei Möglichkeiten, um ein Problem zu lösen.  Aber vielleicht ist dies eine Frage des persönlichen Geschmacks und der Vorlieben?  Vielleicht, aber der Stil Ihres Codes (insbesondere der Code in einem Projekt mit einer großen Anzahl von Teilnehmern) wird definitiv von der Einheitlichkeit profitieren.  Im besten Fall sollten Sie eine Methode zum Formatieren von Zeichenfolgen verwenden, damit das Lesen des Codes einfacher wird.  Aber welche Methode soll man wählen?  Und gibt es einen Unterschied in der Codeleistung? <br><a name="habracut"></a><br>  Versuchen wir, die Frage nach der Leistung experimentell zu beantworten: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> timeit setup = <span class="hljs-string"><span class="hljs-string">""" integer = 42 string = 'FORTY_TWO' """</span></span>.strip() percent_stmt =<span class="hljs-string"><span class="hljs-string">"'Number %s or simply %d' % (string, integer)"</span></span> call_stmt = <span class="hljs-string"><span class="hljs-string">"'Number {} or simply {}'.format(string, integer)"</span></span> fstr_stmt = <span class="hljs-string"><span class="hljs-string">"""f'Number {string} or simply {integer}'"""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">time</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(stmt)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">f"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{timeit.timeit(stmt, setup, number=int(</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">1e7</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)):</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">.3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">f}</span></span></span><span class="hljs-string">"</span></span> print(<span class="hljs-string"><span class="hljs-string">f"Timing percent formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(percent_stmt)}</span></span></span><span class="hljs-string">"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"Timing call formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(call_stmt)}</span></span></span><span class="hljs-string">"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"Timing f-string formating: | </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{time(fstr_stmt)}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre> <br>  Ergebnisse auf MacBook mit Python 3.7: <br><br><pre> <code class="plaintext hljs">Timing percent formating: | 2.025 Timing call formating: | 2.943 Timing f-string formating: | 1.348</code> </pre> <br>  Der Unterschied ist signifikant.  Führen Sie nun die Regex-Suche für ".format" aus und schreiben Sie Hunderte von Ausdrücken neu?  Grundsätzlich ist die Aufgabe einfach, aber zeitaufwändig.  Plus die Chance, einen Fehler zu machen und einen Fehler in den zuvor funktionierenden Code zu setzen!  Es scheint Raum für Automatisierung zu geben.  In der Tat gibt es Bibliotheken, die die meisten Ausdrücke in F-Strings konvertieren können: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">flynt</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">pyupgrade</a> . <br><br>  Flynt ist einfach zu bedienen.  Führen Sie beispielsweise die Konvertierung für den Quellcode des Kolbens aus: <br><br><pre> <code class="plaintext hljs">38f9d3a65222:~ ikkamens$ git clone https://github.com/pallets/flask.git Cloning into 'flask'... ... Resolving deltas: 100% (12203/12203), done. 38f9d3a65222:~ ikkamens$ flynt flask Flynt run has finished. Stats: Execution time: 0.623s Files modified: 18 Expressions transformed: 43 Character count reduction: 241 (0.04%) _-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_. Please run your tests before commiting. Report bugs as github issues at: https://github.com/ikamensh/flynt Thank you for using flynt! Fstringify more projects and recommend it to your colleagues! _-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_._-_. 38f9d3a65222:~ ikkamens$</code> </pre> <br>  Es ist auch erwähnenswert, dass Ausdrücke, die mehrere Zeilen belegen, konvertiert und Statistiken über die vorgenommenen Änderungen gesammelt werden können.  Das Flag --line_length XX definiert die Zeilenlängenbegrenzung nach der Konvertierung.  Mit Flynt können Sie pyupgrade mit dem Flag --upgrade aufrufen. <br><br>  Pyupgrade bietet mehr Funktionen und kann Ihren Code von vielen Python 2-Artefakten bereinigen - z. B. vom Erben von Objekten, Angeben von Klassennamen in Super und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vielem mehr</a> .  Pyupgrade wurde für die Verwendung mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pre-Commit entwickelt</a> , einem Dienstprogramm zum automatischen Ändern von Code vor dem Festschreiben. <br><br>  Es ist besser, die Quelle in eine Gita oder eine andere Versionskontrolle zu konvertieren.  Es lohnt sich, Tests durchzuführen und die Änderungen selbst zu betrachten (unter Verwendung von Git Diff- oder PyCharm-Umgebungen).  Solange wir unter denen leben, die sich darum kümmern, dass der Code ein paar Zeichen kürzer geworden ist, spart eine proaktive Konvertierung auch Zeit.  Schließlich wird früher oder später jemand anfangen, mit seinen Händen zu tun, was zu einem Dienstprogramm gemacht werden kann.  F-Strings funktionieren nur unter Python 3.6+, aber bald wird dies kein Problem mehr sein, da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">andere Versionen veraltet sein werden</a> . <br><br>  Es ist erwähnenswert, dass die klassische .format-Methode nicht vollständig funktioniert.  Wenn Sie dieselbe Vorlage verwenden, um Nachrichten mit unterschiedlichen Variablen an verschiedenen Stellen im Code zu erstellen, sollten Sie diese Vorlage in einer Variablen speichern und verwenden. Das Prinzip „Wiederholen Sie sich nicht“ ist viel wichtiger als das Gewinnen von Nanosekunden nach dem Formatieren einer Zeichenfolge. <br><br>  Schlussfolgerungen: <br><br>  Wir haben uns die drei in Python 3.6+ verfügbaren Formatierungsmethoden für Zeichenfolgen und ihren kurzen Verlauf angesehen und ihre Leistung verglichen.  Wir haben auch die Open-Source-Tools zum automatischen Konvertieren von Code in eine neue Methode zum Formatieren von Zeichenfolgen und ihre zusätzlichen Funktionen untersucht.  Vergessen Sie nicht die einfachen Dinge in Ihrem Code und viel Glück! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462179/">https://habr.com/ru/post/de462179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de462169/index.html">Juli Maschinelles Lernen und künstliche Intelligenz News Digest</a></li>
<li><a href="../de462171/index.html">SCADA-Visualisierung für IoT-Projekte [Free Library]</a></li>
<li><a href="../de462173/index.html">Konferenzen. Zwischenergebnisse für das erste Halbjahr 2019</a></li>
<li><a href="../de462175/index.html">Wir beschäftigen uns mit lateinischen Abkürzungen und Phrasen in Englisch</a></li>
<li><a href="../de462177/index.html">Fototour durch das nach Fersman benannte Mineralogische Museum</a></li>
<li><a href="../de462181/index.html">Regeln für eine effektive Kommunikation in Gruppenchats</a></li>
<li><a href="../de462185/index.html">Die Revolution ist vorbei. Gibt es eine Alternative zu einem Lithium-Ionen-Akku?</a></li>
<li><a href="../de462189/index.html">Ätzen von Daten mit Travajs</a></li>
<li><a href="../de462191/index.html">DataArt Museum: Eine Tour durch Norditalien</a></li>
<li><a href="../de462197/index.html">Tipps, wie Sie Ihren Geist befreien und Ihre Kreativität steigern können</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>