<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕎 🚅 🦇 Profil proyek Persatuan dengan Android Studio 🍼 🖕 ⛴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hari baik untuk semua! Artikel ini adalah tentang cara membuat profil game Unity di Android dengan Android Studio. Saya akan berbicara tentang cara me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profil proyek Persatuan dengan Android Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437602/">  Hari baik untuk semua!  Artikel ini adalah tentang cara membuat profil game Unity di Android dengan Android Studio.  Saya akan berbicara tentang cara mengonfigurasi Android Studio dan mendapatkan jumlah data maksimum.  Masalah analisis dan kesimpulan berdasarkan hasilnya berada di luar ruang lingkup artikel ini. <br><a name="habracut"></a><br><h2>  Persyaratan </h2><br>  Untuk sepenuhnya profil aplikasi, Anda memerlukan ponsel dengan Android 8 atau yang lebih baru (API 27).  Dalam pengalaman, membuat profil dengan versi Android yang lebih lama lebih menantang daripada bagus.  Untuk alasan ini, saya sarankan untuk mendapatkan garis penuh perangkat Nexus, karena mereka memiliki perangkat keras lama dan pembaruan Android terbaru. <br><br><h2>  Menyiapkan proyek Persatuan </h2><br>  Untuk mendapatkan hasilnya, Anda harus mengkonfigurasi proyek Unity dengan cara tertentu. <br><br><h3>  Pengaturan dalam Pengaturan Bangun </h3><br><img src="https://habrastorage.org/webt/av/tr/ju/avtrjuzmsq9xk8egl88e_osxbz4.jpeg" alt="gambar"><br><br><ul><li>  Pertama-tama, Anda harus mengganti <b>Sistem Bangun</b> ke <b>"Gradle"</b> dan centang kotak di sebelah <b>"Ekspor Proyek"</b> .  Dengan demikian, kita akan mendapatkan proyek Android Studio yang sudah jadi, yang akan terus kita profil.  Membuat profil APK yang sudah selesai juga dimungkinkan, tetapi lebih terbatas dan membutuhkan persiapan lebih banyak. </li><li>  Dianjurkan untuk mematikan mode <b>"Pembangunan Pembangunan"</b> , karena waktu yang dihasilkan dalam profiler akan sedekat mungkin dengan yang asli. </li></ul><br><h3>  Pengaturan dalam Pengaturan Player </h3><br><img src="https://habrastorage.org/webt/-7/hz/ho/-7hzhozfm55alhksgs0jozpm488.jpeg" alt="gambar"><br><br><ul><li>  Instal <b>Scripting Backend</b> di <b>IL2CPP</b> .  Jika Anda meninggalkan Mono, maka dengan profil asli kita akan melihat banyak fungsi Mono, tanpa informasi tentang bagaimana mereka berhubungan dengan kode C #. <br></li><li>  Opsi <b>'C ++ Compiler Configuration'</b> untuk Android tidak berpengaruh (dalam Unity 2018.3).  Anda bisa memasukkannya ke dalam 'Release', mungkin di versi mendatang dari Unchain Android toolchain pengaturan ini akan memengaruhi pengaturan compiler. <br></li><li>  Dianjurkan untuk membatasi <b>'Arsitektur Target'</b> ke <b>ARMv7</b> .  Jadi Anda menghemat waktu kompilasi dan mengalami banyak arsitektur terkadang membuat Android Studio dalam keadaan pingsan. <br></li><li>  Anda juga perlu mengatur sejumlah pengaturan tambahan: <ul><li>  Instal Lokasi - 'Lebih suka eksternal' </li><li>  Akses Internet - 'Membutuhkan' </li><li>  Izin Menulis - 'Eksternal (SDCard)' </li></ul><br>  Android Studio dan profiler lain menggunakan simpleperf untuk mengumpulkan statistik, dan itu akan memerlukan akses ke kartu memori untuk merekam file sementara. <br></li></ul><br><h2>  Mempersiapkan Proyek Gradle </h2><br>  Setelah Anda menginstal semua pengaturan, buat proyek Unity.  Anda harus mendapatkan folder dengan proyek Gradle. <br><img src="https://habrastorage.org/webt/vt/qq/fi/vtqqfixujd8ntg_ipoycbp9exwc.jpeg" alt="gambar"><br><br>  Unity default untuk membangun proyek sehingga Anda berencana untuk membangun APK final dari itu.  Karena itu, semua informasi debug telah dihapus darinya, tetapi untungnya itu dapat dikembalikan.  Untuk melakukan ini, Anda perlu mengganti libil2cpp.so dan libunity.so dengan versi dengan informasi debug. <br><br><h3>  libil2cpp.so </h3><br>  Ini adalah file yang berisi semua kode C ++ yang dihasilkan IL2CPP dari kode C # Anda.  Unity menghasilkan semua informasi yang diperlukan untuk profil, tetapi untuk mengoptimalkan ukuran APK, memotongnya selama proses pembangunan.  Untuk mengembalikannya: <br><ul><li>  Buka folder proyek Anda </li><li>  Temukan subfolder <b>Temp</b> di dalamnya dan buka subfolder <b>Temp / StagingArea / simbol / armeabi-v7a</b> </li><li>  Cari <b>'libil2cpp.so.debug'</b> di dalamnya.  Ini adalah versi 'libil2cpp.so' dengan informasi debug. </li><li>  Sekarang pergi ke proyek Gradle dan temukan folder <b>'\ src \ main \ jniLibs \ armeabi-v7a' di dalamnya</b> </li><li>  Ganti <b>'libil2cpp.so' dengan</b> file <b>'libil2cpp.so.debug'</b> </li></ul><br><h3>  libunity.so </h3><br>  Ini adalah file yang berisi bagian Unity Player tingkat rendah.  Karena kami sedang melakukan rilis Rilis, Unity meletakkan file di proyek Anda tanpa informasi debug.  Anda perlu mengganti libunity.so dengan file karakter. <br><br><ul><li>  Buka folder tempat Anda menginstal Unity </li><li>  Buka folder <b>"\ Data \ PlaybackEngines \ AndroidPlayer \ Variations \ il2cpp \ Development \ Libs \ armeabi-v7a \"</b> </li><li>  Ambil file <b>libunity.so</b> dari sana, dan ganti file dalam proyek Anda, yang ada di folder <b>'\ src \ main \ jniLibs \ armeabi-v7a'</b> </li></ul><br><h2>  Pembuatan profil </h2><br>  Sekarang Anda dapat mulai membuat profil di Android Studio, cukup klik tombol start profiler. <br><br><img src="https://habrastorage.org/webt/le/b3/yi/leb3yimardolvn0inirdf0hh-ak.jpeg" alt="gambar"><br><br>  Android Studio meluncurkan aplikasi dan sesi pembuatan profil dimulai <br><br><img src="https://habrastorage.org/webt/q7/jv/na/q7jvnadenwr-9ixtxu-ac7l0exe.jpeg" alt="gambar"><br><br>  Secara default, Android Studio menampilkan grafik, tetapi tidak mengambil sampel data.  Untuk memulai proses, Anda perlu mengklik jalur CPU sehingga profiler beralih ke tampilan CPU.  Dalam hal ini, dropdown dan tombol 'Rekam' akan muncul di atas jendela. <br><br><img src="https://habrastorage.org/webt/_q/1t/qi/_q1tqikjnm-9vqltl3zvwh8t1am.jpeg" alt="gambar"><br><br>  Pilih Sampel 'Asli' (Dalam Android Studio 3.3 - C / C ++ Asli), dan klik tombol 'Rekam'. <br>  Karena perekaman dilakukan pada disk perangkat, sebaiknya jangan merekam lebih dari 5-8 detik dari pengalaman, banyak perangkat juga akan gagal pada jumlah data yang lebih kecil (lihat daftar perangkat yang diuji di akhir artikel). <br><br>  Untuk mendapatkan hasilnya, klik 'Stop' dan kemudian kotak merah untuk menghentikan sesi.  Sulit untuk memahami ide penulis, tetapi jika Anda tidak menghentikan rekaman sepenuhnya, profiler tidak selalu mulai menganalisis data yang diterima dan segmen Anda dengan data akan pergi jauh. <br><br><img src="https://habrastorage.org/webt/nc/s6/wb/ncs6wbzxzmnl2ekezsbeikdalto.jpeg" alt="gambar"><br><br>  Setelah itu, tetap hanya menunggu sedikit, setelah 30-50 detik profiler akan memberi Anda hasilnya.  Jika semuanya diatur dengan benar, Anda akan mendapatkan tangkapan dengan semua nama fungsi <br><br><img src="https://habrastorage.org/webt/ft/ws/9a/ftws9av2ird_wbbvppc3af9smey.jpeg" alt="gambar"><br><br><h2>  Fitur yang Diketahui </h2><br><ul><li>  Hasil paling stabil dapat diperoleh pada perangkat root </li><li>  Jangan gunakan Samsung, dan mereka memiliki banyak bel dan peluit pelindung yang mengganggu proses debug </li><li>  Di banyak tempat, tumpukan kolektif Anda akan masuk ke fungsi dari bentuk 'kernel.kptr + address'.  Ini adalah panggilan di dalam Android Kernel yang dilindungi karena kebijakan keamanan.  Pada perangkat yang di-rooting, perlindungan dapat dinonaktifkan: <br><ul><li>  Jalankan `adb shell` </li><li>  Jalankan `su` untuk mendapatkan hak akses root </li><li>  Jalankan 'sysctl -w kernel.kptr_restrict = 0' - ini akan menghapus perlindungan dari kernel </li><li>  <b>[!]</b> Setelah debugging selesai, jalankan 'sysctl -w kernel.kptr_restrict = 1'.  Beberapa perangkat tidak akan dapat mem-boot OS jika tidak setelah reboot.  Dalam banyak kasus, ini diperlakukan hanya dengan mem-flash core yang bersih. </li></ul></li><li>  Jika Android Studio sering crash, Anda dapat mencoba menambah tumpukan Java VM: <ul><li>  2Gb - untuk proyek berukuran sedang ('-Xmx2g') </li><li>  4Gb - untuk proyek besar ('-Xmx4g') </li></ul></li><li>  Pada perangkat yang tidak di-root, kadang-kadang beralih kernel ke 'mode permisif' meningkatkan situasi. <br><ul><li>  Jalankan perintah 'adb shell setenforce 0' </li></ul></li></ul><br><h2>  Spesifik kesatuan </h2><br><ul><li>  Utas Unity utama disebut UnityMain, tetapi Anda dapat melihat banyak UnityMain saat membuat profil.  Ini adalah utas pengguna yang Anda buat di dalam kode C #.  Secara default, mereka mendapatkan nama yang sama.  Utas utama Unity biasanya mudah dibedakan, karena akan menjadi yang paling banyak dimuat. </li><li>  Aliran grafik disebut UnityGfxWorkerW </li><li>  Utas sistem Unity Job disebut Worker Thread. </li><li>  Sayangnya, beberapa fungsi tunggu yang digunakan Unity (futex), Android Studio menunjukkan dan menganggap bukan sebagai waktu tunggu, tetapi sebagai aktivitas. </li><li>  Saat Anda melihat grafik panggilan dalam tampilan Top Down, Anda harus melewati banyak level dengan panggilan Java, sayangnya Anda tidak dapat memfilternya di Android Studio. </li></ul><br><img src="https://habrastorage.org/webt/f_/it/lp/f_itlpp-dlvolgu5pb-ze7rz4oe.jpeg" alt="gambar"><br><br><h2>  Perangkat yang Direkomendasikan </h2><br>  Kami menggunakan perangkat berikut untuk eksperimen: <br><ul><li>  Samsung Galaxy S8 </li><li>  Google Pixel 2XL </li><li>  Google pixel </li><li>  Sony Xperia XA1 </li><li>  Huawei Honor 7 </li><li>  Huawei Nexus 6P </li><li>  Moto G5P </li><li>  Asus Nexus 7 (2013) </li></ul><br>  Semua perangkat dipasang, untuk Huawei Nexus 6P kami telah mengumpulkan inti dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">AOSP</a> .  Alhasil, Google dan Sony ternyata menjadi yang paling bebas masalah dan mudah dikerjakan.  Sony memiliki situs yang bagus untuk pengembang - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Perangkat Terbuka</a> .  Huawei tidak lagi memungkinkan Anda membuka kunci perangkat dengan cara yang mudah, Samsung menyebabkan kesulitan konstan dengan tingkat perlindungan tambahan.  Moto G5P sering membuat crash proses pengumpulan data profiler (simpleperf). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id437602/">https://habr.com/ru/post/id437602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id437592/index.html">Arsitektur Lapisan Eksekusi Tugas Asinkron</a></li>
<li><a href="../id437594/index.html">Bagaimana saya menghilangkan penyebab kegagapan dan melewatkan bingkai di semua game, dan juga secara tidak sengaja menurunkan suhu hingga 15 derajat</a></li>
<li><a href="../id437596/index.html">OTRS: Otentikasi, otorisasi, dan sinkronisasi LDAP (FreeIPA, AD)</a></li>
<li><a href="../id437598/index.html">Bagaimana cara menyimpan sistem gim dari PC rumahan dengan cara virtualisasi</a></li>
<li><a href="../id437600/index.html">opencv4arts: Gambarkan kotaku, Vincent</a></li>
<li><a href="../id437604/index.html">Runtuhnya fungsi gelombang: algoritma yang terinspirasi oleh mekanika kuantum</a></li>
<li><a href="../id437606/index.html">Siapa yang memakan memori iPhone kita? Mengupas apel</a></li>
<li><a href="../id437610/index.html">[longrid] 20 tahun karir pemrograman di kota kecil besar</a></li>
<li><a href="../id437612/index.html">Raksasa IT itu akan berurusan dengan silikon fotonik - bagaimana hal itu akan mempengaruhi pasar peralatan jaringan</a></li>
<li><a href="../id437614/index.html">Pola Arsitektur Iterator di Swift Universe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>