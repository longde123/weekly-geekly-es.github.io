<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëó üé® üßíüèª Otimizando um rob√¥ de negocia√ß√£o: um algoritmo gen√©tico üëßüèΩ ‚ò∫Ô∏è üè∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em um artigo anterior, comecei a comparar m√©todos de otimiza√ß√£o param√©trica, ou seja, selecionar par√¢metros, avaliar a lucratividade de negociar um ro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otimizando um rob√¥ de negocia√ß√£o: um algoritmo gen√©tico</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430138/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/bz/_0/v9/bz_0v9pphiv-9bi1gtg5b65riy8.png"></a> <br><br>  Em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior,</a> comecei a comparar m√©todos de otimiza√ß√£o param√©trica, ou seja, selecionar par√¢metros, avaliar a lucratividade de negociar um rob√¥ durante o <abbr title="teste do rob√¥ de negocia√ß√£o em dados hist√≥ricos">backtest</abbr> subsequente.  Descobriu-se que o m√©todo banal de Monte Carlo - a gera√ß√£o de combina√ß√µes aleat√≥rias e n√£o correlacionadas de par√¢metros de rob√¥s - funciona muito bem.  Agora, quero testar um algoritmo popular, incluindo um na comunidade de traders de programa√ß√£o: o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">algoritmo de otimiza√ß√£o gen√©tica</a> . <br><a name="habracut"></a><br><h1>  Algoritmo gen√©tico para otimizar uma estrat√©gia de negocia√ß√£o </h1><br>  Vamos considerar esse algoritmo como um exemplo de otimiza√ß√£o de 2 par√¢metros.  Os par√¢metros otimizados do nosso rob√¥ s√£o o per√≠odo da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√©dia m√≥vel</a> e <abbr title="meta de lucro de uma √∫nica transa√ß√£o de rob√¥">TakeProfit</abbr> .  Para uma imers√£o maior na ‚Äúgen√©tica‚Äù, vamos concordar em chamar o per√≠odo da m√©dia m√≥vel de gene respons√°vel pelo ‚Äúcrescimento‚Äù e TakeProfit - o gene da ‚Äúcor dos olhos‚Äù. <br><br>  No espa√ßo de valores de par√¢metros admiss√≠veis, cada ponto, cada par de coordenadas - "altura / cor dos olhos" teoricamente descreve um "indiv√≠duo".  Suponha que criamos aleatoriamente 10 indiv√≠duos.  Este foi o <b>primeiro passo do</b> algoritmo de otimiza√ß√£o gen√©tica - para criar a primeira gera√ß√£o: <br><br><img src="https://habrastorage.org/webt/wo/mx/1s/womx1s6e3gde2yk04asr9rzaqzs.png"><br><br>  No espa√ßo de coordenadas M - T, os pontos s√£o selecionados aleatoriamente.  Por exemplo, dois pontos marcados com uma moldura vermelha s√£o "indiv√≠duos" com nomes neutros em termos de g√™nero (este √© um ponto importante!) Zhenya e Sasha.  O "crescimento" de Sasha (na formula√ß√£o inicial do problema √© o per√≠odo m√©dio m√≥vel) √© de 11 unidades, a "cor dos olhos" √© de 0,6 (olhos verde-azulados).  Zhenya √© um pouco diferente nos par√¢metros.  As mesmas caracter√≠sticas descrevem os 8 indiv√≠duos restantes. <br><br><h2>  <font color="3030cc">O segundo passo √© a reprodu√ß√£o</font> </h2><br>  Desde toda a primeira gera√ß√£o, determinamos um certo n√∫mero de indiv√≠duos com "sucesso".  O crit√©rio, obviamente, √© o valor de <abbr title="fun√ß√£o objetivo (lucro)">CF.</abbr>  Esses indiv√≠duos se reproduzem, formando pares aleatoriamente (por esse motivo, receberam nomes de g√™nero neutro).  Em geral, v√°rias regras podem ser definidas para pares correspondentes.  Por exemplo, para selecionar indiv√≠duos com caracter√≠sticas pr√≥ximas (ou seja, literalmente, mais pr√≥ximas no espa√ßo de coordenadas) dos indiv√≠duos - consanguinidade.  Voc√™ pode, pelo contr√°rio, procurar opostos (consanguinidade).  N√£o consegui encontrar argumentos a favor de uma dessas op√ß√µes - na minha implementa√ß√£o, os pares s√£o formados estritamente por acidente ... Por exemplo, Zhenya e Sasha passaram na qualifica√ß√£o e decidiram dar √† luz um descendente.  O que isso significa em nosso contexto: <br><br><img src="https://habrastorage.org/webt/mv/ad/i9/mvadi9zl8mv_gfhtnhsadcyul20.png"><br><br>  De dois indiv√≠duos "parentais", obtemos o terceiro indiv√≠duo, que herda parte das caracter√≠sticas de um dos pais, parte do outro.  Por exemplo, Zhenya e Sasha deram √† luz uma Nikita individual (Nikita, Nikita?): <br><br><ul><li>  Nikita herdou o sinal "cor dos olhos" (par√¢metro TakeProfit do rob√¥) de um de seus pais - "Zhenya", </li><li>  "Crescimento" (o per√≠odo do rob√¥ com m√©dia m√≥vel) Nikita herdou de "Sasha" ... mas ligeiramente ajustado na dire√ß√£o de outro pai, Zhenya. </li></ul><br>  O fato √© que quanto menor a dimens√£o do espa√ßo de otimiza√ß√£o (no nosso caso, √© igual a 2), mais "pr√≥xima" a prole estar√°.  O algoritmo de otimiza√ß√£o gen√©tica n√£o determina estritamente as regras para a "heran√ßa" de genes para uma filha.  Portanto, aleatoriamente, Nikita emprestou a cor de seus olhos sem nenhuma altera√ß√£o, mas ele ficou no meio entre os dois pais, mais perto de um deles.  Na minha implementa√ß√£o, com o mesmo sucesso, Nikita poderia emprestar os par√¢metros originais de ambos os pais. <br><br><h2>  <font color="3030cc">O terceiro passo √© criar</font> </h2><br>  Motor do processo evolutivo, sele√ß√£o natural.  4 dos 10 melhores indiv√≠duos deram mais 10 descendentes.  Agora temos 20 indiv√≠duos.  O algoritmo de otimiza√ß√£o gen√©tica envolve a manuten√ß√£o de um tamanho populacional constante.  10 indiv√≠duos devem "morrer".  Nesta implementa√ß√£o, a maioria dos indiv√≠duos da primeira gera√ß√£o ‚Äúmorre‚Äù, de 80% a 100%. <br>  Assim, em nosso exemplo, a nova gera√ß√£o ser√° composta de 0 ... 2 pais e 8 - 10 de seus filhos.  Em outras palavras, se voc√™ omitir a letra, os novos vetores dos par√¢metros do rob√¥ de negocia√ß√£o ser√£o calculados a partir dos vetores obtidos na etapa anterior, ‚Äúpropaga√ß√£o‚Äù (combina√ß√£o) dos 4 melhores melhores testes.  A maioria dos ‚Äúidosos‚Äù n√£o aceitar√° participa√ß√£o na nova itera√ß√£o de sele√ß√£o (outras op√ß√µes para implementar a sele√ß√£o s√£o poss√≠veis). <br><br><h2>  <font color="3030cc">Conclus√£o do algoritmo</font> </h2><br>  A reprodu√ß√£o e a sele√ß√£o s√£o repetidas N vezes.  Especificamente, em nosso exemplo, para compara√ß√£o com tr√™s algoritmos testados anteriormente, 4 gera√ß√µes de 10 indiv√≠duos s√£o testadas, totalizando 40 testes. <br>  Mas pode acontecer que outra popula√ß√£o entre em colapso.  Em outras palavras, todos os testes estar√£o pr√≥ximos de v√°rios pontos.  Para evitar essa situa√ß√£o, v√°rios mecanismos s√£o usados, em particular: <br><br><ul><li>  infus√£o de ‚Äúsangue fresco‚Äù na popula√ß√£o.  Aos descendentes da popula√ß√£o atual s√£o adicionados v√°rios novos indiv√≠duos obtidos por acaso, da mesma forma que a popula√ß√£o inicial foi formada, </li><li>  mecanismo de muta√ß√£o: um indiv√≠duo filhote pode ter algumas das caracter√≠sticas (coordenadas) ligeiramente diferentes das caracter√≠sticas de seus pais: </li></ul><br><img src="https://habrastorage.org/webt/zq/me/o7/zqmeo7nqe2qijovrbmhzf7idh14.png"><br><br>  neste exemplo <br><br><ul><li>  as caracter√≠sticas dos descendentes Jane e Joss - ‚Äúcrescimento‚Äù e ‚Äúcor dos olhos‚Äù s√£o emprestadas de cada um dos pais, </li><li>  as caracter√≠sticas dos filhos de Sam e Siri s√£o um pouco diferentes das caracter√≠sticas correspondentes de ambos os pais. </li></ul><br>  Na minha implementa√ß√£o, apesar de muta√ß√µes e ‚Äúindiv√≠duos novos‚Äù, a popula√ß√£o teve que ser atualizada periodicamente como um todo para evitar converg√™ncia prematura, localiza√ß√£o de toda a popula√ß√£o em um espa√ßo limitado. <br><br>  Se retornarmos aos dados originais nos quais testamos os algoritmos de Monte Carlo, a descida do gradiente e o algoritmo com o nome de trabalho "batalha no mar", o processo de otimiza√ß√£o pode ser ilustrado pela seguinte anima√ß√£o: <br><br><img src="https://habrastorage.org/webt/2a/bn/y_/2abny__yrjhqoscv1jzbircputc.gif"><br><br>  Como voc√™ pode ver na anima√ß√£o, a princ√≠pio, a disposi√ß√£o dos pontos √© ca√≥tica, mas, com as gera√ß√µes subsequentes, tende a √°reas com valores mais altos do DF. <br><br>  Agora compare os algoritmos na mesma superf√≠cie: <abbr title="lucro">P</abbr> = f ( <abbr title="per√≠odo m√©dio m√≥vel">M</abbr> , <abbr title="TakeProfit, meta de lucro no neg√≥cio">T</abbr> ): <br><br><img src="https://habrastorage.org/webt/hc/pm/v8/hcpmv86zitukibrq2urge2errz4.png"><br><br><table><tbody><tr><th>  Monte Carlo </th><th>  descida gradiente </th><th>  "Batalha no mar" </th><th>  <font color="3030cc">algoritmo gen√©tico</font> </th></tr><tr><td>  95,7% </td><td>  92,1% </td><td>  97,0% </td><td>  <font color="3030cc">96,8%</font> </td></tr></tbody></table><br>  O valor m√©dio do extremo encontrado da FC como uma porcentagem do valor global. <br><br>  Obviamente, √© muito cedo para julgar por um conjunto de dados de entrada, mas at√© agora o GA, em rela√ß√£o ao nosso rob√¥ de negocia√ß√£o, √© inferior ao algoritmo de "batalha mar√≠tima": <br><br><ul><li>  insignificante - pela m√©dia do valor quase √≥timo encontrado da CF, </li><li>  fornece a pior estimativa da estabilidade param√©trica do algoritmo de negocia√ß√£o, uma vez que n√£o ‚Äúinvestiga‚Äù o ambiente das tuplas de par√¢metro quase √≥timas encontradas com muito poucos detalhes. </li></ul><br><h1>  Teste final de 4 algoritmos de otimiza√ß√£o </h1><br>  O teste final foi realizado em 4 conjuntos de dados de entrada - os resultados do backtest da estrat√©gia de negocia√ß√£o em 4 segmentos diferentes do hist√≥rico de pre√ßos ( <abbr title="Euro para D√≥lar americano">EURUSD</abbr> : 2016, EURUSD: 2017, <abbr title="on√ßa troy de ouro por d√≥lar americano">XAUUSD</abbr> : 2016, XAUUSD: 2017). <br><br><img src="https://habrastorage.org/webt/ko/in/wg/koinwgtirx7wsytk8ilu5ferro0.gif"><br><br>  (exemplos de filtros digitais como fun√ß√µes de <b>dois</b> par√¢metros para 4 s√©ries temporais de pre√ßos) <br><br>  Desta vez, a otimiza√ß√£o foi realizada de acordo com 3 par√¢metros: <br><br><ol><li>  per√≠odo de m√©dia m√≥vel "r√°pida" </li><li>  per√≠odo de m√©dia m√≥vel "lenta" </li><li>  TakeProfit (lucro da transa√ß√£o, em porcentagem, ao atingir o qual a transa√ß√£o foi conclu√≠da). </li></ol><br>  Cada um dos par√¢metros levou 20 valores diferentes.  Total para criar a tabela <br>  P = F (Mf, Senhora, T) <br>  onde P √© o lucro, Mf √© o per√≠odo da m√©dia m√≥vel "r√°pida", Ms √© o per√≠odo da m√©dia m√≥vel "lenta", T √© TakeProfit, <br>  20 * 20 * 20 = 8.000 itera√ß√µes de teste foram realizadas. <br><br>  A otimiza√ß√£o foi realizada com uma restri√ß√£o de 160, 400 e 800 testes (c√°lculos de DF nas coordenadas selecionadas).  Cada vez, os resultados foram calculados para 1.000 itera√ß√µes de otimiza√ß√£o.  O valor m√©dio do DF para o vetor quase √≥timo de par√¢metros encontrado foi: <br><table><tbody><tr><th>  Monte Carlo </th><th>  descida gradiente </th><th>  "Batalha no mar" </th><th>  algoritmo gen√©tico </th></tr><tr><td>  84,1% </td><td>  83,9% </td><td>  77,0% </td><td>  92,6% </td></tr></tbody></table><br>  Separadamente, vale ressaltar que o GA mostra um bom resultado, mesmo com uma pequena porcentagem de testes do n√∫mero total poss√≠vel de op√ß√µes: <br><table><tbody><tr><th>  testes </th><th>  Monte Carlo </th><th>  descida gradiente </th><th>  "Batalha no mar" </th><th>  algoritmo gen√©tico </th></tr><tr><td>  160 de 8.000 </td><td>  79,1% </td><td>  76,7% </td><td>  73,1% </td><td>  87,7% </td></tr><tr><td>  400 de 8.000 </td><td>  84,7% </td><td>  85,0% </td><td>  77,4% </td><td>  93,7% </td></tr><tr><td>  800 de 8.000 </td><td>  88,6% </td><td>  90,1% </td><td>  80,4% </td><td>  96,3% </td></tr></tbody></table><br><h1>  Em vez de uma conclus√£o </h1><br>  Fiquei um pouco surpreso com o resultado, que mostrou um algoritmo de otimiza√ß√£o gen√©tica.  Eu n√£o acho que especificamente o "paradigma gen√©tico" do m√©todo tenha fornecido a ele o primeiro lugar na lista.  Em certo sentido, de acordo com a l√≥gica da escolha das coordenadas, assemelhava-se aos m√©todos de dicotomia / propor√ß√£o √°urea.  Provavelmente vale a pena tentar um desses algoritmos e comparar o GA com ele. <br><br>  Voltando ao rob√¥ comercial, vale a pena observar como o ‚Äúrelevo‚Äù da superf√≠cie formada pelo CF (lucro) muda de ano para ano.  Ou seja, tendo ‚Äúotimizado‚Äù o rob√¥ na hist√≥ria de 2017, <b>n√£o faz sentido aplicar essas configura√ß√µes em 2018</b> (primeiro trimestre, m√™s, semana ... 2018). <br><br>  Estrat√©gias de negocia√ß√£o artificiais, dogm√°ticas e desamparadas como a nossa (comprando no cruzamento da m√©dia m√≥vel) provavelmente n√£o sair√£o de moda em breve.  Infelizmente, eu n√£o tinha outras estrat√©gias.  Assim, atribuo o lucro ou a perda dos rob√¥s de negocia√ß√£o √† sorte, e n√£o √†s vantagens / desvantagens do algoritmo.  Portanto, a tarefa de otimiza√ß√£o param√©trica de um rob√¥ de negocia√ß√£o √© para mim pessoalmente exclusivamente de interesse acad√™mico. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430138/">https://habr.com/ru/post/pt430138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt430126/index.html">Outra lista de projetos para praticar em</a></li>
<li><a href="../pt430128/index.html">Desenvolvimento atrav√©s de testes: aprimorando habilidades</a></li>
<li><a href="../pt430132/index.html">O que aprendemos sobre a seguran√ßa do Intel ME nos √∫ltimos anos: 7 fatos sobre o misterioso subsistema</a></li>
<li><a href="../pt430134/index.html">Algoritmos para otimizar um rob√¥ de negocia√ß√£o: uma maneira eficaz de negociar um milh√£o retroativamente</a></li>
<li><a href="../pt430136/index.html">Como eles v√£o lan√ßar o Starlink - Internet via sat√©lite da Ilona Mask</a></li>
<li><a href="../pt430140/index.html">Cinco raz√µes para o fracasso do SEO. An√°lise da experi√™ncia mal sucedida de promo√ß√£o com exemplos</a></li>
<li><a href="../pt430142/index.html">O seu Windows √© t√£o antigo?</a></li>
<li><a href="../pt430144/index.html">Simulamos um rio realista em Houdini e Unreal Engine 4</a></li>
<li><a href="../pt430146/index.html">A matem√°tica em Gamedev √© simples. Vetores e integrais</a></li>
<li><a href="../pt430148/index.html">Vazamento de dados pessoais dos MFCs de Moscou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>