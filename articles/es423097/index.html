<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèΩ üõãÔ∏è üèùÔ∏è Tareas y soluciones para el luchador PostgreSQL üï∫üèª üò≥ üíà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Saludos a todos los amantes de SQL! 

 En Internet, rara vez vi art√≠culos que cubran diferentes puntos de trabajo y sutilezas asociadas con el proces...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tareas y soluciones para el luchador PostgreSQL</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423097/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/x3/ee/eo/x3eeeo65jv-nyf7mh9ks2dordqg.jpeg"></div><br>  ¬°Saludos a todos los amantes de SQL! <br><br>  En Internet, rara vez vi art√≠culos que cubran diferentes puntos de trabajo y sutilezas asociadas con <b>el procesamiento de datos en SQL</b> . <br>  Me gusta cuando puedes aprender muchas cosas de un art√≠culo a la vez, incluso en t√©rminos generales. <br>  Por lo tanto, decid√≠ escribir mi art√≠culo que conten√≠a varias tareas y respuestas con explicaciones para ellas. <br>  Adecuado para aquellos que han dominado bien todas las habilidades b√°sicas y desean desarrollarse m√°s. <br><br>  Las respuestas proporcionadas son adecuadas para <b>PostgreSQL</b> (la <u>mayor√≠a de las tareas ser√°n adecuadas para otros DBMS</u> , pero los resultados y las soluciones pueden ser diferentes. Incluso es interesante donde surgen las diferencias) <br><br>  <i><u>Intenta responderte</u> antes de abrir el spoiler.</i> <i><br></i> <br>  Vamos! <br><a name="habracut"></a><br><br>  Intentar√© marcar con un asterisco algo puramente para PostgreSQL * (no hay muchos de esos momentos) <br><br><h4>  1. Un poco sobre operaciones num√©ricas </h4><br>  <b>1.1</b> ¬øSe cumplir√°n estas solicitudes?  ¬øQu√© resultados devolver√°n? <br><br><pre><code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">-- )     SELECT 3/2; -- ) SELECT min('- '::TEXT), avg('- '::TEXT); -- )*      FALSE,     ? SELECT 7.2 = (3.8::FLOAT + 3.4) -- ) SELECT (20/25)*25.0;</span></span></code> </pre> <br><br><div class="spoiler">  <b class="spoiler_title">Respuestas a 1.1</b> <div class="spoiler_text">  A) Respuesta: <b>1</b> <br>  Solo se mostrar√° toda la parte, porque  La operaci√≥n utiliza enteros.  Esto a menudo se encuentra en otros idiomas. <br><br>  B) Respuesta: la solicitud <b>no se ejecutar√°</b> . <br><br>  <b>avg</b> dar√° un error desde  acepta solo n√∫meros e intervalos de tiempo * <br><br>  Sin embargo, la funci√≥n <b>min / max</b> se puede ejecutar en datos de texto (de acuerdo con la clasificaci√≥n alfab√©tica en la base de datos). <br>  A veces esto puede ser √∫til cuando necesita al menos mirar una columna que no aparece en <i>GROUP BY</i> <br>  O cuando necesita aplicar la clasificaci√≥n alfab√©tica a los n√∫meros, en los que '10' &lt;'2' <br><br>  B) Respuesta: <b>FALSO</b> <br><br>  Puede parecer extra√±o, pero esto es <u>aceptable</u> , porque  Esta es una caracter√≠stica de una computadora que representa algunos n√∫meros de punto flotante; un n√∫mero puede tomar la forma 7.1 (9) <br>  Recuerdo que una vez trat√© una solicitud durante mucho tiempo sin saberlo. <br><br>  D) Respuesta: <b>0</b> .  El problema es que la expresi√≥n entre par√©ntesis ser√° = 0 <br><br>  SELECCIONAR (20 / 25.0) * 25 funcionar√≠a m√°s correctamente </div></div><br><br>  <b>1.2</b> Dada la tabla " <i>tabla_2</i> " (con una sola columna " <i>valor</i> " (INTEGER)) que consta de las siguientes 5 filas: <br><table border="1" cellpadding="1"><tbody><tr><th width="120">  valor </th></tr><tr><td>  5 5 </td></tr><tr><td>  5 5 </td></tr><tr><td>  Nulo </td></tr><tr><td>  5 5 </td></tr><tr><td>  5 5 </td></tr></tbody></table><br>  Qu√© resultado devolver√° la consulta: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">avg</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)*<span class="hljs-keyword"><span class="hljs-keyword">count</span></span>(*)) - <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> table_2;</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Opciones de respuesta</b> <div class="spoiler_text"><ul><li>  -4 </li><li>  0 0 </li><li>  Nulo </li><li>  5 5 </li><li>  Causar√° un error porque  no especificado GROUP BY </li><li>  Ninguno de los listados </li></ul><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Respuesta 1.2</b> <div class="spoiler_text">  respuesta: <b>5</b> <br><br>  Las funciones agregadas aplicadas a una columna en particular ignoran <i>NULL</i> , sin embargo, count <b>(*) contar√°</b> todas las filas <br>  5 * 5 - 20 </div></div><br><br><h4>  2. Cuestiones generales </h4><br>  <b>2.1</b> ¬øEn qu√© casos puede una consulta devolver no todo el contenido de una tabla?  ( <i>parent_id</i> INTEGER, la tabla se llena con una variedad de datos) <br><br><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> any_table <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> parent_id = parent_id;</code> </pre><br>  ¬øC√≥mo se comportar√° la siguiente solicitud?  ¬øQu√© datos generar√°?  <i>* PostgreSQL</i> <br><br><pre> <code class="sql hljs"> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> any_table <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> parent_id <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> parent_id;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Respuestas a 2.1</b> <div class="spoiler_text">  La primera consulta mostrar√° todas las entradas excepto aquellas donde <i>parent_id</i> es <b>NULL</b> <br><br>  La segunda consulta mostrar√° todas las entradas de la tabla.  <u>IS DISTINCT FROM</u> es l√≥gicamente similar al operador <b>! =</b> En el que NULL es id√©ntico a NULL <br>  <u><b>NO</b> ES DISTINTO DE</u> L√≥gicamente, convierte la desigualdad en igualdad <br></div></div><br>  <b>2.2.</b>  ¬øCu√°l ser√° el resultado de la solicitud? <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">-- ) SELECT * FROM ( SELECT 1 UNION ALL SELECT 1 ) x(y) UNION ( SELECT 2 UNION ALL SELECT 2 );</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Respuesta a 2.2</b> <div class="spoiler_text">  El resultado ser√° 2 filas con los valores <b>1</b> y <b>2</b> , <i>UNION</i> eliminar√° todos los duplicados en la selecci√≥n <u>resultante</u> , y no solo entre las dos tablas unidas.  Not√© que esto no es obvio para todos. </div></div><br>  <b>2.3</b> Escribir una consulta que muestre la fecha de ma√±ana. <br><br><div class="spoiler">  <b class="spoiler_title">Respuesta a 2.3</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">now</span></span>()+ <span class="hljs-built_in"><span class="hljs-built_in">INTERVAL</span></span> <span class="hljs-string"><span class="hljs-string">'1 DAY'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DATE</span></span>)</code> </pre> <br>  No todos a menudo trabajan con fechas, pero vale la pena dominar un m√≠nimo <br>  * Soluci√≥n de Postgres, pero creo que otros DBMS no son muy diferentes <br><br>  Si trabajar con fechas es nuevo para usted, le aconsejo que experimente con la solicitud. <br>  Por ejemplo: <br>  - reemplace DAY con (semana, mes, a√±o, etc.) <br>  - reemplace +1 con -9000 <br>  - reemplazar FECHA con HORA <br>  - eliminar CAST <br>  - dejar solo AHORA () <br>  etc. <br><br>  Y, inspirado por algunos resultados, lea el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">MANUAL</a> , todos los temas all√≠ se describen en detalle <br><br></div></div><br>  <b>2.4</b> Las <b>declaraciones</b> <b>UPDATE</b> , <b>DELETE</b> , <b>INSERT</b> y <b>MERGE est√°n</b> dise√±adas para manipular datos en tablas.  ¬øEs <b>SELECT ..</b> ejecuci√≥n "segura"?  ¬øPuede cualquier consulta afectar los datos en la tabla? <br><div class="spoiler">  <b class="spoiler_title">Respuesta a 2.4</b> <div class="spoiler_text">  La pregunta puede parecer primitiva, sin embargo ... <br><br>  Al principio de aprender SQL, ten√≠a la opini√≥n de que esta declaraci√≥n solo puede mostrar datos, pero: <br><br>  Adem√°s del hecho de que SELECT puede bloquear la tabla para el cambio (BEGIN; SELECT ... FOR UPDATE) * <br>  SELECT puede invocar funciones que pueden realizar casi cualquier manipulaci√≥n. <br><br>  Los principiantes deben entender esto de inmediato, y no despu√©s de completar la solicitud de "peque√±a informaci√≥n" en el servidor de <s>producci√≥n</s> </div></div><br><br><h4>  3. Solo PostgreSQL </h4><br>  <b>3.1</b> Describa lo que sucede cuando esta consulta se ejecuta en el cuadro de di√°logo SQL: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> wtf <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Respuesta a 3.1</b> <div class="spoiler_text">  Normalmente, SELECT INTO se usa en funciones <i>plpgsql</i> para escribir un valor en una variable. <br><br>  Fuera de plpgsql, el efecto del comando ser√° similar a la consulta a continuaci√≥n: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> wtf <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity;</code> </pre> <br></div></div><br>  <b>3.2</b> lo que mostrar√° esta solicitud "simple" <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> wtf_ <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> wtf_ ;</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Respuesta a 3.2</b> <div class="spoiler_text">  Vista del sistema pg_stat_activity (VIEW) de procesos activos en la base de datos. <br><br>  La peculiaridad de la consulta es que se mostrar√° una columna con filas (ROW) con TYPE pg_stat_activity (u otra tabla).  Necesita saber esto antes para aquellos que escriben funciones. Puede leer m√°s en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">manual.</a> <br>  Se agreg√≥ la pregunta porque un principiante puede obtener f√°cilmente ese resultado por error, y no entender lo que ocurre </div></div><br><h4>  4. Trabajar con texto.  Expresiones regulares </h4><br>  Creo que necesita poder no solo crear consultas, sino tambi√©n presentar los resultados de la manera correcta. <br>  Las expresiones regulares son un gran tema aparte, con muchos art√≠culos de calidad.  Por lo tanto, solo mostrar√© ejemplos, sin explicaciones detalladas. <br><br>  <b>4.1.</b>  Supongamos que hay una tabla " <i>tabla_5</i> " con una columna de texto " <i>X</i> " y muchas filas diferentes.  ¬øQu√© consulta puede obtener los √∫ltimos 10 caracteres de cada l√≠nea? <br><br><div class="spoiler">  <b class="spoiler_title">Responder a 4.1</b> <div class="spoiler_text">  SQL le permite encontrar muchas soluciones al mismo problema, por ejemplo: <br>  lo m√°s simple que viene a la mente es lo <b>correcto (X, 10)</b> <br>  regex se puede usar: <b>subcadena (X, '. {0,10} $')</b> <br>  incluso puedes <s>nakostylyat</s> "esquivar" (en todos los sentidos) de esta manera: <b>reverse (substring (reverse (X) for 10))</b> </div></div><br><br>  <b>4.2</b> Hay una tabla "tabla_6" con una columna de texto "X".  La tabla contiene una fila (todo el texto en ingl√©s y ruso solamente): <br><pre> <code class="sql hljs">'Lorem 3 Ipsum 23 standard 7 dummy 17 text Ultimate Answer of Life ?? 777'</code> </pre> <br>  A) Escriba una consulta que devolver√° los caracteres 42 a 68 de esta cadena <br>  B) ¬øC√≥mo extraer solo letras may√∫sculas (ruso o ingl√©s) en una cadena usando SQL? <br>  C) C√≥mo calcular la suma de n√∫meros ( <u>no d√≠gitos</u> ) en una cadena usando SQL <br><br><div class="spoiler">  <b class="spoiler_title">Bosquejo SQL</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> table_6(X) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'Lorem 3 Ipsum 23 standard 7 dummy 17 text Ultimate Answer of Life ?? 777'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> X <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> table_6</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Respuestas a 4.2</b> <div class="spoiler_text"><pre> <code class="sql hljs"> <span class="hljs-comment"><span class="hljs-comment">--    WITH  "SQL " -- ) SELECT SUBSTRING(LEFT(X,68) FROM 42 ) FROM table_6 -- 1  SELECT SUBSTRING(X, 42, (68-42)+1) FROM table_6 -- 2  -- 3    -- )  ,        SELECT regexp_replace(X,'[^A-Z-]', '','g') FROM table_6 --  ''      - --   'g'    1  -- )        --   regexp_matches   **     ,      SELECT sum(x[1]::INT) FROM ( SELECT regexp_matches(X,'[0-9]+','g') FROM table_6 ) AS y(x) -- *        -- **   +,     (   1 ,     )</span></span></code> </pre> </div></div><br><br>  <b>4.3</b> ¬øC√≥mo reemplazar todos los espacios dobles (triples o m√°s) con un solo espacio en el texto (celda de la tabla)?  (por tradici√≥n: la tabla " <i>table_7</i> " con la columna " <i>X</i> ") (PS ser√° suficiente escribir <i>SELECT</i> devolviendo el resultado deseado, y no <i>ACTUALIZAR table_7 ...</i> ) <br><br><div class="spoiler">  <b class="spoiler_title">Respuesta a 4.3</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> table_7(X) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'Lorem 3 Ipsum 23 standard 7 dummy 11 text'</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">TEXT</span></span>) <span class="hljs-comment"><span class="hljs-comment">-- 1 .    (2   ) SELECT regexp_replace(X, '( ){2,}', ' ', 'g') FROM table_7 -- 2 .     (,  ,    ..)   ,      SELECT regexp_replace(X, '\s+', ' ', 'g') FROM table_7 --  !  ,  -    ,    "" .    .. --   ,    , ,        --    ,      ,    SELECT replace(replace(replace(X, ' ', '&lt;&gt;'), '&gt;&lt;', ''), '&lt;&gt;', ' ') FROM table_7</span></span></code> </pre><br></div></div><br>  <b>4.4</b> Hay una cadena " <i>X</i> " en la que se permiten errores tipogr√°ficos.  En lugar de letras rusas (e, o, s, C), se usaron caracteres externos del alfabeto ingl√©s.  Reemplace estos caracteres con SQL. <br><br>  PD La l√≠nea debe contener solo caracteres rusos, y no debe preocuparse por un posible cambio en las palabras en ingl√©s. <br><br>  (Si tiene dificultades para reemplazar todos los personajes, reemplace al menos uno) <br><br>  L√≠nea de ejemplo: <br><br> <code>X = 'Coeo  eoc oe'</code> <br> <br><div class="spoiler">  <b class="spoiler_title">Respuesta a 4.4</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">-- , Replace(Replace(Replace(..  ,  --        (1   1 ) SELECT TRANSLATE('Coeo  eoc oe', 'Cceo', '')</span></span></code> </pre> </div></div><br>  <b>4.5</b> Escribir una consulta que convierta una cadena: <br>  <b>'</b> <b>Ivan Ivanov e Ivanovich'</b> a la especie <b>'Ivan Ivanov</b> <br><br><div class="spoiler">  <b class="spoiler_title">Responda a 4.5</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--  ,     SELECT initcap('  ') *     </span></span></code> </pre></div></div><br><div class="spoiler">  <b class="spoiler_title">B√∫squeda de bonificaci√≥n para aquellos que se las arreglaron</b> <div class="spoiler_text">  <s>Genial si hay una funci√≥n preparada</s> <br>  ¬øSe puede convertir al rev√©s?  (preferiblemente sin perder el relleno). <br>  Quiz√°s la tarea no sea t√≠pica, pero ser√° √∫til para el desarrollo. <br><br>  <b>'IVANOV IVAN IVANOVICH' se</b> convierte en <b>'IVANOV IVAN IVANOVICH'</b> <br>  <s>y caso invertido?</s> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Bonus Challenge Response</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> string_agg(<span class="hljs-keyword"><span class="hljs-keyword">LOWER</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span>(x,<span class="hljs-number"><span class="hljs-number">1</span></span>)) || <span class="hljs-keyword"><span class="hljs-keyword">UPPER</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTRING</span></span>(x <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>)), <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> rn) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> regexp_split_to_table(<span class="hljs-string"><span class="hljs-string">'    4 TesT'</span></span>, <span class="hljs-string"><span class="hljs-string">'\y'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDINALITY</span></span> y(x, rn) ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> z <span class="hljs-comment"><span class="hljs-comment">-- *  PostgreSQL,      --    ,     --      ,      --      . -- WITH ORDINALITY      (   9.4) --      --          -- ..</span></span></code> </pre> </div></div><br><h4>  5. Un poco sobre transacciones </h4><br>  Las transacciones son una cosa muy importante en un DBMS; es importante comprender los puntos principales. <br><br>  Intentar√© simular un ejemplo: <br><br>  Supongamos que hay una tabla "bienes" con la que van a trabajar dos usuarios. <br>  Tiene una columna de <i>descuento</i> entero igual a <u>10</u> para todas las filas. <br>  La configuraci√≥n de la base de datos es est√°ndar (LEER COMPROMETIDO - leer datos confirmados). <br><br>  Usuario <i>Usuario_1</i> abre una transacci√≥n, ejecuta la siguiente solicitud: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> goods <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> discount = discount + <span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre><br>  Un segundo despu√©s, otro usuario ( <i>Usuario_2</i> ) <br>  Realiza casi la misma solicitud sin abrir una transacci√≥n: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> goods <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> discount = discount + <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><br>  ¬øQu√© crees que pasar√° en las siguientes situaciones: <br><br>  <b>A)</b> ¬øQu√© resultado obtendr√° el Usuario_2 si el Usuario_1 deja la transacci√≥n abierta (es decir, no confirma la transacci√≥n / no revierte los cambios)? <br>  Lo que ver√° User_1 a petici√≥n: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> discount <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> goods <span class="hljs-keyword"><span class="hljs-keyword">LIMIT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre> <br>  <b>B)</b> ¬øQu√© sucede si el Usuario_1 hace ROLLBACK?  ¬øQu√© resultados obtendr√° User_2? <br><br>  <b>P)</b> ¬øQu√© sucede si el Usuario_1 se COMPROMETE?  ¬øQu√© resultados obtendr√° User_2? <br><br><div class="spoiler">  <b class="spoiler_title">Las respuestas</b> <div class="spoiler_text">  Hasta donde yo s√©, READ <b>UN</b> COMMITTED no es compatible con PostgreSQL, y los datos sucios (no confirmados) no se pueden leer <br><br>  Las respuestas ser√°n las siguientes: <br><br>  A) Solicitud El <u>usuario_2</u> esperar√° por COMPROMISO o ROLLBACK del Usuario_1.  (la solicitud parece congelarse) <br>  <u>El usuario_1</u> en su transacci√≥n ver√° su versi√≥n de la instant√°nea de la base de datos, donde el <i>descuento</i> ya <i>es</i> igual a <b>15</b> <br><br>  B) Si el Usuario_1 hace ROLLBACK, entonces el valor del <i>descuento</i> seguir√° siendo el mismo, y luego se ejecutar√° el Usuario_2, que agregar√° 10 al <i>descuento</i> y el descuento ser√° <b>20</b> <br><br>  C) Si el Usuario_1 se COMPROMETE, el valor del <i>descuento</i> aumentar√° en 5, y luego se ejecutar√° el Usuario_2, que agregar√° 10 al <i>descuento</i> y el descuento ser√° <b>25</b> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Otra versi√≥n de esta tarea.</b> <div class="spoiler_text">  Una versi√≥n ligeramente diferente de la tarea 13 del usuario <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">kirill_petrov</a> en READ COMMITTED <br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--      CREATE TABLE goods (discount) AS (SELECT 10::INT UNION ALL SELECT 15); -- 1. User_1   (  ): BEGIN; UPDATE goods SET discount = discount + 5; --2. User_2  : UPDATE goods SET discount = discount + 100 WHERE discount = 15 --3. User_1  COMMIT;</span></span></code> </pre>  ¬øQu√© datos habr√° en la tabla? <br></div></div><br><h4>  Conclusi√≥n </h4><br>  Creo que eso toc√≥ puntos bastante interesantes. <br><br>  Espero que las tareas ayuden a motivar a los principiantes, porque es aburrido aprender algo sin metas / objetivos / direcciones espec√≠ficas. <br><br>  Puedo alegrarme por aquellos que fueron f√°ciles de responder a todas las preguntas.  Y aquellos que tuvieron dificultades, espero, obtuvieron una <s>patada en la</s> direcci√≥n del desarrollo.  Aquellos que no entienden mucho, pero quieren aprender SQL, invito al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">curso de j√≥venes luchadores de PostgreSQL</a> a mi √∫ltimo art√≠culo. <br><br>  Espero cualquier adici√≥n, soluci√≥n a problemas especialmente interesantes (puede minar) y otros comentarios. <br><br>  Gracias por su atencion!  ¬°Te deseo √©xito en aprender SQL! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es423097/">https://habr.com/ru/post/es423097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es423087/index.html">No me empujes en el ojo</a></li>
<li><a href="../es423089/index.html">Programadores en MBLT DEV 2018</a></li>
<li><a href="../es423091/index.html">Flutter para desarrolladores de Android. C√≥mo crear una interfaz de usuario para una actividad usando Flutter</a></li>
<li><a href="../es423093/index.html">Aumentamos la aleatoriedad del hecho de que [probablemente] [casi] por accidente</a></li>
<li><a href="../es423095/index.html">Novedades en la presentaci√≥n de Apple</a></li>
<li><a href="../es423101/index.html">Implementaci√≥n de almacenamiento LINSTOR para Proxmox</a></li>
<li><a href="../es423103/index.html">Podcasts de Python: eso es todo lo que hemos encontrado</a></li>
<li><a href="../es423105/index.html">System.IO.Pipelines: IO de alto rendimiento en .NET</a></li>
<li><a href="../es423107/index.html">Te invitamos a la reuni√≥n Go in Production</a></li>
<li><a href="../es423109/index.html">Qu√© present√≥ Apple y qu√© piensan los desarrolladores de iOS al respecto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>