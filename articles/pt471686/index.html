<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉ üõÄüèª üê≤ Como a AWS fabrica seus servi√ßos resilientes. Escala de servidor e banco de dados üòî üßòüèø üõ©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As nuvens s√£o como uma caixa m√°gica - voc√™ pergunta o que precisa e os recursos aparecem do nada. M√°quinas virtuais, bancos de dados, uma rede - tudo ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como a AWS fabrica seus servi√ßos resilientes. Escala de servidor e banco de dados</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/471686/"> As nuvens s√£o como uma caixa m√°gica - voc√™ pergunta o que precisa e os recursos aparecem do nada.  M√°quinas virtuais, bancos de dados, uma rede - tudo isso pertence apenas a voc√™.  Existem outros inquilinos da nuvem, mas em seu universo voc√™ √© o √∫nico governante.  Voc√™ tem certeza de que sempre receber√° os recursos necess√°rios, n√£o conta com ningu√©m e determina independentemente qual ser√° a rede.  Como √© essa m√°gica que faz a nuvem alocar recursos elasticamente e isolar completamente os inquilinos um do outro? <br><br><img src="https://habrastorage.org/webt/95/t7/1o/95t71ogmxhqysjnhwbqd_nbj4tk.jpeg"><br><br>  O AWS Cloud √© um sistema mega sofisticado que evolui desde 2006.  Parte desse desenvolvimento foi encontrada por <strong>Vasily Pantyukhin</strong> , arquiteta do Amazon Web Services.  Como arquiteto, ele v√™ de dentro n√£o apenas o resultado final, mas tamb√©m os desafios que a AWS supera.  Quanto mais compreens√£o do sistema, mais confian√ßa.  Portanto, Vasily compartilhar√° os segredos dos servi√ßos em nuvem da AWS.  Sob o corte est√° o dispositivo para servidores f√≠sicos da AWS, escalabilidade flex√≠vel do banco de dados, um banco de dados personalizado da Amazon e m√©todos para melhorar o desempenho das m√°quinas virtuais e reduzir seu pre√ßo.  O conhecimento das abordagens arquitet√¥nicas da Amazon ajudar√° voc√™ a usar melhor os servi√ßos da AWS e poder√° fornecer novas id√©ias para criar suas pr√≥prias solu√ß√µes. <br><a name="habracut"></a><br>  <i>Sobre o palestrante: Vasily Pantyukhin ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Hen</a> ) come√ßou como administradora do Unix in.ru, passou 6 anos trabalhando em grandes gl√¢ndulas da Sun Microsystem e, por 11 anos, pregou a centralidade de dados do mundo na EMC.</i>  <i>Evoluiu naturalmente para nuvens privadas e, em 2017, se transformou em nuvens p√∫blicas.</i>  <i>Agora, com dicas t√©cnicas, ele ajuda a viver e se desenvolver na nuvem da AWS.</i> <i><br><br></i>  <i>Isen√ß√£o de responsabilidade: tudo abaixo √© da opini√£o pessoal de Vasily e pode n√£o coincidir com a posi√ß√£o da Amazon Web Services.</i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um v√≠deo do</a> relat√≥rio com base no qual o artigo foi criado est√° dispon√≠vel em nosso canal do YouTube.</i> <br><br><h2>  Por que estou falando de um dispositivo Amazon </h2><br>  Meu primeiro carro foi com uma "al√ßa" - em uma caixa de c√¢mbio manual.  Foi √≥timo devido √† sensa√ß√£o de que eu podia controlar a m√°quina e control√°-la completamente.  Tamb√©m gostei de entender pelo menos o princ√≠pio do trabalho dela.  Naturalmente, imaginei o dispositivo da caixa bastante primitivo - mais ou menos como uma caixa de c√¢mbio em uma bicicleta. <br><br><img src="https://habrastorage.org/webt/t-/zx/uz/t-zxuzgpa2gj26bmpgbe1gj_zd0.jpeg"><br><br>  Tudo foi maravilhoso, exceto por uma coisa - parado em engarrafamentos.  Parece que voc√™ est√° sentado e n√£o est√° fazendo nada, mas muda constantemente de marcha, pressiona a embreagem, acelera, freia - voc√™ realmente se cansa disso.  O problema dos engarrafamentos foi parcialmente resolvido quando uma m√°quina apareceu na m√°quina na fam√≠lia.  Ao volante, havia tempo para pensar em algo, ouvir um audiolivro. <br><br>  Um mist√©rio apareceu em minha vida, porque geralmente deixava de entender como meu carro funciona.  Um carro moderno √© um dispositivo complexo.  O carro se adapta simultaneamente a dezenas de par√¢metros diferentes: pressionando o acelerador, freio, estilo de dire√ß√£o e qualidade da estrada.  N√£o entendo mais como isso funciona. <br><br>  Quando comecei a fazer o Amazon Cloud, isso tamb√©m foi um mist√©rio para mim.  Somente esse segredo √© uma ordem de magnitude maior, porque h√° um motorista no carro e h√° milh√µes na AWS.  Todos os usu√°rios dirigem simultaneamente, pressionam o acelerador e o freio.  √â incr√≠vel que eles v√£o aonde querem - para mim √© um milagre!  O sistema se adapta automaticamente, dimensiona e se ajusta de maneira flex√≠vel a cada usu√°rio, para que pare√ßa que ele est√° sozinho neste universo. <br><br>  A m√°gica se dissipou um pouco quando, mais tarde, fui trabalhar como arquiteto na Amazon.  Vi quais problemas estamos enfrentando, como os resolvemos, como desenvolvemos servi√ßos.  Com um aumento no entendimento do sistema, h√° mais confian√ßa no servi√ßo.  Ent√£o, quero compartilhar uma imagem do que est√° por tr√°s da nuvem da AWS. <br><br><h2>  Sobre o que falaremos </h2><br>  Eu escolhi uma abordagem diversificada - selecionei 4 servi√ßos interessantes que merecem ser discutidos. <br><br>  <strong>Otimiza√ß√£o do servidor</strong> .  Nuvens ef√™meras com uma incorpora√ß√£o f√≠sica: data centers f√≠sicos, onde existem servidores f√≠sicos que est√£o vibrando, aquecendo e piscando l√¢mpadas. <br><br>  <strong>As fun√ß√µes sem servidor</strong> (Lambda) s√£o provavelmente o servi√ßo mais escal√°vel na nuvem. <br><br>  <strong>Escala de banco de dados</strong> .  Falarei sobre como criamos nossos pr√≥prios bancos de dados escal√°veis. <br><br>  <strong>Escala de rede</strong> .  A √∫ltima parte em que vou abrir o dispositivo da nossa rede.  Isso √© uma coisa maravilhosa - cada usu√°rio da nuvem acredita que est√° sozinho na nuvem e n√£o v√™ outros inquilinos. <br><br><blockquote>  <i>Nota</i>  <i>Este artigo se concentrar√° na otimiza√ß√£o do servidor e no dimensionamento do banco de dados.</i>  <i>O dimensionamento da rede ser√° discutido no pr√≥ximo artigo.</i>  <i>Onde est√£o as fun√ß√µes sem servidor?</i>  <i>Uma transcri√ß√£o separada saiu sobre eles: ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mal, sim, ousada.</a></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anboxing de microvirtuais do Firecracker</a> . "</i>  <i>Ele fala sobre v√°rias maneiras diferentes de dimensionar, e a solu√ß√£o Firecracker √© analisada em detalhes - uma simbiose das melhores qualidades de uma m√°quina virtual e cont√™ineres.</i> </blockquote><br><h2>  Servidores </h2><br>  A nuvem √© ef√™mera.  Mas essa efemeridade ainda tem uma personifica√ß√£o f√≠sica - servidores.  Inicialmente, sua arquitetura era cl√°ssica.  Chipset x86 padr√£o, placas de rede, Linux, hipervisor Xen, que executa m√°quinas virtuais. <br><br><img src="https://habrastorage.org/webt/hb/vt/ez/hbvtezxs1wc_ilzrlcorvx9qy4m.jpeg"><br><br>  Em 2012, essa arquitetura fez seu trabalho bem.  Xen √© um √≥timo hipervisor, mas com uma grande falha.  Ele tem uma <strong>sobrecarga</strong> bastante <strong>alta para emular dispositivos</strong> .  Com o advento de novas placas de rede ou SSDs mais r√°pidos, essas sobrecargas se tornam muito altas.  Como lidar com este problema?  Decidimos trabalhar em duas frentes ao mesmo tempo - para <strong>otimizar o hardware e o hipervisor</strong> .  A tarefa √© muito s√©ria. <br><br><h3>  Otimiza√ß√£o de ferro e hipervisor </h3><br>  Fazer tudo de uma vez e bem n√£o funcionar√°.  O que √© "bom" era inicialmente incompreens√≠vel. <br><blockquote>  Decidimos aplicar uma abordagem evolutiva - mudamos um elemento importante da arquitetura e o lan√ßamos em produ√ß√£o. </blockquote>  N√≥s pisamos em todos os ancinhos, ouvimos reclama√ß√µes e sugest√µes.  Ent√£o n√≥s mudamos outro componente.  Assim, em pequenos incrementos, alteramos radicalmente toda a arquitetura com base no feedback e no suporte do usu√°rio. <br><br>  A transforma√ß√£o come√ßou em 2013 com a coisa mais dif√≠cil - a rede.  Nas inst√¢ncias <strong>C3</strong> , uma placa especial do Network Accelerator foi adicionada √† placa de rede padr√£o.  Ele foi conectado com um cabo de loopback literalmente curto no painel frontal.  Feio, mas n√£o vis√≠vel na nuvem.  Mas a intera√ß√£o direta com o hardware melhorou fundamentalmente a instabilidade e a largura de banda da rede. <br><br>  Decidimos focar na melhoria do acesso ao armazenamento em bloco do EBS - Elastic Block Storage.  Essa √© uma combina√ß√£o de rede e armazenamento.  A dificuldade √© que, se as placas do Network Accelerator existiam no mercado, n√£o havia como comprar apenas o hardware do Storage Accelerator.  Portanto, nos voltamos para a startup <strong>Annapurna Labs</strong> , que desenvolveu chips ASIC especiais para n√≥s.  Eles permitiram conectar volumes EBS remotos como dispositivos NVMe. <br><br>  Nos casos <strong>C4</strong> , resolvemos dois problemas.  Primeiro, implementamos as bases para o futuro com a tecnologia NVMe promissora, mas nova na √©poca.  O segundo - descarregou significativamente o processador central, transferindo o processamento de solicita√ß√µes para o EBS para um novo cart√£o.  Acabou bem, agora o Annapurna Labs faz parte da Amazon. <br><br>  Em novembro de 2017, percebemos que era hora de mudar o hypervisor em si. <br><blockquote>  O novo hypervisor foi desenvolvido com base nos m√≥dulos do kernel KVM modificados. </blockquote>  Isso permitiu reduzir fundamentalmente os custos indiretos da emula√ß√£o de dispositivos e trabalhar diretamente com os novos ASICs.  <strong>As</strong> inst√¢ncias <strong>C5</strong> foram as primeiras m√°quinas virtuais sob as quais um novo hipervisor est√° sendo executado.  N√≥s chamamos de <strong>Nitro</strong> . <br><br><img src="https://habrastorage.org/webt/g6/x2/ri/g6x2rizybxczhu-ikt1pfulnpb0.jpeg">  <em>A evolu√ß√£o das inst√¢ncias na linha do tempo.</em> <br><br>  Todos os novos tipos de m√°quinas virtuais que apareceram desde novembro de 2017 funcionam neste hipervisor.  <strong>As inst√¢ncias do Iron Bare Metal n√£o t√™m um hypervisor</strong> , mas tamb√©m s√£o chamadas de Nitro, pois usam placas Nitro especializadas. <br><br>  Nos dois anos seguintes, o n√∫mero de tipos de inst√¢ncias do Nitro excedeu algumas d√∫zias: A1, C5, M5, T3 e outras. <br><br><img src="https://habrastorage.org/webt/vw/zf/as/vwzfasdjwxuuykoylco9bnmgqki.jpeg"><br>  <em>Tipos de inst√¢ncias.</em> <br><br><h3>  Como funcionam os carros nitro modernos </h3><br>  Eles t√™m tr√™s componentes principais: um hipervisor Nitro (discutido acima), um chip de seguran√ßa e placas Nitro. <br><br>  <strong>O chip de seguran√ßa √©</strong> integrado diretamente na placa-m√£e.  Ele controla muitas fun√ß√µes importantes, por exemplo, controlando o carregamento do SO host. <br><br>  <strong>Cart√µes Nitro</strong> - existem quatro tipos deles.  Todos s√£o desenvolvidos pela Annapurna Labs e s√£o baseados em ASICs comuns.  Parte de seu firmware tamb√©m √© comum. <br><br><img src="https://habrastorage.org/webt/fy/pf/pj/fypfpj1r-mpklkd-8ltiz-frjnc.jpeg"><br>  <em>Quatro tipos de cart√µes nitro.</em> <br><br>  Uma das placas foi projetada para funcionar com <strong>uma rede</strong> <strong>VPC</strong> .  √â ela quem √© vis√≠vel nas <strong>m√°quinas virtuais</strong> como uma placa de rede <strong>ENA - Elastic Network Adapter</strong> .  Ele tamb√©m encapsula o tr√°fego quando √© transmitido pela rede f√≠sica (falaremos sobre isso na segunda parte do artigo), controla o firewall dos Grupos de Seguran√ßa, √© respons√°vel pelo roteamento e outras coisas da rede. <br><br>  Placas separadas funcionam com armazenamento em bloco do <strong>EBS</strong> e discos incorporados ao servidor.  Eles s√£o apresentados √†s m√°quinas virtuais convidadas como <strong>adaptadores NVMe</strong> .  Eles tamb√©m s√£o respons√°veis ‚Äã‚Äãpela criptografia de dados e monitoramento de disco. <br><br>  O sistema de cart√µes Nitro, um hipervisor e um chip de seguran√ßa s√£o integrados a uma SDN ou <strong>rede definida por software</strong> .  O <strong>cart√£o de</strong> controle √© respons√°vel pelo gerenciamento desta rede (plano de controle). <br><br>  Obviamente, continuamos a desenvolver novos ASICs.  Por exemplo, no final de 2018, eles lan√ßaram o chip Inferentia, que permite um trabalho mais eficiente com tarefas de aprendizado de m√°quina. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i7/1w/7p/i71w7p7mu3pbl3ozaoczqmxirku.jpeg" width="500"></div><br>  <em>Chip de processador de aprendizado de m√°quina Inferentia.</em> <br><br><h2>  Banco de dados escal√°vel </h2><br>  O banco de dados tradicional possui uma estrutura em camadas.  Se bastante simplificado, os seguintes n√≠veis s√£o diferenciados. <br><br><ul><li>  <strong>SQL</strong> - despachantes de clientes e consultas trabalham nele. </li><li>  Protegendo <strong>transa√ß√µes</strong> - tudo est√° claro aqui, ACID e tudo isso. </li><li>  <strong>Armazenamento em cache</strong> fornecido por buffer pools. </li><li>  <strong>Log</strong> - fornece trabalho com refazer logs.  No MySQL, eles s√£o chamados Bin Logs; no PosgreSQL, s√£o chamados Write Ahead Logs (WAL). </li><li>  <strong>Armazenamento</strong> - escreva diretamente no disco. </li></ul><br><img src="https://habrastorage.org/webt/5x/xv/ay/5xxvay0jy9xyewxzi1py1q9rhei.jpeg"><br>  <em>Estrutura de banco de dados em camadas.</em> <br><br>  Existem diferentes maneiras de dimensionar bancos de dados: sharding, arquitetura Shared Nothing, unidades compartilhadas. <br><br><img src="https://habrastorage.org/webt/ao/pq/sf/aopqsfjiytwkbunwwni-wia5mzu.jpeg"><br><br>  No entanto, todos esses m√©todos mant√™m a mesma estrutura de banco de dados monol√≠tico.  Isso limita significativamente a escala.  Para resolver esse problema, desenvolvemos nosso pr√≥prio banco de dados - o <strong>Amazon Aurora</strong> .  √â compat√≠vel com MySQL e PostgreSQL. <br><br><h3>  Aurora aurora </h3><br>  A principal id√©ia arquitet√¥nica √© dividir os n√≠veis de armazenamento e log do banco de dados principal. <br><br>  Olhando para o futuro, direi que tamb√©m tornamos o n√≠vel do cache independente.  A arquitetura deixa de ser um mon√≥lito e obtemos graus adicionais de liberdade na escala de blocos individuais. <br><br><img src="https://habrastorage.org/webt/31/a1/4_/31a14_4d4o0pvrk_23aj-obbiew.jpeg"><br>  <em>Os n√≠veis de log e armazenamento s√£o separados do banco de dados.</em> <br><br>  Um DBMS tradicional grava dados no sistema de armazenamento na forma de blocos.  No Amazon Aurora, criamos um reposit√≥rio "inteligente" que pode falar o idioma dos <strong>redo-logs</strong> .  No interior, o reposit√≥rio transforma logs em blocos de dados, monitora sua integridade e faz backups automaticamente. <br><br>  Essa abordagem permite implementar coisas interessantes como a <strong>clonagem</strong> .  Funciona fundamentalmente de maneira mais r√°pida e econ√¥mica devido ao fato de n√£o exigir a cria√ß√£o de uma c√≥pia completa de todos os dados. <br><br>  O n√≠vel de armazenamento √© implementado como um sistema distribu√≠do.  Consiste em um n√∫mero muito grande de servidores f√≠sicos.  Cada redo-log √© processado e armazenado simultaneamente por <strong>seis n√≥s</strong> .  Isso fornece prote√ß√£o de dados e balanceamento de carga. <br><br><img src="https://habrastorage.org/webt/uv/up/rg/uvuprghc30bpo190-fjgb3w5pm8.jpeg"><br><br>  A escala de leitura pode ser obtida usando r√©plicas apropriadas.  O armazenamento distribu√≠do elimina a necessidade de sincroniza√ß√£o entre a inst√¢ncia principal do banco de dados atrav√©s da qual gravamos dados e outras r√©plicas.  √â garantido que os dados atuais estejam dispon√≠veis para todas as r√©plicas. <br><br>  O √∫nico problema √© o armazenamento em cache de dados antigos em r√©plicas de leitura.  Mas esse problema √© resolvido atrav√©s da <strong>transfer√™ncia de todos os redo logs</strong> para r√©plicas na rede interna.  Se o log estiver no cache, ele ser√° marcado como inv√°lido e ser√° substitu√≠do.  Se n√£o estiver no cache, ser√° simplesmente descartado. <br><br><img src="https://habrastorage.org/webt/8q/lt/hc/8qlthc7bqmxhqhja_ou4u3udjk4.jpeg"><br><br>  N√≥s descobrimos o armazenamento. <br><br><h3>  Como escalar n√≠veis de DBMS </h3><br>  Aqui a escala horizontal √© muito mais dif√≠cil de fazer.  Portanto, vamos seguir o caminho mais comum da <strong>escala vertical cl√°ssica</strong> . <br><br>  Suponha que tenhamos um aplicativo que se comunique com um DBMS atrav√©s de um n√≥ principal. <br><br>  Com a escala vertical, selecionamos um novo n√≥ que ter√° mais processadores e mem√≥ria. <br><br><img src="https://habrastorage.org/webt/ai/mn/if/aimnifftppplcs1mfg3n-zldlrk.jpeg"><br><br>  Em seguida, alterne o aplicativo do n√≥ principal antigo para o novo.  H√° problemas <br><br><ul><li>  Isso exigir√° um tempo de inatividade percept√≠vel do aplicativo. </li><li>  O novo n√≥ mestre ter√° um cache frio.  O desempenho do banco de dados ser√° m√°ximo somente ap√≥s o aquecimento do cache. </li></ul><br><img src="https://habrastorage.org/webt/k0/i-/jy/k0i-jy69brtsvclx0trwgjfuw0y.jpeg"><br><br>  Como melhorar a situa√ß√£o?  Coloque um proxy entre o aplicativo e o n√≥ principal. <br><br><img src="https://habrastorage.org/webt/ag/bk/c9/agbkc94ple_fti2xvyjinrb7mxu.jpeg"><br><br>  O que isso nos dar√°?  Agora, todos os aplicativos n√£o precisam ser redirecionados manualmente para um novo n√≥.  A troca pode ser feita sob um proxy e, ao mesmo tempo, fundamentalmente mais r√°pido. <br><br>  O problema parece estar resolvido.  Mas n√£o, ainda sofremos a necessidade de aquecer o cache.  Al√©m disso, um novo problema apareceu - agora o proxy √© um ponto potencial de falha. <br><br><h3>  Solu√ß√£o final com o Amazon Aurora Serverless </h3><br>  Como resolvemos esses problemas? <br><br>  <strong>Deixou um proxy</strong> .  Esta n√£o √© uma inst√¢ncia separada, mas toda uma frota distribu√≠da de proxies atrav√©s dos quais os aplicativos se conectam ao banco de dados.  No caso de uma falha, qualquer um dos n√≥s pode ser substitu√≠do quase instantaneamente. <br><br>  <strong>Adicionamos um conjunto de n√≥s quentes de v√°rios tamanhos</strong> .  Portanto, se for necess√°rio alocar um novo n√≥ de tamanho maior ou menor, ele estar√° dispon√≠vel imediatamente.  N√£o √© necess√°rio esperar o carregamento. <br><br>  <strong>Todo o processo de dimensionamento √© controlado por um sistema de monitoramento especial.</strong>  O monitoramento monitora constantemente o status do n√≥ principal atual.  Se detectar, por exemplo, que a carga do processador atingiu um valor cr√≠tico, notifica o conjunto de inst√¢ncias quentes da necessidade de alocar um novo n√≥. <br><br><img src="https://habrastorage.org/webt/2r/ja/oq/2rjaoqe-tgjjv_nxbodwlibzkzc.jpeg"><br>  <em>Proxies distribu√≠dos, inst√¢ncias quentes e monitoramento.</em> <br><br>  Um n√≥ da energia necess√°ria est√° dispon√≠vel.  Os pools de buffers s√£o copiados para ele e o sistema come√ßa a aguardar um momento seguro para alternar. <br><br><img src="https://habrastorage.org/webt/hw/t4/nr/hwt4nruv3h9bdyyte_awfycnp1g.jpeg"><br><br>  Geralmente, o momento da troca chega r√°pido o suficiente.  Em seguida, a comunica√ß√£o entre o proxy e o n√≥ principal antigo √© suspensa, todas as sess√µes mudam para o novo n√≥. <br><br><img src="https://habrastorage.org/webt/pz/4f/cj/pz4fcjzipu0pep5pwwex6mb5kas.jpeg"><br><br>  O trabalho com o banco de dados √© retomado. <br><br><img src="https://habrastorage.org/webt/sv/dl/kf/svdlkfp7ve6gzlomvdxulhmyjsy.jpeg"><br><br>  O gr√°fico mostra que a suspens√£o √© realmente muito curta.  No gr√°fico azul, a carga e nos degraus vermelhos - os momentos da escala.  As quedas de curto prazo no gr√°fico azul s√£o exatamente esse pequeno atraso. <br><br><img src="https://habrastorage.org/webt/te/3p/4x/te3p4xzclr_3liuv-7gk2ocskey.jpeg"><br><br>  A prop√≥sito, o Amazon Aurora permite salvar e desativar completamente o banco de dados quando n√£o estiver em uso, por exemplo, no fim de semana.  Depois de parar a carga, o banco de dados diminui gradualmente sua energia e desliga por um tempo.  Quando a carga retornar, ela subir√° novamente suavemente. <br><br><blockquote>  Na pr√≥xima parte da conversa sobre o dispositivo Amazon, falaremos sobre o dimensionamento da rede.  Assine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a newsletter</a> e fique atento para n√£o perder o artigo. <br><br>  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HighLoad ++,</a> Vasily Pantyukhin far√° uma apresenta√ß√£o ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Houston, temos um problema.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto de sistemas com falha, padr√µes de desenvolvimento de servi√ßos internos na nuvem da Amazon</a> . ‚Äù  O que os desenvolvedores de design da Amazon usam padr√µes de design de sistema distribu√≠do, quais s√£o as raz√µes para falhas de servi√ßo, o que √© arquitetura baseada em c√©lula, trabalho constante e fragmenta√ß√£o de shuffle - ser√° interessante.  Menos de um m√™s antes da confer√™ncia - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reserve seus ingressos</a> .  24 de outubro, o aumento do pre√ßo final. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt471686/">https://habr.com/ru/post/pt471686/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt471668/index.html">An√°lise t√©cnica da explora√ß√£o checkm8</a></li>
<li><a href="../pt471670/index.html">Tentando Jetpack Compose em batalha?</a></li>
<li><a href="../pt471676/index.html">Golpistas por telefone. A segunda a√ß√£o, na qual eu corro e corro para o caixa eletr√¥nico mais pr√≥ximo</a></li>
<li><a href="../pt471678/index.html">Prestar servi√ßos sob demanda</a></li>
<li><a href="../pt471684/index.html">Por que voc√™ precisa criar m√≥dulos para o nginx</a></li>
<li><a href="../pt471688/index.html">Como a AWS fabrica seus servi√ßos resilientes. Escala de rede</a></li>
<li><a href="../pt471700/index.html">Como escolhi uma pilha tecnol√≥gica com uma base para o futuro</a></li>
<li><a href="../pt471702/index.html">Aplicativos Web com aprimoramento cibern√©tico</a></li>
<li><a href="../pt471704/index.html">O livro ‚ÄúMitoc√¥ndrias ego√≠stas. Como manter a sa√∫de e mover a velhice "</a></li>
<li><a href="../pt471706/index.html">9 problemas t√≠picos de rede que podem ser detectados usando a an√°lise NetFlow (usando o Flowmon como exemplo)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>