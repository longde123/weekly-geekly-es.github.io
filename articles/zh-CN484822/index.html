<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏽 🚒 👵 Blazor：如何防止组件生病或两种将代码与标记分开的方法 🏴󠁧󠁢󠁥󠁮󠁧󠁿 👨🏾‍💼 🌲</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我认为每个开发人员在进入一个新项目时都认为及时返回并告诉您的项目之父最好不要在面试时询问模式，也应将其应用于真实项目，这是我的荣幸。 


 特别是，这可能是一种模式，但是一个很好的规则是标记必须与代码分开。 这适用于良好的旧Web窗体，Asp.Net MVC-是否有人在Razor上编写标记？），并...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blazor：如何防止组件生病或两种将代码与标记分开的方法</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484822/"><p> 我认为每个开发人员在进入一个新项目时都认为及时返回并告诉您的项目之父最好不要在面试时询问模式，也应将其应用于真实项目，这是我的荣幸。 </p><br><p> 特别是，这可能是一种模式，但是一个很好的规则是标记必须与代码分开。 这适用于良好的旧Web窗体，Asp.Net MVC-是否有人在Razor上编写标记？），并且Angular在苛刻的企业中很流行。 </p><br><p> 如果您长期以来对终结者的前途无奈，转而使用新奇的Angular和React，那么... </p><a name="habracut"></a><br><p> 是的，先生们，后端开发人员，我们再次希望这些年来积累的知识不会在脑海中流失。 那个希望就是微软的Blazor技术。 <br> 打开工作室在创建Blazor项目时创建的默认项目，然后看了几篇文章之后，我以为一切都非常糟糕，并且代码和标记实际上始终在同一个文件中，例如此处（以下所有示例将基于Visual Studio 2019中安装了.Net Core 3.1的Blazor Server App模板项目）： </p><br><p><img src="https://habrastorage.org/webt/fz/uk/bn/fzukbn53judeqzxrqg7vim1t8xu.png" alt="图片"></p><br><p> 这里没什么混乱的吗？ </p><br><p> 我认为，所有用红色填充的内容都与该组件表示的内容无关，您需要摆脱它。 怎么了 </p><br><ol><li> 好吧，首先，将与您同时在此控件上工作的前端开发人员会为他所无法理解的符号感到困惑，并且每当他需要谨慎对待时，当他需要更改由Razor标记构成的代码段中的内容时，他都会向您提问。 </li><li> 当然，前端程序会很小心，但是可以肯定的是，您会定期遇到这样的事实，即在进行某些操作后，您的页面将无法按您预期的那样工作，或者根本无法工作。 </li><li> 如果您认为不再需要前端开发人员，因为现在所有内容都可以用C＃编写，那么您就错了。 无论如何，您都需要对控件进行样式化，这将由前端开发人员或通常不知道C＃是什么的排版员来完成。 </li><li> 乍一看，代码似乎很小，并且不会使布局非常混乱，这具有欺骗性，在一个不断发展的项目中，您将很快从舞台，技术演示到“该死的事情”。 我经常遇到这样一个事实，即从SQL Web Controls或直接在.cshtml页面上，SQL查询已发布到数据库，是的，我不是在开玩笑。 很多时候，经验丰富的开发人员昨天在一次社会保障面试中折磨了您，他们已经了解SOLID原则，明天就在标记中编写业务逻辑。 </li></ol><br><p> 我想我已经很怕您了，现在，我将告诉您如何避免上述问题，而且这样做非常简单。 如果在创建任何新的Razor组件时通常采用以下方法，那就太好了。 所以，第一种方法。 </p><br><h3 id="bazovyy-klass"> 基类 </h3><br><p> 第一种方法，直到最近才是唯一方法。 </p><br><p> 您将为上述示例中的控件创建一个基类，所有显示逻辑都将位于该基类中。 使用模板创建一个新文件 <br>  [控制名称] .razor.cs </p><br><p> 在这里，工作室将帮助我们，并从两个文件中构建如下图所示的文件： </p><br><p><img src="https://habrastorage.org/webt/oc/96/u9/oc96u90oqb2zzpuomier1gks3dq.png" alt="图片"></p><br><p> 如您所见，工作室非常聪明，并且了解自己想要的东西。 控件与我们要放置代码的文件分组在一起。 </p><br><p> 如果您现在打开一个新文件，则<strong>FetchData</strong>类<strong>名将</strong>用红色波浪线加下划线，这是正确的，因为尽管在<strong>FetchData.razor中</strong>您不会在<strong>任何地方</strong>看到名称为<strong>FetchData的</strong>类声明，但稍后在编译该项目后，它将显示它较低，因此类名称<strong>FetchData已</strong>被保留。 我们别无选择，只能使用将显示逻辑（只有它！！）放置在FetchDataBase类中的约定，即，类名将由模板形成： <br>  <strong>[ControlName]基础</strong> </p><br><p> 当然，您可能会感到困惑并编写自己的静态分析器，该分析器将检查每个组件的此类文件，为什么不呢？ <br> 接下来，我们需要从<strong>ComponentBase</strong>继承此类。 不要忘记添加 <br>  <strong>使用Microsoft.AspNetCore.Components</strong> ; </p><br><p> 这是我们得到的： </p><br><p><img src="https://habrastorage.org/webt/4z/8y/7d/4z8y7dupxs8f1z32uscjrblitky.png" alt="图片"></p><br><p> 哇，课程已经准备好在这里转移显示逻辑了，我们现在有机会完全用C＃编写，难道不是幸福吗？  :) </p><br><p> 但是，尽管Razor组件本身对我们的文件一无所知，但只有Visual Studio知道它们具有某些共同点。 </p><br><p> 因此，请执行以下操作： </p><br><p><img src="https://habrastorage.org/webt/q8/i3/p2/q8i3p2nhk-ecwlhusbd46fz7p58.png" alt="图片"></p><br><p> 我们从<strong>FetchDataBase</strong>类继承了Razor组件。 </p><br><p> 让<strong>FetchData.razor</strong>中仍然存在的C＃代码不打扰您。 </p><br><p> 现在，我们将所有显示逻辑转移到我们所谓的文件背后代码中： </p><br><p><img src="https://habrastorage.org/webt/an/au/kn/anauknb0nxw3tzqxinb15_4j1fy.png" alt="图片"></p><br><p> 发生了什么，好吧，首先我们添加了using和。 在Razor控件上，您几乎看不到它们，因为习惯<strong>上将</strong>它们添加到<strong>_Imports.razor中</strong> 。 已经添加了一些最常用的。 </p><br><p> 接下来，我们插入该属性，如您所见，我们最喜欢的DI可以正常工作。 <br> 您只需要使用<strong>[Inject]</strong>属性标记实现的属性。 在Razor组件中，它被标记为<strong><a href="https://habr.com/ru/users/inject/" class="user_link">Inject</a></strong> 。 即，变化很小。 </p><br><p> 好吧，然后跟随该属性，在该属性中我们加载显示的信息，它必须至少<strong>受到保护</strong> （因为Razor控件继承自当前类）。 如果决定从外部对其进行初始化，则为<strong>公开</strong>或<strong>公开状态</strong> ，在这种情况下，您仍然需要使用<strong>[Parameter]</strong>属性对其进行标记。 在Blazor的早期版本中，它受到了相当的<strong>保护</strong> ，但是现在工作室分析仪会为您骂它。 </p><br><p> 原则上，可以向此类添加构造函数并在那里进行一些工作，但是不建议这样做，最好将所有初始化逻辑放在<strong>OnInitializedAsync（）</strong>方法中 </p><br><p> 这就是<strong>FetchData.razor</strong>中剩下的全部<strong>内容</strong> </p><br><p><img src="https://habrastorage.org/webt/_m/5f/3z/_m5f3zs5nzf8qvrguce_zc9pxbo.png" alt="图片"></p><br><p> 有散布的Razor标记，但是怎么可能呢，我们仍然需要以某种方式显示我们的数据。 但是纯C＃代码完全消失了。 我认为这很棒。 我建议您首先采用类似的方法，然后当您的控件扩展到大尺寸时，您和您的同事都不会抬头。 </p><br><p> 最重要的是，它是否完全有效，现在让我们检查一下： </p><br><p><img src="https://habrastorage.org/webt/gr/sn/rh/grsnrh24yfincyy0eq8rv9gvxme.png" alt="图片"></p><br><p> 太好了，就像他们没有破坏任何东西=） </p><br><h3 id="partial-class"> 部分课程 </h3><br><p> 因此，第二种方法（最近出现）（ <a href="https://docs.microsoft.com/en-us/aspnet/core/blazor/components%3Fview%3Daspnetcore-3.1" rel="nofollow">https://docs.microsoft.com/zh-cn/aspnet/core/blazor/components?view=aspnetcore-3.1#partial-class-support</a> ），但很可能会完全取代前一个。 应工作人员的要求，.Net Core 3.1添加了为Razor控件创建<strong>部分类</strong>的功能。 因此，我们几乎保留了以前方法中的所有内容，但是现在我们不需要从ComponentBase继承，并且可以将类与组件称为相同，也就是说，其签名将如下所示： <br> 公共局部类[ComponentName] </p><br><p> 正如您在下面看到的，更改是最小的，在后面的代码中，我们摆脱了<strong>ComponentBase</strong>的继承，并将该类标记为“ <strong>部分”</strong> </p><br><p><img src="https://habrastorage.org/webt/q1/5o/i5/q15oi5kifsulqhij-jhookhhryu.png" alt="图片"></p><br><p> 标记文件也做了一些简化，我们也摆脱了对FetchDataBase的继承，该类由于无用而不再存在。 </p><br><p><img src="https://habrastorage.org/webt/mq/53/tl/mq53tldh_tppbmfrcicmqe0wwbw.png" alt="图片"></p><br><p> 如您所见，有两种方法可以使标记保持干净。 您选择哪一个取决于您。 不幸的是，对于工作室来说，在创建新组件时立即生成代码隐藏会很好。 现在正在积极地讨论这个问题，并且正如开发人员所说，如果有需求的话，将来肯定会增加这种可能性。 <br> 因此，现在我们的Razor组件变成了什么： </p><br><p><img src="https://habrastorage.org/webt/jf/2v/ef/jf2vefp9jwrsq5pb_psmcbvonua.png" alt="图片"></p><br><p> 熟悉了，不是吗？）曾经使Razor Asp.Net MVC组件成为现实的每个人都会发现，自动生成的文件的内容非常熟悉。 </p><br><p> 希望您今天从第一篇有关Habr的文章中了解到Blazor的更多信息。 留下批评，问题和对新文章的要求=） </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN484822/">https://habr.com/ru/post/zh-CN484822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN484812/index.html">我在Plesk的经历</a></li>
<li><a href="../zh-CN484814/index.html">6. Fortinet入门v6.0。 Web过滤和应用控制</a></li>
<li><a href="../zh-CN484816/index.html">使用操作挂钩动态备份macOS上的文件</a></li>
<li><a href="../zh-CN484818/index.html">该书“ C ++。 《多线程编程实践》</a></li>
<li><a href="../zh-CN484820/index.html">FAQ.Net-具有更新设计的Windows免费笔记记录程序</a></li>
<li><a href="../zh-CN484824/index.html">关灯之战</a></li>
<li><a href="../zh-CN484826/index.html">人工智能使不良药物更加恶化</a></li>
<li><a href="../zh-CN484834/index.html">如何制定培训和发展的企业战略</a></li>
<li><a href="../zh-CN484836/index.html">根据乌克兰2020年的绿色关税计算获利能力</a></li>
<li><a href="../zh-CN484838/index.html">在Google Ads中设置规则的13个示例[说明]</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>