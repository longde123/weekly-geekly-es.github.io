<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÉ üë©‚Äç‚úàÔ∏è ü§úüèø Una historia de lanzamiento que afect√≥ todo üí° üö¥üèº üì¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Enemigos de la realidad por 12f-2 

 A finales de abril, mientras los caminantes blancos asediaban Invernalia, algo m√°s interesante nos sucedi√≥, hicim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Una historia de lanzamiento que afect√≥ todo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/453364/"><img src="https://habrastorage.org/webt/kc/5y/q_/kc5yq_bh4rgol9q8lebwmzsldca.jpeg"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enemigos de la realidad</a> por 12f-2</i> <br><br>  A finales de abril, mientras los caminantes blancos asediaban Invernalia, algo m√°s interesante nos sucedi√≥, hicimos un lanzamiento inusual.  En principio, constantemente presentamos nuevas funciones en el producto (como todos los dem√°s).  Pero este no era como todos los dem√°s.  Su escala era tal que cualquier error potencial que pudi√©ramos cometer afectar√≠a a todos nuestros servicios y usuarios.  Como resultado, implementamos todo seg√∫n el plan, en el tiempo de inactividad previsto y anunciado, sin consecuencias para la venta.  El art√≠culo trata sobre c√≥mo logramos esto y c√≥mo aquellos que lo deseen pueden repetir esto en casa. <br><a name="habracut"></a><br>  Ahora no describir√© nuestras decisiones arquitect√≥nicas y t√©cnicas, ni dir√© c√≥mo funciona todo.  Estas son notas bastante marginales sobre c√≥mo tuvo lugar uno de los despliegues m√°s dif√≠ciles, que observ√© y en el que particip√© directamente.  No pretendo ser detalles completos o t√©cnicos, tal vez aparecer√°n en otro art√≠culo. <br><br><h2>  Fondo + qu√© tipo de funcionalidad es esta </h2><br>  Estamos construyendo la plataforma en la nube <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mail.ru Cloud Solutions</a> (MCS), donde trabajo como CTO.  Y ahora, es hora de conectarse a nuestra plataforma IAM (Identity and Access Management), que proporciona una gesti√≥n unificada de todas las cuentas de usuario, usuarios, contrase√±as, roles, servicios y m√°s.  Por qu√© es necesario en la nube es una pregunta obvia: toda la informaci√≥n del usuario se almacena en ella. <br><br>  Por lo general, tales cosas comienzan a desarrollarse desde el comienzo de cualquier proyecto.  Pero MCS ha sido hist√≥ricamente un poco diferente.  MCS fue construido en dos partes: <br><br><ul><li>  OpenStack con su propio m√≥dulo de autorizaci√≥n Keystone, </li><li>  Hotbox (almacenamiento S3) basado en el proyecto Cloud Mail.ru, </li></ul><br>  alrededor del cual aparecieron nuevos servicios. <br><br>  En esencia, estos eran dos tipos diferentes de autorizaci√≥n.  Adem√°s, utilizamos algunos desarrollos separados de Mail.ru, por ejemplo, el almacenamiento general de contrase√±as de Mail.ru, as√≠ como un conector openid autoescrito, que habilit√≥ SSO (autorizaci√≥n de transferencia) en el panel Horizon de m√°quinas virtuales (OpenItack UI nativo). <br><br>  Hacer IAM significaba para nosotros combinar todo esto en un solo sistema, completamente nuestro.  Al mismo tiempo, no pierda ninguna funcionalidad en el camino, cree una acumulaci√≥n de trabajo para el futuro, lo que nos permitir√° refinarlo de forma transparente sin refactorizarlo y escalarlo seg√∫n la funcionalidad.  Tambi√©n al principio, los usuarios aparecieron un modelo a seguir del acceso a los servicios (RBAC central, control de acceso basado en roles) y algunas otras peque√±as cosas. <br><br>  La tarea result√≥ no ser trivial: python y perl, varios backends, servicios escritos de forma independiente, varios equipos de desarrollo y administradores.  Y lo m√°s importante, miles de usuarios en vivo en el sistema de producci√≥n de combate.  Todo esto ten√≠a que ser escrito y, lo m√°s importante, desplegado sin bajas. <br><br><h2>  ¬øQu√© vamos a desplegar? </h2><br>  Si es muy grosero, en alg√∫n lugar en 4 meses preparamos esto: <br><br><ul><li>  Hicieron varios demonios nuevos que agregaron funciones que anteriormente funcionaban en diferentes partes de la infraestructura.  A otros servicios se les prescribi√≥ un nuevo backend en forma de estos demonios. </li><li>  Escribimos nuestro propio repositorio central de contrase√±as y claves, disponible para todos nuestros servicios, que puede modificarse libremente seg√∫n lo necesitemos. </li><li>  Desde cero, escribieron 4 backends nuevos para Keystone (usuarios, proyectos, roles, asignaciones de roles), que, de hecho, reemplazaron su base y ahora act√∫an como un √∫nico dep√≥sito de nuestras contrase√±as de usuario. </li><li>  Ense√±amos a todos nuestros servicios de Openstack a ir por sus pol√≠ticas a un servicio de pol√≠ticas de terceros en lugar de leer estas pol√≠ticas localmente desde cada servidor (¬°s√≠, por defecto Openstack funciona as√≠!) </li></ul><br>  Una alteraci√≥n tan grande requiere cambios grandes, complejos y, lo m√°s importante, sincr√≥nicos en varios sistemas escritos por diferentes equipos de desarrollo.  Despu√©s del ensamblaje, todo el sistema deber√≠a funcionar. <br><br>  ¬øC√≥mo implementar tales cambios y no arruinarlo?  Primero, decidimos mirar un poco hacia el futuro. <br><br><h2>  Estrategia de despliegue </h2><br><ul><li>  Ser√≠a posible implementarlo en varias etapas, pero esto aumentar√≠a el tiempo de desarrollo en tres veces.  Adem√°s, durante alg√∫n tiempo tendr√≠amos una desincronizaci√≥n completa de datos en las bases de datos.  Tendr√≠a que escribir mis propias herramientas de sincronizaci√≥n y vivir con m√∫ltiples almacenes de datos durante mucho tiempo.  Y esto crea una amplia variedad de riesgos. </li><li>  Todo lo que pudieron preparar de forma transparente para el usuario se hizo de antemano.  Tom√≥ 2 meses. </li><li>  Nos permitimos el tiempo de inactividad durante varias horas, solo para que las operaciones del usuario puedan crear y modificar recursos. </li><li>  Para el trabajo de todos los recursos ya creados, el tiempo de inactividad era inaceptable.  Planeamos que al desplegar los recursos deber√≠a funcionar sin tiempo de inactividad y sin afectar a los clientes. </li><li>  Para reducir el impacto en nuestros clientes, si algo sale mal, decidimos implementarlo el domingo por la noche.  Por la noche, menos clientes administran m√°quinas virtuales. </li><li>  Advertimos a todos nuestros clientes que durante el per√≠odo elegido para el despliegue, la gesti√≥n del servicio no estar√° disponible. </li></ul><br><h2>  Digresi√≥n: ¬øqu√© es el despliegue? </h2><br>  <i>&lt;filosof√≠a de precauci√≥n&gt;</i> <br><br>  Cada especialista de TI responder√° f√°cilmente qu√© es la implementaci√≥n.  Pones CI / CD, y autom√°ticamente todo se entrega al producto.  :) <br><br>  Por supuesto, esto es verdad.  Pero la dificultad es que con las herramientas modernas para automatizar la entrega de c√≥digo, se pierde la comprensi√≥n del rodaje.  ¬øC√≥mo te olvidas de la invenci√≥n √©pica de la rueda, mirando los veh√≠culos modernos?  Todo est√° tan automatizado que el despliegue a menudo se realiza sin darse cuenta de la imagen completa. <br><br>  Y toda la imagen es la siguiente.  La implementaci√≥n consiste en cuatro grandes aspectos: <br><br><ol><li>  Entrega de c√≥digo, incluida la modificaci√≥n de datos.  Por ejemplo, su migraci√≥n. </li><li>  Reversi√≥n de c√≥digo: la capacidad de regresar si algo sale mal.  Por ejemplo, a trav√©s de la creaci√≥n de copias de seguridad. </li><li>  La hora de cada operaci√≥n de despliegue / reversi√≥n.  Uno debe entender el momento de cualquier operaci√≥n de los dos primeros puntos. </li><li>  Funcionalidad afectada.  Es necesario evaluar tanto los efectos positivos esperados como los posibles efectos negativos. </li></ol><br>  Todos estos aspectos deben tenerse en cuenta para un despliegue exitoso.  Por lo general, solo eval√∫an el primero, en el mejor de los casos, el segundo punto, y luego el lanzamiento se considera exitoso.  Pero el tercero y el cuarto son a√∫n m√°s importantes.  ¬øA qu√© usuario le gustar√° si la implementaci√≥n demora 3 horas en lugar de un minuto?  ¬øO si algo superfluo afecta el despliegue?  ¬øO el tiempo de inactividad de un servicio dar√° lugar a consecuencias impredecibles? <br><br><h2>  Acto 1..n, preparaci√≥n para la liberaci√≥n </h2><br>  Al principio pens√© en describir brevemente nuestras reuniones: todo el equipo, sus partes, un mont√≥n de discusiones en puntos de caf√©, disputas, pruebas, tormentas cerebrales.  Entonces pens√© que ser√≠a superfluo.  Cuatro meses de desarrollo siempre consisten en esto, especialmente cuando escribe no algo que se puede entregar constantemente, sino una gran caracter√≠stica en un sistema vivo.  Lo que afecta a todos los servicios, pero los usuarios no deber√≠an cambiar nada excepto el "bot√≥n de la interfaz web". <br><br>  Nuestra comprensi√≥n de c√≥mo implementar, cambi√≥ de cada nueva reuni√≥n, y de manera muy significativa.  Por ejemplo, √≠bamos a actualizar toda nuestra base de facturaci√≥n.  Pero calcularon el tiempo y se dieron cuenta de que era imposible hacer esto en un tiempo de implementaci√≥n razonable.  Nos tomamos casi una semana adicional para fragmentar y archivar la base de datos de facturaci√≥n.  Y cuando la velocidad de despliegue esperada no funcion√≥ despu√©s de eso, ordenaron un hierro adicional y m√°s potente, donde arrastraron toda la base.  No es que no quisi√©ramos hacer esto antes, pero la necesidad actual de implementaci√≥n no nos dej√≥ ninguna opci√≥n. <br><br>  Cuando uno de nosotros ten√≠a dudas de que la implementaci√≥n podr√≠a afectar la disponibilidad de nuestras m√°quinas virtuales, pasamos una semana para probar, experimentar, analizar el c√≥digo y entendimos claramente que esto no suceder√≠a en nuestra producci√≥n, e incluso las personas m√°s dudosas estuvieron de acuerdo con esto. <br><br>  Mientras tanto, los t√©cnicos de soporte t√©cnico realizaron sus experimentos independientes para escribir a los clientes instrucciones sobre c√≥mo conectarse, que se supon√≠a que cambiar√≠an despu√©s de la implementaci√≥n.  Trabajaron en una experiencia de usuario f√°cil de usar, prepararon instrucciones y brindaron asesoramiento personal. <br><br>  Hemos automatizado todas las operaciones de implementaci√≥n posibles.  Cualquier operaci√≥n fue programada, incluso la m√°s simple, constantemente condujo pruebas.  Discutieron sobre la mejor manera de desactivar el servicio: reducir el daemon o bloquear el acceso al servicio con un firewall.  Se cre√≥ una lista de verificaci√≥n de equipos para cada etapa de despliegue, se actualiz√≥ constantemente.  Dibujamos y actualizamos constantemente el diagrama de Gantt para todos los trabajos de implementaci√≥n, con tiempos. <br><br>  Y entonces ... <br><br><h2>  Acto final, antes de lanzar </h2><br>  ... es hora de lanzarse. <br><br>  Como dice el refr√°n, una obra de arte no se puede completar, solo para terminar de trabajar en ella.  Es necesario hacer un esfuerzo voluntario, entendiendo que no encontrar√° todo, pero creyendo que hizo todas las suposiciones razonables, proporcion√≥ todos los casos posibles, cerr√≥ todos los errores cr√≠ticos y todos los participantes hicieron todo lo posible.  Cuanto m√°s c√≥digo implemente, m√°s dif√≠cil ser√° convencerse de esto (adem√°s, cualquiera comprende que es imposible prever todo). <br><br>  Tomamos la decisi√≥n de que est√°bamos listos para implementar cuando est√°bamos convencidos de que hicimos todo lo posible para cerrar todos los riesgos para nuestros usuarios asociados con efectos inesperados y tiempos de inactividad.  Es decir, cualquier cosa puede salir mal excepto: <br><br><ol><li>  El afecto (sagrado para nosotros, el m√°s preciado) de la infraestructura del usuario, </li><li>  Funcionalidad: el uso de nuestro servicio despu√©s de la implementaci√≥n debe ser el mismo que antes. </li></ol><br><h2>  Desplegar </h2><br><img src="https://habrastorage.org/webt/mx/vt/yq/mxvtyqnl26yvqbxhego52zj9d8c.png"><br>  <i>Dos est√°n rodando, 8 no interfieren</i> <br><br>  Tomamos el tiempo de inactividad para todas las solicitudes de los usuarios dentro de las 7 horas.  En este momento, tenemos un plan de implementaci√≥n y un plan de reversi√≥n. <br><br><ul><li>  El despliegue en s√≠ toma aproximadamente 3 horas. </li><li>  2 horas - para pruebas. </li><li>  2 horas: una reserva para una posible reversi√≥n de cambios. </li></ul><br>  Se ha compilado un diagrama de Gantt para cada acci√≥n, cu√°nto tiempo lleva, qu√© pasa en secuencia, qu√© se hace en paralelo. <br><br><img src="https://habrastorage.org/webt/gl/4v/2p/gl4v2pcxxorqbzzhuvlbdsi0jtg.png"><br>  <i>Una porci√≥n del diagrama de despliegue de Gantt, una de las versiones anteriores (sin ejecuci√≥n paralela).</i>  <i>La herramienta de sincronizaci√≥n m√°s valiosa</i> <br><br>  Todos los participantes tienen su papel en el despliegue, las tareas que realizan y de las que son responsables.  Estamos intentando que cada etapa sea autom√°tica, retroceder, recopilar comentarios y volver a rodar. <br><br><h3>  Cr√≥nica de los acontecimientos </h3><br>  Entonces, 15 personas vinieron a trabajar el domingo 28 de abril a las 10 p.m.  Adem√°s de los participantes clave, algunos vinieron solo para apoyar al equipo, por lo que les agradecemos especialmente. <br><br>  Por separado, vale la pena mencionar que nuestro probador clave est√° de vacaciones.  Es imposible implementar sin probar, estamos trabajando en opciones.  Una colega acepta ponernos a prueba fuera de vacaciones, por lo que tiene una gratitud inconmensurable de todo el equipo. <br><br>  <b>00:00.</b>  <b>Para</b> <br>  Detuvimos las solicitudes de los usuarios, colgamos la placa de identificaci√≥n, dicen, trabajo t√©cnico.  El monitoreo grita, pero todo es normal.  Verificamos que nada cay√≥, excepto que deber√≠a.  Y comenzamos a trabajar en la migraci√≥n. <br><br>  Todos tienen un plan de despliegue impreso para los puntos, todos saben qui√©n est√° haciendo qu√© y en qu√© momento.  Despu√©s de cada acci√≥n, verificamos los tiempos que no los exceden, y todo sale seg√∫n el plan.  Aquellos que no est√©n involucrados en el lanzamiento directamente en la etapa actual, prep√°rense lanzando un juguete en l√≠nea (Xonotic, tipo 3 kwaki), para no interferir con sus colegas.  :) <br><br>  <b>02:00 a.m.</b>  <b>Desplegado</b> <br>  Una sorpresa agradable: terminamos de implementar una hora antes, debido a la optimizaci√≥n de nuestras bases de datos y secuencias de comandos de migraci√≥n.  El grito universal, "desplegado!"  Todas las funciones nuevas en el producto, pero hasta ahora solo podemos ver la interfaz.  Todos entran en modo de prueba, ordenados en montones y comienzan a mirar lo que sucedi√≥ al final. <br><br>  No funcion√≥ muy bien, entendemos esto despu√©s de 10 minutos, cuando nada est√° conectado y no funciona en los proyectos de los miembros del equipo.  Sincronizaci√≥n r√°pida, expresar nuestros problemas, priorizar, dividir en equipos y depurar. <br><br>  <b>2:30 a.m.</b>  <b>Dos grandes problemas contra cuatro ojos</b> <br>  Encontramos dos grandes problemas.  Nos dimos cuenta de que los clientes no ver√°n algunos servicios conectados y habr√° problemas con las cuentas de socios.  Ambos est√°n asociados con scripts de migraci√≥n imperfectos para algunos casos extremos.  Necesitamos arreglarlo ahora. <br><br>  Escribimos consultas que arreglan esto, al menos 4 ojos.  Rodamos en la puerta previa para asegurarnos de que funcionen y no rompan nada.  Puedes seguir adelante.  Paralelamente, comienza nuestra prueba de integraci√≥n habitual, que detecta algunos problemas m√°s.  Todos ellos son peque√±os, pero tambi√©n necesitan ser reparados. <br><br>  <b>03:00 a.m.</b>  <b>-2 problemas +2 problemas</b> <br>  Los dos grandes problemas anteriores est√°n solucionados, casi todos los menores tambi√©n.  Todos los arreglos desocupados trabajan activamente en sus cuentas e informan lo que encuentran.  Priorizamos, distribuimos por comandos, dejamos sin cr√≠ticas por la ma√±ana. <br><br>  Al ejecutar las pruebas nuevamente, revelan dos nuevos problemas importantes.  No todas las pol√≠ticas de servicio llegaron correctamente, por lo que algunas solicitudes de los usuarios no se autentican.  Adem√°s de un nuevo problema con las cuentas de socios.  Nos apresuramos a mirar. <br><br>  <b>03:20.</b>  <b>Sincronizaci√≥n de emergencia</b> <br>  Un nuevo problema solucionado.  Para el segundo, organizamos una sincronizaci√≥n de emergencia.  Entendemos lo que est√° sucediendo: la soluci√≥n anterior solucion√≥ un problema, pero cre√≥ otro.  Tomamos un descanso para descubrir c√≥mo hacerlo bien y sin consecuencias. <br><br>  <b>03:30 a.m.</b>  <b>Seis ojos</b> <br>  Somos conscientes de cu√°l deber√≠a ser el estado final de la base para que todo sea bueno para todos los socios.  Escribimos una solicitud en 6 ojos, rodamos en la varilla previa, probamos, rodamos en el producto. <br><br>  <b>04:00.</b>  <b>Todo funciona</b> <br>  Todas las pruebas pasaron, no hay problemas cr√≠ticos visibles.  De vez en cuando, algo no funciona en un equipo, respondemos r√°pidamente.  Muy a menudo, la alarma es falsa.  Pero a veces algo no lleg√≥, en alg√∫n lugar una p√°gina separada no funciona.  Nos sentamos, arreglamos, arreglamos, arreglamos.  Un equipo separado lanza la √∫ltima gran caracter√≠stica: la facturaci√≥n. <br><br>  <b>04:30.</b>  <b>Punto de no retorno</b> <br>  Se acerca el punto de no retorno, es decir, el momento en que, si comenzamos a retroceder, no cumpliremos con el tiempo de inactividad que se nos ha dado.  Hay problemas con la facturaci√≥n, que lo sabe todo y escribe, pero obstinadamente no quiere cancelar el dinero de los clientes.  Hay varios errores en p√°ginas individuales, acciones, estados.  La funcionalidad principal funciona, todas las pruebas pasan con √©xito.  Decidimos que se realiz√≥ el lanzamiento, no volveremos. <br><br>  <b>06:00 a.m.</b>  <b>Abrimos todo en UI</b> <br>  Los errores son corregidos.  Algunos usuarios no afectados quedan para m√°s adelante.  Abrimos la interfaz para todos.  Continuamos evocando la facturaci√≥n, esperamos los comentarios de los usuarios y los resultados del monitoreo. <br><br>  <b>07:00 a.m.</b>  <b>Problemas de carga de API</b> <br>  Queda claro que tenemos una peque√±a carga planificada incorrectamente en nuestra API y que estamos probando esta carga, lo que no pudo identificar el problema.  Como resultado, ‚âà5% de las solicitudes falla.  Nos estamos movilizando, buscando una raz√≥n. <br><br>  La facturaci√≥n es terca, tampoco quiere trabajar.  Decidimos posponerlo para m√°s adelante para realizar cambios en un modo tranquilo.  Es decir, todos los recursos en √©l se acumulan, pero las cancelaciones de los clientes no pasan.  Por supuesto, esto es un problema, pero en comparaci√≥n con el despliegue general, no parece fundamental. <br><br>  <b>08:00.</b>  <b>Fix API</b> <br>  Lanzamos una soluci√≥n para la carga, los fallos se fueron.  Empezamos a irnos a casa. <br><br>  <b>10 a.m.</b>  <b>Todos</b> <br>  Todo esta arreglado.  En el monitoreo y los clientes est√°n callados, el equipo se va a la cama gradualmente.  La facturaci√≥n permanece, la restauraremos ma√±ana. <br><br>  Luego, durante el d√≠a, hubo implementaciones que arreglaron los registros, notificaciones, c√≥digos de retorno y c√≥digos personalizados de algunos de nuestros clientes. <br><br>  Entonces, el lanzamiento fue exitoso.  Por supuesto, podr√≠a ser mejor, pero llegamos a conclusiones sobre lo que no ten√≠amos lo suficiente para lograr la perfecci√≥n. <br><br><h2>  Total </h2><br>  Dentro de los 2 meses de la preparaci√≥n activa para el tiempo de implementaci√≥n, se completaron 43 tareas, que duraron desde un par de horas hasta varios d√≠as. <br><br>  Durante el despliegue: <br><br><ul><li>  demonios nuevos y cambiados - 5 piezas, reemplazando 2 monolitos; </li><li>  cambios dentro de las bases de datos: nuestras 6 bases de datos con datos de usuario se ven afectadas, se descargan las descargas de tres bases de datos antiguas a una nueva; </li><li>  interfaz completamente renovada; </li><li>  el n√∫mero de c√≥digo bombeado: 33 mil l√≠neas de c√≥digo nuevo, ‚âà 3 mil l√≠neas de c√≥digo en las pruebas, ‚âà 5 mil l√≠neas de c√≥digo de migraci√≥n; </li><li>  Todos los datos est√°n intactos, ni una sola m√°quina virtual del cliente ha sufrido.  :) </li></ul><br><h2>  Buenas pr√°cticas para un buen despliegue </h2><br>  Nos guiaron por ellos en esta dif√≠cil situaci√≥n.  Pero, en general, es √∫til observarlos en cualquier despliegue.  Pero cuanto m√°s dif√≠cil es la implementaci√≥n, mayor es el papel que desempe√±an. <br><br><ol><li>  Lo primero que debe hacer es comprender c√≥mo la implementaci√≥n puede afectar o afectar a los usuarios.  ¬øHabr√° tiempo de inactividad?  Si es as√≠, ¬øqu√© es el tiempo de inactividad?  ¬øC√≥mo afectar√° esto a los usuarios?  ¬øCu√°les son los mejores y peores escenarios?  Y cierra los riesgos. </li><li>  Planifica todo.  En cada etapa, debe comprender todos los aspectos del despliegue: <br><ul><li>  entrega de c√≥digo; </li><li>  reversi√≥n de c√≥digo; </li><li>  tiempo de cada operaci√≥n; </li><li>  funcionalidad afectada </li></ul></li><li>  Juega escenarios hasta que todas las etapas de despliegue est√©n claras, as√≠ como los riesgos en cada una de ellas.  Si tiene alguna duda, puede tomar un descanso y explorar la dudosa etapa por separado. </li><li>  Cada etapa puede y debe mejorarse si ayuda a nuestros usuarios.  Por ejemplo, reducir√° el tiempo de inactividad o eliminar√° algunos riesgos. </li><li>  Probar la reversi√≥n es mucho m√°s importante que probar la entrega del c√≥digo.  Es necesario verificar que, como resultado de la reversi√≥n, el sistema volver√° a su estado original, confirme esto con pruebas. </li><li>  Todo lo que se puede automatizar debe ser automatizado.  Todo lo que no se puede automatizar debe estar preescrito en la hoja de trucos. </li><li>  Registre los criterios de √©xito.  ¬øQu√© funcionalidad deber√≠a estar disponible y a qu√© hora?  Si esto no sucede, comience un plan de reversi√≥n. </li><li>  Y lo m√°s importante, la gente.  Todos deben estar conscientes de lo que est√° haciendo, de qu√© y qu√© depende de sus acciones en el proceso de implementaci√≥n. </li></ol><br>  Y si en una frase, con una buena planificaci√≥n y elaboraci√≥n, puede implementar lo que quiera sin consecuencias para la venta.  Incluso eso afecta a todos sus servicios en prod. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/453364/">https://habr.com/ru/post/453364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453352/index.html">C√≥mo los drones entregan medicamentos vitales en Ghana</a></li>
<li><a href="../453354/index.html">Clasificaci√≥n de la cobertura del suelo utilizando eo-learn. Parte 3</a></li>
<li><a href="../453356/index.html">Tendencias actuales y recomendaciones sobre aglomeraci√≥n de grandes instituciones financieras</a></li>
<li><a href="../453360/index.html">Ciudad sin atascos</a></li>
<li><a href="../453362/index.html">HabraConf # 1: hacia atr√°s para backend</a></li>
<li><a href="../453366/index.html">C√≥mo usar comas en ingl√©s: 15 reglas y ejemplos de error</a></li>
<li><a href="../453368/index.html">Recuperaci√≥n de datos de tablas XtraDB sin archivo de estructura utilizando an√°lisis de bytes del archivo ibd</a></li>
<li><a href="../453370/index.html">Confrontaci√≥n 2019: el equipo de Jet Security ocup√≥ el primer lugar en defensa</a></li>
<li><a href="../453374/index.html">Los 10 principales proveedores de API y SDK para llamadas de chat, audio y video para empresas</a></li>
<li><a href="../453376/index.html">¬øC√≥mo perder el tiempo y los recursos SSD en vano? F√°cil y simple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>