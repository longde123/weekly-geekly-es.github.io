<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏓 👨🏿‍🤝‍👨🏼 🔧 Izin file Linux 👩🏽‍✈️ 👨🏽‍🚀 😤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. Kami secara aktif bergabung dengan pekerjaan dan pada bulan Januari kami sedang mempersiapkan banyak peluncuran yang kuat. Di antara ya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Izin file Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/483934/">  <i>Halo semuanya.</i>  <i>Kami secara aktif bergabung dengan pekerjaan dan pada bulan Januari kami sedang mempersiapkan banyak peluncuran yang kuat.</i>  <i>Di antara yang lain, satu set telah diumumkan untuk aliran baru kursus <a href="https://otus.pw/rbVT/">Administrator Linux</a> yang disukai semua orang.</i>  <i>Untuk mengantisipasi peluncuran, kami biasanya membagikan terjemahan materi yang bermanfaat.</i> <br><br><img src="https://habrastorage.org/webt/tx/al/mo/txalmou0on51si-w3_nicm-3ovo.png"><br><hr><br><blockquote>  <i>Izin file menawarkan alternatif yang aman untuk executable SUID, tetapi mereka mungkin tampak sedikit membingungkan pada awalnya.</i> </blockquote><a name="habracut"></a><br>  Kita semua tahu bahwa binari <a href="http://en.wikipedia.org/wiki/Setuid">SUID</a> adalah <a href="http://en.wikipedia.org/wiki/Setuid">solusi keamanan yang buruk</a> .  Untungnya, jika aplikasi Anda memerlukan beberapa hak istimewa terbatas, ada cara yang lebih efisien yang disebut <a href="http://www.linuxjournal.com/article/5737">izin file</a> . <br><br>  Saya akan menghemat waktu Anda jika Anda ingin menghindari pembacaan rinci artikel di atas: pada dasarnya, izin file memungkinkan proses yang berjalan sebagai root dan, oleh karena itu, memiliki hak untuk melakukan sesuatu, untuk menyimpan fitur-fitur tertentu yang dibatasi oleh <a href="http://www.kernel.org/doc/man-pages/online/pages/man7/capabilities.7.html">daftar ini</a> ketika mereka setel ulang hak istimewa dan jalankan sebagai pengguna yang tidak memiliki hak.  Ini berarti bahwa jika seorang penyerang berhasil mengkompromikan suatu proses dengan meluap buffer atau eksploitasi lainnya, ia tidak akan dapat mengambil keuntungan dari apa pun selain hak minimum minimum tertentu yang benar-benar dibutuhkan oleh proses tersebut. <br><br>  Izin sangat bagus untuk layanan yang biasanya selalu dijalankan sebagai root, tetapi bagaimana dengan utilitas baris perintah?  Untungnya, ini juga didukung asalkan Anda memiliki utilitas yang benar diinstal.  Jika Anda menggunakan Ubuntu, misalnya, Anda akan memerlukan paket <code>libcap2-bin</code> .  Anda juga perlu menjalankan kernel non-archaic (mulai dari versi <b>2.6.24</b> ). <br><br>  Fungsi-fungsi ini memungkinkan Anda untuk mengaitkan izin dengan file yang dapat dieksekusi mirip dengan pengaturan bit SUID, tetapi hanya untuk serangkaian izin tertentu.  Utilitas <code>setcap</code> digunakan untuk menambah dan menghapus izin dari file. <br><br>  Langkah pertama adalah memilih izin yang Anda butuhkan.  Untuk artikel ini, saya berasumsi bahwa ada alat diagnostik jaringan yang disebut <code>tracewalk</code> yang harus dapat menggunakan <a href="http://man7.org/linux/man-pages/man7/raw.7.html">soket mentah</a> .  Ini biasanya mengharuskan aplikasi dijalankan sebagai root, tetapi ketika melihat <a href="http://www.kernel.org/doc/man-pages/online/pages/man7/capabilities.7.html">daftar,</a> ternyata hanya izin <code>CAP_NET_RAW</code> yang <code>CAP_NET_RAW</code> . <br><br>  Dengan asumsi Anda berada di direktori tempat biner <code>tracewalk</code> berada, Anda dapat menambahkan izin ini sebagai berikut: <br><br><pre> <code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">setcap</span></span> cap_net_raw=eip tracewalk</code> </pre> <br>  Untuk saat ini, abaikan suffix <code>=eip</code> untuk mendapatkan izin, saya akan membicarakannya dalam beberapa detik.  Harap dicatat bahwa nama izin adalah huruf kecil.  Sekarang Anda dapat memeriksa apakah Anda telah mengkonfigurasi izin dengan benar dengan: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">setcap</span></span> -v cap_new_raw=eip tracewalk</code> </pre> <br>  Atau Anda dapat mendaftar semua izin yang ditetapkan untuk file yang dapat dieksekusi ini: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">getcap</span></span> tracewalk</code> </pre><br>  Untuk referensi, Anda juga dapat menghapus semua izin dari yang dapat dieksekusi menggunakan: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">setcap</span></span> -r tracewalk</code> </pre> <br>  Pada titik ini, Anda harus dapat menjalankan executable sebagai pengguna yang tidak terjangkau, dan ia harus dapat bekerja dengan soket mentah, tetapi tidak memiliki hak istimewa lain yang dimiliki oleh pengguna root. <br><br>  Jadi apa arti akhiran aneh <code>=eip</code> ?  Ini akan membutuhkan sedikit pemahaman tentang sifat izin.  Setiap proses memiliki tiga set izin - <i>efektif, dapat diwariskan dan diizinkan (efektif, dapat diwariskan dan diizinkan)</i> : <br><br><ul><li>  Izin yang <b>efektif</b> adalah izin yang menentukan proses apa yang sebenarnya dapat dilakukan.  Misalnya, tidak dapat menangani soket mentah jika <code>CAP_NET_RAW</code> tidak dalam set efisien. </li><li>  Izin yang diizinkan adalah izin yang diizinkan dimiliki proses jika memintanya melalui panggilan yang sesuai.  Mereka tidak mengizinkan suatu proses untuk benar-benar melakukan apa pun kecuali itu secara khusus ditulis untuk meminta izin yang ditentukan.  Ini memungkinkan Anda untuk menulis proses untuk menambahkan izin penting ke set efektif hanya untuk periode ketika mereka benar-benar diperlukan. </li><li>  Izin yang dapat diwarisi adalah izin yang dapat diwarisi dalam koleksi proses anak yang tersedia.  Selama operasi <code>fork()</code> atau <code>clone()</code> , proses anak selalu diberikan salinan izin dari proses induk, karena pada saat itu masih menjalankan file executable yang sama.  Set yang diwarisi digunakan ketika <code>exec()</code> (atau yang setara) dipanggil untuk mengganti executable dengan yang lain.  Pada titik ini, set proses yang tersedia disamarkan oleh set yang diwarisi untuk mendapatkan set yang tersedia yang akan digunakan untuk proses baru. </li></ul><br>  Dengan demikian, utilitas <code>setcap</code> memungkinkan kita untuk menambahkan izin dari ketiga set ini secara independen untuk file yang dapat dieksekusi yang diberikan.  Perhatikan bahwa makna grup ditafsirkan sedikit berbeda untuk izin file: <br><br><ul><li>  Izin file yang <b>tersedia</b> adalah yang selalu tersedia untuk dieksekusi, bahkan jika proses induk yang memanggilnya tidak memilikinya.  Mereka dulu disebut izin "paksa". </li><li>  Izin file yang <b>diwarisi</b> menentukan topeng tambahan yang juga dapat digunakan untuk menghapus izin dari set proses panggilan.  Mereka digunakan di samping set yang diwariskan dari proses panggilan, jadi izin hanya diwarisi jika ada di kedua set. </li><li>  Izin file yang <b>efektif</b> sebenarnya hanya satu bit, bukan satu set, dan jika itu diinstal, itu berarti seluruh set yang tersedia juga disalin ke set efektif dari proses baru.  Ini dapat digunakan untuk menambahkan izin ke proses yang tidak secara khusus ditulis untuk meminta mereka.  Karena ini hanya satu bit, jika Anda mengaturnya untuk izin apa pun, itu harus ditetapkan untuk semua izin.  Anda dapat menganggapnya sebagai bit warisan karena digunakan untuk memungkinkan izin untuk aplikasi yang tidak mendukungnya. </li></ul><br>  Saat menentukan izin melalui <code>setcap</code> tiga huruf <code>e</code> , <code>i</code> dan <code>p</code> merujuk ke set yang <i>efisien, diwariskan, dan dapat diakses</i> , masing-masing.  Jadi, spesifikasi sebelumnya: <br><br><pre> <code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">setcap</span></span> cap_net_raw=eip tracewalk</code> </pre> <br>  ... menunjukkan bahwa izin <code>CAP_NET_RAW</code> harus ditambahkan ke set yang tersedia dan diwarisi dan bahwa bit efektif juga harus ditetapkan.  Ini akan mengganti semua izin yang ditetapkan sebelumnya dalam file.  Untuk mengatur beberapa izin sekaligus, gunakan daftar yang dipisahkan koma: <br><br><pre> <code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">setcap</span></span> cap_net_admin,cap_net_raw=eip tracewalk</code> </pre> <br>  <a href="http://www.kernel.org/doc/man-pages/online/pages/man7/capabilities.7.html">Panduan perizinan</a> membahas semua ini secara lebih rinci, tetapi mudah-mudahan posting ini sedikit menggambarkan kejadian tersebut.  Masih menyebutkan beberapa peringatan dan trik. <br><br>  Pertama, kemampuan file tidak berfungsi dengan symlink - Anda harus menerapkannya ke biner itu sendiri (yaitu, ke target symlink). <br><br>  Kedua, mereka tidak bekerja dengan skrip yang ditafsirkan.  Misalnya, jika Anda memiliki skrip Python yang ingin Anda beri izin, Anda harus menugaskannya untuk juru bahasa Python itu sendiri.  Jelas, ini merupakan masalah keamanan potensial, karena dengan demikian semua skrip yang dieksekusi dengan penerjemah ini akan memiliki izin yang ditentukan, meskipun ini masih jauh lebih baik daripada melakukan SUID.  Solusi yang paling umum, tampaknya, adalah menulis file yang dapat dieksekusi terpisah dalam C atau analog yang dapat melakukan operasi yang diperlukan dan menyebutnya dari skrip.  Ini mirip dengan pendekatan yang digunakan oleh Wireshark, yang menggunakan file biner <code>/usr/bin/dumpcap</code> untuk melakukan operasi istimewa: <br><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">getcap</span></span> /usr/bin/dumpcap /usr/bin/dumpcap = cap_net_admin,cap_net_raw+eip</code> </pre> <br>  Ketiga, izin file dinonaktifkan jika Anda menggunakan <code>LD_LIBRARY_PATH</code> lingkungan <code>LD_LIBRARY_PATH</code> untuk alasan keamanan yang jelas <i>(1)</i> .  Hal yang sama berlaku untuk <code>LD_PRELOAD</code> , sejauh yang saya tahu. <br><br>  <i>1. Karena penyerang jelas dapat mengganti salah satu pustaka standar dan menggunakan <code>LD_LIBRARY_PATH</code> untuk memaksa pustaka untuk dipanggil dalam preferensi atas sistem, dan oleh karena itu memiliki kode arbitrer sendiri dieksekusi dengan hak istimewa yang sama dengan aplikasi panggilan.</i> <i><br></i> <br><br>  <i><b>Itu saja.</b></i>  <i><b>Rincian program kursus dapat ditemukan di <a href="https://otus.pw/rbVT/">webinar, yang akan diadakan pada 24 Januari.</a></b></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id483934/">https://habr.com/ru/post/id483934/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id483918/index.html">Pelatihan Perusahaan: Pemimpin Mengajar Pemimpin</a></li>
<li><a href="../id483920/index.html">Kekacauan ketergantungan python</a></li>
<li><a href="../id483922/index.html">Rumah pintar di atas roda ... Alice</a></li>
<li><a href="../id483926/index.html">Three.js dan geometri</a></li>
<li><a href="../id483930/index.html">6 proyek pengembangan web GitHub patut dilihat</a></li>
<li><a href="../id483936/index.html">Kuliah Pengembangan Game</a></li>
<li><a href="../id483938/index.html">Nakamichi: tentang dewa-dewa dari era kaset dan saat-saat ketika matahari terbit bersinar lebih terang</a></li>
<li><a href="../id483940/index.html">70 tahun stereotip: Cara mengatasi ketidakpercayaan Kantor Perumahan menggunakan teknologi IT dan meningkatkan kualitas layanan</a></li>
<li><a href="../id483944/index.html">Bagaimana dan mengapa harus mengantri di dua tumpukan</a></li>
<li><a href="../id483946/index.html">Terikat GPU. Bagian Dua Hutan tanpa akhir</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>