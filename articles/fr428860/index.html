<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí• üßñüèΩ ‚¨úÔ∏è Conf√©rence DEFCON 17. Riez de vos virus! 2e partie üëö ü§¥üèø üê®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conf√©rence DEFCON 17. Riez de vos virus! Partie 1 

 Ensuite, vous pouvez le charger dans l'IDA et voir que tout dans le tableau des adresses import√©e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence DEFCON 17. Riez de vos virus! 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428860/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conf√©rence DEFCON 17. Riez de vos virus!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1</a> <br><br>  Ensuite, vous pouvez le charger dans l'IDA et voir que tout dans le tableau des adresses import√©es semble bien, et nous pouvons suivre les liens crois√©s pour d√©finir le pointeur sur le fichier souhait√©.  Nous arrivons donc √† l'emplacement exact du code de chiffrement d√©pendant. <br><br><img src="https://habrastorage.org/webt/ja/31/xh/ja31xhgboctds-lmvejfwiycixc.jpeg"><br><br>  Ainsi, avec seulement quelques commandes pour vider la m√©moire, nous avons trouv√© l'endroit o√π Coreflood se cachait.  Nous avons d√©mont√©, r√©cup√©r√© et ins√©r√© l'en-t√™te PE sans m√™me l'avoir, et nous avons obtenu une table d'adresses enti√®rement restaur√©e en moins de 20 secondes. <br><br>  L'histoire suivante s'intitule "Ch√©rie, je suis d√©sol√©e de te d√©ranger encore - je suis piqu√© par Internet!"  Cette histoire nous dit que le g√©n√©rateur IP d√©fectueux Conficker.B ne scanne qu'une partie d'Internet.  Nous revenons ici √† la fonction rand.  Une partie importante de cette fonction est la toute derni√®re instruction que j'ai marqu√©e avec une fl√®che verte - elle ex√©cute toute valeur finale dans EAX avec une valeur de 7FFF.  Si vous n'√™tes pas familier avec les principes d'assemblage et ne savez pas ce que cette instruction peut faire, voici une petite d√©monstration √† ce sujet. <br><br><img src="https://habrastorage.org/webt/a8/dh/lj/a8dhljmvnb6hrmu1hrhyosfityw.jpeg"><a name="habracut"></a><br><br>  Nous d√©pla√ßons la valeur maximale que EAX peut contenir dans ce registre et ex√©cutons l'instruction finale.  Vous pouvez voir qu'il ¬´coupe¬ª la moiti√© sup√©rieure de la valeur, puis soustrait 7FFF, qui est converti en 32767 dans le syst√®me d√©cimal. Apparemment, les auteurs ne se sont pas rendu compte que cette restriction qui ex√©cute Windows ne renvoie pas √† l'entier la taille souhait√©e .  Il le "coupe" pour que la valeur ne d√©passe pas 7FFF, de sorte qu'un octet de 7F ne soit jamais sup√©rieur √† cette valeur de 7F, c'est-√†-dire qu'il ne sera jamais √©gal √† 80 ou quelque chose comme √ßa. <br><br>  Plus loin sur le c√¥t√© gauche de la diapositive, que j'ai appel√© la ¬´m√©thode vicieuse¬ª, vous voyez le code Conficker.B.  Cela montre un appel √† rand qui initie le premier octet de l'adresse IP, qui est destin√© √† √™tre analys√© apr√®s son retour de rand.  L'appel syst√®me rand suivant initie les troisi√®me et quatri√®me octets de l'adresse IP, mais √† cause de ce qui pr√©c√®de, deux de ces octets ne seront jamais sup√©rieurs √† 7F.  Ainsi, la plupart d'Internet ne pourront pas √™tre analys√©s car Conficker.B utilise cet algorithme. <br><br>  Sur le c√¥t√© droit de la diapositive se trouve la partie du code source qui montre l'assembleur.  Il est difficile √† lire √† l'√©cran, mais cet exemple est accessible au public et vous pouvez le lire en ligne si vous √™tes int√©ress√©. <br><br><img src="https://habrastorage.org/webt/5u/oj/tb/5uojtbhnvqiisohatadjziviyw8.jpeg"><br><br>  Un lien vers cet outil est situ√© au bas de la diapositive suivante, intitul√© ¬´Simulation de la m√©thode vicieuse¬ª.  Vous pouvez √©galement voir que l'adresse IP est g√©n√©r√©e avec PRNG mais pas analys√©e. <br><br><img src="https://habrastorage.org/webt/7f/bd/vf/7fbdvfj000swmtbqwf7sdddjz3o.jpeg"><br><br>  Je veux dire un grand merci √† Brandon Enright, qui a fait le calendrier sur la diapositive suivante.  Ce graphique s'appelle la ¬´courbe de Hilbert¬ª et je vais maintenant agrandir l'image pour que vous puissiez mieux voir √† l'√©cran.  La couleur bleue dans le graphique indique la plage d'adresses IP qui ne sont pas disponibles pour l'analyse par Conficker.B √† l'aide de cet algorithme vicieux.  La couleur rouge fonc√© indique ce qui peut √™tre num√©ris√©.  Vous voyez que la plupart des parties du graphique ne sont pas rouges, mais violettes, et vous ne verrez pas pourquoi cela se produit tant que vous n'aurez pas augment√© le rectangle correspondant. <br><br><img src="https://habrastorage.org/webt/h0/-y/ar/h0-yarvdaqxrhr0a078wmwxmj-c.jpeg"><br><br>  M√™me dans ce rectangle agrandi, dans chaque bloc / 16, vous voyez beaucoup de fragments bleus qui deviennent rouge fonc√© en violet.  Ce sont les parties des adresses que Conficker.B n'est pas en mesure de num√©riser. <br><br><img src="https://habrastorage.org/webt/jv/z0/gb/jvz0gbqxngvlelc8vzavmvgmulk.jpeg"><br><br>  C'est assez int√©ressant car beaucoup de gens sont s√ªrs que Conficker.B a cr√©√© de "grands esprits".  C'est peut-√™tre le cas, mais ces esprits n'√©taient pas conscients des limitations qui existent dans Windows rand (). <br><br>  <b>Matthew Richard:</b> revenons √† ces gars qui, comme je l'ai dit, ne g√®rent pas tr√®s bien leurs virus, donc dans la cybercriminalit√©, cela s'apparente au proverbe ¬´humain √† loup humain¬ª, donc ces gars-l√† ne sont pas respect√©s dans leurs cercles. <br><br>  Parlons des outils de piratage Neosploit, qui ¬´ont¬ª tout le monde.  On peut dire que la devise de ses d√©veloppeurs √©tait "Merci pour l'argent, maintenant il est temps de courir".  Neosploit est une bo√Æte √† outils pour organiser des attaques Web, donc les gars de la cybercriminalit√© l'ach√®teront et le configureront contre les gars sur le serveur, pirateront le serveur, t√©l√©chargeront des codes, etc. <br><br><img src="https://habrastorage.org/webt/ri/s1/bf/ris1bfmqjh1vrnr2a7hohfm13hg.jpeg"><br><br>  Les cr√©ateurs de Neosploit ont fait un bon investissement en vendant leur outil, mais en ne permettant pas qu'il soit chang√©, modifi√© ou utilis√© en pi√®ces.  La troisi√®me version de cette bo√Æte √† outils a √©t√© publi√©e en avril 2008, et la plupart des exploits uniques sont √©crits en C, donc ce n'est pas PHP ou une sorte d'application Web de merde.  Les clients ont re√ßu une distribution binaire avec un ensemble d'exploits CGI. <br><br>  Neosploit poss√®de des fonctionnalit√©s qui emp√™chent les clients de diviser ou de supprimer les exploits.  Pour ce faire, tous les exploits ont √©t√© pr√©sent√©s au format binaire, chiffr√©s √† l'aide de XOR.  Les cr√©ateurs ont fait en sorte que personne ne puisse couper, coller et cr√©er leur propre ensemble d'exploits bas√© sur Neosploit.  Il existe 40 √† 50 √† 60 diff√©rents types d'attaques Web, qui sont bas√©es sur des codes vol√©s et copi√©s ins√©r√©s dans leurs propres exploits, de sorte que les gars de Neosploit se sont r√©v√©l√©s un peu plus intelligents en cryptant leurs exploits de l'int√©rieur.  Dans la capture d'√©cran, vous voyez qu'ils ont un fichier avec la cl√© neosploit.key, il s'agit donc d'un logiciel sous licence compl√®te. <br><br><img src="https://habrastorage.org/webt/fn/uj/zq/fnujzqvxmuxcczupacqnibg2udq.jpeg"><br><br>  Je ne doute pas qu'ils avaient un tas de tr√®s bons clients qui gagnaient beaucoup d'argent.  Leurs clients les plus c√©l√®bres √©taient Torpig.  Je pense que vous avez entendu parler du rootkit Mebroot, avec lequel ils ont compromis les syst√®mes pour cr√©er un r√©seau de botnet.  Mais les cr√©ateurs de Neosploit avaient de nombreux autres clients.  En mai 2008, ils ont publi√© une nouvelle am√©lioration - la 3e version de leur bo√Æte √† outils.  Les clients ont √©t√© pri√©s de pr√©-payer le package d'exploit avec toutes les mises √† jour ult√©rieures pour 1000 $.  Plus tard, j'en parlerai plus en d√©tail, pour l'instant je remarquerai qu'ils se sont vraiment inqui√©t√©s pour les pirates et ont essay√© de prot√©ger leur produit contre eux autant que possible, donc c'√©tait vraiment tr√®s amusant. <br><br><img src="https://habrastorage.org/webt/ri/o0/gq/rio0gq0dwfkuxt4cvuiu8agdafs.jpeg"><br><br>  M√™me les m√©dias ont √©crit que ces exploits sont partout.  Alors bien s√ªr, nous allons essayer de d√©monter le code et de montrer comment fonctionne Neosploit. <br><br>  La premi√®re chose amusante qu'ils ont faite, apr√®s avoir intens√©ment promu cet ensemble d'exploits d'avril √† juillet, a √©t√© leur soutien du 20 juillet 2008. L'explication qu'ils ont simplement publi√©e sur leur site Web disait ce qui suit: ¬´Malheureusement Un support produit suppl√©mentaire n'est pas possible.  Nous nous excusons pour la g√™ne occasionn√©e, mais les affaires sont les affaires, et le temps consacr√© au projet ne se justifiait pas.  Ces derniers mois, nous avons essay√© jusqu'au dernier pour satisfaire les exigences des clients, mais un jour, le support aurait d√ª cesser.  Nous sommes avec vous depuis un an et demi et nous esp√©rons que ce n'√©tait pas le pire moment pour votre entreprise.  Maintenant, nous ne serons plus pr√®s de chez vous, mais nous souhaitons n√©anmoins que votre entreprise prosp√®re tr√®s longtemps. ¬ª  En g√©n√©ral, nous avons re√ßu votre argent, vous avez pay√© l'abonnement, alors soyez en bonne sant√©! <br><br>  Cependant, ils ont simplement plaisant√© et en ao√ªt 2008 sont revenus et ont publi√© une toute nouvelle version 3.1, qu'ils ont fournie √† leurs principaux clients, indiquant que tous les autres clients recevront une mise √† jour apr√®s avoir pay√©.  Cette mise √† jour comprenait plusieurs nouveaux exploits pour Adobe PDF, Shockwave Flash et Quicktime pour Firefox. <br><br>  Ensuite, ils ont de nouveau d√©cid√© d'√™tre s√©rieux et ont annonc√© qu'ils arr√™taient de publier des mises √† jour, de sorte que tous ceux qui ont souscrit un abonnement pr√©pay√© ont foir√©. <br><br>  Passons donc √† Neosploit, ce kit plut√¥t sympa pour organiser des attaques web.  Parce que ses d√©veloppeurs ont combattu des pirates et vol√© des exploits qui pouvaient √™tre copi√©s et coll√©s dans les kits d'autres personnes, ils ont pris chaque exploit et l'ont plac√© dans un fichier CGI, encodant de telle mani√®re qu'il √©tait tr√®s difficile de le retirer de l√†.  Les binaires d'exploitation C √©taient l√©g√®rement diff√©rents des scripts PHP. <br><br><img src="https://habrastorage.org/webt/ng/sh/fy/ngshfybrz6rq6bop8mraqqh2zzo.jpeg"><br><br>  Sur le blog Neosploit, la phrase de Dancho Danchev a √©t√© publi√©e selon laquelle "n'importe qui peut cr√©er un nouvel exploit", mais c'est assez difficile.  J'ai d√©cid√© de d√©couvrir √† quel point c'√©tait difficile et j'ai commenc√© √† d√©monter l'un des exploits. <br><br>  Chaque exploit a √©t√© stock√© sous forme crypt√©e √† l'aide d'une cl√© XOR √† 3 octets.  Pour chaque demande entrante, l'exploit a √©t√© d√©chiffr√© et fourni √† l'utilisateur pour le travail, et un tel cycle a √©t√© constamment r√©p√©t√©. <br><br><img src="https://habrastorage.org/webt/ej/xa/xr/ejxaxrxb3favuqswsknbhqvzqxk.jpeg"><br><br>  Donc, m√™me si vous pouviez parcourir la m√©moire et supprimer le vidage de la m√©moire, c'est toujours assez difficile, et obtenir tous les exploits, tout de m√™me, ces tampons sont effac√©s √† chaque fois. <br><br>  Heureusement, si vous pouvez copier et coller ces exploits dans le programme dont vous avez besoin, vous pouvez trouver la r√©ponse.  Pour cela, un outil de d√©cryptage tr√®s puissant est utilis√© - les scripts IDA.  Avec lui, vous pouvez commenter ou vider une zone m√©moire sp√©cifique, mettre √† jour les exploits, cela peut √™tre utile pour travailler avec des logiciels malveillants qui utilisent des cha√Ænes compliqu√©es par xor, base64, etc.  J'ai √©crit un script IDE avec lequel j'ai essay√© de d√©monter un vidage de m√©moire captur√© d'un exploit chiffr√©. <br><br><img src="https://habrastorage.org/webt/ph/lh/04/phlh04jr_lkm9h6ammkwchmc5fs.jpeg"><br><br>  Il parcourt tous les objets chiffr√©s, recherche tous les appels aux fonctions de d√©chiffrement, capture les objets chiffr√©s, les d√©chiffre √† l'aide de XOR puis supprime le vidage.  C'est une fa√ßon, mais je pense que vous pourriez √©crire votre propre script, une application qui fait de m√™me.  Si vous savez comment ajouter de nouveaux exploits √† Neosploit, vous pouvez faire quelque chose dans ce sens et bien s√ªr, d√®s que vous supprimez le vidage, vous reconna√Ætrez tout le texte en clair, vous pourrez le ¬´d√©tacher¬ª de l'instrumentation et le revendre.  Les nouveaux gars qui d√©veloppent les exploits ont simplement abandonn√© parce que quelqu'un faisait de l'argent sans se soucier de ses clients. <br><br>  Si quelqu'un a entendu le grand philosophe hip-hop Biggie Smalls de Notorius BIG, alors il conna√Æt sa chanson intitul√©e Ten crack commandments, ¬´The Ten Commandments of Crack¬ª, qui contient une grande sagesse.  Si vous √™tes un trafiquant de drogue, suivez le commandement 4: "Ne vous asseyez jamais sur votre propre drogue que vous poussez."  Probablement le gars que j'ai appel√© Peeper et qui a distribu√© son propre code malveillant n'a jamais entendu cette chanson parce qu'il a test√© son produit sur lui-m√™me. <br><br>  Son attaque √©tait la suivante.  Il a envoy√© des courriels, d√©guis√©s en divers organismes gouvernementaux et s'est adress√© aux gens par le nom: ¬´Cher tel ou tel, quelqu'un a d√©pos√© une plainte contre votre entreprise aupr√®s de la Federal Trade Commission, alors cliquez ici pour t√©l√©charger un document qui d√©taille l'essence¬ª . <br><br><img src="https://habrastorage.org/webt/pd/3e/jk/pd3ejkz0sqnukrbmaqwfa7dpcnc.jpeg"><br><br>  Ensuite, l'utilisateur a suivi le lien et a essay√© de t√©l√©charger ce document, et c'√©tait vraiment un document Word au format .doc.  Cependant, il y avait une fonctionnalit√© tr√®s d√©licate.  Vous avez eu la possibilit√© de simplement glisser-d√©poser des fichiers ex√©cutables √† partir d'un document Word, puis de les renommer, mais lorsque vous avez essay√© de t√©l√©charger le fichier, le message ¬´Microsoft Word a d√©tect√© un probl√®me et le document n'a pas pu √™tre t√©l√©charg√©.  Veuillez double-cliquer sur l'ic√¥ne du document pour continuer. "  Super id√©e! <br><br><img src="https://habrastorage.org/webt/ej/5h/dq/ej5hdqstxn-ym3rh6ymrgjgdimo.jpeg"><br><br>  Naturellement, les gens ont cliqu√©, ils ont cliqu√© 6 fois pour recevoir ce message infect√©, donc ce type a eu un tas de victimes.  J'ai aim√© ce message: "Ils ont essay√© de me pi√©ger, bla bla bla." <br><br>  La prochaine chose que nous avons trouv√©e en suivant ce type √©tait les r√©pertoires ouverts du Drop Directory, o√π il a vid√© les informations qu'il avait re√ßues. <br><br><img src="https://habrastorage.org/webt/-y/cf/f-/-ycff-c-idisj5uxijtbakrzvdu.jpeg"><br><br>  Peut-√™tre qu'il n'avait pas ses propres outils pour les g√©rer, ou il pensait que les r√©pertoires ouverts sont une bonne chose, mais les r√©pertoires ouverts sont mauvais si vous stockez beaucoup d'informations re√ßues de diff√©rentes personnes.  Tout serveur qu'il configurerait pour son site "d'atterrissage" avait un r√©pertoire ouvert, et vous pourriez simplement y aller et voir les listes de toutes ses victimes et chacune individuellement. <br><br>  D'une certaine mani√®re, il √©tait un bon d√©veloppeur car il √©crivait du code de qualit√©.  Mais son inconv√©nient √©tait que lorsqu'il adressait son code √† un serveur en direct, il utilisait sa v√©ritable adresse IP, et vous n'utiliseriez pas longtemps de telles choses. <br><br><img src="https://habrastorage.org/webt/zz/jc/rq/zzjcrqpcs9r8e3bc-271cp3vroi.jpeg"><br><br>  Donc en fait, il avait un modem DSL standard qui a pris contact avec l'Ukraine, il a test√© tout son code et malware, qui a une bonne fonction appel√©e "suivez-moi" ou "suivez-le".  Ce gars √©tait occup√© √† voler des informations bancaires, mais parfois il voulait juste regarder ses victimes pour voir ce qu'elles faisaient, alors nous l'avons appel√© Peeper, ou ¬´Observateur¬ª.  Il n'√©tait pas satisfait de la simple fonctionnalit√© de son logiciel, il a commenc√© √† se surveiller.  Cela semble plut√¥t √©trange, comme si vous ouvriez des fen√™tres d'acc√®s √† distance VNC sur votre propre ordinateur et les boucliez, obtenant des images de plus en plus petites.  En fait, il l'a fait plusieurs fois, sur de nombreux serveurs "d'atterrissage", en effet, c'√©tait tr√®s, tr√®s √©trange.  Donc en regardant √† travers ces serveurs "d'atterrissage", on pourrait dire: "Oh, regardez, c'est une image o√π il s'observe, s'observe, qui s'observe." <br><br><img src="https://habrastorage.org/webt/tu/v1/6v/tuv16vk5cws25lqpqr0lymirwto.jpeg"><br><br>  ¬´Ma lumi√®re, miroir, dis-moi, qui au monde est le plus doux¬ª? <br><br>  J'ai surtout aim√© ce qu'il a fait pour lui-m√™me.  Il a utilis√© cette fonction Follow Me dans le processus de d√©veloppement du code.  En fait, il a √©crit le code, en s'observant, en renvoyant tout cela au serveur de commande et de contr√¥le.  Ainsi, il a permis aux policiers de franchir la porte arri√®re, de le coucher face contre terre et de confisquer son ordinateur.  En bref, rien ne permet de se d√©barrasser de vous comme une image d'une arborescence source attach√©e √† votre adresse IP. <br><br><img src="https://habrastorage.org/webt/q0/ic/f9/q0icf9sq3191sbbcj2jk27t5eiw.jpeg"><br><br>  Le dernier malware que nous examinerons int√©ressera s√ªrement les gens qui connaissent Internet Explorer 7. Mais ne vous inqui√©tez pas, Microsoft dit que tout est sous contr√¥le, faites-leur confiance! <br><br><img src="https://habrastorage.org/webt/dw/7r/2f/dw7r2f9zbestlmksm14of1q72dc.jpeg"><br><br>  Ainsi, Microsoft a eu un gros probl√®me avec Internet Explorer 6, car il √©tait tr√®s facile de voler des mots de passe enregistr√©s dans ce navigateur.  Habituellement, vous allez sur le site, ils vous demandent si vous souhaitez enregistrer le mot de passe, un formulaire sp√©cial est appel√©, vous r√©pondez ¬´oui¬ª et il est enregistr√© dans le registre.  Le probl√®me avec IE 6 √©tait que si vous vous connectez en tant qu'utilisateur, vous n'avez qu'√† effectuer un seul appel syst√®me CryptUnprotectData () pour d√©crypter ces mots de passe qui n'ont vraiment aucune protection. <br><br>  Par cons√©quent, les logiciels malveillants ex√©cut√©s avec des privil√®ges d'utilisateur lisent ces mots de passe librement et les envoient √† l'attaquant.  Par cons√©quent, dans IE 7, ils ont install√© un excellent ¬´patch¬ª - les mots de passe ont √©t√© chiffr√©s avec une cl√© de 128 bits.  Vraiment pas une solution crackable! <br>  Si vous regardez plus en profondeur, vous pouvez voir le hachage disponible sur le site, je l'expliquerai un peu plus tard, dans lequel il y a un fichier binaire contenant le nom d'utilisateur et le mot de passe.  Je veux citer un autre grand philosophe, John Travolta, du film Swordfish.  Mon passage pr√©f√©r√© est quand il est assis l√† et explique: "Ce code est si bon que m√™me je ne peux pas le casser."  Je pense qu'il avait en t√™te le chiffrement 512 bits, et lui, le meilleur chiffreur au monde, pourquoi il a √©t√© embauch√©, dit que m√™me il ne peut pas le faire. <br><br>  Voici donc ce que Microsoft a fait.  Ils chiffrent le mot de passe, pour lequel ils vont g√©n√©rer une cl√© de 128 bits bas√©e sur le hachage MD5 du site pour lequel ils enregistrent ce mot de passe.  Cela semble assez raisonnable, donc si vous allez sur <a href="">www.bank.com/login.sp</a> , ils prendront cette ligne, rendront toutes les lettres en minuscules, puis les encoderont en gros caract√®res et utiliseront l'algorithme MD5, transformant cette ligne en une cl√© qui sera utilis√© pour crypter le mot de passe dans le registre du nom d'utilisateur. <br><br>  Ensuite, lorsque vous visitez ce site pour lequel il existe un mot de passe enregistr√©, ils font le contraire: IE normalise l'URL, transcode la cha√Æne et regarde dans le registre pour voir s'il y a des valeurs stock√©es pour vous.  En d√©tail, cela se passe comme ceci: <br><br><ul><li>  lire le hachage du registre pour chaque URL dans index.dat; </li><li>  L'URL est convertie en minuscules; </li><li>  Les param√®tres GET sont r√©duits; </li><li>  L'URL est convertie en gros caract√®res; </li><li>  si le hachage de la valeur d'URL est √©gal √† n'importe quelle valeur du registre, les donn√©es sont d√©chiffr√©es √† l'aide de cette URL. </li></ul><br>  Cela semble assez raisonnable, mais si vous y r√©fl√©chissez, il y a un petit probl√®me.  En fait, il y a trop peu d'entropie et le pirate peut facilement y faire face.  Ce n'est pas beaucoup plus compliqu√© que le cryptage des mots de passe dans IE 6. <br><br>  Le pirater est assez simple.  Pour enregistrer le mot de passe, l'utilisateur doit visiter le site, qui peut ensuite √™tre facilement trouv√© dans index.dat ou dans la section de cl√© de registre ¬´TypedURLS¬ª.  Si nous consid√©rons uniquement les √âtats-Unis, il existe environ 15 000 sites de banques et coop√©ratives de cr√©dit, et vous pouvez facilement les trouver.  Vous connaissez les sites pour lesquels vous souhaitez trouver des mots de passe, et chacun de ces sites poss√®de des pages de connexion, il est donc facile de rassembler toute une collection de cl√©s.  Comme vous pouvez le voir, la protection ici est clairement insuffisante. <br><br>  Bien s√ªr, si vous √™tes un m√©chant, vous connaissez probablement beaucoup de sites qui ont besoin de mots de passe: Facebook, Myspace ou Twitter ou autres avec une page de connexion, vous pouvez donc simplement trouver ces sites.  Vous pouvez utiliser le service Alexa, qui maintient une liste des sites les plus populaires, en collectant des statistiques sur leur trafic.  Les cl√©s sont vraiment faciles √† d√©crypter, vous pouvez faire quelque chose comme une ¬´table arc-en-ciel¬ª Rainbow Table bas√©e sur ces sources courantes et vous aurez alors toutes les cl√©s pour d√©crypter les mots de passe. <br><br>      ,      IE 7  :    ,     . <br><br>      ?  , .       .       ,  Mozilla Firefox,  ,           .      ,      ,     ,   ¬´Remember My password¬ª.         .      Firefox  IE 7    ,          ,       ,   ,      . <br><br>  ,    ,        ,      . <br><br>       Laqma.   ,       ,     .     -  ,      ,  ,          command and control. <br><br><img src="https://habrastorage.org/webt/ri/uf/c3/riufc3cranwrsexq9e-h98otht4.jpeg"><br><br>     ,     .        ,     ,   PHP -,          PHP    ,    ‚Äì    . <br><br>         . <br><br> <b> :</b> ,    ,    ,    .           ,    .     Laqma,   .  ,              ,  Laqma   ,        .      ,       SSDT,                IDA  - . <br>  ,         Volatility,     .       ,  Laqma,     SSDT ,     ,   .         SSDT,   ,     SSDT,       SSDT. <br><br><img src="https://habrastorage.org/webt/w3/n1/df/w3n1df_7w3g1g1oma3ab8gp-lca.jpeg"><br><br>          TOS,         win32k,         ,      .     SSDT           ,      ,     TOS   win32k. <br><br>     ,   ,     ,  , drv, .sys,              .   ,   .   ,  SSDT    .               . <br><br><img src="https://habrastorage.org/webt/9z/q7/ye/9zq7yepu35kywoygfintms0bq6k.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ce processus est l√©g√®rement automatis√© √† l'aide du plugin SSDT. </font><font style="vertical-align: inherit;">Vous voyez comment BSOD a clignot√© √† l'√©cran, cela a fonctionn√© le programme de ligne de commande IDA. </font><font style="vertical-align: inherit;">√Ä la suite du traitement automatique, un IDB est cr√©√©, c'est un peu plus d'automatisation, √† la suite de quoi les fonctions IDB correspondant aux fonctions SSDT ¬´accroch√©es¬ª sont signal√©es. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, avec une petite √©tape, nous avons appris quelles fonctions SSDT √©taient associ√©es au vidage qui poss√®de le module IDB cr√©√©, et nous pourrions les nommer pour savoir exactement o√π chercher dans IDB lorsque je commence la r√©tro-ing√©nierie. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'esp√®re que tu t'es amus√©!</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en le recommandant √† vos amis, une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√©s pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbit / s jusqu'en d√©cembre gratuitement</b> en payant pour une p√©riode de six mois, vous pouvez commander <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 Go DDR4 6x480 Go SSD 1 Gbps 100 TV √† partir de 249 $</a> aux Pays-Bas et aux √âtats-Unis!</b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428860/">https://habr.com/ru/post/fr428860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428850/index.html">Gestion du d√©veloppement dans un grand projet</a></li>
<li><a href="../fr428852/index.html">Diffusion ouverte de la salle principale HighLoad ++ 2018</a></li>
<li><a href="../fr428854/index.html">Comment couper la lumi√®re dans un petit centre de donn√©es: un moyen peu co√ªteux de d√©ployer une urgence</a></li>
<li><a href="../fr428856/index.html">Une merveilleuse astuce pour faire du mainteneur de projet open source un jour</a></li>
<li><a href="../fr428858/index.html">Conf√©rence DEFCON 17. Riez de vos virus! Partie 1</a></li>
<li><a href="../fr428864/index.html">Rendons le Web encore meilleur</a></li>
<li><a href="../fr428866/index.html">7 principes de design, attitude face aux tendances du design, portfolio UX-designer, ...</a></li>
<li><a href="../fr428868/index.html">Fichiers JAR √† plusieurs versions - mauvais ou bon?</a></li>
<li><a href="../fr428870/index.html">Mrr: FRP total pour React</a></li>
<li><a href="../fr428872/index.html">L'histoire d'un ≈ìil et de 20 op√©rations (non lisible) ou il voulait √™tre pilote, mais il n'√©tait pas autoris√© √† voler dans le ciel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>