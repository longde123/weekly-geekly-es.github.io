<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🤝‍👨🏻 🥣 🕉️ Génération de code dans Dart. Partie 2. Annotations, source_gen et build_runner 🏇🏾 🍚 🐡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la première partie, nous avons découvert pourquoi la génération de code est nécessaire et répertorié les outils nécessaires pour la génération de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Génération de code dans Dart. Partie 2. Annotations, source_gen et build_runner</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446264/"><p>  Dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">première partie,</a> nous avons découvert pourquoi la génération de code est nécessaire et répertorié les outils nécessaires pour la génération de code dans Dart.  Dans la deuxième partie, nous apprendrons comment créer et utiliser des annotations dans Dart, ainsi que comment utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">source_gen</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">build_runner</a> pour démarrer la génération de code. </p><br><p><img src="https://habrastorage.org/webt/ol/eq/iu/oleqiu6qqryyv2otgwkcpwadrms.png"></p><a name="habracut"></a><br><h1 id="annotacii-v-dart">  Annotations de fléchettes </h1><br><p> Les annotations sont des métadonnées syntaxiques qui peuvent être ajoutées au code.  En d'autres termes, c'est l'occasion d'ajouter des informations supplémentaires à n'importe quel composant du code, par exemple, à une classe ou une méthode.  Les annotations sont largement utilisées dans le code Dart: nous utilisons <code>@required</code> pour indiquer qu'un paramètre nommé est requis, et notre code ne se compilera pas si le paramètre annoté n'est pas spécifié.  Nous utilisons également <code>@override</code> pour indiquer qu'une API donnée définie dans une classe parent est implémentée dans une classe enfant.  Les annotations commencent toujours par le symbole <code>@</code> . </p><br><h3 id="kak-sozdat-svoyu-annotaciyu">  Comment créer votre propre annotation? </h3><br><p>  Bien que l'idée d'ajouter des métadonnées au code semble un peu exotique et compliquée, les annotations sont l'une des choses les plus simples du langage Dart.  Il a été dit précédemment que les <em>annotations contiennent simplement des informations supplémentaires</em> .  Ils sont similaires aux <strong>PODO</strong> (Plain Old Dart Objects).  Et <em>n'importe quelle classe peut servir d'annotation si un constructeur <code>const</code> est défini</em> : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String todoUrl; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Todo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.name, {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.todoUrl})</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Todo</span></span>(<span class="hljs-string"><span class="hljs-string">'hello first annotation'</span></span>, todoUrl: <span class="hljs-string"><span class="hljs-string">'https://www.google.com'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelloAnnotations</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br><p>  Comme vous pouvez le voir, les annotations sont très simples.  Et ce qui compte, c'est ce que nous ferons de ces annotations.  Cela nous aidera à <code>source_gen</code> et <code>build_runner</code> . </p><br><h3 id="kak-ispolzovat-build_runner">  Comment utiliser build_runner? </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>build_runner</code></a> est un package Dart qui nous aidera à générer des fichiers à l'aide du code Dart.  Nous allons configurer les fichiers <code>Builder</code> en utilisant <code>build.yaml</code> .  Lorsqu'il est configuré, <code>Builder</code> sera appelé à chaque commande de <code>build</code> ou lorsque le fichier est modifié.  Nous avons également la possibilité d'analyser du code qui a été modifié ou qui répond à certains critères. </p><br><h3 id="source_gen-dlya-ponimaniya-dart-koda">  source_gen pour comprendre le code Dart </h3><br><p>  Dans un sens, <code>build_runner</code> est un mécanisme qui répond à la question " <strong>Quand</strong> dois-je générer du code?"  Dans le même temps, <code>source_gen</code> répond à la question « <strong>Quel</strong> code doit être généré?».  <code>source_gen</code> fournit un cadre pour créer des <code>build_runner</code> pour que <code>build_runner</code> fonctionne.  <code>source_gen</code> fournit également une API pratique pour analyser et générer du code. </p><br><h1 id="sobiraem-vse-vmeste-todo-report">  Tout mettre ensemble: rapport TODO </h1><br><p>  Dans la suite de cet article, nous <strong>démonterons le</strong> projet <strong>todo_reporter.dart</strong> , qui se trouve <a href="">ici</a> . </p><br><p>  Il existe une règle non écrite que tous les projets qui utilisent la génération de code suivent: vous devez créer un <strong>package contenant des annotations</strong> et un <strong>package distinct pour le générateur</strong> qui utilise ces annotations.  Vous trouverez ici des informations sur la création d'une bibliothèque de packages dans Dart / Flutter. </p><br><p>  Vous devez d'abord créer le répertoire <code>todo_reporter.dart</code> .  Dans ce répertoire, vous devez créer le répertoire <code>todo_reporter</code> , qui contiendra l'annotation, le répertoire <code>todo_reporter_generator</code> pour traiter l'annotation et, enfin, l' <code>example</code> répertoire contenant une démonstration des capacités de la bibliothèque en cours de création. </p><br><p>  Le suffixe <code>.dart</code> été ajouté au nom du répertoire racine pour plus de clarté.  Bien sûr, ce n'est pas nécessaire, mais j'aime suivre cette règle pour indiquer avec précision le fait que ce package peut être utilisé dans n'importe quel projet Dart.  Au contraire, si je voulais indiquer que ce package est uniquement pour Flutter (comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ozzie.flutter</a> ), j'utiliserais un suffixe différent.  Ce n'est pas nécessaire, c'est juste une convention de dénomination à laquelle j'essaie d'adhérer. </p><br><h3 id="sozdanie-todo_reporter-nashego-prostogo-paketa-s-annotaciey">  Création de todo_reporter, notre package d'annotation simple </h3><br><p>  Nous allons créer <code>todo_reporter</code> dans <code>todo_reporter.dart</code> .  Pour ce faire, créez le fichier <code>pubspec.yaml</code> et le répertoire <code>lib</code> . </p><br><p>  <code>pubspec.yaml</code> très simple: </p><br><pre> <code class="plaintext hljs">name: todo_reporter description: Keep track of all your TODOs. version: 1.0.0 author: Jorge Coca &lt;jcocaramos@gmail.com&gt; homepage: https://github.com/jorgecoca/todo_reporter.dart environment: sdk: "&gt;=2.0.0 &lt;3.0.0" dependencies: dev_dependencies: test: 1.3.4</code> </pre> <br><p>  Il n'y a pas de dépendances à l'exception du package de <code>test</code> utilisé dans le processus de développement. </p><br><p>  Dans le répertoire <code>lib</code> , procédez comme suit: </p><br><ul><li>  Vous devez créer un fichier <code>todo_reporter.dart</code> dans lequel, à l'aide de l' <code>export</code> , toutes les classes qui ont une API publique seront spécifiées.  C'est une bonne pratique, car n'importe quelle classe de notre package peut être importée en utilisant <code>import 'package:todo_reporter/todo_reporter.dart';</code>  .  Vous pouvez voir cette classe <a href="">ici</a> . </li><li>  À l'intérieur du répertoire <code>lib</code> , nous allons créer le répertoire <code>src</code> contenant tout le code - public et non public. </li></ul><br><p>  Dans notre cas, il suffit d'ajouter une annotation.  Créons un fichier <code>todo.dart</code> avec notre annotation: </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Todo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String todoUrl; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Todo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.name, {</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.todoUrl})</span></span></span><span class="hljs-function"> : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">assert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name != </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">null</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; }</code> </pre> <br><p>  C'est tout ce qu'il faut pour annoter.  J'ai dit que ce sera simple.  Mais ce n'est pas tout.  Ajoutons des tests unitaires au répertoire de <code>test</code> : </p><br><div class="spoiler">  <b class="spoiler_title">todo_test.dart</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:test/test.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ group(<span class="hljs-string"><span class="hljs-string">'Todo annotation'</span></span>, () { test(<span class="hljs-string"><span class="hljs-string">'must have a non-null name'</span></span>, () { expect(() =&gt; Todo(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>), throwsA(TypeMatcher&lt;AssertionError&gt;())); }); test(<span class="hljs-string"><span class="hljs-string">'does not need to have a todoUrl'</span></span>, () { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> todo = Todo(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); expect(todo.todoUrl, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'if it is a given a todoUrl, it will be part of the model'</span></span>, () { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> givenUrl = <span class="hljs-string"><span class="hljs-string">'http://url.com'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> todo = Todo(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, todoUrl: givenUrl); expect(todo.todoUrl, givenUrl); }); }); }</code> </pre> </div></div><br><p>  C'est tout ce dont nous avons besoin pour créer l'annotation.  Vous pouvez trouver le code <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Maintenant, nous pouvons aller au générateur. </p><br><h3 id="delaem-klassnuyu-rabotu-todo_reporter_generator">  Faire un travail sympa: todo_reporter_generator </h3><br><p>  Maintenant que nous savons comment créer des packages, créons le package <code>todo_reporter_generator</code> .  A l'intérieur de ce paquet devrait se <code>build.yaml</code> <code>pubspec.yaml</code> et <code>build.yaml</code> et un répertoire <code>lib</code> .  Le répertoire <code>lib</code> doit avoir le répertoire <code>src</code> et le fichier <code>builder.dart</code> .  Notre <code>todo_reporter_generator</code> est considéré comme un package séparé qui sera ajouté en tant que <code>dev_dependency</code> à d'autres projets.  En effet, la génération de code n'est nécessaire qu'au stade du développement et n'a pas besoin d'être ajoutée à l'application terminée. </p><br><p>  <code>pubspec.yaml</code> le suivant: </p><br><pre> <code class="plaintext hljs">name: todo_reporter_generator description: An annotation processor for @Todo annotations. version: 1.0.0 author: Jorge Coca &lt;jcocaramos@gmail.com&gt; homepage: https://github.com/jorgecoca/todo_reporter.dart environment: sdk: "&gt;=2.0.0 &lt;3.0.0" dependencies: build: '&gt;=0.12.0 &lt;2.0.0' source_gen: ^0.9.0 todo_reporter: path: ../todo_reporter/ dev_dependencies: build_test: ^0.10.0 build_runner: '&gt;=0.9.0 &lt;0.11.0' test: ^1.0.0</code> </pre> <br><p>  <code>build.yaml</code> maintenant <code>build.yaml</code> .  Ce fichier contient la configuration nécessaire à nos <em>constructeurs</em> .  Plus de détails peuvent être trouvés <a href="">ici</a> .  <code>build.yaml</code> le suivant: </p><br><pre> <code class="plaintext hljs">targets: $default: builders: todo_reporter_generator|todo_reporter: enabled: true builders: todo_reporter: target: ":todo_reporter_generator" import: "package:todo_reporter_generator/builder.dart" builder_factories: ["todoReporter"] build_extensions: {".dart": [".todo_reporter.g.part"]} auto_apply: dependents build_to: cache applies_builders: ["source_gen|combining_builder"]</code> </pre> <br><p>  La propriété <code>import</code> pointe vers le fichier qui contient le <code>builder_factories</code> et la propriété <code>builder_factories</code> pointe vers les méthodes qui généreront le code. </p><br><p>  Nous pouvons maintenant créer le fichier <code>builder.dart</code> dans le répertoire <code>lib</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:build/build.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:source_gen/source_gen.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter_generator/src/todo_reporter_generator.dart'</span></span>; <span class="hljs-function"><span class="hljs-function">Builder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">todoReporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BuilderOptions options)</span></span></span><span class="hljs-function"> </span></span>=&gt; SharedPartBuilder([TodoReporterGenerator()], <span class="hljs-string"><span class="hljs-string">'todo_reporter'</span></span>);</code> </pre> <br><p>  Et le fichier <code>todo_reporter_generator.dart</code> dans le répertoire <code>src</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'dart:async'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:analyzer/dart/element/element.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:build/src/builder/build_step.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:source_gen/source_gen.dart'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TodoReporterGenerator</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GeneratorForAnnotation</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Todo</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@override</span></span> <span class="hljs-function"><span class="hljs-function">FutureOr&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateForAnnotatedElement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( Element element, ConstantReader annotation, BuildStep buildStep)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"// Hey! Annotation found!"</span></span>; } }</code> </pre> <br><p>  Comme vous pouvez le voir, dans le fichier <code>builder.dart</code> , nous avons défini la méthode <code>todoReporter</code> le <code>todoReporter</code> .  <code>Builder</code> <code>SharedPartBuilder</code> est créé à l'aide de <code>SharedPartBuilder</code> , qui utilise notre <code>TodoReporterGenerator</code> .  Donc <code>build_runner</code> et <code>source_gen</code> fonctionnent ensemble. </p><br><p>  Notre <code>TodoReporterGenerator</code> est une sous-classe de <code>GeneratorForAnnotation</code> , donc la méthode <code>generateForAnnotatedElement</code> ne sera exécutée que lorsque cette annotation ( <code>@Todo</code> dans notre cas) se trouve dans le code. </p><br><p>  La méthode <code>generateForAnnotatedElement</code> renvoie une chaîne contenant notre code généré.  <strong>Si le code généré ne se compile pas, la phase de génération entière échouera</strong> .  Ceci est très utile car il évite les erreurs à l'avenir. </p><br><p>  Ainsi, à chaque génération de code, notre <code>todo_repoter_generator</code> créera un fichier <code>part</code> , avec commentaire <code>// Hey! Annotation found!</code> <code>// Hey! Annotation found!</code>  Dans le prochain article, nous apprendrons comment traiter les annotations. </p><br><h1 id="sobiraem-vse-vmeste-ispolzovanie-todo_reporter">  Mettre tout cela ensemble: en utilisant todo_reporter </h1><br><p>  Vous pouvez maintenant montrer comment <code>todo_reporter.dart</code> .  Il est recommandé d'ajouter un <code>example</code> projet lorsque vous travaillez avec des packages.  Ainsi, d'autres développeurs pourront voir comment l'API peut être utilisée dans un vrai projet. </p><br><p>  Créons un projet et ajoutons les dépendances requises à <code>pubspec.yaml</code> .  Dans notre cas, nous allons créer un projet Flutter dans le répertoire d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><code>example</code></a> et ajouter les dépendances: </p><br><pre> <code class="plaintext hljs">dependencies: flutter: sdk: flutter todo_reporter: path: ../todo_reporter/ dev_dependencies: build_runner: 1.0.0 flutter_test: sdk: flutter todo_reporter_generator: path: ../todo_reporter_generator/</code> </pre> <br><p>  Après avoir reçu les paquets (les paquets <code>flutter packages get</code> ), nous pouvons utiliser notre annotation: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">'package:todo_reporter/todo_reporter.dart'</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Todo</span></span>(<span class="hljs-string"><span class="hljs-string">'Complete implementation of TestClass'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestClass</span></span></span><span class="hljs-class"> </span></span>{}</code> </pre> <br><p>  Maintenant que tout est en place, lancez notre générateur: </p><br><pre> <code class="bash hljs">$ flutter packages pub run build_runner build</code> </pre> <br><p>  Une fois la commande terminée, vous remarquerez un nouveau fichier dans notre projet: <code>todo.g.dart</code> .  Il contiendra les éléments suivants: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// GENERATED CODE - DO NOT MODIFY BY HAND part of 'todo.dart'; // ***************************************************************** // TodoReporterGenerator // ******************************************************************** // Hey! Annotation found!</span></span></code> </pre> <br><p>  Nous avons réalisé ce que nous voulions!  Nous pouvons maintenant générer le fichier Dart correct pour chaque annotation <code>@Todo</code> dans notre code.  Essayez d'en créer autant que vous en avez besoin. </p><br><h1 id="v-sleduyuschey-state">  Dans le prochain article </h1><br><p>  Nous avons maintenant les bons paramètres pour générer des fichiers.  Dans le prochain article, nous apprendrons à utiliser les annotations pour que le code généré puisse faire des choses vraiment cool.  Après tout, le code généré actuellement n'a pas beaucoup de sens. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446264/">https://habr.com/ru/post/fr446264/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446244/index.html">Extensions Chrome pour le développement Web et travailler avec GitHub</a></li>
<li><a href="../fr446248/index.html">Annonce du Meetup FunTech QA-Automation</a></li>
<li><a href="../fr446252/index.html">Sauvegarder une partition dans Debian en cas de problème</a></li>
<li><a href="../fr446254/index.html">Comment booster rapidement votre réseau sans fil</a></li>
<li><a href="../fr446258/index.html">Techniques de développement mobile Jedi: comment monétiser l'application en 2019?</a></li>
<li><a href="../fr446266/index.html">Ampoules biochimiques</a></li>
<li><a href="../fr446272/index.html">Combien coûte OpenSource</a></li>
<li><a href="../fr446276/index.html">La mission Chang'e-4 est le quatrième jour lunaire pour le module d'atterrissage et le rover Yutu-2. À propos des caméras et des contrôleurs sur les appareils</a></li>
<li><a href="../fr446278/index.html">Le rôle du système IGF-1 dans la modulation de la longévité: contradictions et nouvelle compréhension du point de vue des centenaires</a></li>
<li><a href="../fr446280/index.html">Section des sciences au DUMP: élargissez vos horizons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>