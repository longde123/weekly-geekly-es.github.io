<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛅 ✊🏾 🗒️ DEFCON会议16. Fedor，InSecure.org黑客。 NMAP在线扫描 👸🏽 👨🏾‍🤝‍👨🏼 👰🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="下午好，我叫Fedor，来自InSecure.org ，是1997年发布的Nmap安全扫描程序项目的作者。 我要感谢所有来这里的人，以及Defcon本人邀请我来这里。 我是这类会议的忠实拥护者，在那儿，那些对业余技术怀有真正热情但又不愿意为门票支付数千美元的公司的人会来。 

 我想警告您，这次对话...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON会议16. Fedor，InSecure.org黑客。 NMAP在线扫描</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/422767/">下午好，我叫Fedor，来自<b>InSecure.org</b> ，是1997年发布的<b>Nmap</b>安全扫描程序项目的作者。 我要感谢所有来这里的人，以及<b>Defcon</b>本人邀请我来这里。 我是这类会议的忠实拥护者，在那儿，那些对业余技术怀有真正热情但又不愿意为门票支付数千美元的公司的人会来。 <br><br> 我想警告您，这次对话不是关于如何对社交网络进行跨站点脚本攻击或如何破解<b>Twitter</b>频道。 它与端口扫描有关，而不仅仅是端口扫描，如果您不喜欢端口扫描，那么接下来的50分钟对您来说将是最糟糕的噩梦。 <br><br><img src="https://habrastorage.org/webt/9v/is/84/9vis84enhamknaaxpa5xhr42w4s.jpeg"><br><br> 因为对我来说，谈论其他事情和听不谈论<b>DNS的</b> Dan Kaminsky一样罕见。 我的意思是，我可以像Dan Dan可以使用其<b>DNS</b>并使用它来引导<b>YouTube</b>愚弄某些白痴一样，着手发现某些操作系统或<b>Nmap</b>脚本处理程序的动作，但是在两种情况下，我们都只是扩展了密钥话题。 <br><br> 从第一张幻灯片中可以看到，我的主题是有关扫描Internet。 今年夏天，我花了大量时间扫描Internet上的数千万台主机并收集必要的数据。 <br><br> 当我告诉人们这件事时，他们经常问：“为什么？” 对我来说，扫描本身就是很有价值的，但是如果您需要某些原因，那么在这种情况下，我就有了该项目的一些特定目标。 首先是收集经验数据，并使用它来扩展和改进<b>Nmap</b>的功能，我们将在稍后讨论。 <a name="habracut"></a><br><br> 第二个目标是使用数据来帮助知识渊博的人更有效地进行扫描。 有很多人收集有关网络结构和人口的信息，以找出最好的扫描方法。 但是通常他们会想知道如何自定义现有的扫描工具而找不到合适的工具。 为了使您可以根据自己的需要使用我的经验数据，它们将帮助您学习如何扫描和收集结果。 <br><br><img src="https://habrastorage.org/webt/oy/uq/dl/oyuqdl-ntfkjp2b3_dha_dtz0hk.jpeg"><br><br> 第三个目标是检测和修复<b>Nmap</b>错误并提高大规模扫描的性能。 由于在各种情况下都会扫描数百万台主机，因此您可以跟踪<b>Nmap对其的</b>响应。 我设法解决了导致系统崩溃或死机的错误，并通过找出导致扫描速度降低的确切原因来加快了处理速度。 <br><br> 第四个目标是演示可用于Internet的常规扫描和大规模扫描的技术。 <br><br> 这个想法是，如果此扫描适用于2500万台主机，则可能可以扫描25,000台主机或您需要扫描多少台主机。 <br> 让我们看一下扫描时必须面对的问题。 首先，我想说的是，最好进行数十次大型但有针对性的扫描，而不是一次大型扫描。 这些目标中的每一个都允许您收集某种有用的数据，但是问题是确定需要扫描的特定IP地址。 <br><br> 这样做有很多可能性： <b>BGP</b>路由表，可让您知道要路由的网络，DNS区域文件，寄存器分配表等。 <br><br><img src="https://habrastorage.org/webt/ga/3e/ju/ga3eju_sc7izbygov4butufo4_i.jpeg"><br><br> 我决定使用自己的脚本化<b>Nmap</b> IP地址生成器，该生成器使我可以创建25,000,000个IP地址，并且由于可能重复，所以又增加了200,000个。 同时，实际上不是扫描计算机，而是扫描计算机的列表，因为稍后我会扫描计算机本身。 结果，我得到了一个曾经扫描的2500万IP地址的列表。 这是一种生成随机数的方法，但是一旦您有需要扫描的特定目标，就会出现以下问题：您将使用什么来源。 <br><br> 在这里，我有很多想法，一个比另一个更疯狂，例如P2P扫描。 我打算分发一个名为<b>Nmapster</b>的客户端，人们可以下载该客户端。 他会扫描他们的计算机，并说我们收集数据进行概括。 但是我认为主要目标是使<b>Nmap</b>更快，更高效地进行日常扫描，并且最好专注于使用<b>Nmap</b>本身，而不是为其创建自定义程序。 <br><br> 第二大障碍是这种行为的非法性。 当您扫描许多主机时，人们可能会感到愤怒，并且我不希望我的ISP拒绝再次提供我，但是被捕的可能性看起来更糟。 因此，我决定通过邻居的免费无线接入点（掌声和欢笑）上网。 <br><br> 不，我只是在开玩笑，此外，我邻居的互联网频道没有足够的带宽来处理所需的流量。 <br><br> 因此，我决定使用用于托管的ISP，并从那里进行扫描，即通过位于其领土上的设备进行扫描。 扫描开始后15分钟，这些家伙与我联系，疯狂地问到底是怎么回事，也许我的计算机感染了Internet上最严重的蠕虫，因为它发疯了，并每秒在Internet上探测数千辆汽车！ 他们建议与我断开连接，但我向他们解释说，他们不必担心，不会受到伤害，我这样做是出于特定的目的。 然后他们认为如果可能的话，我是垃圾邮件发送者，或更糟的是，我需要被逮捕。 然后我感到害怕，并以为自己完成了，所以我不得不放弃我的项目，开始研究跨站点漏洞。 幸运的是，事实证明他们是<b>Nmap的</b>用户，我能够解释说此扫描对于使我的程序更高效和更具生产力是必要的。 他们对此说：“那么，您可以继续！” <br><br> 由于不希望保险丝烧断，因此我略微降低了扫描速度，因此继续进行这项出色的工作。 不幸的是，美国国防部并不那么友善，他们根本不喜欢我的扫描，他们告诉我不要扫描重要的军事设施。 我以为<b>Nmap</b>跳过扫描某些网络的功能对我很有用，但它们甚至不能让我识别这些网络，因为它们也是军事设施。 因此从那以后，如果军用飞机飞过我的头顶，我会有点紧张。 <br><br><img src="https://habrastorage.org/webt/hf/ll/6-/hfll6-8r-tzrkxmmib8mjlfwwp8.jpeg"><br><br> 扫描的下一个障碍是防火墙。 在某些情况下，对于我来说，从不受保护的Internet区域中获取结果就足够了，但是对于其他情况，最好研究一下它在公司防火墙后面的样子。 您知道它们通常控制不同的端口，因此从内部看，开放网络看起来完全不同。 我很高兴地说，我能够突破一系列防火墙，而不是借助高级碎片攻击之类的东西，而是借助简单地“询问”它们以提供必要数据的技术。 <br><br> 有许多大型公司每天都使用<b>Nmap</b>扫描其网络，他们很乐意以数据的形式提供有助于改善网络的信息。 <br><br> 接下来的问题是性能和准确性。 扫描互联网是一项漫长而艰巨的工作。 关键目标是提高Nmap的性能，因为其使用情况统计令人失望： <br><br><ul><li> 自扫描开始以来经过的时间93 h 57分钟。  40秒（超过4天）； </li><li> 在此期间，在254868个计划的主机中，对2048个主机上的65,000个端口进行了UDP扫描； </li><li> 在此期间，将执行UDP扫描，大约是计划数量的11.34％，扫描剩余主机的时间将为688小时41分48秒。 </li></ul><br> 当您对剩余时间的估计导致“整数溢出”并带来一个负数时，这不是一个令人鼓舞的信号。 特定的扫描仍在进行中，也许在明年的DEFCON会议上，我会告诉您它的结果。 幸运的是，我们的其他一些扫描更早结束了，因此这是对我们执行哪种类型的扫描及其原因的一种介绍。 <br><br> 现在，让我们继续一些实用的技巧，这些技巧可以作为有用的细节，并让您知道如何将其用作自己的扫描工具。 主机发现是一个好的开始，因为重新侦察网络时您要做的第一件事是找到主机并找出可用于扫描的网络。 因此，您不应浪费时间扫描主机未侦听的IP地址，并决定要扫描的方法。 <br><br> 曾经有一段时间，大多数主机默认情况下都会响应<b>Nmap</b>发送到端口80的<b>ICMP</b>回显请求或ping数据包，但不幸的是，此时间结束于10年前。 <br><br><img src="https://habrastorage.org/webt/_a/fs/mw/_afsmwlpzn-nhxdeg02dccxrm-k.jpeg"><br><br> 现在，大多数公司都阻止ping程序包，我不得不使用更有效的方法。 <br><br> 第一种是用于使用<b>SYN（-PS）</b>合成数据包检测主机的<b>TCP</b>方法，该方法最适合于使用恒定例外列表的静态过滤防火墙和使用对动态过滤防火墙有效的<b>ACK（-PA）</b>数据包。 <br><br> 那些允许合成数据包通过的防火墙通常会阻止<b>ACK</b>数据包，反之亦然。 <br><br> 我将展示一个简单的示例，其中将<b>nmap</b>与合成包一起用于<b>sun.com的</b>端口80。 如您所见，答案很快就出现了，它表明主机可用。 <br><br><img src="https://habrastorage.org/webt/al/bu/3s/albu3sgpef4jt-4iqjbkty9ho1s.jpeg"><br><br> 然后，我们对同一主机使用<b>ACK</b>数据包，您会看到扫描时间更长，并且主机没有响应我们，因为它阻止了ping感应。 <br><br><img src="https://habrastorage.org/webt/2s/nq/qx/2snqqx8epjv16gzopg9rqc9nk4y.jpeg"><br><br> 因此，您可以了解使用静态过滤或动态过滤在该主机上安装了哪个防火墙。 在这种情况下，我们有一个静态防火墙，它跳过了<b>SYN</b>数据包并阻止了<b>ACK</b>数据包。 <br><br> 可能会出现问题，哪种端口检测更好使用。 我会回答-您需要发送两种类型的数据包，直到主机通过其中一种。 <br><br> 下一个问题是要使用哪个端口。 您有65,000个端口，通常不可能选择最有效的端口。 因此，我根据经验数据选择了端口，这在下一张幻灯片中显示。 这是检测某些类型主机的最佳10个端口。 <br><br><img src="https://habrastorage.org/webt/mf/p4/qj/mfp4qjgn7gqraj12nk9eyqmll-k.jpeg"><br><br> 某些人可能会查看此列表并询问，最常见的<b>Windows</b>端口135或139在哪里？ <br><br> 但是，请记住，我是在受良好保护的主机的基础上创建数据库的，因此，如果您在安装防火墙时遇到问题，则最好阻止这些<b>Windows</b>端口。 我建议使用<b>SYN数据包</b> “探查”这些端口的一部分，另一部分-使用<b>ACK</b>包。 <br><br> 接下来，我们有<b>UDP</b>主机发现。 在这种情况下，封闭的<b>UDP</b>端口比开放的<b>UDP</b>端口更好，因为它们更容易回答。 打开的端口接收到干净的数据包，不知道如何处理它，而只是忽略它。 封闭端口通常禁止此类数据包，这意味着主机在此处。 端口53通常属于防火墙例外，因为它用于<b>DNS</b> 。 <br><br> 我还使用了<b>ICMP</b>主机发现方法<b>（PE，PM，PP）</b> 。 一些系统很容易接受ping，但阻止了其他系统。 例如， <b>Google.com</b>管理员在接收到ping数据包时没有看到威胁，但是他们阻止网络掩码请求和时间戳，因为他们相信黑客会使用它们。 <br><br> 其他管理员以黑客的身份明确阻止回显请求，但忘记了阻止网络掩码请求和<b>网络掩码/时间戳记</b>时间戳。 因此，我建议您同时使用两种类型的请求-回显请求和第二种类型的请求之一。 <br><br> 我们还有一个称为<b>协议Ping（PO）</b>的新功能。 默认情况下，此协议使用3种类型的IP数据包：1（ <b>ICMP</b> ），2（ <b>IGMP</b> ）和4（ <b>IPinIP</b> ），以便在主机还活着时获得可承受的响应。 我没有进行测试以找出最有用的协议，因此默认情况下全部使用这三个协议。 <br><br> 现在，我想谈谈我使用的各种主机发现技术，您可以问一下这些堆中最有价值的堆，以及它们之间的区别是什么。 幻灯片上的示例显示了当我生成5万个IP地址并使用默认的ping扫描时，结果是在1600 s或27分钟内发现了3348台主机。 <br><br><img src="https://habrastorage.org/webt/fb/v7/sx/fbv7sxugrzktxcdpualc7orgalu.jpeg"><br><br> 这是许多计算机，并且此扫描看起来非常成功。 但是后来我决定使用“高级”扫描，几乎使用了相同的5万台主机列表，并添加了几种不同的检测技术，例如回显应答，时间戳，端口堆的<b>SYN</b>探测并设置了源端口53以进行屏蔽在<b>DNS下</b> 。 这使我们能够检测到4473个“活动”主机，但是花费了更长的时间-4259 s。 <br><br><img src="https://habrastorage.org/webt/rw/s3/k-/rws3k-qfpxhycgo0k8ks44ri5k4.jpeg"><br><br> 对这两种扫描方法（具有默认选项和高级选项）进行的比较显示，第二种扫描方法花费的时间增加了167％（41分钟比27分钟），发现的主机增加了34％。 <br><br> 现在，我想谈谈在这些研究的基础上进行的<b>Nmap</b>升级。 <br><br>  <b>Nmap 4.68</b>的最新版本可从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://nmap.org/changelog.html获得</a> ，该版本中的错误已得到修复，性能得到了改善。 还有最新的<b>SVN</b>版本，可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://nmap.org/book/install.html#instsvn</a>上找到。 <br><br> 我对错误消息说“是的，我们在2003年更正”感到厌倦，因为有很多人不想经常进行更新。 然后他们抱怨<b>Nmap</b>程序早已过时，因为它告诉您哪些端口号是打开的，但没有告诉它们后面有哪些服务。 最近，我对该程序进行了许多改进，如果您需要该程序的最高级版本<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-BHD</a> <b>CO 8 Black Hat DefCon</b>发行版，则可以在特殊链接<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">svn上</a>找到它<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">：//svn.insecure.org/nmapexp/bhdc08（</a>使用访客登录）和密码。 最新版本包含“ <b>主要端口”</b>扫描功能和一些其他功能，我将在后面讨论。 <br><br> 因此，“ <b>顶级端口”</b>项目是对数百万个IP地址的又一次大型扫描，目的是使用一系列流行的端口来发现开放的<b>TCP</b>和<b>UDP</b>端口。 一些大型组织还提供了扫描位于防火墙后面的内部网络数据的功能。 同时，为每个端口的频率数据补充了<b>Nmap</b>服务文件。 <br><br> 考虑默认情况下扫描的端口。  <b>Nmap 4.68</b>扫描了1715个<b>TCP</b>端口和1488个<b>UDP</b>端口，扫描了从1到1024的端口以及所有命名为更高的端口。 我注意到许多端口是许多年前发明的，并且已经很长时间没有使用了。 同时，有许多开放的无名端口。 <br><br><img src="https://habrastorage.org/webt/ei/ym/sp/eiymspkq4wcc7jgq4-7x00nrqfi.jpeg"><br><br>  <b>Nmap</b>的最终版本使用每种协议的前1000个端口频率数据，因此在许多情况下，我获得了最佳结果。 这使我们不必浪费时间扫描旧的未使用的端口，因此扫描速度更快，因为实际扫描了所有现有端口的一半以上。 <br><br> 快速扫描与默认扫描有很大不同。 在<b>Nmap中，</b>用字母（ <b>-F</b> ）表示。 这次， <b>Nmap 4.68</b>在整个数字范围内扫描了1276个<b>TCP</b>端口和1017个<b>UDP</b>端口。 您可能会问，为什么默认情况下扫描处理的端口更多，但是这里没有什么戏剧性的-快速扫描只花了较少的时间。 但是，在这种情况下，扫描程序不会检查所有现有端口，而只能与名称在新的<b>Nmap</b>服务文件中的端口一起使用。 结果，对每个协议的前100个端口执行了扫描，与默认情况下进行扫描相比，我获得了一个速度级的增益。 这对于<b>TCP</b>协议更有用，而对于<b>UDP</b>则更有用，因为我知道许多人从不执行<b>UDP</b>扫描，因为这非常耗时且在过滤开放端口方面很复杂。 因此，他们假装<b>UDP</b>不存在。 但是，黑客不会假装，因此对于我们来说，了解此协议正在发生的事情非常重要。 <br> 以下幻灯片显示了使用不同版本的<b>Nmap的</b>快速扫描示例。 扫描模式<b>Nmap-sUV-F-T4</b>的字母<b>U</b>表示<b>UDP</b>端口<b>F-</b>快速扫描。 此开放版本中存在过滤问题，因为<b>Nmap</b>不会收到响应，并且无法确定端口是被过滤还是被打开。 如果使用<b>scanme.nmap.org中</b>的版本， <b>则会</b>发生这种情况。  ,       ,       . <br><br><img src="https://habrastorage.org/webt/hs/pp/gz/hsppgzr9m1x8sd-i2y3n9zln-di.jpeg"><br><br>  ,    <b>Nmap 4.68</b>  ,     <b>Blackhat DefCon 08</b>  6   ,   «»  <b>Blackhat DefCon 08</b>   13 .  3         53. <br><br>       : <pre><code class="hljs xml">- top-ports <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 她使用每个必需的协议和功能扫描了最受欢迎的开放端口： <br><pre> <b><code class="hljs xml">–port-ratio <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">n</span></span></span><span class="hljs-tag">&gt;</span></span></code></b> </pre> <br> 其中<b>n</b>在0到1之间选择，它以此级别设置的频率扫描所有端口。 <br><br> 最新版本使用标记“ <b>-version-强度0</b> ”。 这意味着<b>UDP</b>请求是使用某些协议发送到某些端口的，也就是说，对于53个端口，我仅尝试使用<b>DNS</b> ；对于161个端口端口，仅使用<b>SNMP</b> ，等等。 这将扫描时间减少到13秒。 <br><br> 这个故事的寓意是，如果您知道真正需要什么数据，则可以稍微优化扫描并使其更快。 在这种情况下，我们收到了相同的数据，但是我们没有等待一个小时，而是仅等待了13秒。 因此，配置功能很有帮助，尤其是顶部端口功能。 您只需要在默认扫描1000个端口和快速扫描100个端口之间进行选择，然后任意指定要扫描的端口数即可。 <br><br> 这就提出了哪个顶级端口功能最有效的问题。 下面的幻灯片显示了前10个<b>TCP</b>端口和“最高”效率的示例，这些效率是我根据经验数据得出的。 此示例显示了使用一个或另一个“顶部”找到的打开端口数。 <br><br> 如果使用最快的端口“十”扫描，则可以检测到一半以上的开放TCP端口。 使用“前100个”端口可以检测到73％的开放端口，使用默认的“前1000个”可以检测到93％的开放端口，但是仅扫描65,000个端口空间的2％。 <br><br><img src="https://habrastorage.org/webt/n2/-h/bi/n2-hbirh4bne2rwbrtttz1zy64o.jpeg"><br><br> 接下来，我将提供有关查找打开的<b>UDP</b>端口的统计信息。 尽管有<b>SNMP</b>和<b>NTP</b> ，但典型的<b>Microsoft</b>端口在这里占主导地位。 <br><br><img src="https://habrastorage.org/webt/qu/mx/wb/qumxwbhtyig_yuurlf8pwp3tdpc.jpeg"><br><br>  <b>UDP</b>效率与<b>TCP</b>效率不同，此处，较高的打开端口百分比是由较低的“最高”值决定的。 因此，“ Top-100” <b>UDP</b>可以检测90％的端口，而<b>TCP</b>仅为73％。 <br><br> 我使用了最近开发的另一个功能： <b>包速率控制</b> 。 <br><br><img src="https://habrastorage.org/webt/ph/o4/py/pho4pyq2omqghei4pjn4opkzaoy.jpeg"><br><br> 我对她有百感交集。 我为<b>Nmap的</b>负载控制和其他技术感到骄傲，以找出哪种扫描速度最有效。 但是有许多人说，他们只是想以一定的频率简单扫描端口，而不用担心是否有任何数据包丢失。 这就是他们使用<b>RAND</b>或<b>Unicorn</b>等扫描仪的原因之一。 对于这种情况，我决定添加一个函数来设置每秒发送数据包的最大和最小频率。 <br><br> 事实证明，当我几乎“融合”了Internet托管服务时，它非常有用，因为我能够以300个数据包/秒的频率设置<b>Nmap</b>的扫描参数，并使这些来自<b>ISP的人</b>更加快乐。 <br><br> 以下幻灯片显示了如何将所有有用的<b>Nmap</b>功能放在一起的示例。 <br><br><img src="https://habrastorage.org/webt/gc/pj/9j/gcpj9jngrejwaro_17cio98at70.jpeg"><br><br> 在此处输入我要用于此特定扫描的源IP地址，并指示调试模式。 我经常在扫描过程中使用此功能与程序进行交互，因为人们不知道您可以按<b>D</b>键并打开调试模式，并且如果多次按此键，则可以滚动屏幕并查看<b>Nmap</b>在其中的作用。此刻。 <br><br> 在这里，我使用了低延迟，因为我不想长时间等待数据包频率受限的主机。 我应用了使用时间<b>STRF</b>值的功能创建日志文件的功能，该功能会自动放置日期和时间。 <br><br> 接下来，我输入了要获取的文件名，并指出我不想进行超过1秒钟的扫描尝试，因为我将尽快执行大量扫描。 <br><br> 接下来，注意主机随机化，列出扫描端口的数量，指示主机的一大组MAC地址，最小扫描频率为每秒175个数据包，最大每秒为300个数据包。 <br><br> 这是我不断更改和改进<b>Nmap</b>算法的一个示例，直到找到一个比其他方法更有效的选项为止。 <br><br> 现在，我想用剩下的时间告诉您最新的<b>Nmap</b>新闻。 其中一些是新颖有趣的功能，例如<b>NSE</b>脚本引擎。 这是一种以特定方式轮询端口的模块化机制。 在这种情况下，我们为其找到的网站制作<b>HTML</b>标题。 <br><br><img src="https://habrastorage.org/webt/0o/x6/po/0ox6poasnhj2vbdbgc3svhaedjc.jpeg"><br><br> 现在， <b>Nmap</b>支持50多个脚本，这些脚本与<b>Whois</b>数据， <b>强制使用pop3</b>密码以及您要使用的其他疯狂功能兼容。 <br><br> 现在，我将快速向您展示<b>Nmap脚本引擎的</b>工作方式。 <br><br><img src="https://habrastorage.org/webt/qz/fw/_u/qzfw_ubczy1m0sccp4grsu4dwuq.jpeg"><br><br> 这是一个很长的团队，所以我将从另一个地方复制它。 它规定了详细的<b>Nmap</b>模式-不要ping，在端口53上执行<b>UDP</b>探测，在此处使用激进的计时并应用3个脚本，这将有助于避免Dan上星期日讨论的<b>DNS</b>错误。 一个脚本只是检查DNS服务器是否允许递归，第二个脚本检查是否将原始端口号随机化，第三个脚本检查是否具有随机事务标识符。 这些是人们为了减少缓存中毒问题而要修复的错误。 <br><br> 在我们的案例中，我想演示在对一台<b>BlackHat</b>服务器和一台<b>Shmoo.com</b>服务器进行端口扫描期间<b>NSE</b>的操作。 这会花费一些时间，然后在端口号旁边立即显示结果。 <br><br> 您可以看到，当<b>UDP</b>扫描端口53时，其IP地址为216.231.64.55的blackhat.com都收到了服务器递归失败，因此无法进一步“查询”。 对于IP地址为12.21.210.234的服务器<b>archimedes.shmoo.com</b> ，发生了递归。 但是我很高兴地报告说，这在端口随机化方面很棒。 <br><br> 我想展示我的企业惨遭失败时的几个例子之一，因此在这里可以玩“谁先毒化了缓存”的游戏，但是我认为这对我们的演讲不是一个好主意。 另外，在<b>涉及到</b>我的主题上，我还有更多有趣的材料-这是新的<b>Zenmap GUI</b> 。 <br><br><img src="https://habrastorage.org/webt/-h/lp/fm/-hlpfm6p8orb55ubz87fwyvko20.jpeg"><br><br> 许多人说他们不需要图形界面，因为他们使用<b>Nmap</b>已有10年了，并且知道它的130种选择。 但是，此界面是用于扫描仪的强大工具，我将在此快速进行演示。 <br><br> 它显示一个带有输出的窗口，每个打开的主机，您可以设置<b>HTTP</b>或<b>SSH</b>显示的过滤，等等。 此外，我们在最新版本的扫描仪中添加了有趣的功能。 对于那些说：“因为您将此工具称为<b>H卡</b> ，所以就给我这个卡！”，我们添加了扫描网络拓扑图。 <br><br><img src="https://habrastorage.org/webt/o8/ht/fx/o8htfxtaeolm1643vupmss0rvc8.jpeg"><br><br> 这是相当准确的事情，它绘制网络扫描的结果并将其放置在源节点的中心，并且在此中心周围的同心圆中，每个跳转到网络，然后显示您扫描的计算机。 您可以采取这样的节点，然后说：“嘿，告诉我该特定扫描的其他数据是什么，告诉我打开的端口等”，也就是说，当您将鼠标悬停在黄色圆圈上时，将打开一个包含所有详细信息的窗口扫描执行。 您可以扫描新机器，它们也将添加到电路中。 您还可以将图相对于其他主机居中-只需单击该节点并将其拖向所需方向即可。 <br><br><img src="https://habrastorage.org/webt/rn/wv/7k/rnwv7kjrqniifg7cfwu-wg3m4fe.jpeg"><br><br> 图形界面的另一个重要<b>优点</b>是，现在<b>Nmap</b>可以与不知道如何使用命令行控制程序的<b>Windows</b>用户一起使用。 我已经收到他们的来信，上面写着：“我双击了桌面上的<b>nmap.exe</b>图标，然后弹出了一个黑盒子一秒钟，然后所有内容消失了。 显然，您的程序已完全损坏。” 因此，我希望<b>Zenmap GU</b>我能为他们提供帮助。 尽管另一方面，也许这样的人根本不应该使用<b>Nmap</b> 。 <br><br> 我们还有第二代操作系统检测系统。 <br><br><img src="https://habrastorage.org/webt/pk/vb/sb/pkvbsbemplkqqq8xzk6bfd-n2y4.jpeg"><br><br> 它包含了我在过去7年中研究的有关OS检测的所有内容，并且包含1,500个新操作系统的签名。 因此Nmap用户可以在我们的<b>nmap.org</b>网站上找到您可以想象的任何工具，并下载适用于<b>Windows</b>或<b>Linux</b>的程序版本。 我们还有一个检测软件版本的工具。 <br><br><img src="https://habrastorage.org/webt/gg/ah/ae/ggahaex349u6cwbcg0fwvdtnz2k.jpeg"><br><br> 还有一个名为<b>Reason</b>的函数。 这是一种过滤器，它显示端口打开的原因是什么（由于使用合成或<b>ACK</b>数据包），还是端口由于什么原因（例如由于重新启动）而被关闭。 <br><br><img src="https://habrastorage.org/webt/gx/ur/rj/gxurrj8onqqrpoas8t9ugkvjj7y.jpeg"><br><br> 这是了解<b>Nmap</b>实际作用的非常好工具。 可以为您提供许多有用信息的下一个功能称为“数据包跟踪”或“数据包跟踪”。 <br><br><img src="https://habrastorage.org/webt/r1/eo/ub/r1eoublly9mmogftzheu8wo8j8k.jpeg"><br><br> 多亏了她，我才能确定端口25是最终向我返回数据包的主机，还是防火墙将它们扔回了主机。 通过在快速<b>Nmap</b>扫描期间查看数据包跟踪，我可以知道它们正在与哪个设备进行交互。 在这里，您可以看到频率，使用的扫描选项，IP ID，并且使用此功能，我可以确定在两种情况下同一主机是否向我发送了数据包。 这对于了解所使用的防火墙和过滤系统很有用。 <br><br> 另一个称为<b>Advanced Traceroute的</b>功能可显示最适合用于穿透的探测类型。 这是一个快速的功能，因为<b>Nmap</b>可以与扫描并行执行它。 <br><br><img src="https://habrastorage.org/webt/1n/24/ny/1n24nypdgor-oq5kd9qe7u49d2w.jpeg"><br><br> 接下来，我对性能和扫描精度进行了一些改进。 <br><br><img src="https://habrastorage.org/webt/15/lz/vm/15lzvm2v_ythhvwtsxjijul9sn4.jpeg"><br><br> 程序界面主页上有一整节内容，其中显示了可以使用的所有选项。 接下来，我们有<b>TCP</b>和<b>IP</b>标头选项，它允许您指定源路由或源记录。 <br><br><img src="https://habrastorage.org/webt/st/jv/h_/stjvh_evswjq_10l6acsudlabsw.jpeg"><br><br> 你们中的许多人会说15年前需要原始路线，而现在没有人需要它。 但是我与一个最近在一家公司测试局域网的家伙交谈。 它位于会议室之类的地方，只能连接特定系列的服务器，因此无法与公司的所有计算机建立联系。 他们创建了诸如<b>DMZ之</b>类的东西来访问会议室。 然后，这个家伙拿走了其中一台服务器，丢失了通过它的原始路由，找到了目标计算机，因此能够解决此限制。 <br><br> 我们已经开发了另一个全新的工具，称为<b>Ncat</b> 。 <br><br><img src="https://habrastorage.org/webt/0s/gz/je/0sgzjebkau6wsgssjap8todaxxm.jpeg"><br><br> 这是<b>Netcat</b>对古老的霍比特人的现代诠释。 它几乎支持<b>Netcat 1.10的</b>所有功能（基本端口扫描程序除外），因为我更喜欢将<b>Nmap</b>用作扫描程序。 它还支持许多新功能：在运行<b>Linux，Windows，Mac OS的</b>不同平台上运行<b>SSL，IPv6</b> ，网络中介，端口转发，用于通过另一台计算机进行扫描的代理（客户端，服务器，链），shell执行，访问控制等 该程序由Chris Catterjon在2005年创建，现已完全准备好发布。 克里斯还添加了一些功能，例如IP选项和ping检测模式。 <br><br> 下一个工具是<b>Ndiff</b> ，许多人已经等待了很长时间。 <br><br><img src="https://habrastorage.org/webt/7z/_8/we/7z_8we-vynptllhlqecnzy6rcw0.jpeg"><br><br> 该实用程序比较两次或更多次扫描的结果并显示更改：新主机或远程主机，端口，更改的服务等。 重新扫描时快速检测变化非常有用。 例如，每天我扫描一家公司的网络，在工作结束时，我称该实用程序为：“向我发送自昨天以来发生的更改”。 因此，我可以看到新的打开的端口，添加的计算机等。 <br><br> 最后，我想向您展示我的书“使用Nmap进行网络扫描”，我已经研究了好几年。 它不仅说明了我的网络扫描仪的功能，还说明了网络扫描技术。 <br><br><img src="https://habrastorage.org/webt/fz/z2/vn/fzz2vn3oujq85hciqnlyv3pet9o.jpeg"><br><br> 我印刷了170本书，希望在这里分发，但恐怕第二天早上就会卖出去。 该书还将在亚马逊上出售，可在<b>denman.org/book上</b>免费下载。 您可以将自己添加到<b>Nmap</b>黑客列表中，并接收有关我的程序的新闻。 <br><br> 以下幻灯片列出了从9个月前发布的4.50版开始对<b>Nmap</b>程序的改进做出了贡献的人。 没有他们的帮助，我什么也做不了。 我们的项目非常感谢加入该项目并帮助其变得更好的志愿者。 <br><br> 现在，我还有时间回答几个问题。 <br><br> 确实，在德国和英国以及其他通过了禁止人们使用<b>Nmap之</b>类的法律的国家中，我的感觉并不理想。 是的，好人和坏人都可以使用它们，但最好是改善他们的网络，而不要像禁止使用锤子的人那样行事，因为它们会杀死人。 就我个人而言，我喜欢在德国和英国讲话，所以这样的禁令对我来说可能是一个潜在的问题，因为我不想因为违反法律而被捕。 <br><br><img src="https://habrastorage.org/webt/xw/cq/op/xwcqoppx90fzzkok68ltwunn5ry.jpeg"><br><br> 我什至无法向法官解释我的动机是什么，因为我一点都不懂德语。 因此，令我感到高兴的是，有些人团体正在与这项法律作斗争。 <br><br> 如果您还有问题，我会很乐意在大厅对面的103室回答。 谢谢大家的关注！ <br><br><img src="https://habrastorage.org/webt/zn/ps/4p/znps4p11w5dq6gzenwjfpdw16qi.jpeg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Hk-21p2m8YY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> 感谢您与我们在一起。 你喜欢我们的文章吗？ 想看更多有趣的资料吗？ 通过下订单或将其推荐给您的朋友来支持我们， <b>为我们为您发明的入门级服务器的独特模拟，为Habr用户</b>提供<b>30％的折扣：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于VPS（KVM）E5-2650 v4（6核）的全部真相10GB DDR4 240GB SSD 1Gbps从$ 20还是如何划分服务器？</a>  （RAID1和RAID10提供选件，最多24个内核和最大40GB DDR4）。 <br><br>  <b>VPS（KVM）E5-2650 v4（6核）10GB DDR4 240GB SSD 1Gbps至12月免费，</b>在六个月内付款，您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在此处</a>订购。 <br><br>  <b>戴尔R730xd便宜2倍？</b> 仅<b>在荷兰和美国，</b>我们有<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2台Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100电视（249美元起）</a> ！</b> 阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何构建基础架构大厦的信息。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用价格为9000欧元的Dell R730xd E5-2650 v4服务器的上等课程？</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN422767/">https://habr.com/ru/post/zh-CN422767/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN422757/index.html">没有政治。 如何使用移动应用程序永久改变街头抗议活动？</a></li>
<li><a href="../zh-CN422759/index.html">几个小时内的Web应用程序交互式地图</a></li>
<li><a href="../zh-CN422761/index.html">Yandex数据分析学院的四种方法</a></li>
<li><a href="../zh-CN422763/index.html">9月10日至16日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN422765/index.html">手指上的OpenID Connect 1.0</a></li>
<li><a href="../zh-CN422769/index.html">Startup Battlefield TechCrunch Disrupt San Francisco 2018的获奖者</a></li>
<li><a href="../zh-CN422771/index.html">设计规则，达到新水平和设计思路</a></li>
<li><a href="../zh-CN422773/index.html">英伟达 揭示下一代Turing GPU架构的秘密：双射线跟踪，GDDR6等</a></li>
<li><a href="../zh-CN422775/index.html">DEFCON会议22. Andrew“ Zoz” Brooks。 不要拧紧它！ 第一部分</a></li>
<li><a href="../zh-CN422777/index.html">神经网络ALU的简单介绍：解释，物理含义和实现</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>