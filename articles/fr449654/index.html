<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè´ üë©‚Äçüëß‚Äçüë¶ üíáüèΩ Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 11 üëºüèª üòæ üë©‚Äçüë©‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Commandement et contr√¥le 
 Liens vers toutes les parties: 
 Partie 1. Obtention de l'acc√®s initial (acc√®s initial) 
 Partie 2. Ex√©cution 
 Partie 3. F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 11</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449654/"><h2>  Commandement et contr√¥le </h2><br>  <b>Liens vers toutes les parties:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1. Obtention de l'acc√®s initial (acc√®s initial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Ex√©cution</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 3. Fixation (persistance)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Escalade de privil√®ges</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. √âvasion de la d√©fense</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 6. Obtention des informations d'identification (acc√®s aux informations d'identification)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 7. D√©couverte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 8. Mouvement lat√©ral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 9. Collecte de donn√©es (collecte)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 10. Exfiltration</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 11. Commandement et contr√¥le</a> <br><br>  La section ¬´Command and Control¬ª ( <i>abr√©viation - C2, C &amp; C</i> ) est la derni√®re √©tape de la cha√Æne d'attaque introduite dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ATT &amp; CK Matrix for Enterprise</a> . <br><br>  Le commandement et le contr√¥le comprennent les techniques par lesquelles l'ennemi communique avec les syst√®mes connect√©s au r√©seau attaqu√© et sous son contr√¥le.  Selon la configuration des syst√®mes et la topologie du r√©seau cible, il existe de nombreuses fa√ßons d'organiser le canal cach√© C2.  Les techniques les plus courantes sont d√©crites sous cat.  Les recommandations g√©n√©rales sur l'organisation des mesures de pr√©vention et de d√©tection de C2 sont mises en √©vidence dans un bloc s√©par√© et plac√©es √† la fin de la section. <br><br><a name="habracut"></a><br>  <i>L'auteur n'est pas responsable des cons√©quences possibles de l'application des informations √©nonc√©es dans l'article, et s'excuse √©galement pour d'√©ventuelles inexactitudes faites dans certaines formulations et termes.</i>  <i>Les informations publi√©es sont une nouvelle version gratuite du contenu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ports communs</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin de contourner les pare-feu et de m√©langer le trafic malveillant avec une activit√© r√©seau normale, un adversaire peut rester en contact avec le syst√®me attaqu√© via les ports standard couramment utilis√©s par les applications r√©guli√®res: <br> <code>TCP: 80 (HTTP) <br> TCP: 443 (HTTPS) <br> TCP: 25 (SMTP) <br> TCP/UDP: 53 (DNS)</code> <br> <br>  Des exemples de ports pour organiser les connexions r√©seau au sein d'une enclave ennemie, par exemple entre un serveur proxy et d'autres n≈ìuds) sont: <br> <code>TCP/UDP: 135 (RPC) <br> TCP/UDP: 22 <br> TCP/UDP: 3389</code> <br> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Communication via des supports amovibles</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: un</i> adversaire peut organiser une infrastructure C2 entre des n≈ìuds physiquement isol√©s √† l'aide d'un support de stockage amovible pour transf√©rer des commandes d'un syst√®me √† un autre.  Les deux syst√®mes doivent √™tre compromis.  Un syst√®me avec une connexion Internet est le plus susceptible d'√™tre compromis par le premier, et le deuxi√®me syst√®me est compromis pendant le mouvement lat√©ral en r√©pliquant des logiciels malveillants via un support amovible (voir la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 8</a> ).  Les commandes et les fichiers seront relay√©s d'un syst√®me isol√© vers un syst√®me avec une connexion Internet, √† laquelle l'adversaire a un acc√®s direct. <br><br>  <i>Recommandations de protection:</i> d√©sactivez l'ex√©cution automatique des p√©riph√©riques amovibles.  Interdisez ou limitez l'utilisation de supports amovibles au niveau de la strat√©gie organisationnelle.  Organisez un audit des processus qui sont effectu√©s lors de la connexion d'un support amovible. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Connexion via un proxy (Connection Proxy)</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> un serveur proxy peut √™tre utilis√© par un attaquant pour rediriger le trafic r√©seau entre les syst√®mes ou comme interm√©diaire pour les communications r√©seau.  De nombreux outils (tels que HTRAN, ZXProxy et ZXPortMap) vous permettent de rediriger le trafic ou de rediriger les ports. <br><br>  Le concept de proxys peut √©galement englober les approbations en peer-to-peer (p2p), les r√©seaux maill√©s ou les connexions s√©curis√©es entre r√©seaux.  Un r√©seau peut √™tre au sein d'une organisation ou entre des organisations avec des fiducies.  Un adversaire peut utiliser des approbations de r√©seau pour contr√¥ler le canal C2, r√©duire le nombre de connexions r√©seau sortantes simultan√©es, fournir une tol√©rance aux pannes ou utiliser des connexions s√©curis√©es pour √©viter les soup√ßons. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole de commande et de contr√¥le personnalis√©</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: un</i> attaquant peut organiser un canal C2 en utilisant son propre protocole r√©seau au lieu d'encapsuler des commandes / donn√©es dans un protocole de couche application standard existant.  L'impl√©mentation du protocole C2 ennemi peut imiter des protocoles bien connus ou des protocoles utilisateur (y compris des sockets brutes) sur les protocoles de base pr√©sent√©s dans TCP / IP ou une autre pile r√©seau standard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole cryptographique personnalis√©</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin de masquer le trafic transmis via le canal C2, l'adversaire peut utiliser son propre protocole cryptographique ou algorithme de cryptage.  Un sch√©ma simple, tel que le cryptage XOR du texte brut avec une cl√© fixe, donnera un texte chiffr√© (bien que tr√®s faible). <br><br>  Les sch√©mas de chiffrement propri√©taires peuvent varier en complexit√©.  L'analyse et l'ing√©nierie inverse d'√©chantillons de logiciels malveillants peuvent √™tre utilis√©es pour d√©tecter avec succ√®s l'algorithme utilis√© et la cl√© de chiffrement.  Certains attaquants peuvent essayer d'impl√©menter leur propre version d'un algorithme cryptographique bien connu au lieu d'utiliser une biblioth√®que bien connue, ce qui peut entra√Æner des erreurs involontaires dans le fonctionnement du logiciel ennemi. <br><br>  <i>Recommandations de protection:</i> si un logiciel malveillant utilise son propre chiffrement avec des cl√©s sym√©triques, il est possible d'obtenir un algorithme et une cl√© √† partir d'√©chantillons de logiciels afin de les utiliser pour d√©coder le trafic r√©seau et identifier les signatures de logiciels malveillants. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Encodage des donn√©es</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> informations transmises sur le canal C2 sont cod√©es √† l'aide de syst√®mes de codage de donn√©es standard.  L'utilisation du codage de donn√©es doit √™tre conforme aux sp√©cifications de protocole existantes et comprend l'utilisation de ASCII, Unicode, Base64, MIME, UTF-8 ou d'autres codages de texte et de caract√®res binaires.  Certains syst√®mes d'encodage, tels que gzip, peuvent en outre compresser des donn√©es. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Obfuscation des donn√©es</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> donn√©es du canal C2 peuvent √™tre masqu√©es (mais pas n√©cessairement √† l'aide du cryptage) afin de rendre difficile la d√©tection et le d√©cryptage du contenu transmis, ainsi que de rendre le processus de communication moins visible et de masquer les commandes transmises.  Il existe de nombreuses m√©thodes d'obscurcissement, telles que l'ajout de donn√©es inutiles au trafic de protocole, l'utilisation de la st√©ganographie, la combinaison du trafic l√©gitime avec le trafic C2 ou l'utilisation d'un syst√®me de codage de donn√©es non standard, par exemple, un Base64 modifi√© dans le corps d'un message de requ√™te HTTP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Masquage de l'adresse de fin d'une connexion</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">(Domain Fronting)</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> L'essence de Domain Fronting est la possibilit√© de masquer l'adresse de destination r√©elle du paquet HTTPs dans les r√©seaux CDN (Content Delivery Netwoks). <br><br>  <i>Exemple: il y a le domaine X et le domaine Y, qui sont des clients des m√™mes CDN.</i>  <i>Un paquet avec l'adresse de domaine X dans l'en-t√™te TLS et l'adresse de domaine Y dans l'en-t√™te HTTP sera tr√®s probablement livr√© √† l'adresse de domaine Y, m√™me si la communication r√©seau entre les adresses source et de destination est interdite.</i> <br><br>  Un paquet HTTPs contient deux ensembles d'en-t√™tes: le premier, TLS, se trouve dans la partie ouverte du paquet, le second, HTTP - fait r√©f√©rence √† la partie chiffr√©e du paquet.  De plus, chaque en-t√™te poss√®de son propre champ pour sp√©cifier l'adresse IP de destination.  L'essence de Domain Fronting est l'utilisation d√©lib√©r√©e de diff√©rents noms de domaine dans le champ ¬´SNI¬ª de l'en-t√™te TLS et le champ ¬´Host¬ª de l'en-t√™te HTTP.  Ainsi, l'adresse de destination autoris√©e est indiqu√©e dans le champ "SNI" et l'adresse de destination de livraison est indiqu√©e dans le champ "Host".  Si les deux adresses appartiennent aux m√™mes CDN, alors √† la r√©ception d'un tel paquet, le n≈ìud de routage peut relayer la demande √† l'adresse de destination. <br><br>  Il existe une autre variante de cette technique appel√©e fa√ßade sans rev√™tement.  Dans ce cas, le champ ¬´SNI¬ª (en-t√™te TLS) est intentionnellement laiss√© vide, ce qui permet au paquet d'atteindre son objectif m√™me si le CDN v√©rifie la co√Øncidence des champs ¬´SNI¬ª et ¬´HOST¬ª (si les champs SNI vides sont ignor√©s). <br><br>  <i>Recommandations de protection:</i> S'il est possible d'inspecter le trafic HTTPS, des connexions similaires √† la fa√ßade de domaine peuvent √™tre captur√©es et analys√©es.  Si une inspection SSL est effectu√©e ou si le trafic n'est pas chiffr√©, le champ ¬´HOST¬ª peut √™tre v√©rifi√© pour co√Øncider avec le champ ¬´SNI¬ª ou la pr√©sence de l'adresse sp√©cifi√©e dans des listes blanches ou noires.  Pour impl√©menter le domaine Fronting, un adversaire devra probablement d√©ployer des outils suppl√©mentaires dans un syst√®me compromis, dont l'installation peut √™tre emp√™ch√©e en installant des outils de protection d'h√¥te local. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Canaux de secours</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin d'assurer la fiabilit√© du canal de contr√¥le et d'√©viter de d√©passer les valeurs de seuil des donn√©es transmises, les attaquants peuvent utiliser des canaux de sauvegarde ou de communication alternatifs si le canal principal C2 est compromis ou indisponible. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Canaux multi-√©tages</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: Les</i> attaquants peuvent cr√©er des canaux C2 √† plusieurs √©tages qui sont utilis√©s dans diverses conditions ou pour des fonctions sp√©cifiques.  L'utilisation de plusieurs √©tapes peut brouiller et obscurcir le canal C2, ce qui le rend difficile √† d√©tecter. <br><br>  Les RAT ex√©cut√©s sur l'h√¥te cible √©tablissent une connexion avec le serveur de premier niveau C2.  La premi√®re √©tape peut avoir des capacit√©s automatis√©es pour collecter des informations de base sur l'h√¥te, ex√©cuter des outils de mise √† jour et t√©l√©charger des fichiers suppl√©mentaires.  Ensuite, un deuxi√®me outil RAT peut √™tre lanc√© pour rediriger l'h√¥te vers le serveur de deuxi√®me niveau C2.  La deuxi√®me √©tape de C2, tr√®s probablement, sera enti√®rement fonctionnelle et permettra √† l'ennemi d'interagir avec le syst√®me cible via la coque invers√©e et des fonctions RAT suppl√©mentaires. <br><br>  Les √©tapes C2, tr√®s probablement, seront plac√©es s√©par√©ment les unes des autres sans traverser leur infrastructure.  Le chargeur de d√©marrage peut √©galement disposer de canaux de r√©troaction ou de secours de premier √©tage redondants au cas o√π le canal de premier √©tage d'origine serait d√©tect√© et bloqu√©. <br><br>  <i>Recommandations de protection: l'</i> infrastructure C2 utilis√©e pour organiser les canaux √† plusieurs √©tages peut √™tre bloqu√©e si elle est connue √† l'avance.  Si des signatures uniques sont pr√©sentes dans le trafic C2, elles peuvent √™tre utilis√©es pour identifier et bloquer le canal. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proxy multiple (proxy multi-hop)</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  Description: pour masquer la source du trafic malveillant, un adversaire peut utiliser une cha√Æne de plusieurs serveurs proxy.  En r√®gle g√©n√©rale, le d√©fenseur ne pourra d√©terminer que le dernier proxy.  L'utilisation du multiproxing rend l'identification de la source du trafic malveillant plus difficile, obligeant la partie d√©fenderesse √† surveiller le trafic malveillant via plusieurs serveurs proxy. <br><br>  <i>Recommandations de protection: le</i> trafic vers les r√©seaux anonymes connus (tels que Tor) et les infrastructures C2 peut √™tre bloqu√© en organisant des listes noires et blanches.  Cependant, vous devez faire attention √† ce que cette m√©thode de blocage puisse √™tre contourn√©e en utilisant des techniques similaires √† la fa√ßade de domaine. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Communication multibande</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> certains opposants peuvent diviser le canal de donn√©es C2 entre diff√©rents protocoles.  Les commandes entrantes peuvent √™tre transmises via un protocole et les donn√©es sortantes d'une mani√®re diff√©rente, ce qui vous permet de contourner certaines restrictions du pare-feu.  La s√©paration peut √©galement √™tre accidentelle afin d'√©viter les avertissements concernant le d√©passement des valeurs de seuil pour un seul message. <br><br>  <i>Recommandations de protection:</i> Analysez le contenu des paquets pour trouver des connexions qui ne correspondent pas au comportement de protocole attendu pour le port utilis√©.  Faire correspondre les alertes entre plusieurs canaux de communication peut √©galement aider √† d√©tecter C2. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cryptage multicouche</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: un</i> adversaire peut appliquer plusieurs niveaux de chiffrement du trafic C2.  En r√®gle g√©n√©rale (mais d'autres options ne sont pas exclues), un tunneling suppl√©mentaire utilisant son propre sch√©ma de chiffrement est utilis√© dans le cadre du chiffrement HTTPS ou SMTPS. <br><br>  <i>Conseils de s√©curit√©: l'</i> utilisation de protocoles de chiffrement peut compliquer la d√©couverte C2 typique bas√©e sur l'analyse du trafic bas√©e sur les signatures.  Si le malware utilise un protocole cryptographique standard, l'inspection SSL / TLS peut √™tre utilis√©e pour d√©tecter le trafic C2 sur certains canaux crypt√©s.  La v√©rification SSL / TLS comporte certains risques qui doivent √™tre pris en compte avant la mise en ≈ìuvre afin d'√©viter des probl√®mes de s√©curit√© potentiels, tels qu'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">v√©rification de certificat incompl√®te</a> .  Apr√®s la v√©rification SSL / TLS, une analyse cryptographique suppl√©mentaire peut √™tre requise pour le chiffrement de deuxi√®me niveau. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Coup de port</a> </h3><br>  <i>Syst√®me:</i> Linux, macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description: les</i> attaquants peuvent utiliser les m√©thodes de d√©tournement de port pour masquer les ports ouverts qu'ils utilisent pour se connecter au syst√®me. <br><br>  Conseils de <i>s√©curit√©: l'</i> utilisation de pare-feu avec √©tat peut emp√™cher la mise en ≈ìuvre de certaines options de d√©tournement de port. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Outils d'acc√®s √† distance</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> Pour √©tablir un mode de commande et de contr√¥le interactif, un attaquant peut utiliser un logiciel l√©gitime con√ßu pour ceux-ci.  prise en charge des postes de travail et logiciels pour l'acc√®s √† distance, par exemple TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc., qui sont g√©n√©ralement utilis√©s par les services de support technique et peuvent √™tre ajout√©s √† la liste blanche.  Les outils d'acc√®s √† distance, tels que VNC, Ammy et Teamview, sont les plus couramment utilis√©s par les ing√©nieurs du support technique et sont couramment utilis√©s par les cybercriminels. <br><br>  Les outils d'acc√®s √† distance peuvent √™tre install√©s une fois que le syst√®me a √©t√© compromis pour √™tre utilis√© comme canal C2 alternatif.  Ils peuvent √©galement √™tre utilis√©s comme composants de logiciels malveillants pour √©tablir une connexion inverse avec un serveur ou un syst√®me contr√¥l√© par un adversaire. <br><br>  Des outils d'administration, tels que TeamViewer, ont √©t√© utilis√©s par plusieurs groupes ax√©s sur les agences gouvernementales dans les pays d'int√©r√™t pour l'√âtat russe et les soci√©t√©s criminelles. <br><br>  <i>Recommandations de protection:</i> les outils d'acc√®s √† distance peuvent √™tre utilis√©s en conjonction avec les techniques de Fronting de domaine, il est donc conseill√© d'emp√™cher l'adversaire d'installer les outils RAT √† l'aide des outils de s√©curit√© de l'h√¥te. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Copie de fichier √† distance</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> fichiers peuvent √™tre copi√©s d'un syst√®me √† un autre pour d√©ployer des outils ennemis ou d'autres fichiers.  Les fichiers peuvent √™tre copi√©s √† partir d'un syst√®me externe contr√¥l√© par un attaquant, via le canal C&amp;C ou √† l'aide d'autres outils utilisant des protocoles alternatifs, tels que FTP.  Les fichiers peuvent √©galement √™tre copi√©s sur Mac et Linux √† l'aide d'outils int√©gr√©s tels que scp, rsync, sftp. <br><br>  Les ennemis peuvent √©galement copier des fichiers lat√©ralement entre les syst√®mes internes des victimes pour prendre en charge le mouvement du r√©seau et l'ex√©cution de commandes √† distance.  Cela peut √™tre fait √† l'aide de protocoles de partage de fichiers en connectant les ressources r√©seau via SMB ou en utilisant des connexions authentifi√©es aux partages d'administration Windows ou RDP. <br><br>  <i>Recommandations de protection:</i> comme moyen de d√©tection, il est recommand√© de surveiller la cr√©ation et le transfert de fichiers sur le r√©seau via le protocole SMB.  Les processus inhabituels avec des connexions r√©seau externes qui cr√©ent des fichiers dans le syst√®me doivent √©galement √™tre suspects.  L'utilisation atypique d'utilitaires comme FTP peut √©galement √™tre suspecte. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole de couche d'application standard</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description:</i> pour √©viter de d√©tecter et de m√©langer le trafic C2 avec le trafic r√©seau existant, les attaquants peuvent utiliser des protocoles standard au niveau de l'application tels que HTTP, HTTPS, SMTP ou DNS.  Pour les connexions au sein du canal C2 (enclave), par exemple, entre le serveur proxy et le n≈ìud ma√Ætre et d'autres n≈ìuds, les protocoles RPC, SSH ou RDP sont g√©n√©ralement utilis√©s. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole cryptographique standard</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> opposants peuvent utiliser des algorithmes de cryptage bien connus pour masquer le trafic C2.  Malgr√© l'utilisation d'un algorithme robuste, si les cl√©s secr√®tes sont crypt√©es et g√©n√©r√©es par des logiciels malveillants et / ou stock√©es dans des fichiers de configuration, le trafic C2 peut √™tre r√©v√©l√© √† l'aide de la r√©tro-ing√©nierie. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole standard de couche non-application</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> protocoles de couche non applicative du mod√®le OSI peuvent √™tre utilis√©s pour la communication entre l'h√¥te et le serveur infect√©s ou pour l'interaction des h√¥tes infect√©s sur le r√©seau.  Dans des impl√©mentations bien connues, le protocole de couche r√©seau - ICMP, la couche de transport - UDP, la couche de session - SOCKS et des protocoles tels que redirig√©s / tunnel√©s, tels que Serial over LAN (SOL), ont √©t√© utilis√©s. <br><br>  ICMP est souvent utilis√© par les cybercriminels pour cacher la communication entre les h√¥tes.  √âtant donn√© qu'ICMP fait partie de la suite de protocoles Internet et doit √™tre impl√©ment√© par tous les appareils compatibles IP, il n'est pas aussi souvent surveill√© que d'autres protocoles, tels que TCP ou UDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ports de fantaisie (port rarement utilis√©)</a> </h3><br>  <i>Syst√®me:</i> Windows, Linux, macOS <br>  <i>Description: les</i> adversaires peuvent communiquer via C2 via un port non standard pour contourner les serveurs proxy et les pare-feu qui n'ont pas √©t√© correctement configur√©s. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Service Web</a> </h3><br>  <i>Syst√®me:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description: les</i> attaquants peuvent utiliser un service Web externe l√©gitime en cours d'ex√©cution comme moyen d'envoyer des commandes pour contr√¥ler un syst√®me infect√©.  Les serveurs de gestion sont appel√©s Commandement et contr√¥le (C&amp;C ou C2).  Les sites Web et les r√©seaux sociaux populaires peuvent servir de m√©canisme pour C2, et divers services publics tels que Google ou Twitter peuvent √©galement √™tre utilis√©s.  Tout cela permet de masquer les activit√©s malveillantes dans le flux de trafic global.  Les services Web utilisent g√©n√©ralement SSL / TLS, de sorte que les adversaires b√©n√©ficient d'une couche de protection suppl√©mentaire. <br><br>  <i>Recommandations de protection: les</i> pare-feu et les proxys Web peuvent √™tre utilis√©s pour impl√©menter des strat√©gies de restriction des communications r√©seau externes. <br><br><h3>  Recommandations g√©n√©rales sur l'organisation de mesures de pr√©vention et de d√©tection de C2 </h3><br><br>  ‚Ä¢ Les syst√®mes IDS / DLP qui utilisent l'analyse du trafic bas√©e sur les signatures peuvent √™tre utilis√©s pour d√©tecter et bloquer des outils C2 sp√©cifiques et des programmes malveillants connus, de sorte que l'adversaire changera tr√®s probablement les outils utilis√©s au fil du temps ou configurera le protocole de transfert de donn√©es afin d'√©viter la d√©tection par des moyens connus de lui. protection; <br><br>  ‚Ä¢ Utiliser des outils antivirus de protection des terminaux pour bloquer les outils et logiciels malveillants C2 connus; <br><br>  ‚Ä¢ Assurez-vous que les h√¥tes du r√©seau interne ne sont accessibles que via des interfaces autoris√©es; <br><br>  ‚Ä¢ Limitez le trafic sortant en autorisant uniquement les ports n√©cessaires sur les pare-feu et les proxys via les passerelles r√©seau appropri√©es; <br><br>  ‚Ä¢ Bloquer les domaines et les adresses IP des infrastructures C2 connues.  Il convient toutefois de noter qu‚Äôil ne s‚Äôagit pas d‚Äôune solution efficace et √† long terme,<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les adversaires peuvent souvent changer l'infrastructure de C2; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Utiliser les outils de mise en liste blanche des applications pour rendre difficile l'installation et l'ex√©cution de logiciels tiers; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ √Ä l'aide de pare-feu, de pare-feu d'application et de proxys, limitez le trafic sortant vers des sites et des services utilis√©s par des outils d'acc√®s √† distance bien connus (TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc.); </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Si un malware utilise son propre cryptage avec des cl√©s sym√©triques, alors en utilisant la r√©tro-ing√©nierie d'√©chantillons logiciels, il est possible d'obtenir un algorithme et une cl√© afin de d√©coder le trafic r√©seau et d'identifier les signatures de malware; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Surveiller les appels aux fonctions API li√©es √† l'inclusion ou √† l'utilisation de canaux de communication alternatifs;</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analyser le trafic r√©seau pour les messages ICMP ou autres protocoles qui contiennent des donn√©es anormales ou qui ne sont g√©n√©ralement pas visibles sur le r√©seau ou hors de celui-ci; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analyser les flux r√©seau pour identifier les flux anormaux, par exemple, lorsqu'un client envoie beaucoup plus de donn√©es qu'il n'en re√ßoit d'un serveur ou lorsqu'un processus qui n'utilise g√©n√©ralement pas de r√©seau ouvre des connexions r√©seau; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä¢ Analyser les flux du r√©seau pour identifier les paquets qui ne sont pas conformes √† la norme de protocole pour le port utilis√©.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449654/">https://habr.com/ru/post/fr449654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449644/index.html">Une √©tude VW montre que Golf-E est √©cologique apr√®s 100 000 km</a></li>
<li><a href="../fr449646/index.html">Analyse des ondelettes. Les bases</a></li>
<li><a href="../fr449648/index.html">Les microbes indig√®nes √† la pointe de la mode</a></li>
<li><a href="../fr449650/index.html">Du forum √† la vid√©o - le chemin d'un graphomane</a></li>
<li><a href="../fr449652/index.html">Nous invitons les d√©veloppeurs √† participer au hackathon √† PHDays 9</a></li>
<li><a href="../fr449656/index.html">Comment vous divertir avec vk api</a></li>
<li><a href="../fr449658/index.html">Nouvel ≈ìuf de P√¢ques de Google - Thanos et le gant de l'infini par rapport aux r√©sultats de recherche Google</a></li>
<li><a href="../fr449662/index.html">Bienvenue √† prendre la parole √† PyCon Russie 2019</a></li>
<li><a href="../fr449664/index.html">Configuration de GitLab CI pour charger un projet Java dans Maven Central</a></li>
<li><a href="../fr449666/index.html">DevOpsForum 2019. D√©ployer DevOps ne peut pas attendre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>