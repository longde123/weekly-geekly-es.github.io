<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍🏫 👩‍👧‍👦 💇🏽 Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 11 👼🏻 😾 👩‍👩‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Commandement et contrôle 
 Liens vers toutes les parties: 
 Partie 1. Obtention de l'accès initial (accès initial) 
 Partie 2. Exécution 
 Partie 3. F...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apprenez les tactiques, techniques et connaissances communes contradictoires (ATT @ CK). Tactiques d'entreprise. Partie 11</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449654/"><h2>  Commandement et contrôle </h2><br>  <b>Liens vers toutes les parties:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1. Obtention de l'accès initial (accès initial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. Exécution</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 3. Fixation (persistance)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 4. Escalade de privilèges</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 5. Évasion de la défense</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 6. Obtention des informations d'identification (accès aux informations d'identification)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 7. Découverte</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 8. Mouvement latéral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 9. Collecte de données (collecte)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 10. Exfiltration</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 11. Commandement et contrôle</a> <br><br>  La section «Command and Control» ( <i>abréviation - C2, C &amp; C</i> ) est la dernière étape de la chaîne d'attaque introduite dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ATT &amp; CK Matrix for Enterprise</a> . <br><br>  Le commandement et le contrôle comprennent les techniques par lesquelles l'ennemi communique avec les systèmes connectés au réseau attaqué et sous son contrôle.  Selon la configuration des systèmes et la topologie du réseau cible, il existe de nombreuses façons d'organiser le canal caché C2.  Les techniques les plus courantes sont décrites sous cat.  Les recommandations générales sur l'organisation des mesures de prévention et de détection de C2 sont mises en évidence dans un bloc séparé et placées à la fin de la section. <br><br><a name="habracut"></a><br>  <i>L'auteur n'est pas responsable des conséquences possibles de l'application des informations énoncées dans l'article, et s'excuse également pour d'éventuelles inexactitudes faites dans certaines formulations et termes.</i>  <i>Les informations publiées sont une nouvelle version gratuite du contenu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ports communs</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin de contourner les pare-feu et de mélanger le trafic malveillant avec une activité réseau normale, un adversaire peut rester en contact avec le système attaqué via les ports standard couramment utilisés par les applications régulières: <br> <code>TCP: 80 (HTTP) <br> TCP: 443 (HTTPS) <br> TCP: 25 (SMTP) <br> TCP/UDP: 53 (DNS)</code> <br> <br>  Des exemples de ports pour organiser les connexions réseau au sein d'une enclave ennemie, par exemple entre un serveur proxy et d'autres nœuds) sont: <br> <code>TCP/UDP: 135 (RPC) <br> TCP/UDP: 22 <br> TCP/UDP: 3389</code> <br> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Communication via des supports amovibles</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: un</i> adversaire peut organiser une infrastructure C2 entre des nœuds physiquement isolés à l'aide d'un support de stockage amovible pour transférer des commandes d'un système à un autre.  Les deux systèmes doivent être compromis.  Un système avec une connexion Internet est le plus susceptible d'être compromis par le premier, et le deuxième système est compromis pendant le mouvement latéral en répliquant des logiciels malveillants via un support amovible (voir la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 8</a> ).  Les commandes et les fichiers seront relayés d'un système isolé vers un système avec une connexion Internet, à laquelle l'adversaire a un accès direct. <br><br>  <i>Recommandations de protection:</i> désactivez l'exécution automatique des périphériques amovibles.  Interdisez ou limitez l'utilisation de supports amovibles au niveau de la stratégie organisationnelle.  Organisez un audit des processus qui sont effectués lors de la connexion d'un support amovible. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Connexion via un proxy (Connection Proxy)</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> un serveur proxy peut être utilisé par un attaquant pour rediriger le trafic réseau entre les systèmes ou comme intermédiaire pour les communications réseau.  De nombreux outils (tels que HTRAN, ZXProxy et ZXPortMap) vous permettent de rediriger le trafic ou de rediriger les ports. <br><br>  Le concept de proxys peut également englober les approbations en peer-to-peer (p2p), les réseaux maillés ou les connexions sécurisées entre réseaux.  Un réseau peut être au sein d'une organisation ou entre des organisations avec des fiducies.  Un adversaire peut utiliser des approbations de réseau pour contrôler le canal C2, réduire le nombre de connexions réseau sortantes simultanées, fournir une tolérance aux pannes ou utiliser des connexions sécurisées pour éviter les soupçons. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole de commande et de contrôle personnalisé</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: un</i> attaquant peut organiser un canal C2 en utilisant son propre protocole réseau au lieu d'encapsuler des commandes / données dans un protocole de couche application standard existant.  L'implémentation du protocole C2 ennemi peut imiter des protocoles bien connus ou des protocoles utilisateur (y compris des sockets brutes) sur les protocoles de base présentés dans TCP / IP ou une autre pile réseau standard. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole cryptographique personnalisé</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin de masquer le trafic transmis via le canal C2, l'adversaire peut utiliser son propre protocole cryptographique ou algorithme de cryptage.  Un schéma simple, tel que le cryptage XOR du texte brut avec une clé fixe, donnera un texte chiffré (bien que très faible). <br><br>  Les schémas de chiffrement propriétaires peuvent varier en complexité.  L'analyse et l'ingénierie inverse d'échantillons de logiciels malveillants peuvent être utilisées pour détecter avec succès l'algorithme utilisé et la clé de chiffrement.  Certains attaquants peuvent essayer d'implémenter leur propre version d'un algorithme cryptographique bien connu au lieu d'utiliser une bibliothèque bien connue, ce qui peut entraîner des erreurs involontaires dans le fonctionnement du logiciel ennemi. <br><br>  <i>Recommandations de protection:</i> si un logiciel malveillant utilise son propre chiffrement avec des clés symétriques, il est possible d'obtenir un algorithme et une clé à partir d'échantillons de logiciels afin de les utiliser pour décoder le trafic réseau et identifier les signatures de logiciels malveillants. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Encodage des données</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> informations transmises sur le canal C2 sont codées à l'aide de systèmes de codage de données standard.  L'utilisation du codage de données doit être conforme aux spécifications de protocole existantes et comprend l'utilisation de ASCII, Unicode, Base64, MIME, UTF-8 ou d'autres codages de texte et de caractères binaires.  Certains systèmes d'encodage, tels que gzip, peuvent en outre compresser des données. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Obfuscation des données</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> données du canal C2 peuvent être masquées (mais pas nécessairement à l'aide du cryptage) afin de rendre difficile la détection et le décryptage du contenu transmis, ainsi que de rendre le processus de communication moins visible et de masquer les commandes transmises.  Il existe de nombreuses méthodes d'obscurcissement, telles que l'ajout de données inutiles au trafic de protocole, l'utilisation de la stéganographie, la combinaison du trafic légitime avec le trafic C2 ou l'utilisation d'un système de codage de données non standard, par exemple, un Base64 modifié dans le corps d'un message de requête HTTP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Masquage de l'adresse de fin d'une connexion</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">(Domain Fronting)</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> L'essence de Domain Fronting est la possibilité de masquer l'adresse de destination réelle du paquet HTTPs dans les réseaux CDN (Content Delivery Netwoks). <br><br>  <i>Exemple: il y a le domaine X et le domaine Y, qui sont des clients des mêmes CDN.</i>  <i>Un paquet avec l'adresse de domaine X dans l'en-tête TLS et l'adresse de domaine Y dans l'en-tête HTTP sera très probablement livré à l'adresse de domaine Y, même si la communication réseau entre les adresses source et de destination est interdite.</i> <br><br>  Un paquet HTTPs contient deux ensembles d'en-têtes: le premier, TLS, se trouve dans la partie ouverte du paquet, le second, HTTP - fait référence à la partie chiffrée du paquet.  De plus, chaque en-tête possède son propre champ pour spécifier l'adresse IP de destination.  L'essence de Domain Fronting est l'utilisation délibérée de différents noms de domaine dans le champ «SNI» de l'en-tête TLS et le champ «Host» de l'en-tête HTTP.  Ainsi, l'adresse de destination autorisée est indiquée dans le champ "SNI" et l'adresse de destination de livraison est indiquée dans le champ "Host".  Si les deux adresses appartiennent aux mêmes CDN, alors à la réception d'un tel paquet, le nœud de routage peut relayer la demande à l'adresse de destination. <br><br>  Il existe une autre variante de cette technique appelée façade sans revêtement.  Dans ce cas, le champ «SNI» (en-tête TLS) est intentionnellement laissé vide, ce qui permet au paquet d'atteindre son objectif même si le CDN vérifie la coïncidence des champs «SNI» et «HOST» (si les champs SNI vides sont ignorés). <br><br>  <i>Recommandations de protection:</i> S'il est possible d'inspecter le trafic HTTPS, des connexions similaires à la façade de domaine peuvent être capturées et analysées.  Si une inspection SSL est effectuée ou si le trafic n'est pas chiffré, le champ «HOST» peut être vérifié pour coïncider avec le champ «SNI» ou la présence de l'adresse spécifiée dans des listes blanches ou noires.  Pour implémenter le domaine Fronting, un adversaire devra probablement déployer des outils supplémentaires dans un système compromis, dont l'installation peut être empêchée en installant des outils de protection d'hôte local. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Canaux de secours</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> Afin d'assurer la fiabilité du canal de contrôle et d'éviter de dépasser les valeurs de seuil des données transmises, les attaquants peuvent utiliser des canaux de sauvegarde ou de communication alternatifs si le canal principal C2 est compromis ou indisponible. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Canaux multi-étages</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: Les</i> attaquants peuvent créer des canaux C2 à plusieurs étages qui sont utilisés dans diverses conditions ou pour des fonctions spécifiques.  L'utilisation de plusieurs étapes peut brouiller et obscurcir le canal C2, ce qui le rend difficile à détecter. <br><br>  Les RAT exécutés sur l'hôte cible établissent une connexion avec le serveur de premier niveau C2.  La première étape peut avoir des capacités automatisées pour collecter des informations de base sur l'hôte, exécuter des outils de mise à jour et télécharger des fichiers supplémentaires.  Ensuite, un deuxième outil RAT peut être lancé pour rediriger l'hôte vers le serveur de deuxième niveau C2.  La deuxième étape de C2, très probablement, sera entièrement fonctionnelle et permettra à l'ennemi d'interagir avec le système cible via la coque inversée et des fonctions RAT supplémentaires. <br><br>  Les étapes C2, très probablement, seront placées séparément les unes des autres sans traverser leur infrastructure.  Le chargeur de démarrage peut également disposer de canaux de rétroaction ou de secours de premier étage redondants au cas où le canal de premier étage d'origine serait détecté et bloqué. <br><br>  <i>Recommandations de protection: l'</i> infrastructure C2 utilisée pour organiser les canaux à plusieurs étages peut être bloquée si elle est connue à l'avance.  Si des signatures uniques sont présentes dans le trafic C2, elles peuvent être utilisées pour identifier et bloquer le canal. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proxy multiple (proxy multi-hop)</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  Description: pour masquer la source du trafic malveillant, un adversaire peut utiliser une chaîne de plusieurs serveurs proxy.  En règle générale, le défenseur ne pourra déterminer que le dernier proxy.  L'utilisation du multiproxing rend l'identification de la source du trafic malveillant plus difficile, obligeant la partie défenderesse à surveiller le trafic malveillant via plusieurs serveurs proxy. <br><br>  <i>Recommandations de protection: le</i> trafic vers les réseaux anonymes connus (tels que Tor) et les infrastructures C2 peut être bloqué en organisant des listes noires et blanches.  Cependant, vous devez faire attention à ce que cette méthode de blocage puisse être contournée en utilisant des techniques similaires à la façade de domaine. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Communication multibande</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> certains opposants peuvent diviser le canal de données C2 entre différents protocoles.  Les commandes entrantes peuvent être transmises via un protocole et les données sortantes d'une manière différente, ce qui vous permet de contourner certaines restrictions du pare-feu.  La séparation peut également être accidentelle afin d'éviter les avertissements concernant le dépassement des valeurs de seuil pour un seul message. <br><br>  <i>Recommandations de protection:</i> Analysez le contenu des paquets pour trouver des connexions qui ne correspondent pas au comportement de protocole attendu pour le port utilisé.  Faire correspondre les alertes entre plusieurs canaux de communication peut également aider à détecter C2. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cryptage multicouche</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: un</i> adversaire peut appliquer plusieurs niveaux de chiffrement du trafic C2.  En règle générale (mais d'autres options ne sont pas exclues), un tunneling supplémentaire utilisant son propre schéma de chiffrement est utilisé dans le cadre du chiffrement HTTPS ou SMTPS. <br><br>  <i>Conseils de sécurité: l'</i> utilisation de protocoles de chiffrement peut compliquer la découverte C2 typique basée sur l'analyse du trafic basée sur les signatures.  Si le malware utilise un protocole cryptographique standard, l'inspection SSL / TLS peut être utilisée pour détecter le trafic C2 sur certains canaux cryptés.  La vérification SSL / TLS comporte certains risques qui doivent être pris en compte avant la mise en œuvre afin d'éviter des problèmes de sécurité potentiels, tels qu'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vérification de certificat incomplète</a> .  Après la vérification SSL / TLS, une analyse cryptographique supplémentaire peut être requise pour le chiffrement de deuxième niveau. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Coup de port</a> </h3><br>  <i>Système:</i> Linux, macOS <br>  <i>Droits:</i> utilisateur <br>  <i>Description: les</i> attaquants peuvent utiliser les méthodes de détournement de port pour masquer les ports ouverts qu'ils utilisent pour se connecter au système. <br><br>  Conseils de <i>sécurité: l'</i> utilisation de pare-feu avec état peut empêcher la mise en œuvre de certaines options de détournement de port. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Outils d'accès à distance</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> Pour établir un mode de commande et de contrôle interactif, un attaquant peut utiliser un logiciel légitime conçu pour ceux-ci.  prise en charge des postes de travail et logiciels pour l'accès à distance, par exemple TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc., qui sont généralement utilisés par les services de support technique et peuvent être ajoutés à la liste blanche.  Les outils d'accès à distance, tels que VNC, Ammy et Teamview, sont les plus couramment utilisés par les ingénieurs du support technique et sont couramment utilisés par les cybercriminels. <br><br>  Les outils d'accès à distance peuvent être installés une fois que le système a été compromis pour être utilisé comme canal C2 alternatif.  Ils peuvent également être utilisés comme composants de logiciels malveillants pour établir une connexion inverse avec un serveur ou un système contrôlé par un adversaire. <br><br>  Des outils d'administration, tels que TeamViewer, ont été utilisés par plusieurs groupes axés sur les agences gouvernementales dans les pays d'intérêt pour l'État russe et les sociétés criminelles. <br><br>  <i>Recommandations de protection:</i> les outils d'accès à distance peuvent être utilisés en conjonction avec les techniques de Fronting de domaine, il est donc conseillé d'empêcher l'adversaire d'installer les outils RAT à l'aide des outils de sécurité de l'hôte. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Copie de fichier à distance</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> fichiers peuvent être copiés d'un système à un autre pour déployer des outils ennemis ou d'autres fichiers.  Les fichiers peuvent être copiés à partir d'un système externe contrôlé par un attaquant, via le canal C&amp;C ou à l'aide d'autres outils utilisant des protocoles alternatifs, tels que FTP.  Les fichiers peuvent également être copiés sur Mac et Linux à l'aide d'outils intégrés tels que scp, rsync, sftp. <br><br>  Les ennemis peuvent également copier des fichiers latéralement entre les systèmes internes des victimes pour prendre en charge le mouvement du réseau et l'exécution de commandes à distance.  Cela peut être fait à l'aide de protocoles de partage de fichiers en connectant les ressources réseau via SMB ou en utilisant des connexions authentifiées aux partages d'administration Windows ou RDP. <br><br>  <i>Recommandations de protection:</i> comme moyen de détection, il est recommandé de surveiller la création et le transfert de fichiers sur le réseau via le protocole SMB.  Les processus inhabituels avec des connexions réseau externes qui créent des fichiers dans le système doivent également être suspects.  L'utilisation atypique d'utilitaires comme FTP peut également être suspecte. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole de couche d'application standard</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description:</i> pour éviter de détecter et de mélanger le trafic C2 avec le trafic réseau existant, les attaquants peuvent utiliser des protocoles standard au niveau de l'application tels que HTTP, HTTPS, SMTP ou DNS.  Pour les connexions au sein du canal C2 (enclave), par exemple, entre le serveur proxy et le nœud maître et d'autres nœuds, les protocoles RPC, SSH ou RDP sont généralement utilisés. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole cryptographique standard</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> opposants peuvent utiliser des algorithmes de cryptage bien connus pour masquer le trafic C2.  Malgré l'utilisation d'un algorithme robuste, si les clés secrètes sont cryptées et générées par des logiciels malveillants et / ou stockées dans des fichiers de configuration, le trafic C2 peut être révélé à l'aide de la rétro-ingénierie. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Protocole standard de couche non-application</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> protocoles de couche non applicative du modèle OSI peuvent être utilisés pour la communication entre l'hôte et le serveur infectés ou pour l'interaction des hôtes infectés sur le réseau.  Dans des implémentations bien connues, le protocole de couche réseau - ICMP, la couche de transport - UDP, la couche de session - SOCKS et des protocoles tels que redirigés / tunnelés, tels que Serial over LAN (SOL), ont été utilisés. <br><br>  ICMP est souvent utilisé par les cybercriminels pour cacher la communication entre les hôtes.  Étant donné qu'ICMP fait partie de la suite de protocoles Internet et doit être implémenté par tous les appareils compatibles IP, il n'est pas aussi souvent surveillé que d'autres protocoles, tels que TCP ou UDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ports de fantaisie (port rarement utilisé)</a> </h3><br>  <i>Système:</i> Windows, Linux, macOS <br>  <i>Description: les</i> adversaires peuvent communiquer via C2 via un port non standard pour contourner les serveurs proxy et les pare-feu qui n'ont pas été correctement configurés. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Service Web</a> </h3><br>  <i>Système:</i> Windows <br>  <i>Droits:</i> utilisateur <br>  <i>Description: les</i> attaquants peuvent utiliser un service Web externe légitime en cours d'exécution comme moyen d'envoyer des commandes pour contrôler un système infecté.  Les serveurs de gestion sont appelés Commandement et contrôle (C&amp;C ou C2).  Les sites Web et les réseaux sociaux populaires peuvent servir de mécanisme pour C2, et divers services publics tels que Google ou Twitter peuvent également être utilisés.  Tout cela permet de masquer les activités malveillantes dans le flux de trafic global.  Les services Web utilisent généralement SSL / TLS, de sorte que les adversaires bénéficient d'une couche de protection supplémentaire. <br><br>  <i>Recommandations de protection: les</i> pare-feu et les proxys Web peuvent être utilisés pour implémenter des stratégies de restriction des communications réseau externes. <br><br><h3>  Recommandations générales sur l'organisation de mesures de prévention et de détection de C2 </h3><br><br>  • Les systèmes IDS / DLP qui utilisent l'analyse du trafic basée sur les signatures peuvent être utilisés pour détecter et bloquer des outils C2 spécifiques et des programmes malveillants connus, de sorte que l'adversaire changera très probablement les outils utilisés au fil du temps ou configurera le protocole de transfert de données afin d'éviter la détection par des moyens connus de lui. protection; <br><br>  • Utiliser des outils antivirus de protection des terminaux pour bloquer les outils et logiciels malveillants C2 connus; <br><br>  • Assurez-vous que les hôtes du réseau interne ne sont accessibles que via des interfaces autorisées; <br><br>  • Limitez le trafic sortant en autorisant uniquement les ports nécessaires sur les pare-feu et les proxys via les passerelles réseau appropriées; <br><br>  • Bloquer les domaines et les adresses IP des infrastructures C2 connues.  Il convient toutefois de noter qu’il ne s’agit pas d’une solution efficace et à long terme,<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les adversaires peuvent souvent changer l'infrastructure de C2; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Utiliser les outils de mise en liste blanche des applications pour rendre difficile l'installation et l'exécution de logiciels tiers; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• À l'aide de pare-feu, de pare-feu d'application et de proxys, limitez le trafic sortant vers des sites et des services utilisés par des outils d'accès à distance bien connus (TeamViewer, Go2Assist, LogMain, AmmyAdmin, etc.); </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Si un malware utilise son propre cryptage avec des clés symétriques, alors en utilisant la rétro-ingénierie d'échantillons logiciels, il est possible d'obtenir un algorithme et une clé afin de décoder le trafic réseau et d'identifier les signatures de malware; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Surveiller les appels aux fonctions API liées à l'inclusion ou à l'utilisation de canaux de communication alternatifs;</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Analyser le trafic réseau pour les messages ICMP ou autres protocoles qui contiennent des données anormales ou qui ne sont généralement pas visibles sur le réseau ou hors de celui-ci; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Analyser les flux réseau pour identifier les flux anormaux, par exemple, lorsqu'un client envoie beaucoup plus de données qu'il n'en reçoit d'un serveur ou lorsqu'un processus qui n'utilise généralement pas de réseau ouvre des connexions réseau; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">• Analyser les flux du réseau pour identifier les paquets qui ne sont pas conformes à la norme de protocole pour le port utilisé.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr449654/">https://habr.com/ru/post/fr449654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr449644/index.html">Une étude VW montre que Golf-E est écologique après 100 000 km</a></li>
<li><a href="../fr449646/index.html">Analyse des ondelettes. Les bases</a></li>
<li><a href="../fr449648/index.html">Les microbes indigènes à la pointe de la mode</a></li>
<li><a href="../fr449650/index.html">Du forum à la vidéo - le chemin d'un graphomane</a></li>
<li><a href="../fr449652/index.html">Nous invitons les développeurs à participer au hackathon à PHDays 9</a></li>
<li><a href="../fr449656/index.html">Comment vous divertir avec vk api</a></li>
<li><a href="../fr449658/index.html">Nouvel œuf de Pâques de Google - Thanos et le gant de l'infini par rapport aux résultats de recherche Google</a></li>
<li><a href="../fr449662/index.html">Bienvenue à prendre la parole à PyCon Russie 2019</a></li>
<li><a href="../fr449664/index.html">Configuration de GitLab CI pour charger un projet Java dans Maven Central</a></li>
<li><a href="../fr449666/index.html">DevOpsForum 2019. Déployer DevOps ne peut pas attendre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>