<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙏🏻 ⚓️ 👨🏾‍🏭 Speichern von Standard-Warwar in Python 👌🏾 🐴 🖕🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So können Sie sich eine Python-Funktion merken: 



def memo_square(a, cache={}): if a not in cache: cache[a] = a*a return cache[a]  
 Der Empfang ist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Speichern von Standard-Warwar in Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426341/">  So können Sie sich eine Python-Funktion merken: <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memo_square</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, cache={})</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cache: cache[a] = a*a <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cache[a]</code> </pre> <br>  Der Empfang ist zu Unrecht wenig bekannt, daher werden wir unter dem Schnitt analysieren, wie er funktioniert und wofür er gedacht ist. <br><a name="habracut"></a><br>  Erstens, wie und warum es funktioniert.  <code>memo_square</code> (wie jede andere Funktion) ein Objekt der Funktionsklasse, für das unter anderem beim Erstellen des Objekts ein <code>memo_square.__defaults__</code> -Tupel ausgefüllt ist.  Erstens enthält es ein leeres Wörterbuch, wie im Funktionsheader angegeben: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>memo_square.__defaults__ ({},)</code> </pre> <br>  <code>__defaults__</code> ist ein reguläres Tupel und Sie können seine Elemente nicht ändern.  Richtig, Sie können den gesamten Satz von Standardwerten auf einmal ersetzen, jedoch nur durch ein anderes Tupel: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, b=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> ... print(a, b) ... &gt;&gt;&gt; test.__defaults__ (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) &gt;&gt;&gt; test() <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> &gt;&gt;&gt; test.__defaults__ = (<span class="hljs-string"><span class="hljs-string">', '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) &gt;&gt;&gt; test() ,  &gt;&gt;&gt; test.__defaults__[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">''</span></span> Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; TypeError: <span class="hljs-string"><span class="hljs-string">'tuple'</span></span> object does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> support item assignment &gt;&gt;&gt; test.__defaults__ = {<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-string"><span class="hljs-string">', '</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>} Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"&lt;stdin&gt;"</span></span>, line <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; TypeError: __defaults__ must be set to a tuple object</code> </pre> <br>  Soryan, dieser Artikel kommt nicht nach Picaba.  Okay, das ist nicht wichtig.  Wichtig ist, dass mit Ausnahme des sehr gerissenen Codes <code>func.__defaults__</code> einmal während der Programmzeit mit all seinen Elementen erstellt wird.  Ein Tupel und seine Elemente werden nicht bei jedem Funktionsaufruf neu erstellt, sondern verwendet, solange die Funktion vorhanden ist.  Aber zu ändern, wenn die Elemente selbst veränderlich sind, verbietet niemand sie.  Die Unfähigkeit, mit solchen Elementen zu arbeiten, ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine der häufigsten Möglichkeiten, sich in die Python zu schießen</a> .  Das Speichern von Werten zwischen Funktionsaufrufen kann jedoch sehr nützlich sein.  Nach mehreren Aufrufen <code>memo_square.__defaults__</code> aus: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>memo_square(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span> &gt;&gt;&gt; memo_square.__defaults__ ({<span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>},) &gt;&gt;&gt; memo_square(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-number"><span class="hljs-number">25</span></span> &gt;&gt;&gt; memo_square.__defaults__ ({<span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>},) &gt;&gt;&gt; memo_square(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">4</span></span> &gt;&gt;&gt; memo_square.__defaults__ ({<span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>},)</code> </pre> <br>  Wenn die Funktion bereits für denselben Wert aufgerufen wurde, wird der Wert berechnet und der Cache entsprechend nicht aufgefüllt.  Für ein Quadrat ist der Nutzen gering (genau genommen ist der Nutzen für ein Quadrat negativ, da das Suchen in einem Wörterbuch teurer ist als das Multiplizieren von zwei Zahlen), aber für wirklich teure Funktionen kann das Auswendiglernen / Zwischenspeichern nützlich sein.  Natürlich können Sie es in Python auf mehrere Arten bereitstellen.  Hier sind die Alternativen, die wir haben: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">@ functools.lru_cache</a> .  Ein Dekorator aus dem functools-Modul, der sich an die letzten Funktionsaufrufe erinnert.  Es ist zuverlässig und einfach, verwendet jedoch alle Parameter der Funktion als Schlüssel, was bedeutet, dass Hashfähigkeit erforderlich ist und nicht bemerkt werden kann, dass zwei formal unterschiedliche Parameterwerte äquivalent sind.  Mit der ersten Anforderung ist alles klar, zum Beispiel über Funktionen aus Mengen, die Sie vergessen können.  Nun, oder wenn Sie anrufen, konvertieren Sie sie in Frozenset.  Was die zweite betrifft, habe ich zum Beispiel eine Funktion, die eine SQL-Verbindung und eine Nummer als Eingabe verwendet und die mit dieser Nummer verknüpften Daten manipuliert.  Die Verbindung kann während des Programmbetriebs getrennt und wiederhergestellt werden, und der lru_cache-Cache fliegt dann ab.  Aber er weiß, wie man nur eine begrenzte Anzahl von Anrufen zwischenspeichert (um Speicherlecks zu vermeiden) und ist gut dokumentiert. </li><li>  Cache außerhalb der Funktion: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">square</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a**a cache = {} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> values: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cache: cache[x] = x**x <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> cache[x]</code> </pre> <br>  Die Bedeutung ist dieselbe, aber viel umständlicher.  Darüber hinaus ist die Cache-Variable außerhalb der Funktion sichtbar, obwohl sie nur zum Speichern verwendet wird.  Auf den Cache während der Memoisierung mit dem Standardargument kann extern nur über <code>func.__defaults__</code> , auf die versehentlich nur schwer <code>func.__defaults__</code> werden kann. </li><li>  Leeren Sie ein vollwertiges Objekt mit einem Cache und machen Sie seine Funktion zu einer Methode.  Es ist in Bezug auf Architektur und Testbarkeit gut und ermöglicht es Ihnen, eine beliebig komplexe Caching-Logik beizubehalten, die jedoch aufgrund der im Objektcode enthaltenen Boilerplate noch umständlicher ist.  Außerdem ist nicht klar, von was und was überhaupt zu erben ist, wenn es mehr als eine merkwürdige Funktion gibt. </li></ul><br>  Die Hauptsache, an der diese Methode des Auswendiglernen verliert, ist, dass sie nicht sehr idiomatisch ist.  Als ich persönlich zum ersten Mal über diese Entscheidung stolperte, dachte ich ein paar Minuten darüber nach, was hier vor sich ging und warum.  Andererseits begann ich in diesen paar Minuten etwas besser zu verstehen, wie die Python-Funktionen und ihre Argumente angeordnet sind.  Selbst wenn Sie nicht die Standardargumente verwenden (zum Auswendiglernen oder zum Beispiel zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschleunigung der Namensauflösung</a> ), ist es für jeden Ernährungsberater nützlich, diese Technik zu kennen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426341/">https://habr.com/ru/post/de426341/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426327/index.html">Was ist neu in Windows 10 Oktober 2018 Update</a></li>
<li><a href="../de426331/index.html">Sicherheitslücke in PlayStation 4 - Der Zeichensatz in der Nachricht für den Benutzer aus der Ferne verwandelt die Konsole in fast einen "Baustein".</a></li>
<li><a href="../de426333/index.html">Microsoft hat MS-DOS 1.25- und 2.0-Code unter der MIT-Lizenz veröffentlicht</a></li>
<li><a href="../de426335/index.html">„Mars-Technologie“: Warum Rechenzentren auf Brennstoffzellen umstellen</a></li>
<li><a href="../de426339/index.html">25. Oktober 2018 Treffen der Atlassian User Group in der Raiffeisenbank</a></li>
<li><a href="../de426343/index.html">Gentleman-Verhaltensregeln in der IT: Die Geschichte von ITIL</a></li>
<li><a href="../de426345/index.html">Interessante Rätsel aus technischen Interviews</a></li>
<li><a href="../de426347/index.html">ITMO University Digest: Neue Studien, Alumni-Erfahrung und internationale Projekte</a></li>
<li><a href="../de426349/index.html">Wir schaffen einen einfachen, kompakten und billigen Internetradiosender</a></li>
<li><a href="../de426351/index.html">Änderungen an Microsoft-Zertifizierungen und -Prüfungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>