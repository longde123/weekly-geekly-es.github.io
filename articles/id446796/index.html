<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦋 ♨️ 🍆 Sirkuit tidak standar: indikator tujuh segmen pada ATtiny13 👨🏼‍🌾 🍼 🐑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami tidak mencari cara sederhana. 



 Sebelumnya, ini adalah publikasi pertama saya yang menyebabkan resonansi di kalangan pengguna Habr. Memutuskan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sirkuit tidak standar: indikator tujuh segmen pada ATtiny13</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446796/"><blockquote>  <i>Kami tidak mencari cara sederhana.</i> </blockquote><br><br><img src="https://habrastorage.org/webt/gl/vh/go/glvhgoheu-u5slanwr-7y9azjlg.jpeg" alt="gambar"><br><br>  Sebelumnya, ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">publikasi</a> pertama saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">yang</a> menyebabkan resonansi di kalangan pengguna Habr.  Memutuskan untuk tidak berhenti.  Kami terus memeras yang mustahil dari ATtiny13.  Saya segera memperingatkan Anda, solusi yang dijelaskan adalah non-standar lagi, dan seseorang dapat menyebabkan kemarahan dan disonansi kognitif ("Dan apa gunanya artikel itu? Perlihatkan elemen apa yang dapat dihubungkan?").  Selain itu, solusi seperti itu juga sangat tidak praktis, yang akan saya tulis lebih terinci di bawah ini.  Tetapi kebetulan bahwa solusi standar telah lama dikenal, dan membaca tentang mereka tidak selalu menarik, tetapi menulis tidak berterima kasih. <br><a name="habracut"></a><br>  Saya sangat suka anak ini ATtiny13.  Dia memiliki otak yang cukup untuk menyelesaikan banyak masalah sehari-hari (nyalakan lampu, ventilasi, <s>lari ke toko untuk minum bir</s> ).  Dan harganya hanya konyol.  Ini hanya beberapa kaki, dan tidak ada pegangan sama sekali.  Karena itu, Anda harus pergi ke segala macam trik untuk menyelesaikan masalah kekurangan kaki. <br><br>  Dalam proses mempelajari pemrograman mikrokontroler (di lingkungan Arduino, jangan beri tahu siapa pun) Saya, seperti banyak orang, melewati langkah menghubungkan sensor jarak ultrasonik, seperti ini: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2a2/c6c/0c1/2a2c6c0c19d10932dbcffa732d0482d7.jpg" alt="gambar"><br><br>  Karena metode pengiriman informasi dari sensor ke controller mudah dipermalukan, ATtiny13 mengatasi ini dengan mudah.  Maka itu perlu untuk menampilkan informasi pada indikator tujuh segmen menggunakan register geser.  Artinya, skema tampilan bagian itu beberapa kali lebih besar dari pengontrol itu sendiri.  Pada saat itu saya bermain-main dan pindah. <br><br>  Baru-baru ini, saya berpikir, apa lagi yang akan menjadi tugas besar untuk ditugaskan ke Tinka?  Apa yang masih tidak bisa dia tangani dalam contoh yang dijelaskan.  Hal pertama yang saya ingat tentang indikasi.  Beberapa waktu lalu saya sudah mencari informasi tentang topik serupa.  Kemudian saya menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">opsi yang</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menarik</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">.</a> <br><br><div class="spoiler">  <b class="spoiler_title">Gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/e08/0b6/2fb/e080b62fbc0864cbe0ba6f8dd6682132.gif" alt="gambar"><br></div></div><br>  21 segmen dari 5 kaki controller.  Wow!  Saya bahkan tidak membutuhkan banyak, dua tanda sudah cukup, ditambah satu titik, total 15 segmen.  Dan jika dengan empat kaki?  Kemudian dapatkan maksimal 13 segmen, tidak cukup.  Saat melihat rangkaian, keinginan muncul segera untuk berkumpul dan mencoba, meskipun tidak mudah untuk membuat algoritma operasi.  Tetapi dengan melihat lebih dekat, Anda mengerti bahwa itu tidak akan berfungsi untuk mengumpulkan, hewan tujuh segmen seperti itu tidak ada di alam (kemungkinan besar).  Anda dapat membuat, tentu saja, tetapi ini adalah level yang berbeda.  Kemudian ide itu ditunda hingga masa yang lebih baik. <br><br>  Offtopic: Mengapa tidak ada indikator tujuh segmen dengan logika terintegrasi?  Di mana pengembang mencari?  Seberapa mudah instalasi dan kontrol - dua power leg dan 3 (1, 2) data leg.  Dan bagaimanapun, mereka bahkan berada di USSR: 490IP1, 490IP2.  Di dalam indikator yang paling biasa untuk 2 ... 4 digit ada banyak ruang untuk menempatkan microcircuit chip, dan harga register geser adalah 0,064 cu bersama dengan kasing.  Oh baiklah <br><br>  Jadi saya berpikir lagi, bagaimana cara mengurangi jumlah kaki untuk bekerja dengan indikator tujuh segmen?  Output pengontrol dapat mengambil tiga status (sebenarnya 4, tapi sekarang tidak masalah).  Apakah ada cara untuk menggunakan ini?  Jika dua negara sehubungan dengan LED dapat diartikan hanya sebagai bersinar, bukan bersinar, maka dengan tiga itu sedikit lebih menarik.  Saya belum menemukan cara menggunakannya, tetapi skema berikut muncul di benak saya: <br><br><img src="https://habrastorage.org/webt/cw/f8/32/cwf832ajr1kedukuv_tyigpuzwk.jpeg" alt="gambar"><br><br>  Jika output pengontrol dalam keadaan nol, LED tidak menyala (yang jelas). <br><br>  Jika output dalam status unit, maka LED menyala, yang juga bisa dimengerti. <br><br>  Tetapi jika output bukan output sama sekali, tetapi terhubung ke input, maka arus mengalir melalui rangkaian dua resistor dan LED HL1, yang menciptakan penurunan tegangan pada titik koneksi resistor kira-kira (5-1.7) / (2.2 + 1.5) * 1.5 + 1.7 = 3.0 V. Ini tidak cukup untuk arus mengalir melalui sirkuit VD1_R3_HL2 (sekitar 3,4 V diperlukan).  VD1 adalah LED tambahan yang digunakan sebagai dioda zener (penstabil lebih tepat), oleh karena itu kami tidak akan menganggapnya sebagai LED, agar tidak bingung.  Tidak masalah jika resistor pull-up dihidupkan di dalam mikrokontroler, resistansi (20 kOhm) praktis tidak mempengaruhi situasi.  Saya tidak datang ke peringkat seperti itu segera, sebelum itu saya mencoba dengan dioda biasa seperti VD1, itu juga bekerja cukup baik dengan resistor yang sama R1 dan R2.  Tetapi lebih baik R2 sekitar satu setengah kali lebih besar dari R1.  Dan saya hampir lupa hal yang paling penting: semuanya dijelaskan hanya mungkin dengan penggunaan LED <i>merah</i> baik di indikator dan yang tambahan.  Dalam kasus ekstrim, indikator <i>atau</i> LED tambahan dapat diterapkan hijau.  Dan dengan tegangan suplai 4,5 V hingga 5 V. <br><br>  Apa yang kita miliki pada akhirnya?  Tiga status: tidak ada LED (0) bersinar, HL1 (1) bersinar, atau HL1 dan HL2 (2) bersinar.  Sangat mirip dengan sistem terner.  Tapi kita tidak bisa menyalakan HL2 tanpa HL1, ini harus diingat.  Tapi sekarang dengan bantuan empat kaki mikrokontroler kita dapat mengontrol delapan LED (saya ingin berpikir begitu). <br><br>  Kemudian saya mencoba memecah segmen indikator menjadi berpasangan (seperti di taman kanak-kanak: perempuan).  Syarat utamanya adalah bahwa pada setiap pasangan salah satu segmen tidak dapat bersinar dengan sendirinya, diskriminasi semacam itu.  Inilah yang saya dapatkan: <br><br><img src="https://habrastorage.org/webt/rj/oa/dr/rjoadrat5-jro2zaaj6oe4dxrno.jpeg" alt="gambar"><br><br>  Empat pasang segmen, dalam setiap huruf kapital ditunjukkan segmen dominan, yang dapat bekerja dengan sendirinya, yang kedua hanya bisa bersamanya.  Anda mungkin memperhatikan bahwa segmen “a” bergerak dengan dua sekaligus, dan tidak ada yang sampai pada titik yang buruk sama sekali.  Seperti apa kehidupan ini! <br><br>  Tetapi dengan pasangan ini Anda dapat menampilkan (hampir) semua angka: <br><br><div class="spoiler">  <b class="spoiler_title">Gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ux/vb/tv/uxvbtvxvpp1rlhvkqg23uld0oou.jpeg" alt="gambar"><br></div></div><br>  Setiap pasangan dicat dengan warnanya sendiri.  Seorang penonton yang penuh perhatian memperhatikan bahwa ada sesuatu yang salah dengan deuce.  Kami tidak akan fokus pada ini untuk saat ini.  Saya mencoba beberapa opsi lagi untuk mengelompokkan segmen, lebih baik tidak muncul.  Mungkin seseorang akan menyarankan.  Mungkin jaringan saraf bisa menanganinya. <br><br>  Pada tahap kedua percobaan, saya harus menggunakan indikator dengan anoda umum.  Oleh karena itu, skema terakhir adalah sebagai berikut: <br><br><div class="spoiler">  <b class="spoiler_title">Skema</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/cq/nd/jo/cqndjod7jj6ofopx2fcwmuvqums.jpeg" alt="gambar"><br></div></div><br>  Seseorang mungkin bertanya: kemana perginya 100 ohm resistor?  Telah lama diketahui (dan digunakan secara aktif) bahwa dengan indikasi dinamis yang dibuat dengan benar, resistor pembatas arus dapat ditiadakan.  Bahkan jika tegangan secara konstan diterapkan dari output pengontrol ke dua LED yang dihubungkan secara tidak sengaja, mikrokontroler dan LED biasanya menahan ini, arus dibatasi oleh resistansi transisi di dalam MC.  Dan lebih banyak tentang resistor.  Arus maksimum melalui HL1 menurut skema sebelumnya adalah sekitar 2 mA, dan melalui HL2 mencapai 25 ... 40 mA (mungkin, nanti saya akan mengatakan dari mana angka-angka ini berasal).  Ini berarti bahwa keluaran cahaya dari segmen yang berbeda akan berbeda.  Tetapi karena indikasi dinamis akan digunakan, ini dapat dengan mudah diselesaikan karena waktu tampilan segmen yang berbeda. <br><br>  Semua percobaan yang saya lakukan pada Arduino Nano di Arduino IDE.  Papan prototyping yang sangat baik, itu bagus di papan tempat memotong roti, itu di-flash melalui USB tanpa masalah.  Apakah ada yang gagal?  Saya memperbaiki sketsa dan dalam satu menit saya mengunggah firmware baru.  Dan ketika Anda men-debug kode, Anda dapat pergi ke firmware di ATtiny13, masih membutuhkan sedikit lebih banyak gerakan. <br><br>  Ngomong-ngomong, saya juga menginstal menggunakan Arduino di lingkungan Arduino, ini praktis menghilangkan kemungkinan mengunci MK dengan sekering yang salah, dan jauh lebih mudah. <br><br>  Berikut adalah contoh menampilkan angka 4 dalam kode: <br><br><pre><code class="cpp hljs">pinMode(f_a, INPUT); <span class="hljs-comment"><span class="hljs-comment">//    f_a   digitalWrite(f_a, 1); //   F pinMode(d_e, OUTPUT); //    d_e   digitalWrite(d_e, 1); //     1,     D  E pinMode(b_a, INPUT); //    b_a   digitalWrite(b_a, 1); //   B pinMode(c_g, OUTPUT); //    c_g   digitalWrite(c_g, 0); //     0,   C,  G delayMicroseconds (150); // F, B, C, G c  150  pinMode(c_g, INPUT); //    c_g   digitalWrite(c_g, 1); //   G ,     delay (time_2); // F, B, C c  2 </span></span></code> </pre> <br>  Pada prinsipnya, semuanya harus jelas bahkan bagi mereka yang tidak terbiasa dengan Arduino, tetapi mengerti sedikit tentang pengendali.  Angka 150 mikrodetik dan 2 milidetik dipilih secara eksperimental oleh kecerahan segmen.  Dalam kode terakhir, Anda perlu menempatkan mereka dalam variabel yang terpisah sehingga Anda dapat mengubahnya selama debugging.  Dari angka-angka ini adalah mungkin untuk kira-kira menentukan urutan perbedaan arus di dua segmen dalam satu pasangan.  Karena segmen G bersinar sekitar 13 kali lebih sedikit daripada yang lain dan memberikan kecerahan yang sama, dapat diasumsikan bahwa arus yang melalui segmen ini 13 kali lebih banyak daripada yang lain.  Faktanya, ketergantungan kecerahan pada arus adalah nonlinier, sehingga arus dapat 25 kali lebih besar, yaitu 50 mA.  Bahwa dengan siklus tugas seperti itu cukup aman untuk keluaran MK.  By the way, perbedaan dalam arus dimainkan ke tangan ketika memecahkan masalah gambar 2. Seperti yang saya tulis di atas, segmen G hanya bisa menyala bersama dengan segmen C. Tapi jika Anda melewati 0 ke kaki MK, yang bertanggung jawab untuk C dan G, 150 μs, dan setelah 2 ms untuk mempertahankan 1 di atasnya, maka segmen G akan "bekerja" dengan kecerahan penuh, dan segmen C hanya akan memiliki sedikit waktu untuk menyala selama 150 mikrodetik yang sama.  Kami mendapatkan dua yang hampir penuh.  Jadi, saya berhasil melanggar aturan yang saya buat sendiri.  Apa yang tidak bisa dilakukan dari keputusasaan. <br><br>  Jadi, kami menyalakan sosok dengan empat kaki MK.  Sebenarnya, saya merindukan tahap ini untuk diri saya sendiri, segera ditampilkan dua karakter.  Untuk melakukan ini, lepaskan output dari anoda umum dari salah satu bit indikator dari plus daya, dan sambungkan ke output MK lain, dan anoda pelepasan lain ke output berikutnya (6 kaki sudah).  Sekarang, pada gilirannya, atur 1 pada anoda digit paling signifikan, tampilkan digit dari digit paling signifikan, lalu 1 pada anoda digit paling signifikan, dan tampilkan digit dari digit tertinggi, dan seterusnya dalam lingkaran.  Saya melakukan percobaan ini dengan Arduino Nano, dia punya cukup kaki.  Semua kode di-debug, bukan pertama kali.  Dan itu berhasil, sebagaimana mestinya. <br><br><div class="spoiler">  <b class="spoiler_title">Skema</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/m6/5t/jp/m65tjptj6-dkubdfrmwlxup9olm.jpeg" alt="gambar"><br></div></div><br>  Karena anoda terhubung secara bergantian, dengan bantuan penyempurnaan sederhana, satu lagi output dari MK dapat dirilis.  Berikut ini ringkasan diagram: <br><br><div class="spoiler">  <b class="spoiler_title">Skema</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8e/xe/zc/8exezcoas6flcayfpbvdeenevdm.jpeg" alt="gambar"><br></div></div><br>  Total gunakan 5 kaki MK untuk menampilkan angka dua digit.  Pada tahap ini, Anda sudah bisa mencoba dengan bayi ATtiny.  Yang saya lakukan.  Tapi tidak segera.  Sebuah sketsa yang dikompilasi dalam lingkungan Arduino untuk ATtiny13 membutuhkan sekitar 1,7 kB memori dengan 1 kB tersedia.  Untuk mengurangi ukuran, saya harus beralih ke port secara langsung, yang akan saya lakukan nanti.  Ngomong-ngomong, di Arduino saya menggunakan port yang sama yang akan saya gunakan pada ATtiny, itu sangat nyaman.  Mereka sudah ditunjukkan dalam diagram terakhir.  Setelah diproses, kode kehilangan satu kilobyte. <br><br>  Berikut adalah kode yang dihasilkan untuk ATtiny13: <br><br><div class="spoiler">  <b class="spoiler_title">Kode</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> time_2 2 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    ,  #define time_3 150 //    ,  byte in1_; byte in2_; int disp_; int d_ = 0; void setup() { } void loop() { d_ = d_ + 1; if (d_ &gt; 150) { //    150     1 d_ = 0; disp_ = disp_ + 1; if (disp_ &gt; 99)(disp_ = 0); //   0  99 } in2_ = disp_ / 10; //     -    10 in1_ = disp_ % 10; //          10 } switch (in1_) { case 0: DDRB = B00001111; PORTB = B00010000; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 1: DDRB = B00000111; PORTB = B00000110; delay (time_2); break; case 2: DDRB = B00011111; PORTB = B00000010; delayMicroseconds (time_3); DDRB = B00010011; PORTB = B00010010; delay (time_2); break; case 3: DDRB = B00011011; PORTB = B00000110; delayMicroseconds (time_3); DDRB = B00000011; delay (time_2); break; case 4: DDRB = B00010101; PORTB = B00001110; delayMicroseconds (time_3); DDRB = B00000101; delay (time_2); break; case 5: DDRB = B00011011; PORTB = B00001100; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 6: DDRB = B00011111; PORTB = B00001000; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 7: DDRB = B00001111; PORTB = B00010110; delayMicroseconds (time_3); DDRB = B00000111; delay (time_2); break; case 8: DDRB = B00011111; PORTB = B00000000; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 9: DDRB = B00011011; PORTB = B00000100; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; } switch (in2_) { case 0: DDRB = B00001111; PORTB = B00010001; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 1: DDRB = B00000111; PORTB = B00000111; delay (time_2); break; case 2: DDRB = B00011111; PORTB = B00000011; delayMicroseconds (time_3); DDRB = B00010011; PORTB = B00010011; delay (time_2); break; case 3: DDRB = B00011011; PORTB = B00000111; delayMicroseconds (time_3); DDRB = B00000011; delay (time_2); break; case 4: DDRB = B00010101; PORTB = B00001111; delayMicroseconds (time_3); DDRB = B00000101; delay (time_2); break; case 5: DDRB = B00011011; PORTB = B00001101; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 6: DDRB = B00011111; PORTB = B00001001; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 7: DDRB = B00001111; PORTB = B00010111; delayMicroseconds (time_3); DDRB = B00000111; delay (time_2); break; case 8: DDRB = B00011111; PORTB = B00000001; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 9: DDRB = B00011011; PORTB = B00000101; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; } DDRB = B00011111;//   PORTB = B00011110; delay (5); }</span></span></span></span></code> </pre><br></div></div><br>  Kode di atas akan memungkinkan ATtiny13 Anda membaca dari 0 hingga 99. Akan lebih tepat untuk memberikan kemungkinan penugasan kembali kaki MK.  Pemrograman guru dapat mengurangi kode beberapa kali ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Di mana batas Hello World minimum pada AVR?</a> ). <br><br>  Anda dapat menambahkan fungsi yang diperlukan ke kode sehingga MK menampilkan sesuatu yang disadari.  Benar, Tinki sudah memiliki semua kakinya terisi.  Ada juga leg reset yang dapat digunakan sebagai port input / output.  Tetapi menggunakannya lebih sulit dari yang saya kira.  Karena itu, untuk diriku sendiri aku pergi "untuk nanti"  Tetapi ada fitur menarik yang tidak semua orang tahu.  Input analog ADC0 adalah output ke kaki yang sama, dan berfungsi!  Benar, ketika tegangan di bawah kurang dari 1/4 dari tegangan suplai, MK beralih ke mode reset.  Tetapi dari 1/4 ke tegangan suplai, sangat mungkin untuk mengukur tegangan input.  Saya mengambil keuntungan dari ini: <br><br><div class="spoiler">  <b class="spoiler_title">Kode</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> time_2 2 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    ,  #define time_3 150 //    ,  byte in1_; byte in2_; int disp_; int d_ = 0; void setup() { } void loop() { d_ = d_ + 1; if (d_ &gt; 50) { //   50 ... d_ = 0; disp_ = analogRead(A0) / 10; // ...   ,   10,    . if (disp_ &gt; 99)(disp_ = 99); in2_ = disp_ / 10; //     -    10 in1_ = disp_ % 10; //          10 } switch (in1_) { case 0: DDRB = B00001111; PORTB = B00010000; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 1: DDRB = B00000111; PORTB = B00000110; delay (time_2); break; case 2: DDRB = B00011111; PORTB = B00000010; delayMicroseconds (time_3); DDRB = B00010011; PORTB = B00010010; delay (time_2); break; case 3: DDRB = B00011011; PORTB = B00000110; delayMicroseconds (time_3); DDRB = B00000011; delay (time_2); break; case 4: DDRB = B00010101; PORTB = B00001110; delayMicroseconds (time_3); DDRB = B00000101; delay (time_2); break; case 5: DDRB = B00011011; PORTB = B00001100; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 6: DDRB = B00011111; PORTB = B00001000; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 7: DDRB = B00001111; PORTB = B00010110; delayMicroseconds (time_3); DDRB = B00000111; delay (time_2); break; case 8: DDRB = B00011111; PORTB = B00000000; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 9: DDRB = B00011011; PORTB = B00000100; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; } switch (in2_) { case 0: DDRB = B00001111; PORTB = B00010001; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 1: DDRB = B00000111; PORTB = B00000111; delay (time_2); break; case 2: DDRB = B00011111; PORTB = B00000011; delayMicroseconds (time_3); DDRB = B00010011; PORTB = B00010011; delay (time_2); break; case 3: DDRB = B00011011; PORTB = B00000111; delayMicroseconds (time_3); DDRB = B00000011; delay (time_2); break; case 4: DDRB = B00010101; PORTB = B00001111; delayMicroseconds (time_3); DDRB = B00000101; delay (time_2); break; case 5: DDRB = B00011011; PORTB = B00001101; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 6: DDRB = B00011111; PORTB = B00001001; delayMicroseconds (time_3); DDRB = B00001001; delay (time_2); break; case 7: DDRB = B00001111; PORTB = B00010111; delayMicroseconds (time_3); DDRB = B00000111; delay (time_2); break; case 8: DDRB = B00011111; PORTB = B00000001; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; case 9: DDRB = B00011011; PORTB = B00000101; delayMicroseconds (time_3); DDRB = B00000001; delay (time_2); break; } DDRB = B00011111;//   PORTB = B00011110; delay (5); }</span></span></span></span></code> </pre><br></div></div><br>  Pengalaman menunjukkan bahwa indikator dapat dikurangi hingga 21, hanya kemudian MK masuk ke mode reset dan mulai bekerja ketika kembali ke sekitar 25 ke atas.  Jadi dimungkinkan untuk membuat "indikator" yang sangat salah untuk menunjukkan tegangan dari 25 hingga 99 volt, tentu saja, dengan pembagi pada input pengukuran. <br><br>  Sekarang tentang aplikasi praktis.  Gagasan asli menampilkan data dari sensor jarak ditunda hingga waktu yang lebih baik karena kurangnya satu input digital.  Kenapa lagi Anda bisa menerapkan skema sampai ide datang.  Peringatan lain: tidak ada pertanyaan tentang keuntungan.  Bahkan jika Anda melunasi semua segmen, arus 2,5 mA akan mengalir melalui resistor R2 (sesuai dengan skema pertama), secara total 10 mA ke indikator, ditambah kontrol transistor menambahkan sekitar 5 lebih.  Saya tidak menyebutkan, transistor dari hampir semua pnp modern. <br><br>  Tentang kemanfaatan.  Pilihan termurah untuk output ke tujuh segmen adalah ATtiny13 plus 74HC595.  Dua kasus SMD akan menelan biaya sekitar 0,50 cu  Yang paling sederhana adalah ATmega8 (dan hanya itu, tidak ada resistor, tidak lebih), itu 0,68 cu  Dan opsi yang dijelaskan di atas adalah biaya ATtiny, 9 resistor, 4 LED, transistor (semua SMD) - ini sekitar 0,46 cu, meskipun itu sepotong demi sepotong semuanya lebih mahal di kali.  Selain itu, menyatukan semuanya lebih rumit daripada di versi sebelumnya. <br><br>  Sebenarnya, satu-satunya pilihan yang bisa saya lihat adalah jika Anda memiliki ATtiny13 penuh, tetapi Anda masih perlu pergi ke toko untuk ATmega.  Nah, jika indikator tujuh segmen adalah dekorasi utama perangkat Anda, saya tidak akan merekomendasikan skema ini, tampilan tidak sempurna, dalam beberapa kombinasi, segmen yang tidak perlu sedikit disorot.  Kebetulan indikasi itu kadang-kadang diperlukan ketika mengatur, kemudian tempat itu sendiri. <br><br>  Secara umum, saya menghabiskan beberapa hari dengan sia-sia. <br><br>  Selain kritik, saya menunggu saran untuk memperbaiki kode dan menyederhanakan skema.  Atau fungsionalitas yang ditingkatkan tanpa komplikasi.  Yang paling menarik minat saya adalah bagaimana menjelaskan suatu hal, ini akan memperluas cakupan.  Tetapi jika kita juga bisa mengeluarkan satu kesimpulan dari 5 yang terlibat, maka akan mungkin untuk berkeliaran. <br><br>  Saya akan senang jika solusi non-standar saya akan menguntungkan seseorang, bukan sekarang, suatu hari nanti. <br><br><blockquote>  UPD: Saya tahu tentang Charliplexing!  Skema pihak ketiga yang saya kutip di awal artikel ini adalah Charliplexing.  Dan di sana saya menulis mengapa Charliplexing tidak cocok. <br>  Tolong jangan menulis komentar jika Anda membaca artikel secara diagonal. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446796/">https://habr.com/ru/post/id446796/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446782/index.html">Yo-ho-ho dan sebotol rum</a></li>
<li><a href="../id446786/index.html">Mengapa saya menolak Disqus dan Anda harus pergi juga</a></li>
<li><a href="../id446788/index.html">Kiat & trik Kubernetes: tentang pengembangan lokal dan Telepresence</a></li>
<li><a href="../id446790/index.html">Bagaimana saya menemukan telur paskah di keamanan Android dan tidak mendapatkan pekerjaan di Google</a></li>
<li><a href="../id446794/index.html">Kami bekerja dengan Wordstat dengan benar. Panduan lengkap</a></li>
<li><a href="../id446798/index.html">Kepergian seorang insinyur elektronik dari Apple menyebabkan kegemparan di antara para spekulan saham. Bagaimana menjadi seperti dia?</a></li>
<li><a href="../id446802/index.html">Refill Dot Cartridges - Sangat Menarik</a></li>
<li><a href="../id446806/index.html">Latar Belakang: "Runet Autonomous" - apa itu dan siapa yang membutuhkannya</a></li>
<li><a href="../id446808/index.html">Kompiler saya untuk Lisp</a></li>
<li><a href="../id446810/index.html">Jika Anda memiliki sebungkus rokok di saku Anda ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>