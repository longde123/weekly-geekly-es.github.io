<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úä üí™üèΩ üë©‚Äçüé® TelegramBot. La funcionalidad b√°sica. Pegatinas y emoticones. (Parte 3) üë®üèø‚Äçüé§ üßëüèø üíáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Una de las preguntas que a menudo viene en PM es c√≥mo trabajar con sonrisas (emojis) y pegatinas. 

 C√≥mo trabajar con ellos, qu√© herramientas uso, et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TelegramBot. La funcionalidad b√°sica. Pegatinas y emoticones. (Parte 3)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482260/"> Una de las preguntas que a menudo viene en PM es c√≥mo trabajar con sonrisas (emojis) y pegatinas. <br><br>  C√≥mo trabajar con ellos, qu√© herramientas uso, etc. <br><br>  En esta parte, consideraremos tales cosas: c√≥mo crear un mensaje con una pegatina, c√≥mo procesar un mensaje recibido con una pegatina, c√≥mo encontrar todos los emoticones (emoji) en el texto del mensaje, c√≥mo crear un mensaje usando emoticones. <br><br>  A qui√©n le importa, por favor, debajo del gato. <br><a name="habracut"></a><br>  Por tradici√≥n, comenzamos el art√≠culo con un enlace a la fuente para ello :) <br><br>  Todo el c√≥digo discutido en el art√≠culo est√° compilado en la <a href="https://github.com/dp-ua/TelegramBotBase/tree/Part3-Stick_and_Emoji">rama Part3-Stick_and_Emoji</a> . <br><br><h3>  Pegatinas </h3><br>  Una de las cosas que me gustaron tanto en el telegrama en cuanto apareci√≥ fueron las pegatinas.  Son geniales, c√≥modos, gratis.  Y toda esta gran variedad de pegatinas que naturalmente queremos usar en el bot.  De hecho, este procedimiento es muy simple.  Para enviar una pegatina a un usuario, solo necesitamos conocer la identificaci√≥n de la pegatina y nada m√°s. <br>  Por lo general, para las etiquetas, creo una clase de asistente, donde almaceno datos sobre las etiquetas utilizadas en el bot: <br><br>  <a href="">Stickers.java</a> <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.telegram.telegrambots.api.methods.send.SendSticker; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Stickers { FUNNY_JIM_CARREY(<span class="hljs-string"><span class="hljs-string">"CAADBQADiQMAAukKyAPZH7wCI2BwFxYE"</span></span>), ; String stickerId; Stickers(String stickerId) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stickerId = stickerId; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SendSticker </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSendSticker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String chatId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span>.equals(chatId)) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalArgumentException(<span class="hljs-string"><span class="hljs-string">"ChatId cant be null"</span></span>); SendSticker sendSticker = getSendSticker(); sendSticker.setChatId(chatId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sendSticker; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> SendSticker </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSendSticker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SendSticker sendSticker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SendSticker(); sendSticker.setSticker(stickerId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sendSticker; } }</code> </pre> <br>  Todo es simple aqu√≠.  Le damos a la pegatina un nombre que nos es comprensible.  Y con la ayuda de un par de m√©todos, obtenemos un objeto listo para enviar al usuario. <br><br>  Para responder a la pregunta: "¬øD√≥nde puedo obtener la ID de la pegatina?", Escribamos un asistente que nos proporcionar√° estos datos en nuestro bot. <br><br>  Tenemos la funcionalidad b√°sica que creamos aqu√≠: <br>  <a href="https://habr.com/ru/post/481354/">TelegramBot.</a>  <a href="https://habr.com/ru/post/481354/">La funcionalidad b√°sica.</a>  <a href="https://habr.com/ru/post/481354/">(Parte 2)</a> <br>  Para que nuestro bot pueda comenzar a procesar de alguna manera las pegatinas aceptadas, necesitamos: <br><br><ul><li>  Determina que nos enviaron una pegatina </li><li>  Indique qu√© manejador es responsable de procesar los mensajes con calcoman√≠as </li><li>  Ejecute un controlador que generar√° un mensaje para el usuario en respuesta </li></ul><br>  <b>Tarea</b> : al recibir una pegatina en el chat, el bot debe enviar un mensaje de texto con la ID de la pegatina en respuesta. <br><br>  <a href="">Agregamos el</a> comando <a href="">STICKER</a> a la lista de comandos <br><br>  En el analizador de la actualizaci√≥n enviada, intentaremos determinar si tenemos un mensaje de texto o si contiene una pegatina: <br><br>  <a href="">MessageReciever.java l√≠nea 57</a> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (message.hasText()) { parsedCommand = parser.getParsedCommand(message.getText()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Sticker sticker = message.getSticker(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sticker != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { parsedCommand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ParsedCommand(Command.STICKER, sticker.getFileId()); } }</code> </pre> <br>  Porque  no necesitamos hacer un procesamiento complejo del mensaje enviado, entonces confiaremos el procesamiento de los mensajes que contienen la etiqueta al manejador existente responsable de manejar los llamados "mensajes del sistema": <br>  <a href="">MessageReciever.java l√≠nea 86</a> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> START: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> HELP: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ID: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> STICKER: SystemHandler systemHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SystemHandler(bot); log.info(<span class="hljs-string"><span class="hljs-string">"Handler for command["</span></span> + command.toString() + <span class="hljs-string"><span class="hljs-string">"] is: "</span></span> + systemHandler); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> systemHandler;</code> </pre> <br>  En consecuencia, en <b>SystemHandler</b> necesitamos especificar c√≥mo procesar el comando <b>STICKER</b> recibido: <br>  <a href="">SystemHandler.java l√≠nea 31</a> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> STICKER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"StickerID: "</span></span> + parsedCommand.getText();</code> </pre> <br>  Como resultado, al enviar cualquier pegatina a nuestro bot, recibiremos su ID en respuesta: <br><br><img src="https://habrastorage.org/webt/3i/56/dy/3i56dyf1gkch2j-xgy9o-gjk8si.png"><br><br><h3>  Emoticones o Emoji </h3><br>  Se estandarizaron, casi todos los dispositivos y sistemas operativos los entienden y pueden mostrar.  Son muy convenientes de usar para decorar mensajes.  Se ven sucintamente en los botones debajo de los mensajes.  Nos guste o no, algunas ventajas. <br><br>  Por ejemplo, en el <a href="https://t.me/EventCheckPlanner_Bot">bot del planificador de eventos</a> <br><br><img src="https://habrastorage.org/webt/r3/bq/bd/r3bqbdspnrch4-qy28vppzwxiks.png"><br><br>  Usando los mismos √≠conos en los botones y en el texto del mensaje, le permite al usuario entender intuitivamente y entender su interfaz, abarrotando el mensaje y los botones con texto en exceso. <br><br>  Para mostrar emojis en un mensaje o en un bot√≥n, debe conocer su Unicode.  Internet est√° lleno de fuentes donde puede encontrar todos los emoticones enumerados, donde se indican sus etiquetas y c√≥digos. <br>  Por mi parte, eleg√≠ esta forma de trabajar con emojis: es m√°s conveniente mirar y seleccionar emoticones en el telegrama mismo. <br><br>  Bueno, por supuesto, por analog√≠a con las pegatinas, escribamos un peque√±o ayudante para nosotros que nos mostrar√° los c√≥digos necesarios e incluso para garantizar que los procesemos correctamente. <br><br>  En primer lugar, agregue la siguiente dependencia a <a href="">pom.xml</a> : <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.vdurmont<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>emoji-java<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.3.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Honestamente, no recuerdo d√≥nde lo encontr√©, pero desde entonces solo lo uso si necesito hacer algo con emoticones en mi bot. <br><br>  La biblioteca contiene muchas herramientas diferentes: <br><br><img src="https://habrastorage.org/webt/ri/4e/qm/ri4eqmdo2uiyrnwoxck1trfklim.png"><br><br>  Inquisitivo e inquisitivo ser√° donde dar la vuelta :) <br><br>  ¬øQu√© se necesita para enviar un emotic√≥n usando un bot?  Debe incrustar el emoji deseado en el texto del mensaje Unicode. <br><br>  S√≠, puede encontrar recursos que ofrecen listas Unicode con emojis, muestran diferentes tablas de resumen de c√≥mo se ven los emoticones en diferentes tel√©fonos inteligentes. <br><br>  Quiero mostrarte una forma que result√≥ ser la m√°s conveniente para trabajar con sonrisas para m√≠. <br><br>  Primero, veamos c√≥mo puedes usar sonrisas en el telegrama.  Puede abrir un cuadro de di√°logo donde se enumeran todos los emoticones y agregarlos al mensaje, simplemente haciendo clic en sus iconos.  Tambi√©n se pueden agregar emoticones al mensaje mediante etiquetas. <br><br>  Las etiquetas deben estar enmarcadas en dos puntos y contener alg√∫n tipo de texto √∫nico que indique el smiley deseado. <br><br>  Si en el campo para ingresar un mensaje comienza a escribir un mensaje que comienza con dos puntos, el telegrama comenzar√° a mostrar qu√© emojis contienen el texto ingresado de la etiqueta: <br><br><img src="https://habrastorage.org/webt/hr/s4/1o/hrs41orsvl1k4mkpt7mxlja-bnm.png"><br><br>  Y cuando ingrese la etiqueta de emotic√≥n correcta y coloque otros dos puntos, el texto se convertir√° en una carita sonriente.  Las etiquetas tambi√©n se muestran si mantiene presionado el bot√≥n izquierdo del mouse en el emotic√≥n. <br><br><img src="https://habrastorage.org/webt/t-/ib/ya/t-ibya9mw4829qau8wnz9h8uxwq.png"><br><br>  Y ahora la biblioteca viene en nuestra ayuda, cuya dependencia agregamos anteriormente.  Ella sabe c√≥mo trabajar con etiquetas de emoticones.  Esto es conveniente principalmente para usted, ya que las etiquetas son m√°s legibles, tienen alg√∫n tipo de significado. <br><br>  Y nosotros, conociendo la etiqueta, podemos obtener el emotic√≥n Unicode as√≠: <br><br><pre> <code class="java hljs">String emoji_kissing = EmojiParser.parseToUnicode(<span class="hljs-string"><span class="hljs-string">":kissing:"</span></span>);</code> </pre> <br>  Puedes hacerte una clase separada en la que mantendr√°s los emoticones que usas en el bot.  En el ejemplo del mismo <a href="https://t.me/EventCheckPlanner_Bot">organizador de eventos</a> , tiene estas sonrisas en su arsenal: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiParser; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Icon { PLUS(<span class="hljs-string"><span class="hljs-string">":heavy_plus_sign:"</span></span>), MINUS(<span class="hljs-string"><span class="hljs-string">":heavy_minus_sign:"</span></span>), CHECK(<span class="hljs-string"><span class="hljs-string">":white_check_mark:"</span></span>), NOT(<span class="hljs-string"><span class="hljs-string">":x:"</span></span>), DOUBT(<span class="hljs-string"><span class="hljs-string">":zzz:"</span></span>), FLAG(<span class="hljs-string"><span class="hljs-string">":checkered_flag:"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> EmojiParser.parseToUnicode(value); } Icon(String value) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } }</code> </pre> <br>  Y as√≠ es como se ver√° el c√≥digo usando esta clase y un emotic√≥n espec√≠fico: <br><br><pre> <code class="java hljs"> row.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InlineKeyboardButton() .setText(Icon.CHECK.get() + <span class="hljs-string"><span class="hljs-string">" I'm going"</span></span>)</code> </pre> <br>  Este es el c√≥digo para este bot√≥n: <br><br><img src="https://habrastorage.org/webt/bc/lw/ou/bclwou1ukoe0nosc7iyfnqw6zki.png"><br><br>  Not√© un matiz de esta biblioteca.  No todos los emoticones que est√°n en un telegrama, la biblioteca puede reconocerlos.  Por lo tanto, tenga cuidado con las nuevas versiones de la biblioteca. <br><br>  Bueno, para estar seguros de qu√© sonrisas podemos mostrar y cu√°les no, confiaremos esta tarea a nuestro asistente. <br><br>  <b>Tarea:</b> si el mensaje enviado no contiene ning√∫n comando espec√≠fico, pero contiene sonrisas en el texto, muestre estas sonrisas en la pantalla en forma de mensaje para el usuario e indique sus atributos (etiqueta y descripci√≥n). <br><br>  Agregue el comando <b>TEXT_CONTAIN_EMOJI</b> a la lista de comandos <br>  <a href="">Command.java l√≠nea 8</a> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Command { ... TEXT_CONTAIN_EMOJI, ... }</code> </pre> <br>  En el analizador que determina qu√© tipo de comando est√° contenido en nuestro mensaje, agregue el siguiente texto: <br><br>  <a href="">Parser.java l√≠nea 38</a> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.getCommand() == Command.NONE) { List&lt;String&gt; emojiContainsInText = EmojiParser.extractEmojis(result.getText()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emojiContainsInText.size() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) result.setCommand(Command.TEXT_CONTAIN_EMOJI); }</code> </pre> <br>  Si determinamos que el mensaje no contiene ning√∫n comando espec√≠fico, pero contiene emoticones, devolvemos que analizamos el comando TEXT_CONTAIN_EMOJI. <br><br>  Cree un controlador separado que solo procesar√° este comando: <br>  <a href="">EmojiHandler.java</a> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.example.telegrambot.bot.Bot; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.example.telegrambot.command.ParsedCommand; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.Emoji; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vdurmont.emoji.EmojiParser; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.log4j.Logger; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.telegram.telegrambots.api.objects.Update; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashSet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Set; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmojiHandler</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AbstractHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger log = Logger.getLogger(EmojiHandler.class); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EmojiHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bot bot)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(bot); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String chatId, ParsedCommand parsedCommand, Update update)</span></span></span><span class="hljs-function"> </span></span>{ String text = parsedCommand.getText(); StringBuilder result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); Set&lt;String&gt; emojisInTextUnique = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;&gt;(EmojiParser.extractEmojis(text)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (emojisInTextUnique.size() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) result.append(<span class="hljs-string"><span class="hljs-string">"Parsed emojies from message:"</span></span>).append(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String emojiUnicode : emojisInTextUnique) { Emoji byUnicode = EmojiManager.getByUnicode(emojiUnicode); log.debug(byUnicode.toString()); String emoji = byUnicode.getUnicode() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + byUnicode.getAliases() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + byUnicode.getDescription(); result.append(emoji).append(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.toString(); } }</code> </pre> <br>  Este c√≥digo selecciona solo emoticones del texto del mensaje, forma un conjunto con los √∫nicos, selecciona etiquetas y descripci√≥n de sus propiedades, y genera un mensaje de texto a partir de esto. <br><br>  El resultado del trabajo se ve as√≠: <br><br><img src="https://habrastorage.org/webt/ia/wy/sx/iawysxkxh3utfud9znjifqrgosm.png"><br><br>  Entre corchetes obtenemos etiquetas que podemos usar para insertar emoticones.  Puede ver que m√°s de 1 etiqueta a veces se refiere a un emotic√≥n. <br><br>  Y tambi√©n, con la ayuda de este asistente, podemos entender con precisi√≥n qu√© emoticones entiende nuestra biblioteca y cu√°les ignora. <br><br>  Como, por ejemplo, puedes ver aqu√≠: <br><br><img src="https://habrastorage.org/webt/bz/f9/5i/bzf95i9alj3uqweuzdxfqg9ost0.png"><br><br>  Sonr√≠e con el c√≥digo <i>: face_with_monocle:</i> por alguna raz√≥n, esta biblioteca no lo detecta. <br><br>  Entonces, tenemos un controlador.  ¬øC√≥mo le pasamos la tarea a √©l? <br><br>  Porque  ya sabemos que un mensaje de texto con emoticones dentro se detecta como un comando TEXT_CONTAIN_EMOJI; en MessageReciever debemos indicar que un controlador EmojiHandler es responsable de procesar este comando. <br><br>  <a href="">MessageReciever.java l√≠nea 94</a> <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TEXT_CONTAIN_EMOJI: EmojiHandler emojiHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EmojiHandler(bot); log.info(<span class="hljs-string"><span class="hljs-string">"Handler for command["</span></span> + command.toString() + <span class="hljs-string"><span class="hljs-string">"] is: "</span></span> + emojiHandler); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> emojiHandler;</code> </pre> <br>  Programa con mucho gusto y no dudes en hacer preguntas :) <br><br>  PS <br>  Puedes sentir el bot con esta funcionalidad aqu√≠: <a href="https://t.me/test_habr_bot">https://t.me/test_habr_bot</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/482260/">https://habr.com/ru/post/482260/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../482250/index.html">Una m√°quina de estado simple para VueJS</a></li>
<li><a href="../482252/index.html">Inodoro autom√°tico para gatos - continuaci√≥n</a></li>
<li><a href="../482254/index.html">Experimento VonmoTrade. Parte 3: Libro de warrants. Procesamiento y almacenamiento de informaci√≥n comercial.</a></li>
<li><a href="../482256/index.html">La IA y el futuro del trabajo: perspectivas de empleo en el futuro cercano</a></li>
<li><a href="../482258/index.html">C√≥mo funcionan las redes neuronales y por qu√© comenzaron a traer mucho dinero</a></li>
<li><a href="../482262/index.html">C√≥mo iniciar sesi√≥n en Talend Open Studio</a></li>
<li><a href="../482264/index.html">Brasil, magia oscura, Mortal Kombat, Marte y 15,000 personas. Resultados del a√±o de Ontiko</a></li>
<li><a href="../482268/index.html">Megaestructuras del futuro: la esfera Dyson, el motor estelar y la "bomba de agujero negro"</a></li>
<li><a href="../482272/index.html">Elecci√≥n de un almac√©n de datos para Prometheus: Thanos vs VictoriaMetrics</a></li>
<li><a href="../482274/index.html">5 razones por las que debe dejar de usar System.Drawing en ASP.NET</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>