<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉโ๐ฆโ๐ฆ ๐จ๐ฟโ๐ ๐ ุชุตุญูุญ ุงูุฃุฎุทุงุก ุจุนุฏ ุงูููุงุฉ ุนูู Cortex-M ๐ฑ ๐๐ป ๐จโ๐ฉโ๐งโ๐ฆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุตุญูุญ ุงูุฃุฎุทุงุก ุจุนุฏ ุงูููุงุฉ ุนูู Cortex-M 



 ุฎูููุฉ: 


 ุดุงุฑูุช ูุคุฎุฑูุง ูู ุชุทููุฑ ุฌูุงุฒ ุบูุฑ ุนุงุฏู ุจุงููุณุจุฉ ูู ูู ูุฆุฉ ุงูุฃุฌูุฒุฉ ุงูุฅููุชุฑูููุฉ ุงูุงุณุชููุงููุฉ. ูุจุฏู ุฃูู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุตุญูุญ ุงูุฃุฎุทุงุก ุจุนุฏ ุงูููุงุฉ ุนูู Cortex-M</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452704/" style=";text-align:right;direction:rtl"><h1 id="post-mortem-otladka-na-cortex-m" style=";text-align:right;direction:rtl">  ุชุตุญูุญ ุงูุฃุฎุทุงุก ุจุนุฏ ุงูููุงุฉ ุนูู Cortex-M </h1><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ya/rn/fd/yarnfd_zlonid-bdujxzbnikuuu.png"></p><br><h2 id="predystoriya" style=";text-align:right;direction:rtl">  ุฎูููุฉ: </h2><br><p style=";text-align:right;direction:rtl">  ุดุงุฑูุช ูุคุฎุฑูุง ูู ุชุทููุฑ ุฌูุงุฒ ุบูุฑ ุนุงุฏู ุจุงููุณุจุฉ ูู ูู ูุฆุฉ ุงูุฃุฌูุฒุฉ ุงูุฅููุชุฑูููุฉ ุงูุงุณุชููุงููุฉ.  ูุจุฏู ุฃูู ููุณ ุดูุฆูุง ูุนูุฏูุง ุ ุตูุฏูููุง ูุฌุจ ุฃู ูุฎุฑุฌ ุฃุญูุงููุง ุนู ูุถุน ุงูุณููู ุ ููุจูุบ ุฅูู ุงูุฎุงุฏู ูููุงู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุธูุฑุช ุงูููุงุฑุณุฉ ุจุณุฑุนุฉ ุฃู ูุตุญุญ ุงูุฃุฎุทุงุก ูุง ูุณุงุนุฏ ูุซูุฑูุง ุนูุฏ ุงูุนูู ูุน ูุชุญูู ูุณุชูุฑ ูู ูุถุน ุงูุณููู ุงูุนููู ุฃู ููุทุน ุงูุทุงูุฉ.  ูู ุงูุฃุณุงุณ ุ ูุฃู ุงููุฑุจุน ูู ูุถุน ุงูุงุฎุชุจุงุฑ ูุงู ุจุฏูู ูุตุญุญ ูุจุฏููู ูุฑูุจ <em>ูุฃุญูุงููุง ูุงู</em> ุนุฑุจุงุช ุงูุชู ุชุฌุฑูุง ุงูุฏูุงุจ.  ุญูุงูู ูุฑุฉ ูุงุญุฏุฉ ูู ุจุถุนุฉ ุฃูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุชู ุชุตุญูุญ ุฃุฎุทุงุก UART ุนูู ุงููุชุญุงุช ุ ูุงูุชู ุจุฏุฃุช ูู ุฅุฎุฑุงุฌ ุงูุณุฌูุงุช ูููุง.  ุฃุตุจุญ ุฃุณูู ุ ุชู ุญู ุจุนุถ ุงููุดุงูู.  ูููู ุจุนุฏ ุฐูู ุญุฏุซ ุชุฃููุฏ ููู ุฐูู ุญุฏุซ. </p><a name="habracut"></a><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ุญุงูุชู ุ ูุจุฏู ุงููุงูุฑู ููุชุฃููุฏ ุดูุฆูุง ูุซู ูุฐุง:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> USER_ASSERT( statement ) \ do \ { \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(! (statement) ) \ { \ DEBUG_PRINTF_ERROR( </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Assertion on line %d in file %s!\n"</span></span></span><span class="hljs-meta">, \ __LINE__, __FILE__ ); \ \ __disable_irq(); \ while(1) \ { \ __BKPT(0xAB); \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(0) \ break; \ } \ } \ } while(0)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <code>__BKPT(0xAB)</code> ููุทุฉ ุชููู ุจุฑูุงูุฌุ  ุฅุฐุง ุญุฏุซ ุงูุชูููุฏ ุชุญุช ุชุตุญูุญ ุงูุฃุฎุทุงุก ุ ูุฅู ุงููุตุญุญ ูุชููู ุนูุฏ ุฎุท ุงููุดููุฉ ุ ููุฐุง ููุงุณุจ ููุบุงูุฉ. </p></div></div><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ูุจุนุถ ุงูุชุฃููุฏุงุช ุ ูุชุถุญ ุนูู ุงูููุฑ ุณุจุจ ุฐูู - ูุฃู ุงูุณุฌู ููุธูุฑ ุงุณู ุงูููู ูุฑูู ุงูุณุทุฑ ุงูุฐู ุนูู ุนููู ุงูุชุฃููุฏ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ููููุง ููุชุฃููุฏ ุ ูุงู ูู ุงููุงุถุญ ููุท ุฃู ุงููุตูููุฉ ูุงูุช ุชููุถ - ูุจุดูู ุฃูุซุฑ ุฏูุฉ ุ ุบูุงู ูุคูุช ููู ุงููุตูููุฉ ุ ูุงูุฐู ูุชุญูู ูู ุงููุฎุฑุฌ.  ููุฐุง ุงูุณุจุจ ุ ูุงู ุงุณู ุงูููู "super_array.h" ูุฑูู ุงูุณุทุฑ ููู ูุฑุฆููุง ููุท ูู ุงูุณุฌู.  ููุง ูุฌููุนุฉ ูุญุฏุฏุฉ ููุณุช ูุงุถุญุฉ.  ูู ุงูุณุฌูุงุช ุงููุญูุทุฉ ุ ููู ุบูุฑ ุงููุงุถุญ ุฃูุถุง. </p><br><p style=";text-align:right;direction:rtl">  ุจุงูุทุจุน ุ ูููู ูููุฑุก ุฃู ูุนุถ ุงูุฑุตุงุตุฉ ููุฐูุจ ุฅูู ูุฑุงุกุฉ ุงูููุฏ ุ ููููู ููุช ูุณูููุง ุฌุฏูุง ุ ููู ุซู ูู ุชูุฌุญ ุงูููุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุฐ ุฃู ูุชุจุช ูู uVision Keil 5 ูุน ูุชุฑุฌู armcc ุ ุชู ุงุฎุชุจุงุฑ ุฑูุฒ ุฅุถุงูู ููุท ุชุญุชู.  ููุง ุฃููู ุงุณุชุฎุฏูุช C ++ 11 ุ ูุฃูู ุจุงููุนู 2019 ูู ุงูููุงุก ุ ููุฏ ุญุงู ุงูููุช ุจุงููุนู. </p><br><h2 id="stacktrace" style=";text-align:right;direction:rtl">  ุชุชุจุน ููุฏุณ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุจุทุจูุนุฉ ุงูุญุงู ุ ูุฅู ุฃูู ูุง ูุชุจุงุฏุฑ ุฅูู ุงูุฐูู ูู ุ ูุนูุฉ ุ ูุฃูู ุนูุฏูุง ูุญุฏุซ ุชุฃููุฏ ุนูู ููุจููุชุฑ ุณุทุญ ุงูููุชุจ ุงูุนุงุฏู ุ ูุชู ุฅุฎุฑุงุฌ ุชุชุจุน ููุฏุณ ุฅูู ูุญุฏุฉ ุงูุชุญูู ุ ูุซู KDPV.  ูู ุชุชุจุน ุงูููุฏุณ ุ ููููู ุนุงุฏุฉ ููู ุชุณูุณู ุงูููุงููุงุช ุงูุฐู ุฃุฏู ุฅูู ุงูุฎุทุฃ. <br>  ุญุณููุง ุ ูุฐูู ุฃุญุชุงุฌ ุฃูุถูุง ุฅูู ูุณุงุฑ ุฎูุณุฉ.  ููู ุงุตูุนูุงุ </p><br><h3 id="mozhet-byt-esli-brosit-isklyuchenie-on-sam-vyvedetsya" style=";text-align:right;direction:rtl">  ุฑุจูุง ุฅุฐุง ุฑููุช ุงุณุชุซูุงุกูุง ุ ูุณูุชู ุงุณุชูุชุงุฌูุ </h3><br><p style=";text-align:right;direction:rtl">  ูููู ุงุณุชุซูุงุก ููุง ููุฌุฃ ุฅููู ุ ูุฑู ุฅุฎุฑุงุฌ "SIGABRT" ูุงูุฏุนูุฉ ุฅูู <code>_sys_exit</code> .  ููุณุช ุฑุญูุฉ ุ ุญุณูุงู ุ ุญุณููุง ุ ููุณ ุญููุง ุ ูุฃุฑุฏุช ุญููุง ุงูุณูุงุญ ุจุงูุงุณุชุซูุงุกุงุช. </p><br><h3 id="poguglit-kak-eto-drugie-lyudi-delayut" style=";text-align:right;direction:rtl">  ุบูุบูููุบ ููู ููุนู ุงูุขุฎุฑูู ุฐูู. </h3><br><p style=";text-align:right;direction:rtl">  ุฌููุน ุงูุทุฑู ุฎุงุตุฉ ุจุงูููุตุฉ (ููุณุช ููุงุฌุฆุฉ ููุบุงูุฉ) ุ <code>execinfo.h</code> ูู gcc ุถูู POSIX ุ ููุฌุฏ <code>backtrace()</code> ู <code>execinfo.h</code> .  ูู ููู ููุงู ุดูุก ูุงุถุญ ูููู.  ูุณูุท ุฏูุนุฉ ูุชูุณุทุฉ.  ุนููู ุฃู ุชุชุณูู ุงูููุฏุณ ุจูุฏูู. </p><br><h3 id="lezem-v-stek-rukami" style=";text-align:right;direction:rtl">  ูุญู ูุชุณูู ูู ุงููููุฉ ุจุฃูุฏููุง </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ูู ุดูุก ุจุณูุท ููุบุงูุฉ. </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุฌุฏ ุนููุงู ุงููุฑุชุฌุนุงุช ูู ุงููุธููุฉ ุงูุญุงููุฉ ูู ุณุฌู LR ุ ูุนููุงู ุงูุฌุฒุก ุงูุนููู ุงูุญุงูู ูู ุงูุฑุตุฉ (ุจูุนูู ุขุฎุฑ ุนูุตุฑ ูู ุงูุฑุตุฉ) ููุฌูุฏ ูู ุณุฌู SP ุ ูุนููุงู ุงูุฃูุฑ ุงูุญุงูู ูู ุณุฌู ุงูููุจููุชุฑ ุงูุดุฎุตู. </li><li style=";text-align:right;direction:rtl">  ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุ ูุฌุฏ ุญุฌู ุฅุทุงุฑ ุงูุฑุตุฉ ูููุธููุฉ ุงูุญุงููุฉ ุ ูุฎุทู ุทูู ุงูุฑุตุฉ ูู ูุซู ูุฐู ุงููุณุงูุฉ ุ ููุฌุฏ ุนููุงู ุงููุฑุณู ูููุธููุฉ ุงูุณุงุจูุฉ ููุงู ูููุฑุฑูุง ุญุชู ููุชูู ูู ุงูุฑุตุฉ ุฅูู ุงูููุงูุฉ. </li><li style=";text-align:right;direction:rtl">  ุจุทุฑููุฉ ูุง ุ ูุทุงุจู ุนูุงููู ุงูุฅุฑุฌุงุน ูุน ุฃุฑูุงู ุงูุฃุณุทุฑ ูู ุงููููุงุช ูุน ุงูููุฏ ุงููุตุฏุฑู. </li></ol><br><h4 id="okey-dlya-nachala--kak-uznat-razmer-stekovogo-kadra" style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุจุงููุณุจุฉ ูููุจุชุฏุฆูู - ููู ุฃุนุฑู ุญุฌู ุฅุทุงุฑ ุงูููุฏุณุ </h4><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฎูุงุฑุงุช ุจุดูู ุงูุชุฑุงุถู - ุนูู ูุง ูุจุฏู ุ ูุง ุดูุก ุนูู ุงูุฅุทูุงู ุ ูุชู ุชุฑููุฒูุง ุจุจุณุงุทุฉ ุจูุงุณุทุฉ ุงููุชุฑุฌู ูู "prolog" ู "epilogue" ููู ูุธููุฉ ุ ูู ุฃูุงูุฑ ุชุฎุตุต ูุชุญุฑุฑ ุฌุฒุกูุง ูู ุงูููุฏุณ ููุฅุทุงุฑ. <br>  ูููู ูุญุณู ุงูุญุธ ุ ูุชููุฑ ูุฏู armcc ุงูุฎูุงุฑ <code>--use_frame_pointer</code> ุ ุงูุฐู ูุฎุตุต ุณุฌู R11 ุชุญุช ูุคุดุฑ ุงูุฅุทุงุฑ - ุฃู  ูุคุดุฑ ุฅูู ุฅุทุงุฑ ููุฏุณ ุงููุธููุฉ ุงูุณุงุจูุฉ.  ุนุธูู ุ ุงูุขู ููููู ุงููุดู ูู ุฎูุงู ุฌููุน ุฅุทุงุฑุงุช ุงูููุฏุณ. </p><br><h4 id="teper--kak-sopostavit-adresa-vozvratov-so-strokami-v-faylah-s-ishodnikami" style=";text-align:right;direction:rtl">  ุงูุขู - ููู ุชุชุทุงุจู ูุน ุนูุงููู ุงููุฑุณู ูุน ุณูุงุณู ูู ุงููููุงุช ุงููุตุฏุฑุ </h4><br><p style=";text-align:right;direction:rtl">  ูุนูุฉ ุ ูุง ูุฑุฉ ุฃุฎุฑู.  ูุง ูุชู ูููุถ ูุนูููุงุช ุชุตุญูุญ ุงูุฃุฎุทุงุก ูู ูุชุญูู (ููู ุฃูุฑ ุบูุฑ ููุงุฌุฆ ุ ูุฃูู ูุฃุฎุฐ ุฃูุงูู ูุงุฆูุฉ).  ูู ูุง ุฒุงู ุจุฅููุงู ูุงูู ุฃู ุชุฌุนููุง ุชููุถ ููุงู ุ ูุง ุฃุนุฑู ุ ูู ุฃุณุชุทุน ุงูุนุซูุฑ ุนูููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุญู ุชููุฏ.  ูุฐูู ุ ูู ูุนูู ุงูุชูุฏูุณ ุงูุตุงุฏู - ูุซู ุฃุณูุงุก ุงููุธุงุฆู ูุฃุฑูุงู ุงูุฃุณุทุฑ ุนูู ุงูููุฑ ูุฅุฎุฑุงุฌ ุงูุชุตุญูุญ -.  ูููู ููููู ุนุฑุถ ุงูุนูุงููู ุ ุซู ุนูู ุงูููุจููุชุฑ ููุงุฑูุชูุง ุจุงููุธุงุฆู ูุงูุฃุฑูุงู ุ ุญูุซ ูุง ุชุฒุงู ููุงู ูุนูููุงุช ุชุตุญูุญ ุงูุฃุฎุทุงุก ูู ุงููุดุฑูุน. </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏู ุงูุฃูุฑ ูุญุฒููุง ููุบุงูุฉ ุ ูุฃูู ูุชุนูู ุนููู ุชุญููู ููู .map ุ ุงูุฐู ูุดูุฑ ุฅูู ูุทุงูุงุช ุงูุนูุงููู ุงูุชู ุชุดุบููุง ูู ูุธููุฉ.  ุซู ูู ุจุชุญููู ุงููููุงุช ุจุดูู ูููุตู ูุน ุชุนูููุงุช ุจุฑูุฌูุฉ ููููุฉ ููุนุซูุฑ ุนูู ุณุทุฑ ูุนูู.  ููุงู ุฑุบุจุฉ ุญุงุฏุฉ ููุชุณุฌูู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุจุงููุธุฑ ุจุนูุงูุฉ ูู ุงููุซุงุฆู ุงูุฎุงุตุฉ ุจุงูุฎูุงุฑ - ูุชูุญ <code>--use_frame_pointer</code> ุฑุคูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐู ุงูุตูุญุฉ</a> ุ ุงูุชู ุชููู ุฅู ูุฐุง ุงูุฎูุงุฑ ูููู ุฃู ูุคุฏู ุฅูู ุชุนุทู ูู HardFault ูู ุฃููุงุช ุนุดูุงุฆูุฉ.  ูู. <br>  ุญุณูุง ุ ููุฑ ุฃูุซุฑ. </p><br><h3 id="a-kak-eto-delaet-otladchik" style=";text-align:right;direction:rtl">  ููู ุงููุตุญุญ ุชูุนู ูุฐุงุ </h3><br><p style=";text-align:right;direction:rtl">  ูููู ุงููุตุญุญ ุจุทุฑููุฉ ูุง ูุธูุฑ ููุฏุณ ุงูุงุณุชุฏุนุงุก ุญุชู ุจุฏูู <code>frame pointer'a</code> .  ุญุณููุง ุ ูู ุงููุงุถุญ ููู ุฃู IDE ูุฏูู ูู ูุนูููุงุช ุงูุชุตุญูุญ ูู ูุชูุงูู ุงููุฏ ุ ูู ุงูุณูู ุนูููุง ููุงุฑูุฉ ุนูุงููู ูุฃุณูุงุก ุงููุธุงุฆู.  ูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ูุญุชูู Visual Studio ููุณู ุนูู ุดูุก ูู ูุฐุง ุงููุจูู - ุชูุฑูุบ ูุตุบุฑ - ุนูุฏูุง ููุดุฆ ุงูุชุทุจูู ุงููุนุทูุจ ููููุง ุตุบูุฑูุง ุ ุซู ุชููู ุจุฅุทุนุงู ุงูุงุณุชูุฏูู ููุณุชุนูุฏ ุญุงูุฉ ุงูุชุทุจูู ูู ููุช ุงูุชุนุทู.  ูููููู ุงููุธุฑ ูู ุฌููุน ุงููุชุบูุฑุงุช ุ ูุงููุดู ุนูู ุงูููุฏุณ ูู ุฑุงุญุฉ.  ุฌูุงูุฉ ุงูููู ูุฑุฉ ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ููุน ุจุณูุท ุฌุฏุง.  ููุท ุชุญุชุงุฌ <del>  ูุฑู ุงุณุชูุฑุงุฑ ุงูุณูููุชู ุณูููุฉ ูู ุงูุฃุฑุฏุงู ูู ููู </del>  ููุก ุงูููุฏุณ ูุน ุงูููู ุงูุชู ูุงูุช ููุฌูุฏุฉ ูู ููุช ุงูุณููุท ุ ูุนูู ูุง ูุจุฏู ุ ุงุณุชุนุงุฏุฉ ุญุงูุฉ ุงูุณุฌูุงุช.  ููุฐุง ูู ุดูุก ุ ุนูู ูุง ูุจุฏูุ </p><br><p style=";text-align:right;direction:rtl">  ูุฑุฉ ุฃุฎุฑู ุ ูุณู ูุฐู ุงูููุฑุฉ ุฅูู ููุงู ูุฑุนูุฉ. </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูู ุงููุชุญูู ุงูุฏููู ุ ุชุญุชุงุฌ ุฅูู ุงููุฑูุฑ ุนุจุฑ ุงูููุฏุณ ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ูููุฉ SP ุงูุญุงููุฉ ูุนููุงู ุจุฏุงูุฉ ุงูููุฏุณ. </li><li style=";text-align:right;direction:rtl">  ูู ูุญุฏุฉ ุงูุชุญูู ุ ุชุญุชุงุฌ ุฅูู ุนุฑุถ ููู ุงูุณุฌูุงุช. </li><li style=";text-align:right;direction:rtl">  ูู IDE ุ ุชุญุชุงุฌ ุฅูู ุฏูุน ุฌููุน ุงูููู ุจุทุฑููุฉ ูุง ูู "ุชูุฑูุบ ูุตุบุฑ" ูุฑุฉ ุฃุฎุฑู ุฅูู ุงูููุฏุณ.  ูููู ุงูุณุฌูุงุช ุฃูุถุง. </li></ol><br><h4 id="kak-poluchit-tekuschee-znachenie-sp" style=";text-align:right;direction:rtl">  ููููุฉ ุงูุญุตูู ุนูู ุงููููุฉ ุงูุญุงููุฉ ููุฑุฉ ุณูุฑูุฉุ </h4><br><p style=";text-align:right;direction:rtl">  ุนูู ูุญู ููุถู ุ ุนุฏู ุงูุชุธููู ุนูู ุงูุชุฌููุน.  ูู Cale ุ ูุญุณู ุงูุญุธ ุ ููุงู ูุธููุฉ ุฎุงุตุฉ (ูุถูู) - <code>__current_sp()</code> .  ูู ูุนูู Gcc ุ ููููู ูุณุช ุจุญุงุฌุฉ ุฅูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ููููุฉ ุงูุญุตูู ุนูู ุนููุงู ุจุฏุงูุฉ ุงูููุฏุณุ  ูุธุฑูุง ูุฃููู ุฃุณุชุฎุฏู ุงูุจุฑูุงูุฌ ุงููุตู ููุญูุงูุฉ ูู ุชุฌุงูุฒ ุงูุณุนุฉ (ุงูุชู ูุชุจุช ุนููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ) ุ ูุฅู ูุฌููุนุชู ุชููู ูู ูุณู ุฑุงุจุท ูููุตู ุ ูุงูุฐู <code>REGION_STACK</code> . <br>  ูุฐุง ูุนูู ุฃูู ูููู ุงูุนุซูุฑ ุนูู ุนููุงูู ุนูู ุฑุงุจุท ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุบูุฑุงุช ุบุฑูุจุฉ ูุน ุงูุฏููุงุฑุงุช ูู ุงูุฃุณูุงุก</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุฎูุงู ุงูุชุฌุฑุจุฉ ูุงูุฎุทุฃ ุ ูุฎุชุงุฑ ุงูุงุณู ุงููุทููุจ - <code>Image$$REGION_STACK$$ZI$$Limit</code> ุ ุชุญูู ุ ูุนูู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุถูุญ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฐุง ุฑูุฒ ุณุญุฑู ูุชู ุฅูุดุงุคู ูู ูุฑุญูุฉ ุงูุฑุจุท ุ ุจูุนูู ุฃูู ุจุตุฑุงูุฉ ุ ูุฅูู ููุณ ุซุงุจุชูุง ูู ูุฑุญูุฉ ุงูุชุฌููุน. <br>  ูุงุณุชุฎุฏุงููุง ุ ุชุญุชุงุฌ ุฅูู ุฅูุบุงุก ุงูุชุณุฌูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Image$$REGION_STACK$$ZI$$Limit; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> MemPointer = <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> *; <span class="hljs-comment"><span class="hljs-comment">//   ,   static const auto stack_upper_address = (MemPointer) &amp;( Image$$REGION_STACK$$ZI$$Limit );</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ูุง ุชุดุนุฑ ุจุงูุถูู ุ ูููููู ุจุจุณุงุทุฉ ุชุบููุฑ ุญุฌู ุงูุฑุตุฉ ุ ุญูุซ ุฅูู ูุงุฏุฑูุง ูุง ูุชุบูุฑ.  ูู ุฃุณูุฃ ุงูุญุงูุงุช ุ ูุง ูุฑู ูู ูุงูุฐุฉ ููุฏุณ ุงูููุงููุงุช ุฌููุน ุงูููุงููุงุช ุ ูููู ูุนุจ ุงูุฑูุชูู. </p><br><h4 id="kak-vyvesti-znacheniya-registrov" style=";text-align:right;direction:rtl">  ููููุฉ ุนุฑุถ ููู ุงูุชุณุฌููุ </h4><br><p style=";text-align:right;direction:rtl">  ูู ุงูุจุฏุงูุฉ ุงุนุชูุฏุช ุฃูู ูู ุงูุถุฑูุฑู ุนุฑุถ ุฌููุน ุณุฌูุงุช ุงูุฃุบุฑุงุถ ุงูุนุงูุฉ ุจุดูู ุนุงู ุ ุจุฏุฃุช ูู ุงูุชุดููุด ูุน ุงููุฌููุน ุ ููููู ุฃุฏุฑูุช ุณุฑูุนูุง ุฃูู ูู ูููู ููุงู ุฃู ูุนูู ูู ูุฐุง.  ุจุนุฏ ูู ุดูุก ุ ุณูุชู ุชูููุฐ ุฅุฎุฑุงุฌ minidump ุจูุงุณุทุฉ ูุธููุฉ ุฎุงุตุฉ ุจุงููุณุจุฉ ูู ุ ูุง ููุฌุฏ ุฃู ูุนูู ูู ููู ุงูุณุฌู ูู ุณูุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุญููุง ุฅูู Link Register (LR) ุ ุงูุฐู ูุฎุฒู ุนููุงู ุงููุฑุณู ูู ุงููุธููุฉ ุงูุญุงููุฉ ุ SP ุ ุงูุชู ุชุนุงูููุง ูุนูุง ุจุงููุนู ุ ู Program Counter (PC) ุ ุงูุฐู ูุฎุฒู ุนููุงู ุงูุฃูุฑ ุงูุญุงูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฑุฉ ุฃุฎุฑู ุ ูู ุฃุชููู ูู ุงูุนุซูุฑ ุนูู ุฎูุงุฑ ูู ุดุฃูู ุฃู ูุนูู ูุน ุฃู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ุ ูููู ููุงู ูุธุงุฆู <code>__return_address()</code> ูู Cale: <code>__return_address()</code> ูู LR ู <code>__current_pc()</code> ููููุจููุชุฑ ุงูุดุฎุตู. <br>  ููุชุงุฒ.  ูุจูู ูุฏูุน ุฌููุน ุงูููู ูู ุชูุฑูุบ ูุตุบุฑ ุงูุนูุฏุฉ ุฅูู ุงูููุฏุณ ุ ูููู ุงูุณุฌูุงุช ูู ุงูุณุฌูุงุช. </p><br><h4 id="kak-zagruzit-minidamp-v-pamyat" style=";text-align:right;direction:rtl">  ููููุฉ ุชุญููู ุชูุฑูุบ ูุตุบุฑ ูู ุงูุฐุงูุฑุฉุ </h4><br><p style=";text-align:right;direction:rtl">  ูู ุงูุจุฏุงูุฉ ุ ุฎุทุทุช ูุงุณุชุฎุฏุงู ุงูุฃูุฑ LOAD debugger ุ ูุงูุฐู ูุณูุญ ูู ุจุชุญููู ุงูููู ูู ููู hex ุฃู .bin ุฅูู ุงูุฐุงูุฑุฉ ุ ููููู ุงูุชุดูุช ุจุณุฑุนุฉ ุฃู LOAD ูุณุจุจ ูุง ูุง ูููู ุจุชุญููู ุงูููู ุฅูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู. <br>  ููุง ุฒูุช ุบูุฑ ูุงุฏุฑ ุนูู ุฅููุงู ุงูุณุฌูุงุช ุจูุฐุง ุงูุฃูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุญุณููุง ุ ูุง ูุฒุงู ูุชุทูุจ ุงููุซูุฑ ูู ุงูุฅููุงุกุงุช ุ ุชุญููู ุงููุต ุฅูู ุจู ุ ุชุญููู ุจู ุฅูู ุณุช ุนุดุฑู ... </p><br><p style=";text-align:right;direction:rtl">  ูุญุณู ุงูุญุธ ุ ูุญุชูู Cale ุนูู ูุญุงูู ุ ูุจุงููุณุจุฉ ูููุญุงูู ุ ููููู ูุชุงุจุฉ ุงูุจุฑุงูุฌ ุงููุตูุฉ ุจูุบุฉ C- ุงูุจุงุฆุณุฉ.  ููู ูุฐู ุงููุบุฉ ููุงู ูุฑุตุฉ ูููุชุงุจุฉ ูู ุงูุฐุงูุฑุฉ!  ููุงู ูุธุงุฆู ุฎุงุตุฉ ูุซู <code>_WDWORD</code> ู <code>_WBYTE</code> .  ูููู ุจุฌูุน ูู ุงูุฃููุงุฑ ูู ูููุฉ ุ ูุงูุญุตูู ุนูู ูุซู ูุฐุง ุงูุฑูุฒ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูู ุงูููุฏ:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> USER_ASSERT( statement ) \ do \ { \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(! (statement) ) \ { \ DEBUG_PRINTF_ERROR( </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Assertion on line %d in file %s!\n"</span></span></span><span class="hljs-meta">, \ __LINE__, __FILE__ ); \ \ print_minidump(); \ __disable_irq(); \ while(1) \ { \ __BKPT(0xAB); \ </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(0) \ break; \ } \ } \ } while(0) </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   ,    //   ,         scatter- extern unsigned int Image$$REGION_STACK$$ZI$$Limit; void print_minidump() { //   - armcc  arm-clang #if __CC_ARM || ( (__ARMCC_VERSION) &amp;&amp; (__ARMCC_VERSION &gt;= 6010050)) using MemPointer = const uint32_t *; //   ,   static const auto stack_upper_address = (MemPointer) &amp;(Image$$REGION_STACK$$ZI$$Limit ); //      , ..      //  SP  stack_upper_address auto LR = __return_address(); auto PC = __current_pc(); auto SP = __current_sp(); auto i = 0; DEBUG_PRINTF("\nCopy the following function for simulator to .ini-file, \n" "start fresh debug session in simulator and call __load_minidump() from command window.\n" "You should be able to see the call stack in CallStack window\n\n"); DEBUG_PRINTF("func void __load_minidump() {\n "); for( MemPointer stack = (MemPointer)SP; stack &lt;= stack_upper_address; stack++ ) { DEBUG_PRINTF("_WDWORD (0x%p, 0x%08x); ", stack, *stack ); //         if( i == 1 ) { DEBUG_PRINTF("\n "); i=0; } else { i++; } } DEBUG_PRINTF("\n LR = 0x%08x;", LR ); DEBUG_PRINTF("\n PC = 0x%08x;", PC ); DEBUG_PRINTF("\n SP = 0x%08x;", SP ); DEBUG_PRINTF("\n}\n"); #endif }</span></span></span></span></code> </pre></div></div><br><p style=";text-align:right;direction:rtl">  ูุชุญููู <code>__load_minidump</code> ุ ูุญุชุงุฌ ุฅูู ุฅูุดุงุก ููู .ini ุ ููุณุฎ ูุธููุฉ <code>__load_minidump</code> ููู ุ ูุฅุถุงูุฉ ูุฐุง ุงูููู ุฅูู ุงูุชุดุบูู ุงูุชููุงุฆู - <code>Project -&gt; Options for Target -&gt; Debug</code> ููุชุงุจุฉ ููู .ini ูุฐุง ูู ูุณู "ููู ุงูุชููุฆุฉ" ูู ูุณู ุงุณุชุฎุฏุงู ุงููุญุงูุงุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฐูุจ ููุท ุฅูู ุชุตุญูุญ ุงูุฃุฎุทุงุก ุนูู ุฌูุงุฒ ูุญุงูุงุฉ ุ ูุจุฏูู ุจุฏุก ุชุตุญูุญ ุงูุฃุฎุทุงุก ุ ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ <code>__load_minidump()</code> ูู ุฅุทุงุฑ ุงูุฃูุงูุฑ. <br>  ู voila ุ ููุชูู ุฅูู ูุธููุฉ <code>print_minidump</code> ุนูู ุงูุฎุท ุญูุซ ุชู ุญูุธ ุฌูุงุฒ ุงูููุจููุชุฑ.  ููู ูุงูุฐุฉ Callstack + Localals ุ ููููู ุฑุคูุฉ ููุฏุณ ุงูุงุชุตุงู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุงุญุธุฉ:</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุชุชู ุชุณููุฉ ุงููุธููุฉ ุนูู ูุฌู ุงูุชุญุฏูุฏ ุจุฑูุฒูู ุณููููู ูู ุงูุจุฏุงูุฉ ุ ูุฃูู ุฅุฐุง ุชุฒุงูู ุงุณู ุงููุธููุฉ ุฃู ุงููุชุบูุฑ ูู ุงูุจุฑูุงูุฌ ุงููุตู ูููุญุงูุงุฉ ูุน ุงูุงุณู ูู ุฑูุฒ ุงููุดุฑูุน ุ ููู ูุชููู Cale ูู ุงูุงุชุตุงู ุจู.  ูุญุธุฑ ูุนูุงุฑ C ++ ุงุณุชุฎุฏุงู ุงูุฃุณูุงุก ุฐุงุช ุงูุดุฑุทูู ุงูุณูููุฉ ูู ุงูุจุฏุงูุฉ ุ ูุจุงูุชุงูู ุชูู ุงุญุชูุงููุฉ ูุทุงุจูุฉ ุงูุฃุณูุงุก. </p></div></div><br><p style=";text-align:right;direction:rtl">  ูู ุญูุซ ุงููุจุฏุฃ ุ ูุฐุง ูู ุดูุก.  ุจูุฏุฑ ูุง ุชูููุช ูู ุงูุชุญูู ุ ูุนูู ุชูุฑูุบ ูุตุบุฑ ููู ูู ุงููุธุงุฆู ุงูุนุงุฏูุฉ ููุนุงูุฌุงุช ุงูููุงุทุนุฉ.  ูุง ุฅุฐุง ูุงู ุณูุนูู ูุน ุฌููุน ุฃููุงุน ุงูุงูุญุฑุงูุงุช ุจุงุณุชุฎุฏุงู <code>setjmp/longjmp</code> ุฃู <code>setjmp/longjmp</code> - ูุง ุฃุนุฑู ุ ูุฃููู ูุง ุฃูุงุฑุณ ุงูุงูุญุฑุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุณุนูุฏ ุจูุง ุญุฏุซ ุ  ุฑูุฒ ุตุบูุฑ ุ ุงููููุงุช ุงูุนุงูุฉ - ูุงูุฑู ููููุง ุชูุฑู ููุชุฃููุฏ.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุทุช ุฌููุน ุงูุฃุนูุงู ุงููููุฉ ุญูู ุชุญููู ุงูููุฏุณ ุนูู ุฃูุชุงู IDE ุ ุญูุซ ุชูุชูู. </p><br><p style=";text-align:right;direction:rtl">  ุซู ุบูุบูุฏ ููููุงู ููุฌุฏุช ุดูุฆูุง ูุดุงุจููุง ูู gcc ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">gdb</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CrashCatcher</a> . </p><br><p style=";text-align:right;direction:rtl">  ุฃููู ุฃููู ูู ุฃุฎุชุฑุน ุฃู ุดูุก ุฌุฏูุฏ ุ ููู ูู ุฃุชููู ูู ุงูุนุซูุฑ ุนูู ูุตูุฉ ุฌุงูุฒุฉ ุชุคุฏู ุฅูู ูุชูุฌุฉ ููุงุซูุฉ.  ุณุฃููู ููุชูุง ูู ุฃุฎุจุฑููู ูุง ุงูุฐู ูููู ุนููู ุจุดูู ุฃูุถู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar452704/">https://habr.com/ru/post/ar452704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar452692/index.html">ูุงู ูุคูู ูุดุฑูุน rePalm ุจุฅุนุงุฏุฉ ูุชุงุจุฉ ูุธุงู ุงูุชุดุบูู Palm OS ูู ุงูุจุฏุงูุฉ ููุฎุทุท ูุชุญูููู ุฅูู ููุตุฉ ูุฑุงูุจุฉ ุฐููุฉ</a></li>
<li><a href="../ar452696/index.html">ููููุฉ ุจุฏุก ุงููุฏููุนุงุช ุงูุตุบูุฑุฉ ูู ุงูุชุทุจูู ุงูุฎุงุต ุจู</a></li>
<li><a href="../ar452698/index.html">ุงุซูุงู ูู ูุงุญุฏ: ุงูุจูุงูุงุช ุงูุณูุงุญูุฉ ูุชุฐุงูุฑ ุงูุฃุญุฏุงุซ ุงูุซูุงููุฉ ูุงูุช ูุชุงุญุฉ ููุฌูููุฑ</a></li>
<li><a href="../ar452700/index.html">ุฃุฎุจุงุฑ ูู ุฎุฑูุทุฉ ุงูุดุงุฑุน ุงูููุชูุญ ุฑูู 460 (05/07/2019 - 05/05/2019)</a></li>
<li><a href="../ar452702/index.html">ุงุฎุชุจุงุฑุงุช ููุฑูุฒ ูุฑูุฒ ููุงุฎุชุจุงุฑุงุช</a></li>
<li><a href="../ar452706/index.html">ูู ุนุงู 1983 ุ ุฃุตุจุญ ูุฐุง ุงูููุจููุชุฑ ูู Bella Labs ุฃูู ุบุฑุงูุฏ ูุงุณุชุฑ.</a></li>
<li><a href="../ar452712/index.html">ููู ุญุงูููุง ุงูุนูู ูู ูุฑูู ุ ููุงุฐุง ุฌุงุก ููู</a></li>
<li><a href="../ar452714/index.html">ุงูุชุจู # 5: ููุฎุต ุงูููุงูุงุช ุญูู ุงูุชูููุฑ ุงูููุชุฌ ุ ุนูู ุงูููุณ ุงูุณูููู ูุงูุฅูุชุงุฌูุฉ</a></li>
<li><a href="../ar452716/index.html">ูู ุงูุจุญุซ ุนู ููุทุฉ ุงูุฃูุซู ูุชุทุจูู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ</a></li>
<li><a href="../ar452718/index.html">PsyGuide: ููุต ุงูุงูุชุจุงู. # 0001/1001</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>