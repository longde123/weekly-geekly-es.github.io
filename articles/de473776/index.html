<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòû ‚úÇÔ∏è üè© Vereinheitlichung der Validierungsregeln am Beispiel von Asp Core + VueJS üë¥üèª üßó ‚úãüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel beschreibt eine einfache M√∂glichkeit, die Regeln f√ºr die √úberpr√ºfung von Benutzereingaben f√ºr eine Client-Server-Anwendung zu vereinhei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vereinheitlichung der Validierungsregeln am Beispiel von Asp Core + VueJS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473776/"><p><img src="https://habrastorage.org/webt/aq/-m/hx/aq-mhx5bf0a0_ablfc-ers0kvki.png"><br>  <em>Dieser Artikel beschreibt eine einfache M√∂glichkeit, die Regeln f√ºr die √úberpr√ºfung von Benutzereingaben f√ºr eine Client-Server-Anwendung zu vereinheitlichen.</em>  <em>Am Beispiel eines einfachen Projekts werde ich zeigen, wie dies mit Asp net core und Vue js m√∂glich ist.</em> </p><br><p>  Bei der Entwicklung von Webanwendungen stehen wir in der Regel vor der doppelten Validierung von Benutzereingaben.  Einerseits m√ºssen Benutzereingaben auf dem Client validiert werden, um redundante Anforderungen an den Server zu reduzieren und die Validierung selbst f√ºr den Benutzer zu beschleunigen.  Wenn man von Validierung spricht, kann der Server nicht akzeptieren, dass die Client-Validierung tats√§chlich funktioniert hat, bevor die Anforderung gesendet wurde, weil  Der Benutzer kann den Validierungscode deaktivieren oder √§ndern.  Oder stellen Sie sogar manuell eine Anfrage √ºber die Client-API. </p><a name="habracut"></a><br><p>  Daher hat die klassische Client-Server-Interaktion zwei Knoten mit h√§ufig identischen Validierungsregeln f√ºr Benutzereingaben.  Dieser Artikel als Ganzes wurde in mehr als einem Artikel behandelt. Eine einfache L√∂sung wird hier am Beispiel des ASP.Net Core API-Servers und des Vue js-Clients beschrieben. </p><br><p> Zun√§chst werden wir festlegen, dass wir ausschlie√ülich die Anforderungen des Benutzers (Teams) und nicht der Entit√§t validieren. Aus Sicht der klassischen 3-Layer-Architektur erfolgt unsere Validierung in der Pr√§sentationsschicht. </p><br><h1 id="servernaya-chast">  Serverseite </h1><br><p>  In Visual Studio 2019 werde ich mithilfe der ASP.NET Core-Webanwendungsvorlage ein Projekt f√ºr eine Serveranwendung mit einem API-Typ erstellen.  ASP out of the box verf√ºgt √ºber einen recht guten und erweiterbaren Validierungsmechanismus - die Modellvalidierung, nach der die Anforderungseigenschaften des Modells mit bestimmten Validierungsattributen gekennzeichnet sind. </p><br><p>  Betrachten Sie dies anhand eines einfachen Controllers als Beispiel: </p><br><pre><code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Route(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"[controller]"</span></span></span><span class="hljs-meta">)</span></span>] [ApiController] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">AccountController</span></span> : <span class="hljs-title"><span class="hljs-title">ControllerBase</span></span> { [HttpPost(<span class="hljs-keyword"><span class="hljs-keyword">nameof</span></span>(Registration))] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Registration</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[FromBody]RegistrationRequest request</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Ok(<span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{request.Name}</span></span></span><span class="hljs-string">,  !"</span></span>); } }</code> </pre> <br><p>  Die Anfrage zur Registrierung eines neuen Benutzers sieht folgenderma√üen aus: </p><br><div class="spoiler">  <b class="spoiler_title">Registrierungsanfrage</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RegistrationRequest</span></span> { [StringLength(maximumLength: <span class="hljs-number"><span class="hljs-number">50</span></span>, MinimumLength = <span class="hljs-number"><span class="hljs-number">2</span></span>, ErrorMessage = <span class="hljs-string"><span class="hljs-string">"     2  50 "</span></span>)] [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">" "</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Name { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">"  . "</span></span>)] [EmailAddress(ErrorMessage = <span class="hljs-string"><span class="hljs-string">"  . "</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Email { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">" "</span></span>)] [MaxLength(<span class="hljs-number"><span class="hljs-number">100</span></span>, ErrorMessage = <span class="hljs-string"><span class="hljs-string">"{0}    {1} "</span></span>)] [MinLength(<span class="hljs-number"><span class="hljs-number">6</span></span>, ErrorMessage =<span class="hljs-string"><span class="hljs-string">"{0}    {1} "</span></span>)] [DisplayName(<span class="hljs-string"><span class="hljs-string">""</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Password { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Required(ErrorMessage = <span class="hljs-string"><span class="hljs-string">" "</span></span>)] [Range(<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">150</span></span>, ErrorMessage = <span class="hljs-string"><span class="hljs-string">"      18  150"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Age { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [DisplayName(<span class="hljs-string"><span class="hljs-string">""</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> Culture { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre> </div></div><br><p>  Es verwendet vordefinierte Validierungsattribute aus dem System.ComponentModel.DataAnnotations-Namespace.  Erforderliche Eigenschaften sind mit dem Attribut Erforderlich gekennzeichnet.  Wenn Sie also leeren JSON ("{}") senden, gibt unsere API Folgendes zur√ºck: </p><br><pre> <code class="json hljs">{ ... <span class="hljs-attr"><span class="hljs-attr">"errors"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"Age"</span></span>: [ <span class="hljs-string"><span class="hljs-string">" "</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: [ <span class="hljs-string"><span class="hljs-string">" "</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"Email"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"  . "</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"Password"</span></span>: [ <span class="hljs-string"><span class="hljs-string">" "</span></span> ] } }</code> </pre> <br><p>  Das erste Problem, das in dieser Phase auftreten kann, ist die Lokalisierung von Fehlerbeschreibungen.  √úbrigens, ASP verf√ºgt √ºber integrierte Lokalisierungstools, die wir sp√§ter betrachten werden. </p><br><p>  Um die L√§nge der Zeichenfolgendaten zu √ºberpr√ºfen, k√∂nnen Sie die Attribute mit sprechenden Namen verwenden: StringLength, MaxLength und MinLength.  Gleichzeitig k√∂nnen durch Formatieren von Zeichenfolgen (geschweifte Klammern) Attributparameter in eine Nachricht integriert werden.  Beispielsweise f√ºgen wir f√ºr den Benutzernamen die minimale und maximale L√§nge in die Nachricht ein und f√ºr das Kennwort "Anzeigename", das im gleichnamigen Attribut angegeben ist.  Das Range-Attribut ist f√ºr die √úberpr√ºfung des Werts verantwortlich, der im angegebenen Bereich liegen soll. <br>  Senden wir eine Anfrage mit einem unannehmbar kurzen Benutzernamen und Passwort: </p><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"a"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Password"</span></span> : <span class="hljs-string"><span class="hljs-string">"123"</span></span> }</code> </pre> <br><p>  In der Antwort vom Server finden Sie neue Validierungsfehlermeldungen: </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"Name"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"     2  50 "</span></span> ], <span class="hljs-string"><span class="hljs-string">"Password"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"    6 "</span></span> ]</code> </pre> <br><p>  Das Problem, das vorerst m√∂glicherweise nicht offensichtlich ist, besteht darin, dass die Grenzwerte f√ºr die L√§nge des Namens und des Kennworts auch in der Clientanwendung vorhanden sein m√ºssen.  Eine Situation, in der dieselben Daten manuell an zwei oder mehr Stellen festgelegt werden, ist ein potenzieller N√§hrboden f√ºr Fehler, eines der Anzeichen f√ºr ein schlechtes Design.  Lass es uns reparieren. </p><br><p>  Wir speichern alles, was der Client ben√∂tigt, in Ressourcendateien.  Nachrichten in Controllers.AccountController.ru.resx und kulturell unabh√§ngige Daten in einer gemeinsam genutzten Ressource: Controllers.AccountController.resx.  Ich halte mich an dieses Format: </p><br><pre> <code class="json hljs">{PropertyName}DisplayName {PropertyName}{RuleName} {PropertyName}{RuleName}Message</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Somit erhalten wir das folgende Bild</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/al/cr/zg/alcrzgje8f1btwzkgwzfrz6mgyq.png"></p></div></div><br><p>  Bitte beachten Sie dies, um die E-Mail-Adresse zu best√§tigen  mail wird als regul√§rer Ausdruck verwendet.  F√ºr die Kulturvalidierung wird eine benutzerdefinierte Regel verwendet - "Werte" (Werteliste).  Sie m√ºssen auch das Kennwortbest√§tigungsfeld √ºberpr√ºfen, das wir sp√§ter auf der Benutzeroberfl√§che sehen werden. </p><br><p>  Um auf Ressourcendateien f√ºr eine bestimmte Kultur zuzugreifen, f√ºgen wir der Startup.ConfigureServices-Methode Lokalisierungsunterst√ºtzung hinzu und geben den Pfad zu den Ressourcendateien an: </p><br><pre> <code class="cs hljs">services.AddLocalization(options =&gt; options.ResourcesPath = <span class="hljs-string"><span class="hljs-string">"Resources"</span></span>);</code> </pre> <br><p>  Und auch in der Startup.Configure-Methode, die die Kultur anhand des Headers der Benutzeranforderung bestimmt: </p><br><pre> <code class="cs hljs"> app.UseRequestLocalization(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RequestLocalizationOptions { DefaultRequestCulture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RequestCulture(<span class="hljs-string"><span class="hljs-string">"ru-RU"</span></span>), SupportedCultures = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CultureInfo(<span class="hljs-string"><span class="hljs-string">"en-US"</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CultureInfo(<span class="hljs-string"><span class="hljs-string">"ru-RU"</span></span>) }, RequestCultureProviders = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;IRequestCultureProvider&gt; { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AcceptLanguageHeaderRequestCultureProvider() } });</code> </pre> <br><p>  Damit wir innerhalb des Controllers Zugriff auf die Lokalisierung haben, implementieren wir eine Abh√§ngigkeit vom Typ IStringLocalizer im Konstruktor und √§ndern den R√ºckgabeausdruck der Registrierungsaktion: <br></p><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Ok(<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(_localizer[<span class="hljs-string"><span class="hljs-string">"RegisteredMessage"</span></span>], request.Name));</code> </pre> <br><p>  Die ResxValidatior-Klasse ist f√ºr die √úberpr√ºfung der Regeln verantwortlich, die die erstellten Ressourcen verwenden.  Es enth√§lt eine reservierte Liste von Schl√ºsselw√∂rtern, voreingestellten Rollen und eine Methode zu deren √úberpr√ºfung. </p><br><div class="spoiler">  <b class="spoiler_title">ResxValidatior</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ResxValidator</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ValuesSeparator = <span class="hljs-string"><span class="hljs-string">','</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> RangeSeparator = <span class="hljs-string"><span class="hljs-string">'-'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Keywords { DisplayName, Message, Required, Pattern, Length, MinLength, MaxLength, Range, MinValue, MaxValue, Values, Compare } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> Dictionary&lt;Keywords, Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;&gt; _rules = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;Keywords, Func&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt;&gt;() { [Keywords.Required] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(v), [Keywords.Pattern] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; Regex.IsMatch(v, arg), [Keywords.Range] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vLong) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg.Split(RangeSeparator)[<span class="hljs-number"><span class="hljs-number">0</span></span>].Trim(), <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vMin) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg.Split(RangeSeparator)[<span class="hljs-number"><span class="hljs-number">1</span></span>].Trim(), <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vMax) &amp;&amp; vLong &gt;= vMin &amp;&amp; vLong &lt;= vMax, [Keywords.Length] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg.Split(RangeSeparator)[<span class="hljs-number"><span class="hljs-number">0</span></span>].Trim(), <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vMin) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg.Split(RangeSeparator)[<span class="hljs-number"><span class="hljs-number">1</span></span>].Trim(), <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vMax) &amp;&amp; v.Length &gt;= vMin &amp;&amp; v.Length &lt;= vMax, [Keywords.MinLength] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; v.Length &gt;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(arg), [Keywords.MaxLength] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; v.Length &lt;= <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(arg), [Keywords.Values] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(v) &amp;&amp; arg.Split(ValuesSeparator).Select(x =&gt; x.Trim()).Contains(v), [Keywords.MinValue] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(v) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vLong) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> argLong) &amp;&amp; vLong &gt;= argLong, [Keywords.MaxValue] = (v, arg) =&gt; !<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(v) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(v, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vLong) &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>.TryParse(arg, <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> argLong) &amp;&amp; vLong &lt;= argLong }; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IStringLocalizer _localizer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ResxValidator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IStringLocalizer localizer</span></span></span><span class="hljs-function">)</span></span> { _localizer = localizer; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsValid</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> memberName, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">out</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> message</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rules = _rules.Select(x =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> { Name = x.Key, Check = x.Value, String = _localizer.GetString(memberName + x.Key) }).Where(x =&gt; x.String != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !x.String.ResourceNotFound); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rule <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rules) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!rule.Check(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>, rule.String?.Value)) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> messageResourceKey = <span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{memberName}</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{rule.Name}</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Keywords.Message}</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> messageResource = _localizer[messageResourceKey]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> displayNameResourceKey = <span class="hljs-string"><span class="hljs-string">$"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{memberName}</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{Keywords.DisplayName}</span></span></span><span class="hljs-string">"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> displayNameResource = _localizer[displayNameResourceKey] ?? displayNameResourceKey; message = messageResource != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; !messageResource.ResourceNotFound ? <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(messageResource.Value, displayNameResource, rule.String?.Value) : messageResourceKey; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } message = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre> </div></div><br><p>  Erstellen Sie ein benutzerdefiniertes Validierungsattribut, das unser Validator aufruft.  Hier besteht die Standardlogik darin, den Wert der verifizierten Eigenschaft des Modells, seinen Namen und den Validator aufzurufen. </p><br><div class="spoiler">  <b class="spoiler_title">ResxAttribute</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">public sealed class ResxAttribute : ValidationAttribute { private readonly string _baseName; private string _resourceName; public ResxAttribute(string sectionName, string resourceName = null) { _baseName = sectionName; _resourceName = resourceName; } protected override ValidationResult IsValid(object value, ValidationContext validationContext) { if (_resourceName == null) _resourceName = validationContext.MemberName; var factory = validationContext .GetService(typeof(IStringLocalizerFactory)) as IStringLocalizerFactory; var localizer = factory?.Create(_baseName, System.Reflection.Assembly.GetExecutingAssembly().GetName().Name); ErrorMessage = ErrorMessageString; var currentValue = value as string; var validator = new ResxValidator(localizer); return validator.IsValid(_resourceName, currentValue, out var message) ? ValidationResult.Success : new ValidationResult(message); } }</code> </pre> </div></div><br><p>  Schlie√ülich k√∂nnen Sie alle Attribute in der Anforderung durch unser universelles ersetzen und den Namen der Ressource angeben: </p><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Resx(sectionName: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Controllers.AccountController"</span></span></span><span class="hljs-meta">)</span></span>]</code> </pre> <br><p>  Wir testen die Funktionalit√§t, indem wir dieselbe Anfrage senden: </p><br><pre> <code class="json hljs"> { <span class="hljs-attr"><span class="hljs-attr">"Name"</span></span>: <span class="hljs-string"><span class="hljs-string">"a"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"Password"</span></span> : <span class="hljs-string"><span class="hljs-string">"123"</span></span> }</code> </pre> <br><p>  F√ºgen Sie zur Lokalisierung Controllers.AccountController.en.resx mit Nachrichten in Englisch sowie einer Kopfzeile mit Informationen zur Kultur hinzu: Accept-Language: en-US. </p><br><p>  Bitte beachten Sie, dass wir jetzt die Einstellungen f√ºr eine bestimmte Kultur √ºberschreiben k√∂nnen.  In der Datei * .en.resx habe ich die Mindestkennwortl√§nge von 8 angegeben und eine entsprechende Nachricht erhalten: </p><br><pre> <code class="json hljs"> <span class="hljs-string"><span class="hljs-string">"Password"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Password must be at least 8 characters"</span></span> ]</code> </pre> <br><p>  Um w√§hrend der Client-Validierung identische Nachrichten anzuzeigen, m√ºssen Sie die gesamte Liste der Nachrichten f√ºr den Client-Teil exportieren.  Der Einfachheit halber erstellen wir einen separaten Controller, der alles bietet, was Sie f√ºr eine Clientanwendung im i18n-Format ben√∂tigen. </p><br><div class="spoiler">  <b class="spoiler_title">Lokaler Controller</b> <div class="spoiler_text"><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Route(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"[controller]"</span></span></span><span class="hljs-meta">)</span></span>] [ApiController] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">LocaleController</span></span> : <span class="hljs-title"><span class="hljs-title">ControllerBase</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> IStringLocalizerFactory _factory; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _assumbly; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> _location; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LocaleController</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IStringLocalizerFactory factory</span></span></span><span class="hljs-function">)</span></span> { _factory = factory; _assumbly = System.Reflection.Assembly.GetExecutingAssembly().GetName().Name; _location = Path.Combine(Directory.GetCurrentDirectory(), <span class="hljs-string"><span class="hljs-string">"Resources"</span></span>); } [HttpGet(<span class="hljs-string"><span class="hljs-string">"Config"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IActionResult </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetConfig</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> culture</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(culture)) { CultureInfo.CurrentCulture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CultureInfo(culture); CultureInfo.CurrentUICulture = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CultureInfo(culture); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> resources = Directory.GetFiles(_location, <span class="hljs-string"><span class="hljs-string">"*.resx"</span></span>, SearchOption.AllDirectories) .Select(x =&gt; x.Replace(_location + Path.DirectorySeparatorChar, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty)) .Select(x =&gt; x.Substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, x.IndexOf(<span class="hljs-string"><span class="hljs-string">'.'</span></span>))) .Distinct(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> resource <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> resources.Select(x =&gt; x.Replace(<span class="hljs-string"><span class="hljs-string">'\\'</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>))) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> section = _factory.Create(resource, _assumbly) .GetAllStrings() .OrderBy(x =&gt; x.Name) .ToDictionary(x =&gt; x.Name, x =&gt; x.Value); config.Add(resource.Replace(<span class="hljs-string"><span class="hljs-string">'.'</span></span>, <span class="hljs-string"><span class="hljs-string">'-'</span></span>), section); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = JsonConvert.SerializeObject(config, Formatting.Indented); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Ok(result); } }</code> </pre> </div></div><br><p>  Abh√§ngig von der Accept-Language wird Folgendes zur√ºckgegeben: </p><br><div class="spoiler">  <b class="spoiler_title">Accept-Language: en-US</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"Controllers-AccountController"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"AgeDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Age"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"AgeRange"</span></span>: <span class="hljs-string"><span class="hljs-string">"18 - 150"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"AgeRangeMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0} must be {1}"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Email"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailPattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"^[-\\w.]+@([A-z0-9][-A-z0-9]+\\.)+[Az]{2,4}$"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailPatternMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Incorrect email"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailRequired"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailRequiredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Email required"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Language"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageValues"</span></span>: <span class="hljs-string"><span class="hljs-string">"ru-RU, en-US"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageValuesMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Incorrect language. Possible: {1}"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"2 - 50"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Name length must be {1} characters"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmCompare"</span></span>: <span class="hljs-string"><span class="hljs-string">"Password"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmCompareMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Passwords must be the same"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Password confirmation"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">"Password"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMaxLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMaxLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0} can't be greater than {1} characters"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMinLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"8"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMinLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0} must be at least {1} characters"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordRequired"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordRequiredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"Password required"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"RegisteredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0}, you've been registered!"</span></span> } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Accept-Language: en-RU</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"Controllers-AccountController"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"AgeDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"AgeRange"</span></span>: <span class="hljs-string"><span class="hljs-string">"18 - 150"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"AgeRangeMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0}     {1}"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">" . "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailPattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"^[-\\w.]+@([A-z0-9][-A-z0-9]+\\.)+[Az]{2,4}$"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailPatternMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"  . "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailRequired"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"EmailRequiredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"  . "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageValues"</span></span>: <span class="hljs-string"><span class="hljs-string">"ru-RU, en-US"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"LanguageValuesMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">" .  : {1}"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"2 - 50"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"NameLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"    {1} "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmCompare"</span></span>: <span class="hljs-string"><span class="hljs-string">"Password"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmCompareMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordConfirmDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordDisplayName"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMaxLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMaxLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0}    {1} "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMinLength"</span></span>: <span class="hljs-string"><span class="hljs-string">"6"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordMinLengthMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0}    {1} "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordRequired"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"PasswordRequiredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"RegisteredMessage"</span></span>: <span class="hljs-string"><span class="hljs-string">"{0},  !"</span></span> } }</code> </pre> </div></div><br><p>  Als letztes m√ºssen noch Ursprungs√ºbergreifende Anforderungen f√ºr den Client zugelassen werden.  F√ºgen Sie dazu in Startup.ConfigureServices Folgendes hinzu: </p><br><pre> <code class="cs hljs"> services.AddCors();</code> </pre> <br><p>  und in Startup.Configure hinzuf√ºgen: </p><br><pre> <code class="cs hljs"> app.UseCors(x =&gt; x .AllowAnyOrigin() .AllowAnyMethod() .AllowAnyHeader());</code> </pre> <br><h1 id="klientskaya-chast">  Client-Teil </h1><br><p>  Ich bevorzuge es, alle Teile der Anwendung in einer IDE zu sehen, daher erstelle ich ein Clientanwendungsprojekt mithilfe der Visual Studio-Vorlage: Basic Vue.js Web Application.  Wenn Sie es nicht haben / VS mit solchen Vorlagen nicht verstopfen m√∂chten, verwenden Sie vue cli. Damit werde ich zuvor eine Reihe von Paketen installieren: vuetify, axios, vue-i18n. </p><br><p>  Wir fordern die konvertierten Ressourcendateien vom LocaleController an, wobei die Kultur im Header Accept-Language angegeben wird, und platzieren die Antwort in den Dateien en.json und ru.json im Verzeichnis locales. </p><br><p>  Als n√§chstes ben√∂tigen wir einen Dienst, um die Antwort mit Fehlern vom Server zu analysieren. </p><br><div class="spoiler">  <b class="spoiler_title">errorHandler.service.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ErrorHandlerService = { parseResponseError (error) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error.toString().includes(<span class="hljs-string"><span class="hljs-string">'Network Error'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'ServerUnavailable'</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error.response) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> statusText = error.response.statusText; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error.response.data &amp;&amp; error.response.data.errors) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> message = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> property <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> error.response.data.errors) { error.response.data.errors[property].forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">entry</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (entry) { message += entry + <span class="hljs-string"><span class="hljs-string">'\n'</span></span> } }) } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> message } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (error.response.data &amp;&amp; error.response.data.message) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> error.response.data.message } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusText) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> statusText } } } }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { ErrorHandlerService }</code> </pre> </div></div><br><p>  F√ºr den in Vutify.js integrierten Vee-Validate-Validator m√ºssen Sie ein Array von Validierungsfunktionen mit dem Attribut rules angeben. Wir fordern sie vom Service f√ºr die Arbeit mit Ressourcen an. </p><br><div class="spoiler">  <b class="spoiler_title">locale.service.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> i18n <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../i18n'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> LocaleService = { getRules(resource, options) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rules = []; options = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.prepareOptions(options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addRequireRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addPatternRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addRangeRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addLengthRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addMaxLengthRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addMinLengthRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addValuesRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.addCompareRule(rules, resource, options); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rules; }, prepareOptions(options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> getter = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> v; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> compared = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!options){ options = { <span class="hljs-attr"><span class="hljs-attr">getter</span></span>: getter, <span class="hljs-attr"><span class="hljs-attr">compared</span></span>: compared }; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!options.getter) options.getter = getter; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!options.compared) options.compared = compared; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> options; }, addRequireRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Required'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); } }, addPatternRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Pattern'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">RegExp</span></span>(settings.value).test(options.getter(v)) || settings.message); } }, addRangeRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Range'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> values = settings.value.split(<span class="hljs-string"><span class="hljs-string">'-'</span></span>); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(options.getter(v)) &gt;= values[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(options.getter(v)) &lt;= values[<span class="hljs-number"><span class="hljs-number">1</span></span>] || settings.message); } }, addLengthRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Length'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> values = settings.value.split(<span class="hljs-string"><span class="hljs-string">'-'</span></span>); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> options.getter(v).length &gt;= values[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; options.getter(v).length &lt;= values[<span class="hljs-number"><span class="hljs-number">1</span></span>] || settings.message); } }, addMaxLengthRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'MaxLength'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> options.getter(v).length &lt;= settings.value || settings.message); } }, addMinLengthRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'MinLength'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings){ rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> options.getter(v).length &gt;= settings.value || settings.message); } }, addValuesRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Values'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> values = settings.value.split(<span class="hljs-string"><span class="hljs-string">','</span></span>); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!options.getter(v) || settings.message); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> !!values.find(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.trim() === options.getter(v)) || settings.message); } }, addCompareRule(rules, resource, options){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> settings = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleSettings(resource, <span class="hljs-string"><span class="hljs-string">'Compare'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(settings) { rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> settings.value === <span class="hljs-string"><span class="hljs-string">''</span></span> || !!settings.value || settings.message }); rules.push(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> options.getter(v) === options.compared() || settings.message; }); } }, getRuleSettings(resource, rule){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> value = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleValue(resource, rule); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> message = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getRuleMessage(resource, rule, value); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value === <span class="hljs-string"><span class="hljs-string">''</span></span> || value ? { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: value, <span class="hljs-attr"><span class="hljs-attr">message</span></span>: message } : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }, getRuleValue(resource, rule){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> key =<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${resource}</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${rule}</span></span></span><span class="hljs-string">`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getI18nValue(key); }, getDisplayName(resource){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> key =<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${resource}</span></span></span><span class="hljs-string">DisplayName`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getI18nValue(key); }, getRuleMessage(resource, rule, value){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> key =<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${resource}</span></span></span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${rule}</span></span></span><span class="hljs-string">Message`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i18n.t(key, [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getDisplayName(resource), value]); }, getI18nValue(key){ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> value = i18n.t(key); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value !== key ? value : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } }; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { LocaleService }</code> </pre> </div></div><br><p>  Es macht keinen Sinn, diesen Service vollst√§ndig als zu beschreiben  Die ResxValidator-Klasse wird teilweise dupliziert.  Ich stelle fest, dass zur √úberpr√ºfung der Vergleichsregel, bei der der Wert der aktuellen Eigenschaft mit einer anderen verglichen werden muss, das Optionsobjekt √ºbergeben wird, in dem der Delegat verglichen wird, wodurch der Wert zum Vergleich zur√ºckgegeben wird. </p><br><p>  Ein typisches Formularfeld sieht also folgenderma√üen aus: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-text-field</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"displayFor('Name')"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">:rules</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rulesFor('Name')"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">v-model</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"model.Name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prepend-icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"mdi-account"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">v-text-field</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  F√ºr das Label wird die Wrapper-Funktion in locale.service aufgerufen, die den vollst√§ndigen Namen der Ressource sowie den Namen der Eigenschaft √ºbergibt, f√ºr die Sie den Anzeigenamen erhalten m√∂chten.  √Ñhnliches gilt f√ºr Regeln.  Das V-Modell gibt ein Modell zum Speichern der eingegebenen Daten an. <br>  √úbergeben Sie f√ºr die Kennwortbest√§tigungseigenschaft die Werte des Kennworts selbst im Optionsobjekt: </p><br><pre> <code class="xml hljs">:rules="rulesFor('PasswordConfirm', { compared:() =&gt; model.Password })"</code> </pre> <br><p>  v-select f√ºr die Sprachauswahl verf√ºgt √ºber eine vordefinierte Liste von Elementen (dies dient der Vereinfachung des Beispiels) und onChange ist ein Handler.  Weil  Wenn wir SPA ausf√ºhren, m√∂chten wir die Lokalisierung √§ndern, wenn der Benutzer eine Sprache ausw√§hlt. Daher wird in der onChange-Auswahl die ausgew√§hlte Sprache √ºberpr√ºft, und wenn sie sich ge√§ndert hat, √§ndert sich das Gebietsschema der Benutzeroberfl√§che: </p><br><pre> <code class="javascript hljs"> onCultureChange (value) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> culture = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cultures.find(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.value === value); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.model.Culture = culture.value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (culture.locale !== <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$i18n.locale) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$i18n.locale = culture.locale; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$refs.form.resetValidation(); } }</code> </pre> <br><p>  Das ist alles, das Repository mit einer funktionierenden Anwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ist hier</a> . </p><br><p>  <strong>Zusammenfassend m√∂chte ich darauf hinweisen,</strong> dass es gro√üartig w√§re, die Ressourcen selbst in einem einzigen JSON-Format zu speichern, das wir vom LocaleController anfordern, um sie von den Besonderheiten des ASP-Frameworks zu l√∂sen.  In ResxValidatior k√∂nnte man Unterst√ºtzung f√ºr Erweiterbarkeit und benutzerdefinierte Regeln hinzuf√ºgen sowie Code hervorheben, der mit locale.service identisch ist, und ihn im JS-Stil neu schreiben, um die Unterst√ºtzung zu vereinfachen.  In diesem Beispiel konzentriere ich mich jedoch auf die Einfachheit. </p><p></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473776/">https://habr.com/ru/post/de473776/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473764/index.html">Paket ist mein Lieblingsprojektbauer</a></li>
<li><a href="../de473766/index.html">Statische Analyse gro√üer Mengen von Python-Code: Instagram-Erfahrung. Teil 1</a></li>
<li><a href="../de473768/index.html">Top 5 B√ºcher f√ºr diejenigen, die ihre F√§higkeiten verbessern wollen</a></li>
<li><a href="../de473770/index.html">Statische Analyse gro√üer Mengen von Python-Code: Instagram-Erfahrung. Teil 2</a></li>
<li><a href="../de473774/index.html">Sichere Cloud in DF Cloud</a></li>
<li><a href="../de473778/index.html">Bildoptimierung: Verwendung der Vision AI von Google zum Verst√§ndnis der Bildranking-Prinzipien</a></li>
<li><a href="../de473780/index.html">Schnelle Konturerkennung in 4K-Video: Farbe und komplexe Formen</a></li>
<li><a href="../de473784/index.html">Wie schreibe ich einen intelligenten Vertrag f√ºr WebAssembly in einem Ontology-Netzwerk? Teil 2: C ++</a></li>
<li><a href="../de473786/index.html">Die Registrierung f√ºr den Hackathon in Riga endet. Preis - Kurzzeittraining bei PhysTech</a></li>
<li><a href="../de473788/index.html">Mikroproteine ‚Äã‚Äãentdecken unbekannte Aspekte der modernen Biologie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>