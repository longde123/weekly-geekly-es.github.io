<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚Äçüßëüèº üå©Ô∏è üë®‚Äçüé® Donc tout de m√™me RAML ou OAS (Swagger)? üÉè üßú üßóüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans le monde dynamique des microservices, tout peut changer - n'importe quel composant peut √™tre r√©√©crit dans un autre langage en utilisant des cadre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Donc tout de m√™me RAML ou OAS (Swagger)?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/466691/">  Dans le monde dynamique des microservices, tout peut changer - n'importe quel composant peut √™tre r√©√©crit dans un autre langage en utilisant des cadres et une architecture diff√©rents.  Seuls les contrats doivent rester inchang√©s, afin qu'il soit possible d'interagir avec le microservice de l'ext√©rieur de fa√ßon permanente, ind√©pendamment des m√©tamorphoses internes.  Et aujourd'hui, nous parlerons de notre probl√®me de choix d'un format pour d√©crire les contrats et partager les artefacts trouv√©s. <br><br><img src="https://habrastorage.org/webt/x2/vf/ry/x2vfryzr_9r4fmxsm1ggh7xsskg.jpeg"><br><a name="habracut"></a><br>  Le message a √©t√© pr√©par√© par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Anna Melekhova</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vladimir Lapatin</a> <br><br>  <b>Microservices.</b>  Lors du d√©veloppement d'Acronis Cyber ‚Äã‚ÄãCloud, nous avons r√©alis√© que nous ne pouvions pas nous √©loigner d'eux.  Et la conception de microservices est impossible sans formaliser un contrat, qui est une interface de microservices. <br><br>  Mais lorsqu'un produit contient plus d'un composant et que l'√©laboration d'un contrat devient une activit√© r√©guli√®re, vous commencez involontairement √† penser √† optimiser le processus.  Il devient √©vident que l'interface (contrat) et l'impl√©mentation (microservice) doivent correspondre, que les diff√©rents composants doivent faire les m√™mes choses de la m√™me mani√®re, et que sans une adoption centralis√©e de toutes ces d√©cisions, chaque √©quipe sera oblig√©e de passer du temps √† les obtenir encore et encore . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/58e/abe/9a0/58eabe9a07a07742389fbc3de927d6a5.jpg" alt="image"><br>  <i>Disposition des microservices Amazon du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tweet</a> de Werner Vogelis, Amazon CTO</i> <br>  Quel est le dilemme?  De facto, les microservices interagissent de deux mani√®res: HTTP Rest et gRPC de Google.  Ne voulant pas s'impliquer dans la pile technologique de Google, nous avons choisi HTTP Rest.  Les annotations aux contrats HTTP REST sont le plus souvent d√©crites dans l'un des deux formats: RAML et OAS, anciennement Swagger. Par cons√©quent, chaque √©quipe de d√©veloppement est confront√©e √† la n√©cessit√© de choisir l'une des normes.  Mais, il s'est av√©r√© que faire ce choix peut √™tre tr√®s difficile. <br><br><h3>  Pourquoi des annotations? </h3><br>  Une annotation est n√©cessaire pour qu'un utilisateur externe puisse facilement comprendre ce qui peut √™tre fait avec votre service via son interface HTTP.  Autrement dit, l'annotation doit contenir au moins une liste des ressources disponibles, leurs m√©thodes HTTP, les corps de la demande, une √©num√©ration des param√®tres, une indication des en-t√™tes n√©cessaires et pris en charge, ainsi que des codes de retour et des formats de r√©ponse.  Un √©l√©ment extr√™mement important de l'annotation du contrat est leur description verbale (¬´que se passe-t-il si vous ajoutez ce param√®tre de requ√™te √† la demande?¬ª, ¬´Dans quel cas le code 400 retournera-t-il?¬ª) <br><br>  N√©anmoins, quand il s'agit de d√©velopper un grand nombre de microservices, je veux tirer un avantage suppl√©mentaire des annotations √©crites.  Par exemple, bas√© sur RAML / Swagger, vous pouvez g√©n√©rer du code client et serveur dans un grand nombre de langages de programmation.  Vous pouvez √©galement recevoir automatiquement la documentation du microservice et la t√©l√©charger sur votre portail d√©veloppeur :). <br><br><img src="https://habrastorage.org/webt/l2/b1/lt/l2b1ltgjao7oeoqqvvrpkv0hnhg.png"><br>  <i>Un exemple de description de contrat structur√©e</i> <br><br>  La pratique de tester les microservices sur la base des descriptions de contrat est moins courante.  Si vous avez √©crit une annotation et un composant, vous pouvez cr√©er un autotest qui v√©rifie l'ad√©quation du service avec diff√©rents types de donn√©es d'entr√©e.  Le service renvoie-t-il un code de r√©ponse qui n'est pas d√©crit dans l'annotation?  Sera-t-il capable de traiter correctement des donn√©es sciemment incorrectes? <br><br>  De plus, l'impl√©mentation de haute qualit√© non seulement des contrats eux-m√™mes, mais √©galement des outils de visualisation des annotations facilite le travail avec le microservice.  Autrement dit, si l'architecte a d√©crit qualitativement le contrat, sur sa base, les concepteurs et les d√©veloppeurs impl√©menteront le service dans d'autres produits sans frais suppl√©mentaires. <br><br>  Pour le fonctionnement d'outils suppl√©mentaires, RAML et OAS ont la possibilit√© d'ajouter des m√©tadonn√©es qui ne sont pas fournies par la norme ( <a href="">par exemple, cela se fait dans OAS</a> ). <br><br>  En g√©n√©ral, le champ de la cr√©ativit√© dans l'application des contrats de microservices est immense ... du moins th√©oriquement <br><br><h3>  Comparaison h√©risson avec serpent </h3><br>  Actuellement, le domaine de d√©veloppement prioritaire d'Acronis est le d√©veloppement de la plate-forme Cyber ‚Äã‚ÄãAcronis.  Acronis Cyber ‚Äã‚ÄãPlatform - ce sont de nouveaux points d'int√©gration de services tiers avec Acronis Cyber ‚Äã‚ÄãCloud et la partie agent.  Bien que nos API internes d√©crites dans RAML nous convenaient, la n√©cessit√© de publier √† nouveau l'API a soulev√© la question du choix: quelle norme d'annotation est pr√©f√©rable d'utiliser pour notre travail? <br><br>  Au d√©part, il semblait qu'il y avait deux solutions - il s'agissait des d√©veloppements les plus courants de RAML et Swagger (ou OAS).  Mais en fait, il s'est av√©r√© que les alternatives ne sont pas au moins 2, mais 3 ou plus. <br><br>  D'une part, il y a RAML - un langage puissant et efficace.  Il impl√©mente bien la hi√©rarchie et l'h√©ritage, donc ce format convient mieux aux grandes entreprises qui ont besoin de nombreuses descriptions - c'est-√†-dire, pas un seul produit, mais de nombreux microservices qui ont des parties communes de contrats - sch√©mas d'authentification, m√™mes types de donn√©es, corps d'erreur. <br><br>  Mais le d√©veloppeur RAML, Mulesoft, a rejoint le consortium Open API qui d√©veloppe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.google.com/url%3Fq%3D">Swagger</a> .  Par cons√©quent, RAML a suspendu son d√©veloppement.  Pour imaginer le format de l'√©v√©nement, imaginez que les responsables des principaux composants Linux soient all√©s travailler chez Microsoft.  Cette situation cr√©e les conditions pr√©alables √† l'utilisation de Swagger, qui se d√©veloppe dynamiquement et dans la derni√®re - troisi√®me version - rattrape pratiquement RAML en termes de flexibilit√© et de fonctionnalit√©. <br><br><h3>  Sinon pour un mais ... </h3><br>  Il s'est av√©r√© que tous les utilitaires open source n'ont pas √©t√© mis √† jour vers la version OAS 3.0.  Pour les microservices sur Go, le plus critique sera le manque d'adaptation du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">go-swagger</a> √† la derni√®re version de la norme.  Cependant, la diff√©rence entre Swagger 2 et Swagger 3 est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©norme</a> .  Par exemple, dans la troisi√®me version, les d√©veloppeurs: <br><br><ul><li>  description am√©lior√©e des sch√©mas d'authentification </li><li>  prise en charge <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">compl√®te</a> du sch√©ma JSON </li><li>  pomp√© la possibilit√© d'ajouter des exemples </li></ul><br>  La situation est dr√¥le: lors du choix d'une norme, vous devez consid√©rer RAML, Swagger 2 et Swagger 3 comme des alternatives distinctes.  Cependant, seul Swagger 2 prend en charge correctement la bo√Æte √† outils OpenSource.  RAML est tr√®s flexible ... et complexe, et Swagger 3 est mal pris en charge par la communaut√©, vous devez donc utiliser des outils propri√©taires ou des solutions commerciales, qui sont g√©n√©ralement tr√®s chers. <br><br>  Dans le m√™me temps, s'il existe de nombreuses fonctionnalit√©s int√©ressantes dans Swagger, telles que le portail pr√™t √† l'emploi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">editor.swagger.io</a> , sur lequel vous pouvez t√©l√©charger l'annotation et obtenir sa visualisation avec une description d√©taill√©e, des liens et des liens, il n'y a pas une telle possibilit√© pour une RAML plus fondamentale et moins conviviale.  Oui, vous pouvez rechercher quelque chose parmi les projets sur GitHub, y trouver un analogue et le d√©ployer vous-m√™me.  Cependant, dans tous les cas, quelqu'un devra prendre en charge le portail, ce qui n'est pas si pratique pour une utilisation de base ou des besoins de test.  De plus, le swagger est plus "sans principes", enfin, ou lib√©ral - il peut √™tre g√©n√©r√© √† partir de commentaires dans le code, ce qui, bien s√ªr, va √† l'encontre du principe de l'API en premier et n'est pris en charge par aucun des utilitaires RAML, <br><br>  √Ä un moment donn√©, nous avons commenc√© √† travailler avec RAML en tant que langage plus flexible et, par cons√©quent, nous avons d√ª faire beaucoup de nos propres mains.  Par exemple, l'un des projets utilise l'utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ramlfications</a> dans les tests unitaires, qui ne prend en charge que RAML 0.8.  J'ai donc d√ª ajouter des b√©quilles pour que l'utilitaire puisse ¬´manger¬ª RAML version 1.0. <br><br><h3>  Dois-je choisir? </h3><br>  Apr√®s avoir particip√© √† l'ajout d'un √©cosyst√®me de solutions pour RAML, nous sommes arriv√©s √† la conclusion que nous devons convertir RAML en Swagger 2 et d√©j√† y r√©aliser toutes les automatisations, v√©rifications, tests et optimisations ult√©rieures.  C'est un bon moyen de tirer parti √† la fois de la flexibilit√© de RAML et de la prise en charge des outils communautaires de Swagger. <br><br>  Pour r√©soudre ce probl√®me, il existe deux outils OpenSource qui devraient assurer la conversion des contrats: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">oas-raml-converter</a> est maintenant un utilitaire non pris en charge.  En travaillant avec elle, nous avons constat√© qu'elle a un certain nombre de probl√®mes avec des RAML complexes qui sont ¬´r√©parties¬ª sur un grand nombre de fichiers.  Ce programme est √©crit en JavaScript et effectue une travers√©e r√©cursive de l'arbre de syntaxe.  En raison de la frappe dynamique, il devient difficile de comprendre ce code, nous avons donc d√©cid√© de ne pas perdre de temps √† √©crire des correctifs pour un utilitaire mourant. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">webapi-parser</a> est un outil de la m√™me entreprise, qui pr√©tend √™tre pr√™t √† tout convertir, dans toutes les directions.  √Ä ce jour, la prise en charge de RAML 0.8, RAML 1.0 et Swagger 2.0 a √©t√© annonc√©e.  Cependant, au moment de notre √©tude, l'utilitaire √©tait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">EXTR√äMEMENT</a> brut et inutilisable.  Les d√©veloppeurs cr√©ent une sorte d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IR</a> , ce qui leur permettra d'ajouter rapidement de nouvelles normes √† l'avenir.  Mais pour l'instant, tout cela ne fonctionne tout simplement pas. </li></ol><br>  Et ce ne sont pas toutes les difficult√©s que nous avons rencontr√©es.  L'une des √©tapes de notre pipeline consiste √† v√©rifier que la RAML du r√©f√©rentiel est correcte par rapport √† la sp√©cification.  Nous avons essay√© plusieurs utilitaires.  √âtonnamment, ils ont tous maudit nos annotations √† diff√©rents endroits et avec de mauvais mots compl√®tement diff√©rents.  Et pas toujours le cas :). <br><br>  En fin de compte, nous nous sommes install√©s sur le projet d√©sormais obsol√®te, qui a √©galement un certain nombre de probl√®mes (parfois il tombe √† l'improviste, a des probl√®mes lors du travail avec des expressions r√©guli√®res).  Ainsi, nous n'avons pas trouv√© de moyen de r√©soudre les t√¢ches de validation et de conversion bas√©es sur des outils gratuits, et avons d√©cid√© d'utiliser un utilitaire commercial.  √Ä l'avenir, lorsque les outils OpenSource seront plus d√©velopp√©s, la r√©solution de ce probl√®me pourrait devenir plus facile.  Entre-temps, le temps et le travail n√©cessaires √† la ¬´finition¬ª nous ont sembl√© plus importants que le co√ªt d'un service commercial. <br><br><h3>  Conclusion </h3><br>  Apr√®s tout cela, nous avons voulu partager notre exp√©rience et noter qu'avant de choisir un outil pour d√©crire les contrats, vous devez d√©terminer clairement ce que vous en voulez et quel budget vous √™tes pr√™t √† investir.  Si vous oubliez OpenSource, il existe maintenant un grand nombre de services et de produits qui vous aideront √† v√©rifier, convertir, valider.  Mais ils sont chers et parfois tr√®s chers.  Pour une grande entreprise, ces co√ªts sont tol√©rables, mais pour une startup, cela peut devenir un gros fardeau. <br><br>  D√©finissez un ensemble d'outils que vous utiliserez ult√©rieurement.  Par exemple, si vous avez juste besoin d'afficher le contrat, il sera plus facile d'utiliser Swagger 2, qui poss√®de une belle API, car en RAML, vous devez lever et maintenir le service vous-m√™me. <br>  Plus vous aurez de t√¢ches, plus vous aurez besoin d'outils, et ils seront diff√©rents pour diff√©rentes plates-formes, et il est pr√©f√©rable de vous familiariser imm√©diatement avec les versions disponibles pour faire un choix qui minimise vos co√ªts √† l'avenir. <br><br>  Mais il vaut la peine de reconna√Ætre que tous les √©cosyst√®mes qui existent aujourd'hui sont imparfaits.  Par cons√©quent, si l'entreprise a des fans qui aiment travailler en RAML, car ¬´cela vous permet d'exprimer vos pens√©es de mani√®re plus flexible¬ª, ou, au contraire, pr√©f√©rez Swagger, car ¬´c'est plus compr√©hensible¬ª, il est pr√©f√©rable de les laisser travailler dans ce qu'ils Nous y sommes habitu√©s et nous le voulons, car les outils de tous les formats doivent √™tre finalis√©s avec un fichier. <br><br>  Quant √† notre exp√©rience, dans les articles suivants, nous parlerons du type de contr√¥les statiques et dynamiques que nous effectuons sur la base de notre architecture RAML-Swagger, ainsi que de la documentation que nous g√©n√©rons √† partir des contrats et de la fa√ßon dont tout cela fonctionne. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466691/">https://habr.com/ru/post/fr466691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466679/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 49. Introduction √† l'EIGRP</a></li>
<li><a href="../fr466681/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 50. Configuration de l'EIGRP</a></li>
<li><a href="../fr466683/index.html">√âv√©nements num√©riques √† Moscou du 9 au 15 septembre</a></li>
<li><a href="../fr466685/index.html">Voir l'argent</a></li>
<li><a href="../fr466689/index.html">Comment cr√©er des classes de personnages dans une action MMO mobile</a></li>
<li><a href="../fr466693/index.html">Si vous entrez pas en informatique</a></li>
<li><a href="../fr466697/index.html">Monades √† Erlang</a></li>
<li><a href="../fr466699/index.html">Approbation des protocoles de confiance - Authentification OAuth avec InterSystems IRIS</a></li>
<li><a href="../fr466701/index.html">Let's Encrypt dessert pr√®s de 30% des domaines</a></li>
<li><a href="../fr466705/index.html">Vivaldi Beta pour Android - Navigateur r√©el</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>