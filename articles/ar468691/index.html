<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👺 👩🏾‍🍳 🗻 برامج تشغيل الجهات الخارجية الخطرة على نظامك أو LOLDrivers 🏠 🖋️ 📈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="هل تعلم أن برنامج التشغيل الشرعي تمامًا يمكن أن يمنح المهاجم فرصة التسجيل في نظامك لفترة طويلة ، مع الاستمرار في الداخل حتى بعد إعادة تثبيته؟ أو تحويل...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>برامج تشغيل الجهات الخارجية الخطرة على نظامك أو LOLDrivers</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br><p style=";text-align:right;direction:rtl">  هل تعلم أن برنامج التشغيل الشرعي تمامًا يمكن أن يمنح المهاجم فرصة التسجيل في نظامك لفترة طويلة ، مع الاستمرار في الداخل حتى بعد إعادة تثبيته؟  أو تحويل جهاز الكمبيوتر الخاص بك إلى لبنة؟  على سبيل المثال ، تعتبر بعض برامج التشغيل غير الموقعة (الموقعة) غير المؤذية أدوات بالمناسبة للكتابة فوق BIOS.  بعد هذا الهجوم ، فقط المبرمج سيوفر. </p><br><p style=";text-align:right;direction:rtl">  في Windows ، هناك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تطبيقات / نصوص / مكتبات</a> موثوق بها مع إضافات <del>  مثير </del>  وظيفة خطيرة مثل تنفيذ التعليمات البرمجية التعسفية ، وتنزيل الملفات ، وتجاوز UAC ، إلخ.  إذا تم العثور على هذه الوظيفة الإضافية في مكون kernel ، فستصبح أكثر إثارة للاهتمام. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  بدءًا من نظام التشغيل Windows Vista x64 ، يتم تطبيق سياسة توقيع برنامج التشغيل (DSE) - يجب توقيع جميع برامج تشغيل مستوى kernel.  إذا أراد أحد المهاجمين (مع حقوق المستخدم / المسؤول) بعد اختراق النظام الحصول على أقصى مستوى من الوصول (تثبيت kernel rootkit / bootkit / SMM-rootkit / BIOS-rootkit) ، فسيتعين عليه تجاوز شرط التوقيع لبرنامج التشغيل بطريقة أو بأخرى.  يمكن أن تتيح القدرة على استدعاء وظائف أو تعليمات معينة من وضع kernel في وضع kernel للمهاجمين أداة لرفع الامتيازات أو الكشف عن المعلومات أو التسبب في رفض الخدمة.  نحن نسمي هذه الوظيفة وظيفة مزدوجة الغرض (في بعض الحالات ، قد يطلق عليها نقاط الضعف أو الخلفية ، ومع ذلك ، فإن المناقشة حول التعريف الصحيح تتجاوز نطاق هذه المقالة). </p><br><h2 id="sposoby-obhoda-dse" style=";text-align:right;direction:rtl">  <strong>حلول DSE</strong> </h2><br><p style=";text-align:right;direction:rtl">  دعونا نلقي نظرة على الخيارات التي يجب على المهاجم عمومًا تجاوز DSE (يجب عليك اختراق ring0 بطريقة أو بأخرى).  يلخص الجدول التالي طرق تجاوز DSE بمزاياها وعيوبها (للمهاجم ، ويحيط حراس الأمن علما بذلك).  تجدر الإشارة إلى أن هذه المعلومات تنطبق على نظام التشغيل Windows x64 ، بدءًا من نظام التشغيل Vista. </p><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><thead><tr><th>  طريقة ل </th><th>  الفوائد </th><th>  القصور </th></tr></thead><tbody><tr><td>  إعداد بيانات تهيئة التمهيد (وضع الاختبار) </td><td>  سهولة </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  لا يعمل مع جميع التطبيقات. </li><li style=";text-align:right;direction:rtl">  تظهر علامة مائية على سطح المكتب </li><li style=";text-align:right;direction:rtl">  إعادة تشغيل المطلوبة </li></ul></td></tr><tr><td>  باستخدام مفتاح خاص للخطر </td><td>  القدرة على تثبيت أي سائق </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  في حالة اكتشاف تسرب ، تتم إضافة الشهادة إلى قائمة إبطال الشهادات (CRL) </li></ul></td></tr><tr><td>  استخدام الضعف في تطبيق التحكم DSE </td><td>  لم يتم الكشف عنها بواسطة أنظمة مكافحة الفيروسات والأمان من Windows </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  صعوبة في العثور على مثل هذه الثغرات </li><li style=";text-align:right;direction:rtl">  إصدار نظام التشغيل يعتمد </li></ul></td></tr><tr><td>  تعديل آليات فحص برنامج التشغيل (bootmgr ، winload.exe ، winresume.exe ، ci.dll) </td><td>  القدرة على تثبيت أي برنامج تشغيل دون الشيكات OC </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تعديل التعقيد </li><li style=";text-align:right;direction:rtl">  يتطلب طريقة لتجاوز التمهيد الآمن (في حالة التمكين) </li><li style=";text-align:right;direction:rtl">  إعادة تشغيل المطلوبة </li><li style=";text-align:right;direction:rtl">  إصدار نظام التشغيل يعتمد </li><li style=";text-align:right;direction:rtl">  ملف الضوابط الأخرى </li></ul></td></tr><tr><td>  باستخدام برنامج تشغيل موقع مع وجود ثغرة أمنية </td><td>  صعوبة اكتشاف الهجوم </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  صعوبة في العثور على مثل هذه الثغرات </li><li style=";text-align:right;direction:rtl">  كشف قفل الأمان </li></ul></td></tr><tr><td>  استخدام برنامج تشغيل موقّع مع وظائف ثنائية الغرض </td><td>  لم يتم الكشف عنها بواسطة أنظمة مكافحة الفيروسات والأمان من Windows </td><td><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  مدى تعقيد البحث (عن المهاجم) في برنامج التشغيل مع الوظيفة المزدوجة المطلوبة </li></ul></td></tr></tbody></table></div><br><p style=";text-align:right;direction:rtl">  كما ترون من الجدول ، فإن برنامج التشغيل الموقّع ذو الوظيفة المزدوجة هو الطريقة الأكثر جاذبية لتجاوز DSE للمهاجمين. </p><br><h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya" style=";text-align:right;direction:rtl">  <strong>وظيفة خطيرة أو مزدوجة الغرض</strong> </h2><br><p style=";text-align:right;direction:rtl">  دعونا نلقي نظرة على أمثلة القدرات الخبيثة التي يظهرها المهاجم في وجود سائق له وظائف خطرة مزدوجة الغرض. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> امتياز التصعيد لمستوى المشرف / النظام.  قراءة / كتابة الذاكرة الفعلية المطلوبة.  يمكن تنفيذ هذا الهجوم ، على سبيل المثال ، باستخدام برنامج التشغيل ASMMAP من ASUS.  للقيام بذلك ، اقرأ الذاكرة الفعلية وابحث عن بنية EPROCESS (إنها عنصر في قائمة مرتبطة) ، ثم انتقل إلى القائمة بحثًا عن العملية التي نريد زيادة مستوى امتيازها ، وكذلك بعض العمليات المعروفة بمستوى SYSTEM (على سبيل المثال ، lsass ، wininit).  ثم انسخ قيمة حقل الرمز المميز لهيكل عملية النظام إلى بنية العملية المستهدفة.  ويرد وصف أكثر تفصيلا للهجوم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> . </li><li style=";text-align:right;direction:rtl">  تعطيل SMEP.  للقيام بذلك ، تحتاج إلى الكتابة إلى سجل التحكم cr4 (بتعبير أدق ، إعادة تعيين بت 20).  على سبيل المثال ، لا يقوم برنامج التشغيل bandainamcoonline.sys بتعطيل SMEP فحسب ، بل يقوم أيضًا بتنفيذ التعليمات البرمجية وفقًا للمؤشر الذي تم تمريره إليها من المستخدم.  للمهتمين ، هناك <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مقال</a> مع وصف مفصل للسائق. </li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  تنفيذ التعليمات البرمجية التعسفية في وضع kernel.  قراءة / كتابة الذاكرة الفعلية و MSR المطلوبة.  النقطة المهمة هي استبدال العنوان (الموجود في إحدى MSRs) ، والذي سيتم الانتقال إليه عند إجراء مكالمة النظام ، إلى عنوان موقع رمز المهاجم.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> يمكنك العثور على مزيد من المعلومات حول هذا.  سوف تتدخل PatchGuard على طول الطريق ، ولكن يمكنك معرفة ذلك إذا كنت ترغب في ذلك. </p><br><blockquote style=";text-align:right;direction:rtl">  نظرًا لأن كلا من برنامج التشغيل و PatchGuard يعملان في Ring 0 ، فلا شيء يمنع السائق من تعطيل اختبارات PatchGuard (حتى ، بالطبع ، حتى تستمع Microsoft إلى Intel وتتجاوز النموذج مع حلقتين للحماية).  يدرك مطورو برامج kernel في Microsoft هذه الحقيقة ويقومون بإجراءات مختلفة لإخفاء موقع هذا الرمز وتعمية تصرفاته والهياكل الداخلية المستخدمة.  بمعنى آخر ، نظرًا لعدم القدرة على منعك من تعديل كود PatchGuard ، فإنهم يبذلون قصارى جهدهم لإخفائه. <br><br>  - <em>Blunden B. ترسانة Rootkit: الهروب والتهرب في الزوايا المظلمة للنظام.</em> </blockquote><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">الأصلي</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><blockquote style=";text-align:right;direction:rtl">  نظرًا لأن كلا من رمز برنامج التشغيل ورمز PatchGuard يتم تنفيذهما في Ring 0 ، فلا يوجد شيء يمنع KMD من تعطيل اختبارات PatchGuard (ما لم تكن Microsoft بالطبع تأخذ إشارة من Intel وتتحرك إلى أبعد من نموذج امتياز ذي حلقتين).  يدرك مهندسو النواة في Microsoft هذه الحقيقة تمامًا ويؤدون جميع أنواع برامج الألعاب البهلوانية للتشويش على أماكن تواجد الكود وما يفعله وهياكل البيانات الداخلية التي يتعامل معها.  بمعنى آخر ، لا يمكنهم منعك من تعديل كود PatchGuard ، لذلك سيحاولون مثل الجحيم لإخفائه. <br><br>  - <em>Blunden B. ترسانة Rootkit: الهروب والتهرب في الزوايا المظلمة للنظام.</em> </blockquote><br></div></div><br></li></ul><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  دخول BIOS.  مثال في البرية هو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Lojax</a> .  استولى المهاجمون على RwDrv.sys المعروفة واستخدموها لأغراضهم المتسخة: لقد قرأوا نظام BIOS ، وقاموا بتعديله وكتابته.  لن تساعد إعادة تثبيت Windows هنا ، لأن الشفرة الخبيثة موجودة في البرنامج الثابت على SPI-flash.  إذا لم تنجح عملية الكتابة الفوقية لـ BIOS (أو الكتابة فوقها بشكل خاص) ، فستكون غير سارة أيضًا.  في أي حال ، سوف تضطر إلى القيادة بعد المبرمج لإصلاح العواقب المزعجة. </li><li style=";text-align:right;direction:rtl">  اتصل بمعالج SMI.  أولاً ، ليست كل وحدات BIOS غير معزولة بنفس القدر عن الكود في وضع ring0: هناك آليات متعددة لحماية القراءة / الكتابة ، لذلك قد يكون هناك موقف تحتاج إلى خفضه - إلى وضع SMM (الأكثر امتيازًا).  طريقة واحدة للوصول إلى هناك من وضع kernel هي سحب معالج SMI (غالبًا ما تكون هناك نقاط ضعف بينها).  للاتصال بمعالج SMI ، يجب أن تكون قادرًا على الكتابة إلى منفذ الإدخال / الإخراج ، ويمكن القيام بذلك فقط بامتيازات ring0.  بمعنى أن برنامج تشغيل لديه القدرة على الكتابة إلى منافذ الإدخال / الإخراج قادر على اكتشاف معالج SMI ضعيف يمكن أن يسمح للمهاجم بتنفيذ التعليمات البرمجية في وضع SMM.  في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المثال ،</a> يستخدم المؤلف برنامج التشغيل RwDrv.sys. </li><li style=";text-align:right;direction:rtl">  معلومات حول النظام.  قراءة ذاكرة kernel (من خلال قراءة الذاكرة الفعلية) ، وقراءة BIOS ، ومعلومات حول إعدادات النظام ، والأجهزة المتصلة وآليات الحماية الممكّنة / المعطلة (من خلال قراءة MSR ، وسجلات التحكم ، والوصول إلى منافذ الإدخال / الإخراج) ، في بعض الحالات ، يمكن اكتشاف برنامج مشرفي مشهور ( مثل VirtualBox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">عبر MSR</a> ).  لهذه المهمة ، حتى السائق الذي يمكنه القراءة فقط ، وليس بالضرورة الكتابة ، يكون مناسبًا في أغلب الأحيان.  على سبيل المثال ، تعتبر RamCaptureDriver64.sys من Belkasoft مناسبة لقراءة الذاكرة الفعلية. </li></ul><br><p style=";text-align:right;direction:rtl">  إذا قمنا بتحليل العديد من المقالات والملاحظات حول CVE ، فيمكننا التمييز بين بعض تصنيفات الخطر المحتمل عند الوصول من وظائف ring3 في برامج التشغيل.  يسرد الجدول أدناه الوظائف الخطرة ومصادر المعلومات عنها. </p><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><thead><tr><th>  وظائف خطرة محددة </th><th>  مصادر المعلومات المتعلقة بالممارسات الأمنية </th></tr></thead><tbody><tr><td>  قراءة / كتابة سجلات MSR </td><td>  CVE-2018-10711 ، CVE-2018-18535 ، CVE-2018-19323 ، CVE-2007-5633 ، CVE-2007-5761 </td></tr><tr><td>  قراءة / كتابة منافذ الإدخال / الإخراج </td><td>  CVE-2018-10712 ، CVE-2018-18536 ، CVE-2018-19322 </td></tr><tr><td>  قراءة / كتابة الذاكرة الفعلية </td><td>  CVE-2018-16712 ، CVE-2018-10710 ، CVE-2017-15302 ، CVE-2017-15303 ، CVE-2018-19321 </td></tr><tr><td>  قراءة / كتابة سجلات التحكم </td><td>  CVE-2018-10709 ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Eset - استغلال ويندوز في عام 2016</a> </td></tr><tr><td>  أداء الوصول / عدادات على مدار الساعة </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ليف Uhsadel ، أندي جورج ، إنغريد Verbauwhed - استغلال عدادات أداء الأجهزة</a> </td></tr><tr><td>  قراءة / كتابة سجل العلم </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Wojtczuk R. ، Rutkowska J. بعد الأرنب الأبيض: هجمات برمجية ضد تقنية Intel VT-d</a> </td></tr><tr><td>  تعليمات الوصول إلى ذاكرة التخزين المؤقت </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اكتشاف الهجمات على القنوات الجانبية القائمة على ذاكرة التخزين المؤقت من خلال تقنية مراقبة التخزين المؤقت من Intel وعدادات أداء الأجهزة</a> </td></tr></tbody></table></div><br><p style=";text-align:right;direction:rtl">  وهذه ليست القائمة الكاملة للوظائف الخطرة المحتملة.  يمكنك أيضًا التحدث عن قراءة / كتابة الذاكرة الظاهرية لـ kernel ، والقراءة / الكتابة MMIO ، والوصول إلى أجهزة PCI ، إلخ. </p><br><p style=";text-align:right;direction:rtl">  من أهم الاهتمامات ، فضلاً عن الخطر الأكبر (وأكبر احتمال لاكتشاف برنامج تشغيل به مثل هذه الوظائف) ، أول ثلاث وظائف: سجلات MSR للقراءة / الكتابة ، ومنافذ القراءة / الكتابة / الإدخال / الذاكرة الفعلية للقراءة / الكتابة.  باستخدام سجلات التحكم ، يمكنك تجاوز بعض آليات الحماية ، تتيح لك الكتابة إلى سجل العلم تمكين منافذ الإدخال / الإخراج للقراءة / الكتابة في الحلقة 3 (بالمناسبة ، تم ذكره في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذه</a> المقالة على Habré) ، ونجاح الهجمات على قنوات الجهات الخارجية (عن طريق الوصول إلى ذاكرة التخزين المؤقت ومراقبة عدادات الأداء / الدورات) من غير المرجح على الأرجح. </p><br><p style=";text-align:right;direction:rtl">  أثناء عملية إنشاء هذه المادة في مؤتمر DEFCON 27 في لاس فيجاس ، قدم الباحثان جيسي مايكل وميكي شيكاتوف العمل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"انطلق من النواة إذا كنت غير قادر على القيادة"</a> ، والذي يناقش هذه المشكلة أيضًا ، ونحن نوصي بأن تدرس هذه المواد لاستكمال الصورة.  إن سيناريوهات استخدام برامج التشغيل هذه بسيطة للغاية وواضحة ، ويتم تقديم أمثلة على أقسام التعليمات البرمجية المسؤولة عن الوظائف الأكثر أهمية.  ويوفر أيضًا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">رمزًا</a> للعمل وإيجاد برامج تشغيل مماثلة. </p><br><p style=";text-align:right;direction:rtl">  بشكل عام ، تجدر الإشارة إلى أن هذا الموضوع طالما كان قلقًا بشأن باحثي الأمن.  مرة أخرى في عام 2018 ، الباحث الكسندر Matrosov في مقالته <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ما الذي يجعل السائقين OS خطير على BIOS؟"</a>  أثار هذا السؤال وأظهر كم هو بسيط لاستغلال BIOS. </p><br><h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya" style=";text-align:right;direction:rtl">  <strong>السائقين ثنائي الوظيفة</strong> </h2><br><p style=";text-align:right;direction:rtl">  فيما يلي أشهر ممثلين للسائقين ذوي وظائف مزدوجة الغرض. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  RwDrv.sys هو برنامج مشهور جدًا (يأتي مع الأداة المساعدة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RWeverything</a> ).  يقرأ ويكتب الذاكرة الفعلية ومنافذ الإدخال / الإخراج و MSR وسجلات التحكم.  تم استخدامه مرارا وتكرارا في مختلف PoCs ، ثم في الجذور الخفية Lojax المذكورة سابقا.  <a href="">واجهة</a> مكتوبة <a href="">له</a> في C ++ ، ويستخدم أيضا في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">chipec</a> . </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  cpuz / gpuz </p><br><div class="oembed" style=";text-align:right;direction:rtl"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" style=";text-align:right;direction:rtl" data-twitter-extracted-i1582099021363725906="true"><p lang="en" style=";text-align:right;direction:rtl">  هل [V] HW IO الغمغمة؟  تحقق من GPU-Z.sys (توقيع).  يلف داخل / خارج / MmMapIoSpace / wrmsr / إلخ من خلال IOCTLs :) - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">http://t.co/VwCYsm97rr</a> </p>  - كوستيا كورتشينسكي (@ crypt0ad) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">30 يناير 2015</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p style=";text-align:right;direction:rtl">  يقرأ ويكتب الذاكرة الفعلية ، والموانئ ، و MSR.  هناك العديد من الأدوات المساعدة PoC استخدامه ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وهنا</a> ). </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  pcdsrvc_x64 - برنامج تشغيل من Dell ، لمزيد من المعلومات ، اتصل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بهذه</a> المشاركة.  يتيح لك قراءة / كتابة الذاكرة الفعلية في منافذ الإدخال / الإخراج. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  AsIO64.sys <br><img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="صورة"><br>  يوفر القدرة على قراءة / كتابة الذاكرة الفعلية ومنافذ الإدخال / الإخراج ، ويأتي أيضًا مع ملف dll مناسب لأداء هذه الطلبات. </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  Asmmap64.sys هو برنامج تشغيل آخر من ASUS يسمح لك بقراءة / كتابة الذاكرة الفعلية ومنافذ الإدخال / الإخراج و MSR.  سيكون ممتعًا بشكل خاص للمهاجمين ، حيث يمكن الوصول إلى برنامج التشغيل من مستخدم عادي دون حقوق المسؤول.  يمكن للفضوليين اللجوء إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المصدر</a> . </p><br></li><li style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ntiolib_x64.sys / winio64.sys - برامج تشغيل من MSI ، يتم وصفها بالتفصيل في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المقالة</a> المذكورة سابقًا.  باستخدام ntiolib_x64.sys ، يمكنك قراءة / كتابة الذاكرة الفعلية ومنفذ الإدخال / الإخراج و MSR ، يوفر winio64.sys جميع هذه الوظائف باستثناء MSR. </p><br></li></ul><br><p style=";text-align:right;direction:rtl">  عادة ، يتم التعرف على الوظائف الخطرة الموصوفة على أنها نقاط ضعف إذا كان المستخدم في متناول المستخدم بدون حقوق المسؤول (ACL غير صحيحة) أو عندما يسمح بتنفيذ التعليمات البرمجية التعسفية مباشرة (كما في bandainamcoonline.sys).  في حالات أخرى ، هذه مجرد وظيفة ، ولأن المستخدم لديه حقوق المسؤول ، يمكنه استخدام جميع وظائف برنامج التشغيل وهذا هو المعيار. </p><br><p style=";text-align:right;direction:rtl">  إذا كنت تعتقد أنه لا يوجد أكثر من عشرة من برامج التشغيل هذه ، فأنت مخطئ إلى حد كبير.  يمكنك رؤية <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا الاختيار من</a> برامج التشغيل المثيرة للاهتمام.  تحتوي هذه القائمة على برامج تشغيل من ASUS و AVAST و Razer و LG و Megatrends الأمريكية وغيرها من الشركات المعروفة.  لذلك هناك الكثير منهم ، تحتاج فقط إلى البحث.  لذلك ، فإنها تشكل تهديدا حقيقيا. </p><br><p style=";text-align:right;direction:rtl">  يتم فهم هذا التهديد أيضًا من قِبل موظفي Microsoft.  وسيكونون ممتنين للحصول على معلومات حول برامج التشغيل هذه ؛) <br><img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="صورة"></p><br><h2 id="rekomendacii" style=";text-align:right;direction:rtl">  <strong>توصيات</strong> </h2><br><p style=";text-align:right;direction:rtl">  للمستخدمين: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يجب ألا تجلس دون داع تحت حساب المسؤول وتعطيل UAC (على الرغم من أنه ليس من الصعب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الالتفاف</a> عليه). </li><li style=";text-align:right;direction:rtl">  يمكنك تثبيت الكاشف الذي يحاول تثبيت برامج التشغيل (على سبيل المثال ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> ). </li><li style=";text-align:right;direction:rtl">  إذا كان من الضروري استخدام الأدوات المساعدة مع برامج التشغيل هذه (التشخيص ، لتحديث BIOS ، وما إلى ذلك) ، قم بإزالة برامج التشغيل بعد الاستخدام. </li><li style=";text-align:right;direction:rtl">  قم بإعداد <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">واقي الأجهزة</a> (إذا كنت مالكًا سعيدًا لنظام Windows 10).  باستخدام هذه التقنية ، يمكنك إنشاء سياسة تكامل التعليمات البرمجية الخاصة بك وإضافة قوائم بيضاء من البرامج والشهادات.  على سبيل المثال ، أضف إلى السياسة شرط أن يكون لدى أي برنامج تشغيل وضع kernel توقيع Microsoft WHQL.  في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هذا</a> المنشور ، يمكنك التعرف بشكل أفضل على إعداد Device Guard لهذا الغرض. </li></ul><br><p style=";text-align:right;direction:rtl">  الشركات المصنعة هي أفضل حالا لا توقع مثل هذه السائقين.  إذا احتاج المستخدم إلى تحديث نظام BIOS ، فتحقق من وجود ثغرات أمنية (مرحبًا ، chipsec) ، وقياس الأداء أو إجراء بعض التلاعب الأخرى التي تتطلب تثبيت برامج التشغيل هذه ، ثم يمكنه الدخول في Test Mode ، والقيام بكل هذا ، ثم الخروج.  ستنخفض قابليتها للاستخدام ، ولكن الأمان سيزداد. </p><br><h2 id="vyvody" style=";text-align:right;direction:rtl">  <strong>النتائج</strong> </h2><br><p style=";text-align:right;direction:rtl">  إذا تم توقيع شيء ما ، فلا يمكنك الوثوق به على أي حال.  أولاً ، يمكنك توقيع شيء كهذا ، وثانياً ، يمكن للمهاجم الاستفادة من هذا الموقع (حتى لو كان من شركة تصنيع موثوق بها). </p><br><p style=";text-align:right;direction:rtl">  يجب ألا يستبعد متخصصو أمن المعلومات من مواقف نماذج التهديد التي يتطلب فيها المهاجم سائقًا ذو وظيفة خطيرة لتنفيذ هجوم.  هناك ما يكفي من هذه السائقين ؛ الأمر بسيط للغاية للقيام بذلك.  إذا لم يتم تنفيذ الهجوم باستخدام برنامج تشغيل البوب ​​مثل RwEverything ، ولكن مع البعض الآخر الأقل شهرة ، فسيكون من الصعب اكتشافه.  لذلك عليك أن تكون في حالة تأهب ، وأن تراقب مثل هذه الأشياء ولا تسمح لكل برنامج تشغيل بالتمهيد في النظام. </p><br><p style=";text-align:right;direction:rtl">  المؤلف: إليزافيتا كومينكو </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar468691/">https://habr.com/ru/post/ar468691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar468677/index.html">الإعلان عن الهاتف الذكي Xiaomi Mi Mix Alpha</a></li>
<li><a href="../ar468679/index.html">أبجديات الأمن في Kubernetes: المصادقة ، إذن ، التدقيق</a></li>
<li><a href="../ar468683/index.html">نظرية وممارسة توحيد خدمات دوكر</a></li>
<li><a href="../ar468687/index.html">نقوم بتحليل المبادرات الجديدة للبنك المركزي لتنظيم سوق الأوراق المالية: 3 مجموعات من المستثمرين ، قيود للمبتدئين</a></li>
<li><a href="../ar468689/index.html">تسجيل أعمال تكنولوجيا المعلومات في سنغافورة: ماذا علي أن أفعل؟</a></li>
<li><a href="../ar468693/index.html">كيف الأتمتة يدمر موظفي وول مارت</a></li>
<li><a href="../ar468695/index.html">مخترقتي الأولى: موقع يتيح لك ضبط أي كلمة مرور للمستخدم</a></li>
<li><a href="../ar468697/index.html">DB & DWH MeetUp # 5 في Raiffeisenbank</a></li>
<li><a href="../ar468703/index.html">كيف يمكن للمبرمج كسب المزيد؟</a></li>
<li><a href="../ar468705/index.html">مكالمة فيديو في المتصفح على PeerJS. بداية سريعة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>