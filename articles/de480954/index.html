<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸšµğŸ¿ ğŸ¦ ğŸ‘¸ Aufgabennummer 1. Finden Sie Geschlecht und Verwandtschaftsgrad heraus ğŸ‘µğŸ¿ â™“ï¸ ğŸ‘‰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im vorherigen detaillierten Artikel Ã¼ber das vollstÃ¤ndige Genom haben wir versprochen, drei Probleme zu verÃ¶ffentlichen und demjenigen einen Test zu g...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aufgabennummer 1. Finden Sie Geschlecht und Verwandtschaftsgrad heraus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/atlasbiomed/blog/480954/">  Im vorherigen detaillierten <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">Artikel</a> Ã¼ber das <a href="https://atlas.ru/wgs">vollstÃ¤ndige Genom haben</a> wir versprochen, drei Probleme zu verÃ¶ffentlichen und demjenigen einen Test zu geben, der alle drei zuerst richtig lÃ¶st.  Gleichzeitig geben wir Beispiele, wie man bei diesen Aufgaben mit genetischen Daten arbeitet.  Heute verÃ¶ffentlichen wir die erste. <br><br><img src="https://habrastorage.org/webt/qd/mz/ye/qdmzye9a9sdyp82atstpktqrnu4.png"><br><a name="habracut"></a><br>  Im ersten <a href="https://habr.com/ru/company/atlasbiomed/blog/479602/">Artikel haben</a> wir nÃ¼tzliche Informationen und Links geteilt, die fÃ¼r die Arbeit mit Bioinformatikdaten nÃ¼tzlich sind.  Wir empfehlen, dass Sie es zuerst lesen, wenn Sie es verpasst haben. <br><br>  <b>Haftungsausschluss</b> <br>  Die Arbeit mit genetischen Daten wird auf Unix-Systemen (Linux, macOS) ausgefÃ¼hrt, da einige Befehle und Software unter Windows nicht verfÃ¼gbar sind.  Aus diesem Grund besteht eine der einfachsten LÃ¶sungen fÃ¼r Windows-Benutzer darin, eine virtuelle Linux-Maschine zu mieten. <br><br>  Alle nachfolgend beschriebenen VorgÃ¤nge werden auf dem Befehlszeilenterminal ausgefÃ¼hrt.  Bevor Sie beginnen, lernen Sie, wie Sie in einem Terminal mit Ihrem Betriebssystem arbeiten und Befehle verwenden, da einige davon mÃ¶glicherweise das Betriebssystem und Ihre Daten beschÃ¤digen kÃ¶nnen. <br><br><br><h2>  BenÃ¶tigte Software </h2><br>  Wir haben das <a href="https://cloud.yandex.ru/marketplace/products/f2e5v4acgtukhi31n6o4">Image einer virtuellen Maschine</a> (VM) mit der gesamten erforderlichen Software auf Yandex.Cloud gesammelt.  Registrieren Sie sich in Yandex.Cloud und klicken Sie in Ihrem Konto im Bereich "Compute Cloud" auf "VM erstellen".  WÃ¤hlen Sie als Ã¶ffentliches Bild 1000 Genome aus dem Atlas Data Analysis-Katalog aus. <br><br>  VM-Konfiguration: 100% 2vCPU, 8 GB RAM, 20 GB Festplatte.  Beim Erstellen einer VM mÃ¼ssen Sie die Zahlungsdaten eingeben, es wird jedoch nichts vom Konto abgeschrieben.  Ein Start und ein zusÃ¤tzliches Grant fÃ¼r ein Codewort reichen aus, um mit einer VM und einem Image von Atlas bis zum 31. Dezember 2019 kostenlos zu arbeiten.  Senden Sie das Codewort "ATLAS" an den <a href="https://console.cloud.yandex.ru/support">Yandex.Cloud-Support,</a> um eine Finanzhilfe fÃ¼r die Erledigung von Aufgaben zu <a href="https://console.cloud.yandex.ru/support">erhalten</a> . <br><br>  Hinweis: Das Stipendium gilt fÃ¼r neue Yandex.Cloud-Benutzer, die sich seit dem 18. Dezember 2019 angemeldet haben, oder fÃ¼r Benutzer, die noch eine Testphase haben und ein Startstipendium haben.  Das Codewort ATLAS ist nur einmal gÃ¼ltig. <br><br>  Erstellen Sie zunÃ¤chst einen SSH-SchlÃ¼ssel auf dem lokalen Computer, von dem aus Sie eine Verbindung zur VM herstellen mÃ¶chten: <br><br><pre><code class="bash hljs">ssh-keygen -o -t rsa -b 4096 -C <span class="hljs-string"><span class="hljs-string">"my-local-machine"</span></span> -f ~/.ssh/yandex-cloud -a 100</code> </pre> <br>  Vergessen Sie nicht, den Inhalt der Datei <code>~/.ssh/yandex-cloud.pub</code> beim Erstellen der VM in das entsprechende Fenster zu kopieren. <br><br>  Wenn Sie die Software auf Ihrem Computer installieren mÃ¶chten, finden Sie nachfolgend alle Installationsinformationen.  Wenn Sie sich fÃ¼r Yandex.Cloud entscheiden, erstellen Sie eine VM und fahren Sie mit dem nÃ¤chsten Abschnitt fort. <br><br><br><h3>  Plink </h3><br>  Plink ist ein Softwarepaket zur Manipulation genetischer Daten und der Wide Genome Association Search (GWAS).  Es wurde vom Genetiker Sean Purcell (Shaun Purcell) entwickelt.  Seit 2008 wurden mit Hilfe von Plink weltweit Hunderte von GWAS durchgefÃ¼hrt, deren beste Ergebnisse Atlas als Datenquelle fÃ¼r Algorithmen zur Berechnung von Krankheitsrisiken verwendet. <br><br>  Plink bietet eine Reihe von Tools zum Speichern, Konvertieren und Suchen von Genotypisierungsdaten.  Plink ermÃ¶glicht auch die statistische Verarbeitung, die Analyse des VerknÃ¼pfungsungleichgewichts (LD), die Analyse der IdentitÃ¤t nach Abstammung (IBD) und der IdentitÃ¤t (Zustand nach IBS), Populationsschichtungstests und Epistasietests - das Zusammenspiel mehrerer genetischer Variationen untereinander. <br><br>  IBD und IBS werden verwendet, um die Populationszusammensetzung zu analysieren und die Verwandtschaft zu bestimmen. <br><br>  Ein Beispiel fÃ¼r eine Epistase sind die Variationen von rs7412 und rs429358 im APOE-Gen, wobei eine bestimmte Kombination von Varianten das Risiko fÃ¼r die Entwicklung der Alzheimer-Krankheit stark erhÃ¶ht, wÃ¤hrend jede Variante einzeln nur einen geringen Beitrag zum Risiko leistet. <br><br>  Laden Sie die stabile Version von Plink von der offiziellen <a href="https://www.cog-genomics.org/plink/">Website herunter</a> . <br><br><br><h3>  BCFtools </h3><br>  BCFtools ist eine Reihe von Dienstprogrammen zur Bearbeitung genetischer Daten im VCF-Format und seinem binÃ¤ren GegenstÃ¼ck BCF.  Die Liste der mÃ¶glichen Anwendungen des BCFtools-Pakets umfasst das Kommentieren, Filtern, ZusammenfÃ¼hren und Aufteilen von VCF / BCF-Dateien, das Finden ihrer Schnittpunkte, das Indizieren, das selektive Suchen, das Sortieren, das ZÃ¤hlen von Statistiken usw. <br><br>  Gehen Sie zur Installation wie folgt vor: <br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/htslib.git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/samtools/bcftools.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> bcftools <span class="hljs-comment"><span class="hljs-comment"># The following is optional: # autoheader &amp;&amp; autoconf &amp;&amp; ./configure --enable-libgsl --enable-perl-filters make</span></span></code> </pre> <br>  Der Installationsvorgang wird <a href="https://samtools.github.io/bcftools/howtos/install.html">hier</a> ausfÃ¼hrlicher beschrieben. <br><br><br><h3>  KÃ–NIG </h3><br>  Das KING-Paket (Kinship-based INference for Gwas) wird in Populationsstudien verwendet, wenn mit Daten aus einer genomweiten Assoziationssuche gearbeitet wird, um Familienbeziehungen in den untersuchten Daten zu bestimmen.  In dieser Aufgabe hilft KING dabei, den Verwandtschaftsgrad mehrerer Proben aus dem 1000-Genom-Projekt zu bestimmen. <br>  Sie kÃ¶nnen es <a href="http://people.virginia.edu/~wc9c/KING/Download.htm">hier</a> herunterladen.  Zur Behebung von Problemen finden Sie hier das KING-Handbuch. <br><br><blockquote>  Nahezu alle Fehler, die bei der Arbeit mit Werkzeugen auftreten kÃ¶nnen, sind in <a href="https://stackoverflow.com/">Stackoverflow</a> oder seinem bioinformatischen GegenstÃ¼ck - <a href="https://www.biostars.org/">Biostars</a> - <a href="https://www.biostars.org/">beschrieben</a> . </blockquote><br><h2>  Verwendete Daten </h2><br>  Zur Orientierung verwenden wir die offenen Daten <a href="https://www.internationalgenome.org/">aus</a> dem 1000 Genomes-Projekt.  FÃ¼r die Analyse haben wir 10 Proben mit Informationen Ã¼ber die Genotypen von etwa 85 Millionen Variationen ausgewÃ¤hlt, die durch Analyse von NGS-Daten erhalten wurden, die mit der Version des Referenzgenoms GRCh37 Ã¼bereinstimmen.  Familienbeziehungen und Stichprobenpopulationen sind in Abbildung 1 dargestellt. <br><br><img src="https://habrastorage.org/webt/yr/rt/bg/yrrtbgj6tct9huih0rg5gww63xc.png"><br>  <b>Abbildung 1</b>  Pedigree in VCF-Proben verwendet.  Das Quadrat entspricht dem mÃ¤nnlichen Geschlecht, der Kreis dem weiblichen.  Gepunktete Linie bedeutet unbestimmte Verwandtschaft zweiter Ordnung. <br><br><br><h2>  Beachten Sie </h2><br>  Das VCF-Format ermÃ¶glicht es Ihnen, Informationen Ã¼ber das Feld einer Person als einzelne Zahl zu speichern, wenn diese Informationen wÃ¤hrend der Erstellung des VCF bekannt waren.  Es sieht so aus: Das GT-Feld (Genotyp, Genotyp) fÃ¼r DatensÃ¤tze aus dem X-Chromosom enthÃ¤lt einen numerischen Wert, der einem Allel entspricht, fÃ¼r MÃ¤nner und zwei fÃ¼r Frauen.  Wenn keine Informationen zum biologischen Feld der sequenzierten Probe vorliegen, enthÃ¤lt das GT-Feld standardmÃ¤ÃŸig zwei numerische Werte (in Abbildung 2 rot hervorgehoben). <br><br>  In den in diesem Handbuch verwendeten VCF-Dateien ist das Y-Chromosom ausgeschlossen. Das Vorhandensein des Y-Chromosoms in der VCF-Datei bedeutet jedoch nicht immer, dass die sequenzierte Probe tatsÃ¤chlich Ã¼ber dieses verfÃ¼gt.  Dies liegt an pseudoautosomalen Regionen (PARs), die fÃ¼r die X- und Y-Chromosomen identisch sind und sich an ihren Enden befinden. <br><br>  Verschiedene Chromosomen haben normalerweise nicht lange identische (homologe) Regionen, jedoch besitzen X- und Y-Chromosomen solche Regionen, die zu Beginn (PAR1) und am Ende (PAR2) mehrere Millionen Basenpaare lang sind.  Daher werden bei der Analyse von NGS-Daten bei MÃ¤nnern in den PAR-Regionen zwei Allele gefunden (eines fÃ¼r jedes Geschlechtschromosom), und bei Frauen kÃ¶nnen Genotypen in den PAR-Regionen des Y-Chromosoms auftreten, obwohl dies tatsÃ¤chlich Genotypen aus ihrem X-Chromosom sind. <br><br><img src="https://habrastorage.org/webt/xc/nx/ga/xcnxgajnkuainexvlp2a5ppsqrg.png"><br>  <b>Abbildung 2</b>  VCF-Datei mit Genotypen aus dem X-Chromosom eines Mannes aus der PAR1-Region (erste beiden EintrÃ¤ge) und der nicht-pseudo-autosomalen Region (letzte beiden EintrÃ¤ge). <br><br><blockquote>  Unterrichtseinheit <br>  Das genetische Geschlecht ist ein Satz von Geschlechtschromosomen, die der Manifestation von primÃ¤ren und sekundÃ¤ren Geschlechtsmerkmalen eines mÃ¤nnlichen oder weiblichen Typs entsprechen.  Normalerweise haben MÃ¤nner ein Chromosom X und ein Chromosom Y, wÃ¤hrend Frauen zwei Chromosomen X haben. Mit verschiedenen StÃ¶rungen bei der Bildung von Keimzellen, Eiern und Spermien kann ein Kind mit einem ausgezeichneten Satz von Geschlechtschromosomen zur Welt kommen, was hÃ¤ufig zu EntwicklungsstÃ¶rungen fÃ¼hrt primÃ¤re und sekundÃ¤re sexuelle Merkmale. <br><br>  Die beiden hÃ¤ufigsten chromosomalen sexuellen Anomalien sind das <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%25A8%25D0%25B5%25D1%2580%25D0%25B5%25D1%2588%25D0%25B5%25D0%25B2%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B3%25D0%25BE_%25E2%2580%2594_%25D0%25A2%25D1%2591%25D1%2580%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B0">Turner-Syndrom</a> (ein Satz von Chromosomen X0, dh nur ein X-Chromosom) und das <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%259A%25D0%25BB%25D0%25B0%25D0%25B9%25D0%25BD%25D1%2584%25D0%25B5%25D0%25BB%25D1%258C%25D1%2582%25D0%25B5%25D1%2580%25D0%25B0">Klinefelter-Syndrom</a> (ein Satz von Chromosomen XXY). <br><br>  Ein Allel ist ein oder mehrere Nukleotide, die sich an einer beliebigen Stelle im Genom befinden und eine Alternative haben.  Das Konzept wird zur Beschreibung von Genotypen verwendet.  Unterscheiden Sie zwischen Referenz-Allelen und Alternativen.  Alle werden in der VCF-Datei in den Feldern REF und ALT gespeichert. </blockquote><br><h2>  Bestimmen Sie das Geschlecht </h2><br><div class="spoiler">  <b class="spoiler_title">FÃ¼r Benutzer von Yandex.Cloud</b> <div class="spoiler_text">  Alle Daten zur DurchfÃ¼hrung der manuellen und unabhÃ¤ngigen Aufgaben werden in Yandex.Cloud in der unten gezeigten Struktur gespeichert.  Der <code>Tutorial</code> Ordner enthÃ¤lt die VCF-Datei, die zur VervollstÃ¤ndigung des Handbuchs benÃ¶tigt wird, den <code>Test</code> Ordner fÃ¼r unabhÃ¤ngige Aufgaben.  Der Ordner " <code>Technical</code> " enthÃ¤lt zwei Dateien mit einer Liste der Identifikatoren genetischer Variationen: " <code>rsids_for_subsetting.txt</code> im Handbuch verwendet und Aufgaben fÃ¼r die unabhÃ¤ngige AusfÃ¼hrung. " <code>external_interpretation_rsids.txt</code> mÃ¶glicherweise in Zukunft benÃ¶tigt, wenn die genomweite Sequenzierung im Atlas zum Hochladen von Genotypisierungsdaten an Dienste von Drittanbietern erfolgt.  Der Ordner <code>Tools</code> enthÃ¤lt unter anderem zwei Skripte, die in den Aufgaben 2 und 3 verwendet werden. <br><br><pre> <code class="bash hljs">home â””â”€â”€ ubuntu â”œâ”€â”€ Data â”‚ â”œâ”€â”€ Test â”‚ â”‚ â”œâ”€â”€ CEI.1kg.2019.test.vcf.gz â”‚ â”‚ â””â”€â”€ CEI.1kg.2019.test.vcf.gz.tbi â”‚ â””â”€â”€ Tutorial â”‚ â”œâ”€â”€ CEI.1kg.2019.demo.vcf.gz â”‚ â””â”€â”€ CEI.1kg.2019.demo.vcf.gz.tbi â”œâ”€â”€ Technical â”‚ â”œâ”€â”€ external_interpretation_rsids.txt â”‚ â””â”€â”€ rsids_for_subsetting.txt â””â”€â”€ Tools â”œâ”€â”€ convert_plink_delimiter.sh â””â”€â”€ create_23andme.sh</code> </pre> <br>  Im Verzeichnis <code>/home</code> auf der Yandex.Cloud-VM wird ein Ordner erstellt, dessen Name dem Benutzernamen entspricht, der bei der Erstellung der VM angegeben wurde.  Kopieren Sie alles aus dem Verzeichnis <code>/home/ubuntu</code> mit den folgenden Befehlen in Ihr Verzeichnis: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ cp -r /home/ubuntu/* ./</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">FÃ¼r den Rest</b> <div class="spoiler_text">  Wenn Sie an einem PC arbeiten, kÃ¶nnen Sie die fÃ¼r die erste Aufgabe erforderlichen Dateien Ã¼ber den <a href="">Link</a> herunterladen.  Das heruntergeladene Archiv unterstÃ¼tzt eine Ã¤hnliche Dateispeicherstruktur wie Yandex.Cloud: <br><br><pre> <code class="bash hljs">home â””â”€â”€ ubuntu â”œâ”€â”€ Data â”‚ â”œâ”€â”€ Test â”‚ â”‚ â”œâ”€â”€ CEI.1kg.2019.test.vcf.gz â”‚ â”‚ â””â”€â”€ CEI.1kg.2019.test.vcf.gz.tbi â”‚ â””â”€â”€ Tutorial â”‚ â”œâ”€â”€ CEI.1kg.2019.demo.vcf.gz â”‚ â””â”€â”€ CEI.1kg.2019.demo.vcf.gz.tbi â”œâ”€â”€ Technical â”‚ â”œâ”€â”€ external_interpretation_rsids.txt â”‚ â””â”€â”€ rsids_for_subsetting.txt â””â”€â”€ Tools â”œâ”€â”€ convert_plink_delimiter.sh â””â”€â”€ create_23andme.sh</code> </pre> <br>  Entpacken Sie das Archiv <code>atlas_wgs_contest.tar.gz</code> mit dem Befehl <br> <code>tar -xvzf atlas_wgs_contest.tar.gz</code> <br> </div></div><br>  VCF-Dateien fÃ¼r die AusfÃ¼hrung von Aufgaben in nicht archivierter Form belegen jeweils etwa 19 Gigabyte. Aus PlatzgrÃ¼nden empfehlen wir daher, nur mit Archiven zu arbeiten.  Alle oben aufgefÃ¼hrten Programme kÃ¶nnen bereits mit komprimierten VCF-Daten arbeiten.  DarÃ¼ber hinaus mÃ¼ssen Sie nichts tun. <br><br>  Um das Geschlecht des Subjekts zu bestimmen, mÃ¼ssen Sie die Genotypen auf dem X-Chromosom untersuchen und die Regionen PAR1 und PAR2 am Anfang und Ende ausschlieÃŸen.  Dies sind die Intervalle der Positionen 60001â€“2699520 und 154931044â€“155260560 in der GRCh37-Version des Genoms.  Wenn der Genotyp eine numerische Bezeichnung enthÃ¤lt, ist dies das mÃ¤nnliche biologische Geschlecht, ansonsten das weibliche.  Es ist zu beachten, dass die Benennung des Geschlechts in der VCF-Datei von der VerfÃ¼gbarkeit von Informationen Ã¼ber das biologische Feld wÃ¤hrend der Erzeugung der VCF abhÃ¤ngt. Daher kann dieser Ansatz nicht immer verwendet werden. <br><br>  Verwenden Sie fÃ¼r jedes Beispiel im Dataset den folgenden Befehl.  Ersetzen Sie die Beispiel-ID nach dem Argument <code>-s</code> : <br><br><pre> <code class="bash hljs">(/Data/Tutotrial/CEI.1kg.2019.demo.vcf.gz): <span class="hljs-comment"><span class="hljs-comment">#      bcftools view -O v -H -s HG00731 -r chrX:2699521-154931043 CEI.1kg.2019.demo.vcf.gz | head</span></span></code> </pre> <br>  Wenn Sie die Befehle ausfÃ¼hren, sehen Sie einen Teil des Inhalts der VCF-Datei fÃ¼r die angegebene Beispiel-ID.  Der <code>-r chrX:2699521-154931043</code> in BCFtools beschrÃ¤nkt die Anzeige des Inhalts der Datei auf den Bereich von Chromosom X von Position 2699521 bis Position 154931043 (Nicht-PAR-Bereich in Abbildung 3).  Diese Grenzen schlieÃŸen pseudoautosomale Regionen aus, die in diesem Fall nicht erforderlich sind (PAR1 und PAR2).  Bestimmen Sie anhand der numerischen Werte im GT-Feld das Geschlecht jeder Probe. <br><br><img src="https://habrastorage.org/webt/vn/fx/et/vnfxetqzursuy3ltyytqj-giiko.png"><br>  <b>Abbildung 3</b>  Die Position der pseudo-autosomalen Regionen PAR1 und PAR2 auf den Geschlechtschromosomen. <br><br>  Sie kÃ¶nnen die Liste aller Beispiel-IDs in der VCF-Datei in Abbildung 1 oder in der letzten Zeile des Headers der VCF-Datei sehen.  Sie werden nach dem Spaltennamen FORMAT aufgefÃ¼hrt: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#CHROM POS ID REF ALT QUAL FILTER INFO FORMAT HG00731 HG00732 HG02026 HG02025 HG02250 HG02373 HG00733 HG02024 HG02377 HG02381</span></span></code> </pre> <br>  Das wahre Geschlecht dieser Proben ist ebenfalls in Abbildung 1 dargestellt. <br><br><br><h2>  Wir bestimmen die Beziehung </h2><br>  Um die Beziehung zu bestimmen, mÃ¼ssen wir die genetischen Daten aller Proben paarweise vergleichen.  Es ist schwierig, dies mit dem vollen Genom zu tun: In diesem Fall benÃ¶tigt eine VCF-Datei zehn Gigabyte.  Der von uns verwendete VCF nimmt nur etwa 2 Gigabyte in Anspruch, filtert ihn jedoch nach der Liste der genetischen Variationskennungen (rsIDs), die auf den Chips von Illumina genotypisiert sind: GSA v1, GSA v2, HumanOmniExpress v1.0, HumanOmniExpress v1.3, InfiniumExome v1. 1 und Infinium OmniExpressExome v1.4.  Dies sind die beliebtesten Chips bei der kommerziellen Genotypisierung. <br><br>  Wir haben eine Liste aller Identifikatoren genetischer Variationen dieser Chips in einer separaten Datei mit einer Liste von rsIDs zusammengestellt.  Es enthÃ¤lt 1,4 Millionen Identifikatoren.  FÃ¼hren Sie den folgenden Befehl aus, um die VCF-Datei zu filtern: <br><br><pre> <code class="bash hljs">bcftools view -O z -i <span class="hljs-string"><span class="hljs-string">'ID=@rsids_for_subsetting.txt'</span></span> CEI.1kg.2019.demo.vcf.gz &gt; CEI.1kg.2019.demo.subset.vcf.gz</code> </pre> <br>  Jedes Mal, wenn Sie BCFtools und andere Pakete zum Arbeiten mit VCF-Dateien verwenden, wird der Verlauf vorheriger Befehle zum Header der Datei hinzugefÃ¼gt.  UnabhÃ¤ngig von der Methode zum Filtern der VCF-Datei und den zuvor ausgefÃ¼hrten Befehlen kÃ¶nnen Sie die IntegritÃ¤t und IdentitÃ¤t des Hauptinhalts der VCF Ã¼berprÃ¼fen, indem Sie die Hash-Summe berechnen: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      gunzip -c CEI.1kg.2019.demo.subset.vcf.gz | grep -v "^#" &gt; CEI.1kg.2019.demo.subset.body.vcf md5sum --tag CEI.1kg.2019.demo.subset.body.vcf #       d609eb330908d4eb5feb9f1860fd508b</span></span></code> </pre> <br>  Der Befehl <code>gunzip -c</code> dekomprimiert die Datei mit der Ausgabe ihres Inhalts auf stdout, aus der die <code> #</code> beginnenden Kopfzeilen der VCF-Datei weiter gelÃ¶scht werden (daher wird der Befehl <code>grep -v "^#"</code> verwendet).  Der Header wird entfernt, um nur die IntegritÃ¤t der genetischen Daten selbst zu vergleichen und nicht die Metadaten darÃ¼ber, welche Tools und wann fÃ¼r die Arbeit mit dieser VCF-Datei verwendet wurden. <br><br>  Wenn der Hash-Wert Ã¼bereinstimmt, kÃ¶nnen Sie VCF in das interne Plink-Format konvertieren (standardmÃ¤ÃŸig besteht das Plink-Format aus drei Dateien mit den Erweiterungen bed, bim und fam).  In diesen Dateien bleiben nur der Genotyp, das Chromosom, die Position und einige andere Daten Ã¼brig, und der Rest wird eliminiert.  Mit diesem Format ist es viel einfacher, verschiedene Probleme zu bearbeiten und zu lÃ¶sen, fÃ¼r die keine zusÃ¤tzlichen Informationen von VCF erforderlich sind.  FÃ¼hren Sie beispielsweise GWAS durch. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#     plink --vcf CEI.1kg.2019.demo.subset.vcf.gz --make-bed --out CEI.1kg.2019.demo.subset</span></span></code> </pre><br>  Dieser Befehl erstellt drei Dateien im Ordner: <br> <code>CEI.1kg.2019.demo.subset.bed <br> CEI.1kg.2019.demo.subset.bim <br> CEI.1kg.2019.demo.subset.fam</code> <br> <br>  Sie kÃ¶nnen fÃ¼r alle 10 Proben eine paarweise Verwandtschaft bestimmen.  Wir verwenden den folgenden Befehl, um Plink-Dateien zu analysieren: <br><br><pre> <code class="bash hljs">king -b CEI.1kg.2019.demo.subset.bed --kinship --prefix CEI.1kg.2019.demo.subset.kinship_analysis</code> </pre> <br>  Sehen Sie sich die Datei <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> und achten Sie auf die Spalte Kinship, die die Verwandtschaftskoeffizienten fÃ¼r die in ID1 bzw. ID2 angegebenen Stichprobenpaare enthÃ¤lt. <br><br>  Vergleichen Sie die in der Datei <code>CEI.1kg.2019.demo.subset.kinship_analysis.kin0</code> erhaltenen Koeffizienten fÃ¼r alle Stichprobenpaare mit dem in Abbildung 1 gezeigten Stammbaum (die gestrichelte Linie entspricht der Verwandtschaft zweiter Ordnung, es gibt jedoch keine genauen Verwandtschaftsdaten, d. H es kann Cousins, Tante / Neffe oder Onkel / Nichte geben).  Versuchen Sie, Ihre eigenen Schlussfolgerungen darÃ¼ber zu ziehen, welche Werte von Verwandtschaftskoeffizienten der Verwandtschaft erster und zweiter Ordnung entsprechen kÃ¶nnen. <br><br><div class="spoiler">  <b class="spoiler_title">Hinweis</b> <div class="spoiler_text">  Auszug aus der KING-Dokumentation: Verwandtschaftskoeffizienten&gt; 0,354 entsprechen doppelten Stichproben oder identischen Zwillingen, 0,177 bis 0,354 Verwandtschaft erster Ordnung (Eltern-Kinder, Geschwister), 0,0884 bis 0,177 Verwandtschaft zweiter Ordnung (Cousins, Tanten) / Onkel-Neffen) und von 0,0442 bis 0,0884 - bis zur Verwandtschaft dritter Ordnung (GroÃŸeltern, Enkelkinder, zweite Cousins).  Alles, was weniger als 0,0442 ist, ist schwer eindeutig zu interpretieren. <br></div></div><br><br><h2>  Die erste Aufgabe des Wettbewerbs </h2><br>  <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> anhand eines Testdatensatzes von 12 Stichproben <code>Data/Test/CEI.1kg.2019.test.vcf.gz</code> ihren Stammbaum, der sich an den Ergebnissen der Geschlechtsbestimmung und der Verwandtschaftsanalyse orientiert.  Proben, die nach den Ergebnissen der Analyse nicht mit jemandem verwandt sind, sollten in der NÃ¤he notiert werden, ohne sie mit einer Linie mit anderen Proben zu verbinden.  Der Stammbaum kann in einem Ã¤hnlichen Stil wie in Abbildung 1 verfasst werden, dies bleibt jedoch Ihrem Ermessen Ã¼berlassen.  MÃ¤nner sind durch ein Quadrat gekennzeichnet, Frauen durch einen Kreis, die Ehe durch eine horizontale Linie, ein Kind durch eine vertikale Linie, mehrere Kinder durch eine horizontale Verzweigung einer vertikalen Linie (in Form des Buchstabens P).  Lesen Sie hier mehr Ã¼ber diese Bezeichnungen. <br><br>  Wie wir oben geschrieben haben, kÃ¶nnen Verwandtschaftskoeffizienten die Verwandtschaft der einen oder anderen Ordnung nicht eindeutig charakterisieren: Beim Vergleich der Paare Eltern-Kind und Bruder-Schwester (Verwandtschaft erster Ordnung) werden dieselben Verwandtschaftskoeffizienten erhalten.  Wenn es nicht mÃ¶glich ist, die Art der Beziehung festzustellen, geben Sie eine der mÃ¶glichen an.  Bitte beachten Sie, dass die Proben im Testdatensatz andere Bezeichner aufweisen als im Trainingsdatensatz. <br><br>  Die Antworten <a href="">sollten</a> bis zum 26. Dezember um 23:59 Uhr an <a href="">wgs@atlas.ru gesendet werden</a> .  Zwei weitere Aufgaben werden in KÃ¼rze verÃ¶ffentlicht, und die endgÃ¼ltigen Ergebnisse fÃ¼r die Aufgaben werden am 28. Dezember verÃ¶ffentlicht.  Der Gewinner erhÃ¤lt den vollstÃ¤ndigen Genomtest und die PlÃ¤tze zwei und drei erhalten den Atlas-Gentest.  Es wird auch Sonderpreise von <a href="https://cloud.yandex.ru/">Yandex.Cloud geben</a> .  Ehemalige und aktuelle Mitarbeiter von Atlas nehmen nicht am Wettbewerb teil;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de480954/">https://habr.com/ru/post/de480954/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de480940/index.html">FÃ¼hren Sie einen browserÃ¼bergreifenden UI-Test mit Cucumber und Selenoid in Gitlab CI mit Allure-Bericht aus</a></li>
<li><a href="../de480944/index.html">Top 5 Trends im E-Mail-Marketing im Jahr 2020</a></li>
<li><a href="../de480946/index.html">Protokolle in Kubernetes (und nicht nur) heute: Erwartungen und RealitÃ¤t</a></li>
<li><a href="../de480948/index.html">Mitap Marketing und PR in Ivanovo</a></li>
<li><a href="../de480950/index.html">Analyse des Android-Quiz vom Stand hh.ru auf der Mobius 2019 in Moskau</a></li>
<li><a href="../de480956/index.html">Wie ich einen Weg gefunden habe, alle Citimobil-Fahrer zu verfolgen</a></li>
<li><a href="../de480958/index.html">Satellitenverbindung. Ãœbersicht der Betreiberfirmen und ein bisschen Ã¼ber das Rating</a></li>
<li><a href="../de480960/index.html">Finden Sie verlorene Dateien in mehreren Xcode-Zielen</a></li>
<li><a href="../de480962/index.html">Entwicklung des C-Compilers fÃ¼r den neuen Multiclet-Neuroprozessor</a></li>
<li><a href="../de480964/index.html">Was ist die Fresnel-Zone und CCQ (Client Connection Quality) oder die grundlegenden Faktoren fÃ¼r eine hochwertige drahtlose BrÃ¼cke</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>