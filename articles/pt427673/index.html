<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìß üî∞ üï¢ Aprendizado de m√°quina @ booking.com üßóüèª üçß ‚õΩÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O aprendizado de m√°quina permite tornar o servi√ßo muito mais conveniente para os usu√°rios. N√£o √© t√£o dif√≠cil come√ßar a implementar recomenda√ß√µes; os p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizado de m√°quina @ booking.com</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/427673/"> O aprendizado de m√°quina permite tornar o servi√ßo muito mais conveniente para os usu√°rios.  N√£o √© t√£o dif√≠cil come√ßar a implementar recomenda√ß√µes; os primeiros resultados podem ser obtidos mesmo sem uma infraestrutura estabelecida; o principal √© come√ßar.  E s√≥ ent√£o para construir um sistema em grande escala.  Foi assim que tudo come√ßou na Booking.com.  E o que resultou, quais abordagens est√£o sendo usadas agora, como os modelos est√£o sendo introduzidos na produ√ß√£o e quais monitorar, afirmou Viktor Bilyk ao HighLoad ++ Siberia.  Poss√≠veis erros e problemas n√£o foram deixados para tr√°s no relat√≥rio, ajudar√° algu√©m a contornar o raso e algu√©m ter√° novas id√©ias. <br><br><img src="https://habrastorage.org/webt/xi/se/oi/xiseoiionccibwqnt5plovk4qza.jpeg"><br><br>  <strong>Sobre o palestrante:</strong> Victor Bilyk introduz produtos de aprendizado de m√°quina em opera√ß√£o comercial na Booking.com. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8IskcexLLpI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Primeiro, vamos ver onde a Booking.com usa o aprendizado de m√°quina em quais produtos. <br><img src="https://habrastorage.org/webt/ka/6t/3y/ka6t3y4chljglcr3ijjzszcxhgm.jpeg"><br><br>  Em primeiro lugar, esse √© um grande n√∫mero de sistemas de recomenda√ß√£o para hot√©is, destinos, datas e em diferentes pontos do funil de vendas e em diferentes contextos.  Por exemplo, estamos tentando adivinhar para onde voc√™ vai quando n√£o inseriu nada na linha de pesquisa. <br><br><img src="https://habrastorage.org/webt/lo/em/bh/loembheuhe8qp-vhv_jntors2je.jpeg"><br><br>  Esta √© uma captura de tela na minha conta e definitivamente visitarei duas dessas √°reas este ano. <br><br><img src="https://habrastorage.org/webt/ab/zc/go/abzcgoqypaywtxwzygsoxo4njrc.jpeg"><br><br>  Processamos quase todas as mensagens de texto dos clientes, desde filtros de spam banais a produtos sofisticados, como o Assistant e o ChatToBook, que usam modelos para determinar inten√ß√µes e reconhecer entidades.  Al√©m disso, existem modelos que n√£o s√£o t√£o percept√≠veis, por exemplo, detec√ß√£o de fraude. <br><br>  Analisamos cr√≠ticas.  Modelos nos dizem por que as pessoas v√£o, digamos, para Berlim. <br><img src="https://habrastorage.org/webt/xn/sv/9e/xnsv9escc-iqeayrkec7ekop_n4.jpeg"><br><br>  Com a ajuda de modelos de aprendizado de m√°quina, √© analisado por que o hotel √© elogiado para que voc√™ n√£o precise ler milhares de coment√°rios. <br><img src="https://habrastorage.org/webt/u6/qi/4y/u6qi4yc7gz7vgiqk0ekkxa72a_i.jpeg"><br><br>  Em alguns lugares da nossa interface, quase todas as pe√ßas est√£o vinculadas √†s previs√µes de alguns modelos.  Por exemplo, aqui estamos tentando prever quando o hotel estar√° esgotado. <br><img src="https://habrastorage.org/webt/7f/yy/kv/7fyykvfv6k6h7unwgh2unlvgzdq.jpeg"><br><br>  Muitas vezes, achamos que estamos certos - ap√≥s 19 horas, o √∫ltimo quarto j√° est√° reservado. <br><img src="https://habrastorage.org/webt/41/wy/bp/41wybpl2pkhjpcidi6yv-geyvpy.jpeg"><br><br>  Ou, por exemplo, - o emblema "Oferta favor√°vel".  Aqui estamos tentando formalizar o subjetivo: o que √© uma oferta t√£o vantajosa.  Como entender que os pre√ßos estabelecidos pelo hotel para essas datas s√£o bons?  Afinal, isso, al√©m do pre√ßo, depende de muitos fatores, como servi√ßos adicionais e, muitas vezes, at√© de motivos externos, se, por exemplo, a Copa do Mundo ou uma grande confer√™ncia t√©cnica estiver sendo realizada nesta cidade agora. <br><br><h2>  In√≠cio da implementa√ß√£o <br></h2><br>  Vamos retroceder alguns anos atr√°s, em 2015.  Alguns dos produtos sobre os quais falei j√° existem.  Al√©m disso, o sistema sobre o qual falarei hoje ainda n√£o √©.  Como a implementa√ß√£o ocorreu naquela √©poca?  Francamente, as coisas n√£o eram muito.  O fato √© que tivemos um enorme problema, parte do qual √© t√©cnico e parte √© organizacional. <br><img src="https://habrastorage.org/webt/05/om/8s/05om8smme1rfenwrzl_ue7rwwh4.jpeg"><br><br>  Enviamos cientistas de dados a equipes multifuncionais existentes que trabalham em um problema espec√≠fico do usu√°rio e esperavam que eles melhorassem o produto de alguma forma. <br><br>  Na maioria das vezes, essas pe√ßas do produto foram constru√≠das na pilha Perl.  H√° um problema √≥bvio com o Perl - ele n√£o foi projetado para computa√ß√£o intensiva e nosso back-end j√° est√° carregado com outras coisas.  Al√©m disso, o desenvolvimento de sistemas s√©rios que resolveriam esse problema n√£o poderia ser priorizado dentro da equipe, porque o foco da equipe √© resolver um problema do usu√°rio e n√£o resolver um problema do usu√°rio usando o aprendizado de m√°quina.  Portanto, o Product Owner (PO) seria muito contr√°rio a isso. <br><br>  Vamos ver como aconteceu ent√£o. <br><br>  Havia apenas duas op√ß√µes - eu sei disso com certeza, porque naquela √©poca eu estava apenas trabalhando em uma equipe e ajudou os Cientistas de Dados a trazer seus primeiros modelos para a batalha. <br><br>  A primeira op√ß√£o foi a <strong>materializa√ß√£o de previs√µes</strong> .  Suponha que exista um modelo muito simples com apenas dois recursos: <br><br><ol><li>  pa√≠s onde o visitante est√° localizado; </li><li>  a cidade em que ele est√° procurando um hotel. </li></ol><br>  Precisamos prever a probabilidade de algum evento.  Acabamos de explodir todos os vetores de entrada: digamos, 100.000 cidades, 200 pa√≠ses - um total de 20 milh√µes de linhas no MySQL.  Parece uma op√ß√£o totalmente funcional para gerar alguns pequenos sistemas de classifica√ß√£o ou outros modelos simples para produ√ß√£o. <br><img src="https://habrastorage.org/webt/vh/jq/y0/vhjqy0gxsyydgrnirucbg4kpiva.jpeg"><br><br>  Outra op√ß√£o √© <strong>incorporar as previs√µes diretamente no c√≥digo de back-end</strong> .  Existem grandes limita√ß√µes - centenas, talvez milhares de coeficientes - √© tudo o que podemos pagar. <br><img src="https://habrastorage.org/webt/oa/sm/qn/oasmqn17bfvbsfjxla2qcidhgds.jpeg"><br><br>  Obviamente, nem uma nem a outra maneira permite que voc√™ exiba pelo menos algum tipo de modelo complexo na produ√ß√£o.  Isso limitou o datacenter e os sucessos que eles poderiam alcan√ßar melhorando os produtos.  Obviamente, esse problema teve que ser resolvido de alguma forma. <br><br><h3>  Servi√ßo de Previs√£o <br></h3><br>  A primeira coisa que fizemos foi um servi√ßo de previs√£o.  Provavelmente, a arquitetura mais simples j√° mostrada no Habr√© e no HighLoad ++ √© menor. <br><img src="https://habrastorage.org/webt/my/xw/jx/myxwjxsaotaglrxaq7obr2klmtc.jpeg"><br><br>  Escrevemos um pequeno aplicativo no Scala + Akka + Spray que simplesmente pegava os vetores recebidos e retornava a previs√£o.  Na verdade, sou um pouco astuto - o sistema era um pouco mais complicado, porque precis√°vamos de alguma forma monitorar e implement√°-lo.  Na realidade, tudo parecia assim: <br><img src="https://habrastorage.org/webt/jc/mi/o9/jcmio9itnh23j0xsjwm0--_mmkc.jpeg"><br><br>  A Booking.com possui um sistema de eventos - algo como uma revista para todos os sistemas.  √â muito f√°cil escrever l√°, e esse fluxo √© muito simples de redirecionar.  Inicialmente, precisamos enviar a telemetria do cliente para o Graphite e o Grafana com lat√™ncias percebidas e informa√ß√µes detalhadas do lado do servidor. <br><img src="https://habrastorage.org/webt/r1/9x/kf/r19xkf9zdmzalcslvhxamaxj9qk.jpeg"><br><br>  Criamos bibliotecas de cliente simples para o Perl - ocultamos o RPC inteiro em uma chamada local, colocamos v√°rios modelos l√° e o servi√ßo come√ßou a decolar.  Vender esse produto foi bastante simples, porque tivemos a oportunidade <strong>de apresentar modelos mais complexos e gastar muito menos tempo</strong> . <br><img src="https://habrastorage.org/webt/g9/b-/xd/g9b-xdm7jzfyeysocelckin2rdc.jpeg"><br><br>  Os cientistas de dados come√ßaram a trabalhar com muito menos restri√ß√µes e, em alguns casos, o trabalho dos back -ders se reduziu a uma √∫nica linha. <br><br><h3>  Previs√µes do produto <br></h3><br>  Mas vamos voltar brevemente √† forma como usamos essas previs√µes no produto. <br><br>  Existe um modelo que faz previs√µes com base em fatos conhecidos.  Com base nessa previs√£o, estamos alterando a interface do usu√°rio.  Obviamente, esse n√£o √© o √∫nico cen√°rio para o uso de aprendizado de m√°quina em nossa empresa, mas √© bastante comum. <br><br>  <strong>Qual √© o problema de iniciar esses recursos?</strong>  O fato √© que essas s√£o duas coisas em uma garrafa: um modelo e uma altera√ß√£o na interface do usu√°rio.  √â muito dif√≠cil separar os efeitos de ambos. <br><br>  Imagine lan√ßar o selo "Oferta favor√°vel" como parte de um experimento da AB.  Se n√£o decolar - n√£o h√° altera√ß√µes estatisticamente significativas nas m√©tricas de destino - n√£o se sabe qual √© o problema: um distintivo incompreens√≠vel, pequeno e discreto ou um modelo ruim. <br><br>  Al√©m disso, os modelos podem se degradar, e pode haver muitas raz√µes para isso.  O que funcionou ontem n√£o necessariamente funciona hoje.  Al√©m disso, estamos constantemente no modo de partida a frio, conectando constantemente novas cidades e hot√©is, pessoas de novas cidades v√™m at√© n√≥s.  De alguma forma, precisamos entender que o modelo ainda generaliza bem nessas partes do espa√ßo de entrada. <br><img src="https://habrastorage.org/webt/np/rc/91/nprc91mvpwisjodjjq2ri2eueps.jpeg"><br><br>  O caso provavelmente mais recentemente conhecido de degrada√ß√£o de modelo foi a hist√≥ria de Alex.  Provavelmente, como resultado da reciclagem, ela come√ßou a entender ru√≠dos aleat√≥rios, como um pedido de rir, e come√ßou a rir √† noite, assustando os propriet√°rios. <br><br><h3>  Monitoramento de Previs√£o <br></h3><br>  Para monitorar as previs√µes, modificamos levemente nosso sistema (diagrama abaixo).  Da mesma forma, no sistema de eventos, redirecionamos o fluxo para o Hadoop e come√ßamos a salvar, al√©m de tudo o que salvamos anteriormente, todos os vetores de entrada e todas as previs√µes feitas pelo nosso sistema.  Em seguida, usando Oozie, os agregamos no MySQL e, a partir da√≠, mostramos a eles um pequeno aplicativo da web para aqueles que est√£o interessados ‚Äã‚Äãem algum tipo de caracter√≠stica qualitativa dos modelos. <br><img src="https://habrastorage.org/webt/nw/jj/3i/nwjj3iu-btqmjbx1ajvbsgik2hg.jpeg"><br><br>  No entanto, √© importante descobrir o que mostrar l√°.  O fato √© que, no nosso caso, √© muito dif√≠cil calcular as m√©tricas usuais usadas no treinamento de modelos, porque geralmente temos um grande atraso nos r√≥tulos. <br><br>  Considere isso como um exemplo.  Queremos prever se o usu√°rio est√° saindo de f√©rias sozinho ou com a fam√≠lia.  Precisamos dessa previs√£o quando uma pessoa escolhe um hotel, mas s√≥ podemos descobrir a verdade em um ano.  Depois de sair de f√©rias, o usu√°rio receber√° um convite para deixar um coment√°rio, onde, entre outras coisas, haver√° uma pergunta se ele estava l√° sozinho ou com sua fam√≠lia. <br><br>  Ou seja, voc√™ precisa armazenar em algum lugar todas as previs√µes feitas ao longo do ano e ainda assim, para encontrar rapidamente correspond√™ncias com os r√≥tulos recebidos.  Parecia um investimento muito s√©rio, talvez at√© pesado.  Portanto, at√© resolvermos esse problema, decidimos fazer algo mais simples. <br><br>  Esse "mais simples" acabou sendo apenas um <strong>histograma de previs√µes</strong> feitas pelo modelo. <br><img src="https://habrastorage.org/webt/k4/gu/gm/k4gugmskee9ve0ewmw2qldlcopg.jpeg"><br><br>  Acima no gr√°fico, h√° uma regress√£o log√≠stica que prev√™ se o usu√°rio alterar√° ou n√£o a data de sua viagem.  Pode-se ver que ele divide os usu√°rios em duas classes: √† esquerda, o morro √© aquele que n√£o faz isso;  a colina √† direita √© quem faz. <br><img src="https://habrastorage.org/webt/fy/ac/dk/fyacdkdo2pmlpmbmnmelkm3zx8w.jpeg"><br><br>  De fato, mostramos at√© dois gr√°ficos: um para o per√≠odo atual e outro para o per√≠odo anterior.  V√™-se claramente que nesta semana (este √© um gr√°fico semanal) o modelo prev√™ uma mudan√ßa de datas com um pouco mais de frequ√™ncia.  √â dif√≠cil dizer com certeza se √© a sazonalidade ou a mesma degrada√ß√£o ao longo do tempo. <br><br>  Isso levou a uma mudan√ßa no trabalho dos datacientes, que deixaram de envolver outras pessoas e come√ßaram a iterar seus modelos mais rapidamente.  Eles enviaram modelos para produ√ß√£o em funcionamento a seco, juntamente com os engenheiros de back-end.  Ou seja, os vetores foram coletados, o modelo fez uma previs√£o, mas essas previs√µes n√£o foram usadas de forma alguma. <br><br>  No caso de um crach√°, simplesmente n√£o mostramos nada, como antes, mas coletamos estat√≠sticas.  Isso nos permitiu n√£o perder tempo com projetos com falha antecipadamente.  Liberamos tempo para o front-end e designers para outros experimentos.  <strong>Desde que o datacenter n√£o tenha certeza de que o modelo funciona da maneira que deseja, ele simplesmente n√£o envolve outras pessoas nesse processo.</strong> <br><br>  √â interessante ver como os gr√°ficos mudam em diferentes se√ß√µes. <br><img src="https://habrastorage.org/webt/kb/z_/oy/kbz_oyrod8128_uwtafqsjoym_m.jpeg"><br><br>  √Ä esquerda, a probabilidade de alterar as datas na √°rea de trabalho, √† direita, nos tablets.  √â claramente visto que nos tablets o modelo prev√™ uma mudan√ßa de datas mais prov√°vel.  Isso provavelmente ocorre devido ao fato de o tablet ser usado com frequ√™ncia no planejamento de viagens e com menos frequ√™ncia nas reservas. <br><br>  Tamb√©m √© interessante ver como esses gr√°ficos mudam √† medida que os usu√°rios se movem pelo funil de vendas. <br><img src="https://habrastorage.org/webt/oi/ck/zi/oickzi_2tyz5vm8qyf4uk3g-dlw.jpeg"><br><br>  √Ä esquerda, a probabilidade de alterar as datas na p√°gina de pesquisa, √† direita, na primeira p√°gina de reserva.  Pode-se observar que um n√∫mero muito maior de pessoas que j√° decidiram suas datas acessam a p√°gina de reservas. <br><br>  Mas esses eram bons gr√°ficos.  Como s√£o os maus?  De maneiras muito diferentes.  √Äs vezes √© apenas barulho, √†s vezes √© uma colina enorme, o que significa que o modelo n√£o pode separar efetivamente duas classes de previs√µes. <br><img src="https://habrastorage.org/webt/uv/c4/zo/uvc4zocpgcdejqtebbpzzvgibws.jpeg"><br><br>  √Äs vezes, esses s√£o enormes picos. <br><img src="https://habrastorage.org/webt/gv/l1/y3/gvl1y36_ui-ut8wbo9ncdhciksg.jpeg"><br><br>  Essa tamb√©m √© uma regress√£o log√≠stica e, at√© certo ponto, mostrou uma bela foto com duas colinas, mas uma manh√£ ficou assim. <br><br>  Para entender o que aconteceu l√° dentro, voc√™ precisa entender como a regress√£o log√≠stica √© calculada. <br><br><h4>  Refer√™ncia r√°pida <br></h4><br><img src="https://habrastorage.org/webt/-f/op/w2/-fopw2q3tayu8rhnyg_pp5z4yms.jpeg"><br><br>  Essa √© uma fun√ß√£o log√≠stica do produto escalar, em que x <sub>n</sub> s√£o alguns recursos.  Uma dessas caracter√≠sticas era o pre√ßo de uma noite em um hotel (em euros). <br><img src="https://habrastorage.org/webt/sb/mw/6o/sbmw6ocz3ts8f-fdjawob2ve3zk.jpeg"><br><br>  Chamar esse modelo seria algo assim: <br><img src="https://habrastorage.org/webt/cf/so/m1/cfsom1foagpoo152nli4z31aqmo.jpeg"><br><br>  Preste aten√ß√£o na sele√ß√£o.  Era necess√°rio converter o pre√ßo em euros, mas o desenvolvedor esqueceu de faz√™-lo. <br><img src="https://habrastorage.org/webt/sz/5x/my/sz5xmybzwpcutqsc1xrj9vczaei.jpeg"><br><br>  Moedas como r√∫pias ou rublos aumentaram o produto escalar muitas vezes e, portanto, for√ßaram esse modelo a produzir um valor pr√≥ximo √† unidade, com muito mais frequ√™ncia, que vemos no gr√°fico. <br><br><h4>  Valores limite <br></h4><br>  Outra caracter√≠stica √∫til desses histogramas foi a possibilidade de uma escolha consciente e ideal dos valores-limite. <br><img src="https://habrastorage.org/webt/0p/j-/lj/0pj-ljv2emwsf_7wu8bttcdb-e8.jpeg"><br><br>  Se voc√™ colocar a bola na colina mais alta deste histograma, empurre-a e imagine onde ela ir√° parar, este ser√° o ponto ideal para a separa√ß√£o de classes.  Tudo √† direita √© uma classe, tudo √† esquerda √© outra. <br><br>  No entanto, se voc√™ come√ßar a mover esse ponto, poder√° obter efeitos muito interessantes.  Suponha que desejemos executar um experimento que, se o modelo disser sim, de alguma forma altere a interface do usu√°rio.  Se voc√™ mover esse ponto para a direita, o p√∫blico de nosso experimento ser√° reduzido.  Afinal, o n√∫mero de pessoas que receberam essa previs√£o √© a √°rea abaixo da curva.  No entanto, na pr√°tica, a precis√£o das previs√µes √© muito maior.  Da mesma forma, se n√£o houver energia est√°tica suficiente, voc√™ poder√° aumentar o p√∫blico do seu experimento, mas diminuir a precis√£o das previs√µes. <br><br>  Al√©m das pr√≥prias previs√µes, come√ßamos a monitorar os valores de entrada nos vetores. <br><br><h4>  Uma codifica√ß√£o quente <br></h4><br>  A maioria dos recursos em nossos modelos mais simples √© categ√≥rica.  Isso significa que n√£o s√£o n√∫meros, mas certas categorias: a cidade da qual o usu√°rio √© ou a cidade em que ele est√° procurando um hotel.  Usamos One Hot Encoding e transformamos cada um dos valores poss√≠veis em uma unidade em um vetor bin√°rio.  Como no in√≠cio usamos apenas nosso pr√≥prio n√∫cleo de computa√ß√£o, foi f√°cil identificar situa√ß√µes em que n√£o h√° lugar para a categoria de entrada no vetor de entrada, ou seja, o modelo n√£o viu esses dados durante o treinamento. <br><img src="https://habrastorage.org/webt/xf/9t/w4/xf9tw4lzt0qbikwpfzeenzjjpie.jpeg"><br><br>  √â assim que geralmente se parece. <br><img src="https://habrastorage.org/webt/hb/ih/0n/hbih0nrx9t3xlnl2coxoot3ek7a.jpeg"><br><br>  destination_id - a cidade em que o usu√°rio est√° procurando um hotel.  Naturalmente, o modelo n√£o obteve cerca de 5% dos valores, pois estamos constantemente conectando novas cidades.  visitor_cty_id = 23.32%, porque os datacientistas √†s vezes omitem conscientemente cidades menos comuns. <br><br>  Em um caso ruim, pode ser assim: <br><img src="https://habrastorage.org/webt/mq/14/ak/mq14akuux2wuwsqqyif_02e8j-e.jpeg"><br><br>  Imediatamente 3 propriedades, 100% dos valores que o modelo nunca viu.  Na maioria das vezes, isso ocorre devido ao uso de formatos diferentes dos usados ‚Äã‚Äãno treinamento ou simplesmente erros banais. <br><br>  Agora, com a ajuda dos pain√©is, detectamos e corrigimos essas situa√ß√µes muito rapidamente. <br><br><h2>  Vitrine de aprendizado de m√°quina <br></h2><br>  Vamos falar sobre outros problemas que resolvemos.  Depois que criamos as bibliotecas e o monitoramento do cliente, o servi√ßo come√ßou a ganhar impulso muito rapidamente.  Ficamos literalmente impressionados com aplicativos de diferentes partes da empresa: ‚ÄúVamos conectar esse modelo tamb√©m!  Vamos atualizar o antigo!  Acabamos de costurar, de fato, qualquer novo desenvolvimento parou. <br><br>  Sa√≠mos da situa√ß√£o criando <strong>um quiosque de autoatendimento para cientistas de dados</strong> .  Agora voc√™ pode simplesmente acessar nosso portal, o mesmo que usamos inicialmente apenas para o monitoramento e, literalmente, clicando no bot√£o para carregar o modelo em produ√ß√£o.  Em alguns minutos, ela trabalhar√° e far√° previs√µes. <br><br>  Havia mais um problema. <br><img src="https://habrastorage.org/webt/mw/rp/l-/mwrpl-evpqktnfdk9l61shicboc.jpeg"><br><br>  A Booking.com possui aproximadamente 200 equipes de TI.  Como deixar a equipe saber em alguma parte completamente diferente da empresa que existe um modelo que poderia ajud√°-los?  Voc√™ pode simplesmente n√£o saber que essa equipe existe.  Como descobrir quais modelos existem e como us√°-los?  Tradicionalmente, as comunica√ß√µes externas em nossas equipes est√£o envolvidas no PO (Product Owner).  Isso n√£o significa que n√£o temos outras conex√µes horizontais, apenas o PO faz isso mais do que outros.  Mas √© √≥bvio que, nessa escala, a comunica√ß√£o individual n√£o √© dimensionada.  Voc√™ precisa fazer algo sobre isso. <br><br>  <strong>Como a comunica√ß√£o pode ser facilitada?</strong> <br><br>  De repente, percebemos que o portal, que criamos exclusivamente para monitoramento, est√° gradualmente come√ßando a se transformar em uma vitrine de aprendizado de m√°quina em nossa empresa. <br><img src="https://habrastorage.org/webt/p_/r8/ps/p_r8pst3fhoza0zyb-b5lercws8.jpeg"><br><br>  Permitimos que os datacientistas descrevessem seus modelos em detalhes.  Quando havia muitos modelos, adicionamos r√≥tulos de t√≥pico e √°rea para agrupamento conveniente. <br><img src="https://habrastorage.org/webt/54/d5/ft/54d5ftteqrf-siyozzgllalvuly.jpeg"><br><br>  Vinculamos nossa ferramenta ao ExperimentTool.  Este √© um produto dentro de nossa empresa que fornece experimentos A / B e armazena todo o hist√≥rico de experimentos. <br><img src="https://habrastorage.org/webt/kh/bp/e2/khbpe2ifrcjlhkpaf9ihq-_3m0e.jpeg"><br><br>  Agora, junto com a descri√ß√£o do modelo, voc√™ tamb√©m pode ver o que outras equipes fizeram com esse modelo antes e com que √™xito.  Isso mudou tudo. <br><br>  S√©rio, isso mudou a maneira como a TI funciona, porque mesmo em situa√ß√µes em que n√£o h√° cientista de dados na equipe, voc√™ pode usar o aprendizado de m√°quina. <br><img src="https://habrastorage.org/webt/kf/4n/pn/kf4npnnbrtj1vh_1080whzeewbk.jpeg"><br><br>  Por exemplo, muitas equipes usam isso durante as sess√µes de brainstorming.  Quando apresentam novas id√©ias de produtos, simplesmente selecionam os modelos que mais lhes agradam e os utilizam.  Nada complicado √© necess√°rio para isso. <br><br>  <strong>O que derramou para n√≥s?</strong>  No momento, no pico, entregamos cerca de 200 mil previs√µes por segundo, com lat√™ncia menor que 20 a 30 ms, incluindo ida e volta HTTP e o posicionamento de mais de 200 modelos. <br><br>  Pode parecer que foi uma caminhada t√£o f√°cil no parque: fizemos um trabalho maravilhoso, tudo funciona, todo mundo est√° feliz! <br><img src="https://habrastorage.org/webt/do/-q/mg/do-qmg7z1boovf5kyag7ngbr2wy.jpeg"><br><br>  Isso, √© claro, n√£o acontece.  Houve erros.  No come√ßo, por exemplo, plantamos uma pequena bomba-rel√≥gio.  Por alguma raz√£o, assumimos que a maioria dos nossos modelos ser√° um sistema de recomenda√ß√£o com vetores de entrada pesados, e a pilha Scala + Akka foi escolhida precisamente porque √© muito f√°cil organizar c√°lculos paralelos com sua ajuda.  Mas, na realidade, a sobrecarga para toda essa paraleliza√ß√£o, para se reunir, acabou sendo maior que o ganho poss√≠vel.  Em algum momento, nossas 100 m√°quinas processaram apenas 100.000 RPS e ocorreram falhas com sintomas bastante caracter√≠sticos: a utiliza√ß√£o da CPU √© baixa, mas os tempos limite s√£o obtidos. <br><img src="https://habrastorage.org/webt/ms/so/zz/mssozzq2glmsbn5o-g5au7dqjaa.jpeg"><br><br>  Em seguida, retornamos ao nosso n√∫cleo de computa√ß√£o, revisamos, fizemos benchmarks e, como resultado do teste de capacidade, aprendemos que, para o mesmo tr√°fego, precisamos de apenas 4 m√°quinas. ,    ,      -,       , ,   ,      100 000 RPS  4 . <br><br>    -  ,        ,        .  -       ,      ,    ,    . <br><br>   ‚Äî    ,           .  ,    ID ,     .    ,    0. <br><img src="https://habrastorage.org/webt/cq/0b/6w/cq0b6wonigy8ltd8_jwilv7j62k.jpeg"><br><br>   ‚Äî    ,   ‚Äî     . <br><img src="https://habrastorage.org/webt/v-/qb/-u/v-qb-uqcn4kn09heh1z03rycgfm.jpeg"><br><br>   ,        .       ,    .    ,        ‚Äî      ,   .  , ,  ,       - . <br><br>     ,           ‚Äî  ID .        ‚Äî 49-51%.      ,     .     ,     ,    .     ,     . <br><br><h2>  Planos futuros <br></h2><br><ul><li> Label based metrics <br></li></ul><br>     -           ,     .   Label based metrics,   precision  recall   . <br><br><ul><li> More tools &amp; integrations <br></li></ul><br>        ,     .     ,            Perl  Java,  ,  ,   .       Spark,        . <br><br><ul><li> Reusable training pipelines <br></li></ul><br>          . <br><br> ,   -.  ,       , ,    ,  , <strong>steaming</strong> ‚Äî    -   ,       ,   . <br><br>      .     pipeline,    ,   .       ,    ,    . <br><br><ul><li> Async models <br></li></ul><br>     .    ,  <strong>,   50 ,    </strong> .   ,            .          ,      ,   . <br><br><h3> Start small <br></h3><br><blockquote>  ,   ,         Booking.com,    ,   ,     ‚Äî   ! <br></blockquote><br>        ,  ,    MySQL. ,      ,      .    -    . B      .      ,     ,    -     ‚Äî      . <br><br><blockquote>    ,      ? <br></blockquote><br><h3> Monitor <br></h3><br>     ‚Äî      , -, . <strong> ‚Äî     </strong> .   ‚Äî   ,    .    , ,   ,  .      :  ,  . ,      ,       ,      ‚Äî ! <br><br><h3> Organization footprint <br></h3><br>   ,    .         ,     . ,                . <br><br><h3> (Don't) Follow our steps <br></h3><br>   - , , ,    . , -     ,    .   ,     .   ‚Äî     ,      ,  ?  ,  ,     ,    ? <br><br> <strong>, ,   !</strong> <br><br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HighLoad++ 2018,</a>   8  9   ,  <strong>135 </strong> ,      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> <strong>9  -  </strong> .    ,      . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427673/">https://habr.com/ru/post/pt427673/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427661/index.html">Sportiduino - sistema de marca√ß√£o eletr√¥nica para eventos esportivos, parte 3</a></li>
<li><a href="../pt427663/index.html">Ursos e caranguejo de Habro</a></li>
<li><a href="../pt427665/index.html">As melhores escalas inteligentes (de acordo com Wareable)</a></li>
<li><a href="../pt427669/index.html">KNX Home Control: Ilumina√ß√£o</a></li>
<li><a href="../pt427671/index.html">Sberbank e Yandex lan√ßaram oficialmente a plataforma de negocia√ß√£o Beru, a vers√£o russa da Amazon</a></li>
<li><a href="../pt427675/index.html">Pap√©is, por favor. Como uma rede neural nos ajuda a verificar clientes e capturar golpistas</a></li>
<li><a href="../pt427679/index.html">A zeragem do limite de compras com isen√ß√£o de impostos levar√° um ano e meio, se uma decis√£o for tomada</a></li>
<li><a href="../pt427681/index.html">Arraste e deslize o dedo no RecyclerView. Parte 1: ItemTouchHelper</a></li>
<li><a href="../pt427683/index.html">Por que portar sobre o excesso de n√∫mero inteiro n√£o √© uma boa ideia</a></li>
<li><a href="../pt427685/index.html">FSB contra Internet via sat√©lite de operadores estrangeiros</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>