<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🏭 👩🏼‍🤝‍👨🏽 👩‍👩‍👧 Fotos als Geiseln genommen. Das erste Hacken von Digitalkameras über WLAN (PTP / IP-Protokoll) 🏆 🚣 👩🏾‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heutzutage ist kein Gerät mit einer Netzwerkverbindung vor potenziellem Hacking geschützt. Sogar die Kamera. 

 Auf der Hackerkonferenz DEF CON 2019 z...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fotos als Geiseln genommen. Das erste Hacken von Digitalkameras über WLAN (PTP / IP-Protokoll)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/globalsign/blog/463881/"><img src="https://habrastorage.org/webt/35/42/ki/3542ki7dwdyany7aladhibjshks.jpeg"><br><br>  Heutzutage ist kein Gerät mit einer Netzwerkverbindung vor potenziellem Hacking geschützt.  Sogar die Kamera. <br><br>  Auf der Hackerkonferenz DEF CON 2019 zeigte Eyal Itkin von Check Point Software Technologies <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den</a> weltweit ersten aktiven Exploit für das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PTP-</a> Protokoll (Picture Transfer Protocol).  Viele moderne DSLRs unterstützen die Dateiübertragung über WLAN.  In diesem Fall wird ein böswilliger WLAN-Zugangspunkt beschrieben, mit dem die umgebenden Kameras automatisch verbunden werden. <br><br>  Der Exploit funktioniert auch, wenn die Kamera über PTP / USB physisch mit dem Computer verbunden ist.  In beiden Fällen kann ein Angreifer eine Verbindung zur Kamera herstellen und ausführbaren Code darauf laden.  Zum Beispiel, um alle Bilder auf einer Karte zu verschlüsseln. <br><a name="habracut"></a><br>  Beispielsweise hat Check Point Eyal Itkin eine Demoversion einer Ransomware-Malware, die Dateien auf einer Flash-Karte verschlüsselt, auf die Canon EOS 80D-Kamera hochgeladen.  Itkin schlägt vor, dass dies ein sehr reales Modell der Monetarisierung ist: Oft werden dort Fotos von wichtigen Lebensereignissen gespeichert, sodass die Leute zahlen möchten, um sie zurückzubekommen. <br><br><img src="https://habrastorage.org/webt/mh/3q/yh/mh3qyhlmtn5mlgygcwdfdjwtaqq.jpeg"><br><br>  Neben der Ransomware sind theoretisch andere Methoden zur Exploit-Exploitation möglich: <br><br><ul><li>  Vollständige Arbeitsunfähigkeit <br></li><li>  Verwenden der Kamera für Spionage (sie macht bereits Fotos) </li></ul><br>  Sie haben sich für das Canon-Modell entschieden, weil dieser Hersteller mehr als 50% des globalen Marktes für Digitalkameras kontrolliert.  Darüber hinaus hat sich um Canon-Kameras eine umfangreiche Modding-Bewegung entwickelt.  Aktivisten entwickeln Firmware und Hardware zurück, um kostenlose Firmware mit erweiterten Funktionen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">freizugeben</a> : siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Magic Lattern</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Canon Hack Development Kit</a> (CHDK). <br><br>  Ähnliche Methoden gelten jedoch auch für andere Kameras, da alle PTP auf standardmäßige Weise unterstützen.  Und dieses Protokoll hat wichtige Eigenschaften, die das Hacken begünstigen: <br><br><ul><li>  keine Authentifizierung und Verschlüsselung (das Protokoll wurde ursprünglich unter USB erstellt, dann wurde das Vorhandensein von PTP / IP nicht angenommen); <br></li><li>  Unterstützung für Dutzende komplexer Teams mit umfangreichen Funktionen; <br></li><li>  WiFi-Unterstützung. </li></ul><br>  Im Zusammenhang mit dem Hacking hat Canon einen Patch und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Sicherheitswarnung herausgegeben</a> , in denen empfohlen wird, Vorsichtsmaßnahmen zu treffen, keine Verbindung zu verdächtigem WLAN herzustellen und Netzwerkfunktionen zu deaktivieren, wenn sie nicht verwendet werden. <br><br><h1>  Video-Demo </h1><br><iframe width="560" height="315" src="https://www.youtube.com/embed/75fVog7MKgg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Technische Details angreifen </h1><br>  Das erste, was der Hacker tat, war das Reverse Engineering und die Analyse der Kamera-Firmware.  Es stellte sich heraus, dass es von AES verschlüsselt ist, aber es gibt keinen Schlüssel.  Aber die Magic Lattern-Community hat dieses Problem bereits gelöst.  Sie benutzten ROM Dumper und bekamen Schlüssel. <br><br><img src="https://habrastorage.org/webt/os/hg/9x/oshg9xsursh5ogmbbfd_jnkctzm.jpeg"><br><br>  Der Speicherauszug wird in die IDA geladen, und Magic Lattern verfügt über eine gute Datenbank mit dokumentierten Adressen, von denen aus diese oder jene Funktion aufgerufen wird.  Canon-Kameras verwenden das proprietäre Echtzeit-Betriebssystem DryOS.  Dank ihr kann das Gerät in nur drei Sekunden neu gestartet werden. <br><br>  Hier ist eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Liste von PTP-Befehlen</a> mit Opcodes in DryOS.  Um den erforderlichen Code in der Firmware zu finden, reicht es aus, die Suche nach der entsprechenden Konstante zu starten, die in der Liste für jeden Befehl angegeben ist. <br><br>  Eine oberflächliche Analyse einiger Funktionen, die mit PTP-Befehlen arbeiten, ergab, dass sie ziemlich schwierig zu implementieren sind (148 eindeutige Handler in einer Funktion) und dass es offensichtliche Schwachstellen bei Pufferüberläufen gibt. <br><br><img src="https://habrastorage.org/webt/ye/xr/c7/yexrc7jb7ik6p8y9nd6b3qscpiy.png"><br><br>  Itkin hat beim Aufrufen von vier PTP-Befehlen (SendObjectInfo, NotifyBtStatus, BLERequest, SendHostInfo) vier Sicherheitsanfälligkeiten bezüglich Pufferüberlauf festgestellt: Sicherheitsanfälligkeitsnummern CVE-2019-5994, CVE-2019-5998, CVE-2019-5999, CVE-2019-6000).  Interessanterweise hängen zwei Sicherheitslücken mit der Bluetooth-Verarbeitung zusammen, obwohl dieses Kameramodell Bluetooth nicht unterstützt. <br><br>  Nun blieb es, einen geeigneten Exploit zu sammeln, was getan wurde.  Aber der Autor hörte hier nicht auf und entschied sich für eine visuellere Demonstration, ein Ransomware-Programm zu schreiben, das Dateien auf einer Flash-Karte verschlüsselt.  Die Idee war nicht, eine eigene Kryptografie zu implementieren, sondern <i>die in die Canon-Firmware selbst integrierten AES-Verschlüsselungsfunktionen</i> zu <i>verwenden</i> !  Auf der Suche nach kryptografischen Funktionen fand Iskin sogar die Verschlüsselungsschlüssel selbst. <br><br><img src="https://habrastorage.org/webt/up/fn/bl/upfnblzskfvfjlw3ad4-qeoffxm.png" align="left">  Aufgrund der proprietären Implementierung war es schwierig zu verstehen, wie der Schlüssel in der Firmware generiert wird.  Dieses Verständnis sei jedoch für die Verwendung kryptografischer Funktionen nicht erforderlich, sagte Itkin.  Auf Befehl der Malware verschlüsseln sie erfolgreich Fotos auf der Karte und berechnen die richtige Signatur. <br><br>  Itkin entwickelte auch eine Möglichkeit, ein schädliches Firmware-Update ohne Benutzereingriff auf der Kamera zu installieren (CVE-2019-5995). <br><br>  In einer Präsentation zu DEF CON <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sagt</a> der Autor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">,</a> dass dies der erste Exploit für das PTP-Protokoll ist und „eine zuverlässige Möglichkeit, die meisten DSLRs zu erfassen, ohne Schwachstellen auszunutzen“. <br><br><hr><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/rw/hk/1y/rwhk1y-msfqaknqu2kbktqf6g7a.jpeg"></a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/od/n-/xe/odn-xebtl8a5lexzip_kkkezr6s.jpeg"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463881/">https://habr.com/ru/post/de463881/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463871/index.html">Was sind die Arten von Scrum-Zeremonien und ihre Best Practices?</a></li>
<li><a href="../de463873/index.html">Gestorbener Nobelpreisträger Carey Mullis - Erfinder der DNA-Polymerasekettenreaktion</a></li>
<li><a href="../de463875/index.html">Intel Ice Lake. 10 nm - zu den Massen</a></li>
<li><a href="../de463877/index.html">Wir suchten nach einem Ersatz für MS Word und führten stattdessen einen neuen Dokumentenverwaltungsprozess ein</a></li>
<li><a href="../de463879/index.html">Bootcamp in Yandex: Wie kann ein Entwickler ein Team auswählen?</a></li>
<li><a href="../de463885/index.html">Problem beim Aktualisieren von MikroTik RouterOS auf Routern mit 16 MB FLASH</a></li>
<li><a href="../de463889/index.html">So erstellen Sie Anwendungen für Telefone mit Behinderungen</a></li>
<li><a href="../de463891/index.html">Künstliches Immunsystem in der Informationssicherheit</a></li>
<li><a href="../de463895/index.html">Im Regal der Kompaktprojektoren angekommen: Epson EF-100 - die erste Schwalbe einer Reihe heller tragbarer Laserprojektoren</a></li>
<li><a href="../de463897/index.html">Sicherheitsüberprüfung der MCS Cloud Platform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>