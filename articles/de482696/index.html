<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¤ ğŸ‘‹ ğŸ¤¹ VollstÃ¤ndige FestplattenverschlÃ¼sselung von Windows Linux-Systemen. VerschlÃ¼sselter Multiboot ğŸ” ğŸ‘¶ğŸ½ ğŸš®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sein eigenes Handbuch fÃ¼r die vollstÃ¤ndige FestplattenverschlÃ¼sselung in Runet V0.2 wurde aktualisiert 

 Cowboy-Strategie: 
 [A] Block SystemverschlÃ¼...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VollstÃ¤ndige FestplattenverschlÃ¼sselung von Windows Linux-Systemen. VerschlÃ¼sselter Multiboot</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482696/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/y7/04/pd/y704pdw4xfrpf8nipub8isyyzra.jpeg"></div><br>  <b>Sein eigenes Handbuch fÃ¼r die vollstÃ¤ndige FestplattenverschlÃ¼sselung in Runet V0.2 wurde aktualisiert</b> <br><br><h3>  Cowboy-Strategie: </h3><br>  [A] Block SystemverschlÃ¼sselung von Windows 7 installiertem System; <br>  [B] GNU / Linux-BlocksystemverschlÃ¼sselung <i>(Debian) des</i> installierten Systems <i>(einschlieÃŸlich / boot)</i> ; <br>  [C] GRUB2-Setup, Bootloader-Schutz durch digitale Signatur / Authentifizierung / Hashing; <br>  [D] Stripping - ZerstÃ¶rung unverschlÃ¼sselter Daten; <br>  [E] universelle Sicherung des verschlÃ¼sselten Betriebssystems; <br>  [F] attackiere &lt;auf S. [C6]&gt; target - GRUB2 bootloader; <br>  [G] nÃ¼tzliche Dokumentation. <br><br>  <b>â•­â”€â”€â”€Circuit # rooms 40 # &lt;BIOS / MBR / 1HDD ohne lvm&gt;:</b> <br>  â”œâ”€â”€â•¼ Windows 7 installiert - vollstÃ¤ndige SystemverschlÃ¼sselung, nicht verborgen; <br>  â”œâ”€â”€â•¼ GNU / Linux installiert <i>(Debian und derivative Distributionen)</i> - vollstÃ¤ndige SystemverschlÃ¼sselung nicht verborgen <i>(/, einschlieÃŸlich / boot; Swap)</i> ; <br>  â”œâ”€â”€â•¼ unabhÃ¤ngige Bootloader: VeraCrypt-Bootloader im MBR installiert, GRUB2-Bootloader in der erweiterten Partition installiert; <br>  â”œâ”€â”€â•¼ Installation / Neuinstallation des Betriebssystems ist nicht erforderlich. <br>  â””â”€â”€â•¼ verwendete kryptografische Software: VeraCrypt;  Cryptsetup;  GnuPG;  Seepferdchen  Hashdeep;  GRUB2 - kostenlos / kostenlos. <a name="habracut"></a><br><br>  Das obige Schema lÃ¶st teilweise das Problem des "Remote-Bootens auf ein Flash-Laufwerk", ermÃ¶glicht es Ihnen, ein verschlÃ¼sseltes Betriebssystem Windows / Linux zu genieÃŸen und Daten Ã¼ber den "verschlÃ¼sselten Kanal" von einem Betriebssystem zu einem anderen auszutauschen. <br><br>  <b>PC-Startreihenfolge (eine der Optionen):</b> <br><br><ul><li>  Maschine einschalten; </li><li>  Laden des VeraCrypt-Bootloaders <i>(die Eingabe des richtigen Passworts setzt das Laden von Windows 7 fort)</i> ; </li><li>  Durch DrÃ¼cken der Esc-Taste wird der GRUB2-Bootloader geladen. </li><li>  Der Bootloader GRUB2 <i>(Auswahl der Distribution / GNU / Linux / CLI)</i> erfordert die Authentifizierung des GRUB2-Superbenutzers &lt;login / password&gt;. </li><li>  Nach erfolgreicher Authentifizierung und Auswahl des Distributionskits mÃ¼ssen Sie eine Passphrase eingeben, um "/boot/initrd.img" zu entsperren. </li><li>  Nach der Eingabe fehlerfreier PasswÃ¶rter in GRUB2 muss ein Passwort "eingegeben" werden <i>(drittes, BIOS-Passwort oder GNU / Linux-Benutzerkonto-Passwort - wird nicht berÃ¼cksichtigt)</i> , um GNU / Linux OS zu entsperren und zu laden, oder es muss automatisch ein geheimer SchlÃ¼ssel <i>(zwei PasswÃ¶rter + ein SchlÃ¼ssel) ersetzt werden Passwort + SchlÃ¼ssel)</i> ; </li><li>  Ein externer Eingriff in die GRUB2-Konfiguration fÃ¼hrt zum Einfrieren des GNU / Linux-Startvorgangs. </li></ul><br>  LÃ¤stig?  Ok, lassen Sie uns die Prozesse automatisieren. <br><br>  Beim Markieren der Festplatte <i>(MBR-Tabelle) kann ein</i> PC nicht mehr als 4 Hauptpartitionen oder 3 Haupt- und eine erweiterte Partition sowie einen nicht zugewiesenen Bereich haben.  Eine erweiterte Partition kann im Gegensatz zur Hauptpartition Unterabschnitte enthalten <i>(logische Laufwerke = erweiterte Partition)</i> .  Mit anderen Worten, die "erweiterte Partition" auf der Festplatte ersetzt LVM fÃ¼r die aktuelle Aufgabe: vollstÃ¤ndige SystemverschlÃ¼sselung.  Wenn Ihre Festplatte in 4 Hauptpartitionen partitioniert ist, mÃ¼ssen Sie lvm verwenden, indem Sie entweder <i>die</i> Partition von main in extended transformieren <i>(mit Formatierung)</i> oder alle vier Partitionen mit Bedacht verwenden und alles so lassen, wie es ist, um das gewÃ¼nschte Ergebnis zu erzielen.  Selbst wenn Sie eine Partition auf der Festplatte haben, hilft Gparted dabei, die Festplatte <i>(in zusÃ¤tzliche Partitionen)</i> aufzuteilen, ohne Daten zu verlieren, jedoch mit einem geringen Preis fÃ¼r solche Aktionen. <br><br>  Das Layout des Festplattenlayouts, in dem der gesamte Artikel verbalisiert wird, ist in der folgenden Tabelle dargestellt. <br><br><img src="https://habrastorage.org/webt/jd/3k/wf/jd3kwfqr9mas6ldlmil_5qwwbg8.png"><br>  <i>Tabelle (Nr. 1) von 1Tb-Abschnitten.</i> <br><br>  Etwas Ã„hnliches sollte mit dir sein. <br>  sda1 - die Hauptpartition â„–1 NTFS <i>(verschlÃ¼sselt)</i> ; <br>  sda2 - erweiterter Markerabschnitt; <br>  sda6 - logisches Laufwerk <i>(GRUB2-Bootloader ist darauf installiert);</i> <br>  sda8 - Swap (verschlÃ¼sselte Swap-Datei / nicht immer); <br>  sda9 - logisches Laufwerk testen; <br>  sda5 - logisches Laufwerk fÃ¼r Neugierige; <br>  sda7 - GNU / Linux OS (portiertes Betriebssystem auf ein verschlÃ¼sseltes logisches Laufwerk); <br>  sda3 - Hauptabschnitt Nr. 2 mit Windows 7 <i>(verschlÃ¼sselt)</i> ; <br>  sda4 ist die Hauptpartition Nr. 3 <i>(sie enthielt unverschlÃ¼sseltes GNU / Linux; sie wird fÃ¼r Backups verwendet / nicht immer)</i> . <br><br><h2>  [A] Windows 7 Block System Encryption </h2><br><div class="spoiler">  <b class="spoiler_title">A1.</b>  <b class="spoiler_title">Veracrypt</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-q/in/7s/-qin7s3t7xacdjov7invu_8kb2y.png"><br><br>  Laden Sie die Installationsversion der VeraCrypt-Kryptografiesoftware von der <a href="https://www.veracrypt.fr/en/Downloads.html" rel="nofollow">offiziellen Website</a> oder von <i>SourceForge herunter (zum Zeitpunkt der VerÃ¶ffentlichung von Artikel v1.24-Update3 ist die portable Version von VeraCrypt nicht fÃ¼r die SystemverschlÃ¼sselung geeignet)</i> .  ÃœberprÃ¼fen Sie die PrÃ¼fsumme der heruntergeladenen Software <br><br> <code>$ Certutil -hashfile "C:\VeraCrypt Setup 1.24.exe" SHA256</code> <br> <br>  und vergleichen Sie das Ergebnis mit der auf der Website des VeraCrypt-Entwicklers verÃ¶ffentlichten CS. <br><br>  Wenn die HashTab-Software installiert ist, ist dies noch einfacher: RMB <i>(VeraCrypt Setup 1.24.exe)</i> - Hash- <i>Eigenschaften der</i> Summe der Dateien. <br><br>  Um die Signatur des Programms zu Ã¼berprÃ¼fen, mÃ¼ssen auf dem System die Software und der Ã¶ffentliche PGP-SchlÃ¼ssel des <a href="https://www.gnupg.org/download/index.html" rel="nofollow">gnuPG-</a> Entwicklers <a href="https://www.gnupg.org/download/index.html" rel="nofollow">installiert sein</a> .  <a href="https://www.gpg4win.org/get-gpg4win.html" rel="nofollow">gpg4win</a> . <br></div></div><br><div class="spoiler">  <b class="spoiler_title">A2.</b>  <b class="spoiler_title">Installation / Start der VeraCrypt Administrator Software</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/py/ih/fo/pyihfozxju5pulv79n_3mllt9km.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">A3.</b>  <b class="spoiler_title">AuswÃ¤hlen der SystemverschlÃ¼sselungsoptionen fÃ¼r die aktive Partition</b> <div class="spoiler_text">  VeraCrypt - System - VerschlÃ¼sseln der Systempartition / Festplatte - Normal - VerschlÃ¼sseln der Windows-Systempartition - Multiboot - <i>(Warnung: "Unerfahrenen Benutzern wird diese Methode nicht empfohlen. Wir stimmen dem zu" Ja ")</i> - Bootdiskette <i>(" Ja ", auch wenn ohnehin nicht "ja")</i> - Anzahl der Systemfestplatten "2 oder mehr" - Mehrere Systeme auf einer Festplatte "ja" - Nicht Windows-Bootloader "nein" <i>(aber tatsÃ¤chlich "ja"! Andernfalls teilen sich VeraCrypt / GRUB2-Bootloader keinen MBR untereinander, genauer gesagt, im MBR / Boot-Track wird nur der kleinste Teil des Bootloader-Codes gespeichert,</i>  <i>sein Hauptteil befindet sich im Dateisystem)</i> - Multiboot - VerschlÃ¼sselungseinstellungen ... <br><br>  Wenn Sie von den oben genannten Schritten abweichen ( <i>Block-System-VerschlÃ¼sselungsschema)</i> , gibt VeraCrypt eine Warnung aus und erlaubt keine VerschlÃ¼sselung der Partition. <br><br>  FÃ¼hren Sie im nÃ¤chsten Schritt zum gezielten Datenschutz einen â€Testâ€œ durch und wÃ¤hlen Sie einen VerschlÃ¼sselungsalgorithmus aus.  Wenn Sie eine nicht moderne CPU haben, wÃ¤hlen Sie sie als schnellsten Twofish-VerschlÃ¼sselungsalgorithmus aus.  Wenn die CPU modern ist, beachten Sie den Unterschied: Die AES-VerschlÃ¼sselung ist laut Testergebnis um ein Vielfaches schneller als die ihrer Kryptokonkurrenten.  AES ist der beliebteste VerschlÃ¼sselungsalgorithmus, die Hardware moderner CPUs ist speziell fÃ¼r "Secret" <s>und "Hacking</s> " optimiert. <br><br>  VeraCrypt unterstÃ¼tzt die MÃ¶glichkeit, Laufwerke mit AES <i>(Twofish)</i> / und anderen Kombinationen zu <i>verschlÃ¼sseln</i> .  Auf der alten Intel-Core-CPU von vor einem Jahrzehnt <i>(ohne Hardware-UnterstÃ¼tzung fÃ¼r AES-NI, VerschlÃ¼sselung mit A / T-Kaskade) ist der</i> Leistungsabfall im Wesentlichen nicht wahrnehmbar.  <i>(Bei AMD-CPUs im selben Zeitalter von ~ Parametern ist die Leistung geringfÃ¼gig reduziert)</i> .  Das Betriebssystem ist dynamisch und der Ressourcenverbrauch fÃ¼r die transparente VerschlÃ¼sselung ist unsichtbar.  Im Gegensatz dazu ist zum Beispiel eine merkliche Abnahme der Leistung aufgrund der installierten Test-instabilen Desktop-Umgebung Mate v1.20.1 <i>(oder v1.20.2, an die ich mich nicht genau erinnere)</i> in GNU / Linux oder aufgrund des Betriebs der Telemetrie-Unkraut-Routine in Windows7 zu verzeichnen.  In der Regel fÃ¼hren erfahrene Benutzer vor der VerschlÃ¼sselung Tests zur Hardwareleistung durch.  Zum Beispiel werden sie in Aida64 / Sysbench / systemd-analyse mit den Ergebnissen der gleichen Tests verglichen, nachdem das System verschlÃ¼sselt wurde, wodurch der Mythos widerlegt wird, dass "SystemverschlÃ¼sselung schÃ¤dlich ist".  Beim Sichern / Wiederherstellen von verschlÃ¼sselten Daten sind Verlangsamung und Unannehmlichkeiten der Maschine zu bemerken, da der Vorgang der Systemdatensicherung selbst nicht in ms gemessen wird und die gleichen VorgÃ¤nge "on the fly entschlÃ¼sseln / verschlÃ¼sseln" hinzugefÃ¼gt werden.  Letztendlich legt jeder Benutzer, der sich mit Kryptografie befassen darf, das Gleichgewicht des VerschlÃ¼sselungsalgorithmus in Bezug auf das Erreichen der Ziele, den Grad seiner Paranoia und die Benutzerfreundlichkeit fest. <br><br>  Es ist besser, den PIM-Parameter standardmÃ¤ÃŸig zu belassen, damit Sie beim Laden des Betriebssystems nicht jedes Mal die genauen Werte der Iterationen eingeben.  VeraCrypt verwendet eine Vielzahl von Iterationen, um einen wirklich â€langsamen Hashâ€œ zu erstellen.  Ein Angriff auf eine solche â€Kryptoschneckeâ€œ mit der Brute-Force- / Rainbow-Tables-Methode ist nur mit einer <s>kurzen</s> â€einfachenâ€œ Passphrase und der Zeichensatzliste des persÃ¶nlichen Opfers sinnvoll.  Bezahlung fÃ¼r Passwortsicherheit - die VerzÃ¶gerung bei der korrekten Eingabe des Passworts beim Booten des Betriebssystems <i>(das Mounten von VeraCrypt-Volumes in GNU / Linux ist viel schneller).</i> <br>  Kostenlose Software zur Implementierung von Brute-Force-Angriffen <i>(Extrahieren von PasswÃ¶rtern aus dem VeraCrypt / LUKS-</i> Plattenheader <i>)</i> Hashcat.  John the Ripper weiÃŸ nicht, wie man "Veracrypt" zerstÃ¶rt, und wenn er mit LUKS arbeitet, versteht er keine Twofish-Kryptographie.  Ãœbrigens ist JtR bei nichtkommerzieller Software in jeder anderen Hinsicht besser als Hashcat. <br><br>  Aufgrund der kryptografischen StÃ¤rke von VerschlÃ¼sselungsalgorithmen entwickeln unaufhaltsame ChiffrierbÃ¤nke und ihre Antipoden Software mit einem anderen Angriffsvektor.  Zum Beispiel: Extrahieren von Metadaten / SchlÃ¼sseln aus dem RAM <i>(Kaltstart-Angriff / direkter Speicherzugriff),</i> Diebstahl eines LUKS-Headers beim Abfangen eines Kennworts und Senden von Netzwerkpaketen, mÃ¶glicherweise etwas anderes, das ich nicht kenne.  FÃ¼r diese Zwecke gibt es spezielle freie und unfreie Software. <br><br>  Nach Abschluss der Konfiguration / Generierung von â€eindeutigen Metadatenâ€œ der verschlÃ¼sselten aktiven Partition bietet VeraCrypt an, den PC neu zu starten und die Leistung seines Bootloaders zu testen.  Nach dem Neustart / Start von Windows wird VeraCrypt im Standby-Modus geladen. Es bleibt nur die BestÃ¤tigung des VerschlÃ¼sselungsvorgangs - Y. <br><br>  Im letzten Schritt der SystemverschlÃ¼sselung bietet VeraCrypt an, eine Sicherungskopie des Headers der aktiven verschlÃ¼sselten Partition in Form von "veracrypt rescue disk.iso" zu erstellen - dies muss durchgefÃ¼hrt werden. <u>In dieser Software ist dieser Vorgang eine Voraussetzung</u> <i>(in LUKS wird dies als Voraussetzung leider ausgelassen, wird jedoch hervorgehoben) in der Dokumentation)</i> .  Rettungsdiskette ist nÃ¼tzlich fÃ¼r alle und fÃ¼r jemanden mehr als einmal.  Wenn Sie das Betriebssystem verschieben und die Sicherung <i>des Headers / MBR-</i> Headers ohne Festplattenheader verlieren <i>(Ã¼berschreiben),</i> wird der Zugriff auf die entschlÃ¼sselte Partition mit dem Windows-Betriebssystem dauerhaft gesperrt. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">A4.</b>  <b class="spoiler_title">Erstellen einer VeraCrypt USB / Drive-Rettung</b> <div class="spoiler_text">  VeraCrypt bietet standardmÃ¤ÃŸig die MÃ¶glichkeit, "~ 2-3 MB Metadaten" auf eine CD zu brennen, aber nicht alle Benutzer verfÃ¼gen Ã¼ber Laufwerke oder DWD-ROM-Laufwerke. Das Erstellen einer bootfÃ¤higen VeraCrypt Rescue-Diskette fÃ¼r jemanden ist eine technische Ãœberraschung: Rufus / GUIdd-ROSA ImageWriter und Ã¤hnliche Software werden diese Aufgabe nicht bewÃ¤ltigen kÃ¶nnen, da Sie nicht nur die verschobenen Metadaten auf das bootfÃ¤hige USB-Flash-Laufwerk kopieren, sondern auch das Image auÃŸerhalb des Dateisystems des USB-Laufwerks kopieren bzw. einfÃ¼gen mÃ¼ssen SchlÃ¼sselbund.  Unter GNU / Linux kÃ¶nnen Sie mit dem Dienstprogramm "dd" ein bootfÃ¤higes Flash-Laufwerk erstellen, indem Sie sich diese Platte ansehen. <br><br><img src="https://habrastorage.org/webt/_z/zl/f-/_zzlf-zhvflotagy215jpqv9dkw.jpeg"><br><br>  Das Erstellen einer Rettungsdiskette in einer Windows-Umgebung ist anders.  Der VeraCrypt-Entwickler hat die LÃ¶sung fÃ¼r dieses Problem nicht in die offizielle <a href="https://www.veracrypt.fr/en/VeraCrypt%2520Rescue%2520Disk.html" rel="nofollow">Dokumentation</a> fÃ¼r die "Rettungsdiskette" aufgenommen, sondern eine andere LÃ¶sung vorgeschlagen: Er hat zusÃ¤tzliche Software zum Erstellen der "USB-Rettungsdiskette" fÃ¼r den freien Zugriff in seinem VeraCrypt-Forum verÃ¶ffentlicht.  Update: 2020 hatte der entwickler schade um die "kleinen dinge" und nahm die <a href="" rel="nofollow">usb rescue disk</a> lÃ¶sung offiziell in seine dokumentation auf. <br>  Nachdem Sie die Rettungsdiskette.iso gespeichert haben, beginnt der Vorgang zum Blockieren der SystemverschlÃ¼sselung der aktiven Partition.  WÃ¤hrend der VerschlÃ¼sselung stoppt das Betriebssystem nicht und ein Neustart des PCs ist nicht erforderlich.  Nach Abschluss des VerschlÃ¼sselungsvorgangs wird die aktive Partition vollstÃ¤ndig verschlÃ¼sselt. Sie kÃ¶nnen sie verwenden.  Wenn der VeraCrypt-Bootloader beim Starten des PCs nicht angezeigt wird und die Header-Wiederherstellung nicht hilft, aktivieren Sie das KontrollkÃ¤stchen "Boot". Er sollte auf der Partition installiert werden, auf der Windows vorhanden ist <i>(unabhÃ¤ngig von VerschlÃ¼sselung und anderen Betriebssystemen, siehe Tabelle Nr. 1).</i> <br>  FÃ¼gen Sie nach dem VerschlÃ¼sseln des Systemlaufwerks und der logischen Laufwerke ntfs (dasselbe Kennwort) alle verschlÃ¼sselten Laufwerke zu den â€Systemfavoritenâ€œ hinzu.  Aktivieren Sie als NÃ¤chstes unter "Einstellungen"&gt; "Systemfavoriten" das KontrollkÃ¤stchen "Systemfavoriten beim Start von Windows einbinden". Wenn das Betriebssystem hochfÃ¤hrt, werden alle NTFS-Festplatten automatisch eingebunden. <br>  <i><b>Damit ist die Beschreibung der BlocksystemverschlÃ¼sselung unter Windows abgeschlossen.</b></i> <br></div></div><br><h2>  [B] LUKS.  VerschlÃ¼sselung von GNU / Linux <i>(~ Debian)</i> installiertem Betriebssystem.  Algorithmus und Schritte </h2><br>  Um die installierte Debian / Derivated-Distribution zu verschlÃ¼sseln, mÃ¼ssen Sie die vorbereitete Partition einem virtuellen Block-GerÃ¤t zuordnen, auf das zugeordnete GNU / Linux-Laufwerk Ã¼bertragen und GRUB2 installieren / konfigurieren.  Wenn Sie keinen nackten Server haben und Ihre Zeit schÃ¤tzen, mÃ¼ssen Sie die GUI verwenden, und die meisten der nachfolgend beschriebenen Terminalbefehle sind fÃ¼r den Betrieb im â€Chuck-Norris-Modusâ€œ vorgesehen. <br><br>  <b>B1.</b>  <b>Laden Sie den PC von Live-USB GNU / Linux herunter</b> <br><br>  "FÃ¼hren Sie einen Kryptotest zur Leistung von Eisen durch" <br><br><pre> <code class="bash hljs">lscpu &amp;&amp; ryptsetup benchmark</code> </pre> <br><img src="https://habrastorage.org/webt/xm/t5/ko/xmt5koolr78zxwr0rwicahnlr78.jpeg"><br><br>  Wenn Sie ein zufriedener Besitzer eines leistungsstarken Autos mit Hardware-UnterstÃ¼tzung fÃ¼r AES-NI sind, sehen die Zahlen wie auf der rechten Seite des Terminals aus, wenn Sie zufrieden sind, aber mit antikem Eisen - auf der linken Seite. <br><br>  <b>B2.</b>  <b>Partitionieren einer Festplatte.</b>  <b>EinhÃ¤ngen / Formatieren der Festplatte des logischen Laufwerks in Ext4 (Gparted)</b> <br><br><div class="spoiler">  <b class="spoiler_title">B2.1.</b>  <b class="spoiler_title">Erstellen Sie einen verschlÃ¼sselten sda7-Partitionsheader</b> <div class="spoiler_text">  Ich werde die Namen der Abschnitte im Folgenden gemÃ¤ÃŸ meiner oben angegebenen Abschnittstabelle beschreiben.  Entsprechend Ihrem Festplattenlayout mÃ¼ssen Sie Ihre Partitionsnamen ersetzen. <br><br>  Zuordnung der logischen FestplattenverschlÃ¼sselung <i>(/ dev / sda7&gt; / dev / mapper / sda7_crypt).</i> <br>  # Einfache Erstellung einer â€LUKS-AES-XTS-Partitionâ€œ <br><br><pre> <code class="bash hljs">cryptsetup -v -y luksFormat /dev/sda7</code> </pre> <br>  Optionen: <br><br>  * luksFormat - Initialisierung des LUKS-Headers; <br>  * -y ist eine Passphrase (kein SchlÃ¼ssel / keine Datei); <br>  * -v -verbalization (Informationsausgabe im Terminal); <br>  * / dev / sda7 - Ihr logisches Laufwerk von der erweiterten Partition <i>(an den Ort, an den Sie GNU / Linux Ã¼bertragen / verschlÃ¼sseln</i> mÃ¶chten <i>)</i> . <br><br>  StandardmÃ¤ÃŸig lautet der VerschlÃ¼sselungsalgorithmus &lt;L <i>UKS1: aes-xts-plain64, SchlÃ¼ssel: 256 Bit, LUKS-Header-Hashing: sha256, RNG: / dev / urandom</i> &gt; <i>(abhÃ¤ngig von der Version von cryptsetup).</i> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># default-  cryptsetup --help #     .</span></span></code> </pre> <br>  In Ermangelung von Hardware-UnterstÃ¼tzung fÃ¼r AES auf der CPU ist die Erstellung einer erweiterten â€LUKS-Twofish-XTS-Partitionâ€œ die beste Wahl. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">B2.2.</b>  <b class="spoiler_title">Erweiterte Erstellung einer â€LUKS-Twofish-XTS-Partitionâ€œ</b> <div class="spoiler_text"><pre> <code class="bash hljs">cryptsetup luksFormat /dev/sda7 -v -y -c twofish-xts-plain64 -s 512 -h sha512 -i 1500 --use-urandom</code> </pre> <br>  Optionen: <br>  * luksFormat - Initialisierung des LUKS-Headers; <br>  * / dev / sda7 Ihr zukÃ¼nftiges verschlÃ¼sseltes logisches Laufwerk; <br>  * -v Verbalisierung; <br>  * -jede Anfrage zur BestÃ¤tigung einer Passphrase; <br>  * -c Auswahl des DatenverschlÃ¼sselungsalgorithmus; <br>  * -s GrÃ¶ÃŸe des VerschlÃ¼sselungsschlÃ¼ssels; <br>  * -h Hashing-Algorithmus / <i>Kryptofunktion</i> , die vom RNG <i>(--use-urandom) verwendet wird</i> , um einen eindeutigen VerschlÃ¼sselungs- / EntschlÃ¼sselungsschlÃ¼ssel fÃ¼r den Header des logischen Laufwerks und den sekundÃ¤ren Header-SchlÃ¼ssel (XTS) zu generieren.  Der im verschlÃ¼sselten Header der Festplatte gespeicherte eindeutige HauptschlÃ¼ssel, der sekundÃ¤re XTS-SchlÃ¼ssel, alle diese Metadaten und die VerschlÃ¼sselungsroutine, die mit dem HauptschlÃ¼ssel und dem sekundÃ¤ren XTS-SchlÃ¼ssel alle Daten auf der Partition <i>(mit Ausnahme des Partitionsheaders)</i> verschlÃ¼sselt / entschlÃ¼sselt, werden in ~ 3 mB auf der ausgewÃ¤hlten festen Partition gespeichert fahren. <br>  * -i PBKDF-Iterationszeit fÃ¼r LUKS (in ms) <i>(ZeitverzÃ¶gerung beim Verarbeiten einer Passphrase wirkt sich auf das Laden des Betriebssystems und die kryptografische StÃ¤rke von SchlÃ¼sseln aus).</i>  Um das Gleichgewicht der kryptografischen StÃ¤rke mit einem einfachen Passwort wie "russisch" aufrechtzuerhalten, mÃ¼ssen Sie den Wert erhÃ¶hen - (i), mit einem komplexen Passwort wie "? 8dÆ±ob / Ã¸fh" kÃ¶nnen Sie den Wert verringern. <br>  * --use-urandom Zufallszahlengenerator, erzeugt SchlÃ¼ssel und Salz. <br><br>  Nachdem Sie den Abschnitt sda7&gt; sda7_crypt abgeglichen haben <i>(die Operation ist schnell, da ein verschlÃ¼sselter Header mit Metadaten von ~ 3 MB erstellt wird und das ist alles)</i> , mÃ¼ssen Sie das Dateisystem sda7_crypt formatieren und bereitstellen. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">B2.3.</b>  <b class="spoiler_title">Zuordnung</b> <div class="spoiler_text"><pre> <code class="bash hljs">cryptsetup open /dev/sda7 sda7_crypt <span class="hljs-comment"><span class="hljs-comment">#       .</span></span></code> </pre><br>  MÃ¶glichkeiten: <br>  * open - ordne den Abschnitt "mit einem Namen" zu; <br>  * / dev / sda7-logisches Laufwerk; <br>  * sda7_crypt ist eine Namenszuordnung, mit der eine verschlÃ¼sselte Partition eingehÃ¤ngt oder beim Start des Betriebssystems initialisiert wird. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">B2.4.</b>  <b class="spoiler_title">Formatieren des Dateisystems sda7_crypt in ext4.</b>  <b class="spoiler_title">OS Mount</b> <div class="spoiler_text">  <i>(Hinweis: Gparted funktioniert nicht mehr mit einer verschlÃ¼sselten Partition)</i> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#    mkfs.ext4 -v -L DebSHIFR /dev/mapper/sda7_crypt</span></span></code> </pre><br>  MÃ¶glichkeiten: <br>  * -v - Verbalisierung; <br>  * -L -disk label (wird unter anderem im Explorer angezeigt). <br><br>  HÃ¤ngen Sie als NÃ¤chstes das virtuell verschlÃ¼sselte BlockgerÃ¤t / dev / sda7_crypt in das System ein <br><br><pre> <code class="bash hljs">mount /dev/mapper/sda7_crypt /mnt</code> </pre> <br>  Das Arbeiten mit Dateien im Ordner / mnt verschlÃ¼sselt / entschlÃ¼sselt Daten automatisch im laufenden Betrieb in sda7. <br><br>  Es ist praktischer, die Partition im Explorer <i>(nautilus / caja GUI)</i> zuzuordnen und zu mounten. Die Partition befindet sich bereits in der DatentrÃ¤gerauswahlliste. Es muss nur noch die Passphrase zum Ã–ffnen / EntschlÃ¼sseln des DatentrÃ¤gers eingegeben werden.  Der passende Name wird automatisch ausgewÃ¤hlt und nicht "sda7_crypt", sondern so etwas wie / dev / mapper / Luks-xx-xx ... <br></div></div><br><div class="spoiler">  <b class="spoiler_title">B2.5.</b>  <b class="spoiler_title">SicherungsdatentrÃ¤ger-Header (~ 3 MB Metadaten)</b> <div class="spoiler_text">  Eine der <b>wichtigsten</b> Operationen, die unverzÃ¼glich ausgefÃ¼hrt werden mÃ¼ssen, ist eine Sicherungskopie des sda7_crypt-Headers.  Wenn Sie den Header Ã¼berschreiben / <i>beschÃ¤digen (z. B. durch Installieren von GRUB2 in der sda7-Partition usw.)</i> , gehen die verschlÃ¼sselten Daten dauerhaft verloren, ohne dass eine Wiederherstellung mÃ¶glich ist, da dieselben SchlÃ¼ssel nicht neu <i>generiert werden</i> kÃ¶nnen. Die SchlÃ¼ssel werden eindeutig erstellt. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   cryptsetup luksHeaderBackup --header-backup-file ~/_DebSHIFR /dev/sda7</span></span></code> </pre><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   cryptsetup luksHeaderRestore --header-backup-file &lt;file&gt; &lt;device&gt;</span></span></code> </pre> <br>  MÃ¶glichkeiten: <br>  * luksHeaderBackup - Befehl "header-backup-file-backup"; <br>  * luksHeaderRestore - Befehl "header-backup-file-restore"; <br>  * ~ / Backup_DebSHIFR - Sicherungsdatei; <br>  * / dev / sda7 ist die Partition, deren Sicherungskopie des verschlÃ¼sselten Festplatten-Headers Sie behalten mÃ¶chten. <br>  <i><b>Hinweis</b></i>  <i>Versuchen Sie nicht, den Header des LUKS-Abschnitts von [sdaX] nach [sdaY] wiederherzustellen, da die meisten Benutzernamen fehlschlagen.</i> <br>  <i><b>In diesem Schritt ist die &lt;Erstellung und Bearbeitung der verschlÃ¼sselten Partition&gt; abgeschlossen.</b></i> <br></div></div><br>  <b>B3</b>  <b>GNU / Linux OS <i>(sda4)</i> auf eine verschlÃ¼sselte Partition <i>(sda7) migrieren</i></b> <br><br>  <i><b>Hinweis</b></i>  <i>Vor dem Ãœbertragen des Betriebssystems auf eine verschlÃ¼sselte Partition wird empfohlen, Ã¼berschÃ¼ssigen zwischengespeicherten MÃ¼ll zu entfernen (Ã¤hnlicher MÃ¼ll kann mit der BleachBit-Software gefunden werden). In meinem Fall handelte es sich beispielsweise um mehrere hunderttausend kleine Dateien / var / cache / fontconfig / * und /home/user/.cache / fontconfig / *</i> <i><br></i>  <i>Wenn Sie fontconfig-Dateien bereinigt haben, fÃ¼hren Sie $ fc-cache -fvr aus</i> <br><br>  Erstellen Sie den Ordner / mnt2 <i>(Hinweis: Wir arbeiten immer noch mit Live-USB, sda7_crypt wird am Punkt / mnt eingehÃ¤ngt)</i> und hÃ¤ngen Sie unser GNU / Linux in / mnt2 ein, das verschlÃ¼sselt werden muss. <br><br><pre> <code class="bash hljs">mkdir /mnt2 mount /dev/sda4 /mnt2</code> </pre><br>  Wir fÃ¼hren die korrekte Betriebssystemmigration mit der Rsync-Software durch <br><pre> <code class="bash hljs">rsync -avlxhHX --progress /mnt2/ /mnt</code> </pre> <br>  Rsync-Optionen werden in S. E1 beschrieben. <br><br>  Als NÃ¤chstes mÃ¼ssen <b>Sie</b> die Partition des logischen Laufwerks defragmentieren <br><br><pre> <code class="bash hljs">e4defrag -c /mnt/ <span class="hljs-comment"><span class="hljs-comment"># , e4defrag ,     â‰ˆ 0,  ,       ! e4defrag /mnt/ #   GNU/Linux</span></span></code> </pre> <br>  Machen Sie es sich zur Regel: Machen Sie von Zeit zu Zeit e4defrag auf verschlÃ¼sseltem GNU / LInux, wenn Sie eine Festplatte haben. <br>  <i><b>Die Migration und Synchronisation [GNU / Linux&gt; GNU / Linux-verschlÃ¼sselt] dieses Schritts ist abgeschlossen.</b></i> <br><br>  <b>B4.</b>  <b>GNU / Linux auf einer verschlÃ¼sselten sda7-Partition konfigurieren</b> <br><br>  Nachdem Sie das Betriebssystem / dev / sda4&gt; / dev / sda7 erfolgreich Ã¼bertragen haben, mÃ¼ssen Sie sich auf der verschlÃ¼sselten Partition bei GNU / Linux anmelden und eine weitere Konfiguration <i>(ohne den PC neu zu starten)</i> des verschlÃ¼sselten Systems durchfÃ¼hren.  Das heiÃŸt, Sie mÃ¼ssen sich im Live-Modus befinden, aber die auszufÃ¼hrenden Befehle beziehen sich auf das Stammverzeichnis des verschlÃ¼sselten Betriebssystems.  Eine Ã¤hnliche Situation zu simulieren wird "chroot" sein.  Um schnell Informationen Ã¼ber das Betriebssystem zu erhalten, an dem Sie gerade arbeiten <i>(verschlÃ¼sselt oder nicht, da die Daten in sda4 und sda7 synchronisiert sind)</i> , mÃ¼ssen Sie <i>das</i> Betriebssystem <i>desynchronisieren</i> .  Erstellen Sie leere <i>Tokendateien</i> in den Stammverzeichnissen <i>(sda4 / sda7_crypt)</i> , z. B. / mnt / encrypted OS und / mnt2 / decrypted OS.  Ein kurzer Ãœberblick Ã¼ber das Betriebssystem, in dem Sie sich befinden <i>(auch fÃ¼r die Zukunft):</i> <br><pre> <code class="bash hljs">ls /&lt;Tab-Tab&gt;</code> </pre> <br><br><div class="spoiler">  <b class="spoiler_title">B4.1.</b>  <b class="spoiler_title">"Simulieren eines Zugriffs auf ein verschlÃ¼sseltes Betriebssystem"</b> <div class="spoiler_text"><pre> <code class="bash hljs">mount --<span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /dev /mnt/dev mount --<span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /proc /mnt/proc mount --<span class="hljs-built_in"><span class="hljs-built_in">bind</span></span> /sys /mnt/sys chroot /mnt</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">B4.2.</b>  <b class="spoiler_title">ÃœberprÃ¼fen, ob die Arbeit auf einem verschlÃ¼sselten System ausgefÃ¼hrt wird</b> <div class="spoiler_text"><pre> <code class="bash hljs">ls /mnt&lt;Tab-Tab&gt; <span class="hljs-comment"><span class="hljs-comment">#   "/"</span></span></code> </pre><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">history</span></span> <span class="hljs-comment"><span class="hljs-comment">#       su  .</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">B4.3.</b>  <b class="spoiler_title">Erstellen / Konfigurieren von verschlÃ¼sseltem Swap</b> <div class="spoiler_text">  Da die Auslagerungsdatei bei jedem Start des Betriebssystems formatiert wird, ist es nicht sinnvoll, jetzt eine Auslagerung zu erstellen und dem logischen Laufwerk zuzuordnen und Befehle wie in Abschnitt B2.2 einzugeben.  Bei Swap werden die temporÃ¤ren VerschlÃ¼sselungsschlÃ¼ssel bei jedem Start automatisch generiert.  Swap-a-Key-Lebenszyklus: AushÃ¤ngen / Trennen der Swap-Partition <i>(+ RAM-Reinigung)</i> ;  oder Neustart des Betriebssystems.  Ã–ffnen Sie beim Konfigurieren von Swap die Datei, die fÃ¼r die Konfiguration blockverschlÃ¼sselter GerÃ¤te zustÃ¤ndig ist <i>(eine Entsprechung zur fstab-Datei, die jedoch</i> fÃ¼r die VerschlÃ¼sselung <i>zustÃ¤ndig ist).</i> <br><br><pre> <code class="bash hljs">nano /etc/crypttab</code> </pre> <br>  Regel <br><blockquote>  # "Zielname" "QuellgerÃ¤t" "SchlÃ¼sseldatei" "Optionen" <br>  swap / dev / sda8 / dev / urandom swap, cipher = twofish-xts-plain64, size = 512, hash = sha512 </blockquote><br>  Optionen <br>  * swap ist der zugeordnete VerschlÃ¼sselungsname von / dev / mapper / swap. <br>  * / dev / sda8 - Verwenden Sie Ihre logische Partition unter Swap. <br>  * / dev / urandom - Generator fÃ¼r zufÃ¤llige VerschlÃ¼sselungsschlÃ¼ssel fÃ¼r den Austausch ( <i>neue SchlÃ¼ssel werden bei jedem neuen Start des Betriebssystems erstellt).</i>  Der / dev / urandom-Generator ist weniger zufÃ¤llig als / dev / random, schlieÃŸlich wird / dev / random verwendet, wenn unter gefÃ¤hrlichen paranoiden UmstÃ¤nden gearbeitet wird.  Beim Booten des Betriebssystems verlangsamt / dev / random das Laden fÃ¼r einige Â± Minuten <i>(siehe systemd-analyse)</i> . <br>  * swap, cipher = twofish-xts-plain64, size = 512, hash = sha512: -der Abschnitt weiÃŸ, dass es sich um einen Swap handelt und "entsprechend" formatiert ist;  VerschlÃ¼sselungsalgorithmus. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   fstab nano /etc/fstab</span></span></code> </pre><br>  Regel <br><blockquote>  # swap war wÃ¤hrend der Installation auf / dev / sda8 <br>  / dev / mapper / swap keine swap sw 0 0 <br></blockquote><br>  / dev / mapper / swap ist der Name, der in crypttab festgelegt wurde. <br><br>  <b>Alternativer verschlÃ¼sselter Swap</b> <br>  Wenn Sie aus irgendeinem Grund der Auslagerungsdatei nicht den gesamten Abschnitt zuweisen mÃ¶chten, kÃ¶nnen Sie einen alternativen und besseren Weg wÃ¤hlen: Erstellen Sie eine Auslagerungsdatei in einer Datei auf einer verschlÃ¼sselten Partition mit dem Betriebssystem. <br><br><pre> <code class="bash hljs">fallocate -l 3G /swap <span class="hljs-comment"><span class="hljs-comment">#   3 (  ) chmod 600 /swap #  mkswap /swap #     swapon /swap #  swap free -m #,       printf "/swap none swap sw 0 0" &gt;&gt; /etc/fstab #    swap  </span></span></code> </pre> <br>  <i><b>Die Einrichtung der Swap-Partition ist abgeschlossen.</b></i> <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">B4.4.</b>  <b class="spoiler_title">Konfigurieren von verschlÃ¼sseltem GNU / Linux (Bearbeiten von crypttab / fstab-Dateien)</b> <div class="spoiler_text">  Die Datei / etc / crypttab beschreibt, wie oben beschrieben, die verschlÃ¼sselten BlockgerÃ¤te, die beim Booten konfiguriert werden. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /etc/crypttab nano /etc/crypttab</span></span></code> </pre><br>  wenn Sie den Abschnitt sda7&gt; sda7_crypt wie in Abschnitt B2.1 abgebildet haben <br><blockquote>  # "Zielname" "QuellgerÃ¤t" "SchlÃ¼sseldatei" "Optionen" <br>  sda7_crypt UUID = 81048598-5bb9-4a53-af92-f3f9e709e2f2 keine luks <br></blockquote><br>  wenn Sie den Abschnitt sda7&gt; sda7_crypt wie in B2.2 zugeordnet haben <br><blockquote>  # "Zielname" "QuellgerÃ¤t" "SchlÃ¼sseldatei" "Optionen" <br>  sda7_crypt UUID = 81048598-5bb9-4a53-af92-f3f9e709e2f2 keine VerschlÃ¼sselung = twofish-xts-plain64, GrÃ¶ÃŸe = 512, Hash = sha512 </blockquote><br>  Wenn Sie den Abschnitt sda7&gt; sda7_crypt wie in B2.1 oder B2.2 verglichen haben und das Kennwort zum Entsperren und Booten des Betriebssystems nicht erneut eingeben mÃ¶chten, kÃ¶nnen Sie das Kennwort durch den geheimen SchlÃ¼ssel / die Zufallsdatei ersetzen <br><blockquote>  # "Zielname" "QuellgerÃ¤t" "SchlÃ¼sseldatei" "Optionen" <br>  sda7_crypt UUID = 81048598-5bb9-4a53-af92-f3f9e709e2f2 / etc / skey luks </blockquote><br>  Beschreibung <br>  * none - meldet, dass beim Hochfahren des Betriebssystems eine geheime Passphrase erforderlich ist, um den Root freizuschalten. <br>  * UUID - Abschnittskennung.  Um Ihre Kennung herauszufinden, geben Sie das Terminal ein <i>(eine Erinnerung, dass Sie die ganze Zeit und darÃ¼ber hinaus im Terminal in der Chroot-Umgebung arbeiten und nicht in einem anderen Live-USB-Terminal).</i> <br><br><pre> <code class="bash hljs">fdisk -l <span class="hljs-comment"><span class="hljs-comment">#   blkid #  - </span></span></code> </pre><br><blockquote>  / dev / sda7: UUID = "81048598-5bb9-4a53-af92-f3f9e709e2f2" TYPE = "crypto_LUKS" PARTUUID = "0332d73c-07" <br>  / dev / mapper / sda7_crypt: LABEL = "DebSHIFR" UUID = "382111a2-f993-403c-aa2e-292b5eac4780" TYPE = "ext4" <br></blockquote><br>  Diese Zeile ist sichtbar, wenn Sie blkid vom Live-USB-Terminal anfordern (sda7_crypt ist aktiviert). <br> UUID     sdaX <i>( sdaX_crypt!, UUID sdaX_crypt â€“      grub.cfg).</i> <br> * cipher=twofish-xts-plain64,size=512,hash=sha512 -luks    . <br> * /etc/skey - -,        <i>(  3- ).</i>      8,     &lt;1. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># ""   &lt; &gt;  691. head -c 691 /dev/urandom &gt; /etc/skey</span></span></code> </pre><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#   (691)  7-   luks cryptsetup luksAddKey --key-slot 7 /dev/sda7 /etc/skey</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  "/ luks-" cryptsetup luksDump /dev/sda7</span></span></code> </pre><br>    : <br><blockquote> (    .    2020.,     LUKS2,  ,    LUKS1.   â€”  LUKS1      CLI). </blockquote><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Check " " file -s /dev/sda7 /dev/sda7: LUKS encrypted file, ver 1 [twofish, xts-plain64, sha512] UUID: -- #   LUKS /dev/sda7: data #   VeraCrypt</span></span></code> </pre> <br><pre> <code class="bash hljs">cryptsetup luksKillSlot /dev/sda7 7 <span class="hljs-comment"><span class="hljs-comment"># /  7 </span></span></code> </pre> <br><br> /etc/fstab       . <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /etc/fstab nano /etc/fstab</span></span></code> </pre><br><blockquote> # Â«file systemÂ» Â«mount poinÂ» Â«typeÂ» Â«optionsÂ» Â«dumpÂ» Â«passÂ» <br> # / was on /dev/sda7 during installation <br> /dev/mapper/sda7_crypt / ext4 errors=remount-ro 0 1 <br></blockquote><br>  <br> * /dev/mapper/sda7_crypt -  sda7&gt;sda7_crypt,     /etc/crypttab. <br> <b> crypttab/fstab .</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">B4.5.   .  </b> <div class="spoiler_text"> <b>B4.5.1.   /etc/initramfs-tools/conf.d/resume</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      swap ,  . nano /etc/initramfs-tools/conf.d/resume</span></span></code> </pre><br>   <i>( )</i> "#"  Â«resumeÂ».     . <br><br> <b>B4.5.2.   /etc/initramfs-tools/conf.d/cryptsetup</b> <br><br><pre> <code class="bash hljs">nano /etc/initramfs-tools/conf.d/cryptsetup</code> </pre> <br>   <br><blockquote> # /etc/initramfs-tools/conf.d/cryptsetup <br> CRYPTSETUP=yes <br> export CRYPTSETUP <br></blockquote><br><br> <b>B4.5.3.   /etc/default/grub <i>(       grub.cfg     /boot)</i></b> <br><br><pre> <code class="bash hljs">nano /etc/default/grub</code> </pre> <br>   Â«GRUB_ENABLE_CRYPTODISK=yÂ» <br>  'y', grub-mkconfig  grub-install         ,        <i>(insmod- &lt;cryptomount/set root&gt;)</i> . <br>    <br><blockquote> GRUB_DEFAULT=0 <br> GRUB_TIMEOUT=1 <br> GRUB_DISTRIBUTOR=`lsb_release -i -s 2&gt; /dev/null || echo Debian` <br> GRUB_CMDLINE_LINUX_DEFAULT=Â«acpi_backlight=vendorÂ» <br> GRUB_CMDLINE_LINUX=Â«quiet splash noautomountÂ» <br> GRUB_ENABLE_CRYPTODISK=y <br></blockquote><br><br> <b>B4.5.4.   /etc/cryptsetup-initramfs/conf-hook</b> <br><br><pre> <code class="bash hljs">nano /etc/cryptsetup-initramfs/conf-hook</code> </pre> <br> ,   &lt;CRYPTSETUP=y&gt;  &lt;#&gt;. <br>   <i>(   ,       ,       initrd.img).</i> <br><br>    : <br><blockquote> KEYFILE_PATTERN="/etc/skey" <br> UMASK=0077 <br></blockquote><br>     Â«skeyÂ»  initrd.img,         <i>(             Â«skeyÂ» ( + ) . .B4.4).</i> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">B4.6.  /boot/initrd.img [version]</b> <div class="spoiler_text">      initrd.img    cryptsetup,   <br><br><pre> <code class="bash hljs">update-initramfs -u -k all</code> </pre> <br>   initrd.img <i>(  Â«,    Â»)</i>  ,   cryptsetup, , ,     Nvidia â€”   .   , ,     .   <i>( chroot ./boot/initrd.img).</i>  <i><b>Achtung!</b></i> <i> [update-initramfs -u -k all]  ,  cryptsetup open /dev/sda7 <b>sda7_crypt</b> â€”     ,    /etc/crypttab,   reboot-a  busybox) <br> <i><b>      .</b></i> <br></i> <br></div></div><br><h2> []    GRUB2/ </h2><br><div class="spoiler"> <b class="spoiler_title">C1.        (    20)</b> <div class="spoiler_text"><pre> <code class="bash hljs">mkfs.ext4 -v -L GRUB2 /dev/sda6</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">C2.  /dev/sda6  /mnt</b> <div class="spoiler_text">     chroot,       /mnt2,   /mnt â€”  . <br>   GRUB2 <br><br><pre> <code class="bash hljs">mount /dev/sda6 /mnt</code> </pre> <br>       GRUB2,   /mnt/boot/grub/i-386-pc <i>(  , ,  Â«i386-pcÂ»)</i>   <i>(,     ,   .mod: cryptodisk; luks; gcry_twofish; gcry_sha512; signature_test.mod),</i>    GRUB2  . <br><br><pre> <code class="bash hljs">apt-get update apt-get install grub2</code> </pre><br>  Wichtig!     GRUB2  ,   Â« Â»      â€“     <i>( â€”   GRUB2 â€”  Â«MBRÂ»   live usb)</i> .      / VeraCrypt.    GRUB2,   ,       ,    Â«MBRÂ».       GRUB2,  <a href="https://www.gnu.org/software/grub/manual/grub/grub.html" rel="nofollow"></a>     â€“   <i>(    GRUB 2.02 ~BetaX).</i> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">C3.  GRUB2    [sda6]</b> <div class="spoiler_text">       [.C.2] <br><br><pre> <code class="bash hljs">grub-install --force --root-directory=/mnt /dev/sda6</code> </pre> <br>  <br> * --force - ,   ,        <i>( ).</i> <br> * --root-directory -  &lt;boot/grub&gt;   sda6. <br> * /dev/sda6 - sda  <i>(  &lt;&gt;  /mnt /dev/sda6).</i> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">C4.    [grub.cfg]</b> <div class="spoiler_text">    Â«update-grub2Â»,        <br><br><pre> <code class="bash hljs">grub-mkconfig -o /mnt/boot/grub/grub.cfg</code> </pre> <br>   /  grub.cfg,      ()      <i>(Â«grub-mkconfigÂ»       live usb,       Windows 10     â€”  ).</i>    Â«Â»,  Â«grub.cfgÂ»  ,     ,    GRUB  <i>(       ),</i>  GRUB2   . <br> <b> Â« Â»   GRUB2 .</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">C5. Proof-test   GNU/Linux</b> <div class="spoiler_text">   .    GNU/Linux <i>(   chroot).</i> <br><br><pre> <code class="bash hljs">umount -a <span class="hljs-comment"><span class="hljs-comment">#     GNU/Linux Ctrl+d #   chroot umount /mnt/dev umount /mnt/proc umount /mnt/sys umount -a #     live usb reboot</span></span></code> </pre> <br>       VeraCrypt. <br><img src="https://habrastorage.org/webt/ih/jd/9c/ihjd9ciwkuzmd6mqdwmxhbcgx5q.jpeg"><br><br> *     â€”    Windows. <br> *  Â«EscÂ»   GRUB2,    GNU/Linux â€“   (sda7_crypt)   /boot/initrd.img ( grub2  uuid Â« Â» â€”    grub2,   , ,   /  ). <br><img src="https://habrastorage.org/webt/e4/j2/jo/e4j2jofau3dugyj7jrnztkzpbn4.jpeg"><br><br> *   ,     (. .B4.4/4.5)        /boot/initrd.img,     / ,      Â«skeyÂ»,      . <br><img src="https://habrastorage.org/webt/rj/76/al/rj76alpbc7ebscvxe2_0uraoaya.jpeg"><br> ( Â«   Â»). <br><br> *     GNU/Linux    . <br><img src="https://habrastorage.org/webt/j_/q0/fn/j_q0fnugeazypbbwrv_sym9qxvq.jpeg"><br><br> *      ,    /boot/initrd.img <i>( 4.6).</i> <br><br><pre> <code class="bash hljs">update-initramfs -u -k all</code> </pre> <br>        GRUB2 <i>(  -  live usb)</i>    <br><br><pre> <code class="bash hljs">mount /dev/sda6 /mnt grub-mkconfig -o /mnt/boot/grub/grub.cfg</code> </pre><br> <b>     GNU/Linux:</b> <br><br><ul><li> GNU/Linuxinux  ,  /boot/kernel and initrd; </li><li>     initrd.img; </li><li>    <i>(    initrd; /   ;    Linux)</i> . </li></ul><br> <b>Â«  GRUB2Â»     .</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">6.   GRUB2.     +  </b> <div class="spoiler_text"> GNU/Linux  ,     â€“    BIOS.       GRUB2 ,  /   ,     â€“   [. . F]. <br>  Â«Â» GRUB2      Â«/Â». <br><ul><li>    Â«  Â»   ,         â€“     . </li><li>        - ,      CLI,      -GRUB2. </li></ul><br><br><div class="spoiler"> <b class="spoiler_title">6.1.   </b> <div class="spoiler_text"> ,         <br><br><pre> <code class="bash hljs">ls /&lt;Tab-Tab&gt; <span class="hljs-comment"><span class="hljs-comment"># -</span></span></code> </pre> <br>       GRUB2 <br><br><pre> <code class="bash hljs">grub-mkpasswd-pbkdf2 <span class="hljs-comment"><span class="hljs-comment">#/  .</span></span></code> </pre> <br>   . -    <br><blockquote> grub.pbkdf2.sha512.10000.DE10E42B01BB6FEEE46250FC5F9C3756894A8476A7F7661A9FFE9D6CC4D0A168898B98C34EBA210F46FC10985CE28277D0563F74E108FCE3ACBD52B26F8BA04D.27625A4D30E4F1044962D3DD1C2E493EF511C01366909767C3AF9A005E81F4BFC33372B9C041BE9BA904D7C6BB141DE48722ED17D2DF9C560170821F033BCFD8 <br></blockquote><br>   GRUB <br><br><pre> <code class="bash hljs">mount /dev/sda6 /mnt</code> </pre> <br>   <br><br><pre> <code class="bash hljs">nano -$ /mnt/boot/grub/grub.cfg</code> </pre> <br>    ,   Â«grub.cfgÂ»  -  (" --unrestricted" "--user", <br>     <i>(  ### END /etc/grub.d/41_custom ###)</i> <br> <i>Â«set superusers=Â»root" <br> password_pbkdf2 root ".</i> <br><br>     <br><blockquote> # This file provides an easy way to add custom menu entries. Simply type the <br> # menu entries you want to add after this comment. Be careful not to change <br> # the 'exec tail' line above. <br> ### END /etc/grub.d/40_custom ### <br><br> ### BEGIN /etc/grub.d/41_custom ### <br> if [ -f ${config_directory}/custom.cfg ];  dann <br> source ${config_directory}/custom.cfg <br> elif [ -z "${config_directory}" -a -f $prefix/custom.cfg ];  dann <br> source $prefix/custom.cfg; <br>  fi <br> set superusers=Â«rootÂ» <br> password_pbkdf2 root grub.pbkdf2.sha512.10000.DE10E42B01BB6FEEE46250FC5F9C3756894A8476A7F7661A9FFE9D6CC4D0A168898B98C34EBA210F46FC10985CE28277D0563F74E108FCE3ACBD52B26F8BA04D.27625A4D30E4F1044962D3DD1C2E493EF511C01366909767C3AF9A005E81F4BFC33372B9C041BE9BA904D7C6BB141DE48722ED17D2DF9C560170821F033BCFD8 <br> ### END /etc/grub.d/41_custom ### <br>  # <br></blockquote><br>      Â«grub-mkconfig -o /mnt/boot/grub/grub.cfgÂ»         grub.cfg,    <i>(/)</i>    GRUB-    <br><br><pre> <code class="bash hljs">nano /etc/grub.d/41_custom</code> </pre> <br><blockquote> cat &lt;&lt; EOF <br> set superusers=Â«rootÂ» <br> password_pbkdf2 root grub.pbkdf2.sha512.10000.DE10E42B01BB6FEEE46250FC5F9C3756894A8476A7F7661A9FFE9D6CC4D0A168898B98C34EBA210F46FC10985CE28277D0563F74E108FCE3ACBD52B26F8BA04D.27625A4D30E4F1044962D3DD1C2E493EF511C01366909767C3AF9A005E81F4BFC33372B9C041BE9BA904D7C6BB141DE48722ED17D2DF9C560170821F033BCFD8 <br> EOF <br></blockquote><br><br>    Â«grub-mkconfig -o /mnt/boot/grub/grub.cfgÂ», ,   ,     grub.cfg. <br> <b>     GRUB2 .</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">6.2.    </b> <div class="spoiler_text"> ,        pgp-  <i>(   ).</i>       : gnuPG; kleopatra/GPA; Seahorse. -        . Seahorse â€”    3.14.0 <i>( , , V3.20 â€“     ).</i> <br><br> PGP-  //    su! <br><br>     <br><br><pre> <code class="bash hljs">gpg - -gen-key</code> </pre> <br>    <br><br><pre> <code class="bash hljs">gpg --<span class="hljs-built_in"><span class="hljs-built_in">export</span></span> -o ~/perskey</code> </pre> <br>           <br><br><pre> <code class="bash hljs">mount /dev/sda6 /mnt <span class="hljs-comment"><span class="hljs-comment">#sda6 â€“  GRUB2</span></span></code> </pre> <br>   GRUB2 <br><br><pre> <code class="bash hljs">rm -rf /mnt/</code> </pre> <br>  GRUB2  sda6,        GRUB Â«core.imgÂ» <br><br><pre> <code class="bash hljs">grub-install --force --modules=<span class="hljs-string"><span class="hljs-string">"gcry_sha256 gcry_sha512 signature_test gcry_dsa gcry_rsa"</span></span> -k ~/perskey --root-directory=/mnt /dev/sda6</code> </pre> <br>  <br> * --force - ,   ,    <i>( ).</i> <br> * --modules=Â«gcry_sha256 gcry_sha512 signature_test gcry_dsa gcry_rsaÂ» - GRUB2        . <br> * -k ~/perskey -  Â«PGP-Â» <i>(    ,   ).</i> <br> * --root-directory -  boot   sda6 <br> /dev/sda6 - sda . <br><br> / grub.cfg <br><br><pre> <code class="bash hljs">grub-mkconfig -o /mnt/boot/grub/grub.cfg</code> </pre> <br>     Â«grub.cfgÂ»  Â«trust /boot/grub/perskeyÂ» <i>(  pgp-.)</i>     GRUB2   ,       Â«signature_test.modÂ»,          Â«set check_signatures=enforceÂ». <br><br>     <i>(    grub.cfg)</i> <br><blockquote> ### BEGIN /etc/grub.d/41_custom ### <br> if [ -f ${config_directory}/custom.cfg ];  dann <br> source ${config_directory}/custom.cfg <br> elif [ -z "${config_directory}" -a -f $prefix/custom.cfg ];  dann <br> source $prefix/custom.cfg; <br>  fi <br> trust /boot/grub/perskey <br> set superusers=Â«rootÂ» <br> password_pbkdf2 root grub.pbkdf2.sha512.10000.DE10E42B01BB6FEEE46250FC5F9C3756894A8476A7F7661A9FFE9D6CC4D0A168898B98C34EBA210F46FC10985CE28277D0563F74E108FCE3ACBD52B26F8BA04D.27625A4D30E4F1044962D3DD1C2E493EF511C01366909767C3AF9A005E81F4BFC33372B9C041BE9BA904D7C6BB141DE48722ED17D2DF9C560170821F033BCFD8 <br> ### END /etc/grub.d/41_custom ### <br>  # </blockquote><br><br>   "/boot/grub/perskey"       ,  hd0,6,    Â«Â»    ,    GRUB2 <i>(. set rot=..).</i> <br><br>  GRUB2 <i>(     /GRUB)</i>   Â«perskeyÂ». <br>  ,   <i>(  nautilus/caja):</i>     Â«seahorseÂ»  .         su. <br>    sudo "/mnt/boot" â€“  â€“ .       <br><br><img src="https://habrastorage.org/webt/ja/bw/id/jabwidfus4xnsjb774pllt4z1hc.jpeg"><br><br>   "/mnt/boot/grub/perskey" <i>(   grub)</i>       . ,   /    [*.sig]. <br>    "/boot" <i>( kernel, initrd).</i>    - ,      bash-   Â« Â». <br><br>      <i>( -   )</i> <br><br><pre> <code class="bash hljs">rm -f $(find /mnt/boot/grub -<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> f -name <span class="hljs-string"><span class="hljs-string">'*.sig'</span></span>)</code> </pre> <br>        ,    ,    GRUB2. <br><br><pre> <code class="bash hljs">apt-mark hold grub-common grub-pc grub-pc-bin grub2 grub2-common</code> </pre> <br> <b>   &lt;   &gt;   GRUB2 .</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">C6.3. Proof-test  GRUB2,     </b> <div class="spoiler_text"> GRUB2.   -  GNU/Linux    CLI <i>( )</i>   .    /    initrd <br><br><img src="https://habrastorage.org/webt/wu/ip/nt/wuipntxpfzxczd8sz-_nihhtkrc.jpeg"><br> ,   GRUB2-. <br><br>   -   GRUB2/   grub.cfg,   /,   .mod,    .  GRUB2 . <br><br><img src="https://habrastorage.org/webt/1j/cn/ao/1jcnaogftdd3pme8jexwyrzhe_m.jpeg"><br> ,    GRUB2 Â« Â». <br><br>  Â«Â»  Â« Â»,     Â«0Â».        <i>(  Â«      Â»         Â«0Â» â€”  ).</i> <br><br>     ? <br><br>   : /  GRUB2 , ,   luks.mod.sig   . <br><br>  :   CLI     <br><br><pre> <code class="bash hljs">trust_list</code> </pre> <br>      Â«perskeyÂ»,   Â«0Â»,     ,  .C6.2. <br> <b>     Â« GRUB2    Â» .</b> <br></div></div><br></div></div><br><div class="spoiler"> <b class="spoiler_title">7     GRUB2   </b> <div class="spoiler_text">    Â«  /Â» â€”  . -  GRUB2,       ,      .[F].  ,   /   . <br><br><h4>   GRUB2    </h4><br> <b>  :</b> <br><br><ul><li>    / <i>(/    <u>  </u> .      GRUB2   ,    ,        /   ,    ,   Â«- Â»          ).</i> </li><li>   <i>(      ).</i> </li><li>  <i>(/     GRUB2   ).</i> </li><li>    . </li></ul><br> <b>  .</b> <br><br><ul><li>   <i>(,      ).</i> </li><li> The Worst Evil Script <i>( /:       GRUB  ,   usb-/ , /       ,      pass/_LUKS   ).</i> </li><li>    <i>(           GNU/Linux).</i> </li></ul><br>    â€” <a href="http://bit.ly/2QrQk2O" rel="nofollow"> </a> ,       . <br><br> <b>     GRUB2/</b> <br><br> Â«Â»  GRUB2,               ().    ,       ,        <br><br><div class="spoiler"> <b class="spoiler_title">.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/o9/nz/e0/o9nze0_csyzmfb7wrozs4efqqto.gif"><br></div></div><br>    ,        GRUB, save log,         pas/_LUKS  . <br>    The Worst Evil Script    <s></s>         (  cryptsetup reencrypt),    LUKS  . <br>         GRUB,     . <br>    "-$ _GRUB"         ,      CLI. <br>    "-$ sudo _GRUB"     GRUB2/     <i>(   /boot),    .</i> <br><br> <b>      </b> <br><br> <b>0)</b>  / GRUB,     /media/username <br><pre> <code class="bash hljs">-$ hashdeep -c md5 -r /media/username/GRUB &gt; /podpis.txt</code> </pre> <br> <b>1)</b>         ~/podpis,      744     Â«Â». <br><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #      GRUB2  . #  " /  ",        . !    :   GRUB2     OS GNU/Linux. echo -e "******************************************************************\n" &gt;&gt; '/var/log/podpis.txt' &amp;&amp; date &gt;&gt; '/var/log/podpis.txt' &amp;&amp; hashdeep -vvv -a -k '/podpis.txt' -r '/media/username/GRUB' &gt;&gt; '/var/log/podpis.txt' a=`tail '/var/log/podpis.txt' | grep failed` #  "cat"!! b="hashdeep: Audit failed" #:    -      GRUB2         "  "      gif- "warning". if [[ "$a" = "$b" ]] then echo -e "****\n" &gt;&gt; '/var/log/vtorjenie.txt' &amp;&amp; echo "vtorjenie" &gt;&gt; '/var/log/vtorjenie.txt' &amp;&amp; date &gt;&gt; '/var/log/vtorjenie.txt' &amp; sudo -u username DISPLAY=:0 eom '/warning.gif' fi</span></span></code> </pre> <br></div></div><br>    <i>su</i> ,     GRUB   , save . <br><br>   , , Â« Â» [virus.mod]   GRUB2    /: <br><br><pre> <code class="bash hljs">-$ hashdeep -vvv -a -k <span class="hljs-string"><span class="hljs-string">'/podpis.txt'</span></span> -r <span class="hljs-string"><span class="hljs-string">'/media/username/GRUB</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> CLI      --</b> <div class="spoiler_text"> #   CLI <br><br><pre> <code class="bash hljs">  2 11::41 MSK 2020 /media/username/GRUB/boot/grub/virus.mod: Moved from /media/username/GRUB/1nononoshifr /media/username/GRUB/boot/grub/i386-pc/mda_text.mod: Ok /media/username/GRUB/boot/grub/grub.cfg: Ok hashdeep: Audit failed Input files examined: 0 Known files expecting: 0 Files matched: 325 Files partially matched: 0 Files moved: 1 New files found: 0 Known files not found: 0</code> </pre> <br> #   Â«Files moved: 1  Audit failedÂ» ,    . <br> -     Â«New files foundÂ» &gt; Â«Files movedÂ» <br></div></div><br> <b>2)</b>    &gt; ~/warning.gif,   744. <br><br> <b>3)</b>  fstab    GRUB   <br><br><pre> <code class="bash hljs">-$ sudo nano /etc/fstab</code> </pre> <br><blockquote> LABEL=GRUB /media/username/GRUB ext4 defaults 0 0 </blockquote><br> <b>4)</b>    <br><br><pre> <code class="bash hljs">-$ sudo nano /etc/logrotate.d/podpis</code> </pre> <br><blockquote> /var/log/podpis.txt { <br> daily <br> rotate 50 <br> size 5M <br> dateext <br> compress <br> delaycompress <br> olddir /var/log/old <br>  } <br><br> /var/log/vtorjenie.txt { <br> monthly <br> rotate 5 <br> size 5M <br> dateext <br> olddir /var/log/old <br>  } </blockquote><br> <b>5)</b>    cron <br><br><pre> <code class="bash hljs">-$ sudo crontab -e</code> </pre> <br><blockquote> <a href="https://habr.com/ru/users/reboot/" class="user_link">reboot</a> '/podpis' #     <br> 0 */6 * * * '/podpis #   0-00; 6; 12; 18. <br></blockquote><br> <b>6)</b>    <br><br><pre> <code class="bash hljs">-$ sudo su -$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"alias _GRUB='hashdeep -c md5 -r /media/username/GRUB &gt; /podpis.txt'"</span></span> &gt;&gt; /root/.bashrc &amp;&amp; bash -$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"alias _GRUB='hashdeep -vvv -a -k '/podpis.txt' -r /media/username/GRUB'"</span></span> &gt;&gt; .bashrc &amp;&amp; bash</code> </pre><br>    <code>-$ apt-get upgrade</code>    GRUB <br> <code>-$ _GRUB</code> <br> <b>      GRUB .</b> <br></div></div><br><h2> [D]  â€”    </h2><br><blockquote>      ,  Â«     Â»,       . </blockquote><br>     Â«  <a href="https://docs.bleachbit.org/doc/shred-files-and-wipe-disks.html" rel="nofollow"></a> Â»,         .     ,    Dr web          / <i>(,    R-studio)</i> ,       ,  ,   . <br><br>    GNU/Linux   ,        .   :   Windows/Linux  GUI  <a href="https://www.bleachbit.org/" rel="nofollow">BleachBit</a> . <br>  <b> </b> ,      <i>(  Gparted),</i>  BleachBit,  Â«  Â» â€“   <i>( sdaX    GNU/Linux)</i> ,   . BleachBit â€”      â€”  ,  Â« Â», !     ,         BB v2.0. <br><br>  <b>Achtung</b> ! BB  ,  :        <i>(Ccleaner â€”   ).</i> <br><br><div class="spoiler"> <b class="spoiler_title">         .</b> <div class="spoiler_text"> Bleachbit V2.0-2   unstable OS Debian <i>(    : sfill; wipe-Nautilus -       )</i>      :  Â«  Â» <b> </b>  HDD/ <i>(ntfs/ext4)</i> .           ,    .   <i>()</i>   /    /    Â«Â»   .   ,   ,   ,   <b>Â« Â»  </b>   3+   . <br>  GNU/Linux  Bleachbit <b>2.0-2</b>        ,     .  :  Windows   CCleaner  Â«  ntfsÂ»  ,        . <br><br>  ,    <u>Â«Â»</u>   , <b>   Bleachbit   </b> , ,   Â« / Â». <br>   Â«    Â»  Windows  CCleaner/BB   Â«Â».  GNU/Linux    <i>(  )</i>      <i>( +           (  ,  ))</i> ,                . <br><br> Bleachbit v3.0  , ,   . <br> Bleachbit v2.0     GNU/Linux   Windows7. <br></div></div><br> <b>   Â« Â» .</b> <br><br><h2> [E]      </h2><br>        ,    Â« Â»      .  ,   Â«ClonezillaÂ»          . <br><br>       : <br><br><ol><li>  â€”  /    Windows/Linux; </li><li>       live usb GNU/Linux      <i>(    GUI)</i> ; </li><li>    â€”  Â«Â»   /; </li><li>         ; </li><li>        <i>(     ).</i> </li></ol><br> ,  /   Â«ddÂ» <br><br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/dev/sda7 of=//sda7.img bs=7M conv=sync,noerror dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=//sda7.img of=/dev/sda7 bs=7M conv=sync,noerror</code> </pre> <br>      ,   .4   ,       ,       â€”  . <br><br> ,   GNU/Linux   [tar | gpg] Â«Â»,    Windows     â€”  . <br><br><div class="spoiler"> <b class="spoiler_title">E1.    Windows/Linux ( rsync (Grsync)+VeraCrypt ) &amp;   </b> <div class="spoiler_text"> <b>   :</b> <br><br><ol><li>    <i>(/)</i> VeraCrypt  ; </li><li> /     Rsync   VeraCrypt; </li><li>     VeraCrypt  www. </li></ol><br><br> <i>   VeraCrypt   : <br></i> <ol><li>    <i>(  <u>    Windows</u> ,     GNU/Linux)</i> ; </li><li>   ,    Â« Â» <i>(  )</i> â€“  . </li></ol><br><br>        Windows,       GNU/Linux &gt; VeraCrypt ,        . <br><br>   Twofish  70   <i>( ,    )</i>  HDD ~   <i>(      ,   ).</i>  VeraCrypt Windows/Linux        ,       Â«   Â»,     . <br><br>  2017      VeraCrypt     Â«      GNU/LinuxÂ».   <i> en &gt; ru</i> : <br><br><blockquote>     ,      <br>    ,       .â€¦ <br><br>         Linux. <br>     ,       . <br>  ,    . </blockquote><br>  ,   VeraCrypt      HDD   . <br>     ,     ,    <i>( Â«Â»    ).</i> <br><br>     VeraCrypt 1.24-Update3        GNU/Linux,      (/dev/sdaX). <br><img src="https://habrastorage.org/webt/ix/pj/dk/ixpjdk9i1dlmojr7obxa49wobey.png"><br>  / â€”    VeraCrypt-. <br><br>    VeraCrypt <i>(/ntfs)</i> ,     . <br><br> //   VeraCrypt GUI &gt; GNU/Linux live usb <i>(    /media/veracrypt2,   Windows   /media/veracrypt1).</i>      Windows   GUI rsync <i>(grsync)</i> ,  . <br><br><img src="https://habrastorage.org/webt/py/0v/hw/py0vhwm-rlgyctkndhzgcyrzpu8.jpeg"><br><br>   .    ,      . <br><br>      GNU/Linux,    GUI rsync Â«  WindowsÂ». <br><br>  <b>Achtung</b> !  Veracrypt  Â« GNU/LinuxÂ»     <b>ext4</b> .      ntfs,        /    . <br><br>       .    rsync: <br> * -g - ; <br> * -P --progress â€”     ; <br> * -H - ,  ; <br> * - -  <i>(  rlptgoD)</i> ; <br> * -v -. <br><br>    Â« Windows VeraCryptÂ»     cryptsetup,   alias (su) <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"alias veramount='cryptsetup open --veracrypt --tcrypt-system --type tcrypt /dev/sdaX Windows_crypt &amp;&amp; mount /dev/mapper/ Windows_crypt /media/veracrypt1'"</span></span> &gt;&gt; .bashrc &amp;&amp; bash</code> </pre><br>    Â«veramount <s>pictures</s> Â»      ,   - ,    Windows. <br><br> / <b>  VeraCrypt</b>  cryptsetup  <br><br><pre> <code class="bash hljs">cryptsetup open --veracrypt --tcrypt-system --<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> tcrypt /dev/sdaX Windows_crypt mount /dev/mapper/Windows_crypt /mnt</code> </pre> <br> / <b>/ VeraCrypt</b>  cryptsetup  <br><br><pre> <code class="bash hljs">cryptsetup open --veracrypt --<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> tcrypt /dev/sdaY test_crypt mount /dev/mapper/test_crypt /mnt</code> </pre> <br><br> <b> alias-  (  )      Windows     ntfs   GNU/Linux   /</b> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /   ntfs- mkdir /media/Winda7 &amp;&amp; mkdir /media/</span></span></code> </pre> <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      VeraCrypt,  " "    printf 'bob' | base64 Ym9i #  cli   "bob"</span></span></code> </pre> <br>       ~/VeraOpen.sh <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'Ym9i'</span></span> | base64 -d | cryptsetup open --veracrypt --tcrypt-system --<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> tcrypt /dev/sda3 Windows_crypt &amp;&amp; mount /dev/mapper/Windows_crypt /media/Winda7 <span class="hljs-comment"><span class="hljs-comment">#   base64 (bob)             Windows. echo 'Ym9i' | base64 -d | cryptsetup open --veracrypt --type tcrypt /dev/sda1 ntfscrypt &amp;&amp; mount /dev/mapper/ntfscrypt /media/ #,     ntfs.</span></span></code> </pre><br>  Â«Â» : <pre> <code class="bash hljs">sudo chmod 100 /VeraOpen.sh</code> </pre> <br><br>     ( !)  /etc/rc.local  ~/etc/init.d/rc.local <br>   <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh -e # # rc.local # # This script is executed at the end of each multiuser runlevel. # Make sure that the script will Â«exit 0Â» on success or any other # value on error. # # In order to enable or disable this script just change the execution # bits. # # By default this script does nothing. sh -c "sleep 1 &amp;&amp; '/VeraOpen.sh'" #  ,  ~ 1     . exit 0</span></span></code> </pre> <br>  Â«Â» : <pre> <code class="bash hljs">sudo chmod 100 /etc/rc.local &amp;&amp; sudo chmod 100 /etc/init.d/rc.local</code> </pre> <br> ,    GNU/Linux         ntfs,   . <br>   ,      : <br><pre> <code class="bash hljs">systemd-analyze &amp;&amp; systemd-analyze blame</code> </pre> <br><br> <i><b>   ,     .E1   (    / OS GNU/Linux)</b></i> <br> 1)     ext4 &gt; 4gb ( ) Linux  Veracrypt []. <br> 2) Reboot  live usb. <br> 3) ~$ cryptsetup open /dev/sda7 Lunux #  . <br> 4) ~$ mount /dev/mapper/Linux /mnt #    /mnt. <br> 5) ~$ mkdir mnt2 #    . <br> 6) ~$ cryptsetup open --veracrypt --type tcrypt ~/  &amp;&amp; mount /dev/mapper/ /mnt2 #  Veracrypt   Â«Â»     /mnt2. <br> 7) ~$ rsync -avlxhHX --delete --progress /mnt/ /mnt2 #  /      Veracrypt  .  "--delete"      ( ), ..       . <br><br> (p/s/ <b></b> !     GNU/Linux   /  , , Intel &gt; AMD <i>(            Intel &gt; AMD)</i> , <b> </b>          , .   ~/etc/skey â€”       ,    Â«cryptsetup luksAddKeyÂ»     chroot â€”  ,   ~/etc/crypttab   "/etc/skey"  Â«noneÂ»,  rebot-          . <br><br> <u>  IT         Windows/Linux,      .</u> <br> <b>    /   .</b> <br></div></div><br><h2> [F]    GRUB2 </h2><br><div class="spoiler">  <b class="spoiler_title">Einzelheiten</b> <div class="spoiler_text">        /  <i>( .C6.)</i> ,        .    - ,    <i>(   )</i> GRUB2       ,    <i>(       ,      --  grub.cfg).</i> <br><br>  .  <br><br> *    live usb.   <i>()</i>           .    GRUB2   grub.cfg <i>(    )</i>      <i>(  ,   GRUB2,     .    &lt;0&gt;)</i> <br> *   ,    "/mnt/boot/grub/grub.cfg". <br> *   <i>( Â«perskeyÂ»   core.img)</i> <br><br><pre> <code class="bash hljs">grub-install --force --root-directory=/mnt /dev/sda6</code> </pre> <br> *  Â«grub.cfgÂ» &gt; "/mnt/boot/grub/grub.cfg",    , ,    Â«keylogger.modÂ»     ,  Â«grub.cfgÂ» &gt;  Â«insmod keyloggerÂ». , ,   ,    GRUB2 <i>(    )</i>     GRUB2,  Â«grub-mkimage   (-).Â»  Â«-Â»        Â«grub.cfgÂ».        :    Â«modern.cfgÂ», , ,  ~400  <i>(+)</i>   "/boot/grub/i386-pc".          ,   "/boot/grub/grub.cfg",     Â«hashsumÂ»        . <br>  /  GRUB2   ,      <i>(  )</i> "/boot/grub/grub.cfg"   Â«modern.cfgÂ» <br><blockquote> set superusers=Â«rootÂ» <br> password_pbkdf2 root grub.pbkdf2.sha512.10000.DE10E42B01BB6FEEE46250FC5F9C3756894A8476A7F7661A9FFE9D6CC4D0A168898B98C34EBA210F46FC10985CE28277D0563F74E108FCE3ACBD52B26F8BA04D.27625A4D30E4F1044962D3DD1C2E493EF511C01366909767C3AF9A005E81F4BFC33372B9C041BE9BA904D7C6BB141DE48722ED17D2DF9C560170821F033BCFD8 <br></blockquote><br>     -      GRUB2. <br><br>   <i>(   )</i> ,   ,    <i>(    )</i> . - BIOS     <i>(     GRUB2 &gt;  GRUB2, !)</i> .   -     ,    ,     <i>( )</i> Â«grub.cfgÂ»   .      ,  , ,     Â«grub.cfgÂ» <i>(  )   ,     GRUB2.</i> <br><br>     ,  /    sdaY,    GRUB2 <i>( grub-install    )</i>   Â«grub.cfgÂ» <i>( )</i>     <br><blockquote> menuentry 'GRUBx2' --class parrot --class gnu-linux --class gnu --class os $menuentry_id_option 'gnulinux-simple-382111a2-f993-403c-aa2e-292b5eac4780' { <br> load_video <br> insmod gzio <br> if [ x$grub_platform = xxen ]; then insmod xzio; insmod lzopio;  fi <br> insmod part_msdos <br> insmod cryptodisk <br> insmod luks <br> insmod gcry_twofish <br> insmod gcry_twofish <br> insmod gcry_sha512 <br> insmod ext2 <br> cryptomount -u 15c47d1c4bd34e5289df77bcf60ee838 <br> set root='cryptouuid/15c47d1c4bd34e5289df77bcf60ee838' <br> normal /boot/grub/grub.cfg <br>  } <br></blockquote><br>  <br> * insmod -       ; <br> * GRUBx2 -      GRUB2; <br> * cryptomount -u 15c47d1c4bd34e5289df77bcf60ee838 -. fdisk -l (sda9); <br> * set root - ; <br> * normal /boot/grub/grub.cfg -     . <br><br>   ,     Â«grub.cfgÂ» â€”      / Â«sdaYÂ»    Â«GRUBx2Â»   GRUB. <br><br>    CLI,    <i>(      Â«set rootÂ»),</i>    , ,    "/shifr_grub",    "/noshifr_grub".   CLI <br><br><pre> <code class="bash hljs">cat /Tab-Tab</code> </pre> <br>    ,       ,       . , ,              "~/i386",          . <br><br>    ,       <i>( )</i> ,      ,  CLI   <br><br><pre> <code class="bash hljs">list_trusted</code> </pre> <br>      Â«perskeyÂ»,    ,    <i>(   Â«set check_signatures=enforceÂ»)</i> . <br>    ,   .      Â«grub.cfgÂ»     ,           ,      ,   GRUB2. <br>      :    <a href="https://www.gnu.org/software/grub/manual/grub/grub.html" rel="nofollow"></a> .18.2   <blockquote> Â«Note that even with GRUB password protection, GRUB itself cannot prevent someone with physical access to the machine from altering that machine's firmware (eg, Coreboot or BIOS) configuration to cause the machine to boot from a different (attacker-controlled) device. GRUB is at best only one link in a secure boot chainÂ». </blockquote><br> GRUB2 â€”   ,      ,         MS-DOS,      . ,  GRUB2 â€” Â«Â»   ,   GNU/Linux    . <br><br>  ,  ,       GRUB2,        <i>(,   ,     â€“      /.mod)</i> . <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qhmsLeAN2Ag" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><h4>  Schlussfolgerungen: </h4><br> 1)     Windows â€”  ,     ,         GNU/Linux,  :  . <br><br> 2)  ,  ,  <b></b>     VeraCrypt/LUKS on one home the machine, ,       (IMHO).   &gt; 60k         :  ,  <a href="https://en.wikipedia.org/wiki/Talk:FreeOTFE" rel="nofollow"></a> / <a href="https://diskcryptor.net/forum/index.php%3Ftopic%3D5347.msg13975" rel="nofollow"></a>  <a href="https://www.schneier.com/blog/archives/2014/05/truecrypt_wtf.html" rel="nofollow"></a> ;  ,     GNU/Linux /   ;  .51  ;  <a href="http://www.consultant.ru/document/cons_doc_LAW_128739/1aad6fe079cd2555c9c329d872dfca33764f738f/" rel="nofollow"></a> / <a href="http://www.consultant.ru/document/cons_doc_LAW_128739/5b53393f08d12d297d683284d87338c801ed859b/" rel="nofollow">  </a> ,       Â«/bootÂ».      ,   <i>(   )</i> ,   ,     ,    Â« Â». <br><br> 3)     Windows 7 64; GNU/Linux Parrot 4x; GNU/Debian 9.0/9.5. <br><br> 4)     <u></u>  GRUB2. <br><br> 5) Tutorial ,    <s> </s> ,        .      ,          . <br><br> 6)     ,    2020 . <br><br><h2> [G]   </h2><br><ol><li> <a href="https://www.dropbox.com/s/tg2etzeptae73xa/TrueCrypt%2520%25D0%25B4%25D0%25BE%25D0%25BA%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F%2520%25D0%25BF%25D0%25BE%25D0%25B4%2520%25D1%2581%25D0%25B2%25D0%25BE%25D0%25B1%25D0%25BE%25D0%25B4%25D0%25BD%25D0%25BE%25D0%25B9%2520%25D0%25BB%25D0%25B8%25D1%2586%25D0%25B5%25D0%25BD%25D0%25B7%25D0%25B8%25D0%25B5%25D0%25B9.pdf%3Fdl%3D0" rel="nofollow">  TrueCrypt</a> <i>( 2012 RU)</i> </li><li> <a href="https://www.veracrypt.fr/en/Documentation.html" rel="nofollow"> VeraCrypt</a> </li><li> /usr/share/doc/cryptsetup(-run) [ ] <i>(      GNU/Linux   cryptsetup)</i> </li><li> <a href="https://gitlab.com/cryptsetup/cryptsetup/-/wikis/FrequentlyAskedQuestions" rel="nofollow"> FAQ cryptsetup</a> <i>(     GNU/Linux   cryptsetup)</i> </li><li> <a href="https://wiki.archlinux.org/index.php/Dm-crypt/Device_encryption" rel="nofollow">  LUKS</a> <i>(archlinux-)</i> </li><li> <a href="" rel="nofollow">   cryptsetup</a> <i>(  arch)</i> </li><li> <a href="" rel="nofollow">  crypttab</a> <i>(  arch)</i> </li><li> <a href="https://www.gnu.org/software/grub/manual/grub/grub.html" rel="nofollow">  GRUB2</a> . </li></ol><br> : VeraCrypt,   ,  ,   Linux,    LUKS1/LUKS2. <br><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8a/32/f-/8a32f-bolla8my7o-yt9hhlanbi.png"><br> Â© ,     . <br> <a href="https://habr.com/ru/users/ne555/" class="user_link">ne555</a> 2018-2020 <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de482696/">https://habr.com/ru/post/de482696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de482684/index.html">Ich habe in zwei Wochen mein eigenes Dipfake erstellt und $ 552</a></li>
<li><a href="../de482686/index.html">Wissenschaftler automatisieren Tierverhaltensforschung, um die Gehirnfunktion zu entschlÃ¼sseln</a></li>
<li><a href="../de482690/index.html">Erstellen Sie Ihren Publisher in Combine</a></li>
<li><a href="../de482692/index.html">Intel NUC Home fÃ¼r Arbeit und Virtualisierung</a></li>
<li><a href="../de482694/index.html">Gibt es ein Leben nach Windows oder wo kann man 2020 einen Windows-Systemadministrator / -ingenieur entwickeln?</a></li>
<li><a href="../de482698/index.html">[Essay] BÃ¼ro Plankton gewidmet. Ich bin nicht von meiner Arbeit inspiriert</a></li>
<li><a href="../de482700/index.html">Wie man Google und Yandex "fickt": Schwarz-WeiÃŸ-SEO-Werbung fÃ¼r Websites. Schestakow | Menschen PRO # 74</a></li>
<li><a href="../de482702/index.html">Brauchen wir wirklich TypeScript im Jahr 2020?</a></li>
<li><a href="../de482704/index.html">Redis Cache-Synchronisierung fÃ¼r Go-Dienst</a></li>
<li><a href="../de482706/index.html">Empfehlungen zur Implementierung der parallelen Rechnungslegung RAS + IFRS auf der 1C-Plattform</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>