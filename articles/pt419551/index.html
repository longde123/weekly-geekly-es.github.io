<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßöüèº ‚ùóÔ∏è üïû Vulnerabilidade no Telegram pode comprometer conversas secretas üåó üîç üõåüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Publica√ß√£o de anivers√°rio do telegrama 
 Os bate-papos secretos do Telegram usam criptografia de ponta a ponta, e da√≠? Criptografia de ponta a ponta O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vulnerabilidade no Telegram pode comprometer conversas secretas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419551/"><h3>  Publica√ß√£o de anivers√°rio do telegrama </h3><br>  Os bate-papos secretos do Telegram usam criptografia de ponta a ponta, e da√≠?  Criptografia de ponta a ponta O Telegram protege fracamente a correspond√™ncia do usu√°rio.  Um exemplo simples: um invasor conseguiu a chave privada .pgp de Alice, √© claro, para descriptografar a mensagem criptografada para Alice, voc√™ precisa de uma senha para essa chave, que n√£o pode ser removida usando a moderna doutrina de prote√ß√£o por senha.  No Telegram, criptografia de ponta a ponta no Android - isso se torna poss√≠vel com uma probabilidade de 100%.  O desvio da autentica√ß√£o de dois fatores, a recupera√ß√£o do c√≥digo PIN e o seq√ºestro de bate-papos secretos no Telegram sobre essa vulnerabilidade ser√£o um artigo. <br><a name="habracut"></a><br>  No meu trabalho, tentarei descrever um manual detalhado sobre a vulnerabilidade no Telegram em dispositivos Android, dar exemplos de como restaurar o c√≥digo local do Telegram no Android, Desktop Linux / Windows.  Comprometerei o bate-papo secreto do Telegram.  Minha empresa vai me ajudar nesse confronto com a equipe de Durov: I (Root);  Android 7.0;  Android 6.0 (raiz)  Android 4.4.2 (raiz)  PC com SO GNU / Linux / Windows (raiz).  √Ä primeira vista, parece que as for√ßas n√£o s√£o iguais, vamos ver ... <br><br><h4>  IMHO.  Como tudo come√ßou </h4><br>  No meu caso, tamb√©m senti todo o poder da campanha de rela√ß√µes p√∫blicas em torno da plataforma Telegram.  Nas enormes rodas do ‚Äúcarrinho‚Äù, o hype rolava m√™s a m√™s, sem centro e sem fronteiras.  A influ√™ncia de E. Snowden na populariza√ß√£o da criptografia onipresente de correspond√™ncia de usu√°rios.  Lembre-se do cult ICQ messenger com seu aplicativo QIP 2005 na √°rea de trabalho, onde toda a correspond√™ncia foi armazenada em um PC no dom√≠nio p√∫blico em arquivos .txt.  O telegrama sobre a criptografia da correspond√™ncia "que come√ßou a criptografar a correspond√™ncia privada em massa" n√£o o fez imediatamente, mas depois afirmou que ele foi o pioneiro.  A hist√≥ria do Telegram n√£o foi particularmente distinta: uma disputa pela seguran√ßa do protocolo MTProto contra durov;  Kolyma para artistas e pintores (desenho de adesivos);  API para cria√ß√£o de bots / aplicativos;  ICO TON, que trouxe muito dinheiro para os propriet√°rios do Telegram;  bloquear o mensageiro no Ir√£, na Federa√ß√£o Russa e novamente no Ir√£;  bem como entrar na rede de itens on-line raros dos detalhes do Telegram.  Em julho de 2018  "O carrinho tamb√©m correu atrav√©s de mim."  Quando o ‚Äúpr√≥ximo Telegrama‚Äù apareceu no mercado de massa de mensagens instant√¢neas com seu pr√≥prio slogan e uma pequena advert√™ncia (isso √© super r√°pido, simples e gratuito).  "O Telegram √© um aplicativo de mensagens com foco em velocidade e seguran√ßa."  √Ä custa deste √∫ltimo, em um slogan t√£o legal, durov e sua equipe (devido ao forte lado t√©cnico de Nikolai Durov) interagem abertamente com especialistas em seguran√ßa da informa√ß√£o / ca√ßadores de bagagens que encontram / tentam encontrar vulnerabilidades no protocolo MTProto ou bugs na plataforma Telegram.  Os especialistas enviam seu material para security@telegram.org - este √© o m√©todo oficial dessa intera√ß√£o por ‚Äúca√ßadores de recompensas‚Äù e desenvolvedores de Telegram, tamb√©m √© mencionado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">aqui</a> <br><blockquote>  De fato, damos as boas-vindas aos especialistas em seguran√ßa para auditar nosso sistema e agradecemos <b>qualquer feedback</b> (security@telegram.org) </blockquote><br>  Um formato n√£o oficial de comunica√ß√£o, quando as cartas s√£o ignoradas pelos desenvolvedores do Telegram e, em seguida, os especialistas geralmente postam seus tweets no microblog, onde durov comenta sobre alguns deles. <br><br>  Ao servi√ßo do <s>Pr√≠ncipe Negro do</s> usu√°rio, a privacidade na plataforma m√≥vel Telegram √© apresentada como um desenvolvimento inexpugn√°vel, formid√°vel e novo do MTProto de Nikolai Durov.  As conversas secretas no Telegram (daqui em diante MF) s√£o conversas presentes na plataforma m√≥vel Telegram e protegidas por criptografia de ponta a ponta, as chaves s√£o armazenadas apenas nos dispositivos em que foram geradas, e esse tamb√©m √© o orgulho do Telegram-Dubai (chamarei assim).  Os midrange de telegrama s√£o considerados salas de bate-papo muito seguras em todo o mundo, no mundo do Telegram-Dubai.  V√°rias vezes durov sacudiu o ar, comparando seu produto com os concorrentes em forma b√©lica p√∫blica e sempre venceu. <br><br>  Ignorando a criptografia de ponta a ponta do Telegram messenger no Android, um relat√≥rio de bug foi enviado por email para o e-mail mencionado acima.  N√£o recebi resposta, alguns dias depois escrevi para o suporte t√©cnico dos volunt√°rios do Telegram.  Os volunt√°rios me responderam que transmitiriam minha id√©ia √† lideran√ßa do Telegram, pedindo esclarecimentos: para onde e quando enviei minha carta.  Depois de duas semanas de sil√™ncio, lembrei mais uma vez minha carta aos volunt√°rios, desta vez os volunt√°rios mensageiros ignoraram completamente meu lembrete.  Uma semana depois, repeti novamente o envio da carta para o correio oficial do Telegram - n√£o h√° resposta.  O que resta, o que fazer?  se incomodar com o seu relat√≥rio de erros do Telegram via microblogging?, sitiar fontes de comunica√ß√£o n√£o oficiais da equipe durov?  Ou escreva e publique um artigo para a m√≠dia?  Apenas algum tipo de burocracia cibern√©tica se formou nas fileiras do Telegram.  N√£o posso deixar de mencionar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">w9w</a> no habr.com, que, na minha opini√£o, encontrou a melhor vulnerabilidade na plataforma Telegram: vulnerabilidade no telegra.ph.  Conclus√£o - "qualquer usu√°rio" pode editar o artigo de outra pessoa no telegra.ph.  Com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">relat√≥rio de</a> vulnerabilidade do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">w9w</a> (ele encontrou v√°rios), ele tamb√©m n√£o conseguiu entrar em contato com security@telegram.org.  Depois de concluir uma miss√£o burocr√°tica, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">w9w</a> recebeu uma pequena recompensa financeira pelas vulnerabilidades encontradas.  Eu me pergunto √© Telegram gan√¢ncia?  ou algum outro motivo?  De volta ao Telegram, alguns coment√°rios sobre o assunto. <br><br><img src="https://habrastorage.org/webt/bt/qy/qa/btqyqapjuur9cnzfm5itije2vgk.jpeg"><br><br>  Muitas pessoas t√™m seu pr√≥prio √°lbum de fotos de fam√≠lia, e os ca√ßadores de bagagens t√™m seu pr√≥prio hist√≥rico de "bugs / erros / vulnerabilidades encontrados".  No meu PS, ap√≥s a conclus√£o do artigo, pintarei indiferentemente a c√©lula B30 em vermelho, deixando assim minha pergunta para a equipe do Telegram em aberto. <br><br><h4>  Parte 1. Restaure o Telegram do c√≥digo local no SO Android Linux / Windows Desktop.  Baseado em eventos reais. </h4><br>  Em julho, ver√£o 2018  no Github, um dos desenvolvedores de <s>um agrupamento informal da</s> vers√£o de John The Ripper (doravante JTR) postou o c√≥digo fonte do m√≥dulo de an√°lise "telegram2john.py" escrito em Python (com base em uma dica de um usu√°rio "aleat√≥rio" que leu o c√≥digo da linha <a href="" rel="nofollow">411</a> ) .  A partir do nome do programa, fica claro por que e para quem esse m√≥dulo serve.  Quem n√£o entende o significado de tais m√≥dulos, esses s√£o m√≥dulos que estendem a funcionalidade JTR.  O JTR oficial pode estripar 8 formatos e o JTR jumbo-1-sangramento - 263 formatos (sem contar + centenas de formatos din√¢micos sha1 / 2 / md5 / $) e um desses formatos √© o c√≥digo local do Telegram.  Depois de testar o "telegram2john.py", encontrei um erro: uma das tr√™s fun√ß√µes de an√°lise de c√≥digo local do Telegram n√£o funcionou corretamente, o que relatei aos desenvolvedores de JTR no Github.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">A corre√ß√£o</a> para "telegram2john.py" saiu imediatamente.  Este n√£o √© o primeiro recurso para os bugs encontrados pelos desenvolvedores do JTR, e cada vez que uma resposta r√°pida e uma corre√ß√£o de erro menos r√°pida s√£o boas quando existem canais de comunica√ß√£o estabelecidos todos os dias.  Depois de alguns dias <s>em uma veche secreta</s> , o m√≥dulo telegram2john.py foi aprovado e enviado ao reposit√≥rio JTR. <br><br>  <b>O esquema de recupera√ß√£o de c√≥digo local (Desktop-Telegram) √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">processo de v√°rias etapas</a> :</b> <br><br> <code>Read the salt (32 bytes), encrypted data and sha1 of decrypted data from a file. <br> Compute a PKCS5_PBKDF2_HMAC_SHA1 on the UTF8 (passcode), using the salt, 4000 iterations, keysize of 256 bytes <br> Use a Telegram-specific KDF to get the AesKey and AesIV (Relatively cheap - bunch of memcpy and 4x sha1) <br> Perform an AES-IGE-DECRYPT on the encrypted data using the derived key and IV from step 3. <br> Compare sha1 of decrypted data with the sha1 read in step 1. If they match - passcode is correct. <br></code> <br>  <b>userconfing.xml (Android)</b> <br><br><img src="https://habrastorage.org/webt/mu/dw/rq/mudwrqg9shykcb2mxwddmbaf4g8.png"><br>  Internals <code>/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> <br><br>  Para o usu√°rio JTR, a opera√ß√£o ‚Äúsangramento / Android-Telegram‚Äù √© simplificada para um processo de dois est√°gios: usando o m√≥dulo ‚Äútelegram2john.py‚Äù, ‚Äúhash drawing‚Äù para o processador John a partir do arquivo userconfing.xml pertencente ao aplicativo Telegram (opera√ß√£o instant√¢nea) e for√ßa bruta esse "hash" usando o JTR.  Com essa opera√ß√£o, a probabilidade de recupera√ß√£o de c√≥digo local no Android e √© 100% bem-sucedida, o tempo de espera √© de v√°rios milissegundos.  A probabilidade de recuperar c√≥digo local no Desktop Linux / Windows √© de X% de sucesso, o tempo de espera √© indefinido.  Porque  Como, em primeiro lugar, o c√≥digo local √© um c√≥digo PIN digital comum em um telegrama de quatro d√≠gitos (10 ^ 4 todos os tipos de combina√ß√µes de pinos) n√£o √© mais nem menos e, em segundo lugar, o algoritmo de criptografia de telegrama de c√≥digo local no Android n√£o √© <b>criptogr√°fico [SHA256 ($ s. $ p. $ s)]</b> , da√≠ a alta velocidade de adivinha√ß√£o de senha.  A situa√ß√£o √© diferente nos aplicativos Telegram Desktop onde n√£o h√° bate-papos secretos: no aplicativo Desktop, a criptografia de c√≥digo local √© forte (a velocidade de pesquisa na CPU de hash Desktop / Telegram √© 10.000 vezes mais lenta que a velocidade de pesquisa de hash Anroid / Telegram) e, o mais importante o c√≥digo local no Desktope / Telegram pode ser definido como "qualquer" comprimento e usar qualquer caractere. <br><br><img src="https://habrastorage.org/webt/ls/ub/b0/lsubb0cle23xy2pkv_wkzmm7fi4.png"><br>  <i>A for√ßa criptogr√°fica do c√≥digo local do Telegrama para desktop √© alta, a velocidade da for√ßa bruta √© 10k vezes mais lenta que o c√≥digo local da for√ßa bruta do Android Telegram.</i> <br><br>  Pessoalmente, tenho a impress√£o de que os desenvolvedores do Telegram trabalharam na cria√ß√£o de um protocolo MTProto exclusivo e seguro, e n√£o na privacidade abrangente do usu√°rio, por exemplo, o cache aberto do aplicativo armazenado em um diret√≥rio raiz n√£o Android ou c√≥digo local n√£o criptogr√°fico, que, como se v√™, recupera com 100% de probabilidade. <br><br>  No momento da reda√ß√£o deste artigo, as JTRs prontas para uso nos sistemas operacionais Kali Linux e Parrot Security mais recentes n√£o s√£o atualizadas desde 2015, possuem bugs que n√£o permitem analisar o c√≥digo local do telegrama (o jTR-1-bleeding JTR sempre possui alguns bugs, mas sua funcionalidade desenvolve-se mais √≠ngreme do que voc√™ pensa se pensar no software Hashcat).  Portanto, um usu√°rio experiente do Kali / Parrot n√£o pode invadir para restaurar o Telegram do c√≥digo local; no Windows / Android, os JTRs truncados na funcionalidade tamb√©m n√£o s√£o bons.  Portanto, voc√™ deve instalar o JTR com Github no seu sistema operacional (para sistemas Linux).  Para que o software JTR seja compilado com √™xito, antes de compilar o programa, entregue o pacote ao seu sistema operacional ‚Äúlibssl-dev‚Äù e, em seguida, <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git://github.com/magnumripper/JohnTheRipper -b bleeding-jumbo john &amp;&amp; apt-get install libssl-dev &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> john/src &amp;&amp; ./configure &amp;&amp; make -s clean &amp;&amp; make -sj4 john/run/telegram2john.py userconfing.xml &gt;  <span class="hljs-comment"><span class="hljs-comment">#  "telegram2john.py"   GNU/Linux ,   : python telegram2john.py userconfing.xml &gt;  JohnTheRipper/run/john  --mask=?d?d?d?d #    ‚Äì  local code Android Telegram   .</span></span></code> </pre><br><img src="https://habrastorage.org/webt/99/l7/mg/99l7mgbd_gjlbyfxzaae_f7tvwa.png"><br>  <i>C√≥digo local restaurado Android Telegram.</i>  <i>Pino 5369.</i> <br><br>  Da mesma forma, com o c√≥digo local bruto do aplicativo Linux / Windows local do Telegram, em vez do arquivo userconfing.xml, o caminho para o diret√≥rio Telegram √© indicado: <br><br>  (Linux): ~ / telegram2john.py ~ / .local / share / TelegramDesktop; <br>  (Windows): ~ / telegram2john.py ‚ÄúC: / Usu√°rios / Nome / AppData / Roaming / Telegram Desktop‚Äù (para um aplicativo Telegram desatualizado no Windows); <br>  (Windows): ~ / telegram2john.py ‚ÄùTelegram Desktop" (para o aplicativo Telegram atualizado no Windows). <br><br>  Observe que, se voc√™ deseja analisar o c√≥digo local do telegrama novamente, o JTR exibir√° "Sem senha".  O motivo √© que a senha j√° foi encontrada anteriormente.  Johnny, nunca restaura uma senha na segunda e subsequente vez. Em vez disso, use a op√ß√£o "--show hash", mas √†s vezes os erros podem acontecer e a op√ß√£o "--show" n√£o funcionar√° como deveria (encontrei esses erros com outros hashes, mas tudo j√° foi corrigido pelos desenvolvedores do JTR).  Nesse caso, observe o arquivo ~ / john / run / john.pot, todas as senhas encontradas s√£o armazenadas nele; se voc√™ a limpar, poder√° refutar os hashes com as senhas encontradas. <br><br><img src="https://habrastorage.org/webt/4l/ta/gz/4ltagz1y7hbtdec1le1mxt2pabi.png"><br>  <i>John The Ripper n√£o vai sujar as m√£os <s>de sangue</s> sobre o c√≥digo local Android Telegram</i> <br><br>  <b>o arquivo userconfing.xml</b> , que √© o destino da JTR, est√° localizado no diret√≥rio raiz do Android: <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  Assim, voc√™ pode acessar o arquivo com direitos de root, atrav√©s do TWRP ou usando an√°lise forense digital. <br><br>  Um manual de v√≠deo detalhado para recuperar o c√≥digo local do Telegram no link Android / Linux / Windows no final do artigo. <br><br><h4>  Parte 2. O branco come√ßa e perde.  Roubo de conversas secretas no Telegram.  Baseado tamb√©m em eventos reais. </h4><br>  <b>Como a prote√ß√£o se baseia no Telegram:</b> <br><br><ol><li>  Digite o n√∫mero de telefone; </li><li>  Recebendo SMS ou c√≥digo no aplicativo em outro dispositivo - opcional, digitando o c√≥digo ou c√≥digo SMS recebido no aplicativo em outro dispositivo. </li><li>  Bloqueio tempor√°rio de conta com login frequente (incluindo bem-sucedido) do usu√°rio. </li></ol><br>  Ao interceptar um SMS, voc√™ pode invadir a conta do usu√°rio, mas n√£o pode acessar as conversas secretas do <s>terrorista</s> , uma vez que elas existem e vivem apenas nos dispositivos <s>do capanga do ISIS</s> , onde foram geradas, o que significa que voc√™ n√£o ser√° especialmente cauteloso com os que controlam as operadoras m√≥veis. <br><br>  <b>Prote√ß√£o Telegram b√°sica + b√°sica opcional:</b> <br><br><ol><li>  Digite o n√∫mero de telefone; </li><li>  Receber SMS ou c√≥digo no aplicativo em outro dispositivo - √† vontade, digitando o c√≥digo ou c√≥digo SMS do aplicativo; </li><li>  Digite o c√≥digo de nuvem Telegram (armazenado no servidor Telegram e, em sua mente, redefinir / vincular via e-mail); </li><li>  Definir c√≥digo local (no Android, configura√ß√µes - privacidade e seguran√ßa - c√≥digo de senha); </li><li>  Verificar as sess√µes atuais / recentes de entrada no messenger; </li><li>  Saia de todas as sess√µes, exceto a atual; </li><li>  Limpando o conte√∫do do cron√¥metro de gama m√©dia; </li><li>  Proibi√ß√£o da tela / gravar tela de m√©dio porte; </li><li>  Bloqueio tempor√°rio de conta com login frequente (incluindo bem-sucedido) do usu√°rio; </li><li>  Como aconteceu durante o roubo do midrange (fazendo login na conta de outra pessoa de outro ip), uma proibi√ß√£o tempor√°ria da conta real / comprometida ~ ap√≥s 5 minutos e o cancelamento do midrange no Telegram.  Na mesma rede de contas reais / comprometidas, o Telegram esquece de proibir o seq√ºestro de uma conta. </li></ol><br>  <b>Abaixo, mostrarei que a faixa intermedi√°ria √© vulner√°vel, sequestrarei uma delas (minha conta de teste no Telegram) e representarei o usu√°rio "Boss"</b> <b><br></b> <br>  Ap√≥s recuperar com √™xito o c√≥digo local do Telegram, decidi sentir os arquivos ao lado do arquivo userconfing.xml no Android.  Criou um bate-papo secreto, analisou quais arquivos e em quais subdiret√≥rios s√£o atualizados no tempo.  Tentei copiar esses arquivos do sistema operacional Android 4.4.2 para outro dispositivo com o sistema operacional Android 6.0 (transferi arquivos entre dispositivos por meio de arquivos rar; zip).  Instalado com o GP a vers√£o mais recente do Telegram no Android 6.0.  Transferido do Android 4.4.2&gt; Arquivos atualizados do Android 6.0 para diret√≥rios semelhantes <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs /data/data/org.telegram.messenger/files /data/data/org.telegram.messenger/no_backup</code> </pre><br>  De acordo com a conta de teste <s>roubada</s> , o Telegram restaurou os direitos (que estavam no 4.4.2) para cada arquivo e pasta pessoalmente, a opera√ß√£o n√£o √© r√°pida (arquivos diferentes t√™m os direitos mais diversos), atribu√≠da o Telegram UID GID. <br><br><img src="https://habrastorage.org/webt/mg/lv/gf/mglvgf6i9sojpxamtme5sznrook.jpeg"><br><br>  Lan√ßou o aplicativo.  Imediatamente todos os arquivos roubados foram atualizados a tempo e a tela "novo usu√°rio" me recebeu.  O Telegram se comportou como se eu fosse um novo usu√°rio e sugeriu o registro ou o login via telefone (o procedimento padr√£o para a instala√ß√£o inicial do Telegram no Android).  Ou seja, n√£o consegui entrar na conta de outra pessoa.  Sneaked mais e mais v√°rias vezes de lados diferentes, mas no final - um <b>arquivo</b> . <br><br>  <b>Tentei de outra maneira - backup da conta de teste do Telegram via backup do Titanium.</b> <br>  Fiz um backup do aplicativo no Android 4.4.2, implantei um backup do 4.4.2.  no Android 6.0. <br><br><img src="https://habrastorage.org/webt/iu/eb/7v/iueb7vcq3h-upyl2_xxyl3qewoc.jpeg"><br><br>  Os direitos do aplicativo "roubado", alterando o UID / GID, n√£o s√£o necess√°rios - tudo ser√° feito pela Titanium Base.  Lancei contas comprometidas do Telegram no Android 6.0 e magia!  Recebo uma solicita√ß√£o para inserir o c√≥digo local do usu√°rio "Host".  Esse jogo intermedi√°rio com um backup fornecia um desvio da autentica√ß√£o de dois fatores sem v√≠timas e truques.  O Telegram, por sua vez, solicitou apenas o c√≥digo local da conta roubada.  Enviar arquivo roubado <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  no VDS com o Kali Linux instalado, onde o JohnTheRipper n√£o dorme mais nos processos em execu√ß√£o, √© hora de agir.  No instante seguinte, o inferno bateu o c√≥digo local!  Hash n√£o aguentou um segundo, rachado. <br><br><img src="https://habrastorage.org/webt/vq/kz/s-/vqkzs-lt2vvyp1o7rw389sf7be0.jpeg"><br><br>  Destaque em vermelho (de cima para baixo) recebido: <br><br><ul><li>  Hash para JTR usando o m√≥dulo telegram2john.py; </li><li>  C√≥digo local recondicionado Android Telegram; </li><li>  Trabalho em per√≠odo integral de Johnny (senha indecentemente de alta velocidade de for√ßa bruta, op√ß√£o - - -mask =? D? D? D? D, dizendo a Johnny que ele seleciona um c√≥digo digital de 4 d√≠gitos, n√£o o liga, para que o JTR acelere e mostre sua velocidade de <s>f√∫ria</s> ); </li><li>  Solicite a JTR do c√≥digo local restaurado. </li></ul><br>  Johnny legal!  isso n√£o √© verdade? <br><br>  <s>Tendo abusado da "parte" da propriedade do Telegram,</s> restaurado o c√≥digo local Telegram usando o JTR Android, ele fez login com sua conta de teste IP na conta de <s>outra pessoa</s> , originalmente localizada no Android 4.4.2. E agora foi constru√≠da no Android 6.0.  Ao mesmo tempo, vejo todas as conversas secretas da v√≠tima e toda a correspond√™ncia nelas.  Tentei escrever, no midrange criado anteriormente, para um usu√°rio do Android 7.0 e a mensagem foi enviada com sucesso.  O usu√°rio do Android 7.0 enviou uma resposta, a mensagem de resposta n√£o foi apenas recebida, mas recebida em dois gadgets: no Android 6.0 e no Android 4.4.2.  Eu verifiquei a √∫ltima sess√£o de login: o usu√°rio real exibiu seu ip e seu gadget Teclast Android 4.4.2 (configura√ß√µes - privacidade e seguran√ßa - sess√µes ativas);  um invasor Android 6.0 em "sess√µes ativas" exibia o dispositivo Teclast Android 4.4.2, ip Virginia.  Ou seja, o usu√°rio real n√£o recebe informa√ß√µes atrav√©s de "Sess√µes ativas" que sua conta foi comprometida, mas recebe informa√ß√µes "falsas" de que ele est√° online de um de seus dispositivos e de um de seu IP. <br><br><img src="https://habrastorage.org/webt/ps/5h/vi/ps5hviqijte1q-4ltk_1ucmhc48.jpeg"><br><br>  O usu√°rio real atrav√©s de sess√µes ativas n√£o v√™ que ele est√° comprometido.  O hist√≥rico de sess√µes recentes n√£o registra os pontos de entrada do invasor.  Al√©m disso, na conta real "Host", cliquei em "sair de todas as sess√µes, exceto a atual".  Ao mesmo tempo, o invasor n√£o foi expulso da sess√£o, independentemente do status online / offline do invasor. <br><br>  Tentei a mesma opera√ß√£o em rela√ß√£o a uma conta comprometida - o resultado √© semelhante: o ‚Äúmestre‚Äù n√£o foi expulso do telegrama, as chaves da sess√£o eram as mesmas.  Incrivelmente, n√©? <br><br>  As teclas gr√°ficas podem indicador de seguran√ßa de m√©dio porte?  As chaves das conversas secretas n√£o s√£o um indicador de seguran√ßa; nesse experimento, as tr√™s est√£o batendo entre si. <br><br><img src="https://habrastorage.org/webt/am/ei/zy/ameizyvemokjmzivi6o6wf2ig1y.jpeg"><br>  <i>Todas as chaves s√£o iguais, incluindo uma conta comprometida.</i> <br><br>  O Telegram afirma que, se as teclas forem pressionadas em 2 dispositivos, voc√™ estar√° seguro - n√£o √© assim.  <i>(Digress√£o. Voc√™ ainda precisa verificar as chaves, depois de instalar o Telegram no Android e ao criar os primeiros usu√°rios de m√©dio porte, os usu√°rios de m√©dio porte n√£o tiveram instant√¢neos de chave, e as imagens gr√°ficas das chaves diferiam nos dispositivos. Os m√©dios funcionavam normalmente, o que eu n√£o entendia e era um caso isolado quando as teclas n√£o batiam entre si).</i> <br><br>  <b>Voltei ao primeiro m√©todo de "copiar e colar", que inicialmente n√£o obtive √™xito.</b> <br><br>  Repeti todas as etapas anteriores, adicionando uma terceira a√ß√£o intermedi√°ria. <br><br>  1) Instalado com o GP a vers√£o mais recente do Telegram. <br><br>  2) Diret√≥rios transferidos do OS 4.4.2 para outro dispositivo com o OS 6.0 (apenas dados confidenciais transferidos. Eu n√£o copiei o Telegram e seus outros diret√≥rios) <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs /data/data/org.telegram.messenger/files /data/data/org.telegram.messenger/no_backup</code> </pre> <br>  3) <b>Excluiu a pasta no Android 6.0</b> , verifique <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/code_cache</code> </pre> <br>  4) Eu n√£o restaurei pessoalmente os direitos; em vez disso, distribu√≠ 777 direitos (acesso total) a todos os diret√≥rios descritos acima "recursivamente".  Atribu√≠ os mesmos diret√≥rios ao propriet√°rio e propriet√°rio do grupo (UID / GID) "Telegram" (na verdade, "recursivamente" no diret√≥rio raiz n√£o funciona bem no TC, ent√£o tive que verificar duas vezes a atribui√ß√£o de direitos). <br><br>  5) Atacante!  Eu inicio o Telegram em outra rede com uma falha de IP diferente, novamente √© uma sauda√ß√£o de um novo usu√°rio em ingl√™s. <br><br>  6) Atacante!  Reinicie o Telegram, xeque-mate!  O Telegram emitiu um aviso para inserir o c√≥digo local de um usu√°rio que estava no Android-e 4.4.2 (e que √© restaurado com uma probabilidade de 100%), enquanto n√£o houve solicita√ß√µes do Telegram para o c√≥digo da nuvem ou SMS e ainda est√° completamente ausente.  Desvio de autentica√ß√£o de dois fatores, n√£o!  Ignorando criptografia ponta a ponta O Telegram foi bem-sucedido. <br><br>  Resultado: as mensagens de um invasor na faixa intermedi√°ria tamb√©m foram enviadas com sucesso em nome de um usu√°rio real e toda a correspond√™ncia da faixa intermedi√°ria tamb√©m estava dispon√≠vel.  Depois de ~ 400 batidas no meu cora√ß√£o ansioso, os medos foram confirmados: a conta roubada foi bloqueada pelo Telegram por um invasor e um usu√°rio real;  MF - cancelado. <br><br><img src="https://habrastorage.org/webt/jr/ge/s2/jrges2a2eoeptmbpv5jm48j3g0s.jpeg"><br>  <i>Bloqueio tempor√°rio da conta do Telegram.</i> <br><br>  Depois de fazer login novamente no Telegram (√†s vezes a proibi√ß√£o acontece por um dia, mas tenho sorte, por algum motivo todos os sinos foram distribu√≠dos por um segundo naquele dia), o usu√°rio real tinha tudo como sempre, e o invasor n√£o conseguia mais cheirar a conta comprometida (as chaves da sess√£o foram atualizadas). <br><br><h4>  Consegui refutar v√°rias declara√ß√µes do Telegram </h4><br><blockquote>  telegram.org/faq - ‚ÄúMFs s√≥ podem estar em dispositivos de origem MF‚Äù. </blockquote>  I - "Como voc√™ pode ver, a faixa intermedi√°ria pode estar n√£o apenas nos dispositivos de origem da faixa intermedi√°ria, mas tamb√©m nos dispositivos em que h√° uma chave Raiz e faixa intermedi√°ria, independentemente da vers√£o do sistema operacional Android". <br><blockquote>  telegram.org/faq - ‚ÄúVoc√™ pode comparar esta imagem (nota: imagem do meio da chave) com a que seu amigo possui - se as duas imagens forem iguais, voc√™ pode ter certeza de que o bate-papo secreto √© seguro‚Äù </blockquote>  I - "Sim, seguro, mas apenas no mundo do Telegram-Dubai";  "Voc√™ n√£o pode ter certeza de que o bate-papo √© seguro." <br><blockquote>  telegram.org/faq - ‚ÄúTamb√©m recomendamos que voc√™ ative a autentica√ß√£o em duas etapas e defina um c√≥digo de acesso forte para bloquear seu aplicativo. Voc√™ encontrar√° as duas op√ß√µes nas configura√ß√µes - Privacidade e seguran√ßa.‚Äù </blockquote>  I - ‚ÄúUm c√≥digo de acesso forte pode ser definido apenas em aplicativos Linux / Windows do Telegram Desktop, mas n√£o pode fixar /‚Äú senha ‚Äùem um aplicativo Android‚Äù <br><blockquote>  telegram.org/faq - ‚ÄúUm usu√°rio com acesso root pode ignorar facilmente os recursos de seguran√ßa integrados ao sistema operacional, ler a mem√≥ria do processo ou acessar √°reas restritas, como armazenamento interno.  Depois que um invasor tem acesso √† raiz, qualquer esfor√ßo de mitiga√ß√£o se torna in√∫til.  "Nenhum aplicativo pode ser chamado de seguro nessas circunst√¢ncias, n√£o importa qu√£o fortemente criptografado." </blockquote>  I - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Bobagem de marketing</a> , devido √† falta de pessoal t√©cnico qualificado em 2013."  ‚ÄúRestaure o c√≥digo local do Android e obtenha / clone a conta.  A cada nova tentativa incorreta de inserir um pino, o Telegram aumenta o tempo de espera entre as tentativas de inserir um pino.  Aparentemente, o Telegram est√° satisfeito com esse algoritmo para proteger o usu√°rio da for√ßa bruta manual 10 ^ 4 de todas as combina√ß√µes poss√≠veis de pinos, mas o usu√°rio fica satisfeito quando √© f√°cil comprometer?  Se os desenvolvedores do Telegram quiserem atenuar as amea√ßas nessas circunst√¢ncias, poder√£o implement√°-lo como um bloqueio tempor√°rio por alguns segundos, digitando o c√≥digo local incorretamente e substituindo a fun√ß√£o de alfinete ‚Äúfalso‚Äù por Telegram na senha por senha, com criptografia PBKDF2 - isso √© muito forte retardar√° o ataque da for√ßa bruta.  Como um exemplo de boa prote√ß√£o - senha para entrar no banco de dados de senhas criptografadas Keepass2Android. <br><blockquote>  telegram.org/faq ‚ÄúVoc√™ pode acessar mensagens de bate-papo secretas no seu dispositivo de origem.  Eles est√£o seguros desde que seu dispositivo esteja seguro no seu bolso. ‚Äù </blockquote>  I - "√â a√≠ que a verdade acontece!" <br><br><h4>  Conclus√µes </h4><br><ul><li>  O c√≥digo local Telegram (pin) no Android e √© hackeado no JTR instantaneamente e com uma probabilidade de 100%, isso leva a consequ√™ncias: roubar bate-papos secretos, abrir mensagens de SC, passar um atacante como um usu√°rio real.  A prote√ß√£o contra esse "truque" √© uma proibi√ß√£o tempor√°ria do Telegram e novas chaves de sess√£o para o usu√°rio real. </li><li>  A opera√ß√£o para roubar a faixa intermedi√°ria √© semelhante ao roubo de cookies + pino de hacking + "problemas com direitos" se voc√™ usar o m√©todo "copiar e colar". </li><li>  Para restaurar o PIN / senha do Telegram no Android, voc√™ precisa trabalhar com o arquivo do aplicativo messenger localizado em <br><br><pre> <code class="plaintext hljs">/data/data/org.telegram.messenger/shared_prefs/userconfing.xml</code> </pre> <br>  Voc√™ pode acessar "arquivos confidenciais" com privil√©gios de root, via TWRP ou usando an√°lise forense digital. </li><li>  Para um invasor, o seq√ºestro √© uma oportunidade n√£o apenas de despejar correspond√™ncia, mas tamb√©m de causar danos ao verdadeiro propriet√°rio da conta: por exemplo, para limpar "sua" nuvem.  Nesse caso, o usu√°rio real perder√° irrevogavelmente seus dados nos "favoritos".  Exclua oficialmente a conta do Telegram e, por exemplo, voc√™ era o administrador de uma comunidade, perderia os privil√©gios de administrador. </li><li>  Muitas vezes, os usu√°rios definem o c√≥digo local no Telegram Desktop-e o mesmo que o alfinete no Android-e - isso √© uma armadilha, o c√≥digo local de quatro d√≠gitos do Telegram no Windows / Linux ultrapassa &lt;1 minuto e o acesso a um PC geralmente √© mais f√°cil do que o acesso a um gadget. </li><li>  UPD  Os desenvolvedores de telegrama devem substituir o ‚Äúpin‚Äù no Android-e por ‚Äúpassword‚Äù, por criptografia criptogr√°fica (conforme implementada no Telegram Desktop-e ou em outros aplicativos m√≥veis, por exemplo, Keepass ...) usando, por exemplo, PBKDF2 e assim por diante ... <br>  E tamb√©m desate a fun√ß√£o de desbloqueio de impress√£o digital (no gadget em que o dispositivo n√£o possui impress√£o digital) ao abrir um novo banco de dados (esta √© a <b>terceira <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vulnerabilidade no Telegram</a> / Android</b> que eu ignorei em meus experimentos).  N√£o importa qual c√≥digo local pin / pass foi instalado na conta roubada (voc√™ nem pode decifr√°-lo), a conta da v√≠tima pode ser acessada por impress√£o digital (qualquer impress√£o digital instalada no gadget do atacante funciona contra o Telegram, mas o ataque de impress√£o digital n√£o funciona contra Dinheiro Yandex, Keepass2android offline, Sberbank online). </li><li> security@telegram.org,       Telegram,      -   . </li><li>   ¬´¬ª Telegram    GP,        Passport telegram,    ,  ,         ,      . </li><li>  - ( ) Telegram   .      . </li></ul><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-p/zt/iq/-pztiqxrayw-cdrexspsi3hmf9y.jpeg"><br></div></div><br> <b>  local code Telegram  Android/Linux/Windows.</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OzFAyOJ5MPw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <b>    Telegram.</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zRO_KsPZJto" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <i>PS: /     -   ,     Telegram       ,  -   Telegram-    .</i> <br><br> <i>PPS:       root-.       root ( ),   -     root   .  ,    GNU/Linux     ¬´  ¬ª (Android ‚Äî  Linux  GNU   ).      Windows  ¬´¬ª       ?  Android-     ,   . <br>  :      gpg/pgp ,    keepass2android offline,       rar.  ¬´¬ª  /      root        .  Telegram Android    pin,          100% .</i> <br><div class="spoiler"> <b class="spoiler_title">...</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rz/cf/oy/rzcfoywf1y9lphimjjal0l-2nqe.jpeg"><br></div></div><br> <i>       local code  Android-e ¬´password¬ª  ¬´pin¬ª. <u>    :</u> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> ...</a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt419551/">https://habr.com/ru/post/pt419551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt419531/index.html">Escolhendo o par perfeito para seus ouvidos: dez dicas pr√°ticas</a></li>
<li><a href="../pt419535/index.html">Atualiza√ß√£o na torradeira</a></li>
<li><a href="../pt419537/index.html">CyberDemons: Intelig√™ncia Artificial DOOM 2016</a></li>
<li><a href="../pt419539/index.html">Semin√°rio on-line aberto "Programa√ß√£o ass√≠ncrona em Python"</a></li>
<li><a href="../pt419547/index.html">Organizando um resumo regular de log com python e ansible usando asterisk como exemplo</a></li>
<li><a href="../pt419557/index.html">Figo-figo e em produ√ß√£o. Lan√ßamos o RegionSoft CRM 7.0</a></li>
<li><a href="../pt419559/index.html">Como fazer pesquisas de usu√°rios no GitHub usando React + RxJS 6 + Recompose</a></li>
<li><a href="../pt419561/index.html">As operadoras de telefonia m√≥vel ainda cancelam a taxa de roaming nacional</a></li>
<li><a href="../pt419567/index.html">Roskomnadzor e a Procuradoria Geral da Rep√∫blica excederam sua autoridade ao bloquear o Telegram</a></li>
<li><a href="../pt419569/index.html">Slurm: v√≠deo de aulas e facaps organizacionais</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>