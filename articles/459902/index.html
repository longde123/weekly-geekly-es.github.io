<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèº üë®üèΩ‚Äçüé® ü•¢ Mapa interactivo de regiones rusas para principiantes. Errores que comet√≠ y que no debes cometer üöΩ ‚ùì üë©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, le dir√© c√≥mo encontramos errores t√≠picos al crear un mapa interactivo, y lo m√°s importante, le dar√© enlaces a mapas normales y actua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mapa interactivo de regiones rusas para principiantes. Errores que comet√≠ y que no debes cometer</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459902/"><p>  En este art√≠culo, le dir√© c√≥mo encontramos errores t√≠picos al crear un mapa interactivo, y lo m√°s importante, le dar√© enlaces a mapas normales y actuales de las entidades constitutivas de la Federaci√≥n Rusa. </p><br><img src="https://habrastorage.org/webt/fr/zl/1t/frzl1tzsb5rukh8hezpfrjo6o1s.png"><br><p>  Nuestro reto  Cree un mapa interactivo para que cuando pase el mouse sobre una regi√≥n, se active un controlador de eventos y muestre algunos datos por regi√≥n (por ejemplo, su nombre). <br>  A primera vista, esto parece muy simple, pero m√°s adelante en el art√≠culo le dir√© c√≥mo pasamos m√°s de 3 d√≠as para solucionarlo y, lo m√°s importante, para identificar errores. </p><a name="habracut"></a><br><p>  Entonces, comenzamos el proyecto.  Para empezar, necesitamos, de hecho, el mapa en s√≠ mismo: vaya a Google para obtener un mont√≥n de diferentes formatos de datos de mapas. </p><br><p>  Como no somos geoanalistas profesionales, en principio, no nos interesan los formatos: lo principal es trabajar, por lo que no consideraremos todo y todo aqu√≠, pero destacaremos dos grupos principales. </p><br><ul><li>  Tarjetas de vectores </li><li>  Mapas con metadatos </li></ul><br><p>  Los mapas vectoriales son un pol√≠gono vectorial regular que repite la forma de un objeto, por ejemplo, un pa√≠s.  El formato principal para este tipo de tarjeta es SVG.  Y dir√© de inmediato por qu√© es malo para nuestro proyecto y por qu√© no deber√≠a usarse en mapas interactivos.  Es simplemente una figura geom√©trica sin datos, incluso sin un nombre.  Si no es un masoquista, no atornillar√° manualmente el controlador de eventos a cada pol√≠gono e ingresar√° manualmente toda la informaci√≥n sobre el objeto, desde siglas en diferentes idiomas hasta estado administrativo.  Si puede hacer esto con un mapa de distritos federales, entonces a nivel de distrito simplemente morir√°. </p><br><p>  Mapas con metadatos.  Los mapas con metadatos, si est√°n en un lenguaje muy simple, son los mismos pol√≠gonos vectoriales, solo que con informaci√≥n conectada dentro.  Hay muchos formatos, enumerar√© los principales: GeoJSON, SHP, GeoTIFF, MIF, TAB, KML.  En general, hay muchos de ellos, cada uno de ellos tiene sus propias caracter√≠sticas, sobre las cuales solo una persona que conoce los sistemas SIG puede decirle. </p><br><p>  Este art√≠culo solo trata sobre GeoJSON debido al hecho de que el proyecto decidi√≥ usar solo este formato con metadatos.  Todos los mapas a continuaci√≥n contienen el nombre de la regi√≥n, su descripci√≥n, poblaci√≥n, etc. </p><br><p>  Descubrimos el formato y estamos buscando datos con una extensi√≥n espec√≠fica.  Y entonces comienza la diversi√≥n.  ¬øCrees que es f√°cil encontrar buenos mapas de trabajo de la Federaci√≥n Rusa?  Pff, no estaba all√≠, te espera mucha aventura.  Entonces, descarg√≥ el mapa, configur√≥ todo, lo lanz√≥ y ... </p><br><img src="https://habrastorage.org/webt/3n/fe/l_/3nfel_fnki8v27zf60-64noffsq.jpeg"><br><p>  Crimea  Los primeros enlaces en google van a gis-lab.  Y en estos mapas no hay pen√≠nsula.  Todo es simple aqu√≠.  Las principales tarjetas rusas se hicieron en 2000 y 2010, es decir, antes de que Crimea fuera incluida en la Federaci√≥n de Rusia, y muchos servicios occidentales no reconocen la adhesi√≥n y no agregan la pen√≠nsula a sus tarjetas.  Y si inserta un mapa sin Crimea en su proyecto, mientras est√° en Rusia, usted mismo comprende lo que podr√≠a suceder.  Por lo tanto, hacer un mapa sin este territorio no es una opci√≥n. <br>  Soluci√≥n: busque conjuntos de tarjetas de aficionados posteriores a 2014 o servicios extranjeros que a√∫n agreguen Crimea a las tarjetas rusas.  Pero lo m√°s probable es que no los encuentres. </p><br><p>  Vayamos m√°s all√°.  Vamos a Google, manejamos en "descargar temas geojson de la Federaci√≥n Rusa", buscamos, descargamos el mapa de mydata.biz y ... Todo est√° hinchado con nosotros. </p><br><img src="https://habrastorage.org/webt/a-/da/te/a-datejv8bvoune008mr2u6sprm.jpeg"><br><p>  Fronteras flotantes.  En algunos mapas, las aguas territoriales est√°n incluidas en los temas.  Debido al hecho de que el territorio de todos los sujetos que bordean el mar se incrementa en 24 km, el mapa parece "flotante", especialmente las regiones con la costa y las islas.  Si no tienes pretensiones, entonces probablemente puedas usar esta tarjeta, pero para mi proyecto esto es categ√≥ricamente inaceptable. <br>  Soluci√≥n  Busque m√°s mapas que excluyan las aguas territoriales. </p><br><p>  Adelante  En las profundidades de Internet en un sitio abandonado, usted encontr√≥ mapas, como en Crimea, y no "flot√≥", descarg√≥ y ... </p><br><img src="https://habrastorage.org/webt/hc/xf/28/hcxf28bpg0uid2xd4ikhfihbbuo.jpeg"><br><p>  Los l√≠mites de los sujetos se topan entre s√≠. </p><br><p>  Este problema a menudo se encuentra en las cartas de aficionado, los l√≠mites de los sujetos se topan entre s√≠ y, debido a esto, es posible la visualizaci√≥n incorrecta de elementos.  Tambi√©n puede aparecer debido a la compresi√≥n inadecuada o la simplificaci√≥n de los mapas. </p><br><p>  Los puntos rojos son la intersecci√≥n de pol√≠gonos entre s√≠. </p><br><p>  Esto no siempre muestra artefactos en la pantalla, pero con una gran cantidad de errores puede ocurrir la siguiente imagen: </p><br><img src="https://habrastorage.org/webt/3y/a1/vj/3ya1vjn8xjxpquswm104_owfe7a.jpeg"><br><p>  Soluci√≥n: busque mapas sin golpear pol√≠gonos entre s√≠. </p><br><p>  Estamos buscando m√°s all√°.  En alg√∫n lugar, por alg√∫n milagro, encuentras un buen mapa, con Crimea, sin aguas territoriales, sin golpear los vertederos entre s√≠ y ... </p><br><p>  Todo se congela.  La tarjeta pesa 35mb debido a detalles excesivos, y las computadoras d√©biles comienzan a disminuir cuando se muestran. </p><br><p>  Soluci√≥n: busque un mapa con menos detalles o comprima el mapa.  Para geojson recomiendo mapshaper.org. </p><br><p>  Eso es todo, pasaste por nueve c√≠rculos del infierno, encontraste el mapa perfecto, lo descargaste y ...  Parte de Chukotka estaba idealmente aislada del resto de Rusia. </p><br><p><img src="https://habrastorage.org/webt/zg/ho/jm/zghojmp433ydfvg1sajlejjh6aq.jpeg" alt="imagen"></p><br><p>  Chukotka  Chukotka  Chukotka  Vale la pena repetir esta palabra muchas veces, porque si eres un principiante, estar√°s atrapado con este problema durante mucho tiempo.  No ser√° f√°cil para usted comprender que esta no es una tarjeta rota, esto no es un error, y no es tan f√°cil de arreglar como cree a primera vista.  No podr√° cortar esta pieza y adherirse al resto de Rusia, no podr√° transferir todos los objetos al centro sin errores, etc.  Y si tiene √©xito, ser√°n las peores muletas, y no aprobamos tales m√©todos. </p><br><h4 id="razrezannaya-chukotka">  Chukotka en rodajas </h4><br><p>  No entrar√© en detalles, pero inmediatamente revelar√© las cartas. </p><br><p>  Esto no es un error.  El problema es que, por defecto, en los servicios de mapas hay una proyecci√≥n (s√≠, tendr√° que comprender qu√© es una proyecci√≥n y cu√°les son) CRS84 que, en t√©rminos generales, el origen de coordenadas proviene del meridiano 180, es decir, el mapa comienza y termina en Chukotka  Imagina que est√°s cortando y expandiendo el globo a lo largo de esta l√≠nea. </p><br><p>  Desde el punto de vista de la proyecci√≥n CRS84, todo se muestra correctamente. </p><br><p>  La proyecci√≥n es un tema enorme y complejo.  No creo que sea necesario pasar una gran cantidad de tiempo estudi√°ndolo, si solo necesita hacer un mapa interactivo en su proyecto.  Adem√°s, no analizar√© en detalle, pero solo contar√© sobre esas proyecciones que ayudar√°n a mostrar correctamente el mapa de la Federaci√≥n Rusa. </p><br><p>  La proyecci√≥n c√≥nica conforme de Asia lambert devolver√° a Chukotka a su lugar.  Pero, seg√∫n tengo entendido, esta es una proyecci√≥n no est√°ndar y muchos servicios, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://geojson.io</a> , no admiten una desviaci√≥n del est√°ndar. </p><br><p>  Con la proyecci√≥n de √°rea igual c√≥nica, todo funcion√≥ para nosotros despu√©s de una peque√±a revisi√≥n. </p><br><p>  Despu√©s de colocar una proyecci√≥n c√≥nica, ver√° la siguiente imagen: Rusia cay√≥ de lado y se ahog√≥ a medias. </p><br><p><img src="https://habrastorage.org/webt/cf/tf/9z/cftf9zuptqjlc2yvh0sq-cc6bku.jpeg" alt="imagen"></p><br><p>  De nuevo, esto no es un error: el mapa se mostr√≥ correctamente, pero por defecto existe ese √°ngulo.  Esto se resuelve con volteo trivial y zoom de la tarjeta: </p><br><pre><code class="django hljs"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ComposableMap</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">projection</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> geoConicEqualArea() .scale(690) .center([100, 100]) .parallels([40, 80]) .rotate([265].translate([130, 5]) }&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ZoomableGroup</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geographies</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">geography</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{map}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {(geographies, proj) =&gt; geographies.map(geo =&gt; ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geography</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">projection</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{proj}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">geography</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{geo}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> )) } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Geographies</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ZoomableGroup</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ComposableMap</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Como resultado, obtienes la siguiente tarjeta: </p><br><img src="https://habrastorage.org/webt/ka/gd/xp/kagdxpkw7xplsbekoquncdvpudg.jpeg"><br><p>  ... con lo que todo est√° bien, ella est√° sin existencias y hermosa.  Casi.  Sin embargo, qued√≥ una "cicatriz de Chukchi" que no pudimos eliminar.  No es particularmente notable y no da√±a mucho la composici√≥n.  No encontramos la forma de eliminarlo y, para ser sincero, no lo buscamos, est√°bamos demasiado atormentados por errores anteriores y decidimos dejar todo como est√°. </p><br><img src="https://habrastorage.org/webt/gc/ue/tj/gcuetjnlyxhr6bdwlsebrjzvwa8.jpeg"><br><p>  Por lo tanto, hemos resuelto los errores t√≠picos al dise√±ar un mapa interactivo.  Si tuvi√©ramos un art√≠culo de este tipo hace un mes, ahorrar√≠a muchos nervios a nuestro equipo y, espero, tambi√©n salvar√° los tuyos. </p><br><p>  Examinamos los siguientes problemas: </p><br><ul><li>  Crimea desaparecida </li><li>  Los temas incluyeron aguas territoriales </li><li>  Las fronteras de los sujetos se topan </li><li>  La tarjeta es demasiado pesada. </li><li>  Chukotka corta 180 meridianos </li></ul><br><h4 id="zametka-ot-razrabotchika-iz-komandy">  Nota del desarrollador del equipo </h4><br><p>  Otra dificultad fue encontrar un componente para representar mapas que no depender√≠a del lado del cliente, como  El mapa se representa en el servidor.  Utilizamos el framework Next.js, que se basa en React, por lo que d3-geo simplemente no funcion√≥, fue necesario encontrar el componente React. </p><br><p>  PD: El art√≠culo fue escrito solo para que j√≥venes y verdes no pasen 2-3 d√≠as atormentando con tarjetas y aprendan de los errores de los dem√°s.  No fue escrito por un programador, ni un geoanalista, ni un cart√≥grafo, sino por un proyecto simple, por lo que para todas las afirmaciones e imprecisiones sugiero escribir su art√≠culo en el segmento del idioma ruso, donde explique en detalle c√≥mo hacerlo, ya que no encontr√© fuentes normales de informaci√≥n. </p><br><p>  Tarjetas: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">A partir de junio de 2019, los mejores mapas rusos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Un gran banco de tarjetas de todo el mundo de calidad media.</a> </p><br><p>  Servicios: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Visualizaci√≥n de mapas en l√≠nea y una herramienta para comprimirlos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">proyecci√≥n</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Proyeccion</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Componente de representaci√≥n de mapa de reacci√≥n</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/459902/">https://habr.com/ru/post/459902/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../459890/index.html">El auto el√©ctrico no es para m√≠</a></li>
<li><a href="../459892/index.html">Eventos digitales en Mosc√∫ del 15 al 21 de julio.</a></li>
<li><a href="../459894/index.html">Si no responde, escribiremos ... a Sportloto</a></li>
<li><a href="../459898/index.html">El plan ha vuelto a la econom√≠a.</a></li>
<li><a href="../459900/index.html">Visualizar una columna de un DataFrame usando la biblioteca Seaborn</a></li>
<li><a href="../459906/index.html">Tic Tac Toe, parte 3: Deshacer / Rehacer con almacenamiento de comandos</a></li>
<li><a href="../459910/index.html">Situaci√≥n: las empresas no tienen prisa por desarrollar servicios para asistentes de voz: ¬øcu√°les son los riesgos?</a></li>
<li><a href="../459914/index.html">SQL Index Manager: una herramienta gratuita para desfragmentar y mantener √≠ndices</a></li>
<li><a href="../459918/index.html">Resoluci√≥n de problemas con pwnable.kr 03 - bof. Desbordamiento de b√∫fer en la pila</a></li>
<li><a href="../459922/index.html">Eliminar el ruido de alta frecuencia de las se√±ales de los sensores de vibraci√≥n durante el diagn√≥stico de vibraci√≥n de los rodamientos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>