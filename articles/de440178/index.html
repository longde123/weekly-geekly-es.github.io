<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦏 📁 🐅 Rekursion in Python entfernen 🥪 🆑 🙍🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! Ich präsentiere Ihnen die Übersetzung des Artikels "Entfernen einer Rekursion in Python, Teil 1" von Eric Lippert. 


 In den letzten 20 J...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekursion in Python entfernen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440178/"><p> Hallo Habr!  Ich präsentiere Ihnen die Übersetzung des Artikels <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Entfernen einer Rekursion in Python, Teil 1"</a> von Eric Lippert. </p><br><p>  In den letzten 20 Jahren habe ich die Einfachheit und Leistungsfähigkeit von Python bewundert, obwohl ich nie wirklich damit gearbeitet oder im Detail studiert habe. </p><br><p>  Vor kurzem habe ich ihn mir genau angesehen - und es stellte sich heraus, dass es eine wirklich schöne Sprache war. </p><br><p>  Bei einer kürzlich gestellten Frage zu StackOverflow habe ich mich gefragt, wie ein rekursiver Algorithmus in einen iterativen Algorithmus konvertiert werden kann, und es stellte sich heraus, dass Python eine ziemlich gute Sprache dafür ist. <br>  Das Problem, auf das der Autor der Frage gestoßen ist, war wie folgt: </p><a name="habracut"></a><br><ul><li>  Der Spieler befindet sich in einer beliebigen Zelle auf einem nummerierten Feld. </li><li>  Das Ziel ist es, zu Zelle Nummer 1 zurückzukehren; </li><li>  Befindet sich der Spieler auf einem geraden Feld, zahlt er eine Münze und geht den halben Weg zur Zelle Nr. 1; </li><li>  Befindet sich der Spieler auf einem ungeraden Feld, kann er 5 Münzen bezahlen und direkt zum ersten Feld gehen oder eine Münze bezahlen und einen Schritt zum Feld Nr. 1 machen - auf einem geraden Feld. </li></ul><br><p>  Die Frage ist: Was ist die geringste Menge an Münzen, die Sie bezahlen müssen, um von der aktuellen Zelle zur ersten zurückzukehren? </p><br><p>  Die Aufgabe hat eine offensichtliche rekursive Lösung: </p><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> + cost(s // <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> min(<span class="hljs-number"><span class="hljs-number">1</span></span> + cost(s - <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br><p>  Dieses Programm stürzte jedoch ab und erreichte die maximale Rekursionstiefe, höchstwahrscheinlich aufgrund der Tatsache, dass der Autor der Frage mit sehr großen Zahlen experimentierte. <br>  Daher stellt sich die Frage: Wie kann ein rekursiver Algorithmus in Python in einen iterativen Algorithmus umgewandelt werden? </p><br><p>  Bevor wir beginnen, möchte ich darauf hinweisen, dass es natürlich schnellere Lösungen für dieses spezielle Problem gibt, an sich ist es nicht sehr interessant. </p><br><p>  Vielmehr diente diese Aufgabe nur als Ausgangspunkt für die Frage, wie im allgemeinen Fall ein einzelner rekursiver Aufruf in einem Python-Programm entfernt werden kann. </p><br><p>  Der Punkt ist, dass Sie jede einfache rekursive Methode konvertieren und die Rekursion loswerden können, und dies ist nur ein Beispiel, das zur Hand war. </p><br><p>  Die Technik, die ich zeigen werde, stimmt natürlich nicht genau mit der Schreibweise von Python überein. Wahrscheinlich würde eine Lösung im Python-Stil Generatoren oder andere Funktionen der Sprache verwenden. </p><br><p>  Was ich hier zeigen möchte, ist, wie man die Rekursion mithilfe einer Folge kleiner und sicherer Transformationen beseitigt und die Funktion zu einer Form führt, in der es einfach ist, die Rekursion durch eine Iteration zu ersetzen. </p><br><p>  Lassen Sie uns zunächst sehen, wie Sie das Programm in dieses Formular bringen. </p><br><p>  Im ersten Schritt unserer Konvertierung möchte ich, dass die vor dem rekursiven Aufruf durchgeführten Berechnungen auf die Berechnung des Arguments reduziert werden und die Berechnungen nach dem rekursiven Aufruf in einer separaten Methode ausgeführt werden, die das Ergebnis des rekursiven Aufrufs akzeptiert. </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_one</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n + <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_min</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> min(n + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: argument = s // <span class="hljs-number"><span class="hljs-number">2</span></span> result = cost(argument) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> add_one(result) argument = s - <span class="hljs-number"><span class="hljs-number">1</span></span> result = cost(argument) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> get_min(result)</code> </pre> <br><p>  Der zweite Schritt, den ich machen möchte, ist die Berechnung des Arguments in einer separaten Funktion: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># ... def get_argument(s): if s % 2 == 0: return s // 2 return s - 1 def cost(s): if s &lt;= 1: return 0 argument = get_argument(s) result = cost(argument) if s % 2 == 0: return add_one(result) return get_min(result)</span></span></code> </pre> <br><p>  Im dritten Schritt möchte ich eine Hilfsfunktion hinzufügen, die die Fortsetzungsfunktion auswählt, die nach der Rückkehr von der Rekursion aufgerufen wird. </p><br><p>  Beachten Sie, dass die Hilfsfunktion eine Funktion zurückgibt. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#... def get_after(s): if s % 2 == 0: return add_one return get_min def cost(s): if s &lt;= 1: return 0 argument = get_argument(s) after = get_after(s) # after  ! result = cost(argument) return after(result)</span></span></code> </pre> <br><p>  Jetzt schreiben wir es in einer allgemeineren und prägnanteren Form: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#... def is_base_case(s): return s &lt;= 1 def base_case_value(s): return 0 def cost(s): if is_base_case(s): return base_case_value(s) argument = get_argument(s) after = get_after(s) return after(cost(argument))</span></span></code> </pre> <br><p>  Es ist ersichtlich, dass jede vorgenommene Änderung die Bedeutung des Programms beibehielt. </p><br><p>  Jetzt wird die Prüfung auf die Parität der Zahl zweimal durchgeführt, obwohl vor den Änderungen eine Prüfung durchgeführt wurde. </p><br><p>  Wenn wir wollen, können wir dieses Problem lösen, indem wir zwei Hilfsfunktionen zu einer kombinieren, die ein Tupel zurückgibt. </p><br><p>  Aber machen wir uns im Rahmen dieser Aufgabe keine Sorgen. </p><br><p>  Wir haben unsere rekursive Methode auf die allgemeinste Form reduziert. </p><br><ul><li>  Im Basisfall: <br><ul><li>  Berechnen Sie den zurückzugebenden Wert. </li><li>  gib es zurück. </li></ul></li><li>  In einem nicht grundlegenden Fall: <br><ul><li>  Berechnen Sie das Rekursionsargument. </li><li>  einen rekursiven Aufruf machen; </li><li>  Berechnen Sie den Rückgabewert. </li><li>  gib es zurück. </li></ul></li></ul><br><p>  Ein wichtiger Punkt, auf den Sie bei diesem Schritt achten müssen, ist, dass <code>after</code> keine <code>cost</code> selbst enthalten sollte. </p><br><p>  Die hier gezeigte Methode entfernt einen einzelnen rekursiven Aufruf. </p><br><p>  Wenn Sie zwei oder mehr Rekursionen haben, benötigen wir eine andere Lösung. </p><br><p>  Sobald wir unseren rekursiven Algorithmus in diese Form gebracht haben, ist es bereits einfach, ihn in eine iterative zu konvertieren. </p><br><p>  Der Trick besteht darin, sich vorzustellen, was in einem rekursiven Programm passiert. </p><br><p>  So führen wir einen rekursiven Abstieg durch: Wir rufen <strong>get_argument</strong> vor dem rekursiven Aufruf auf und rufen die <strong>after-</strong> Funktion auf, <strong>nachdem</strong> wir von der Rekursion zurückgekehrt sind. </p><br><p>  Das heißt, alle Aufrufe von <strong>get_argument</strong> erfolgen vor allen Aufrufen von <strong>get_argument</strong> . <br>  Daher können wir dies in zwei Zyklen konvertieren: Der erste ruft <strong>get_argument auf</strong> und bildet eine Liste von <strong>After-</strong> Funktionen, und der zweite ruft alle <strong>After-</strong> Funktionen auf: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#... def cost(s): #     "after".    #       # ,    . afters = [ ] while not is_base_case(s): argument = get_argument(s) after = get_after(s) afters.append(after) s = argument #       "after" : result = base_case_value(s) while len(afters) != 0: after = afters.pop() result = after(result) return result</span></span></code> </pre> <br><p>  Keine Rekursion mehr! </p><br><p>  Es sieht aus wie Magie, aber alles, was wir hier tun, ist dasselbe wie die rekursive Version des Programms und in derselben Reihenfolge. </p><br><p>  Dieses Beispiel spiegelt den Gedanken wider, den ich oft über den Aufrufstapel wiederhole: <em>Sein Zweck ist es, zu kommunizieren, was als nächstes passieren wird und nicht, was bereits passiert ist!</em> </p><br><p>  Die einzige nützliche Information über den Aufrufstapel in der rekursiven Version des Programms ist der Nachwert, da diese Funktion als nächstes aufgerufen wird und alles andere auf dem Stapel nicht wichtig ist. </p><br><p>  Anstatt den Aufrufstapel als ineffiziente und umständliche Methode zum Speichern des <strong>After-</strong> Stacks zu verwenden, können wir einfach den <strong>After-</strong> Function-Stack speichern. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das nächste Mal werden</a> wir uns einen komplexeren Weg ansehen, um die Rekursion in Python zu entfernen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440178/">https://habr.com/ru/post/de440178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440168/index.html">Videoberichte vom FunTech ML-Treffen</a></li>
<li><a href="../de440170/index.html">Analyse von Vorfällen im Zusammenhang mit Cyber-Angriffen auf Blockchain-Projekte</a></li>
<li><a href="../de440172/index.html">CQRS: das Prinzip "Teilen und Erobern" im Dienste eines Programmierers</a></li>
<li><a href="../de440174/index.html">Microsoft Q # Coding Contest - Winter 2019</a></li>
<li><a href="../de440176/index.html">Sieben Cybersicherheitstrends für 2019</a></li>
<li><a href="../de440180/index.html">Q # Programmierwettbewerb: Microsoft Q # Codierungswettbewerb</a></li>
<li><a href="../de440182/index.html">IBM Watson Studio - Eine Cloud-basierte Entwicklungsplattform für KI-Anwendungen</a></li>
<li><a href="../de440184/index.html">Warum wir GraphQL in 8base verwenden</a></li>
<li><a href="../de440188/index.html">Die Sterne erreichen: Ansible Operatoren für die Verwaltung von Anwendungen in Kubernetes beherrschen</a></li>
<li><a href="../de440190/index.html">Bekanntschaft mit dem einfachsten neuronalen Netz und dessen schrittweise Implementierung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>