<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçüè´ üêí üö∂üèæ Criptograf√≠a en lenguaje simple: analizamos el cifrado sim√©trico y asim√©trico utilizando la trama de Star Wars como ejemplo (actualizado) üíÉüèø üñ§ ‚úãüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Hola a todos los lectores de Habr! No hace mucho tiempo decid√≠ tratar con algoritmos de cifrado y los principios de la firma electr√≥nica. El tema, cr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criptograf√≠a en lenguaje simple: analizamos el cifrado sim√©trico y asim√©trico utilizando la trama de Star Wars como ejemplo (actualizado)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452042/"> ¬°Hola a todos los lectores de Habr!  No hace mucho tiempo decid√≠ tratar con algoritmos de cifrado y los principios de la firma electr√≥nica.  El tema, creo, es interesante y relevante.  En el proceso de estudio, prob√© varias bibliotecas, pero la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PyCrypto</a> es la m√°s conveniente desde mi punto de vista.  Ella tiene una excelente documentaci√≥n, acompa√±ada de ejemplos. <br><br><img src="https://habrastorage.org/webt/66/he/oz/66heoz7zb5m8gxup9igsegwjlog.png" alt="imagen"><br><br>  <b>Despu√©s de leer el material, aprender√° los siguientes puntos:</b> <br><br><ol><li>  ¬øQu√© es el cifrado? </li><li>  ¬øCu√°l es la diferencia entre cifrado sim√©trico y asim√©trico? </li><li>  En cuyo caso, es m√°s eficiente usar el cifrado sim√©trico y en el cual el cifrado asim√©trico; </li><li>  ¬øQu√© es un hash de datos y por qu√© se usa en el cifrado? </li></ol><br>  La relevancia del tema est√° en constante crecimiento.  El uso de la criptograf√≠a no se ha limitado durante mucho tiempo al cifrado de informaci√≥n.  De una forma u otra, usamos algoritmos de encriptaci√≥n diariamente cuando visitamos sitios a trav√©s del protocolo HTTPS, al hacer compras con una tarjeta de cr√©dito y al comunicarnos en mensajer√≠a instant√°nea.  En los √∫ltimos a√±os, las tecnolog√≠as blockchain, que tambi√©n se basan en la criptograf√≠a, han atra√≠do una gran atenci√≥n. <br><br>  El prop√≥sito de este art√≠culo es presentar al lector los algoritmos de cifrado b√°sicos.  Al escribir un art√≠culo, trat√© de prestar la mayor atenci√≥n posible al tema de la aplicaci√≥n pr√°ctica.  Para la programaci√≥n, se utiliz√≥ Python 3.6.  Al escribir el c√≥digo, trat√© de dividirlo en partes separadas y comentar todos los puntos clave. <br><a name="habracut"></a><br>  En este art√≠culo, no analic√© la firma digital, pero despu√©s de comprender el cifrado asim√©trico, el significado de esta tecnolog√≠a quedar√° claro. <br><br><h3>  Parcela </h3><br>  Viajemos mentalmente al universo de Star Wars antes de los eventos del Episodio 6, cuando las fuerzas de resistencia se den cuenta del comienzo de la construcci√≥n de una nueva Estrella de la Muerte.  El comando planea introducir un grupo de inteligencia disfrazado de constructores.  La operaci√≥n es muy peligrosa, la comunicaci√≥n con la sede ser√° dif√≠cil.  En el caso de una situaci√≥n de emergencia, cada miembro del grupo puede enviar y recibir mensajes desde la sede con una frecuencia desprotegida. <br><br>  El prop√≥sito del grupo de reconocimiento es cualquier dato que pueda arrojar luz sobre la configuraci√≥n, las armas y el prop√≥sito de la futura estaci√≥n.  Para almacenar datos, se planea desarrollar equipos y software especiales. <br><br>  <b>La sede aprob√≥ dos opciones para esta operaci√≥n:</b> <br><br>  Plan A - Devoluci√≥n de agentes con fuerzas rebeldes dadas; <br>  Plan B: transmisi√≥n remota de planes desde la Estrella de la Muerte utilizando el equipo de la estaci√≥n.  <i>La transferencia de informaci√≥n ser√° r√°pida, pero despu√©s de la transferencia, lo m√°s probable es que el agente sea calculado y capturado.</i> <br><br><div class="spoiler">  <b class="spoiler_title">Esquema</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/cv/xz/or/cvxzormscazwyzscn90hvzrdmqq.png" alt="imagen"><br></div></div><br>  Usted es un programador en un equipo responsable del desarrollo de software. <br><br>  <b>Al planificar una operaci√≥n, se consideran varios escenarios negativos posibles:</b> <br><br><ul><li>  El enemigo interceptar√° la se√±al, comprender√° su contenido sobre la planificaci√≥n del ataque y acercar√° el objeto a las fuerzas leales al Imperio.  En este caso, las p√©rdidas entre la resistencia ser√°n mayores; </li><li>  Uno de los esp√≠as ser√° atrapado y durante el interrogatorio revelar√° el plan de operaci√≥n, lo que puede comprometer las claves de cifrado (hablaremos de ellas a continuaci√≥n); </li><li>  Un esp√≠a con datos descargados puede ser interceptado por las fuerzas imperiales, que har√°n cambios en el contenido, informando mal la resistencia sobre las debilidades de la estaci√≥n.  En este caso, durante el ataque, la flota rebelde ser√° enviada en una direcci√≥n falsa y destruida gradualmente; </li></ul><br>  <b>A partir de estos escenarios se formulan las tareas:</b> <br><br><ol><li>  El contenido debe estar encriptado de forma segura y protegido de cambios; </li><li>  En caso de p√©rdida de claves de cifrado o su compromiso, deber√≠a ser posible obtener nuevas claves de cifrado de forma remota a una frecuencia que el adversario pueda aprovechar. </li></ol><br><h4>  Cifrado de informaci√≥n </h4><br>  Solucionemos el problema del cifrado de informaci√≥n: <br><br>  Una clave de cifrado se utiliza para cifrar y descifrar informaci√≥n.  Es la clave que hace que el cifrado sea reversible.  Cada agente recibir√° una clave de cifrado.  Despu√©s de descargar los datos, el agente los cifrar√° y los enviar√° a la sede de la resistencia. <br><br><div class="spoiler">  <b class="spoiler_title">Descripci√≥n del principio de encriptaci√≥n</b> <div class="spoiler_text">  El m√©todo en el que el mensaje se encripta y desencripta usando una sola clave se denomina <i>encriptaci√≥n sim√©trica</i> . <br><br><img src="https://habrastorage.org/webt/or/pn/ar/orpnarkw6jyoz-vdtqwwf7ap4vi.png" alt="imagen"><br><br>  El punto d√©bil del cifrado sim√©trico es la clave de cifrado, o m√°s bien, su entrega al destinatario.  Si la clave se ve comprometida durante la entrega, un tercero puede decodificar f√°cilmente el mensaje.  La fuerza del cifrado sim√©trico es su velocidad, que permite codificar grandes cantidades de datos. <br><br>  <i>El cifrado asim√©trico</i> utiliza dos claves conectadas entre s√≠: p√∫blica y privada. <br><br><img src="https://habrastorage.org/webt/vg/bo/i3/vgboi3dy5tbj3tbta36ul-ybdau.png" alt="imagen"><br><br>  <b>El mecanismo de acci√≥n es el siguiente:</b> <br><br><ol><li>  el destinatario env√≠a la clave ABIERTA al remitente; </li><li>  el remitente codifica el mensaje usando la clave p√∫blica recibida.  Al mismo tiempo, el mensaje ahora puede decodificarse solo con la clave privada; </li><li>  Al recibir el mensaje cifrado, el destinatario lo decodifica con la clave CERRADA (que se gener√≥ en conjunto con el p√∫blico). </li></ol><br></div></div><br>  ¬°Comencemos en la programaci√≥n!  Para desarrollar el software necesario, utilizaremos la biblioteca de Python llamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pycrypto</a> .  Ella tiene una excelente documentaci√≥n y presenta todos los algoritmos de cifrado comunes. <br><br>  Primero, desarrollaremos una funci√≥n para el cifrado sim√©trico llamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Advanced Encryption Standard (AES)</a> .  Es uno de los algoritmos de cifrado sim√©trico m√°s comunes. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Crypto.Cipher <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AES <span class="hljs-comment"><span class="hljs-comment">#   from Crypto.Hash import SHA256 #        SHA. from Crypto.Hash import MD5 #            32  from Crypto import Random def transform_password(password_str): """Transform the password string into 32 bit MD5 hash :param password_str: &lt;str&gt; password in plain text; :return: &lt;str&gt; Transformed password fixed length """ h = MD5.new() h.update(key.encode()) return h.hexdigest() def symmetric_encrypt(message, key, verbose = True): """Encripts the message using symmetric AES algorythm. :param message: &lt;str&gt; Message for encryption; :param key: &lt;object&gt; symmetric key; :return: &lt;object&gt; Message encrypted with key """ key_MD5 = transform_password(key) #      32  message_hash = SHA256.new(message.encode()) message_with_hash = message.encode() + message_hash.hexdigest().encode() #     .      iv = Random.new().read(AES.block_size) cipher = AES.new(key_MD5, AES.MODE_CFB, iv) #     . AES.MODE_CFB -   ,      iv. https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.blockalgo-module.html#MODE_CFB encrypted_message = iv + cipher.encrypt(message_with_hash) #       .  ,       ,       . if verbose: print(f'Message was encrypted into: {encrypted_message.hex()}') return encrypted_message def symmetric_decrypt(encr_message, key): """Decripts the message using private_key and check it's hash :param encrypted_message: &lt;object&gt; Encrypted message :param key: &lt;object&gt; symmetric key; :return: &lt;object&gt; Message decripted with key """ key_MD5 = transform_password(key) #   ,      bsize = AES.block_size dsize = SHA256.digest_size*2 iv = Random.new().read(bsize) cipher = AES.new(key_MD5, AES.MODE_CFB, iv) decrypted_message_with_hesh = cipher.decrypt(encr_message)[bsize:] #     ,      decrypted_message = decrypted_message_with_hesh[:-dsize] #   ,      digest = SHA256.new(decrypted_message).hexdigest() #    .     ,     . if digest==decrypted_message_with_hesh[-dsize:].decode(): #      ,      ,   print(f"Success!\nEncrypted hash is {decrypted_message_with_hesh[-dsize:].decode()}\nDecrypted hash is {digest}") return decrypted_message.decode() else: print(f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is {decrypted_message_with_hesh[-dsize:]}\nDecrypted hash is {digest}")</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Verifiquemos el rendimiento del c√≥digo usando un ejemplo</b> <div class="spoiler_text"><pre> <code class="python hljs">message = <span class="hljs-string"><span class="hljs-string">"""  120   120  / 120   10     30-5 (2)    4.0 """</span></span> key = <span class="hljs-string"><span class="hljs-string">'Traveling through hyperspace ain'</span></span>t like dusting crops, farm boy.<span class="hljs-string"><span class="hljs-string">' encr_message = symmetric_encrypt(message, key, verbose = True) print('</span></span>\n<span class="hljs-string"><span class="hljs-string">') print('</span></span>DECRIPTION<span class="hljs-string"><span class="hljs-string">') decr_message = symmetric_decrypt(encr_message, key) print(decr_message)</span></span></code> </pre><br><pre> <code class="plaintext hljs">Message was encrypted into: ed10e4c65358bb9e351c801c3b3200b21fa86a24021c317bb5c9d8b3f76bdf9f3a7d26781a22402f0e4f41ca831b6d2da9e1e6878c34c79ddc7959af3ae9fc2ba0cfff1c0180a7e0f637f1aa5b24507d552d5dfe7625e7b81d817b5882b2b19bb95f3988a03c78f850098dfc8e6089863deaa39b887eaea4c1d4ba006edaec90205d54b27ed4ac70ed75cdd01732e1176bf04218beb8ae742ff708a201a9d1cb57dd5f2e70dc3239208d23705f7a3aae3e315c4df6d73c871b66c4995cce5f19738f731cd58755d21ed92612c44197f875cddf3f7aa1d60e435ce1492679b9d60c4b8538f52408f321711ac1d2daa6dbbc33dc655abca10e2f5fd3ff27823995b9dcdb62c0bafc1963ab539ccb466f1c140479df34b0005f578f72fcdd76b17391332037b801f74f733a08 DECRIPTION Success! Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026 Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026  120   120  / 120   10     30-5 (2)    4.0</code> </pre><br></div></div><br>  <i>Como puede ver, ciframos con √©xito el mensaje utilizando la clave p√∫blica.</i> <i><br></i>  <i>Ejecute el c√≥digo varias veces.</i>  <i>Ver√° que cada vez que cambia la parte cifrada.</i>  <i>Esto se debe a que al cifrar, utilizamos el modo Cipher FeedBack (AES.MODECFB), en el que los bloques de texto sin formato se mezclan con los bloques de texto cifrado.</i>  <i>iv - vector de inicializaci√≥n (lea m√°s sobre el modo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ).</i>  <i>Al descifrar el mensaje, vemos que el hash del mensaje descifrado coincide con el hash que agregamos durante el cifrado.</i>  <i>Esto significa que el descifrado fue correcto.</i> <i><br></i> <br><div class="spoiler">  <b class="spoiler_title">¬øQu√© es un hash?</b> <div class="spoiler_text">  Un hash de documento es simplemente una cadena de caracteres que es exclusiva de cualquier conjunto de datos.  Con cualquier cambio de datos, el hash cambia mucho.  En otras palabras, un hash es una especie de "huella digital" para cualquier conjunto de datos. <br><br><img src="https://habrastorage.org/webt/qn/tf/v3/qntfv3yr0oiaexp1o_jzekwsd1o.png"><br></div></div><br>  Pero, ¬øqu√© pasa si las claves de cifrado se ven comprometidas por alguna raz√≥n?  Entonces cualquiera puede descifrar la informaci√≥n. <br><br>  En este caso, necesitamos cambiar de alguna manera las claves de cifrado de forma remota a una frecuencia que el adversario pueda aprovechar.  Asumiremos que ya la est√°n escuchando.  Entonces, ¬øc√≥mo hacemos esto?  Aqu√≠, otro m√©todo viene al rescate, llamado cifrado asim√©trico (o un sistema criptogr√°fico de clave p√∫blica).  A diferencia del cifrado sim√©trico, utiliza dos claves: p√∫blica y privada.  El mensaje se cifra con la clave p√∫blica, despu√©s de lo cual solo se puede descifrar con la clave privada.  La clave p√∫blica de descifrado ser√° in√∫til.  Sin embargo, hay un punto importante: la clave privada ciertamente debe ser del par p√∫blico generado.  La presencia de una clave p√∫blica es una de varias propiedades importantes e interesantes del cifrado asim√©trico.  Es decir, podemos transmitir la clave p√∫blica por cualquier canal y no tener miedo de que se use para descifrar el mensaje. <br><br>  Al mismo tiempo, con respecto a nuestra tarea, hay un matiz: el cifrado asim√©trico es adecuado para datos peque√±os, por ejemplo, mensajes cortos.  Solo podemos adivinar la cantidad de datos obtenidos por inteligencia.  Por supuesto, podemos dividir todos los datos recibidos en peque√±os fragmentos y codificarlos con una clave privada, pero existe una mejor soluci√≥n.  (El problema se resuelve <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ). <br><br>  <b>Soluci√≥n</b> <br><br><blockquote>  <i>El usuario Akela_wolf coment√≥ correctamente que cualquiera puede generar y enviar la clave p√∫blica.</i>  <i>Hice algunos ajustes al plan.</i> <br><br>  Ser√° correcto si, antes de enviar agentes, la sede generar√° varios pares de claves y asignar√° una clave privada a cada agente.  Es mejor generar solo unos pocos pares para que cada agente tenga una clave individual.  Esto es necesario para personificar con precisi√≥n al propietario de la clave. <br>  Luego, si las claves se ven comprometidas, el centro crear√° una nueva clave SIM√âTRICA, la codificar√° a cada agente con claves p√∫blicas y la enviar√° por el canal abierto. <br><div class="spoiler">  <b class="spoiler_title">Esquema de soluci√≥n general</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ge/uk/q3/geukq3vj-o8ab3bkta_i5y-8xsa.png"><br><img src="https://habrastorage.org/webt/5l/sn/fy/5lsnfygzrehgkfjlq6qzon-wbdw.png"><br></div></div><br><br></blockquote><br><br><div class="spoiler">  <b class="spoiler_title">Vieja decisi√≥n</b> <div class="spoiler_text"><ol><li>  El agente generar√° un par de claves (p√∫blicas y privadas) en su lugar, luego enviar√° la clave p√∫blica a las fuerzas rebeldes; </li><li>  En la sede de la resistencia crear√°n una nueva clave para el cifrado SIM√âTRICO; </li><li>  La clave sim√©trica se codifica utilizando la clave p√∫blica que envi√≥ el agente; </li><li>  La clave sim√©trica cifrada se enviar√° al agente, que la decodificar√° utilizando la clave privada. </li></ol><br>  <i>Presta atenci√≥n a nuestro programa en el canal abierto:</i> <i><br><br></i> <ol><li>  El agente env√≠a la llave ABIERTA del par, la llave CERRADA est√° en su poder; </li><li>  La sede de la resistencia env√≠a una clave de cifrado sim√©trica, cifrada con la clave p√∫blica enviada por el agente. </li></ol><br><br>  Ni el primer ni el segundo mensaje son de ning√∫n valor en la intercepci√≥n. <br></div></div><br><br>  Escribamos el c√≥digo: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#          RSA. #        SHA256 from Crypto.PublicKey import RSA #      def generate_keys(bits = 2048): """Generates the pair of private and public keys. :param bits: &lt;int&gt; Key length, or size (in bits) of the RSA modulus (default 2048) :return: &lt;object&gt; private_key, &lt;object&gt; public_key """ private_key = RSA.generate(bits) public_key = private_key.publickey() return private_key, public_key private_key, public_key = generate_keys(bits = 2048)</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Veamos c√≥mo se ven las teclas.</b> <div class="spoiler_text"><pre> <code class="python hljs">print(private_key.exportKey(format=<span class="hljs-string"><span class="hljs-string">'PEM'</span></span>).decode()) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'#'</span></span>*<span class="hljs-number"><span class="hljs-number">65</span></span>) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(public_key.exportKey(format=<span class="hljs-string"><span class="hljs-string">'PEM'</span></span>).decode())</code> </pre> <br> <code>-----BEGIN RSA PRIVATE KEY----- <br> MIIEpAIBAAKCAQEA4JDLu7Vtvg2yqbH6Y0eJPfoEsOlKzgmOodqhA1CqkEG4OpKi <br> sGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzTHvKd1pO70B84vD5OSrS7uNw2EYkj <br> d/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKwlW61DY9X7LfNz7aOKMTbKnm1vdR0 <br> 919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxBZIXfFupEiANSvOs+57hgaCho7OWM <br> GUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKifgo1/2ue61MV1Pzh5CVaicJKNaRtg <br> Pd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO8wIDAQABAoIBAARM4YnjrIlSK9Sy <br> EtBp40frjMFyhjsx1ahlzmWI2utORt/gRPtJx3AlEmNPZ8qMXt5t8+X4IOz1INmN <br> uAuviH90N++O/q66mlSIgOlPUrT0ipiFXseCUZ9StMMzGNtJSMw5FfAwNEU/stLd <br> VoF2ezkxWIg88XsX/fn3Tfub4XKLvu4raJGcJ+Fo2GI9hYEGKnHhSuHvDHekTLlQ <br> z46O+cIwtehbFGcKesyK3zDD1uP5YLPIWpiqt1TgKjJzRF0l4ZJLk+RT7kU2pGIQ <br> mosOnr+06WyMIg724yQyAIwtS9X0czKBGUESrtTTb1HCXLeTwnncOTxh6q2z42LF <br> tn34+DECgYEA6EEp4oTvjfTQfUQPMByuAjF1hpdFHQqRymygiFgoF+Mg3QmL0w8j <br> /84H/q7s8FSx+3th8MK87bFq4lrry+h/mYwmvF5zZbhxcnl2uaX+KUPgpT6TgvAo <br> WOv2wc4BSaoo9DrxrZId86vpO2qbopw6gkBsvw47HSoQ+FSqXtZ0p8kCgYEA94Zj <br> b1ulctUjybiszO93TAjkzx3lU3yL+B1eZiQXtJa3mgG+ka1R/uMfr0NlT+Jzo0My <br> wHV30YRJDxziCrDol9OgSSU0sXwEcUxUIBLBwXLCp1EmMsYG9PB/x4OTWve35a8F <br> O+rMxuvWaZeIOfVCfL8UEcWweYaVdWIonJN+ltsCgYEAjeSZ2UlMLZce9RjqioNL <br> EA31dlfeoqJ9dYUuAn6RaB6cSk51vWlnnfXazo9CNIYaAsFbkcL3t+QHn+jaXEZc <br> BowocjbmG4Q20zBAB6XRBJbynSIA7yMYE1N9+uOHx+CMisGkO12krOUfZex4zzzR <br> RhhkF8ly9htoKL9ZIv20YXkCgYBzH3UF6PkVZJ5lhtgP5Nx2Z7iLwBrV7ppnBrnO <br> BcFkw6iXH3KT7KmzQ82LxWvMcMVZzLpBGyFkOAOG3OchE9DKNKpa+sv8NHMYguip <br> li+5mneAPFTozoOTznuPvtl9OLO2RuXHTVh6uFub9tdsJW8L+A8MiQagLwE6fDHp <br> SQxaewKBgQDIyzL1THpW3+AMNrOZuI/d3Em5wpGJiZbDSBRosvsfGm/sHaz4Ik5E <br> nWnftgktmsAD60eORTTh9/ww/nm7f3q9kzT8Sv1MmqeRXq9VFIOeP/+8SSE/7LzD <br> izlb5xEtVD8LuY54jHyiOxiZC++TQswMnOKKi0Gx26MDoO7Tx9akVw== <br> -----END RSA PRIVATE KEY----- <br> <br> ################################################################# <br> <br> -----BEGIN PUBLIC KEY----- <br> MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4JDLu7Vtvg2yqbH6Y0eJ <br> PfoEsOlKzgmOodqhA1CqkEG4OpKisGW7ciGP4v37GE6edHBCEy4UNkVQtnpPBjzT <br> HvKd1pO70B84vD5OSrS7uNw2EYkjd/ZwhrJMrcQKRwPkkM4OiewaaAaK0vPWJIKw <br> lW61DY9X7LfNz7aOKMTbKnm1vdR0919AV98FUmNoQBgka6nXFGmNbi7D43MtLwxB <br> ZIXfFupEiANSvOs+57hgaCho7OWMGUOjLkG6HBscPhJ2W1H5DU9GjwL24ynTvKif <br> go1/2ue61MV1Pzh5CVaicJKNaRtgPd99gFhBGINsXV2X6Jh/W5nNsCddU4EI0AlO <br> 8wIDAQAB <br> -----END PUBLIC KEY----- <br></code> <br>  Como puede ver, las claves de cifrado asim√©trico son largas secuencias de caracteres generadas matem√°ticamente. <br></div></div><br>  Entonces, generamos las claves.  Ahora escribamos una funci√≥n para codificar datos: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Crypto.PublicKey <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RSA <span class="hljs-comment"><span class="hljs-comment">#        RSA. from Crypto.Hash import SHA256 #        SHA256.    #       from Crypto.Cipher import PKCS1_OAEP #   def encrypt_message(message, public_key, verbose = True): """Encripts the message using public_key. :param message: &lt;str&gt; Message for encryption :param public_key: &lt;object&gt; public_key :param verbose: &lt;bool&gt; Print description; :return: &lt;object&gt; Message encrypted with public_key """ message_hash = SHA256.new(message.encode()) #   . cipher = PKCS1_OAEP.new(public_key) message_with_hash = message.encode() + message_hash.hexdigest().encode() #      ,          encrypted_message = cipher.encrypt(message_with_hash) if verbose: print(f'Message: {message} was encrypted to\n{encrypted_message.hex()}') return encrypted_message def decrypt_message(encrypted_message, private_key): """Decripts the message using private_key and check it's hash :param encrypted_message: &lt;object&gt; Encrypted message :param private_key: &lt;object&gt; private_key :return: &lt;object&gt; Message decripted with private_key """ dsize = SHA256.digest_size*2 cipher = PKCS1_OAEP.new(private_key) decrypted_message_with_hesh = cipher.decrypt(encrypted_message) #   (  ) decrypted_message = decrypted_message_with_hesh[:-dsize] #      digest = SHA256.new(decrypted_message).hexdigest() #     if digest==decrypted_message_with_hesh[-dsize:].decode(): #      ,      ,   print(f"Success!\nEncrypted hash is {decrypted_message_with_hesh[-dsize:].decode()}\nDecrypted hash is {digest}") return decrypted_message.decode() else: print(f"Encryption was not correct: the hash of decripted message doesn't match with encrypted hash\nEncrypted hash is {decrypted_message_with_hesh[-dsize:]}\nDecrypted hash is {digest}")</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Pasos de flujo de trabajo</b> <div class="spoiler_text"><ol><li>  El agente genera un par de claves: <br><pre> <code class="python hljs">private_key, public_key = generate_keys()</code> </pre> <br></li><li>  Env√≠a la llave ABIERTA a la sede; </li><li>  En la sede, utilizando la clave p√∫blica, codifique la clave para el cifrado sim√©trico: <br><pre> <code class="python hljs">new_symmetric_key = <span class="hljs-string"><span class="hljs-string">'SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt'</span></span> encr_msg = encrypt_message(new_symmetric_key, public_key)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Conclusi√≥n</b> <div class="spoiler_text"> <code>Message: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt was encrypted to <br> 41e940507c96397e3feb4a53390c982633bb1775a52957996a8069bd22063086a0e831bf775a17909276aba0d0478ee6c953837c8ea5d20d40e1c8eb463aaa1bc5c93c71677b1a85e90439c9dbda8a98ce168acb38368155437c66815b84aa2fbdda0eb909e4e6079b4410c720eddd955ed048193bf87f8f9976a17ee32a58a71dfddf3db116343d949d29c25f72c511a440a50a5d4f1e01c37b24a1cb4127e191d3231328b2f120c7dbd0cb5bf19823f0978b8ed17d25952de4b146ef9724fff359eb2af503fdfd72b91525a5503b076ba9aaaeac55af3f8d210c12d579d45dd70362123c0b4b36ef9c2f7705e6f884a25553eb0e11e5077f11fa986d0ff280</code> <br> </div></div><br></li><li>  Esta larga secuencia se env√≠a de vuelta al agente; </li><li>  El agente descifra el mensaje recibido utilizando la clave privada: <br><pre> <code class="python hljs">recieved_symmetric_key = decrypt_message(encr_msg, private_key) print(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) print(<span class="hljs-string"><span class="hljs-string">f"New symmetric key is: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{recieved_symmetric_key}</span></span></span><span class="hljs-string">"</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Conclusi√≥n</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Success! Encrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c Decrypted hash is 42ad66445a05ac09e684bb21f9b487d95b9cfa11d02e0b459931321ee02f7c1c New symmetric key is: SOME_KEY_asdfasdfasdfasdfsdfgrtwhetynt</code> </pre> <br></div></div><br></li><li>  Luego, utilizando una nueva clave sim√©trica, el agente cifra los datos recibidos: <br><br><pre> <code class="python hljs">message = <span class="hljs-string"><span class="hljs-string">"""  120   120  / 120   10     30-5 (2)    4.0 """</span></span> encr_message = symmetric_encrypt(message, recieved_symmetric_key, verbose = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Conclusi√≥n</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Message was encrypted into:</code> </pre><br></div></div><br></li><li>  La sede descifra: <br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'DECRIPTION'</span></span>) decr_message = symmetric_decrypt(encr_message, new_symmetric_key) print(decr_message)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Conclusi√≥n</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">DECRIPTION Success! Encrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026 Decrypted hash is b0dbb35b28fbff258350a50c39282b73e31f408c9da937c81d8d48115b491026  120   120  / 120   10     30-5 (2)    4.0</code> </pre><br></div></div><br></li></ol><br></div></div><br>  <b>Voila!</b> <br><br>  En este ejemplo abstracto, vimos el trabajo de algoritmos de cifrado comunes.  El cifrado sim√©trico y asim√©trico, as√≠ como el hash, se utilizan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el trabajo de la web</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">firma electr√≥nica</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blockchain y criptomonedas</a> .  Espero que el material haya sido √∫til para comprender el funcionamiento de estas tecnolog√≠as. <br><br><h3>  Ep√≠logo </h3><br>  Como resultado, la inteligencia rebelde logr√≥ obtener informaci√≥n precisa sobre la vulnerabilidad de la estaci√≥n y el camino hacia ella, la presencia del Emperador para la inspecci√≥n, la presencia de un escudo de energ√≠a y su fuente en Endor.  El imperio vio a los esp√≠as, les inform√≥ mal sobre la capacidad de combate de la estaci√≥n.  La estaci√≥n tambi√©n fue asignada al sat√©lite de Endor, desde donde estaba protegida por un escudo. <br><br><div class="spoiler">  <b class="spoiler_title">Pero sabemos c√≥mo termin√≥ todo;)</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/452042/">https://habr.com/ru/post/452042/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452030/index.html">Historia de Internet: descubriendo la interactividad</a></li>
<li><a href="../452034/index.html">Autocontrol del tiempo para la autoeducaci√≥n y tiempo para leer libros</a></li>
<li><a href="../452036/index.html">Radio definida por software: ¬øc√≥mo funciona? Parte 2</a></li>
<li><a href="../452038/index.html">Trato peligroso</a></li>
<li><a href="../452040/index.html">El meteorito de Tunguska y sus hermanos menores.</a></li>
<li><a href="../452046/index.html">Mando a distancia con baja corriente de reposo en el ATmega328P</a></li>
<li><a href="../452052/index.html">C√≥mo redujimos a la mitad el costo de una lecci√≥n introductoria al ver una soluci√≥n de las aerol√≠neas</a></li>
<li><a href="../452054/index.html">Por qu√© WhatsApp nunca ser√° seguro</a></li>
<li><a href="../452056/index.html">Golang DevDay: 31 de mayo, Novosibirsk + transmisi√≥n</a></li>
<li><a href="../452060/index.html">La informaci√≥n predice la esperanza</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>