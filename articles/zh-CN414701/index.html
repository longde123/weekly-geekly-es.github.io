<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤·ğŸ½ â˜¸ï¸ ğŸ‘©ğŸ»â€ğŸ“ ä½¿ç”¨KOMPAS-3D APIâ†’ç¬¬10è¯¾â†’ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸² ğŸ¤² ğŸ‘²ğŸ» ğŸ›€ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬å‘¨æœŸçš„ç¬¬4è¯¾ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç†Ÿæ‚‰ç‰¹æ®Šå­—ç¬¦ã€‚ åœ¨æ­¤æ˜¾ç¤ºäº†å®ƒä»¬æœ€ç®€å•çš„ç”¨æ³•ã€‚ å®ƒè¿˜è¯´ï¼Œå¦‚æœksTextItemParamæ¥å£åŒæ—¶æŒ‡å®šäº†ç‰¹æ®Šå­—ç¬¦å’Œå­—ç¬¦ä¸²ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²å°†ç«‹å³ä½äºç‰¹æ®Šå­—ç¬¦ä¹‹åã€‚ ä½†æ˜¯ï¼Œæœ‰äº›ç‰¹æ®Šå­—ç¬¦è¿åäº†æ­¤è§„åˆ™ã€‚ ä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºå®ƒä»¬ã€‚ 




 è¯¾ç¨‹ç³»åˆ—â€œä½¿ç”¨KOMPAS-3D APIçš„å·¥ä½œâ€...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨KOMPAS-3D APIâ†’ç¬¬10è¯¾â†’ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/414701/"> åœ¨æœ¬å‘¨æœŸçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬4è¯¾ä¸­ï¼Œ</a>æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰ç‰¹æ®Šå­—ç¬¦ã€‚ åœ¨æ­¤æ˜¾ç¤ºäº†å®ƒä»¬æœ€ç®€å•çš„ç”¨æ³•ã€‚ å®ƒè¿˜è¯´ï¼Œå¦‚æœ<b>ksTextItemParam</b>æ¥å£åŒæ—¶æŒ‡å®šäº†ç‰¹æ®Šå­—ç¬¦å’Œå­—ç¬¦ä¸²ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²å°†ç«‹å³ä½äºç‰¹æ®Šå­—ç¬¦ä¹‹åã€‚ ä½†æ˜¯ï¼Œæœ‰äº›ç‰¹æ®Šå­—ç¬¦è¿åäº†æ­¤è§„åˆ™ã€‚ ä»Šå¤©æˆ‘ä»¬å°†è®¨è®ºå®ƒä»¬ã€‚ <br><br><img src="https://habrastorage.org/webt/iw/kr/zf/iwkrzfipwrlcopjm1kbpct1n2j4.png"><br><br><a name="habracut"></a><br><blockquote><h4> è¯¾ç¨‹ç³»åˆ—â€œä½¿ç”¨KOMPAS-3D APIçš„å·¥ä½œâ€çš„å†…å®¹ </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºç¡€çŸ¥è¯†</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å›¾çº¸è®¾è®¡</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­£ç¡®è¿æ¥åˆ°KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸»é¢˜è¯</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å›¾å½¢å›¾å…ƒ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»¥å„ç§æ ¼å¼ä¿å­˜æ–‡æ¡£</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†è§£è®¾ç½®</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ ‡é¢˜æ ä¸­æ›´å¤æ‚çš„ä¹¦å†™æ–¹æ³•</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯»å–å­—å¹•å•å…ƒ</a> </li><li>  <b>ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²</b> </li></ol><br></blockquote><br><h2>  <font color="#00B2FF">ç‰¹æ®Šå­—ç¬¦ï¼ŒåŒ…æ‹¬å­—ç¬¦ä¸²</font> </h2><br><img src="https://habrastorage.org/webt/0s/x3/wh/0sx3whiq1g1yjkqoi764nrg8owm.png"><br>  <i>ç‰¹æ®Šç¬¦å·è¡¨åœ¨KOMPASä¸»è¦å¸®åŠ©çš„é™„å½•Vä¸­</i> <br><br> å­—ç¬¦ä¸²åŒ…æ‹¬å¸¦æœ‰æ•°å­—<i>78-80ï¼Œ83ï¼Œ93-99ï¼Œ171</i>å’Œ<i>172çš„</i>ç‰¹æ®Šå­—ç¬¦ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <b>ksTextItemParam</b>æ¥å£çš„å­—ç¬¦ä¸²<b>s</b>ä¸åœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹åï¼Œè€Œæ˜¯åœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹åã€‚ ä¾‹å¦‚ï¼Œå¸¦æœ‰æ•°å­—<i>80</i>çš„ç‰¹æ®Šå­—ç¬¦å°†åœ¨æ¡†æ¶ä¸­æ˜¾ç¤ºæ–‡æœ¬ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªç¨‹åºç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨è¿™ç§ç‰¹æ®Šå­—ç¬¦ã€‚ <br><br><pre><code class="hljs erlang-repl">//    TextItemParamPtr TextItemParam; TextItemParam=(TextItemParamPtr)kompas-&gt;GetParamStruct(ko_TextItemParam); //  TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">98</span></span>); BSTR str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">""</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); //    StampPtr Stamp; Stamp=(StampPtr)Document2D-&gt;GetStamp(); //     Stamp-&gt;ksOpenStamp(); Stamp-&gt;ksColumnNumber(<span class="hljs-number"><span class="hljs-number">1</span></span>); Stamp-&gt;ksTextLine(TextItemParam); //     Stamp-&gt;ksCloseStamp(); Stamp.Unbind(); TextItemParam.Unbind(); Document2D.Unbind(); //   kompas-&gt;Visible = true; kompas.Unbind();</code> </pre> <br> ä¸ºç®€å•èµ·è§ï¼Œæ­¤ç¤ºä¾‹çœç•¥äº†è´Ÿè´£åˆ›å»ºå’Œæ‰§è¡Œæ–‡æ¡£çš„ä»£ç ï¼ˆåœ¨æœ¬å‘¨æœŸçš„å…ˆå‰è¯¾ç¨‹ä¸­è®¨è®ºäº†è¯¥ä¸»é¢˜ï¼‰ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†æ­¤ç¨‹åºå½¢æˆçš„ä¸»è¦æ ‡ç­¾ã€‚ <br><br><img src="https://habrastorage.org/webt/19/we/pi/19wepilxlhns4c6pzxl4okbo-4u.png"><br><br> ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä»…å¡«å†™ä¸€ä¸ªå•å…ƒæ ¼ã€‚ å¸¦æœ‰æ•°å­—<i>98</i>çš„ç‰¹æ®Šå­—ç¬¦å®šä¹‰å¹³æ–¹æ ¹çš„ç¬¦å·ã€‚ è¯·æ³¨æ„ï¼Œ <b>ksTextItemParam</b>æ¥å£çš„så±æ€§çš„å€¼å®Œå…¨åœ¨æ ¹ç¬¦å·ä¸‹ã€‚ å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼ˆåŒ…æ‹¬å­—ç¬¦ä¸²ï¼‰çš„å·¥ä½œæ–¹å¼ä¹Ÿå®Œå…¨ç›¸åŒã€‚ <br><br><h2>  <font color="#00B2FF">ç‰¹æ®Šå­—ç¬¦å’Œ<b>ksTextLineParam</b></font> </h2><br> ç‰¹æ®Šå­—ç¬¦çš„ä½œç”¨ä¸ä»…é™äº<b>ksTextItemParam</b>æ¥å£ã€‚ è€ƒè™‘ä¸‹é¢çš„ç¤ºä¾‹ã€‚ <br><br><pre> <code class="hljs erlang-repl">//     TextItemParamPtr TextItemParam; TextItemParam=(TextItemParamPtr)kompas-&gt;GetParamStruct(ko_TextItemParam); //     DynamicArrayPtr DynamicArray; DynamicArray=(DynamicArrayPtr)kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR); //   TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">98</span></span>); BSTR str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"1 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   TextItemParam-&gt;Init(); TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">169</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"2 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   TextItemParam-&gt;Init(); TextItemParam-&gt;set_type(<span class="hljs-number"><span class="hljs-number">0</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">" 3"</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   ksTextLineParam TextLineParamPtr TextLineParam; TextLineParam=(TextLineParamPtr)kompas-&gt;GetParamStruct(ko_TextLineParam); TextLineParam-&gt;SetTextItemArr(DynamicArray); //    StampPtr Stamp; Stamp=(StampPtr)Document2D-&gt;GetStamp(); //     Stamp-&gt;ksOpenStamp(); Stamp-&gt;ksColumnNumber(<span class="hljs-number"><span class="hljs-number">1</span></span>); Stamp-&gt;ksTextLine(TextLineParam); //     Stamp-&gt;ksCloseStamp(); Stamp.Unbind(); TextItemParam.Unbind(); TextLineParam.Unbind(); DynamicArray-&gt;ksDeleteArray(); DynamicArray.Unbind(); Document2D.Unbind(); //   kompas-&gt;Visible = true; kompas.Unbind();</code> </pre><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œåœ¨æ ‡é¢˜æ ä¸­è¾“å…¥äº†ç”±ä¸‰ä¸ªç»„ä»¶ç»„æˆçš„è¡Œã€‚ å‰ä¸¤ä¸ªåŒ…å«ç‰¹æ®Šå­—ç¬¦å’Œå­—ç¬¦ä¸²ã€‚ ç¬¬ä¸‰éƒ¨åˆ†ä»…åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ²¡æœ‰ç‰¹æ®Šå­—ç¬¦ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ç¨‹åºçš„ç»“æœï¼ˆä¸‹å›¾ä»…æ˜¾ç¤ºäº†ç”Ÿæˆçš„è¡Œï¼Œæ²¡æœ‰ä¸»æ ‡é¢˜ï¼‰ã€‚ <br><br><img src="https://habrastorage.org/webt/0o/4a/pk/0o4apkmrscynicmcq1otwlhtkfm.png"><br><br> è¯·æ³¨æ„ï¼Œç¬¬äºŒä¸ªç‰¹æ®Šå­—ç¬¦<i>ä¸­</i>åŒ…å«<i>â€œç¬¬2é¡µâ€</i>è¡Œå’Œ<i>â€œç¬¬3é¡µâ€</i>è¡Œï¼Œæˆ‘ä»¬è®¡åˆ’å°†å…¶æ˜¾ç¤ºåœ¨ç‰¹æ®Šå­—ç¬¦ä¹‹å¤–ã€‚ è€Œä¸”ï¼Œè¿™ä¸¤ä¸ªè¡Œéƒ½åŒ…å«åœ¨ç¬¬ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ä¸­ï¼ˆæˆ‘ä»¬ä¹Ÿä¸æ‰“ç®—è¿™æ ·åšï¼‰ã€‚ æ­¤ç¤ºä¾‹è¯´æ˜äº†ä¸¤ä¸ªé‡è¦ç‚¹ï¼š <br><br><ul><li> ç‰¹æ®Šå­—ç¬¦å¯èƒ½åŒ…æ‹¬å…¶ä»–ç‰¹æ®Šå­—ç¬¦ï¼› </li><li> ç‰¹æ®Šå­—ç¬¦çš„ä½œç”¨æ‰©å±•åˆ°ç»„æˆ<b>ksTextLineParam</b>æ¥å£çš„æ‰€æœ‰ç»„ä»¶ã€‚ </li></ul><br> å‡ºç°ä¸€ä¸ªåˆç†çš„é—®é¢˜-æ˜¯å¦æœ‰åŠæ³•é™åˆ¶ç‰¹æ®Šå­—ç¬¦çš„ä½œç”¨ï¼Ÿ æ˜¯çš„ï¼Œæœ‰ã€‚ ä½†æ˜¯ï¼Œä¸ºäº†ç†è§£å®ƒï¼Œæ‚¨é¦–å…ˆéœ€è¦ç†Ÿæ‚‰<b>ksTextItemFont</b>æ¥å£ã€‚ <br><br><h2>  <font color="#00B2FF">æ–‡æœ¬ç»„ä»¶å­—ä½“é€‰é¡¹ï¼ˆ <b>ksTextItemFont</b> ï¼‰</font> </h2><br> æ ¹æ®æ–‡æ¡£ï¼Œ <b>ksTextItemFont</b>æ¥å£æè¿°äº†æ–‡æœ¬ç»„ä»¶çš„å­—ä½“å‚æ•°ã€‚ ä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒçš„åŠŸèƒ½è¶…å‡ºäº†æ‰€ä½¿ç”¨å­—ä½“çš„ç®€å•æè¿°ã€‚ è¯¥ç•Œé¢å…è®¸æ‚¨åˆ›å»ºå¤åˆçº¿ï¼ˆå…³äºå®ƒä»¬-åœ¨æœ¬å‘¨æœŸçš„ä¸‹ä¸€è¯¾ä¸­ï¼‰ã€‚ <br><br> æ‚¨å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è·å¾—å®ƒã€‚ é¦–å…ˆï¼Œä½¿ç”¨<b>KompasObject</b>æ¥å£çš„<b>GetParamStruct</b>æ–¹æ³•ï¼šä¸ºæ­¤ï¼Œåº”å°†å¸¸æ•°<b>ko_TextItemFont</b>ä½œä¸ºå”¯ä¸€å‚æ•°ä¼ é€’ç»™æ­¤æ–¹æ³•ã€‚ å…¶æ¬¡ï¼Œä½¿ç”¨<b>ksTextItemParam</b>æ¥å£çš„<b>GetItemFont</b>æ–¹æ³•ã€‚ æ­¤æ–¹æ³•æ²¡æœ‰è¾“å…¥å‚æ•°ï¼Œå¹¶è¿”å›å·²ç»ä¸æ–‡æœ¬ç»„ä»¶å…³è”çš„<b>ksTextItemFont</b>æ¥å£ã€‚ <br><br> è€ƒè™‘<b>ksTextItemFont</b>æ¥å£çš„å±æ€§ã€‚ <br> ä½å‘é‡-å®šä¹‰æ–‡æœ¬ç‰¹å¾çš„ä½å‘é‡ï¼ˆå°†åœ¨æœ¬å‘¨æœŸçš„ä¸‹ä¸€è¯¾ä¸­è¯¦ç»†è®¨è®ºï¼‰ã€‚ <br>  <b>color</b> -RGBæ ¼å¼å­—ç¬¦çš„é¢œè‰²ã€‚ <br>  <b>fontName-</b>å…·æœ‰å­—ä½“åç§°çš„å­—ç¬¦ä¸²ã€‚ <br>  <b>height-</b>å­—ä½“é«˜åº¦ï¼Œä»¥æ¯«ç±³ä¸ºå•ä½ã€‚ <br>  <b>ksu</b>æ˜¯æ–‡æœ¬æ‹‰ä¼¸å› å­ã€‚ <br>  <b>ksTextItemFont</b>æ¥å£åªæœ‰ä¸‰ç§æ–¹æ³•ã€‚ <br>  <b>Initï¼ˆï¼‰</b>é‡ç½®æ‰€æœ‰æ¥å£å±æ€§ã€‚ æ²¡æœ‰è¾“å…¥å‚æ•°ã€‚ å¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›<i>TRUE</i> ï¼Œå¦‚æœå‡ºç°é”™è¯¯ï¼Œåˆ™è¿”å›<i>-FALSE</i> ã€‚ <br>  <b>GetBitVectorValue</b>ä»ä½<b>å‘é‡</b>é›†ä¸­è¿”å›å•ä¸ªæ ‡å¿—çš„å€¼ã€‚ å®ƒä»¥æ ‡å¿—ä½œä¸ºå”¯ä¸€å‚æ•°ï¼Œæˆ‘ä»¬è¦ç¡®å®šå…¶å€¼ã€‚ å¦‚æœè®¾ç½®ï¼Œåˆ™è¯¥æ–¹æ³•è¿”å›<i>TRUE</i> ï¼›å¦‚æœé‡ç½®ï¼Œåˆ™è¿”å›<i>FALSE</i> ã€‚ <br>  <b>SetBitVectorValue</b>æ›´æ”¹å•ä¸ªæ ‡å¿—çš„å€¼ã€‚ ä»¥ä¸‹æ˜¯æ­¤æ–¹æ³•çš„åŸå‹ï¼š <br><br><pre> <code class="hljs objectivec"><span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span> SetBitVectorValue ( <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> bitVector, <span class="hljs-comment"><span class="hljs-comment">//  BOOL state //   );</span></span></code> </pre><br> å¦‚æœ<b>çŠ¶æ€</b>å‚æ•°å€¼ä¸º<i>TRUE</i> ï¼Œåˆ™<b>bitVector</b>æ ‡å¿—å°†<b>è¢«</b>ç«–èµ·ï¼Œå¦åˆ™å°†è¢«é‡ç½®ã€‚ <br> å¦‚æœæˆåŠŸï¼Œåˆ™<b>SetBitVectorValue</b>æ–¹æ³•è¿”å›<i>TRUE</i> ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œåˆ™è¿”å›<i>FALSE</i> ã€‚ <br>  <b>GetBitVectorValue</b>å’Œ<b>SetBitVectorValueæ–¹æ³•</b>å…è®¸æ‚¨ä½¿ç”¨<b>bitvector</b>å±æ€§ï¼Œè€Œæ— éœ€ç›´æ¥è®¿é—®å®ƒã€‚ <br><br><h2>  <font color="#00B2FF">ç‰¹æ®Šå­—ç¬¦é™åˆ¶</font> </h2><br> è®¾è®¡äº†ä¸¤ä¸ªæ ‡å¿—æ¥æ§åˆ¶ç‰¹æ®Šå­—ç¬¦ã€‚ å®ƒä»¬åœ¨ä¸‹è¡¨ä¸­åˆ—å‡ºã€‚ <br><br><img src="https://habrastorage.org/webt/i0/d1/gi/i0d1gimygumrgjotsp1o6fksiyg.png"><br><br> æè¿°æ¥å£<b>ksTextItemParam</b>æ—¶å·²ç»è€ƒè™‘è¿‡æ ‡å¿—<b>SPECIAL_SYMBOL</b> ã€‚ ä¸ºäº†æŒ‡ç¤º-éœ€è¦ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦è€Œæ˜¾ç¤ºã€‚  <b>ksTextItemFont</b>æ¥å£çš„<b>bitVector</b>å±æ€§ä¸­å¤åˆ¶äº†ç›¸åŒçš„æ ‡å¿—ï¼ˆå¦‚æˆ‘çš„å®éªŒæ‰€ç¤ºï¼Œæ­¤å¤åˆ¶æ˜¯å¯é€‰çš„ï¼‰ã€‚ <br><br> ç¬¬äºŒä¸ªæ ‡å¿—ï¼ˆ <b>SPECIAL_SYMBOL_END</b> ï¼‰ä»…å¯¹åŒ…å«å­—ç¬¦ä¸²çš„ç‰¹æ®Šå­—ç¬¦æœ‰æ„ä¹‰ã€‚ å–æ¶ˆç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œã€‚ è¯¥æ ‡å¿—ä¹‹åæ˜¾ç¤ºçš„è¡Œä¸åŒ…å«åœ¨ç‰¹æ®Šå­—ç¬¦ä¸­ã€‚ <br><br> ä¸¤ä¸ªæ ‡å¿—çš„ç»„åˆåŠ¨ä½œå–æ¶ˆç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‰¹æ®Šå­—ç¬¦å°†ä¸ä¼šæ˜¾ç¤ºåœ¨æ–‡æ¡£ä¸­ã€‚ <br><br><h2>  <font color="#00B2FF">ä¾‹å­</font> </h2><br> ä¸‹é¢æ˜¯ä¿®æ”¹åçš„ç¨‹åºçš„æºä»£ç ã€‚ ä½¿ç”¨ä¸Šè¿°æ ‡å¿—ï¼Œå®ƒå¯ä»¥å®ç°ç»„ä»¶çš„æ­£ç¡®è¾“å‡ºã€‚ <br><br><pre> <code class="hljs erlang-repl">//     TextItemParamPtr TextItemParam; TextItemParam=(TextItemParamPtr)kompas-&gt;GetParamStruct(ko_TextItemParam); //     DynamicArrayPtr DynamicArray; DynamicArray=(DynamicArrayPtr)kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR); //   TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">98</span></span>); BSTR str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"1 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   TextItemFontPtr TextItemFont; TextItemParam-&gt;Init(); TextItemFont=(TextItemFontPtr)TextItemParam-&gt;GetItemFont(); TextItemFont-&gt;set_bitVector(SPECIAL_SYMBOL_END); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); TextItemFont-&gt;Init(); TextItemFont.Unbind(); //   TextItemParam-&gt;Init(); TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">169</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"2 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //      TextItemParam-&gt;Init(); TextItemFont=(TextItemFontPtr)TextItemParam-&gt;GetItemFont(); TextItemFont-&gt;set_bitVector(SPECIAL_SYMBOL_END); TextItemParam-&gt;set_type(<span class="hljs-number"><span class="hljs-number">0</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  3"</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); TextItemFont.Unbind(); //   ksTextLineParam TextLineParamPtr TextLineParam; TextLineParam=(TextLineParamPtr)kompas-&gt;GetParamStruct(ko_TextLineParam); TextLineParam-&gt;SetTextItemArr(DynamicArray); //    StampPtr Stamp; Stamp=(StampPtr)Document2D-&gt;GetStamp(); //     Stamp-&gt;ksOpenStamp(); Stamp-&gt;ksColumnNumber(<span class="hljs-number"><span class="hljs-number">1</span></span>); Stamp-&gt;ksTextLine(TextLineParam); //     Stamp-&gt;ksCloseStamp(); Stamp.Unbind(); TextItemParam.Unbind(); TextLineParam.Unbind(); DynamicArray-&gt;ksDeleteArray(); DynamicArray.Unbind(); Document2D.Unbind(); //   kompas-&gt;Visible = true; kompas.Unbind();</code> </pre><br> æ­¤ç¤ºä¾‹ä¸ä¸Šä¸€ä¸ªç¤ºä¾‹ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œåœ¨æ¯ä¸ªç‰¹æ®Šå­—ç¬¦ä¹‹åéƒ½ä¼šæ˜¾ç¤ºä¸€ä¸ªç»„ä»¶ï¼Œè¯¥ç»„ä»¶çš„<b>ksTextItemFont</b>æ¥å£ä¸­è®¾ç½®äº†<b>SPECIAL_SYMBOL_END</b>æ ‡å¿—ã€‚ å…¶å”¯ä¸€ç›®çš„æ˜¯å–æ¶ˆç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œã€‚ åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œå®ƒä¸åŒ…å«ä»»ä½•æ•°æ®ï¼ˆå½“ç„¶ï¼Œæ ‡å¿—é™¤å¤–ï¼‰ã€‚ åœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«å­—ç¬¦ä¸²<i>â€œ Page 3â€</i> ã€‚ <br><br> æ‚¨ä¸èƒ½å°†<b>SPECIAL_SYMBOL_END</b>æ ‡å¿—ä¸ç¬¬äºŒä¸ªç‰¹æ®Šå­—ç¬¦çš„è¾“å‡ºç»“åˆä½¿ç”¨ã€‚ ç”±äºåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ­¤æ ‡å¿—å°†å–æ¶ˆä¸¤ä¸ªç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œã€‚ å°†æ˜¾ç¤º<i>â€œé¡µ2â€</i>è¡Œè€Œæ²¡æœ‰åˆ é™¤çº¿ã€‚ <br><br> ä¸‹å›¾æ˜¾ç¤ºäº†è¯¥ç¨‹åºåœ¨æ ‡é¢˜æ ä¸­æ˜¾ç¤ºçš„è¡Œã€‚ <br><br><img src="https://habrastorage.org/webt/hj/cd/tn/hjcdtneeonrdvngvleec6uaxuic.png"><br><br> å¦‚æ‚¨æ‰€è§ï¼Œç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œç°åœ¨ä»…é€‚ç”¨äºâ€œæ‚¨çš„â€ç»„ä»¶ã€‚ <br><br><h2>  <font color="#00B2FF">åµŒå¥—çš„ç‰¹æ®Šç¬¦å·</font> </h2><br> ä»Šå¤©çš„è¯¾ç¨‹çš„ç¬¬ä¸€ä¸ªç¤ºä¾‹æ¸…æ¥šåœ°æ˜¾ç¤ºäº†-ç‰¹æ®Šå­—ç¬¦å¯ä»¥ç›¸äº’åµŒå…¥ã€‚  <b>SPECIAL_SYMBOL_END</b>æ ‡å¿—å–æ¶ˆä¸€ä¸ªï¼ˆæœ€åä¸€ä¸ªï¼‰ç‰¹æ®Šå­—ç¬¦çš„åŠ¨ä½œã€‚ è¿™ä½¿æ‚¨å¯ä»¥ä½¿ç”¨åµŒå…¥çš„ç‰¹æ®Šå­—ç¬¦æ¥æ„å»ºå¤æ‚çš„è¡Œã€‚ <br><br> ä¸‹é¢æ˜¯ä¿®æ”¹ç¤ºä¾‹çš„æºä»£ç ï¼Œå…¶ä¸­å­å­—ç¬¦ä¸²<i>â€œ Page 2â€</i>ä¹ŸåŒ…å«åœ¨å¹³æ–¹æ ¹ç¬¦å·ä¸‹çš„è¡¨è¾¾å¼ä¸­ã€‚ <br><br><pre> <code class="hljs erlang-repl">//     TextItemParamPtr TextItemParam; TextItemParam=(TextItemParamPtr)kompas-&gt;GetParamStruct(ko_TextItemParam); //     DynamicArrayPtr DynamicArray; DynamicArray=(DynamicArrayPtr)kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR); //   TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">98</span></span>); BSTR str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"1 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   TextItemParam-&gt;Init(); TextItemParam-&gt;set_type(SPECIAL_SYMBOL); TextItemParam-&gt;set_iSNumb(<span class="hljs-number"><span class="hljs-number">169</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"2 "</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //   TextItemFontPtr TextItemFont; TextItemParam-&gt;Init(); TextItemFont=(TextItemFontPtr)TextItemParam-&gt;GetItemFont(); TextItemFont-&gt;set_bitVector(SPECIAL_SYMBOL_END); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); //      TextItemParam-&gt;set_type(<span class="hljs-number"><span class="hljs-number">0</span></span>); str = SysAllocString(L<span class="hljs-string"><span class="hljs-string">"  3"</span></span>); TextItemParam-&gt;set_s(str); SysFreeString(str); DynamicArray-&gt;ksAddArrayItem(-<span class="hljs-number"><span class="hljs-number">1</span></span>, TextItemParam); TextItemFont.Unbind(); //   ksTextLineParam TextLineParamPtr TextLineParam; TextLineParam=(TextLineParamPtr)kompas-&gt;GetParamStruct(ko_TextLineParam); TextLineParam-&gt;SetTextItemArr(DynamicArray); //    StampPtr Stamp; Stamp=(StampPtr)Document2D-&gt;GetStamp(); //     Stamp-&gt;ksOpenStamp(); Stamp-&gt;ksColumnNumber(<span class="hljs-number"><span class="hljs-number">1</span></span>); Stamp-&gt;ksTextLine(TextLineParam); //     Stamp-&gt;ksCloseStamp(); Stamp.Unbind(); TextItemParam.Unbind(); TextLineParam.Unbind(); DynamicArray-&gt;ksDeleteArray(); DynamicArray.Unbind(); Document2D.Unbind(); //   kompas-&gt;Visible = true; kompas.Unbind();</code> </pre><br> è¯·æ³¨æ„ï¼Œåœ¨æ›¿æ¢å­—ç¬¦ä¸²<i>â€œ Page 2â€ä¹‹åï¼Œ</i>æˆ‘ä»¬å°†è¾“å‡ºå¸¦æœ‰æ ‡å¿—<b>SPECIAL_SYMBOL_END</b>çš„ç»„ä»¶ï¼ˆç¬¬ä¸€æ¬¡-ä½œä¸ºç©ºç»„ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œç¬¬äºŒæ¬¡-ä¸å­—ç¬¦ä¸²<i>â€œ Page 3â€ä¸€èµ·</i> ï¼‰ã€‚ è¿™æ˜¯å–æ¶ˆç‰¹æ®Šå­—ç¬¦çš„æ“ä½œæ‰€å¿…éœ€çš„ã€‚ æˆ‘ä»¬ç¬¬ä¸€æ¬¡å–æ¶ˆç‰¹æ®Šå­—ç¬¦<i>169</i> ï¼ˆåˆ é™¤çº¿ï¼‰ï¼Œç¬¬äºŒæ¬¡å–æ¶ˆ<i>98</i> ï¼ˆå¹³æ–¹æ ¹ï¼‰ã€‚ å¦‚æœæˆ‘ä»¬åª<b>æ˜¾ç¤º</b>ä¸€ä¸ªå¸¦æœ‰<b>SPECIAL_SYMBOL_END</b>æ ‡å¿—çš„ç»„ä»¶ï¼Œè¿™å°†ä»…å–æ¶ˆç‰¹æ®Šå­—ç¬¦<i>169</i> ï¼Œè€Œä¸å–æ¶ˆ<i>98</i> ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ <i>â€œé¡µ3â€</i>è¡Œä¸ä¼šè¢«åˆ’æ‰ï¼Œè€Œæ˜¯ä¼šåŒ…å«åœ¨è¡¨è¾¾å¼ä¸­çš„æ ¹ç¬¦å·ä¸‹ã€‚ <br> ä¸‹å›¾æ˜¾ç¤ºäº†è¯¥ç¨‹åºçš„ç»“æœã€‚ <br><br><img src="https://habrastorage.org/webt/fs/x5/gc/fsx5gc3eq24wn7m1k1mbbgfah_m.png"><br><br>  <b>ç»“è®º</b> <br><br> åœ¨æœ¬è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬é‡åˆ°äº†åŒ…å«å­—ç¬¦ä¸²çš„ç‰¹æ®Šå­—ç¬¦ã€‚ å¦‚æ‚¨æ‰€è§ï¼Œå®ƒä»¬ä¸ç®€å•çš„ç‰¹æ®Šå­—ç¬¦ï¼ˆä¾‹å¦‚ï¼Œå¸Œè…Šå­—æ¯ï¼‰å¤§ä¸ç›¸åŒã€‚ å°½ç®¡æˆ‘ä»¬åœ¨ä¸»é“­æ–‡ç¤ºä¾‹ä¸­æ˜¾ç¤ºäº†å®ƒä»¬ï¼Œä½†è¿™ä¸åº”ä½¿æ‚¨æ„Ÿåˆ°å›°æƒ‘ã€‚ è¿™äº›å­—ç¬¦å¯ä»¥åœ¨å…¶ä»–æ–‡æœ¬è¾“å‡ºæ–¹æ³•ä¸­ä½¿ç”¨ã€‚ åœ¨ä¸‹ä¸€è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘å…¶ä¸­ä¸€ç§æ–¹æ³•ã€‚ <br><br>  <b>è¦ç»§ç»­ï¼Œè¯·å…³æ³¨åšå®¢æ–°é—»ã€‚</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseevåšå£«ï¼Œã€Šåœ¨Delphiä¸­è¿›è¡ŒCOMPASçš„åº”ç”¨ç¨‹åºå¼€å‘ã€‹ä¸€ä¹¦çš„ä½œè€…ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN414701/">https://habr.com/ru/post/zh-CN414701/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN414689/index.html">å…¬å¼€è¯¾â€œ Spring Boot 2.0ä¸Šçš„Webåº”ç”¨ç¨‹åºå’Œå¾®æœåŠ¡â€</a></li>
<li><a href="../zh-CN414691/index.html">èƒŒæ™¯ YouTubeéŸ³ä¹å’ŒYouTubeé«˜çº§ç‰ˆï¼šå®ƒæ˜¯ä»€ä¹ˆä»¥åŠå®ƒä»¬ä¹‹é—´çš„ä¸åŒ</a></li>
<li><a href="../zh-CN414693/index.html">Windows 10ä¸Šé€šè¿‡Adaptec 78xx SCSIçš„Fujitsu fi-4750C</a></li>
<li><a href="../zh-CN414695/index.html">çº³ç±³äº‹ç‰©äº’è”ç½‘çš„çº³ç±³ä»‹ç»ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN414699/index.html">ç¨‹åºç”Ÿæˆçš„è¡Œæ˜Ÿè¡¨é¢ä¸Šçš„ä¸è§„åˆ™ç“·ç –</a></li>
<li><a href="../zh-CN414703/index.html">ï¼ˆå·®ä¸å¤šï¼‰å…­ä¸ªæœˆå-å¯¹å»‰ä»·å®¶ç”¨æŠ•å½±æœºEpson EH-TW610å’ŒEpson EH-TW650æå‡ºäº†ä¸€äº›æ„è§ã€‚ è¿˜æœ‰å¦ä¸€ä¸ªæ°‘æ„è°ƒæŸ¥</a></li>
<li><a href="../zh-CN414705/index.html">å…¨çƒæ‰¬å£°å™¨æ„é€ çš„æ°ä½œï¼šMonitor Audioä»ç»‡ç‰©åˆ°é‡‘å±å’Œå¤åˆææ–™çš„åˆ›æ–°ä¹‹è·¯</a></li>
<li><a href="../zh-CN414707/index.html">åŒºå—é“¾åˆ†æï¼Œæˆ–è€…ä¸ºä»€ä¹ˆæ··é¢‘å™¨ä¸­æ–­ï¼Ÿ</a></li>
<li><a href="../zh-CN414709/index.html">æ²™æ¼ ç‹®å­ä¸è‡ªçœ</a></li>
<li><a href="../zh-CN414711/index.html">è¥¿ç­ç‰™è¶³çƒåº”ç”¨ç¨‹å¼La Ligaä½¿å…¶ä½¿ç”¨è€…æˆä¸ºéè‡ªæ„¿è¯ˆéª—è€…</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>