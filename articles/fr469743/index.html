<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçé ü§¨ ü¶ó Celestia: les aventures de bugs dans l'espace üõ©Ô∏è ‚è≥ üèÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Celestia est un simulateur spatial en trois dimensions. La simulation spatiale nous permet d'explorer notre univers en trois dimensions. Celestia est ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Celestia: les aventures de bugs dans l'espace</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/469743/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/230/63e/3b7/23063e3b758a73fe27fc09ff16f33c1b.png" alt="Image 1"></div><br>  Celestia est un simulateur spatial en trois dimensions.  La simulation spatiale nous permet d'explorer notre univers en trois dimensions.  Celestia est disponible sur Windows, Linux et macOS.  Le projet est tr√®s petit et en lui, en utilisant PVS-Studio, un tr√®s petit nombre de d√©fauts sont d√©tect√©s.  Cependant, nous voulons vraiment faire attention √† lui, car il s'agit d'un projet √©ducatif populaire qui est utile pour s'am√©liorer.  Soit dit en passant, le programme est utilis√© dans des films, s√©ries et programmes populaires pour repr√©senter l'espace.  Ce qui soul√®ve √©galement les exigences de qualit√© du code. <br><a name="habracut"></a><br><h2>  Pr√©sentation </h2><br>  Sur le site officiel du projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Celestia</a> , vous pouvez en trouver une description d√©taill√©e.  Le code source du projet est h√©berg√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> .  Excluant les biblioth√®ques et les tests, l'analyseur a v√©rifi√© 166 fichiers .cpp.  Le projet est petit, mais les d√©fauts constat√©s sont assez int√©ressants. <br><br>  Pour analyser le code, nous avons utilis√© l'analyseur de code statique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PVS-Studio</a> .  Celestia et PVS-Studio sont multi-plateformes.  Pour l'analyse, la plate-forme Windows a √©t√© s√©lectionn√©e.  Le projet a √©t√© facile √† construire en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©cup√©rant</a> les d√©pendances √† l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vcpkg</a> , le gestionnaire de biblioth√®que Microsoft.  Selon les critiques, il est inf√©rieur √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conan</a> , mais ce programme √©tait √©galement pratique √† utiliser. <br><br><h2>  R√©sultats d'analyse </h2><br>  <b>Avertissement 1</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V501</a> Il existe des sous-expressions identiques √† gauche et √† droite de l'op√©rateur '&lt;': b.nAttributes &lt;b.nAttributes cmodfix.cpp 378 <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>&lt;(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Mesh::VertexDescription&amp; a, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Mesh::VertexDescription&amp; b) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a.stride &lt; b.stride) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.stride &lt; a.stride) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a.nAttributes &lt; b.nAttributes) <span class="hljs-comment"><span class="hljs-comment">// &lt;= return true; if (b.nAttributes &lt; b.nAttributes) // &lt;= return false; for (uint32_t i = 0; i &lt; a.nAttributes; i++) { if (a.attributes[i] &lt; b.attributes[i]) return true; else if (b.attributes[i] &lt; a.attributes[i]) return false; } return false; }</span></span></code> </pre> <br>  Comme il est facile de faire des erreurs lors de la copie de code.  Nous √©crivons √† ce sujet dans chaque avis.  Apparemment, seule l'analyse de code statique peut aider dans cette situation. <br><br>  Le programmeur a copi√© l'expression conditionnelle et ne l'a pas enti√®rement modifi√©e.  L'option correcte est tr√®s probablement la suivante: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (a.nAttributes &lt; b.nAttributes) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (b.nAttributes &lt; a.nAttributes) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre> <br>  Une √©tude int√©ressante sur ce sujet: ¬´Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mal vit dans les fonctions de comparaison</a> ¬ª. <br><br>  <b>Avertissement 2</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V575</a> La fonction 'memset' traite les √©l√©ments '0'.  Inspectez le troisi√®me argument.  winmain.cpp 2235 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuildScriptsMenu</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HMENU menuBar, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fs::path&amp; scriptsDir)</span></span></span><span class="hljs-function"> </span></span>{ .... MENUITEMINFO info; <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(&amp;info, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(info), <span class="hljs-number"><span class="hljs-number">0</span></span>); info.cbSize = <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(info); info.fMask = MIIM_SUBMENU; .... }</code> </pre> <br>  L'auteur du code a m√©lang√© les deuxi√®me et troisi√®me arguments √† la fonction <i>memset</i> .  Au lieu de remplir la structure avec des z√©ros, il est indiqu√© de remplir 0 octet de m√©moire. <br><br>  <b>Avertissement 3</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V595</a> Le pointeur ¬´destinations¬ª a √©t√© utilis√© avant d'√™tre v√©rifi√© par rapport √† nullptr.  V√©rifier les lignes: 48, 50. wintourguide.cpp 48 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">BOOL APIENTRY </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TourGuideProc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DestinationList* destinations = guide-&gt;appCore-&gt;getDestinations(); Destination* dest = (*destinations)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; guide-&gt;selectedDest = dest; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hwnd != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> &amp;&amp; destinations != <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { .... } .... }</code> </pre> <br>  Le pointeur de <i>destinations</i> est d√©r√©f√©renc√© deux lignes plus haut que compar√© √† <i>NULL</i> .  Un tel code pourrait potentiellement conduire √† une erreur. <br><br>  <b>Avertissement 4</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les</a> classes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V702</a> doivent toujours √™tre d√©riv√©es de std :: exception (et similaires) en tant que ¬´public¬ª (aucun mot-cl√© n'a √©t√© sp√©cifi√©, donc le compilateur le d√©finit par d√©faut sur ¬´priv√©¬ª).  fs.h 21 <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filesystem_error</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::system_error { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: filesystem_error(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::error_code ec, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* msg) : <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::system_error(ec, msg) { } }; <span class="hljs-comment"><span class="hljs-comment">// filesystem_error</span></span></code> </pre> <br>  L'analyseur a d√©tect√© une classe h√©rit√©e de la classe <i>std :: exception</i> via le modificateur <i>priv√©</i> (sp√©cifi√© par d√©faut).  Cet h√©ritage est dangereux car en cas d'h√©ritage non public, lors de la tentative d'interception de l' <i>exception std :: exception</i> , il sera ignor√©.  Par cons√©quent, les gestionnaires d'exceptions ne se comportent pas comme pr√©vu. <br><br>  <b>Avertissement 5</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V713</a> Le pointeur a √©t√© utilis√© dans l'expression logique avant d'√™tre v√©rifi√© par rapport √† nullptr dans la m√™me expression logique.  winmain.cpp 3031 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">skipUntilQuote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* s)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (*s != <span class="hljs-string"><span class="hljs-string">'"'</span></span> &amp;&amp; s != <span class="hljs-string"><span class="hljs-string">'\0'</span></span>) s++; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }</code> </pre> <br>  √Ä un endroit de l'expression conditionnelle, ils ont oubli√© de d√©r√©f√©rencer le pointeur <i>s</i> .  Le r√©sultat a √©t√© une comparaison du pointeur, pas de sa valeur.  Et cela n'a pas de sens dans cette situation. <br><br>  <b>Avertissement 6</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V773</a> La fonction a √©t√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ferm√©e</a> sans rel√¢cher le pointeur 'vertexShader'.  Une fuite de m√©moire est possible.  modelviewwidget.cpp 1517 <br><br><pre> <code class="cpp hljs">GLShaderProgram* ModelViewWidget::createShader(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ShaderKey&amp; shaderKey) { .... <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>* glShader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLShaderProgram(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>* vertexShader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GLVertexShader(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!vertexShader-&gt;compile(vertexShaderSource.toStdString())) { qWarning(<span class="hljs-string"><span class="hljs-string">"Vertex shader error: %s"</span></span>, vertexShader-&gt;<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>().c_str()); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; vertexShaderSource.toStdString() &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> glShader; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>; } .... }</code> </pre> <br>  Lorsque vous quittez la fonction, la m√©moire est lib√©r√©e par le pointeur <i>glShader</i> , mais elle n'est pas effac√©e par le pointeur <i>vertexShader</i> . <br><br>  Le m√™me endroit est plus bas dans le code: <br><br><ul><li>  V773 La fonction a √©t√© quitt√©e sans lib√©rer le pointeur 'fragmentShader'.  Une fuite de m√©moire est possible.  modelviewwidget.cpp 1526 </li></ul><br>  <b>Avertissement 7</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V547 L'</a> expression '! InputFilename.empty ()' est toujours vraie.  makexindex.cpp 128 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* argv[])</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!parseCommandLine(argc, argv) || inputFilename.empty()) { Usage(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } istream* inputFile = &amp;<span class="hljs-built_in"><span class="hljs-built_in">cin</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!inputFilename.empty()) { inputFile = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ifstream(inputFilename, ios::in); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!inputFile-&gt;good()) { <span class="hljs-built_in"><span class="hljs-built_in">cerr</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"Error opening input file "</span></span> &lt;&lt; inputFilename &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } } .... }</code> </pre> <br>  V√©rifiez √† nouveau le nom du fichier.  Ce n'est pas une erreur, mais √©tant donn√© que la variable <i>inputFilename est</i> d√©j√† <i>v√©rifi√©e</i> au d√©but de la fonction, la v√©rification peut √™tre supprim√©e ci-dessous, ce qui rendra le code plus compact. <br><br>  <b>Avertissement 8</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V556</a> Les valeurs des diff√©rents types d'√©num√©ration sont compar√©es: switch (ENUM_TYPE_A) {case ENUM_TYPE_B: ...}.  render.cpp 7457 <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> LabelAlignment { AlignCenter, AlignLeft, AlignRight }; <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> LabelVerticalAlignment { VerticalAlignCenter, VerticalAlignBottom, VerticalAlignTop, }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Annotation</span></span></span><span class="hljs-class"> {</span></span> .... LabelVerticalAlignment valign : <span class="hljs-number"><span class="hljs-number">3</span></span>; .... }; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Renderer::renderAnnotations(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (annotations[i].valign) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> AlignCenter: vOffset = -font[fs]-&gt;getHeight() / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> VerticalAlignTop: vOffset = -font[fs]-&gt;getHeight(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> VerticalAlignBottom: vOffset = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } .... }</code> </pre> <br>  Dans l' <i>instruction switch</i> , les valeurs d'√©num√©ration sont confuses.  Pour cette raison, les √©num√©rations de diff√©rents types sont compar√©es en un seul endroit: <i>LabelVerticalAlignment</i> et <i>AlignCenter</i> . <br><br>  <b>Avertissement 9</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V581</a> Les expressions conditionnelles des instructions ¬´if¬ª situ√©es c√¥te √† c√¥te sont identiques.  V√©rifiez les lignes: 2844, 2850. shadermanager.cpp 2850 <br><br><pre> <code class="cpp hljs">GLVertexShader* ShaderManager::buildParticleVertexShader(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ShaderProperties&amp; props) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.texUsage &amp; ShaderProperties::PointSprite) { source &lt;&lt; <span class="hljs-string"><span class="hljs-string">"uniform float pointScale;\n"</span></span>; source &lt;&lt; <span class="hljs-string"><span class="hljs-string">"attribute float pointSize;\n"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (props.texUsage &amp; ShaderProperties::PointSprite) { source &lt;&lt; DeclareVarying(<span class="hljs-string"><span class="hljs-string">"pointFade"</span></span>, Shader_Float); } .... }</code> </pre> <br>  L'analyseur a d√©tect√© deux expressions conditionnelles identiques d'affil√©e.  Il y a soit une erreur, soit deux conditions peuvent √™tre combin√©es en une seule et simplifier ainsi le code. <br><br>  <b>Avertissement 10</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V668</a> Il est inutile de tester le pointeur 'dp' contre null, car la m√©moire a √©t√© allou√©e √† l'aide de l'op√©rateur 'new'.  L'exception sera g√©n√©r√©e en cas d'erreur d'allocation de m√©moire.  windatepicker.cpp 625 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> LRESULT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DatePickerCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HWND hwnd, CREATESTRUCT&amp; cs)</span></span></span><span class="hljs-function"> </span></span>{ DatePicker* dp = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DatePicker(hwnd, cs); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dp == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; .... }</code> </pre> <br>  La valeur du pointeur renvoy√© par le <i>nouvel</i> op√©rateur est compar√©e √† z√©ro.  Si l'op√©rateur n'a pas pu allouer de m√©moire, alors selon la norme du langage C ++, une exception <i>std :: bad_alloc () est lev√©e</i> .  Ainsi, v√©rifier le pointeur de l'√©galit√© √† z√©ro n'a pas de sens. <br><br>  Trois autres contr√¥les similaires: <br><br><ul><li>  V668 Il est inutile de tester le pointeur ¬´modes¬ª par rapport √† null, car la m√©moire a √©t√© allou√©e √† l'aide de l'op√©rateur ¬´nouveau¬ª.  L'exception sera g√©n√©r√©e en cas d'erreur d'allocation de m√©moire.  winmain.cpp 2967 </li><li>  V668 Il est inutile de tester le pointeur 'dropTarget' contre null, car la m√©moire a √©t√© allou√©e √† l'aide de l'op√©rateur 'new'.  L'exception sera g√©n√©r√©e en cas d'erreur d'allocation de m√©moire.  winmain.cpp 3272 </li><li>  V668 Il est inutile de tester le pointeur ¬´appCore¬ª par rapport √† null, car la m√©moire a √©t√© allou√©e √† l'aide de l'op√©rateur ¬´nouveau¬ª.  L'exception sera g√©n√©r√©e en cas d'erreur d'allocation de m√©moire.  winmain.cpp 3352 </li></ul><br>  <b>Avertissement 11</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">V624</a> La constante 3,14159265 est utilis√©e.  La valeur r√©sultante peut √™tre inexacte.  Pensez √† utiliser la constante M_PI de &lt;math.h&gt;.  3dstocmod.cpp 62 <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* argv[])</span></span></span><span class="hljs-function"> </span></span>{ .... Model* newModel = GenerateModelNormals(*model, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>(smoothAngle * <span class="hljs-number"><span class="hljs-number">3.14159265</span></span> / <span class="hljs-number"><span class="hljs-number">180.0</span></span>), weldVertices, weldTolerance); .... }</code> </pre> <br>  Les diagnostics sont recommand√©s, mais il est vraiment pr√©f√©rable d'utiliser une constante pr√™te √† l'emploi pour le nombre Pi de la biblioth√®que standard. <br><br><h2>  Conclusion </h2><br>  R√©cemment, le projet a √©t√© d√©velopp√© par des passionn√©s, mais il est toujours populaire et en demande dans les programmes de formation.  Sur Internet, il existe des milliers de modules compl√©mentaires avec diff√©rents objets spatiaux.  Celestia a √©t√© utilis√© dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">The Day After Tomorrow</a> et la s√©rie documentaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Through the Wormhole avec Morgan Freeman</a> . <br><br>  Nous sommes heureux qu'en v√©rifiant de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nombreux</a> projets open source, nous non seulement vulgarisons la m√©thodologie de l'analyse de code statique, mais contribuons √©galement au d√©veloppement du monde des projets open source.  Soit dit en passant, vous pouvez √©galement utiliser l'analyseur PVS-Studio non seulement pour tester le v√¥tre, mais √©galement des projets tiers en tant que passionn√©.  Pour ce faire, vous pouvez utiliser l'une des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">options de</a> licence gratuite. <br><br>  Utilisez des analyseurs de code statique, rendez vos projets plus fiables et meilleurs! <br><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/c78/30f/70c/c7830f70c5577c3d6704f254d7cad6a3.png" align="left"></a> </p><br><br>  Si vous souhaitez partager cet article avec un public anglophone, veuillez utiliser le lien vers la traduction: Svyatoslav Razmyslov.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Celestia: Bugs 'Adventures in Space</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr469743/">https://habr.com/ru/post/fr469743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr469731/index.html">Gestion des exceptions ASP.NET √† l'aide de IRO.Mvc.MvcExceptionHandler</a></li>
<li><a href="../fr469735/index.html">Algorithme de calcul de la racine du ni√®me degr√© √† partir d'un nombre positif arbitraire</a></li>
<li><a href="../fr469737/index.html">Jouets en bois, cinqui√®me partie - 1991</a></li>
<li><a href="../fr469739/index.html">Jouets en bois, sixi√®me partie - 1992</a></li>
<li><a href="../fr469741/index.html">Celestia: les aventures des insectes dans l'espace</a></li>
<li><a href="../fr469745/index.html">14-15 octobre: ‚Äã‚ÄãBootcamp du projet mondial de blockchain Hyperledger pour la premi√®re fois √† Moscou</a></li>
<li><a href="../fr469747/index.html">R√©sum√© des √©v√©nements informatiques d'octobre (premi√®re partie)</a></li>
<li><a href="../fr469749/index.html">Am√©lioration de l'UX avec la touche Tab</a></li>
<li><a href="../fr469753/index.html">Les 9 meilleures trouvailles open source pour septembre 2019</a></li>
<li><a href="../fr469755/index.html">Comment √™tre un bon programmeur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>