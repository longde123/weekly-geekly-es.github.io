<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äç‚öñÔ∏è üßëüèº üòë Penulisan HTTP / 1.1 & HTTP / 2 Client dan Server di Golang ‚ÜóÔ∏è üçä üñï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Golang adalah bahasa pemrograman yang luar biasa dengan beragam fitur. Artikel ini menunjukkan bagaimana Anda dapat menulis klien dan server on Go unt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Penulisan HTTP / 1.1 & HTTP / 2 Client dan Server di Golang</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/451032/"><img src="https://habrastorage.org/getpro/habr/post_images/d3a/039/afd/d3a039afd1ba2d00298f26b62c2a3624.png"><br><br>  Golang adalah bahasa pemrograman yang luar biasa dengan beragam fitur.  Artikel ini menunjukkan bagaimana Anda dapat menulis klien dan server on Go untuk protokol HTTP / 1.1 dan HTTP / 2. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox merekomendasikan:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengembang Python dari awal</a> tentu saja. <br><br>  <b>Kami mengingatkan Anda:</b> <i>untuk semua pembaca "Habr" - diskon 10.000 rubel saat mendaftar untuk kursus Skillbox menggunakan kode promo "Habr".</i> <br></blockquote><br>  HTTP / 2 adalah versi utama kedua dari protokol jaringan HTTP yang digunakan untuk mengakses World Wide Web.  Protokol didasarkan pada SPDY.  Pelajari lebih lanjut tentang versi ini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://">di GitHub</a> . <br><br><h3>  HTTP / 1.1 Server </h3><br>  Kode di bawah ini menunjukkan cara menulis server HTTP / 1.1 di mana pun.  Fungsi utama memulai layanan HTTP (S) dengan port 9191 dan path / hello / sayHello.  echoPayload bertanggung jawab atas logika gema, menganalisis lalu lintas masuk dan bereaksi sesuai itu.  Jika perlu, echoPayload dapat dimodifikasi. <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/hello/sayHello"</span></span>, echoPayload) log.Printf(<span class="hljs-string"><span class="hljs-string">"Go Backend: { HTTPVersion = 1 }; serving on https://localhost:9191/hello/sayHello"</span></span>) log.Fatal(http.ListenAndServeTLS(<span class="hljs-string"><span class="hljs-string">":9191"</span></span>, <span class="hljs-string"><span class="hljs-string">"./cert/server.crt"</span></span>, <span class="hljs-string"><span class="hljs-string">"./cert/server.key"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echoPayload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span></span></span> { log.Printf(<span class="hljs-string"><span class="hljs-string">"Request connection: %s, path: %s"</span></span>, req.Proto, req.URL.Path[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> req.Body.Close() contents, err := ioutil.ReadAll(req.Body) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatalf(<span class="hljs-string"><span class="hljs-string">"Oops! Failed reading body of the request.\n %s"</span></span>, err) http.Error(w, err.Error(), <span class="hljs-number"><span class="hljs-number">500</span></span>) } fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"%s\n"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(contents))</code> </pre> <br>  Karena layanan HTTP (S) sudah berjalan, Anda perlu memberikan sertifikat dan kunci server.  Kedua objek disimpan di direktori cert dengan nama server.crt dan server.key. <br><br>  Contoh sertifikat dan kunci di bawah ini. <br><br>  ./cert/server.crt <br><br>  ----- MEMULAI SERTIFIKAT ----- <br>  MIID + zCCAuOgAwIBAgIJAPsvGCCAC2i + MA0GCSqGSIb3DQEBCwUAMIGTMQswCQYD <br>  VQQGEwJMSzEQMA4GA1UECAwHV2VzdGVybjEQMA4GA1UEBwwHQ29sb21ibzESMBAG <br>  A1UECgwJTERDTEFLTUFMMRQwEgYDVQQLDAtFbmdpbmVlcmluZzESMBAGA1UEAwwJ <br>  bG9jYWxob3N0MSIwIAYJKoZIhvcNAQkBFhNsZGNsYWttYWxAZ21haWwuY29tMB4X <br>  DTE5MDQyMDA1MjczM1oXDTIwMDQxOTA1MjczM1owgZMxCzAJBgNVBAYTAkxLMRAw <br>  DgYDVQQIDAdXZXN0ZXJuMRAwDgYDVQQHDAdDb2xvbWJvMRIwEAYDVQQKDAlMRENM <br>  QUtNQUwxFDASBgNVBAsMC0VuZ2luZWVyaW5nMRIwEAYDVQQDDAlsb2NhbGhvc3Qx <br>  IjAgBgkqhkiG9w0BCQEWE2xkY2xha21hbEBnbWFpbC5jb20wggEiMA0GCSqGSIb3 <br>  DQEBAQUAA4IBDwAwggEKAoIBAQC9PKAOlJcOBUI9CGnVjMjQHNRqYv01CaUdC4 / e <br>  YFyegxLpoMpYvEC + nYlHT2j7BOhQBV + TkH1D4YOK2WP3V0FLv5hM7Nxsgf25WNHa <br>  zi2DTBvcBgB9sDJA / avIvF + 63 + Btnyggp3xq6MaHy5DNH0kPnSiPiy7PRKToEUn6 <br>  oqPnB10rRBFZqs3ePmEDxVL3T / TUZSXR3P95fV1vDCqrJbr3YwWOzFCq8kEJFslK <br>  B7GSEKpPgmK0g5krmAQqUOuCJ3 / xFlCP4trKg / lvSJZ5S / LZD5teDDg6Ax3Mvthj <br>  kMh9 / OM5GGTTjRwhct9dHjFI8POj + TMbLZvoPVXjsmATEgtLAgMBAAGjUDBOMB0G <br>  A1UdDgQWBBQ1CmWXmrHOv6b8f763 / bk80EpbajAfBgNVHSMEGDAWgBQ1CmWXmrHO <br>  v6b8f763 / bk80EpbajAMBgNVHRMEBTADAQH / MA0GCSqGSIb3DQEBCwUAA4IBAQAH <br>  D51Uoe2K4N9 / GxRgww5mMW2dUJ7Hc / tGsr / J1fNqHY8SXNAn5i + GwI + xBvwxFHL3 <br>  KZHbfq7eYDE5EItt3cZp5ySSscdTEay9ReH2 + 8k32gpH46CMwPV3XvtQuBVVAC4u <br>  szrq1eWKhYI2zf4iUVpwvq89OynVGIp0atng + q3A2cBhi3NGo6Ho1s2rywQyqiq8 <br>  up4PUSVQ6WBoJFx5PEEDxD84VMS7Pan6dT34b9n56tq5R06retZTUZ8jMM88CGX4 <br>  88pSPU + XImp6DdNVBmW6Lz76jiSNHLkZGm4jumjeyUGzBjBEBOgSegeWlinMtWE9 <br>  gaVxeUHrqHk8xzwJ4oIu <br>  ----- AKHIR SERTIFIKAT ----- <br><br>  ./cert/server.key <br><br>  ----- KUNCI PRIVATE AWAL ----- <br>  MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC9PKAOlJcOBUI9 <br>  CGnVjMjQHNRqYv01CaUdC4 / eYFyegxLpoMpYvEC + nYlHT2j7BOhQBV + TkH1D4YOK <br>  2WP3V0FLv5hM7Nxsgf25WNHazi2DTBvcBgB9sDJA / avIvF + 63 + Btnyggp3xq6MaH <br>  y5DNH0kPnSiPiy7PRKToEUn6oqPnB10rRBFZqs3ePmEDxVL3T / TUZSXR3P95fV1v <br>  DCqrJbr3YwWOzFCq8kEJFslKB7GSEKpPgmK0g5krmAQqUOuCJ3 / xFlCP4trKg / lv <br>  SJZ5S / LZD5teDDg6Ax3MvthjkMh9 / OM5GGTTjRwhct9dHjFI8POj + TMbLZvoPVXj <br>  smATEgtLAgMBAAECggEAbaS2yDvn2cPKQTqit4y + vXY2zP1V4GkaNd4BGcOTZnRj <br>  fOIg25EXoln8tEiadva888BpREKvkakUYlraxPDVcGIuiEOk42nd7Io97R0Q2cY7 <br>  ThxcJHb2ZxmTctdSUCBvFJTm1ySzve3pOb0ExRSfbGCOo7zs / kKzmZKK3qFlffGS <br>  Ga9O7hyLOuXPU22CM + 5Lq0JPTER73z0DpAweZc0L14j6dzhcG3qUwk0K6K47VZgE <br>  NhEORul7xDj91bh2iEoSbaQe8HxLaMQoMXOC / 9oey2UKKTe9WZE3 + XCvg + vkw / sS <br>  biQ + b4EZ9LuhAhCZ0UE6 + y7PZY + 8G / YsbGg0Zo8cAQKBgQDyTuG47rWBgbdHsEB / <br>  MSKGU6w + a1SdLk6jG + Enji5Q624 / h0xt5nF9ah2eRf3Rlhn9WEKM / uE9ouEODBKE <br>  8rnIDsjufEMI8moPEloRBSsxPNw + fNMSSCZjL + qPtTJUbRio7WA23sfdnE57ygBa <br>  wlPQ9UBBWSm2se4veEZtHjtngQKBgQDH7gnH5Att6ZYazRTgD72g0C5v1l4LYVEQ <br>  jxdBcs6TJA8wHfifZ45F67W95QunmM813UxfS + ybdjytlb8 / lmi2BnK6lDx5HWIL <br>  31jnbg2CxCrNv9oZLjKVDmkp4WUcEp5W33R1 / MGDTRfyARP + 6QYQO / ATMdqtm5Uu <br>  cD6clrL4ywKBgQCQ0niy0WmGaAMlQ8CoxLM / 2c6 + 1 + OQtlalwkoGHEKudqhELBeQ <br>  MAVw0fW13Vtg4vfRpejQ4J26 + xjMDocbEv / bBIsvjvF57XlaXLucJJy2Jwv0BSMa <br>  cCkRa1gkYEYek74DaSzyXqDSYVO / RPKFTFRQNeUbqbD20s3rbVWablFPAQKBgB5y <br>  zUCJJYh2w6qPQzegjhO4wOm9bxMyngL0l + ka0AUuv7VnSx8TyWIytLoX8P90UVJ1 <br>  wpTc3ksK5dDV9ot7n7ThJIXv34nehLkkKckNRLd + oro1FsUw + PkkebWsIxb0avL2 <br>  EymI9fvGOPhdW6s91 / OO / VAfDpvUDxNEevSkKtujAoGAcMOsXtn / UyT3Lssxgla3 <br>  K + DCaFhAQPSUXOmpZwEbQ0yQlksDe4flsam8bEDI5D5iHx1ziSfh583qJl3BEZ5u <br>  VZTEO2YLvT9QRz7pv2qspqj7nzSyBU2BFAajq43 / G1b8FHfVgN + YdVtzVrigfql5 <br>  2a + JxOxFfpjnGQ7RfSxSb + Q = <br>  ----- AKHIR KUNCI PRIVATE ----- <br><br>  Sudah waktunya untuk menguji menjalankan layanan menggunakan perintah berikut: <br><br><pre> <code class="plaintext hljs">$ go run http_server.go</code> </pre> <br>  Jawabannya harus seperti ini: <br><br><pre> <code class="plaintext hljs">Go Backend: { HTTPVersion = 1 }; serving on https://localhost:9191/hello/sayHello</code> </pre> <br>  Sekarang kami memulai layanan menggunakan permintaan HTTP / 1.1 POST (mode tidak aman dan aman): <br><br><pre> <code class="plaintext hljs">$ curl -k -v https://localhost:9191/hello/sayHello -d "Hello Go!" $ curl -v --cacert ./cert/server.crt https://localhost:9191/hello/sayHello -d "Hello Go!"</code> </pre> <br>  Di bawah ini adalah hasil dari program ini.  Bagian pertama adalah detail jabat tangan dari server dan klien TLS.  Yang kedua adalah perincian permintaan dan tanggapan HTTP / 1.1.  Pada akhirnya adalah pesan teks "Hello Go!". <br><br>  * Mencoba 127.0.0.1 ... <br>  * Terhubung ke localhost (127.0.0.1) port 9191 (# 0) <br>  * ALPN, menawarkan http / 1.1 <br>  * Pilihan sandi: SEMUA:! EKSPOR:! EKSPOR40:! EKSPOR56:! ANULL :! RENDAH:! RC4: @STRENGTH <br>  * Berhasil menetapkan lokasi verifikasi sertifikat: <br>  * CAfile: /etc/ssl/certs/ca-certificates.crt <br>  CApath: tidak ada <br>  * TLSv1.2 (OUT), header TLS, Status Sertifikat (22): <br>  * TLSv1.2 (OUT), jabat tangan TLS, Klien halo (1): <br>  * TLSv1.2 (IN), jabat tangan TLS, Server halo (2): <br>  * TLSv1.2 (IN), jabat tangan TLS, Sertifikat (11): <br>  * TLSv1.2 (IN), jabat tangan TLS, pertukaran kunci Server (12): <br>  * TLSv1.2 (IN), jabat tangan TLS, Server selesai (14): <br>  * TLSv1.2 (OUT), jabat tangan TLS, pertukaran kunci Klien (16): <br>  * TLSv1.2 (OUT), TLS ubah sandi, Klien halo (1): <br>  * TLSv1.2 (OUT), jabat tangan TLS, Selesai (20): <br>  * TLSv1.2 (IN), TLS ubah sandi, Klien halo (1): <br>  * TLSv1.2 (IN), jabat tangan TLS, Selesai (20): <br>  * Koneksi SSL menggunakan TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 <br>  * ALPN, server diterima untuk menggunakan http / 1.1 <br>  * Sertifikat server: <br>  * subjek: C = LK;  ST = Barat;  L = Colombo;  O = LDCLAKMAL;  OU = Teknik;  CN = Chanaka Lakmal;  emailAddress=ldclakmal@gmail.com <br>  * tanggal mulai: 20 April 03:03:58 2019 GMT <br>  * tanggal kedaluwarsa: 19 April 03:03:58 2020 GMT <br>  * penerbit: C = LK;  ST = Barat;  L = Colombo;  O = LDCLAKMAL;  OU = Teknik;  CN = Chanaka Lakmal;  emailAddress=ldclakmal@gmail.com <br>  * Hasil verifikasi sertifikat SSL: sertifikat yang ditandatangani sendiri (18), tetap berlanjut. <br>  &gt; POST / halo / sayaikan Halo HTTP / 1.1 <br>  &gt; Host: localhost: 9191 <br>  &gt; User-Agent: curl / 7.46.0 <br>  &gt; Terima: * / * <br>  &gt; Panjang Konten: 9 <br>  &gt; Tipe-Konten: application / x-www-form-urlencoded <br>  &gt; <br>  * unggahan sepenuhnya dikirim: 9 dari 9 byte <br>  &lt;HTTP / 1.1 200 OK <br>  &lt;Tanggal: Sab, 20 April 2019 06:56:19 GMT <br>  &lt;Panjang Konten: 10 <br>  &lt;Tipe-Konten: teks / polos;  charset = utf-8 <br>  &lt; <br>  Halo pergi! <br>  * Koneksi # 0 untuk meng-host localhost dibiarkan utuh <br><br><h3>  Klien HTTP / 1.1 </h3><br>  Kode baru adalah contoh penulisan klien HTTP / 1.1 sederhana di Go.  Klien ini mengirimkan permintaan POST HTTP (S) ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">localhost</a> : 9191 / hello / sayHello dengan pesan "Hello Go!". <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"bytes"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/tls"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/x509"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { client := &amp;http.Client{} <span class="hljs-comment"><span class="hljs-comment">// Create a pool with the server certificate since it is not signed // by a known CA caCert, err := ioutil.ReadFile("./cert/server.crt") if err != nil { log.Fatalf("Reading server certificate: %s", err) } caCertPool := x509.NewCertPool() caCertPool.AppendCertsFromPEM(caCert) // Create TLS configuration with the certificate of the server tlsConfig := &amp;tls.Config{ RootCAs: caCertPool, } // Use the proper transport in the client client.Transport = &amp;http.Transport{ TLSClientConfig: tlsConfig, } // Perform the request resp, err := client.Post("https://localhost:9191/hello/sayHello", "text/plain", bytes.NewBufferString("Hello Go!")) if err != nil { log.Fatalf("Failed get: %s", err) } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) if err != nil { log.Fatalf("Failed reading response body: %s", err) } fmt.Printf("Got response %d: %s %s", resp.StatusCode, resp.Proto, string(body))</span></span></code> </pre> <br>  Karena layanan HTTP (S) juga dimulai di sini, Anda perlu memberikan sertifikat dan kunci.  Data yang diperlukan ditempatkan di direktori cert dengan nama server.crt dan server.key. <br><br>  Untuk memulai klien, Anda perlu menginisialisasi server.  Untuk melakukan ini, kami melakukan tindakan yang dijelaskan di bagian pertama, atau kami memulai layanan HTTP (S) apa pun dengan port 9191 dan path / hello / sayHello. <br><br><pre> <code class="plaintext hljs">$ go run http_client.go</code> </pre> <br>  Outputnya harus seperti ini: <br><br><pre> <code class="plaintext hljs">Got response 200: HTTP/1.1 Hello Go!</code> </pre> <br>  Klien menunjukkan operasi perintah curl: <br><br><pre> <code class="plaintext hljs">$ curl -v --cacert ./cert/server.crt https://localhost:9191/hello/sayHello -d "Hello Go!"</code> </pre> <br>  Setelah Anda selesai bekerja dengan HTTP / 1.1, Anda harus mencoba mengulangi hal yang sama untuk HTTP / 2. <br><br><h3>  HTTP / 2 Server </h3><br>  Seperti pada bagian sebelumnya, Anda harus terlebih dahulu membuat server gema. <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"golang.org/x/net/http2"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> httpServer = http.Server{ Addr: <span class="hljs-string"><span class="hljs-string">":9191"</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> http2Server = http2.Server{} _ = http2.ConfigureServer(&amp;httpServer, &amp;http2Server) http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/hello/sayHello"</span></span>, echoPayload) log.Printf(<span class="hljs-string"><span class="hljs-string">"Go Backend: { HTTPVersion = 2 }; serving on https://localhost:9191/hello/sayHello"</span></span>) log.Fatal(httpServer.ListenAndServeTLS(<span class="hljs-string"><span class="hljs-string">"./cert/server.crt"</span></span>, <span class="hljs-string"><span class="hljs-string">"./cert/server.key"</span></span>)) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">echoPayload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, req *http.Request)</span></span></span></span> { log.Printf(<span class="hljs-string"><span class="hljs-string">"Request connection: %s, path: %s"</span></span>, req.Proto, req.URL.Path[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> req.Body.Close() contents, err := ioutil.ReadAll(req.Body) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { log.Fatalf(<span class="hljs-string"><span class="hljs-string">"Oops! Failed reading body of the request.\n %s"</span></span>, err) http.Error(w, err.Error(), <span class="hljs-number"><span class="hljs-number">500</span></span>) } fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"%s\n"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>(contents))</code> </pre> <br>  Untuk memeriksa server, Anda perlu mengirim perintah: <br><br><pre> <code class="plaintext hljs">$ go run http2_server.go</code> </pre> <br>  Jawabannya harus seperti ini: <br><br><pre> <code class="plaintext hljs">Go Backend: { HTTPVersion = 2 }; serving on https://localhost:9191/hello/sayHello</code> </pre> <br>  Sekarang server sedang berjalan, Anda dapat menginisialisasi dengan menggunakan permintaan HTTP / 1.1 atau HTTP / 2.  Perintah HTTP / 1.1 POST untuk menguji operasi server diberikan di bawah ini: <br><br><pre> <code class="plaintext hljs">$ curl -k -v https://localhost:9191/hello/sayHello -d "Hello Go!" $ curl -v --cacert ./cert/server.crt https://localhost:9191/hello/sayHello -d "Hello Go!"</code> </pre> <br>  Dan hal yang sama, tetapi dengan HTTP / 2 POST: <br><br><pre> <code class="plaintext hljs">$ curl -k -v --http2 https://localhost:9191/hello/sayHello -d "Hello Go!" $ curl -v --http2 --cacert ./cert/server.crt https://localhost:9191/hello/sayHello -d "Hello Go!"</code> </pre> <br>  Di bawah ini adalah contoh dari output operasi server.  Bagian pertama adalah jabat tangan TLS antara server dan klien, yang kedua adalah rincian permintaan dan tanggapan HTTP / 2. <br><br>  * Mencoba 127.0.0.1 ... <br>  * Terhubung ke localhost (127.0.0.1) port 9191 (# 0) <br>  * ALPN, menawarkan h2 <br>  * ALPN, menawarkan http / 1.1 <br>  * Pilihan sandi: SEMUA:! EKSPOR:! EKSPOR40:! EKSPOR56:! ANULL :! RENDAH:! RC4: @STRENGTH <br>  * Berhasil menetapkan lokasi verifikasi sertifikat: <br>  * CAfile: src / hello / cert / server.crt <br>  CApath: tidak ada <br>  * TLSv1.2 (OUT), header TLS, Status Sertifikat (22): <br>  * TLSv1.2 (OUT), jabat tangan TLS, Klien halo (1): <br>  * TLSv1.2 (IN), jabat tangan TLS, Server halo (2): <br>  * TLSv1.2 (IN), jabat tangan TLS, Sertifikat (11): <br>  * TLSv1.2 (IN), jabat tangan TLS, pertukaran kunci Server (12): <br>  * TLSv1.2 (IN), jabat tangan TLS, Server selesai (14): <br>  * TLSv1.2 (OUT), jabat tangan TLS, pertukaran kunci Klien (16): <br>  * TLSv1.2 (OUT), TLS ubah sandi, Klien halo (1): <br>  * TLSv1.2 (OUT), jabat tangan TLS, Selesai (20): <br>  * TLSv1.2 (IN), TLS ubah sandi, Klien halo (1): <br>  * TLSv1.2 (IN), jabat tangan TLS, Selesai (20): <br>  * Koneksi SSL menggunakan TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 <br>  * ALPN, server diterima untuk menggunakan h2 <br>  * Sertifikat server: <br>  * subjek: C = LK;  ST = Barat;  L = Colombo;  O = LDCLAKMAL;  OU = Teknik;  CN = localhost;  emailAddress=ldclakmal@gmail.com <br>  * tanggal mulai: 20 April 05:27:33 2019 GMT <br>  * tanggal kedaluwarsa: 19 April 05:27:33 2020 GMT <br>  * nama umum: localhost (cocok) <br>  * penerbit: C = LK;  ST = Barat;  L = Colombo;  O = LDCLAKMAL;  OU = Teknik;  CN = localhost;  emailAddress=ldclakmal@gmail.com <br>  * Sertifikat SSL memverifikasi ok. <br>  * Menggunakan HTTP2, server mendukung multi guna <br>  * Status koneksi berubah (HTTP / 2 dikonfirmasi) <br>  * Set TCP_NODELAY <br>  * Menyalin data HTTP / 2 dalam buffer aliran ke buffer koneksi setelah peningkatan: len = 0 <br>  * Menggunakan Stream ID: 1 (pegangan mudah 0x10ddf20) <br>  &gt; POST / halo / sayaikan Halo HTTP / 1.1 <br>  &gt; Host: localhost: 9191 <br>  &gt; User-Agent: curl / 7.46.0 <br>  &gt; Terima: * / * <br>  &gt; Panjang Konten: 9 <br>  &gt; Tipe-Konten: application / x-www-form-urlencoded <br>  &gt; <br>  * Kami sepenuhnya diunggah dan baik-baik saja <br>  &lt;HTTP / 2.0 200 <br>  &lt;tipe konten: teks / polos;  charset = utf-8 <br>  &lt;panjang konten: 10 <br>  &lt;tanggal: Sab, 20 April 2019 06:54:50 GMT <br>  &lt; <br>  Halo pergi! <br>  * Koneksi # 0 untuk meng-host localhost kiri utuh <br><br><h3>  HTTP / 2 Klien </h3><br>  Bagian terakhir adalah membuat klien HTTP / 2.  Berikut adalah implementasi pengiriman permintaan POST HTTP (S) untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">localhost</a> : 9191 / hello / sayHello: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"bytes"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/tls"</span></span> <span class="hljs-string"><span class="hljs-string">"crypto/x509"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"golang.org/x/net/http2"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { client := &amp;http.Client{} <span class="hljs-comment"><span class="hljs-comment">// Create a pool with the server certificate since it is not signed // by a known CA caCert, err := ioutil.ReadFile("./cert/server.crt") if err != nil { log.Fatalf("Reading server certificate: %s", err) } caCertPool := x509.NewCertPool() caCertPool.AppendCertsFromPEM(caCert) // Create TLS configuration with the certificate of the server tlsConfig := &amp;tls.Config{ RootCAs: caCertPool, } // Use the proper transport in the client client.Transport = &amp;http2.Transport{ TLSClientConfig: tlsConfig, } // Perform the request resp, err := client.Post("https://localhost:9191/hello/sayHello", "text/plain", bytes.NewBufferString("Hello Go!")) if err != nil { log.Fatalf("Failed get: %s", err) } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) if err != nil { log.Fatalf("Failed reading response body: %s", err) } fmt.Printf("Got response %d: %s %s", resp.StatusCode, resp.Proto, string(body))</span></span></code> </pre> <br>  Seperti sebelumnya, Anda memerlukan kunci dan sertifikat untuk berfungsi.  Mereka disimpan dalam sertifikat dengan nama server.crt dan server.key. <br><br>  Peluncuran klien: <br><br><pre> <code class="plaintext hljs">$ go run http2_client.go</code> </pre> <br>  Dan jawaban yang diharapkan: <br><br><pre> <code class="plaintext hljs">Got response 200: HTTP/2 Hello Go!</code> </pre> <br>  Merinci pekerjaan klien: <br><br><pre> <code class="plaintext hljs">$ curl -v --http2 --cacert ./cert/server.crt https://localhost:9191/hello/sayHello -d "Hello Go!"</code> </pre> <br>  Itu saja.  Pekerjaan ini relatif sederhana, tetapi memberikan pemahaman tentang bagaimana menerapkan layanan jaringan dasar di Go. <br><br><blockquote>  <b>Skillbox merekomendasikan:</b> <br><br><ul><li>  Kursus praktis dua tahun <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Saya adalah pengembang web PRO</a> . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"</a> </li><li>  Kursus online pendidikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Profesi Java-developer"</a> . </li><li>  Kursus tahunan praktis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Pengembang PHP dari 0 hingga PRO"</a> . <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id451032/">https://habr.com/ru/post/id451032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id451014/index.html">Terburu-buru, mendesak atau terobosan? Kami mengatakan seluruh kebenaran tentang hackathon terbesar di negara itu</a></li>
<li><a href="../id451018/index.html">Pergi ke sana - saya tidak tahu di mana</a></li>
<li><a href="../id451020/index.html">Sejarah satu optimasi MySQL</a></li>
<li><a href="../id451026/index.html">Mengapa kita hanya memiliki sedikit sisa dari internet awal?</a></li>
<li><a href="../id451028/index.html">Panduan: jenis esai dalam bahasa Inggris dan tips untuk menulisnya</a></li>
<li><a href="../id451034/index.html">Permintaan SQL Phantom</a></li>
<li><a href="../id451040/index.html">Runaway Fun in May, atau Standoff Approaching</a></li>
<li><a href="../id451042/index.html">Dasar-Dasar Desain Basis Data - Perbandingan PostgreSQL, Cassandra, dan MongoDB</a></li>
<li><a href="../id451044/index.html">IMaskjs - 3 tahun di Open Source</a></li>
<li><a href="../id451050/index.html">Ember.js: (lagi) saatnya mencoba</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>