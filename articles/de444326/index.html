<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüé§ ‚ûñ üòé SMS-√úberwachung des Gewichts von drei Bienenst√∂cken f√ºr 30 US-Dollar üçê üé≠ ‚õ∫Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nein, dies ist kein kommerzielles Angebot. Dies sind die Kosten f√ºr Systemkomponenten, die Sie nach dem Lesen des Artikels sammeln k√∂nnen. 


 Ein kle...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SMS-√úberwachung des Gewichts von drei Bienenst√∂cken f√ºr 30 US-Dollar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444326/"><p><img src="https://habrastorage.org/getpro/habr/post_images/f9b/e29/cd3/f9be29cd3be301fe1554f261ae6d0dcb.jpg" alt="Mein Logo"></p><br><p>  Nein, dies ist kein kommerzielles Angebot. Dies sind die Kosten f√ºr Systemkomponenten, die Sie nach dem Lesen des Artikels sammeln k√∂nnen. </p><br><p>  Ein kleiner Hintergrund: </p><br><p>  Vor einiger Zeit habe ich beschlossen, Bienen zu holen, und sie erschienen ... f√ºr die ganze Saison, kamen aber nicht aus dem Winter. <br>  Und das trotz der Tatsache, dass alles richtig zu laufen schien - Herbstk√∂der, der sich vor der K√§lte erw√§rmt. <br>  Der Bienenstock war ein klassisches Dadan-Holzsystem mit 10 Rahmen von einem 40-mm-Brett. <br>  Aber in diesem Winter verloren selbst erfahrene Imker aufgrund der Temperaturschwankungen viel mehr als sonst. </p><br><p>  So entstand die Idee eines Systems zur √úberwachung des Bienenstockzustands. <br>  Nach der Ver√∂ffentlichung mehrerer Artikel √ºber Habr-e und der Kommunikation im Imkerforum entschied ich mich, von einfach zu komplex zu wechseln. <br>  Das Gewicht ist der einzige unbestreitbare Parameter, aber in der Regel √ºberwachen vorhandene Systeme nur einen "Referenz" -Stamm. <br>  Wenn bei ihm etwas schief geht (z. B. ein Schwarmflug, eine Bienenkrankheit), sind die Indikatoren irrelevant. </p><br><p>  Daher wurde beschlossen, die Gewichts√§nderung von drei Bienenst√∂cken gleichzeitig mit einem Mikrocontroller zu √ºberwachen und die anderen "Br√∂tchen" danach hinzuzuf√ºgen. <br>  Das Ergebnis ist ein autonomes System mit einer Laufzeit von etwa einem Monat bei einmaliger Aufladung des 18650-Akkus und einmal t√§glichem Senden von Statistiken. <br>  Ich habe versucht, das Design so weit wie m√∂glich zu vereinfachen, damit es laut einem Foto auch ohne Schema wiederholt werden kann. </p><br><p>  Die Arbeitslogik lautet wie folgt: Beim ersten Start / Zur√ºcksetzen werden die Messwerte der unter den Bienenst√∂cken installierten Sensoren im EEPROM gespeichert. <br>  Au√üerdem "wacht" das System jeden Tag nach Sonnenuntergang auf, liest das Zeugnis und sendet SMS mit einer Gewichts√§nderung pro Tag und ab dem Moment des Einschaltens. <br>  Zus√§tzlich wird der Spannungswert der Batterie √ºbertragen, und wenn er auf 3,5 V abf√§llt, wird eine Warnung √ºber die Notwendigkeit des Ladens ausgegeben, da sich das Kommunikationsmodul unter 3,4 V nicht einschaltet und die Gewichtswerte bereits "wegschweben". </p><a name="habracut"></a><br><p>  "Erinnerst du dich, wie alles begann? Alles war das erste Mal und wieder." <br><img src="https://habrastorage.org/getpro/habr/post_images/2f2/432/274/2f24322742ff9b620f05bb2804a5bb03.jpg" alt="Wie es anf√§ngt"><br>  Ja, es war urspr√ºnglich so ein Satz ‚ÄûEisen‚Äú, obwohl nur W√§gezellen und Dr√§hte bis zur endg√ºltigen Version √ºberlebten, aber das Wichtigste zuerst. <br>  Tats√§chlich wird der Kabelschacht nicht ben√∂tigt, er hat sich zum gleichen Preis wie 30 m flach herausgestellt. </p><br><p>  Wenn Sie keine Angst haben, 3 smd-LEDs und ein halbes Hundert Punkte normales (Ausgangs-) L√∂ten zu zerlegen, dann gehen Sie! </p><br><p>  Wir ben√∂tigen also die folgenden Ger√§te / Materialien: </p><br><ol><li>  Arduino Pro Mini 3V <br>  Sie sollten auf den Mikrochip des Linearwandlers achten - er sollte genau 3,3 V betragen - auf dem Markierungs-Chip KB 33 / LB 33 / DE A10 - die Chinesen haben etwas mit mir und der ganzen Charge verwechselt <br>  Es stellte sich heraus, dass die Leiterplatten im Laden mit 5-Volt-Reglern und 16-MHz-Quarz ausgestattet waren. </li><li>  USB-Ttl auf einem CH340-Chip - Sie k√∂nnen sogar 5 Volt erzeugen, aber w√§hrend der Firmware des Mikrocontrollers muss Arduino vom GSM-Modul getrennt werden, um letzteres nicht zu verbrennen. <br>  Karten auf dem PL2303-Chip funktionieren unter Windows 10 nicht. </li><li>  GSM-Kommunikationsmodul Goouu Tech IOT GA-6-B oder AI-THINKER A-6 Mini. <br>  Warum hast du damit aufgeh√∂rt?  Neoway M590 - ein Designer, der separate T√§nze mit Tamburinen ben√∂tigt, GSM SIM800L - mochte die nicht standardm√§√üige 2,8-V-Logik nicht und erforderte sogar eine Koordination mit einem Drei-Volt-Arduino. <br>  Dar√ºber hinaus hat die L√∂sung von AiThinker einen minimalen Energieverbrauch (beim Senden von SMS habe ich keinen Strom √ºber 100 mA gesehen). </li><li>  GSM GPRS 3DBI-Antenne (auf dem Foto oben - ein rechteckiger Schal mit einem ‚ÄûSchwanz‚Äú f√ºr 9 Stunden) </li><li>  Starterpaket f√ºr einen Bediener mit guter Abdeckung am Standort Ihres Bienenhauses. <br>  Ja, das Paket muss zuerst in einem normalen Telefon aktiviert werden. Deaktivieren Sie die PIN-Anfrage am Eingang und f√ºllen Sie das Konto auf. <br>  Jetzt gibt es viele Optionen mit Namen im Stil von "Sensor", "IoT" - sie haben etwas niedrigere monatliche Geb√ºhren. </li><li>  Dupont Draht 20cm Mutter Mutter - 3 Stk.  (zum Anschlie√üen von Arduino an USB-TTL) </li><li>  3St  HX711 - ADC f√ºr Waagen </li><li>  6 W√§gezellen mit einem Gewicht von bis zu 50 kg </li><li>  15 Meter 4-adriges Telefonkabel - zum Anschluss von Gewichtsmodulen mit ARDUINO. </li><li>  GL5528 Fotowiderstand (dies ist wichtig, mit einem Dunkelwiderstand von 1 MOhm und einem Lichtwiderstand von 10-20 kOhm) und zwei herk√∂mmlichen 20k-Widerst√§nden </li><li>  Ein St√ºck doppelseitiges 18x18mm dickes Klebeband - zum Anbringen des Arduino am Kommunikationsmodul. </li><li>  Der 18650 Batteriehalter und in der Tat die Batterie selbst ~ 2600mAh. </li><li>  Ein wenig Wachs oder Paraffin (Aromalampentablettenkerze) - zum Feuchtigkeitsschutz HX711 </li><li>  Ein St√ºck Holzbalken 25x50x300mm f√ºr die Basis von W√§gezellen. </li><li>  Ein Dutzend selbstschneidende Schrauben mit einer 4,2 x 19 mm Pressscheibe zur Montage von Sensoren an der Basis. </li></ol><br><p>  Der Akku kann aus zerlegbaren Laptops entnommen werden - vielfach billiger als ein neuer, und die Kapazit√§t wird viel h√∂her sein als die des chinesischen UltraFire - ich habe 1.500 gegen√ºber 450 (dies ist von der Firewall 6800 ;-) </p><br><p>  Dar√ºber hinaus sind krumme H√§nde, ein EPSN-25-L√∂tkolben, Kolophonium und POS-60-Lot erforderlich. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/0a9/222/e6a/0a9222e6acd4d43631f777dfa995dcab.jpg" alt="L√∂tkolben"></p><br><p>  Vor 5 Jahren habe ich einen sowjetischen L√∂tkolben mit Kupferstich verwendet (ich habe keine L√∂tstationen bekommen - ich habe ihn f√ºr eine Probefahrt genommen und die EPSN-Schaltung beendet). <br>  Aber nach seinem Scheitern und mehreren chinesischen Monstern unter (d) Weihnachtsb√§umen wurde letzterer Sparta genannt - eine Sache, die so streng war, wie der Name aufh√∂rte <br>  auf einem Produkt mit einem Temperaturregler. </p><br><p>  Also lass uns gehen! </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/eba/218/027/eba21802786557630e811458e9a07eaa.jpg" alt="GSM A6"></p><br><p>  Zu Beginn werden zwei LEDs vom GSM-Modul gel√∂tet (die Stelle, an der sie in einem orangefarbenen Oval eingekreist waren). <br>  Wir legen die SIM-Karte mit den Pads in die Leiterplatte ein, die abgeschr√§gte Ecke auf dem Foto ist durch den Pfeil gekennzeichnet. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/463/027/4e6/4630274e63f3710ea1b69f94a3d2dd8b.jpg" alt="Arduino Pro Mini 3v"></p><br><p>  Dann f√ºhren wir einen √§hnlichen Vorgang mit der LED auf der Arduino-Platine durch (das Oval links vom quadratischen Chip). <br>  L√∂ten Sie den Kamm in vier Kontakte (1), <br>  Wir nehmen zwei 20k-Widerst√§nde, verdrehen die Leitungen auf einer Seite, l√∂ten die Verdrehung in das Kontaktloch A5, die verbleibenden Leitungen im RAW- und GND-Arduinki (2). <br>  Wir k√ºrzen den Fotowiderstand auf 10 mm und l√∂ten ihn gem√§√ü den Schlussfolgerungen der GND- und D2-Platinen (3). </p><br><p>  Jetzt ist es Zeit <del>  blaues Klebeband </del>  doppelseitiges Klebeband - kleben Sie es auf den SIM-Kartenhalter des Kommunikationsmoduls, und oben - Arduino - zeigt der rote (silberne) Knopf zu uns und befindet sich √ºber der SIM-Karte. </p><br><p>  L√∂ten Sie die Leistung: plus vom Kondensator des Kommunikationsmoduls (4) zum RAW-Arduino-Pin. <br>  Tatsache ist, dass das Kommunikationsmodul selbst 3,4-4,2 V f√ºr seine Stromversorgung ben√∂tigt und sein PWR-Kontakt mit einem Abw√§rts-Abw√§rtswandler verbunden ist, so dass f√ºr den Betrieb mit Li-Ionen-Spannung unter Umgehung dieses Teils der Schaltung angelegt werden muss. </p><br><p>  Im Arduino hingegen starten wir die Stromversorgung √ºber einen Linearwandler - bei niedrigen Str√∂men betr√§gt der Spannungsabfall 0,1 V. <br>  Durch Anlegen einer stabilisierten Spannung an die HX711-Module entf√§llt jedoch die Notwendigkeit, sie unter einer niedrigeren Spannung zu verfeinern (und gleichzeitig das Rauschen infolge dieses Vorgangs zu erh√∂hen). </p><br><p>  Dann l√∂ten wir die Jumper (5) zwischen die Kontakte PWR-A1, URX-D4 und UTX-D5, die GND-G-Masse (6) und schlie√ülich die Stromversorgung aus dem 18650-Batteriehalter (7), um die Antenne (8) anzuschlie√üen. <br>  Jetzt nehmen wir den USB-TTL-Konverter und verbinden die Kontakte RXD-TXD und TXD-RXD, GND-GND mit den Dupont-Dr√§hten mit ARDUINO (Kamm 1): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/651/7dc/8ff/6517dc8ffbb81e4be9f1793db3eb66aa.jpg" alt="Erste Version"></p><br><p>  Auf dem Foto oben - die erste Version (von drei) des Systems, die zum Debuggen verwendet wurde. </p><br><p>  Und jetzt schweifen wir f√ºr einige Zeit vom L√∂tkolben ab und gehen zum Software-Teil √ºber. <br>  Ich werde die Reihenfolge der Aktionen f√ºr Windows beschreiben: <br>  Zun√§chst m√ºssen Sie das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Arduino IDE-</a> Programm herunterladen und installieren / entpacken - die aktuelle Version ist 1.8.9, aber ich verwende 1.6.4 </p><br><p>  Der Einfachheit halber entpacken wir das Archiv in den Ordner C: \ arduino- "your_version_number". Darin befinden sich / dist, Treiber, Beispiele, Hardware, Java, lib, Bibliotheken, Referenz, Tools-Ordner sowie die ausf√ºhrbare Datei von arduino (unter anderem). </p><br><p>  Jetzt brauchen wir eine Bibliothek f√ºr die Arbeit mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">HX711</a> ADC - die gr√ºne Schaltfl√§che "Klonen oder Herunterladen" - ZIP herunterladen. <br>  Der Inhalt (Ordner HX711-master) befindet sich im Verzeichnis C: \ arduino- "Ihre_Versionsnummer" \ Bibliotheken </p><br><p>  Und nat√ºrlich stammt der Treiber f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">USB-TTL</a> vom selben Github - aus dem entpackten Archiv wird die SETUP-Datei des Installationsprogramms einfach gestartet. </p><br><p>  Ok, f√ºhren Sie das Programm C: \ arduino- "your_version_number" \ arduino aus und konfigurieren Sie es </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2fd/429/2d5/2fd4292d54f67c31052b54ca853be5b3.jpg" alt="Programmschnittstelle"></p><br><p>  Wir gehen zum Punkt "Extras" - w√§hlen Sie die Karte "Arduino Pro oder Pro Mini", den Atmega 328 3,3 V 8 MHz Prozessor, der Port ist die andere Nummer als das System COM1 (erscheint nach der Installation des CH340-Treibers mit angeschlossenem USB-TTL-Adapter). </p><br><p>  Ok, kopieren Sie die folgende Skizze (Programm) und f√ºgen Sie sie in das Arduino IDE-Fenster ein </p><br><pre><code class="plaintext hljs">char phone_no[]="+123456789012"; // Your phone number that receive SMS with counry code #include &lt;avr/sleep.h&gt; // ARDUINO sleep mode library #include &lt;SoftwareSerial.h&gt; // Sofrware serial library #include "HX711.h" // HX711 lib. https://github.com/bogde/HX711 #include &lt;EEPROM.h&gt; // EEPROM lib. HX711 scale0(10, 14); HX711 scale1(11, 14); HX711 scale2(12, 14); #define SENSORCNT 3 HX711 *scale[SENSORCNT]; SoftwareSerial mySerial(5, 4); // Set I/O-port TXD, RXD of GSM-shield byte pin2sleep=15; // Set powerON/OFF pin float delta00; // delta weight from start float delta10; float delta20; float delta01; // delta weight from yesterday float delta11; float delta21; float raw00; //raw data from sensors on first start float raw10; float raw20; float raw01; //raw data from sensors on yesterday float raw11; float raw21; float raw02; //actual raw data from sensors float raw12; float raw22; word calibrate0=20880; //calibration factor for each sensor word calibrate1=20880; word calibrate2=20880; word daynum=0; //numbers of day after start int notsunset=0; boolean setZero=false; float readVcc() { // Read battery voltage function long result1000; float rvcc; result1000 = analogRead(A5); rvcc=result1000; rvcc=6.6*rvcc/1023; return rvcc; } void setup() { // Setup part run once, at start pinMode(13, OUTPUT); // Led pin init pinMode(2, INPUT_PULLUP); // Set pullup voltage Serial.begin(9600); mySerial.begin(115200); // Open Software Serial port to work with GSM-shield pinMode(pin2sleep, OUTPUT);// Itit ON/OFF pin for GSM digitalWrite(pin2sleep, LOW); // Turn ON modem delay(16000); // Wait for its boot scale[0] = &amp;scale0; //init scale scale[1] = &amp;scale1; scale[2] = &amp;scale2; scale0.set_scale(); scale1.set_scale(); scale2.set_scale(); delay(200); setZero=digitalRead(2); if (EEPROM.read(500)==EEPROM.read(501) || setZero) // first boot/reset with hiding photoresistor //if (setZero) { raw00=scale0.get_units(16); //read data from scales raw10=scale1.get_units(16); raw20=scale2.get_units(16); EEPROM.put(500, raw00); //write data to eeprom EEPROM.put(504, raw10); EEPROM.put(508, raw20); for (int i = 0; i &lt;= 24; i++) { //blinking LED13 on reset/first boot digitalWrite(13, HIGH); delay(500); digitalWrite(13, LOW); delay(500); } } else { EEPROM.get(500, raw00); // read data from eeprom after battery change EEPROM.get(504, raw10); EEPROM.get(508, raw20); digitalWrite(13, HIGH); // turn on LED 13 on 12sec. delay(12000); digitalWrite(13, LOW); } delay(200); // Test SMS at initial boot // mySerial.println("AT+CMGF=1"); // Send SMS part delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.println("INITIAL BOOT OK"); mySerial.print("V Bat= "); mySerial.println(readVcc()); if (readVcc()&lt;3.5) {mySerial.print("!!! CHARGE BATTERY !!!");} delay(500); mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); // raw02=raw00; raw12=raw10; raw22=raw20; //scale0.power_down(); //power down all scales //scale1.power_down(); //scale2.power_down(); } void loop() { attachInterrupt(0, NULL , RISING); // Interrupt on high lewel set_sleep_mode(SLEEP_MODE_PWR_DOWN); //Set ARDUINO sleep mode digitalWrite(pin2sleep, HIGH); // Turn OFF GSM-shield delay(2200); digitalWrite(pin2sleep, LOW); // Turn OFF GSM-shield delay(2200); digitalWrite(pin2sleep, HIGH); digitalWrite(13, LOW); scale0.power_down(); //power down all scales scale1.power_down(); scale2.power_down(); delay(90000); sleep_mode(); // Go to sleep detachInterrupt(digitalPinToInterrupt(0)); // turn off external interrupt notsunset=0; for (int i=0; i &lt;= 250; i++){ if ( !digitalRead(2) ){ notsunset++; } //is a really sunset now? you shure? delay(360); } if ( notsunset==0 ) { digitalWrite(13, HIGH); digitalWrite(pin2sleep, LOW); // Turn-ON GSM-shield scale0.power_up(); //power up all scales scale1.power_up(); scale2.power_up(); raw01=raw02; raw11=raw12; raw21=raw22; raw02=scale0.get_units(16); //read data from scales raw12=scale1.get_units(16); raw22=scale2.get_units(16); daynum++; delta00=(raw02-raw00)/calibrate0; // calculate weight changes delta01=(raw02-raw01)/calibrate0; delta10=(raw12-raw10)/calibrate1; delta11=(raw12-raw11)/calibrate1; delta20=(raw22-raw20)/calibrate2; delta21=(raw22-raw21)/calibrate2; delay(16000); mySerial.println("AT+CMGF=1"); // Send SMS part delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.print("Turn "); mySerial.println(daynum); mySerial.print("Hive1 "); mySerial.print(delta01); mySerial.print(" "); mySerial.println(delta00); mySerial.print("Hive2 "); mySerial.print(delta11); mySerial.print(" "); mySerial.println(delta10); mySerial.print("Hive3 "); mySerial.print(delta21); mySerial.print(" "); mySerial.println(delta20); mySerial.print("V Bat= "); mySerial.println(readVcc()); if (readVcc()&lt;3.5) {mySerial.print("!!! CHARGE BATTERY !!!");} delay(500); mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); } }</code> </pre> <br><p>  In der ersten Zeile in Anf√ºhrungszeichen char phone_no [] = "+ 123456789012";  - Anstelle von 123456789012 geben wir unsere Telefonnummer mit der Landesvorwahl an, an die die SMS gesendet wird. </p><br><p>  Klicken Sie nun auf die Check-Schaltfl√§che (√ºber der Nummer eins im obigen Screenshot). Wenn die Kompilierung unten ist (unter dem Triple im Screenshot), k√∂nnen wir den Mikrocontroller flashen. </p><br><p>  Also, USB-TTL ist mit dem ARDUINO und dem Computer verbunden, wir legen den geladenen Akku in die Halterung (normalerweise beginnt bei einem neuen Arduino die LED einmal pro Sekunde zu blinken). </p><br><p>  Jetzt die Firmware - wir trainieren, um den roten (silbernen) Knopf des Mikrocontrollers zu dr√ºcken - dies muss unbedingt zu einem bestimmten Zeitpunkt erfolgen !!! <br>  Ist da  Klicken Sie auf die Schaltfl√§che "Hochladen" (√ºber den beiden im Screenshot) und sehen Sie sich die Zeile am unteren Rand der Benutzeroberfl√§che (unter den drei Bildschirmen) genau an. <br>  Sobald die Beschriftung "Zusammenstellung" durch "Herunterladen" ersetzt wird - dr√ºcken Sie die rote Taste (Zur√ºcksetzen) - wenn alles in Ordnung ist - blinkt der USB-TTL-Adapter freudig und die Beschriftung "Heruntergeladen" am unteren Rand der Benutzeroberfl√§che </p><br><p>  W√§hrend wir auf das Eintreffen der Test-SMS am Telefon warten, erkl√§re ich Ihnen, wie das Programm funktioniert: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/bb0/555/3f9/bb05553f9fb11ef00ae30a92be52839b.jpg" alt="Die zweite Version des Debug-Stands"></p><br><p>  Auf dem Foto - die zweite Version des Debug-Stands. </p><br><p>  Beim ersten Einschalten des Systems werden die Bytes 500 und 501 des EEPROM √ºberpr√ºft. Wenn sie gleich sind, wurden die Kalibrierungsdaten nicht aufgezeichnet, und der Algorithmus f√§hrt mit dem Setup-Abschnitt fort. <br>  Das gleiche passiert, wenn der Fotowiderstand beim Einschalten schattiert ist (mit einer Kappe von einem Stift) - der Parameter-Reset-Modus ist aktiviert. </p><br><p>  Dehnungsmessstreifen sollten bereits unter den Bienenst√∂cken installiert sein, da wir einfach den Anfangspegel von Null festlegen und dann die Gewichts√§nderung messen (jetzt kommen Nullen, da wir noch nichts angeschlossen haben). <br>  Auf Arduino blinkt die eingebaute LED von Pin 13. <br>  Wenn der Reset nicht erfolgt, leuchtet die LED 12 Sekunden lang auf. <br>  Danach wird eine Test-SMS mit der Meldung "INITIAL BOOT OK" und der Batteriespannung gesendet. <br>  Das Kommunikationsmodul wird ausgeschaltet und nach 3 Minuten versetzt die Arduino-Karte die HX711-ADC-Karten in den Ruhemodus und schl√§ft von selbst ein. <br>  Eine solche Verz√∂gerung wurde vorgenommen, um St√∂rungen durch ein funktionierendes GSM-Modul nicht zu erfassen (nach dem Ausschalten werden einige Zeit lang ‚ÄûSchriftarten‚Äú geschrieben). </p><br><p>  Au√üerdem haben wir einen Interrupt am Fotosensor, der am zweiten Stift arbeitet (plus das Anheben wird durch die Pullup-Funktion aktiviert). <br>  In diesem Fall wird nach weiteren 3 Minuten Ausl√∂sen der Zustand des Fotowiderstands √ºberpr√ºft, um wiederholte / falsch positive Ergebnisse auszuschlie√üen. <br>  Was charakteristisch ist, ohne Anpassung arbeitet das System 10 Minuten nach dem astronomischen Sonnenuntergang bei bew√∂lktem Wetter und nach 20 Minuten bei klarem Wetter. <br>  Ja, damit jedes Mal, wenn das System nicht zur√ºckgesetzt wird, mindestens das erste HX711-Modul angeschlossen werden muss (Pins DT-D10, SCK-A0) </p><br><p>  Dann werden die W√§gezellenablesungen vorgenommen, die Gewichts√§nderung gegen√ºber dem vorherigen Vorgang (die erste Zahl in der Zeile nach Hive) berechnet und vom ersten Start an wird die Batteriespannung √ºberpr√ºft und diese Informationen werden in Form von SMS gesendet: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c05/360/360/c05360360e4ac01a63cd0daa0f138a99.png" alt="Probensystem"></p><br><p>  Hast du √ºbrigens SMS erhalten?  Gl√ºckwunsch!  Wir sind auf halbem Weg!  W√§hrend der Akku aus der Halterung entfernt werden kann, ben√∂tigen wir keinen weiteren Computer. </p><br><p>  Das Flugkontrollzentrum erwies sich √ºbrigens als so kompakt, dass es in ein Mayonnaise-Glas passt, in meinem Fall in eine durchscheinende Box mit einer Gr√∂√üe von 30 x 60 x 100 mm (von Visitenkarten), die perfekt passt. </p><br><p>  Ja, das Schlafsystem verbraucht ~ 2,3 mA - 90% aufgrund des Kommunikationsmoduls - es schaltet sich nicht vollst√§ndig aus, sondern wechselt in den Standby-Modus. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/26b/994/07e/26b99407efab87e00ffe017eea588666.jpg" alt="Nicht Houston"></p><br><p>  Wir fahren mit der Herstellung von Sensoren fort. Lassen Sie uns zun√§chst das Layout der Sensoren ansprechen: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/182/43b/cec/18243bcecc904c4018d7b2217cc72d9b.jpg" alt="Sensorposition"></p><br><p>  Dies ist der Plan der Bienenstock-Draufsicht. </p><br><p>  Klassischerweise sind 4 Sensoren in den Ecken installiert (1,2,3,4) </p><br><p>  Wir werden anders messen.  Oder besser gesagt, sogar im dritten.  Wie die Jungs von BroodMinder es anders machen: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b49/fbe/1f3/b49fbe1f378d3e5b4b7320bf6ac83520.jpg" alt="Brutminder"></p><br><p>  Bei dieser Konstruktion sind die Sensoren an den Positionen 1 und 2 installiert, die Punkte 3.4 basieren auf dem Strahl. <br>  Dann f√§llt nur die H√§lfte des Gewichts auf die Sensoren. <br>  Ja, eine solche Methode ist weniger genau, aber es ist schwer vorstellbar, dass die Bienen alle Rahmen mit ‚ÄûZungen‚Äú aus den Waben entlang einer Wand des Bienenstocks aufgebaut haben. </p><br><p>  Daher schlage ich vor, die Sensoren auf Punkt 5 zu reduzieren - dann muss das System nicht abgeschirmt werden, und bei Verwendung von leichten Bienenst√∂cken muss unbedingt ein Sensor verwendet werden. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/67b/10b/4cc/67b10b4ccdaf51f4f81574927ac21ca3.jpg" alt="Sensor und Sensoroptionen"></p><br><p>  Im Allgemeinen haben wir zwei Modultypen am HX711 getestet, zwei Sensortypen und zwei Optionen zum Anschlie√üen - mit einer vollst√§ndigen Wheatstone-Br√ºcke (2 Sensoren) und eine halbe, wenn der zweite Teil mit 1k-Widerst√§nden mit einer Toleranz von 0,1% erg√§nzt wird. <br>  Die letztere Methode ist jedoch unerw√ºnscht und wird selbst von Sensorherstellern nicht empfohlen. Daher werde ich nur die erste beschreiben. </p><br><p>  In einem Bienenstock werden also zwei W√§gezellen und ein HX711-Modul installiert. Der Schaltplan lautet wie folgt: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6d2/39b/bef/6d239bbef099b427b0f6127a323a7e69.jpg"></p><br><p>  Von der ADC-Karte bis zum Arduino gibt es 5 Meter eines 4-adrigen Telefonkabels - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wir erinnern uns, dass die Bienen GSM-Ger√§te im Bienenstock nicht m√∂gen</a> . </p><br><p>  Im Allgemeinen lassen wir bei den Sensoren "Schw√§nze" von 8 cm, reinigen das verdrillte Paar und l√∂ten alles wie auf dem Foto oben. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/30d/ab9/f9c/30dab9f9cc87cd43929d9b86fec36f62.jpg" alt="Wahr Sie sterben die Polarit√§t!"></p><br><p>  Ich wiederhole noch einmal - beachte die Polarit√§t! </p><br><p>  Wenn das schwarze Kabel der W√§gezelle mit dem E + der HX711-Karte verbunden ist, geht das rote an A + </p><br><p>  Andernfalls erhalten Sie anstelle einer Gewichtszunahme eine Erm√§√üigung, die jedoch keine Rolle spielt. In diesem Fall reicht es aus, die roten Dr√§hte von den W√§gezellen (A + und A-) auf der ADC-Karte auszutauschen. </p><br><p>  Legen Sie vor Beginn der Tischlerei Wachs / Paraffin in einen geeigneten Beh√§lter, um es in einem Wasserbad zu schmelzen. </p><br><p>  Jetzt nehmen wir unseren Strahl und teilen ihn in drei Segmente von 100 mm </p><br><p>  Als n√§chstes markieren wir eine 25 mm breite, 7-8 mm tiefe L√§ngsnut mit einer B√ºgels√§ge und einem Mei√üel. Wir entfernen den √úberschuss - ein U-f√∂rmiges Profil sollte herauskommen. </p><br><p>  Wachs aufgew√§rmt?  - Wir tauchen unsere ADC-Platten dort ein - dies sch√ºtzt sie vor Feuchtigkeit / Nebel: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/672/7f1/a576727f1b4385933b640b0dd1ef2a01.jpg" alt="ADC-Schutz gegen Konflikte"></p><br><p>  Wir haben alles auf einem Holzsockel (es ist notwendig, es mit einem Antiseptikum gegen Verfall zu behandeln): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/a6b/347/a57a6b34743c1f8b8add453e729fadea.jpg" alt="Montage"></p><br><p>  Und zum Schluss befestigen wir die Sensoren mit Schrauben: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/94d/e43/541/94de435418f3d001e47b181935612e5f.jpg" alt="Sensor bereit"></p><br><p>  Es gab eine andere Option mit einem blauen Isolierband, aber aus Gr√ºnden der Menschlichkeit bringe ich es nicht mit ;-) </p><br><p>  Von der Seite von Arduino machen wir Folgendes: </p><br><p>  Wir reinigen unsere Telefonkabel, drehen die farbigen Dr√§hte zusammen, d√ºnn. </p><br><p>  Danach l√∂ten wir die Platinenkontakte wie auf dem Foto: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a0c/6fc/0fe/a0c6fc0fedd0bc6a1c4f1e6929d5e4bc.jpg" alt="Finale"></p><br><p>  Das war's, jetzt f√ºr die letzte √úberpr√ºfung, setzen Sie die Sensoren auf die Sektoren des Kreises, oben - ein St√ºck Sperrholz, setzen Sie den Controller auf Null (setzen Sie die Batterie mit der Kappe auf die Fotodiode vom F√ºllfederhalter). </p><br><p>  In diesem Fall sollte die LED am Arduino blinken und eine Test-SMS sollte kommen. </p><br><p>  Dann entfernen wir die Kappen von der Fotozelle und sammeln Wasser in einer 1,5-Liter-Plastikflasche. <br>  Wir stellen die Flasche auf Sperrholz und setzen nach dem Einschalten bereits einige Minuten auf den Fotowiderstand (simuliert einen Sonnenuntergang). </p><br><p>  Nach drei Minuten leuchtet die LED am Arduino auf und Sie sollten an allen Positionen eine SMS mit einem Gewichtswert von ca. 1 kg erhalten. </p><br><p>  Gl√ºckwunsch!  Das System ist erfolgreich montiert! </p><br><p>  Wenn wir das System jetzt wieder zum Laufen bringen, erhalten wir in der ersten Spalte des Gewichts Nullen. </p><br><p>  Ja, unter realen Bedingungen ist es w√ºnschenswert, den Fotowiderstand vertikal nach oben auszurichten. </p><br><p>  Jetzt werde ich ein kurzes Handbuch zur Verwendung von: </p><br><ol><li>  Installieren Sie Dehnungsmessstreifen unter den R√ºckw√§nden der Bienenst√∂cke (unter der Vorderseite ersetzen Sie einen Balken / eine Platte mit einer Dicke von ~ 30 mm). </li><li>  Schattieren Sie den Fotowiderstand und legen Sie den Akku ein - die LED sollte blinken und eine Test-SMS mit dem Text "INITIAL BOOT OK" sollte kommen </li><li>  Positionieren Sie die Zentraleinheit so weit wie m√∂glich von den Bienenst√∂cken entfernt, damit die Dr√§hte bei der Arbeit mit Bienen nicht st√∂ren. <br>  Jeden Abend nach Sonnenuntergang kommt SMS mit einer Gewichts√§nderung pro Tag und ab dem Start an. <br>  Wenn die Batteriespannung 3,5 V erreicht, endet die SMS mit der Zeile "!!! CHARGE BATTERY !!!" <br>  Die Betriebszeit einer Batterie mit einer Kapazit√§t von 2600 mAh betr√§gt ungef√§hr einen Monat. <br>  Beim Austausch der Batterie werden die t√§glichen Gewichts√§nderungen der Bienenst√∂cke nicht ber√ºcksichtigt. </li></ol><br><p>  Was weiter? </p><br><ol><li>  Um herauszufinden, wie man all dies in ein Projekt f√ºr Github einf√ºgt </li><li>  Starten Sie 3 Bienenfamilien in den Bienenst√∂cken des Palivoda-Systems (oder geh√∂rnte Menschen). </li><li>  F√ºgen Sie "Br√∂tchen" hinzu - eine Messung von Luftfeuchtigkeit, Temperatur und vor allem eine Analyse des Summens von Bienen. </li></ol><br><p>  Lassen Sie uns alles besetzen, mit freundlichen Gr√º√üen, elektrischer Imker Andrey </p><br><p>  PS F√ºr neue Ver√∂ffentlichungen zu diesem Thema siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beefree.xyz</a> <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de444326/">https://habr.com/ru/post/de444326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de444316/index.html">Briefe aus sozialen Netzwerken: Ist Ihre Privatsph√§re gut genug? Zwei Probleme und ihre L√∂sung</a></li>
<li><a href="../de444318/index.html">Nginx-Erfolgsgeschichte oder "Alles ist m√∂glich, probieren Sie es aus!"</a></li>
<li><a href="../de444320/index.html">Exotischer Bleistift: Erkennen eines zweiten Ger√§usches in gew√∂hnlichem Graphit</a></li>
<li><a href="../de444322/index.html">Auf den Spuren der Taschenrechner: SpeedCrunch</a></li>
<li><a href="../de444324/index.html">Auf den Spuren von Taschenrechnern: SpeedCrunch</a></li>
<li><a href="../de444328/index.html">Die Neugestaltung der Benutzeroberfl√§che ist oft Zeitverschwendung</a></li>
<li><a href="../de444330/index.html">Serverless CMS ist endlich ein w√ºrdiger Konkurrent f√ºr Wordpress</a></li>
<li><a href="../de444332/index.html">Informationssicherheit und Catering: Wie Manager √ºber IT-Produkte denken</a></li>
<li><a href="../de444336/index.html">Schnelle Erfassungslisten: Was ist der Unterschied zwischen schwachen, starken und nicht besessenen Links?</a></li>
<li><a href="../de444338/index.html">Kapselung in Python 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>