<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•© ‚ò∏Ô∏è ‚òÇÔ∏è Unity3D: ¬øc√≥mo averiguar el grado de iluminaci√≥n de un punto en una escena? ‚öóÔ∏è üå† üíû</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saludos! 

 Lo s√©, y en el fondo sabes lo que faltan tus juegos de cartas o juegos tres en uno. Sistemas de sigilo! 

 Y, por supuesto, cualquier sist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Unity3D: ¬øc√≥mo averiguar el grado de iluminaci√≥n de un punto en una escena?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417135/">  Saludos! <br><br>  Lo s√©, y en el fondo sabes lo que faltan tus juegos de cartas o juegos tres en uno.  Sistemas de sigilo! <br><br>  Y, por supuesto, cualquier sistema de sigilo que se respete deber√≠a poder tener en cuenta la iluminaci√≥n del entorno que rodea al jugador.  Me sorprendi√≥ desenterrar el tema y encontrar una cantidad anormalmente peque√±a de informaci√≥n.  Por lo tanto, me apresuro a compartir los frutos. <br><br>  Hoy no desarrollaremos un sistema completo de sigilo para el jugador, consideraremos puramente interacciones con la iluminaci√≥n. <br><a name="habracut"></a><br><h3>  M√©todo 1: colisionadores </h3><br>  Una forma simple y no muy intensiva en recursos. <br><br>  Agregamos un colisionador esf√©rico a cada fuente de luz.  Lo hacemos un disparador.  Establecemos las dimensiones aproximadamente iguales al radio de luz. <br><br>  El resto es tan claro como una sombra.  Estamos escribiendo un script simple, donde en OnTriggerEnter () colocamos la activaci√≥n del c√°lculo de la luz (para que las fuentes de luz no funcionen "inactivas" cuando el jugador no est√° cerca). <br><br>  El c√°lculo de iluminaci√≥n en s√≠ estar√° ubicado en Actualizaci√≥n ().  En esencia, este es el Physics.Raycast habitual ().  Si golpea al jugador, el jugador est√° en la zona de luz.  Si no cae, significa que el jugador est√° detr√°s de obst√°culos y, por lo tanto, a la sombra. <br><br>  Tambi√©n puede agregar aqu√≠ el c√°lculo de la distancia entre el jugador y la fuente de luz.  Por lo tanto, para determinar la iluminaci√≥n, utilizaremos un flotador simple, que variar√° seg√∫n la distancia a las fuentes de luz.  Y puedes usarlo donde tu coraz√≥n lo desee. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/c9/nu/43/c9nu43wv6trcy2hg28eijiq4j_o.png"><br>  <i>En el punto 1, la iluminaci√≥n est√° cerca del m√°ximo.</i>  <i>En el punto 2, la iluminaci√≥n es m√≠nima: hay un obst√°culo entre la luz y el punto.</i>  <i>En el punto 3, la iluminaci√≥n es promedio.</i> <br></div></div><br>  ¬°Y eso no es todo!  Puede agregar colisionadores de activaci√≥n a varias "zonas de sombra" donde el jugador debe esconderse.  En las mejores tradiciones de Manhunt.  Del mismo modo, puede marcar las zonas brillantes con el colisionador, simulando, por ejemplo, la luz de un foco. <br><br><h4>  Ventajas: </h4><br><ul><li>  F√°cil de personalizar luces puntuales. </li><li>  Bastante econ√≥mico en t√©rminos de recursos, si no env√≠a spam a las fuentes de luz. </li></ul><br><h4>  Desventajas </h4><br><ul><li>  La luz puntual y la luz direccional est√°n muy ajustadas.  Si por primera vez es suficiente colocar el colisionador en el campo de luz (para aumentar la visibilidad del jugador en la entrada), entonces la segunda es un verdadero horror.  Debes colocar colisionadores en cada sombra (para reducir la visibilidad del jugador en la entrada), o comprobar constantemente usando Physics.Raycast () entre el jugador y el "sol": se encuentra debajo de los rayos o en la sombra. </li><li>  Una gran cantidad de colisionadores abarrotan la escena, lo que complica la f√≠sica. </li><li>  Se debe tener cuidado con las fuentes de luz que se cruzan. </li><li>  La luz din√°mica (intensidad m√≥vil o cambiante) debe agregarse por separado a trav√©s de scripts. </li></ul><br><h3>  M√©todo 2: RenderTexture </h3><br>  Que estamos haciendo aqui  De hecho, obtenemos una "captura de pantalla" de la c√°mara, y no necesariamente de la c√°mara principal.  Y luego analizamos el color de la captura de pantalla para descubrir c√≥mo la luz brillante cae sobre el sujeto. <br><br>  Para empezar, necesitamos un objeto del cual "leeremos" la luz.  Cree una esfera o plano regular, h√°galo peque√±o (escala 0.1), col√≥quelo cerca del piso, h√°galo blanco, retire el colisionador: <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hb/ri/7o/hbri7op9p5lyq091ia1ozgeiasc.png"><br></div></div><br>  Agregue una c√°mara (aseg√∫rese de eliminar el oyente de audio y verifique que la etiqueta MainCamera no valga la pena).  Atadlo a nuestro objeto.  Lo ponemos un poco m√°s alto, lo dirigimos hacia abajo.  Exponemos en la configuraci√≥n no la pantalla principal.  Hacerlo ortogr√°fico es para tu gusto. <br><br>  Al final, lo posicionamos de modo que mire nuestro objeto y solo a √©l. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/uv/de/3y/uvde3ygsuysuvuysojxbsvmbml8.png"><br></div></div><br>  Al final, configure la m√°scara de selecci√≥n de las c√°maras primaria y secundaria para que la primaria no muestre nuestros objetos "ligeros", mientras que las secundarias solo los ven, sin saturar nada m√°s. <br><br>  Y aqu√≠ comienza la diversi√≥n.  Adjuntamos el gui√≥n a la c√°mara: <br><br><pre><code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">public</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Camera</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">cam</span></span>; //   <span class="hljs-selector-tag"><span class="hljs-selector-tag">RenderTexture</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">tex</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">Texture2D</span></span> _<span class="hljs-selector-tag"><span class="hljs-selector-tag">tex</span></span>; <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Start</span></span> () { //    "". // ,       -   . // Depth   0   -   . tex = new RenderTexture (1, 1, 8); // RenderTexture "" , //   ,    . _tex = new Texture2D (1, 1, TextureFormat.RGB24, false); } <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Update</span></span> () { //   ""  cam.targetTexture = tex; cam.Render (); //     RenderTexture.active = tex; //   Texture2D _tex.ReadPixels (new Rect (0, 0, 1, 1), 0, 0); _tex.Apply (); Color col = _tex.GetPixel (0, 0); float vis = (col.r + col.g + col.b) / 3; }</code> </pre> <br>  En la salida, obtenemos un vis de flotaci√≥n, que, en esencia, es una representaci√≥n num√©rica del nivel de iluminaci√≥n incidente en nuestro objeto.  Si la fuente est√° cerca - el objeto es blanco - vis es 1. Si est√° oscuro - el objeto es negro - vis es ~ 0. <br><br>  No necesitamos hacer la operaci√≥n anterior en cada cuadro, por lo que incorporamos un segundo temporizador peque√±o: <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">float</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">interval</span></span> = 0; <span class="hljs-selector-tag"><span class="hljs-selector-tag">void</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Update</span></span> () { interval += Time.deltaTime; if (interval &lt; 1) return; interval = 0; //   }</code> </pre> <br>  Luego, vinculamos todo nuestro sistema al jugador para que se mueva con √©l.  ¬°Y nuestra variable vis devuelve autom√°ticamente la luz alrededor del jugador! <br><br>  Este sistema se puede usar no solo junto con el reproductor.  Puede colocarlo en cualquier lugar y a su gusto, creando una especie de sensores de luz.  Como regla, hay formas m√°s efectivas de implementarlos, pero ¬øsiempre es bueno tener alternativas? <br><br>  Las ventajas son obvias, hablemos de las desventajas. <br><br><h4>  Desventajas </h4><br><ul><li>  Cada "detector de luz" (si hay m√°s de uno) requiere una c√°mara separada. </li><li>  Texture2D.ReadPixels (): bueno, extremadamente lento.  Incluso si lo hace una vez por segundo, y no todos los cuadros, incluso si divide las funciones de escritura y lectura de texturas en cuadros diferentes, todav√≠a hay dise√±os a 40-110 ms. </li><li>  Este sistema no tiene en cuenta algunos casos raros.  Por ejemplo, una linterna brilla sobre un personaje.  El personaje est√° bien iluminado, pero la luz cae sobre √©l y detr√°s de √©l, y no hacia abajo, respectivamente, nuestro detector de luz muestra un bajo nivel de iluminaci√≥n.  Puedes resolver el problema, por ejemplo, colocando el detector no en el piso, sino al nivel del cofre del personaje.  Luego, debe colocar dos c√°maras en lados opuestos para leer la luz desde ambos lados.  Lo que ralentizar√° el sistema a la mitad. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es417135/">https://habr.com/ru/post/es417135/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es417123/index.html">Integraci√≥n de Spark Streaming y Kafka</a></li>
<li><a href="../es417125/index.html">RTC Meetup .Net: invitar a la primera reuni√≥n</a></li>
<li><a href="../es417127/index.html">Tesla firma un acuerdo para construir Gigafactory 3 en China</a></li>
<li><a href="../es417129/index.html">Universo de la mente</a></li>
<li><a href="../es417131/index.html">C√≥mo sentir las transacciones en MongoDB ahora</a></li>
<li><a href="../es417137/index.html">Angular: cree un componente de casilla de verificaci√≥n m√∫ltiple adecuado para reutilizar</a></li>
<li><a href="../es417139/index.html">Evidencia que enga√±√≥ a los cient√≠ficos durante d√©cadas.</a></li>
<li><a href="../es417141/index.html">Nunca es demasiado temprano para pensar en 6G</a></li>
<li><a href="../es417143/index.html">¬øEvidencia en ciencia? No son</a></li>
<li><a href="../es417145/index.html">Aplicaci√≥n Burger King: burla tu privacidad. ¬øEstamos corrigiendo?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>