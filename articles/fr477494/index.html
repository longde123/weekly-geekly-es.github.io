<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎅🏿 👁️ 🎐 1. Analyse des logiciels malveillants à l'aide de Check Point forensics. Réseau de sablage 🐣 🧘 🙆🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bienvenue dans la nouvelle série d'articles, cette fois sur le sujet des enquêtes sur les incidents, à savoir l'analyse des logiciels malveillants à l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1. Analyse des logiciels malveillants à l'aide de Check Point forensics. Réseau de sablage</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/477494/"><img src="https://habrastorage.org/webt/ww/ya/6d/wwya6d8jmmk_e_9kyrnpmvtsw98.png"><br><br>  Bienvenue dans la nouvelle série d'articles, cette fois sur le sujet des enquêtes sur les incidents, à savoir l'analyse des logiciels malveillants à l'aide de Check Point forensics.  Plus tôt, nous avons publié <a href="https://habr.com/ru/company/tssolution/blog/358508/">plusieurs didacticiels vidéo</a> sur le travail dans Smart Event, mais cette fois, nous examinerons des rapports médico-légaux sur des événements spécifiques dans différents produits Check Point: <br><br><ul><li>  <a href="https://tssolution.ru/katalog/checkpoint/sandblast">Réseau de sablage</a> </li><li>  <a href="https://tssolution.ru/reshenie/sandblast-agent">Agent de sablage</a> </li><li>  <a href="https://tssolution.ru/reshenie/mobile-threat-defense">Mobile de sablage</a> </li><li>  <a href="https://www.checkpoint.com/ru/products/cloud-security/">CloudGuard SaaS</a> </li></ul><br>  Pourquoi la criminalistique des incidents évités est-elle importante?  Il semblerait que j’ai attrapé le virus, c’est déjà bien, pourquoi s’y attaquer?  Comme le montre la pratique, il est conseillé non seulement de bloquer l'attaque, mais aussi de comprendre comment cela fonctionne: quel était le point d'entrée, quelle vulnérabilité a été utilisée, quels processus ont été impliqués, si le registre et le système de fichiers ont été affectés, quelle famille de virus, quels dommages potentiels, etc. .  Ces données et d'autres utiles peuvent être obtenues dans des rapports complets de Check Point forensics (à la fois sous forme de texte et sous forme graphique).  Obtenir un tel rapport manuellement est très difficile.  Ensuite, ces données peuvent aider à prendre les mesures nécessaires et exclure la possibilité de succès de telles attaques à l'avenir.  Aujourd'hui, nous allons examiner le rapport médico-légal du Check Point SandBlast Network. <a name="habracut"></a><br><br><h3>  Réseau de sablage </h3><br>  L'utilisation de bacs à sable pour améliorer la sécurité du périmètre du réseau est depuis longtemps courante et constitue un composant indispensable comme IPS.  À Check Point, la lame Threat Emulation est responsable de la fonctionnalité sandbox, qui fait partie des technologies SandBlast (il y a aussi Threat Extraction au même endroit).  Nous avons déjà publié un <a href="https://habr.com/ru/company/tssolution/blog/325822/">court cours Check Point</a> SandBlast <a href="https://habr.com/ru/company/tssolution/blog/325822/">pour</a> Gaia version 77.30 (je vous recommande fortement de le consulter si vous ne comprenez pas de quoi il s'agit).  Du point de vue de l'architecture, rien n'a fondamentalement changé depuis lors.  Si vous avez Check Point Gateway sur le périmètre du réseau, vous pouvez utiliser deux options d'intégration avec le sandbox: <br><br><ol><li>  <b>SandBlast Local Appliance</b> - une appliance SandBlast supplémentaire est placée sur votre réseau, à laquelle les fichiers sont envoyés pour analyse. </li><li>  <b>SandBlast Cloud</b> - les fichiers sont envoyés pour analyse au cloud Check Point. </li></ol><br><img src="https://habrastorage.org/webt/66/sn/gm/66sngmmpwecwyhjbpzxxaugqqvm.png"><br><br>  Le bac à sable peut être considéré comme la dernière ligne de défense sur le périmètre du réseau.  Il ne se connecte qu'après analyse par des moyens classiques - antivirus, IPS.  Et si ces outils de signature traditionnels ne fournissent pratiquement aucune analyse, le bac à sable peut «dire» en détail pourquoi le fichier a été verrouillé et ce qu'il fait de malveillant.  Un tel rapport médico-légal peut être obtenu à partir du sandbox local et du cloud. <br><br><h3>  Rapport d'investigation judiciaire </h3><br>  Supposons que vous, en tant que spécialiste de la sécurité des informations, êtes venu travailler et avez ouvert un tableau de bord dans SmartConsole.  Immédiatement, vous voyez des incidents au cours des dernières 24 heures et votre attention est attirée sur les événements d'émulation de menaces - les attaques les plus dangereuses qui n'ont pas été bloquées par l'analyse de signature. <br><br><img src="https://habrastorage.org/webt/dg/bf/jh/dgbfjhsfuskdji2voo-pjnvcj5o.png"><br><br>  Vous pouvez «tomber» dans ces événements (explorer vers le bas) et voir tous les journaux sur la lame d'émulation de menace. <br><br><img src="https://habrastorage.org/webt/v1/2h/bn/v12hbnqdibste1syaurkx4wn-6o.png"><br><br>  Après cela, vous pouvez en outre filtrer les journaux par le niveau de criticité des menaces (gravité), ainsi que par niveau de confiance (fiabilité du fonctionnement): <br><br><img src="https://habrastorage.org/webt/oe/bn/cq/oebncqvep3bgs3oj8wcrhtkub60.png"><br><br>  Après avoir ouvert l'événement qui nous intéresse, vous pouvez vous familiariser avec les informations générales (src, dst, gravité, expéditeur, etc.): <br><br><img src="https://habrastorage.org/webt/0r/ck/mp/0rckmpxyoz1joyeieyq03co1sl8.png"><br><br>  Et là, vous pouvez voir la section <b>Forensics</b> avec un rapport de <b>synthèse</b> disponible.  En cliquant dessus, une analyse détaillée du malware sous forme d'une page HTML interactive s'ouvrira devant nous: <br><br><img src="https://habrastorage.org/webt/lr/6g/m5/lr6gm5ro4eyikidei3uixqha3bo.png"><br>  (Cela fait partie de la page. <a href="https://eolkov.github.io/checkpoint-forensics/">L'original peut être consulté ici</a> ) <br><br>  À partir du même rapport, nous pouvons télécharger le malware d'origine (dans une archive protégée par mot de passe), ou contacter immédiatement l'équipe de réponse de Check Point. <br><br><img src="https://habrastorage.org/webt/_u/nt/oe/_untoelrwujpuvehzop2v29fapu.png"><br><br>  Un peu plus bas, vous pouvez voir une belle animation, qui en pourcentage montre ce que le code malveillant déjà connu fait écho à notre instance (y compris le code lui-même et les macros).  Ces analyses sont fournies à l'aide de l'apprentissage automatique dans le Check Point Threat Cloud. <br><br><img src="https://habrastorage.org/webt/bw/kj/kh/bwkjkhgyb88psrizii6c5g2chjs.png"><br><br>  Ensuite, vous pouvez voir quel type d'activité dans le bac à sable a permis de conclure que ce fichier est malveillant.  Dans ce cas, nous voyons l'utilisation de techniques de contournement et une tentative de téléchargement de chiffreurs: <br><br><img src="https://habrastorage.org/webt/gg/wx/db/ggwxdb17lpj_sgtxpkwo-t8rl6u.png"><br><br>  Vous pouvez remarquer que dans ce cas, l'émulation a été effectuée sur deux systèmes (Win 7, Win XP) et différentes versions de logiciel (Office, Adobe).  Ci-dessous, une vidéo (diaporama) avec le processus d'ouverture de ce fichier dans le bac à sable: <br><br><img src="https://habrastorage.org/webt/lm/bg/vf/lmbgvfaqsbbzvtvrdi8a62lrk4u.png"><br><br>  Exemple vidéo: <br><br><img src="https://habrastorage.org/webt/r4/yr/a_/r4yra_jm8idpzuqq-hobylj7lz4.gif"><br><br>  À la toute fin, nous pouvons voir en détail l'évolution de l'attaque.  Soit sous forme de tableau soit sous forme graphique: <br><br><img src="https://habrastorage.org/webt/dh/yf/ja/dhyfjam083g8plvfjlpzcvwcml4.png"><br><br>  Là, nous pouvons télécharger ces informations au format RAW et un fichier pcap pour une analyse détaillée du trafic généré dans Wireshark: <br><br><img src="https://habrastorage.org/webt/_p/71/gy/_p71gykq_nax2s1sb3vjvyc0ui0.png"><br><br><h3>  Conclusion </h3><br>  L'utilisation de ces informations peut renforcer considérablement la protection de votre réseau.  Bloquez les hôtes de distribution de virus, corrigez les vulnérabilités, bloquez les éventuels commentaires de C&amp;C et bien plus encore.  Ne négligez pas cette analyse. <br><br>  Dans les articles suivants, nous examinerons également les rapports de SandBlast Agent, SnadBlast Mobile, ainsi que CloudGiard SaaS.  Alors restez à l'écoute ( <a href="https://t.me/tssolution">Telegram</a> , <a href="https://www.facebook.com/groups/tssolution.info/">Facebook</a> , <a href="https://vk.com/ts_solution">VK</a> , <a href="https://tssolution.ru/blog">TS Solution Blog</a> )! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477494/">https://habr.com/ru/post/fr477494/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477478/index.html">Domotique avec prise en charge des langages de programmation industriels ou BluePill x405</a></li>
<li><a href="../fr477484/index.html">Que pensaient-ils des programmeurs</a></li>
<li><a href="../fr477488/index.html">Neungers: les épices doivent couler</a></li>
<li><a href="../fr477490/index.html">Kitchen Robotics Part 2 ou un autre avatar de Blynk</a></li>
<li><a href="../fr477492/index.html">Que restera-t-il dans la salle des serveurs?</a></li>
<li><a href="../fr477498/index.html">Nous collectons les journaux de Nginx à l'aide de nginx-clickhouse, les envoyons à Clickhouse et les affichons à Grafana</a></li>
<li><a href="../fr477500/index.html">Modèle d'application (Avalanche - cadre d'application pour Java)</a></li>
<li><a href="../fr477502/index.html">Travail à distance d'un employeur sain</a></li>
<li><a href="../fr477504/index.html">Meilleures pratiques de développement d'applications à suivre en 2020</a></li>
<li><a href="../fr477506/index.html">Développement d'une application mobile sans serveur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>