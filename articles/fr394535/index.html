<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏫ 🏳️‍🌈 👂🏼 ESP8266 par où commencer ou première expérience 👨‍🚒 📹 🧚🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je veux partager mon expérience de ce qu'il faut faire lorsque les châles ESP8266 tombent entre mes mains pour la première fois. Fai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ESP8266 par où commencer ou première expérience</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/394535/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet article, je veux partager mon expérience de ce qu'il faut faire lorsque les châles ESP8266 tombent entre mes mains pour la première fois. </font><font style="vertical-align: inherit;">Faire immédiatement une réservation que la cueillette de tels morceaux de fer, ainsi que la programmation, est mon passe-temps pour mon argent et dans mon temps libre de mon activité principale. </font><font style="vertical-align: inherit;">Par conséquent, veuillez traiter le degré de critique de ce matériel avec une certaine remise. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pourquoi ai-je décidé d'écrire ceci? </font><font style="vertical-align: inherit;">C'est simple: j'ai tué 3 semaines pour savoir par où commencer et comment ça marche. </font><font style="vertical-align: inherit;">De plus, je vais essayer de collecter un petit catalogue de liens pour travailler avec ESP8266. </font><font style="vertical-align: inherit;">J'espère que ces informations vous feront gagner au moins une fraction du temps. </font></font><br>
<br>
<img src="https://habrastorage.org/files/4ee/3f5/d03/4ee3f5d03937417fb3e6615740e7d527.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons donc!</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai commandé 3 options de carte pour moi sur un site chinois célèbre:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP8266 WIFI Serial Wireless Dev Test Board basé sur ESP-12 (ci-après «Yellow Board») (3,12 $)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP8266 ESP-07 avec plaque d'adaptation pour ESP8266 (ci-après ESP-07) (2,30 $)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoLin V3 NodeMcu Lua basé sur ESP-12 (ci-après dénommé "Lolin") (3,12 $)</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les raisons pour lesquelles j'ai pris un tel zoo:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le tableau jaune a déjà des LED intégrées que vous pouvez immédiatement clignoter; pour l'alimentation, vous pouvez utiliser non pas une fabuleuse 3,3 V, que vous devez en quelque sorte obtenir, mais 3 piles AA ou en connectant 4,5 V (ce que j'ai fait).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoLing m'a soudoyé par le fait qu'il est connecté à l'aide d'un câble micro USB et qu'elle n'a pas besoin de convertisseurs UART - il est immédiatement intégré à celui-ci sur la base de la puce chinoise CH340, pour laquelle vous pouvez facilement trouver des pilotes sur win7x64 et win10x64 (mes cas), et, encore une fois alimenté par un adaptateur ordinaire avec une sortie USB, plutôt qu'un 3,3V sophistiqué.</font></font></li>
<li>  ESP-07    . -  ,   ,         .      Adapter Plate —    20 ,    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer - vérifier les modules. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans toutes les instructions de démarrage, ils écrivent que si vous avez connecté l'alimentation et que le réseau WiFi AI-THINKER xxxxxxx est apparu, alors l'appareil fonctionne. </font><font style="vertical-align: inherit;">C'est arrivé avec mes appareils - ils ont tous créé un réseau WiFi auquel vous pouvez vous connecter. </font><font style="vertical-align: inherit;">Hourra! </font><font style="vertical-align: inherit;">Gagné! </font><font style="vertical-align: inherit;">J'étais ravi, mais tôt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, j'ai décidé d'expérimenter avec le Yellow Board. </font><font style="vertical-align: inherit;">Le vendeur avec le meilleur indicateur de prix dans la description du produit n'avait que des photos. </font><font style="vertical-align: inherit;">Et pas un mot de description. </font><font style="vertical-align: inherit;">Sur les ressources en russe, il y avait des références à ces tableaux, mais je n'ai pas trouvé de détails à ce sujet. </font><font style="vertical-align: inherit;">Chez certains vendeurs, j'ai vu cette instruction:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instruction du tableau jaune</font></font></b><div class="spoiler_text">1. Android phone installation IOT.APK, IOS client be released later<br>
2. shorting cap connected to the power to enter the programming mode, enter the normal operating state removed<br>
3. Replace the battery, mobile search network «AI-THINKER» router<br>
4. join the router (the router module form) password is: ai-thinker<br>
5. after the success can be added directly to the control module of the mobile phone.<br>
6. Enter the home router «SSID» and «Password» in the «Configure Device», then click on the icon at the top of the router, wait a few moments after the jump to join the router, connect the phone router WiFi, again «discovered device» to achieve control in the LAN.<br>
<br>
  :<br>
<br>
1.    Wi-Fi     (    5.0  !)  IOT.APK,   IOS   <br>
2.     ,   .<br>
3.   (   )        Wi-Fi  «AI-THINKER»<br>
4.       «ai-thinker»<br>
5.      IOT    .    .    ,       .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'incohérence était que mon réseau AI-THINKER xxxxxxxxxx n'a pas demandé de mot de passe, mais immédiatement le téléphone s'y est connecté. Et le point blanc de l'application n'a pas "vu" l'ESP après la connexion. La LED RGB était allumée en bleu avec un cavalier installé ou en vert sans lui. </font></font><br>
<br>
<img src="https://habrastorage.org/files/96d/58f/698/96d58f69805f4f078768b03f4d17800e.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai deviné que peut-être les Chinois soudaient - ils soudaient, mais ils ont oublié de flasher (ou ont flasqué de travers). J'ai donc décidé de me coudre. Pour le firmware, j'ai utilisé ESP8266 Flasher. Et puis une deuxième surprise est sortie: aucun programme n'a reconnu la carte, n'a pas répondu aux commandes, le firmware n'a pas inondé. Connecté via Arduino et via le convertisseur UART - rien. Les deux autres cartes ont déjà été reflasher et clignoter avec une LED, mais ici, c'est terne. Jusqu'à ce que je devine sonner les contacts.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois contacts pour le firmware sont affichés séparément sur cette carte: TX, RX, GND. Il s'est donc avéré que TX a été élevé sur le RX de l'ESP-12 lui-même, respectivement, RX - sur le TX. C'est-à-dire il fallait juste échanger deux fils: on connecte un convertisseur UART selon le schéma: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TX-TX </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RX-RX </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GND-GND </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ou Arduino: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
TX-RX </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
RX-TX </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
GND-GND </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après l'ouverture, le module a pris vie, l'original a été retrouvé firmware pour les LED clignotantes (AI-THINKER-IOT-2014-10-17 165528.bin) et est toujours flashé avec le même ESP8266 Flasher. Le mot de passe du point d'accès est apparu et l'application a immédiatement vu la carte jaune. La seule mise en garde: pour flasher, il est nécessaire d'installer un cavalier, pour tous les autres cas à retirer. Et n'oubliez pas de redémarrer l'appareil après avoir clignoté.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP8266 ESP-07 avec plaque d'adaptation</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instructions pour connecter ESP-07 (ESP-12) via un convertisseur UART:</font></font><br>
<br>
<img src="https://habrastorage.org/files/5c9/768/30c/5c976830ca6e43b89442587c8c791fce.jpg" alt="image"><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rouge - puissance 3,3 v;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noir - GND;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jaune - côté ESP8266 - RX, côté USB-TTL - TX;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vert - côté ESP8266 - TX, côté USB-TTL - RX;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Orange - CH_PD (CHIP ENABLE) - doit toujours être mis sous tension;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bleu - GPIO0 - est connecté via le commutateur à la terre pour activer le mode de clignotement du module. </font><font style="vertical-align: inherit;">Pour le démarrage habituel du module GPIO0, vous pouvez le laisser non connecté;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gris - GPIO15 (MTDO, HSPICS) cette broche doit être tirée au sol;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous vous connectez à Arduino, puis RX-RX et TX-TX.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À l'aide d'un fer à souder, l'ESP-07 et l'adaptateur ont été combinés. </font><font style="vertical-align: inherit;">Je recommande l'adaptateur car il facilite davantage la connexion par méthode sans soudure à l'aide d'une planche à pain et de fils. </font><font style="vertical-align: inherit;">Dans ce cas, j'ai utilisé un convertisseur DC-DC abaisseur de Chine pour l'alimentation. </font><font style="vertical-align: inherit;">Des capteurs DS18B20 étaient disponibles et il a été décidé de les connecter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je ne voulais pas installer HomesSmart tout de suite et le choix s'est porté sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un tel exemple</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Je ne retaperai pas le circuit et le code - ils sont presque les mêmes. </font><font style="vertical-align: inherit;">Cela n'a pas fonctionné tout de suite, mais avec Google et un tambourin, les données sur People’s Monitoring ont démarré et ont volé. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai téléchargé le script via </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESplorer</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'était sur Arduino</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/158/a33/c8d/158a33c8dddc4271a1b8f80ba22afa57.jpg" alt="image"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est devenu sur ESP8266</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/9ca/1eb/f11/9ca1ebf115164f109917b3656383d7f5.jpg" alt="image"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'attends le module d'alimentation compact 220AC - 3.3DC pour optimiser le nombre de fils.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LoLin V3 NodeMcu (Lolin)</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a été conseillé à cette carte de flasher le firmware NodeMcu immédiatement, ce qui a été fait via le programme de clignotement NodeMcu. </font><font style="vertical-align: inherit;">Le firmware lui-même est assemblé par le concepteur, ce qui vous permet d'inclure uniquement les plus nécessaires. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, il était censé connecter et contrôler un relais à 2 canaux et contrôler deux appliques dans la chambre. </font><font style="vertical-align: inherit;">Ici, je veux m'attarder sur une chose. </font><font style="vertical-align: inherit;">La version chinoise d'un tel relais a un cavalier JD-VCC - VCC - GND. </font><font style="vertical-align: inherit;">Par défaut, il est installé sur les broches JD-VCC - VCC. </font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/cb2/515/ec3cb25158934ab0b80f743fb9fc6aa4.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, le cavalier ne peut jamais être installé sur VCC - GND - organisez un court-circuit! </font><font style="vertical-align: inherit;">Ces trois contacts sont utilisés pour fournir une alimentation supplémentaire au relais, dans les cas où la commande peut ne pas être suffisante pour faire fonctionner le relais. </font><font style="vertical-align: inherit;">La présence d'un cavalier indique que l'alimentation provient des contacts "de contrôle". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le script a été utilisé comme suit:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Texte du script</font></font></b><div class="spoiler_text"><pre><code class="lua hljs">#================= init.lua =================
<span class="hljs-comment"><span class="hljs-comment">--      </span></span>
ssid,pass = <span class="hljs-string"><span class="hljs-string">"SSID"</span></span>,<span class="hljs-string"><span class="hljs-string">"PASSWORD"</span></span>;<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file.<span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(<span class="hljs-string"><span class="hljs-string">'wificonf'</span></span>) == <span class="hljs-literal"><span class="hljs-literal">true</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
   ssid = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">gsub</span></span>(file.readline(), <span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>);<font></font>
   pass = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">gsub</span></span>(file.readline(), <span class="hljs-string"><span class="hljs-string">"\n"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>);<font></font>
   file.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>();
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
<font></font>
wifi.setmode(wifi.STATION)<font></font>
wifi.sta.<span class="hljs-built_in"><span class="hljs-built_in">config</span></span>(ssid,pass)<font></font>
wifi.sta.autoconnect(<span class="hljs-number"><span class="hljs-number">1</span></span>);
<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">'IP:'</span></span>,wifi.sta.getip());
<span class="hljs-comment"><span class="hljs-comment">--print('MAC:',wifi.sta.getmac());</span></span><font></font>
<font></font>
led1 = <span class="hljs-number"><span class="hljs-number">3</span></span>
led2 = <span class="hljs-number"><span class="hljs-number">4</span></span><font></font>
gpio.mode(led1, gpio.OUTPUT)<font></font>
gpio.mode(led2, gpio.OUTPUT)<font></font>
restart=<span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led1, gpio.HIGH);<font></font>
gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led2, gpio.HIGH);<font></font>
<font></font>
<font></font>
t=<span class="hljs-number"><span class="hljs-number">0</span></span>
tmr.alarm(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> t=t+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> t&gt;<span class="hljs-number"><span class="hljs-number">999</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> t=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)<font></font>
<font></font>
srv=net.createServer(net.TCP, <span class="hljs-number"><span class="hljs-number">1000</span></span>)<font></font>
srv:listen(<span class="hljs-number"><span class="hljs-number">80</span></span>,<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(conn)</span></span></span></span>
    conn:on(<span class="hljs-string"><span class="hljs-string">"receive"</span></span>,<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(client,request)</span></span></span></span>
    <span class="hljs-comment"><span class="hljs-comment">--      _GET</span></span>
            <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> buf = <span class="hljs-string"><span class="hljs-string">""</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> _, _, method, <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>, vars = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">find</span></span>(request, <span class="hljs-string"><span class="hljs-string">"([A-Z]+) (.+)?(.+) HTTP"</span></span>);
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(method == <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
            _, _, method, <span class="hljs-built_in"><span class="hljs-built_in">path</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">find</span></span>(request, <span class="hljs-string"><span class="hljs-string">"([A-Z]+) (.+) HTTP"</span></span>);
        <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> _GET = {}
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (vars ~= <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
            <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k, v <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">gmatch</span></span>(vars, <span class="hljs-string"><span class="hljs-string">"(%w+)=(%w+)&amp;*"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span><font></font>
                _GET[k] = v<font></font>
            <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>
    <span class="hljs-comment"><span class="hljs-comment">--    </span></span>
       <span class="hljs-comment"><span class="hljs-comment">--    &lt;html&gt;&lt;body&gt;,      \</span></span>
   <span class="hljs-comment"><span class="hljs-comment">--        \,  &lt;/body&gt;&lt;/html&gt;</span></span>
    conn:send(<span class="hljs-string"><span class="hljs-string">'HTTP/1.1 200 OK\r\nConnection: keep-alive\r\nCache-Control: private, no-store\r\n\r\n\
   &lt;!DOCTYPE HTML&gt;\
&lt;html&gt;\
 &lt;head&gt;\
        &lt;meta charset="UTF-8" /&gt;\
        &lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt; \
        &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt; \
        &lt;title&gt;My control&lt;/title&gt;\
   &lt;/head&gt;&lt;body&gt;\
        &lt;div class="container"&gt;\
            &lt;section class="color-1"&gt;\
                &lt;p&gt;\
                    &lt;a href=\"?pin=ON1\"&gt;&lt;button class="btn btn-4 btn-4a"&gt;Back ON&lt;/button&gt;&lt;/a&gt;\
                    &lt;a href=\"?pin=ON2\"&gt;&lt;button class="btn btn-4 btn-4a"&gt;Bra ON&lt;/button&gt;&lt;/a&gt;\
                &lt;/p&gt;\
                &lt;p&gt;\
                    &lt;a href=\"?pin=OFF1\"&gt;&lt;button class="btn btn-5 btn-5a"&gt;Back OFF&lt;/button&gt;&lt;/a&gt;\
                    &lt;a href=\"?pin=OFF2\"&gt;&lt;button class="btn btn-5 btn-5a"&gt;Bra OFF&lt;/button&gt;&lt;/a&gt;\
                &lt;/p&gt;\
            &lt;/section&gt;\
        &lt;/div&gt;\
&lt;/body&gt;&lt;/html&gt;'</span></span>)
    <span class="hljs-comment"><span class="hljs-comment">--  </span></span>
    <span class="hljs-comment"><span class="hljs-comment">--    </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> _on,_off = <span class="hljs-string"><span class="hljs-string">""</span></span>,<span class="hljs-string"><span class="hljs-string">""</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_GET.pin == <span class="hljs-string"><span class="hljs-string">"ON1"</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
              gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led1, gpio.LOW);
        <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(_GET.pin == <span class="hljs-string"><span class="hljs-string">"OFF1"</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
              gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led1, gpio.HIGH);
        <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(_GET.pin == <span class="hljs-string"><span class="hljs-string">"ON2"</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
              gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led2, gpio.LOW);
        <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>(_GET.pin == <span class="hljs-string"><span class="hljs-string">"OFF2"</span></span>)<span class="hljs-keyword"><span class="hljs-keyword">then</span></span>
              gpio.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(led2, gpio.HIGH);
        <span class="hljs-keyword"><span class="hljs-keyword">end</span></span><font></font>
        <font></font>
  <font></font>
              <font></font>
    conn:on(<span class="hljs-string"><span class="hljs-string">"sent"</span></span>,<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(conn)</span></span></span></span> conn:<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)
    <span class="hljs-built_in"><span class="hljs-built_in">collectgarbage</span></span>();<font></font>
<font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)<font></font>
    <font></font>
<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)<font></font>
<font></font>
#========================================<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas pu retrouver le lien vers la source. </font><font style="vertical-align: inherit;">Mais le schéma est simple: à Lolin on connecte le relais 1 et le relais 2 aux sorties D3 et D4 ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">led1 = 3 led2 = 4</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Ensuite, nous allons à l'adresse IP émise par notre routeur et voyons la page: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ad8/e8b/2f5/ad8e8b2f561146fa89068727784382eb.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À mon grand regret, je n'ai pas encore compris comment apporter de la beauté, par exemple, pour connecter un fichier de style CSS. </font><font style="vertical-align: inherit;">La question est dans l'utilisation de fichiers individuels lors de l'affichage de la page, et non dans la définition du style. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'espère vraiment que ces informations seront utiles à au moins une personne. </font><font style="vertical-align: inherit;">Et ne jugez pas strictement pour le premier article.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les références</font></font></h4><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esp8266.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - une ressource très complète sur ESP8266</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clignotant NodeMcu (clignotant ESP8266)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Constructeur NodeMcu</font></font></a></li>
<li><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pilote CH340</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (pour Windows)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Article " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESP8266 - Connexion et mise à jour du firmware</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AI-THINKER-IOT-2014-10-17 165528.bin</a> —    </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ESplorer</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    DS18B20   </a></li>
<li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">homes-smart</a></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr394535/">https://habr.com/ru/post/fr394535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr394519/index.html">Android reconnaîtra le propriétaire par des données biométriques au lieu de mots de passe</a></li>
<li><a href="../fr394521/index.html">Автономные грузовики размажут наше общество по асфальту</a></li>
<li><a href="../fr394523/index.html">Cet été, les États-Unis procéderont à des essais en mer du railgun</a></li>
<li><a href="../fr394529/index.html">Le scanner de ville Half-Life 2 est devenu une réalité</a></li>
<li><a href="../fr394531/index.html">Encore une fois sur le dessin sur l'écran de l'oscilloscope</a></li>
<li><a href="../fr394537/index.html">Nous fabriquons une fraiseuse à commande numérique à trois axes</a></li>
<li><a href="../fr394539/index.html">Menace d'Internet: pourquoi les analystes de Wall Street considèrent Airbnb comme le «tueur» de l'hôtellerie</a></li>
<li><a href="../fr394541/index.html">Plus de bricolage aux dieux DIY</a></li>
<li><a href="../fr394543/index.html">Quand la taille compte: Mi Max et d'autres nouveaux produits de XIAOMI</a></li>
<li><a href="../fr394545/index.html">Rudolf Svorenu - 89! Comment le livre "Electronics Step by Step" - a changé la vie des gens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>