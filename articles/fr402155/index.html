<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé≥ ü§∂üèª üßë Variateur puissant √† quatre canaux pour LED üè™ üï¥üèΩ üóÇÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je vais parler du projet d'un puissant gradateur √† quatre canaux pour bandes et lampes LED (jusqu'√† 200 watts de puissance totale, 5...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Variateur puissant √† quatre canaux pour LED</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/402155/">  Dans cet article, je vais parler du projet d'un puissant gradateur √† quatre canaux pour bandes et lampes LED (jusqu'√† 200 watts de puissance totale, 50..100 watts par canal) avec une fr√©quence √©lev√©e de r√©gulation PWM (1 kilohertz avec une profondeur de couleur de 10 bits), pour un √©clairage de haute qualit√© .  De plus, il poss√®de une entr√©e pour le capteur de lumi√®re, des fonctions de r√©troaction (d√©livrant au contr√¥leur des informations sur la tension d'entr√©e, la tension aux entr√©es de mesure, etc.) et m√™me une isolation galvanique du port de contr√¥le s√©rie. <br><br><img src="https://habrastorage.org/files/34a/40c/43c/34a40c43cea94d2c86d0a577633c5993.JPG"><br><a name="habracut"></a><br>  Il se trouve que j'ai d√©cid√© de changer de profil et de m'occuper des microcontr√¥leurs et de l'automatisation, et apr√®s quelques mois, j'ai re√ßu une offre tentante de faire une ¬´maison intelligente¬ª en R√©publique dominicaine, de sorte que presque tous les aspects de la vie d'une assez grande villa de trois grandes sont g√©r√©s et automatis√©s. b√¢timents, de l'√©clairage et du climat, aux robots de jardin et aux syst√®mes d'irrigation.  Comme j'√©tais fatigu√© de la neige et du gel pendant longtemps, il √©tait impossible de rejeter une telle offre, d'autant plus qu'ils m'ont beaucoup aid√© √† bouger et √† m'adapter. <br><br>  Bien s√ªr, l'une des t√¢ches les plus cruciales consiste √† contr√¥ler l'√©clairage, √† la fois dans de nombreuses pi√®ces et √† l'ext√©rieur.  Afin d'√©conomiser l'√©nergie qui est ch√®re ici, les bandes LED et les lampes 12 volts seront utilis√©es presque partout, qui doivent √™tre contr√¥l√©es √† l'aide de gradateurs.  Les mod√®les de gradateurs existants n'√©taient pas tr√®s satisfaisants √† tous √©gards (une fr√©quence de r√©gulation suffisamment √©lev√©e, pour l'absence de scintillement; puissance, pour contr√¥ler de longues bandes lumineuses ou des lampes / spots; protocoles d'√©change ferm√©s, etc.).  J'ai donc d√©cid√© de faire mon gradateur. <br><br>  Un point tr√®s sensible au stade de la conception a √©t√© le choix d'obtenir une alimentation basse tension √† partir de 110 volts de courant alternatif.  Nous avons m√™me envisag√© une version exotique avec un abaisseur sans transformateur imm√©diatement jusqu'√† 12 volts, mais pour des raisons de s√©curit√© √©lectrique et d'incendie, elle a √©t√© rejet√©e.  Les alimentations pr√™tes √† l'emploi 110-&gt; 12 n'√©taient pas si ch√®res (20 $ pour 120 watts et 40 $ pour 200), bien que dans l'ensemble.  Mais, heureusement, il y avait beaucoup d'espace pour l'√©quipement, alors j'ai opt√© pour cette option. <br><br>  Le circuit s'est av√©r√© relativement simple (√† l'exception du n≈ìud d'isolation galvanique du port s√©rie sur quatre optocoupleurs) - le microcontr√¥leur STM32F030F4P6, deux pilotes MOSFET ADP3624 et les transistors √† cl√© IRLB8748, s√©lectionn√©s avec une grande marge (avec une charge de 100 watts par canal - ils √©taient √† peine chauds) , plus un module abaisseur puls√© chinois pr√™t √† l'emploi √† 3,3 volts.  Les pilotes s√©lectionn√©s vous permettent de contr√¥ler √† des fr√©quences allant jusqu'√† m√©gahertz, ce qui donne la fr√©quence de la tension de sortie en kilohertz, avec un pas PWM d'une microseconde.  En pratique, m√™me un mode avec une fr√©quence PWM de huit kilohertz et un pas de 125 nanosecondes a √©t√© test√©, mais en pratique, une fr√©quence d'ajustement aussi √©lev√©e menace une certaine instabilit√© √† la sortie - les transistors peuvent simplement ne pas avoir le temps de se fermer si rapidement et la qualit√© de l'ajustement ¬´flottera¬ª. <br><br> <a href=""><img src="https://habrastorage.org/files/066/0b3/8bb/0660b38bbd6f408894a90839f6ce3407.png" width="900"></a> <br><br>  Le c√¢blage de la carte pour des courants aussi √©lev√©s √©tait un d√©fi assez difficile pour moi, je n'avais jamais rencontr√© de telles t√¢ches auparavant.  Il a √©t√© d√©cid√© de les rendre aussi larges que possible (un conducteur d'une largeur d'au moins 10 mm sur une couche de 70 microns de cuivre), et lorsque cela n'est pas possible, utiliser la deuxi√®me couche, en les combinant avec un grand nombre de vias.  J'ai retir√© le masque des conducteurs √† haute charge afin que, si n√©cessaire, un bus en cuivre puisse √™tre appliqu√© sur le dessus (mais cela n'√©tait pas n√©cessaire, m√™me avec une charge maximale de 200 watts - la carte chauffe jusqu'√† √† peine 40 degr√©s dans un bo√Ætier ferm√©). <br><br>  Le protocole d'√©change, faute de m√©moire flash, a √©t√© choisi extr√™mement simple, les commandes sont envoy√©es ligne par ligne, sous la forme du texte "0: 512" (canal z√©ro, PWM 512), les donn√©es de sortie sont transmises de la m√™me mani√®re (tension, donn√©es de la premi√®re photor√©sistance, donn√©es de la deuxi√®me photor√©sistance, tension d'entr√©e √† l'entr√©e ADC3, tension d'entr√©e √† l'entr√©e ADC5, tension d'alimentation du contr√¥leur, temp√©rature de la puce).  Il serait plus correct d'utiliser le protocole MQTT, mais j'avais peur qu'il ne rentre pas dans le flash (les kilo-octets d'espace libre restaient sur 16). <br><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source sur github</a> <br><br>  Un variateur est flash√© via le m√™me port de contr√¥le (vous devez appliquer une unit√© √† la 4e broche, puis une impulsion √† la 5e, apr√®s quoi le microcontr√¥leur peut √™tre charg√© en utilisant le protocole s√©rie standard STM32. Pour contr√¥ler un gradateur d√©j√† flash√©, trois fils suffisent, + 3,3 / + 5 V sur la premi√®re broche, les donn√©es sur la troisi√®me, sur la sixi√®me - la terre.Les param√®tres du port de contr√¥le dans le firmware sont 38400 bauds, 8n1. <br><br>  Bien s√ªr, la premi√®re version du variateur n'√©tait pas sans d√©fauts.  Il s'est av√©r√© qu'un condensateur de 470 microfarads par 12 volts ne suffit pas, il chauffe trop avec une charge lourde (surtout si les fils de l'alimentation sont minces pour de tels courants), nous devons en ajouter quelques-uns plus puissants (en fonction du courant maximal autoris√©).  Le module d'alimentation chinois s'est √©galement av√©r√© √™tre une solution infructueuse, l'un des modules a √©chou√© pendant les tests sans aucune raison apparente, je le remplacerai par un convertisseur sur TPS62177, en plus j'ajouterai √©galement un autre convertisseur optionnel sur AP1501 (24-&gt; 12), pour le cas de l'alimentation du variateur √† partir de 24 volts.  Eh bien, vous aurez besoin d'un circuit de commande pour un ventilateur de 120 mm pour l'alimentation (dans les cas o√π la charge est proche du maximum), avec contr√¥le thermique et r√©glable en continu.  J'ai √©galement d√©cid√© de remplacer l'isolement galvanique complexe du port de contr√¥le par la puce SI8641. <br><br>  Il y a des probl√®mes dans la partie logicielle - parfois la lecture depuis le port s√©rie se bloque, le contr√¥le du blocage (l'exp√©rience avec STM32 n'est pas encore tr√®s grande pour moi), et le protocole s'est av√©r√© trop idiot, j'essaierai peut-√™tre de remplir un MQTT normal l√†-bas. <br><br>  Voici un exemple d'utilisation d'un gradateur sur un banc d'essai (ma porte d'entr√©e), avec un capteur de distance IR (la couleur et la luminosit√© de la bande RGBW sont r√©glables, en fonction de la distance, via openhab): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/knXuq3a6p4M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Dans le prochain article, je parlerai d'une unit√© de commutation √† quatre canaux de charges CA de huit kilowatts avec des relais bistables (pour r√©duire l'√©nergie consomm√©e en vain) en mesurant la consommation de courant sur chaque canal. <br><br>  Eh bien, je vais terminer sur une note positive.  Il s'est av√©r√© qu'en R√©publique dominicaine, 99% d'alcool isopropylique ou √©thylique ne peuvent pas √™tre trouv√©s pour laver les circuits imprim√©s (et aussi l'essence pure).  Vous pouvez trouver 70% m√©lang√© √©videmment pas avec de l'eau distill√©e, laissant des taches.  Et vous pouvez toujours facilement trouver 99,6% de m√©thyle (je ne sais pas pourquoi ils le vendent du tout, c'est m√™me effrayant de l'utiliser comme solvant - vous pouvez respirer par paires).  J'ai d√©cid√© d'essayer de rincer la premi√®re carte de gradateur avec de l'eau distill√©e, que j'ai achet√©e dans un magasin d'articles m√©nagers.  Heureusement, je n'ai pas r√©alis√© l'id√©e de v√©rifier la qualit√© du distillat pour le go√ªt.  Mais le circuit imprim√© et l'√©vier galvanis√© n'aimaient vraiment pas quand je les versais avec de l'√©lectrolyte de batterie (des bouteilles d'eau se tenaient sur l'√©tag√®re avec, √©videmment j'ai attrap√© le mauvais quand je l'ai mis dans le panier) ... <br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr402155/">https://habr.com/ru/post/fr402155/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr402145/index.html">Poursuivant le th√®me ¬´Cancer. Que faire avec √ßa ... "</a></li>
<li><a href="../fr402147/index.html">IBM a enregistr√© un seul bit d'information dans un atome</a></li>
<li><a href="../fr402149/index.html">Intel XMM 7560 - Gigabit Over the Air</a></li>
<li><a href="../fr402151/index.html">Notaire num√©rique Blockchain: Emercoin DPO Antifake</a></li>
<li><a href="../fr402153/index.html">"On trie" la maison imprim√©e</a></li>
<li><a href="../fr402157/index.html">Chris Kaspersky est d√©c√©d√©. En m√©moire d'un vrai hacker</a></li>
<li><a href="../fr402159/index.html">Classement en f√©vrier des d√©veloppements scientifiques les plus m√©diatiques</a></li>
<li><a href="../fr402161/index.html">Les √©diteurs de logiciels corrigent massivement les vuln√©rabilit√©s utilis√©es par la CIA</a></li>
<li><a href="../fr402163/index.html">Mise √† jour de l'histoire de Steve Jobs</a></li>
<li><a href="../fr402165/index.html">Le plus grand ¬´d√¥me¬ª de la science d'Istra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>