<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐩 ♣️ 🚩 Membuat prototipe game seluler, mulai dari mana, dan bagaimana melakukannya. Bagian 3 (final) 🤽🏽 👋🏼 ☎️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada bagian pertama saya berbicara tentang mengapa membuat prototipe dan secara umum di mana untuk memulai 
 - Bagian 1 

 Di bagian kedua, sedikit di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membuat prototipe game seluler, mulai dari mana, dan bagaimana melakukannya. Bagian 3 (final)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453748/">  Pada bagian pertama saya berbicara tentang mengapa membuat prototipe dan secara umum di mana untuk memulai <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 1</a> <br><br>  Di bagian kedua, sedikit dijalankan melalui kelas utama <br>  dan arsitektur - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian 2</a> <br><br>  Dan bagian ketiga - ini sebenarnya akan memiliki sedikit diskusi, kita akan menganalisis bagaimana pengubah bekerja, dan jatuh di lapangan (ini tidak sulit, tetapi ada nuansa).  Dan sedikit tentang arsitektur, saya akan coba tanpa kebosanan. <br><br>  Tangkapan layar tentang roket pada umumnya membosankan, jadi saya sarankan menonton video prototipe lain, yang dirakit dalam 2 minggu bersama dengan gambar, dan ditinggalkan karena fakta bahwa dalam genre platformer tidak ada jalan lain.  Ngomong-ngomong, ini adalah salah satu ide kunci di sekitar prototipe - untuk berkumpul, melihat apakah ini omong kosong, apakah itu perlu?  Dan dengan jujur ​​lemparkan keranjang jika jawabannya tidak meyakinkan Anda.  Tapi!  Ini tidak berlaku untuk proyek-proyek kreatif - kadang-kadang kreativitas terjadi demi kreativitas). <br><br>  Jadi vidosik, Anda perlu melihat teks yang disusun berdasarkan level, dan bukan pada gameplay): <br><iframe width="560" height="315" src="https://www.youtube.com/embed/lY8e1igkzI0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><br><h3>  Penyimpangan kecil </h3><br>  Dalam artikel terakhir, saya menerima kode ulasan dan berterima kasih untuk ini, kritik membantu untuk mengembangkan bahkan jika Anda tidak setuju dengan itu. <br><br>  <b>Tapi saya ingin menggunakan untuk arsitektur dan sintaksis mengenai prototipe:</b> <br><ol><li>  Tidak peduli seberapa kerennya Anda, Anda tidak dapat memperkirakan bahwa itu tidak akan digadaikan, dan akan ada banyak yang digadaikan dari apa yang tidak diperlukan.  Karena itu, dalam hal apa pun, refactoring atau ekspansi akan diperlukan.  Jika Anda tidak dapat menggambarkan manfaat spesifik dari kode / pendekatan, lebih baik tidak menghabiskan banyak waktu untuk kode ini. </li><li>  Mengapa menurut saya OOP / Model Acara / Komposisi lebih mudah untuk prototipe daripada ECS, Unity COOP, DI FrameWorks, Kerangka Reaktif, dll.  Lebih sedikit coretan, semua koneksi terlihat dalam kode, karena tugas utama prototipe adalah menjawab pertanyaan utama - apakah mungkin untuk memainkannya, dan sejumlah yang sekunder - yang lebih baik untuk gameplay, ini atau itu.  Karena itu, Anda perlu mengimplementasikan fungsi yang diperlukan secepat mungkin.  Mengapa memperkenalkan kerangka kerja pada proyek kecil, meresepkan semua sampah untuk mengimplementasikan tiga entitas game?  Masing-masing sebenarnya adalah kelas 50-100 baris.  Arsitektur harus dipikirkan sebagai bagian dari tugas prototipe, dan sebagai bagian dari kemungkinan perluasan ke alpha, tetapi yang kedua diperlukan lebih di kepala daripada di kode, sehingga Anda tidak membakar ketika menambahkan kode </li></ol><br><br><h3>  Tentang pengubah: </h3><br>  <b>Dan akhirnya tentang modifikator itu sendiri:</b> <br>  Di sini dan sebelumnya, saya menyebut pengubah medan gaya yang disentuh roket dan yang memengaruhi jalurnya, dalam prototipe ada dua jenisnya - akselerasi dan defleksi. <br><br><div class="spoiler">  <b class="spoiler_title">Kelas pengubah</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PushSideModificator</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] TypeOfForce typeOfForce = TypeOfForce.Push; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> force; [SerializeField] DropPanelConfig dropPanelConfig; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> boundsOfCollider; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerEnter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ boundsOfCollider = other.bounds.extents.x; GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { TypeOfForce = typeOfForce, Force = force, ColliderBound = boundsOfCollider, CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); } }</code> </pre> <br></div></div><br>  Ini adalah kelas yang sangat sederhana yang tugasnya melewati dua peristiwa: <br><ol><li>  Entri pemain ke lapangan (yang sebenarnya merupakan pemicu persatuan fisik), dan semua konteks yang diperlukan - jenis pengubah, posisinya, ukuran collider, kekuatan pengubah, dan sebagainya.  Dalam hal ini ditambah acara agregator, ia dapat menyampaikan konteks apa pun kepada pihak yang berkepentingan.  Dalam nada ini, ini adalah model roket yang memproses pengubah. </li><li>  Acara kedua - pemain meninggalkan lapangan.  Untuk menghapus pengaruhnya pada lintasan pemain </li></ol><br>  <b>Untuk apa model acara?</b>  <b>Siapa lagi yang mungkin membutuhkan acara ini?</b> <b><br></b>  <b>Dalam proyek saat ini ini tidak diterapkan, tetapi:</b> <br><ol><li>  Akting suara (menerima peristiwa bahwa seseorang memasuki lapangan - kami memutar suara yang sesuai, seseorang keluar - sama halnya) </li><li>  Marker UI, katakanlah untuk setiap bidang kita akan menghapus beberapa bahan bakar dari roket, tooltips akan muncul bahwa kita memasuki lapangan dan kehilangan bahan bakar, baik, atau mendapatkan poin untuk setiap klik di lapangan, ada banyak pilihan antarmuka tertarik pemain masuk ke lapangan. </li><li>  Spesial  efek - ketika terkena dalam jenis bidang yang berbeda, efek yang berbeda dapat ditumpangkan, baik pada roket itu sendiri maupun pada ruang di sekitar roket / bidang.  Spesial  efek dapat ditangani oleh entitas / pengontrol terpisah, yang juga akan berlangganan acara dari pengubah. </li><li>  Ya, ini adalah kode minimum, pencari lokasi, agregasi, dependensi, dll. Tidak diperlukan. </li></ol><br><br><h3>  Dasar Gameplay </h3><br>  Dalam prototipe ini, inti dari gameplay adalah menempatkan pengubah di lapangan bermain, menyesuaikan jalur penerbangan roket, untuk terbang di sekitar rintangan dan mengenai titik / planet tujuan.  Untuk melakukan ini, kami memiliki panel di sebelah kanan, di mana ikon pengubah berada. <br><br><img src="https://habrastorage.org/webt/lj/eb/ga/ljebgar88u47kcyxyhz_6kzxyke.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Kelas Panel</b> <div class="spoiler_text"><pre> <code class="java hljs"> [RequireComponent (typeof(CanvasGroup))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DragAndDropModifiersPanel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifiersIcon iconPrfb; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropPanelConfig config; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.AddListener&lt;ButtonStartPressed&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, RocketStarted); canvasGroup = GetComponent&lt;CanvasGroup&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RocketStarted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ButtonStartPressed obj)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.DOFade(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); (canvasGroup.transform as RectTransform).DOAnchorPosX(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.Push); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.AddSpeed); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } } }</code> </pre> <br></div></div><br><br>  Mengantisipasi pertanyaan: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++)</code> </pre><br><br>  3 dan 1 - yang disebut angka ajaib yang hanya diambil dari kepala dan dimasukkan ke dalam kode, ini harus dihindari, tetapi mengapa mereka ada di sini?  Prinsip dimana panel kanan dibentuk belum pernah ditentukan, dan diputuskan hanya untuk menguji prototipe hanya dengan sejumlah pengubah pada prototipe. <br><br>  Bagaimana cara melakukannya dengan benar?  - setidaknya memasukkannya ke dalam bidang serializable, dan atur jumlah yang dibutuhkan melalui inspektur.  Mengapa saya terlalu malas dan Anda harus melakukannya?  Di sini kita harus melanjutkan dari gambaran besar, entitas terpisah dan konfigurasi masih akan bertanggung jawab untuk pembentukan jumlah pengubah yang diperlukan, jadi di sini saya terlalu malas mengharapkan banyak refactoring di masa depan.  Tapi lebih baik jangan malas!  ) <br><br>  Tentang konfigurasi - ketika kuliah pertama tentang ScriptableObject muncul, saya menyukai gagasan menyimpan data sebagai aset.  Anda mendapatkan data yang diperlukan di mana pun Anda membutuhkannya, tanpa terikat dengan turunan tunggal.  Lalu ada kuliah tentang pendekatan pengembangan game yang melibatkan ScriptableObject, di mana mereka dulu menyimpan pengaturan instance.  Sebenarnya preset / pengaturan dari sesuatu yang disimpan dalam aset adalah konfigurasi. <br><br>  <b>Pertimbangkan kelas konfigurasi:</b> <br><div class="spoiler">  <b class="spoiler_title">Kelas konfigurasi</b> <div class="spoiler_text"><pre> <code class="java hljs"> [CreateAssetMenu(fileName = <span class="hljs-string"><span class="hljs-string">"DropModifiersPanel"</span></span>, menuName = <span class="hljs-string"><span class="hljs-string">"Configs/DropModifier"</span></span>, order = <span class="hljs-number"><span class="hljs-number">2</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropPanelConfig</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ScriptableObject</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ModifierBluePrintSimple[] modifierBluePrintSimples; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DropModifier </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetModifierByType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TypeOfForce typeOfModifiers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modifierBluePrintSimples.FirstOrDefault(x =&gt; x.GetValue.TypeOfModifier == typeOfModifiers).GetValue; } } [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br></div></div><br><br>  Apa esensi dari karyanya?  Ini menyimpan kelas data pengubah disesuaikan. <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br><br>  Jenis pengubah diperlukan untuk identifikasi, ikon untuk antarmuka, mode game dari objek game pengubah, materi di sini sehingga dapat diubah selama konfigurasi.  Pengubah mungkin sudah terletak di lapangan bermain, dan katakanlah perancang permainan mengubah tipenya, sekarang ia memberikan akselerasi, init pengubah dari konfigurasi dan memperbarui semua bidang, termasuk materi, menurut jenis pengubah ini. <br><br>  Bekerja dengan konfigurasi sangat sederhana - kita beralih ke konfigurasi untuk data untuk tipe tertentu, kita mendapatkan data ini, pengaturan visual dan kemungkinan intim dari data ini. <br><br>  <b>Di mana untungnya?</b> <br>  Keuntungannya adalah fleksibilitas yang sangat besar, misalnya, Anda ingin mengubah materi dan ikon pada pengubah akselerasi, atau katakanlah untuk mengganti seluruh proyek game.  Alih-alih menulis ulang dan meneruskan ke bidang inspektur, kami hanya mengubah data ini dalam satu konfigurasi dan voila - semuanya akan diperbarui bersama kami, di semua adegan / level / panel. <br><br>  <b>Dan jika ada beberapa data untuk pengubah akselerator dalam konfigurasi?</b> <br>  Dalam prototipe, Anda dapat dengan mudah melacaknya secara manual sehingga data tidak digandakan, pada draft kerja, Anda perlu tes dan validasi data. <br><br><h3>  Dari ikon ke lapangan bermain </h3><br><div class="spoiler">  <b class="spoiler_title">Kelas Ikon Pengubah</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifiersIcon</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBeginDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IEndDragHandler</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Image icon; [Header(<span class="hljs-string"><span class="hljs-string">"       "</span></span>)] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RectTransform canvas; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifier currentModifier; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 startPoint; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 outV3; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameObject currentDraggedObj; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup = GetComponent&lt;CanvasGroup&gt;(); startPoint = transform.position; canvas = GetComponentInParent&lt;Canvas&gt;().transform as RectTransform; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropModifier dropModifier)</span></span></span><span class="hljs-function"> </span></span>{ icon.sprite = dropModifier.Icon; currentModifier = dropModifier; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnBeginDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ BlockRaycast(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); currentDraggedObj = Instantiate(currentModifier.Modifier, WorldSpaceCoord(), Quaternion.identity); GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BlockRaycast</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bool state)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.blocksRaycasts = state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ Vector2 outV2; RectTransformUtility.ScreenPointToLocalPointInRectangle(canvas, Input.mousePosition, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, out outV2); transform.position = canvas.transform.TransformPoint(outV2); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentDraggedObj != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) currentDraggedObj.transform.position = WorldSpaceCoord(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorldSpaceCoord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ RectTransformUtility.ScreenPointToWorldPointInRectangle(canvas, Input.mousePosition, Camera.main, out outV3); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outV3; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEndDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>) { Destroy(currentDraggedObj); transform.SetAsLastSibling(); canvasGroup.blocksRaycasts = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Destroy(gameObject); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct ImOnDragEvent { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool IsDragging; }</code> </pre><br></div></div><br><br>  <b>Apa yang sedang terjadi di sini?</b> <br>  Kami ambil ikon dari panel, di bawahnya kami membuat game blog pengubah itu sendiri.  Dan sebenarnya kami mengatur koordinat dari click / gerobak ke ruang permainan, jadi kami memindahkan pengubah di ruang permainan bersama dengan ikon di UI, dengan cara saya menyarankan Anda untuk membaca tentang RectTransformUtility, ini adalah kelas pembantu yang hebat di mana ada banyak fitur untuk antarmuka. <br><br>  Katakanlah kita berubah pikiran tentang menempatkan pengubah dan mengembalikannya ke panel, <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Sepotong kode ini memungkinkan kita untuk memahami apa yang ada di bawah klik.  Mengapa pengecekan layer juga ditunjukkan di sini?  Dan mengapa lagi adalah angka ajaib 5?  Seperti yang kita ingat dari bagian kedua, kita menggunakan grafik rakester tidak hanya untuk UI, tetapi juga untuk tombol yang ada di layar, juga jika kita menambahkan fungsionalitas untuk menghapus pengubah yang sudah ditempatkan di lapangan atau memindahkannya, maka mereka juga akan jatuh di bawah grafik rake, oleh karena itu ada juga pemeriksaan tambahan untuk milik lapisan UI.  Ini adalah lapisan default, dan urutannya tidak berubah, jadi angka 5 di sini umumnya bukan angka ajaib. <br><br>  Akibatnya, ternyata jika kita melepaskan ikon di atas panel, itu akan kembali ke panel, jika di atas lapangan bermain pengubah tetap di lapangan, ikon akan dihapus. <br><br>  1 hari kerja dihabiskan untuk kode prototipe.  Ditambah sedikit keributan pada file dan grafik.  Secara umum, gameplay ditemukan cocok, meskipun ada banyak pertanyaan tentang chip desain seni dan game.  Misi Selesai. <br><br><h3>  Kesimpulan dan rekomendasi </h3><br><ol><li>  Lay arsitektur minimal, tetapi arsitektur tetap </li><li>  Ikuti prinsip-prinsip dasar, tetapi tanpa fanatisme) </li><li>  Pilih solusi sederhana </li><li>  Antara keserbagunaan dan kecepatan - lebih baik memilih kecepatan untuk prototipe </li><li>  Untuk proyek besar / menengah, menyiratkan bahwa lebih baik untuk menulis ulang proyek dari awal.  Misalnya, sekarang tren di Unity adalah DOTS, Anda harus menulis banyak komponen dan sistem, itu buruk untuk jangka pendek, Anda kehilangan waktu, untuk jangka panjang - ketika semua komponen dan sistem terdaftar, ketika gain waktu dimulai.  Saya tidak berpikir itu keren untuk menghabiskan banyak waktu pada arsitektur yang sedang tren dan mencari tahu apa prototipnya. </li></ol><br>  Prototipe yang berhasil untuk semua. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id453748/">https://habr.com/ru/post/id453748/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id453730/index.html">Kedokteran gigi modern: implantasi gigi simultan dan perluasan tulang rahang melalui mata direktur teknis</a></li>
<li><a href="../id453732/index.html">Saya dari Moreinis. Pandangan miring atau rasa hormat?</a></li>
<li><a href="../id453734/index.html">Memperkenalkan Helm 3</a></li>
<li><a href="../id453742/index.html">Plugin memcached: NoSQL di MySQL</a></li>
<li><a href="../id453744/index.html">Kami mempelajari prinsip pseudo-class: not () menggunakan contoh tugas "Menyorot baris aktif tabel dalam CSS murni"</a></li>
<li><a href="../id453750/index.html">Tentang serangan cyber Baltimore baru-baru ini</a></li>
<li><a href="../id453756/index.html">Masalah metodologi saat ini untuk menentukan ancaman saat ini dari FSTEC</a></li>
<li><a href="../id453760/index.html">Kamp pelatihan sirkuit untuk tank dan prosesor</a></li>
<li><a href="../id453764/index.html">Amnesia sukarela: manipulasi hippocampal untuk menghilangkan ingatan yang menyakitkan</a></li>
<li><a href="../id453766/index.html">Software Defined Radio - bagaimana cara kerjanya? Bagian 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>