<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍹 🤢 👨🏿‍🤝‍👨🏻 Zen des tests unitaires 🖐️ 😏 🎒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La capacité à écrire de bons tests unitaires est une caractéristique importante de tout développeur. Mais comment comprendre que vos tests unitaires s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zen des tests unitaires</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439804/"><p><img src="https://habrastorage.org/webt/ih/ya/u6/ihyau61ji5s6cgg7f91-grwhr84.png"></p><br><p>  La capacité à écrire de bons tests unitaires est une caractéristique importante de tout développeur.  Mais comment comprendre que vos tests unitaires sont corrects?  Un bon test unitaire est comme un bon jeu d'échecs.  Dans notre cas, les échecs sont les approches que nous allons discuter dans ce post.  Il n'y a pas de meilleur joueur d'échecs dans une partie d'échecs car tout dépend des positions <em>(et d'un joueur)</em> .  De même, dans les tests unitaires, vous n'avez pas à distinguer une seule approche.  En d'autres termes, vous devez utiliser toutes les approches ensemble pour obtenir le meilleur résultat.  Donc, si vous voulez gagner ce jeu, alors bienvenue sous la coupe. </p><a name="habracut"></a><br><h2 id="dbut">  Débuts </h2><br><h3 id="why-should-i-write-unit-tests">  Pourquoi devrais-je écrire des tests unitaires? </h3><br><p>  Vous n'êtes pas obligé d'écrire des tests unitaires à moins que vous ne soyez une personne à perception extrasensorielle qui puisse écrire du code sans bogues, que vous ayez une super mémoire, que vous puissiez compiler votre code dans votre tête ou que vous aimez la douleur.  Sinon, vous devez absolument écrire des tests unitaires, car ils diminuent le nombre de bogues dans les fonctionnalités nouvelles et existantes, réduisent le coût et la peur de changer vos fonctionnalités et permettent de refactoriser votre code.  De plus, vous devez toujours exécuter les tests existants et je vous recommande de faire attention aux outils de test continu. </p><br><h3 id="what-to-test">  Que tester? </h3><br><p>  De toute évidence, dans le test unitaire, vous testez le comportement d'une unité distincte <em>(pas des invocations, car elles peuvent être modifiées ultérieurement)</em> .  Aussi, faites-en une règle pour couvrir avec des tests unitaires tous les bogues que vous avez trouvés pour prouver qu'ils sont corrigés.  Qu'en est-il de la couverture du code?  La couverture du code n'est pas un objectif, c'est juste une mesure qui vous aide à comprendre quelle partie de la logique vous avez oublié de couvrir avec des tests unitaires.  Ce serait une énorme erreur lorsque vous décidez de couvrir chaque ligne de code avec des tests unitaires. </p><br><h2 id="mittelspiel">  Mittelspiel </h2><br><h3 id="test-only-one-thing">  Testez une seule chose </h3><br><p>  Ne confondez pas les tests unitaires avec les tests d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">intégration</a> où tester plus d'une chose est normal.  L'idée des tests unitaires est de prouver qu'un module d'application séparé fonctionne ou non.  Vous devez comprendre facilement et certainement quel comportement dans votre code échoue et comment le corriger.  <strong>Combien d'assertions devez-vous utiliser?</strong>  <strong>Un!</strong>  L'utilisation de nombreuses assertions peut être l'odeur de code que vous testez plus d'une chose.  De plus, il est possible que quelqu'un ajoute une nouvelle assertion à votre test au lieu d'en écrire une autre.  Et comment pouvez-vous comprendre comment vos autres assertions se sont terminées lorsque la première a échoué? </p><br><h3 id="avoid-logic">  Évitez la logique </h3><br><p> Les bogues dans les tests sont les choses les plus difficiles à trouver pour les développeurs.  Les chances d'obtenir un bogue dans votre code de test augmentent à mesure que vous décidez d'ajouter de la logique à votre test.  Il devient plus difficile à lire, à comprendre et à maintenir.  L'utilisation de <code>for</code> , <code>foreach</code> , <code>if</code> , <code>switch</code> et d'autres opérateurs dans un test peut également être une odeur de code que vous testez plus d'une chose. </p><br><h3 id="aaa">  AAA </h3><br><p>  <strong>Arrange, Act, Assert</strong> est un modèle couramment utilisé qui aide à organiser votre code de test en trois phases en conséquence.  Il sépare clairement ce qui est testé des étapes de configuration et de vérification.  C'est l'une des meilleures pratiques et cela rend votre code de test plus lisible et plus facile à gérer.  Cela dit, n'utilisez pas les <strong>commentaires</strong> AAA dans vos tests si vous voulez garder votre code propre et lisible.  Le test créé avec compétence exprime l'idée AAA même sans commentaires. </p><br><h3 id="stick-to-the-naming-convention">  Respectez la convention de dénomination </h3><br><p>  Les noms des tests doivent être descriptifs et compréhensibles non seulement pour leur auteur.  Il existe de nombreuses stratégies de nommage de test, mais j'aime celle de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Roy Osherove</a> : <code>[MethodName_StateUnderTest_ExpectedBehavior]</code> .  Il contient toutes les informations nécessaires sur le test de manière formatée.  Il est facile de suivre cette stratégie pour tout développeur. </p><br><p>  Exemples: </p><br><pre> <code class="plaintext hljs">public void Sum_NegativeNumberAs2ndParam_ExceptionThrown () public void Sum_simpleValues_Calculated () public void Parse_OnEmptyString_ExceptionThrown() public void Parse_SingleToken_ReturnsEqualTokenValue ()</code> </pre> <br><p>  Mais faites attention à ce que vous ayez une convention de dénomination que vous devrez suivre sur votre projet actuel.  Ne les mélange pas. </p><br><h3 id="test-data-preparation">  Préparation des données de test </h3><br><p>  La construction de données de test peut apporter désordre et souffrance dans votre code de test.  Vous pouvez faire face à cette situation lorsque: </p><br><ul><li>  vous devez changer le constructeur de votre modèle dans chaque morceau de code où ce modèle est créé <em>(cela se produit généralement lorsque votre modèle est immuable)</em> ; </li><li>  vous avez beaucoup de doublons de code lors de la construction de vos données de test; </li><li>  vous devez passer beaucoup de "données magiques" dans votre constructeur de modèle <em>(par exemple, un <code>new Device("Stub", 10, true, "http");</code> )</em> ; </li><li>  vous avez le sentiment que vous devez créer une sorte de générateur de données aléatoires; </li><li>  il vous est difficile de créer des collections de données de tests. </li></ul><br><p>  Dans cet esprit, vous devez considérer quelques alternatives courantes: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mère d'objet</a> et [modèle de générateur Fluent].  Ces approches sont également de bons joueurs d'équipe, vous pouvez donc les utiliser ensemble. </p><br><p>  N'utilisez pas de données aléatoires, car votre test peut être sensible à certains types de valeurs.  En conséquence, vous pouvez obtenir un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">heisenbug</a> maléfique dans votre test, qui est difficile à trouver et à reproduire. </p><br><h3 id="learn-your-testing-framework">  Apprenez votre cadre de test </h3><br><p>  Découvrez tous les attributs, assertions et autres fonctionnalités de votre framework de test.  Il vous aide à rendre vos tests plus lisibles et élégants.  Par exemple, dans le framework <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NUnit</a> , vous pouvez utiliser deux modèles d'assertions et vous pouvez en choisir un qui vous plaît le plus: </p><br><pre> <code class="plaintext hljs">Assert.AreEqual(StatusCode.OK, response.StatusCode);</code> </pre> <br><p>  ou </p><br><pre> <code class="plaintext hljs">Assert.That(StatusCode.OK, Is.EqualTo(response.StatusCode));</code> </pre> <br><p>  N'oubliez pas les méthodes de configuration et de démontage, les attributs TestCase et Category, les assertions de collection.  Ne confondez pas les paramètres de résultats attendus et réels dans les assertions. </p><br><h2 id="endspiel">  Endspiel </h2><br><p>  Votre code de test a le même privilège que votre code de production que vous devez écrire et maintenir, n'oubliez pas les principes SOLID.  De plus, vos tests unitaires doivent être lisibles et il y a plusieurs raisons à cela.  Premièrement, l'intention de vos tests doit être compréhensible et claire.  Cela signifie que vous n'avez pas à perdre votre temps en lisant vos tests.  Deuxièmement, il devrait être facile de maintenir vos tests, de détecter et d'éliminer les problèmes sans débogage. </p><br><p>  Les tests unitaires sont une énorme philosophie qui ne peut être discutée dans un seul article.  Ici, j'ai expliqué les approches courantes et les questions fréquentes liées aux tests unitaires.  Si vous souhaitez approfondir, vous trouverez peut-être ces liens intéressants: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Blogue de Roy Osherove</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Livre de Roy Osherove, "L'art des tests unitaires"</a> </p><br><blockquote>  Restez calme et test unitaire </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439804/">https://habr.com/ru/post/fr439804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439788/index.html">Une autre bizarrerie dans les algorithmes GOST Grasshopper et Stribog</a></li>
<li><a href="../fr439790/index.html">Tester JaCarta WebClient ou stocker des jetons dans un coffre-fort</a></li>
<li><a href="../fr439792/index.html">La NASA recherche des partenaires dans l'industrie américaine pour créer un atterrissage habité partiellement réutilisable</a></li>
<li><a href="../fr439794/index.html">Douleurs dorsales - comprendre du point de vue de la médecine moderne</a></li>
<li><a href="../fr439796/index.html">Spring Boot 2: ce qu'ils n'écrivent pas dans les notes de version</a></li>
<li><a href="../fr439806/index.html">Noms de domaine SSL valides pour les conteneurs Docker locaux</a></li>
<li><a href="../fr439808/index.html">Les plus grands télescopes. De l'ordinateur portable et des yeux aux appareils photo 340 mégapixels et aux centres de données. Partie 1</a></li>
<li><a href="../fr439810/index.html">Découvrez le cadre du microservice Moleculer</a></li>
<li><a href="../fr439812/index.html">Approches Kaggle pour CV en prod: vous ne pouvez pas implémenter pour couper</a></li>
<li><a href="../fr439818/index.html">Caractéristiques des approches de conception dans le secteur manufacturier réel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>