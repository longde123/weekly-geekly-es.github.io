<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçé üîÅ üë©‚Äçüîß Software de emula√ß√£o de rede Modbus RTU üôÇ üßìüèº üîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introdu√ß√£o 
 Se voc√™ tem apenas um martelo como ferramenta, cada problema come√ßa a se parecer com um prego. 

 Abraham Maslow 
 O protocolo Modbus ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Software de emula√ß√£o de rede Modbus RTU</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409111/"><h1>  1. Introdu√ß√£o </h1><br><blockquote>  Se voc√™ tem apenas um martelo como ferramenta, cada problema come√ßa a se parecer com um prego. <br><br>  <i>Abraham Maslow</i> </blockquote><br>  O protocolo Modbus √© bem conhecido tanto pelos leitores Habr quanto pelos leitores hicktime.  Muitas publica√ß√µes foram dedicadas √† sua aplica√ß√£o, dif√≠ceis de listar porque s√£o muitas e, de tempos em tempos, novos artigos aparecem aqui e ali. <br><br><img src="https://habrastorage.org/webt/2m/xh/ry/2mxhryo9sblm6uzcf0srfxzqkkm.png"><br><br>  A popularidade deste protocolo √© devido √† sua abertura e simplicidade.  O escopo da aplica√ß√£o √© amplo o suficiente: de sistemas profissionais de automa√ß√£o industrial a projetos amadores de bricolage de sistemas de controle distribu√≠do, casas "inteligentes" e assim por diante.  Esse protocolo tamb√©m foi escolhido por mim quando minha equipe estava envolvida na cria√ß√£o de software para o simulador de trem.  O protocolo Modbus RTU na interface f√≠sica RS485 √© usado neste simulador para fornecer dados ao computador de controle dos controles montados no console do motorista (n√£o pense que o Modbus seja usado em material circulante real!). <br><br>  N√£o vale a pena falar sobre as dificuldades envolvidas na configura√ß√£o de software que interage com uma rede de controladores que controlam equipamentos.  Especialmente quando parte dos dispositivos j√° existe no ferro e a outra parte est√° em processo de desenvolvimento e fabrica√ß√£o.  Nesse caso, √© necess√°rio escrever um software de n√≠vel superior, levando em considera√ß√£o sua intera√ß√£o com esse hardware.  E √© aconselh√°vel escrev√™-lo de forma a criar uma vers√£o funcional do sistema imediatamente, sem o uso de ‚Äúmuletas‚Äù, sempre dif√≠ceis de limpar a partir do c√≥digo. <br><br>  "Voc√™ precisa escrever software quando os prot√≥tipos de trabalho de todo o hardware estiverem prontos", voc√™ diz, e voc√™ estar√° certo, mas ... ha ha ha, isso raramente acontece no mundo real.  E aqui os emuladores de software v√™m em nosso aux√≠lio. <br><a name="habracut"></a><br><h1>  1. Brevemente sobre Modbus RTU </h1><br>  N√£o falarei em detalhes sobre o protocolo.  Quem est√° interessado nos detalhes pode usar a pesquisa - o protocolo est√° aberto, sua especifica√ß√£o oficial e muitas informa√ß√µes est√£o dispon√≠veis na rede.  S√≥ posso dizer que no Modbus RTU ele descreve o formato bin√°rio dos dados transmitidos e usa o cabo de par tran√ßado padr√£o RS485 como meio de transmiss√£o.  O RS232 tamb√©m pode ser usado se a rede tiver um transmissor e um receptor, ou o RS422 para transmiss√£o de dados unidirecional. <br><br>  Estaremos interessados ‚Äã‚Äãno RS485, que √© uma interface half-duplex, que permite que apenas um dispositivo transmita dados por vez.  A arbitragem do barramento no Modbus √© realizada devido √† resist√™ncia do intervalo de sil√™ncio obrigat√≥rio de 3,5 caracteres a uma determinada velocidade de transmiss√£o.  Cada mensagem deve come√ßar e terminar com um intervalo de sil√™ncio.  H√° um dispositivo mestre na rede e v√°rios escravos (at√© 31 em um segmento de rede, sem o uso de repetidores).  Cada dispositivo escravo possui um identificador √∫nico (1 a 31).  A transmiss√£o de dados por escravos √© realizada apenas se o mestre enviou uma solicita√ß√£o para receber dados deste dispositivo. <br><br>  Uma solicita√ß√£o t√≠pica do assistente se parece com isso <br><br><table><tbody><tr><td>  ID </td><td>  C√≥digo de fun√ß√£o </td><td>  Endere√ßo de dados </td><td>  Quantidade de dados (2 bytes) </td><td>  Dados </td><td>  CRC16 </td></tr></tbody></table><br>  O CRC16 √© usado para controlar a integridade dos dados transmitidos.  O Modus usa a nota√ß√£o de representa√ß√£o de dados Big Endian: para valores de 2 bytes, o byte mais significativo da mensagem vem primeiro).  O protocolo usa quatro tipos de dados: <br><br><ol><li>  Bobinas - sa√≠das discretas (1 bit) de leitura / grava√ß√£o </li><li>  Entradas discretas - entradas discretas somente leitura (1 bit) </li><li>  Registros de reten√ß√£o - registros de sa√≠da (2 bytes) dispon√≠veis para leitura / grava√ß√£o </li><li>  Registradores de entrada - registradores de entrada (2 bytes) dispon√≠veis para leitura </li></ol><br>  Em resposta √† solicita√ß√£o, o escravo envia dados no seguinte formato <br><br><table><tbody><tr><td>  ID </td><td>  C√≥digo de fun√ß√£o </td><td>  A quantidade de dados em bytes </td><td>  Dados </td><td>  CRC16 </td></tr></tbody></table><br>  Uma mensagem recebida do mestre entra no buffer de recebimento de todos os dispositivos.  No entanto, se o primeiro byte do buffer de recebimento n√£o corresponder ao ID do dispositivo, ele ignorar√° os dados recebidos, limpando o buffer de recebimento.  Se a mensagem √© destinada a este dispositivo, ela forma uma resposta e, ap√≥s manter o intervalo de sil√™ncio, a envia ao mestre. <br><br>  Como se costuma dizer, simples, mas com bom gosto.  Voc√™ pode ler mais sobre tudo isso na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">especifica√ß√£o oficial do protocolo</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Leia</a> sobre m√©todos para implementar o protocolo na interface serial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  N√≥s n√£o nos reunimos aqui para isso. <br><br>  Ao desenvolver software de n√≠vel superior (mestre implementado com base em um PC, por exemplo) para uma rede assim, seria bom ter um conjunto de ferramentas de software que permitam implementar esse conceito <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/89b/944/3b5/89b9443b5fb11f04536782afce19be3d.png" alt="imagem"></div><br>  O significado deste esquema √© o seguinte.  Suponha que tenhamos uma parte dos dispositivos inclu√≠dos na rede futura.  Ou at√© agora n√£o existem tais dispositivos.  Mas h√° um desejo ardente de escrever software para o n√≠vel superior de gerenciamento, depur√°-lo, para que, quando a rede ainda estiver implementada em hardware, n√£o tenhamos que reescrever nada.  Para fazer isso, voc√™ precisar√° usar um meio de transmiss√£o f√≠sico, para o qual usamos um dispositivo semelhante a este <br><br><img src="https://habrastorage.org/webt/1x/cz/ja/1xczjafogu-dwd3qnetuijaszma.jpeg"><br><br>  Um dos adaptadores √© usado para conectar o software do assistente desenvolvido.  Outra √© conectar um emulador de uma futura rede de escravos.  Para a filial com um conector branco, conectamos a parte da rede que j√° est√° implementada no hardware.  Assim, temos a oportunidade de trabalhar com calma com o protocolo de comunica√ß√£o padr√£o, introduzindo gradualmente equipamentos reais em opera√ß√£o.  Al√©m disso, dando o objeto ao cliente, n√£o somos privados da oportunidade de modificar seu software em um ambiente confort√°vel de laborat√≥rio sem acesso ao objeto.  QSlave no diagrama √© exatamente a mesma parte da rede emulada pelo software.  Naturalmente, voc√™ deve escrever o software apropriado, feito pelo autor. <br><br><h1>  2. QSlave - emula√ß√£o de rede escrava </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O QSlave</a> √© um emulador de rede modbus RTU de plataforma cruzada aberto.  Voc√™ pode obt√™-lo sob a licen√ßa GPL v2.0 no Github no link acima. <br><br><img src="https://habrastorage.org/webt/4n/nd/am/4nndamsmf4i7ghnfrzzbbc94vqu.png"><br><br>  O aplicativo √© desenvolvido em C ++ usando a estrutura Qt.  O Qt, de um modo geral, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">possui bibliotecas para trabalhar com o Modbus</a> , mas os detalhes da tarefa - simular uma rede de escravos em vez de um √∫nico escravo, levaram ao fato de que as bibliotecas integradas do Qt para o Modbus n√£o foram usadas aqui.  Para processar os dados recebidos da porta serial virtual, foi criada uma biblioteca modbus auto-escrita.  O c√≥digo desta biblioteca √© implementado como um projeto separado, √© completamente independente da interface do usu√°rio e pode ser usado para conscientizar sobre simula√ß√µes de software com funcionalidades mais avan√ßadas.  Devido ao fato de a emula√ß√£o Modbus ser desconectada da interface do usu√°rio, a rede √© configurada usando arquivos de configura√ß√£o.  O formato XML foi escolhido (geralmente o usamos em nossos projetos).  Uma configura√ß√£o de amostra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√° dispon√≠vel no c√≥digo do projeto</a> .  Um conjunto de configura√ß√µes consiste em um arquivo principal com a extens√£o * .net, que se parece com isso <br><br>  <b>example.net</b> <br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Traffic light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  XML-  (  *.xml) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span>traffic-light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  e arquivos de configura√ß√£o XML para cada um dos escravos <br><br>  <b>traffic-light.xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>16<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Red signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Yellow signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Green signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Ready<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signal activity time<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signals count<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  O √∫ltimo arquivo cont√©m uma descri√ß√£o de todos os dados dispon√≠veis no dispositivo.  Para fazer o download da configura√ß√£o, √© necess√°rio abrir o arquivo * .net no menu do programa QSlave (Arquivo ‚Üí Abrir configura√ß√£o).  Todos os arquivos de configura√ß√£o devem estar no mesmo diret√≥rio.  A configura√ß√£o de exemplo descreve uma rede de um dispositivo escravo, um sem√°foro virtual, cujas sa√≠das discretas descrevem os sinais, uma entrada digital indica um pouco do dispositivo pronto para opera√ß√£o (Pronto), o registro de entrada relata o n√∫mero de sinais de tr√°fego e o registro de sa√≠da define o tempo durante o qual est√° ligado cada um dos sinais. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fea/def/3a4/feadef3a4c17567d127543ee0954b561.png" alt="imagem"><br><br>  Naturalmente, este simulador n√£o simula a l√≥gica interna do dispositivo.  Permite apenas definir os valores das c√©lulas de mem√≥ria dispon√≠veis para o mestre.  Qualquer um dos valores pode ser definido a seu crit√©rio, editando a c√©lula correspondente na tabela. <br><br>  Por toda a sua simplicidade, este software nos ajuda a trabalhar no software do simulador (que j√° foi comissionado) sem sair do laborat√≥rio. <br><br><img src="https://habrastorage.org/webt/qh/9j/ba/qh9jba49bbzglh5ca1t2nryin9a.png"><br><br>  Mas ningu√©m diz que voc√™ n√£o pode criar um emulador mais avan√ßado que simule a opera√ß√£o de dispositivos de rede virtual.  Para cri√°-lo, voc√™ pode usar o c√≥digo da biblioteca modbus dispon√≠vel no pacote QSlave. <br><br><h1>  3. QMaster - emula√ß√£o do dispositivo principal </h1><br>  Para criar escravos, depure seu firmware, voc√™ precisa de uma simula√ß√£o de assistente.  Existem v√°rios emuladores abertos, como, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">QModbus</a> .  N√≥s o usamos em nosso trabalho, at√© que decidimos aumentar a taxa de transfer√™ncia de dados para 250 kBit / s.  O QModbus n√£o permite isso.  Foi poss√≠vel reconstru√≠-lo a partir das fontes do Linux, mas nossos engenheiros eletr√¥nicos est√£o sentados no Windows e onde a montagem n√£o foi realizada por v√°rios motivos.  Acontece que este aplicativo est√° escrito no Qt 4, usa uma biblioteca libmodbus de terceiros.  Eu queria ter uma solu√ß√£o multiplataforma no Qt5, especialmente porque o Qt5 j√° funciona com o Modbus pronto para uso.  Portanto, seu an√°logo foi escrito usando a pilha da biblioteca Qt Modbus - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">QMaster</a> .  Tamb√©m est√° dispon√≠vel no Github nas mesmas condi√ß√µes. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a13/5fa/5b2/a135fa5b2781d646d18010960defd69d.png" alt="imagem"><br><br><h1>  Conclus√£o </h1><br>  Concluindo, direi que trabalho (no trabalho) principalmente em projetos fechados.  No entanto, as ferramentas descritas foram desenvolvidas por mim pessoalmente por minha pr√≥pria iniciativa no meu tempo livre.  Al√©m disso, eles, na vers√£o Windows, est√£o estaticamente vinculados ao c√≥digo Qt GPL, portanto, devo transmiti-los √† comunidade nas mesmas condi√ß√µes que o Qt recebeu.  Al√©m disso, essas ferramentas podem ser √∫teis para o leitor. <br><br>  Obrigado pela aten√ß√£o! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt409111/">https://habr.com/ru/post/pt409111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt409099/index.html">O que dar para o Ano Novo? Problem 2017</a></li>
<li><a href="../pt409101/index.html">Maneiras cient√≠ficas de superar a fadiga: nootr√≥picos, caf√© e neurotecnologia</a></li>
<li><a href="../pt409103/index.html">Crispr Therapeutics planeja primeiros ensaios cl√≠nicos para tratamento de doen√ßas gen√©ticas</a></li>
<li><a href="../pt409105/index.html">As maiores criptomoedas, seus resultados e por que o NiceHash n√£o roubou em casa</a></li>
<li><a href="../pt409107/index.html">Programar e transmitir dados para o Arduino atrav√©s do ar usando o ESP8266. Parte Tr√™s. Ol√°, ANDROID</a></li>
<li><a href="../pt409113/index.html">Um pouco, mas agrad√°vel: um copo que regula a temperatura da bebida</a></li>
<li><a href="../pt409115/index.html">Trilhas sonoras de jogos de culto: pestil√™ncia, utopia e machados de gelo</a></li>
<li><a href="../pt409119/index.html">Intel ‚ùÑ 2017. Resultados do ano</a></li>
<li><a href="../pt409121/index.html">O que √©: o mercado russo de servi√ßos de streaming</a></li>
<li><a href="../pt409123/index.html">Como fazer um sintetizador conveniente com suas pr√≥prias m√£os</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>