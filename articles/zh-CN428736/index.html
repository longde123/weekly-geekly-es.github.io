<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›¢ï¸ ğŸ¤²ğŸ¾ ğŸ§• å°†Retrofit 2.xç”¨ä½œRESTå®¢æˆ·ç«¯-æ•™ç¨‹ ğŸ§‘ğŸ¿â€ğŸ¤â€ğŸ§‘ğŸ¼ ğŸ¤˜ ğŸ¤·ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1.æ”¹é€  
 1.1ã€‚ ä»€ä¹ˆæ˜¯ç¿»æ–°ï¼Ÿ 
 Retrofitæ˜¯Javaå’ŒAndroidçš„RESTå®¢æˆ·ç«¯ã€‚ é€šè¿‡åŸºäºRESTçš„WebæœåŠ¡ï¼Œå¯ä»¥è½»æ¾è·å–å’ŒåŠ è½½JSONï¼ˆæˆ–å…¶ä»–ç»“æ„åŒ–æ•°æ®ï¼‰ã€‚ åœ¨ç¿»æ–°ä¸­ï¼Œæ‚¨å¯ä»¥é…ç½®ç”¨äºåºåˆ—åŒ–æ•°æ®çš„è½¬æ¢å™¨ã€‚ é€šå¸¸ï¼ŒGSonç”¨äºJSONï¼Œä½†æ˜¯æ‚¨å¯ä»¥æ·»åŠ è‡ªå·±çš„è½¬æ¢å™¨æ¥å¤„ç†XMLæˆ–å…¶...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å°†Retrofit 2.xç”¨ä½œRESTå®¢æˆ·ç«¯-æ•™ç¨‹</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428736/"><h1>  1.æ”¹é€  </h1><br><h2>  1.1ã€‚ ä»€ä¹ˆæ˜¯ç¿»æ–°ï¼Ÿ </h2><br>  Retrofitæ˜¯Javaå’ŒAndroidçš„RESTå®¢æˆ·ç«¯ã€‚ é€šè¿‡åŸºäºRESTçš„WebæœåŠ¡ï¼Œå¯ä»¥è½»æ¾è·å–å’ŒåŠ è½½JSONï¼ˆæˆ–å…¶ä»–ç»“æ„åŒ–æ•°æ®ï¼‰ã€‚ åœ¨ç¿»æ–°ä¸­ï¼Œæ‚¨å¯ä»¥é…ç½®ç”¨äºåºåˆ—åŒ–æ•°æ®çš„è½¬æ¢å™¨ã€‚ é€šå¸¸ï¼ŒGSonç”¨äºJSONï¼Œä½†æ˜¯æ‚¨å¯ä»¥æ·»åŠ è‡ªå·±çš„è½¬æ¢å™¨æ¥å¤„ç†XMLæˆ–å…¶ä»–åè®®ã€‚  Retrofitå°†OkHttpåº“ç”¨äºHTTPè¯·æ±‚ã€‚ <a name="habracut"></a><br><br>  <em>æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·åˆ›å»ºåŸºäºJSONçš„Javaå¯¹è±¡ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">www.jsonschema2pojo.org</a>è¿™å¯¹äºä»ç°æœ‰JSONåˆ›å»ºå¤æ‚çš„Javaæ•°æ®ç»“æ„å¾ˆæœ‰ç”¨ã€‚</em> <em><br></em> <br><br><h2>  1.2ã€‚ ä½¿ç”¨æ”¹é€  </h2><br> è¦ä½¿ç”¨Retrofitï¼Œæ‚¨å°†éœ€è¦ä»¥ä¸‹ä¸‰ä¸ªç±»ï¼š <br><br><ul><li> ç”¨ä½œJSONæ¨¡å‹çš„æ¨¡å‹ç±» </li><li> è¯†åˆ«å¯èƒ½çš„HTTPæ“ä½œçš„æ¥å£ </li><li>  Retrofit.Builderç±»æ˜¯ä½¿ç”¨Builderæ¥å£å’ŒAPIæ¥å®šä¹‰HTTPæ“ä½œçš„URLç«¯ç‚¹å®šä¹‰çš„å®ä¾‹ã€‚ </li></ul><br> æ¯ä¸ªæ¥å£æ–¹æ³•ä»£è¡¨ä¸€ä¸ªå¯èƒ½çš„APIè°ƒç”¨ã€‚ å®ƒå¿…é¡»å…·æœ‰HTTPæ³¨é‡Šï¼ˆGETï¼ŒPOSTç­‰ï¼‰ï¼Œä»¥æŒ‡ç¤ºè¯·æ±‚çš„ç±»å‹å’Œç›¸å¯¹URLã€‚ è¿”å›å€¼ä»¥é¢„æœŸçš„ç»“æœç±»å‹å®Œæˆäº†Callå¯¹è±¡ä¸­çš„å“åº”ã€‚ <br><br><pre><code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) Call&lt;List&lt;User&gt;&gt; getUsers();</code> </pre> <br> æ‚¨å¯ä»¥ä½¿ç”¨æ›¿æ¢å—å’ŒæŸ¥è¯¢å‚æ•°æ¥é…ç½®URLã€‚ ä½¿ç”¨{}å°†æ›¿æ¢å—é™„åŠ åˆ°ç›¸å¯¹URLã€‚ å¯¹æ–¹æ³•å‚æ•°ä½¿ç”¨@ Pathæ‰¹æ³¨ï¼Œæ­¤å‚æ•°çš„å€¼ç»‘å®šåˆ°ç‰¹å®šçš„æ›¿æ¢å—ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"users/{name}/commits"</span></span>) Call&lt;List&lt;Commit&gt;&gt; getCommitsByName(<span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"name"</span></span>) String name);</code> </pre> <br> ä½¿ç”¨@ Queryæ‰¹æ³¨å°†æŸ¥è¯¢å‚æ•°æ·»åŠ åˆ°æ–¹æ³•å‚æ•°ã€‚ å®ƒä»¬ä¼šè‡ªåŠ¨æ·»åŠ åˆ°URLçš„æœ«å°¾ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;User&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserById</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Query(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"id"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer id)</span></span>;</code> </pre> <br> æ–¹æ³•å‚æ•°çš„@ Bodyæ‰¹æ³¨å‘Šè¯‰Retrofitå°†å¯¹è±¡ç”¨ä½œè°ƒç”¨ä¸»ä½“ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@POST</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;User&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Body User user)</span></span></span></span></code> </pre> <br><h1>  2.å…ˆå†³æ¡ä»¶ </h1><br> ä»¥ä¸‹ç¤ºä¾‹å°†Eclipse IDEä¸Gradleæ„å»ºç³»ç»Ÿç»“åˆä½¿ç”¨ã€‚ <br> æœ¬ç»ƒä¹ å‡å®šæ‚¨ç†Ÿæ‚‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gradle</a>å¹¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨Eclipseä¸­ä½¿ç”¨Gradle</a> ã€‚ <br><br> å…¶ä»–å¼€å‘ç¯å¢ƒï¼ˆä¾‹å¦‚Visual Studio Codeæˆ–IntelliJï¼‰ä¹Ÿå¯ä»¥è¿™æ ·åšï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„å·¥å…·ã€‚ <br><br><h1>  3.ç»ƒä¹ ï¼šç¬¬ä¸€ä¸ªæ”¹é€ å®¢æˆ· </h1><br> åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæ‚¨å°†åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„RESTå®¢æˆ·ç«¯ã€‚ å“åº”ç”±æ¨¡æ‹ŸæœåŠ¡å™¨ç”Ÿæˆã€‚ <br><br><h2>  3.1ã€‚ åˆ›å»ºå’Œè®¾ç½®é¡¹ç›® </h2><br> åˆ›å»ºä¸€ä¸ªåä¸ºcom.vogella.retrofitgerritçš„æ–°Gradleé¡¹ç›®ã€‚ åœ¨src / main / javaä¸­æ·»åŠ ä¸€ä¸ªåä¸ºcom.vogella.retrofitgerritçš„æ–°åŒ…ã€‚ <br><br> å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ã€‚ <br><br><pre> <code class="hljs pgsql">// retrofit implementation <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.1.0'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-gson:2.1.0'</span></span> // Junit testImplementation("org.junit.jupiter:junit-jupiter-api:5.0.0") testRuntime("org.junit.jupiter:junit-jupiter-engine:5.0.0") // <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> run JUnit <span class="hljs-number"><span class="hljs-number">3</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> tests: testImplementation("junit:junit:4.12") testRuntime("org.junit.vintage:junit-vintage-engine:4.12.0")</code> </pre><br><h2>  3.2ã€‚ å®šä¹‰APIå’Œæ”¹é€ é€‚é…å™¨ </h2><br> åœ¨Gerritçš„JSONå“åº”ä¸­ï¼Œæˆ‘ä»¬ä»…å¯¹æ›´æ”¹é—®é¢˜æ„Ÿå…´è¶£ã€‚ å› æ­¤ï¼Œåœ¨ä»¥å‰æ·»åŠ çš„é»˜è®¤åŒ…ä¸­åˆ›å»ºä»¥ä¸‹æ•°æ®ç±»ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Change</span></span></span><span class="hljs-class"> </span></span>{ String subject; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSubject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subject; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSubject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String subject)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subject = subject; } }</code> </pre> <br> é€šè¿‡ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Query; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GerritAPI</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"changes/"</span></span>) Call&lt;List&lt;Change&gt;&gt; loadChanges(<span class="hljs-meta"><span class="hljs-meta">@Query</span></span>(<span class="hljs-string"><span class="hljs-string">"q"</span></span>) String status); }</code> </pre> <br> åˆ›å»ºä»¥ä¸‹æ§åˆ¶å™¨ç±»ã€‚ æ­¤ç±»åˆ›å»ºRetrofitå®¢æˆ·ç«¯ï¼Œè°ƒç”¨Gerrit APIå¹¶å¤„ç†ç»“æœï¼ˆå°†è°ƒç”¨ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ï¼‰ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.GsonBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Callback; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Response; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.gson.GsonConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Change</span></span></span><span class="hljs-class">&gt;&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://git.eclipse.org/r/"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Gson gson = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder() .setLenient() .create(); Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(BASE_URL) .addConverterFactory(GsonConverterFactory.create(gson)) .build(); GerritAPI gerritAPI = retrofit.create(GerritAPI.class); Call&lt;List&lt;Change&gt;&gt; call = gerritAPI.loadChanges(<span class="hljs-string"><span class="hljs-string">"status:open"</span></span>); call.enqueue(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;List&lt;Change&gt;&gt; call, Response&lt;List&lt;Change&gt;&gt; response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(response.isSuccessful()) { List&lt;Change&gt; changesList = response.body(); changesList.forEach(change -&gt; System.out.println(change.subject)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { System.out.println(response.errorBody()); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;List&lt;Change&gt;&gt; call, Throwable t)</span></span></span><span class="hljs-function"> </span></span>{ t.printStackTrace(); } }</code> </pre> <br> ä½¿ç”¨mainæ–¹æ³•åˆ›å»ºä¸€ä¸ªç±»ä»¥å¯åŠ¨æ§åˆ¶å™¨ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Controller controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Controller(); controller.start(); } }</code> </pre> <br><h1>  4.æ”¹è£…è½¬æ¢å™¨å’Œé€‚é…å™¨ </h1><br><h2>  4.1ã€‚ æ”¹è£…è½¬æ¢å™¨ </h2><br> å¯ä»¥å°†æ”¹é€ é…ç½®ä¸ºä½¿ç”¨ç‰¹å®šçš„è½¬æ¢å™¨ã€‚ è¯¥è½¬æ¢å™¨å¤„ç†ï¼ˆå–æ¶ˆï¼‰æ•°æ®åºåˆ—åŒ–ã€‚ å·²æœ‰å‡ ç§è½¬æ¢å™¨å¯ç”¨äºå„ç§åºåˆ—åŒ–æ ¼å¼ã€‚ <br><br><ul><li> è¦è½¬æ¢ä¸ºJSONï¼Œåä¹‹äº¦ç„¶ï¼š <br><ul><li>  Gsonï¼šcom.squareup.retrofitï¼šconverter-gson </li><li> æ°å…‹é€Šï¼šcom.squareup.retrofitï¼šè½¬æ¢å™¨æ°å…‹é€Š </li><li>  Moshiï¼šcom.squareup.retrofitï¼šè½¬æ¢å™¨-moshi </li></ul><br></li><li> è½¬æ¢ä¸ºåè®®ç¼“å†²åŒºï¼Œåä¹‹äº¦ç„¶ï¼š <br><ul><li>  Protobufï¼šcom.squareup.retrofitï¼šconverter-protobuf </li><li> ç”µçº¿ï¼šcom.squareup.retrofitï¼šè½¬æ¢å™¨ç”µçº¿ </li></ul><br></li><li> è¦è½¬æ¢ä¸ºXMLï¼Œåä¹‹äº¦ç„¶ï¼š <br><ul><li> ç®€å•XMLï¼šcom.squareup.retrofitï¼šè½¬æ¢å™¨-simplexml </li></ul><br></li></ul><br> é™¤äº†åˆ—å‡ºçš„è½¬æ¢å™¨ï¼Œæ‚¨è¿˜å¯ä»¥é€šè¿‡æ‰©å±•Converter.Factoryç±»æ¥åˆ›å»ºè‡ªå·±çš„åè®®æ¥å¤„ç†å…¶ä»–åè®®ã€‚ <br><br><h2>  4.2ã€‚ æ”¹è£…é€‚é…å™¨ </h2><br> è¿˜å¯ä»¥ä½¿ç”¨é€‚é…å™¨æ‰©å±•ç¿»æ–°ï¼Œä»¥ä¾¿ä¸å…¶ä»–åº“ï¼ˆä¾‹å¦‚RxJava 2.xï¼ŒJava 8å’ŒGuavaï¼‰æ¥å£ã€‚ <br><br> æœ‰å…³å¯ç”¨é€‚é…å™¨çš„æ¦‚è¿°ï¼Œè¯·å‚è§Github <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">square / retrofit / retrofit-adapters /</a> ã€‚ <br><br> ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨Gradleè¿æ¥RxJava 2.xé€‚é…å™¨ï¼š <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">compile</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:adapter-rxjava2:latest.version'</span></span></code> </pre> <br> æˆ–ä½¿ç”¨Apache Mavenï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.squareup.retrofit2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>adapter-rxjava2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>latest.version<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> è¦æ·»åŠ é€‚é…å™¨ï¼Œå¿…é¡»ä½¿ç”¨retrofit2.Retrofit.Builder.addCallAdapterFactoryï¼ˆFactoryï¼‰æ–¹æ³•ã€‚ <br><br><pre> <code class="java hljs">Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(<span class="hljs-string"><span class="hljs-string">"https://api.example.com/"</span></span>) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .build();</code> </pre> <br> ä½¿ç”¨æ­¤é€‚é…å™¨ï¼ŒRetrofitæ¥å£å¯ä»¥è¿”å›RxJava 2.xç±»å‹ï¼Œä¾‹å¦‚Observableï¼ŒFlowableæˆ–Singleç­‰ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"users"</span></span>) Observable&lt;List&lt;User&gt;&gt; getUsers();</code> </pre> <br><h1>  5.æ”¹é€ è®¤è¯ </h1><br> æ”¹é€ æ”¯æŒéœ€è¦èº«ä»½éªŒè¯çš„APIè°ƒç”¨ã€‚ å¯ä»¥ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ï¼ˆHttp Basicèº«ä»½éªŒè¯ï¼‰æˆ–APIä»¤â€‹â€‹ç‰Œæ¥å®Œæˆèº«ä»½éªŒè¯ã€‚ <br><br> æœ‰ä¸¤ç§ç®¡ç†èº«ä»½éªŒè¯çš„æ–¹æ³•ã€‚ ç¬¬ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨æ‰¹æ³¨ç®¡ç†è¯·æ±‚æ ‡å¤´ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯ä¸ºæ­¤ä½¿ç”¨OkHttpæ‹¦æˆªå™¨ã€‚ <br><br><h2>  5.1ã€‚ å¸¦æœ‰æ³¨é‡Šçš„èº«ä»½éªŒè¯ </h2><br> å‡è®¾æ‚¨æƒ³è¯·æ±‚æœ‰å…³éœ€è¦è®¤è¯çš„ç”¨æˆ·çš„ä¿¡æ¯ã€‚ æ‚¨å¯ä»¥é€šè¿‡åœ¨APIå®šä¹‰ä¸­æ·»åŠ æ–°å‚æ•°æ¥æ‰§è¡Œæ­¤æ“ä½œï¼Œä¾‹å¦‚ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"user"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;UserDetails&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Header(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"Authorization"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String credentials)</span></span></code> </pre> <br><br> ä½¿ç”¨@ Headerï¼ˆâ€œ Authorizationâ€ï¼‰æ‰¹æ³¨ï¼Œæ‚¨å‘Šè¯‰Retrofitå‘æ‚¨çš„è¯·æ±‚æ·»åŠ å¸¦æœ‰æ‚¨ä¼ é€’çš„å€¼çš„Authorizationæ ‡å¤´ã€‚ <br><br> è¦ç”Ÿæˆç”¨äºåŸºæœ¬èº«ä»½éªŒè¯çš„å‡­æ®ï¼Œå¯ä»¥ä½¿ç”¨OkHttps Credentialsç±»åŠå…¶åŸºæœ¬ï¼ˆå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ï¼‰æ–¹æ³•ã€‚ è¯¥æ–¹æ³•æ¥å—ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶è¿”å›Http Basicæ–¹æ¡ˆçš„èº«ä»½éªŒè¯å‡­æ®ã€‚ <br><br><pre> <code class="java hljs">Credentials.basic(<span class="hljs-string"><span class="hljs-string">"ausername"</span></span>,<span class="hljs-string"><span class="hljs-string">"apassword"</span></span>);</code> </pre> <br> å¦‚æœè¦ä½¿ç”¨APIâ€‹â€‹ä»¤ç‰Œè€Œä¸ä½¿ç”¨Basicæ–¹æ¡ˆï¼Œåªéœ€ä½¿ç”¨ä»¤ç‰Œè°ƒç”¨getUserDetailsï¼ˆStringï¼‰æ–¹æ³•ã€‚ <br><br><h2>  5.2ã€‚ ä½¿ç”¨OkHttpæ‹¦æˆªå™¨è¿›è¡Œèº«ä»½éªŒè¯ã€‚ </h2><br> ä»…å½“æ‚¨è¯·æ±‚ç”¨æˆ·æ•°æ®æ—¶ï¼Œä»¥ä¸Šæ–¹æ³•æ‰ä¼šæ·»åŠ å‡­æ®ã€‚ å¦‚æœæ‚¨æœ‰æ›´å¤šéœ€è¦èº«ä»½éªŒè¯çš„å‘¼å«ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ‹¦æˆªå™¨æ¥æ‰§è¡Œæ­¤æ“ä½œã€‚ æ‹¦æˆªå™¨ç”¨äºåœ¨æ‰§è¡Œä¹‹å‰ä¿®æ”¹æ¯ä¸ªè¯·æ±‚å¹¶è®¾ç½®è¯·æ±‚æ ‡å¤´ã€‚ ä¼˜ç‚¹æ˜¯æ‚¨ä¸éœ€è¦åœ¨æ¯ä¸ªAPIæ–¹æ³•å®šä¹‰ä¸­æ·»åŠ @ Headerï¼ˆâ€œæˆæƒâ€ï¼‰ã€‚ <br><br> è‹¥è¦æ·»åŠ æ‹¦æˆªå™¨ï¼Œå¿…é¡»åœ¨OkHttp Builderä¸­ä½¿ç”¨okhttp3.OkHttpClient.Builder.addInterceptorï¼ˆInterceptorï¼‰æ–¹æ³•ã€‚ <br><br><pre> <code class="java hljs">OkHttpClient okHttpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OkHttpClient().newBuilder().addInterceptor(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Interceptor() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> okhttp3.<span class="hljs-function"><span class="hljs-function">Response </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intercept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Chain chain)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ Request originalRequest = chain.request(); Request.Builder builder = originalRequest.newBuilder().header(<span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>, Credentials.basic(<span class="hljs-string"><span class="hljs-string">"aUsername"</span></span>, <span class="hljs-string"><span class="hljs-string">"aPassword"</span></span>)); Request newRequest = builder.build(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chain.proceed(newRequest); } }).build();</code> </pre> <br> ç”±OkHttpåˆ›å»ºçš„å®¢æˆ·ç«¯å¿…é¡»ä½¿ç”¨retrofit2.Retrofit.Builder.clientï¼ˆOkHttpClientï¼‰æ–¹æ³•æ·»åŠ åˆ°Retrofitå®¢æˆ·ç«¯ä¸­ã€‚ <br><br><pre> <code class="java hljs">Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(<span class="hljs-string"><span class="hljs-string">"https://api.example.com/"</span></span>) .client(okHttpClient) .build();</code> </pre> <br> æ‚¨å·²ç»æ³¨æ„åˆ°ï¼ŒCredentialsç±»åœ¨è¿™é‡Œç”¨äºåŸºæœ¬æˆæƒã€‚ <br> åŒæ ·ï¼Œå¦‚æœæ‚¨æƒ³ä½¿ç”¨APIâ€‹â€‹ä»¤ç‰Œï¼Œåªéœ€ä½¿ç”¨ä»¤ç‰Œå³å¯ã€‚ <br><br><h1>  6.ç»ƒä¹ ï¼šåœ¨Javaä¸­ä½¿ç”¨ç¿»æ–°è¯·æ±‚Gerrit </h1><br> ä»¥ä¸‹éƒ¨åˆ†æè¿°äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªæœ€å°çš„Javaåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºä½¿ç”¨Retrofitä»Gerrit APIä¸­æ£€ç´¢å¼€æ”¾çš„æ›´æ”¹å¯¹è±¡ã€‚ ç»“æœå°†æ‰“å°åœ¨æ§åˆ¶å°ä¸­ã€‚ <br><br><h2>  6.1ã€‚ åˆ›å»ºå’Œè®¾ç½®é¡¹ç›® </h2><br> æœ¬ç»ƒä¹ å‡å®šæ‚¨ç†Ÿæ‚‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Eclipseçš„</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gradle</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Buildship</a> ã€‚ <br><br> åˆ›å»ºä¸€ä¸ªåä¸ºcom.vogella.java.retrofitgerritçš„æ–°Gradleé¡¹ç›®ã€‚ å‘src / main / javaæ·»åŠ ä¸€ä¸ªåä¸ºcom.vogella.java.retrofitgerritçš„æ–°åŒ…ã€‚ <br><br> å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ã€‚ <br><br><pre> <code class="hljs pgsql">// retrofit implementation <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.1.0'</span></span> implementation <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-gson:2.1.0'</span></span> // Junit testImplementation("org.junit.jupiter:junit-jupiter-api:5.0.0") testRuntime("org.junit.jupiter:junit-jupiter-engine:5.0.0") // <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> run JUnit <span class="hljs-number"><span class="hljs-number">3</span></span>/<span class="hljs-number"><span class="hljs-number">4</span></span> tests: testImplementation("junit:junit:4.12") testRuntime("org.junit.vintage:junit-vintage-engine:4.12.0")</code> </pre> <br><h2>  6.2ã€‚ å®šä¹‰APIå’Œæ”¹é€ é€‚é…å™¨ </h2><br> åœ¨Gerritçš„JSONå“åº”ä¸­ï¼Œæˆ‘ä»¬ä»…å¯¹æ›´æ”¹é—®é¢˜æ„Ÿå…´è¶£ã€‚ å› æ­¤ï¼Œåœ¨ä»¥å‰æ·»åŠ çš„é»˜è®¤åŒ…ä¸­åˆ›å»ºä»¥ä¸‹æ•°æ®ç±»ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Change</span></span></span><span class="hljs-class"> </span></span>{ String subject; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSubject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subject; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setSubject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String subject)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.subject = subject; } }</code> </pre> <br> ä½¿ç”¨ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Query; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GerritAPI</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"changes/"</span></span>) Call&lt;List&lt;Change&gt;&gt; loadChanges(<span class="hljs-meta"><span class="hljs-meta">@Query</span></span>(<span class="hljs-string"><span class="hljs-string">"q"</span></span>) String status); }</code> </pre> <br> åˆ›å»ºä»¥ä¸‹æ§åˆ¶å™¨ç±»ã€‚ æ­¤ç±»åˆ›å»ºRetrofitå®¢æˆ·ç«¯ï¼Œè°ƒç”¨Gerrit APIå¹¶å¤„ç†ç»“æœï¼ˆå°†è°ƒç”¨ç»“æœæ‰“å°åˆ°æ§åˆ¶å°ï¼‰ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.GsonBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Callback; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Response; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.gson.GsonConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">List</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Change</span></span></span><span class="hljs-class">&gt;&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://git.eclipse.org/r/"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Gson gson = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder() .setLenient() .create(); Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(BASE_URL) .addConverterFactory(GsonConverterFactory.create(gson)) .build(); GerritAPI gerritAPI = retrofit.create(GerritAPI.class); Call&lt;List&lt;Change&gt;&gt; call = gerritAPI.loadChanges(<span class="hljs-string"><span class="hljs-string">"status:open"</span></span>); call.enqueue(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;List&lt;Change&gt;&gt; call, Response&lt;List&lt;Change&gt;&gt; response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(response.isSuccessful()) { List&lt;Change&gt; changesList = response.body(); changesList.forEach(change -&gt; System.out.println(change.subject)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { System.out.println(response.errorBody()); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;List&lt;Change&gt;&gt; call, Throwable t)</span></span></span><span class="hljs-function"> </span></span>{ t.printStackTrace(); } }</code> </pre> <br> ä½¿ç”¨mainæ–¹æ³•åˆ›å»ºä¸€ä¸ªç±»ä»¥å¯åŠ¨æ§åˆ¶å™¨ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitgerrit; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Controller controller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Controller(); controller.start(); } }</code> </pre> <br><h1>  7.ç»ƒä¹ ï¼šä½¿ç”¨ç¿»æ–°ä»RSS Feedè½¬æ¢XMLå“åº” </h1><br> æœ¬èŠ‚ä»‹ç»å¦‚ä½•ä½¿ç”¨Retrofité€šè¿‡SimpleXMLConverterè½¬æ¢XMLå“åº”ã€‚ <br><br> åˆ›å»ºäº†ä¸€ä¸ªæœ€å°çš„Javaåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºè¯·æ±‚Vogella RSS feedï¼ˆ <a href="">http://vogella.com/article.rss</a> ï¼‰å¹¶æ‰“å°é¢‘é“åç§°ï¼Œæ ‡é¢˜å’Œæ–‡ç« é“¾æ¥ã€‚ <br><br><h2>  7.1ã€‚ åˆ›å»ºå’Œè®¾ç½®é¡¹ç›® </h2><br> æœ¬ç»ƒä¹ å‡å®šæ‚¨ç†Ÿæ‚‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Eclipseçš„</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gradle</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Buildship</a> ã€‚ <br><br> åˆ›å»ºä¸€ä¸ªåä¸ºcom.vogella.java.retrofitxmlçš„æ–°Gradleé¡¹ç›®ã€‚ å‘src / main / javaæ·»åŠ ä¸€ä¸ªåä¸ºcom.vogella.java.retrofitxmlçš„æ–°åŒ…ã€‚ <br><br> å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ã€‚ <br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.1.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-simplexml:2.1.0'</span></span></code> </pre> <br><h2>  7.2ã€‚ å®šä¹‰XMLè§†å›¾ </h2><br>  RSSæè¦å¦‚ä¸‹ï¼š <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rss</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">channel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Eclipse and Android Information<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Eclipse and Android Information<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span>en<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copyright</span></span></span><span class="hljs-tag">&gt;</span></span>Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Germany (CC BY-NC-SA 3.0)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">copyright</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pubDate</span></span></span><span class="hljs-tag">&gt;</span></span>Tue, 03 May 2016 11:46:11 +0200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pubDate</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Android user interface testing with Espresso - Tutorial<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> This tutorial describes how to test Android applications with the Android Espresso testing framework.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/AndroidTestingEspresso/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span>lars.vogel@vogella.com (Lars Vogel)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/AndroidTestingEspresso/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Using the Gradle build system in the Eclipse IDE - Tutorial<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>This article describes how to use the Gradle tooling in Eclipse<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/EclipseGradle/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span>lars.vogel@vogella.com (Lars Vogel)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/EclipseGradle/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Unit tests with Mockito - Tutorial<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>This tutorial explains testing with the Mockito framework for writting software tests.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/Mockito/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span>lars.vogel@vogella.com (Lars Vogel)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span>http://www.vogella.com/tutorials/Mockito/article.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guid</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">channel</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rss</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> é™¤äº†XMLæ ‡å¤´ï¼Œæ­¤æ–‡ä»¶è¿˜åŒ…å«å„ç§XMLå…ƒç´ ã€‚  RSSå…ƒç´ åŒ…å«ä¸€ä¸ªchannelå…ƒç´ ï¼Œå…¶ä¸­åŒ…å«å…¶ä»–å…ƒç´ ï¼ˆä¾‹å¦‚titleï¼Œdescriptionï¼ŒpubDateï¼‰å’Œå‡ ä¸ªitemå…ƒç´ ï¼ˆæ–‡ç« ï¼‰ã€‚ <br><br> åˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªæ•°æ®ç±»ï¼šRSSFeedå’ŒArticleã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitxml; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.Element; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.Root; <span class="hljs-meta"><span class="hljs-meta">@Root</span></span>(name = <span class="hljs-string"><span class="hljs-string">"item"</span></span>, strict = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Article</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Element</span></span>(name = <span class="hljs-string"><span class="hljs-string">"title"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String title; <span class="hljs-meta"><span class="hljs-meta">@Element</span></span>(name = <span class="hljs-string"><span class="hljs-string">"link"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String link; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> title; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String title)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.title = title; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> link; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setLink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String link)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.link = link; } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitxml; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.Element; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.ElementList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.Path; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.simpleframework.xml.Root; <span class="hljs-meta"><span class="hljs-meta">@Root</span></span>(name=<span class="hljs-string"><span class="hljs-string">"rss"</span></span>, strict=<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RSSFeed</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Element</span></span>(name=<span class="hljs-string"><span class="hljs-string">"title"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"channel"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String channelTitle; <span class="hljs-meta"><span class="hljs-meta">@ElementList</span></span>(name=<span class="hljs-string"><span class="hljs-string">"item"</span></span>, inline=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"channel"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Article&gt; articleList; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChannelTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> channelTitle; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setChannelTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String channelTitle)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.channelTitle = channelTitle; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Article&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getArticleList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> articleList; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setArticleList</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Article&gt; articleList)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.articleList = articleList; } }</code> </pre> <br>  Articleç±»ä»£è¡¨ä¸€ç¯‡æ–‡ç« ï¼Œå¹¶ä¸”ä»…ä¿ç•™æ ‡é¢˜å’ŒæŒ‡å‘è¯¥æ–‡ç« çš„é“¾æ¥ã€‚ è¿™äº›æ˜¯æˆ‘ä»¬å”¯ä¸€æ„Ÿå…´è¶£çš„é¢†åŸŸã€‚ <br><br> æ³¨é‡Š@æ ¹å°†ç±»æ ‡è®°ä¸ºè¦è¿›è¡Œï¼ˆdeï¼‰åºåˆ—åŒ–ã€‚  ï¼ˆå¯é€‰ï¼‰æ‚¨å¯ä»¥åœ¨@ Rootæ‰¹æ³¨ä¸­æŒ‡å®šä¸XMLå…ƒç´ çš„åç§°åŒ¹é…çš„åç§°ã€‚ å¦‚æœæœªæŒ‡å®šåç§°ï¼Œåˆ™å°†ç±»åç§°ç”¨ä½œXMLå…ƒç´ çš„åç§°ã€‚ ç”±äºç±»åç§°ï¼ˆRSSFeedï¼‰ä¸XMLå…ƒç´ åç§°ï¼ˆrssï¼‰ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æŒ‡å®šåç§°ã€‚ <br><br> å½“strictè®¾ç½®ä¸ºfalseæ—¶ï¼Œå°†ç¦ç”¨ä¸¥æ ¼è§£æã€‚ å¦‚æœå‘ç°æœªæä¾›æ˜ å°„çš„XMLå…ƒç´ æˆ–å±æ€§ï¼Œè¿™å°†å‘Šè¯‰è§£æå™¨ä¸è¦ä¸­æ–­æˆ–å¼•å‘å¼‚å¸¸ã€‚ ç”±äºrsså…ƒç´ å…·æœ‰æ²¡æœ‰å¯¹åº”å­—æ®µçš„versionå±æ€§ï¼Œå› æ­¤ï¼Œå¦‚æœä¸¥æ ¼å‚æ•°æœªè®¾ç½®ä¸ºfalseï¼Œåˆ™åº”ç”¨ç¨‹åºå°†ç”Ÿæˆé”™è¯¯ã€‚ <br><br> ä½¿ç”¨@ Elementæ‰¹æ³¨è¡¨ç¤ºXMLå…ƒç´ ã€‚ å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥æŒ‡å®šæ­¤å­—æ®µè¡¨ç¤ºçš„å…ƒç´ çš„XMLåç§°ã€‚ å¦‚æœæœªæŒ‡å®šåç§°ï¼Œåˆ™ä½¿ç”¨å­—æ®µåç§°ã€‚ <br><br>  articleListå­—æ®µç”¨@ ElementListæ³¨é‡Šã€‚ è¿™è¡¨æ˜è¯¥å­—æ®µç”¨äºå­˜å‚¨å…·æœ‰ç›¸åŒåç§°çš„XMLå…ƒç´ çš„é›†åˆï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ä¸ºListï¼‰ã€‚ å½“inlineè®¾ç½®ä¸ºtrueæ—¶ï¼Œè¿™æ„å‘³ç€è¯¥é›†åˆä¸­çš„é¡¹ç›®åœ¨æŒ‡å®šé¡¹ç›®å†…ç´§æŒ¨ç€åˆ—å‡ºï¼Œå¹¶ä¸”æ²¡æœ‰ä¸­é—´çˆ¶çº§ã€‚ <br><br> ä½¿ç”¨@ Pathæ‰¹æ³¨ï¼Œå¯ä»¥åœ¨XMLæ ‘ä¸­æŒ‡å®šXMLå…ƒç´ çš„è·¯å¾„ã€‚ å¦‚æœæ‚¨ä¸æƒ³ä½¿ç”¨Javaå¯¹è±¡ä¸ºå®Œæ•´çš„XMLæ ‘å»ºæ¨¡ï¼Œè¿™å°†å¾ˆæœ‰ç”¨ã€‚ å¯¹äºé€šé“çš„åç§°å’Œå‡ ä¸ªé¡¹ç›®å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æŒ‡å‘é€šé“å…ƒç´ ä¸­çš„ç‰¹å®šå…ƒç´ ã€‚ <br><br><h2>  7.3ã€‚ å®šä¹‰APIå’Œæ”¹é€ é€‚é…å™¨ </h2><br> é€šè¿‡ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitxml; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VogellaAPI</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"article.rss"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;RSSFeed&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadRSSFeed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br> åˆ›å»ºä»¥ä¸‹æ§åˆ¶å™¨ç±»ã€‚ æ­¤ç±»åˆ›å»ºRetrofitå®¢æˆ·ç«¯ï¼Œè°ƒç”¨Vogella APIï¼Œå¹¶å¤„ç†ç»“æœã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitxml; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Callback; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Response; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.simplexml.SimpleXmlConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Controller</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callback</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RSSFeed</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String BASE_URL = <span class="hljs-string"><span class="hljs-string">"http://vogella.com/"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder().baseUrl(BASE_URL) .addConverterFactory(SimpleXmlConverterFactory.create()).build(); VogellaAPI vogellaAPI = retrofit.create(VogellaAPI.class); Call&lt;RSSFeed&gt; call = vogellaAPI.loadRSSFeed(); call.enqueue(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;RSSFeed&gt; call, Response&lt;RSSFeed&gt; response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.isSuccessful()) { RSSFeed rss = response.body(); System.out.println(<span class="hljs-string"><span class="hljs-string">"Channel title: "</span></span> + rss.getChannelTitle()); rss.getArticleList().forEach( article -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"Title: "</span></span> + article.getTitle() + <span class="hljs-string"><span class="hljs-string">" Link: "</span></span> + article.getLink())); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { System.out.println(response.errorBody()); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;RSSFeed&gt; call, Throwable t)</span></span></span><span class="hljs-function"> </span></span>{ t.printStackTrace(); } }</code> </pre> <br> æœ€åä¸€æ­¥æ˜¯ä½¿ç”¨mainæ–¹æ³•åˆ›å»ºä¸€ä¸ªç±»æ¥å¯åŠ¨æ§åˆ¶å™¨ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.java.retrofitxml; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Controller ctrl = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Controller(); ctrl.start(); } }</code> </pre> <br><h1>  8.ç»ƒä¹ ï¼šåˆ›å»ºä¸€ä¸ªè¯·æ±‚StackOverflowçš„åº”ç”¨ç¨‹åº </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StackOverflow</a>æ˜¯ä¸€ä¸ªä¸ç¼–ç¨‹ç›¸å…³çš„é—®é¢˜çš„çƒ­é—¨ç½‘ç«™ã€‚ å®ƒè¿˜æä¾›äº†ä¸€ä¸ªREST APIï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨Stackoverflow APIé¡µé¢ä¸Šæœ‰è¯¦ç»†è®°å½•</a> ã€‚ <br><br> åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨REST Retrofitåº“ã€‚ æ‚¨å°†ä½¿ç”¨å®ƒæ¥æŸ¥è¯¢StackOverflowæ ‡ç­¾é—®é¢˜åŠå…¶ç­”æ¡ˆã€‚ <br><br> åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹è¯·æ±‚URLã€‚ åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ­¤URLï¼Œç„¶åæŸ¥çœ‹ç­”æ¡ˆã€‚ <br><br><pre> <code class="hljs pgsql">https://api.stackexchange.com/<span class="hljs-number"><span class="hljs-number">2.2</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>?<span class="hljs-keyword"><span class="hljs-keyword">order</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">desc</span></span>&amp;sort=votes&amp;tagged=android&amp;site=stackoverflow</code> </pre> <br><h2>  8.1ã€‚ åˆ›å»ºå’Œè®¾ç½®é¡¹ç›® </h2><br> åˆ›å»ºä¸€ä¸ªåä¸ºcom.vogella.android.stackoverflowçš„Androidåº”ç”¨ã€‚ ä½¿ç”¨com.vogella.android.stackoverflowä½œä¸ºé¡¶çº§åŒ…çš„åç§°ã€‚ <br><br> å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ã€‚ <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">compile</span></span> <span class="hljs-string"><span class="hljs-string">"com.android.support:recyclerview-v7:25.3.1"</span></span> compile <span class="hljs-string"><span class="hljs-string">'com.google.code.gson:gson:2.8.1'</span></span></code> </pre> <br><h2>  8.2ã€‚ åˆ›å»ºæ•°æ®æ¨¡å‹ </h2><br> æˆ‘ä»¬å¯¹Stackoverflowçš„é—®é¢˜å’Œç­”æ¡ˆæ„Ÿå…´è¶£ã€‚ ä¸ºæ­¤ï¼Œåˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªæ•°æ®ç±»ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.annotations.SerializedName; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Question</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String title; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String body; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"question_id"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String questionId; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(title); } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.annotations.SerializedName; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Answer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"answer_id"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> answerId; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"is_accepted"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> accepted; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> score; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> answerId + <span class="hljs-string"><span class="hljs-string">" - Score: "</span></span> + score + <span class="hljs-string"><span class="hljs-string">" - Accepted: "</span></span> + (accepted ? <span class="hljs-string"><span class="hljs-string">"Yes"</span></span> : <span class="hljs-string"><span class="hljs-string">"No"</span></span>); } }</code> </pre> <br><h2>  8.3ã€‚ åˆ›å»ºæ´»åŠ¨å’Œå¸ƒå±€ </h2><br> ä¸ºæ‚¨çš„æ´»åŠ¨è®¾ç½®activity_main.xmlã€‚ <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/activity_main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.stackoverflow.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Spinner</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/questions_spinner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.RecyclerView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/list"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/authenticate_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Authenticate"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> å°†åä¸ºRecyclerViewAdapterçš„é€‚é…å™¨å›æ”¶å™¨è§†å›¾ç±»æ·»åŠ åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚ <br><br> ä¸€ç§å¯èƒ½çš„å®ç°å¦‚ä¸‹ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.RecyclerView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.LayoutInflater; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.ViewGroup; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerViewAdapter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerView</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Adapter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerViewAdapter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;Answer&gt; data; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecyclerView</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TextView text; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(v); text = (TextView) v.findViewById(android.R.id.text1); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RecyclerViewAdapter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;Answer&gt; data)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = data; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> RecyclerViewAdapter.<span class="hljs-function"><span class="hljs-function">ViewHolder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ViewGroup parent, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> viewType)</span></span></span><span class="hljs-function"> </span></span>{ View v; v = LayoutInflater.from(parent.getContext()).inflate(android.R.layout.simple_selectable_list_item, parent, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ViewHolder(v); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onBindViewHolder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RecyclerViewAdapter.ViewHolder holder, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position)</span></span></span><span class="hljs-function"> </span></span>{ Answer answer = ((Answer) data.get(position)); holder.text.setText(answer.toString()); holder.itemView.setTag(answer.answerId); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItemCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.size(); } }</code> </pre> <br> ä¿®æ”¹MainActivityç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.LinearLayoutManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.RecyclerView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.AdapterView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ArrayAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Spinner; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String token; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button authenticateButton; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Spinner questionsSpinner; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RecyclerView recyclerView; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); questionsSpinner = (Spinner) findViewById(R.id.questions_spinner); questionsSpinner.setOnItemSelectedListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdapterView.OnItemSelectedListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent, View view, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Spinner item selected"</span></span>, Toast.LENGTH_LONG).show(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNothingSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent)</span></span></span><span class="hljs-function"> </span></span>{ } }); authenticateButton = (Button) findViewById(R.id.authenticate_button); recyclerView = (RecyclerView) findViewById(R.id.list); recyclerView.setHasFixedSize(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); recyclerView.setLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinearLayoutManager(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { authenticateButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (v.getId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> android.R.id.text1: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// TODO } else { Toast.makeText(this, "You need to authenticate first", Toast.LENGTH_LONG).show(); } break; case R.id.authenticate_button: // TODO break; } } @Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { if (resultCode == RESULT_OK &amp;&amp; requestCode == 1) { token = data.getStringExtra("token"); } } }</span></span></code> </pre> <br><h2>  8.4ã€‚ ä½¿ç”¨ä¼ªé€ çš„æ•°æ®æä¾›è€… </h2><br> åˆ›å»ºä¸€ä¸ªä¼ªé€ çš„æ•°æ®æä¾›ç¨‹åºï¼Œå¹¶åœ¨ä¼ªé€ è€…ä¸­å¡«å……ä¼ªé€ çš„é—®é¢˜ï¼Œåœ¨recyclerviewä¸­å¡«å……ä¼ªé€ çš„ç­”æ¡ˆï¼ˆåœ¨æ—‹è½¬å™¨ä¸­æ›´æ”¹é€‰æ‹©ä¹‹åï¼‰ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FakeDataProvider</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;Question&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getQuestions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ List&lt;Question&gt; questions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>; i++) { Question question = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Question(); question.questionId = String.valueOf(i); question.title = String.valueOf(i); question.body = String.valueOf(i) + <span class="hljs-string"><span class="hljs-string">"Body"</span></span>; questions.add(question); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> questions; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> List&lt;Answer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAnswers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ List&lt;Answer&gt; answers = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>; i++) { Answer answer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Answer(); answer.answerId = i; answer.accepted = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; answer.score = i; answers.add(answer); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> answers; } }</code> </pre> <br> ç°åœ¨å°†Spinnerå’ŒRecyclerviewé…ç½®ä¸ºä½¿ç”¨æ­¤ä¼ªé€ æ•°æ®ã€‚ <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.LinearLayoutManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.RecyclerView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.AdapterView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ArrayAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Spinner; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String token; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button authenticateButton; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Spinner questionsSpinner; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RecyclerView recyclerView; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); questionsSpinner = (Spinner) findViewById(R.id.questions_spinner); questionsSpinner.setOnItemSelectedListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdapterView.OnItemSelectedListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent, View view, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Spinner item selected"</span></span>, Toast.LENGTH_LONG).show(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNothingSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent)</span></span></span><span class="hljs-function"> </span></span>{ } }); List&lt;Question&gt; questions = FakeDataProvider.getQuestions(); ArrayAdapter&lt;Question&gt; arrayAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;Question&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, questions); questionsSpinner.setAdapter(arrayAdapter); authenticateButton = (Button) findViewById(R.id.authenticate_button); recyclerView = (RecyclerView) findViewById(R.id.list); recyclerView.setHasFixedSize(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); recyclerView.setLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinearLayoutManager(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); List&lt;Answer&gt; answers = FakeDataProvider.getAnswers(); RecyclerViewAdapter adapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RecyclerViewAdapter(answers); recyclerView.setAdapter(adapter); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { authenticateButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (v.getId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> android.R.id.text1: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// TODO } else { Toast.makeText(this, "You need to authenticate first", Toast.LENGTH_LONG).show(); } break; case R.id.authenticate_button: // TODO break; } } @Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { if (resultCode == RESULT_OK &amp;&amp; requestCode == 1) { token = data.getStringExtra("token"); } } }</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.5ã€‚</font><font style="vertical-align: inherit;">æ·»åŠ Gradleä¾èµ–å…³ç³»å’Œæƒé™</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ã€‚ </font></font><br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.1.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-gson:2.1.0'</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨æ¸…å•ä¸­æ·»åŠ è®¿é—®Internetçš„æƒé™ã€‚ </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.stackoverflow"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.6ã€‚</font><font style="vertical-align: inherit;">å®šä¹‰APIå’Œæ”¹é€ é€‚é…å™¨</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Stackoverflow APIå°†ç­”æ¡ˆæˆ–é—®é¢˜åŒ…è£…åœ¨åä¸ºitemsçš„JSONå¯¹è±¡ä¸­ã€‚</font><font style="vertical-align: inherit;">è¦å¤„ç†æ­¤é—®é¢˜ï¼Œè¯·åˆ›å»ºä»¥ä¸‹åä¸ºListWrapperçš„æ•°æ®ç±»ã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†å¤„ç†Stackoverflowå…ƒç´ çš„åŒ…è£…ï¼Œè¿™æ˜¯å¿…éœ€çš„ã€‚</font><font style="vertical-align: inherit;">æ­¤ç±»é‡‡ç”¨ç±»å‹å‚æ•°ï¼Œå¹¶ä¸”ä»…åŒ…è£…æ­¤ç±»å‹çš„å¯¹è±¡åˆ—è¡¨ã€‚</font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListWrapper</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ List&lt;T&gt; items; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é€šè¿‡ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIã€‚ </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Field; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.FormUrlEncoded; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.POST; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Path; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StackOverflowAPI</span></span></span><span class="hljs-class"> </span></span>{ String BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://api.stackexchange.com/"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"/2.2/questions?order=desc&amp;sort=votes&amp;site=stackoverflow&amp;tagged=android&amp;filter=withbody"</span></span>) Call&lt;ListWrapper&lt;Question&gt;&gt; getQuestions(); <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"/2.2/questions/{id}/answers?order=desc&amp;sort=votes&amp;site=stackoverflow"</span></span>) Call&lt;ListWrapper&lt;Answer&gt;&gt; getAnswersForQuestion(<span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"id"</span></span>) String questionId); }</code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.7ã€‚</font><font style="vertical-align: inherit;">æ´»åŠ¨è®¾å®š</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚ä¸‹æ›´æ”¹MainActivityä»£ç ã€‚ </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.stackoverflow; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.LinearLayoutManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.RecyclerView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.AdapterView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ArrayAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Spinner; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.GsonBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Callback; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Response; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.gson.GsonConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnClickListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> StackOverflowAPI stackoverflowAPI; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String token; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button authenticateButton; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Spinner questionsSpinner; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RecyclerView recyclerView; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); questionsSpinner = (Spinner) findViewById(R.id.questions_spinner); questionsSpinner.setOnItemSelectedListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdapterView.OnItemSelectedListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent, View view, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ Question question = (Question) parent.getAdapter().getItem(position); stackoverflowAPI.getAnswersForQuestion(question.questionId).enqueue(answersCallback); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNothingSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent)</span></span></span><span class="hljs-function"> </span></span>{ } }); authenticateButton = (Button) findViewById(R.id.authenticate_button); recyclerView = (RecyclerView) findViewById(R.id.list); recyclerView.setHasFixedSize(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); recyclerView.setLayoutManager(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LinearLayoutManager(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); createStackoverflowAPI(); stackoverflowAPI.getQuestions().enqueue(questionsCallback); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { authenticateButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createStackoverflowAPI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Gson gson = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder() .setDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd'T'HH:mm:ssZ"</span></span>) .create(); Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(StackOverflowAPI.BASE_URL) .addConverterFactory(GsonConverterFactory.create(gson)) .build(); stackoverflowAPI = retrofit.create(StackOverflowAPI.class); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (v.getId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> android.R.id.text1: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//TODO } else { Toast.makeText(this, "You need to authenticate first", Toast.LENGTH_LONG).show(); } break; case R.id.authenticate_button: // TODO break; } } @Override protected void onActivityResult(int requestCode, int resultCode, Intent data) { if (resultCode == RESULT_OK &amp;&amp; requestCode == 1) { token = data.getStringExtra("token"); } } Callback&lt;ListWrapper&lt;Question&gt;&gt; questionsCallback = new Callback&lt;ListWrapper&lt;Question&gt;&gt;() { @Override public void onResponse(Call&lt;ListWrapper&lt;Question&gt;&gt; call, Response&lt;ListWrapper&lt;Question&gt;&gt; response) { if (response.isSuccessful()) { ListWrapper&lt;Question&gt; questions = response.body(); ArrayAdapter&lt;Question&gt; arrayAdapter = new ArrayAdapter&lt;Question&gt;(MainActivity.this, android.R.layout.simple_spinner_dropdown_item, questions.items); questionsSpinner.setAdapter(arrayAdapter); } else { Log.d("QuestionsCallback", "Code: " + response.code() + " Message: " + response.message()); } } @Override public void onFailure(Call&lt;ListWrapper&lt;Question&gt;&gt; call, Throwable t) { t.printStackTrace(); } }; Callback&lt;ListWrapper&lt;Answer&gt;&gt; answersCallback = new Callback&lt;ListWrapper&lt;Answer&gt;&gt;() { @Override public void onResponse(Call&lt;ListWrapper&lt;Answer&gt;&gt; call, Response&lt;ListWrapper&lt;Answer&gt;&gt; response) { if (response.isSuccessful()) { List&lt;Answer&gt; data = new ArrayList&lt;&gt;(); data.addAll(response.body().items); recyclerView.setAdapter(new RecyclerViewAdapter(data)); } else { Log.d("QuestionsCallback", "Code: " + response.code() + " Message: " + response.message()); } } @Override public void onFailure(Call&lt;ListWrapper&lt;Answer&gt;&gt; call, Throwable t) { t.printStackTrace(); } }; Callback&lt;ResponseBody&gt; upvoteCallback = new Callback&lt;ResponseBody&gt;() { @Override public void onResponse(Call&lt;ResponseBody&gt; call, Response&lt;ResponseBody&gt; response) { if (response.isSuccessful()) { Toast.makeText(MainActivity.this, "Upvote successful", Toast.LENGTH_LONG).show(); } else { Log.d("QuestionsCallback", "Code: " + response.code() + " Message: " + response.message()); Toast.makeText(MainActivity.this, "You already upvoted this answer", Toast.LENGTH_LONG).show(); } } @Override public void onFailure(Call&lt;ResponseBody&gt; call, Throwable t) { t.printStackTrace(); } }; }</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.8ã€‚</font><font style="vertical-align: inherit;">å¯é€‰ï¼šè·å–ç”¨æˆ·ä¸ªäººèµ„æ–™å›¾ç‰‡</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨å›æ”¶è€…è§†å›¾ä¸­æ›´æ”¹ç”Ÿäº§çº¿çš„å¸ƒå±€ï¼Œä»¥åŒæ—¶æ˜¾ç¤ºç”¨æˆ·ä¸ªäººèµ„æ–™å›¾åƒã€‚</font><font style="vertical-align: inherit;">æ‰©å±•æ•°æ®æ¨¡å‹ä»¥è·å¾—å›ç­”é—®é¢˜çš„ç”¨æˆ·çš„ä¸ªäººèµ„æ–™å›¾ç‰‡ã€‚</font><font style="vertical-align: inherit;">å°†ImageViewæ·»åŠ åˆ°å¸ƒå±€çº¿ï¼Œå¹¶ä½¿ç”¨Glideåº“åŠ è½½å›¾åƒã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.9ã€‚</font><font style="vertical-align: inherit;">å¯é€‰ï¼šå¯¹å¶æ•°å’Œå¥‡æ•°è¡Œä½¿ç”¨ä¸åŒçš„å¸ƒå±€</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ›´æ”¹é€‚é…å™¨å®ç°ä»¥å¯¹å¶æ•°å’Œå¥‡æ•°è¡Œä½¿ç”¨ä¸åŒçš„å¸ƒå±€ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™éœ€è¦æ ¹æ®æ•°æ®ç±»å‹åˆ›å»ºä¸åŒçš„å¸ƒå±€ã€‚</font><font style="vertical-align: inherit;">åœ¨é€‚é…å™¨ä¸­ä½¿ç”¨getItemViewTypeï¼ˆï¼‰ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.10ã€‚</font><font style="vertical-align: inherit;">å¯é€‰ï¼šç½‘ç»œé”™è¯¯å¤„ç†</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚æœé‡åˆ°ç½‘ç»œæ•…éšœï¼Œè¯·æ˜¾ç¤ºâ€œé‡æ–°è¯·æ±‚â€æŒ‰é’®ï¼Œè€Œä¸æ˜¯ä¸»ç”¨æˆ·ç•Œé¢ã€‚ </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9.ç»ƒä¹ ï¼šä½¿ç”¨ç¿»æ–°ç‰ˆåœ¨Androidä¸Šè®¿é—®GitHub API </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬ç»ƒä¹ æè¿°äº†å¦‚ä½•ä½¿ç”¨Retrofitåœ¨Androidåº”ç”¨ç¨‹åºä¸­ä¸ºç”¨æˆ·åˆ—å‡ºæ‰€æœ‰GitHubå­˜å‚¨åº“ã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥ä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©å­˜å‚¨åº“ï¼Œå¹¶ä¸ºæ‰€é€‰å­˜å‚¨åº“æŒ‡å®šä¸ç”¨æˆ·ç›¸å…³çš„è®¨è®ºã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç„¶åï¼Œæ‚¨å¯ä»¥ä»å…¶ä»–ä¸‹æ‹‰å­—æ®µä¸­é€‰æ‹©ä¸€ä¸ªè®¨è®ºå¹¶å‘è¡¨è¯„è®ºã€‚</font><font style="vertical-align: inherit;">DialogFragmentå°†ç”¨äºè¾“å…¥èº«ä»½éªŒè¯å‡­æ®ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·ç¡®ä¿æ‚¨æ‹¥æœ‰ä¸€ä¸ªGithubå¸æˆ·ï¼Œå› ä¸ºè¿™æ˜¯æ­¤ç»ƒä¹ æ‰€å¿…éœ€çš„ã€‚</font><font style="vertical-align: inherit;">ç”±äºåœ¨æœ¬ç»ƒä¹ ä¸­Retrofitå°†ä¸RxJava2ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤ä¹Ÿè¯·æ³¨æ„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RxJava2 Tutorial</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.1ã€‚</font><font style="vertical-align: inherit;">é¡¹ç›®è®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºä¸€ä¸ªåä¸ºRetrofit Githubçš„Androidåº”ç”¨ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨com.vogella.android.retrofitgithubä½œä¸ºé¡¶çº§è½¯ä»¶åŒ…çš„åç§°ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªç©ºæ¨¡æ¿ã€‚</font><font style="vertical-align: inherit;">ç¡®ä¿é€‰ä¸­â€œå‘åå…¼å®¹â€æ ‡å¿—ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ä½¿ç”¨Retrofitå’Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RxJava2 CallAdapter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œè¯·å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ åˆ°build.gradleæ–‡ä»¶ä¸­</font></font><br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.3.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-gson:2.3.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:adapter-rxjava2:2.3.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'io.reactivex.rxjava2:rxandroid:2.0.1'</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨æ¸…å•ä¸­æ·»åŠ è®¿é—®Internetçš„æƒé™ã€‚ </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.retrofitgithub"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.retrofitgithub.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.2ã€‚</font><font style="vertical-align: inherit;">APIå®šä¹‰</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªæ•°æ®ç±»ï¼šGithubIssueå’ŒGithubRepoã€‚ </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.annotations.SerializedName; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubIssue</span></span></span><span class="hljs-class"> </span></span>{ String id; String title; String comments_url; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"body"</span></span>) String comment; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id + <span class="hljs-string"><span class="hljs-string">" - "</span></span> + title; } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubRepo</span></span></span><span class="hljs-class"> </span></span>{ String name; String owner; String url; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>(name + <span class="hljs-string"><span class="hljs-string">" "</span></span> + url); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»å­˜å‚¨åº“ä¿¡æ¯ä¸­ï¼Œä»…å­˜å‚¨åº“åç§°å’ŒURLå°†æ˜¾ç¤ºåœ¨ä¸‹æ‹‰åˆ—è¡¨ä¸­ã€‚æˆ‘ä»¬è¿˜å°†æ‰€æœ‰è€…æ·»åŠ åˆ°æ•°æ®ç±»ä¸­ï¼Œå› ä¸ºéœ€è¦æ‰€æœ‰è€…åç§°æ‰èƒ½è¯·æ±‚ä»¥åçš„è®¨è®ºã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬åœ¨ä¸‹æ‹‰å­—æ®µä¸­ä»…æ˜¾ç¤ºè®¨è®ºçš„IDå’Œæ ‡é¢˜ï¼Œå› æ­¤æˆ‘ä»¬ä¸ºæ¯ä¸ªå­—æ®µåˆ›å»ºä¸€ä¸ªå­—æ®µã€‚å¦å¤–ï¼Œæ¥è‡ªGithubçš„å“åº”åŒ…å«ä¸€ä¸ªç”¨äºå‘å¸ƒè¯„è®ºçš„URLï¼Œè¯¥URLå­˜å‚¨åœ¨comments_urlå­—æ®µä¸­ã€‚è¦ç¨ååœ¨Github APIä¸Šå‘å¸ƒæ–°è¯„è®ºï¼Œè¯·æ·»åŠ ä¸€ä¸ªåä¸ºcommentçš„å­—æ®µã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github API</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æŒ‡ç¤ºæ³¨é‡Šçš„å†…å®¹åº”ç»‘å®šåˆ°JSONè¯·æ±‚ä¸­åä¸ºbodyçš„å­—æ®µã€‚ç”±äºRetrofitï¼ˆdeï¼‰æ ¹æ®å…¶åç§°å¯¹æ‰€æœ‰å­—æ®µè¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶ä¸”ç”±äºæˆ‘ä»¬ä¸æƒ³åœ¨ä¸»ä½“GithubIssueç±»ä¸­ä½¿ç”¨ä¸»ä½“ä½œä¸ºå­—æ®µåç§°ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨@SerializedNameæ‰¹æ³¨ã€‚ä½¿ç”¨æ­¤æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹å°†å­—æ®µï¼ˆdeï¼‰åºåˆ—åŒ–ä¸ºJSONçš„åç§°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸å¹¸çš„æ˜¯ï¼ŒGithubRepoç±»ä¸è¶³ä»¥è¯·æ±‚æœ‰å…³å­˜å‚¨åº“çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ã€‚æ­£å¦‚ä½ å¯ä»¥çœ‹åˆ°</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œå­˜å‚¨åº“çš„æ‰€æœ‰è€…æ˜¯å­˜å‚¨åº“å“åº”ä¸­çš„ä¸€ä¸ªå•ç‹¬çš„JSONå¯¹è±¡ï¼Œå› æ­¤é€šå¸¸éœ€è¦é€‚å½“çš„Javaç±»æ¥ï¼ˆè¿›è¡Œåºåˆ—åŒ–ï¼‰ã€‚</font><font style="vertical-align: inherit;">å¹¸è¿çš„æ˜¯ï¼ŒRetrofitå…è®¸æ‚¨æ·»åŠ è‡ªå·±çš„ç±»å‹åŒ–JSONDeserializeræ¥æ§åˆ¶ç‰¹å®šç±»å‹çš„ååºåˆ—åŒ–ã€‚</font><font style="vertical-align: inherit;">æ¯æ¬¡éœ€è¦ååºåˆ—åŒ–æŸç§ç±»å‹çš„å¯¹è±¡æ—¶ï¼Œéƒ½ä¼šä½¿ç”¨æ­¤è‡ªå®šä¹‰ååºåˆ—åŒ–å™¨ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæ·»åŠ ä»¥ä¸‹GithubRepoDeserialzerç±»ã€‚</font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.JsonDeserializationContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.JsonDeserializer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.JsonElement; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.JsonObject; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.JsonParseException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.lang.reflect.Type; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubRepoDeserializer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JsonDeserializer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubRepo</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GithubRepo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deserialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JsonElement json, Type typeOfT, JsonDeserializationContext context)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> JsonParseException </span></span>{ GithubRepo githubRepo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GithubRepo(); JsonObject repoJsonObject = json.getAsJsonObject(); githubRepo.name = repoJsonObject.get(<span class="hljs-string"><span class="hljs-string">"name"</span></span>).getAsString(); githubRepo.url = repoJsonObject.get(<span class="hljs-string"><span class="hljs-string">"url"</span></span>).getAsString(); JsonElement ownerJsonElement = repoJsonObject.get(<span class="hljs-string"><span class="hljs-string">"owner"</span></span>); JsonObject ownerJsonObject = ownerJsonElement.getAsJsonObject(); githubRepo.owner = ownerJsonObject.get(<span class="hljs-string"><span class="hljs-string">"login"</span></span>).getAsString(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> githubRepo; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> é€šè¿‡ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIï¼š </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.reactivex.Single; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Body; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.POST; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Path; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Url; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GithubAPI</span></span></span><span class="hljs-class"> </span></span>{ String ENDPOINT = <span class="hljs-string"><span class="hljs-string">"https://api.github.com"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"user/repos?per_page=100"</span></span>) Single&lt;List&lt;GithubRepo&gt;&gt; getRepos(); <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"/repos/{owner}/{repo}/issues"</span></span>) Single&lt;List&lt;GithubIssue&gt;&gt; getIssues(<span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"owner"</span></span>) String owner, <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"repo"</span></span>) String repository); <span class="hljs-meta"><span class="hljs-meta">@POST</span></span> <span class="hljs-function"><span class="hljs-function">Single&lt;ResponseBody&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postComment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Url String url, @Body GithubIssue issue)</span></span></span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯èƒ½å¯¹@ Urlæ³¨é‡Šæœ‰ç–‘é—®ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨æ­¤æ³¨é‡Šï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæ­¤è¯·æ±‚çš„URLã€‚</font><font style="vertical-align: inherit;">è¿™ä½¿æˆ‘ä»¬èƒ½å¤ŸåŠ¨æ€æ›´æ”¹æ¯ä¸ªè¯·æ±‚çš„URLã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬éœ€è¦è¿™ä¸ªç”¨äºGithubIssueç±»çš„comment_urlå­—æ®µã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@è·¯å¾„æ³¨é‡Šå°†å‚æ•°å€¼ç»‘å®šåˆ°è¯·æ±‚URLä¸­çš„ç›¸åº”å˜é‡ï¼ˆå¤§æ‹¬å·ï¼‰ã€‚</font><font style="vertical-align: inherit;">è¿™å¯¹äºæŒ‡ç¤ºåº”è¯·æ±‚è®¨è®ºçš„å­˜å‚¨åº“çš„æ‰€æœ‰è€…å’Œåç§°æ˜¯å¿…éœ€çš„ã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.3ã€‚</font><font style="vertical-align: inherit;">åˆ›å»ºå‡­æ®å¯¹è¯æ¡†</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ä½¿ç”¨æˆ·èƒ½å¤Ÿå°†å…¶å‡­æ®å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥ä½¿ç”¨DialogFragmentã€‚</font><font style="vertical-align: inherit;">å› æ­¤ï¼Œåˆ›å»ºä»¥ä¸‹åä¸ºCredentialsDialogçš„ç±»ï¼Œå¹¶å°†ä¸€ä¸ªåä¸ºdialog_credentials.xmlçš„å¸ƒå±€æ–‡ä»¶æ·»åŠ åˆ°èµ„æºå¸ƒå±€æ–‡ä»¶å¤¹ä¸­ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç»“æœåº”ç±»ä¼¼äºä»¥ä¸‹å±å¹•æˆªå›¾ã€‚</font></font><br><br><img src="https://habrastorage.org/webt/uk/0w/r0/uk0wr0igypudl7pfpyms5yljllq.png"><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Fill you credentials here"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Username:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/username_edittext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_marginRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Password"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/password_edittext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.7"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:inputType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"textPassword"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Dialog; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.DialogInterface; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.annotation.NonNull; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v4.app.DialogFragment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AlertDialog; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.EditText; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Credentials; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CredentialsDialog</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DialogFragment</span></span></span><span class="hljs-class"> </span></span>{ EditText usernameEditText; EditText passwordEditText; ICredentialsDialogListener listener; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICredentialsDialogListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDialogPositiveClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username, String password)</span></span></span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAttach</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onAttach(context); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getActivity() <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ICredentialsDialogListener) { listener = (ICredentialsDialogListener) getActivity(); } } <span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Dialog </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateDialog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ View view = getActivity().getLayoutInflater().inflate(R.layout.dialog_credentials, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); usernameEditText = (EditText) view.findViewById(R.id.username_edittext); passwordEditText = (EditText) view.findViewById(R.id.password_edittext); usernameEditText.setText(getArguments().getString(<span class="hljs-string"><span class="hljs-string">"username"</span></span>)); passwordEditText.setText(getArguments().getString(<span class="hljs-string"><span class="hljs-string">"password"</span></span>)); AlertDialog.Builder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AlertDialog.Builder(getActivity()) .setView(view) .setTitle(<span class="hljs-string"><span class="hljs-string">"Credentials"</span></span>) .setNegativeButton(<span class="hljs-string"><span class="hljs-string">"Cancel"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) .setPositiveButton(<span class="hljs-string"><span class="hljs-string">"Continue"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DialogInterface.OnClickListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DialogInterface dialog, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> which)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (listener != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { listener.onDialogPositiveClick(usernameEditText.getText().toString(), passwordEditText.getText().toString()); } } }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> builder.create(); } }</code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9.4ã€‚</font><font style="vertical-align: inherit;">å»ºç«‹æ´»åŠ¨</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¦‚ä¸‹ä¿®æ”¹activity_main.xmlã€‚ </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/activity_main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.retrofitgithub.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">android.support.v7.widget.Toolbar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/my_toolbar"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"?attr/actionBarSize"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:background</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"?attr/colorPrimary"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:elevation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4dp"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:paddingBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/activity_vertical_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:paddingLeft</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/activity_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:paddingRight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/activity_horizontal_margin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:paddingTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/activity_vertical_margin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Spinner</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/repositories_spinner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Spinner</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/issues_spinner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/repositories_spinner"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/comment_edittext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/issues_spinner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:hint</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Your comment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:imeOptions</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"actionDone"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:inputType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:maxLines</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/loadRepos_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Load user repositories"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/send_comment_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_above</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/loadRepos_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Send comment"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸¤ä¸ªæŒ‰é’®ï¼ˆç”¨äºä¸‹è½½å­˜å‚¨åº“å’Œå‘é€è¯„è®ºï¼‰ï¼Œä¸¤ä¸ªSpinnerï¼ˆç”¨äºæ˜¾ç¤ºå­˜å‚¨åº“å’Œè®¨è®ºçš„ä¸‹æ‹‰å­—æ®µï¼‰å’ŒEditTextï¼ˆç”¨äºç¼–å†™è¯„è®ºï¼‰ã€‚</font><font style="vertical-align: inherit;">è¦å¯åŠ¨CredentialsDialogï¼Œè¯·ä½¿ç”¨Androidå·¥å…·æ ä¸Šçš„èœå•ã€‚</font><font style="vertical-align: inherit;">è¦åˆ›å»ºå®ƒï¼Œè¯·å°†åä¸ºmenu_main.xmlçš„èœå•xmlæ–‡ä»¶æ·»åŠ åˆ°èœå•èµ„æºæ–‡ä»¶å¤¹ä¸­ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰ã€‚</font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/menu_credentials"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Credentials"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">menu</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”±äºæˆ‘ä»¬ä½¿ç”¨å·¥å…·æ å°éƒ¨ä»¶ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹éœ€è¦ç¦ç”¨æ“ä½œæ ã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œå¦‚ä¸‹æ‰€ç¤ºä¿®æ”¹xmlæ ·å¼æ–‡ä»¶ã€‚</font></font><br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppTheme"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimary</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimaryDark"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimaryDark</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorAccent"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorAccent</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å°†æ‚¨çš„æ´»åŠ¨ä»£ç æ›´æ”¹ä¸ºä»¥ä¸‹å†…å®¹ã€‚ </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofitgithub; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.widget.Toolbar; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.Menu; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.MenuItem; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.AdapterView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.ArrayAdapter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.EditText; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Spinner; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.Gson; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.GsonBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.reactivex.android.schedulers.AndroidSchedulers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.reactivex.disposables.CompositeDisposable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.reactivex.observers.DisposableSingleObserver; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.reactivex.schedulers.Schedulers; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Credentials; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Interceptor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.OkHttpClient; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Request; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.ResponseBody; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.adapter.rxjava2.RxJava2CallAdapterFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.gson.GsonConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CredentialsDialog</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICredentialsDialogListener</span></span></span><span class="hljs-class"> </span></span>{ GithubAPI githubAPI; String username; String password; Spinner repositoriesSpinner; Spinner issuesSpinner; EditText commentEditText; Button sendButton; Button loadReposButtons; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CompositeDisposable compositeDisposable = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CompositeDisposable(); <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); Toolbar toolbar = (Toolbar) findViewById(R.id.my_toolbar); setSupportActionBar(toolbar); sendButton = (Button) findViewById(R.id.send_comment_button); repositoriesSpinner = (Spinner) findViewById(R.id.repositories_spinner); repositoriesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); repositoriesSpinner.setAdapter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"No repositories available"</span></span>})); repositoriesSpinner.setOnItemSelectedListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdapterView.OnItemSelectedListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onItemSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent, View view, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (parent.getSelectedItem() <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> GithubRepo) { GithubRepo githubRepo = (GithubRepo) parent.getSelectedItem(); compositeDisposable.add(githubAPI.getIssues(githubRepo.owner, githubRepo.name) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribeWith(getIssuesObserver())); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNothingSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(AdapterView&lt;?&gt; parent)</span></span></span><span class="hljs-function"> </span></span>{ } }); issuesSpinner = (Spinner) findViewById(R.id.issues_spinner); issuesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); issuesSpinner.setAdapter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"Please select repository"</span></span>})); commentEditText = (EditText) findViewById(R.id.comment_edittext); loadReposButtons = (Button) findViewById(R.id.loadRepos_button); createGithubAPI(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (compositeDisposable != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !compositeDisposable.isDisposed()) { compositeDisposable.dispose(); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateOptionsMenu</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Menu menu)</span></span></span><span class="hljs-function"> </span></span>{ getMenuInflater().inflate(R.menu.menu_main, menu); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOptionsItemSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MenuItem item)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (item.getItemId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.id.menu_credentials: showCredentialsDialog(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onOptionsItemSelected(item); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showCredentialsDialog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ CredentialsDialog dialog = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CredentialsDialog(); Bundle arguments = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Bundle(); arguments.putString(<span class="hljs-string"><span class="hljs-string">"username"</span></span>, username); arguments.putString(<span class="hljs-string"><span class="hljs-string">"password"</span></span>, password); dialog.setArguments(arguments); dialog.show(getSupportFragmentManager(), <span class="hljs-string"><span class="hljs-string">"credentialsDialog"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGithubAPI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Gson gson = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder() .setDateFormat(<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd'T'HH:mm:ssZ"</span></span>) .registerTypeAdapter(GithubRepo.class, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GithubRepoDeserializer()) .create(); OkHttpClient okHttpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OkHttpClient.Builder() .addInterceptor(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Interceptor() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> okhttp3.<span class="hljs-function"><span class="hljs-function">Response </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intercept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Chain chain)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ Request originalRequest = chain.request(); Request.Builder builder = originalRequest.newBuilder().header(<span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>, Credentials.basic(username, password)); Request newRequest = builder.build(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chain.proceed(newRequest); } }).build(); Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(GithubAPI.ENDPOINT) .client(okHttpClient) .addCallAdapterFactory(RxJava2CallAdapterFactory.create()) .addConverterFactory(GsonConverterFactory.create(gson)) .build(); githubAPI = retrofit.create(GithubAPI.class); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (view.getId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.id.loadRepos_button: compositeDisposable.add(githubAPI.getRepos() .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribeWith(getRepositoriesObserver())); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.id.send_comment_button: String newComment = commentEditText.getText().toString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!newComment.isEmpty()) { GithubIssue selectedItem = (GithubIssue) issuesSpinner.getSelectedItem(); selectedItem.comment = newComment; compositeDisposable.add(githubAPI.postComment(selectedItem.comments_url, selectedItem) .subscribeOn(Schedulers.io()) .observeOn(AndroidSchedulers.mainThread()) .subscribeWith(getCommentObserver())); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Please enter a comment"</span></span>, Toast.LENGTH_LONG).show(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DisposableSingleObserver&lt;List&lt;GithubRepo&gt;&gt; getRepositoriesObserver() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisposableSingleObserver&lt;List&lt;GithubRepo&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;GithubRepo&gt; value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value.isEmpty()) { ArrayAdapter&lt;GithubRepo&gt; spinnerAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, value); repositoriesSpinner.setAdapter(spinnerAdapter); repositoriesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ArrayAdapter&lt;String&gt; spinnerAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"User has no repositories"</span></span>}); repositoriesSpinner.setAdapter(spinnerAdapter); repositoriesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable e)</span></span></span><span class="hljs-function"> </span></span>{ e.printStackTrace(); Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Can not load repositories"</span></span>, Toast.LENGTH_SHORT).show(); } }; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DisposableSingleObserver&lt;List&lt;GithubIssue&gt;&gt; getIssuesObserver() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisposableSingleObserver&lt;List&lt;GithubIssue&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;GithubIssue&gt; value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!value.isEmpty()) { ArrayAdapter&lt;GithubIssue&gt; spinnerAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, value); issuesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); commentEditText.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); sendButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); issuesSpinner.setAdapter(spinnerAdapter); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { ArrayAdapter&lt;String&gt; spinnerAdapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter&lt;&gt;(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_spinner_dropdown_item, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"Repository has no issues"</span></span>}); issuesSpinner.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); commentEditText.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); sendButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); issuesSpinner.setAdapter(spinnerAdapter); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable e)</span></span></span><span class="hljs-function"> </span></span>{ e.printStackTrace(); Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Can not load issues"</span></span>, Toast.LENGTH_SHORT).show(); } }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> DisposableSingleObserver&lt;ResponseBody&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCommentObserver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DisposableSingleObserver&lt;ResponseBody&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ResponseBody value)</span></span></span><span class="hljs-function"> </span></span>{ commentEditText.setText(<span class="hljs-string"><span class="hljs-string">""</span></span>); Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Comment created"</span></span>, Toast.LENGTH_LONG).show(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable e)</span></span></span><span class="hljs-function"> </span></span>{ e.printStackTrace(); Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Can not create comment"</span></span>, Toast.LENGTH_SHORT).show(); } }; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDialogPositiveClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String username, String password)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.username = username; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.password = password; loadReposButtons.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åœ¨GsonBuilderä¸­æ·»åŠ äº†å…ˆå‰åˆ›å»ºçš„GithubRepoDeserializerä½œä¸ºTypeAdapterã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†å¤„ç†æ¯ä¸ªå‘¼å«çš„èº«ä»½éªŒè¯ï¼Œå·²å°†ä¸€ä¸ª</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interceptor</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ·»åŠ </font><font style="vertical-align: inherit;">åˆ°OkHttpClientã€‚</font><font style="vertical-align: inherit;">ä¸ºäº†ä½¿APIæ–¹æ³•è¿”å›RxJava2ç±»å‹ï¼Œæˆ‘ä»¬å‘å®¢æˆ·ç«¯æ·»åŠ äº†RxJava2 CallAdapterã€‚</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10.ç»ƒä¹ ï¼šå°†ç¿»æ–°ä¸OAuthç»“åˆä½¿ç”¨ä»¥ä»Androidä¸Šçš„Twitterè¯·æ±‚ç”¨æˆ·ä¿¡æ¯ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬ç»ƒä¹ æè¿°äº†å¦‚ä½•åœ¨Androidä¸Šä½¿ç”¨Retrofitè®¿é—®Twitterã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªå¯ä»¥è¯·æ±‚å¹¶æ˜¾ç¤ºæ‰€æä¾›ç”¨æˆ·åçš„ç”¨æˆ·æ•°æ®çš„åº”ç”¨ç¨‹åºã€‚</font><font style="vertical-align: inherit;">åœ¨æœ¬ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»…</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">Twitterèº«ä»½éªŒè¯åº”ç”¨ç¨‹åº</font></a><font style="vertical-align: inherit;">å’ŒOAuth 2è¿›è¡Œæˆæƒã€‚</font><font style="vertical-align: inherit;">ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦æ‹¥æœ‰ä¸€ä¸ªTwitterå¸æˆ·ã€‚</font><font style="vertical-align: inherit;">æ­¤å¤–ï¼Œæ‚¨éœ€è¦è½¬åˆ°</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Twitteråº”ç”¨ç¨‹åº</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¹¶åˆ›å»ºä¸€ä¸ªæ–°åº”ç”¨ç¨‹åºä»¥è·å–æ‚¨çš„æ¶ˆè´¹è€…å¯†é’¥å’Œæ¶ˆè´¹è€…ç§˜å¯†ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ç¨åå°†éœ€è¦æ­¤è¯·æ±‚æˆ‘ä»¬çš„OAuthä»¤ç‰Œã€‚</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.1ã€‚</font><font style="vertical-align: inherit;">é¡¹ç›®è®¾ç½®</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åˆ›å»ºä¸€ä¸ªåä¸ºRetrofit Twitterçš„Androidåº”ç”¨ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨com.vogella.android.retrofittwitterä½œä¸ºé¡¶çº§è½¯ä»¶åŒ…çš„åç§°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¦ä½¿ç”¨Retrofitï¼Œè¯·å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°build.gradleæ–‡ä»¶ä¸­</font></font><br><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:retrofit:2.1.0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-string"><span class="hljs-string">'com.squareup.retrofit2:converter-gson:2.1.0'</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨æ¸…å•ä¸­æ·»åŠ è®¿é—®Internetçš„æƒé™ã€‚ </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.retrofittwitter"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@mipmap/ic_launcher"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/app_name"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:supportsRtl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@style/AppTheme"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.2ã€‚</font><font style="vertical-align: inherit;">APIå®šä¹‰</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªæ•°æ®ç±»ï¼Œåˆ†åˆ«ç§°ä¸ºOAuthTokenå’ŒUserDetailsã€‚ </font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofittwitter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.gson.annotations.SerializedName; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OAuthToken</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"access_token"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String accessToken; <span class="hljs-meta"><span class="hljs-meta">@SerializedName</span></span>(<span class="hljs-string"><span class="hljs-string">"token_type"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String tokenType; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAccessToken</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> accessToken; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTokenType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tokenType; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAuthorization</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getTokenType() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + getAccessToken(); } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofittwitter; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDetails</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String location; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String description; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String url; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLocation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> location; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setLocation</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String location)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.location = location; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> description; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDescription</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String description)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.description = description; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUrl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> url; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUrl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.url = url; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OAuthTokenç±»ç”¨äºå­˜å‚¨æˆ‘ä»¬ä»Twitterè¯·æ±‚çš„æ‰¿è½½ä»¤ç‰Œä»¥åŠå¯†é’¥å’Œæœºå¯†ã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä½¿ç”¨@ SerializedNameæ‰¹æ³¨å°†åç§°Retrofitè®¾ç½®ä¸ºï¼ˆå–æ¶ˆï¼‰åºåˆ—åŒ–å­—æ®µã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¯·æ±‚ç”¨æˆ·ä¿¡æ¯æ—¶ï¼ŒUserDetailsç±»ä»…ä¿å­˜Twitterå“åº”ä¸­çš„å¤šä¸ªå­—æ®µã€‚</font><font style="vertical-align: inherit;">æˆ‘ä»¬ä¸ä¼šæ˜¾ç¤ºå“åº”ä¸­åŒ…å«çš„æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼Œåªä¼šæ˜¾ç¤ºåç§°ï¼Œä½ç½®ï¼ŒURLå’Œæè¿°ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">é€šè¿‡ä»¥ä¸‹æ¥å£å®šä¹‰ç”¨äºæ”¹é€ çš„REST APIï¼š</font></font><br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofittwitter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Field; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.FormUrlEncoded; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.GET; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.POST; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.http.Query; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TwitterApi</span></span></span><span class="hljs-class"> </span></span>{ String BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://api.twitter.com/"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@FormUrlEncoded</span></span> <span class="hljs-meta"><span class="hljs-meta">@POST</span></span>(<span class="hljs-string"><span class="hljs-string">"oauth2/token"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;OAuthToken&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postCredentials</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Field(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"grant_type"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String grantType)</span></span>; <span class="hljs-meta"><span class="hljs-meta">@GET</span></span>(<span class="hljs-string"><span class="hljs-string">"/1.1/users/show.json"</span></span>) <span class="hljs-function"><span class="hljs-function">Call&lt;UserDetails&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserDetails</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@Query(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"screen_name"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String name)</span></span>; }</code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.3ã€‚</font><font style="vertical-align: inherit;">å»ºç«‹æ´»åŠ¨</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¿®æ”¹activity_main.xmlæ–‡ä»¶å’Œç›¸åº”çš„MainActivityç±»ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </font></font><br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:tools</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/tools"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/activity_main"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tools:context</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vogella.android.retrofittwitter.MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/username_container"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentTop</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/username_textview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Username:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">EditText</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/username_edittext"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:imeOptions</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"actionDone"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:inputType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:maxLines</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/request_token_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_alignParentBottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Request token"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/request_user_details_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_above</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/request_token_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onClick"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Request user details"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_above</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/request_user_details_button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_below</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/username_container"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Name:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/name_textview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"---"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Location:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/location_textview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"---"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Url:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/url_textview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"---"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:minHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50dp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Description:"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TextView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/description_textview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_weight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:gravity</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center_vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:text</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"---"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RelativeLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vogella.android.retrofittwitter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.support.v7.app.AppCompatActivity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.view.View; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.EditText; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.TextView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Credentials; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Interceptor; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.OkHttpClient; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> okhttp3.Request; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Call; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Callback; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Response; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.Retrofit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> retrofit2.converter.gson.GsonConverterFactory; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String credentials = Credentials.basic(<span class="hljs-string"><span class="hljs-string">"aConsumerKey"</span></span>, <span class="hljs-string"><span class="hljs-string">"aSecret"</span></span>); Button requestTokenButton; Button requestUserDetailsButton; EditText usernameEditText; TextView usernameTextView; TextView nameTextView; TextView locationTextView; TextView urlTextView; TextView descriptionTextView; TwitterApi twitterApi; OAuthToken token; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); requestTokenButton = (Button) findViewById(R.id.request_token_button); requestUserDetailsButton = (Button) findViewById(R.id.request_user_details_button); usernameEditText = (EditText) findViewById(R.id.username_edittext); usernameTextView = (TextView) findViewById(R.id.username_textview); nameTextView = (TextView) findViewById(R.id.name_textview); locationTextView = (TextView) findViewById(R.id.location_textview); urlTextView = (TextView) findViewById(R.id.url_textview); descriptionTextView = (TextView) findViewById(R.id.description_textview); createTwitterApi(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createTwitterApi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ OkHttpClient okHttpClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OkHttpClient.Builder().addInterceptor(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Interceptor() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> okhttp3.<span class="hljs-function"><span class="hljs-function">Response </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">intercept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Chain chain)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ Request originalRequest = chain.request(); Request.Builder builder = originalRequest.newBuilder().header(<span class="hljs-string"><span class="hljs-string">"Authorization"</span></span>, token != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? token.getAuthorization() : credentials); Request newRequest = builder.build(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chain.proceed(newRequest); } }).build(); Retrofit retrofit = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Retrofit.Builder() .baseUrl(TwitterApi.BASE_URL) .client(okHttpClient) .addConverterFactory(GsonConverterFactory.create()) .build(); twitterApi = retrofit.create(TwitterApi.class); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View view)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (view.getId()) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.id.request_token_button: twitterApi.postCredentials(<span class="hljs-string"><span class="hljs-string">"client_credentials"</span></span>).enqueue(tokenCallback); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> R.id.request_user_details_button: String editTextInput = usernameEditText.getText().toString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!editTextInput.isEmpty()) { twitterApi.getUserDetails(editTextInput).enqueue(userDetailsCallback); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Please provide a username"</span></span>, Toast.LENGTH_LONG).show(); } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } Callback&lt;OAuthToken&gt; tokenCallback = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Callback&lt;OAuthToken&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;OAuthToken&gt; call, Response&lt;OAuthToken&gt; response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.isSuccessful()) { requestTokenButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); requestUserDetailsButton.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); usernameTextView.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); usernameEditText.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); token = response.body(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Failure while requesting token"</span></span>, Toast.LENGTH_LONG).show(); Log.d(<span class="hljs-string"><span class="hljs-string">"RequestTokenCallback"</span></span>, <span class="hljs-string"><span class="hljs-string">"Code: "</span></span> + response.code() + <span class="hljs-string"><span class="hljs-string">"Message: "</span></span> + response.message()); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;OAuthToken&gt; call, Throwable t)</span></span></span><span class="hljs-function"> </span></span>{ t.printStackTrace(); } }; Callback&lt;UserDetails&gt; userDetailsCallback = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Callback&lt;UserDetails&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResponse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;UserDetails&gt; call, Response&lt;UserDetails&gt; response)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.isSuccessful()) { UserDetails userDetails = response.body(); nameTextView.setText(userDetails.getName() == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? <span class="hljs-string"><span class="hljs-string">"no value"</span></span> : userDetails.getName()); locationTextView.setText(userDetails.getLocation() == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? <span class="hljs-string"><span class="hljs-string">"no value"</span></span> : userDetails.getLocation()); urlTextView.setText(userDetails.getUrl() == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? <span class="hljs-string"><span class="hljs-string">"no value"</span></span> : userDetails.getUrl()); descriptionTextView.setText(userDetails.getDescription().isEmpty() ? <span class="hljs-string"><span class="hljs-string">"no value"</span></span> : userDetails.getDescription()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Toast.makeText(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Failure while requesting user details"</span></span>, Toast.LENGTH_LONG).show(); Log.d(<span class="hljs-string"><span class="hljs-string">"UserDetailsCallback"</span></span>, <span class="hljs-string"><span class="hljs-string">"Code: "</span></span> + response.code() + <span class="hljs-string"><span class="hljs-string">"Message: "</span></span> + response.message()); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFailure</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Call&lt;UserDetails&gt; call, Throwable t)</span></span></span><span class="hljs-function"> </span></span>{ t.printStackTrace(); } }; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç”¨ä»Twitteræ”¶åˆ°çš„ä½¿ç”¨è€…å¯†é’¥å’Œæœºå¯†æ›¿æ¢aConsumerKeyå’ŒaSecretã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è¿˜è¦çœ‹çœ‹æˆ‘ä»¬æ·»åŠ åˆ°Retrofitå®¢æˆ·ç«¯çš„æ‹¦æˆªå™¨ã€‚</font><font style="vertical-align: inherit;">ç”±äºæˆ‘ä»¬ä½¿ç”¨OAuthï¼Œå› æ­¤æ¯ä¸ªè°ƒç”¨çš„å‡­æ®éƒ½ä¸åŒã€‚</font><font style="vertical-align: inherit;">postCredentialsæ–¹æ³•å¿…é¡»åœ¨åŸºæœ¬Twitteræ¶æ„ä¸­å‘å¸ƒå‡­æ®ï¼ˆç”¨æˆ·å¯†é’¥å’Œæœºå¯†ï¼‰ã€‚</font><font style="vertical-align: inherit;">ç»“æœï¼Œæ­¤è°ƒç”¨è¿”å›æ‰¿è½½ä»¤ç‰Œï¼ŒRetrofitå°†å…¶ååºåˆ—åŒ–ä¸ºæˆ‘ä»¬çš„OAuthTokenç±»ï¼Œç„¶åå°†å…¶å­˜å‚¨åœ¨ä»¤ç‰Œå­—æ®µä¸­ã€‚</font><font style="vertical-align: inherit;">ç°åœ¨ï¼Œä»»ä½•å…¶ä»–è¯·æ±‚éƒ½å¯ä»¥ï¼ˆå¹¶ä¸”åº”è¯¥ï¼‰å°†æ­¤ä»¤ç‰Œç”¨ä½œæˆæƒå‡­è¯ã€‚</font><font style="vertical-align: inherit;">è¿˜è¦æ±‚æä¾›ç”¨æˆ·ä¿¡æ¯ã€‚</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11.æ”¹é€ èµ„æº </font></font></h1><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨Retrofitçš„æ¶ˆè´¹APIæ•™ç¨‹</font></font><br></a> <br> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ‰å…³ä½¿ç”¨Retrofitçš„</font></font><br></a> <font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">æ¶ˆè´¹APIçš„</font></a><a href=""><font style="vertical-align: inherit;">éƒ¨é—¨åšå®¢ç³»åˆ—ä¸­</font></a></font><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font><br></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428736/">https://habr.com/ru/post/zh-CN428736/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428726/index.html">å‘˜å·¥æ‹›è˜ã€‚ å¦‚ä½•ä¸è¸©åŒä¸€æŠŠè€™å­</a></li>
<li><a href="../zh-CN428728/index.html">App Storeè¯„è®ºï¼š15æ¬¡å°è¯•é¦–æ¬¡å‘å¸ƒï¼Œæˆ–â€œæ‚¨ä¸ä¼šé€šè¿‡ï¼â€</a></li>
<li><a href="../zh-CN428730/index.html">æµ®åŠ¨å¼å¤ªé˜³èƒ½ç”µæ± æ¿-æ°´åŠ›å‘ç”µå‚çš„é‡è¦å…±ç”Ÿä½“</a></li>
<li><a href="../zh-CN428732/index.html">å¦‚ä½•ä½¿PHP7ä¸­çš„æ‰©å±•æ¯”â€œ helloï¼Œworldâ€æ›´å›°éš¾ï¼Œå¹¶ä¸”ä¸è‡´äºçœ¼èŠ±redä¹±ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN428734/index.html">è‡ª1974å¹´ä»¥æ¥åœ¨Windowsä¸­ä¸€ç›´å­˜åœ¨çš„é”™è¯¯</a></li>
<li><a href="../zh-CN428738/index.html">ä½¿ç”¨Neuronåœ¨Visual Studio Codeä¸­è¿›è¡Œæ•°æ®ç§‘å­¦</a></li>
<li><a href="../zh-CN428740/index.html">é‡å­ç½‘ç»œï¼šå®æ–½çš„å‰æ™¯å’Œå›°éš¾</a></li>
<li><a href="../zh-CN428744/index.html">jDrum StudioèŠ‚å¥æ¨¡æ‹Ÿå™¨</a></li>
<li><a href="../zh-CN428746/index.html">CRC16æ ¡éªŒå’Œå¯é æ€§</a></li>
<li><a href="../zh-CN428748/index.html">é€‚ç”¨äºç§»åŠ¨å¼€å‘äººå‘˜273çš„æœ‰è¶£ææ–™çš„æ‘˜è¦ï¼ˆ10æœˆ29æ—¥è‡³11æœˆ4æ—¥ï¼‰</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>