<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüè≠ üëéüèø üö≥ C√≥mo Pusher Channels entreg√≥ 10,000,000,000,000 de mensajes ya üïç üÖæÔ∏è üëâüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Recientemente encontr√© una descripci√≥n bastante interesante de la arquitectura de los canales Pusher y decid√≠ traducirla para usted. En mi opini√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo Pusher Channels entreg√≥ 10,000,000,000,000 de mensajes ya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415337/"><p> <em>Hola</em>  <em>Recientemente encontr√© una descripci√≥n bastante interesante de la arquitectura de los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canales Pusher</a> y decid√≠ traducirla para usted.</em>  <em>En mi opini√≥n, el autor describi√≥ muy f√°cilmente los enfoques para construir una arquitectura altamente cargada y escalable.</em>  <em>Lo m√°s probable es que el art√≠culo sea √∫til para principiantes, as√≠ como para especialistas de campos relacionados.</em> </p><br><p>  En la oficina de Pusher, tenemos un peque√±o mostrador con un n√∫mero cada vez mayor.  Muestra el n√∫mero de mensajes entregados para toda la existencia de canales Pusher.  El viernes a las 22:20 UTC, el n√∫mero aument√≥ en una categor√≠a y alcanz√≥ los 10,000,000,000,000.  Tiene 13 ceros - 10 billones. </p><br><p><img src="https://habrastorage.org/webt/za/kb/dw/zakbdwmmhgz5p8hg5oxvhbi-jdc.jpeg"></p><br><p>  Puede pensar que el recuento total de mensajes es una m√©trica hinchada in√∫til.  Pero ese n√∫mero es un indicador clave del √©xito de Pusher Channels, nuestro producto de comunicaci√≥n en tiempo real.  En primer lugar, este contador refleja la confianza depositada en nosotros por los usuarios.  En segundo lugar, mide la escalabilidad de nuestro sistema.  Para aumentar el n√∫mero, en Pusher debemos asegurarnos de que los usuarios conf√≠en en el env√≠o de mensajes a nuestro servicio, y debemos estar seguros de que nuestro sistema es capaz de procesar estos mensajes.  Pero, ¬øqu√© debemos entregar 10 billones de mensajes?  A ver </p><a name="habracut"></a><br><p>  Alrededor de 200,000 mensajes se env√≠an por segundo a trav√©s de los canales Pusher, y millones en las horas pico.  Por ejemplo, cuando el New York Times utiliz√≥ el servicio para mantener a sus lectores informados sobre el progreso de las elecciones presidenciales de los Estados Unidos. </p><br><p>  Veamos primero los canales Pusher como una gran caja negra a trav√©s de la cual van todos estos mensajes: </p><br><p><img src="https://habrastorage.org/webt/q8/ly/tt/q8lyttjmuao2gkkgkfbjavnx120.png"></p><br><p>  Pusher Channels es un sistema de tipo publicaci√≥n-suscripci√≥n.  Los clientes se suscriben a canales (por ejemplo, "btc-usd" o "private-user-jim"), mientras que otros clientes les env√≠an mensajes.  Si un mill√≥n de personas est√°n suscritas al canal "btc-usd" y alguien env√≠a el costo real de bitcoin all√≠, entonces los canales Pusher deber√°n entregar un mill√≥n de mensajes.  Hacemos esto en unos pocos milisegundos. </p><br><p>  Un servidor no puede entregar tantos mensajes en tan poco tiempo.  Por lo tanto, utilizamos tres t√©cnicas probadas en el tiempo: abanico, fragmentaci√≥n y equilibrio de carga.  Veamos qu√© hay en la caja negra. </p><br><p><img src="https://habrastorage.org/webt/fe/vx/rx/fevxrxzehjg1squjlnjqoa473sq.png"></p><br><p>  Millones de suscriptores se distribuyen en aproximadamente 170 potentes servidores perimetrales, cada uno de los cuales tiene aproximadamente 20,000 conexiones.  Cada uno de estos servidores recuerda la lista de canales que son interesantes para sus clientes y se suscribe a ellos en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">servicio</a> central de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Redis</a> .  Incluso si 2000 clientes est√°n interesados ‚Äã‚Äãen "btc-usd" en el servidor perimetral, solo necesita suscribirse una vez.  Por lo tanto, cuando llega un nuevo mensaje al canal, Redis env√≠a 170 mensajes a servidores perimetrales, que ya env√≠an 20,000 mensajes a sus suscriptores.  Este enfoque se llama despliegue. </p><br><p>  Pero el despliegue no es suficiente para nosotros, porque todav√≠a hay un componente central de Redis a trav√©s del cual pasan todos los que env√≠an mensajes.  Esta centralizaci√≥n limita el n√∫mero de mensajes enviados por segundo.  Para evitar esta limitaci√≥n, el servicio central de Redis consta de muchos fragmentos de Redis.  Cada canal, a su vez, se adjunta al fragmento Redis mediante el hash de su nombre.  Cuando el cliente quiere enviar un mensaje, va al servicio de descanso.  Este √∫ltimo codifica el nombre del canal y, en funci√≥n del resultado, determina el fragmento Redis necesario al que se debe enviar el mensaje.  Este enfoque se llama fragmentaci√≥n. </p><br><p>  Parece que solo estamos cambiando la centralizaci√≥n de un servicio Redis a un servicio de descanso.  Pero esto no es as√≠, ya que el servicio de descanso en s√≠ consta de unos 90 servidores que realizan el mismo trabajo: reciben solicitudes de publicaci√≥n, calculan fragmentos de Redis y les env√≠an mensajes.  Cuando un editor quiere enviar un mensaje, va a uno de los muchos servidores de descanso.  Este enfoque se llama equilibrio de carga. </p><br><p>  Juntos, el abanico, el fragmentaci√≥n y el equilibrio de carga permiten que el sistema tenga un componente central.  Esta propiedad es clave para lograr la escalabilidad horizontal, que permite enviar millones de mensajes por segundo. </p><br><p>  Examinamos los componentes centrales del servicio Pusher Channels, pero hay otras partes, como las m√©tricas (c√≥mo obtenemos este n√∫mero de 10 billones), webhooks (c√≥mo informamos a los clientes sobre eventos interesantes), autorizaci√≥n (restricci√≥n de acceso a canales), datos sobre activos usuarios, limitaci√≥n de tarifas (¬øc√≥mo nos aseguramos de que nuestros clientes usen exactamente tantos recursos como pagaron y que no interfieran con otros clientes)?  Toda esta funcionalidad adicional debe implementarse sin sacrificar el ancho de banda, el tiempo de entrega de mensajes y la disponibilidad de nuestro servicio en su conjunto. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415337/">https://habr.com/ru/post/es415337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415327/index.html">El teorema de Pit√°goras fue utilizado por los constructores de Stonehenge 2000 a√±os antes del nacimiento del propio Pit√°goras.</a></li>
<li><a href="../es415329/index.html">Toda la verdad sobre RTOS de Colin Walls. Art√≠culo # 3. Tareas y planificaci√≥n</a></li>
<li><a href="../es415331/index.html">Impresoras de construcci√≥n para imprentas de 5-6 pisos se producen en Yaroslavl</a></li>
<li><a href="../es415333/index.html">Arduino - transmisor de radiodifusi√≥n AM micropoderoso</a></li>
<li><a href="../es415335/index.html">Tutorial de fondo de Android. Parte 5: Corutinas en Kotlin</a></li>
<li><a href="../es415341/index.html">Cursos de administraci√≥n de PostgreSQL</a></li>
<li><a href="../es415343/index.html"># 2 HACKATON para j√≥venes profesionales en Perm</a></li>
<li><a href="../es415345/index.html">Consejos para decidir convertirse en desarrollador de iOS</a></li>
<li><a href="../es415347/index.html">2. Basado en Meyers "C ++ efectivo y moderno" - detalles de inferencia de tipo de plantilla para matrices</a></li>
<li><a href="../es415349/index.html">Kubernetes 1.11: una visi√≥n general de las principales innovaciones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>