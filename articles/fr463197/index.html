<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüöí üë©üèΩ‚Äçüé® üëõ Blazor + MVVM = Silverlight riposte parce que le mal ancien est invincible üëéüèΩ üë©üèΩ‚Äçüé® üëµüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 

 Alors oui, net core 3.0 arrive bient√¥t et il y aura un mod√®le de projet avec Blazor comme l'un des mod√®les par d√©faut. Le nom du cad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blazor + MVVM = Silverlight riposte parce que le mal ancien est invincible</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463197/">  Bonjour, Habr! <br><br>  Alors oui, net core 3.0 arrive bient√¥t et il y aura un mod√®le de projet avec Blazor comme l'un des mod√®les par d√©faut.  Le nom du cadre, √† mon avis, est similaire au nom de certains Pok√©mon.  Blazor entre dans la bataille!  J'ai d√©cid√© de regarder de quel type d'animal il s'agit et avec quoi il est mang√©, alors j'ai fait une feuille Todo dessus.  Eh bien, sur Vue.js aussi, pour la comparaison avec le sujet car √† mon avis, ils sont similaires au syst√®me de composants en termes de r√©activit√©, et c'est tout.  Plus de dieux dieux dieux!  En fait, c'est un guide pour les jeunes esprits, pas forts qui sont trop paresseux pour apprendre TypeScript ou JavaScript et qui veulent faire des boutons et des entr√©es sur le site.  Comme dans ce meme - "Le technicien voulait √©crire un livre mais l'instruction s'est av√©r√©e."  Qui s'int√©resse √† mes aventures en front end ou qui d√©couvre quel genre de Blazor vous √™tes les bienvenus pour chat. <a name="habracut"></a><br><br><h2>  Pr√©sentation </h2><br>  Microsoft a eu l'id√©e de travailler en C # dans un navigateur et a appel√© cette id√©e Silverlight.  √áa n'a pas d√©coll√©.  Ces tyrnets √©taient alors diff√©rents comme des navigateurs.  Pourquoi est-ce que je pense que √ßa d√©colle maintenant?  Parce que maintenant les assemblys web sont par d√©faut dans tous les navigateurs modernes.  Il n'est pas n√©cessaire d'installer une extension distincte.  Un autre probl√®me est la taille des applications.  Si Vue.js SPA p√®se 1,7 m√©gaoctets, alors exactement la m√™me chose sur Blazor 21 m√©gaoctets.  Maintenant, Internet est devenu plus rapide et plus fiable que pendant Silverlight et vous devez t√©l√©charger l'application une fois, puis il y a le cache et tout le travail.  En g√©n√©ral, Blazor semblait tr√®s similaire √† Vue.js.  Et donc, en hommage √† Silverligtht, WPF et UWP, et juste parce qu'il √©tait si courant chez les aff√ªteurs, j'ai d√©cid√© d'utiliser le mod√®le MVVM pour mon projet.  Donc pour r√©f√©rence - je suis g√©n√©ralement un back-end et j'ai aim√© Blazor.  Je pr√©viens les √¢mes sensibles - La conception et la mise en page dans mes exemples sont terribles, et dans le projet avec Vue.js, un √©crivain exp√©riment√© peut voir beaucoup de govnokod.  Eh bien, avec l'orthographe et la ponctuation, les choses sont aussi comme √ßa. <br><br><h2>  Les r√©f√©rences </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple Todo sur Vue + Vuex</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple de Todo sur Blazor</a> <br><br><h2>  Mod√®les de placement </h2><br><ol><li>  C√¥t√© client.  Un SPA standard qui peut √™tre distribu√© de diff√©rentes mani√®res.  Dans mon exemple, j'ai utilis√© un mod√®le dans lequel les fichiers d'application sont envoy√©s au serveur de navigateur sur le noyau asp.net.  L'inconv√©nient de cette approche r√©side dans les 21 m√©gaoctets que vous devez t√©l√©charger sur le navigateur. </li><li>  C√¥t√© serveur.  Tout se passe sur le serveur, et le DOM fini est transmis au client via des sockets.  Le navigateur n'a pas besoin de t√©l√©charger quoi que ce soit au d√©but, mais √† la place, t√©l√©chargez constamment le DOM mis √† jour en morceaux.  Eh bien, la charge enti√®re sur le code client tombe soudainement sur le serveur. </li></ol><br>  Personnellement, j'aime davantage la premi√®re option et je peux l'utiliser dans tous ces cas lorsque vous n'avez pas √† vous soucier des conversions d'utilisateurs.  Par exemple, il s'agit d'une sorte de syst√®me d'information interne de l'entreprise ou d'une solution B2B sp√©cialis√©e car Blazor t√©l√©charge depuis longtemps pour la premi√®re fois.  Si vos utilisateurs se connectent constamment √† votre application, ils ne remarqueront aucune diff√©rence avec la version JS.  Si un utilisateur clique sur un lien publicitaire, regardez simplement quel type de site est l√†, tr√®s probablement il n'attendra pas longtemps que le site se charge et quitte.  Dans ce cas, il est pr√©f√©rable d'utiliser la deuxi√®me option de placement, c'est-√†-dire  Blazor c√¥t√© serveur <br><br><h2>  Cr√©ation de projet </h2><br>  T√©l√©charger net core 3.0 <a href="">dotnet.microsoft.com/download/dotnet-core/3.0</a> <br>  Ex√©cutez la commande dans le terminal qui chargera les mod√®les n√©cessaires pour vous. <br><br><pre><code class="bash hljs">dotnet new -i Microsoft.AspNetCore.Blazor.Templates</code> </pre> <br>  Pour cr√©er un c√¥t√© serveur <br><br><pre> <code class="bash hljs">dotnet new blazorserverside -o MyWebApp</code> </pre><br>  Pour le c√¥t√© client dont les fichiers seront distribu√©s par le serveur principal asp.net <br><br><pre> <code class="bash hljs">dotnet new blazorhosted -o MyWebApp</code> </pre><br>  Si vous vouliez l'exotisme et avez soudainement d√©cid√© de ne pas utiliser le noyau asp.net comme serveur, mais autre chose (en avez-vous besoin?) Vous pouvez cr√©er uniquement un client sans serveur avec cette commande. <br><br><pre> <code class="bash hljs">dotnet new blazor -o MyWebApp</code> </pre><br><h2>  Liaisons </h2><br>  Prend en charge la liaison unidirectionnelle et bidirectionnelle.  Donc oui, vous n'avez besoin d'aucun OnPropertichanged comme dans WPF.  Lors de la modification du mod√®le de vue, la disposition change automatiquement. <br><br><pre> <code class="cs hljs">&lt;label&gt;One way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text /&gt; &lt;br /&gt; &lt;label&gt;Two way binding         Text   oninput:&lt;/label&gt; &lt;br /&gt; &lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> @bind=@Text @bind:<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=<span class="hljs-string"><span class="hljs-string">"oninput"</span></span> /&gt; <span class="hljs-comment"><span class="hljs-comment">//ViewModel @code{ string Text; async Task InpuValueChanged() { Console.WriteLine("Input value changed"); } }</span></span></code> </pre><br>  Et donc, nous avons ici un ViewModel (anonyme) qui a un champ Texte. <br><br>  Dans la premi√®re entr√©e, via ¬´value = @ Text¬ª, nous avons cr√©√© une liaison unidirectionnelle.  Maintenant, lorsque nous modifions le texte dans le code, le texte √† l'int√©rieur de l'entr√©e change imm√©diatement.  Ce n'est que pour que nous n'imprimons pas dans notre entr√©e que cela affecte notre machine virtuelle.  Dans la deuxi√®me entr√©e, via "@ bind = @ Text", nous avons cr√©√© une liaison bidirectionnelle.  Maintenant, si nous √©crivons quelque chose de nouveau dans notre entr√©e, notre machine virtuelle changera imm√©diatement, et l'inverse est √©galement vrai, c'est-√†-dire  si nous modifions le champ Texte dans le code, notre entr√©e affichera imm√©diatement la nouvelle valeur.  Il y a un MAIS - par d√©faut, les changements sont li√©s √† l'√©v√©nement onchange de notre entr√©e, donc la VM ne changera que lorsque nous aurons termin√© l'entr√©e.  Dans la troisi√®me entr√©e "@bind: event =" oninput "", nous avons chang√© l'√©v√©nement pour le transfert des donn√©es VM en oninput maintenant chaque fois que nous imprimons un caract√®re, une nouvelle valeur est imm√©diatement transf√©r√©e sur notre VM.  Vous pouvez √©galement sp√©cifier un format pour DateTime, par exemple, comme ceci. <br><br><pre> <code class="cs hljs">&lt;input @bind=@Today @bind:format=<span class="hljs-string"><span class="hljs-string">"yyyy-MM-dd"</span></span> /&gt;</code> </pre> <br><h2>  Voir le mod√®le </h2><br>  Vous pouvez le rendre anonyme, puis vous devez l'arr√™ter dans le bloc "@code {}" <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> &lt;p&gt;  @UserName &lt;/p&gt; @code{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  ou vous pouvez le mettre dans un fichier s√©par√©.  Ensuite, il doit √™tre h√©rit√© de ComponentBase et en haut de la page sp√©cifier un lien vers notre VM en utilisant "@inherits" <br><br>  Par exemple <br><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span>: <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> UserName{<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} }</code> </pre><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits MyWebApp.ViewModels.TodoViewModel &lt;p&gt;  @UserName &lt;/p&gt;</code> </pre><br><h2>  Acheminement </h2><br>  Les itin√©raires auxquels la page r√©pondra sont indiqu√©s au d√©but de la page en utilisant "@page".  De plus, il peut y en avoir plusieurs.  Le premier sera s√©lectionn√© exactement dans l'ordre de haut en bas.  Par exemple: <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @page <span class="hljs-string"><span class="hljs-string">"/todo/delete"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt;</code> </pre><br>  Cette page s'ouvrira dans "/ todo" ou "todo / delete" <br><br><h2>  Disposition </h2><br>  En g√©n√©ral, les √©l√©ments identiques pour plusieurs pages sont g√©n√©ralement plac√©s ici.  Comme une barre lat√©rale, et plus encore. <br><br>  Pour utiliser la mise en page en premier lieu, vous devez la cr√©er.  Il doit √™tre h√©rit√© de LayotComponentBase en utilisant "@inherits".  Par exemple <br><br><pre> <code class="cs hljs">@inherits LayoutComponentBase &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"sidebar"</span></span>&gt; &lt;NavMenu /&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"main"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"top-row px-4"</span></span>&gt; &lt;a href=<span class="hljs-string"><span class="hljs-string">"http://blazor.net"</span></span> target=<span class="hljs-string"><span class="hljs-string">"_blank"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"ml-md-auto"</span></span>&gt;About&lt;/a&gt; &lt;/div&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"content px-4"</span></span>&gt; @Body &lt;/div&gt; &lt;/div&gt;</code> </pre><br>  Deuxi√®mement, il doit √™tre import√©.  Pour ce faire, dans le r√©pertoire des pages qui vont l'utiliser, vous devez cr√©er le fichier _imports.razor puis ajouter la ligne "@layout" √† ce fichier <br><br><pre> <code class="cs hljs">@layout MainLayout @<span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System</code> </pre><br>  Troisi√®mement, vous pouvez indiquer sur la page quelle disposition il utilise directement <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt;</code> </pre><br>  En g√©n√©ral, _imports.razor et son utilisation agissent sur toutes les pages qui se trouvent dans le m√™me dossier que lui. <br><br><h2>  Options d'itin√©raire </h2><br>  Tout d'abord, indiquez le param√®tre et son type entre accolades dans notre itin√©raire (insensible √† la casse).  Les types standard sont pris en charge.  Alors oui, il n'y a pas de param√®tres optionnels, c'est-√†-dire  la valeur doit toujours √™tre transmise. <br><br>  La valeur elle-m√™me peut √™tre obtenue en cr√©ant dans notre ViewModel une propri√©t√© avec le m√™me nom que le param√®tre et avec l'attribut BTV [Parameter] - en cours d'ex√©cution avant - les donn√©es et les √©v√©nements dans les composants parents sont √©galement transmis en utilisant l'attribut [Parameter] comme param√®tres en cascade.  Ils sont pass√©s du composant parent √† tous ses composants enfants et √† leurs composants enfants.  Ils sont principalement utilis√©s pour les styles, mais il vaut mieux ne faire que des styles en CSS, alors pourquoi ne pas s'en soucier. <br><br><pre> <code class="cs hljs">@page <span class="hljs-string"><span class="hljs-string">"/todo/delete/{id:guid}"</span></span> &lt;h1&gt; Hello!&lt;/h1&gt; @code{ [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } }</code> </pre><br><h2>  DI </h2><br>  Tout est enregistr√© dans Startup.cs, comme dans une application principale asp.net standard.  Rien de nouveau ici.  Mais l'impl√©mentation des d√©pendances pour notre machine virtuelle se fait toujours via les propri√©t√©s publiques et non via le constructeur.  La propri√©t√© doit simplement √™tre d√©cor√©e avec l'attribut [Inject] <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Parameter] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Guid Id { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; }</code> </pre><br>  Par d√©faut, 3 services sont d√©j√† connect√©s.  HttpClient - Eh bien, vous savez pourquoi.  IJSRuntime - Appelle le code JS depuis C #.  IUriHelper - en l'utilisant, il n'est pas possible de rediriger vers d'autres pages. <br><br><h2>  Exemple d'application </h2><br><h3>  Feuille de calcul Todo </h3><br>  TodoTableComponent.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) &lt;table class="table table-hover"&gt; &lt;thead&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;th&gt; &lt;/th&gt; &lt;th&gt;&lt;/th&gt; &lt;/thead&gt; &lt;tbody&gt; //2) @foreach (var item in Items) { //3) &lt;tr @onclick=@(()=&gt;ClickRow(item.Id)) class="@(item.Id == Current?"table-primary":null)"&gt; &lt;td&gt;&lt;input type="checkbox" checked="@item.IsComplite" disabled="disabled" /&gt;&lt;/td&gt; &lt;td&gt;@item.Name&lt;/td&gt; &lt;td&gt;@item.Created.ToString("dd.MM.yyyy HH:mm:ss")&lt;/td&gt; &lt;td&gt;&lt;a href="/todo/delete/@item.Id" class="btn btn-danger"&gt;&lt;/a&gt;&lt;/td&gt; &lt;/tr&gt; } &lt;/tbody&gt; &lt;/table&gt; @code { //4) [Parameter] private List&lt;BlazorApp.Client.Presentation.TodoDto&gt; Items { get; set; } [Parameter] private EventCallback&lt;UIMouseEventArgs&gt; OnClick { get; set; } [Parameter] private Guid Current { get; set; } private async Task ClickRow(Guid id) { //5 await OnClick.InvokeAsync(CreateArgs(id)); } private ClickTodoEventArgs CreateArgs(Guid id) { return new ClickTodoEventArgs { Id = id }; } //6) public class ClickTodoEventArgs : UIMouseEventArgs { public Guid Id { get; set; } } }</span></span></code> </pre><br><ol><li>  Comme ce composant n'a pas besoin de "@page" et "@layout" car il ne participera pas au routage et il utilisera la mise en page du composant parent </li><li>  Le code C # commence par le symbole @.  En fait le m√™me que dans Razor </li><li><pre> <code class="cs hljs">@onclick=@(()=&gt;ClickRow(item.Id))</code> </pre>  Lie un √©v√©nement de clic de ligne √† la m√©thode ClickRow de notre ViewModel </li><li>  Sp√©cifiez les param√®tres qui seront transf√©r√©s du composant ou de la page parent au n√¥tre √† l'aide de l'attribut [Parameter] </li><li>  Nous appelons la fonction de rappel re√ßue du composant parent.  Ainsi, le composant parent apprend qu'un √©v√©nement s'est produit chez l'enfant.  Les fonctions peuvent uniquement √™tre pass√©es envelopp√©es dans EventCallback &lt;&gt; EventArgs param√©tr√©.  Une liste possible d'EventArgs peut √™tre trouv√©e ici - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">docs.microsoft.com/ru-ru/aspnet/core/blazor/components?view=aspnetcore-3.0#event-handling</a> </li><li>  √âtant donn√© que la liste des types possibles d'EventArgs est limit√©e et que nous devons transmettre une propri√©t√© Id suppl√©mentaire au gestionnaire d'√©v√©nements du c√¥t√© du composant parent, nous cr√©ons notre propre classe de param√®tres h√©rit√©e de la base et la transmettons √† l'√©v√©nement.  Donc oui - dans le composant parent, le UIMouseEventArgs normal volera dans la fonction du gestionnaire d'√©v√©nements et il devra √™tre converti en notre type, par exemple, en utilisant l'op√©rateur as </li></ol><br>  Exemple d'utilisation: <br><br><pre> <code class="cs hljs">&lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt;</code> </pre> <br><h3>  Page de suppression de Todo </h3><br>  Notre ViewModel aka VM est DeleteTodoViewModel.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DeleteTodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) [Parameter] private Guid Id { get; set; } //2) [Inject] public ICommandDispatcher CommandDispatcher { get; set; } [Inject] public IQueryDispatcher QueryDispatcher { get; set; } [Inject] public IUriHelper UriHelper { get; set; } //3) public TodoDto Todo { get; set; } protected override async Task OnInitAsync() { var todo = await QueryDispatcher.Execute&lt;GetById,TodoItem&gt;(new GetById(Id)); if (todo != null) Todo = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; await base.OnInitAsync(); } //4) public async Task Delete() { if (Todo != null) await CommandDispatcher.Execute(new Remove(Todo.Id)); Todo = null; //5) UriHelper.NavigateTo("/todo"); } }</span></span></code> </pre><br><ol><li>  Le param√®tre de route "/ todo / delete / {id: guid}" est pass√© √† Guid ici si nous allons, par exemple, √† localhost / todo / delete / ae434aae44 ... </li><li>  Injectez des services du conteneur DI dans notre machine virtuelle. </li><li>  Juste une propri√©t√© de notre VM.  Nous fixons nous-m√™mes sa valeur, comme nous voulons. </li><li>  Cette m√©thode est appel√©e automatiquement lorsque la page est initialis√©e.  Ici, nous d√©finissons les valeurs n√©cessaires pour les propri√©t√©s de notre VM </li><li>  La m√©thode de notre VM.  Nous pouvons le lier, par exemple, √† l'√©v√©nement de cliquer sur n'importe quel bouton de notre vue </li><li>  Aller sur une autre page situ√©e √† l'adresse "/ todo" ie  elle a au d√©but la ligne "@page" / todo "" <br>  Notre point de vue est DeleteTodo.razor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//1) @page "/todo/delete/{id:guid}" @using BlazorApp.Client.TodoModule.Presentation @using BlazorApp.Client.Shared; //2) @layout MainLayout //3) @inherits DeleteTodoViewModel &lt;h3&gt; Todo &lt;/h3&gt; @if (Todo != null) { &lt;div class="row"&gt; &lt;div class="col"&gt; &lt;input type="checkbox" checked=@Todo.IsComplite disabled="disabled" /&gt; &lt;br /&gt; &lt;label&gt;@Todo.Name&lt;/label&gt; &lt;br /&gt; //4) &lt;button class="btn btn-danger" onclick=@Delete&gt;&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; } else { &lt;p&gt;&lt;em&gt; Todo  &lt;/em&gt;&lt;/p&gt; }</span></span></code> </pre><br><ol><li>  Nous indiquons que ce pays sera disponible √† l'adresse {adresse racine de notre site} + "/ todo / delete /" + {une sorte de Guid}.  Par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">localhost / todo / delete / ae434aae44</a> ... </li><li>  Sp√©cifiez que notre page sera rendue dans MainLayout.razor </li><li>  Sp√©cifiez que notre page utilisera les propri√©t√©s et les m√©thodes de la classe DeleteTodoViewModel </li><li>  Nous pr√©cisons que lorsque vous cliquez sur ce bouton, la m√©thode Delete () de notre VM sera appel√©e </li></ol><br><h3>  Todo Home </h3><br>  TodoViewModel.cs: <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TodoViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ComponentBase</span></span> { [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ICommandDispatcher CommandDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } [Inject] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IQueryDispatcher QueryDispatcher { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//1) [Required(ErrorMessage = "  Todo")] public string NewTodo { get; set; } public List&lt;TodoDto&gt; Items { get; set; } public TodoDto Selected { get; set; } protected override async Task OnInitAsync() { await LoadTodos(); await base.OnInitAsync(); } public async Task Create() { await CommandDispatcher.Execute(new Add(NewTodo)); await LoadTodos(); NewTodo = string.Empty; } //2) public async Task Select(UIMouseEventArgs args) { //3) var e = args as TodoTableComponent.ClickTodoEventArgs; if (e == null) return; var todo = await QueryDispatcher.Execute&lt;GetById, TodoItem&gt;(new GetById(e.Id)); if (todo == null) { Selected = null; return; } Selected = new TodoDto { Id = todo.Id, IsComplite = todo.IsComplite, Name = todo.Name, Created = todo.Created }; } public void CanselEdit() { Selected = null; } public async Task Update() { await CommandDispatcher.Execute(new Update(Selected.Id, Selected.Name, Selected.IsComplite)); Selected = null; await LoadTodos(); } private async Task LoadTodos() { var todos = await QueryDispatcher.Execute&lt;GetAll, List&lt;TodoItem&gt;&gt;(new GetAll()); Items = todos.Select(t =&gt; new TodoDto { Id = t.Id, IsComplite = t.IsComplite, Name = t.Name, Created = t.Created }) .ToList(); } }</span></span></code> </pre><br><ol><li>  Les attributs de validation standard de System.ComponentModel.DataAnnotations sont pris en charge.  Plus pr√©cis√©ment, nous indiquons ici que ce champ est obligatoire et le texte qui sera affich√© si l'utilisateur ne sp√©cifie pas de valeur dans l'entr√©e qui sera associ√©e √† ce champ. </li><li>  M√©thode de gestion d'un √©v√©nement avec un param√®tre.  Cette m√©thode g√©rera l'√©v√©nement du composant enfant. </li><li>  Nous castons l'argument au type que nous avons cr√©√© dans le composant enfant </li></ol><br>  Todo.razor: <br><br><pre> <code class="cs hljs">@layout MainLayout @page <span class="hljs-string"><span class="hljs-string">"/todo"</span></span> @inherits BlazorApp.Client.Presentation.TodoViewModel &lt;h3&gt;Todo&lt;/h3&gt; &lt;h4&gt;&lt;/h4&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"row"</span></span>&gt; &lt;div <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>=<span class="hljs-string"><span class="hljs-string">"col"</span></span>&gt; @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { &lt;p&gt;&lt;em&gt;...&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Items.Count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { &lt;p&gt;&lt;em&gt;   .    .&lt;/em&gt;&lt;/p&gt; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//1) &lt;TodoTableComponent Items=@Items OnClick=@Select Current=@(Selected?.Id??Guid.Empty)&gt;&lt;/TodoTableComponent&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { //2) &lt;EditForm name="addForm" Model=@this OnValidSubmit=@Create&gt; //3) &lt;DataAnnotationsValidator /&gt; //4) &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; //5) &lt;InputText @bind-Value=@NewTodo /&gt; //6) &lt;ValidationMessage For="@(() =&gt; this. NewTodo)" /&gt; //7) &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } &lt;/div&gt; &lt;/div&gt; &lt;br /&gt; &lt;h4&gt; Todo&lt;/h4&gt; &lt;div class="row"&gt; &lt;div class="col"&gt; @if (Items != null) { @if (Selected != null) { &lt;EditForm name="editForm" Model=@Selected OnValidSubmit=@Update&gt; &lt;DataAnnotationsValidator /&gt; &lt;ValidationSummary /&gt; &lt;div class="form-group"&gt; &lt;InputCheckbox @bind-Value=@Selected.IsComplite /&gt; &lt;InputText @bind-Value=@Selected.Name /&gt; &lt;button type="submit" class="btn btn-primary"&gt;&lt;/button&gt; &lt;button type="reset" class="btn btn-warning" @onclick=@CanselEdit&gt;&lt;/button&gt; &lt;/div&gt; &lt;/EditForm&gt; } else { &lt;p&gt;&lt;em&gt;     &lt;/em&gt;&lt;/p&gt; } } &lt;/div&gt; &lt;/div&gt;</span></span></code> </pre><br><ol><li>  Nous appelons le composant enfant et lui transmettons les propri√©t√©s et les m√©thodes de notre VM en tant que param√®tres. </li><li>  Composant de formulaire int√©gr√© avec validation des donn√©es.  Nous y indiquons qu'en tant que mod√®le, il utilisera notre VM et lors de l'envoi de donn√©es valides, il appellera sa m√©thode Create () </li><li>  La validation sera effectu√©e √† l'aide d'attributs de mod√®le tels que [Requared], etc. </li><li>  Ici, je vais afficher les erreurs g√©n√©rales de validation </li><li>  Cr√©era une entr√©e avec validation.  La liste des balises possibles est InputText, InputTextArea, InputSelect, InputNumber, InputCheckbox, InputDate </li><li>  Les erreurs de validation de la propri√©t√© de cha√Æne publique NewTodo {get; set;} seront affich√©es ici </li><li>  Lorsque vous cliquez sur ce bouton, l'√©v√©nement OnValidSubmit de notre formulaire est d√©clench√© </li></ol><br><h3>  Fichier Startup.cs </h3><br>  Ici, nous enregistrons nos services <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Startup</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConfigureServices</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IServiceCollection services</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// LocalStorage  SessionStorage       //    //     Nuget  Blazor.Extensions.Storage services.AddStorage(); services.AddSingleton&lt;ITodoRepository, TodoRepository&gt;(); services.AddSingleton&lt;ICommandDispatcher, CommandDispatcher&gt;(); services.AddSingleton&lt;IQueryDispatcher, QueryDispatcher&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetAll, List&lt;TodoItem&gt;&gt;, GetAllHandler&gt;(); services.AddSingleton&lt;IQueryHandler&lt;GetById, TodoItem&gt;, GetByIdHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Add&gt;, AddHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Remove&gt;, RemoveHandler&gt;(); services.AddSingleton&lt;ICommandHandler&lt;Update&gt;, UpdateHandler&gt;(); } public void Configure(IComponentsApplicationBuilder app) { //       App.razor //        &lt;app&gt;&lt;/app&gt; app.AddComponent&lt;App&gt;("app"); } }</span></span></code> </pre><br><h2>  √âpilogue </h2><br>  Cet article a √©t√© √©crit pour jouer l'app√©tit et encourager une √©tude plus approfondie de Blazor.  J'esp√®re avoir atteint mon objectif.  Eh bien, pour mieux l'√©tudier, je recommande de lire le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">manuel officiel de Microsoft</a> . <br><br><h2>  Remerciements </h2><br>  Merci √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">AndreyNikolin</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">win32nipuh</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">SemenPV</a> pour les fautes d'orthographe et de grammaire trouv√©es dans le texte. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr463197/">https://habr.com/ru/post/fr463197/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr463183/index.html">Formation Cisco 200-125 CCNA v3.0. Jour 13. Configurer le VLAN</a></li>
<li><a href="../fr463185/index.html">Comment de puissants tremblements de terre en Bolivie ont d√©couvert des montagnes √† une profondeur de 660 kilom√®tres sous terre</a></li>
<li><a href="../fr463189/index.html">√Ä propos de l'anonymat sur Internet, de la vie et de sa relativit√©</a></li>
<li><a href="../fr463193/index.html">Convertissez des images en noir et blanc en graphiques ASCII √† l'aide d'une d√©composition matricielle non n√©gative</a></li>
<li><a href="../fr463195/index.html">Que se passe-t-il avec Internet Tele2</a></li>
<li><a href="../fr463205/index.html">Initialement inutilisable: comment survivre avec un ordinateur portable sous Windows 10 et un lecteur de 32 gigaoctets</a></li>
<li><a href="../fr463213/index.html">Id√©es fausses pour les d√©veloppeurs C # novices. Essayer de r√©pondre √† des questions standard</a></li>
<li><a href="../fr463215/index.html">Les ing√©nieurs et les architectes con√ßoivent d√©j√† des √©tablissements lunaires</a></li>
<li><a href="../fr463221/index.html">Regarder le soleil: 5 types de gadgets, de 5 $ √† 5 000 $</a></li>
<li><a href="../fr463225/index.html">WiFi Enterprise. FreeRadius + FreeIPA + Ubiquiti</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>