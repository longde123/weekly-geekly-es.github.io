<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèä üòΩ üöÇ Detecci√≥n de rostros en video: Raspberry Pi y Neural Compute Stick üàöÔ∏è üàÇÔ∏è üôçüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace aproximadamente un a√±o, Intel Movidius lanz√≥ un dispositivo para la inferencia eficiente de redes neuronales convolucionales: Movidius Neural Com...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Detecci√≥n de rostros en video: Raspberry Pi y Neural Compute Stick</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424973/">  Hace aproximadamente un a√±o, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intel Movidius</a> lanz√≥ un dispositivo para la inferencia eficiente de redes neuronales convolucionales: Movidius Neural Compute Stick (NCS).  Este dispositivo permite el uso de redes neuronales para el reconocimiento o detecci√≥n de objetos en condiciones de consumo de energ√≠a limitado, incluso en tareas de rob√≥tica.  NCS tiene una interfaz USB y no consume m√°s de 1 vatio.  En este art√≠culo, hablar√© sobre la experiencia de usar NCS con la Raspberry Pi para la tarea de detectar rostros en video, incluyendo tanto la capacitaci√≥n del detector Mobilenet-SSD como el lanzamiento en Raspberry. <br><br>  Todo el c√≥digo se puede encontrar en mis dos repositorios: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">capacitaci√≥n de detectores</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">demostraciones de detecci√≥n de rostros</a> . <br><br><img src="https://habrastorage.org/webt/qu/b_/tj/qub_tj1u6ztw9irfy9ivtaaidcc.jpeg"><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En mi primer art√≠culo,</a> ya escrib√≠ sobre la detecci√≥n de rostros usando NCS: luego est√°bamos hablando de un detector <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">YOLOv2</a> , que convert√≠ del formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Darknet al</a> formato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Caffe</a> , y luego lo lanc√© en NCS.  El proceso de conversi√≥n result√≥ no ser trivial: dado que estos dos formatos definen la √∫ltima capa del detector de diferentes maneras, la salida de la red neuronal tuvo que analizarse por separado, en la CPU, utilizando un c√≥digo de Darknet.  Adem√°s, este detector no me satisfizo tanto en velocidad (hasta 5.1 FPS en mi computadora port√°til) como en precisi√≥n; m√°s tarde me convenc√≠ de que debido a su sensibilidad a la calidad de imagen era dif√≠cil obtener un buen resultado en Raspberry Pi. <br><br>  Al final, decid√≠ entrenar mi detector.  La elecci√≥n recay√≥ en el detector <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SSD</a> con el codificador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mobilenet</a> : la convoluci√≥n ligera de Mobilenet le permite alcanzar alta velocidad sin p√©rdida de calidad, y el detector SSD no es inferior a YOLO y funciona en el NCS de f√°brica. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥mo funciona el detector Mobilenet-SSD</b> <div class="spoiler_text">  Comencemos con Mobilenet.  En esta arquitectura esta completa <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.251ex" height="2.486ex" viewBox="0 -772.3 2691.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-70" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-6F" x="1254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-72" x="1739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="2191" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> 3 \ por 3 </script>  la convoluci√≥n (en todos los canales) se reemplaza por dos convoluciones ligeras: primero <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.251ex" height="2.486ex" viewBox="0 -772.3 2691.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-70" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-6F" x="1254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-72" x="1739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="2191" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> 3 \ por 3 </script>  por separado para cada canal y luego completar <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.251ex" height="2.486ex" viewBox="0 -772.3 2691.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-70" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-6F" x="1254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-72" x="1739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="2191" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> 1 \ por 1 </script>  convoluci√≥n  Despu√©s de cada convoluci√≥n, se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usan BatchNorm</a> y Non-linearity (ReLU).  La primera convoluci√≥n de red que recibe una imagen como entrada generalmente se deja completa.  Esta arquitectura puede reducir significativamente la complejidad de los c√°lculos debido a una ligera disminuci√≥n en la calidad de las predicciones.  Hay una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">opci√≥n m√°s avanzada</a> , pero a√∫n no la he probado. <br><br>  SSD (Single Shot Detector) funciona as√≠: en las salidas de varios codificadores de convoluci√≥n se cuelgan en dos <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.251ex" height="2.486ex" viewBox="0 -772.3 2691.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-70" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-6F" x="1254" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-72" x="1739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="2191" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> 1 \ por 1 </script>  capa convolucional: uno predice las probabilidades de las clases, el otro, las coordenadas del cuadro delimitador.  Hay una tercera capa que proporciona las coordenadas y las posiciones de los cuadros predeterminados en el nivel actual.  El significado es: la salida de cualquier capa se divide naturalmente en celdas;  m√°s cerca del final de la red neuronal, se est√°n volviendo m√°s peque√±os (en este caso, debido a la convoluci√≥n con <code>stride=2</code> ), y el campo de visi√≥n de cada c√©lula aumenta.  Para cada celda en cada una de varias capas seleccionadas, establecemos varios marcos predeterminados de diferentes tama√±os y con diferentes relaciones de aspecto, y utilizamos capas convolucionales adicionales para corregir coordenadas y predecir las probabilidades de clase para cada uno de esos marcos.  Por lo tanto, un detector SSD (como YOLO) siempre considera el mismo n√∫mero de cuadros.  El mismo objeto se puede detectar en diferentes capas: durante el entrenamiento, la se√±al se env√≠a a todos los cuadros que se cruzan con el objeto con bastante fuerza, y durante la aplicaci√≥n, las detecciones se combinan utilizando la supresi√≥n no m√°xima (NMS).  La capa final combina las detecciones de todas las capas, considera sus coordenadas completas, corta el umbral de probabilidad y produce NMS. <br></div></div><br><h2>  Entrenamiento de detectores </h2><br><h3>  Arquitectura </h3><br>  El c√≥digo para entrenar el detector se encuentra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Decid√≠ usar el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">detector Mobilenet-SSD listo</a> para usar entrenado en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PASCAL VOC0712</a> y entrenarlo para detectar rostros.  En primer lugar, ayuda a entrenar la red mucho m√°s r√°pido y, en segundo lugar, no tiene que reinventar la rueda. <br><br>  El proyecto original inclu√≠a el script <code>gen.py</code> , que literalmente recopilaba el archivo de modelo <code>.prototxt</code> , sustituyendo los par√°metros de entrada.  Lo transfer√≠ a mi proyecto, ampliando un poco la funcionalidad.  Este script le permite generar cuatro tipos de archivos de configuraci√≥n: <br><br><ul><li>  <b>tren</b> : en la entrada - una base de entrenamiento LMDB, en la salida - una capa con el c√°lculo de la funci√≥n de p√©rdida y sus gradientes, hay BatchNorm </li><li>  <b>prueba</b> : en la entrada, la base de prueba LMDB, en la salida, la capa con el c√°lculo de la calidad (precisi√≥n media promedio), hay BatchNorm </li><li>  <b>desplegar</b> : en la entrada - la imagen, en la salida - la capa con predicciones, falta BatchNorm </li><li>  <b>deploy_bn</b> : en la entrada, la imagen, en la salida, la capa con predicciones, hay BatchNorm </li></ul><br>  Agregu√© la √∫ltima opci√≥n m√°s tarde, para que en las secuencias de comandos pueda cargar y convertir la cuadr√≠cula de BatchNorm sin tocar la base de datos LMDB; de lo contrario, en ausencia de la base de datos, nada funcionar√≠a.  (En general, me parece extra√±o que en Caffe la fuente de datos est√© configurada en la arquitectura de red; esto al menos no es muy pr√°ctico). <br><br><div class="spoiler">  <b class="spoiler_title">¬øC√≥mo se ve la arquitectura de red (breve)</b> <div class="spoiler_text"><ul><li>  Iniciar sesi√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.082ex" height="2.074ex" viewBox="0 -772.3 8646.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="1751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2237" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="2703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="3137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="3603" y="0"></use><g transform="translate(4073,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="5824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="6310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="6776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="7210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="7676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="8146" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> 300 \ veces 300 \ veces 3 </script></li><li>  Full <b>conv conv conv</b> : 32 canales, <code>stride=2</code> </li><li>  Convoluci√≥n <b>Mobilenet conv1 - conv11</b> : 64, 128, 128, 256, 256, 512 ... 512 canales, algunos tienen <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.082ex" height="2.074ex" viewBox="0 -772.3 8646.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-39" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="1251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="2203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="3103" y="0"></use><g transform="translate(3572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-39" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="4823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="5775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="6209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="6675" y="0"></use><g transform="translate(7145,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> 19 \ veces 19 \ veces 512 </script></li><li>  Convoluci√≥n <b>Mobilenet conv12, conv13</b> : 1024 canales, <b>conv12</b> tiene <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.245ex" height="2.074ex" viewBox="0 -772.3 9147 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="1251" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="2203" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="3103" y="0"></use><g transform="translate(3572,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="4823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="5775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="6209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="6675" y="0"></use><g transform="translate(7145,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="1501" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> 10 \ veces 10 \ veces 1024 </script></li><li>  Convoluci√≥n completa <b>conv14_1, conv14_2</b> : 256, 512 canales, el primer <code>kernel_size=1</code> , el segundo <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.757ex" height="2.074ex" viewBox="0 -772.3 7645.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="1702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="4774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="5674" y="0"></use><g transform="translate(6144,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> 5 \ veces 5 \ veces 512 </script></li><li>  Convoluci√≥n completa <b>conv15_1, conv15_2</b> : 128, 256 canales, el primer <code>kernel_size=1</code> , el segundo <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.757ex" height="2.074ex" viewBox="0 -772.3 7645.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="1702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="4774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="5674" y="0"></use><g transform="translate(6144,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-36" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9"> 3 \ veces 3 \ veces 256 </script></li><li>  <b>Convoluciones conv16_1, conv16_2</b> completas: 128, 256 canales, el primer <code>kernel_size=1</code> , el segundo <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.757ex" height="2.074ex" viewBox="0 -772.3 7645.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="1702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="4774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="5674" y="0"></use><g transform="translate(6144,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-36" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> 2 \ veces 2 \ veces 256 </script></li><li>  Convoluci√≥n completa <b>conv17_1, conv17_2</b> : 64, 128 canales, el primer <code>kernel_size=1</code> , el segundo <code>stride=2</code> </li><li>  Capa de detecci√≥n: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.757ex" height="2.074ex" viewBox="0 -772.3 7645.5 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="1236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="1702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="2136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="2602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="3072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-76" x="3822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="4308" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-63" x="4774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-65" x="5208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="5674" y="0"></use><g transform="translate(6144,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-38" x="1001" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-11"> 1 \ veces 1 \ veces 128 </script></li><li>  Salida de detecci√≥n de capa final </li></ul><br></div></div><br>  He corregido ligeramente la arquitectura de la red.  Lista de cambios: <br><br><ul><li>  Obviamente, el n√∫mero de clases ha cambiado a 1 (sin contar el fondo). </li><li>  Limitaciones en la relaci√≥n de aspecto de los parches de corte durante el entrenamiento: cambiado de <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.271ex" height="2.66ex" viewBox="0 -832 3561.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-35" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="1558" y="0"></use><g transform="translate(2003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-5D" x="3282" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> [0.5,2.0] </script>  en <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.271ex" height="2.66ex" viewBox="0 -832 3561.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-37" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="1558" y="0"></use><g transform="translate(2003,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="779" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-5D" x="3282" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> [0.7,1.4] </script>  (Decid√≠ simplificar un poco la tarea y no aprender de im√°genes demasiado estiradas). </li><li>  De los marcos predeterminados, solo quedaron los cuadrados, dos para cada celda.  Reduje considerablemente sus tama√±os, ya que las caras son significativamente m√°s peque√±as que los objetos en el cl√°sico problema de detecci√≥n de objetos. </li></ul><br>  Caffe calcula los tama√±os de fotograma predeterminados de la siguiente manera: tener un tama√±o de fotograma m√≠nimo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.455ex" viewBox="0 -520.7 469.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> s </script>  y m√°ximo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-4C" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> L </script>  , crea un marco peque√±o y grande con dimensiones <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="1.455ex" viewBox="0 -520.7 469.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> s </script>  y <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.302ex" height="2.419ex" viewBox="0 -780.1 3144 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-74" x="1631" y="0"></use><g transform="translate(1993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-4C" x="469" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-17"> \ sqrt {sL} </script>  .  Como quer√≠a detectar rostros lo m√°s peque√±os posible, calcul√© el <code>stride</code> completo para cada capa de detecci√≥n y equipar√© el tama√±o m√≠nimo de fotograma.  Con estos par√°metros, los peque√±os marcos predeterminados se ubicar√°n uno cerca del otro y no se intersecar√°n.  Entonces, al menos tenemos una garant√≠a de que la intersecci√≥n con el objeto existir√° para alg√∫n tipo de marco.  Establezco el tama√±o m√°ximo el doble.  Para las capas <b>conv16_2, conv17_2,</b> configuro las dimensiones en el ojo para que sean las mismas.  De esta manera <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.707ex" height="2.419ex" viewBox="0 -780.1 1596.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-73" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMATHI-4C" x="914" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> s, L </script>  para todas las capas fueron: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="57.491ex" height="2.66ex" viewBox="0 -832 24753 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-36" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="1780" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="2670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="3059" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="3504" y="0"></use><g transform="translate(3894,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2E" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-36" x="1279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="1780" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="6174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="6564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="7009" y="0"></use><g transform="translate(7398,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-36"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="8399" y="0"></use><g transform="translate(8844,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-38" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="10346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="10735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="11181" y="0"></use><g transform="translate(11570,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-38" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="13072" y="0"></use><g transform="translate(13517,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="15018" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="15408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="15853" y="0"></use><g transform="translate(16242,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="17744" y="0"></use><g transform="translate(18189,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="19691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="20080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-28" x="20525" y="0"></use><g transform="translate(20915,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-34" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-2C" x="22416" y="0"></use><g transform="translate(22862,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/424973/&amp;usg=ALkJrhhsh0CBL5x64VOK6G1mgaHsav3bmA#MJMAIN-29" x="24363" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> (16.32), (32.64), (64,128), (128,214), (214,300), (214,300) </script><br><br><div class="spoiler">  <b class="spoiler_title">C√≥mo se ven algunos marcos predeterminados (ruido para mayor claridad)</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j9/ti/gj/j9tigjn9tq7sdz6m3tyxa1v2r9s.png"><br></div></div><br><h3>  Datos </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Us√©</a> dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">conjuntos de datos</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">WIDER Face</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">FDDB</a> .  WIDER contiene muchas im√°genes con caras muy peque√±as y borrosas, y FDDB est√° m√°s inclinado a im√°genes grandes de caras (y un orden de magnitud menor que WIDER).  El formato de anotaci√≥n es ligeramente diferente en ellos, pero estos ya son detalles. <br><br>  Para el entrenamiento, no utilic√© todos los datos: arroj√© caras demasiado peque√±as (menos de seis p√≠xeles o menos del 2% del ancho de la imagen), arroj√© todas las im√°genes con una relaci√≥n de aspecto de menos de 0.5 o m√°s de 2, arroj√© todas las im√°genes marcadas como "borrosas" en el conjunto de datos WIDER, dado que correspond√≠an en su mayor parte a personas muy peque√±as, y tuve que alinear al menos de alguna manera la proporci√≥n de caras peque√±as y grandes.  Despu√©s de eso, hice todos los cuadros cuadrados, expandiendo el lado m√°s peque√±o: decid√≠ que no estaba muy interesado en las proporciones faciales, y la tarea para la red neuronal se simplific√≥ un poco.  Tambi√©n descart√© todas las im√°genes en blanco y negro, de las cuales hab√≠a pocas, y en las que el script de compilaci√≥n de la base de datos falla. <br><br>  Para usarlos para entrenamiento y pruebas, necesita armar una base LMDB a partir de ellos.  C√≥mo hacerlo: <br><br><ul><li>  Para cada imagen, el marcado se crea en formato <code>.xml</code> . </li><li>  Se <code>train.txt</code> archivo <code>train.txt</code> con l√≠neas de la forma <code>"path/to/image.png path/to/labels.xml"</code> , lo mismo se crea para la prueba. </li><li>  Se <code>test_name_size.txt</code> archivo <code>test_name_size.txt</code> con l√≠neas de la forma <code>"test_image_name height width"</code> </li><li>  Crea un archivo <code>labelmap.prototxt</code> con coincidencias de <code>labelmap.prototxt</code> num√©ricas </li></ul><br><br>  Se <code>ssd-caffe/scripts/create_annoset.py</code> (ejemplo del Makefile): <br><br><pre> <code class="bash hljs">python3 /opt/movidius/ssd-caffe/scripts/create_annoset.py --anno-type=detection \ --label-map-file=$(wider_dir)/labelmap.prototxt --min-dim=0 --max-dim=0 \ --resize-width=0 --resize-height=0 --check-label --encode-type=jpg --encoded \ --redo $(wider_dir) \ $(wider_dir)/trainval.txt $(wider_dir)/WIDER_train/lmdb/wider_train_lmdb ./data</code> </pre><br><div class="spoiler">  <b class="spoiler_title">labelmap.prototxt</b> <div class="spoiler_text"><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">item</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">name</span></span>: <span class="hljs-string"><span class="hljs-string">"none_of_the_above"</span></span> label: <span class="hljs-number"><span class="hljs-number">0</span></span> display_name: <span class="hljs-string"><span class="hljs-string">"background"</span></span> } <span class="hljs-selector-tag"><span class="hljs-selector-tag">item</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">name</span></span>: <span class="hljs-string"><span class="hljs-string">"face"</span></span> label: <span class="hljs-number"><span class="hljs-number">1</span></span> display_name: <span class="hljs-string"><span class="hljs-string">"face"</span></span> }</code> </pre><br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de marcado .xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">width</span></span></span><span class="hljs-tag">&gt;</span></span>348<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">width</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">height</span></span></span><span class="hljs-tag">&gt;</span></span>450<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">height</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depth</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">depth</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>face<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bndbox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmin</span></span></span><span class="hljs-tag">&gt;</span></span>161<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymin</span></span></span><span class="hljs-tag">&gt;</span></span>43<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmax</span></span></span><span class="hljs-tag">&gt;</span></span>241<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xmax</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymax</span></span></span><span class="hljs-tag">&gt;</span></span>123<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ymax</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bndbox</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">object</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">annotation</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  El uso de dos conjuntos de datos al mismo tiempo solo significa que debe fusionar cuidadosamente los archivos correspondientes en pares, sin olvidar registrar correctamente las rutas, as√≠ como barajar el archivo para el entrenamiento. <br><br>  Despu√©s de eso, puedes comenzar a entrenar. <br><br><h3>  Entrenamiento </h3><br>  El c√≥digo para la capacitaci√≥n modelo se puede encontrar en mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Colab Notebook</a> . <br><br>  Realic√© la capacitaci√≥n en Google Colaboratory, porque mi computadora port√°til apenas realiz√≥ las pruebas de la red y, en general, colg√≥ la capacitaci√≥n.  La colaboraci√≥n me permiti√≥ entrenar la red lo suficientemente r√°pido y gratis.  El √∫nico inconveniente es que tuve que escribir un script de compilaci√≥n SSD-Caffe para el Colaboratorio (que incluye cosas tan extra√±as como la recompilaci√≥n de impulso y la edici√≥n de la fuente), que toma alrededor de 40 minutos.  Se pueden encontrar m√°s detalles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en mi publicaci√≥n anterior</a> . <br><br>  El Colaboratorio tiene una caracter√≠stica m√°s: despu√©s de 12 horas, el autom√≥vil muere, borrando permanentemente todos los datos.  La mejor manera de evitar la p√©rdida de datos es montar su disco de Google en el sistema y ahorrar pesos de red all√≠ cada 500-1000 iteraciones de entrenamiento. <br><br>  En cuanto a mi detector, en una sesi√≥n en Colaboratory logr√≥ desaprender 4.500 iteraciones, y se entren√≥ por completo en dos sesiones. <br><br>  La calidad de las predicciones (precisi√≥n promedio promedio) en el conjunto de datos de prueba que destaqu√© (fusion√≥ WIDER y FDDB con las restricciones enumeradas anteriormente) fue de aproximadamente 0.87 para el mejor modelo.  Para medir mAP en las escalas guardadas durante el entrenamiento, hay un script <code>scripts/plot_map.py</code> . <br><br>  El detector funciona en un ejemplo (muy extra√±o) de un conjunto de datos: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nw/kc/jy/nwkcjyrtsz09v2fivdbs4uny3lc.png" width="60%"></div><br><h2>  Lanzamiento en NCS </h2><br>  Una demostraci√≥n de detecci√≥n de rostros est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Para compilar una red neuronal para el Neural Compute Stick, necesita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Movidius NCSDK</a> : contiene utilidades para compilar y perfilar redes neuronales, as√≠ como las API de C ++ y Python.  Vale la pena se√±alar que la segunda versi√≥n fue lanzada recientemente, que no es compatible con la primera: todas las funciones de API fueron renombradas por alguna raz√≥n, el formato interno de las redes neuronales cambi√≥, FIFO fue agregado para interactuar con NCS y (finalmente) la conversi√≥n autom√°tica de flotante de 32 bits a float 16 bit, que faltaba tanto en C ++.  Actualic√© todos mis proyectos a la segunda versi√≥n, pero dej√© un par de muletas para compatibilidad con la primera. <br><br>  Despu√©s de entrenar el detector, vale la pena fusionar capas BatchNorm con convoluciones adyacentes para acelerar la red neuronal.  El script <code>merge_bn.py</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esto desde aqu√≠</a> , que tambi√©n tom√© prestado del proyecto Mobilenet-SSD. <br><br>  Luego debe llamar a la utilidad <code>mvNCCompile</code> , por ejemplo: <br><br><pre> <code class="bash hljs">mvNCCompile -s 12 -o graph_ssd -w ssd-face.caffemodel ssd-face.prototxt</code> </pre><br>  Hay un objetivo <code>graph_ssd</code> para esto en el Makefile del proyecto.  El archivo <code>graph_ssd</code> resultante es una descripci√≥n de red neuronal en un formato comprendido por NCS. <br><br>  Ahora sobre c√≥mo interactuar con el dispositivo en s√≠.  El proceso no es muy complicado, pero requiere una cantidad bastante grande de c√≥digo.  La secuencia de acciones es aproximadamente la siguiente: <br><br><ul><li>  Obtenga el descriptor del dispositivo por n√∫mero de serie </li><li>  Dispositivo abierto </li><li>  Lea el archivo de red neuronal compilado en el b√∫fer (como un archivo binario) </li><li>  Crear un gr√°fico de c√°lculo vac√≠o para NCS </li><li>  Coloque el gr√°fico en el dispositivo usando los datos del archivo y seleccione FIFO para √©l en la entrada / salida;  ahora se puede liberar el b√∫fer con el contenido del archivo </li><li>  Detector de inicio: <br><ul><li>  Obtenga la imagen de la c√°mara (o de cualquier otra fuente) </li><li>  Procesarlo: escalar al tama√±o deseado, convertir a float32 y lanzar al rango [-1,1] </li><li>  Subir imagen al dispositivo y solicitar inferencia </li><li>  Solicitar un resultado (el programa se bloquear√° hasta que se reciba el resultado) </li><li>  Analiza el resultado, selecciona los cuadros de los objetos (sobre el formato - m√°s adelante) </li><li>  Mostrar predicciones </li></ul><br></li><li>  Libere todos los recursos: elimine FIFO y el gr√°fico de c√°lculo, cierre el dispositivo y quite su asa </li></ul><br>  Casi todas las acciones con NCS tienen su propia funci√≥n separada, y en C ++ se ve muy engorroso, y debe monitorear cuidadosamente la liberaci√≥n de todos los recursos.  Para no sobrecargar el c√≥digo, cre√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">una clase de contenedor para trabajar con NCS</a> .  En √©l, todo el trabajo de inicializaci√≥n se oculta en el constructor y la funci√≥n <code>load_file</code> , y en la liberaci√≥n de recursos, en el destructor, y trabajar con NCS se reduce a llamar a m√©todos de clase 2-3.  Adem√°s, hay una funci√≥n conveniente para explicar los errores que han ocurrido. <br><br>  Cree un contenedor pasando el tama√±o de entrada y el tama√±o de salida (n√∫mero de elementos) al constructor: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">NCSWrapper </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NCS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(NETWORK_INPUT_SIZE*NETWORK_INPUT_SIZE*</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, NETWORK_OUTPUT_SIZE)</span></span></span></span>;</code> </pre><br>  Cargamos el archivo compilado con la red neuronal, inicializando simult√°neamente todo lo que necesitamos: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!NCS.load_file(<span class="hljs-string"><span class="hljs-string">"./models/face/graph_ssd"</span></span>)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br>  Convertimos la imagen a float32 (la <code>image</code> es <code>cv::Mat</code> en el formato <code>CV_32FC3</code> ) y la descargamos al dispositivo: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!NCS.load_tensor_nowait((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>*)image.data)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  Obtenemos el resultado (el <code>result</code> es un puntero de <code>float</code> libre, el contenedor de resultados es compatible con el contenedor);  hasta el final de los c√°lculos, el programa est√° bloqueado: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!NCS.get_result(result)) { NCS.print_error_code(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre><br>  De hecho, el contenedor tambi√©n tiene un m√©todo que le permite cargar datos y obtener el resultado al mismo tiempo: <code>load_tensor((float*)image.data, result)</code> .  Me negu√© a usarlo por una raz√≥n: usando m√©todos separados, puede acelerar ligeramente la ejecuci√≥n del c√≥digo.  Despu√©s de cargar la imagen, la CPU permanecer√° inactiva hasta que llegue el resultado de la ejecuci√≥n con NCS (en este caso es de aproximadamente 100 ms), y en este momento puede hacer un trabajo √∫til: leer un nuevo marco y convertirlo, as√≠ como mostrar detecciones anteriores .  As√≠ es exactamente como se implementa el programa de demostraci√≥n, en mi caso aumenta ligeramente el FPS.  Puede ir m√°s all√° e iniciar el procesamiento de im√°genes y el detector de caras de forma asincr√≥nica en dos flujos diferentes; esto realmente funciona y le permite acelerar un poco m√°s, pero no est√° implementado en el programa de demostraci√≥n. <br><br>  Como resultado, el detector devuelve una matriz flotante de tama√±o <code>7*(keep_top_k+1)</code> .  Aqu√≠, <code>keep_top_k</code> es el par√°metro especificado en el archivo <code>.prototxt</code> del modelo y muestra cu√°ntas detecciones (en el orden de disminuci√≥n de la confianza) deben devolverse.  Este par√°metro, as√≠ como el par√°metro responsable de filtrar las detecciones por el valor de confianza m√≠nimo, y los par√°metros de supresi√≥n no m√°xima se pueden configurar en el archivo <code>.prototxt</code> del modelo en la √∫ltima capa.  Vale la pena se√±alar que si Caffe devuelve tantas detecciones como se encontraron en la imagen, entonces NCS siempre devuelve <code>keep_top_k</code> detecciones para que el tama√±o de la matriz sea constante. <br><br>  El conjunto de resultados en s√≠ est√° <code>keep_top_k+1</code> siguiente manera: si lo consideramos como una matriz con <code>keep_top_k+1</code> filas y 7 columnas, entonces en la primera fila, en el primer elemento habr√° el n√∫mero de detecciones, y a partir de la segunda fila habr√° las detecciones en el formato <code>"garbage, class_index, class_probability, x_min, y_min, x_max, y_max"</code> .  Las coordenadas se especifican en el rango [0,1], por lo que deber√°n multiplicarse por el alto / ancho de la imagen.  Los elementos restantes de la matriz ser√°n basura.  En este caso, la supresi√≥n no m√°xima se realiza autom√°ticamente, incluso antes de que se obtenga el resultado (parece, justo en el NCS). <br><br><div class="spoiler">  <b class="spoiler_title">Detector de an√°lisis</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_detection_boxes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">* predictions, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> w, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> h, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> thresh, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;&amp; probs, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;cv::Rect&gt;&amp; boxes)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> num = predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> cls = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">1</span></span>; i&lt;num+<span class="hljs-number"><span class="hljs-number">1</span></span>; i++) { score = predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">2</span></span>]; cls = predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (score&gt;thresh &amp;&amp; cls&lt;=<span class="hljs-number"><span class="hljs-number">1</span></span>) { probs.push_back(score); boxes.push_back(Rect(predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">3</span></span>]*w, predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span>]*h, (predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">5</span></span>]-predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">3</span></span>])*w, (predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">6</span></span>]-predictions[i*<span class="hljs-number"><span class="hljs-number">7</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span>])*h)); } } }</code> </pre><br></div></div><br><h2>  Raspberry Pi Caracter√≠sticas de lanzamiento </h2><br>  El programa de demostraci√≥n en s√≠ se puede ejecutar en una computadora o computadora port√°til normal con Ubuntu, o en una Raspberry Pi con un Raspbian Stretch.  Estoy usando un Raspberry Pi 2 modelo B, pero la demostraci√≥n tambi√©n deber√≠a funcionar en otros modelos.  El archivo MAKE del proyecto contiene dos objetivos para cambiar de modo: <code>make switch_desk</code> para la computadora / laptop y <code>make switch_rpi</code> para la Raspberry Pi.  La diferencia fundamental en el c√≥digo del programa es que, en el primer caso, OpenCV se usa para leer datos de la c√°mara y, en el segundo caso, la biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RaspiCam</a> .  Para ejecutar la demostraci√≥n en Raspberry, debe compilarla e instalarla. <br><br>  Ahora un punto muy importante: instalar NCSDK.  Si sigue las instrucciones de instalaci√≥n est√°ndar en la Raspberry Pi, no terminar√° en nada bueno: el instalador intentar√° arrastrar y compilar SSD-Caffe y Tensorflow.  En cambio, el NCSDK debe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">compilarse en modo solo API</a> .  En este modo, solo estar√°n disponibles las API de C ++ y Python (es decir, no ser√° posible compilar y perfilar gr√°ficos de redes neuronales).  Esto significa que el gr√°fico de la red neuronal primero debe compilarse en una computadora normal y luego copiarse a Raspberry.  Por conveniencia, agregu√© dos archivos compilados al repositorio, para YOLO y para SSD. <br><br>  Otro punto interesante es la conexi√≥n puramente f√≠sica de NCS a Raspberry.  Parece que no es dif√≠cil conectarlo a un conector USB, pero debe recordar que su carcasa bloquear√° los otros tres conectores (es bastante saludable, ya que act√∫a como un radiador).  La salida m√°s f√°cil es conectarlo a trav√©s de un cable USB. <br><br>  Tambi√©n vale la pena tener en cuenta que la velocidad de ejecuci√≥n variar√° para diferentes versiones de USB (para esta red neuronal particular: 102 ms para USB 3.0, 92 ms para USB 2.0). <br><br>  Ahora sobre el poder de la NCS.  Seg√∫n la documentaci√≥n, consume hasta 1 vatio (a 5 voltios en el conector USB ser√° de hasta 200 ma; en comparaci√≥n: la c√°mara Raspberry consume hasta 250 ma).  Cuando funciona con un cargador regular de 5 voltios, 2 amperios, todo funciona muy bien.  Sin embargo, intentar conectar dos o m√°s NCS a Raspberry puede causar problemas.  En este caso, se recomienda utilizar un divisor USB con posibilidad de alimentaci√≥n externa. <br><br>  En Raspberry, la demostraci√≥n es m√°s lenta que en una computadora / laptop: 7.2 FPS versus 10.4 FPS.  Esto se debe a varios factores: en primer lugar, es imposible deshacerse de los c√°lculos en la CPU, pero se realizan mucho m√°s lentamente;  en segundo lugar, la velocidad de transferencia de datos afecta (para USB 2.0). <br><br>  Adem√°s, para comparar, intent√© ejecutar un detector de rostros en Raspberry YOLOv2 desde mi primer art√≠culo, pero funcion√≥ muy mal: a una velocidad de 3.6 FPS, pierde muchas caras incluso en cuadros simples.  Aparentemente, es muy sensible a los par√°metros de la imagen de entrada, cuya calidad en el caso de la c√°mara Raspberry est√° lejos de ser ideal.  SSD funciona mucho m√°s estable, aunque tuve que ajustar un poco la configuraci√≥n de video en la configuraci√≥n de RapiCam.  a veces tambi√©n extra√±a las caras en el marco, pero rara vez lo hace.  Para aumentar la estabilidad en aplicaciones reales, puede agregar un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">rastreador centroide</a> simple. <br><br>  Por cierto: lo mismo se puede reproducir en Python, hay un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tutorial sobre PyImageSearch</a> (Mobilenet-SSD se usa para la tarea de detecci√≥n de objetos). <br><br><h4>  Otras ideas </h4><br>  Tambi√©n prob√© un par de ideas para acelerar la red neuronal en s√≠: <br><br>  Primera idea: puede dejar solo la detecci√≥n de las capas <code>conv11</code> y <code>conv13</code> , y eliminar todas las capas adicionales.  Obtendr√° un detector que detecta solo caras peque√±as y funciona un poco m√°s r√°pido.  En general, no vale la pena. <br><br>  La segunda idea fue interesante, pero no funcion√≥: intent√© lanzar convoluciones desde la red neuronal con pesos cercanos a cero, con la esperanza de que fuera m√°s r√°pido.  Sin embargo, hubo pocas convoluciones de este tipo, y su eliminaci√≥n solo ralentiz√≥ ligeramente la red neuronal (el √∫nico presentimiento: esto se debe al hecho de que el n√∫mero de canales ha dejado de ser una potencia de dos). <br><br><h2>  Conclusi√≥n </h2><br>  Pens√© en detectar rostros en Raspberry durante mucho tiempo, como una subtarea de mi proyecto rob√≥tico.  No me gustaron los detectores cl√°sicos en t√©rminos de velocidad y calidad, y decid√≠ probar m√©todos de redes neuronales, al mismo tiempo que probaba el Neural Compute Stick, como resultado de lo cual hab√≠a dos proyectos en GitHub y tres art√≠culos sobre Habr√© (incluido el actual).  En general, el resultado me conviene, lo m√°s probable es que use este detector en mi robot (tal vez haya otro art√≠culo al respecto).  Vale la pena se√±alar que mi soluci√≥n puede no ser √≥ptima; sin embargo, este es un proyecto de capacitaci√≥n, hecho en parte por curiosidad por el NCS.  Sin embargo, espero que este art√≠culo sea √∫til para alguien. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424973/">https://habr.com/ru/post/es424973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424963/index.html">Financiaci√≥n de Zuckerberg: construyendo herramientas para la ciencia juntos</a></li>
<li><a href="../es424965/index.html">Reaccionar el desarrollo de aplicaciones usando ReasonReact</a></li>
<li><a href="../es424967/index.html">Atajos de JavaScript para principiantes</a></li>
<li><a href="../es424969/index.html">Gu√≠a de Node.js, Parte 9: Trabajar con el sistema de archivos</a></li>
<li><a href="../es424971/index.html">Habrokast "Puesta de sol manual" # 1. Tratando de configurar un entorno para desarrollar un juguete para Windows</a></li>
<li><a href="../es424975/index.html">Profundidades SIEM: correlaciones listas para usar. Parte 2. Esquema de datos como reflejo del modelo del "mundo"</a></li>
<li><a href="../es424977/index.html">Aprender de los errores: optimizar aplicaciones en App Store y Google Play</a></li>
<li><a href="../es424979/index.html">Olmo C√≥modo e inc√≥modo. Http, Tarea</a></li>
<li><a href="../es424981/index.html">Easter Egg Text RPG en el c√≥digo del motor de b√∫squeda de Google</a></li>
<li><a href="../es424985/index.html">En un importante precedente judicial, las agencias de inteligencia de EE. UU. No pudieron interceptar llamadas telef√≥nicas en el mensajero</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>