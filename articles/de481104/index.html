<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏾 👨‍👨‍👧‍👦 ♟️ Mischen von OpenJDK und NodeJS: Sprachübergreifende Interaktionen und vertikale Architektur 👨‍🔬 👩🏼‍🤝‍👨🏽 🔐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habr 

 Lange Zeit hatte ich die Idee, GraalVM mit Ihnen zu diskutieren, es aufzuschieben , bis schließlich der heutige Artikel gefunden wurde, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mischen von OpenJDK und NodeJS: Sprachübergreifende Interaktionen und vertikale Architektur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/481104/">  Hallo habr <br><br>  Lange Zeit hatte ich die Idee, <a href="https://www.graalvm.org/">GraalVM</a> mit Ihnen zu diskutieren, es <a href="https://www.graalvm.org/">aufzuschieben</a> , bis schließlich der heutige Artikel gefunden wurde, dessen Thema den Rahmen einer bestimmten virtuellen Maschine <a href="https://www.graalvm.org/">sprengt</a> .  Der Autor Mike Hearn skizziert das gesamte Paradigma der mehrsprachigen Interaktion und der mehrsprachigen Programmierung (Polyglot-Programmierung).  Als nächstes sehen Sie das berühmte Beispiel für vertikale Skalierung und einen sehr langen Artikel unter dem Schnitt. <br><br><img src="https://habrastorage.org/webt/w8/rn/pl/w8rnplm8qono1q-owxp4_dcmlxk.jpeg"><br><a name="habracut"></a><br>  In diesem Artikel geht es um eine innovative Art, Software zu schreiben, die in Zukunft populär werden könnte, aber wahrscheinlich nicht jetzt.  Der Artikel hat einen Code, ehrlich! <br><br>  In der Antike, also im Jahr 2015, schrieb ich, <a href="https://blog.plan99.net/why-kotlin-is-my-next-programming-language-c25c001e26e3%3F">warum Kotlin meine nächste Programmiersprache sein wird</a> , und im Jahr 2016 schrieb ich über <a href="https://blog.plan99.net/graal-truffle-134d8f28fb69">Graal und Truffle</a> : zwei radikale Forschungsprojekte im Zusammenhang mit Compilern, die die Arbeit von Sprachen wie Ruby nicht nur erheblich beschleunigen , sondern verkörpern auch in der Realität nahtlose interlanguage Interaktionen.  In diesen Projekten wird der dynamische (JIT) Compiler oder OpenJDK durch einen neuen ersetzt, der die Möglichkeit bietet, mit Anmerkungen versehene Interpreter automatisch in hochmoderne JIT-Compiler zu verwandeln. <br><br>  Um auf diese Themen im Jahr 2019 zurückzukommen, möchte ich Ihnen drei Dinge zeigen: <br><br><ol><li>  Wie man die kleine Bibliothek benutzt, die ich geschrieben habe, um NPM-Module aus dem Code von Programmen, die in Java oder Kotlin geschrieben sind, fast nahtlos zu verwenden. </li><li>  Erklären Sie alle guten Gründe, warum Sie es benötigen, auch wenn Sie denken, dass JavaScript / Java das Schlimmste auf der Welt ist, ohne Fischöl. </li><li>  Erläutern Sie kurz das Konzept der vertikalen Architektur, das mit dem auf Mikroservices ausgerichteten Design konkurriert.  Es befindet sich an der Schnittstelle der neuesten Versionen von GraalVM und OpenJDK und erfordert modernste Hardware. </li></ol><br><h4>  Verwendung von NPMs aus Java und Kotlin </h4><br>  Wir werden nur drei einfache Schritte unternehmen: <br><br><ol><li>  Nehmen Sie <a href="https://www.graalvm.org/">GraalVM</a> .  Hierbei handelt es sich um eine Reihe von Patches, die auf OpenJDK basieren und gerade rechtzeitig erschienen sind: Sie können den gesamten JVM-Bytecode ausführen, den Sie haben. </li><li> Wir nehmen mein <a href="https://github.com/mikehearn/nodejvm">NodeJVM-</a> Toolkit aus Github und fügen es unserem Pfad hinzu. </li><li> Ersetzen Sie <code>java</code> in der Befehlszeile durch <code>nodejvm</code> .  Das ist alles! </li></ol><br>  Okay, okay.  Ich gebe zu, hier zeichne ich ein wenig und übertreibe, bis zum Ende des Artikels wirst du einen solchen Stil ertragen müssen.  Natürlich ist alles gar nicht so einfach: Sie müssen das Modul trotzdem nehmen und verwenden. <br><br>  Überlegen Sie, wie es aussieht: <br><br><img src="https://habrastorage.org/webt/f3/ov/xv/f3ovxvzch5mpwwmhy8w7tqyyiaw.png"><br><br>  Beispielcode mit NodeJVM <br><br>  Schauen Sie sich dieses Bild genau an.  Ja, genau so sieht es aus: Kotlin mit einer integrierten mehrzeiligen Zeichenfolge, in der die automatische Vervollständigung von JavaScript erfolgt, nach der eine statische JavaScript-Analyse durchgeführt und die Syntax korrekt hervorgehoben wird.  Für die JVM funktionieren die gleichen Vorgänge von Java oder anderen Sprachen aus, die IntelliJ versteht.  Um solche Möglichkeiten zu erhalten, müssen Sie in den IDE-Einstellungen auf den Schalter klicken (lesen Sie hierzu die Readme-Datei für NodeJVM). Diese Funktion wird jedoch später automatisch ausgeführt.  Wenn es IntelliJ gelingt, durch Analyse des Datenstroms herauszufinden, dass Ihre Zeichenfolge schließlich an die <code>run</code> oder <code>eval</code> werden soll, wird sie als eingebettetes JS behandelt. <br><br>  Hier werde ich über die API für Kotlin sprechen, da diese in normalem Java etwas hübscher und praktischer ist als die API, aber alles, was ich unten beschreibe, kann auch in Java erfolgen. <br><br>  Achten Sie im obigen Code auf einige der folgenden Funktionen: <br><br><ul><li>  Um auf JavaScript zuzugreifen, müssen Sie den <code>nodejs {}</code> -Block verwenden.  Fakt ist, dass JavaScript Single-Threaded ist und dass Sie zum Ausführen von NPM-Modulen „den Node-Stream eingeben“ müssen.  Der <code>nodejs {}</code> -Block führt eine solche Synchronisation für uns durch, egal in welchem ​​Thread wir uns befinden.  Sie müssen sich also ständig daran erinnern: Um einen JS-Code auszuführen, müssen Sie sich im Prinzip in einem solchen Block befinden.  Sie können es so oft wie Sie möchten erneut eingeben, sodass es sicher ist, einen solchen Block an jedem Ort zu verwenden, an dem wir ihn benötigen.  Alle JavaScript-Rückrufe werden im <code>nodejs</code> ausgeführt, und daher wird allen anderen Threads der Zugriff auf den Block <code>nodejs</code> verweigert. Wenn Sie sich also Gedanken über die Leistung oder das reibungslose Rendern der <code>nodejs</code> machen, vermeiden Sie die Ausführung lang laufender Vorgänge in Rückrufen. </li><li>  Die Syntax <code>var x by bind(SomeObject())</code> ist nur im <code>nodejs</code> Block verfügbar und ermöglicht es Ihnen, im globalen JavaScript-Bereich eine Verbindung zu derselben Variablen <code>nodejs</code> .  Wenn sich x von Kotlin ändert, ändert sich dies in JS und umgekehrt.  Hier füge ich der JS-Welt ein reguläres Java- <code>File</code> Objekt hinzu. </li><li>  Die <code>eval</code> Methode gibt zurück ... was wir von ihr verlangen, jedoch in der Art der statischen Typisierung.  Dies ist eine generische Funktion. Durch Angabe des Entitätstyps, den wir ihr zuweisen, wird sichergestellt, dass das JavaScript-Objekt von eval automatisch in eine statisch typisierte Klasse oder eine Java / Kotlin / Scala / etc-Schnittstelle umgewandelt wird.  Obwohl dies oben nicht explizit angegeben wurde, ist <code>MemoryUsage</code> ein einfacher Schnittstellentyp, den ich definiert habe, und er verfügt über die Funktionen <code>rss()</code> und <code>heapTotal()</code> .  Sie werden den gleichnamigen JavaScript-Eigenschaften zugeordnet und auf das angewendet, was Sie von der Node-API <code>process.memoryUsage()</code> .  Die meisten JS-Typen können daher in „normale“ Java-Typen konvertiert werden.  Eine ausführliche Dokumentation der Funktionsweise finden Sie auf der GraalVM-Website.  Die resultierenden Objekte können überall gespeichert werden, aber die Methodenaufrufe in ihnen müssen natürlich im <code>nodejs</code> Block erfolgen. </li><li>  JavaScript-Objekte können auch als einfache Zuordnungen eines Strings zu einem Objekt betrachtet werden, was in vielerlei Hinsicht ihrer Natur entspricht.  Solche Zuordnungen einer Zeichenfolge zu einem Objekt können wiederum auf etwas Stärkeres zurückgeführt werden, was im Rückruf deutlich zu sehen ist.  Verwenden Sie die Präsentation, die Sie bevorzugen. </li><li>  Sie können <code>require</code> und es wird auf die übliche Weise in den <code>node_modules</code> Verzeichnissen nach Modulen <code>node_modules</code> . </li></ul><br>  Das obige Code-Snippet verwendet das <a href="https://dat.foundation/">DAT-</a> Protokoll, mit dem Sie eine Remote-Verbindung zu einem Peer-to-Peer-Netzwerk herstellen können, das BitTorrent ähnelt, und nach Peers suchen, die die gewünschte Datei haben.  Ich verwende DAT als Beispiel, da es (a) dezentral und daher einzigartig schick ist und (b) zum Guten oder Schlechten, ist seine Referenzimplementierung in JavaScript geschrieben.  Dies ist kein Programm, das ich vollständig schreiben könnte, ohne JS in einer angemessenen Zeit zu verwenden. <br><br>  Dies kann auch von Java aus erfolgen: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.plan99.nodejs.NodeJS; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Demo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = NodeJS.runJS(() -&gt; NodeJS.eval(<span class="hljs-string"><span class="hljs-string">"return 2 + 3 + 4"</span></span>).asInt() ); System.out.println(result); } }</code> </pre> <br>  Die Java-API bietet Ihnen keine so angenehme Variablenbindung und automatische Umwandlung wie die Kotlin-API, ist jedoch recht einfach zu verwenden.  Hier zeigen wir, wie wir das Ergebnis in einen Java ( <code>int</code> ) vom Integer-Typ konvertieren und "aus" dem Node-Stream zurückgeben: In diesem Fall ist der Haupt-Java-Stream <b>nicht mit dem</b> NodeJS-Stream identisch, aber wir wechseln nahtlos zwischen diesen Flows. <br><br>  NodeJVM ist ein sehr, sehr kleiner Wrapper auf <a href="https://www.graalvm.org/">GraalVM</a> .  Es fügt eine unbedeutende Menge Code hinzu. Machen Sie sich also keine Sorgen, dass der Code möglicherweise nicht mehr unterstützt wird oder verschwindet. 99,99% der in diesem Fall geleisteten Arbeit wird vom GraalVM-Team ausgeführt. <br><br>  Hier einige offensichtliche Vorschläge für Verbesserungen: <br><br><ul><li>  Ermöglichen Sie JS-Modulen, Java-Module nach Maven-Koordinaten zu importieren. </li><li>  Formulierung einiger „Best Practices“ für die Java-Erstellung von NPM-Modulen.  Kann eine JAR-Datei beispielsweise ein node_modules-Verzeichnis enthalten (kurz gesagt: Nein, da NodeJS die Datei-E / A-Vorgänge immer noch auf seine eigene Weise organisiert und nichts über Reißverschlüsse weiß, lange gesagt: Ja, wenn Sie sich anstrengen). </li><li>  Weitere Sprachen: Python und Ruby benötigen für die Thread-Synchronisierung nicht den in NodeJS erforderlichen „Kleber“. Sie können also einfach die reguläre <a href="https://www.graalvm.org/docs/reference-manual/polyglot/">GraalVM Polyglot-API verwenden</a> .  Kotlin-Benutzer werden jedoch feststellen, dass Cast- / Erweiterungsmethoden und APIs zum Binden von Variablen in jeder Sprache nützlich sind. </li><li>  Windows-Unterstützung. </li><li>  Gradle-Plugin, damit Programme Abhängigkeitslisten in verschiedenen Sprachen haben können </li><li>  Integration mit dem <code>native-image</code> Tool, dem sogenannten  SubstrateVM;  Wenn Sie also zur Laufzeit nicht die volle Leistung von HotSpot benötigen, können Sie kleine statisch verknüpfte Binärdateien im Golang-Stil bereitstellen. </li><li>  Vielleicht eine Art Konverter zum Konvertieren von TypeScript in Java, damit Sie <a href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped verwenden</a> und schnell in die statische Welt eintauchen können. </li></ul><br>  Patches sind willkommen. <br><br><h4>  Warum brauchst du das? </h4><br>  Vielleicht denken Sie schon: "Wow, JavaScript, das wir entwickelt haben, kann jetzt in gegenseitiger Liebe, gegenseitigem Respekt und Harmonie sein!" <br><br><img src="https://habrastorage.org/webt/pg/hg/_d/pghg_dqd6pgbortse6gaqdks-p8.gif"><br><br>  Idealisierte begeisterte Reaktion <br><br>  Es ist sehr wahrscheinlich, dass Sie diesem Standpunkt näher kommen: <br><br><img src="https://habrastorage.org/webt/j9/th/g6/j9thg6dscg5ce13x_vtpajwvjmm.jpeg"><br><br>  JavaScript und Java sind nicht nur Sprachen.  Dies sind Kulturen, und nichts ist Entwicklern so sympathisch wie CULTURAL WARS! <br><br>  Aus diesem Grund sollten Sie diese Seite zumindest als Lesezeichen für zukünftige Referenz verwenden, auch wenn Sie nur mit dem Gedanken daran, dass $ OTHER_LANG in Ihr kostbares Ökosystem eindringt, die Waffe greifen möchten: <br><br><ul><li>  Wenn Sie in erster Linie <b>Java-</b> Entwickler sind, haben Sie jetzt Zugriff auf eindeutige JavaScript-Module, die möglicherweise keine Entsprechung in der JVM haben (z. B. das DAT-Protokoll).  Sie können es lieben oder hassen, aber die Tatsache bleibt: Viele Leute schreiben Open-Source-NPM-Module, und einige dieser Module sind sehr gut.  Sie können auch Code wiederverwenden, der auf Ihren Web-Frontends ausgeführt wird, ohne Sprachtransporter zu benötigen.  Und wenn Sie mit einer geerbten Codebasis in NodeJS arbeiten, die Sie nach und nach nach Java portieren möchten, wird diese Arbeit plötzlich erheblich vereinfacht. </li><li>  Wenn Sie in erster Linie <b>JavaScript-</b> Entwickler sind, haben Sie jetzt einfachen Zugriff auf eindeutige JVM-Bibliotheken, die in JavaScript möglicherweise keine direkten Entsprechungen aufweisen (z. B. <a href="http://lucene.apache.org/">Lucene</a> , <a href="https://github.com/OpenHFT/Chronicle-Map">Chronicle Map</a> ) oder nur schlecht dokumentierte, unreife oder weniger produktive Analoga bieten .  Wenn Sie in Ihrem nächsten Projekt auf HTML verzichten möchten, können Sie das <a href="https://blog.plan99.net/reacts-tictactoe-tutorial-in-kotlin-javafx-715c75a947d2">GUI-Framework für eine weiße Person untersuchen</a> .  Sie können auch auf <b>viele andere Sprachen</b> zugreifen, z. B. Ruby- und R. JVM-Objekte können von NodeJS-Mitarbeitern gemeinsam genutzt werden, wobei <a href="https://medium.com/graalvm/multi-threaded-java-javascript-language-interoperability-in-graalvm-2f19c1f9c37b">das Multithreading im gemeinsam genutzten Speicher genutzt wird</a> , wenn diese Möglichkeit Ihrem Profiler zufolge genutzt werden kann.  Und wenn Sie mit einer geerbten Java-Codebasis arbeiten, die Sie nach und nach auf NodeJS portieren möchten, wird diese Arbeit plötzlich erheblich vereinfacht. </li><li>  Wenn Sie <b>alle Sprachen gleichzeitig lernen</b> , können Sie mehrsprachig programmieren.  Vielsprachige Programmierer sind keine Hasser, im Gegenteil, sie können sich mit dem besten verfügbaren Code anfreunden, egal aus welcher Kultur er stammt.  Sie sind wie Studenten der Renaissance, die sofort Englisch, Französisch und Latein gelernt haben ... all diese Sprachen sind eine für sie.  Sie mischen die Java-, Kotlin-, JavaScript-, Scala-, Python-, Ruby-, Lisp-, R-, Rust-, Smalltalk-, C / C ++ - und sogar FORTRAN-Bibliotheken und setzen eine saubere Ganzzahl auf GraalVM. </li><li>  Wenn Sie ein zufriedener NodeJS-Benutzer sind und andere Sprachen Sie überhaupt nicht stören, möchten Sie möglicherweise trotzdem mit GraalVM experimentieren. </li></ul><br>  NodeJS basiert auf V8, einer virtuellen Maschine, die kurzlebige Single-Thread-Skripts verwendet, die auf PCs und Smartphones ausgeführt werden.  Genau das wird von Google finanziert, aber V8 wird auch auf Servern verwendet.  OpenJDK ist seit Jahrzehnten auf Servern optimiert.  Die neuesten Versionen enthalten <a href="https://wiki.openjdk.java.net/display/zgc/Main">ZGC</a> und <a href="https://wiki.openjdk.java.net/display/shenandoah/Main">Shenandoah</a> , zwei Garbage Collectors, die eine minimale Latenz ermöglichen. Mit diesen Tools können Sie Terabytes an Speicher mit nur wenigen Millisekunden Pausen belegen.  Daher können Sie möglicherweise sogar die Kosten senken, indem Sie die <a href="https://www.graalvm.org/docs/reference-manual/tools/">hervorragende GraalVM-Infrastruktur und -Tools verwenden</a> , ohne auf Einsprachigkeit zu verzichten. <br><br><img src="https://habrastorage.org/webt/tn/4y/68/tn4y68r7cmq6z9tpheeuwafpncy.png"><br><br>  Zeigen Sie den Heap mit Ruby-Objekten an <br><br><img src="https://habrastorage.org/webt/ko/vc/jj/kovcjjmwvhnayjpfix25cs-rx48.png"><br><br>  Über HTTP verfügbare CPU-Metriken <br><br><img src="https://habrastorage.org/webt/sb/fq/qy/sbfqqy9mzuppcp-vnro8tdscc_o.png"><br><br>  Extrem fundierte Expertendiagnose, die zeigt, wie der Code optimiert wurde <br><br><h4>  Vertikale Architektur </h4><br>  Wir kommen zum letzten Thema, das ich in diesem Artikel diskutieren möchte. <br><br>  Manchmal erzähle ich jemandem all das, aber sie antworten mir: „ <i>Das ist großartig, aber geben uns all diese Microservices das nicht alles?</i>  <i>Woran liegt die ganze Aufregung?</i>  Es ist schwer zu verstehen, warum ich mehrsprachiges Programmieren so sehr mag, aber es scheint mir, dass Microservice-Architekturen einen gesunden Wettbewerb brauchen. <br><br>  Erstens, ja, manchmal müssen Sie viele Dienste auf einer Vielzahl von Servern betreiben, die interagieren müssen.  Ich habe mehr als 7 Jahre bei Google gearbeitet und mich fast täglich mit deren Container-Orchestrator Borg auseinandergesetzt.  Ich habe "microservices" geschrieben, obwohl wir sie nicht einmal angerufen haben, und sie konsumiert.  Ansonsten gab es keine Möglichkeit, damit umzugehen, da für unsere Arbeitsbelastung Tausende von Maschinen erforderlich waren! <br><br>  Für solche Architekturen muss man allerdings einen hohen Preis zahlen: <br><br><ol><li>  <b>Serialisierung</b>  Dies führt sofort zu einer Verringerung der Produktivität, erfordert jedoch vor allem, dass Sie Ihre zumindest teilweise typisierten und optimierten Datenstrukturen ständig ausrichten und in einfache Bäume verwandeln.  Wenn Sie auf JSON zurückgreifen, verlieren Sie die Fähigkeit, einfache Dinge zu tun, z. B. viele kleine Objekte, die auf mehrere große Objekte verweisen (um Wiederholungen zu vermeiden, müssen Sie Ihre eigenen Indizes verwenden). </li><li>  <b>Versionierung</b>  Das ist schwer.  Die Universitäten unterrichten diese schwierige, aber alltägliche Disziplin im Bereich Software-Engineering oft nicht, und selbst wenn Sie der Meinung sind, dass Sie den Unterschied zwischen direkter und rückwärtiger Kompatibilität gründlich verstanden haben, können Sie garantieren, dass Sie wissen, was mehrstufiges Rollen ist dass all dies von der Person verstanden wird, die Sie ersetzen wird?  Führen Sie die Integrationstests für verschiedene Versionskombinationen korrekt durch, die während des Nicht-Atom-Rollouts entstehen können?  In verteilten Architekturen habe ich mehrere echte Katastrophen gesehen, die darauf hinausliefen, dass die Versionen vom rechten Weg abgekommen sind. </li><li>  <b>Kohärenz</b> .  Das Ausführen atomarer Operationen auf demselben Server ist recht einfach.  Es ist viel schwieriger sicherzustellen, dass Benutzer in jeder Situation ein absolut konsistentes Bild sehen, wenn viele Computer an dem System beteiligt sind, insbesondere, wenn zwischen ihnen Datenverluste auftreten.  Aus diesem Grund können relationale Datenbank-Engines historisch gesehen keine gute Skalierbarkeit aufweisen.  Lassen Sie mich Ihnen sagen: Die <a href="https://www.piter.com/collection/all/product/site-reliability-engineering-nadezhnost-i-bezotkaznost-kak-v-google">besten Google-Ingenieure haben jahrzehntelang</a> versucht, die verteilte Programmierung für ihre Teams zu vereinfachen und sie so zu gestalten, dass sie eher einer herkömmlichen ähnelt. </li><li>  <b>Neuimplementierung</b> .  Da Remoteprozeduraufrufe teuer sind, werden Sie nicht viele solcher Anrufe tätigen, und es bleibt nichts zu tun, um einige Probleme zu lösen, sondern den Code erneut zu implementieren.  Google hat einige Bibliotheken für die gleichzeitige Arbeit mit mehreren Sprachen erstellt, um Remoteprozeduren aufrufen zu können.  Es gibt auch Situationen, in denen ein solcher Code von Grund auf neu geschrieben werden muss. </li></ol><br>  Also, was ist die Alternative? <br><br>  Einfach gesagt, viel Eisen.  Diese Methode mag absurd großartig erscheinen, aber denken Sie daran, dass die Hardwarekosten ständig sinken, viele Workloads nicht als „global global“ bezeichnet werden und Ihre Intuition darüber, wofür Sie ausgeben sollten, scheitern kann. <br><br>  Hier ist eine relativ neue <a href="http://www.deltaserverstore.com/dell-r910.html">Preisliste</a> eines kanadischen Herstellers: <br><br><img src="https://habrastorage.org/webt/_2/ko/qq/_2koqq_9uanqjed7ebsfcwjzyqy.png"><br><br>  Ein vierzigkerniger Rechner mit einem Terabyte RAM und fast einem Terabyte auf der Festplatte kostet heute etwa 6.000 US-Dollar.  Stellen Sie sich vor, wie viel Zeit Ihr Team für die gesamte Projektlaufzeit benötigt, um Probleme mit verteilten Systemen zu lösen, und wie viel es Sie kosten wird. <br><br>  Ja, aber sind nicht alle heutigen Unternehmen global webbasiert? <br><br>  Kurz gesagt, nein. <br><br>  Die Welt ist voll von Unternehmen, für die Folgendes zutrifft: <br><br><ul><li>  Sie operieren in stabilen Märkten. </li><li>  Sie verdienen, indem sie Dinge verkaufen. </li><li>  Folglich zählt ihr Kundenstamm mehrere Zehntausend bis Zehntausend Millionen Menschen, aber nicht Milliarden. </li><li>  Ihre Datensätze sind normalerweise mit ihren eigenen Kunden und Produkten verknüpft. </li></ul><br>  Ein gutes Beispiel für ein solches Unternehmen ist eine Bank.  Banken erleben kein "Hyperwachstum", werden nicht "viral".  Ihr Wachstumsmodell ist moderat und vorhersehbar, wenn man davon ausgeht, dass sie in irgendeiner Form wachsen (Banken sind regional und operieren in der Regel in gesättigten Märkten).  Der Kundenstamm der größten US-Bank beträgt rund 50 Millionen Nutzer und verdoppelt sich natürlich nicht alle sechs Monate.  In diesem Fall ist die Situation überhaupt nicht die gleiche wie bei Instagram.  Kein Wunder also, dass der Mainframe immer noch auf einem typischen Bankensystem basiert?  Gleiches gilt natürlich auch für Logistikunternehmen, Fertigungsunternehmen usw.  Das ist das A und O unserer Wirtschaft. <br><br>  In solchen Unternehmen ist es durchaus möglich, dass die Anforderungen jeder spezifischen Anwendung immer mit den Ressourcen einer einzigen großen Maschine erfüllt werden können.  Ja, sogar einige öffentliche Sites passen heute auf einen einzelnen Computer.  Im Jahr 2015 hielt Maciej Tseglovsky einen sehr interessanten Vortrag zum Thema „ <a href="https://idlewords.com/talks/website_obesity.htm">Die Krise mit der Fettleibigkeit von Websites</a> “ und stellte fest, dass seine eigene Website mit Lesezeichen-Service rentabel war, sein Konkurrent jedoch dieselbe Website auf AWS veröffentlichte - und nur aufgrund unterschiedlicher Kosten verlor Ausrüstung und verschiedene Annahmen über die Komplexität.  In einer Studie zum Vergleich der <a href="https://blog.codinghorror.com/scaling-up-vs-scaling-out-hidden-costs/">vertikalen und horizontalen Skalierung</a> wurde festgestellt, dass PlentyOfFish auf ca. einem Megaserver ausgeführt wird (der Artikel stammt aus dem Jahr 2009, sodass Sie die dort aufgeführten Gerätepreise ignorieren können).  Der Autor führt einige Berechnungen durch und zeigt, dass ein Server nicht so dumm ist, wie es scheint.  Wenn Sie sich für Hadoop und Big Data entscheiden, lesen Sie diesen <a href="https://www.researchgate.net/publication/261862149_Scale-up_vs_scale-out_for_Hadoop_time_to_rethink">Microsoft-Forschungsartikel</a> aus dem Jahr <a href="https://www.researchgate.net/publication/261862149_Scale-up_vs_scale-out_for_Hadoop_time_to_rethink">2013, in</a> dem gezeigt wird, dass viele der Hadoop-Workloads von Microsoft, Yahoo und Facebook auf einem einzelnen großen Computer wesentlich schneller und effizienter ausgeführt werden als auf einem Cluster.  Und so war es vor 6 Jahren!  Es ist wahrscheinlich, dass seitdem die Betonung der vertikalen Skalierung noch deutlicher geworden ist. <br><br>  Die wirklichen Einsparungen sind jedoch keineswegs mit der Ausrüstung verbunden, sondern mit der Optimierung der extrem kostspieligen Arbeitszeit der Ingenieure, die für die Erstellung einer Reihe winziger Mikrodienste aufgewendet wird, die mit einem elastischen Nachfragemanagement horizontal skaliert werden müssen.  Solch eine Herangehensweise an das Engineering ist riskant und zeitaufwändig, selbst wenn Sie die neuesten Spielzeuge verwenden, die in der Cloud verfügbar sind.  Sie können SQL, SOLID-Transaktionen und Unified Profiling verlieren, und Sie werden definitiv Informationen wie die systemübergreifende Stapelverfolgung verlieren.  Die Typensicherheit verschwindet jedes Mal, wenn Sie den Server verlassen.  Sie erhalten Aufrufe von Funktionen, bei denen möglicherweise eine Zeitüberschreitung eintritt, ein übermäßiger Overhead im Zusammenhang mit der dynamischen Kompilierung, unerwartete Rückstauausfälle, komplexe Orchestrierungs-Engines mit ausgefallenen Konfigurationsformaten und ... oh, die Erinnerungen sind wirklich überfüllt.  Es war interessant, mit all dem zu arbeiten, als mir die proprietäre Google-Architektur und ein umfangreiches Engineering-Budget zur Verfügung standen, aber heute würde ich es wagen, dies nur zu wiederholen, wenn ich keine andere Wahl hätte. <br><br>  Erfahrungsgemäß ist es nicht möglich, mit sehr großen Servern zu arbeiten, die mit Garbage Collection arbeiten - die Garbage Collection selbst war eine schlecht entwickelte Technologie, und daher ist dieses Thema lange Zeit rein akademisch geblieben.  In jedem Fall mussten Sie mehrere Server gleichzeitig fahren. ,   ZGC  Shenandoah,   ,   80          –      .    ,     -,       –  ,     . <br><br> ,         ?         –   ,        ?   –    :  ,      ,        …    . <br><br><h4>  Fazit </h4><br> NodeJVM –  ,    GraalVM.     NPM    Java/Kotlin,   JS  ,    Kotlin   JavaScript,      JS  ,   V8. <br><br>     ,    JS  Java,    Java  JS         . <br><br>        ,           4 ,     –      –  ,            .             . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de481104/">https://habr.com/ru/post/de481104/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de481086/index.html">Vivaldi 2.10 - Undercover Agent</a></li>
<li><a href="../de481092/index.html">Das Interessanteste in PHP 8</a></li>
<li><a href="../de481094/index.html">Über JBL Funkkopfhörer mit Solarenergie und was ist mit ihnen los</a></li>
<li><a href="../de481100/index.html">Winkel 9, was ist neu?</a></li>
<li><a href="../de481102/index.html">Plattformübergreifende .NET UI-Toolkit-Version AvaloniaUI 0.9</a></li>
<li><a href="../de481106/index.html">Wie LANIT eine DIY-Sitcom in seinem Büro drehte</a></li>
<li><a href="../de481110/index.html">Playme VEGA review: Combo-Rekorder mit Touchscreen und Spiegelhalterung</a></li>
<li><a href="../de481112/index.html">Was sagt das Kaugummi-Alter von 5700 Jahren über die Person aus, die es gekaut hat?</a></li>
<li><a href="../de481114/index.html">Seccomp bei Kubernetes: 7 Dinge, die Sie von Anfang an wissen müssen</a></li>
<li><a href="../de481116/index.html">Automatisch Posts aus der VKontakte-Community in Discord veröffentlichen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>