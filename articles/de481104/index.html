<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèæ üë®‚Äçüë®‚Äçüëß‚Äçüë¶ ‚ôüÔ∏è Mischen von OpenJDK und NodeJS: Sprach√ºbergreifende Interaktionen und vertikale Architektur üë®‚Äçüî¨ üë©üèº‚Äçü§ù‚Äçüë®üèΩ üîê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo habr 

 Lange Zeit hatte ich die Idee, GraalVM mit Ihnen zu diskutieren, es aufzuschieben , bis schlie√ülich der heutige Artikel gefunden wurde, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mischen von OpenJDK und NodeJS: Sprach√ºbergreifende Interaktionen und vertikale Architektur</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/481104/">  Hallo habr <br><br>  Lange Zeit hatte ich die Idee, <a href="https://www.graalvm.org/">GraalVM</a> mit Ihnen zu diskutieren, es <a href="https://www.graalvm.org/">aufzuschieben</a> , bis schlie√ülich der heutige Artikel gefunden wurde, dessen Thema den Rahmen einer bestimmten virtuellen Maschine <a href="https://www.graalvm.org/">sprengt</a> .  Der Autor Mike Hearn skizziert das gesamte Paradigma der mehrsprachigen Interaktion und der mehrsprachigen Programmierung (Polyglot-Programmierung).  Als n√§chstes sehen Sie das ber√ºhmte Beispiel f√ºr vertikale Skalierung und einen sehr langen Artikel unter dem Schnitt. <br><br><img src="https://habrastorage.org/webt/w8/rn/pl/w8rnplm8qono1q-owxp4_dcmlxk.jpeg"><br><a name="habracut"></a><br>  In diesem Artikel geht es um eine innovative Art, Software zu schreiben, die in Zukunft popul√§r werden k√∂nnte, aber wahrscheinlich nicht jetzt.  Der Artikel hat einen Code, ehrlich! <br><br>  In der Antike, also im Jahr 2015, schrieb ich, <a href="https://blog.plan99.net/why-kotlin-is-my-next-programming-language-c25c001e26e3%3F">warum Kotlin meine n√§chste Programmiersprache sein wird</a> , und im Jahr 2016 schrieb ich √ºber <a href="https://blog.plan99.net/graal-truffle-134d8f28fb69">Graal und Truffle</a> : zwei radikale Forschungsprojekte im Zusammenhang mit Compilern, die die Arbeit von Sprachen wie Ruby nicht nur erheblich beschleunigen , sondern verk√∂rpern auch in der Realit√§t nahtlose interlanguage Interaktionen.  In diesen Projekten wird der dynamische (JIT) Compiler oder OpenJDK durch einen neuen ersetzt, der die M√∂glichkeit bietet, mit Anmerkungen versehene Interpreter automatisch in hochmoderne JIT-Compiler zu verwandeln. <br><br>  Um auf diese Themen im Jahr 2019 zur√ºckzukommen, m√∂chte ich Ihnen drei Dinge zeigen: <br><br><ol><li>  Wie man die kleine Bibliothek benutzt, die ich geschrieben habe, um NPM-Module aus dem Code von Programmen, die in Java oder Kotlin geschrieben sind, fast nahtlos zu verwenden. </li><li>  Erkl√§ren Sie alle guten Gr√ºnde, warum Sie es ben√∂tigen, auch wenn Sie denken, dass JavaScript / Java das Schlimmste auf der Welt ist, ohne Fisch√∂l. </li><li>  Erl√§utern Sie kurz das Konzept der vertikalen Architektur, das mit dem auf Mikroservices ausgerichteten Design konkurriert.  Es befindet sich an der Schnittstelle der neuesten Versionen von GraalVM und OpenJDK und erfordert modernste Hardware. </li></ol><br><h4>  Verwendung von NPMs aus Java und Kotlin </h4><br>  Wir werden nur drei einfache Schritte unternehmen: <br><br><ol><li>  Nehmen Sie <a href="https://www.graalvm.org/">GraalVM</a> .  Hierbei handelt es sich um eine Reihe von Patches, die auf OpenJDK basieren und gerade rechtzeitig erschienen sind: Sie k√∂nnen den gesamten JVM-Bytecode ausf√ºhren, den Sie haben. </li><li> Wir nehmen mein <a href="https://github.com/mikehearn/nodejvm">NodeJVM-</a> Toolkit aus Github und f√ºgen es unserem Pfad hinzu. </li><li> Ersetzen Sie <code>java</code> in der Befehlszeile durch <code>nodejvm</code> .  Das ist alles! </li></ol><br>  Okay, okay.  Ich gebe zu, hier zeichne ich ein wenig und √ºbertreibe, bis zum Ende des Artikels wirst du einen solchen Stil ertragen m√ºssen.  Nat√ºrlich ist alles gar nicht so einfach: Sie m√ºssen das Modul trotzdem nehmen und verwenden. <br><br>  √úberlegen Sie, wie es aussieht: <br><br><img src="https://habrastorage.org/webt/f3/ov/xv/f3ovxvzch5mpwwmhy8w7tqyyiaw.png"><br><br>  Beispielcode mit NodeJVM <br><br>  Schauen Sie sich dieses Bild genau an.  Ja, genau so sieht es aus: Kotlin mit einer integrierten mehrzeiligen Zeichenfolge, in der die automatische Vervollst√§ndigung von JavaScript erfolgt, nach der eine statische JavaScript-Analyse durchgef√ºhrt und die Syntax korrekt hervorgehoben wird.  F√ºr die JVM funktionieren die gleichen Vorg√§nge von Java oder anderen Sprachen aus, die IntelliJ versteht.  Um solche M√∂glichkeiten zu erhalten, m√ºssen Sie in den IDE-Einstellungen auf den Schalter klicken (lesen Sie hierzu die Readme-Datei f√ºr NodeJVM). Diese Funktion wird jedoch sp√§ter automatisch ausgef√ºhrt.  Wenn es IntelliJ gelingt, durch Analyse des Datenstroms herauszufinden, dass Ihre Zeichenfolge schlie√ülich an die <code>run</code> oder <code>eval</code> werden soll, wird sie als eingebettetes JS behandelt. <br><br>  Hier werde ich √ºber die API f√ºr Kotlin sprechen, da diese in normalem Java etwas h√ºbscher und praktischer ist als die API, aber alles, was ich unten beschreibe, kann auch in Java erfolgen. <br><br>  Achten Sie im obigen Code auf einige der folgenden Funktionen: <br><br><ul><li>  Um auf JavaScript zuzugreifen, m√ºssen Sie den <code>nodejs {}</code> -Block verwenden.  Fakt ist, dass JavaScript Single-Threaded ist und dass Sie zum Ausf√ºhren von NPM-Modulen ‚Äûden Node-Stream eingeben‚Äú m√ºssen.  Der <code>nodejs {}</code> -Block f√ºhrt eine solche Synchronisation f√ºr uns durch, egal in welchem ‚Äã‚ÄãThread wir uns befinden.  Sie m√ºssen sich also st√§ndig daran erinnern: Um einen JS-Code auszuf√ºhren, m√ºssen Sie sich im Prinzip in einem solchen Block befinden.  Sie k√∂nnen es so oft wie Sie m√∂chten erneut eingeben, sodass es sicher ist, einen solchen Block an jedem Ort zu verwenden, an dem wir ihn ben√∂tigen.  Alle JavaScript-R√ºckrufe werden im <code>nodejs</code> ausgef√ºhrt, und daher wird allen anderen Threads der Zugriff auf den Block <code>nodejs</code> verweigert. Wenn Sie sich also Gedanken √ºber die Leistung oder das reibungslose Rendern der <code>nodejs</code> machen, vermeiden Sie die Ausf√ºhrung lang laufender Vorg√§nge in R√ºckrufen. </li><li>  Die Syntax <code>var x by bind(SomeObject())</code> ist nur im <code>nodejs</code> Block verf√ºgbar und erm√∂glicht es Ihnen, im globalen JavaScript-Bereich eine Verbindung zu derselben Variablen <code>nodejs</code> .  Wenn sich x von Kotlin √§ndert, √§ndert sich dies in JS und umgekehrt.  Hier f√ºge ich der JS-Welt ein regul√§res Java- <code>File</code> Objekt hinzu. </li><li>  Die <code>eval</code> Methode gibt zur√ºck ... was wir von ihr verlangen, jedoch in der Art der statischen Typisierung.  Dies ist eine generische Funktion. Durch Angabe des Entit√§tstyps, den wir ihr zuweisen, wird sichergestellt, dass das JavaScript-Objekt von eval automatisch in eine statisch typisierte Klasse oder eine Java / Kotlin / Scala / etc-Schnittstelle umgewandelt wird.  Obwohl dies oben nicht explizit angegeben wurde, ist <code>MemoryUsage</code> ein einfacher Schnittstellentyp, den ich definiert habe, und er verf√ºgt √ºber die Funktionen <code>rss()</code> und <code>heapTotal()</code> .  Sie werden den gleichnamigen JavaScript-Eigenschaften zugeordnet und auf das angewendet, was Sie von der Node-API <code>process.memoryUsage()</code> .  Die meisten JS-Typen k√∂nnen daher in ‚Äûnormale‚Äú Java-Typen konvertiert werden.  Eine ausf√ºhrliche Dokumentation der Funktionsweise finden Sie auf der GraalVM-Website.  Die resultierenden Objekte k√∂nnen √ºberall gespeichert werden, aber die Methodenaufrufe in ihnen m√ºssen nat√ºrlich im <code>nodejs</code> Block erfolgen. </li><li>  JavaScript-Objekte k√∂nnen auch als einfache Zuordnungen eines Strings zu einem Objekt betrachtet werden, was in vielerlei Hinsicht ihrer Natur entspricht.  Solche Zuordnungen einer Zeichenfolge zu einem Objekt k√∂nnen wiederum auf etwas St√§rkeres zur√ºckgef√ºhrt werden, was im R√ºckruf deutlich zu sehen ist.  Verwenden Sie die Pr√§sentation, die Sie bevorzugen. </li><li>  Sie k√∂nnen <code>require</code> und es wird auf die √ºbliche Weise in den <code>node_modules</code> Verzeichnissen nach Modulen <code>node_modules</code> . </li></ul><br>  Das obige Code-Snippet verwendet das <a href="https://dat.foundation/">DAT-</a> Protokoll, mit dem Sie eine Remote-Verbindung zu einem Peer-to-Peer-Netzwerk herstellen k√∂nnen, das BitTorrent √§hnelt, und nach Peers suchen, die die gew√ºnschte Datei haben.  Ich verwende DAT als Beispiel, da es (a) dezentral und daher einzigartig schick ist und (b) zum Guten oder Schlechten, ist seine Referenzimplementierung in JavaScript geschrieben.  Dies ist kein Programm, das ich vollst√§ndig schreiben k√∂nnte, ohne JS in einer angemessenen Zeit zu verwenden. <br><br>  Dies kann auch von Java aus erfolgen: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.plan99.nodejs.NodeJS; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Demo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result = NodeJS.runJS(() -&gt; NodeJS.eval(<span class="hljs-string"><span class="hljs-string">"return 2 + 3 + 4"</span></span>).asInt() ); System.out.println(result); } }</code> </pre> <br>  Die Java-API bietet Ihnen keine so angenehme Variablenbindung und automatische Umwandlung wie die Kotlin-API, ist jedoch recht einfach zu verwenden.  Hier zeigen wir, wie wir das Ergebnis in einen Java ( <code>int</code> ) vom Integer-Typ konvertieren und "aus" dem Node-Stream zur√ºckgeben: In diesem Fall ist der Haupt-Java-Stream <b>nicht mit dem</b> NodeJS-Stream identisch, aber wir wechseln nahtlos zwischen diesen Flows. <br><br>  NodeJVM ist ein sehr, sehr kleiner Wrapper auf <a href="https://www.graalvm.org/">GraalVM</a> .  Es f√ºgt eine unbedeutende Menge Code hinzu. Machen Sie sich also keine Sorgen, dass der Code m√∂glicherweise nicht mehr unterst√ºtzt wird oder verschwindet. 99,99% der in diesem Fall geleisteten Arbeit wird vom GraalVM-Team ausgef√ºhrt. <br><br>  Hier einige offensichtliche Vorschl√§ge f√ºr Verbesserungen: <br><br><ul><li>  Erm√∂glichen Sie JS-Modulen, Java-Module nach Maven-Koordinaten zu importieren. </li><li>  Formulierung einiger ‚ÄûBest Practices‚Äú f√ºr die Java-Erstellung von NPM-Modulen.  Kann eine JAR-Datei beispielsweise ein node_modules-Verzeichnis enthalten (kurz gesagt: Nein, da NodeJS die Datei-E / A-Vorg√§nge immer noch auf seine eigene Weise organisiert und nichts √ºber Rei√üverschl√ºsse wei√ü, lange gesagt: Ja, wenn Sie sich anstrengen). </li><li>  Weitere Sprachen: Python und Ruby ben√∂tigen f√ºr die Thread-Synchronisierung nicht den in NodeJS erforderlichen ‚ÄûKleber‚Äú. Sie k√∂nnen also einfach die regul√§re <a href="https://www.graalvm.org/docs/reference-manual/polyglot/">GraalVM Polyglot-API verwenden</a> .  Kotlin-Benutzer werden jedoch feststellen, dass Cast- / Erweiterungsmethoden und APIs zum Binden von Variablen in jeder Sprache n√ºtzlich sind. </li><li>  Windows-Unterst√ºtzung. </li><li>  Gradle-Plugin, damit Programme Abh√§ngigkeitslisten in verschiedenen Sprachen haben k√∂nnen </li><li>  Integration mit dem <code>native-image</code> Tool, dem sogenannten  SubstrateVM;  Wenn Sie also zur Laufzeit nicht die volle Leistung von HotSpot ben√∂tigen, k√∂nnen Sie kleine statisch verkn√ºpfte Bin√§rdateien im Golang-Stil bereitstellen. </li><li>  Vielleicht eine Art Konverter zum Konvertieren von TypeScript in Java, damit Sie <a href="https://github.com/DefinitelyTyped/DefinitelyTyped">DefinitelyTyped verwenden</a> und schnell in die statische Welt eintauchen k√∂nnen. </li></ul><br>  Patches sind willkommen. <br><br><h4>  Warum brauchst du das? </h4><br>  Vielleicht denken Sie schon: "Wow, JavaScript, das wir entwickelt haben, kann jetzt in gegenseitiger Liebe, gegenseitigem Respekt und Harmonie sein!" <br><br><img src="https://habrastorage.org/webt/pg/hg/_d/pghg_dqd6pgbortse6gaqdks-p8.gif"><br><br>  Idealisierte begeisterte Reaktion <br><br>  Es ist sehr wahrscheinlich, dass Sie diesem Standpunkt n√§her kommen: <br><br><img src="https://habrastorage.org/webt/j9/th/g6/j9thg6dscg5ce13x_vtpajwvjmm.jpeg"><br><br>  JavaScript und Java sind nicht nur Sprachen.  Dies sind Kulturen, und nichts ist Entwicklern so sympathisch wie CULTURAL WARS! <br><br>  Aus diesem Grund sollten Sie diese Seite zumindest als Lesezeichen f√ºr zuk√ºnftige Referenz verwenden, auch wenn Sie nur mit dem Gedanken daran, dass $ OTHER_LANG in Ihr kostbares √ñkosystem eindringt, die Waffe greifen m√∂chten: <br><br><ul><li>  Wenn Sie in erster Linie <b>Java-</b> Entwickler sind, haben Sie jetzt Zugriff auf eindeutige JavaScript-Module, die m√∂glicherweise keine Entsprechung in der JVM haben (z. B. das DAT-Protokoll).  Sie k√∂nnen es lieben oder hassen, aber die Tatsache bleibt: Viele Leute schreiben Open-Source-NPM-Module, und einige dieser Module sind sehr gut.  Sie k√∂nnen auch Code wiederverwenden, der auf Ihren Web-Frontends ausgef√ºhrt wird, ohne Sprachtransporter zu ben√∂tigen.  Und wenn Sie mit einer geerbten Codebasis in NodeJS arbeiten, die Sie nach und nach nach Java portieren m√∂chten, wird diese Arbeit pl√∂tzlich erheblich vereinfacht. </li><li>  Wenn Sie in erster Linie <b>JavaScript-</b> Entwickler sind, haben Sie jetzt einfachen Zugriff auf eindeutige JVM-Bibliotheken, die in JavaScript m√∂glicherweise keine direkten Entsprechungen aufweisen (z. B. <a href="http://lucene.apache.org/">Lucene</a> , <a href="https://github.com/OpenHFT/Chronicle-Map">Chronicle Map</a> ) oder nur schlecht dokumentierte, unreife oder weniger produktive Analoga bieten .  Wenn Sie in Ihrem n√§chsten Projekt auf HTML verzichten m√∂chten, k√∂nnen Sie das <a href="https://blog.plan99.net/reacts-tictactoe-tutorial-in-kotlin-javafx-715c75a947d2">GUI-Framework f√ºr eine wei√üe Person untersuchen</a> .  Sie k√∂nnen auch auf <b>viele andere Sprachen</b> zugreifen, z. B. Ruby- und R. JVM-Objekte k√∂nnen von NodeJS-Mitarbeitern gemeinsam genutzt werden, wobei <a href="https://medium.com/graalvm/multi-threaded-java-javascript-language-interoperability-in-graalvm-2f19c1f9c37b">das Multithreading im gemeinsam genutzten Speicher genutzt wird</a> , wenn diese M√∂glichkeit Ihrem Profiler zufolge genutzt werden kann.  Und wenn Sie mit einer geerbten Java-Codebasis arbeiten, die Sie nach und nach auf NodeJS portieren m√∂chten, wird diese Arbeit pl√∂tzlich erheblich vereinfacht. </li><li>  Wenn Sie <b>alle Sprachen gleichzeitig lernen</b> , k√∂nnen Sie mehrsprachig programmieren.  Vielsprachige Programmierer sind keine Hasser, im Gegenteil, sie k√∂nnen sich mit dem besten verf√ºgbaren Code anfreunden, egal aus welcher Kultur er stammt.  Sie sind wie Studenten der Renaissance, die sofort Englisch, Franz√∂sisch und Latein gelernt haben ... all diese Sprachen sind eine f√ºr sie.  Sie mischen die Java-, Kotlin-, JavaScript-, Scala-, Python-, Ruby-, Lisp-, R-, Rust-, Smalltalk-, C / C ++ - und sogar FORTRAN-Bibliotheken und setzen eine saubere Ganzzahl auf GraalVM. </li><li>  Wenn Sie ein zufriedener NodeJS-Benutzer sind und andere Sprachen Sie √ºberhaupt nicht st√∂ren, m√∂chten Sie m√∂glicherweise trotzdem mit GraalVM experimentieren. </li></ul><br>  NodeJS basiert auf V8, einer virtuellen Maschine, die kurzlebige Single-Thread-Skripts verwendet, die auf PCs und Smartphones ausgef√ºhrt werden.  Genau das wird von Google finanziert, aber V8 wird auch auf Servern verwendet.  OpenJDK ist seit Jahrzehnten auf Servern optimiert.  Die neuesten Versionen enthalten <a href="https://wiki.openjdk.java.net/display/zgc/Main">ZGC</a> und <a href="https://wiki.openjdk.java.net/display/shenandoah/Main">Shenandoah</a> , zwei Garbage Collectors, die eine minimale Latenz erm√∂glichen. Mit diesen Tools k√∂nnen Sie Terabytes an Speicher mit nur wenigen Millisekunden Pausen belegen.  Daher k√∂nnen Sie m√∂glicherweise sogar die Kosten senken, indem Sie die <a href="https://www.graalvm.org/docs/reference-manual/tools/">hervorragende GraalVM-Infrastruktur und -Tools verwenden</a> , ohne auf Einsprachigkeit zu verzichten. <br><br><img src="https://habrastorage.org/webt/tn/4y/68/tn4y68r7cmq6z9tpheeuwafpncy.png"><br><br>  Zeigen Sie den Heap mit Ruby-Objekten an <br><br><img src="https://habrastorage.org/webt/ko/vc/jj/kovcjjmwvhnayjpfix25cs-rx48.png"><br><br>  √úber HTTP verf√ºgbare CPU-Metriken <br><br><img src="https://habrastorage.org/webt/sb/fq/qy/sbfqqy9mzuppcp-vnro8tdscc_o.png"><br><br>  Extrem fundierte Expertendiagnose, die zeigt, wie der Code optimiert wurde <br><br><h4>  Vertikale Architektur </h4><br>  Wir kommen zum letzten Thema, das ich in diesem Artikel diskutieren m√∂chte. <br><br>  Manchmal erz√§hle ich jemandem all das, aber sie antworten mir: ‚Äû <i>Das ist gro√üartig, aber geben uns all diese Microservices das nicht alles?</i>  <i>Woran liegt die ganze Aufregung?</i>  Es ist schwer zu verstehen, warum ich mehrsprachiges Programmieren so sehr mag, aber es scheint mir, dass Microservice-Architekturen einen gesunden Wettbewerb brauchen. <br><br>  Erstens, ja, manchmal m√ºssen Sie viele Dienste auf einer Vielzahl von Servern betreiben, die interagieren m√ºssen.  Ich habe mehr als 7 Jahre bei Google gearbeitet und mich fast t√§glich mit deren Container-Orchestrator Borg auseinandergesetzt.  Ich habe "microservices" geschrieben, obwohl wir sie nicht einmal angerufen haben, und sie konsumiert.  Ansonsten gab es keine M√∂glichkeit, damit umzugehen, da f√ºr unsere Arbeitsbelastung Tausende von Maschinen erforderlich waren! <br><br>  F√ºr solche Architekturen muss man allerdings einen hohen Preis zahlen: <br><br><ol><li>  <b>Serialisierung</b>  Dies f√ºhrt sofort zu einer Verringerung der Produktivit√§t, erfordert jedoch vor allem, dass Sie Ihre zumindest teilweise typisierten und optimierten Datenstrukturen st√§ndig ausrichten und in einfache B√§ume verwandeln.  Wenn Sie auf JSON zur√ºckgreifen, verlieren Sie die F√§higkeit, einfache Dinge zu tun, z. B. viele kleine Objekte, die auf mehrere gro√üe Objekte verweisen (um Wiederholungen zu vermeiden, m√ºssen Sie Ihre eigenen Indizes verwenden). </li><li>  <b>Versionierung</b>  Das ist schwer.  Die Universit√§ten unterrichten diese schwierige, aber allt√§gliche Disziplin im Bereich Software-Engineering oft nicht, und selbst wenn Sie der Meinung sind, dass Sie den Unterschied zwischen direkter und r√ºckw√§rtiger Kompatibilit√§t gr√ºndlich verstanden haben, k√∂nnen Sie garantieren, dass Sie wissen, was mehrstufiges Rollen ist dass all dies von der Person verstanden wird, die Sie ersetzen wird?  F√ºhren Sie die Integrationstests f√ºr verschiedene Versionskombinationen korrekt durch, die w√§hrend des Nicht-Atom-Rollouts entstehen k√∂nnen?  In verteilten Architekturen habe ich mehrere echte Katastrophen gesehen, die darauf hinausliefen, dass die Versionen vom rechten Weg abgekommen sind. </li><li>  <b>Koh√§renz</b> .  Das Ausf√ºhren atomarer Operationen auf demselben Server ist recht einfach.  Es ist viel schwieriger sicherzustellen, dass Benutzer in jeder Situation ein absolut konsistentes Bild sehen, wenn viele Computer an dem System beteiligt sind, insbesondere, wenn zwischen ihnen Datenverluste auftreten.  Aus diesem Grund k√∂nnen relationale Datenbank-Engines historisch gesehen keine gute Skalierbarkeit aufweisen.  Lassen Sie mich Ihnen sagen: Die <a href="https://www.piter.com/collection/all/product/site-reliability-engineering-nadezhnost-i-bezotkaznost-kak-v-google">besten Google-Ingenieure haben jahrzehntelang</a> versucht, die verteilte Programmierung f√ºr ihre Teams zu vereinfachen und sie so zu gestalten, dass sie eher einer herk√∂mmlichen √§hnelt. </li><li>  <b>Neuimplementierung</b> .  Da Remoteprozeduraufrufe teuer sind, werden Sie nicht viele solcher Anrufe t√§tigen, und es bleibt nichts zu tun, um einige Probleme zu l√∂sen, sondern den Code erneut zu implementieren.  Google hat einige Bibliotheken f√ºr die gleichzeitige Arbeit mit mehreren Sprachen erstellt, um Remoteprozeduren aufrufen zu k√∂nnen.  Es gibt auch Situationen, in denen ein solcher Code von Grund auf neu geschrieben werden muss. </li></ol><br>  Also, was ist die Alternative? <br><br>  Einfach gesagt, viel Eisen.  Diese Methode mag absurd gro√üartig erscheinen, aber denken Sie daran, dass die Hardwarekosten st√§ndig sinken, viele Workloads nicht als ‚Äûglobal global‚Äú bezeichnet werden und Ihre Intuition dar√ºber, wof√ºr Sie ausgeben sollten, scheitern kann. <br><br>  Hier ist eine relativ neue <a href="http://www.deltaserverstore.com/dell-r910.html">Preisliste</a> eines kanadischen Herstellers: <br><br><img src="https://habrastorage.org/webt/_2/ko/qq/_2koqq_9uanqjed7ebsfcwjzyqy.png"><br><br>  Ein vierzigkerniger Rechner mit einem Terabyte RAM und fast einem Terabyte auf der Festplatte kostet heute etwa 6.000 US-Dollar.  Stellen Sie sich vor, wie viel Zeit Ihr Team f√ºr die gesamte Projektlaufzeit ben√∂tigt, um Probleme mit verteilten Systemen zu l√∂sen, und wie viel es Sie kosten wird. <br><br>  Ja, aber sind nicht alle heutigen Unternehmen global webbasiert? <br><br>  Kurz gesagt, nein. <br><br>  Die Welt ist voll von Unternehmen, f√ºr die Folgendes zutrifft: <br><br><ul><li>  Sie operieren in stabilen M√§rkten. </li><li>  Sie verdienen, indem sie Dinge verkaufen. </li><li>  Folglich z√§hlt ihr Kundenstamm mehrere Zehntausend bis Zehntausend Millionen Menschen, aber nicht Milliarden. </li><li>  Ihre Datens√§tze sind normalerweise mit ihren eigenen Kunden und Produkten verkn√ºpft. </li></ul><br>  Ein gutes Beispiel f√ºr ein solches Unternehmen ist eine Bank.  Banken erleben kein "Hyperwachstum", werden nicht "viral".  Ihr Wachstumsmodell ist moderat und vorhersehbar, wenn man davon ausgeht, dass sie in irgendeiner Form wachsen (Banken sind regional und operieren in der Regel in ges√§ttigten M√§rkten).  Der Kundenstamm der gr√∂√üten US-Bank betr√§gt rund 50 Millionen Nutzer und verdoppelt sich nat√ºrlich nicht alle sechs Monate.  In diesem Fall ist die Situation √ºberhaupt nicht die gleiche wie bei Instagram.  Kein Wunder also, dass der Mainframe immer noch auf einem typischen Bankensystem basiert?  Gleiches gilt nat√ºrlich auch f√ºr Logistikunternehmen, Fertigungsunternehmen usw.  Das ist das A und O unserer Wirtschaft. <br><br>  In solchen Unternehmen ist es durchaus m√∂glich, dass die Anforderungen jeder spezifischen Anwendung immer mit den Ressourcen einer einzigen gro√üen Maschine erf√ºllt werden k√∂nnen.  Ja, sogar einige √∂ffentliche Sites passen heute auf einen einzelnen Computer.  Im Jahr 2015 hielt Maciej Tseglovsky einen sehr interessanten Vortrag zum Thema ‚Äû <a href="https://idlewords.com/talks/website_obesity.htm">Die Krise mit der Fettleibigkeit von Websites</a> ‚Äú und stellte fest, dass seine eigene Website mit Lesezeichen-Service rentabel war, sein Konkurrent jedoch dieselbe Website auf AWS ver√∂ffentlichte - und nur aufgrund unterschiedlicher Kosten verlor Ausr√ºstung und verschiedene Annahmen √ºber die Komplexit√§t.  In einer Studie zum Vergleich der <a href="https://blog.codinghorror.com/scaling-up-vs-scaling-out-hidden-costs/">vertikalen und horizontalen Skalierung</a> wurde festgestellt, dass PlentyOfFish auf ca. einem Megaserver ausgef√ºhrt wird (der Artikel stammt aus dem Jahr 2009, sodass Sie die dort aufgef√ºhrten Ger√§tepreise ignorieren k√∂nnen).  Der Autor f√ºhrt einige Berechnungen durch und zeigt, dass ein Server nicht so dumm ist, wie es scheint.  Wenn Sie sich f√ºr Hadoop und Big Data entscheiden, lesen Sie diesen <a href="https://www.researchgate.net/publication/261862149_Scale-up_vs_scale-out_for_Hadoop_time_to_rethink">Microsoft-Forschungsartikel</a> aus dem Jahr <a href="https://www.researchgate.net/publication/261862149_Scale-up_vs_scale-out_for_Hadoop_time_to_rethink">2013, in</a> dem gezeigt wird, dass viele der Hadoop-Workloads von Microsoft, Yahoo und Facebook auf einem einzelnen gro√üen Computer wesentlich schneller und effizienter ausgef√ºhrt werden als auf einem Cluster.  Und so war es vor 6 Jahren!  Es ist wahrscheinlich, dass seitdem die Betonung der vertikalen Skalierung noch deutlicher geworden ist. <br><br>  Die wirklichen Einsparungen sind jedoch keineswegs mit der Ausr√ºstung verbunden, sondern mit der Optimierung der extrem kostspieligen Arbeitszeit der Ingenieure, die f√ºr die Erstellung einer Reihe winziger Mikrodienste aufgewendet wird, die mit einem elastischen Nachfragemanagement horizontal skaliert werden m√ºssen.  Solch eine Herangehensweise an das Engineering ist riskant und zeitaufw√§ndig, selbst wenn Sie die neuesten Spielzeuge verwenden, die in der Cloud verf√ºgbar sind.  Sie k√∂nnen SQL, SOLID-Transaktionen und Unified Profiling verlieren, und Sie werden definitiv Informationen wie die system√ºbergreifende Stapelverfolgung verlieren.  Die Typensicherheit verschwindet jedes Mal, wenn Sie den Server verlassen.  Sie erhalten Aufrufe von Funktionen, bei denen m√∂glicherweise eine Zeit√ºberschreitung eintritt, ein √ºberm√§√üiger Overhead im Zusammenhang mit der dynamischen Kompilierung, unerwartete R√ºckstauausf√§lle, komplexe Orchestrierungs-Engines mit ausgefallenen Konfigurationsformaten und ... oh, die Erinnerungen sind wirklich √ºberf√ºllt.  Es war interessant, mit all dem zu arbeiten, als mir die propriet√§re Google-Architektur und ein umfangreiches Engineering-Budget zur Verf√ºgung standen, aber heute w√ºrde ich es wagen, dies nur zu wiederholen, wenn ich keine andere Wahl h√§tte. <br><br>  Erfahrungsgem√§√ü ist es nicht m√∂glich, mit sehr gro√üen Servern zu arbeiten, die mit Garbage Collection arbeiten - die Garbage Collection selbst war eine schlecht entwickelte Technologie, und daher ist dieses Thema lange Zeit rein akademisch geblieben.  In jedem Fall mussten Sie mehrere Server gleichzeitig fahren. ,   ZGC  Shenandoah,   ,   80          ‚Äì      .    ,     -,       ‚Äì  ,     . <br><br> ,         ?         ‚Äì   ,        ?   ‚Äì    :  ,      ,        ‚Ä¶    . <br><br><h4>  Fazit </h4><br> NodeJVM ‚Äì  ,    GraalVM.     NPM    Java/Kotlin,   JS  ,    Kotlin   JavaScript,      JS  ,   V8. <br><br>     ,    JS  Java,    Java  JS         . <br><br>        ,           4 ,     ‚Äì      ‚Äì  ,            .             . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de481104/">https://habr.com/ru/post/de481104/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de481086/index.html">Vivaldi 2.10 - Undercover Agent</a></li>
<li><a href="../de481092/index.html">Das Interessanteste in PHP 8</a></li>
<li><a href="../de481094/index.html">√úber JBL Funkkopfh√∂rer mit Solarenergie und was ist mit ihnen los</a></li>
<li><a href="../de481100/index.html">Winkel 9, was ist neu?</a></li>
<li><a href="../de481102/index.html">Plattform√ºbergreifende .NET UI-Toolkit-Version AvaloniaUI 0.9</a></li>
<li><a href="../de481106/index.html">Wie LANIT eine DIY-Sitcom in seinem B√ºro drehte</a></li>
<li><a href="../de481110/index.html">Playme VEGA review: Combo-Rekorder mit Touchscreen und Spiegelhalterung</a></li>
<li><a href="../de481112/index.html">Was sagt das Kaugummi-Alter von 5700 Jahren √ºber die Person aus, die es gekaut hat?</a></li>
<li><a href="../de481114/index.html">Seccomp bei Kubernetes: 7 Dinge, die Sie von Anfang an wissen m√ºssen</a></li>
<li><a href="../de481116/index.html">Automatisch Posts aus der VKontakte-Community in Discord ver√∂ffentlichen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>