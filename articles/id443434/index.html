<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬛️ 🌶️ 🐆 Pemberitahuan: diperlukan tindakan untuk mengambil untung / rugi. Jika Pialang Anda tidak mendukung pesanan tersebut 🙅 🐦 ⚔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ada Broker Rusia - Tinkoff Bank. Sekarang inilah masalahnya: broker tidak mendukung take profit dan stop loss order. Sama sekali. Jika Anda ingin mera...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemberitahuan: diperlukan tindakan untuk mengambil untung / rugi. Jika Pialang Anda tidak mendukung pesanan tersebut</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443434/">  Ada Broker Rusia - Tinkoff Bank.  Sekarang inilah masalahnya: broker tidak mendukung take profit dan stop loss order.  Sama sekali.  Jika Anda ingin merasa lebih nyaman saat berdagang, maka Anda perlu beberapa solusi untuk situasi ini, sampai pengembang Tinkoff Bank akhirnya merilis pesanan tersebut sebagai fitur pembunuh.  Dalam artikel ini, saya akan menunjukkan solusi untuk Anda. <br>  <b>pembaruan:</b> 2019-03-22, platform Broker yang diterbitkan 3.0.0 (pembaruan utama) di Google Play.  Fitur changelog menerima pesanan untung / rugi <br><a name="habracut"></a><br>  Mengapa saya memutuskan untuk mengirim artikel di sini?  Saya memiliki asumsi, bahwa Tinkoff Bank dan produknya cukup populer di kalangan kerumunan TI di Rusia dan mungkin beberapa dari mereka memiliki kebutuhan yang sama tetapi tidak memiliki cukup waktu atau kemauan untuk mengembangkan solusi sementara sendiri.  Itu sebabnya saya membagikan solusi dan sejarah solusi saya. <br><br>  Di sini saya harus mengatakan sesuatu tentang penyelesaian, yang disediakan oleh broker.  Pertama, broker memiliki limit order.  Fitur ini dirilis pada Februari 2019 (dan klien menunggu selama hampir dua tahun).  Mereka menampilkan bekerja dalam satu hari perdagangan.  Jadi, Anda perlu setiap hari perdagangan mengaturnya kembali.  Satu cacat lagi: Anda tidak dapat menetapkan batas seperti yang Anda inginkan.  Ada beberapa kisaran harga dan Anda tidak dapat membuat batas pesanan dengan harga di luar kisaran.  Dan kisaran ini sangat sempit.  Di pasar yang fluktuatif, itu membuat Anda merasa tidak nyaman.  Akhirnya, Anda tidak dapat membuat dua pesanan multidireksional (dalam kasus saya, bahkan pesanan batas pertama menyebabkan crash instan aplikasi seluler broker dan situs broker tidak menyediakan fitur ini). <br><br>  Kedua, aplikasi seluler broker menyediakan fitur: Anda dapat berlangganan perubahan harga aset.  Jika ambang (absolut, harga, atau relatif, dalam persentase) dilewati, Anda akan mendapatkan pemberitahuan.  Tetapi sekali lagi, Anda tidak dapat membuat dua ambang batas untuk aset. <br><br>  Solusi saya cukup sederhana: <br><br><ol><li> kami memiliki ambang batas untuk suatu aset.  Kami menghitung ambang sendiri.  Jika ambang batas dilewati, kami membuat tindakan manual: menjual atau membeli untuk mendapatkan, sebagai akibatnya, untung atau rugi. </li><li>  kita harus mendapatkan sumber data, untuk mendapatkan harga aset yang sebenarnya </li><li>  jika ambang dilewati, kami harus mengirim pemberitahuan. </li></ol><br>  Meskipun terlihat cukup sederhana, ada beberapa detail dalam solusi saya yang ingin saya bagikan dan diskusikan. <br><br>  1. Meskipun portofolio sekuritas saya memiliki satu aset, ambang batas didefinisikan dalam skrip, dan pencarian saham dibuat sederhana, sederhana dan tidak dapat dikonfigurasi sama sekali.  Itu adalah solusi yang buruk, tetapi cepat dan menunjukkan bahwa ide itu benar.  Ketika saya mendapatkan aset baru dalam portofolio saya membuat memuat nama, pertukaran, ambang batas dari file. <br><br>  2. Aset pertama saya adalah saham asing, dan saham asing hanya bisa dibeli atau dijual di bursa Saint-Petersburg.  Serbuan pertama saya adalah mengurai situs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pertukaran SPb</a> . <br><br>  Ada semacam volume yang menurun, jadi mudah untuk diuraikan, karena aset saya selalu ada di halaman pertama.  Tapi 8 Maret itu rusak.  Saya tidak tahu mengapa, tetapi TSLA muncul di halaman ke-25.  Paginator mereka menggunakan JavaScript untuk mengunduh data halaman.  Ada solusi langsung: unduh dan parsing semua halaman dan temukan asetnya.  Tetapi perlu banyak waktu untuk mengunduh dan mengurai 25+ halaman dalam setiap loop. <br><br>  Alih-alih, saya memutuskan untuk menambahkan sebagai sumber data lain situs tradingview.com.  Tidak perlu menguraikan banyak halaman untuk menemukan stok Anda, karena setiap aset memiliki halamannya sendiri, seperti ini: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.tradingview.com/symbols/NASDAQ-TSLA</a> <br><br>  Saya berasumsi, bahwa sekarang masalah saya sudah hilang, tetapi saya salah.  Data pada halaman memuat dan memperbarui hanya dengan JS.  Jadi, Permintaan yang saya gunakan untuk mengunduh halaman gagal. <br><br>  Untuk masalah ini saya tahu tiga solusi berbeda: <br><br>  PyQT, selenium (webdriver) dan ekstensi Permintaan-HTML.  Karena saya sudah memiliki modul Permintaan di proyek saya, saya memutuskan untuk menggunakan Permintaan-HTML. <br><br>  Untuk kekecewaan saya yang kuat, itu tidak terlalu stabil, sampai saya menemukan beberapa petunjuk tentang StackOverFlow dan semacamnya. <br><br><pre><code class="python hljs">session = HTMLSession() r = session.get(url) my = r.html.render(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) selector = <span class="hljs-string"><span class="hljs-string">'span.tv-symbol-header-quote__value.tv-symbol-header-quote__value--large.js-symbol-last'</span></span> price = r.html.find(selector)[<span class="hljs-number"><span class="hljs-number">0</span></span>].text r.close() session.close()</code> </pre> <br>  Perhatikan batas waktu, juga untuk kedua panggilan dekat ().  Sebagian besar contoh tidak memiliki perincian ini, dan bisa menimbulkan beberapa masalah. <br><br>  3. Sekarang, ketika kita telah mengunduh halaman dengan data JS, menguraikannya dan memutuskan, apakah kita perlu mengirim pemberitahuan, hanya ada pertanyaan: 'Bagaimana cara kita mengirim pemberitahuan?'.  Dalam kasus saya, sms.ru menawarkan API yang nyaman dan 5 SMS gratis per hari.  Mendaftar di gerbang SMS.  Buat kunci API.  Kuncinya kira-kira seperti ini: <br><br><pre> <code class="plaintext hljs">24A41EA5-EEEE-CCCC-5555-094143C2EDDD</code> </pre> <br>  Mengirim fungsi SMS dari versi solusi saya sebelumnya: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mymessage)</span></span></span><span class="hljs-function">:</span></span> sms_url = <span class="hljs-string"><span class="hljs-string">'https://sms.ru/sms/send?api_id=key&amp;to=number&amp;msg=message&amp;json=1'</span></span> sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'key'</span></span>, mykey) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'number'</span></span>, mynumber) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, mymessage) sms_response = requests.get(sms_url)</code> </pre> <br>  Ini bekerja dengan baik.  Saya menemukan pertanyaan: bagaimana jika kami sudah mengirim SMS.  Versi pertama tidak memiliki pemeriksaan apa pun, sehingga mengirim SMS dalam setiap loop.  Lagi dan lagi. <br><br>  Saya menambahkan penghitung SMS, yang diperiksa skrip sebelum menelepon send_message. <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> sms_counter sms_counter = sms_counter + <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Oke, kita mengerti.  Tetapi ketika hari baru muncul, timbul masalah baru: bagaimana cara menyiram SMS counter?  Atau, sebenarnya kapan?  Saya melihat tiga cara berbeda: menyimpan penghitung di DB (tapi solusi saya, untuk saat ini, adalah stateless), parse tanggal / waktu untuk menyiram penghitung antara hari perdagangan dan restart skrip di beberapa titik antara dua hari perdagangan.  Untuk saat ini, saya menerapkan varian terbaru, tetapi di masa depan, saya dapat mengubahnya. <br><br>  Solusi saya sekarang berfungsi, Anda dapat mengunduhnya dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> . <br><br>  Untuk pengguna, yang tidak tahu cara menangani skrip Python, saya menawarkan <a href="">solusi paket untuk Windows</a> (milik PyInstaller). <br><br>  TODO: <br><br><ol><li>  parse waktu tanggal untuk menyiram penghitung SMS alih-alih memulai kembali skrip; </li><li>  untuk sekarang ini adalah aplikasi stateless, saya ingin menambahkan DB; </li><li>  setelah # 2, akan lebih baik untuk melacak kenaikan besar atau penurunan harga aset (relatif terhadap harga penutupan hari perdagangan sebelumnya); </li><li>  perluas jalur komunikasi (Telegram, Viber, panggilan suara) dan penyedia (untuk tujuan keandalan, saya ingin menambahkan smsc.ru SMS-gate, karena sms.ru terkadang macet dan tidak mengembalikan sms_response, meskipun SMS dikirim). </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id443434/">https://habr.com/ru/post/id443434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id443424/index.html">Menulis ulang test case untuk junior frontend ke TypeScript dan react-hooks</a></li>
<li><a href="../id443426/index.html">Tanda hitam - bagaimana OpenShift melindungi terhadap kerentanan kontainer dengan SELinux</a></li>
<li><a href="../id443428/index.html">Palmer Lucky, "bapak" dari Oculus Rift, sedang mengembangkan sistem medan virtual untuk Pentagon</a></li>
<li><a href="../id443430/index.html">Mengapa itu buruk ketika Internet tahu segalanya tentang Anda?</a></li>
<li><a href="../id443432/index.html">Blazor 0.9.0 dirilis</a></li>
<li><a href="../id443436/index.html">Tempat berbicara tentang Apache Ignite, mendistribusikan database, dan mendistribusikan pembelajaran mesin di musim semi</a></li>
<li><a href="../id443438/index.html">7 ekstensi Firefox yang berguna untuk belajar bahasa Inggris</a></li>
<li><a href="../id443440/index.html">Modul PHP untuk bekerja dengan data hierarkis di InterSystems IRIS</a></li>
<li><a href="../id443450/index.html">Mengapa orang miskin tidak bisa sehat</a></li>
<li><a href="../id443452/index.html">Militer Rusia akan membuat Internet tertutup mereka sendiri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>