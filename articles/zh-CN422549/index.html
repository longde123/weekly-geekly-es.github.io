<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍧 🧑🏼 🏳️‍🌈 科尔达：科特林 🧜 👩🏾‍🏫 👩🏼‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="当有人查看Corda代码时，他们会立即注意到它是用Kotlin编写的-Kotlin是JetBrains的新编程语言，可以为JVM和Javascript进行编译。 这是一个不寻常的选择，在本文中，我想分享一些做出此决定的原因，以及我们“在Kotlin投入生产的那一年”的经验。 
 为什么选择科特林？ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>科尔达：科特林</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422549/"><p> 当有人查看<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Corda</a>代码时，他们会立即注意到它是用Kotlin编写的-Kotlin是JetBrains的新编程语言，可以为JVM和Javascript进行编译。 这是一个不寻常的选择，在本文中，我想分享一些做出此决定的原因，以及我们“在Kotlin投入生产的那一年”的经验。 </p><a name="habracut"></a><br><h3 id="pochemu-kotlin"> 为什么选择科特林？ </h3><br><p> 此解决方案可以分为两部分： </p><br><ol><li> 使用哪个平台？  JVM，.NET，Node，Python / Ruby，Go，Haskell或其他已编译的（以机器代码形式）？ </li><li> 如果选择JVM，将使用哪种语言？  Java的？ 如果没有，那为什么呢？ 如果不是，那么还有什么：Scala，Ceylon，Clojure，Kotlin，Python，Ruby，Javascript或Haskell（因为它们都有JVM的实现）。 </li></ol><br><p>选择JVM作为平台的原因在企业应用程序环境中广为人知，对此一无所知。 只需说一下，如果您需要一个具有<em>垃圾回收功能</em>的可伸缩，线程安全，跨平台的运行时，并需要有许多文档齐全的库来解决基本的业务问题，那么选择仅限于JVM和.NET。 </p><br><p> 在Corda的工作开始之初，该项目没有名称，很难想象它会在将来开发成产品。 实际上，当成为Corda的项目于2015年12月（在我上班的第一天）开始时，还没有创建新的公司分布式会计系统的计划。  Corda最初是一组原型，用于探索联盟<em>架构工作组</em>感兴趣的新想法和要求，尤其是那些与数据和提供“ UTXO事务输出数组的可伸缩性”的数据模型的有限可视性有关的需求。以及一般性命令式以太坊智能合约的可编程性。 </p><br><p> 由于尚不清楚这些原型是否会变成某种东西，或只是用作市场上其他产品的信息，因此我们面临一个艰难的选择。 一方面，我们希望快速高效地探索算法和数据结构。 另一方面，应该仍然有潜在的机会来创建大型公司产品并迅速为其雇用人员。 </p><br><p>  Java确实满足了这些要求，但是语言中缺乏现代功能大大降低了生产率，更隐含地降低了开发人员的士气。 </p><br><p> 没有考虑动态类型-静态类型所提供的正确性，开发工具和性能的好处实在太大，无法忽略。 </p><br><p> 也没有考虑与流行语言根本不同的语言，因为 我们希望能够聘请财务专家。 而且，尽管<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">完全有可能</a>围绕Haskell这样的语言创建团队，但是找到一个具有认真银行业务经验并随机地（随机）地生活在伦敦的人看来是冒险的。 另外，该产品的本质意味着我们的“用户”实际上是使用该平台的插件和应用程序的开发人员，没有必要要求他们学习全新的范例和工具。 我们选择的语言不应限制用户太多。 </p><br><p> 结果，这些要求使我们离开了Kotlin，Scala和Ceylon。 这些语言非常相似，也很有趣。 我们选择Kotlin的原因如下： </p><br><ul><li> 与Java几乎<em>无缝</em>集成 <br><ul><li> 特别是，Kotlin程序使用标准JDK集合的增强版本（增强的编译器），从而确保不会由于使用其他集合库而导致集成问题。 我们在世界各地的Java库之间来回传送集合，因此不要造成任何问题很重要。 </li><li>从Kotlin类中，我们获得了一个外观简单的Java API，其<code>get</code> / <code>set</code> / <code>is</code>方法根据类型而定。 为此，不需要特殊的注释或其他操作。 由于Corda提供了专为Java开发人员透明使用而设计的API，所以这是一个很大的优势：从普通代码中，您得到的API只需几个警告就无法与Java API区别开（例如，显式拦截Java中的检查异常需要显式）方法注释） </li></ul></li><li> 内联小功能（例如<code>map</code> / <code>filter</code> / <code>fold</code> / <code>groupBy</code> （而不是希望JVM自己完成）是由编译器完成的。 不幸的是，JIT JVM编译器虽然总体上非常出色，但是并不能在所有情况下都消除大量使用高阶函数的开销。 除了允许您从Lambda函数内控制程序执行（注意：例如， <em>非本地</em>返回）之外，使用Kotlin可以弥补这一点。 这是鲜为人知但有用的功能之一。 因为 在任何地方，我们都以这种功能风格编写代码，如果将其翻译成机器代码的方式不好，我们可能会为自己造成性能问题。 </li><li> 由于Kotlin上的代码已转换为相当相似的Java代码，因此几乎所有现有的面向Java的工具都可以直接使用。 对于其他语言，情况并非总是如此。 例如，Quasar难以检测Scala代码，因为它需要方法注释，而Scala将lambda转换为无法注释的方法。  Kotlin Lambda通常是嵌入的（请参见上文），或者可以附加注释。 </li><li> 出色的文档和纤巧的标准库使学习变得非常快。 我们没有在空缺中表明需要Kotlin的经验，我们在1-3 <em>年的时间里</em>雇用了没有他的知识的人员，此后团队的新成员便能够编写惯用的代码。 </li><li> 根据对我们进行面试的候选人的选择，IntelliJ是最受欢迎的IDE（他们可以自由选择工具）。 在后Java语言中，IntelliJ最好地支持Kotlin。 </li><li> 我已经与他取得了令人满意的经历，因此，我确信他的新同事也会喜欢他。 </li></ul><br><p> 如果不是Kotlin，我们可能会选择Scala：Kotlin很大程度上是受它的启发，两者都是很好的语言。 </p><br><h3 id="nash-god-s-kotlin"> 我们与科特林的一年 </h3><br><p> 感觉如何-在公司申请环境中使用一种新语言的一年？ </p><br><p> 毫无疑问，最重要的是从同事那里听到他们真的很喜欢与他一起工作。 编程语言是每个人的个人问题，人们通常对此事有明确的看法。 如果您作为一项新工作的首要任务，要求某人学习一种新语言并且甚至没有事先警告它，那么总是存在这样的风险，即同事只会讨厌他，而是发现他讨厌而不是提高他的工作效率。 但是事实并非如此。 </p><br><p> 以下是我们自己遇到的Java / C＃后企业开发环境中经常出现的一些问题： </p><br><ul><li>  <strong>代码看起来是不同的，具体取决于谁编写。</strong> 一般来说，不是什么大问题。 与需要某种设计风格的Go不同，不同作者的Kotlin代码可能看起来有所不同。 但是IntelliJ有一个格式化工具，可以提供统一的代码库样式。 它比Java更受限制，但这足够了。  Java-OOP和Haskell-FI编码风格的对立是一个更微妙的问题，尤其是Scala代码。 对于希望看到<em>改进的</em> Java的开发人员来说，使用scalaz等库的Scala代码可能<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">很难阅读</a> 。 在这场辩论中，Kotlin坚决支持<em>改进的</em> Java。 而且，尽管以某种方式进行了函数式编程（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可能</a>在Kotlin上），但社区（至少到目前为止）尚未分成阵营。 在某些情况下，编写代码的方式就像是Haskell，但可以在codereview上解决。 </li><li>  <strong>图书馆</strong> 在Corda中，我们使用了50多个开源库，并且没有任何问题。 我们从未写过包装器或适配器层。 由于通常在Kotlin，Maven或Gradle上的项目中使用构建系统-没有这些工具的官方Kotlin特定替代品（尽管Gradle引入了Kotlin支持作为一种新的脚本语言！）。 </li><li>  <strong>DSL和SQL。</strong>  C＃具有LINQ，Java具有JOOQ，而Kotlin具有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Exposed</a> 。 这是Kotlin比竞争对手弱一些的领域之一-公开的示例是使用Kotlin的功能来构建DSL的一个很好的例子，但是该库本身具有不稳定的API，并且是一个辅助项目。 当然，JOOQ可以与Kotlin一起使用，回头看，这似乎是首选。 </li><li>  <strong>IDE /工具包。</strong> 当然，用于IntelliJ的Kotlin插件是由JetBrains编写的，总的来说，它很棒。 但是，与Java支持相比，它不那么复杂。 必须手动将新的编辑器功能（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">参数提示）</a>移植到Kotlin，因此，支持本身通常落后于许多较旧的Java插件。 我们还注意到，IDE插件经常会通知内部错误，尽管在一年中IDE例外的发生率已显着降低（而且似乎不影响任何事情）。 使用其他工具也不会引起问题，因为  Java编写的内容通常是<em>开箱即用的</em> 。 一个例外是使用源代码而不是字节码的工具，并且显然不能重复使用。 有了这些，即使在1.0版本发布一年后，Kotlin编译器和IDE插件的调试也不如Java调试。 您很有可能永远不会在<code>javac</code>遇到内部错误，但是尽管很少见，但我们仍然在Kotlin中看到它们。 </li><li>  <strong>被用户认可。</strong>  Corda用户通常是大型且保守的金融机构。 这样的公司更喜欢使用通用的，公认的语言。  Kotlin既不是彼此也不是另一个，显然在我们开始的时候就引起了一些惊奇。  “为什么科特林？”  -这个问题在过去一年中几乎消失了，因为 人们仔细观察并意识到，这并不像使用新的编程语言那样冒险。 我们还尝试通过提供代码示例来促进采用，以证明使用该平台构建应用程序不需要Kotlin知识。 这样的结果并不是很成功-许多第一次与Corda合作的开发人员仍然从探索Kotlin开始。 还不是很清楚这是否是由于我们没有提供足够的面向Java的用法示例和文档，还是仅仅是为了学习一个新的炫酷工具的好借口。 主要投资银行越来越多地采用Kotlin，也为我们提供了帮助。 在过去的一年中，我们从该财团的几位成员那里听说，他们的内部开发团队已经开始认真考虑Kotlin自己的产品：通常是由将Java转换为Kotlin的工具的可用性驱动的，这些工具可以将痛苦的整合减少到现有代码库中。 </li><li>  <strong>商业支持。</strong> 使用鲜为人知的语言的风险是，它们可能会停止开发，或者其目标与围绕产品，用户社区形成的需求不一致（例如，对于研究语言，开发人员的主要目标是创建科学文章）。 我们对Kotlin充满信心的主要原因是JetBrains是一家稳定，盈利的公司，已经在市场上销售了15年以上。 通过将Kotlin引入主要产品的代码中，JetBrains很快开始<em>品尝</em>他们自己的工具。 因此，终止支持的风险很小。 此外，JetBrains已经是一家中年公司，其目标市场（IDE和开发人员工具）已不再是新事物，尤其是不流行的时尚产品，这降低了公司可能被收购的风险，这可能导致不可预测的战略变革。 而且，尽管缺少Kotlin的商业支持包，但实际上，该团队可以迅速解决已知问题。 目前，JetBrains打算在1.0版发布一年后发布下一个语言更新。 此发布周期与公司环境中的开发周期非常相似。 </li></ul><br><h3 id="vyvody"> 结论？ </h3><br><p> 我们不后悔：在这个项目开始时选择一种年轻的语言虽然有风险，但是很平衡。 他为我们做得很好，我们不会改变选择。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN422549/">https://habr.com/ru/post/zh-CN422549/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN422539/index.html">关于数字经济，火灾和互联网</a></li>
<li><a href="../zh-CN422541/index.html">联盟漏洞的戏剧化成了幻影</a></li>
<li><a href="../zh-CN422543/index.html">像程序员一样思考。 任务课</a></li>
<li><a href="../zh-CN422545/index.html">同步浏览器标签的方法</a></li>
<li><a href="../zh-CN422547/index.html">为了消除Spectre和Meltdown，您可能必须创建一种全新的处理器</a></li>
<li><a href="../zh-CN422551/index.html">如何从非接触式卡和Apple Pay窃钱</a></li>
<li><a href="../zh-CN422553/index.html">大型官方浏览器扩展程序窃取文件共享数据和加密货币</a></li>
<li><a href="../zh-CN422555/index.html">Android多模块架构。 从A到Z</a></li>
<li><a href="../zh-CN422561/index.html">Yandex如何应用计算机视觉来提高视频广播的质量。 DeepHD技术</a></li>
<li><a href="../zh-CN422565/index.html">Skillbox星期五网络研讨会：面向程序员和设计师的一切</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>