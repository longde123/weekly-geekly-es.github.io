<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∞üèæ ü§≤üèΩ üèà VMware NSX para o menor. Parte 4. Configurando o roteamento üòÜ ‚è≤Ô∏è ‚ôåÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parte I Introdut√≥rio 
 Parte Dois Configurar regras de firewall e NAT 
 Parte tr√™s. Configura√ß√£o DHCP 

 O NSX Edge suporta roteamento est√°tico e din√¢...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VMware NSX para o menor. Parte 4. Configurando o roteamento</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/444644/"><img src="https://habrastorage.org/webt/o5/jp/se/o5jpse0g14zpljktkchdfyahj4c.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte I</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Introdut√≥rio</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte Dois</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configurar regras de firewall e NAT</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte tr√™s.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√£o DHCP</a> <br><br>  O NSX Edge suporta roteamento est√°tico e din√¢mico (ospf, bgp). <br><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√£o inicial</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Roteamento est√°tico</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OSPF</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BGP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Redistribui√ß√£o de rota</a> <br></blockquote><a name="habracut"></a><br>  Para configurar o roteamento, no vCloud Director, v√° para a se√ß√£o <b>Administra√ß√£o</b> e clique no datacenter virtual.  No menu horizontal, selecione a guia <b>Gateways de Borda</b> .  Clique com o bot√£o direito do mouse na rede desejada e selecione a op√ß√£o <b>Servi√ßos de Gateway de Borda</b> . <br><img src="https://habrastorage.org/webt/-z/wb/hr/-zwbhr3yvklwwmz373nxs95q3p8.png"><br><br>  V√° para o menu Roteamento. <br><img src="https://habrastorage.org/webt/dx/xz/uy/dxxzuyn_moa3cweghpd1zz4se0k.png"><br><br><a name="Intro"></a><h3>  Configura√ß√£o inicial (configura√ß√£o de roteamento) </h3><br>  Nesta contribui√ß√£o voc√™ pode: <br>  - ative o par√¢metro ECMP, que permite configurar at√© 8 rotas iguais no RIB. <br><img src="https://habrastorage.org/webt/q1/6a/sd/q16asdzebookohamojdyemrun-g.png"><br><br>  - alterar ou desativar a rota padr√£o. <br><img src="https://habrastorage.org/webt/4m/jn/vu/4mjnvu8oxsmnz_gus50good442a.png"><br><br>  - selecione ID do roteador.  Como o ID do roteador, voc√™ pode selecionar o endere√ßo da interface externa.  Sem especificar um ID de roteador, n√£o √© poss√≠vel iniciar processos OSPF ou BGP. <br><img src="https://habrastorage.org/webt/hx/5p/pe/hx5ppesjnsdtpvoz8xxsnmwzd5q.png"><br><br>  Ou adicione o seu pr√≥prio pressionando +. <br><img src="https://habrastorage.org/webt/ld/lw/fz/ldlwfz-yqpbcbch4-ahnndi4ln4.png"><br><img src="https://habrastorage.org/webt/gp/pz/vw/gppzvwolykjwwoac2_mycaaigzu.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/bg/0i/mk/bg0imko-8vfk-lwwlwwyqfwpc1m.png"><br><br>  Feito. <br><img src="https://habrastorage.org/webt/rv/qo/gh/rvqoghhugwlogxqaftviirqrk0e.png"><br><br><a name="Static"></a><h3>  Configurar roteamento est√°tico </h3><br>  V√° para a guia Roteamento est√°tico e clique em +. <br><img src="https://habrastorage.org/webt/-h/zn/iy/-hzniy4kmmm20ubeij7-mahzzpk.png"><br><br>  Para adicionar uma rota est√°tica, preencha os seguintes campos obrigat√≥rios: <br>  - Rede - rede de destino; <br>  - Pr√≥ximo salto - endere√ßo IP do host / roteador atrav√©s do qual o tr√°fego ir√° para a rede de destino; <br>  - Interface - a interface atr√°s da qual o pr√≥ximo salto seguinte est√° localizado. <br>  Clique em manter. <br><img src="https://habrastorage.org/webt/l_/lp/ac/l_lpacga9yjedbnzr2pv7eyhe7u.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/_s/dr/yw/_sdrywzxwf0kafi4vik3vynjd_s.png"><br><br>  Feito. <br><img src="https://habrastorage.org/webt/tn/7m/s_/tn7ms_tzc2otiecdo1u2iktawka.png"><br><br><a name="OSPF"></a><h3>  Configura√ß√£o OSPF </h3><br>  V√° para a guia OSPF.  Ligue o processo OSPF. <br>  Se necess√°rio, desative o Graceful restart, que √© ativado por padr√£o.  O rein√≠cio gracioso √© um protocolo que permite continuar encaminhando o tr√°fego durante a converg√™ncia do plano de controle. <br>  Aqui voc√™ pode ativar o an√∫ncio da rota padr√£o, se estiver no RIB - a op√ß√£o de origem padr√£o. <br><img src="https://habrastorage.org/webt/jj/mp/mn/jjmpmnl0asl-ngs6nwky4ymlb4g.png"><br><br>  Em seguida, adicione √Årea.  A √°rea 0. √© adicionada por padr√£o.O NSX Edge suporta 3 tipos de √°rea: <br>  - √Årea de backbone (√°rea 0 + Normal); <br>  - √°rea padr√£o (normal); <br>  - √Årea n√£o t√£o atarracada (NSSA). <br><br>  Clique em + no campo Defini√ß√£o de √°rea para adicionar uma nova √°rea. <br><img src="https://habrastorage.org/webt/j4/gf/xm/j4gfxmqfpdxqexmjqltlf6wi8de.png"><br><br>  Na janela exibida, especifique os seguintes campos obrigat√≥rios: <br>  - ID da √°rea; <br>  - Tipo de √°rea. <br><img src="https://habrastorage.org/webt/j3/sq/dg/j3sqdgj7gi8lgoru3g0iuykez9q.png"><br><br>  Se necess√°rio, configure a autentica√ß√£o.  O NSX Edge suporta dois tipos de autentica√ß√£o: texto n√£o criptografado (senha) e MD5. <br><img src="https://habrastorage.org/webt/vf/md/qi/vfmdqiwwm02pqkrjariwhmrjcok.png"><br><br>  Clique em manter. <br><img src="https://habrastorage.org/webt/bs/ge/mk/bsgemk6rnskll3eyqqoefn_a-j8.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/mz/iq/ez/mziqezbbtykcgx2tuogmkpnxckw.png"><br><br>  Agora adicione as interfaces nas quais o bairro OSPF aumentar√°.  Para fazer isso, clique em + no campo Mapeamento da interface. <br><img src="https://habrastorage.org/webt/cf/gs/yc/cfgsycnwitjfzve0hitfowky72e.png"><br><br>  Na janela exibida, especifique os seguintes par√¢metros: <br>  - Interface - a interface que estar√° envolvida no processo OSPF; <br>  - ID da √°rea; <br>  - Ol√° / intervalo morto - temporizadores de protocolo; <br>  - Prioridade - a prioridade necess√°ria para selecionar DR / BDR; <br>  - Custo √© a m√©trica necess√°ria para calcular o melhor caminho.  Clique em manter. <br><img src="https://habrastorage.org/webt/gm/s5/re/gms5reb0bu0jkivbpicfbenwkhi.png"><br><br><img src="https://habrastorage.org/webt/3t/vp/tz/3tvptzjpayfxqs123rowadgnwys.png"><br><br>  Adicione a √°rea NSSA ao nosso roteador. <br><img src="https://habrastorage.org/webt/iw/eg/tr/iwegtrfhmdfhe9atkle-gxfe-ki.png"><br><br><img src="https://habrastorage.org/webt/-h/fp/t3/-hfpt38slfy3_g3ydmvpz_erp8s.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/bz/xi/3j/bzxi3jrfq-5cgwi2qw90qy5h6i8.png"><br><br>  Na captura de tela abaixo, vemos: <br>  1. sess√µes estabelecidas; <br>  2. rotas estabelecidas no RIB. <br><br><img src="https://habrastorage.org/webt/gh/la/he/ghlahervxrgjwndsbnsyhxocpka.png"><br><br><a name="BGP"></a><h3>  Configurar BGP </h3><br>  V√° para a guia BGP. <br><img src="https://habrastorage.org/webt/sm/gq/dk/smgqdkqy4fp0n0hn7kcsefmvqio.png"><br><br>  Ligue o processo BGP. <br>  Se necess√°rio, desative o Rein√≠cio gracioso, que √© ativado por padr√£o.  Aqui voc√™ pode ativar o an√∫ncio da rota padr√£o, mesmo que n√£o esteja na op√ß√£o RIB - a Origem Padr√£o. <br>  Especifique AS do nosso NSX Edge.  O suporte ao AS de 4 bytes est√° dispon√≠vel apenas no NSX 6.3 <br><img src="https://habrastorage.org/webt/pq/mt/ki/pqmtkij87a9uumnmg8nq-bhfape.png"><br><br>  Para adicionar um banquete de vizinhos, clique em +. <br><img src="https://habrastorage.org/webt/di/z5/pg/diz5pgenv_kelpjpkkjonfbab0m.jpeg"><br><br>  Na janela exibida, especifique os seguintes par√¢metros: <br>  - Endere√ßo IP - o endere√ßo BGP do par; <br>  - AS remoto - n√∫mero BGP AS de pares; <br>  - Peso - uma m√©trica com a qual voc√™ pode controlar o tr√°fego de sa√≠da; <br>  - Mantenha Alive / Hold Down Time - temporizadores de protocolo. <br><img src="https://habrastorage.org/webt/kz/0b/s4/kz0bs4hjug62ygvhrrzcheuzesq.png"><br><br>  Em seguida, configure os filtros BGP.  Para sess√µes eBGP, por padr√£o, todos os prefixos anunciados e recebidos neste roteador s√£o filtrados, exceto a rota padr√£o.  √â anunciado usando a op√ß√£o de origem padr√£o. <br>  Clique em + para adicionar o filtro BGP. <br><img src="https://habrastorage.org/webt/tp/1n/lt/tp1nlt__asfg9bbqpim3h1zvu_e.png"><br><br>  Configuramos o filtro para uma atualiza√ß√£o de sa√≠da. <br><img src="https://habrastorage.org/webt/ci/2j/cv/ci2jcvimcphf5-21-go_vibvwow.png"><br><br>  N√≥s configuramos o filtro para a atualiza√ß√£o recebida. <br><img src="https://habrastorage.org/webt/gv/yi/qu/gvyiquqi4cracor84v6vnsgg4ac.png"><br><br>  Clique em Manter para concluir a instala√ß√£o. <br><img src="https://habrastorage.org/webt/c0/5t/zq/c05tzqehitmz0i_vungrufiwjqc.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/x8/1j/kn/x81jknbhab1d9tlqzx27eixfxus.png"><br><br>  Feito. <br><img src="https://habrastorage.org/webt/c2/u2/_9/c2u2_9rorrzgom-5ter71vtbijy.png"><br><br>  Na captura de tela abaixo, vemos: <br>  1. sess√£o estabelecida. <br>  2. prefixos recebidos (4 prefixos / 24) do par BGP. <br>  3. O an√∫ncio da rota padr√£o.  O prefixo 172.20.0.0/24 n√£o √© anunciado, pois n√£o √© adicionado ao BGP. <br><img src="https://habrastorage.org/webt/4z/0e/q0/4z0eq0vlynr0mcdlalzrvacobwi.png"><br><br><a name="Redistr"></a><h3>  Configurar redistribui√ß√£o de rota </h3><br>  V√° para a guia Redistribui√ß√£o de rota. <br><img src="https://habrastorage.org/webt/5d/-d/vu/5d-dvuzhgha8ggtg9ueglqyeshe.png"><br><br>  Ativamos a importa√ß√£o de rotas para o protocolo (BGP ou OSPF). <br><img src="https://habrastorage.org/webt/fx/rr/z3/fxrrz3tud3tige4v9x1fv-onmm4.png"><br><br>  Para adicionar um prefixo IP, clique em +. <br><img src="https://habrastorage.org/webt/vu/mx/ml/vumxml1cppir3cykejqrvu64qea.png"><br><br>  Indique o nome do prefixo IP e o pr√≥prio prefixo. <br><img src="https://habrastorage.org/webt/qn/v9/di/qnv9di7wbwbj1tikhfthdhe7mb0.png"><br><br><img src="https://habrastorage.org/webt/gy/zg/bc/gyzgbcb4xjpelbo1copblwy-mrm.png"><br><br>  Configure uma tabela de distribui√ß√£o de rota.  Clique em +. <br><img src="https://habrastorage.org/webt/ia/vn/pq/iavnpqpcgku9ic0b2z6ntkyqdl8.png"><br><br>  - Nome do prefixo - selecione o prefixo que importaremos para o protocolo apropriado. <br>  - Learner Protocol - o protocolo em que importaremos o prefixo; <br>  - Permitir aprendizado - protocolo de onde exportamos o prefixo; <br>  - A√ß√£o - a a√ß√£o que ser√° aplicada a esse prefixo. <br><img src="https://habrastorage.org/webt/9o/tm/pf/9otmpfj_xmu81cboh6ixgtied8u.png"><br><br>  Salve a configura√ß√£o. <br><img src="https://habrastorage.org/webt/ob/o9/xt/obo9xtxk3qgbrhswejshosyf1fg.png"><br><br>  Feito. <br><img src="https://habrastorage.org/webt/vl/r2/7w/vlr27wlgz5esv1xgz4evwsofv0a.png"><br><br>  A captura de tela abaixo mostra que o an√∫ncio correspondente no BGP apareceu. <br><img src="https://habrastorage.org/webt/t1/0x/5p/t10x5paueyjuwo3fxmsrpomwzty.png"><br><br>  √â isso para mim sobre roteamento com o NSX Edge.  Pergunte se algo n√£o est√° claro.  Da pr√≥xima vez, lidaremos com o balanceador. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444644/">https://habr.com/ru/post/pt444644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444634/index.html">Epic Games oferece aos desenvolvedores US $ 100 milh√µes</a></li>
<li><a href="../pt444636/index.html">Por que n√£o posso crescer por dinheiro</a></li>
<li><a href="../pt444638/index.html">Controle de qualidade no CodeFest. Automa√ß√£o, gerenciamento, infraestrutura, venda de bolinhos na loja</a></li>
<li><a href="../pt444640/index.html">Kostya Gorsky, Intercom: sobre cidades e ambi√ß√µes, pensamento de produto, habilidades para designers e autodesenvolvimento</a></li>
<li><a href="../pt444642/index.html">Remasteriza√ß√£o de Star Trek com redes neurais de at√© 1080p e 4K</a></li>
<li><a href="../pt444646/index.html">Rutoken, OpenSSL e uma CA local para assinar mensagens</a></li>
<li><a href="../pt444650/index.html">Desodorante bacteriano: uma rela√ß√£o simbi√≥tica entre pererecas e bact√©rias Pseudomonas</a></li>
<li><a href="../pt444652/index.html">‚Äú√â hora de sair do front-end‚Äù: Andrey Sitnik sobre a estagna√ß√£o da comunidade, c√≥digo aberto e n√£o apenas</a></li>
<li><a href="../pt444654/index.html">A economia da alegria. Tutoria como um caso especial. A lei de tr√™s por cento</a></li>
<li><a href="../pt444658/index.html">V√≠deo do Badoo PHP Meetup # 2: Sobre testes e qualidade de c√≥digo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>