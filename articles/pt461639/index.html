<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòò ü§ü üç§ Sua sa√≠da, gr√°fico: como n√£o encontramos um bom gr√°fico de rede e criamos nosso pr√≥prio üïï üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ üåì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Investigando casos envolvendo phishing, redes de bots, transa√ß√µes fraudulentas e grupos criminosos de hackers, os especialistas do Grupo-IB usam a an√°...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sua sa√≠da, gr√°fico: como n√£o encontramos um bom gr√°fico de rede e criamos nosso pr√≥prio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/461639/"><img src="https://habrastorage.org/webt/5w/z_/im/5wz_imjcrurw4gk_wubv6gqanig.jpeg"><br><br>  Investigando casos envolvendo phishing, redes de bots, transa√ß√µes fraudulentas e grupos criminosos de hackers, os especialistas do Grupo-IB usam a an√°lise de gr√°ficos h√° muitos anos para identificar todos os tipos de conex√µes.  Casos diferentes t√™m suas pr√≥prias matrizes de dados, seus pr√≥prios algoritmos de identifica√ß√£o de conex√£o e interfaces personalizadas para tarefas espec√≠ficas.  Todas essas ferramentas eram um desenvolvimento interno do Grupo-IB e estavam dispon√≠veis apenas para nossos funcion√°rios. <br><br>  A an√°lise gr√°fica da infraestrutura de rede ( <i>gr√°fico de rede</i> ) foi a primeira ferramenta interna que incorporamos a todos os produtos p√∫blicos da empresa.  Antes de criar nosso pr√≥prio gr√°fico de rede, analisamos muitos desenvolvimentos semelhantes no mercado e n√£o encontramos um √∫nico produto que satisfizesse nossas pr√≥prias necessidades.  Neste artigo, falaremos sobre como criamos o gr√°fico de rede, como us√°-lo e quais dificuldades encontramos. <br><br>  <b>Dmitry Volkov,</b> CTO Group-IB e Chefe de Cyber ‚Äã‚ÄãIntelligence <a name="habracut"></a><br><br><h1>  <font color="#e63619">O que um gr√°fico de rede do Grupo-IB pode fazer?</font> </h1><br><h3>  Investiga√ß√µes </h3><br>  Desde a funda√ß√£o do Grupo-IB em 2003 at√© o presente, identifica√ß√£o, decano e responsabiliza√ß√£o de criminosos cibern√©ticos t√™m sido a principal prioridade em nosso trabalho.  Nenhuma investiga√ß√£o de ataque cibern√©tico poderia prescindir de uma an√°lise da infraestrutura de rede do invasor.  No in√≠cio de nossa jornada, foi um trabalho √°rduo e minucioso encontrar relacionamentos que pudessem ajudar a identificar criminosos: informa√ß√µes sobre nomes de dom√≠nio, endere√ßos IP, impress√µes digitais de servidores, etc. <br><br>  A maioria dos atacantes tenta agir da forma mais an√¥nima poss√≠vel na rede.  No entanto, como todas as pessoas, eles cometem erros.  A principal tarefa dessa an√°lise √© encontrar os projetos hist√≥ricos ‚Äúbrancos‚Äù ou ‚Äúcinzas‚Äù dos invasores que se cruzam com a infraestrutura maliciosa usada no incidente real que estamos investigando.  Se for poss√≠vel detectar "projetos brancos", encontrar o invasor, em regra, torna-se uma tarefa trivial.  No caso dos "cinzas", √© preciso mais tempo e esfor√ßo para pesquisar, pois seus propriet√°rios tentam anonimizar ou ocultar os dados de registro, mas as chances permanecem bastante altas.  Como regra, no in√≠cio de sua atividade criminosa, os atacantes prestam menos aten√ß√£o √† sua pr√≥pria seguran√ßa e cometem mais erros; portanto, quanto mais aprofundados pudermos mergulhar na hist√≥ria, maiores ser√£o as chances de uma investiga√ß√£o bem-sucedida.  √â por isso que um gr√°fico de rede com um bom hist√≥rico √© um elemento extremamente importante dessa investiga√ß√£o.  Simplificando, quanto mais profundos os dados hist√≥ricos de uma empresa, melhor ser√° o seu gr√°fico.  Suponha que uma hist√≥ria de 5 anos possa ajudar a resolver, condicionalmente, 1-2 de 10 crimes, e uma hist√≥ria de 15 anos oferece a chance de resolver todos os dez. <br><br><h3>  Detectando phishing e fraude </h3><br>  Sempre que recebemos um link suspeito para recursos de phishing, fraudulentos ou pirateados, criamos automaticamente um gr√°fico dos recursos de rede relacionados e verificamos todos os hosts encontrados quanto a conte√∫do semelhante.  Isso permite que voc√™ encontre sites antigos de phishing ativos, mas desconhecidos, e sites novos, preparados para ataques futuros, mas que ainda n√£o s√£o usados.  Um exemplo elementar bastante comum: encontramos um site de phishing em um servidor com apenas 5 sites.  Ao verificar cada um deles, tamb√©m encontramos conte√∫do de phishing em outros sites, o que significa que podemos bloquear 5 em vez de 1. <br><br><h3>  Pesquisa de back-end </h3><br>  Esse processo √© necess√°rio para estabelecer onde o servidor malicioso est√° realmente localizado. <br>  99% das lojas de cart√µes, f√≥runs de hackers, muitos recursos de phishing e outros servidores mal-intencionados est√£o escondidos atr√°s de seus pr√≥prios servidores proxy e proxies de servi√ßos leg√≠timos, por exemplo, o Cloudflare.  Conhecer o back-end real √© muito importante para as investiga√ß√µes: se torna conhecido o provedor de hospedagem do qual voc√™ pode remover o servidor, torna-se poss√≠vel estabelecer conex√µes com outros projetos maliciosos. <br><br>  Por exemplo, voc√™ tem um site de phishing para coletar dados de cart√£o banc√°rio que resolve para o endere√ßo IP 11/11/11/11 e um endere√ßo de loja de cart√£o que resolve para o endere√ßo IP 22.22.22.22.  Durante a an√°lise, pode acontecer que o site de phishing e a loja de cart√µes tenham um endere√ßo IP de back-end comum, por exemplo, 33.33.33.33.  Esse conhecimento permite criar um v√≠nculo entre ataques de phishing e uma loja de cart√µes na qual, talvez, eles vendam dados de cart√µes banc√°rios. <br><br><h3>  Correla√ß√£o de eventos </h3><br>  Quando houver dois gatilhos diferentes (por exemplo, no IDS) com malware e servidores diferentes para controlar o ataque, voc√™ os considerar√° como dois eventos independentes.  Mas se houver uma boa conex√£o entre infraestruturas maliciosas, torna-se √≥bvio que esses n√£o s√£o ataques diferentes, mas est√°gios de um ataque multiest√°gio mais complexo.  E se um dos eventos j√° for atribu√≠do a qualquer grupo de atacantes, o segundo tamb√©m poder√° ser atribu√≠do ao mesmo grupo.  Obviamente, o processo de atribui√ß√£o √© muito mais complexo, portanto, trate a escrita como um exemplo simples. <br><br><h3>  Indicadores de enriquecimento </h3><br>  N√£o prestaremos muita aten√ß√£o a isso, pois esse √© o cen√°rio mais comum para o uso de gr√°ficos em seguran√ßa cibern√©tica: voc√™ fornece um indicador para a entrada e obt√©m uma s√©rie de indicadores relacionados na sa√≠da. <br><br><h3>  Detec√ß√£o de padr√µes </h3><br>  A identifica√ß√£o de padr√µes √© essencial para uma ca√ßa eficaz.  Os gr√°ficos permitem n√£o apenas encontrar elementos relacionados, mas tamb√©m revelar propriedades comuns que s√£o inerentes a um determinado grupo de hackers.  Conhecer esses recursos exclusivos permite que voc√™ reconhe√ßa a infraestrutura do invasor, mesmo no est√°gio de prepara√ß√£o e sem evid√™ncias que confirmem o ataque, como e-mails de phishing ou malware. <br><br><h1>  <font color="#e63619">Por que criamos nosso pr√≥prio gr√°fico de rede?</font> </h1><br>  Repito que consideramos solu√ß√µes de diferentes fornecedores antes de chegarmos √† conclus√£o de que precisamos desenvolver nossa pr√≥pria ferramenta que possa fazer o que n√£o √© encontrado em nenhum produto existente.  Demorou v√°rios anos para cri√°-lo, durante o qual o mudamos completamente mais de uma vez.  Mas, apesar do longo per√≠odo de desenvolvimento, ainda n√£o encontramos um √∫nico an√°logo que atendesse aos nossos requisitos.  Usando nosso pr√≥prio produto, conseguimos resolver quase todos os problemas encontrados nos gr√°ficos de rede existentes.  Abaixo, consideramos esses problemas em detalhes: <br><br><div class="scrollable-table"><table><tbody><tr><th width="350">  O problema </th><th width="350">  Solu√ß√£o </th></tr><tr><td>  Falta de um provedor com diferentes cole√ß√µes de dados: dom√≠nios, DNS passivo, SSL passivo, registros DNS, portas abertas, servi√ßos em execu√ß√£o nas portas, arquivos que interagem com nomes de dom√≠nio e endere√ßos IP.  Explica√ß√£o  Os fornecedores geralmente fornecem tipos separados de dados e, para obter uma imagem completa, voc√™ precisa comprar assinaturas de todos.  Mas, mesmo assim, nem sempre √© poss√≠vel obter todos os dados: alguns provedores SSL passivos fornecem apenas dados sobre certificados emitidos por CAs confi√°veis, e a cobertura de certificados autoassinados √© extremamente baixa.  Outros fornecem dados em certificados autoassinados, mas apenas os coletam em portas padr√£o. </td><td>  Reunimos todas as cole√ß√µes acima.  Por exemplo, para coletar dados sobre certificados SSL, escrevemos nosso pr√≥prio servi√ßo que os coleta de CAs confi√°veis ‚Äã‚Äãe verificando todo o espa√ßo IPv4.  Os certificados foram coletados n√£o apenas do IP, mas tamb√©m de todos os dom√≠nios e subdom√≠nios do nosso banco de dados: se voc√™ tiver o dom√≠nio example.com e seu subdom√≠nio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.example.com</a> e todos resolverem para o IP 1.1.1.1, quando tentar obter SSL- certificado da porta 443 por IP, dom√≠nio e seu subdom√≠nio, voc√™ pode obter tr√™s resultados diferentes.  Para coletar dados sobre portas abertas e servi√ßos em execu√ß√£o, tive que criar meu pr√≥prio sistema de varredura distribu√≠da, porque para outros servi√ßos os endere√ßos IP dos servidores de varredura estavam frequentemente nas "listas negras".  Nossos servidores de digitaliza√ß√£o tamb√©m est√£o na lista negra, mas o resultado de encontrar os servi√ßos de que precisamos √© maior do que aqueles que simplesmente digitalizam o maior n√∫mero poss√≠vel de portas e vendem o acesso a esses dados. </td></tr><tr><td>  Falta de acesso a todo o banco de dados de registros hist√≥ricos.  Explica√ß√£o  Cada fornecedor normal tem um bom hist√≥rico acumulado, mas por raz√µes naturais, como cliente, n√£o conseguimos acesso a todos os dados hist√≥ricos.  I.e.  voc√™ pode obter a hist√≥ria inteira por um registro separado, por exemplo, por dom√≠nio ou endere√ßo IP, mas n√£o pode ver o hist√≥rico de tudo - e sem isso, n√£o √© poss√≠vel ver a imagem inteira. </td><td>  Para coletar o maior n√∫mero poss√≠vel de registros hist√≥ricos por dom√≠nio, compramos v√°rios bancos de dados, analisamos muitos recursos abertos que possu√≠am esse hist√≥rico (√© bom que existissem muitos deles) e concordamos com os registradores de nomes de dom√≠nio.  Todas as atualiza√ß√µes em nossas pr√≥prias cole√ß√µes, √© claro, s√£o armazenadas com um hist√≥rico completo de altera√ß√µes. </td></tr><tr><td>  Todas as solu√ß√µes existentes permitem criar um gr√°fico no modo manual.  Explica√ß√£o  Digamos que voc√™ comprou muitas assinaturas de todos os provedores de dados poss√≠veis (geralmente eles s√£o chamados de "enriquecimento").  Quando voc√™ precisa criar um gr√°fico, voc√™ fornece o comando ‚Äúm√£os‚Äù para criar a partir do elemento de comunica√ß√£o desejado, depois, a partir dos elementos exibidos, seleciona os necess√°rios e fornece o comando para concluir as conex√µes a partir deles e assim por diante.  Nesse caso, a responsabilidade de qu√£o bem o gr√°fico ser√° constru√≠do recai inteiramente sobre a pessoa. </td><td>  Fizemos gr√°ficos autom√°ticos.  I.e.  se voc√™ precisar criar um gr√°fico, as conex√µes do primeiro elemento ser√£o constru√≠das automaticamente, al√©m de todas as subsequentes.  O especialista indica apenas a profundidade com a qual construir o gr√°fico.  O processo de preenchimento autom√°tico de gr√°ficos √© simples, mas outros fornecedores n√£o o implementam porque ele oferece uma quantidade enorme de resultados irrelevantes, e tamb√©m tivemos que considerar essa desvantagem (veja abaixo). </td></tr><tr><td>  Muitos resultados irrelevantes s√£o o problema de todos os gr√°ficos nos elementos de rede.  Explica√ß√£o  Por exemplo, um "dom√≠nio incorreto" (participou do ataque) est√° associado a um servidor ao qual nos √∫ltimos 10 anos 500 outros dom√≠nios foram associados.  Ao adicionar ou criar manualmente um gr√°fico, todos esses 500 dom√≠nios tamb√©m devem rastrear o gr√°fico, embora n√£o estejam relacionados ao ataque.  Ou, por exemplo, voc√™ verifica o indicador IP no relat√≥rio de seguran√ßa do fornecedor.  Como regra geral, esses relat√≥rios apresentam um atraso significativo e geralmente cobrem um ano ou mais.  Provavelmente, no momento em que voc√™ l√™ o relat√≥rio, o servidor com esse endere√ßo IP j√° est√° alugado para outras pessoas com outras conex√µes, e a constru√ß√£o do gr√°fico levar√° ao fato de que voc√™ recebeu novamente resultados irrelevantes. </td><td>  Treinamos o sistema para identificar elementos irrelevantes de acordo com a mesma l√≥gica que nossos especialistas fizeram manualmente.  Por exemplo, voc√™ verifica o dom√≠nio incorreto example.com, que agora resolve para o IP 11.11.11.11 e, h√° um m√™s, para o IP 22.22.22.22.  Al√©m do dom√≠nio example.com, o example.ru est√° associado ao IP 11.11.11.11 e 25 mil outros dom√≠nios est√£o associados ao IP 22.22.22.22.  O sistema, como uma pessoa, entende que o 11.11.11.11 provavelmente √© um servidor dedicado e, como o dom√≠nio example.ru √© semelhante em ortografia ao example.com, ent√£o, com uma alta probabilidade, eles est√£o conectados e devem estar no gr√°fico;  mas o IP 22.22.22.22 pertence √† hospedagem compartilhada, portanto, voc√™ n√£o precisa colocar todos os seus dom√≠nios no gr√°fico se n√£o houver outros links que mostrem que um desses 25 mil dom√≠nios tamb√©m precisa ser removido (por exemplo, exemplo.net).  Antes que o sistema perceba que as conex√µes precisam ser interrompidas e alguns dos elementos n√£o devem ser colocados no gr√°fico, leva em considera√ß√£o as muitas propriedades dos elementos e agrupamentos nos quais esses elementos s√£o combinados, bem como a for√ßa das conex√µes atuais.  Por exemplo, se tivermos um cluster pequeno (50 elementos) no gr√°fico, que inclui um dom√≠nio incorreto, e outro cluster grande (5 mil elementos) e os dois clusters estiverem conectados por um link (linha) com for√ßa (peso) muito baixa, essa conex√£o ser√° interrompida e os itens do cluster grande ser√£o exclu√≠dos.  Mas se houver muitos links entre clusters pequenos e grandes e sua for√ßa aumentar gradualmente, nesse caso a conex√£o n√£o ser√° interrompida e os elementos necess√°rios de ambos os clusters permanecer√£o no gr√°fico. <br></td></tr><tr><td>  O intervalo de propriedade do servidor e do dom√≠nio n√£o √© levado em considera√ß√£o.  Explica√ß√£o  O registro de "dom√≠nios defeituosos" expira mais cedo ou mais tarde e eles s√£o comprados novamente para fins maliciosos ou leg√≠timos.  Mesmo com hospedagem √† prova de balas, os servidores s√£o alugados para diferentes hackers; portanto, √© essencial conhecer e levar em considera√ß√£o o intervalo em que um dom√≠nio / servidor espec√≠fico estava sob o controle de um propriet√°rio.  Muitas vezes, encontramos uma situa√ß√£o em que um servidor com IP 11.11.11.11 agora √© usado como C&amp;C para um bot banc√°rio e o Ransomware foi gerenciado h√° dois meses.  Se voc√™ criar uma conex√£o, sem levar em considera√ß√£o os intervalos de propriedade, parecer√° que h√° uma conex√£o entre os propriet√°rios da botnet banc√°ria e o ransomware, embora na verdade n√£o seja.  Em nosso trabalho, esse erro √© cr√≠tico. </td><td>  Ensinamos o sistema a determinar intervalos de propriedade.  Para dom√≠nios, isso √© relativamente simples, porque whois geralmente mostra as datas de in√≠cio e t√©rmino do registro e, quando h√° um hist√≥rico completo de altera√ß√µes de whois, √© f√°cil determinar os intervalos.  Quando o dom√≠nio n√£o expirou, mas seu gerenciamento foi transferido para outros propriet√°rios, voc√™ tamb√©m pode control√°-lo.  N√£o existe esse problema para certificados SSL, porque √© emitido uma vez, n√£o √© renovado e n√£o √© transmitido.  Mas para certificados autoassinados, voc√™ n√£o pode confiar nas datas indicadas nas datas de vencimento do certificado, porque √© poss√≠vel gerar um certificado SSL hoje e especificar a data de in√≠cio do certificado a partir de 2010.  O mais dif√≠cil √© determinar os intervalos de propriedade dos servidores, porque apenas os provedores de hospedagem t√™m datas e concess√µes.  Para determinar o per√≠odo de propriedade do servidor, come√ßamos a usar os resultados da verifica√ß√£o de portas e a cria√ß√£o de impress√µes digitais dos servi√ßos em execu√ß√£o nas portas.  Com base nessas informa√ß√µes, podemos dizer com precis√£o quando o propriet√°rio do servidor mudou. </td></tr><tr><td>  Poucas conex√µes.  Explica√ß√£o  Agora, n√£o √© um problema obter uma lista de dom√≠nios gratuitamente, quem √© um endere√ßo de email espec√≠fico ou descobrir todos os dom√≠nios associados a um endere√ßo IP espec√≠fico.  Por√©m, quando se trata de hackers que fazem todo o poss√≠vel para dificultar o rastreamento, s√£o necess√°rios "truques" adicionais para encontrar novas propriedades e criar novas conex√µes. </td><td>  Passamos muito tempo pesquisando como recuperar dados que n√£o est√£o dispon√≠veis da maneira usual.  N√£o podemos descrever como isso funciona aqui por raz√µes √≥bvias, mas sob certas circunst√¢ncias, os hackers cometem erros ao registrar dom√≠nios ou ao alugar e configurar servidores, o que permite descobrir endere√ßos de email, aliases de hackers e endere√ßos de back-end.  Quanto mais conex√µes voc√™ extrair, mais precisamente poder√° criar gr√°ficos. <br></td></tr></tbody></table></div><br><h1>  <font color="#e63619">Como nosso gr√°fico funciona</font> </h1><br>  Para come√ßar a usar o gr√°fico de rede, √© necess√°rio inserir o dom√≠nio, endere√ßo IP, email ou impress√£o digital do certificado SSL na caixa de pesquisa.  Existem tr√™s condi√ß√µes que um analista pode controlar: tempo, profundidade da etapa e limpeza. <br><br><img src="https://habrastorage.org/webt/tc/dp/fy/tcdpfyhagm1jh52ksaklg5ohsko.png"><br><br><h4>  Tempo </h4><br>  Hora - a data ou intervalo em que o item de pesquisa foi usado para fins maliciosos.  Se voc√™ n√£o especificar este par√¢metro, o sistema determinar√° o √∫ltimo intervalo de propriedade desse recurso.  Por exemplo, em 11 de julho, a Eset publicou um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio</a> sobre como o Buhtrap usa uma explora√ß√£o de 0 dias para espionagem cibern√©tica.  No final do relat√≥rio, existem 6 indicadores.  Uma delas, a telemetria segura [.] Net, foi registrada novamente em 16 de julho.  Portanto, se voc√™ criar um gr√°fico ap√≥s 16 de julho, receber√° resultados irrelevantes.  Mas se voc√™ indicar que esse dom√≠nio foi usado antes dessa data, 126 novos dom√≠nios e 69 endere√ßos IP que n√£o est√£o listados no relat√≥rio Eset caem no gr√°fico: <br><br><ul><li>  ukrfreshnews [.] com </li><li>  unian-search [.] com </li><li>  vesti-world [.] informa√ß√£o </li><li>  runewsmeta [.] com </li><li>  foxnewsmeta [.] neg√≥cios </li><li>  sobesednik-meta [.] informa√ß√£o </li><li>  rian-ua [.] l√≠quido </li><li>  e outros </li></ul><br>  Al√©m dos indicadores de rede, encontramos imediatamente links para arquivos maliciosos que tinham links para essa infraestrutura e tags que informam que o Meterpreter, AZORult foi usado. <br><br>  O melhor √© que voc√™ obt√©m esse resultado em um segundo e n√£o precisa mais passar dias analisando os dados.  Obviamente, essa abordagem √†s vezes reduz o tempo para investiga√ß√µes em v√°rias vezes, o que geralmente √© cr√≠tico. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/oi/an/h4oianoutpvnbrb2f3hhukxxtge.png"></div><br><h4>  O n√∫mero de etapas ou a profundidade de recurs√£o com a qual o gr√°fico ser√° constru√≠do </h4><br>  Por padr√£o, a profundidade √© 3. Isso significa que, a partir do elemento que voc√™ est√° procurando, todos os elementos diretamente relacionados ser√£o encontrados e, a partir de cada novo elemento, novas conex√µes ser√£o constru√≠das para outros elementos e, a partir dos novos elementos da √∫ltima etapa, haver√° novos elementos. <br><br>  Tomemos um exemplo n√£o relacionado a APT e explora√ß√µes de 0 dias.  Recentemente, Habr√© descreveu um caso interessante de fraude associada a criptomoedas.  O relat√≥rio menciona o dom√≠nio - themcx [.] Co, usado pelos golpistas para hospedar o site da supostamente trocadora Miner Coin Exchange e a pesquisa por telefone [.] Xyz, para atrair tr√°fego. <br><br>  A partir da descri√ß√£o, fica claro que o esquema requer uma infraestrutura suficientemente grande para atrair tr√°fego para recursos fraudulentos.  Decidimos analisar essa infraestrutura criando um gr√°fico em 4 etapas.  A sa√≠da foi um gr√°fico com 230 dom√≠nios e 39 endere√ßos IP.  Em seguida, dividimos os dom√≠nios em duas categorias: os que s√£o semelhantes aos servi√ßos para trabalhar com criptomoedas e os que s√£o projetados para capturar tr√°fego atrav√©s dos servi√ßos de verifica√ß√£o por telefone: <br><div class="scrollable-table"><table><tbody><tr><th width="350">  Criptomoeda relacionada </th><th width="350">  Associado aos servi√ßos de perfura√ß√£o por telefone </th></tr><tr><td>  guarda-moedas [.] cc </td><td>  site de registro de chamadas [.]. </td></tr><tr><td>  mcxwallet [.] co </td><td>  espa√ßo para registros telef√¥nicos [.] </td></tr><tr><td>  btcnoise [.] com </td><td>  fone-descobrir [.] xyz </td></tr><tr><td>  rel√≥gio cryptominer [.] </td><td>  n√∫mero-descobrir [.] informa√ß√µes </td></tr></tbody></table></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/cj/ve/yqcjvezppd6oulazlfojthyfqwk.png"></div><br><h4>  Limpeza </h4><br>  Por padr√£o, a op√ß√£o "Limpar gr√°fico" est√° ativada e todos os elementos irrelevantes ser√£o exclu√≠dos do gr√°fico.  A prop√≥sito, foi usado em todos os exemplos anteriores.  Prevejo uma pergunta natural: como garantir que algo importante n√£o desapare√ßa? :  ,     ,         = 1.                 . <br><br>         whois, DNS,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/wd/yz/hcwdyzowhht2vljiyxzcspjdgaa.png"></div><br><h3>   </h3><br>     APT- ,               .       ,      ,        ,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8b/6v/st/8b6vstloohn7p-vq4wqngh-_ara.png"></div><br>         .      ‚Äî lloydsbnk-uk[.]com,          3 ,    250  ,       2015    .       ,     ,       . <br><br>          2 . <br><br> ,    2019               -,          . ,  swift-department.com, saudconsultancy.com, vbgrigoryanpartners.com. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/vs/5s/kvvs5sma6yo7kym8lq3fomys67e.png"></div><br><h3> Cobalt gang </h3><br>   2018    Cobalt,      ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/gs/57/gqgs57x9zvmfioavsfo5u-04p1k.png"></div><br>      hXXps://nationalbank.bz/Doc/Prikaz.doc.    ,  powershell,        hXXp://wateroilclub.com/file/dwm.exe  %Temp%\einmrmdmy.exe.  %Temp%\einmrmdmy.exe aka dwm.exe ‚Äî CobInt stager,      hXXp://admvmsopp.com/rilruietguadvtoefmuy. <br><br> ,               .     nationalbank[.]bz       ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wa/yv/rg/wayvrgnysrvft9tjv8p_apiwis4.png"></div><br>     IP- 46.173.219[.]152           .    40 , , bl0ckchain[.]ug <br> paypal.co.uk.qlg6[.]pw <br> cryptoelips[.]com <br><br>    ,       ,    ,              ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/au/mt/heaumtr6jhhfktfn6qgjttwkzt0.png"></div><br>      nationalbank[.]bz,     ,      500             Cobalt,    . ,      : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pz/kc/f4/pzkcf4fyxxhaqmem5jzwb9ituti.png"></div><br><h1>  <font color="#e63619">Conclus√£o</font> </h1><br>     ,    ,             ,         .          .    ,        ,     ,   .      ‚Äú‚Äù   ,   .       ,         .               .          Group-IB        .        .  ,   ,         ,   ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt461639/">https://habr.com/ru/post/pt461639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt461625/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel # 308 (22 a 28 de julho)</a></li>
<li><a href="../pt461629/index.html">12 etapas para encontrar trabalho remoto</a></li>
<li><a href="../pt461631/index.html">17 maneiras de penetrar na rede interna da empresa</a></li>
<li><a href="../pt461633/index.html">Eventos digitais em Moscou, de 29 de julho a 04 de agosto</a></li>
<li><a href="../pt461637/index.html">Pr√≠ncipe saudita planeja construir uma cidade do futuro com chuva artificial, sistemas inteligentes e medicina gen√©tica</a></li>
<li><a href="../pt461641/index.html">Solu√ß√£o de problemas com pwnable.kr 11 moedas1, 12-blackjack, 13-lotto. Erros na l√≥gica do aplicativo</a></li>
<li><a href="../pt461643/index.html">Como voc√™ foi para a Escola de An√°lise de Sistemas do Alfa Bank?</a></li>
<li><a href="../pt461645/index.html">Apresentando o SwiftUI: Criando um aplicativo simples usando o TableView</a></li>
<li><a href="../pt461647/index.html">5 habilidades importantes e perdidas necess√°rias pelo melhor desenvolvedor</a></li>
<li><a href="../pt461649/index.html">Como vou salvar o mundo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>