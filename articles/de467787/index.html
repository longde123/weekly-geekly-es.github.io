<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëø üëÅ‚Äçüó® üèúÔ∏è So richten Sie die Adressensuche nach Koordinaten ein (und wo erhalten Sie das erforderliche Verzeichnis) üî® üàπ üßê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Fr√ºhjahr haben wir der DaData.ru-API die Funktion "Reverse Geocoding" hinzugef√ºgt, die auch als " Address by Coordinates " bezeichnet wird. Der Nam...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So richten Sie die Adressensuche nach Koordinaten ein (und wo erhalten Sie das erforderliche Verzeichnis)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/467787/"><img src="https://habrastorage.org/webt/_w/mf/y5/_wmfy5eag0qfwexxhm4qerr0-64.jpeg"><br><br>  Im Fr√ºhjahr haben wir der DaData.ru-API die Funktion "Reverse Geocoding" hinzugef√ºgt, die auch als " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Address by Coordinates</a> " bezeichnet wird.  Der Name weist darauf hin: Die Methode verwendet Geokoordinaten und gibt Daten √ºber die Adresse an. <br><br>  Ein solides Produkt mit der gleichen Funktionalit√§t bietet Yandex - es hei√üt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geocoder</a> .  Der Yandex-Service ist jedoch nur f√ºr offene nichtkommerzielle Projekte kostenlos.  Der Standardtarif - ab 120 000 ‚ÇΩ pro Jahr - ist nicht f√ºr jeden geeignet. <br><br>  Wir dachten - wenn Sie eine kostenlose oder kosteng√ºnstige Alternative zu "Geocoder" machen, werden sich die Entwickler wahrscheinlich bedanken.  Und sie taten es.  In dem Artikel werde ich Ihnen erkl√§ren, wie die Struktur "Adresse nach Koordinaten" funktioniert: Wie wir die Suche einrichten, ein Verzeichnis zusammenstellen und es in eine vorgefertigte Methode packen. <br><a name="habracut"></a><br><h2>  Woher bekommen wir die Daten und wie suchen wir die Adresse </h2><br>  Als wir uns der Aufgabe n√§herten, untersuchten wir vorgefertigte L√∂sungen: Woher kommt das Koordinatenverzeichnis mit den Adressen und wie wird dann aus diesem Verzeichnis nach geografischen Objekten gesucht?  Es stellte sich heraus, dass Sie nicht einmal weit gehen m√ºssen, um die richtigen Werkzeuge zu finden. <br><br>  <b>Wir nehmen die Adressobjekte in FIAS</b> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Federal Information Address System</a> .  Dies ist das umfassendste der offenen und offiziellen Adressverzeichnisse.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir haben bereits</a> ausf√ºhrlich √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Habr√© dar√ºber geschrieben</a> , und jetzt sind vier Fakten wichtig: <br><br><ul><li>  FIAS speichert alle adressierbaren Objekte des Landes, von Regionen und darunter - bis hin zu Geb√§uden und zus√§tzlichen Gebieten; </li><li>  Das Verzeichnis ist in den Formaten DBF und XML frei verf√ºgbar. </li><li>  FIAS ist nicht perfekt - es fehlen Zehntausende von H√§usern und viele Stra√üen, insbesondere neue; </li><li>  Jedes Adressobjekt im Verzeichnis entspricht einer eindeutigen ID - FIAS-Code.  Der Objektcode wird manchmal ge√§ndert, aber f√ºr unseren Artikel ist dies nicht so wichtig. </li></ul><br>  Von FIAS heruntergeladene Adressobjekte bilden zusammen mit der ID die Grundlage unseres Verzeichnisses f√ºr die umgekehrte Geokodierung. <br><br>  <b>Laden Sie die Koordinaten von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OpenStreetMap</a> (OSM) herunter.</b>  OSM ist ein Projekt mit einer kostenlosen Lizenz: Enthusiasten sammeln die Koordinaten verschiedener Objekte und ver√∂ffentlichen sie an alle. <br><br>  In einfachen Worten ist OSM eine Reihe von Punkten, Linien und Polygonen auf einer Karte.  Jedes Objekt hat eine eigene Beschreibung, einen eigenen Typ und einen eigenen Satz von Koordinaten.  OSM-Daten f√ºr Russland finden Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">needgeo.com</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">osm.sbin.ru/osm_dump/</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">osmosis.svimik.com/latest/</a> . <br><br><img src="https://habrastorage.org/webt/ws/p6/hy/wsp6hyjy8brd4qmc11clfyoulic.png"><br>  <sub>Die Liste der Quellen wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf einer speziellen Seite im ‚ÄûWiki‚Äú des Projekts ver√∂ffentlicht.</a></sub> <br><br>  Das Entladen besteht aus PBF-Dateien - dieses Format wird anstelle von XML als kompakteres verwendet.  Die Umwandlung von PBF in OSM-XML kostet nichts. Eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reihe von von der Community genehmigten Dienstprogrammen kann damit</a> umgehen. <br><br>  F√ºr unser eigenes Verzeichnis nehmen wir die Adressobjekte von FIAS und suchen dann in OSM nach ihren Koordinaten.  Wenn gefunden, speichern Sie die kombinierten Daten.  Es stellt sich heraus, dass FIAS und OSM eine solche Schnittstelle bilden. <br><br>  Und das alles ist wunderbar, aber es gibt ein Problem: Die Qualit√§t der Daten in OSM ist nicht einfach.  Die Koordinaten von Objekten entsprechen oft nicht der Realit√§t.  Beispielsweise sind Polygone f√ºr Regionen und Bezirke ausreichend.  Aber f√ºr St√§dte und darunter - nicht so sehr. <br><br><img src="https://habrastorage.org/webt/dc/hn/uh/dchnuhisbetq44m1uyd8sniuy20.png"><br>  <sub>Polygone sind Polygone, die Bereiche auf einer Karte begrenzen.</sub>  <sub>Sie bestehen aus einem verkn√ºpften Satz von Punkten mit Koordinaten.</sub>  <sub>Polygone geben die Grenzen von Regionen, Bezirken, St√§dten und sogar Geb√§uden an</sub> <br><br>  Die Hauptaufgabe besteht bei weitem darin, angemessene Daten von OSM zu sammeln und die Ehe auszusortieren.  Die Aufgabe ist so umfangreich, dass ich ihr im Artikel einen eigenen Abschnitt gewidmet habe. <br><br>  <b>Wir laden auch H√§user, die nicht in FIAS sind, von OSM herunter.</b>  Wie ich oben sagte, gibt es in FIAS Zehntausende von H√§usern.  Dies ist nicht einmal ein Problem, sondern einfach eine Realit√§t, ein Hintergrund.  Daher f√ºllen wir unser Verzeichnis mit H√§usern von OSM auf.  Aber nur diejenigen, f√ºr die es in FIAS eine Stra√üe gibt.  Die Geb√§ude, die von OSM stammen, haben keine FIAS-ID, daher identifizieren wir sie als <i>FIAS-Code + Hausnummer</i> der <i>Eltern</i> . <br><br>  <b>Im Verzeichnis suchen wir mit Hilfe der sch√∂nen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lucene</a></b> - unserer langj√§hrigen Assistentin.  Vielen Dank f√ºr den Tipp an einen versierten Inder, der den Beitrag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Indizieren geografischer Daten mit Lucene geschrieben hat</a> (eine gute Erg√§nzung ist das Material <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ad Spatial in r√§umliche Suchalgorithmen</a> - √ºber die kd-B√§ume, auf denen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Suchalgorithmus</a> basiert). <br><br>  Sobald wir von Lucene erfahren hatten, war das Suchproblem fast von selbst gel√∂st.  Das Gesch√§ft bleibt bestehen - Sandpapier. <br><br><ol><li>  Wir haben in Lucene Ihr Verzeichnis mit Koordinaten und Adressen geladen und einen Suchindex erhalten.  Der Einfachheit halber wurde fast alles entfernt, wobei nur die Adress-IDs und Koordinaten √ºbrig blieben. </li><li>  Wir richten eine Suche nach Index ein: Eingabe - Koordinaten, Ausgabe - ID der gefundenen Adressobjekte.  Die Suche gibt keine anderen Informationen zur√ºck, da der Index vollst√§ndig gek√ºrzt wurde. </li><li>  Befriedigte die Ausgabe und lud Daten aus dem "gro√üen" FIAS durch die gefundenen IDs.  Wir f√ºgen viel von allem hinzu, von der Adresse, die jeder in einer Zeile ben√∂tigt, bis zum Zeichen der regionalen Hauptstadt der St√§dte. </li><li>  Wir haben herausgefunden, wie man die empfangenen Objekte sortiert und gibt. </li></ol><br>  Bisher sieht alles einfach aus, aber das ist nur ein kleiner Teil der Arbeit.  Keine Suche nach der Adresse nach Koordinaten h√§tte funktioniert, wenn wir kein anst√§ndiges Verzeichnis zusammengestellt h√§tten. <br><br><h2>  So sammeln Sie die Basis von Koordinaten und Adressen </h2><br>  Zun√§chst lege ich das Gep√§ck aus: Nach dem Lesen des Artikels funktioniert ein solches Handbuch schnell nicht.  Wir sammeln es seit 2014 und erg√§nzen es st√§ndig.  Ich werde √ºber diesen verdammt langen Weg sprechen. <br><br>  Der schwierigste Teil beim Kompilieren eines Verzeichnisses besteht darin, die von OSM stammenden Koordinaten zu sortieren.  Zu Beginn haben wir sie so gut wie m√∂glich √ºberpr√ºft, auch mit unseren H√§nden.  Das Hauptziel war es dann, Referenzpunkte in Gro√üst√§dten zu erhalten und daraus einen Referenzleitfaden zu erstellen.  Da es viele solcher Punkte gibt, ist es fast nicht mehr erforderlich, manuell nach neuen Daten zu suchen.  Wir f√ºgen dem Referenzverzeichnis jeweils 200.000 bis 300.000 Adressen mit Koordinaten hinzu. So gehen wir vor. <br><br>  <b>Wir bilden vollst√§ndige Adressen aus OSM-Tags.</b>  Bei OSM-Uploads werden die Bestandteile von Adressen durch verschiedene Tags verteilt: <br><br><ul><li>  <i>Adresse: Stadt - Dorf Bulatnikovo</i> ; </li><li>  <i>Adresse: Stra√üe - Hauptstra√üe</i> ; </li><li>  <i>Adresse: Hausnummer - 103</i> . </li></ul><br>  Wir gehen die Tags durch und sammeln die vollst√§ndige Adresse von ihnen: <i>Bulatnikovo Village, 103 Central Street</i> . <br><br>  <b>Wir f√ºhren jede neue Adresse √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dadat-Standardisierungs-API aus</a> .</b>  Der Dienst konvertiert Adressen in ein einziges Format "Wie in FIAS": <br><br><ul><li>  korrigiert Tippfehler; </li><li>  dekodiert Abk√ºrzungen wie "NiNo" und "Msk"; </li><li>  √§ndert alte Namen in neue; </li><li>  findet die fehlende Stadt in der Adresse nach Index; </li><li>  definiert einen FIAS-Code. </li></ul><br>  Die Adressen von der API sind sauber, obwohl sie jetzt einen Brief oder ein Paket senden. <br><div class="scrollable-table"><table><tbody><tr><th>  Vor der Standardisierung </th><th>  Nachher </th></tr><tr><td>  <i>Bulatnikovo Dorf, Central Street, 103</i> </td><td><p>  <i>142718, Region Moskau, Bezirk Leninsky, mit Bulatnikovo, Central St., 103.</i> </p><br><p>  FIAS-Code - <i>a8b6a52f-e96d-4ec3-a0ff-641013ab0445</i> </p></td></tr></tbody></table></div>  Wir speichern standardisierte H√§user, Stra√üen und Siedlungen als einen Punkt.  F√ºr die Stra√üe und das Dorf ist dieser Punkt das Zentrum.  Infolgedessen befinden sich alle Adressobjekte in derselben Tabelle - Adresse, FIAS-ID, Breite und L√§nge. <br><div class="scrollable-table"><table><tbody><tr><th>  Die Adresse </th><th>  FIAS ID </th><th>  Breitengrad </th><th>  L√§ngengrad </th></tr><tr><td>  <i>142718, Region Moskau, Bezirk Leninsky, mit Bulatnikovo, Central St., 103</i> </td><td>  <i>a8b6a52f-e96d-4ec3-a0ff-641013ab0445</i> </td><td>  <i>55.558773</i> </td><td>  <i>37.667103</i> </td></tr><tr><td>  <i>119034, Moskau, Gasse Turchaninov, d 6 Geb√§ude 2</i> </td><td>  <i>8c925e61-9173-48b3-999e-dc85c86d89e7</i> </td><td>  <i>55.737096</i> </td><td>  <i>37.597190</i> </td></tr></tbody></table></div>  <b>Wir analysieren Adressen, die Dadata nicht standardisiert hat.</b>  Adressen, die nicht mit FIAS √ºbereinstimmen konnten, werden vom Dienst mit einem Flag gekennzeichnet.  Wir √ºberpr√ºfen sie manuell, es gibt verschiedene M√∂glichkeiten. <br><br><ol><li>  Die Adresse kam nicht in den richtigen OSM-Upload-Tags, aber der Teufel wei√ü wo.  Erf√ºllte und nicht ausgef√ºllte Adressschilder und die Stadt auf der Stra√üe und vieles mehr. </li><li>  In OSM liegt ein exotisches Objekt wie ein Spielplatz, ein College-Football-Feld oder sogar ein Friedhof.  In FIAS gibt es nichts Vergleichbares, und f√ºr unsere Zwecke sind diese Ergebnisse nicht geeignet.  Solche Objekte werden einfach ausgesiebt. </li><li>  Ein Fehler - und √ºberhaupt kein Fehler.  Beispielsweise stammte ein Stadtteil, der in FIAS nicht existiert, von OSM.  Oder in OSM befindet sich das Objekt in einer Siedlung, aber in FIAS wurde diese Siedlung an die Stadt angeh√§ngt und entfernt.  Dann beenden wir den Algorithmus f√ºr die geladenen Daten und f√ºhren ihn erneut aus. </li></ol><br><img src="https://habrastorage.org/webt/_u/yc/1u/_uyc1uds-xef7yiwtpu01vgk7ju.png"><br>  <sub>Analysieren Sie das Entladen und dort - Verwirrung in Tags</sub> <br><br>  <b>Wir pr√ºfen, wie ausreichend die geladenen Koordinaten sind.</b>  Dazu pr√ºfen wir mit einem besonderen Dienstprogramm, ob die Koordinaten des neuen Objekts in das Polygon der √ºbergeordneten Region oder des √ºbergeordneten Distrikts fallen.  Wenn die Adresse mitteilt, dass sich das Objekt in der Region Omsk befindet, seien Sie bitte so freundlich, auf die Deponie zu gelangen.  Der Eintritt in die Stadt ist nicht erforderlich - nicht alle St√§dte werden in OSM genau abgedeckt, f√ºr viele werden die Daten nicht aktualisiert. <br><br>  Wir laden Referenzpolygone aus OSM und speichern sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unver√§ndert</a> im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GeoJSON-</a> Format.  Um auszuw√§hlen, welches Polygon an einem Punkt ausprobiert werden soll, schauen Sie in eine separate Tabelle.  Darin haben wir die Pr√§fixe der CLADR-Codes und der Polygon-IDs verglichen: Sie finden den CLADR-Code f√ºr die Adresse und sehen, welches Polygon Sie ausw√§hlen m√ºssen. <br><br><img src="https://habrastorage.org/webt/f_/ud/tt/f_udtt5i_rael-f2i8exqc-4k0g.png"><br>  <sub>Der KLADR-Code ist eine eindeutige Kennung, die vor dem FIAS verwendet wurde.</sub>  <sub>Eine Million Dienste k√∂nnen diesen Code f√ºr eine Adresse finden</sub> <br><br>  Das Dienstprogramm erm√∂glicht es dem Objekt, 1.700 Meter von der Deponie entfernt zu stehen.  Diese Regel wurde aufgrund von Autobahnen hinzugef√ºgt, die h√§ufig √ºber die Grenzen der Region hinausgehen.  Eine Entfernung von mehr als 1.700 Metern ist laut Statistik ein Zeichen f√ºr einen Fehler. <br><br>  Damit endet f√ºr St√§dte und Stra√üen die Pr√ºfung. <br><br>  <b>Noch einmal, strenger, √ºberpr√ºfen wir die geladenen Koordinaten der H√§user.</b>  Das wieder erw√§hnte Dienstprogramm kommt ins Spiel, und genau das tut es. <br><br><ol><li>  Er nimmt die Adresse des neuen Hauses und findet im Referenzverzeichnis Nachbarn f√ºr ihn. </li><li>  Gem√§√ü den Koordinaten wird die Entfernung zwischen dem nicht √ºberpr√ºften neuen Haus und zuverl√§ssigen Nachbarn ber√ºcksichtigt. </li></ol><br><img src="https://habrastorage.org/webt/sx/vx/y-/sxvxy-u2l54hlaggzda0zx8u-tw.jpeg"><br>  <sub>Es ist einfach, Nachbarn zu finden: 1. Wir nehmen ein neues Haus und finden die FIAS-ID des Elternteils.</sub>  <sub>2. Wir w√§hlen aus dem Referenzverzeichnis H√§user aus, deren Eltern dieselbe FIAS-ID haben</sub> <br><br>  Die Inspektion wird nur zu Hause durchgef√ºhrt, nicht mehr als 150 Meter von zuverl√§ssigen Kollegen entfernt.  Dar√ºber hinaus ber√ºcksichtigen wir jedes neue genehmigte Haus bei der Analyse der folgenden Punkte.  So funktioniert es <br><br>  Angenommen, im Referenzhandbuch sind die H√§user <i>Nr. 1, 2 und 3</i> <i>entlang der Kommunarov-Stra√üe</i> gelagert.  In den neuen Daten kamen die H√§user <i>Nr. 5, 6 und 7</i> in derselben Stra√üe.  Nach den Koordinaten zu urteilen, sind die neuen H√§user in der N√§he.  Das Dienstprogramm erkennt, dass sich Hausnummer <i>5</i> neben <i>Hausnummer 1, 2 und 3 befindet,</i> und f√ºgt es dem Referenzverzeichnis hinzu.  Daher werden auch die H√§user <i>6 und 7</i> getestet. <br><br>  Und dann wird das Schicksal der Daten entschieden, die von OSM stammen: <br><br><ul><li>  H√§user, die beide Pr√ºfungen bestanden haben: F√ºr Deponien und f√ºr Nachbarn f√ºgen wir dem Referenzverzeichnis hinzu; </li><li>  Wenn das Objekt nicht in das Polygon f√§llt, sind die neuen Daten nicht geeignet.  Das gleiche, wenn der Abstand zwischen dem Haus und den Nachbarn zu gro√ü ist; </li><li>  H√§user, die keine Nachbarn haben, verschieben wir.  Sie liegen in einer separaten Datenbank, die wir eines Tages analysieren werden. </li></ul><br>  <b>Wir teilen die getesteten Objekte in zwei Teile.</b>  Sie werden zu verschiedenen Tafeln unseres Referenzhandbuchs gehen. <br><br><img src="https://habrastorage.org/webt/60/mh/30/60mh30nzsamn2rv_gegjgooqusy.png"><br>  <sub>In der ersten Tabelle alle Objekte mit FIAS-ID f√ºr H√§user: Regionen, Siedlungen, Stra√üen.</sub>  <sub>Im zweiten - zu Hause und ein Link zum Elternteil aus der ersten Tabelle</sub> <br><br>  Es werden zwei Tabellen ben√∂tigt, um Schl√ºssel f√ºr H√§user zuzuweisen, die in FIAS fehlen.  Sie haben keinen eigenen FIAS-Code. So geht's: <br><br><ul><li>  Wir sammeln Adressobjekte f√ºr das Haus in einer Tabelle, von denen jede ihren eigenen FIAS-Code hat. </li><li>  in der zweiten - nur zu Hause, unter Bezugnahme auf die Eltern in der ersten Tabelle. </li></ul><br>  Als Ergebnis eines Geb√§udes ohne FIAS-Code identifizieren wir die <i>ID + Hausnummer</i> des <i>Elternteils</i> mit dem <i>FIAS-</i> Schl√ºssel. <br><br>  <b>Die Referenz ist fertig, es bleibt zu testen.</b>  Wir f√ºhren √ºber Nacht einen Funktionstestservice durch und testen die Leistung.  Wir √ºberpr√ºfen die Geschwindigkeit in Moskau und fordern alle H√§user im Umkreis von drei Kilometern an.  Um sicher zu sein.  Nat√ºrlich haben sie alles mit Autotests √ºberlagert. <br><br>  Die Hauptsache nach dem Update ist, nicht schlechter zu werden. <br><br><h2>  Umgekehrte Geokodierung mit den Augen des Benutzers </h2><br>  Die Eingabemethode verwendet drei Parameter: Koordinaten, Anzahl der Ergebnisse und Suchradius.  Der Standardradius betr√§gt 100 Meter, das Maximum ist ein Kilometer.  Der genaue Wert wird in den Einstellungen eingestellt. <br><br><pre><code class="java hljs">curl -X POST \ -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Accept: application/json"</span></span> \ -H <span class="hljs-string"><span class="hljs-string">"Authorization: Token ${API_KEY}"</span></span> \ -d <span class="hljs-string"><span class="hljs-string">'{ "lat": 55.878, "lon": 37.653, "radius_meters": 50 }'</span></span> \ https:<span class="hljs-comment"><span class="hljs-comment">//suggestions.dadata.ru/suggestions/api/4_1/rs/geolocate/address</span></span></code> </pre> <br>  Die Methode gibt die gefundenen Objekte zur√ºck: H√§user, Stra√üen und Siedlungen.  Es sortiert sie in absteigender Reihenfolge der Genauigkeit. <br><br><ol><li>  Zu Hause. </li><li>  Die Stra√üen. </li><li>  Siedlungen. </li><li>  St√§dte </li></ol><br>  Dann sortiert es erneut - nach Abstand von den angegebenen Koordinaten.  Wenn die Methode vier H√§user und eine Stra√üe gefunden hat, stehen die H√§user zun√§chst in der Reihenfolge der Entfernung von einem bestimmten Punkt.  Hinter ihnen ist die Stra√üe. <br><br>  Nach all diesen Burgen gibt die Methode schlie√ülich die gefundenen Objekte zur√ºck. <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"suggestions"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unrestricted_value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: {...} }, { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unrestricted_value"</span></span>: <span class="hljs-string"><span class="hljs-string">" ,  ,  11"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"data"</span></span>: {...} } ] }</code> </pre> <br>  Im Inneren - viele verschiedene Dinge √ºber die gefundenen Objekte: Zeilen mit der vollst√§ndigen und abgek√ºrzten Adresse, aktuellen und veralteten Namen, Postleitzahl, FIAS-Code des √ºbergeordneten Objekts und so weiter. <br><br><img src="https://habrastorage.org/webt/c5/_4/8i/c5_48iyueonoygc22saytynllr4.png"><br>  <sub>Alle von der Methode angegebenen Daten befinden sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in der Dokumentation</a></sub> <br><br>  Die Abdeckung durch Koordinaten f√ºr verschiedene Regionen ist unterschiedlich, wie bei H√§usern: <br><br><ul><li>  Moskau - 96%, </li><li>  St. Petersburg - 88%, </li><li>  andere mehr als eine Million St√§dte - 74%, </li><li>  der Rest von Russland ist 47%. </li></ul><br>  Und hier ist es - auf den Stra√üen: <br><br><ul><li>  Moskau - 92% </li><li>  St. Petersburg - 79%, </li><li>  andere Million√§rsst√§dte - 75%, </li><li>  der Rest von Russland ist 67%. </li></ul><br>  Sie haben die St√§dte nicht ber√ºcksichtigt - auf der Skala Russlands war sogar die Tatsache, zum stolzen Titel der Stadt zu geh√∂ren, unbest√§ndig.  Zum Beispiel ist die <i>Region Jaroslawl, Bezirk Poshekhonsky, s / o Fedorkovsky</i> , laut dem offiziellen FIAS-Verzeichnis eine Stadt.  Aber in der Tat und an der Adresse - dem Landkreis.  Physisch √§hnelt der Landkreis der Vereinigung mehrerer D√∂rfer in einem gro√üen Fleck.  Es ist schwierig, nicht nur das Zentrum zu bestimmen, sondern auch die Siedlung auf der Karte zu finden. <br><br>  Wir √ºberlegen bereits, was wir der Methode hinzuf√ºgen sollen: Filtern nach Objekttyp zulassen, Entfernung zu einem bestimmten Punkt zur√ºckgeben, etwas anderes.  Wir √ºberwachen die Nachfrage und entscheiden, ob wir investieren. <br><br>  Ansonsten ist schon alles auf dem Prod.  Bis zu 10.000 Anfragen pro Tag - kostenlos, mehr - im Abonnement ab 5.000 ‚ÇΩ pro Jahr.  Wenn Sie Adressen nach Koordinaten f√ºr ein kommerzielles Projekt ben√∂tigen und Geocoder zu teuer ist, probieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Dadati-API aus</a> . <br><br>  <i>Der Originalartikel wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im HFLabs-Blog ver√∂ffentlicht</a> .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467787/">https://habr.com/ru/post/de467787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467775/index.html">5 Mythen √ºber das Gesch√§ft: Warum der Kunde falsch liegt und wie man Apple √ºbertrifft</a></li>
<li><a href="../de467779/index.html">√úber Godot, GLSL und WebGL, Shader, die im Minispiel verwendet werden</a></li>
<li><a href="../de467781/index.html">C ++ - Kurs im CS Center, erster Teil</a></li>
<li><a href="../de467783/index.html">Wie kann ein IT-Profi in der Schweiz arbeiten und leben?</a></li>
<li><a href="../de467785/index.html">So optimieren Sie Pandas bei der Arbeit mit gro√üen Datenmengen (Aufsatz)</a></li>
<li><a href="../de467789/index.html">Java 13 ist gerade eingetroffen. ZGC hat begonnen, Speicher gemeinsam zu nutzen, CDS selbst erinnert sich an Klassen und andere technische Wunder</a></li>
<li><a href="../de467791/index.html">Analyse des Bildlaufs in Google Data Studio</a></li>
<li><a href="../de467793/index.html">Langweiliger Technologie-Stack eines Ein-Mann-Internetunternehmens</a></li>
<li><a href="../de467795/index.html">Hinweis zu Kryptow√§hrungen und staatlicher Regulierung</a></li>
<li><a href="../de467797/index.html">"Um der Sache willen lachen": Warum ben√∂tigen Sie m√∂glicherweise Software-Tools, die keine "Kampf" -Anwendung haben?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>