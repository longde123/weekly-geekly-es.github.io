<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüëß‚Äçüë¶ üèóÔ∏è üè® D√©ploiement du mod√®le Keras Deep Learning en tant qu'application Web Python ü§òüèª üëêüèº üçö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours "D√©veloppeur Web en Python" . 



 Cr√©er un projet d'apprentissage ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©ploiement du mod√®le Keras Deep Learning en tant qu'application Web Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/477402/">  <i>La traduction de l'article a √©t√© pr√©par√©e sp√©cialement pour les √©tudiants du cours <a href="https://otus.pw/PcSx/">"D√©veloppeur Web en Python"</a> .</i> <br><br><img src="https://habrastorage.org/webt/vz/ii/2j/vzii2j88n5_-t9hihzrz276v7ho.png"><br><hr><br>  Cr√©er un projet d'apprentissage automatique sympa est une chose, une autre chose quand vous avez besoin que d'autres personnes le voient aussi.  Bien s√ªr, vous pouvez mettre tout le projet sur GitHub, mais comment vos grands-parents comprendront-ils ce que vous avez fait?  Non, nous devons d√©ployer notre mod√®le d'apprentissage en profondeur en tant qu'application Web qui sera accessible √† tous dans le monde. <br><br>  Dans cet article, nous apprendrons √† √©crire une application Web qui utilise le r√©seau neuronal r√©current form√© par Keras et permet aux utilisateurs de cr√©er de nouvelles annotations de brevets.  Ce projet est bas√© sur le travail de l'article <a href="https://medium.com/p/ffd204f99470%3Fsource%3Duser_profile---------6------------------">¬´R√©seaux de neurones r√©currents par l'exemple¬ª</a> , cependant, il n'est pas n√©cessaire de savoir comment le RNN est construit maintenant.  Pour le moment, nous allons simplement le consid√©rer comme une bo√Æte noire: nous avons d√©fini la s√©quence initiale, et elle affiche une toute nouvelle annotation de brevet, qui peut √™tre consult√©e dans un navigateur! <a name="habracut"></a><br><br>  En r√®gle g√©n√©rale, les analystes de donn√©es d√©veloppent des mod√®les et les pr√©sentent au monde entier.  Dans ce projet, nous devrons jouer les deux r√¥les et plonger dans le d√©veloppement web (bien que presque enti√®rement en Python). <br><br>  Ce projet n√©cessitera la combinaison de plusieurs outils: <br><br><ul><li>  <a href="http://flask.pocoo.org/">Flask</a> : pour cr√©er une application web de base en Python; </li><li>  <a href="http://keras.io/">Keras</a> : D√©ploiement d'un r√©seau neuronal <a href="http://keras.io/">r√©current pr√©-form√©</a> </li><li>  Mod√®les du moteur de mod√®les <a href="http://jinja.pocoo.org/">Jinja</a> ; </li><li>  <a href="https://www.w3schools.com/html/">HTML</a> et <a href="https://www.w3schools.com/html/html_css.asp">CSS</a> pour cr√©er des pages Web. </li></ul><br>  En fin de compte, nous obtenons une application Web qui permettra aux utilisateurs de cr√©er des annotations de brevets compl√®tement nouvelles en utilisant un r√©seau neuronal r√©current form√©. <br><br><img src="https://habrastorage.org/webt/l_/oc/2j/l_oc2jgyuokd3kvrsk2pn87bhis.gif"><br><br>  Tout le code du projet est disponible sur <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">GitHub</a> . <br><br><h3>  L'approche </h3><br>  L'objectif √©tait de d√©ployer l'application Web le plus rapidement possible.  Pour cela, j'ai choisi Flask, qui vous permet d'√©crire des applications en Python.  Je n'aime pas jouer avec les styles (je pense que vous l'avez d√©j√† vu), donc je copie et colle presque tous les CSS √† partir de sources tierces.  Cet <a href="https://blog.keras.io/building-a-simple-keras-deep-learning-rest-api.html">article</a> de l'√©quipe Keras a √©t√© utile pour apprendre les bases, et <a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">cet article</a> est √©galement un guide utile. <br><blockquote> <i>En g√©n√©ral, ce projet r√©pond √† mes principes de conception: cr√©er un prototype qui fonctionne rapidement (copier et coller autant de code que n√©cessaire), puis r√©p√©ter la m√™me chose pour am√©liorer le produit.</i> </blockquote><h3>  Application Web de base sur Flask </h3><br>  Le moyen le plus rapide pour cr√©er une application Web Python est d'utiliser Flask (http://flask.pocoo.org/).  Pour cr√©er notre propre application, nous pouvons utiliser les √©l√©ments suivants: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Flask app = Flask(__name__) @app.route(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;Not Much Going On Here&lt;/h1&gt;"</span></span> app.run(host=<span class="hljs-string"><span class="hljs-string">'0.0.0.0'</span></span>, port=<span class="hljs-number"><span class="hljs-number">50000</span></span>)</code> </pre> <br>  Si vous ex√©cutez ce code, vous verrez votre propre application sur localhost: 50000.  Bien s√ªr, nous avons besoin de quelque chose de plus, nous allons donc utiliser une fonction plus complexe qui fait g√©n√©ralement la m√™me chose: il traite les demandes de votre navigateur et sert du contenu sous forme de HTML. <br><br><h3>  Formulaire d'inscription utilisateur </h3><br>  Lorsque les utilisateurs acc√®dent √† la page principale de l'application, nous leur montrerons un formulaire avec trois options: <br><br><ol><li>  Saisissez la s√©quence source du RNN ou g√©n√©rez-la au hasard. </li><li>  S√©lection de la ¬´diversit√©¬ª des pr√©visions RNN. </li><li>  Le choix du nombre de mots √©mis par le RNN. </li></ol><br>  Pour cr√©er un formulaire en Python, nous utilisons <a href="https://wtforms.readthedocs.io/">wtforms</a> .  Vous verrez ci-dessous le code de sa cr√©ation: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> wtforms <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> (Form, TextField, validators, SubmitField, DecimalField, IntegerField) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ReusableForm</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Form)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""User entry form for entering specifics for generation"""</span></span> <span class="hljs-comment"><span class="hljs-comment"># Starting seed seed = TextField("Enter a seed string or 'random':", validators=[ validators.InputRequired()]) # Diversity of predictions diversity = DecimalField('Enter diversity:', default=0.8, validators=[validators.InputRequired(), validators.NumberRange(min=0.5, max=5.0, message='Diversity must be between 0.5 and 5.')]) # Number of words words = IntegerField('Enter number of words to generate:', default=50, validators=[validators.InputRequired(), validators.NumberRange(min=10, max=100, message='Number of words must be between 10 and 100')]) # Submit button submit = SubmitField("Enter")</span></span></code> </pre> <br>  En l'utilisant, nous avons cr√©√© le formulaire ci-dessous (avec des styles de <code>main.css</code> ): <br><br><img src="https://habrastorage.org/webt/ja/mc/2j/jamc2jeigbqz87z4flruuzuzp4e.png"><br><br>  Une v√©rification du code est n√©cessaire pour s'assurer que l'utilisateur entre les informations correctes.  Par exemple, nous v√©rifions que tous les champs sont remplis et que la valeur du param√®tre de diversit√© est comprise entre 0,5 et 5. Ces conditions doivent √™tre remplies pour commencer. <br><br><img src="https://habrastorage.org/webt/wz/wy/e2/wzwye2lrn8rrnfdp1lemj9hf4p4.png"><br>  <i>Erreur lors de la validation des donn√©es saisies</i> <br><br>  Nous traitons ce formulaire √† l'aide de mod√®les sur <code>Flask</code> . <br><br><h3>  Patterns </h3><br>  Un mod√®le est un fichier avec un ¬´cadre¬ª d√©j√† pr√©par√© qui doit simplement √™tre rempli d'une certaine mani√®re.  Pour une application Web Flask, nous pouvons utiliser la biblioth√®que de mod√®les <a href="http://jinja.pocoo.org/">Jinja</a> pour traduire le code Python en un document HTML.  Par exemple, dans notre fonction principale, nous enverrons le contenu du formulaire vers un mod√®le appel√© <code>index.html</code> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> render_template <span class="hljs-comment"><span class="hljs-comment"># Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Lorsque l'utilisateur acc√®de √† la page principale, notre application fournit <code>index.html</code> entr√©e du formulaire.  Le mod√®le est une structure HTML compl√®te dans laquelle nous nous r√©f√©rons aux variables Python en utilisant la syntaxe <code>{{variable}}</code> . <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>RNN Patent Writing<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span>Writing Novel Patent Abstracts with Recurrent Neural Networks<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {% for message in form.seed.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.diversity.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} {% for message in form.words.errors %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flash"</span></span></span><span class="hljs-tag">&gt;</span></span>{{ message }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {% endfor %} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">post</span></span></span><span class="hljs-tag">&gt;</span></span> {{ form.seed.label }} {{ form.seed }} {{ form.diversity.label }} {{ form.diversity }} {{ form.words.label }} {{ form.words }} {{ form.submit }} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Lorsqu'une erreur se produit dans le formulaire (entr√©e non v√©rifiable), un message d'erreur clignote.  De plus, le formulaire sera affich√© comme dans le fichier ci-dessus. <br><br>  Lorsque l'utilisateur entre des informations et clique sur <code>submit</code> (demande <code>POST</code> ), si les informations sont correctes, nous redirigeons les donn√©es d'entr√©e vers la fonction correspondante pour faire des pr√©dictions en utilisant un RNN form√©.  Cela signifie que vous devez modifier <code>home()</code> . <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request <span class="hljs-comment"><span class="hljs-comment"># User defined utility functions from utils import generate_random_start, generate_from_seed # Home page @app.route("/", methods=['GET', 'POST']) def home(): """Home page of app with form""" # Create form form = ReusableForm(request.form) # On form entry and all conditions met if request.method == 'POST' and form.validate(): # Extract information seed = request.form['seed'] diversity = float(request.form['diversity']) words = int(request.form['words']) # Generate a random sequence if seed == 'random': return render_template('random.html', input=generate_random_start(model=model, graph=graph, new_words=words, diversity=diversity)) # Generate starting from a seed sequence else: return render_template('seeded.html', input=generate_from_seed(model=model, graph=graph, seed=seed, new_words=words, diversity=diversity)) # Send template information to index.html return render_template('index.html', form=form)</span></span></code> </pre> <br>  Maintenant, lorsque l'utilisateur appuie sur <code>submit</code> et que les informations saisies sont correctes, en fonction de l'entr√©e, l'entr√©e est envoy√©e soit √† <code>generate_random_start</code> soit √† <code>generate_from_seed</code> .  Ces fonctionnalit√©s utilisent le mod√®le form√© par Keras pour cr√©er un nouveau brevet avec les param√®tres d'utilisateur et de <code>diversity</code> <code>num_words</code> .  La sortie de cette fonction, √† son tour, est envoy√©e au hasard aux <code>random.html</code> ou <code>seeded.html</code> pour s'afficher en tant que page Web. <br><br><h2>  Cr√©ation de pr√©dictions √† l'aide du mod√®le pr√©-form√© Keras </h2><br>  Le param√®tre param√®tre contient le mod√®le Keras pr√©-form√©, qui se charge comme suit: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load_keras_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Load in the pre-trained model"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> model model = load_model(<span class="hljs-string"><span class="hljs-string">'../models/train-embeddings-rnn.h5'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Required for model to work global graph graph = tf.get_default_graph() load_keras_model()</span></span></code> </pre> <br>  (Essentiellement, il existe une solution de contournement qui ressemble √† <code>tf.get_default_graph()</code> ) <br>  Je ne montrerai pas compl√®tement deux fonctions <code>util</code> (le code que vous trouverez <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/deployment/utils.py">ici</a> ), car tout ce que vous devez comprendre, c'est qu'elles stockent le mod√®le Keras d√©j√† form√© avec les param√®tres et font des pr√©dictions - des annotations de brevets. <br><br>  Ces deux fonctions renvoient une cha√Æne en Python avec du HTML format√©.  Cette ligne est envoy√©e √† un autre mod√®le, qui appara√Ætra comme une page Web.  Par exemple, <code>generate_random_start</code> renvoie du HTML format√© qui est envoy√© √† <code>random.html</code> : <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Random Starting Abstract <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/css/main.css"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shortcut icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/static/images/lstm.ico"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span>Home<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">header</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> {% block content %} {{input|safe}} {% endblock %} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Ici, nous utilisons √† nouveau le moteur de mod√®le <code>Jinja</code> pour afficher un fichier HTML format√©.  Puisque la cha√Æne Python est d√©j√† traduite en HTML, tout ce que nous devons faire pour l'afficher est d'utiliser <code>{{input|safe}}</code> (o√π <code>input</code> est une variable Python).  Ensuite, dans <code>main.css</code> nous pouvons ajouter des styles √† cette page, ainsi que d'autres pages HTML. <br><br><h3>  R√©sultat du travail </h3><br>  La fonction <code>generate_random_start</code> s√©lectionne une annotation de brevet al√©atoire comme s√©quence d'entr√©e et fait des pr√©dictions en fonction de celle-ci.  Il affiche ensuite la s√©quence d'entr√©e, la sortie g√©n√©r√©e par RNN et la sortie r√©elle: <br><br><img src="https://habrastorage.org/webt/z_/2y/6q/z_2y6q7q7xalfmwihsw3ohxwuza.png"><br>  <i>La sortie est bas√©e sur une s√©quence d'entr√©e al√©atoire.</i> <br><br>  La fonction <code>generate_from_seed</code> accepte la s√©quence initiale entr√©e par l'utilisateur et construit des pr√©visions √† partir de celle-ci.  La sortie est la suivante: <br><br><img src="https://habrastorage.org/webt/vd/4t/xw/vd4txwgqdyresaxrd5a0midnosm.png"><br>  <i>Sortie bas√©e sur la s√©quence d'entr√©e utilisateur.</i> <br><br>  Bien que les r√©sultats ne forment pas toujours des s√©quences logiques, ils montrent n√©anmoins que le r√©seau neuronal est familier avec les bases de la langue anglaise.  Elle a √©t√© form√©e pour pr√©dire chaque mot suivant sur la base des 50 pr√©c√©dents et ainsi s√©lectionner une annotation convaincante.  Selon le param√®tre de <code>diversity</code> , la sortie peut √™tre compl√®tement al√©atoire ou cyclique. <br><br><h3>  Lancement de l'application </h3><br>  Pour d√©marrer l'application par vous-m√™me, il vous suffit de t√©l√©charger le r√©f√©rentiel, acc√©dez au r√©pertoire o√π se trouve le d√©ploiement et entrez <code>run_keras_server.py</code> .  L'application sera disponible sur <code>localhost:10000</code> . <br><br>  Selon la configuration de votre r√©seau Wi-Fi domestique, vous devriez pouvoir acc√©der √† l'application depuis n'importe quel ordinateur du r√©seau en utilisant votre adresse IP. <br><br><h3>  Prochaines √©tapes </h3><br>  L'application Web ex√©cut√©e sur votre ordinateur personnel est id√©ale pour partager avec vos amis et votre famille.  Cependant, je ne recommande certainement pas de l'ouvrir √† tout le monde sur votre r√©seau domestique.  Plus tard, nous apprendrons comment d√©ployer l'application sur <a href="https://towardsdatascience.com/deploying-keras-deep-learning-models-with-flask-5da4181436a2">AWS EC2</a> et enfin la montrer au monde. <br><br>  Pour am√©liorer l'application, vous pouvez modifier les styles ( <a href="">dans main.css</a> ) et, √©ventuellement, ajouter des param√®tres suppl√©mentaires, tels que la possibilit√© de s√©lectionner un <a href="https://github.com/WillKoehrsen/recurrent-neural-networks/tree/master/models">r√©seau</a> pr√©-form√©.  La grande chose au sujet des projets personnels est que vous pouvez les d√©velopper aussi longtemps que vous le souhaitez.  Si vous souhaitez jouer avec l'application, t√©l√©chargez le <a href="https://github.com/WillKoehrsen/recurrent-neural-networks">r√©f√©rentiel</a> et commencez. <br><br><img src="https://habrastorage.org/webt/hu/z9/up/huz9upmw2zstf5wdojoflzsrxey.gif"><br><br><h2>  Conclusion </h2><br>  Dans cet article, nous avons appris √† d√©ployer un mod√®le d'apprentissage approfondi pr√©-form√© Keras en tant qu'application Web.  Cela a n√©cessit√© l'int√©gration d'un certain nombre de technologies diff√©rentes, y compris les r√©seaux de neurones r√©currents, les applications Web, les mod√®les, HTML, CSS et, bien s√ªr, <a href="https://www.python.org/">Python</a> . <br><br>  Bien qu'il s'agisse d'une application de base, elle montre que vous pouvez cr√©er des applications Web en utilisant l'apprentissage en profondeur avec relativement peu d'effort.  Peu de gens peuvent dire qu'ils ont pu d√©ployer un mod√®le d'apprentissage en profondeur sous la forme d'une application Web, mais si vous suivez les instructions de cet article, vous pouvez en devenir un! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr477402/">https://habr.com/ru/post/fr477402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr477388/index.html">NILFS2 - syst√®me de fichiers pare-balles pour / home</a></li>
<li><a href="../fr477390/index.html">D√©bogage des retards r√©seau dans Kubernetes</a></li>
<li><a href="../fr477392/index.html">Microphone ouvert: backend. Nous invitons des conf√©renciers</a></li>
<li><a href="../fr477396/index.html">Comment s'inscrire √† un cours et ... aller jusqu'au bout</a></li>
<li><a href="../fr477400/index.html">A propos du m√©tier de chef de produit: comment atteindre l'id√©al?</a></li>
<li><a href="../fr477404/index.html">Le probl√®me de la cr√©ation et de la suppression fr√©quentes d'objets en C ++</a></li>
<li><a href="../fr477406/index.html">Support technique et support. Grande recherche sur le march√© du travail et les salaires. Qu'est-ce qui a chang√© en 2 ans?</a></li>
<li><a href="../fr477408/index.html">Tutoriel JavaFX: dispositions avanc√©es</a></li>
<li><a href="../fr477414/index.html">Ing√©nieur de donn√©es - La profession la plus sexy du 21e si√®cle</a></li>
<li><a href="../fr477416/index.html">Quand est-il dangereux de hacher</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>