<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍜 🏇 🍌 Membangun paket RPM untuk Rosa Linux dalam praktiknya 📞 🧕🏻 🧖🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jika Anda telah menggunakan sistem operasi Linux untuk waktu yang lama dan bahkan tahu sedikit tentang pemrograman, cepat atau lambat Anda mungkin per...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Membangun paket RPM untuk Rosa Linux dalam praktiknya</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464993/"><p>  Jika Anda telah menggunakan sistem operasi Linux untuk waktu yang lama dan bahkan tahu sedikit tentang pemrograman, cepat atau lambat Anda mungkin perlu mengkompilasi program dari kode sumber.  Mungkin program yang diinginkan tidak akan berada dalam repositori distribusi.  Atau program ini memiliki versi lama di repositori ini, dan Anda memerlukan yang terbaru.  Atau mungkin Anda membuat program baru dan ingin membaginya dengan pengguna lain. <br></p><br><p>  Tentu saja, Anda dapat menginstal program sesuai dengan instruksi yang disertakan dengan kode sumber.  Tetapi kemudian Anda perlu mengelola file program secara manual dan memonitor dependensinya.  Jauh lebih baik untuk membangun sebuah paket dengan program dan menggunakan manajer aplikasi yang dibangun ke dalam sistem operasi. <br></p><br><p>  Saya harap artikel ini membantu Anda dengan cepat mengetahui cara membangun paket RPM untuk <em>Rosa Linux</em> atau untuk distribusi lain yang menggunakan manajer paket RPM (Mandriva, RedHat).  Atau setidaknya beri tahu saya di mana mencari informasi. <br></p><br><p>  Di sini saya akan menunjukkan cara membuat paket RPM di komputer lokal saya, menggunakan contoh sederhana.  Kami akan membangun program <em>xkb-switch</em> di <em>sistem</em> operasi <em>Rosa Linux</em> .  Kami akan mengambil kode sumber program dari <em>GitHub</em> . <br></p><br><br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Artikel ini dibagi menjadi banyak bagian pendek, sehingga daftar isi berada di bawah spoiler</b> <div class="spoiler_text"><h2>  Daftar isi </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sedikit tentang Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sedikit tentang xkb-switch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Menyiapkan, menyelesaikan, memeriksa program</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Memeriksa kode sumber tanpa profil Anda di GitHub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Verifikasi dengan menyimpan proyek ke profil GitHub Anda</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat tambalan</a> </li></ul><br></li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Persiapkan "tempat kerja" untuk membuat paket</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mari kita mulai membuat file spesifikasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sedikit tentang sintaks file spesifikasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Header file spesifikasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Persiapan sumber</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kompilasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Instalasi</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengepakan file</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Apa itu rpmlint</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jenis Paket RPM untuk Rosa Linux</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Hasil kami</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Jika Anda perlu membagi paket menjadi beberapa bagian</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tambahkan beberapa makro</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ubah judulnya sedikit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tentukan paket perpustakaan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tentukan file untuk paket</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Memecahkan Masalah Tambahan</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kesimpulan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tim utama</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Perintah yang berguna untuk membangun sebuah paket</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Memeriksa paket yang sudah selesai</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tautan yang bermanfaat (sumber utama)</a> </li></ul><br></div></div><br><br><a name="foreword"></a><br><h2>  Sedikit tentang Rosa Linux </h2><br><p>  <em>Rosa Linux</em> adalah distribusi yang dibuat dan didukung oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pengembang Rusia</a> .  Ini didasarkan pada <em>Mandriva</em> , tetapi dengan beberapa fitur.  Saya menggunakan versi 32-bit dari <em>Rosa Fresh R8</em> , yang dirilis pada tahun 2014.  Sekarang versi <em>R8</em> tidak lagi didukung oleh pengembang (repositori untuk itu tidak diperbarui), tetapi berfungsi dengan baik di laptop saya, jadi saya tidak ingin menginstal versi baru. <br></p><br><p> <em>Rosa Fresh R8</em> Menggunakan desktop <em>KDE4</em> .  Semua versi paket distribusi menggunakan manajer <code>rpm</code> dan <code>urpm</code> untuk mengelola paket dengan aplikasi, dan perintah yang sesuai adalah <code>rpm</code> , <code>urpmi</code> , <code>urpme</code> , <code>urpmq</code> , <code>urpmf</code> . <br></p><br><p>  Prinsip-prinsip pembangunan paket perangkat lunak biasanya jarang diubah dalam keluarga distribusi Linux yang sama.  Oleh karena itu, apa yang dijelaskan dalam artikel ini harus berfungsi di semua versi distribusi <em>Rosa</em> . <br></p><br><p>  Membangun paket pada Rosa Linux sedikit lebih sederhana daripada pada beberapa distribusi berbasis <em>RPM</em> lainnya.  Beberapa poin otomatis dan tidak perlu dikonfigurasi. <br></p><br><br><a name="foreword-xkb-switch"></a><br><h2>  Sedikit tentang xkb-switch </h2><br><p>  Saya menyukai gagasan menggunakan plugin untuk editor teks Vim - <em>xkbswitch</em> , tentang yang ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel tentang Habré</a> .  Secara otomatis beralih tata letak keyboard ke Bahasa Inggris ketika Anda keluar dari mode input, dan sebaliknya - ke yang mana teks dimasukkan terakhir kali - jika Anda memasuki mode input lagi.  Agar plugin ini berfungsi, Anda memerlukan program <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">xkb-switch</a> , yang memungkinkan Anda untuk mengubah tata letak keyboard dari baris perintah dan dari plugin untuk editor <em>Vim</em> .  Program ini tidak ada dalam repositori <em>Rosa Linux R8</em> (dan kemungkinan besar tidak ada yang akan menambahkannya, karena distribusinya sudah tua, dan program <em>xkb-switch</em> tidak terlalu populer). <br></p><br><br><a name="test_program"></a><br><h2>  Menyiapkan, menyelesaikan, memeriksa program </h2><br><p>  Seringkali perlu untuk mengkonfigurasi kompilasi program untuk bekerja dengan benar dalam distribusi tertentu atau bahkan untuk sistem tertentu.  Kebetulan sebuah program perlu dibangun dengan opsi lain atau dengan dukungan beberapa driver khusus.  Atau mungkin Anda ingin memperbaiki kesalahan dalam kode program atau hanya memeriksa apakah itu berfungsi.  Untuk melakukan ini, lebih baik menyalin kode sumber ke komputer Anda sebelum membangun paket RPM, cobalah untuk mengkompilasinya dan memeriksa cara kerja program yang dikompilasi. <br></p><br><p>  Jika Anda yakin tidak perlu mengubah file proyek, maka Anda dapat menggunakan kode sumber asli dari situs web proyek dan segera melanjutkan untuk membangun paket.  Tetapi jika Anda perlu mengubah pengaturan kompilasi, biasanya jauh lebih mudah untuk mengubah file di folder sumber (yang disebut <em>makefile</em> ) daripada kemudian berurusan dengan opsi untuk perintah kompilasi dan perangkat makro internal untuk file spesifikasi. <br></p><br><br><a name="test_program-local"></a><br><h3>  Memeriksa kode sumber tanpa profil Anda di GitHub </h3><br><p>  Jika Anda memutuskan untuk bekerja dengan kode sumber atau pengaturan kompilasi proyek, tetapi Anda tidak memiliki profil Anda sendiri di GitHub atau tidak ingin menggunakannya, Anda dapat mengunduh dan membuka zip kode sumbernya.  Dalam kasus kami, ini mungkin terlihat seperti ini (saya menggunakan folder <code>~/Projects/cpp</code> untuk kode sumber <em>C ++</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Ini akan membuat folder <code>~/Projects/cpp/xkb-switch</code> berisi kode sumber.  Tentu saja, alih-alih menggunakan <code>git</code> Anda dapat mengunduh arsip dengan program dan unzip. <br></p><br><p>  Dari file <code>README.md</code> di folder proyek, mudah ditebak bahwa utilitas <code>cmake</code> digunakan untuk membangun program.  Oleh karena itu, jika Anda perlu mengubah pengaturan kompilasi, dalam kasus kami mereka berada di file <code>CMakeLists.txt</code> .  Dan kami hanya mencoba untuk mengkompilasi program dan memeriksa apakah itu berfungsi.  Perintah apa yang perlu Anda gunakan untuk ini ditulis dalam file <code>README.md</code> sama di root proyek. <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> xkb-switch mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make ./xkb-switch <span class="hljs-comment"><span class="hljs-comment">#         ./xkb-switch -l #       ./xkb-switch -s ru #       (  )</span></span></code> </pre><br><br><p>  Setelah itu, untuk menggunakan proyek yang diubah, Anda harus menghapus atau menghapus folder <code>build</code> dari proyek dan mengemas kode sumber ke dalam arsip.  Mungkin terlihat seperti ini: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/xkb-switch rm -rf ./build <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp zip -r xkb-switch.zip xkb-switch</code> </pre><br><br><p>  File <code>xkb-switch.zip</code> kemudian perlu digunakan untuk membangun paket. <br></p><br><br><a name="test_program-github"></a><br><h3>  Verifikasi dengan menyimpan proyek ke profil GitHub Anda </h3><br><p>  Saya berasumsi bahwa siapa pun yang membaca bagian ini setidaknya sedikit terbiasa dengan bekerja dengan <em>git</em> dan telah membuat profil di <em>GitHub</em> .  Saya pikir metode ini adalah yang terbaik, sehingga sisa artikel akan menyiratkan bahwa itu digunakan, kecuali dinyatakan sebaliknya. <br></p><br><p>  Pertama, Anda perlu mem-fork proyek asli ke dalam <em>GitHub</em> Anda.  Setelah itu, seperti pada metode sebelumnya, kami mengkloning proyek ke komputer kami, tetapi dari repositori kami (dalam kasus saya, nama pengguna adalah <em>alexandersolovyov</em> ): <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/alexandersolovyov/xkb-switch.git</code> </pre><br><br><p>  Untuk menambahkan perubahan, lebih baik menggunakan cabang baru.  Kemudian, jika diinginkan, dimungkinkan untuk menggunakan versi program yang berbeda.  Dan juga dimungkinkan untuk mengusulkan perubahan pada penulis proyek menggunakan permintaan-tarik.  Misalnya, jika Anda memutuskan untuk sedikit memperbaiki file <code>CMakeLists.txt</code> , sebelum itu Anda perlu membuat cabang baru dengan: <br></p><br><br><pre> <code class="bash hljs">git branch cmake_corrections</code> </pre><br><br><p>  Setelah perubahan dibuat, dicentang dan ditambahkan ke cabang (menggunakan <code>git commit -am " "</code> ), Anda dapat menambahkan cabang baru ke GitHub Anda: <br></p><br><br><pre> <code class="bash hljs">git push origin cmake_corrections</code> </pre><br><br><p>  Setelah itu, Anda dapat membuat permintaan tarik, jika perlu. <br></p><br><p>  Anda dapat membuat tautan ke repositori asli: <br></p><br><br><pre> <code class="bash hljs">git remote add ierton https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p>  Dan kemudian perbarui cabang utama repositori Anda sehingga cocok dengan aslinya: <br></p><br><br><pre> <code class="bash hljs">git pull ierton master</code> </pre><br><br><p>  Kode program yang terkait dengan cabang yang dikoreksi dapat digunakan saat membangun RPM.  Untuk melakukan ini, Anda harus menentukan alamat arsip dalam formulir di file spesifikasi: <br></p><br><br><pre> <code class="plaintext hljs">Source0: https://github.com/-/-/archive/---.zip</code> </pre><br><br><p>  Tapi, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">seperti yang diminta pengguna specblog</a> , ini sebenarnya tidak terjadi.  Lebih baik menyampaikan perubahan Anda dalam bentuk tambalan.  Untuk melakukan ini, Anda perlu membuat file tambalan dari perubahan di cabang Anda dan menyalinnya ke folder sumber untuk membangun paket ( <code>~/rpmbuild/SOURCES/</code> ).  Maka Anda harus menentukannya dalam file spesifikasi.  Kami akan mempertimbangkan ini nanti, tetapi jika Anda mau, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda bisa membacanya di sini</a> .  Jika Anda tidak tahu cara membuat tambalan, Anda bisa melihat di bawah spoiler. <br></p><br><br><a name="test_program-github-patches"></a><br><div class="spoiler">  <b class="spoiler_title">Cara membuat tambalan menggunakan git</b> <div class="spoiler_text"><h4>  Membuat tambalan </h4><br><p>  <em>Tambalan</em> , mereka <em>Tambalan</em> - ini adalah file di mana perubahan dicatat dalam kode sumber program.  Mereka digunakan sebagai alternatif untuk perintah <code>git pull</code> dan <code>git push</code> untuk komunikasi antara repositori kode lokal jika tidak nyaman untuk "menarik" perubahan dari repositori jarak jauh, atau sejarah perubahan proyek dan prinsip-prinsip bekerja dengannya sedemikian rupa sehingga lebih baik menggunakan tambalan. <br></p><br><br><p>  Mari kita bayangkan bahwa kita perlu melakukan perubahan pada file <code>CMakeLists.txt</code> .  Pertama, Anda perlu melakukan semuanya seperti yang dijelaskan di atas: cabang <em>master</em> di repositori GitHub kami harus sesuai dengan cabang utama dari proyek asli, dan untuk perubahan Anda, Anda perlu menggunakan cabang <em>cmake_corrections</em> .  Maka Anda harus pergi ke cabang ini, melakukan perubahan yang diperlukan dan menyimpannya di <em>git</em> menggunakan commit. <br></p><br><p>  Sekarang Anda perlu menyimpan perubahan sebagai tambalan file ke folder <code>~/rpmbuild/SOURCES</code> (jika Anda tidak menggunakan Rosa Linux, jalur ke folder <code>SOURCES</code> mungkin berbeda).  Sebagai contoh, ini (maksud saya kita berada di folder proyek - misalnya, <code>~/Projects/cpp/xkb-switch</code> - dan pada cabang <code>cmake_corrections</code> ): <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES origin/master</code> </pre><br><p>  Perintah <code>git format-patch</code> membuat satu file <code>git format-patch</code> untuk setiap komit.  Dalam formulir ini, itu akan membuat tambalan mulai dari komit yang ditentukan oleh argumen terakhir, dan berakhir dengan komit terakhir dari cabang saat ini.  Anda dapat menentukan komit dengan cara apa pun: di awal hash, menggunakan pointer <em>HEAD</em> atau nama cabang, yang sekarang menunjukkan komit yang diinginkan.  Hal utama adalah bahwa salah satu komit yang terlihat ketika <code>git log</code> dijalankan diambil sebagai permulaan.  Artinya, Anda tidak bisa mulai membuat tambalan dari komit yang ada di cabang lain. <br></p><br><p>  Dan Anda dapat mengingat (atau melihat) berapa banyak komit yang kita cabut dari cabang utama, dan membuat tambalan untuk sejumlah komit kembali.  Misalnya, jika kita membuat dua komit, perintahnya adalah: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES -2</code> </pre><br><p>  Di sini jumlah komit diatur menggunakan <code>-2</code> .  Anda dapat menentukan jumlah mereka sebagai ganti angka ini. <br></p><br><p>  Anda dapat menentukan rentang komit dari mana tambalan harus dibuat dengan menempatkan dua poin antara tautan ke komit awal dan akhir: <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES master..cmake_corrections</code> </pre><br><p>  Nama setiap file tambalan terdiri dari nomor seri dan baris pertama dari komentar komit.  Oleh karena itu, lebih baik untuk mengganti nama setiap file sehingga deskripsi tambalan lebih singkat dan jelas menjelaskan esensinya.  Misalnya, seperti ini: <br></p><br><pre> <code class="bash hljs">mv 0001-Return-memory-allocated-by-XkbRf-getNamesProp()-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-tmp.patch 001-Fix-memory-leak.patch</code> </pre><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">konvensi penamaan untuk tambalan dalam artikel tentang sintaks dari file spesifikasi</a> merekomendasikan menambahkan <em>package_name-version-rosa-</em> sebelum deskripsi dari masing-masing file tambalan.  Mungkin ini praktik yang baik jika Anda mengirim tambalan melalui email, tetapi tidak untuk membangun paket.  Kami membuat paket di komputer kami, jadi lebih baik mengosongkan folder <code>~/rpmbuild/SOURCES</code> setiap kali sebelum <code>~/rpmbuild/SOURCES</code> paket dengan program lain atau paket versi baru. <br></p><br><p>  Sekarang jika Anda perlu memperbarui cabang repositori utama ( <em>master</em> ) agar sesuai dengan aslinya, maka setelah itu cabang perubahan ( <em>cmake_corrections</em> ) perlu diperbarui menggunakan perintah <code>git rebase</code> .  Anda <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dapat melihat</a> bagaimana melakukan ini di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Setelah itu, tambalan perlu dibuat ulang. <br></p><br></div></div><br><br><a name="prepare"></a><br><h2>  Persiapkan "tempat kerja" untuk membuat paket </h2><br><p>  Pertama, Anda perlu membuat struktur direktori.  Semua perakitan terjadi di folder <code>rpmbuild</code> di folder rumah <code>rpmbuild</code> .  Buat struktur direktori awal dan buka folder untuk file spesifikasi: <br></p><br><br><pre> <code class="bash hljs">mkdir -p ~/rpmbuild/SPECS &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/SPECS</code> </pre><br><br><p>  Untuk Rosa Linux, ini sudah cukup: folder yang tersisa akan dibuat secara otomatis. <br></p><br><p>  Distribusi lain dapat menggunakan lokasi file yang berbeda untuk membangun paket.  Dan mungkin Anda harus membuat seluruh hierarki folder secara manual.  Cari informasi untuk distribusi Anda jika Anda tidak menggunakan Rosa Linux.  Misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini mungkin terlihat seperti ini di Red Hat</a> . <br></p><br><p>  Jika paket dibangun dengan kesalahan, maka semua file yang dibuat oleh perintah <code>rpmbuild</code> tidak dihapus - sama seperti dengan build yang berhasil.  Kami akan mencoba mengumpulkan paket berkali-kali, dan file yang tersisa setelah terakhir kali akan mengganggu.  Karena itu, lebih baik membuat skrip sederhana yang akan membantu menghapusnya dengan cepat.  Buat file cleanup.sh dan letakkan di <code>~/rpmbuild/SPECS</code> .  Berikut isinya: <br></p><br><br><pre> <code class="bash hljs">!<span class="hljs-comment"><span class="hljs-comment">#/bin/sh rm -rf ~/rpmbuild/BUILD/* rm -rf ~/rpmbuild/BUILDROOT/* rm -rf ~/rpmbuild/RPMS/* rm -rf ~/rpmbuild/SRPMS/*</span></span></code> </pre><br><br><p>  Tentu saja, lebih baik menambahkan hak eksekusi untuk itu menggunakan perintah <code>chmod u+x cleanup.sh</code> . <br></p><br><p>  Jika Anda ingin mengumpulkan paket dari file yang ada di komputer lokal - jika Anda tidak menggunakan <em>GitHub</em> dan membuat perubahan pada file proyek, atau ingin membuat paket dari program Anda sendiri yang hanya disimpan di komputer Anda - Anda perlu mengemas proyek ke dalam arsip ( mis. <code>.zip</code> , <code>.tar</code> atau <code>.tar.gz</code> ) dan letakkan di folder <code>SOURCES</code> .  Misalnya, seperti ini: <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/ zip -r xkb-switch.zip xkb-switch mkdir -p ~/rpmbuild/SOURCES cp xkb-switch.zip ~/rpmbuild/SOURCES/</code> </pre><br><br><p>  Jika setelah membuat program Anda ingin membuat yang lain atau yang sama, tetapi versi yang berbeda, Anda harus menghapus semua file dari folder <code>~/rpmbuild/SOURCES</code> , dan setelah itu salin arsip Anda di sana (jika Anda tidak mengunduhnya dari <em>GitHub</em> ) dan menambal file (jika digunakan).  Jika tidak, file arsip, kemungkinan besar, tidak akan diunduh dari <em>GitHub</em> (mengapa - lihat nanti), dan juga akan sulit untuk mengetahui file tambalan mana yang termasuk dalam program mana. <br></p><br><br><a name="specfile_start"></a><br><h2>  Mari kita mulai membuat file spesifikasi </h2><br><p>  Dasar untuk membangun paket RPM adalah <em>file speck yang</em> disebut.  File ini berisi instruksi untuk program <code>rpmbuild</code> (atau lebih tepatnya <code>rpm</code> ) yang diperlukan untuk membangun paket. <br></p><br><p>  Buat file <code>xkb-switch.spec</code> di folder <code>~/rpmbuild/SPECS/</code> .  Cara termudah untuk memulai adalah dengan templat yang dapat ditemukan di situs web <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">File Templat Templat</a> . <br></p><br><p>  Dari <code>README</code> pada halaman proyek <em>switch xkb</em> , diketahui bahwa program dikompilasi menggunakan utilitas <code>cmake</code> .  Oleh karena itu, kami akan memilih <strong>file Spec untuk program yang dibangun menggunakan CMake</strong> dan menyalin seluruh templat ke file spec kami.  Tentu saja, untuk merakit paket RPM kami dengan benar, template ini perlu banyak diubah, yang akan kami lakukan. <br></p><br><br><a name="specfile_syntax"></a><br><h2>  Sedikit tentang sintaks file spesifikasi </h2><br><ul><li>  Sintaks file spesifikasi memungkinkan Anda untuk menambahkan komentar gaya bash. <br></li><li>  Anda bisa menggunakan spasi sebagai spasi di antara nilai-nilai pada baris yang sama untuk membuat tampilan kolom genap, tetapi dokumentasi sangat menganjurkan menggunakan karakter tab (satu atau dua selama diperlukan untuk menjaga kolom tetap rata).  <strong>Catatan:</strong> dalam semua contoh kode dalam artikel ini, hanya spasi yang digunakan, jadi lebih baik untuk tidak menyalin semua teks dari sini ke file spesifikasi Anda, tetapi cetak sendiri. <br></li><li>  Bidang opsi terdiri dari nama opsi khusus dengan titik dua dan nilai berikutnya melalui tab (atau spasi).  Kasus karakter dalam nama bidang tidak masalah.  Sebagai contoh: <br><pre> <code class="plaintext hljs"> Name: xkb-switch</code> </pre><br></li><li>  Jika kata tersebut didahului dengan simbol <code>%</code> (misalnya, <code>%description</code> ), maka ini adalah kata kunci khusus.  Ini bisa berupa perintah, makro, atau panggilan skrip.  Kemudian setelah itu parameter yang digunakannya dapat ditunjukkan.  Dan ada kata kunci yang menunjukkan awal dari blok perintah atau opsi.  Kemudian, parameter dapat ditunjukkan di sebelahnya, dan pada baris berikutnya harus ada perintah atau daftar opsi yang saya jelaskan di paragraf sebelumnya.  Setelah blok seperti itu, sebuah baris kosong harus dibiarkan. <br></li><li>  Untuk menggunakan nilai konstanta, Anda harus memasukkan konstruksi form <code>%{_}</code> .  Nilainya dapat ditentukan sebelumnya, atau dapat ditentukan dengan opsi (misalnya, <code>Name: xkb-switch</code> ) atau menggunakan kata kunci <code>%define</code> .  Semua konstanta ini juga dianggap makro.  Penggunaannya akan dibahas lebih rinci di bawah ini. <br></li></ul><br><br><a name="specfile_header"></a><br><h2>  Header file spesifikasi </h2><br><p>  Dalam file spesifikasi, tajuk selalu ditulis terlebih dahulu.  Ini adalah daftar opsi yang berlaku untuk paket RPM utama.  Ketika paket sudah siap, hampir semua informasi ini akan ditampilkan saat melihat deskripsinya.  Inilah yang ditunjukkan oleh masing-masing garis: <br></p><br><br>  <b>Ringkasan:</b> <br>  Deskripsi singkat tentang paket.  Saya melihat deskripsi dalam file <code>README.md</code> di proyek <em>xkb-switch</em> : <code>Query and change XKB layout state</code> . <br><br>  <b>Nama:</b> <br>  Nama paket.  Dalam kasus kami, ini adalah <code>xkb-switch</code> . <br><br>  <b>Versi:</b> <br>  Versi program.  Untuk mengetahuinya, yang terbaik adalah melihat file <code>CMakeLists.txt</code> di folder root proyek.  Tentu saja, Anda perlu mengambil file dari salinan proyek yang akan digunakan untuk perakitan.  Jika Anda menggunakan proyek asli, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda dapat membuka file langsung di halaman GitHub-nya</a> .  Seperti yang Anda lihat, versi ini terdiri dari <code>MAJOR_VERSION</code> , <code>MINOR_VERSION</code> , dan <code>RELEASE_VERSION</code> .  Saya menggunakan program versi <code>1.6.0</code> . <br><br>  <b>Rilis:</b> <br>  Nomor versi paket itu sendiri.  Menampilkan waktu paket dengan program dengan versi yang sama sedang dirakit.  Dalam kasus kami, ini adalah "1", karena tidak ada yang pernah membuat program versi ini.  Dalam kasus yang ideal, jika kami sudah mencoba untuk mengkompilasi paket dan perakitan mencapai akhir (bahkan jika ada kesalahan), maka setelah setiap upaya baru Anda perlu menambah nomor ini dengan 1 dan pada saat yang sama jangan menghapus paket-paket lama yang dirakit dari <code>rpmbuild/SRPMS</code> <code>rpmbuild/RPMS</code> dan <code>rpmbuild/SRPMS</code> : Selanjutnya, paket baru dengan nomor build baru akan dibuat.  Mungkin ini harus dilakukan jika Anda menggunakan server khusus untuk perakitan.  Kami menggunakan komputer kami dan sebagai gantinya kami akan membersihkan folder.  Jika sebuah paket dengan program versi ini sudah ada dalam repositori distribusi Linux, tetapi Anda mengkompilasi dengan pengaturan lain, maka lebih baik untuk menentukan nomor rilis 1 lebih dari paket itu. <br><br>  <b>Lisensi:</b> <br>  Nama pendek lisensi tempat program ini didistribusikan.  Menurut aturan Rosa Linux, Anda hanya dapat membangun paket dengan lisensi yang memungkinkan distribusi gratis.  <code>README.md</code> dapat mengetahui dari file <code>README.md</code> bahwa lisensinya adalah <em>GNU GPLv3</em> .  Jadi kami menulis: <code>GPLv3+</code> . <br><br>  <b>Kelompok:</b> <br>  Grup atau kategori tempat program tersebut berada.  Dengan menggunakan grup ini, program diurutkan dalam menu peluncuran aplikasi dan di window program manager (“Tambah atau Hapus Program”).  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Daftar grup untuk Rosa Linux dapat ditemukan di sini</a> .  Saya pikir <code>Development\X11</code> adalah yang terbaik bagi kami, karena program ini terkait dengan X11 dan terutama diperlukan untuk membuat skrip dan plugin untuk Vim. <br><br>  <b>URL:</b> <br>  Alamat internet tempat Anda dapat mengunduh kode sumber asli program.  Ini akan ditentukan saat melihat informasi paket RPM.  Item ini opsional, tetapi kami akan menunjukkan: <code>https://github.com/ierton/xkb-switch</code> <br><br>  <b>Sumber0:</b> <br>  Nama file arsip yang berisi kode sumber, atau alamat Internet tempat file itu dapat diunduh.  Jika Anda menentukan alamat di Internet, maka selama pembangunan pertama file akan diunduh ke <code>~/rpmbuild/SOURCES/</code> .  Jika file seperti itu sudah ada, itu tidak akan lagi diunduh, yaitu, program <code>rpmbuild</code> hanya akan menggunakan nama file yang ditentukan di akhir URL ini.  Anda dapat menentukan hanya nama file, tetapi kemudian harus ditempatkan di folder <code>~/rpmbuild/SOURCES/</code> secara manual.  Lebih baik memberikan alamat salinan proyek Anda di GitHub.  Saya menggunakan file <code>https://github.com/alexandersolovyov/xkb-switch/archive/master.zip</code> .  Anda dapat menentukan beberapa sumber berbeda untuk mengumpulkan sumber dari beberapa arsip dengan bantuan satu file speck.  Kemudian, atas nama opsi untuk menambahkan setiap arsip berikutnya, jumlahnya harus bertambah ( <code>Source2</code> , <code>Source2</code> , dll.).  Alamat file ini tidak terlihat saat melihat informasi paket RPM. <br><br>  <b>Patch0:</b> <br>  Opsi ini tidak ada dalam file templat.  Mungkin berguna jika Anda memutuskan untuk mentransfer perubahan Anda dalam file proyek program dalam bentuk tambalan.  Adapun opsi <code>Source0</code> , setiap file harus ditunjukkan pada baris yang terpisah, dan jumlah di akhir nama opsi harus bertambah setiap kali.  File tambalan harus berada di folder <code>~/rpmbuild/SOURCES</code> (di sebelah arsip sumber yang diunduh).  Nama setiap file harus ditulis tanpa jalur ke sana.  Tidak perlu menentukan semua file tambalan di sini - hanya yang ingin Anda terapkan yang dapat digunakan. <br><br>  <b>BuildRequires:</b> <br>  Paket diperlukan untuk membangun program.  Templat <code>cmake</code> .  File <code>CMakeLists.txt</code> menunjukkan bahwa versi minimum CMake untuk perakitan tidak boleh lebih rendah dari <em>2,6</em> , jadi lebih baik untuk menentukan <code>cmake &gt;= 2.6</code> .  Anda dapat menambahkan paket lain, masing-masing pada baris yang berbeda, menggunakan opsi <code>BuildRequires:</code> terpisah.  Daftar paket yang dibutuhkan untuk perakitan dapat ditemukan dengan membaca <code>README</code> proyek dan dengan cermat melihat file <code>CMakeLists.txt</code> (terutama <code>FIND_PACKAGE</code> , <code>TARGET_LINK_LIBRARY</code> , <code>FIND_PROGRAM</code> ).  Maka Anda perlu menemukan nama paket yang benar di repositori menggunakan perintah <code>urpmq -a __</code> .  Dalam kasus kami, file pengaturan kompilasi ( <code>CMakeLists.txt</code> ) sudah berisi baris yang memeriksa keberadaan paket yang diperlukan dalam sistem.  Tetapi lebih baik untuk menentukan seluruh daftar di sini juga: <br><pre> <code class="plaintext hljs"># CMake  2.6   BuildRequires: cmake &gt;= 2.6 #  C/C++ BuildRequires: gcc #    libxkbfile BuildRequires: libxkbfile-devel #   X11   libxkbfile, #  libx11-devel   . #    man: BuildRequires: xz</code> </pre><br><br>  <b>Membutuhkan:, Menyediakan:</b> <br>  Opsi-opsi ini tidak ada dalam sampel, tetapi kadang-kadang bisa berguna.  Mereka membangun dependensi antar paket.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Opsi ini </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menentukan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fitur yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disediakan oleh paket yang sedang dibangun. Hal ini dapat nama file bahasa sundulan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , atau dinamis nama link library, atau fungsi khusus. Dan opsi </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menunjukkan </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemampuan</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> paket mana yang tergantung pada paket tersebut. Package Manager ( </font></font><code>rpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>urpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, atau orang lain yang menggunakan distribusi), ketika mencari dependensi mencari ini </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peluang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> daripada nama paket. Oleh karena itu, </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lebih baik untuk menunjukkan versi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peluang yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disediakan </font><font style="vertical-align: inherit;">, dan untuk </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peluang yang</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disediakan mana </font><font style="vertical-align: inherit;">yang cocok. Versi ditunjukkan dengan tanda </font></font><code>&gt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">,</font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, atau </font></font><code>&lt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, dikelilingi oleh spasi. Biasanya, semua opsi ditunjukkan terlebih dahulu </font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lalu - </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, satu nama fitur per baris - sama seperti untuk </font></font><code>BuildRequires:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Biasanya, ketika membangun paket di Rosa Linux, dependensi secara otomatis dikenali, dan opsi ini jarang perlu ditentukan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoReq:, AutoProv:</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jika Anda sedang </font><b><font style="vertical-align: inherit;">membangun sebuah</font></b><font style="vertical-align: inherit;"> program yang ditulis dalam bahasa yang membuat manajer </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> baru, atau yang berpemilik, dan dependensi tidak terdeteksi secara otomatis secara otomatis, Anda dapat menonaktifkan deteksi otomatis </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kemampuan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dengan </font></font><code>AutoProv: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) dan / atau </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ketergantungan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (dengan) bantuan </font></font><code>AutoReq: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% deskripsi</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blok ini bukan lagi bagian dari tajuk, tetapi terkait dengannya. </font><font style="vertical-align: inherit;">Dia akan menambahkan deskripsi lengkap program ke paket RPM. </font><font style="vertical-align: inherit;">Baris kosong harus ditinggalkan setelahnya. </font><font style="vertical-align: inherit;">Uraiannya mungkin sebagai berikut:</font></font><br><pre> <code class="plaintext hljs">%description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Baris dari template dimulai dengan </font></font><code>%files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan </font></font><code>%find_lang</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diperlukan hanya jika Anda membangun aplikasi dengan dukungan untuk beberapa bahasa, jadi hapuslah.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Selanjutnya, setelah membagi komentar-baris, diikuti oleh perintah dan makro yang harus diselesaikan sebelum mengemas file. </font><font style="vertical-align: inherit;">Semua perintah ini dibagi menjadi beberapa blok yang ditentukan menggunakan kata kunci khusus.</font></font></p><br><br><a name="prep"></a><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Persiapan sumber </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yang pertama adalah blok </font></font><code>%prep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yang menunjukkan perintah-perintah untuk persiapan kompilasi. </font><font style="vertical-align: inherit;">Di dalamnya ada perintah makro </font></font><code>%setup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Dia menjalankan skrip yang melakukan hal berikut:</font></font></p><br><br><ul><li>       ,      <code>SourceX:</code>    (  —  <code>Source0:</code> ).         ,    . <br></li><li>      <code>~/rpmbuild/SOURCES/</code> . <br></li><li>      <code>~/rpmbuild/BUILD/</code> . <br></li><li>      . <br></li></ul><br><br><p>   <code>-q</code> ,       . </p><br><p>     ,     <code>%prep</code> : </p><br><br><pre> <code class="bash hljs">rpmbuild -bp ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>rpmbuild</code> .       ,      <code>rpm</code>    : <code>rpmbuild</code>    ,      .           (   <code>root</code>    <code>sudo</code> ).    <code>rpmbuild</code>  ,  <code>man rpmbuild</code> .      ,       ,   , —  ,          <code>rpmbuild</code> . <br></p><br><p>      : <code>xkb-switch-1.6.0: No such file or directory</code> .    ,          <code>~/rpmbuild/BUILD/xkb-switch-1.6.0</code> ,  .   <br></p><br><br><pre> <code class="bash hljs">ls ~/rpmbuild/BUILD/</code> </pre><br><br><p> ,     <code>xkb-switch-master</code> .     <code>%setup</code>    <code>-n</code> .    <code>%prep</code>  -   : <br></p><br><br><pre> <code class="bash hljs">%prep %setup -q -n xkb-switch-master</code> </pre><br><br><p>    <code>~/rpmbuild/SPECS/cleanup.sh</code> ,    <code>BUILD</code> ,     ,   <code>%prep</code> .  ,     <code>exit 0</code> .  ,     . <br></p><br><p>          ,         .       <code>%prep</code> .       ,    ,      : <br></p><br><pre> <code class="plaintext hljs">%apply_patches</code> </pre><br><p>       <code>rpmbuild -bp xkb-switch.spec</code> .    —    . <br></p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  Maximum RPM</a> . <br></p><br><p>    . <br></p><br><br><a name="build"></a><br><h2>  </h2><br><p>      <code>%build</code> .   <code>README</code>  ,     <code>cmake ..</code>  <code>make</code> ,     -   .  :           ,     .    ,        <code>%build</code> : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bc ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>exit 0</code> :    . <br></p><br><p> ,         .     shell (  bash  zsh,     ).  <code>rpmbuild</code>      ,           .    shell    - —        . (    .) <br></p><br><p>     -  , ,  ,     <code>%build</code>  shell  . <br></p><br><p>     ,    ,   .      <code>cmake</code> , , ,        <code>%cmake</code>      -  ,      ,    .         (   — <code>CMakeLists.txt</code> ).             ,    . <br></p><br><br><a name="install"></a><br><h2>  Instalasi </h2><br><p> , <em></em> .   <code>%install</code>   ,               ,     ,    <code>~/rpmbuild/BUILDROOT/__-buildroot/</code> . <br></p><br><p>  <code>__</code>    ,     <code>Name:</code>   -,   ( <code>Version:</code>  -),   ( <code>Release:</code>  -),  ,     . <br></p><br><p>   <code>README</code>  ,     <code>make install</code> ,    <code>build</code>   .  - - <code>%makeinstall_std -C build</code>    ,   .       ( ,   ): <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bi ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>      ,       RPM.   -   ,     . <br></p><br><br><a name="packing"></a><br><h2>   </h2><br><p>         ,      -  .     ,     <code>~/rpmbild/BUILDROOT/</code> . ( , ,     <code>tree</code> ,  -      Linux.)  ,       ,       <code>.debug</code> .    , ,    :        . <br></p><br><p>  ,       ,   <code>%files</code>  -.   ,     ,      .  . <br></p><br><p>       <code>%files</code>  -.  ,    .   Rosa Linux       <code>%prep</code> (  -   ).   ,   ,     ,  ,        —   .          - (,    ,     ). <br></p><br><p>   <code>%files</code>    ,      RPM. ,     : <br></p><br><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz</code> </pre><br><br><p>         -.   , ,     <code>/usr/lib/rpm/macros</code> .  , <code>%{_bindir}</code>     , <code>%{_libdir}</code> —   ,  <code>%{_mandir}</code> —    man.   <code>%{name}</code>  <code>%{version}</code>    <code>Name:</code>  <code>Version:</code>   -. <br></p><br><p>     : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p> …   2   1 .    <code>rpmlint</code> ,      .  ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> Rpmlint Errors</a>  ,   : <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kesalahan: Versi dalam nama paket perpustakaan tidak ditentukan dengan benar. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: E: executable-in-library-package (Keburukan: 1) / usr / bin / xkb-switch`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kesalahan: paket perpustakaan berisi file yang dapat dieksekusi. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586: W: devel-file-in-non-devel-package / usr / lib / libxkbswitch.so`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Peringatan bahwa file </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">paket pengembangan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ditemukan dalam paket yang tidak dimaksudkan untuk pengembangan.</font></font><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apakah semuanya jelas? </font></font> Saya kira tidak.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mari kita lihat lebih dekat apa yang terjadi di sini. </font></font><br></p><br><br><a name="packing-rpmlint"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Apa itu rpmlint </font></font></h3><br><p>     Rosa Linux  <code>rpmbuild</code>   <code>rpmlint</code> ,    .  <code>rpmlint</code>    ,   ,      .   ,     Rosa Linux (  ,     <code>rpmlint</code> )     . <br></p><br><p>     ,     ,      .       <code>~/rpmbuild/RPMS/_/</code>         <code>rpmlint -i __</code> . <br></p><br><p> ,      RPM   - ,  ,    ,  ,      Rosa Linux,      <code>rpmlint -i __</code> . <br></p><br><br><a name="packing-package_types"></a><br><h3>   RPM  Rosa Linux </h3><br><p>   Rosa Linux   6 .   ,          . <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket yang dapat dieksekusi</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ini adalah biner. Ini hanya berisi file biner atau skrip yang ditujukan langsung untuk dieksekusi. File-file dari paket-paket ini paling sering dipasang di folder </font></font><code>/bin/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau di </font></font><code>/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mungkin juga berisi tautan - untuk kemungkinan memanggil program menggunakan beberapa nama berbeda. Nama paket sesuai dengan nama program. Paket-paket seperti itu seringkali tergantung pada perpustakaan. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Library</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Berisi file yang dikompilasi dari </font><b><font style="vertical-align: inherit;">library yang</font></b><font style="vertical-align: inherit;"> terhubung secara dinamis ("shared", "shared") yang digunakan oleh program. Biasanya ini adalah file perpustakaan itu sendiri, yang namanya berakhir dengan versi, dan tautan ke file ini, yang namanya berakhir dengan nomor versi pertama. Misalnya, untuk perpustakaan </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versi 1.0.2 itu akan menjadi file </font></font><code>libxkbfile.so.1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan tautan ke sana,</font></font><code>libxkbfile.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nama paket perpustakaan, di mana ia dikenali dalam repositori installer, diakhiri dengan nomor versi pertama dan dimulai dengan awalan </font></font><code>lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Perpustakaan memiliki </font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nama yang benar - </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ini disebabkan oleh fakta bahwa biasanya nomor versi pertama hanya berubah dengan perubahan pustaka yang tidak kompatibel, dan dengan demikian akan mungkin untuk menginstal beberapa paket dengan pustaka dari versi yang berbeda jika beberapa program menggunakan versi pustaka yang lama dan yang lain menggunakan versi yang lebih baru. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Paket untuk pengembang</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> File yang diperlukan untuk menyusun program yang menggunakan pustaka, tetapi tidak perlu untuk pekerjaan program yang sudah jadi. Untuk program </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sederhana </font><font style="vertical-align: inherit;">, ini adalah tautan ke file pustaka, tetapi tanpa versi dalam namanya (misalnya,</font></font><code>libxkbfile.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), serta file header (dengan ekstensi </font></font><code>.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). Nama paket berakhir dengan </font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, misalnya: </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Selama instalasi, selalu tergantung pada perpustakaan yang sesuai. Misalnya, paket </font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tergantung pada </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source Code</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rosa Linux repositori memiliki paket RPM yang berisi kode sumber untuk beberapa program - pada dasarnya hanya mereka yang </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">benar</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font><em><font style="vertical-align: inherit;">benar perlu</font></em><font style="vertical-align: inherit;"> dibangun kembali. Nama-nama paket ini diakhiri dengan </font></font><code>-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atau </font></font><code>-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(misalnya, </font></font><code>apache-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">selalu membuat paket seperti itu secara otomatis dan memasukkannya ke dalam </font></font><code>~/rpmbuild/SRPMS/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simbol debugging</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ini adalah informasi yang dapat digunakan untuk men-debug program yang sudah selesai. </font><font style="vertical-align: inherit;">Ini mengaitkan lokasi dalam file yang dikompilasi dengan kode sumber. </font><font style="vertical-align: inherit;">Paket-paket semacam itu </font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">secara otomatis </font><font style="vertical-align: inherit;">dibuat oleh tim </font><font style="vertical-align: inherit;">, sebuah akhiran ditetapkan untuk namanya </font></font><code>-debuginfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Saya tidak menemukan paket seperti itu di repositori Rosa Linux. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokumentasi</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rosa repositori Linux memiliki paket dokumentasi untuk berbagai program dan perpustakaan. </font><font style="vertical-align: inherit;">Saya (untuk saat ini) tidak tahu fitur membangun paket-paket seperti itu. </font><font style="vertical-align: inherit;">Nama-nama mereka biasanya berakhir di </font></font><code>doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: misalnya </font></font><code>libx11-doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>java-1.7.0-openjdk-javadoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Ngomong-ngomong, hampir semuanya dibuat dalam gaya situs web, dan untuk melihatnya, yang terbaik adalah membuka browser, pergi ke alamat </font></font><code>file:///usr/share/doc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan pilih folder dan file yang diinginkan.</font></font><br><br><br><br><a name="packing-result"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hasil kami </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Sekarang semuanya menjadi lebih jelas. </font></font><br></p><br><br><ul><li>    <code>xkb-switch</code>   <code>libxkbswitch.so</code> , ,  ,    <em>  </em> .   ,          : <code>xkb-switch.i586: W: devel-file-in-non-devel-package /usr/lib/libxkbswitch.so</code> . <br></li><li>     <em></em> ,      <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> .       ,       .  : <code>xkb-switch.i586: E: executable-in-library-package (Badness: 1) /usr/bin/xkb-switch</code> . <br></li><li>    ,          (1).   : <code>xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1</code> . <br></li></ul><br><br><p> ,  <code>rpmlint</code> ,     .          .   <em>xkb-switch</em> ,      <code>libxkbswitch.so.1.6.0</code>       ,        <em>Vim</em> .            <em>xkb-switch</em> ,          <em>C</em>  <em>C++</em> .  RPM-    . <br></p><br><p>       -: <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-   xkb-switch</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Summary: Query and change XKB layout state Name: xkb-switch Version: 1.6.0 Release: 1 License: GPLv3+ Group: Development/X11 URL: https://github.com/ierton/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley. %files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="subpackaging"></a><br><h2>       </h2><br><p>        — ,         .    ,  ,       <code>xkb-switch</code>  3 : <em></em> , <em></em>   <em></em> . : <br></p><br><br><ul><li>  <em></em>     <code>/usr/bin/xkb-switch</code>    <code>/usr/share/man/man1/xkb-switch.1.xz</code> , <br></li><li>  <em></em> —  <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <em> </em> — <code>/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       -.  ,   , <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">  - Maximum RPM</a> .     <a href=""> -  libxkbfile</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   Rosa Linux</a> . <br></p><br><p>    . <br></p><br><br><a name="subpackaging-macros"></a><br><h3>    </h3><br><p>        —   <a href="">-  libxkbfile</a> .     -  : <br></p><br><br><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch</code> </pre><br><br><p>    <code>%define</code>  .        ,    (     ) —   ,       .     ,    <code>%{major}</code>   <code>1</code> ,      . <br></p><br><p>  <code>%mklibname</code>   «lib»,     ,      —   (  ).     <code>%{libname}</code>  <em>«lib» + «xkbswitch» + (  %{major}) =</em> <code>libxkbswitch1</code> —   . <br></p><br><p>  <code>-d</code>  <code>%mklibname</code>   <code>-devel</code> .    <code>%{develname}</code>  <code>libxkbswitch-devel</code> —    . <br></p><br><br><a name="subpackaging-change_header"></a><br><h3>    </h3><br><p>     <code>Version:</code>   <br></p><br><br><pre> <code class="plaintext hljs">Version: %{major}.6.0</code> </pre><br><br><p>  ,           -. <br></p><br><p>      -       .      .      : <br></p><br><pre> <code class="plaintext hljs">Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><a name="subpackaging-packages"></a><br><h3>    </h3><br><p>     <em>-</em>     . <em>-</em>   , -      (    <em>rpm</em> ).       <code>%package</code> .        -.     ,    -.          <code>Version</code> , <code>Summary</code> , <code>Group</code> .      <code>Provides</code>  <code>Requires</code>   <em></em>  <em></em> ,     .  <code>Name</code>   :    ,     <code>%package</code> . <br></p><br><p>      .     <code>%description</code>       —   ,     <code>%package</code> . <br></p><br><p>  Rosa Linux   -   <code>%description</code>  -.    <code>libxkbswitch1</code> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'.</code> </pre><br><br><p>  <code>-n</code>    <code>%package</code>  <code>%description</code> ,       .    -        ,    <code>xkb-switch-libxkbswitch1</code> .       <code>libxkbswitch1</code> .           . <br></p><br><p>    <em> </em> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'.</code> </pre><br><br><a name="subpackaging-files"></a><br><h3>     </h3><br><p>   ,      .     <code>%files</code> . <br></p><br><p>      ,     ,    <code>%package</code> , <code>%description</code>  <code>%files</code> .  ,    <code>%description</code>  -    .   ,      ,    — <code>xkb-switch</code> . <br></p><br><p>  -  Rosa Linux     <code>%files</code>   ,    <code>%prep</code> .       : <br></p><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_mandir}/%{name}.1.xz %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %files -n %{develname} %{_libdir}/libxkbswitch.so</code> </pre><br><br><p>    , : <br></p><br><br><ul><li>   <code>xkb-switch</code>   <code>~/usr/bin/xkb-switch</code>  <code>~/usr/share/man/man1/xkb-switch.1</code> , <br></li><li>   <code>libxkbswitch1</code>   <code>~/usr/lib/libxkbswitch.so.1</code>  <code>~/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <code>libxkbswitch-devel</code>   <code>~/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       <code>cleanup.sh</code>       <code>rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> .    3 : <br></p><br><br><pre> <code class="plaintext hljs">libxkbswitch1.i586: W: no-documentation libxkbswitch-devel.i586: W: no-documentation libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> </pre><br><br><p>   ,       .   ,     .     .  Mari kita coba mencari tahu. <br></p><br><br><a name="subpackaging-problems"></a><br><h3>    </h3><br><p> ,      ,  ,        <code>README.md</code> .     <code>%files</code>      —    <code>%doc</code> : <br></p><br><br><pre> <code class="plaintext hljs">%doc README.md</code> </pre><br><br><p>      .    <code>%doc</code> —    .        <code>~/rpmbuild/BUILD/xkb-switdh-master/README.md</code> . <br></p><br><p>       : <code>libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> .  ,    <code>libxkbswitch-devel</code>    <code>libxkbswitch</code>  . <br></p><br><p>    <code>rpm -qp  --</code>       .            : <br></p><br><pre> <code class="bash hljs">[user@pc ~] $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/RPMS/i586/ [user@pc ~/rpmbuild/RPMS/i586] $ ls libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-debuginfo-1.6.0-1-rosa2014.1.i586.rpm [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch.so.1 libxkbswitch1 = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libxkbswitch) libxkbswitch-devel = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libX11) devel(libgcc_s) devel(libstdc++) devel(libxkbfile) rpmlib(PayloadIsXz) &lt;= 5.2-1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libc.so.6 libc.so.6(GLIBC_2.0) libc.so.6(GLIBC_2.1.3) libgcc_s.so.1 libgcc_s.so.1(GCC_3.0) libstdc++.so.6 libstdc++.so.6(CXXABI_1.3) libstdc++.so.6(GLIBCXX_3.4) libstdc++.so.6(GLIBCXX_3.4.11) libstdc++.so.6(GLIBCXX_3.4.20) libstdc++.so.6(GLIBCXX_3.4.9) libxkbswitch.so.1 rpmlib(PayloadIsXz) &lt;= 5.2-1</code> </pre><br><br><p>  ,    <code>libxkbswitch1</code>   <code>libxkbswitch.so.1</code>  <code>libxkbswitch1</code> .  <code>xkb-switch</code>   <code>libxkbswitch.so.1</code> ,     <code>libxkbswitch-devel</code>    <code>libxkbswitch1</code> .   ,     <code>%package</code>  <code>libxkbswitch-devel</code> .      : <br></p><br><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version}</code> </pre><br><br><p>        , …       .     <code>libxkbswitch-devel</code>  ,  ,    .     ,         ,  <code>rpmbuild</code>      . <br></p><br><p> -,     (  <code>README.md</code>    ), —  : <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-    </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch # Main package. Automaticaly requires libxkbswitch and libxkbswitch-devel Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley. # libxkbswitch %package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'. # libxkbswitch-devel %package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version} %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'. # xkb-switch %files %{_bindir}/%{name} %{_mandir}/man1/%{name}.1.xz # libxkbswitch1 %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %doc README.md # libxkbswitch-devel %files -n %{develname} %{_libdir}/libxkbswitch.so %doc README.md #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="summary"></a><br><h2>  Kesimpulan </h2><br><p>  ,      RPM    <em>Rosa Linux</em> (       ).       ,   -. ,       — ,   ,   <em>rpmrc</em> ,      <em>ABF</em>   , —         . <br></p><br><p>        —    ,      -,         - , —     . <br></p><br><br><a name="commands"></a><br><h2>   </h2><br><br><a name="commands-build"></a><br><h3>     </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bp specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Menjalankan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">persiapan</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (persiapan%). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bc specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Run </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kompilasi</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (% build) dan semua tindakan sebelumnya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bi specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lakukan </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pseudo-</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instal (% instal) dan semua langkah sebelumnya. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -ba specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Membangun paket sepenuhnya.</font></font><br><br><br><br><a name="commands-package"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Memeriksa paket yang sudah selesai </font></font></h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmlint -i package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pemeriksaan umum - seberapa baik paket itu dibangun. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp --menyediakan package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Periksa "fitur" mana yang disediakan oleh paket. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp --membutuhkan package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Periksa "kemampuan" paket mana yang bergantung pada paket ini. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpl package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Daftar file yang terkandung dalam paket. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpi package-file-name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Informasi tentang paket (dari "header" file spesifikasi atau dari blok </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">% package</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><br><br><br><p>          ,    <code>p</code> .    ,     Rosa Linux,   .     <code>urpmq</code> ,   <code>rpm -q</code> . , <code>urpmq -l _</code>    ,  <code>urpmq --requires _</code>   . <br></p><br><br><a name="links"></a><br><h2>   ( ) </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Building RPMs — Quick Start</a> —         RPM  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="> RPM</a> —    ,   ,       .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">RPM:  spec </a> —    -  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Maximum RPM</a> —        <code>rpm</code>   RPM-  RedHat Linux.         ,      Rosa Linux.    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Template Spec Files</a> —   <code>.spec</code> .  ,      -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Automatic Build Farm (ABF)</a> —      Rosa Linux.             ,   ,     ,    <code>.spec</code> .     -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Rpmlint Errors</a> —    ,   <code>rpmlint</code> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Packaging Group</a> —    Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   Rosa Linux</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Git — </a> —      <em>Git</em> . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464993/">https://habr.com/ru/post/id464993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464981/index.html">Google memberikan argumen untuk membenarkan pelacakan pengguna - perusahaan dituduh tidak tulus dan manipulasi</a></li>
<li><a href="../id464985/index.html">Internet of Things (IoT) akan Mengubah Dunia. Masa depan IoT</a></li>
<li><a href="../id464987/index.html">Repositori di Kubernetes: OpenEBS vs Rook (Ceph) vs Rancher Longhorn vs StorageOS vs Robin vs Portworx vs Linstor</a></li>
<li><a href="../id464989/index.html">Konteks Extravaganza</a></li>
<li><a href="../id464991/index.html">Proyek yang tidak lepas landas</a></li>
<li><a href="../id464995/index.html">Bungkus urutan dalam Swift</a></li>
<li><a href="../id464997/index.html">Tentang pengembangan teknologi VR: di mana mereka menggunakannya, mengapa bisnis VR dan perangkat mana yang digunakan</a></li>
<li><a href="../id464999/index.html">Bagaimana spesifik bekerja dengan server aplikasi berubah menggunakan contoh OpenLiberty</a></li>
<li><a href="../id465001/index.html">Amazon Prime Day 2019 - Didukung oleh AWS</a></li>
<li><a href="../id465003/index.html">Minat untuk genre ARPG</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>