<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🌾 ♉️ 🤹🏾 Entwicklung robuster Python-Skripte 💪 🌆 👵🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Python ist eine Programmiersprache, die sich hervorragend für die Entwicklung eigenständiger Skripte eignet. Um mit einem ähnlichen Skript das gewünsc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Entwicklung robuster Python-Skripte</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/462007/"> Python ist eine Programmiersprache, die sich hervorragend für die Entwicklung eigenständiger Skripte eignet.  Um mit einem ähnlichen Skript das gewünschte Ergebnis zu erzielen, müssen Sie mehrere zehn oder hundert Codezeilen schreiben.  Und nachdem die Arbeit erledigt ist, können Sie einfach den geschriebenen Code vergessen und mit der Lösung des nächsten Problems fortfahren. <br><br>  Wenn beispielsweise sechs Monate nach dem Schreiben eines bestimmten „einmaligen“ Skripts jemand den Autor fragt, warum dieses Skript fehlschlägt, ist dem Autor des Skripts dies möglicherweise nicht bekannt.  Dies geschieht, weil das Skript keine Dokumentation geschrieben hat, weil Parameter verwendet werden, die im Code fest codiert sind, weil das Skript während der Arbeit nichts protokolliert und weil keine Tests zulässig sind um die Ursache des Problems schnell zu verstehen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/bw/sc/8n/bwsc8np51ystvqsvlchcn-ukvwi.jpeg"></a> <br><br>  Es sollte beachtet werden, dass es nicht so schwierig ist, ein in Eile geschriebenes Skript in etwas viel Besseres zu verwandeln.  Ein solches Skript lässt sich nämlich recht einfach in einen zuverlässigen und verständlichen Code verwandeln, der bequem zu verwenden ist, in einen Code, der sowohl den Autor als auch andere Programmierer einfach unterstützt. <br><br>  Der Autor des Materials, dessen Übersetzung wir heute veröffentlichen, wird eine solche „Transformation“ am Beispiel des klassischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fizz Buzz-Tests</a> demonstrieren.  Diese Aufgabe besteht darin, eine Liste mit Zahlen von 1 bis 100 anzuzeigen und einige davon durch spezielle Zeilen zu ersetzen.  Wenn die Zahl also ein Vielfaches von 3 ist - stattdessen müssen Sie die Zeichenfolge <code>Fizz</code> drucken, wenn die Zahl ein Vielfaches von 5 ist - die Zeichenfolge <code>Buzz</code> , und wenn beide Bedingungen erfüllt sind - <code>FizzBuzz</code> . <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Quellcode</font> </h2><br>  Hier ist der Quellcode für ein Python-Skript, das das Problem löst: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(int(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]), int(sys.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>])):    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> n % <span class="hljs-number"><span class="hljs-number">5</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>:        print(<span class="hljs-string"><span class="hljs-string">"fizzbuzz"</span></span>)    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> n % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>:        print(<span class="hljs-string"><span class="hljs-string">"fizz"</span></span>)    <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> n % <span class="hljs-number"><span class="hljs-number">5</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>:        print(<span class="hljs-string"><span class="hljs-string">"buzz"</span></span>)    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:        print(n)</code> </pre> <br>  Sprechen wir darüber, wie wir es verbessern können. <br><br><h2>  <font color="#3AC1EF">Die Dokumentation</font> </h2><br>  Ich finde es hilfreich, vor dem Schreiben von Code Dokumentation zu schreiben.  Dies vereinfacht die Arbeit und hilft, die Erstellung der Dokumentation nicht auf unbestimmte Zeit zu verzögern.  Die Dokumentation für das Skript kann oben platziert werden.  Zum Beispiel könnte es so aussehen: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 """Simple fizzbuzz generator. This script prints out a sequence of numbers from a provided range with the following restrictions: - if the number is divisible by 3, then print out "fizz", - if the number is divisible by 5, then print out "buzz", - if the number is divisible by 3 and 5, then print out "fizzbuzz". """</span></span></code> </pre> <br>  Die erste Zeile enthält eine kurze Beschreibung des Zwecks des Skripts.  Die verbleibenden Absätze enthalten zusätzliche Informationen zur Funktionsweise des Skripts. <br><br><h2>  <font color="#3AC1EF">Befehlszeilenargumente</font> </h2><br>  Die nächste Aufgabe zur Verbesserung des Skripts besteht darin, die im Code fest codierten Werte durch die dokumentierten Werte zu ersetzen, die über Befehlszeilenargumente an das Skript übergeben werden.  Dies kann mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">argparse-</a> Modul erfolgen.  In unserem Beispiel empfehlen wir dem Benutzer, einen Zahlenbereich anzugeben und die Werte für "Fizz" und "Buzz" anzugeben, die beim Überprüfen von Zahlen aus dem angegebenen Bereich verwendet werden. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> argparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomFormatter</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(argparse.RawDescriptionHelpFormatter,                      argparse.ArgumentDefaultsHelpFormatter)</span></span></span><span class="hljs-class">:</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse_args</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args=sys.argv[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">:])</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""Parse arguments."""</span></span>    parser = argparse.ArgumentParser(        description=sys.modules[__name__].__doc__,        formatter_class=CustomFormatter)    g = parser.add_argument_group(<span class="hljs-string"><span class="hljs-string">"fizzbuzz settings"</span></span>)    g.add_argument(<span class="hljs-string"><span class="hljs-string">"--fizz"</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">"N"</span></span>,                   default=<span class="hljs-number"><span class="hljs-number">3</span></span>,                   type=int,                   help=<span class="hljs-string"><span class="hljs-string">"Modulo value for fizz"</span></span>)    g.add_argument(<span class="hljs-string"><span class="hljs-string">"--buzz"</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">"N"</span></span>,                   default=<span class="hljs-number"><span class="hljs-number">5</span></span>,                   type=int,                   help=<span class="hljs-string"><span class="hljs-string">"Modulo value for buzz"</span></span>)    parser.add_argument(<span class="hljs-string"><span class="hljs-string">"start"</span></span>, type=int, help=<span class="hljs-string"><span class="hljs-string">"Start value"</span></span>)    parser.add_argument(<span class="hljs-string"><span class="hljs-string">"end"</span></span>, type=int, help=<span class="hljs-string"><span class="hljs-string">"End value"</span></span>)    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parser.parse_args(args) options = parse_args() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(options.start, options.end + <span class="hljs-number"><span class="hljs-number">1</span></span>):    <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre> <br>  Diese Änderungen sind für das Skript von großem Nutzen.  Die Parameter sind jetzt ordnungsgemäß dokumentiert. Sie können ihren Zweck mit dem Flag <code>--help</code> .  Darüber hinaus wird gemäß dem entsprechenden Befehl auch die Dokumentation angezeigt, die wir im vorherigen Abschnitt geschrieben haben: <br><br><pre> <code class="python hljs">$ ./fizzbuzz.py --help usage: fizzbuzz.py [-h] [--fizz N] [--buzz N] start end Simple fizzbuzz generator. This script prints out a sequence of numbers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> a provided range <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the following restrictions: - <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> divisible by <span class="hljs-number"><span class="hljs-number">3</span></span>, then <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> out <span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, - <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> divisible by <span class="hljs-number"><span class="hljs-number">5</span></span>, then <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> out <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>, - <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the number <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> divisible by <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>, then <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> out <span class="hljs-string"><span class="hljs-string">"fizzbuzz"</span></span>. positional arguments:  start     Start value  end      End value optional arguments:  -h, --help  show this help message <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> exit fizzbuzz settings:  --fizz N   Modulo value <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> fizz (default: <span class="hljs-number"><span class="hljs-number">3</span></span>)  --buzz N   Modulo value <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> buzz (default: <span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Das <code>argparse</code> Modul ist ein sehr leistungsfähiges Werkzeug.  Wenn Sie nicht damit vertraut sind, ist es hilfreich, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> zu lesen.  Insbesondere gefällt mir seine Fähigkeit, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Unterbefehle</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Argumentgruppen</a> zu definieren. <br><br><h2>  <font color="#3AC1EF">Protokollierung</font> </h2><br>  Wenn Sie das Skript mit der Möglichkeit ausstatten, während der Ausführung einige Informationen anzuzeigen, stellt sich heraus, dass dies eine angenehme Ergänzung seiner Funktionalität darstellt.  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Protokollierungsmodul</a> ist für diesen Zweck gut geeignet.  Zunächst beschreiben wir ein Objekt, das die Protokollierung implementiert: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging.handlers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys logger = logging.getLogger(os.path.splitext(os.path.basename(sys.argv[<span class="hljs-number"><span class="hljs-number">0</span></span>]))[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br>  Anschließend können Sie die Details der während der Protokollierung angezeigten Informationen steuern.  Der Befehl <code>logger.debug()</code> sollte also nur dann etwas ausgeben, wenn das Skript mit dem Schalter <code>--debug</code> ausgeführt wird.  Wenn das Skript mit dem <code>--silent</code> , sollte das Skript nur Ausnahmemeldungen anzeigen.  <code>parse_args()</code> den folgenden Code hinzu, um diese Funktionen zu implementieren: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  parse_args() g = parser.add_mutually_exclusive_group() g.add_argument("--debug", "-d", action="store_true",               default=False,               help="enable debugging") g.add_argument("--silent", "-s", action="store_true",               default=False,               help="don't log to console")</span></span></code> </pre> <br>  Fügen Sie dem Projektcode die folgende Funktion hinzu, um die Protokollierung zu konfigurieren: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup_logging</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(options)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""Configure logging."""</span></span>    root = logging.getLogger(<span class="hljs-string"><span class="hljs-string">""</span></span>)    root.setLevel(logging.WARNING)    logger.setLevel(options.debug <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> logging.DEBUG <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> logging.INFO)    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> options.silent:        ch = logging.StreamHandler()        ch.setFormatter(logging.Formatter(            <span class="hljs-string"><span class="hljs-string">"%(levelname)s[%(name)s] %(message)s"</span></span>))        root.addHandler(ch)</code> </pre> <br>  Der Hauptskriptcode ändert sich wie folgt: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">"__main__"</span></span>:    options = parse_args()    setup_logging(options)    <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>:        logger.debug(<span class="hljs-string"><span class="hljs-string">"compute fizzbuzz from {} to {}"</span></span>.format(options.start,                                                             options.end))        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(options.start, options.end + <span class="hljs-number"><span class="hljs-number">1</span></span>):            <span class="hljs-comment"><span class="hljs-comment"># ..    except Exception as e:        logger.exception("%s", e)        sys.exit(1)    sys.exit(0)</span></span></code> </pre> <br>  Wenn Sie das Skript ohne direkte Beteiligung des Benutzers ausführen <code>crontab</code> , z. B. mithilfe von <code>crontab</code> , können Sie die Ausgabe an <code>syslog</code> : <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup_logging</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(options)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""Configure logging."""</span></span>    root = logging.getLogger(<span class="hljs-string"><span class="hljs-string">""</span></span>)    root.setLevel(logging.WARNING)    logger.setLevel(options.debug <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> logging.DEBUG <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> logging.INFO)    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> options.silent:        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> sys.stderr.isatty():            facility = logging.handlers.SysLogHandler.LOG_DAEMON            sh = logging.handlers.SysLogHandler(address=<span class="hljs-string"><span class="hljs-string">'/dev/log'</span></span>,                                                facility=facility)            sh.setFormatter(logging.Formatter(                <span class="hljs-string"><span class="hljs-string">"{0}[{1}]: %(message)s"</span></span>.format(                    logger.name,                    os.getpid())))            root.addHandler(sh)        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:            ch = logging.StreamHandler()            ch.setFormatter(logging.Formatter(                <span class="hljs-string"><span class="hljs-string">"%(levelname)s[%(name)s] %(message)s"</span></span>))            root.addHandler(ch)</code> </pre> <br>  In unserem kleinen Skript scheint eine ähnliche Menge an Code erforderlich zu sein, um nur den Befehl <code>logger.debug()</code> .  In echten Skripten wird dieser Code jedoch nicht mehr so ​​aussehen und der Nutzen davon wird in den Vordergrund rücken, nämlich dass Benutzer mit seiner Hilfe in der Lage sein werden, den Fortschritt der Problemlösung herauszufinden. <br><br><pre> <code class="python hljs">$ ./fizzbuzz.py --debug <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> DEBUG[fizzbuzz] compute fizzbuzz <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> to <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> fizz</code> </pre> <br><h2>  <font color="#3AC1EF">Tests</font> </h2><br>  Unit-Tests sind ein nützliches Tool, um zu überprüfen, ob sich Anwendungen so verhalten, wie sie sollten.  Einheitenskripte werden in Skripten selten verwendet, aber ihre Aufnahme in Skripte verbessert die Codezuverlässigkeit erheblich.  Wir wandeln den Code innerhalb der Schleife in eine Funktion um und beschreiben in seiner Dokumentation mehrere interaktive Beispiele für seine Verwendung: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fizzbuzz</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n, fizz, buzz)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""Compute fizzbuzz nth item given modulo values for fizz and buzz.    &gt;&gt;&gt; fizzbuzz(5, fizz=3, buzz=5)    'buzz'    &gt;&gt;&gt; fizzbuzz(3, fizz=3, buzz=5)    'fizz'    &gt;&gt;&gt; fizzbuzz(15, fizz=3, buzz=5)    'fizzbuzz'    &gt;&gt;&gt; fizzbuzz(4, fizz=3, buzz=5)    4    &gt;&gt;&gt; fizzbuzz(4, fizz=4, buzz=6)    'fizz'    """</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n % fizz == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> n % buzz == <span class="hljs-number"><span class="hljs-number">0</span></span>:        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"fizzbuzz"</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n % fizz == <span class="hljs-number"><span class="hljs-number">0</span></span>:        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"fizz"</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> n % buzz == <span class="hljs-number"><span class="hljs-number">0</span></span>:        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n</code> </pre> <br>  Sie können den korrekten Betrieb der Funktion mit <code>pytest</code> : <br><br><pre> <code class="python hljs">$ python3 -m pytest -v --doctest-modules ./fizzbuzz.py ============================ test session starts ============================= platform linux -- Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>, pytest<span class="hljs-number"><span class="hljs-number">-3.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, py<span class="hljs-number"><span class="hljs-number">-1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>, pluggy<span class="hljs-number"><span class="hljs-number">-0.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> -- /usr/bin/python3 cachedir: .pytest_cache rootdir: /home/bernat/code/perso/python-script, inifile: plugins: xdist<span class="hljs-number"><span class="hljs-number">-1.26</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, timeout<span class="hljs-number"><span class="hljs-number">-1.3</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>, forked<span class="hljs-number"><span class="hljs-number">-1.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>, cov<span class="hljs-number"><span class="hljs-number">-2.6</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> collected <span class="hljs-number"><span class="hljs-number">1</span></span> item fizzbuzz.py::fizzbuzz.fizzbuzz PASSED                 [<span class="hljs-number"><span class="hljs-number">100</span></span>%] ========================== <span class="hljs-number"><span class="hljs-number">1</span></span> passed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.05</span></span> seconds ==========================</code> </pre> <br>  Damit dies alles funktioniert, benötigen Sie die Erweiterung <code>.py</code> , die nach dem Skriptnamen steht.  Ich mag es nicht, Erweiterungen zu Skriptnamen hinzuzufügen: Sprache ist nur ein technisches Detail, das dem Benutzer nicht angezeigt werden muss.  Es scheint jedoch, dass das Ausstatten eines <code>pytest</code> mit einer Erweiterung der einfachste Weg ist, Systeme zum Ausführen von Tests wie <code>pytest</code> die im Code enthaltenen Tests finden zu lassen. <br><br>  Wenn ein Fehler <code>pytest</code> eine Meldung an, die den Speicherort des entsprechenden Codes und die Art des Problems angibt: <br><br><pre> <code class="python hljs">$ python3 -m pytest -v --doctest-modules ./fizzbuzz.py -k fizzbuzz.fizzbuzz ============================ test session starts ============================= platform linux -- Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>, pytest<span class="hljs-number"><span class="hljs-number">-3.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, py<span class="hljs-number"><span class="hljs-number">-1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>, pluggy<span class="hljs-number"><span class="hljs-number">-0.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> -- /usr/bin/python3 cachedir: .pytest_cache rootdir: /home/bernat/code/perso/python-script, inifile: plugins: xdist<span class="hljs-number"><span class="hljs-number">-1.26</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, timeout<span class="hljs-number"><span class="hljs-number">-1.3</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>, forked<span class="hljs-number"><span class="hljs-number">-1.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>, cov<span class="hljs-number"><span class="hljs-number">-2.6</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> collected <span class="hljs-number"><span class="hljs-number">1</span></span> item fizzbuzz.py::fizzbuzz.fizzbuzz FAILED                 [<span class="hljs-number"><span class="hljs-number">100</span></span>%] ================================== FAILURES ================================== ________________________ [doctest] fizzbuzz.fizzbuzz _________________________ <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-number"><span class="hljs-number">101</span></span>   &gt;&gt;&gt; fizzbuzz(<span class="hljs-number"><span class="hljs-number">5</span></span>, fizz=<span class="hljs-number"><span class="hljs-number">3</span></span>, buzz=<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-number"><span class="hljs-number">102</span></span>   <span class="hljs-string"><span class="hljs-string">'buzz'</span></span> <span class="hljs-number"><span class="hljs-number">103</span></span>   &gt;&gt;&gt; fizzbuzz(<span class="hljs-number"><span class="hljs-number">3</span></span>, fizz=<span class="hljs-number"><span class="hljs-number">3</span></span>, buzz=<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-number"><span class="hljs-number">104</span></span>   <span class="hljs-string"><span class="hljs-string">'fizz'</span></span> <span class="hljs-number"><span class="hljs-number">105</span></span>   &gt;&gt;&gt; fizzbuzz(<span class="hljs-number"><span class="hljs-number">15</span></span>, fizz=<span class="hljs-number"><span class="hljs-number">3</span></span>, buzz=<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-number"><span class="hljs-number">106</span></span>   <span class="hljs-string"><span class="hljs-string">'fizzbuzz'</span></span> <span class="hljs-number"><span class="hljs-number">107</span></span>   &gt;&gt;&gt; fizzbuzz(<span class="hljs-number"><span class="hljs-number">4</span></span>, fizz=<span class="hljs-number"><span class="hljs-number">3</span></span>, buzz=<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-number"><span class="hljs-number">108</span></span>   <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">109</span></span>   &gt;&gt;&gt; fizzbuzz(<span class="hljs-number"><span class="hljs-number">4</span></span>, fizz=<span class="hljs-number"><span class="hljs-number">4</span></span>, buzz=<span class="hljs-number"><span class="hljs-number">6</span></span>) Expected:    fizz Got:    <span class="hljs-number"><span class="hljs-number">4</span></span> /home/bernat/code/perso/python-script/fizzbuzz.py:<span class="hljs-number"><span class="hljs-number">109</span></span>: DocTestFailure ========================== <span class="hljs-number"><span class="hljs-number">1</span></span> failed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.02</span></span> seconds ==========================</code> </pre> <br>  Unit-Tests können auch als regulärer Code geschrieben werden.  Stellen Sie sich vor, wir müssen die folgende Funktion testen: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(options)</span></span></span><span class="hljs-function">:</span></span>    <span class="hljs-string"><span class="hljs-string">"""Compute a fizzbuzz set of strings and return them as an array."""</span></span>    logger.debug(<span class="hljs-string"><span class="hljs-string">"compute fizzbuzz from {} to {}"</span></span>.format(options.start,                                                         options.end))    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [str(fizzbuzz(i, options.fizz, options.buzz))            <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(options.start, options.end+<span class="hljs-number"><span class="hljs-number">1</span></span>)]</code> </pre> <br>  Am Ende des Skripts fügen wir die folgenden <code>pytest</code> hinzu, die die <code>pytest</code> für die Verwendung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">parametrisierter Testfunktionen verwenden</a> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   import pytest          # noqa: E402 import shlex          # noqa: E402 @pytest.mark.parametrize("args, expected", [    ("0 0", ["fizzbuzz"]),    ("3 5", ["fizz", "4", "buzz"]),    ("9 12", ["fizz", "buzz", "11", "fizz"]),    ("14 17", ["14", "fizzbuzz", "16", "17"]),    ("14 17 --fizz=2", ["fizz", "buzz", "fizz", "17"]),    ("17 20 --buzz=10", ["17", "fizz", "19", "buzz"]), ]) def test_main(args, expected):    options = parse_args(shlex.split(args))    options.debug = True    options.silent = True    setup_logging(options)    assert main(options) == expected</span></span></code> </pre> <br>  Bitte beachten Sie, dass Tests nicht ausgeführt werden, wenn der <code>sys.exit()</code> mit einem Aufruf von <code>sys.exit()</code> endet, wenn er normal aufgerufen wird.  Aus diesem <code>pytest</code> nicht benötigt, um das Skript auszuführen. <br><br>  Die Testfunktion wird für jede Parametergruppe einmal aufgerufen.  Die <code>args</code> Entität wird als Eingabe für die Funktion <code>parse_args()</code> verwendet.  Dank dieses Mechanismus erhalten wir das, was wir zur Übergabe an die <code>main()</code> Funktion benötigen.  Die <code>expected</code> Entität wird mit der <code>main()</code> verglichen.  <code>pytest</code> sagt uns <code>pytest</code> , wenn alles wie erwartet funktioniert: <br><br><pre> <code class="python hljs">$ python3 -m pytest -v --doctest-modules ./fizzbuzz.py ============================ test session starts ============================= platform linux -- Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>, pytest<span class="hljs-number"><span class="hljs-number">-3.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, py<span class="hljs-number"><span class="hljs-number">-1.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>, pluggy<span class="hljs-number"><span class="hljs-number">-0.8</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> -- /usr/bin/python3 cachedir: .pytest_cache rootdir: /home/bernat/code/perso/python-script, inifile: plugins: xdist<span class="hljs-number"><span class="hljs-number">-1.26</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>, timeout<span class="hljs-number"><span class="hljs-number">-1.3</span></span><span class="hljs-number"><span class="hljs-number">.3</span></span>, forked<span class="hljs-number"><span class="hljs-number">-1.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>, cov<span class="hljs-number"><span class="hljs-number">-2.6</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> collected <span class="hljs-number"><span class="hljs-number">7</span></span> items fizzbuzz.py::fizzbuzz.fizzbuzz PASSED                 [ <span class="hljs-number"><span class="hljs-number">14</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-expected0] PASSED              [ <span class="hljs-number"><span class="hljs-number">28</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>-expected1] PASSED              [ <span class="hljs-number"><span class="hljs-number">42</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>-expected2] PASSED             [ <span class="hljs-number"><span class="hljs-number">57</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>-expected3] PASSED             [ <span class="hljs-number"><span class="hljs-number">71</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> --fizz=<span class="hljs-number"><span class="hljs-number">2</span></span>-expected4] PASSED        [ <span class="hljs-number"><span class="hljs-number">85</span></span>%] fizzbuzz.py::test_main[<span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> --buzz=<span class="hljs-number"><span class="hljs-number">10</span></span>-expected5] PASSED        [<span class="hljs-number"><span class="hljs-number">100</span></span>%] ========================== <span class="hljs-number"><span class="hljs-number">7</span></span> passed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.03</span></span> seconds ==========================</code> </pre> <br>  Wenn ein Fehler auftritt, <code>pytest</code> nützliche Informationen darüber, was passiert ist: <br><br><pre> <code class="python hljs">$ python3 -m pytest -v --doctest-modules ./fizzbuzz.py [...] ================================== FAILURES ================================== __________________________ test_main[<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>-expected0] __________________________ args = <span class="hljs-string"><span class="hljs-string">'0 0'</span></span>, expected = [<span class="hljs-string"><span class="hljs-string">'0'</span></span>]    @pytest.mark.parametrize(<span class="hljs-string"><span class="hljs-string">"args, expected"</span></span>, [        (<span class="hljs-string"><span class="hljs-string">"0 0"</span></span>, [<span class="hljs-string"><span class="hljs-string">"0"</span></span>]),        (<span class="hljs-string"><span class="hljs-string">"3 5"</span></span>, [<span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, <span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>]),        (<span class="hljs-string"><span class="hljs-string">"9 12"</span></span>, [<span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>, <span class="hljs-string"><span class="hljs-string">"11"</span></span>, <span class="hljs-string"><span class="hljs-string">"fizz"</span></span>]),        (<span class="hljs-string"><span class="hljs-string">"14 17"</span></span>, [<span class="hljs-string"><span class="hljs-string">"14"</span></span>, <span class="hljs-string"><span class="hljs-string">"fizzbuzz"</span></span>, <span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-string"><span class="hljs-string">"17"</span></span>]),        (<span class="hljs-string"><span class="hljs-string">"14 17 --fizz=2"</span></span>, [<span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>, <span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, <span class="hljs-string"><span class="hljs-string">"17"</span></span>]),        (<span class="hljs-string"><span class="hljs-string">"17 20 --buzz=10"</span></span>, [<span class="hljs-string"><span class="hljs-string">"17"</span></span>, <span class="hljs-string"><span class="hljs-string">"fizz"</span></span>, <span class="hljs-string"><span class="hljs-string">"19"</span></span>, <span class="hljs-string"><span class="hljs-string">"buzz"</span></span>]),    ])    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args, expected)</span></span></span><span class="hljs-function">:</span></span>        options = parse_args(shlex.split(args))        options.debug = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>        options.silent = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>        setup_logging(options)       <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> main(options) == expected E    AssertionError: <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> [<span class="hljs-string"><span class="hljs-string">'fizzbuzz'</span></span>] == [<span class="hljs-string"><span class="hljs-string">'0'</span></span>] E     At index <span class="hljs-number"><span class="hljs-number">0</span></span> diff: <span class="hljs-string"><span class="hljs-string">'fizzbuzz'</span></span> != <span class="hljs-string"><span class="hljs-string">'0'</span></span> E     Full diff: E     - [<span class="hljs-string"><span class="hljs-string">'fizzbuzz'</span></span>] E     + [<span class="hljs-string"><span class="hljs-string">'0'</span></span>] fizzbuzz.py:<span class="hljs-number"><span class="hljs-number">160</span></span>: AssertionError ----------------------------- Captured log call ------------------------------ fizzbuzz.py        <span class="hljs-number"><span class="hljs-number">125</span></span> DEBUG compute fizzbuzz <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> to <span class="hljs-number"><span class="hljs-number">0</span></span> ===================== <span class="hljs-number"><span class="hljs-number">1</span></span> failed, <span class="hljs-number"><span class="hljs-number">6</span></span> passed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.05</span></span> seconds =====================</code> </pre> <br>  Die Ausgabe des <code>logger.debug()</code> ist <code>logger.debug()</code> in dieser Ausgabe enthalten.  Dies ist ein weiterer guter Grund, Protokollierungsmechanismen in Skripten zu verwenden.  Wenn Sie mehr über die großartigen Eigenschaften von <code>pytest</code> erfahren <code>pytest</code> , schauen Sie sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses</a> Material an. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Sie können Python-Skripte zuverlässiger machen, indem Sie die folgenden vier Schritte ausführen: <br><br><ul><li>  Rüsten Sie das Skript mit der Dokumentation aus, die sich oben in der Datei befindet. </li><li>  Verwenden Sie das <code>argparse</code> Modul, um die Parameter zu dokumentieren, mit denen das Skript aufgerufen werden kann. </li><li>  Verwenden Sie das <code>logging</code> , um Informationen zum <code>logging</code> anzuzeigen. </li><li>  Schreiben Sie Unit-Tests. </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier ist der</a> vollständige Code für das hier beschriebene Beispiel.  Sie können es als Vorlage für Ihre eigenen Skripte verwenden. <br><br>  Interessante Diskussionen rund um dieses Material haben begonnen - Sie finden sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Das Publikum hat anscheinend Empfehlungen zur Dokumentation und zu Befehlszeilenargumenten gut aufgenommen, aber was ist mit Protokollierung und Tests, die einigen Lesern als "Schuss aus einer Kanone auf Spatzen" erschienen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier ist das</a> Material, das als Antwort auf diesen Artikel geschrieben wurde. <br><br>  <b>Liebe Leser!</b>  Planen Sie, die in dieser Veröffentlichung enthaltenen Empfehlungen zum Schreiben von Python-Skripten anzuwenden? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de462007/">https://habr.com/ru/post/de462007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de461995/index.html">Verwendung von residenten Proxys für Marketing und Website-Werbung</a></li>
<li><a href="../de461997/index.html">Optimieren der Abfrageleistung in PostgreSQL</a></li>
<li><a href="../de461999/index.html">Eine andere Version der WordPress-Entwicklungsumgebung (Docker, wp-cli)</a></li>
<li><a href="../de462003/index.html">Wie ich PWA auf Svelte bei Google Play gepostet habe</a></li>
<li><a href="../de462005/index.html">Funktionen von Google PageSpeed: Verbesserte Website-Bewertung und verbessertes Suchranking</a></li>
<li><a href="../de462009/index.html">Programmtrends: Was ist im Jahr 2020 zu erwarten?</a></li>
<li><a href="../de462011/index.html">Web-Geoservices. Überblick über moderne Lösungen</a></li>
<li><a href="../de462013/index.html">Verlauf des Docker-Speicher-Migrationsproblems (Docker-Root)</a></li>
<li><a href="../de462015/index.html">SAP-Berichtsuniversum</a></li>
<li><a href="../de462021/index.html">Wie man aufhört, dasselbe zu tun</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>