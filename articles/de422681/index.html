<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔙 🧑🏽‍🤝‍🧑🏽 👨🏾‍🚒 SAP- und Python-Integration oder einfacheres Abrufen von Daten aus SAP ⛔️ 🏀 😗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Guten Tag, Habr! 

 Ich möchte die Erfahrung einer interessanten Aufgabe zur einfachen Interaktion mit SAP-Systemen mit Python teilen - es spielt kein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SAP- und Python-Integration oder einfacheres Abrufen von Daten aus SAP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422681/">  Guten Tag, Habr! <br><br>  Ich möchte die Erfahrung einer interessanten Aufgabe zur einfachen Interaktion mit SAP-Systemen mit Python teilen - es spielt keine Rolle, welches Modul oder welche Version der Plattform. <br><br>  Wenn nur die technische Lösung interessant ist, überspringen Sie alle Texte und sehen Sie sich eine Beispielimplementierung an. <br><br><h3>  Text </h3><br>  Alles lief darauf hinaus, dass einer der Kunden Daten aus seinem SAP-ERP-System herunterladen musste, indem er bereits erstellte Berichte manipulierte und per E-Mail an interessierte Personen schickte, sowie andere Aktionen. <br><br>  Tatsächlich haben wir als Auftragnehmer bei der Erörterung der Lösung eines solchen Problems verschiedene Optionen vorgeschlagen. Eine der naheliegendsten Möglichkeiten besteht darin, alles mithilfe der internen SAP-Funktionalität auf einfache Weise unter den „Pionieren“ für Zed mit ABAP zu tun. <br><br>  Das erste, was uns begegnete, waren die Kriterien für die Auswahl von Daten, die aus den Worten des Kunden nicht vollständig transparent sind, nämlich die Daten, welche Tabellen, warum, warum, welche Aktionen mit ihnen ausgeführt werden sollten.  Wenn Sie ein Beispiel nennen, musste der Kunde die Anwesenheit von Büromitarbeitern mit Daten im Zusammenhang mit Arbeitszeitnachweisen und Ferien entladen.  Es war auch notwendig, Berichte über die Leistung der Mitarbeiter mit Analysen zu seiner Zeit am Arbeitsplatz zu erstellen. Ich werde nicht auf Details eingehen, aber ich werde sagen, dass die aufgewendete Zeit die Produktivität beeinflusst. Um dies herauszufinden, müssen Sie die Arbeitszeit mit dem Ergebnis der Arbeit und vielem berechnen ein anderer.  Dies ist nur ein Beispiel für einen Bericht, und der Kunde hat während der Diskussionen viel generiert. <br><br>  Nach langen Gesprächen stellten wir fest, dass SAP Query oder BI \ BO eine solche Lösung werden könnten, aber der Kunde war mit den geschätzten Kosten der Lösung und der nicht bequemsten Flexibilität nicht sehr zufrieden. <br><a name="habracut"></a><br><h3>  Python-Lösung </h3><br>  Dann dachte ich an meinen eigenen Kopf über einen Artikel über eine Ressource über die Pyrfc-Bibliothek, und da ich kein Python-Programmierer war, aber einmal darüber gelesen hatte, beschloss ich, ihn zu Hause zu studieren, und zu meiner Überraschung war ich ein Amateur, der sich wohl fühlte Bei dieser Programmiersprache stellte ich fest, dass die Verbindung zu einem beliebigen SAP-System unglaublich einfach ist und außerdem 20 Minuten dauert. <br><br>  Zwanzig Minuten CARL !!! <br><br>  Stellen Sie sich vor, Sie können die Verbindungsschnittstelle mit dem SAP-ERP-System konfigurieren, ohne dort in so kurzer Zeit Datenbusse und alle Arten von PI \ XI zu verwenden. <br><br><h3>  Implementierung </h3><br>  Nachdem ich endlich sichergestellt hatte, dass dies eine funktionierende Lösung ist und den Kunden zufriedenstellt, studierte ich mehrere Plattformen (ich studierte sie, las sie etwa alle 10 Minuten) und entschied mich unter anderem für die Odoo-Plattform, da sie einfacher bereitzustellen ist und alle erforderlichen Eigenschaften aufweist, z. B.: Gut Schnittstelle, Zugriffsrechtssystem, mobile Anwendung, Mailserver, gute Datenbankschnittstelle (psql). <br><br>  Außerdem ist alles sehr einfach. <br><br>  Installieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Odoo</a> auf der virtuellen Maschine des Kunden (ich habe Version 8 verwendet), weil  es ist im Moment das einfachste, ich weiß, dass Version 12 bereits ist, aber die Aufgabe erfordert nicht alle coolen neuen Produkte. <br><br>  Installierte alle notwendigen Bibliotheken, insbesondere pyrfc - ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link zu einem Artikel über Installation und Verbindung</a> . <br><br>  Außerdem musste für die Konnektivität nur ein kleines Modul in die Odoo-Plattform selbst geschrieben werden, und es gab zahlreiche Tools zur Visualisierung von Daten. <br><br>  Verbindung zum Kundensystem herstellen: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection user = <span class="hljs-string"><span class="hljs-string">'user'</span></span> passwd = <span class="hljs-string"><span class="hljs-string">'secretuser'</span></span> saprouter = <span class="hljs-string"><span class="hljs-string">'/H/192.168.0.140/S/3297'</span></span> conn = Connection(user=user, passwd=password, mshost=<span class="hljs-string"><span class="hljs-string">'CLient'</span></span>, msserv=<span class="hljs-string"><span class="hljs-string">'192.168.0.140'</span></span>, sysid=<span class="hljs-string"><span class="hljs-string">'01'</span></span>, group=<span class="hljs-string"><span class="hljs-string">"SPACE"</span></span>, saprouter=saprouter, client=<span class="hljs-string"><span class="hljs-string">'900'</span></span>)</code> </pre> <br>  Rufen Sie BAPI an, um Benutzerinformationen zu erhalten <br><br><pre> <code class="python hljs">b_result = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_GET_DETAIL'</span></span>, USERNAME = <span class="hljs-string"><span class="hljs-string">'user'</span></span>, CACHE_RESULTS = <span class="hljs-string"><span class="hljs-string">' '</span></span>)</code> </pre><br>  Benutzerwechsel <br><br><pre> <code class="python hljs">updated_address[<span class="hljs-string"><span class="hljs-string">'CITY'</span></span>] = <span class="hljs-string"><span class="hljs-string">u'Moscow'</span></span> r = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_CHANGE'</span></span>, USERNAME=<span class="hljs-string"><span class="hljs-string">'user'</span></span>, ADDRESS=updated_address)</code> </pre><br>  Das wichtigste Werkzeug zum Abrufen von Daten aus SAP, wenn es um Tabellen geht, ist das Funktionsmodul RFC_READ_TABLE. Es gibt andere Module in der SAP-Plattform, die aufgerufen werden können. Es muss eine Einstellung vorhanden sein, die besagt, dass sie mit RFC aufgerufen werden können. <br><br>  Zum Beispiel: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection, ABAPApplicationError, ABAPRuntimeError, LogonError, CommunicationError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PrettyPrinter <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: config = ConfigParser() config.read(<span class="hljs-string"><span class="hljs-string">'sapnwrfc.cfg'</span></span>) - <span class="hljs-comment"><span class="hljs-comment"># ,        SAP ERP params_connection = config._sections['connection'] conn = Connection(**params_connection) #    options = [{ 'TEXT': "FCURR = 'USD'"}] pp = PrettyPrinter(indent=4) ROWS_AT_A_TIME = 10 rowskips = 0 while True: print u"----Begin of Batch---" result = conn.call('RFC_READ_TABLE', \ QUERY_TABLE = 'TCURR', \ OPTIONS = options, \ ROWSKIPS = rowskips, ROWCOUNT = ROWS_AT_A_TIME) pp.pprint(result['DATA']) rowskips += ROWS_AT_A_TIME if len(result['DATA']) &lt; ROWS_AT_A_TIME: break except CommunicationError: print u"Could not connect to server." raise except LogonError: print u"Could not log in. Wrong credentials?" raise except (ABAPApplicationError, ABAPRuntimeError): print u"An error occurred." raise</span></span></code> </pre><br><h3>  Ergebnis </h3><br>  In diesem Bild eine Liste der Berichte, die mit dieser Methode entladen wurden, sowie ein Beispiel für einen dieser Berichte. <br><br><img src="https://habrastorage.org/webt/ws/jk/sp/wsjkspjwwobeqnjznhaudqgw8do.jpeg"><br><br><h3>  Zusammenfassung </h3><br>  Im Großen und Ganzen eröffnet diese Methode große Möglichkeiten, sehr teure SAP-Tools und andere durch flexiblere und offenere zu ersetzen. <br><br>  Codebeispiele stammen aus Open Source.  Ich habe keine Rechte zur Verwendung von Kundencode in dem Artikel, und ich bin kein Python-Programmierer. Ich hätte irgendwo einen Fehler machen können. <br><br>  Ich möchte hinzufügen, dass wir dieses Tool bereits in einer Vielzahl von Aufgaben im Zusammenhang mit der KPI-Berechnung, der Ausgabe von Daten an andere Quellen (Websites, Lieferanten- und Kundendatenbanken), dem Senden von Informationen aus Systemen basierend auf Daten von SAP und vielem mehr verwenden. <br>  Im Allgemeinen war eine solche Gelegenheit eine Entdeckung für mich. Wenn jemand eine ähnliche Erfahrung hat, würde ich gerne zuhören. <br><br>  PS Ich habe das Problem der Lizenzierung nicht angesprochen, daher kann ich zu diesem Thema mit Sicherheit nichts sagen. <br>  Vielen Dank! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Habr Link</a> <br>  Mit freundlichen Grüßen SAP Consultant </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422681/">https://habr.com/ru/post/de422681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422669/index.html">Oracle gegen PostgreSQL. Warum die Wahl von Oracle eine kluge Entscheidung sein könnte</a></li>
<li><a href="../de422671/index.html">5G kann Kabel ersetzen - aber nicht überall</a></li>
<li><a href="../de422675/index.html">Made in Space: Wer macht die Faser auf der ISS?</a></li>
<li><a href="../de422677/index.html">Drei Monate später: Wie GDPR Cookies beeinflusste</a></li>
<li><a href="../de422679/index.html">Imaginäre Probleme - der Grund für schlechte Software</a></li>
<li><a href="../de422683/index.html">In den USA gründeten zwei Händler eine gefälschte Maklerfirma, um Geld von unerfahrenen Investoren zu stehlen</a></li>
<li><a href="../de422685/index.html">Smart Watch Samsung Galaxy Watch: Upgrade von Android Wear OS auf Tizen OS - persönliche Erfahrung</a></li>
<li><a href="../de422687/index.html">Boten in Gefahr</a></li>
<li><a href="../de422689/index.html">Farberkennung von Autos mit neuronalen Netzen und TensorFlow</a></li>
<li><a href="../de422691/index.html">Die Hybridkamera und das Lidar verbessern die Fähigkeiten von Robomobilen und ergänzen Informationen über die Außenwelt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>