<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧔🏽 💼 👐🏼 Option pour utiliser la blockchain de crypto-monnaie comme moyen de transfert de commandes pour les éléments de botnet 🈂️ ✏️ 😠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je voudrais développer l'idée mentionnée dans l'article «Suivez l'argent: comment le groupe RTM a commencé à cacher les adresses des serveurs C&C dans...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Option pour utiliser la blockchain de crypto-monnaie comme moyen de transfert de commandes pour les éléments de botnet</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466609/">  Je voudrais développer l'idée mentionnée dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">«Suivez l'argent: comment le groupe RTM a commencé à cacher les adresses des serveurs C&amp;C dans un</a> portefeuille crypté <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">»</a> , qui les a regroupées dans le nombre de Satoshi répertoriés pour deux transactions sur une adresse cryptographique spécifique.  Le malware, demandant les données de transfert à une telle adresse depuis le navigateur de la blockchain, a attribué l'IP du nouveau serveur C&amp;C par de simples manipulations. <br><br>  Nous allons omettre et condamner les intentions criminelles de ce groupe et nous attarderons précisément sur les principes et le processus de transmission des commandes aux éléments du botnet (EBS). <br><br>  À mon humble avis, cette méthode présente certains inconvénients - la bande passante de cette méthode (en termes de quantité d'informations par transfert) est petite, et toute personne connaissant une telle adresse de chiffrement peut lui envoyer une certaine quantité et synchroniser le botnet, l'obligeant à contacter un »Pour eux au serveur. <br><br>  Cependant, les commandes EBS masquées peuvent être envoyées non pas à une adresse distincte, mais à partir d'une adresse A distincte, a priori approuvée pour elles.  Dans ce cas, personne (sauf une personne détenant une clé privée) ne peut effectuer une telle opération. <br><br>  L'ensemble des commandes peut être étendu en envoyant des montants aux adresses générées par l'administrateur du botnet, au nom desquelles les informations de contrôle nécessaires sont encodées / cryptées. <br><a name="habracut"></a><br>  Dans ce cas, une commande de 20 octets maximum (lettres, chiffres, caractères spéciaux) est convertie (texte en hexadécimal) en hexadécimal puis en une adresse de chiffrement B valide. Dans ce cas, la commande elle-même peut être codée / chiffrée. <br><br>  Permettez-moi de vous donner un exemple fantastique.  Pour plus de clarté (PoC), j'ai utilisé un certain nombre de services en ligne disponibles. <br><br>  <b>1.</b> À partir d'une adresse de confiance A, un certain montant est transféré à l'adresse valide générée B. <br><br>  Exemple de génération d'adresse B: il est nécessaire d'envoyer des informations sur le serveur 82.192.95.175 à l'EBS, à partir desquelles il est possible de recevoir la commande de mise à jour du module serveur # 68, l'heure d'activation / désactivation du module, ainsi que la clé de chiffrement (ou l'adresse du navigateur de blockchain supplémentaire, la commande d'exécution) au plus tard à la date transmise, une nouvelle adresse cryptée, clé, etc., etc. de confiance (la clé peut être cousue dans l'agent utilisateur et transférée uniquement s'il est nécessaire de la modifier, économisant ainsi 7 octets du champ de commande)). <br><br>  Il est possible de convertir IP d'une centaine de façons, par exemple 082.192.095.175&gt; 08.21.92.09.51.75 + 32 en chaque nombre (éviter les caractères ASCII illisibles). <br><br>  Total 40.53.124.41.83.107 = (5 |) Sk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">représente en</a> ASCII (6 octets); <br>  Équipe 68 = D; <br><br>  Le temps d'activation du module est 601234 = en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">temps Unix</a> , où le premier chiffre 1 est redondant, nous ne le transmettrons pas (c'est par défaut, car le passage à 2 ne sera qu'en 2033), les trois chiffres inférieurs sont également par défaut 000, car .  peu importe, c'est + - 15 minutes. <br><br>  Heure d'activation - 1601234000 = 27 septembre 2019 13.13.20 GMT <br><br>  Ensuite, quatre chiffres, jusqu'à ce que le module doit fonctionner - 0365 (jours) à partir de l'heure d'activation. <br><br>  C'est-à-dire 6012340365 = 01665D088Dh = AAHpKn en ASCII.  Supposons également que la clé précédente était Key0001. <br><br>  Total (5 |) SkDAAHpKnKey0002 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilisant RC4</a> et Key0001 donne en hex: DD F6 B8 16 2A B6 71 97 0F 9F A2 68 79 11 8C B6 31 DA FE 43. <br><br>  Nous convertissons cette <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hashtoaddress</a> en une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ancienne</a> adresse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">btc</a> (il est possible aux adresses d'autres crypto-monnaies dash, ltc, dogecoin, etc., cela n'a pas d'importance, les algorithmes pour générer des adresses crypto sont ouverts, le transfert sera moins cher et plus rapide). <br><br>  Nous obtenons l'adresse B (héritée) - 1MEdtjmGtqaGPaoYAQn43dkZxiSrSD8gmD. <br>  (Je vous rappelle qu'en face est ajouté un «1» - un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">signe d'</a> octet, à la fin - contrôle 4 octets). <br><br>  Cette <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ressource</a> permet de voir de visu le processus de conversion pas à pas (insérer DDF6 ... sur la ligne 3 (RIPEMD-160 Hash of 2)). <br><br><img src="https://habrastorage.org/webt/ay/gr/-t/aygr-tgwwogg2xmwx6wxme4btlg.jpeg"><br><br>  Cependant, afin de ne pas se démarquer de l'ensemble des adresses du format segwit déjà standard, présentons notre ligne comme (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ). <br><br><img src="https://habrastorage.org/webt/s7/9c/_x/s79c_xcfw0vuvrgfdqtm49e18is.jpeg"><br><br>  Adresse B (segwit) - bc1qmhmts932kecewrul5f58jyvvkcca4ljrrgmpcd <br><br>  <b>2.</b> Nous envoyons un transfert de plusieurs centaines / milliers de satoshi à cette adresse de confiance A.  Le montant du transfert peut également contenir des informations (par exemple, une vérification supplémentaire sur une base convenue, un caractère de commande pour la destruction inconditionnelle / l'arrêt temporaire du botnet sans avoir à lire la commande transmise dans l'adresse, etc.). <br>  Je porterai une attention particulière au fait que lors de l'envoi, il faut garder à l'esprit que l'adresse de livraison doit être la même que l'adresse de livraison, ou enregistrer l'adresse e-mail de livraison comme une nouvelle adresse de confiance. <br>  Une transaction est confirmée en moyenne plusieurs minutes (sous réserve du paiement d'une commission suffisante flottante en fonction de la charge du réseau). <br><br>  Le coût du transfert d'un montant de 1 000 satoshi sera de 7 roubles.  (plus commission de 2-3 roubles).  Je répète qu'avec d'autres crypto-monnaies, cela peut être plus rapide et moins cher des dizaines / centaines de fois. <br><br>  <b>3.</b> De la part de l'EBS, il y a une enquête périodique des navigateurs blockchain (par API) de la liste disponible (les navigateurs sont présentés dans un large assortiment) sur le transfert de A. <br>  Lorsque le fait d'envoyer une nouvelle transaction avec A (et de la confirmer) est révélé, les informations contenues dans l'adresse du destinataire vers lequel le transfert a été effectué sont décryptées (décodées) par la clé reçue et acceptées pour exécution. <br><br>  Supposons que l'adresse de confiance soit bc1qsj0gm0r2c3hzq9yzfewl34yk2r760hy5za4x3q (format segwit). <br>  À cette adresse, la dernière <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">transaction sortante</a> (environ n'est pas la dernière, mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">celle-ci</a> ) est passée à deux adresses - bc1qmhmts932kecewrul5f58jyvvkcca4ljrrgmpcd et le changement était le même que l'adresse d'envoi. <br>  Le montant transféré - 666 Satoshi - nous décidons qu'il s'agit d'une commande conditionnelle pour effectuer le décodage. <br><br><img src="https://habrastorage.org/webt/d8/v9/w3/d8v9w3z69xfusw2kuehvp9glunw.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Décodez</a> notre adresse en DDF6 .... <br>  Convertissez au format (5 |) SkD34 ,, +! Key0002 et déchiffrez avec Key0001 (la clé se transforme en Key0002). <br><br>  Téléchargez le module depuis le serveur (l'accès au serveur peut être implémenté avec la même clé) et attendez la date de lancement du module. <br><br>  Je note qu'il est nécessaire d'utiliser au moins plusieurs navigateurs (ils peuvent déconnecter ou restreindre les demandes de certains pays, comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bitflyer.jp</a> , restreindre le russe et partir du japonais IP). <br><img src="https://habrastorage.org/webt/h1/sp/70/h1sp70_pm2mccze3ypt9rxyppck.jpeg"><br><br>  Les informations reçues peuvent être vérifiées au moins sur un / deux.  Le choix des navigateurs est excellent, seulement dans la liste des types Electrum, il y en a plus d'une douzaine - blockchair.com, smartbit.com.au, bitupper.com, chain.so et bien d'autres.  autre <br><br><img src="https://habrastorage.org/webt/rm/nb/cw/rmnbcwagk67msr831bp0ye742y0.jpeg"><br><br>  Veuillez noter que tous les navigateurs ne prennent pas en charge le format segwit.  Par conséquent, vous devez choisir un terrain d'entente, utiliser l'adresse de confiance de l'ancien ou du nouveau format. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple d'</a> envoi à partir d'une adresse de confiance dans l'ancien format 186A8D7vdAHpFWdSAFHzZGfi44pPcwtZNc vers l'adresse héritée générée en brut <br><br><img src="https://habrastorage.org/webt/cm/lz/ql/cmlzqlnpcmqmq7tqio1w7ry6lqa.jpeg"><br><br>  et l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">adresse segwit</a> <br><br><img src="https://habrastorage.org/webt/zc/-o/qz/zc-oqziyq_8e0mjeuz_8rwujenk.jpeg"><br><br>  <i>L'utilisation de divers navigateurs blockchain souligne leur diversité.</i> <br>  Je rappelle qu'un message caché dans une adresse d'une transaction à truquer pour qu'il soit confirmé est impossible par définition. <br><br><h4>  Avantages de l'algorithme </h4><br><ol><li>  Il n'y a pas de serveur C2, les appels vont aux navigateurs de la blockchain. </li><li>  Les commandes pour EBS sont approuvées sans condition. </li><li>  Le support d'envoi de commandes est la blockchain, qui ne permet pas de bloquer l'envoi / l'envoi de commandes. </li><li>  La blockchain est un système extrêmement stable (cela ne s'applique pas à la volatilité des crypto-monnaies). </li><li>  Faible coût de fourniture du travail. </li><li>  Implémentation d'algorithme simple (données et code open source). </li><li>  Pas besoin de générer des transactions ou de télécharger la blockchain. </li></ol><br><h4>  Caractéristiques de l'algorithme </h4><br><ol><li>  Communication simplex. </li><li>  Dépendance à la stabilité des navigateurs. </li><li>  Certains coûts financiers (quoique minimes). </li></ol><br>  Je crois que certains des points donnés ici sont utiles à considérer pour les experts en sécurité de l'information. <br><br>  Il serait intéressant d'augmenter la stabilité du botnet, en plus des observateurs, pour attirer les capacités de nœuds complets ou de nœuds de portefeuilles populaires tels que l'électrum, ainsi que d'organiser la communication duplex en générant les transactions nécessaires du côté du système bancaire électronique.  Je serais reconnaissant pour les réflexions à ce sujet, ainsi que pour les critiques et suggestions raisonnables. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466609/">https://habr.com/ru/post/fr466609/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466599/index.html">Comment contourner le captcha en utilisant la reconnaissance sonore</a></li>
<li><a href="../fr466601/index.html">Livres psychologiques d'auto-assistance: ont-ils même un sens, et si oui, lesquels choisir?</a></li>
<li><a href="../fr466603/index.html">Outil de comparaison des frameworks CSS</a></li>
<li><a href="../fr466605/index.html">Laboratoire radio de Nizhny Novgorod et communication radio amateur sur HF</a></li>
<li><a href="../fr466607/index.html">"Tout ce que vous lirez sera utilisé contre vous": comment la musique rap est entrée dans la salle d'audience</a></li>
<li><a href="../fr466611/index.html">Ce que vous ne pouvez pas demander et pourquoi vous ne pouvez pas féliciter les employés si vous voulez qu'ils fonctionnent bien</a></li>
<li><a href="../fr466615/index.html">Recettes TeamCity. Signaler Yandex.Taxi</a></li>
<li><a href="../fr466623/index.html">Création d'un curseur de plage de valeurs pour un filtre sans utiliser jQuery</a></li>
<li><a href="../fr466625/index.html">Aller au-delà du pod dans Kubernetes grâce aux journaux de montage</a></li>
<li><a href="../fr466629/index.html">Pourquoi votre application a-t-elle besoin d'accessibilité</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>