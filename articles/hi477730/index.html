<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯЫ╡ ЁЯзЬ тЖЦя╕П рдЪрд┐рдкрд╡рд┐рд╕реНрдкрд░рд░: рдореИрдЧреНрдорд╛ рдкрд░ рдКрд░реНрдЬрд╛ рд╣рдорд▓рд╛ тШГя╕П ЁЯСз ЁЯжК</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rakf рджреНрд╡рд╛рд░рд╛ рдкреЛрд╕реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ 





 рдбрд┐рдЬрд┐рдЯрд▓ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рд╣реИрдХ 2019 рдХреА рдЧрд░реНрдорд┐рдпреЛрдВ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдПрдХ рдмрд┐рдЬрд▓реА рдХреЗ рд╣рдорд▓реЗ рд╕реЗ рдирд┐рдкрдЯрд╛ рдФрд░ рдЪрд┐рдк рд╡реЙрд╢рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЪрд┐рдкрд╡рд┐рд╕реНрдкрд░рд░: рдореИрдЧреНрдорд╛ рдкрд░ рдКрд░реНрдЬрд╛ рд╣рдорд▓рд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/"><p>  <a href="https://habr.com/ru/users/rakf/" class="user_link">Rakf</a> рджреНрд╡рд╛рд░рд╛ рдкреЛрд╕реНрдЯ рдХрд┐рдпрд╛ <a href="https://habr.com/ru/users/rakf/" class="user_link">рдЧрдпрд╛</a> </p><br><p><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br><p>  рдбрд┐рдЬрд┐рдЯрд▓ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рд╣реИрдХ 2019 рдХреА рдЧрд░реНрдорд┐рдпреЛрдВ рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдПрдХ рдмрд┐рдЬрд▓реА рдХреЗ рд╣рдорд▓реЗ рд╕реЗ рдирд┐рдкрдЯрд╛ рдФрд░ рдЪрд┐рдк рд╡реЙрд╢рд░ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд┐рдпрд╛ред </p><br><h2 id="chto-eto">  рдпрд╣ рдХреНрдпрд╛ рд╣реИ </h2><br><p>  рдКрд░реНрдЬрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рддреАрд╕рд░реЗ рдкрдХреНрд╖ рдХреЗ рдЪреИрдирд▓реЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╣рдорд▓рд╛ рд╣реИред  рдпрд╣реА рд╣реИ, рд╕рд┐рд╕реНрдЯрдо рдХреЗ рднреМрддрд┐рдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рджрд┐рдЦрд╛рдИ рджреЗрдиреЗ рд╡рд╛рд▓реА рдЬрд╛рдирдХрд╛рд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╣рдорд▓реЗред </p><br><p>  рд╣рдорд▓рд╛рд╡рд░ рдХреЗ рд▓рд┐рдП рдХреНрдпрд╛ рдЬрд╛рдирдХрд╛рд░реА рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИ: </p><br><ul><li>  рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд┐рдХ рд░реВрдкрд╛рдВрддрд░рдг рд╕рдордп; </li><li>  рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд; </li><li>  рд╡рд┐рджреНрдпреБрдд рдЪреБрдореНрдмрдХреАрдп рдХреНрд╖реЗрддреНрд░; </li><li>  рд╢реЛрд░ рдЖрджрд┐ред </li></ul><br><p>  рдПрдХ рдКрд░реНрдЬрд╛ рд╣рдорд▓реЗ рдХреЛ рд╕рдмрд╕реЗ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </p><a name="habracut"></a><br><h2 id="pochemu-rabotaet">  рдпрд╣ рдХрд╛рдо рдХреНрдпреЛрдВ рдХрд░рддрд╛ рд╣реИ? </h2><br><p>  рдорд╛рдЗрдХреНрд░реЛрдкреНрд░реЛрд╕реЗрд╕рд░, рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░, рд░реИрдо рдФрд░ рдХрдИ рдЕрдиреНрдп рд▓реЙрдЬрд┐рдХ рд╕рд░реНрдХрд┐рдЯ рд╕реАрдПрдордУрдПрд╕ рддрдХрдиреАрдХ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред  CMOS рд╕рд░реНрдХрд┐рдЯ рдХреА рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдореЗрдВ рджреЛ рдШрдЯрдХ рд╣реЛрддреЗ рд╣реИрдВ: рд╕реНрдерд┐рд░ рдФрд░ рдЧрддрд┐рд╢реАрд▓ред  рд╕реНрдереИрддрд┐рдХ рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдмрд╣реБрдд рдХрдо рд╣реИ, рдЬреЛ рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХреЗ рд╡рд┐рдореБрджреНрд░реАрдХрд░рдг рдХреЗ рдХрд╛рд░рдгреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рдЧрддрд┐рд╢реАрд▓ рд╢рдХреНрддрд┐ рдЯреНрд░рд╛рдВрдЬрд┐рд╕реНрдЯрд░ рдХреЗ рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдХреЗ рдХрд╛рд░рдг рд╣реЛрддреА рд╣реИ рдФрд░ рд╕рдВрд╕рд╛рдзрд┐рдд рдбреЗрдЯрд╛ рдФрд░ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИред  рдЪреВрдВрдХрд┐ рд╕реНрдерд┐рд░ рдШрдЯрдХ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рд╕реНрдерд┐рд░ рд╣реИ, рдХреБрд▓ рд╢рдХреНрддрд┐ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХреЗрд╡рд▓ рдЧрддрд┐рд╢реАрд▓ рд╢рдХреНрддрд┐ рдХреЗ рдХрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП, рдХреБрд▓ рдКрд░реНрдЬрд╛ рдЦрдкрдд рдХрд╛ рдЙрдкрдпреЛрдЧ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><h2 id="instrumentariy">  рдЙрдкрдХрд░рдг </h2><br><p>  <a href="https://newae.com/tools/chipwhisperer/">ChipWhisperer</a> , рдореИрдВрдиреЗ 2-рднрд╛рдЧ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛: </p><br><p><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="ChipWhisperer 2-Part рд╕рдВрд╕реНрдХрд░рдг"></p><br><p>  рдЪрд┐рдкрд╡реНрд╣реАрдкрд░ рдПрдореНрдмреЗрдбреЗрдб рдЙрдкрдХрд░рдгреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдкрд░ рд╢реЛрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЦреБрд▓рд╛ рд╕реНрд░реЛрдд рдЯреВрд▓рдХрд┐рдЯ рд╣реИред  рдпрд╣ рдКрд░реНрдЬрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдФрд░ рддреНрд░реБрдЯрд┐ рдЖрдзрд╛рд░рд┐рдд рд╣рдорд▓реЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </p><br><p>  рд╢реБрд▓реНрдХ $ 250 рдХрд╛ рдЦрд░реНрдЪ рдЖрдПрдЧрд╛ред  рдбреЗрд╡рд▓рдкрд░реНрд╕ рдЗрд╕реЗ рдПрдХ рдХреНрд░рд╛рдВрддрд┐рдХрд╛рд░реА рд╕рдорд╛рдзрд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрдерд╛рди рджреЗрддреЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рдРрд╕реЗ рдкрд░рд┐рд╕рд░, рд░рдЪрдирд╛рдХрд╛рд░реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░, $ 30k рд╕реЗ рд▓рд╛рдЧрддред  рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ 2 рдмреЛрд░реНрдб рд╣реЛрддреЗ рд╣реИрдВ: рд▓рдХреНрд╖реНрдп рдФрд░ рдХреИрдкреНрдЪрд░ рдмреЛрд░реНрдбред </p><br><p>  рдЕрдиреНрдп рд╕рдВрд╕реНрдХрд░рдг рд╣реИрдВ, рдЙрдирдХреЗ рдлрд╛рдпрджреЗ (рд▓реЗрдХрд┐рди рдпрд╣ рднреА рдПрдХ рдмрдбрд╝реА рдХреАрдордд рдкрд░) рдХреЗ рд╕рд╛рде, рдЖрдк рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рдХреНрд╖реНрдп рдмреЛрд░реНрдб, рд╡рд┐рд╕реНрддрд╛рд░ рдХрд╛рд░реНрдб, рдЕрдкрдиреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рдкреВрд░реНрдг рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЬрд╛рдВрдЪ рднреА рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдХреЗрд╡рд▓ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП ChipWhisperer рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  ChipWhisperer рдореЗрдВ рдПрдХ рдЙрддреНрдХреГрд╖реНрдЯ <a href="https://wiki.newae.com/Main_Page">рд╡рд┐рдХреА</a> , рдЫреЛрдЯреЗ рд╡рд┐рдХрд╛рд╕ <a href="https://chipwhisperer.readthedocs.io/en/latest/tutorials.html">рдкреНрд░рдпреЛрдЧрд╢рд╛рд▓рд╛рдПрдВ рд╣реИрдВ</a> , рдФрд░ 5 рд╡реЗрдВ рд╕рдВрд╕реНрдХрд░рдг рддрдХ рдЙрдиреНрд╣реЛрдВрдиреЗ рдЕрдЪреНрдЫрд╛ рдПрдкреАрдЖрдИ <a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">рдкреНрд░рд▓реЗрдЦрди</a> рднреА рдмрдирд╛рдпрд╛ рд╣реИред  рдХрдиреЗрдХреНрдЯ рдХрд┐рдП рдЧрдП рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдЯреНрд░реИрдХреНрд╕ рдХреЛ рдЙрдирдХреЗ рд╕реЙрдлрд╝реНрдЯрд╡реЗрдпрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ NumPy рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рд░рд┐рдХреЙрд░реНрдб рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рд▓рдХреНрд╖реНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдлрд░реНрдорд╡реЗрдпрд░ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд▓реИрдм рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рд╕рд┐рдлрд░реНрд╕ AES, DES, TEA рдХреЛ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЙрдирдХреЗ рд▓рд┐рдП, рдирд┐рд╢рд╛рди рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рддреИрдпрд╛рд░ рдлрд░реНрдорд╡реЗрдпрд░ рдФрд░ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рд╣реИрдВ (рд▓рд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдирдореВрдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛, рдСрдлрд╕реЗрдЯ, рдПрдбреАрд╕реА рдЖрд╡реГрддреНрддрд┐, рдЖрджрд┐)ред  рд╕реНрд╡рддрдВрддреНрд░ рдЕрдиреБрд╕рдВрдзрд╛рди рдХреЗ рд▓рд┐рдП рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдкреНрд░рдпреЛрдЧрд╛рддреНрдордХ рд░реВрдк рд╕реЗ рдЪреБрдирдирд╛ рд╣реЛрдЧрд╛ред </p><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЖрдк рд▓рдХреНрд╖реНрдп рдмреЛрд░реНрдб рдХреА рд╡рд┐рдлрд▓рддрд╛ рдХреЛ рднрдбрд╝рдХрд╛ рд╕рдХрддреЗ рд╣реИрдВ: рдШрдбрд╝реА рдХреЗ рд╕рд┐рдЧреНрдирд▓ рдореЗрдВ рдЦрд░рд╛рдмреА, рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдЫреЛрдбрд╝рдирд╛ рдФрд░ рдЧреБрдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдирд╛ред </p><br><p>  рдмрдбрд╝реЗ рдкрд░рд┐рд╕рд░реЛрдВ рдореЗрдВ, рдкрдЯрд░рд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЖрд╕реНрдЯрд╕реАрд▓рд╕реНрдХрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><h2 id="analiz">  рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h2><br><p>  рдХрдИ рдмреБрдирд┐рдпрд╛рджреА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╡рд┐рдзрд┐рдпрд╛рдБ рд╣реИрдВ: </p><br><ul><li>  рд╕рд░рд▓ рд╢рдХреНрддрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдПрд╕рдкреАрдП); </li><li>  рдЕрдВрддрд░ рд╢рдХреНрддрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдбреАрдкреАрдП); </li><li> рд╢рдХреНрддрд┐ рд╕рд╣рд╕рдВрдмрдВрдз рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рд╕реАрдкреАрдП)ред </li></ul><br><p>  рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдмрд┐рдЬрд▓реА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдкрд╛рд╡рд░ рдЧреНрд░рд╛рдл рдХрд╛ рдПрдХ рджреГрд╢реНрдп рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╢рд╛рдорд┐рд▓ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рд╣реА рд╡рд░реНрдг рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдФрд░ рдЧрд▓рдд рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдкрд░ рдкрд╛рд╕рд╡рд░реНрдб рдХреЛ рдПрдХ рдмрд╛рд░ рдореЗрдВ рдПрдХ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="рдкрд╛рд╕рд╡рд░реНрдб рд╢рдХреНрддрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдг"></p><br><p>  рдпрд╛ рдЖрдк рдкрдЯрд░рд┐рдпреЛрдВ рдкрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рд░рд╛рдЙрдВрдб рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдПрдХ рдХреБрдВрдЬреА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдбреЗрдЯрд╛ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕рд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЖрдВрдХрдбрд╝рд╛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдПрдИрдПрд╕ рдХреЗ 10 рдЪрдХреНрдХрд░ рджрд┐рдЦрд╛рддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="рдПрдИрдПрд╕ рдПрд╕рдкреАрдП"></p><br><p>  рд╡рд┐рднреЗрджрдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг (рдбреАрдкреАрдП) рд╕рд░рд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред рдбреАрдкреАрдП рдмрд┐рдЬрд▓реА рдХреЗ рдирд┐рд╢рд╛рди рдореЗрдВ рдЕрдВрддрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╡рд┐рдзрд┐рдпреЛрдВ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рдПрдХ рдмрд╣реБрдд рд╣реА рдкреНрд░рднрд╛рд╡реА рдЙрдкрдХрд░рдг, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдХреБрдВрдЬреА рдХреЛ "рдЦреЛрд▓рдиреЗ" рдХреЗ рд▓рд┐рдП рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдорд╛рд░реНрдЧреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреАред  рдореИрдВрдиреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рдЕрдВрдд рдореЗрдВ рдореИрдВ рдЙрди рд╕реНрд░реЛрддреЛрдВ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд▓рд┐рдВрдХ рджреВрдВрдЧрд╛ рдЬрд╣рд╛рдВ рдпрд╣ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╡рд░реНрдгрд┐рдд рд╣реИред </p><br><p>  рд╕рд╣рд╕рдВрдмрдВрдз рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛ рдЖрдзрд╛рд░ рдЧреБрдкреНрдд рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди рдХреБрдВрдЬреА рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рдЙрдкрдХрд░рдг рд╣реИред  рдХрднреА-рдХрднреА рдЗрд╕реЗ рдПрдХ рдЕрд▓рдЧ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рдкреГрдердХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХрднреА-рдХрднреА рдЗрд╕реЗ рдбреАрдкреАрдП рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрджрд░реНрднрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ рдбреАрдкреАрдП рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдо рдирд┐рд╢рд╛рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдореИрдВрдиреЗ рдЗрд╕реЗ рд╢рдХреНрддрд┐ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред  рдореИрдВ рдЖрдкрдХреЛ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ рдмрддрд╛рдКрдВрдЧрд╛ред </p><br><p>  рдореБрдЦреНрдп рдХрд╛рд░реНрдп рдЕрдзреНрдпрдпрди рдХреЗ рддрд╣рдд рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдКрд░реНрдЬрд╛ рдЦрдкрдд рдХрд╛ рдПрдХ рд╕рдЯреАрдХ рдореЙрдбрд▓ рдмрдирд╛рдирд╛ рд╣реИред  рдпрджрд┐ рдПрдХ рд╕рдЯреАрдХ рдореЙрдбрд▓ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдЕрдиреБрдорд╛рдирд┐рдд рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореВрд▓реНрдп рдХреЗ рдмреАрдЪ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╕рдВрдмрдВрдз рд╣реИред </p><br><p>  рдЬрд┐рди рдкрд╛рд╡рд░ рдореЙрдбрд▓ рдХрд╛ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЙрдирдореЗрдВ рд╕реЗ рдПрдХ рд╣реИрдорд┐рдВрдЧ рд╡реЗрдЯ рдореЙрдбрд▓ рд╣реИред  рдмрд╛рдЗрдирд░реА рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдореЗрдВ рд╣реИрдорд┐рдВрдЧ рдХрд╛ рд╡рдЬрди рдЧреИрд░-рд╢реВрдиреНрдп рдорд╛рдиреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИред  рдЗрд╕ рдореЙрдбрд▓ рдХреА рдзрд╛рд░рдгрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд╕реЗрдЯ рдмрд┐рдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ рдбрд┐рд╡рд╛рдЗрд╕ рджреНрд╡рд╛рд░рд╛ рдЦрдкрдд рдКрд░реНрдЬрд╛ рдХреЗ рд╕рд╛рде рд╕рд╣рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдЧреАред  рд╣реИрдорд┐рдВрдЧ рдХреЗ рд╡рдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдКрд░реНрдЬрд╛ рдХреА рдкрд╛рд░рдВрдкрд░рд┐рдХ рдЗрдХрд╛рдИ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣реИрдорд┐рдВрдЧ рдбрд┐рд╕реНрдЯреЗрдВрд╕ рдореЙрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ - 2 рдорд╛рдиреЛрдВ рдореЗрдВ рд╡рд┐рднрд┐рдиреНрди рдмрд┐рдЯреНрд╕ рдХреА рд╕рдВрдЦреНрдпрд╛ред </p><br><p>  рд╣реЗрдорд┐рдВрдЧ рд╡рдЬрди рдореЙрдбрд▓ рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдХреА рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд░реИрдЦрд┐рдХ рдкрд┐рдпрд░реНрд╕рди рдЧреБрдгрд╛рдВрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдПрдХ рдорд╛рддреНрд░рд╛ рдХреА рд░реИрдЦрд┐рдХ рдирд┐рд░реНрднрд░рддрд╛ рдХреЛ рджреВрд╕рд░реЗ рдкрд░ рджрд┐рдЦрд╛рддрд╛ рд╣реИред  рдПрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде, рдпрд╣ рдЧреБрдгрд╛рдВрдХ 1 рддрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </p><br><p>  рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд CPA рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореБрдЦреНрдп рдЪрд░рдг рд╣реЛрддреЗ рд╣реИрдВ: </p><br><ul><li>  рдЕрдЬреНрдЮрд╛рдд рдХреБрдВрдЬреА рдкрд░ рд╕рдВрджреЗрд╢реЛрдВ рдХреЛ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╕рдордп рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдХреЛ рд╣рдЯрд╛ рджреЗрдВ; </li><li>  рдЬрдм рд╣рдо рдХреБрдВрдЬреА рдЙрдк-рдмреНрд▓реЙрдХ рдХреЗ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рд╡реЗрд░рд┐рдПрдВрдЯ (рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП 256 рд╡рд┐рдХрд▓реНрдк) рдкрд░ рд╕рдорд╛рди рд╕рдВрджреЗрд╢ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЪрд┐рдк рдХреА рдКрд░реНрдЬрд╛ рдЦрдкрдд рдХрд╛ рдПрдХ рдореЙрдбрд▓ рдмрдирд╛рддреЗ рд╣реИрдВ; </li><li>  рд╣рдо рд╕рд┐рдореНрдпреБрд▓реЗрдЯреЗрдб рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХреЗ рд▓рд┐рдП рд░реИрдЦрд┐рдХ рд╕рд╣рд╕рдВрдмрдВрдз рдЧреБрдгрд╛рдВрдХ рдкрд╛рддреЗ рд╣реИрдВред  рдПрдХ рд╕рдЪреНрдЪреА рдХреБрдВрдЬреА рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЧреБрдгрд╛рдВрдХ 1 рд╣реЛ рдЬрд╛рдПрдЧрд╛; </li><li>  рд╢реЗрд╖ рдХреБрдВрдЬреА рдЙрдк-рдмреНрд▓реЙрдХ рдХреЗ рд▓рд┐рдП рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul><br><p>  рдирддреАрдЬрддрди, рдХреБрдВрдЬреА рдХреЛ рдЫреЛрдЯреЗ рднрд╛рдЧреЛрдВ рдореЗрдВ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдмрд╣рд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрджрд┐ рд╣рдо рдПрдХ рдмрд╛рд░ рдореЗрдВ рдХреБрдВрдЬреА рдХреЗ рдПрдХ рдмрд╛рдЗрдЯ рдкрд░ рд╣рдорд▓рд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдХреБрдВрдЬреА рдХреЗ рд▓рд┐рдП 2 <sup>8</sup> рдкреНрд░рдпрд╛рд╕реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк рдПрдИрдПрд╕ - 128 рдЪреБрдирддреЗ рд╣реИрдВ, рддреЛ рдХреБрдВрдЬреА рдХреЗ 16 рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА рдХреБрд▓ рд╕рдВрдЦреНрдпрд╛ 2 <sup>12</sup> рд╣реЛрдЧреА, рдЬреЛ рдХрд┐ 2 <sup>128 рдХреЛ</sup> рдорд╛рд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдмрд╣реБрдд рдмреЗрд╣рддрд░ рд╣реИред </p><br><h3 id="analiz-shifra-magma">  рдореИрдЧреНрдорд╛ рд╕рд┐рдлрд░ рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h3><br><p>  рдореИрдЧреНрдорд╛ рдПрдХ рдХреЛрдб рд╣реИ рдЬрд┐рд╕реЗ GOST R 34.12-2015 рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ GOST 28147-89, рдХреЗрд╡рд▓ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВред  рдПрдиреНрдХреНрд░рд┐рдкреНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдмреНрд▓реЙрдХ 32 рд░рд╛рдЙрдВрдб рд╕реЗ рдЧреБрдЬрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддреЗ рд╣реИрдВред  рдХреБрдВрдЬреА рдореЗрдВ 256 рдмрд┐рдЯ рд╣реЛрддреЗ рд╣реИрдВ, рдкреНрд░рддреНрдпреЗрдХ рдЧреЛрд▓ рдХреБрдВрдЬреА рдореВрд▓ рдХрд╛ рдПрдХ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="Feistel рдлрд╝рдВрдХреНрд╢рди GOST"></p><br><p>  рд╣рдо рд╕реАрдкреАрдП рдкрджреНрдзрддрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдЖрдВрдХрдбрд╝реЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗред </p><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдПрдХ рдордзреНрдпрд╡рд░реНрддреА рдореВрд▓реНрдп рдЪреБрдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЬреЛ рдЬреНрдЮрд╛рдд рдбреЗрдЯрд╛ рдФрд░ рдХреБрдВрдЬреА рдХреЗ рдПрдХ рдЫреЛрдЯреЗ рд╣рд┐рд╕реНрд╕реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╕рд░рд▓ рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рдорд╛рди рдПрд╕-рдмреЙрдХреНрд╕ рдЖрдЙрдЯрдкреБрдЯ рд╣реИ (рдореИрдЧреНрдорд╛ рдореЗрдВ рдЕрдм 1 рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рддрд╛рд▓рд┐рдХрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реЗ рдХреЗ рдРрд╕реЗ рд╣рдорд▓реЛрдВ рдХреЛ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ) (рдЦреБрд▓реЗ рдЧреНрд░рдВрдереЛрдВ рдХреЛ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ) рдпрд╛ рдЕрдВрддрд┐рдо рджреМрд░ (рд╕рд┐рдлрд░рдЯреЗрдХреНрд╕ рдЬреНрдЮрд╛рдд рд╣реИрдВ)ред </p><br><p>  рдореИрдВрдиреЗ рдкреНрд░рд╕рд┐рджреНрдз рдЦреБрд▓реЗ рдЧреНрд░рдВрдереЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдХреБрдВрдЬреА рдкрд░ рд╢реЛрдз рдХрд┐рдпрд╛, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдкрд░ рдЖрдЧреЗ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдореИрдЧреНрдорд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ рдбреЗрд╕, рдПрдИрдПрд╕ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдХ рдЧреЛрд▓ рдХреБрдВрдЬреА рдХреЗ рд╕рд╛рде 32-рдмрд┐рдЯ рдмреНрд▓реЙрдХ рдХрд╛ рдЬреЛрдбрд╝ рдореЛрдбреБрд▓реЛ 2 <sup>32</sup> рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдПрд╕-рдмреЙрдХреНрд╕ рдХреЗ рдЕрдВрддрд┐рдо рдЖрдЙрдЯрдкреБрдЯ рд╕реЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╢реБрд░реВ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЙрдЪреНрдЪрддрдо рдорд╛рди рдЬреЛрдбрд╝рдиреЗ рд╕реЗ рдпреБрд╡рд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред  рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рдПрд╕-рдмреЙрдХреНрд╕ рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ: рдкрд╣рд▓реЗ 8, рдлрд┐рд░ 8, 7 рдФрд░ рдЗрд╕реА рддрд░рд╣ рдкрд╣рд▓реЗ рджрд┐рдП рдЧрдПред  рдЯреНрд░реИрдХ рд╣рдЯрд╛рдиреЗ рдХреЛ 8-рдмрд┐рдЯ рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░ рдкрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдФрд░ рд╣рдо рдпрд╣ рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рджреЛрд╣рд░реА рдПрд╕-рдмреЙрдХреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдореИрдВ рддреБрд░рдВрдд 1 рдмрд╛рдЗрдЯ рдкрд░ рд╣рдорд▓рд╛ рдХрд░реВрдВрдЧрд╛ред </p><br><p>  рдЕрдВрддрд┐рдо рдХреБрдВрдЬреА рдмрд╛рдЗрдЯ рдХреЗ рд▓рд┐рдП рдКрд░реНрдЬрд╛ рдореЙрдбрд▓ рдХреА рдЧрдгрдирд╛: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[leak("Gost28147_tc26_ParamZ", kguess, block2ns(text[tnum])[0], 0)]</span></span></code> </pre> <br><p>  рдЬрд╣рд╛рдВ рд▓реАрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдо рдмрд╛рдЗрдЯ рдХрд╛ рдПрд╕-рдмреЙрдХреНрд╕ рдЖрдЙрдЯрдкреБрдЯ рджреЗрддрд╛ рд╣реИред </p><br><p>  рд╣рдо рд╕реВрддреНрд░ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рд┐рдореНрдпреБрд▓реЗрдЯреЗрдб рдФрд░ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореВрд▓реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рд░реИрдЦрд┐рдХ рдкрд┐рдпрд░рд╕рди рдЧреБрдгрд╛рдВрдХ рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ: </p><br><p><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="рд╕рд╣-рд╕рдВрдмрдВрдз"></p><br><pre> <code class="python hljs"> cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-comment"><span class="hljs-comment">#Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span></span></code> </pre> <br><p>  рдЬрдм рдПрдХ рд╕рдЪреНрдЪреЗ рдЙрдкрдХреБрдВрдЬреА рдЪреБрдирддреЗ рд╣реИрдВ, рддреЛ рд╕рд╣рд╕рдВрдмрдВрдз рдЧреБрдгрд╛рдВрдХ рдореЗрдВ рдПрдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡реГрджреНрдзрд┐ рд╣реЛрдЧреА: </p><br><p><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="Correlation1"></p><br><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЧреЛрд▓ рдХреБрдВрдЬреА рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдЯ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number"><span class="hljs-number">8</span></span>) | best_round ...</code> </pre> <br><p>  рдкрд╣рд▓реЗ рд░рд╛рдЙрдВрдб рдХреА рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рд╣рдо рдЙрд╕реА рддрд░рд╣ рд╕реЗ 2 рдФрд░ рдмрд╛рдж рдХреА рд░рд╛рдЙрдВрдб рдХреАрдЬ рдХреА рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдПрдХ рдкреВрд░реНрдг рдореИрдЧреНрдорд╛ рдХреБрдВрдЬреА 8 рдЧреЛрд▓ рдХреБрдВрдЬреА рдирд┐рдХрд╛рд▓рдХрд░ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред </p><br><p>  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ, рдХрдИ рдмрд╛рд░реАрдХрд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИрдВред  рдПрдИрдПрд╕, рдбреЗрд╕, рдЧреНрд░рд╛рд╕рд╣реЙрдкрд░ рд╕рд┐рдлрд░реНрд╕ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдХ рдкреНрд▓реЗрдирдЯреЗрдХреНрд╕реНрдЯ рд░рд╛рдЙрдВрдб рдХреА рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдореЙрдбреБрд▓реЛ 2 <sup>32</sup> рд╣реЛрддрд╛ рд╣реИред  рдХрдо рдмрд┐рдЯреНрд╕ рдХрд╛ рдЬреЛрдбрд╝ XORa рдХреЗ рд╡рд┐рдкрд░реАрдд рдЙрдЪреНрдЪ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдж рдХреЗ рдЙрдкрдХреБрдВрдЬреА рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХреЛ рдЕрддреАрдд рдХреЗ рдкрд░рд┐рдгрд╛рдореЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕реА рддрд░рд╣ рдЧреЛрд▓ рдЪрд╛рдмрд┐рдпреЛрдВ рдХреЗ рд╕рд╛рдеред  рдбреЗрдЯрд╛ рдмрд╣реБрдд рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред  рдпрджрд┐ рдХрд┐рд╕реА рдПрдХ рдорд╛рди рдХреА рдЧрд▓рдд рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рддреЛ рдЖрдЧреЗ рдХреА рдкреВрд░реА рдЧрдгрдирд╛ рдЧрд▓рдд рд╣реЛрдЧреАред </p><br><p>  рдпрд╣ рднреА рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдЕрдм рдПрдХ рдЪрд┐рдк рдвреВрдВрдврдирд╛ рдХрд╛рдлреА рдореБрд╢реНрдХрд┐рд▓ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдЪрд╛рд░-рдмрд┐рдЯ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╣реИ: рдЕрдзрд┐рдХрд╛рдВрд╢ рдЪрд┐рдкреНрд╕ рдореЗрдВ рдЖрда-рдмрд┐рдЯ рд╣реЛрддреЗ рд╣реИрдВред  рдмреЗрд╢рдХ, рд╡рд┐рд╢реЗрд╖ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд╝рд┐рдХ рдЪрд┐рдкреНрд╕ рд╣реИрдВ рдЬреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╕реБрд░рдХреНрд╖рд╛ рд░реВрдкрд╛рдВрддрд░рдг рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо (рдпрд╛ рдХрдИ рдПрд▓реНрдЧреЛрд░рд┐рджрдо) рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВ рдФрд░ рдЗрдирдореЗрдВ рд╕рдмрд╕реЗ рдХреБрд╢рд▓ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рд╣реИред </p><br><p>  рдбреАрдИрдПрд╕ рд╕рд┐рдлрд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣ рдХреЗ рдХреНрд░рд┐рдкреНрдЯреЛрдкреНрд░реЛрд╕реЗрд╕рд░ рдореЗрдВ рдореИрдЧреНрдорд╛ рдХреЗ рд▓рд┐рдП рдЫрд╣-рдмрд┐рдЯ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ - рдПрдХ рдЪрд╛рд░-рдмрд┐рдЯ рдПрдХ, рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдПрд╕-рдмреЙрдХреНрд╕ рдХреЛ рдЕрд▓рдЧ рд╕реЗ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдореЗрд░рд╛ рд▓рдХреНрд╖реНрдп рдбрд┐рд╡рд╛рдЗрд╕ 8-рдмрд┐рдЯ рд╣реИ, рдФрд░ "рдореИрдЧреНрдорд╛" рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдореЗрдВ рдЖрда рдмрд┐рдЯреНрд╕ рдкрд░ рд░реВрдкрд╛рдВрддрд░рдг рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЕрд░реНрдерд╛рдд  рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди 2 рдПрд╕-рдмреЙрдХреНрд╕ рдкрд░ рд╣реЛрдЧрд╛, 2 рдПрд╕-рдмреЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП рдмрд┐рдЬрд▓реА рдХреА рдЦрдкрдд рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрджрд┐ S- рдмреЙрдХреНрд╕ рдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ, рд╕реАрдирд┐рдпрд░ рдпрд╛ рдЬреВрдирд┐рдпрд░, рд╕рдЪреНрдЪреА рдХреБрдВрдЬреА рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ, рдФрд░ рджреВрд╕рд░рд╛ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдЙрдЪреНрдЪ рд╕рд╣рд╕рдВрдмрдВрдз рдлрдЯ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рдЙрдкрд░реЛрдХреНрдд рд╕рднреА рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдореИрдЧреНрдорд╛ рд╕рд┐рдлрд░ рдХреЗ рд▓рд┐рдП рдКрд░реНрдЬрд╛ рдЦрдкрдд рдкрде рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╣реИ: </p><br><div class="spoiler">  <b class="spoiler_title">рдкрд╛рдпрдерди рд▓рд┐рдкрд┐</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np path = <span class="hljs-string"><span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span></span> traces = np.load(path + <span class="hljs-string"><span class="hljs-string">'traces.npy'</span></span>) text = np.load(path + <span class="hljs-string"><span class="hljs-string">'textin.npy'</span></span>) keys = np.load(path + <span class="hljs-string"><span class="hljs-string">'keylist.npy'</span></span>) HW = [bin(n).count(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>)] SBOXES = {<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>: ( (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), )} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_K</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s, _in)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" S-box substitution :param s: S-box :param _in: 32-bit word :returns: substituted 32-bit word """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (s[<span class="hljs-number"><span class="hljs-number">0</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">1</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">2</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">3</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">4</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">5</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">6</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">7</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">28</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block2ns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Convert block to N1 and N2 integers """</span></span> data = bytearray(data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( data[<span class="hljs-number"><span class="hljs-number">7</span></span>] | data[<span class="hljs-number"><span class="hljs-number">6</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, data[<span class="hljs-number"><span class="hljs-number">3</span></span>] | data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addmod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, mod=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ** </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Modulo adding of two integers """</span></span> r = x + int(y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r &lt; mod <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r - mod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_shift11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 11-bit cyclic shift """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) | ((x &gt;&gt; (<span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">11</span></span>)) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, byte)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] _in = addmod(data, key) sbox_leak = _K(s, _in); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sbox_leak &gt;&gt; (<span class="hljs-number"><span class="hljs-number">8</span></span> * byte)) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Feistel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, nround)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] w = bytearray(key) x = [ w[<span class="hljs-number"><span class="hljs-number">3</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] | w[<span class="hljs-number"><span class="hljs-number">2</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | w[<span class="hljs-number"><span class="hljs-number">1</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | w[<span class="hljs-number"><span class="hljs-number">0</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>) ] n1, n2 = block2ns(data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nround): n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n1 numtraces = len(traces) numpoint = np.shape(traces)[<span class="hljs-number"><span class="hljs-number">1</span></span>] bestguess = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">32</span></span> round_data = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * numtraces <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[i] = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): best_round = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tnum_r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[tnum_r][rnum] = Feistel(<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>, bestguess, text[tnum_r], rnum) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero best_round_key = kguess &lt;&lt; (bnum * 8) | best_round sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[round("Gost28147_tc26_ParamZ", best_round_key, round_data[tnum][rnum], bnum)] #Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess])) best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * 8)) bestguess[((rnum + 1) * 4)-bnum - 1] = np.argmax(maxcpa) print "Best Key Guess: " for b in bestguess: print "%02x "%b,</span></span></code> </pre> </div></div><br><p>  <a href="https://github.com/rakf/ChipWhisperer/tree/master/GOST">рдЧрд┐рдЯрд╣рдм рдкрд░рд┐рдгрд╛рдо рд░рд┐рдкреЛрдЬрд┐рдЯрд░реА</a> </p><br><h2 id="vyvody">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рдЕрдзреНрдпрдпрди рдХреЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рд░реВрдк рдореЗрдВ, рдореИрдВрдиреЗ рдЪреАрдкрд╡рд┐рдпрд░реНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд┐рдпрд╛ред  рдЗрд╕ рддрдереНрдп рдХреЗ рдмрд╛рд╡рдЬреВрдж рдХрд┐ рдореИрдВрдиреЗ рд╕рднреА рдЙрдкрдХрд░рдгреЛрдВ рдХреА рдХреЛрд╢рд┐рд╢ рдирд╣реАрдВ рдХреА (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЧреНрд▓рд┐рдЪрд┐рдВрдЧ), рдореБрдЭреЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЪрд┐рдкрд╡рд░реНрдкрд░ рдЙрдкрдпреЛрдЧреА рд▓рдЧрддрд╛ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдЖрдк рдорд╣рдВрдЧреЗ рд╡рд┐рд╢реЗрд╖ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЦрд░реАрджрдирд╛ рдирд╣реАрдВ рдЪрд╛рд╣рддреЗ рд╣реИрдВред </p><br><p>  рдКрд░реНрдЬрд╛ рдХреА рдЦрдкрдд рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рд╕рд┐рдлрд░ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП, рдпрд╣ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╕рд┐рдлрд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЗрд╕ рд╣рдорд▓реЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдкреНрд░рддрд┐рд░реЛрдзреА рд╣реИ, рд▓реЗрдХрд┐рди рдкрд░реНрдпрд╛рдкреНрдд рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде, рдХреБрдВрдЬреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд┐рдирд╛ рдкреНрд░рд╛рдкреНрдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред </p><br><p>  рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА: </p><br><ul><li>  рдкреАред рдХреЛрдЪрд░ рдбрд┐рдлрд░реЗрдВрд╢рд┐рдпрд▓ рдкрд╛рд╡рд░ рдПрдирд╛рд▓рд┐рд╕рд┐рд╕ </li><li>  "рдкрд╛рд╡рд░ рдПрдирд╛рд▓рд┐рд╕рд┐рд╕ рдЕрдЯреИрдХ: рд╕реНрдорд╛рд░реНрдЯ рдХрд╛рд░реНрдбреНрд╕ рдХреЗ рд░рд╛рдЬ рдХрд╛ рдЦреБрд▓рд╛рд╕рд╛" </li><li>  <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">рдмрдВрджреВрдХ рдХреА рдиреЛрдХ рдкрд░ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА I: рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлрд╝рд┐рдХ рдПрд▓реНрдЧреЛрд░рд┐рджрдо</a> рдЖрд░ред рдХреЛрд░реНрдХрд┐рдХрди <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">рдХреА рдХреБрдВрдЬреА рдХреА</a> рддрд▓рд╛рд╢ рдореЗрдВред </li><li>  рдЧрдирдкреЙрдЗрдВрдЯ <a href="https://xakep.ru/2015/01/27/kriptogry-191/">II рдкрд░ рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА: рдЕрдВрддрд░ рдкреЛрд╖рдг рд╡рд┐рд╢реНрд▓реЗрд╖рдг</a> рдЖрд░ред рдХреЛрд░реНрдХрд┐рдХрдиред </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">рдЬреАрд░реЛрдирд╛рдЗрдЯреНрд╕ 2014</a> рдЖрд░ред рдХреЛрд░реНрдХрд┐рдХрди рдХреЗ <a href="https://xakep.ru/2015/01/27/kriptogry-191/">рд╕рд╛рде рд░рд┐рдкреЛрд░реНрдЯ</a> ред </li><li>  рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреАрд░реЛрдирд╛рдЗрдЯреНрд╕ 2014 рдХреЗ рд╕рд╛рде <a href="http://2014.zeronights.org/assets/files/slides/cryptocodingv2.pdf">рдХреНрд░рд┐рдкреНрдЯреЛрдХрд░рдВрд╕реА v2</a> ред </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi477730/">https://habr.com/ru/post/hi477730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi477716/index.html">рдЧрдгрд┐рддрдЬреНрдЮ "рдЯреИрдЧ" рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдпрд╛рджреГрдЪреНрдЫрд┐рдХрддрд╛ рдХреИрд╕реЗ рд╣реЛрддреА рд╣реИ</a></li>
<li><a href="../hi477718/index.html">рд╕рдВрд╡рд╛рджреА рдкрд░рдд: рд╢рдореВрдПрд▓ рд╡рд┐рдиреЛрдЧреНрд░рд╛рдж рдХреА рд╡рд┐рдзрд┐ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рддреЗрдЬреА рд╕реЗ рджреГрдврд╝ рд╕рдВрдХрд▓реНрдк</a></li>
<li><a href="../hi477722/index.html">C ++ рдореЗрдВ Google рд╕реНрдЯрд╛рдЗрд▓ рдЧрд╛рдЗрдбред рднрд╛рдЧ 8</a></li>
<li><a href="../hi477724/index.html">рдПрдЪрдЖрд░ рдмреНрд░рд╛рдВрдб рд╣реИрдмреНрд░рд╛рд╕реЗрдорд┐рдирд╛рд░: рдкреНрд░рддрд┐рднрд╛, рд╢рд┐рдХрд╛рд░ рдФрд░ рд╕рд╛рдордЧреНрд░реА рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ</a></li>
<li><a href="../hi477728/index.html">рдЯреАрдо рд▓реАрдб рдХреНрдпрд╛ рдХрд░реЗрдВ рддрд╛рдХрд┐ рдЯреАрдо рдмрд╛рд╣рд░ рди рдЬрд▓реЗ</a></li>
<li><a href="../hi477732/index.html">рдкрд╛рдиреА рдХреЗ рдиреАрдЪреЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╕рд┐рд╕реНрдЯрдо рдХреА рдЧрд▓рдд рдЙрдВрдЧрд▓реА рдХрд╛ рд╡рд░реНрдЧреАрдХрд░рдг</a></li>
<li><a href="../hi477734/index.html">рдлреЛрдЯреЛ рдРрдк рдХреЗ рд╕рд╛рде UICollectionViewLayout рдХреЛ рд╕рдордЭрдирд╛</a></li>
<li><a href="../hi477736/index.html">рдкрд░реАрдХреНрд╖рдХ рдХрд╛ рд░рд╛рд╕реНрддрд╛: "рд╣реИрдВрдбрдмреНрд░реЗрдХ" рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рди рддрдХ</a></li>
<li><a href="../hi477738/index.html">iKassa рдпрд╛ рд╣рдордиреЗ "рдбрд┐рдЬрд┐рдЯрд▓ рдХреИрд╢рд┐рдпрд░" рдХрд╛ рдирд╛рдо рдХреИрд╕реЗ рд░рдЦрд╛</a></li>
<li><a href="../hi477740/index.html">рдФрд░ рдЗрд╕ рджреВрд░рдмреАрди рдХреЛ рдЕрдкрдиреА рдЖрдБрдЦ рд╕реЗ рдХрд╣рд╛рдБ рджреЗрдЦрдирд╛ рд╣реИ?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>