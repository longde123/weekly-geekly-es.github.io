<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍⚖️ 🚸 ♀️ Laissez le concours ATM seul les PHDays 8 🏓 👉🏼 📖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au Positive Hack Days 8, la bonne vieille compétition pour le piratage Laisser les distributeurs automatiques de billets s'est à nouveau tenue. Il y a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Laissez le concours ATM seul les PHDays 8</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/412735/">  Au Positive Hack Days 8, la bonne vieille compétition pour le piratage Laisser les distributeurs automatiques de billets s'est à nouveau tenue.  Il y avait deux distributeurs automatiques de billets à la disposition des participants, le matériel a été fourni par notre partenaire de sécurité bancaire Alfa-Bank.  Surtout pour la concurrence, nous avons mis en place des distributeurs automatiques de billets et y avons mis des vulnérabilités.  En 15 minutes, il a fallu contourner l'équipement de protection et retirer de l'argent de l'appareil.  La dotation s'élevait à 40 000 ₽.  Une quarantaine de participants sont venus tenter de contourner la défense.  Leonid Krolle, organisateur du concours et spécialiste du département de recherche sur la sécurité des systèmes bancaires de Positive Technologies, a expliqué comment c'était et analysé les tâches en détail. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/lu/c9/cf/luc9cf7_e31tyqi6v7ejrodfxly.png"></a> <br><br>  <i>Laisser les concurrents ATM seuls</i> <br><br>  Les participants disposaient de deux distributeurs automatiques de billets.  Sur l'un d'eux, un logiciel de contrôle des applications de nos partenaires est installé, ce qui empêche le lancement d'applications non fiables.  Il ne vous permet pas d'exécuter toute application dont vous avez besoin pour retirer de l'argent (bonjour, Cutlet Maker, BubbleMaker et nemagiya!). <br><br>  Le deuxième GAB est connecté via le réseau pour tester le traitement, ce qui vous permet d'effectuer une opération de retrait d'espèces (disponible au GAB).  Cependant, le traitement envoie un signal à émettre depuis la cassette dans laquelle il n'y a pas d'argent.  Par conséquent, la tâche des participants est de remplacer la réponse de traitement pour émettre de l'argent à partir de la bonne cassette. <br><br>  Les câbles de connexion de l'ATM et du traitement de test sont situés à l'extérieur, avec la possibilité de s'y connecter à l'aide d'un câble réseau (LAN). <br><br>  Les joueurs ont retiré tout l'argent retiré du système. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/vh/g8/io/vhg8iogibjgk2plut3n6lmlxywu.png"><br><br>  <i>Distributeurs automatiques de billets à deux jours du forum: ils étaient tristes et seuls</i> <br><br><h2>  Contrôle d'application </h2><br>  Il existe plusieurs façons de vérifier si une application correspond à une liste blanche donnée - de la vérification du chemin d'accès au fichier exécutable ou de son hachage à l'analyse de la signature numérique et de l'extension.  Les outils de contrôle des applications sont le plus souvent utilisés pour fournir une protection supplémentaire aux ordinateurs clients (ils interdisent le lancement de logiciels ne figurant pas sur la liste blanche) et pour sécuriser les systèmes isolés, tels que les distributeurs automatiques de billets, qui n'impliquent pas une intervention opérationnelle constante. <br><br>  Si la liste noire des extensions à bloquer est plus ou moins universelle et facile à configurer, alors la liste blanche de ce qui est autorisé à s'exécuter est redondante par défaut - elle inclut souvent toutes les applications du système d'exploitation au moment de la configuration. <br><br>  Au cours des dernières années, de nombreuses méthodes ont été décrites pour contourner le contrôle des applications à l'aide d'outils Microsoft Windows (par exemple, «rundll32», «regsvr32»), dont le simple blocage perturbe le fonctionnement normal du système d'exploitation.  Par conséquent, affiner le contrôle de l'application est un travail complexe et minutieux, dont le résultat a été donné aux participants du concours de déchirure.  Notez que dans le monde réel, les attaquants n'ont pas autant de temps pour contourner le contrôle des applications. <br><br><h2>  Premier jour de compétition </h2><br><img src="https://habrastorage.org/webt/xt/t6/f3/xtt6f3h0h1wgy5oy1ccte4rbqri.png"><br><br>  <i>La vérité de la vie :)</i> <br><br>  Le début de la première journée du concours a été marqué par un flux dense de participants au forum venus tenter le contournement du contrôle des applications et remplacer la réponse du traitement - plus de 40 personnes au total. <br><br><img src="https://habrastorage.org/webt/yl/tq/96/yltq96ue_yjtqhenqxfjvzweoic.png"><br><br>  <i>Premiers participants</i> <br><br>  Au total, 15 minutes ont été allouées pour contourner la protection d'un GAB avec contrôle des applications: pendant ce temps, vous avez dû réussir à exécuter votre code.  Malheureusement, le premier jour, toutes les tentatives des participants pour lancer leur exploit ont échoué.  Cependant, un participant a réussi à trouver un étrange appareil installé sur un GAB.  C'était un skimmer - un lecteur portable miniature qui peut être connecté à un guichet automatique.  De tels appareils aident les fraudeurs à voler les données des cartes bancaires: détails, code PIN - toutes les informations enregistrées sur la bande magnétique. <br><br><img src="https://habrastorage.org/webt/sz/kd/sk/szkdskly0ge1n-elb3hiaz5d3ku.png"><br><br>  <i>Skimmer</i> <br><br>  Après avoir détecté l'écumoire, il a fallu en extraire les données de la carte: lors de la préparation de la compétition, les organisateurs y ont écrit une décharge d'une carte inexistante avec un certain nombre. <br><br><div class="spoiler">  <b class="spoiler_title">Parlons un peu de la préparation d'un skimmer pour une compétition.</b> <div class="spoiler_text">  L'écumoire se compose d'une tête magnétique pour la lecture et d'un appareil pour enregistrer une piste audio (parfois avec Wi-Fi ou Bluetooth).  Cette instance peut être réalisée sur la base d'un lecteur-enregistreur Explay ou d'un enregistreur vocal USB similaire.  Exemples <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  En termes de taille, ils s'insèrent simplement dans le revêtement de l'anti-skimmer et il y a encore de la place pour une batterie, car le mini de Frankenstein a dû être préparé et relancé: un test de performance a été effectué sur un appareil similaire d'un autre modèle ATM.  Pour économiser de l'espace, le tampon de montage du port USB est coupé, j'ai donc dû faire l'adaptateur moi-même. <br><br><img src="https://habrastorage.org/webt/e7/eu/ux/e7euux45y66_irhfyfm6te8sphy.png"><br><br>  <i>Faire un adaptateur</i> <br><br>  Nous avons testé l'inclusion correcte du joueur de skimmer selon les instructions du joueur sur Internet (il n'y avait aucun signe sur les boutons, car ils restaient sur le boîtier) et avons noté la carte et le numéro que les participants devaient retirer du skimmer. <br><br><img src="https://habrastorage.org/webt/vw/cc/o7/vwcco7dgqrukqqn6gvzkty9x-14.png"><br><br>  Voici à quoi ressemble une carte avec de la poudre magnétique appliquée </div></div><br>  Les informations sur la bande magnétique de la carte sont enregistrées en utilisant un codage de fréquence F / 2F (avec ce qu'elles sont consommées et comment elles peuvent être décodées - lire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> ) et représentent des caractères alphanumériques en codage 7 bits ou des caractères numériques en codage 5 bits.  Pour déterminer les erreurs de lecture, un contrôle de parité et de redondance longitudinale (ou contrôle de veille longitudinal - LRC) est utilisé. <br><br>  Les données sur n'importe quelle piste doivent commencer par le début du symbole de service et se terminer par la fin du symbole de service.  Ces symboles sont choisis de manière à permettre de déterminer le début d'un bloc d'informations utiles, de déterminer le sens de lecture de la carte et même le format d'encodage des informations (5 bits ou 7 bits). <br><br>  Les caractères de contrôle sont conçus pour contrôler le matériel et ne peuvent pas être utilisés pour transmettre des informations (contenu de données).  Les séparateurs sont utilisés pour séparer les champs de données sur la carte. <br><br>  Dans un codage 7 bits, les caractères [\] sont réservés à des caractères nationaux supplémentaires et ne doivent pas être utilisés dans le cadre de l'échange international d'informations, le caractère # est réservé à des caractères graphiques supplémentaires arbitraires. <br>  Voici un exemple de ce à quoi cela pourrait ressembler: <br><br>  - voie ISO 2 standard: <br><br>  <b>; XXXXXXXXXXXXXXXX = YYYYYYYYYYYYYYYYY? Z</b> - 37 caractères <br><br>  X ... X - numéro de carte, Z - LRC (les données commencent par le caractère de début et se terminent par le caractère de fin, le numéro de carte est à 16 chiffres, LRC est présent) <br><br><img src="https://habrastorage.org/webt/zt/l7/tm/ztl7tmpmtzjao3ulrofqqbnlv80.png"><br><br>  <i>Le moment des tests et du dumping</i> <br><br>  En fait, vous pouvez copier des données du lecteur sous la forme d'un fichier MP3, trouver où la piste est enregistrée, l'agrandir dans l'éditeur audio et analyser peu à peu, mais il existe des méthodes plus simples. <br><br>  Par exemple: <br><br><ul><li>  SWipe est une application pour lire des cartes à bande magnétique sur un port audio. </li><li>  Décodeur à bande magnétique.  Un programme pour décoder une carte à bande magnétique, recevoir les données brutes de la bande magnétique via la carte son. </li></ul><br>  Ils vous permettent de convertir plus ou moins précisément les données de la piste audio en ASCII (données décryptées). <br><br>  Après environ une heure, les données de la carte enregistrées dans l'écumoire ont été fournies.  Le prix d'honneur de la sympathie des spectateurs a trouvé son propriétaire.  Félicitations à Maxim Vikhlyantsev! <br><br>  Le reste des participants a continué à se battre pour les principaux prix téléchargés sur les distributeurs automatiques de billets :) Quelqu'un a essayé de pirater la défense, mais il y avait ceux qui étaient fatigués et ont perdu l'espoir d'un enrichissement rapide.  Néanmoins, le premier jour a été houleux, bien que le gros lot principal soit resté aux organisateurs ... <br><br><img src="https://habrastorage.org/webt/a7/jv/qk/a7jvqksrhcpyx7mhu-l7uzuy1_m.png"><br><br><h2>  Deuxième jour </h2><br><img src="https://habrastorage.org/webt/6t/st/ep/6tstepatpvygffsz1gjbyaxk6x0.png"><br><br>  <i>Resté le plus persistant</i> <br><br>  Le deuxième jour de la compétition sur le terrain pour le piratage ATM, on a pu observer tous les mêmes participants.  La persévérance et la persévérance à essayer de trouver un vecteur pour contourner la protection ne sont pas restées vaines, et ici - Stanislav Povolotsky a contourné la défense en toute sécurité et, en exécutant un code non signé, a remporté le prix en espèces dans le premier guichet automatique. <br><br><img src="https://habrastorage.org/webt/sn/9s/wd/sn9swddlya06o70a50iycymfvkg.png"><br><br>  <i>Démonstration d'un emploi réussi</i> <br><br>  L'essence de l'attaque réseau contre le deuxième ATM était la suivante: dans l'ATM, il y avait un ordinateur portable avec un logiciel installé qui émulait le traitement. <br><br><img src="https://habrastorage.org/webt/c2/rk/_i/c2rk_ihnvcu7psjkghgf_srh6iw.png"><br><br>  <i>Émulateur de traitement</i> <br><br>  L'émulateur a été configuré pour émettre de l'argent avec n'importe quelle carte insérée, sans code PIN, mais la cassette dont la commande envoyée par l'émulateur en réponse à la demande était vide.  Pour résoudre ce problème, il fallait: <br><br><ul><li>  intercepter le paquet de réponse de l'émulateur de traitement; </li><li>  démontez l'emballage et formez le vôtre - uniquement avec le bon numéro de cartouche; </li><li>  insérer une carte et, lors de l'envoi d'une demande de traitement, répondre au GAB avec les données modifiées; </li><li>  à l'aide des outils tcpdump, Wireshark, Scapy ou Ettercap, effectuez une attaque de relecture ou une attaque d'usurpation de données modifiées afin de répondre à l'ATM. </li></ul><br>  tcpdump est un utilitaire UNIX qui possède un clone pour Windows et vous permet d'intercepter et d'analyser le trafic réseau passant par l'ordinateur sur lequel ce programme s'exécute. <br><br>  Wireshark est un utilitaire similaire, mais plus "chargé", avec une interface graphique. <br><br>  scapy est un shell interactif et une bibliothèque de logiciels pour manipuler les paquets réseau dans le langage de programmation Python. <br><br>  ettercap est un utilitaire pour analyser le trafic réseau passant par une interface informatique, mais avec des fonctionnalités supplémentaires.  Le programme vous permet d'effectuer des attaques comme "l'homme au milieu" pour forcer un autre ordinateur à transmettre des paquets non pas au routeur, mais à l'attaquant. <br><br><img src="https://habrastorage.org/webt/4_/zf/gq/4_zfgqlxjev9u55wt0dz4tojhz0.png"><br><br>  <i>En fait, rien ne change</i> <br><br>  Avec une approche aussi difficile, les participants ont eu des difficultés, mais ils les ont surmontées.  Le prix pour la falsification de la réponse du traitement au deuxième guichet automatique a été reçu par l'équipe - Information et public, Centre de sécurité et Ouzbékistan.  Avec ce que nous les félicitons!  La liste complète des gagnants se trouve sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la page du concours</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr412735/">https://habr.com/ru/post/fr412735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr412721/index.html">Trois espoirs de l'humanité pour la découverte des extraterrestres</a></li>
<li><a href="../fr412723/index.html">À la recherche d'une nouvelle couleur d'un milliard de dollars</a></li>
<li><a href="../fr412725/index.html">Comment rendre votre infrastructure informatique ennuyeuse</a></li>
<li><a href="../fr412727/index.html">Comment choisir un outil de prototypage en 2018?</a></li>
<li><a href="../fr412729/index.html">GDPR. Faut-il l'exécuter en Russie?</a></li>
<li><a href="../fr412737/index.html">Protection des données personnelles de 3 milliards de personnes - similitudes et différences de législation dans les pays BRICS</a></li>
<li><a href="../fr412739/index.html">Chien de berger</a></li>
<li><a href="../fr412741/index.html">Comment arrêter d'avoir peur que l'intelligence artificielle vous laisse sans travail</a></li>
<li><a href="../fr412743/index.html">Profession: Cyber ​​détective</a></li>
<li><a href="../fr412747/index.html">MIS. Stockage de données médicales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>