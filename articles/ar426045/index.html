<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คฒ๐พ ๐ค ๐๐พ ุงุณุชุซูุงุกุงุช ุฎุงุตุฉ ูู .NET ูููููุฉ ุฅุนุฏุงุฏูุง ๐๐ฟ ๐ ๐ค</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงูุงุณุชุซูุงุกุงุช ุงููุฎุชููุฉ ูู .NET ููุง ุฎุตุงุฆุตูุง ุงูุฎุงุตุฉ ุ ููุฏ ูููู ูู ุงููููุฏ ุฌุฏูุง ุงูุชุนุฑู ุนูููุง. ููููุฉ ุฎุฏุงุน CLRุ ููููุฉ ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ูู ููุช ุงูุชุดุบูู ุนู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงุณุชุซูุงุกุงุช ุฎุงุตุฉ ูู .NET ูููููุฉ ุฅุนุฏุงุฏูุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/426045/" style=";text-align:right;direction:rtl">  ุงูุงุณุชุซูุงุกุงุช ุงููุฎุชููุฉ ูู .NET ููุง ุฎุตุงุฆุตูุง ุงูุฎุงุตุฉ ุ ููุฏ ูููู ูู ุงููููุฏ ุฌุฏูุง ุงูุชุนุฑู ุนูููุง.  ููููุฉ ุฎุฏุงุน CLRุ  ููููุฉ ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ูู ููุช ุงูุชุดุบูู ุนู ุทุฑูู ุงููุญุงู StackOverflowExceptionุ  ูุง ุงูุงุณุชุซูุงุกุงุช ุงูุชู ูุจุฏู ูู ุงููุณุชุญูู ุงูุชูุงุทูุง ุ ูููู ุฅุฐุง ููุช ุชุฑูุฏ ุญููุง ุ ูู ููููู ุฐููุ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f1/314/78d/4f131478de33b4a6acd0ed25a0e53987.png"><br><br>  ุชุญุช ุงููุทุน ุ ูุต ุชูุฑูุฑ ููุฌูู ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">epeshk</a> ) Peshkov ูู ูุคุชูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DotNext 2018 Piter</a> ุ ุญูุซ ุชุญุฏุซ ุนู ูุฐู ุงูููุฒุงุช ูุบูุฑูุง ูู ุงูุงุณุชุซูุงุกุงุช. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WLSrYgMWif4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  ูุฑุญุจูุง  ุงุณูู ููุฌูู.  ุฃูุง ุฃุนูู ูุฏู SKB Kontur ูุฃุทูุฑ ูุธุงู ุงุณุชุถุงูุฉ ููุดุฑ ุชุทุจููุงุช ูู Windows.  ุฎูุงุตุฉ ุงูููู ูู ุฃู ูุฏููุง ุงูุนุฏูุฏ ูู ูุฑู ุงูููุชุฌุงุช ุงูุชู ุชูุชุจ ุฎุฏูุงุชูุง ูุชุณุชุถูููุง ูุนูุง.  ูุญู ููุฏู ููู ุญู ุณูู ูุจุณูุท ููุฌููุนุฉ ูุชููุนุฉ ูู ููุงู ุงูุจููุฉ ุงูุชุญุชูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ููุฑุงูุจุฉ ุงุณุชููุงู ููุงุฑุฏ ุงููุธุงู ุฃู ุฅููุงุก ุงููุณุฎ ุงููุชูุงุซูุฉ ููุฎุฏูุฉ. <br><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุชุจูู ุฃู ุงูุชุทุจููุงุช ุงูุชู ุชุชู ุงุณุชุถุงูุชูุง ุนูู ูุธุงููุง ุชููุงุฑ.  ููุฏ ุฑุฃููุง ุงูุนุฏูุฏ ูู ุงูุทุฑู ูููููุฉ ุชุนุทู ุงูุชุทุจูู ูู ููุช ุงูุชุดุบูู.  ุฅุญุฏู ูุฐู ุงูุทุฑู ูู ุงูุชุฎูุต ูู ุจุนุถ ุงูุงุณุชุซูุงุกุงุช ุบูุฑ ุงููุชููุนุฉ ูุงูุณุงุญุฑุฉ. <br><br>  ุงูููู ุณุฃุชุญุฏุซ ุนู ููุฒุงุช ุงูุงุณุชุซูุงุกุงุช ูู .NET.  ูุงุฌููุง ุจุนุถ ูุฐู ุงูููุฒุงุช ูู ุงูุฅูุชุงุฌ ุ ูุจุนุถูุง ูู ุณูุงู ุงูุชุฌุงุฑุจ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฎุทุฉ </h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณููู ุงุณุชุซูุงุก .NET <br></li><li style=";text-align:right;direction:rtl">  ูุนุงูุฌุฉ ุงุณุชุซูุงุกุงุช Windows ูุนูููุงุช ุงูุงุฎุชุฑุงู <br></li></ol><br>  ูู ูุง ููู ุตุญูุญ ุจุงููุณุจุฉ ููุธุงู ุงูุชุดุบูู Windows.  ุชู ุงุฎุชุจุงุฑ ุฌููุน ุงูุฃูุซูุฉ ุนูู ุฃุญุฏุซ ุฅุตุฏุงุฑ ูู ุฅุทุงุฑ ุนูู .NET 4.7.1 ุงููุงูู.  ุณูููู ููุงู ุฃูุถูุง ุจุนุถ ุงูุฅุดุงุฑุงุช ุฅูู .NET Core. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุชูุงู ุงููุตูู </h2><br>  ูุญุฏุซ ูุฐุง ุงูุงุณุชุซูุงุก ุฃุซูุงุก ุนูููุงุช ุงูุฐุงูุฑุฉ ุบูุฑ ุงูุตุญูุญุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ุญุงูู ุชุทุจูู ุงููุตูู ุฅูู ููุทูุฉ ุฐุงูุฑุฉ ูุง ููููู ุงููุตูู ุฅูููุง.  ุงูุงุณุชุซูุงุก ูู ูุณุชูู ููุฎูุถ ุ ูุนุงุฏุฉู ุ ุฅุฐุง ุญุฏุซ ุฐูู ุ ูุณูููู ููุงู ุญุงุฌุฉ ุฅูู ุชุตุญูุญ ุทููู ุฌุฏูุง. <br><br>  ุฏุนููุง ูุญุงูู ุงูุญุตูู ุนูู ูุฐุง ุงูุงุณุชุซูุงุก ุจุงุณุชุฎุฏุงู C #.  ููููุงู ุจุฐูู ุ ุณููุชุจ ุจุงูุช 42 ุนูู ุงูุนููุงู 1000 (ููุชุฑุถ ุฃู 1000 ุนููุงู ุนุดูุงุฆู ููุนูุง ูุง ูุนูู ุงูุฃุฑุฌุญ ุฃู ุชุทุจูููุง ูุง ููููู ุงููุตูู ุฅููู). <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Marshal.WriteByte((IntPtr) <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (AccessViolationException) { ... }</code> </pre> <br>  ูููู WriteByte ุจูุง ูุญุชุงุฌู ููุท: ููุชุจ ุจุงูุช ุฅูู ุงูุนููุงู ุงููุญุฏุฏ.  ูุชููุน ูู ูุฐู ุงูููุงููุฉ ุทุฑุญ AccessViolationException.  ุณูู ูุฑูู ูุฐุง ุงูุฑูุฒ ุจุงููุนู ูุฐุง ุงูุงุณุชุซูุงุก ุ ูุณูููู ูุงุฏุฑูุง ุนูู ุงูุชุนุงูู ูุนู ูุณูุณุชูุฑ ุงูุชุทุจูู ูู ุงูุนูู.  ุงูุขู ุฏุนูุง ูุบูุฑ ุงูุดูุฑุฉ ููููุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bytes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] {<span class="hljs-number"><span class="hljs-number">42</span></span>}; Marshal.Copy(bytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, (IntPtr) <span class="hljs-number"><span class="hljs-number">1000</span></span>, bytes.Length); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (AccessViolationException) { ... }</code> </pre><br>  ุฅุฐุง ุงุณุชุฎุฏูุช ุจุฏูุงู ูู WriteByte ุฃุณููุจ ุงููุณุฎ ููุณุฎ ุงูุจุงูุช 42 ุฅูู ุงูุนููุงู 1000 ุ ุซู ุจุงุณุชุฎุฏุงู try-catch ุ ูุง ูููู ุงูุชุดุงู AccessViolation.  ูู ููุณ ุงูููุช ุ ุณูุชู ุนุฑุถ ุฑุณุงูุฉ ุนูู ูุญุฏุฉ ุงูุชุญูู ุชููุฏ ุฃูู ุชู ุฅููุงุก ุงูุชุทุจูู ุจุณุจุจ AccessViolationException ุบูุฑ ูุนุงูุฌ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Marshal.Copy(bytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, (IntPtr) <span class="hljs-number"><span class="hljs-number">1000</span></span>, bytes.Length); Marshal.WriteByte((IntPtr) <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>);</code> </pre><br>  ุงุชุถุญ ุฃู ูุฏููุง ุณุทุฑูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ุจูููุง ูุนุทู ุงูุฃูู ุงูุชุทุจูู ุจุฃูููู ูุน AccessViolation ุ ูุงูุซุงูู ูุทุฑุญ ุงุณุชุซูุงุก ูุนุงูุฌูุง ูู ููุณ ุงูููุน.  ูููู ุณุจุจ ุญุฏูุซ ุฐูู ุ ุณููุธุฑ ูู ููููุฉ ุชุฑุชูุจ ูุฐู ุงูุฃุณุงููุจ ูู ุงูุฏุงุฎู. <br><br>  ููุจุฏุฃ ูุน ุทุฑููุฉ ุงููุณุฎ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Copy</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">...</span></span></span><span class="hljs-function">)</span></span> { Marshal.CopyToNative((<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>) source, startIndex, destination, length); } [MethodImpl(MethodImplOptions.InternalCall)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CopyToNative</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> source, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> startIndex, IntPtr destination, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> length</span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br>  ุงูุดูุก ุงููุญูุฏ ุงูุฐู ุชูุนูู ุทุฑููุฉ ุงููุณุฎ ูู ุงุณุชุฏุนุงุก ุทุฑููุฉ CopyToNative ุ ุงูุชู ูุชู ุชูููุฐูุง ุฏุงุฎู .NET.  ุฅุฐุง ุงุณุชูุฑ ุชุนุทู ุชุทุจูููุง ูุญุฏุซ ุงุณุชุซูุงุก ูู ููุงู ูุง ุ ููููู ุฃู ูุญุฏุซ ูุฐุง ููุท ุฏุงุฎู CopyToNative.  ูู ููุง ูููููุง ุนูู ุงูููุงุญุธุฉ ุงูุฃููู: ุฅุฐุง ุญุฏุซ ููุฏ NET ูุณูู ุงูููุฏ ุงูุฃุตูู ู AccessViolation ุจุฏุงุฎูู ุ ููู ูุชููู ููุฏ .NET ูู ูุนุงูุฌุฉ ูุฐุง ุงูุงุณุชุซูุงุก ูุณุจุจ ูุง. <br><br>  ุงูุขู ุณูู ูููู ููุงุฐุง ูุงู ูู ุงููููู ูุนุงูุฌุฉ AccessViolation ุจุงุณุชุฎุฏุงู ุฃุณููุจ WriteByte.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ููุฏ ูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsafe</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteByte</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr ptr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> val</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { *(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>*) ptr = val; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (NullReferenceException) {     <span class="hljs-comment"><span class="hljs-comment">// this method is documented to throw AccessViolationException on any AV throw new AccessViolationException(); } }</span></span></code> </pre><br>  ูุชู ุชูููุฐ ูุฐู ุงูุทุฑููุฉ ุจุงููุงูู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ.  ูุณุชุฎุฏู ูุคุดุฑ C # ููุชุงุจุฉ ุงูุจูุงูุงุช ุฅูู ุงูุนููุงู ุงููุทููุจ ุ ููุง ุฃูู ููุณู NullReferenceException.  ุฅุฐุง ุชู ุงุนุชุฑุงุถ NRE ุ ูุชู ุทุฑุญ AccessViolationException.  ูุฐูู ูู ุงูุถุฑูุฑู ุจุณุจุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุตูุงุช</a> .  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุงูุชุนุงูู ูุน ุฌููุน ุงูุงุณุชุซูุงุกุงุช ุงูุชู ุชู ุทุฑุญูุง ุจูุงุณุทุฉ ุจููุฉ ุงูุฑูู.  ููููุง ูุฐูู ุ ูู ุญุงูุฉ ุญุฏูุซ NullReferenceException ุฃุซูุงุก ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฏุงุฎู WriteByte ุ ูููููุง ุงูุชูุงุท AccessViolation.  ูู ูููู ุฃู ุชุญุฏุซ NRE ุ ูู ุญุงูุชูุง ุ ุนูุฏ ุงููุตูู ุฅูู ุงูุนููุงู 1000 ุจุฏูุงู ูู ุงูุนููุงู ุตูุฑุ <br><br>  ูุนูุฏ ูุชุงุจุฉ ุงูุฑูุฒ ุจุงุณุชุฎุฏุงู ูุคุดุฑุงุช C # ูุจุงุดุฑุฉ ุ ููุฑู ุฃูู ุนูุฏ ุงููุตูู ุฅูู ุนููุงู ุบูุฑ ุตูุฑู ุ ูุชู ุทุฑุญ NullReferenceException ูุนูููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">*(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>*) <span class="hljs-number"><span class="hljs-number">1000</span></span> = <span class="hljs-number"><span class="hljs-number">42</span></span>;</code> </pre><br>  ูููู ุณุจุจ ุญุฏูุซ ุฐูู ุ ูุญุชุงุฌ ุฅูู ุชุฐูุฑ ููููุฉ ุนูู ุฐุงูุฑุฉ ุงูุนูููุฉ.  ูู ุฐุงูุฑุฉ ุงูุนูููุฉ ุ ุฌููุน ุงูุนูุงููู ุงูุชุฑุงุถูุฉ.  ูุฐุง ูุนูู ุฃู ุงูุชุทุจูู ูุญุชูู ุนูู ูุณุงุญุฉ ุนููุงู ูุจูุฑุฉ ููุชู ุนุฑุถ ุจุนุถ ุงูุตูุญุงุช ููู ููุท ูู ุงูุฐุงูุฑุฉ ุงููุนููุฉ ุงูุญููููุฉ.  ูููู ููุงู ููุฒุฉ: ุฃูู 64 ููููุจุงูุช ูู ุงูุนูุงููู ูุง ูุชู ุชุนููููุง ุฃุจุฏูุง ููุฐุงูุฑุฉ ุงููุนููุฉ ููุง ูุชู ุฅุนุทุงุคูุง ููุชุทุจูู.  ูุนุฑู Rantime .NET ูุฐุง ููุณุชุฎุฏูู.  ุฅุฐุง ุญุฏุซ AccessViolation ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ ุ ูุฅู ููุช ุงูุชุดุบูู ูุชุญูู ูู ุงูุนููุงู ุงูุฐู ุชู ุงููุตูู ุฅููู ูู ุงูุฐุงูุฑุฉ ููููุฏ ุงุณุชุซูุงุก ููุงุณุจูุง.  ููุนูุงููู ูู 0 ุฅูู 2 ^ 16 - NullReference ุ ูุฌููุน ุงูุขุฎุฑูู - AccessViolation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/775/3d4/38f/7753d438fc8a977ac0bb54e431d81c6f.png"><br><br>  ุฏุนููุง ูุฑู ููุงุฐุง ูุชู ุทุฑุญ NullReference ููุณ ููุท ุนูุฏ ุงููุตูู ุฅูู ุงูุนููุงู ุตูุฑ.  ุชุฎูู ุฃูู ุชุตู ุฅูู ุญูู ูุงุฆู ูู ุงูููุน ุงููุฑุฌุนู ูุฃู ุงููุฑุฌุน ุฅูู ูุฐุง ุงููุงุฆู ูุงุฑุบ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/127/a27/867/127a27867ef7a568a242797758855b44.png"><br><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชููุน ุงูุญุตูู ุนูู NullReferenceException.  ูุญุฏุซ ุงููุตูู ุฅูู ุญูู ูุงุฆู ุจูุงุณุทุฉ ุงูุฅุฒุงุญุฉ ูุณุจุฉ ุฅูู ุนููุงู ูุฐุง ุงููุงุฆู.  ุงุชุถุญ ุฃููุง ุณููุชูู ุฅูู ุนููุงู ูุฑูุจ ุจูุง ูููู ูู ุงูุตูุฑ (ุชุฐูุฑ ุฃู ุงูุฑุงุจุท ุฅูู ูุงุฆููุง ุงูุฃุตูู ูู ุตูุฑ).  ูุน ุณููู ููุช ุงูุชุดุบูู ูุฐุง ุ ูุญุตู ุนูู ุงูุงุณุชุซูุงุก ุงููุชููุน ุฏูู ุงูุชุญูู ุงูุฅุถุงูู ูู ุนููุงู ุงููุงุฆู ููุณู. <br><br>  ูููู ูุงุฐุง ูุญุฏุซ ุฅุฐุง ุงูุชูููุง ุฅูู ุญูู ูุงุฆู ุ ููุงู ูุฐุง ุงููุงุฆู ููุณู ูุณุชููู ุฃูุซุฑ ูู 64 ููููุจุงูุชุ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/356/897/143/356897143b1275403569dc9f9a71471a.png"><br><br>  ูู ูููููุง ุงูุญุตูู ุนูู AccessViolation ูู ูุฐู ุงูุญุงูุฉุ  ูููู ุจุชุฌุฑุจุฉ.  ูููู ุจุฅูุดุงุก ูุงุฆู ูุจูุฑ ุฌุฏูุง ูุณูุดูุฑ ุฅูู ุญูููู.  ุญูู ูุงุญุฏ ูู ุจุฏุงูุฉ ุงููุงุฆู ุ ูุงูุซุงูู ูู ุงูููุงูุฉ: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/08d/619/95a/08d61995a01630f94f31f759890af4a8.png"><br><br>  ุณุชููู ููุชุง ุงูุทุฑููุชูู ุจุฅููุงุก NullReferenceException.  ูู ูุญุฏุซ AccessViolationException. <br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูุชุนูููุงุช ุงูุชู ุณูุชู ุฅูุดุงุคูุง ููุฐู ุงูุฃุณุงููุจ.  ูู ุงูุญุงูุฉ ุงูุซุงููุฉ ุ ุฃุถุงู ุงููุชุฑุฌู JIT ุชุนูููุฉ cmp ุฅุถุงููุฉ ุชุตู ุฅูู ุนููุงู ุงููุงุฆู ููุณู ุ ูุจุงูุชุงูู ุงุณุชุฏุนุงุก AccessViolation ุจุนููุงู ุตูุฑ ุ ูุงูุฐู ุณูุชู ุชุญูููู ุจูุงุณุทุฉ ููุช ุงูุชุดุบูู ุฅูู NullReferenceException. <br><br>  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูู ูุฐู ุงูุชุฌุฑุจุฉ ูุง ูููู ุงุณุชุฎุฏุงู ูุตูููุฉ ููุงุฆู ูุจูุฑ.  ููุงุฐุงุ  ุงุชุฑู ูุฐุง ุงูุณุคุงู ูููุงุฑุฆ ุ ุงูุชุจ ุงูุฃููุงุฑ ูู ุงูุชุนูููุงุช :) <br><br>  ุฏุนููุง ููุฎุต ุงูุชุฌุงุฑุจ ูุน AccessViolation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ffa/86b/0a8/ffa86b0a85f29a16936c92845f5d3e1e.png"><br><br>  ูุชุตุฑู AccessViolationException ุจุดูู ูุฎุชูู ุงุนุชูุงุฏูุง ุนูู ููุงู ุญุฏูุซ ุงูุงุณุชุซูุงุก (ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ ุฃู ูู ุงููุบุฉ ุงูุฃู).  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุฅุฐุง ุญุฏุซ ุงุณุชุซูุงุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ ุ ูุณูุชู ุงูุชุญูู ูู ุนููุงู ุงููุงุฆู. <br><br>  ุงูุณุคุงู ูู: ูู ูููููุง ุงูุชุนุงูู ูุน AccessViolationException ุงูุชู ุญุฏุซุช ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฃุตููุฉ ุฃู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ ุ ูููู ูู ูุชู ุชุญููููุง ุฅูู NullReference ููุง ูุชู ุทุฑุญูุง ุจุงุณุชุฎุฏุงู ุงูุฑููุ  ูุฐู ูู ุจุนุถ ุงูุฃุญูุงู ููุฒุฉ ูููุฏุฉ ุ ุฎุงุตุฉ ุนูุฏ ุงูุนูู ูุน ุฑูุฒ ุบูุฑ ุขูู.  ุชุนุชูุฏ ุงูุฅุฌุงุจุฉ ุนูู ูุฐุง ุงูุณุคุงู ุนูู ุฅุตุฏุงุฑ .NET. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/67a/785/318/67a785318bc8b5f084a3b23fa36e766b.png"><br><br>  ูู .NET 1.0 ุ ูู ููู ููุงู AccessViolationException ุนูู ุงูุฅุทูุงู.  ุชู ุงุนุชุจุงุฑ ุฌููุน ุงูุฑูุงุจุท ุตุงูุญุฉ ุฃู ุฎุงููุฉ.  ุจุญููู ููุช .NET 2.0 ุ ุฃุตุจุญ ูู ุงููุงุถุญ ุฃูู ุจุฏูู ุงูุนูู ุงููุจุงุดุฑ ูุน ุงูุฐุงูุฑุฉ - ูุง ุชูุฌุฏ ุทุฑููุฉ ุ ูุธูุฑุช AccessViolation ุ ุจูููุง ูุงูุช ูุงุจูุฉ ูููุนุงูุฌุฉ.  ูู ุงูุฅุตุฏุงุฑ 4.0 ููุง ููู ุ ูุง ูุฒุงู ูุงุจูุงู ููุชุทุจูู ุ ูููู ูุนุงูุฌุชู ููุณุช ุจูุฐู ุงูุจุณุงุทุฉ.  ูุงูุชูุงุท ูุฐุง ุงูุงุณุชุซูุงุก ุ ุชุญุชุงุฌ ุงูุขู ุฅูู ูุถุน ุนูุงูุฉ ุนูู ุงูุทุฑููุฉ ุงูุชู ุชูุฌุฏ ุจูุง ูุชูุฉ ุงูุงูุชูุงุท ุจุงูุณูุฉ HandleProcessCorruptedStateException.  ุนูู ูุง ูุจุฏู ุ ูุงู ุงููุทูุฑูู ุจุฐูู ูุฃููู ุงุนุชูุฏูุง ุฃู AccessViolationException ูู ููู ุงูุงุณุชุซูุงุก ุงูุฐู ูุฌุจ ุงูุชุดุงูู ูู ุงูุชุทุจูู ุงูุนุงุฏู. <br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุฃุฌู ุงูุชูุงูู ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ ุ ูู ุงููููู ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ููุช ุงูุชุดุบูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  legacyNullReferenceExceptionPolicy ููุฑุฌุน ุณููู .NET 1.0 - ุชุชุญูู ุฌููุน ูุฑูุจุงุช AV ุฅูู NRE <br></li><li style=";text-align:right;direction:rtl">  legacyCorruptedStateExceptionsPolicy ุชูุฑุฌุน ุณููู .NET 2.0 - ูุชู ุงุนุชุฑุงุถ ุฌููุน ูุฑูุจุงุช AV <br></li></ul><br>  ูู .NET ุ ูุง ูุชู ุงูุชุนุงูู ูุน Core AccessViolation ุนูู ุงูุฅุทูุงู. <br><br>  ูู ุฅูุชุงุฌูุง ูุงู ููุงู ูุซู ูุฐุง ุงููุถุน: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ad7/0f1/6d3/ad70f16d3438d1e8ab80e43ba29d5412.png"><br><br>  ุงุณุชุฎุฏู ุชุทุจูู ุชู ุฅูุดุงุคู ุจููุฌุจ .NET 4.7.1 ููุชุจุฉ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุดุชุฑูุฉ ุชู ุฅูุดุงุคูุง ุจููุฌุจ .NET 3.5.  ูุงู ููุงู ูุณุงุนุฏ ูู ูุฐู ุงูููุชุจุฉ ูุชุดุบูู ุฅุฌุฑุงุก ุฏูุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (isRunning) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { action(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { log.Error(e); } WaitForNextExecution(... ); }</code> </pre><br>  ูุฑุฑูุง ูู ุชุทุจูููุง ุฅูู ูุฐุง ุงููุณุงุนุฏ.  ุญุฏุซ ุฐูู ุฃูู ุชุญุทู ูุน AccessViolation.  ูุชูุฌุฉ ูุฐูู ุ ุณุฌู ุชุทุจูููุง ุจุงุณุชูุฑุงุฑ AccessViolation ุ ุจุฏูุงู ูู ุชุนุทูู ุจุณุจุจ  ุงูููุฏ ูู ุงูููุชุจุฉ ุชุญุช 3.5 ูููู ุฃู ููุณู ุจู.  ูุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุงุนุชุฑุงุถ ูุง ูุนุชูุฏ ุนูู ุฅุตุฏุงุฑ ููุช ุงูุชุดุบูู ุงูุฐู ูุชู ุชุดุบูู ุงูุชุทุจูู ุนููู ุ ูููู ุนูู TargetFramework ุ ุงูุฐู ุชู ุฅูุดุงุก ุงูุชุทุจูู ุจููุฌุจู ุ ูุชุจุนูุงุชู. <br><br>  ูุชูุฎูุต.  ุชุนุชูุฏ ูุนุงูุฌุฉ AccessVilolation ุนูู ููุงู ูุดุฃุชูุง - ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฃุตููุฉ ุฃู ุงูููุฏุงุฑุฉ - ุจุงูุฅุถุงูุฉ ุฅูู ุฅุนุฏุงุฏุงุช TargetFramework ูููุช ุงูุชุดุบูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุฅุญุจุงุท ุงูููุถูุน </h2><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูู ุงูููุฏ ุชุญุชุงุฌ ุฅูู ุฅููุงู ุชูููุฐ ุฃุญุฏ ุณูุงุณู ุงููุญุงุฏุซุงุช.  ููููุงู ุจุฐูู ุ ููููู ุงุณุชุฎุฏุงู ูุคุดุฑ ุงูุชุฑุงุจุท. Abort ()ุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ThreadAbortException e) { ... Thread.ResetAbort(); } }); ... thread.Abort();</code> </pre><br>  ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุงูุฃุณููุจ ุฅุญุจุงุท ูู ูุคุดุฑ ุชุฑุงุจุท ุชููู ุ ูุชู ุทุฑุญ ThreadAbortException.  ุฏุนููุง ูุญูู ููุฒุงุชู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฑูุฒ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { โฆ } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ThreadAbortException e) { โฆ } }); ... thread.Abort();</code> </pre><br>  ูุง ูุนุงุฏู ูุฐุง ุชูุงูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (ThreadAbortException e) { ... <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>; } }); ... thread.Abort();</code> </pre><br>  ุฅุฐุง ููุช ูุง ุชุฒุงู ุจุญุงุฌุฉ ุฅูู ูุนุงูุฌุฉ ThreadAbort ูุชูููุฐ ุจุนุถ ุงูุฅุฌุฑุงุกุงุช ุงูุฃุฎุฑู ูู ุณูุณูุฉ ุงููุญุงุฏุซุงุช ุงููุชูููุฉ ุ ูููููู ุงุณุชุฎุฏุงู ุทุฑููุฉ Thread.ResetAbort () ุ  ุฅูู ูููู ุนูููุฉ ุฅููุงู ุงูุชุฏูู ููุชููู ุงูุงุณุชุซูุงุก ุนู ุงูุฑูู ุฃุนูู ุงูููุฏุณ.  ูู ุงูููู ุฃู ูููู ุฃู ุฃุณููุจ thread.Abort () ููุณู ูุง ูุถูู ุฃู ุดูุก - ูุฏ ูููุนู ุงูุฑูุฒ ุงูููุฌูุฏ ูู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุฐู ุชู ุฅููุงูู. <br><br>  ููุฒุฉ ุฃุฎุฑู ูู thread.Abort () ูู ุฃูู ูู ูููู ูุงุฏุฑูุง ุนูู ููุงุทุนุฉ ุงูุฑูุฒ ุฅุฐุง ูุงู ููุฌูุฏูุง ูู ุงูููุงูุฉ ูุฃุฎูุฑูุง ูุชู ุญุธุฑู. <br><br>  ุฏุงุฎู ููุฏ ุงูุฅุทุงุฑ ุ ููููู ุบุงูุจูุง ุงูุนุซูุฑ ุนูู ุทุฑู ูููู ูููุง ูุชูุฉ ุงููุญุงููุฉ ูุงุฑุบุฉ ููููู ูู ุงูููุทู ุจุฏุงุฎููุง ุฃุฎูุฑูุง.  ูุชู ุฐูู ููุท ูููุน ุทุฑุญ ูุฐุง ุงูุฑูุฒ ุจูุงุณุทุฉ ThreadAbortException. <br><br>  ุฃูุถุงู ุ ููุชุธุฑ ุงุณุชุฏุนุงุก ุงูุฃุณููุจ thread.Abort () ูู ThreadAbortException ููุชู ุทุฑุญู.  ุงุฌูุน ุจูู ูุงุชูู ุงูุญูุงุฆููู ูุงุญุตู ุนูู ุฃู ุทุฑููุฉ thread.Abort () ูููู ุฃู ุชุญุธุฑ ูุคุดุฑ ุงูุชุฑุงุจุท. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { }       <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> { } <span class="hljs-comment"><span class="hljs-comment">// &lt;-- No ThreadAbortException in catch       finally { // &lt;-- No ThreadAbortException in finally           Thread.Sleep(- 1); } }); thread.Start(); ... thread.Abort(); // Never returns</span></span></code> </pre><br>  ูู ุงููุงูุน ุ ูููู ููุงุฌูุฉ ุฐูู ุนูุฏ ุงุณุชุฎุฏุงู ุงูุงุณุชุฎุฏุงู.  ูุชู ูุดุฑูุง ูู ูุญุงููุฉ / ุฃุฎูุฑุง ุ ูู ุงูููุงูุฉ ุ ุชุณูู ุทุฑููุฉ ุงูุชุฎูุต.  ูููู ุฃู ูููู ูุนูุฏูุง ุจุดูู ุชุนุณูู ุ ููุญุชูู ุนูู ูุนุงูุฌุงุช ุงูุฃุญุฏุงุซ ุ ุงุณุชุฎุฏู ุงูุฃููุงู.  ูุฅุฐุง ุชู ุงุณุชุฏุนุงุก thread.Abort ูู ููุช ุงูุชุดุบูู ุ ูุฅู Dispose - thread.Abort () ุณููุชุธุฑูุง.  ูุฐุง ูุญุตู ุนูู ููู ูู ุงูุตูุฑ ุชูุฑูุจูุง. <br><br>  ูู .NET Core ุ ูุทุฑุญ ุฃุณููุจ thread.Abort () PlatformNotSupportedException.  ูุฃุนุชูุฏ ุฃู ูุฐุง ุฃูุฑ ุฌูุฏ ููุบุงูุฉ ุ ูุฃูู ูุญูุฒ ุงุณุชุฎุฏุงู ููุณ ุงูุฎูุท. Abort () ุ ูููู ุงูุฃุณุงููุจ ุบูุฑ ุงูุบุงุฒูุฉ ูููู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุงุณุชุฎุฏุงู CancellationToken. <br><br><h2 style=";text-align:right;direction:rtl">  ุฎุงุฑุฌ ุงูุฐุงูุฑุฉ </h2><br>  ูููู ุงูุญุตูู ุนูู ูุฐุง ุงูุงุณุชุซูุงุก ุฅุฐุง ูุงูุช ุงูุฐุงูุฑุฉ ุงูููุฌูุฏุฉ ุนูู ุงูุฌูุงุฒ ุฃูู ูู ุงููุทููุจ.  ุฃู ุนูุฏูุง ูุงุฌููุง ูููุฏ ุนูููุฉ 32 ุจุช.  ูููู ููููู ุงูุญุตูู ุนูููุง ุญุชู ุฅุฐุง ูุงู ุงูููุจููุชุฑ ูุญุชูู ุนูู ุงููุซูุฑ ูู ุงูุฐุงูุฑุฉ ุงููุงุฑุบุฉ ุ ูุงูุนูููุฉ 64 ุจุช. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arr4gb = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue/<span class="hljs-number"><span class="hljs-number">2</span></span>];</code> </pre><br>  ุณูู ูุฑูู ุงูุฑูุฒ ุฃุนูุงู OutOfMemory.  ุงูุดูุก ูู ุฃูู ุ ุจุดูู ุงูุชุฑุงุถู ุ ูุง ููุณูุญ ุจุงููุงุฆูุงุช ุงูุฃูุจุฑ ูู 2 ุบูุบุงุจุงูุช.  ูููู ุฅุตูุงุญ ุฐูู ุนู ุทุฑูู ุชุนููู gcAllowVeryLargeObjects ูู App.config.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุฅูุดุงุก ุตููู 4 ุบูุบุงุจุงูุช. <br><br>  ุงูุขู ุฏุนูุง ูุญุงูู ุฅูุดุงุก ูุตูููุฉ ุฃูุซุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> largeArr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.MaxValue];</code> </pre><br>  ุงูุขู ูู ุชุณุงุนุฏ ุญุชู gcAllowVeryLargeObjects.  ูุฐูู ูุฃู .NET ูุฏููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุฏ ุนูู ุงูููุฑุณ ุงูุฃูุตู ูู ุงููุตูููุฉ</a> .  ูุฐุง ุงูุชูููุฏ ุฃูู ูู int.MaxValue. <br><br>  ูุคุดุฑ ุงูุตููู ูุงูุณ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุตูุงุฆู ุจุงูุช - 0x7FFFFFC7 <br></li><li style=";text-align:right;direction:rtl">  ุตูุงุฆู ุฃุฎุฑู - 0X7F <b>E</b> FFFFF <br></li></ul><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุญุฏุซ OutOfMemoryException ุ ุนูู ุงูุฑุบู ูู ุฃููุง ูุงุฌููุง ูู ุงููุงูุน ูููุฏูุง ุนูู ููุน ุงูุจูุงูุงุช ุ ูููุณ ููุตูุง ูู ุงูุฐุงูุฑุฉ. <br><br>  ูู ุจุนุถ ุงูุฃุญูุงู ูุชู ุงูุชุฎูุต ูู OutOfMemory ุจุดูู ูุงุถุญ ูู ุฎูุงู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุฏุงุฑุฉ ุฏุงุฎู .NET framework: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efd/c84/d98/efdc84d98a7786e39c9c5931ac523d13.png"><br>  ูุฐุง ูู ุชูููุฐ ุฃุณููุจ string.Concat.  ุฅุฐุง ูุงู ุทูู ุณูุณูุฉ ุงููุชุงุฆุฌ ุฃูุจุฑ ูู int.MaxValue ุ ูุชู ุทุฑุญ OutOfMemoryException ุนูู ุงูููุฑ. <br><br>  ุฏุนูุง ููุชูู ุฅูู ุงูุญุงูุฉ ุนูุฏูุง ุชูุดุฃ OutOfMemory ูู ุญุงูุฉ ููุงุฏ ุงูุฐุงูุฑุฉ ุจุงููุนู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">LimitMemory(<span class="hljs-number"><span class="hljs-number">64.</span></span>Mb()); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>)   list.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[size]); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (OutOfMemoryException e) { Console.WriteLine(e); }</code> </pre><br>  ุฃููุงู ุ ููุตุฑ ุฐุงูุฑุฉ ุงูุนูููุฉ ุนูู 64 ููุบุงุจุงูุช.  ุจุนุฏ ุฐูู ุ ุฏุงุฎู ุงูุญููุฉ ุ ุญุฏุฏ ุตูุงุฆู ุจุงูุช ุฌุฏูุฏุฉ ุ ูุงุญูุธูุง ูู ุจุนุถ ุงููุฑูุฉ ุจุญูุซ ูุง ูุฌูุนูุง GC ุ ูุญุงูู ุงูุชูุงุท OutOfMemory. <br><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุฃู ูุญุฏุซ ุฃู ุดูุก: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุช ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุก <br></li><li style=";text-align:right;direction:rtl">  ุณุชููุงุฑ ุงูุนูููุฉ <br></li><li style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุ ูููู ุงูุงุณุชุซูุงุก ุณูุชุนุทู ูุฑุฉ ุฃุฎุฑู <br></li><li style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุ ูููู StackOverflow ุณูู ูุชุนุทู <br></li></ul><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูู ูููู ุงูุจุฑูุงูุฌ ููุงุฆููุง.  ุฏุนููุง ูุญูู ุฌููุน ุงูุฎูุงุฑุงุช: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุก.  ุฏุงุฎู .NET ุ ูุง ููุฌุฏ ุดูุก ูููุนู ูู ุงูุชุนุงูู ูุน OutOfMemoryException. <br></li><li style=";text-align:right;direction:rtl">  ูุฏ ุชุณูุท ุงูุนูููุฉ.  ูุง ุชูุณ ุฃู ูุฏููุง ุชุทุจูู ููุฏุงุฑ.  ูุฐุง ูุนูู ุฃูู ูุง ูุชู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุฏุงุฎูู ููุท ุ ูููู ุฃูุถูุง ุฑูุฒ ููุช ุงูุชุดุบูู.  ุนูู ุณุจูู ุงููุซุงู ุ GC.  ูุจุงูุชุงูู ุ ูุฏ ูุญุฏุซ ูููู ุนูุฏูุง ูุฑูุฏ ููุช ุงูุชุดุบูู ุชุฎุตูุต ุฐุงูุฑุฉ ูููุณู ุ ูููู ูุง ููููู ุงูููุงู ุจุฐูู ุ ููู ูุชููู ูู ุงูุชูุงุท ุงูุงุณุชุซูุงุก. <br></li><li style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุฅูู ุงูุตูุฏ ุ ููู ุงูุงุณุชุซูุงุก ุณูุชุนุทู ูุฑุฉ ุฃุฎุฑู.  ุฏุงุฎู ุงููุตูุฏ ุ ูููู ุฃูุถูุง ุจุงููููุฉ ุญูุซ ูุญุชุงุฌ ุฅูู ุฐุงูุฑุฉ (ูููู ุจุทุจุงุนุฉ ุงุณุชุซูุงุก ููุญุฏุฉ ุงูุชุญูู) ุ ููุฐุง ูููู ุฃู ูุชุณุจุจ ูู ุงุณุชุซูุงุก ุฌุฏูุฏ. <br></li><li style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุ ูููู StackOverflow ุณูู ูุชุนุทู.  ูุญุฏุซ StackOverflow ููุณู ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุฃุณููุจ WriteLine ุ ูููู ูุง ููุฌุฏ ุชุฌุงูุฒ ุณุนุฉ ููุฏุณ ููุง ุ ูููู ูุญุฏุซ ูููู ูุฎุชูู.  ุฏุนููุง ูุญูู ุฐูู ุจูุฒูุฏ ูู ุงูุชูุตูู. <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/6e3/d32/752/6e3d32752ba10fd39d1f4a5e2e6648a7.png"><br><br>  ูู ุงูุฐุงูุฑุฉ ุงูุงูุชุฑุงุถูุฉ ุ ูุง ูููู ููุท ุชุนููู ุงูุตูุญุงุช ุนูู ุงูุฐุงูุฑุฉ ุงููุนููุฉ ุ ูููู ูููู ุฃูุถูุง ุญุฌุฒูุง.  ุฅุฐุง ูุงูุช ุงูุตูุญุฉ ูุญุฌูุฒุฉ ุ ููุฏ ูุงุญุธ ุงูุชุทุจูู ุฃููุง ุณุชุณุชุฎุฏููุง.  ุฅุฐุง ุชู ุชุนููู ุงูุตูุญุฉ ุจุงููุนู ุนูู ุฐุงูุฑุฉ ุญููููุฉ ุฃู ูุจุงุฏูุฉ ุ ูุนูุฏุฆุฐู ุชุณูู "ููุชุฒู" (ููุชุฒู).  ูุณุชุฎุฏู ุงูููุฏุณ ูุฐู ุงููุฏุฑุฉ ูุชูุณูู ุงูุฐุงูุฑุฉ ุฅูู ูุญุฌูุฒุฉ ูููุชุฒูุฉ.  ูุจุฏู ุดูุก ูุซู ูุฐุง: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b17/9e4/41f/b179e441f0c00f18e2a5fdf12b3093a9.png"><br><br>  ุงุชุถุญ ุฃููุง ูุณูู ุทุฑููุฉ WriteLine ุ ุงูุชู ุชุฃุฎุฐ ููุงููุง ูุง ุนูู ุงูููุฏุณ.  ุงุชุถุญ ุฃู ูู ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ูุฏ ุงูุชูุช ุจุงููุนู ุ ููุง ูุนูู ุฃู ูุธุงู ุงูุชุดุบูู ูู ูุฐู ุงููุญุธุฉ ูุฌุจ ุฃู ูุฃุฎุฐ ุตูุญุฉ ูุญุฌูุฒุฉ ุฃุฎุฑู ุนูู ุงูููุฏุณ ููุนูููุง ุนูู ุฐุงูุฑุฉ ูุนููุฉ ุญููููุฉ ุ ูููุฆุฉ ุจุงููุนู ุจูุตูููุงุช ุจุงูุช.  ูุฐุง ูุคุฏู ุฅูู ุงุณุชุซูุงุก StackOverflow. <br><br>  ุณูุณูุญ ูู ุงูููุฏ ุงูุชุงูู ุจุชุฎุตูุต ูู ุงูุฐุงูุฑุฉ ุฅูู ุงูููุฏุณ ูู ุจุฏุงูุฉ ุงูุฏูู ูู ููุช ูุงุญุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; F(), <span class="hljs-number"><span class="hljs-number">4</span></span>*<span class="hljs-number"><span class="hljs-number">1024</span></span>*<span class="hljs-number"><span class="hljs-number">1024</span></span>).Start();</code> </pre><br>  ูุจุฏูุงู ูู ุฐูู ุ ููููู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุนุฏุงุฏ ููุช ุงูุชุดุบูู</a> disableCommitThreadStack.  ูุฌุจ ุชุนุทููู ุญุชู ูุชู ุชูููุฐ ููุฏุณ ูุคุดุฑ ุงูุชุฑุงุจุท ููุฏููุง.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุณููู ุงูุงูุชุฑุงุถู ุงูููุตูู ูู ุงูุชูุซูู ูุงูููุงุญุธ ูู ุงููุงูุน ูุฎุชูู. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/46e/0e6/dbd/46e0e6dbd47906fb1d0ddf74ac927383.png"><br><br><h2 style=";text-align:right;direction:rtl">  ุชุฌุงูุฒ ุณุนุฉ ุงูููุฏุณ </h2><br>  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู StackOverflowException.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุซุงููู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.  ูู ุฃุญุฏูุง ุ ูููู ุจุชุดุบูู ุงูุนูุฏูุฉ ุงููุงููุงุฆูุฉ ุ ููุง ูุคุฏู ุฅูู ุชุฌุงูุฒ ุณุนุฉ ุงูููุฏุณ ุ ูู ุงูุซุงููุฉ ูุฑูู ูุฐุง ุงูุงุณุชุซูุงุก ุจุฑููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { InfiniteRecursion(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception) { ... }</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StackOverflowException(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception) { ... }</code> </pre><br>  ูุธุฑูุง ูุฃู ุฌููุน ุงูุงุณุชุซูุงุกุงุช ุงูุชู ุชู ุทุฑุญูุง ุจุฑููุฉ ูุชู ุงูุชุนุงูู ูุนูุง ุ ูู ุงูุญุงูุฉ ุงูุซุงููุฉ ุณููุชูุท ุงูุงุณุชุซูุงุก.  ููุน ุงูุญุงูุฉ ุงูุฃููู ุ ูู ุดูุก ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  ุฃูุชูู ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MSDN</a> : <br><br><blockquote style=";text-align:right;direction:rtl">  "ูุง ููููู ุงูุชูุงุท ุงุณุชุซูุงุกุงุช ุชุฌุงูุฒ ุณุนุฉ ุงูููุฏุณ ุ ูุฃู ููุฏ ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุก ูุฏ ูุชุทูุจ ุงูููุฏุณ." <br>  MSDN </blockquote><br>  ุชููู ููุง ุฃููุง ูู ูุชููู ูู ุงูุชูุงุท StackOverflowException ุ ูุฃู ุงูุงุนุชุฑุงุถ ููุณู ูุฏ ูุชุทูุจ ูุณุงุญุฉ ููุฏุณ ุฅุถุงููุฉ ูุฏ ุงูุชูุช ุจุงููุนู. <br><br>  ููุญูุงูุฉ ุจุทุฑููุฉ ูุง ูู ูุฐุง ุงูุงุณุชุซูุงุก ุ ูููููุง ุงูููุงู ุจูุง ููู.  ุฃููุงู ุ ููููู ุชุญุฏูุฏ ุนูู ุงูุนูุฏูุฉ.  ุซุงูููุง ุ ููููู ุงุณุชุฎุฏุงู ุฃุณุงููุจ ูุฆุฉ RuntimeHelpers: <br><br><blockquote style=";text-align:right;direction:rtl">  RuntimeHelpers.EnsureSufficientExecutionStack () ุ <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  "ูุถูู ุฃู ูุณุงุญุฉ ุงูููุฏุณ ุงููุชุจููุฉ ูุจูุฑุฉ ุจูุง ูููู ูุชูููุฐ ูุชูุณุท โโูุธููุฉ .NET Framework."  - MSDN <br></li><li style=";text-align:right;direction:rtl">  InsufficientExecutionStackException <br></li><li style=";text-align:right;direction:rtl">  512 ููููุจุงูุช - x86 ุ AnyCPU ุ 2 ููุฌุงุจุงูุช - x64 (ูุตู ุญุฌู ุงูููุฏุณ) <br></li><li style=";text-align:right;direction:rtl">  64/128 ููููุจุงูุช - .NET Core <br></li><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ูุณุงุญุฉ ุนููุงู ุงูููุฏุณ ููุท <br></li></ul><br></blockquote><br>  ุชูุถุญ ูุซุงุฆู ูุฐู ุงูุทุฑููุฉ ุฃููุง ุชุชุญูู ูู ูุฌูุฏ ูุณุงุญุฉ ูุงููุฉ ุนูู ุงูููุฏุณ ูุชูููุฐ <i>ูุชูุณุท</i> ูุธููุฉ .NET.  ูููู ูุง ูู ุงููุธููุฉ <i>ุงููุชูุณุทุฉ</i> ุ  ูู ุงููุงูุน ุ ูู .NET Framework ุ ุชุชุญูู ูุฐู ุงูุทุฑููุฉ ูู ุฃู ูุตู ุญุฌููุง ุนูู ุงูุฃูู ูุฌุงูู ุนูู ุงูููุฏุณ.  ูู .NET Core ุ ูุชุญูู ูู ูุฌูุฏ 64 ูููู ุจุงูุช ูุฌุงููุง. <br><br>  ููุฏ ุธูุฑ ุฃูุถูุง ุชูุงุธุฑู ูู .NET Core: RuntimeHelpers.TryEnsureSufficientExecutionStack () ุงูุฐู ูุนูุฏ ููุทููุฉ ุ ุจุฏูุงู ูู ุฅููุงุก ุงุณุชุซูุงุก. <br><br>  ูุฏู C # 7.2 ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู Span ู stackallock ูุนูุง ุฏูู ุงุณุชุฎุฏุงู ุฑูุฒ ุบูุฑ ุขูู.  ุฑุจูุง ุจุณุจุจ ูุฐุง ุ ุณูุชู ุงุณุชุฎุฏุงู stackalloc ุจุดูู ุฃูุซุฑ ุชูุฑุงุฑูุง ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุณูููู ูู ุงููููุฏ ุฃู ูููู ูุฏูู ุทุฑููุฉ ูุญูุงูุฉ ููุณู ูู StackOverflow ุนูุฏ ุงุณุชุฎุฏุงูู ุ ูุงุฎุชูุงุฑ ููุงู ุชุฎุตูุต ุงูุฐุงูุฑุฉ.  ูุจูุฐู ุงูุทุฑููุฉ ุ ูุชู ุงูุชุฑุงุญ ุทุฑููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุญูู ูู ุฅููุงููุฉ ุงูุชุฎุตูุต ุนูู ุงูููุฏุณ</a> ูุจูุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">trystackalloc</a> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Span&lt;<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>&gt; span; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (CanAllocateOnStack(size)) span = <span class="hljs-keyword"><span class="hljs-keyword">stackalloc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[size]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> span = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[size];</code> </pre><br>  ุงูุนูุฏุฉ ุฅูู ูุซุงุฆู StackOverflow ุนูู MSDN <br><br><blockquote style=";text-align:right;direction:rtl">  ุจุฏูุงู ูู ุฐูู ุ ุนูุฏูุง ูุญุฏุซ ุชุฌุงูุฒ ุณุนุฉ ููุฏุณ ูู <b>ุชุทุจูู ุนุงุฏู</b> ุ ูููู ููุช ุชุดุบูู ุงููุบุฉ ุงูุนุงูุฉ (CLR) ุงูุนูููุฉ ". <br>  MSDN <br></blockquote><br>  ุฅุฐุง ูุงู ููุงู ุชุทุจูู "ุนุงุฏู" ููุน ุฃุซูุงุก StackOverflow ุ ูููุงู ุชุทุจููุงุช ุบูุฑ ุนุงุฏูุฉ ูุง ุชูุนุ  ููุฅุฌุงุจุฉ ุนูู ูุฐุง ุงูุณุคุงู ุ ุณูููู ุนููู ุงููุฒูู ุฅูู ูุณุชูู ูู ูุณุชูู ุงูุชุทุจูู ุงูููุฏุงุฑ ุฅูู ูุณุชูู CLR. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/186/516/64d/18651664dd1c1d1346e5377f0e0b3995.png"><br><br><blockquote style=";text-align:right;direction:rtl">  "ูููู ููุชุทุจูู ุงูุฐู <b>ูุณุชุถูู CLR</b> ุชุบููุฑ ุงูุณููู ุงูุงูุชุฑุงุถู ูุชุญุฏูุฏ ุฃู CLR ูููู ุจุฅูุบุงุก <b>ุชุญููู ูุฌุงู ุงูุชุทุจูู</b> ุญูุซ ูุญุฏุซ ุงูุงุณุชุซูุงุก ุ ููููู ูุชูุญ ุงุณุชูุฑุงุฑ ุงูุนูููุฉ."  - MSDN <br>  StackOverflowException -&gt; AppDomainUnloadedException <br></blockquote><br>  ูููู ููุชุทุจูู ุงูุฐู ูุณุชุถูู CLR ุฅุนุงุฏุฉ ุชุนุฑูู ุณููู ุชุฌุงูุฒ ุณุนุฉ ุงูููุฏุณ ุจุญูุซ ุจุฏูุงู ูู ุฅููุงู ุงูุนูููุฉ ุจุฃููููุง ุ ูุชู ุฅูุบุงุก ุชุญููู ูุฌุงู ุงูุชุทุจูู ุ ูู ุงูุฏูู ุงูุฐู ุญุฏุซ ููู ุชุฌุงูุฒ ุงูุญุฏ ุงูุฃูุตู.  ุญุชู ูุชููู ูู ุชุญููู StackOverflowException ุฅูู AppDomainUnloadedException. <br><br>  ุนูุฏ ุชุดุบูู ุชุทุจูู ููุฏุงุฑ ุ ูุจุฏุฃ ููุช ุชุดุบูู .NET ุชููุงุฆููุง.  ูููู ููููู ุงูุฐูุงุจ ูู ุงูุงุชุฌุงู ุงูุขุฎุฑ.  ุนูู ุณุจูู ุงููุซุงู ุ ุงูุชุจ ุชุทุจูููุง ุบูุฑ ููุฏุงุฑ (ูู ูุบุฉ C ++ ุฃู ูุบุฉ ุฃุฎุฑู) ุณูุณุชุฎุฏู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุฎุงุตุฉ ูู ุฃุฌู ุฑูุน CLR ูุชุดุบูู ุชุทุจูููุง.  ุงูุชุทุจูู ุงูุฐู ูููู ุจุชุดุบูู CLR ุฏุงุฎูููุง ุณูุณูู CLR-host.  ูู ุฎูุงู ูุชุงุจุชู ุ ูููููุง ุชูููู ุงูุนุฏูุฏ ูู ุงูุฃุดูุงุก ูู ููุช ุงูุชุดุบูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุณุชุจุฏู ูุฏูุฑ ุงูุฐุงูุฑุฉ ููุฏูุฑ ุณูุณูุฉ ุงููุญุงุฏุซุงุช.  ูุญู ูู ุงูุฅูุชุงุฌ ูุณุชุฎุฏู CLR-host ูุชุฌูุจ ุชุจุฏูู ุตูุญุงุช ุงูุฐุงูุฑุฉ. <br><br>  ููููู ุงูุฑูุฒ ุงูุชุงูู ูุถูู CLR ุจุญูุซ ูุชู ุฅูุบุงุก ุชุญููู AppDomain (C ++) ุฃุซูุงุก StackOverflow: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">ICLRPolicyManager *policyMgr; pCLRControl-&gt;GetCLRManager(IID_ICLRPolicyManager, (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>**) (&amp;policyMgr)); policyMgr-&gt;SetActionOnFailure(FAIL_StackOverflow, eRudeUnloadAppDomain);</code> </pre><br>  ูู ูุฐู ุทุฑููุฉ ุฌูุฏุฉ ูููุฑูุจ ูู StackOverflowุ  ุฑุจูุง ููุณ ูุฐูู.  ุฃููุงู ุ ูุงู ุนูููุง ูุชุงุจุฉ ุฑูุฒ C ++ ุ ูุงูุฐู ูุง ูุฑูุฏ ุงูููุงู ุจู.  ุซุงูููุง ุ ูุฌุจ ุนูููุง ุชุบููุฑ ุฑูุฒ C # ุงูุฎุงุต ุจูุง ุจุญูุซ ูุชู ุชูููุฐ ุงููุธููุฉ ุงูุชู ูููููุง ุฑูู StackOverflowException ูู AppDomain ูููุตู ููู ุณูุณูุฉ ูุญุงุฏุซุงุช ูููุตูุฉ.  ุณูุชุญูู ุฑูุฒูุง ุนูู ุงูููุฑ ุฅูู ูุซู ูุฐู ุงูููุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appDomain = AppDomain.CreateDomain(<span class="hljs-string"><span class="hljs-string">"..."</span></span>); appDomain.DoCallBack(() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> thread = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(() =&gt; InfiniteRecursion()); thread.Start(); thread.Join(); }); AppDomain.Unload(appDomain); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (AppDomainUnloadedException) { }</code> </pre><br>  ูู ุฃุฌู ุงุณุชุฏุนุงุก ุทุฑููุฉ InfiniteRecursion ุ ูุชุจูุง ูุฌููุนุฉ ูู ุงูุฎุทูุท.  ุซุงูุซูุง ุ ุจุฏุฃูุง ูู ุงุณุชุฎุฏุงู AppDomain.  ููุฐุง ูููู ูุฌููุนุฉ ูู ุงููุดุงูู ุงูุฌุฏูุฏุฉ.  ุจูุง ูู ุฐูู ูุน ุงูุงุณุชุซูุงุกุงุช.  ููุฑ ูู ูุซุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CustomException</span></span> : <span class="hljs-title"><span class="hljs-title">Exception</span></span> {} <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appDomain = AppDomain.CreateDomain( <span class="hljs-string"><span class="hljs-string">"..."</span></span>); appDomain.DoCallBack(() =&gt; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomException()); System.Runtime.Serialization.SerializationException: Type <span class="hljs-string"><span class="hljs-string">'CustomException'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> not marked <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> serializable. at System.AppDomain.DoCallBack(CrossAppDomainDelegate callBackDelegate)</code> </pre><br>  ูุธุฑูุง ูุฃู ุงุณุชุซูุงุกูุง ูู ูุชู ูุถุน ุนูุงูุฉ ุนููู ุนูู ุฃูู ูุงุจู ููุชุณูุณู ุ ูุณูุชู ุฅุณูุงุท ุฑูุฒูุง ูุน SerializationException.  ููุฅุตูุงุญ ูุฐู ุงููุดููุฉ ุ ูุง ูููู ุฃู ูููุฒ ุงุณุชุซูุงุกูุง ุจุณูุฉ Serializable ุ ููุง ุฒููุง ุจุญุงุฌุฉ ุฅูู ุชุทุจูู ูููุดุฆ ุฅุถุงูู ููุชุณูุณู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Serializable</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CustomException</span></span> : <span class="hljs-title"><span class="hljs-title">Exception</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CustomException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CustomException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SerializationInfo info, StreamingContext ctx</span></span></span><span class="hljs-function">) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">base</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">info, context</span></span></span><span class="hljs-function">)</span></span>{} } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> appDomain = AppDomain.CreateDomain(<span class="hljs-string"><span class="hljs-string">"..."</span></span>); appDomain.DoCallBack(() =&gt; <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomException());</code> </pre><br>  ูู ุดูุก ููุณ ุฌููููุง ุฌุฏูุง ุ ูุฐูู ูุฐูุจ ุฅูู ุฃุจุนุฏ ูู ุฐูู - ุฅูู ูุณุชูู ูุธุงู ุงูุชุดุบูู ูุงูุงุฎุชุฑุงู ุ ูุงูุฐู ูุง ููุจุบู ุงุณุชุฎุฏุงูู ูู ุงูุฅูุชุงุฌ. <br><br><h2 style=";text-align:right;direction:rtl">  Seh / veh </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/2c5/7a2/aff/2c57a2aff0542b2a02ad8ab34d097412.png"><br><br>  ูุงุญุธ ุฃูู ุจูููุง ุชุทูุฑ ุงูุงุณุชุซูุงุกุงุช ุงูููุฏุงุฑุฉ ุจูู ุงูููุฏุงุฑ ู CLR ุ ุชูุชูู ุงุณุชุซูุงุกุงุช SEH ุจูู CLR ู Windows. <br><br>  SEH - ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช ุงููุฑูุจุฉ <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฑู ูุนุงูุฌุฉ ุงุณุชุซูุงุก Windows <br></li><li style=";text-align:right;direction:rtl">  ูุนุงูุฌุฉ ููุญุฏุฉ ููุจุฑุงูุฌ ูุงูุฃุฌูุฒุฉ <br></li><li style=";text-align:right;direction:rtl">  ุชู ุชูููุฐ ุงุณุชุซูุงุกุงุช C # ุฃุนูู SEH <br></li></ul><br>  SEH ูู ุขููุฉ ููุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช ูู Windows ุ ููู ุชุณูุญ ูู ุจุงูุชุนุงูู ุจุดูู ูุชุณุงูู ูุน ุฃู ุงุณุชุซูุงุกุงุช ุฌุงุกุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ูุณุชูู ุงููุนุงูุฌ ุ ุฃู ูุงูุช ูุฑุชุจุทุฉ ุจููุทู ุงูุชุทุจูู ููุณู. <br><br>  ูุนุฑู Rantime .NET ุนู ุงุณุชุซูุงุกุงุช SEH ูููููู ุชุญููููุง ุฅูู ุงุณุชุซูุงุกุงุช ููุฏุงุฑุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  EXCEPTION_STACK_OVERFLOW -&gt; ุชุญุทู <br></li><li style=";text-align:right;direction:rtl">  EXCEPTION_ACCESS_VIOLATION -&gt; AccessViolationException <br></li><li style=";text-align:right;direction:rtl">  EXCEPTION_ACCESS_VIOLATION -&gt; NullReferenceException <br></li><li style=";text-align:right;direction:rtl">  EXCEPTION_INT_DIVIDE_BY_ZERO -&gt; DivideByZeroException <br></li><li style=";text-align:right;direction:rtl">  ุงุณุชุซูุงุกุงุช SEH ุบูุฑ ูุนุฑููุฉ -&gt; SEHException <br></li></ul><br>  ูููููุง ุงูุชูุงุนู ูุน SEH ูู ุฎูุงู WinApi. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"kernel32.dll"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RaiseException</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dwExceptionCode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dwExceptionFlags, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> nNumberOfArguments,IntPtr lpArguments</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-comment"><span class="hljs-comment">// DivideByZeroException RaiseException(0xc0000094, 0, 0, IntPtr.Zero); // Stack overflow RaiseException(0xc00000fd, 0, 0, IntPtr.Zero);</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุงูุน ุ ูุนูู ูููู ุงูุฑูู ุฃูุถูุง ูู ุฎูุงู SEH. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> -&gt; RaiseException(<span class="hljs-number"><span class="hljs-number">0xe0434f4d</span></span>, ...)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ููุง ุฅูู ุฃู ุฑูุฒ ุงุณุชุซูุงุก CLR ูู ููุณู ุฏุงุฆููุง ุ ูุฐูู ุจุบุถ ุงููุธุฑ ุนู ููุน ุงูุงุณุชุซูุงุก ุงูุฐู ูุทุฑุญู ุ ุณุชุชู ูุนุงูุฌุชู ุฏุงุฆููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VEH ูู ูุนุงูุฌุฉ ุงุณุชุซูุงุก ูุชุฌู ุ ููู ุงูุชุฏุงุฏ ูู SEH ุ ููููู ูุนูู ุนูู ูุณุชูู ุงูุนูููุฉ ุ ูููุณ ุนูู ูุณุชูู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงู SEH ูุดุงุจููุง ูุบูููุง ูุชุฌุฑุจุฉ ุงูุงูุชูุงุท ุ ูุฅู VEH ูุดุจู ุฅูู ุญุฏ ูุง ูุนุงูุฌ ุงูููุงุทุนุฉ. </font><font style="vertical-align: inherit;">ูููู ุจุจุณุงุทุฉ ุจุชุนููู ูุนุงูุฌูุง ููููููุง ุชููู ูุนูููุงุช ุญูู ุฌููุน ุงูุงุณุชุซูุงุกุงุช ุงูุชู ุชุญุฏุซ ูู ุนูููุชูุง. </font><font style="vertical-align: inherit;">ููุฒุฉ ูุซูุฑุฉ ููุงูุชูุงู ูู VEH ูู ุฃููุง ุชุณูุญ ูู ุจุชุบููุฑ ุงุณุชุซูุงุก SEH ูุจู ุฃู ุชุตู ุฅูู ุงููุนุงูุฌ.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b8/79d/848/7b879d848390b9e3d1b9156b00b8e2bf.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููููุง ูุถุน ูุนุงูุฌ ุงููุชุฌู ุงูุฎุงุต ุจูุง ุจูู ูุธุงู ุงูุชุดุบูู ูููุช ุงูุชุดุบูู ุ ูุงูุฐู ุณูุชุนุงูู ูุน ุงุณุชุซูุงุกุงุช SEH ุ ูุนูุฏูุง ููุงุฌู EXCEPTION_STACK_OVERFLOW ุ ูู ุจุชุบููุฑู ุจุญูุซ ูุง ูุนุทู ููุช ุชุดุบูู .NET ุงูุนูููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุงูุชูุงุนู ูุน VEH ูู ุฎูุงู WinApi:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"kernel32.dll"</span></span></span><span class="hljs-meta">, SetLastError = true)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> IntPtr </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AddVectoredExceptionHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IntPtr FirstHandler,  VECTORED_EXCEPTION_HANDLER VectoredHandler</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> VEH </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PVECTORED_EXCEPTION_HANDLER</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> EXCEPTION_POINTERS exceptionPointers</span></span></span><span class="hljs-function">)</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> VEH : <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> { EXCEPTION_CONTINUE_SEARCH = <span class="hljs-number"><span class="hljs-number">0</span></span>, EXCEPTION_EXECUTE_HANDLER = <span class="hljs-number"><span class="hljs-number">1</span></span>, EXCEPTION_CONTINUE_EXECUTION = <span class="hljs-number"><span class="hljs-number">-1</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> VEH </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PVECTORED_EXCEPTION_HANDLER</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> EXCEPTION_POINTERS exceptionPointers</span></span></span><span class="hljs-function">)</span></span>; [StructLayout(LayoutKind.Sequential)] <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> EXCEPTION_POINTERS { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> EXCEPTION_RECORD* ExceptionRecord; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IntPtr Context; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">delegate</span></span></span><span class="hljs-function"> VEH </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PVECTORED_EXCEPTION_HANDLER</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> EXCEPTION_POINTERS exceptionPointers</span></span></span><span class="hljs-function">)</span></span>; [StructLayout(LayoutKind.Sequential)] <span class="hljs-keyword"><span class="hljs-keyword">unsafe</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> EXCEPTION_RECORD { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint</span></span> ExceptionCode; ... }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ุงูุณูุงู ุนูู ูุนูููุงุช ุญูู ุญุงูุฉ ูุงูุฉ ุณุฌูุงุช ุงููุนุงูุฌ ูู ููุช ุงูุงุณุชุซูุงุก. </font><font style="vertical-align: inherit;">ุณูููู ููุชููู ุจู EXCEPTION_RECORD ูุญูู ExceptionCode ููู. </font><font style="vertical-align: inherit;">ูููููุง ุงุณุชุจุฏุงูู ุจุฑูุฒ ุงูุงุณุชุซูุงุก ุงูุฎุงุต ุจูุง ุ ูุงูุฐู ูุง ูุนุฑู CLR ุนูู ุดูุฆูุง. </font><font style="vertical-align: inherit;">ูุจุฏู ูุนุงูุฌ ุงููุชุฌูุงุช ูุงูุชุงูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">unsafe</span></span></span><span class="hljs-function"> VEH </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Handler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> EXCEPTION_POINTERS e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.ExceptionRecord == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> VEH. EXCEPTION_CONTINUE_SEARCH; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> record = e. ExceptionRecord; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (record-&gt;ExceptionCode != ExceptionStackOverflow) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> VEH. EXCEPTION_CONTINUE_SEARCH; record-&gt;ExceptionCode = <span class="hljs-number"><span class="hljs-number">0x01234567</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> VEH. EXCEPTION_EXECUTE_HANDLER; }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุณููุดุฆ ุงูุขู ูุฌูููุนูุง ูุซุจุช ูุนุงูุฌ ูุชุฌู ูู ุดูู ุทุฑููุฉ HandleSO ุ ูุงูุฐู ูุณุชูุนุจ ูููุถูุง ูู ุงููุญุชูู ุฃู ูุณูุท ูู StackOverflowException (ููุชูุถูุญ ุ ูุง ูุชุนุงูู ุงูุฑูุฒ ูุน ุฃุฎุทุงุก ูุธููุฉ WinApi ูุฅุฒุงูุฉ ูุนุงูุฌ ุงููุชุฌู). </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">HandleSO(() =&gt; InfiniteRecursion()) ; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> T HandleSO&lt;T&gt;(Func&lt;T&gt; action) { Kernel32. AddVectoredExceptionHandler(IntPtr.Zero, Handler); Kernel32.SetThreadStackGuarantee(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> size); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) when ((<span class="hljs-keyword"><span class="hljs-keyword">uint</span></span>) Marshal. GetExceptionCode() == <span class="hljs-number"><span class="hljs-number">0x01234567</span></span>) {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>(T); } HandleSO(() =&gt; InfiniteRecursion());</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฏุงุฎูู ุ ูุชู ุฃูุถูุง ุงุณุชุฎุฏุงู ุทุฑููุฉ SetThreadStackGuarantee. </font><font style="vertical-align: inherit;">ุชุญุฌุฒ ูุฐู ุงูุทุฑููุฉ ูุณุงุญุฉ ููุฏุณ ููุนุงูุฌุฉ StackOverflow. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจูุฐู ุงูุทุฑููุฉ ุ ูููููุง ุงูุจูุงุก ุนูู ููุฏ ุงูุญูุงุฉ ุจุงุณุชุฏุนุงุก ุทุฑููุฉ ูุน ุงูุนูุฏูุฉ ุงููุงููุงุฆูุฉ. </font><font style="vertical-align: inherit;">ุณูุณุชูุฑ ุงูุจุซ ูุฏููุง ูู ุงูุนูู ููุง ูู ูู ูุญุฏุซ ุดูุก ุ ููุง ูู ูู ูุญุฏุซ ุชุฌุงูุฒ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ูุงุฐุง ูุญุฏุซ ุฅุฐุง ุงุชุตูุช ุจู HandleSO ูุฑุชูู ูู ููุณ ุงูููุถูุนุ</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">HandleSO(() =&gt; InfiniteRecursion()); HandleSO(() =&gt; InfiniteRecursion());</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูููู ููุงู AccessViolationException. ุงูุนูุฏุฉ ุฅูู ุฌูุงุฒ ุงูููุฏุณ. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/639/e93/c8d/639e93c8d187dc31fc37a2ac7247f193.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููู ููุธุงู ุงูุชุดุบูู ุงููุดู ุนู ุชุฌุงูุฒุงุช ุงูููุฏุณ. ูู ุฃุนูู ุงูููุฏุณ ุชูุฌุฏ ุตูุญุฉ ุฎุงุตุฉ ุชุญูู ุนูุงูุฉ ุตูุญุฉ ุงูุญูุงูุฉ. ูู ุงููุฑุฉ ุงูุฃููู ุงูุชู ูุชู ูููุง ุงููุตูู ุฅูู ูุฐู ุงูุตูุญุฉ ุ ุณูุญุฏุซ ุงุณุชุซูุงุก ุขุฎุฑ - STATUS_GUARD_PAGE_VIOLATION ุ ูุณุชุชู ุฅุฒุงูุฉ ุนูุงูุฉ ุตูุญุฉ ุงูุญูุงูุฉ ูู ุงูุตูุญุฉ. ุฅุฐุง ููุช ุจุจุณุงุทุฉ ุจุงุนุชุฑุงุถ ูุฐุง ุงููุงุฆุถ ุ ููู ุชููู ูุฐู ุงูุตูุญุฉ ุนูู ุงูููุฏุณ - ูู ุงูุชุฏูู ุงููุงุฆุถ ุงูุชุงูู ุ ูู ูุชููู ูุธุงู ุงูุชุดุบูู ูู ููู ูุฐุง ูุณูุชุฌุงูุฒ ูุคุดุฑ ุงูููุฏุณ ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ููููุฏุณ. ูุชูุฌุฉ ูุฐูู ุ ุณูุญุฏุซ AccessViolationException. ูุฐูู ุชุญุชุงุฌ ุฅูู ุงุณุชุนุงุฏุฉ ุนูุงูุงุช ุงูุตูุญุฉ ุจุนุฏ ูุนุงูุฌุฉ StackOverflow - ุฃุณูู ุทุฑููุฉ ููููุงู ุจุฐูู ูู ุงุณุชุฎุฏุงู ุทุฑููุฉ _resetstkoflw ูู ููุชุจุฉ ููุช ุงูุชุดุบูู C (msvcrt.dll).</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"msvcrt.dll"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _resetstkoflw();</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุทุฑููุฉ ููุงุซูุฉ ุ ููููู ุงูุชูุงุท AccessViolationException ูู .NET Core ุถูู Windows ุ ููุง ูุคุฏู ุฅูู ุชุนุทู ุงูุนูููุฉ. </font><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ ูุฌุจ ุฃู ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุชุฑุชูุจ ุงูุฐู ูุชู ููู ุงุณุชุฏุนุงุก ูุนุงูุฌุงุช ุงููุชุฌูุงุช ูุชุนููู ุงููุนุงูุฌ ุงูุฎุงุต ุจู ุนูู ุจุฏุงูุฉ ุงูุณูุณูุฉ ุ ุญูุซ ูุณุชุฎุฏู .NET Core ุฃูุถูุง VEH ุนูุฏ ูุนุงูุฌุฉ AccessViolation. </font><font style="vertical-align: inherit;">ุชููู ุงููุนููุฉ ุงูุฃููู ููุฏุงูุฉ AddVectoredExceptionHandler ูุณุคููุฉ ุนู ุงูุชุฑุชูุจ ุงูุฐู ูุชู ูู ุฎูุงูู ุงุณุชุฏุนุงุก ุงููุนุงูุฌุงุช:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">Kernel32.AddVectoredExceptionHandler(FirstHandler: (IntPtr) <span class="hljs-number"><span class="hljs-number">1</span></span>, handler);</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุนุฏ ุฏุฑุงุณุฉ ุงููุถุงูุง ุงูุนูููุฉ ุ ููุฎุต ุงููุชุงุฆุฌ ุงูุนุงูุฉ: </font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุงุณุชุซูุงุกุงุช ููุณุช ุจุณูุทุฉ ููุง ุชุจุฏู ุ </font></font><br></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุง ูุชู ุงูุชุนุงูู ูุน ุฌููุน ุงูุงุณุชุซูุงุกุงุช ุจููุณ ุงูุทุฑููุฉ ุ </font></font><br></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุญุฏุซ ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช ุนูู ูุณุชููุงุช ูุฎุชููุฉ ูู ุงูุชุฌุฑูุฏ ุ </font></font><br></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููููู ุงูุชุฏุฎู ูู ุนูููุฉ ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช ูุฌุนู ููุช ุชุดุบูู .NET ูุนูู ุจุดูู ูุฎุชูู ุนู ุงูุบุฑุถ ุงูุฃุตูู. </font></font><br></li></ul><br><h2 style=";text-align:right;direction:rtl">  ุงููุฑุงุฌุน </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">โ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณุชูุฏุน ูุน ุฃูุซูุฉ ูู ุงูุชูุฑูุฑ</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> โ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dotnext 2016 ููุณูู - ุขุฏู ุณูุชููู - ุงุณุชุซูุงุกุงุช ุงุณุชุซูุงุฆูุฉ ูู .NET</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> โ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DotNetBook: ุงุณุชุซูุงุกุงุช</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> โ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.NET Inside Out Part 8 - ุงูุชุนุงูู ูุน ุงุณุชุซูุงุก ุชุฌุงูุฒ ุณุนุฉ ุงูููุฏุณ ูู C # ูุน VEH</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุทุฑููุฉ ุฃุฎุฑู ูุงุนุชุฑุงุถ StackOverflow.</font></font><br><br><blockquote style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู 22 ุฅูู 23 ููููุจุฑ ุ ุณูุชุญุฏุซ ููุฌูู ูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DotNext 2018 ููุณูู</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุชูุฑูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"ููุงููุณ ุงููุธุงู: </font></font></a><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">ุฌูุน </font></b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุงูุนุซุฑุงุช"</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุณูุฃุชู ุฅูู ููุณูู ุฌููุฑู ุฑูุดุชุฑ ุ ุฌุฑูุฌ ูููุฌ ุ ุจุงูู ููุณูููููุชุด ูุบูุฑูู ูู ุงููุชุญุฏุซูู ุงููุซูุฑูู ููุงูุชูุงู. </font><font style="vertical-align: inherit;">ูููู ุงูุงุทูุงุน ุนูู ููุงุถูุน ุงูุชูุงุฑูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ูุดุฑุงุก ุงูุชุฐุงูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุงูุถู ุงูุขู!</font></font></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar426045/">https://habr.com/ru/post/ar426045/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar426029/index.html">ูู ุชุณุชุณูู ูุชุฑูุฏ ุฅููุงุก ุงููููุฉุ ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุจุฏู ุจูุง ุชุฏุฑูุจ ุงููุทูุฑ ุงููุนุงู</a></li>
<li><a href="../ar426031/index.html">ูุฏ ูุนุชูุฏ ุงูููู ุจุดุฃู ุงูุงุณุชููุงุก ุนูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ุนูู ุงูุนุงูู ุนูู ุงูุชุฑุงุถุงุช ุบูุฑ ุนูููุฉ</a></li>
<li><a href="../ar426033/index.html">ุงุดุชุจู ุฌุจุงุจุฑุฉ ุงูุฑูุงุถูุงุช ุญูู ุฅุซุจุงุช ููุญูู ููุฑุถูุฉ ABC</a></li>
<li><a href="../ar426039/index.html">ุฅุทูุงู ุงูุทูุงุฑุฆ "Soyuz MS-10" (ุฅููุงุฐ ุงูุทุงูู ุ ุงูุจุซ ุนุจุฑ)</a></li>
<li><a href="../ar426041/index.html">ุญู ุฑูุฒู ูููุนุงุฏูุงุช ุงูุชูุงุถููุฉ ุงูุฎุทูุฉ ูุงููุธู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุชุญููู ูุงุจูุงุณ ุจุงุณุชุฎุฏุงู SymPy</a></li>
<li><a href="../ar426047/index.html">10 ูุชุจ ุฑุงุฆุนุฉ ูููุจุชุฏุฆูู ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</a></li>
<li><a href="../ar426051/index.html">ุชุญุณูู ููุงุฑุงุช ุชุตุญูุญ ุงูุจุฑุงูุฌ - ุจุนุถ ุงููุตุงุฆุญ</a></li>
<li><a href="../ar426053/index.html">ุงูุชุฎุฒูู ุงููุคูุช ููุนุงูุฌ ุงูุฃุญุฏุงุซ ูุชุญุณูู ุฃุฏุงุก ุงูุชุทุจูู ุงููุชูุงุนู</a></li>
<li><a href="../ar426055/index.html">TensorFlow.js ู clmtrackr.js: ุชุชุจุน ุงุชุฌุงู ูุธุฑุฉ ุงููุณุชุฎุฏู ูู ุงููุชุตูุญ</a></li>
<li><a href="../ar426059/index.html">ููุงุก ุชูุชู PHP # 2: ููุฏูู ุงูุฎุทุจ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>