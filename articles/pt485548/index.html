<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåó üë∏üèæ üå∑ SwiftUI nas prateleiras üöµüèº üëÖ üíí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Toda vez que uma nova estrutura aparece em uma linguagem de programa√ß√£o, mais cedo ou mais tarde, aparecem pessoas que aprendem a linguagem com ela. P...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwiftUI nas prateleiras</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485548/">  Toda vez que uma nova estrutura aparece em uma linguagem de programa√ß√£o, mais cedo ou mais tarde, aparecem pessoas que aprendem a linguagem com ela.  Provavelmente esse foi o caso no desenvolvimento do IOS no momento do surgimento do Swift: no in√≠cio, era considerado um complemento ao Objective-C - mas ainda n√£o o encontrei.  Agora, se voc√™ come√ßar do zero, a escolha do idioma n√£o vale mais a pena.  Swift est√° al√©m da concorr√™ncia. <br><br>  A mesma coisa, mas em menor escala, est√° acontecendo com estruturas.  A apar√™ncia do SwiftUI n√£o √© exce√ß√£o.  Provavelmente sou um representante da primeira gera√ß√£o de desenvolvedores que come√ßou aprendendo SwiftUI, ignorando o UIKit.  Isso tem um pre√ßo - at√© o momento existem muito poucos materiais de treinamento e exemplos de c√≥digo de trabalho.  Sim, a rede j√° possui v√°rios artigos informando sobre um recurso espec√≠fico, uma ferramenta espec√≠fica.  No mesmo site <a href="https://www.hackingwithswift.com/quick-start/swiftui" rel="nofollow">www.hackingwithswift.com</a> , j√° existem muitos exemplos de c√≥digo com explica√ß√µes.  No entanto, eles fazem pouco para ajudar aqueles que decidem aprender SwiftUI do zero, como eu.  A maioria dos materiais da rede s√£o respostas a perguntas espec√≠ficas e formuladas.  Um desenvolvedor experiente pode descobrir facilmente como tudo funciona, por que √© assim e por que deve ser aplicado.  Para um iniciante, primeiro voc√™ precisa entender que pergunta fazer e s√≥ ent√£o ele poder√° acessar esses artigos. <br><br><img src="https://habrastorage.org/webt/1u/td/t6/1utdt6xa6tcsov4biwj2ura36s0.png"><br><br>  De acordo com o corte, tentarei sistematizar e classificar o que consegui aprender no momento.  O formato do artigo √© quase um guia, embora seja uma folha de dicas compilada por mim na forma em que eu mesmo gostaria de l√™-lo no in√≠cio da minha jornada.  Para desenvolvedores experientes que ainda n√£o se aprofundaram no SwiftUI, tamb√©m existem alguns exemplos de c√≥digo interessantes e explica√ß√µes em texto podem ser lidas na diagonal. <br><br>  Espero que este artigo poupe algum tempo em que voc√™ tamb√©m queira sentir um pouco de m√°gica. <br><a name="habracut"></a><br><h3>  Para come√ßar, um pouco sobre voc√™ </h3><br>  Praticamente n√£o tenho experi√™ncia em desenvolvimento m√≥vel e experi√™ncia significativa <br>  em 1s n√£o poderia ajudar muito aqui.  Sobre como e por que decidi aprender o SwiftUI, vou lhe dizer outra hora, se for interessante para algu√©m, √© claro. <br><br>  Aconteceu que o in√≠cio da minha imers√£o no desenvolvimento m√≥vel coincidiu com o lan√ßamento do iOS 13 e SwiftUI.  Este √© um sinal, pensei, e decidi come√ßar imediatamente com ele, ignorando o UIKit.  Achei uma coincid√™ncia divertida ter come√ßado a trabalhar com o 1c nesses momentos: ent√£o apenas os formul√°rios gerenciados apareceram.  No caso de 1c, a populariza√ß√£o de novas tecnologias levou quase cinco anos.  Toda vez que um desenvolvedor era instru√≠do a implementar algumas novas funcionalidades, ele enfrentava uma op√ß√£o: faz√™-lo de maneira r√°pida e confi√°vel, com ferramentas familiares, ou gastar muito tempo mexendo em novas, e sem garantias de resultados.  No momento, a escolha era feita em favor da velocidade e da qualidade, e o tempo de investimento em novas ferramentas foi adiado por um per√≠odo muito longo. <br><br>  Agora, aparentemente, a situa√ß√£o com o SwiftUI √© praticamente a mesma.  Todo mundo est√° interessado, todo mundo entende que esse √© o futuro, mas at√© agora poucos se dedicaram a estud√°-lo.  A menos que para projetos de animais de estima√ß√£o. <br><br>  Em geral, n√£o me importava qual estrutura estudar, e decidi me arriscar, apesar da opini√£o geral de que seria poss√≠vel lan√ß√°-la em produ√ß√£o em um ano ou dois.  E como eu estava entre os pioneiros, decidi compartilhar experi√™ncias pr√°ticas.  Quero dizer que n√£o sou um guru e, em geral, no desenvolvimento m√≥vel - uma chaleira.  No entanto, eu j√° segui um certo caminho, durante o qual pesquisei toda a Internet em busca de informa√ß√µes, e posso dizer com confian√ßa que isso n√£o √© suficiente e praticamente n√£o √© sistematizado.  Mas, em russo, √© claro, √© praticamente inexistente.  Nesse caso, decidi reunir minhas for√ßas, afastar o complexo do <a href="https://habr.com/ru/post/370877">impostor</a> e compartilhar com a comunidade o que consegui descobrir.  Partirei da suposi√ß√£o de que o leitor j√° est√° pelo menos minimamente familiarizado com o SwiftUI e n√£o decifrarei coisas como <code>VStack{‚Ä¶}</code> , <code>Text(‚Ä¶)</code> etc. <br><br>  Enfatizo mais uma vez que descreverei melhor minhas pr√≥prias impress√µes de tentativas para alcan√ßar o resultado desejado do SwiftUI.  Eu n√£o conseguia entender algo e, a partir de algumas experi√™ncias, para tirar conclus√µes erradas ou imprecisas, portanto quaisquer corre√ß√µes e esclarecimentos s√£o fortemente bem-vindos. <br><br>  Para desenvolvedores experientes, este artigo pode parecer cheio de descri√ß√µes de coisas √≥bvias, mas n√£o julga rigorosamente.  Tutoriais para manequins no SwiftUI ainda n√£o foram escritos. <br><br><h2>  Que diabos √© esse SwiftUI? </h2><br>  Ent√£o, eu provavelmente come√ßaria com o que se trata, este √© o seu SwiftUI.  Aqui, novamente, meu primeiro passado surge.  A analogia com os formul√°rios gerenciados s√≥ ficou mais forte quando assisti a alguns v√≠deos tutoriais sobre como fazer o layout de interfaces no Storyboard (por exemplo, ao trabalhar com o UIKit).  Tomei nostalgia de acordo com as formas "incontrol√°veis" em 1s: coloca√ß√£o manual de elementos no formul√°rio e, especialmente, liga√ß√µes ... Ah, quando o autor do v√≠deo de treinamento por cerca de 20 minutos falou sobre os meandros da liga√ß√£o de v√°rios elementos entre si e as bordas da tela, lembrei com um sorriso 1C - tudo era o mesmo antes de formas controladas.  Bem, quase ... um pouco pior, √© claro, bem, e consequentemente - mais f√°cil.  E o SwiftUI √©, aproximadamente, formul√°rios gerenciados da Apple.  Sem liga√ß√µes.  N√£o h√° storyboards e segways.  Voc√™ simplesmente descreve a estrutura da sua exibi√ß√£o no c√≥digo.  E isso √© tudo.  Todos os par√¢metros, tamanhos, etc. s√£o definidos diretamente no c√≥digo - mas de maneira bastante simples.  Mais precisamente, voc√™ pode editar os par√¢metros dos objetos existentes no Canvas, mas, para isso, primeiro √© necess√°rio adicion√°-los ao c√≥digo.  Honestamente, n√£o sei como isso funcionar√° em grandes equipes de desenvolvimento, onde √© habitual separar o layout do design e o conte√∫do do pr√≥prio View, mas como desenvolvedor independente, gosto muito dessa abordagem. <br><br><h3>  Estilo declarativo </h3><br>  O SwiftUI pressup√µe que a descri√ß√£o da estrutura da sua visualiza√ß√£o esteja totalmente em c√≥digo.  Al√©m disso, a Apple nos oferece um estilo declarativo de escrever esse c√≥digo.  Ou seja, algo como isto: <br><blockquote>  ‚ÄúEsta √© uma vis√£o.  <s>(Por algum motivo, quero dizer "visualizar" e, portanto, aplicar declina√ß√£o a uma palavra feminina)</s> consiste em dois campos de texto e uma imagem.  Os campos de texto s√£o organizados um ap√≥s o outro horizontalmente.  A imagem est√° embaixo deles e suas bordas s√£o cortadas na forma de um c√≠rculo ". </blockquote>  Parece incomum, certo?  Normalmente, no c√≥digo que descrevemos o processo em si, o que precisa ser feito para alcan√ßar o resultado que temos em nossa mente: <br><blockquote>  ‚ÄúInsira um bloco, insira um campo de texto nesse bloco, seguido por outro campo de texto e, depois disso, tire uma foto, corte as bordas arredondando-as e cole abaixo.‚Äù </blockquote>  Parece uma instru√ß√£o para m√≥veis da Ikea.  E no swiftUI, vemos imediatamente qual deve ser o resultado.  Mesmo sem o Canvas ou a depura√ß√£o, a estrutura do c√≥digo reflete claramente a estrutura da Visualiza√ß√£o.  √â claro o que e em que sequ√™ncia ser√° exibida e com quais efeitos. <br><br>  Um excelente artigo sobre o FunctionBuilder e como ele permite escrever c√≥digo em um estilo declarativo j√° est√° em <a href="https://habr.com/ru/company/tinkoff/blog/455760/">Habr√©</a> . <br><br>  Em princ√≠pio, muito foi escrito sobre o estilo declarativo e suas vantagens, ent√£o eu o arredondarei.  Acrescentarei que me acostumei e realmente senti como √© conveniente escrever c√≥digo nesse estilo quando se trata de interfaces.  Com isso, a Apple atingiu o que √© chamado de alvo! <br><br><h2>  Em que consiste o View? </h2><br>  Mas vamos dar uma olhada.  A Apple sugere que o estilo declarativo √© assim: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text1 = <span class="hljs-string"><span class="hljs-string">"some text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text2 = <span class="hljs-string"><span class="hljs-string">"some more text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(text1) .padding() .frame(width: <span class="hljs-number"><span class="hljs-number">100</span></span>, height: <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(text2) .background(<span class="hljs-type"><span class="hljs-type">Color</span></span>.gray) .border(<span class="hljs-type"><span class="hljs-type">Color</span></span>.green) } } }</code> </pre> <br>  Observe que o <code>View</code> √© uma estrutura com alguns par√¢metros.  Para criar a estrutura <code>View</code> , precisamos definir o <code>body</code> par√¢metro calculado, que retorna <code>some View</code> .  Falaremos sobre isso mais tarde.  O conte√∫do do <code>body: some View { ‚Ä¶ }</code> fechamento do <code>body: some View { ‚Ä¶ }</code> √© a descri√ß√£o do que ser√° exibido na tela.  Na verdade, √© tudo o que √© necess√°rio para nossa estrutura atender aos requisitos do protocolo View.  Sugiro focar principalmente no <code>body</code> . <br><br><h3>  E assim, prateleiras </h3><br>  No total, contei tr√™s tipos de elementos a partir dos quais o corpo do View √© constru√≠do: <br><br><ul><li>  <b>Outra vista</b> <br>  I.e.  Cada Visualiza√ß√£o cont√©m uma ou mais outras.  Esses, por sua vez, tamb√©m podem conter tanto a <code>View</code> predefinida do sistema como <code>Text()</code> quanto as personalizadas e complexas, criadas pelo desenvolvedor.  Acontece um tipo de boneca com um n√≠vel ilimitado de aninhamento. </li><li>  <b>Modificadores</b> <br>  Com a ajuda de modificadores, toda m√°gica acontece.  Gra√ßas a eles, informamos de forma breve e clara ao SwiftUI que tipo de vis√£o queremos ver.  Como funciona, ainda vamos descobrir, mas o principal √© que os modificadores adicionam a pe√ßa necess√°ria ao conte√∫do de uma determinada <code>View</code> . </li><li>  <b>Contentores</b> <br>  Os primeiros cont√™ineres com os quais o padr√£o "Ol√°, mundo" come√ßa s√£o o <code>HStack</code> e o <code>VStack</code> .  Um pouco mais tarde, <code>Group</code> , <code>Section</code> e outros aparecem.  De fato, os cont√™ineres s√£o a mesma visualiza√ß√£o, mas eles t√™m um recurso.  Voc√™ transmite a eles algum conte√∫do que deseja exibir.  O recurso completo do cont√™iner √© que ele deve, de alguma forma, agrupar e exibir os elementos desse conte√∫do.  Nesse sentido, os cont√™ineres s√£o semelhantes aos modificadores, com a √∫nica diferen√ßa de que os modificadores pretendem alterar uma Visualiza√ß√£o pronta e os cont√™ineres organizam essa Visualiza√ß√£o (elementos de conte√∫do ou blocos de sintaxe declarativos) em uma determinada ordem, por exemplo, vertical ou horizontalmente ( <code>VStack{...}</code> <code>HStack{...}</code> ).  Tamb√©m existem cont√™ineres espec√≠ficos, como <code>ForEach</code> ou <code>GeometryReader</code> , falaremos sobre eles um pouco mais tarde. <br><br>  Em geral, considero os cont√™ineres como qualquer Visualiza√ß√£o, para a qual o Conte√∫do pode ser passado como par√¢metro. </li></ul><br>  E isso √© tudo.  Todos os elementos do SwiftUI de ra√ßa pura podem ser atribu√≠dos a um desses tipos.  Sim, isso n√£o √© suficiente para preencher a sua visualiza√ß√£o com funcionalidade, mas √© tudo o que voc√™ precisa para mostrar sua funcionalidade na tela. <br><br><h3>  .modifiers () - como eles s√£o organizados? </h3><br>  Vamos come√ßar com o mais simples.  Um modificador √© realmente uma coisa muito simples.  Ele apenas pega alguma <code>View</code> , aplica algumas altera√ß√µes nela <s>(ou faz?)</s> , E devolve.  I.e.  O modificador √© uma fun√ß√£o da pr√≥pria <code>View</code> , que retorna a <code>self</code> , tendo realizado anteriormente algumas modifica√ß√µes. <br><br>  Abaixo est√° um exemplo de c√≥digo com o qual declaro meu pr√≥prio modificador.  Mais precisamente, sobrecarrego o <code>frame(width:height:)</code> modificador existente <code>frame(width:height:)</code> , com o qual voc√™ pode corrigir as dimens√µes espec√≠ficas de uma Visualiza√ß√£o espec√≠fica.  Na caixa, voc√™ precisa especificar a largura e a altura para isso, e eu precisava passar um objeto <code>CGSize</code> para ele com um argumento, que √© uma descri√ß√£o apenas do comprimento e largura.  Por que eu preciso disso, vou contar um pouco mais tarde. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FrameFromSize</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModifier</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> size: <span class="hljs-type"><span class="hljs-type">CGSize</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">body</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(content: Content)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { content .frame(width: size.width, height: size.height) } }</code> </pre> <br>  Com esse c√≥digo, criamos uma estrutura que est√° em conformidade com o protocolo <code>ViewModifier</code> .  Esse protocolo exige que a fun√ß√£o <code>body()</code> seja implementada nessa estrutura, cuja entrada ser√° um pouco de <code>Content</code> e a sa√≠da ter√° <code>some View</code> : o mesmo tipo que o par√¢metro <code>body</code> da nossa <code>View</code> (falaremos sobre alguma view abaixo) .  Que tipo de <code>Content</code> esse? <br><br><h4>  Content + ViewBuilder = Visualizar </h4><br>  Na documenta√ß√£o interna sobre ele, √© o que diz: <br><blockquote>  `content` √© um proxy para a visualiza√ß√£o que ter√° o modificador representado por` Self` aplicado a ela. </blockquote>  Este √© um tipo de proxy, que √© uma pr√©-fabricada View √† qual os modificadores podem ser aplicados.  Um tipo de produto semi-acabado.  Na verdade, o <code>Content</code> √© um fechamento de estilo declarativo que descreve a estrutura de <code>View</code> .  Assim, se chamamos esse modificador de alguma Vis√£o, tudo o que ele faz √© obter um fechamento do <code>body</code> e pass√°-lo para a fun√ß√£o do nosso <code>body</code> , na qual adicionamos nossos cinco centavos a esse fechamento. <br><br>  Mais uma vez, o <code>View</code> √© principalmente uma estrutura que armazena todos os par√¢metros necess√°rios para gerar uma imagem na tela.  Incluindo instru√ß√µes de montagem, das quais o <code>Content</code> .  Assim, um fechamento em um estilo declarativo ( <code>Content</code> ) processado usando o <code>ViewBuilder</code> retorna uma View. <br><br>  Vamos voltar ao nosso modificador.  Em princ√≠pio, a declara√ß√£o da estrutura <code>FrameFromSize</code> j√° <code>FrameFromSize</code> suficiente para come√ßar a aplic√°-la.  Dentro do <code>body</code> podemos escrever assim: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size))</code> </pre><br>  <code>modifier</code> √© um m√©todo de protocolo de exibi√ß√£o que extrai o conte√∫do da <code>View</code> modificada, passa-o para a fun√ß√£o do corpo da estrutura do modificador e passa o resultado para o processamento do <code>ViewBuilder</code> ou para o pr√≥ximo modificador, se houver uma cadeia de modifica√ß√µes. <br><br>  Mas voc√™ pode torn√°-lo ainda mais conciso, declarando seu pr√≥prio modificador como uma fun√ß√£o, expandindo os recursos do protocolo View. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size: CGSize)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size)) } }</code> </pre> <br>  Nesse caso, sobrecarreguei o modificador existente <code>.frame(width: height:)</code> outra variante dos par√¢metros de <code>.frame(width: height:)</code> .  Agora, podemos usar a op√ß√£o de chamar o modificador de <code>frame(size:)</code> para qualquer <code>View</code> .  Como se viu, nada complicado. <br><br><div class="spoiler">  <b class="spoiler_title">Um pouco sobre erros</b> <div class="spoiler_text">  A prop√≥sito, eu pensei que n√£o era necess√°rio expandir todo o protocolo, seria suficiente expandir especificamente o <code>RoundedRectangle</code> no meu caso, e deveria ter funcionado, como me pareceu - mas parece que o Xcode n√£o esperava tal imprud√™ncia e caiu com um erro inintelig√≠vel ‚Äú <code>Abort trap: 6</code> "e uma proposta para enviar um despejo aos desenvolvedores.  De um modo geral, no SwiftUI, as descri√ß√µes de erros, at√© o momento, muitas vezes n√£o revelam completamente a causa desse erro. <br></div></div><br>  Da mesma maneira, voc√™ pode criar quaisquer modificadores personalizados e us√°-los da mesma maneira que o SwiftUI embutido: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).frame(size)</code> </pre><br>  Convenientemente, concisa, claramente. <br><br>  Imagino uma cadeia de modifica√ß√µes como contas amarradas em um fio - nossa Vis√£o.  Essa analogia tamb√©m √© verdadeira no sentido de que a ordem na qual as modifica√ß√µes s√£o chamadas √© importante. <br><br><img src="https://habrastorage.org/webt/tw/1p/ak/tw1paklgxp9d5acpcmwvjywxjce.png"><br><br><div class="spoiler">  <b class="spoiler_title">Quase tudo no SwiftUI √© View</b> <div class="spoiler_text">  A prop√≥sito, uma observa√ß√£o interessante.  Como par√¢metro de entrada, o plano de fundo n√£o aceita cores, mas Visualiza√ß√£o.  I.e.  A classe Color n√£o √© apenas uma descri√ß√£o da cor, √© uma Visualiza√ß√£o completa, na qual modificadores e muito mais podem ser aplicados.  E como pano de fundo, consequentemente, voc√™ pode passar para outra visualiza√ß√£o. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Modificadores - apenas para modifica√ß√µes</b> <div class="spoiler_text">  Talvez valha a pena notar mais um ponto.  Modificadores que n√£o alteram o conte√∫do de origem s√£o simplesmente ignorados pelo SwiftUI e n√£o s√£o chamados.  I.e.  Voc√™ n√£o poder√° disparar com base no modificador que causa alguns eventos, mas n√£o executa nenhuma a√ß√£o com o conte√∫do.  A Apple persistentemente nos leva a abandonar algumas a√ß√µes em tempo de execu√ß√£o ao renderizar a interface e confiar no estilo declarativo. <br></div></div><br><h2>  Visualiza√ß√£o est√°tica </h2><br>  Anteriormente, falamos sobre o que o <code>body</code> consiste, o corpo da <code>View</code> ou suas instru√ß√µes de montagem.  Vamos voltar ao pr√≥prio modo de <code>View</code> .  Antes de tudo, √© uma estrutura na qual alguns par√¢metros podem ser declarados, e <code>body</code> √© apenas um deles.  Como j√° dissemos, descobrindo o que <code>Content</code> , <code>body</code> √© uma instru√ß√£o sobre como montar a Visualiza√ß√£o desejada, que √© um fechamento em estilo declarativo.  Mas o que deve retornar nosso fechamento? <br><br><h3>  alguma vis√£o - conveni√™ncia </h3><br><img align="right" src="https://habrastorage.org/webt/j9/zh/zz/j9zhzza2ma_4if9rhtzqjkqvdhi.jpeg"><br><br>  E chegamos a uma pergunta tranq√ºila que, durante muito tempo, eu n√£o conseguia entender, embora isso n√£o me impedisse de escrever c√≥digo de trabalho.  O que √© isso?  A documenta√ß√£o diz que esta descri√ß√£o √© um "tipo de resultado opaco" - mas isso n√£o faz muito sentido. <br><br>  A palavra-chave <code>some</code> √© uma vers√£o "gen√©rica" ‚Äã‚Äãde uma descri√ß√£o de um tipo retornado por um fechamento que n√£o depende de nada al√©m do pr√≥prio c√≥digo.  I.e.  O resultado do acesso √† propriedade calculada do corpo da nossa View deve ser alguma estrutura que satisfa√ßa o protocolo View.  Pode haver muitos deles - Texto, Imagem ou talvez alguma estrutura que voc√™ declarou.  O chip inteiro da palavra-chave some √© declarar "gen√©rico" que est√° em conformidade com o protocolo View.  Ele √© estaticamente determinado pelo c√≥digo implementado no corpo da sua Visualiza√ß√£o, e o Xcode √© capaz de analisar esse c√≥digo e calcular a assinatura espec√≠fica do valor de retorno <s>(bom, quase sempre)</s> .  E algumas s√£o apenas uma tentativa de n√£o sobrecarregar o desenvolvedor com <a href="https://habr.com/ru/post/482834/">cerim√¥nias</a> desnecess√°rias.  √â suficiente para o desenvolvedor dizer: "haver√° algum tipo de visualiza√ß√£o" e qual - resolva voc√™ mesmo.  A chave aqui √© que o tipo concreto √© determinado n√£o pelos par√¢metros de entrada, como no tipo gen√©rico usual, mas diretamente pelo c√≥digo.  Portanto, acima, gen√©rico eu citei. <br><br>  O Xcode deve ser capaz de identificar um tipo espec√≠fico sem saber exatamente quais valores voc√™ passa para essa estrutura.  √â importante entender: ap√≥s a compila√ß√£o, a express√£o Some View √© substitu√≠da pelo tipo espec√≠fico de sua <code>View</code> .  Esse tipo √© bastante determin√≠stico e pode ser bastante complexo, por exemplo, assim: <code>Group&lt;TupleView&lt;(Text, ForEach&lt;[SomeClass], SomeClass.ID, Text&gt;)&gt;&gt;</code> . <br><br>  O c√≥digo de amostra pode ser restaurado deste tipo: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Group</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(‚Ä¶) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(‚Ä¶){(value: <span class="hljs-type"><span class="hljs-type">SomeClass</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(‚Ä¶) } }</code> </pre> <br>  <code>ForEach</code> , como pode ser visto na assinatura de tipo, n√£o √© um loop de tempo de execu√ß√£o.  Esta √© apenas uma <code>View</code> que √© constru√≠da com base em uma matriz de objetos <code>SomeClass</code> .  como identificador de um <code>subView</code> espec√≠fico associado ao elemento de cole√ß√£o, o ID do elemento √© indicado e, para cada elemento, um <code>subView</code> tipo <code>Text</code> √© <code>subView</code> .  <code>Text</code> e <code>ForEach</code> combinados no <code>TupleView</code> , e tudo isso √© colocado em <code>Group</code> .  Falaremos mais sobre o <code>ForEach</code> mais detalhes. <br><br>  Imagine quanto seria a escrita se f√¥ssemos for√ßados a descrever uma assinatura exata como o <code>body</code> do par√¢metro?  Para evitar isso, a palavra-chave <code>some</code> foi criada. <br><br><div class="spoiler">  <b class="spoiler_title">Sum√°rio</b> <div class="spoiler_text">  <code>some</code> s√£o gen√©ricos - vice-versa.  Obtemos o gen√©rico cl√°ssico de fora da fun√ß√£o e, j√° sabendo o tipo espec√≠fico do tipo gen√©rico, o Xcode define como nossa fun√ß√£o funciona.  <code>some-</code> n√£o depende dos par√¢metros de entrada, mas apenas do pr√≥prio c√≥digo.  Isso √© simplesmente uma abrevia√ß√£o, que permite n√£o definir um tipo espec√≠fico, mas indicar apenas a fam√≠lia do valor retornado pela fun√ß√£o (protocolo). <br></div></div><br><h3>  alguma vis√£o - e consequ√™ncias </h3><br>  A abordagem para calcular o tipo est√°tico de uma express√£o dentro do corpo gera, na minha opini√£o, dois pontos importantes: <br><br><ul><li>  Quando compilado, o Xcode analisa o conte√∫do do corpo para calcular o tipo de retorno espec√≠fico.  Em corpos complexos, isso pode levar algum tempo.  Em alguns corpos particularmente complexos, ele pode n√£o ser capaz de lidar com o tempo s√£o, e o dir√° diretamente. <br><img src="https://habrastorage.org/webt/-b/cf/nv/-bcfnvtylozajmnzcgjcto_8ms0.png"><br>  Em geral, o View precisa ser mantido o mais simples poss√≠vel.  Estruturas complexas s√£o melhor colocadas em modo de exibi√ß√£o separado.  Assim, cadeias inteiras de tipos reais s√£o substitu√≠das por um tipo - seu CustomView, que permite ao compilador n√£o enlouquecer com toda essa bagun√ßa. <br>  A prop√≥sito, √© realmente muito conveniente depurar um pequeno peda√ßo de uma visualiza√ß√£o grande, bem aqui, em tempo real, recebendo e observando o resultado no Canvas. </li><li>  N√£o podemos controlar diretamente o fluxo.  Se o If - else, o SwiftUI ainda puder process√°-lo, criando uma "Schr√∂dinger View" do tipo &lt;_ConditionalContent &lt;Text, TextField &gt;&gt;, o operador da condi√ß√£o de trinar poder√° ser usado apenas para selecionar um valor de par√¢metro espec√≠fico, mas n√£o um tipo, ou mesmo para selecionar uma sequ√™ncia de modificadores. <br><img src="https://habrastorage.org/webt/cp/18/7s/cp187s4fsvn9v3kvwobduyk5rie.png"><br>  Mas vale a pena restaurar a mesma ordem de modificadores, e esse registro deixa de ser um problema. </li></ul><br><h2>  Exceto corpo </h2><br>  No entanto, pode haver outros par√¢metros na estrutura com os quais voc√™ pode trabalhar.  Como par√¢metros, podemos declarar o seguinte. <br><br><h3>  Par√¢metros externos </h3><br>  Estes s√£o par√¢metros de estrutura simples que devemos passar de fora durante a inicializa√ß√£o para que o View os processe de alguma forma: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> textValue: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(textValue) } }</code> </pre> <br>  Neste exemplo, o <code>textValue</code> para a estrutura <code>TextView</code> √© um par√¢metro que deve ser preenchido externamente porque n√£o possui um valor padr√£o.  Dado que as estruturas suportam a gera√ß√£o autom√°tica de inicializadores, podemos usar esta Visualiza√ß√£o simplesmente: <br><br><pre> <code class="swift hljs"> <span class="hljs-type"><span class="hljs-type">TextView</span></span>(textValue: <span class="hljs-string"><span class="hljs-string">"some text"</span></span>)</code> </pre><br>  Do lado de fora, voc√™ tamb√©m pode transferir fechamentos que precisam ser executados quando um evento ocorre.  Por exemplo, <code>Button(lable:action:)</code> faz exatamente isso: executa o fechamento da a√ß√£o passada quando um bot√£o √© clicado. <br><br><h3>  estado - par√¢metros </h3><br>  O SwiftUI est√° usando ativamente o novo recurso do Swift 5.1 - <a href="https://habr.com/ru/company/funcorp/blog/485008/">Property Wrapper</a> . <br><br>  Antes de tudo, s√£o vari√°veis ‚Äã‚Äãde estado - par√¢metros armazenados de nossa estrutura, cuja mudan√ßa deve ser refletida na tela.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eles s√£o embrulhados em inv√≥lucros especiais </font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- para tipos primitivos e </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- para classes. Uma classe deve satisfazer o protocolo </font></font><code>ObservableObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- isso significa que essa classe deve poder notificar os assinantes (View, que usam esse valor com um wrapper </font></font><code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) sobre a altera√ß√£o em suas propriedades. Para fazer isso, basta agrupar as propriedades necess√°rias </font></font><code>@Published</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ n√£o estiver procurando maneiras f√°ceis ou precisar de funcionalidade adicional, em vez deste wrapper, poder√° usar </font></font><code>ObservableObjectPublisher</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e enviar notifica√ß√µes manualmente usando os eventos </font></font><code>willSet()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desses par√¢metros, conforme descrito, por exemplo, </font></font><a href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-send-state-updates-manually-using-objectwillchange" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lembre-se, eu disse isso</font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso √© apenas uma propriedade comput√°vel? No come√ßo, n√£o entendi imediatamente tudo sobre as vari√°veis ‚Äã‚Äãde estado e tentei declarar algumas vari√°veis ‚Äã‚Äãde estado dentro </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sem inv√≥lucros. O problema acabou sendo que </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, como eu disse, √© uma instru√ß√£o sem estado. A vis√£o foi gerada de acordo com esta instru√ß√£o, e todo o contexto declarado dentro do corpo foi para aterro. Em seguida, apenas os par√¢metros de estrutura armazenados s√£o ativados. Ao alterar os par√¢metros de estado, todos os nossos s√£o </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atualizados. A instru√ß√£o √© novamente tomada, os valores atuais de todos os par√¢metros da estrutura s√£o substitu√≠dos, a imagem na tela √© coletada e a instru√ß√£o √© lan√ßada novamente at√© a pr√≥xima vez. Vari√°veis ‚Äã‚Äãdeclaradas dentro </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- junto com ele. Para desenvolvedores experientes, isso pode ser √≥bvio, mas a princ√≠pio fiquei atormentado com isso, sem entender a ess√™ncia do processo.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E mais uma observa√ß√£o</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ n√£o pode usar </font></font><code>didSet</code> <code>willSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eventos de par√¢metros de estrutura agrupados em nenhum inv√≥lucro. </font><font style="vertical-align: inherit;">O compilador permite que voc√™ escreva esse c√≥digo, mas ele simplesmente n√£o √© executado. </font><font style="vertical-align: inherit;">Provavelmente porque o wrapper √© algum tipo de c√≥digo de modelo que √© executado quando esses eventos ocorrem.</font></font><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo de </font></font><a href="https://habr.com/ru/users/state/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">estado</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cl√°ssico </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span> { <span class="hljs-type"><span class="hljs-type">Button</span></span>(action: {<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tapCount += <span class="hljs-number"><span class="hljs-number">1</span></span>}, label: { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Tap count \(tapCount)"</span></span>) }) } } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Par√¢metros de liga√ß√£o </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bem, para refletir algumas altera√ß√µes no servi√ßo de exibi√ß√£o </font></font><code>@State</code> <code>@ObservedObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Mas como essas mudan√ßas s√£o passadas </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? Para fazer isso, o SwiftUI possui outro PropertyWrapper - </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Vamos complicar nosso exemplo com um bot√£o para contar cliques. Suponha que tenhamos um pai </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, que reflete, entre outras coisas, um contador de cliques e um filho </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com um bot√£o. Na visualiza√ß√£o principal, o contador √© declarado como </font></font><code>@State</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- √© compreens√≠vel, mas queremos que o contador na tela seja atualizado. Mas na subsidi√°ria, o contador deve ser declarado como </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este √© outro Property Wrapper, com o qual declaramos par√¢metros de estrutura que n√£o apenas mudam, mas tamb√©m retornam ao pai </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este √© um tipo de </font></font><code>inout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">marcador para</font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Quando um valor √© alterado em uma exibi√ß√£o filho, essa altera√ß√£o √© convertida de volta para a exibi√ß√£o pai, de onde veio originalmente. </font><font style="vertical-align: inherit;">E, assim como </font></font><code>inout</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, precisamos marcar os valores transmitidos com um s√≠mbolo especial </font></font><code>$,</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para mostrar que estamos esperando o valor transmitido mudar dentro de outra visualiza√ß√£o. </font><font style="vertical-align: inherit;">Reaja em a√ß√£o.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: $tapCount) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"you tap \(tapCount) times"</span></span>) } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso tamb√©m se reflete nos tipos de dados. </font></font><code>@Binding var tapCount: Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por exemplo, n√£o √© mais apenas um </font></font><code>Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipo, √©</font></font><br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso √© √∫til para saber, por exemplo, se voc√™ deseja escrever seu pr√≥prio inicializador </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ @<span class="hljs-type"><span class="hljs-type">Binding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: <span class="hljs-type"><span class="hljs-type">Binding</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Int</span></span>&gt;){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>._tapCount = <span class="hljs-built_in"><span class="hljs-built_in">count</span></span> <span class="hljs-comment"><span class="hljs-comment">//    -    } var body: some View{ Button(action: {self.tapCount += 1}, label: { Text("Tap me") }) } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observe que dentro de </font></font><code>init</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ </font></font><code>@PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deve usar um sublinhado </font><font style="vertical-align: inherit;">para se referir aos par√¢metros agrupados em alguns par√¢metros </font></font><code>self._</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- isso funciona nos inicializadores, quando </font></font><code>self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ainda est√° em processo de cria√ß√£o. </font><font style="vertical-align: inherit;">Mais precisamente, com a ajuda, </font></font><code>self._</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nos referimos ao par√¢metro junto com seu inv√≥lucro. </font><font style="vertical-align: inherit;">A aplica√ß√£o direta ao valor dentro do wrapper √© feita sem sublinhado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por sua vez, se voc√™ tiver uma vari√°vel agrupada em algum tipo de entrada </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, obteremos um tipo de wrapper, nesse caso</font></font><br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ </font></font><code>Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pode </font><font style="vertical-align: inherit;">acessar diretamente o valor do tipo </font></font><code>.wrappedValue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E como sempre, um rake pessoal</font></font></b> <div class="spoiler_text"> ,  Binding     .   View          View.      View      ,    @Binding-.  ,   View     <a href="https://habr.com/ru/users/state/" class="user_link">State</a>  @Binding ‚Äî ,     State-   Binding.       -,  ,    . <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> EnvironmentObject </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em resumo, os </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par√¢metros s√£o como </font></font><code>Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, apenas imediatamente para todos </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">na hierarquia, sem a necessidade de pass√°-los explicitamente.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ContentView</span></span>().environmentObject(session)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geralmente, o estado atual do aplicativo, ou parte dele, que muitos View precisam de uma vez, √© transmitido. Por exemplo, dados sobre um usu√°rio, sess√£o ou algo semelhante, faz sentido coloc√°-lo no EnvironmentObject uma vez, na Visualiza√ß√£o raiz. Em cada Visualiza√ß√£o, onde s√£o necess√°rias, elas podem ser extra√≠das do ambiente, declarando uma vari√°vel com um wrapper @EnvironmentObject, por exemplo, como este</font></font><br><br><pre> <code class="swift hljs"> @<span class="hljs-type"><span class="hljs-type">EnvironmentObject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session: <span class="hljs-type"><span class="hljs-type">Session</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O identificador de um valor espec√≠fico √© o pr√≥prio tipo. Se voc√™ inserir </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v√°rios valores do mesmo tipo, o pedido ser√° importante. Para chegar ao terceiro, por exemplo, valor, voc√™ precisa obter todos os valores em ordem, mesmo que n√£o precise deles. Portanto, </font></font><code>EnvironmentObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© adequado para refletir o estado do aplicativo, mas n√£o √© adequado para passar v√°rios valores do mesmo tipo entre eles </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Eles ter√£o que ser transmitidos manualmente, atrav√©s </font></font><code>Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@ Environment √© quase o mesmo. No sentido, este √© um estado do ambiente, ou seja, OS √â conveniente passar por esse inv√≥lucro, por exemplo, a posi√ß√£o da tela (vertical ou horizontal), um tema claro ou escuro, etc. Al√©m disso, atrav√©s deste wrapper, voc√™ pode acessar o banco de dados ao usar o CoreData:</font></font><br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">Environment</span></span>(\.managedObjectContext) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> moc: <span class="hljs-type"><span class="hljs-type">NSManagedObjectContext</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A prop√≥sito, muitas coisas interessantes foram feitas para trabalhar com o CoreData no SwiftUI. </font><font style="vertical-align: inherit;">Mas sobre isso, talvez, da pr√≥xima vez. </font><font style="vertical-align: inherit;">Portanto, o artigo cresceu al√©m de todas as expectativas.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Custom @PropertyWrapper </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em geral, </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esse √© um atalho para setter e getter, o mesmo para todos os par√¢metros agrupados no mesmo </font></font><code>property wrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Voc√™ pode restaurar completamente essa funcionalidade removendo a declara√ß√£o do wrapper e gravando os par√¢metros getter {} setter {}, mas ser√° necess√°rio fazer isso sempre que </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">duplicar o c√≥digo. </font><font style="vertical-align: inherit;">Por exemplo, √© </font></font><code>PropertyWrapper</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muito conveniente ocultar o trabalho </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs">@propertyWrapper <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDefault</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> initialValue: <span class="hljs-type"><span class="hljs-type">T</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wrappedValue: <span class="hljs-type"><span class="hljs-type">T</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(newValue, forKey: key) } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.object(forKey: key) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">T</span></span> ?? initialValue } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Assim, podemos armazenar tipos de dados primitivos no armazenamento </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A Apple alega uma velocidade de acesso muito boa a esse armazenamento, portanto, provavelmente n√£o √© necess√°rio armazenar em cache esses dados na mem√≥ria na forma de par√¢metros ou vari√°veis ‚Äã‚Äãde estrutura, a menos que sejam usados ‚Äã‚Äãem loops maci√ßos e tarefas que exigem velocidade. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dado isso, voc√™ pode criar um tipo de stub (neste caso, uma enumera√ß√£o) no qual declarar vari√°veis ‚Äã‚Äãest√°ticas para acessar valores espec√≠ficos armazenados </font></font><code>UserDefaults</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, usando o wrapper rec√©m-criado:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserPreferences</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"isCheatModeEnabled"</span></span>, initialValue: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isCheatModeEnabled: <span class="hljs-type"><span class="hljs-type">Bool</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"highestScore"</span></span>, initialValue: <span class="hljs-number"><span class="hljs-number">10000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> highestScore: <span class="hljs-type"><span class="hljs-type">Int</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"nickname"</span></span>, initialValue: <span class="hljs-string"><span class="hljs-string">"cloudstrife97"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nickname: <span class="hljs-type"><span class="hljs-type">String</span></span> }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O resultado pode ser usado de forma muito sucinta, com foco na exibi√ß√£o l√≥gica e visual, e todo o trabalho √© realizado sob o cap√¥. </font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.isCheatModeEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.highestScore = <span class="hljs-number"><span class="hljs-number">25000</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.nickname = <span class="hljs-string"><span class="hljs-string">"squallleonhart‚Äù</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um exemplo foi originalmente descrito </font></font><a href="https://medium.com/swlh/understanding-property-wrappers-in-swift-by-examples-604206022b5c" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contentores </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bem, a √∫ltima coisa a discutir da minha lista s√£o os cont√™ineres. J√° tocamos parcialmente nisso quando falamos sobre </font></font><code>body</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. De fato, os cont√™ineres s√£o comuns </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. A √∫nica diferen√ßa √© que, como um dos par√¢metros dessa estrutura, transmitimos o conte√∫do. Lembre-se de que o conte√∫do √© um fechamento que cont√©m uma ou mais express√µes declarativas. Esse fechamento, se processado com a ajuda de </font></font><code>@ViewBuilder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, retornar√° para n√≥s uma nova Visualiza√ß√£o, combinando de uma certa maneira toda a Visualiza√ß√£o listada no fechamento (blocos de conte√∫do). Ao mesmo tempo, para cont√™ineres diferentes, os mecanismos de processamento dos pr√≥prios blocos s√£o diferentes. </font></font><code>VStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">organiza elementos de conte√∫do verticalmente, </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">horizontalmente e assim por diante. √â como um modificador, mas desta vez n√£o √© apenas uma Visualiza√ß√£o espec√≠fica que est√° sendo modificada, mas o todo</font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">transferido para o cont√™iner e um novo √© gerado </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Al√©m disso, este novo </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tem um novo tipo. </font><font style="vertical-align: inherit;">Por exemplo, para </font></font><code>HStack{Text(‚Ä¶)}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este tipo ser√° </font></font><code>TupleView&lt;Text, Image&gt;</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, n√£o esque√ßa que qualquer um </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, incluindo cont√™ineres, √© uma estrutura que pode ter outros par√¢metros al√©m do corpo. </font><font style="vertical-align: inherit;">Por exemplo, durante muito tempo n√£o consegui descobrir como remover um pequeno espa√ßo entre o </font></font><code>Text(¬´a¬ª)</code> <code>Text(¬´b¬ª)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interior </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Passei muito tempo com </font></font><code>offset()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font><code>position()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, calculando as coordenadas do deslocamento com base no comprimento das linhas, at√© encontrar acidentalmente a sintaxe completa da declara√ß√£o </font></font><code>HStack</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HStack (espa√ßamento:, alinhamento:, contexto :). </font></font><br></blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simplesmente, os dois primeiros par√¢metros s√£o opcionais e s√£o ignorados na maioria dos exemplos. </font><font style="vertical-align: inherit;">Erro do novato - para n√£o ver a sintaxe completa.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Foreach </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Separadamente, vale a pena falar </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Este √© um cont√™iner que serve para refletir na tela todos os elementos da cole√ß√£o transferida. Primeiro de tudo, voc√™ precisa entender que isso n√£o √© o mesmo que pedir alguma coleta </font></font><code>forEach(‚Ä¶)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Como dissemos acima, ele </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">retorna um √∫nico </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, criado com base nos elementos da cole√ß√£o transferida.</font></font> I.e.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© apenas outro cont√™iner para o qual a cole√ß√£o √© transferida e instru√ß√µes sobre como refletir os elementos da cole√ß√£o na tela. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al√©m disso, ele </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deve ser colocado dentro de algum outro cont√™iner que j√° determine como agrupar essa entidade m√∫ltipla - colocando-o na vertical, na horizontal ou, por exemplo, em uma lista ( </font></font><code>List</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). </font></font><br><br> <code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aceita tr√™s par√¢metros: cole√ß√£o ( </font></font><code>data: RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), endere√ßo do identificador do elemento de cole√ß√£o ( </font></font><code>id: Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) e conte√∫do ( </font></font><code>content: ()-&gt;Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). O terceiro que j√° discutimos: como qualquer outro cont√™iner, ele </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aceita </font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ou seja, curto-circuito. Por√©m, diferentemente dos cont√™ineres comuns, onde </font></font><code>content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o cont√©m par√¢metros, ele </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passa para o fechamento um elemento de cole√ß√£o que pode ser usado para descrever o conte√∫do.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A cole√ß√£o </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o </font><font style="vertical-align: inherit;">√© </font><font style="vertical-align: inherit;">adequada </font><font style="vertical-align: inherit;">para </font><font style="vertical-align: inherit;">nenhum, mas apenas </font></font><code>RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para v√°rias cole√ß√µes desordenadas, basta chamar o m√©todo </font></font><code>sorted(by:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com o qual voc√™ pode obter </font></font><code>RandomAccesCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br> <code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Este √© um conjunto </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gerado para cada elemento da cole√ß√£o com base no conte√∫do transmitido. √â importante observar que o SwiftUI precisa saber qual deles </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° associado a qual elemento da cole√ß√£o. Para isso, cada um </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deve ter um identificador. O segundo par√¢metro √© necess√°rio precisamente para isso. Se os elementos da cole√ß√£o forem </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipos, como seq√º√™ncias de caracteres, voc√™ poder√° escrever simplesmente </font></font><code>id: \.self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso significa que a pr√≥pria string ser√° o identificador. Se os elementos da cole√ß√£o s√£o classes e satisfazem o protocolo</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ent√£o o segundo argumento pode ser perdido. Nesse caso, o ID de cada item da cole√ß√£o se tornar√° um identificador </font></font><code>subView</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se o seu objeto tiver algum tipo de acess√≥rio que forne√ßa exclusividade e que atenda ao protocolo </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, voc√™ poder√° especific√°-lo assim:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(values, id: \.value){item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ‚Ä¶}</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No meu exemplo, </font></font><code>values</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© uma matriz de objetos de classe </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para os quais props s√£o declarados </font></font><code>value: Int</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. De qualquer forma, voc√™ deve garantir que cada identificador </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">associado a um elemento da sua cole√ß√£o seja </font><font style="vertical-align: inherit;">exclusivo </font><font style="vertical-align: inherit;">. Por exemplo, no seu contexto, alguns par√¢metros do seu objeto podem mudar. </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ele deve corresponder 1 a 1 ao objeto de dados (elemento de cole√ß√£o), caso contr√°rio, n√£o ficar√° claro para onde retornar a altera√ß√£o do </font></font><code>@Binding</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">par√¢metro </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A prop√≥sito, a organiza√ß√£o de um rastreamento de elementos da cole√ß√£o que n√£o atendem ao Identific√°vel tamb√©m pode ser feita usando √≠ndices.</font></font> Por exemplo, assim: <br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(keys.<span class="hljs-built_in"><span class="hljs-built_in">indices</span></span>){ind <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(key: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keys[ind]) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesse caso, a travessia ser√° constru√≠da n√£o pelos pr√≥prios elementos, mas por seus √≠ndices. Para cole√ß√µes pequenas, isso √© perfeitamente aceit√°vel. Em cole√ß√µes com um grande n√∫mero de elementos, isso provavelmente pode afetar o desempenho, especialmente quando os elementos da cole√ß√£o n√£o s√£o tipos de refer√™ncia, mas, por exemplo, cadeias volumosas ou dados JSON. Em geral, use com cuidado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um ponto importante sobre o </font></font><code>Content</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que √© referido </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ele √© muito mal-humorado e se recusa a trabalhar normalmente com fechamentos, com mais de um bloco (ou seja, ele percebe o conte√∫do de uma linha normalmente, mas ele j√° n√£o tem 2 ou mais). Isso √© resolvido de maneira bem simples, √© bastante simples </font></font><code>Groupe{}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">incluir </font><font style="vertical-align: inherit;">todo o conte√∫do </font><font style="vertical-align: inherit;">- esse hack deixa de ser um problema.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Basta declarar que as vari√°veis ‚Äã‚Äãinternas no escopo deste fechamento n√£o funcionar√£o. </font><font style="vertical-align: inherit;">Quaisquer fechamentos passados ‚Äã‚Äãpara o ViewBuilder n√£o podem conter declara√ß√µes de vari√°veis. </font><font style="vertical-align: inherit;">Lembre-se, no come√ßo do artigo, dei um exemplo de cria√ß√£o de um modificador </font></font><code>.frame(size:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? </font><font style="vertical-align: inherit;">Eu criei por esse motivo. </font><font style="vertical-align: inherit;">Calculei os tamanhos dos bot√µes com base no n√∫mero desses bot√µes em uma linha e no n√∫mero de linhas (n√£o fiquei satisfeito com o alongamento autom√°tico, bot√µes diferentes devem ter tamanhos diferentes). </font><font style="vertical-align: inherit;">A fun√ß√£o retornou CGSize e v√°rios n√≠veis de estruturas aninhadas foram rastreados para dentro. </font><font style="vertical-align: inherit;">Se fosse poss√≠vel executar a fun√ß√£o uma vez, escreva o resultado como um tamanho vari√°vel e chame</font></font><code>.ftame(width: size.width, height: size.height)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Eu faria isso." </font><font style="vertical-align: inherit;">Mas n√£o existe essa possibilidade, e eu n√£o queria executar a fun√ß√£o duas vezes - porque contornei essa limita√ß√£o e coloquei parte do c√≥digo no modificador.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Visualiza√ß√£o de cont√™iner personalizado </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bem, como aconteceu, darei um exemplo de cria√ß√£o de um cont√™iner personalizado. </font><font style="vertical-align: inherit;">Muitas vezes, o relacionamento de v√°rios objetos do tipo "1: N" pode ser convenientemente representado na forma de um dicion√°rio. </font><font style="vertical-align: inherit;">N√£o √© </font></font><code>dict: [KeyObject: [SomeObject]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dif√≠cil </font><font style="vertical-align: inherit;">executar a consulta e converter seu resultado em um dicion√°rio de tipos </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nesse caso, os objetos da classe atuam como a chave do dicion√°rio </font></font><code>KeyObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(para isso, ele deve suportar o protocolo </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), e os valores s√£o matrizes de objetos de outra classe - </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> value: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">UUID</span></span> = <span class="hljs-type"><span class="hljs-type">UUID</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(value: <span class="hljs-type"><span class="hljs-type">Int</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.value = value } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(name: <span class="hljs-type"><span class="hljs-type">String</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.name = name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &lt; (lhs: KeyObject, rhs: KeyObject) -&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bool</span></span></span><span class="hljs-function"> </span></span>{ lhs.name &lt; rhs.name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> == </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lhs: KeyObject, rhs: KeyObject)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs.name == rhs.name } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { hasher.combine(name) } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se seu aplicativo planeja algum tipo de an√°lise com agrupamento, faz sentido criar um cont√™iner separado para exibir esses dicion√°rios, para n√£o duplicar todo o c√≥digo em cada exibi√ß√£o. E, considerando que os agrupamentos podem ser alterados pelo usu√°rio, teremos que usar gen√©ricos. N√£o compliquei adicionando design visual, deixando apenas a estrutura do nosso cont√™iner:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TreeView</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">V</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">&gt;: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data: [<span class="hljs-type"><span class="hljs-type">K</span></span>: [<span class="hljs-type"><span class="hljs-type">V</span></span>]] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> keyContent: (<span class="hljs-type"><span class="hljs-type">K</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">KeyContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> valueContent: (<span class="hljs-type"><span class="hljs-type">V</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">ValueContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span>{ <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .leading, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(data.keys.sorted(), id: \.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>){(key: <span class="hljs-type"><span class="hljs-type">K</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .trailing, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keyContent(key) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.data[key]!){(value: <span class="hljs-type"><span class="hljs-type">V</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.valueContent(value) } } } } } }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como voc√™ pode ver, o cont√™iner aceita um dicion√°rio do tipo </font></font><code>[K: [V]]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(onde </font></font><code>K</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o tipo de objetos-chave do dicion√°rio, </font></font><code>V</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√© o tipo de matriz que os valores do dicion√°rio consistem) e dois contextos: um para exibir as chaves do dicion√°rio e o outro para exibir os valores. Infelizmente, n√£o encontrei exemplos de cria√ß√£o </font></font><code>ViewBuilder-</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de cont√™ineres personalizados (provavelmente essa op√ß√£o simplesmente n√£o existe), portanto, teremos que usar o padr√£o </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Como ele aceita apenas na entrada </font></font><code>RandomAccessCollection</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, e </font></font><code>dict.keys</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√£o √©, teremos que usar a classifica√ß√£o. Da√≠ o requisito de suportar o protocolo </font></font><code>Comparable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font><code>KeyObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu usei dois </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cont√™ineres </font><font style="vertical-align: inherit;">aninhados </font><font style="vertical-align: inherit;">. No primeiro caso, usei o hash do item de cole√ß√£o (</font></font><code>\.self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) como o identificador de cada aninhado </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Eu poderia fazer isso porque as chaves de dicion√°rio devem suportar o protocolo de qualquer maneira </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. No segundo caso, adicionei </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">suporte de protocolo </font><font style="vertical-align: inherit;">√† classe</font></font><code>Identifiable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Isso me permitiu n√£o especificar uma chave de comunica√ß√£o - o id √© usado automaticamente. </font><font style="vertical-align: inherit;">No meu caso, o id n√£o √© armazenado em nenhum lugar. </font><font style="vertical-align: inherit;">Cada vez que um objeto √© criado - seja cria√ß√£o no c√≥digo ou recupera√ß√£o usando uma consulta ao banco de dados - um novo ID √© gerado. </font><font style="vertical-align: inherit;">Para uma interface, isso n√£o √© essencial. </font><font style="vertical-align: inherit;">N√£o mudar√° ao longo da vida √∫til do objeto, ou seja, </font><font style="vertical-align: inherit;">sess√£o, e isso √© suficiente para exibi-lo sob esse ID. </font><font style="vertical-align: inherit;">E se da pr√≥xima vez que voc√™ abrir o aplicativo, ele ter√° um ID diferente - nada de ruim acontecer√°. </font><font style="vertical-align: inherit;">Se o seu objeto j√° possui campos-chave, voc√™ pode simplesmente tornar a id um par√¢metro calculado e usar o suporte a este protocolo e uma sintaxe abreviada de qualquer maneira </font></font><code>ForEach</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um exemplo de como usar nosso cont√™iner:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dict: [<span class="hljs-type"><span class="hljs-type">KeyObject</span></span>: [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>]] = [ <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"1st group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">3</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"2nd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">6</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"3rd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">9</span></span>)] ] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">TreeView</span></span>(data: dict, keyContent: {keyObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"the key is: \(keyObject.name)"</span></span>) } ){valueObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"value: \(valueObject.value)"</span></span>) } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e o resultado na tela no Canvas: </font></font><br><br><img src="https://habrastorage.org/webt/48/jl/e_/48jle_vonedzfqtotu7uclu2u1e.png"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para ser continuado </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por enquanto √© tudo. </font><font style="vertical-align: inherit;">Eu tamb√©m queria cobrir todos os ancinhos em que pisei, tentando us√°-lo </font></font><code>CoreData</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">em conjunto com o SwiftUI, mas, francamente, n√£o esperava que apenas o b√°sico do SwiftUI levasse tanto tempo e que o artigo fosse t√£o volumoso. </font><font style="vertical-align: inherit;">Ent√£o, como eles dizem, para continuar. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ tem algo a acrescentar ou corrigir - seja bem-vindo aos coment√°rios. </font><font style="vertical-align: inherit;">Vou tentar refletir coment√°rios significativos no artigo.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt485548/">https://habr.com/ru/post/pt485548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt485536/index.html">√â poss√≠vel invadir um avi√£o - 2</a></li>
<li><a href="../pt485538/index.html">Zabbix: monitore tudo em uma fileira (no exemplo do Redis)</a></li>
<li><a href="../pt485542/index.html">Adicionar gr√°ficos ao No√ß√£o</a></li>
<li><a href="../pt485544/index.html">O xadrez como um sistema din√¢mico</a></li>
<li><a href="../pt485546/index.html">O apocalipse est√° chegando</a></li>
<li><a href="../pt485550/index.html">Existe vida al√©m do anel vi√°rio de Moscou? Como buscamos e preparamos desenvolvedores</a></li>
<li><a href="../pt485552/index.html">Outra maneira de controlar o tempo e criar o n√∫mero para Java</a></li>
<li><a href="../pt485554/index.html">Objetivos e principais resultados (OKR) - Nossa experi√™ncia de implementa√ß√£o em fases</a></li>
<li><a href="../pt485556/index.html">Foram necess√°rios 12 anos para criar uma se√ß√£o do mapa cerebral de Drosophila, os esfor√ßos de 250 pessoas e US $ 40 milh√µes</a></li>
<li><a href="../pt485558/index.html">Sem mosquitos! Vis√£o geral do mosquito "fito-muni√ß√£o"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>