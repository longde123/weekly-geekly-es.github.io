<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöæ üë∂üèª üè° Usando o DbTool para propagar bancos de dados em aplicativos .NET (Core) üëÑ üë©üèæ‚Äçüç≥ üß•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apresentamos √† sua aten√ß√£o o DbTool - um utilit√°rio de linha de comando para exportar dados do banco de dados para v√°rios formatos e a biblioteca de c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Usando o DbTool para propagar bancos de dados em aplicativos .NET (Core)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466541/"><p>  Apresentamos √† sua aten√ß√£o o DbTool - um utilit√°rio de linha de comando para exportar dados do banco de dados para v√°rios formatos e a biblioteca de c√≥digo-fonte aberto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Korzh.DbUtils</a> , cujo uso pode simplificar bastante a "sementeira" inicial do banco de dados no aplicativo .NET (Core). </p><br><p>  Com este kit de ferramentas, voc√™ pode: </p><br><ol><li>  Salve os dados do banco de dados local em arquivos de um determinado formato de texto (XML, JSON), f√°ceis de conectar ao projeto. </li><li>  Use os arquivos salvos para preencher o banco de dados do pr√≥prio aplicativo em sua primeira inicializa√ß√£o. </li></ol><br><p>  Abaixo, mostrarei por que tudo isso √© necess√°rio, como instalar e configurar essas ferramentas e descrever um cen√°rio detalhado para seu uso. </p><br><p><img src="https://habrastorage.org/webt/3r/sk/3i/3rsk3iitaroanayip5fskvr3fxc.png" alt="imagem"></p><a name="habracut"></a><br><h2 id="zachem-my-sdelali-dbtool">  Por que fizemos o DbTool </h2><br><p>  A tarefa inicial foi criar um mecanismo conveniente de preenchimento de banco de dados em aplicativos .NET (Core).  Devido √†s especificidades do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso tipo de atividade</a> (desenvolvimento de componentes), geralmente precisamos criar pequenos aplicativos de amostra que demonstrem um ou outro recurso do nosso produto.  Esses projetos de demonstra√ß√£o devem funcionar com um determinado banco de dados de teste e, portanto, √© aconselh√°vel criar e preencher automaticamente esse banco de dados no primeiro in√≠cio do aplicativo. </p><br><p> Se o projeto usar o Entity Framework (Core) (e isso acontece com mais freq√º√™ncia), n√£o haver√° problemas com a cria√ß√£o do banco de dados.  Voc√™ simplesmente chama <code>dbContext.Database.EnsureCreated</code> ou <code>dbContext.Database.Migrate</code> (se for importante manter as migra√ß√µes). </p><br><p>  Mas com o preenchimento do banco de dados, tudo fica um pouco mais complicado.  A primeira coisa que vem √† mente √© simplesmente criar um script SQL com v√°rios INSERTs, coloc√°-lo no projeto e execut√°-lo na primeira inicializa√ß√£o.  Isso funciona (e fizemos por muito tempo), mas h√° alguns problemas com essa abordagem.  Primeiro de tudo, um problema de sintaxe SQL para um DBMS espec√≠fico.  Muitas vezes, o DBMS original √© diferente daquele que √© realmente usado pelo usu√°rio e nosso script SQL pode n√£o funcionar. </p><br><p>  O segundo problema poss√≠vel √© a migra√ß√£o do pr√≥prio banco de dados.  Periodicamente, √© necess√°rio alterar ligeiramente a estrutura do banco de dados (adicionar um novo campo, excluir ou renomear o antigo, adicionar um novo relacionamento entre tabelas, etc.).  Um script SQL criado sob a estrutura antiga geralmente se torna irrelevante nesse caso e sua execu√ß√£o causa um erro.  O carregamento de dados de algum formato de terceiros fica sem problemas.  Os campos novos / alterados s√£o simplesmente ignorados.  Concorde que, para fins de demonstra√ß√£o, √© melhor que o programa seja iniciado, embora sem dados em algum campo novo, do que n√£o seja iniciado. </p><br><p>  Como resultado, chegamos √† seguinte solu√ß√£o: </p><br><ol><li>  Os dados da "c√≥pia principal" do nosso banco de dados demo s√£o gravados em um arquivo em um determinado formato "independente" (atualmente √© XML ou JSON).  Os arquivos resultantes (ou um arquivo morto) s√£o entregues com o projeto.  Esta tarefa, de fato, lida com o DbTool. </li><li>  Um pequeno peda√ßo de c√≥digo √© inserido em nosso programa, que, usando as classes e fun√ß√µes da biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Korzh.DbUtils,</a> preenche o banco de dados com dados do (s) arquivo (s) obtido (s) na primeira etapa. <br>  Al√©m do cen√°rio acima, o DbTool pode ser usado simplesmente para exportar dados para outros formatos e transferir dados entre bancos de dados.  Assim, por exemplo, voc√™ pode fazer upload de dados do seu banco de dados para o SQL Server e carreg√°-los em um banco de dados semelhante no MySQL. </li></ol><br><h2 id="installyaciya">  Instala√ß√£o </h2><br><p>  O DbTool √© implementado como uma ferramenta global do .NET Core, ou seja,  pode ser facilmente instalado em qualquer sistema em que exista um <a href="">.NET SDK vers√£o 2.1</a> ou superior. </p><br><p>  Para instalar o utilit√°rio, basta abrir o console (Terminal / Prompt de Comando) e executar o seguinte comando: </p><br><pre> <code class="plaintext hljs">dotnet tool install -g Korzh.DbTool</code> </pre> <br><p>  Para verificar ap√≥s a instala√ß√£o, digite <code>dbtool</code> no console e voc√™ ver√° ajuda com uma lista de comandos dispon√≠veis. </p><br><p><img src="https://habrastorage.org/webt/tn/x_/zs/tnx_zs0qltekxzf9jkkfiwf4jai.png"></p><br><h2 id="dobavlyaem-soedinenie-s-bazoy">  Adicionar conex√£o ao banco de dados </h2><br><p>  Para come√ßar a trabalhar com o DbTool, voc√™ precisa adicionar uma conex√£o com o banco de dados: </p><br><pre> <code class="plaintext hljs">dbtool add {YourConnectionId} {DbType} {YourConnectionString}</code> </pre> <br><p>  Aqui: </p><br><ul><li>  {YourConnectionId} √© um identificador que voc√™ deseja atribuir a esta conex√£o, para que voc√™ possa acess√°-la mais tarde quando executar outros comandos. </li><li>  DbType √© o tipo do seu DBMS.  No momento da reda√ß√£o deste artigo, o DbTool (vers√£o 1.1.7) suportava os bancos de dados SQL Server (mssql) e MySQL (mysql). </li><li>  O √∫ltimo par√¢metro neste comando √© a cadeia de conex√£o.  O mesmo que voc√™ j√° usa no seu projeto .NET (Core). </li></ul><br><p>  Um exemplo: </p><br><p><img src="https://habrastorage.org/webt/o8/az/ml/o8azmls5cz7im6noyyuuixtsa3w.png"></p><br><p>  Depois disso, voc√™ pode verificar todas as suas conex√µes digitando: </p><br><pre> <code class="plaintext hljs">dbtool connections list</code> </pre> <br><h2 id="eksport-dannyh">  Exporta√ß√£o de dados </h2><br><p>  Agora que adicionamos a conex√£o, podemos exportar nosso banco de dados usando o comando export: </p><br><pre> <code class="plaintext hljs">dbtool export {ConnectionId} [--format=xml|json] [--output={path-to-folder}] [--zip={file-name}]</code> </pre> <br><p>  Qualquer op√ß√£o mencionada acima pode ser omitida.  Se voc√™ n√£o especificar o <code>format</code> JSON ser√° usado.  Se voc√™ omitir a op√ß√£o de <code>output</code> , o resultado ser√° colocado em um diret√≥rio no formato <code>ConnectionId_yyyy-MM-dd</code> em um formato descompactado. </p><br><p>  Por exemplo, o seguinte comando: </p><br><pre> <code class="plaintext hljs">dbtool export MyDb01 --zip=MyDbData.zip</code> </pre> <br><p>  criar√° um arquivo ZIP com o nome MyDbData.zip no diret√≥rio atual e o preencher√° com arquivos de dados no formato JSON (um arquivo para cada tabela de banco de dados). </p><br><p><img src="https://habrastorage.org/webt/nc/eb/nz/ncebnz_khmkvpxjuhxwarhzdfva.png"></p><br><h2 id="import-dannyh">  Importa√ß√£o de dados </h2><br><p>  Voc√™ pode importar os dados criados na etapa anterior novamente para o seu banco de dados.  Ou para qualquer outra base com a mesma estrutura. </p><br><blockquote>  Importante: O DbTool n√£o cria tabelas durante a opera√ß√£o de importa√ß√£o.  Assim, o banco de dados no qual os dados s√£o importados j√° deve existir e ter a mesma (ou pelo menos semelhante) estrutura que a original. </blockquote><p>  O pr√≥prio comando import √© o seguinte: </p><br><pre> <code class="plaintext hljs">dbtool import {ConnectionId} [--input=path-to-file-or-folder] [--format=xml|json]</code> </pre> <br><p>  A op√ß√£o <code>--input</code> informa ao utilit√°rio onde procurar dados importados.  Se um caminho de pasta for especificado, o DbTool importar√° arquivos .xml ou .json nessa pasta.  Se este for um arquivo ZIP, o utilit√°rio descompactar√° primeiro esse arquivo e, a partir da√≠, remover√° os arquivos de dados necess√°rios. </p><br><p>  Como no caso anterior, <code>--format</code> pode ser omitido, pois o DbTool pode reconhecer o formato por extens√µes de arquivo. </p><br><p>  Um exemplo: </p><br><pre> <code class="plaintext hljs">dbtool import MyDb01 --input=MyDbData.zip</code> </pre> <br><h2 id="bibilioteka-korzhdbutils">  Biblioteca Korzh.DbUtils </h2><br><p>  O pr√≥prio utilit√°rio DbTool √© constru√≠do com base na biblioteca de c√≥digo aberto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Korzh.DbUtils</a> , que inclui v√°rios pacotes com a implementa√ß√£o de algumas opera√ß√µes b√°sicas do banco de dados. </p><br><h3 id="korzhdbutils">  Korzh.DbUtils </h3><br><p>  Define abstra√ß√µes b√°sicas e interfaces como IDatasetExporter, IDatasetImporter, IDataPacker, IDbBridge </p><br><h3 id="korzhdbutilsimport">  Korzh.DbUtils.Import </h3><br><p>  Cont√©m implementa√ß√µes de interfaces IDatasetImporter para os formatos XML e JSON.  Al√©m disso, este pacote inclui a classe DbInitializer, que voc√™ pode usar para preencher dados em seus projetos (mais sobre isso abaixo). </p><br><h3 id="korzhdbutilsexport">  Korzh.DbUtils.Export </h3><br><p>  Cont√©m implementa√ß√µes de IDatasetExporter para XML e JSON. </p><br><h3 id="korzhdbutilssqlserver">  Korzh.DbUtils.SqlServer </h3><br><p>  Cont√©m a implementa√ß√£o das interfaces das opera√ß√µes b√°sicas do banco de dados (IDbBridge, IDbReader, IDbSeeder) para MS SQL Server. </p><br><h3 id="korzhdbutilsmysql">  Korzh.DbUtils.MySQL </h3><br><p>  Cont√©m implementa√ß√µes de interfaces de banco de dados para MySQL. </p><br><p>  Aqui voc√™ pode encontrar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">refer√™ncia completa na API da biblioteca Korzh.DbUtils</a> . </p><br><h2 id="ispolzovanie-korzhdbutils-dlya-zapolnenie-bd-dannymi-pri-starte-prilozheniya">  Usando o Korzh.DbUtils para preencher o banco de dados com dados na inicializa√ß√£o do aplicativo </h2><br><p>  Agora, na verdade, consideraremos como usar o DbTool e o Korzh.DbUtils para implementar o script b√°sico para preencher (semear) o banco de dados no primeiro lan√ßamento do aplicativo. </p><br><p>  Suponha que voc√™ tenha uma ‚Äúc√≥pia principal‚Äù de algum banco de dados que voc√™ precisa ‚Äúcopiar‚Äù no computador do usu√°rio quando iniciar o aplicativo. </p><br><h3 id="shag-1-eksportiruem-master-kopiyu-v-json">  Etapa 1: Exportar a c√≥pia principal para JSON </h3><br><p>  Basta instalar o DbTool, conforme descrito acima, adicionar uma conex√£o ao banco de dados e executar o comando export para salvar todos os dados desse banco de dados em uma pasta separada: </p><br><pre> <code class="plaintext hljs">dotnet tool install -g Korzh.DbTool dbtool connections add MyMasterDb mssql "{ConnectionString}" dbtool export MyMasterDb</code> </pre> <br><h3 id="shag-2-dobavlyaem-fayly-s-dannymi-v-nash-proekt">  Etapa 2: adicionar arquivos de dados ao nosso projeto </h3><br><p>  Ap√≥s a etapa anterior, temos uma nova pasta, no formato MyMasterDb-aaaa-MM-dd, com v√°rios arquivos JSON (um para cada tabela).  Basta copiar o conte√∫do desta pasta para o App_Data \ DbSeed do nosso projeto .NET (Core).  Observe que, para projetos no .NET Framework, voc√™ tamb√©m precisar√° adicionar manualmente esses arquivos ao projeto. </p><br><h3 id="shag-3-kod-inicializacii-bd">  Etapa 3: c√≥digo de inicializa√ß√£o do banco de dados </h3><br><p>  Embora o processo em si (at√© alguns detalhes) seja aplic√°vel a qualquer tipo de projeto no .NET Core ou .NET Framework (vers√£o 4.6.1 ou superior), para simplificar a descri√ß√£o, suponha que estamos falando de um projeto ASP.NET Core que funcione com Banco de dados do SQL Server e que esse banco de dados seja criado automaticamente usando o Entity Framework Core. </p><br><p>  Assim, para resolver o problema de preencher o banco de dados com dados no primeiro in√≠cio, precisamos: </p><br><h4 id="1-ustanovit-v-proekt-nuget-pakety-biblioteki-korzhdbutils">  1. Instale os pacotes da biblioteca Korzh.DbUtils no projeto NuGet </h4><br><p>  Nesse caso, precisamos de 2 deles: </p><br><ul><li>  Korzh.DbUtils.Import </li><li>  Korzh.DbUtils.SqlServer </li></ul><br><h4 id="2-dobavit-kod-inicializacii">  2. Adicione c√≥digo de inicializa√ß√£o </h4><br><p>  Aqui est√° um exemplo desse c√≥digo que devemos adicionar no final do m√©todo Startup.Configure: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IApplicationBuilder app, IHostingEnvironment env</span></span></span><span class="hljs-function">)</span></span> { . . . . app.UseMvc(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scope = app.ApplicationServices.GetRequiredService&lt;IServiceScopeFactory&gt;().CreateScope()) <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> context = scope.ServiceProvider.GetService&lt;AppDbContext&gt;()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (context.Database.EnsureCreated()) { <span class="hljs-comment"><span class="hljs-comment">//run only if database was not created previously Korzh.DbUtils.DbInitializer.Create(options =&gt; { options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")); //set the connection string for our database options.UseFileFolderPacker(System.IO.Path.Combine(env.ContentRootPath, "App_Data", "SeedData")); //set the folder where to get the seeding data }) .Seed(); } } }</span></span></code> </pre><br><p>  Para deixar tudo muito bonito, ou se voc√™ precisar executar alguma inicializa√ß√£o adicional na primeira inicializa√ß√£o (por exemplo, adicionar v√°rias contas de usu√°rio e / ou fun√ß√µes de usu√°rio), √© melhor projetar todo esse c√≥digo como um m√©todo de extens√£o separado (vamos cham√°-lo de <code>EnsureDbInitialized</code> ) para a interface <code>IApplicationBuilder</code> . </p><br><p>  Um exemplo dessa implementa√ß√£o pode ser encontrado no GitHub no <a href="">projeto de demonstra√ß√£o da biblioteca EasyQuery</a> . </p><br><p>  Nesse caso, voc√™ s√≥ precisa adicionar uma chamada no final do seu m√©todo Startup.Configure: </p><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configure</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> IApplicationBuilder,   IHostingEnvironment</span></span></span><span class="hljs-function">)</span></span> { . . . . app.UseMvc (); <span class="hljs-comment"><span class="hljs-comment">//Init database (only if necessary) app.EnsureDbInitialized(Configuration, env); }</span></span></code> </pre> <br><h2 id="plany-na-buduschee">  Planos futuros </h2><br><p>  Embora a biblioteca e o utilit√°rio tenham sido gravados em um cen√°rio muito espec√≠fico, tentamos fazer tudo o mais flex√≠vel e extens√≠vel poss√≠vel, portanto, ativar a funcionalidade adicional n√£o seria um problema. </p><br><p>  Das poss√≠veis melhorias, vemos o seguinte: </p><br><ul><li><p>  Suporte para outros bancos de dados (PostgreSQL, Oracle, SQLite, MariaDB) </p><br></li><li><p>  Novos formatos para os quais voc√™ pode exportar dados (CSV, Excel, HTML) </p><br></li><li><p>  A opera√ß√£o de copiar diretamente dados do banco de dados para o banco de dados (agora voc√™ pode implement√°-lo atrav√©s de algumas chamadas consecutivas aos comandos de exporta√ß√£o / importa√ß√£o) </p><br></li><li><p>  Opera√ß√µes completas de backup / restaura√ß√£o com preserva√ß√£o total da estrutura do banco de dados e sua cria√ß√£o do zero durante a recupera√ß√£o. </p><br></li></ul><br><p>  Teremos o maior prazer em ouvir sugest√µes ou coment√°rios e agradecemos as novas estrelas do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio de bibliotecas</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> :) </p><br><p>  Obrigado pela aten√ß√£o! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466541/">https://habr.com/ru/post/pt466541/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466529/index.html">Tipos de compila√ß√£o na JVM: expondo a sess√£o de magia negra</a></li>
<li><a href="../pt466533/index.html">Pastilda: resultados</a></li>
<li><a href="../pt466535/index.html">Repensando deepClone</a></li>
<li><a href="../pt466537/index.html">Utilizando M√≥dulos JavaScript em Produ√ß√£o: Situa√ß√£o Atual. Parte 1</a></li>
<li><a href="../pt466539/index.html">Utilizando M√≥dulos JavaScript em Produ√ß√£o: Situa√ß√£o Atual. Parte 2</a></li>
<li><a href="../pt466543/index.html">Os cr√©ditos do Habr Weekly # 17 / Sberbank ser√£o aprovados pela AI - assustador, publicidade em produtos de c√≥digo aberto - duvidoso</a></li>
<li><a href="../pt466547/index.html">Feliz Dia do Programador</a></li>
<li><a href="../pt466549/index.html">Princ√≠pios gerais de opera√ß√£o da QEMU-KVM</a></li>
<li><a href="../pt466551/index.html">Marionetista com ES6 em um n√≥ e navegador, ou por que o Zora √© a melhor estrutura de teste em seu nicho</a></li>
<li><a href="../pt466553/index.html">6 li√ß√µes aprendidas ao encontrar uma solu√ß√£o para um enorme problema em gitlab.com. Parte 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>