<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ· ğŸš‰ â™‚ï¸ OpenSceneGraphï¼šåœºæ™¯å‡ ä½•åŸºç¡€ ğŸ‘  ğŸ‘² ğŸ‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 
 OpenGLæ˜¯OpenSceneGraphçš„åç«¯ï¼Œå®ƒä½¿ç”¨å‡ ä½•å›¾å…ƒï¼ˆä¾‹å¦‚ç‚¹ï¼Œçº¿ï¼Œä¸‰è§’å½¢å’Œå¤šè¾¹å½¢é¢ï¼‰æ„é€ ä¸‰ç»´ä¸–ç•Œä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ 

 è¿™äº›å›¾å…ƒç”±æœ‰å…³å…¶é¡¶ç‚¹çš„æ•°æ®å®šä¹‰ï¼Œè¿™äº›æ•°æ®åŒ…æ‹¬é¡¶ç‚¹çš„åæ ‡ï¼Œæ³•çº¿åˆ†é‡ï¼Œé¢œè‰²æ•°æ®å’Œçº¹ç†åæ ‡ã€‚ æ­¤æ•°æ®å­˜å‚¨åœ¨ç‰¹æ®Šæ•°ç»„ä¸­ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ä¸ºæè¿°åŸºå…ƒçš„å¯¹è±¡æŒ‡å®šä¸€ä¸ªé¡¶ç‚¹ç´¢å¼•...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenSceneGraphï¼šåœºæ™¯å‡ ä½•åŸºç¡€</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430212/"><img src="https://habrastorage.org/webt/py/ks/3w/pyks3wlvjf_zfef-sqocutbnimk.jpeg" alt="å›¾ç‰‡"><br><br><h1> å¼•è¨€ </h1><br>  OpenGLæ˜¯OpenSceneGraphçš„åç«¯ï¼Œå®ƒä½¿ç”¨å‡ ä½•å›¾å…ƒï¼ˆä¾‹å¦‚ç‚¹ï¼Œçº¿ï¼Œä¸‰è§’å½¢å’Œå¤šè¾¹å½¢é¢ï¼‰æ„é€ ä¸‰ç»´ä¸–ç•Œä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ <br><br> è¿™äº›å›¾å…ƒç”±æœ‰å…³å…¶é¡¶ç‚¹çš„æ•°æ®å®šä¹‰ï¼Œè¿™äº›æ•°æ®åŒ…æ‹¬é¡¶ç‚¹çš„åæ ‡ï¼Œæ³•çº¿åˆ†é‡ï¼Œé¢œè‰²æ•°æ®å’Œçº¹ç†åæ ‡ã€‚ æ­¤æ•°æ®å­˜å‚¨åœ¨ç‰¹æ®Šæ•°ç»„ä¸­ã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ä¸ºæè¿°åŸºå…ƒçš„å¯¹è±¡æŒ‡å®šä¸€ä¸ªé¡¶ç‚¹ç´¢å¼•åˆ—è¡¨æ¥å½¢æˆåŸºå…ƒã€‚ æ­¤æ–¹æ³•ç§°ä¸ºé¡¶ç‚¹æ•°ç»„æ–¹æ³•ï¼Œå®ƒæ¶ˆé™¤äº†å†…å­˜ä¸­å¤šä½™é¡¶ç‚¹çš„å­˜å‚¨ï¼Œå¹¶å…·æœ‰è‰¯å¥½çš„æ€§èƒ½ã€‚ <br><br> æ­¤å¤–ï¼Œå½“åœ¨è§†é¢‘å­˜å‚¨å™¨ä¸­å‡†å¤‡å¥½çš„åŸè¯­å¯ä»¥è¢«é‡ç”¨æ—¶ï¼ŒOpenGLå¯ä»¥ä½¿ç”¨æ‰€è°“çš„<i>æ˜¾ç¤ºåˆ—è¡¨</i>æœºåˆ¶ï¼Œä»è€Œæ˜¾ç€åŠ å¿«äº†é™æ€å¯¹è±¡çš„æ˜¾ç¤ºé€Ÿåº¦ã€‚ <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼ŒOSGä½¿ç”¨é¡¶ç‚¹æ•°ç»„æ–¹æ³•å’Œæ˜¾ç¤ºåˆ—è¡¨æ–¹æ³•æ¥æ¸²æŸ“å‡ ä½•å›¾å½¢ã€‚ ä½†æ˜¯ï¼Œå¯ä»¥æ ¹æ®å‘ˆç°å‡ ä½•æ•°æ®çš„æ–¹å¼æ›´æ”¹æ¸²æŸ“ç­–ç•¥ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»åœ¨OSGä¸­ä½¿ç”¨å‡ ä½•çš„åŸºæœ¬æŠ€æœ¯ã€‚ <br><a name="habracut"></a><br><h1>  1.ç±»Geodeå’ŒDrawable </h1><br>  osg :: Geodeç±»æ˜¯ä¸€ä¸ªç»ˆç«¯ï¼Œå³åœºæ™¯æ ‘çš„æ‰€è°“â€œå¶â€èŠ‚ç‚¹ã€‚ å®ƒä¸èƒ½å…·æœ‰å­èŠ‚ç‚¹ï¼Œä½†æ˜¯å®ƒåŒ…å«ç”¨äºæ¸²æŸ“å‡ ä½•å›¾å½¢çš„æ‰€æœ‰å¿…è¦ä¿¡æ¯ã€‚ å®ƒçš„åç§°Geodeæ˜¯å‡ ä½•èŠ‚ç‚¹çš„ç¼©å†™ã€‚ <br><br> å¼•æ“è¦å¤„ç†çš„å‡ ä½•æ•°æ®å­˜å‚¨åœ¨osg :: Drawableç±»çš„å¯¹è±¡é›†ä¸­ï¼Œè¯¥å¯¹è±¡é›†ç”±osg :: Geodeç±»ç®¡ç†ã€‚  osg :: Drawableç±»æ˜¯çº¯è™šæ‹Ÿç±»ã€‚ å®ƒç»§æ‰¿äº†è®¸å¤šå­ç±»ï¼Œå®ƒä»¬æ˜¯ä¸‰ç»´æ¨¡å‹ï¼ŒOpenGLç®¡é“å¤„ç†çš„å›¾åƒå’Œæ–‡æœ¬ã€‚  OSGå°†drawableç§°ä¸ºå¼•æ“å¯ä»¥ç»˜åˆ¶çš„æ‰€æœ‰å…ƒç´ ã€‚ <br><br>  osg :: Geodeç±»æä¾›äº†è®¸å¤šç”¨äºé™„ç€å’Œåˆ†ç¦»å¯ç»˜åˆ¶å¯¹è±¡çš„æ–¹æ³•ï¼š <br><br><ul><li> å…¬å…±æ–¹æ³•addDrawableï¼ˆï¼‰-å°†æŒ‡é’ˆä¼ é€’ç»™osg :: Geodeç±»å®ä¾‹ä¸­çš„drawableå…ƒç´ ã€‚ æ‰€æœ‰è¿™äº›å…ƒç´ å‡ç”±osg :: ref_ptr &lt;&gt;æ™ºèƒ½æŒ‡é’ˆæ§åˆ¶ã€‚ <br></li><li> å…¬å…±æ–¹æ³•removeDrawableï¼ˆï¼‰å’ŒremoveDrawablesï¼ˆï¼‰ä»osg :: Geodeä¸­åˆ é™¤å¯¹è±¡ï¼Œå¹¶å‡å°‘å…¶å¼•ç”¨è®¡æ•°ã€‚  removeDrawableï¼ˆï¼‰æ–¹æ³•å°†æŒ‡å‘æ„Ÿå…´è¶£å…ƒç´ çš„æŒ‡é’ˆä½œä¸ºå•ä¸ªå‚æ•°ï¼Œè€ŒremoveDrawablesï¼ˆï¼‰æ–¹æ³•é‡‡ç”¨ä¸¤ä¸ªå‚æ•°ï¼šåˆå§‹ç´¢å¼•å’Œè¦ä»osg :: Geodeå¯¹è±¡æ•°ç»„ä¸­åˆ é™¤çš„å…ƒç´ æ•°ã€‚ <br></li><li>  getDrawableï¼ˆï¼‰æ–¹æ³•è¿”å›æŒ‡å‘ä½œä¸ºå‚æ•°ä¼ é€’çš„ç´¢å¼•å¤„çš„å…ƒç´ çš„æŒ‡é’ˆã€‚ <br></li><li>  getNumDrawablesï¼ˆï¼‰æ–¹æ³•è¿”å›é™„åŠ åˆ°osg :: Geodeçš„å…ƒç´ æ€»æ•°ã€‚ ä¾‹å¦‚ï¼Œè¦ä»osg :: Geodeä¸­åˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç  <br></li></ul><br><pre><code class="cpp hljs">geode-&gt;removeDrawables(<span class="hljs-number"><span class="hljs-number">0</span></span>, geode-&gt;getNumDrawables());</code> </pre> <br><h1>  2.ç»˜åˆ¶ç®€å•çš„å½¢çŠ¶ </h1><br>  OSGæä¾›äº†osg :: ShapeDrawableç±»ï¼Œå®ƒæ˜¯osg :: Drawableç±»çš„åä»£ï¼Œæ—¨åœ¨åˆ›å»ºç®€å•çš„ä¸‰ç»´åŸºå…ƒã€‚ æ­¤ç±»åŒ…æ‹¬ä¸€ä¸ªosg :: Shapeå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å­˜å‚¨æœ‰å…³ç‰¹å®šå‡ ä½•å½¢çŠ¶å’Œå…¶ä»–å‚æ•°çš„ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨setShapeï¼ˆï¼‰æ–¹æ³•ç”ŸæˆåŸºå…ƒ <br><br><pre> <code class="cpp hljs">shapeDrawable-&gt;setShape(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Box(osg::Vec3(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>), <span class="hljs-number"><span class="hljs-number">10.0f</span></span>, <span class="hljs-number"><span class="hljs-number">10.0f</span></span>, <span class="hljs-number"><span class="hljs-number">5.0f</span></span>));</code> </pre><br> åˆ›å»ºä¸€ä¸ªçŸ©å½¢æ¡†ï¼Œè¯¥çŸ©å½¢æ¡†åœ¨ç‚¹ï¼ˆ1.0ï¼Œ0.0ï¼Œ0.0ï¼‰å¤„çš„å‡ ä½•ä¸­å¿ƒï¼Œå®½åº¦å’Œé«˜åº¦ä¸º10ï¼Œæ·±åº¦ä¸º5ä¸ªå•ä½ã€‚  osg :: Vec3ç±»åœ¨ä¸‰ç»´ç©ºé—´ä¸­å®šä¹‰çŸ¢é‡ï¼ˆæ­¤å¤–ï¼Œè¿˜æä¾›äº†æè¿°ç›¸åº”ç»´æ•°çš„osg :: Vec2å’Œosg :: Vec4ç±»ï¼‰ã€‚ <br><br> åœ¨OSGä¸­ï¼Œæœ€æµè¡Œçš„åŸè¯­ç”±osg :: Boxï¼Œosg :: Capsuleï¼Œosg :: Coneï¼Œosg :: Cylinderå’Œosg :: Sphereè¡¨ç¤ºã€‚ <br><br> è€ƒè™‘è¯¥æœºåˆ¶çš„åº”ç”¨ç¤ºä¾‹ã€‚ <br><br>  <strong>ä¸»æ–‡ä»¶</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg/ShapeDrawable&gt; #include &lt;osg/Geode&gt; #include &lt;osgViewer/Viewer&gt; #endif // MAIN_H</span></span></span></span></code> </pre><br>  <strong>main.cpp</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> int main(int argc, char *argv[]) { (void) argc; (void) argv; osg::ref_ptr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg::ShapeDrawable&gt; shape1 = new osg::ShapeDrawable; shape1-&gt;setShape(new osg::Box(osg::Vec3(-3.0f, 0.0f, 0.0f), 2.0f, 2.0f, 1.0f)); osg::ref_ptr&lt;osg::ShapeDrawable&gt; shape2 = new osg::ShapeDrawable; shape2-&gt;setShape(new osg::Cone(osg::Vec3(0.0f, 0.0f, 0.0f), 1.0f, 1.0f)); shape2-&gt;setColor(osg::Vec4(0.0f, 1.0f, 0.0f, 1.0f)); osg::ref_ptr&lt;osg::ShapeDrawable&gt; shape3 = new osg::ShapeDrawable; shape3-&gt;setShape(new osg::Sphere(osg::Vec3(3.0f, 0.0f, 0.0f), 1.0f)); shape3-&gt;setColor(osg::Vec4(0.0f, 0.0f, 1.0f, 1.0f)); osg::ref_ptr&lt;osg::Geode&gt; root = new osg::Geode; root-&gt;addDrawable(shape1.get()); root-&gt;addDrawable(shape2.get()); root-&gt;addDrawable(shape3.get()); osgViewer::Viewer viewer; viewer.setSceneData(root.get()); return viewer.run(); }</span></span></span></span></code> </pre><br> è¿™ä¸ªä¾‹å­å°¤å…¶ä¸éœ€è¦æ³¨é‡Šï¼šåœ¨ç¨‹åºä¸­åˆ›å»ºäº†ä¸‰ä¸ªç®€å•çš„å½¢çŠ¶ï¼Œç¼–è¯‘å’Œå¯åŠ¨åï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™æ ·çš„ç»“æœ <br><br><img src="https://habrastorage.org/webt/mu/kl/cq/muklcqrapar1quikfyshzkang-4.png"><br><br> ç¤ºä¾‹ä¸­æ˜¾ç¤ºçš„æœºåˆ¶éå¸¸ç®€å•æ˜äº†ï¼Œä½†è¿™å¹¶ä¸æ˜¯åˆ›å»ºå‡ ä½•ä½“çš„æœ€æœ‰æ•ˆæ–¹æ³•ï¼Œåªèƒ½ç”¨äºæµ‹è¯•ã€‚  osg :: Geometryç±»ç”¨äºåœ¨åŸºäºOSGçš„é«˜æ€§èƒ½åº”ç”¨ç¨‹åºä¸­åˆ›å»ºå‡ ä½•ã€‚ <br><br><h1>  3.å‡ ä½•æ•°æ®çš„å­˜å‚¨ï¼šosg ::æ•°ç»„å’Œosg ::å‡ ä½• </h1><br>  osg :: Arrayç±»æ˜¯ä¸€ä¸ªåŸºæœ¬çš„æŠ½è±¡ç±»ï¼Œä»è¯¥ç±»ç»§æ‰¿äº†å‡ ä¸ªåä»£ï¼Œè¿™äº›åä»£æ—¨åœ¨å­˜å‚¨ä¼ é€’ç»™OpenGLå‡½æ•°çš„æ•°æ®ã€‚ ä½¿ç”¨æ­¤ç±»ç±»ä¼¼äºä½¿ç”¨C ++æ ‡å‡†åº“ä¸­çš„std :: vectorã€‚ ä»¥ä¸‹ä»£ç è¯´æ˜äº†ä½¿ç”¨push_backï¼ˆï¼‰æ–¹æ³•å°†å‘é‡æ·»åŠ åˆ°é¡¶ç‚¹æ•°ç»„ <br><br><pre> <code class="cpp hljs">vertices-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>));</code> </pre><br>  OSGæ•°ç»„åœ¨å †ä¸Šåˆ†é…ï¼Œå¹¶ç”±æ™ºèƒ½æŒ‡é’ˆç®¡ç†ã€‚ ä½†æ˜¯ï¼Œè¿™ä¸é€‚ç”¨äºæ•°ç»„å…ƒç´ ï¼Œä¾‹å¦‚osg :: Vec3æˆ–osg :: Vec2ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥åœ¨å †æ ˆä¸Šåˆ›å»ºã€‚ <br><br>  osg :: Geometryç±»æ˜¯ä½¿ç”¨é¡¶ç‚¹æ•°ç»„çš„OpenGLå‡½æ•°çš„åŒ…è£…ã€‚ å®ƒæ˜¯ä»osg :: Drawableç±»æ´¾ç”Ÿçš„ï¼Œå¯ä»¥è½»æ¾åœ°æ·»åŠ åˆ°osg :: Geodeå¯¹è±¡åˆ—è¡¨ä¸­ã€‚ æ­¤ç±»å°†ä¸Šè¿°æ•°ç»„ä½œä¸ºè¾“å…¥ï¼Œå¹¶ä½¿ç”¨å®ƒä»¬ä½¿ç”¨OpenGLç”Ÿæˆå‡ ä½•ã€‚ <br><br><h1>  4.é¡¶ç‚¹åŠå…¶å±æ€§ </h1><br> é¡¶ç‚¹æ˜¯å‡ ä½•å›¾å…ƒçš„åŸå­å•ä½ã€‚ å®ƒå…·æœ‰è®¸å¤šæè¿°äºŒç»´æˆ–ä¸‰ç»´ç©ºé—´ä¸­çš„ç‚¹çš„å±æ€§ã€‚ å±æ€§åŒ…æ‹¬ï¼šä½ç½®ï¼Œé¢œè‰²ï¼Œæ³•çº¿å‘é‡ï¼Œçº¹ç†åæ ‡ï¼Œé›¾åæ ‡ç­‰ã€‚ é¡¶éƒ¨å¿…é¡»å§‹ç»ˆåœ¨ç©ºé—´ä¸­å…·æœ‰ä½ç½®ï¼Œå› ä¸ºå¯¹äºå…¶ä»–å±æ€§ï¼Œå¯ä»¥é€‰æ‹©å­˜åœ¨å®ƒä»¬ã€‚  OpenGLæ”¯æŒ16ç§åŸºæœ¬é¡¶ç‚¹å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°ç»„æ¥å­˜å‚¨å®ƒä»¬ã€‚  osg :: Geometryç±»æ”¯æŒæ‰€æœ‰å±æ€§æ•°ç»„ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨set * Arrayï¼ˆï¼‰å½¢å¼çš„æ–¹æ³•è¿›è¡Œè®¾ç½®ã€‚ <br><br>  <b>OpenSceneGraphä¸­çš„é¡¶ç‚¹å±æ€§</b> <br><table><tbody><tr><th> å±æ€§ </th><th> èµ„æ–™ç±»å‹ </th><th>  Osg ::å‡ ä½•æ–¹æ³• </th><th> ç­‰æ•ˆçš„OpenGLè°ƒç”¨ </th></tr><tr><td> ä½ç½® </td><td>  3å‘é‡ </td><td>  setVertexArrayï¼ˆï¼‰ </td><td>  glVertexPointerï¼ˆï¼‰ </td></tr><tr><td> æ­£å¸¸çš„ </td><td>  3å‘é‡ </td><td>  setNormalArrayï¼ˆï¼‰ </td><td>  glNormalPointerï¼ˆï¼‰ </td></tr><tr><td> è‰²æ³½ </td><td>  4å‘é‡ </td><td>  setColorArrayï¼ˆï¼‰ </td><td>  glColorPointerï¼ˆï¼‰ </td></tr><tr><td> äºŒæ¬¡è‰² </td><td>  4å‘é‡ </td><td>  setSecondaryColorArrayï¼ˆï¼‰ </td><td>  glSecondaryColorPointerEXTï¼ˆï¼‰ </td></tr><tr><td> é›¾åæ ‡ </td><td> é£˜æµ® </td><td>  setFogCoordArrayï¼ˆï¼‰ </td><td>  glFogCoordPointerEXTï¼ˆï¼‰ </td></tr><tr><td> çº¹ç†åæ ‡ </td><td>  2æˆ–3å‘é‡ </td><td>  setTexCoordArrayï¼ˆï¼‰ </td><td>  glTexCoordPointerï¼ˆï¼‰ </td></tr><tr><td> å…¶ä»–å±æ€§ </td><td> ç”¨æˆ·å®šä¹‰ </td><td>  setVertexArribArrayï¼ˆï¼‰ </td><td>  glVertexAttribPointerARBï¼ˆï¼‰ </td></tr></tbody></table><br> åŸåˆ™ä¸Šï¼Œå¿…é¡»ä¸ºæ¯ä¸ªé¡¶ç‚¹è®¾ç½®è‡ªå·±çš„å±æ€§ï¼Œè¿™å°†å¯¼è‡´å½¢æˆå¤šä¸ªå…·æœ‰ç›¸åŒå¤§å°çš„å±æ€§æ•°ç»„-å¦åˆ™ï¼Œæ•°ç»„å¤§å°çš„ä¸åŒ¹é…ä¼šå¯¼è‡´å¼•æ“çš„è¡Œä¸ºä¸ç¡®å®šã€‚  OSGæ”¯æŒå¤šç§é“¾æ¥é¡¶ç‚¹å±æ€§çš„æ–¹æ³•ï¼Œä¾‹å¦‚ <br><br><pre> <code class="cpp hljs">geom-&gt;setColorBinding(osg::Geometry::BIND_PER_VERTEX);</code> </pre><br> è¡¨ç¤ºæ¯ä¸ªé¡¶ç‚¹å’Œé¡¶ç‚¹çš„æ¯ç§é¢œè‰²éƒ½æ˜¯ä¸€å¯¹ä¸€å…³è”çš„ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨çœ‹è¿™æ ·çš„ä»£ç  <br><br><pre> <code class="cpp hljs">geom-&gt;setColorBinding(osg::Geometry::BIND_OVERALL);</code> </pre><br> ç„¶åä»–å°†ä¸€ç§é¢œè‰²åº”ç”¨äºæ•´ä¸ªå‡ ä½•ã€‚ åŒæ ·ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨setNormalBindingï¼ˆï¼‰ï¼ŒsetSecondaryColorBindingï¼ˆï¼‰ï¼ŒsetFogCoordBindingï¼ˆï¼‰å’ŒsetVertexAttribBindingï¼ˆï¼‰æ–¹æ³•æ¥é…ç½®å…¶ä»–å±æ€§ä¹‹é—´çš„å…³ç³»ã€‚ <br><br><h1>  5.å‡ ä½•å›¾å…ƒé›† </h1><br> å®šä¹‰é¡¶ç‚¹å±æ€§æ•°ç»„ä¹‹åçš„ä¸‹ä¸€æ­¥æ˜¯æè¿°å¦‚ä½•æ¸²æŸ“é¡¶ç‚¹æ•°æ®ã€‚ è™šæ‹Ÿosg :: PrimitiveSetç±»ç”¨äºæ§åˆ¶æ¸²æŸ“å™¨ä»ä¸€ç»„é¡¶ç‚¹ç”Ÿæˆçš„å‡ ä½•å›¾å…ƒã€‚  osg :: Geometryç±»æä¾›äº†å‡ ç§å¤„ç†å‡ ä½•å›¾å…ƒé›†çš„æ–¹æ³•ï¼š <br><br><ul><li>  addPrimitiveSetï¼ˆï¼‰-å°†æŒ‡é’ˆä¼ é€’ç»™osg :: Geometryå¯¹è±¡ä¸­çš„ä¸€ç»„å›¾å…ƒã€‚ <br></li><li>  removePrimitiveSetï¼ˆï¼‰-åˆ é™¤ä¸€ç»„åŸè¯­ã€‚ ä½œä¸ºå‚æ•°ï¼Œå®ƒä½¿ç”¨é›†åˆçš„åˆå§‹ç´¢å¼•å’Œè¦åˆ é™¤çš„é›†åˆæ•°ã€‚ <br></li><li>  getPrimitiveSetï¼ˆï¼‰-åœ¨ä½œä¸ºå‚æ•°ä¼ é€’çš„ç´¢å¼•å¤„è¿”å›ä¸€ç»„åŸå§‹å…ƒç´ ã€‚ <br></li><li>  getNumPrimitiveSetsï¼ˆï¼‰-è¿”å›ä¸æ­¤å‡ ä½•å…³è”çš„å›¾å…ƒçš„æ€»æ•°ã€‚ <br></li></ul><br>  osg :: PrimitiveSetç±»æ˜¯æŠ½è±¡çš„ï¼Œæ— æ³•å®ä¾‹åŒ–ï¼Œä½†æ˜¯å°è£…äº†ä¸OpenGLä¸€èµ·æ“ä½œçš„åŸå§‹é›†çš„å‡ ä¸ªæ´¾ç”Ÿç±»ï¼ˆä¾‹å¦‚osg :: DrawArrayså’Œosg :: DrawElementsUIntï¼‰ä»å…¶ç»§æ‰¿ã€‚ <br><br>  osg :: DrawArraysç±»ä½¿ç”¨é¡¶ç‚¹æ•°ç»„çš„å‡ ä¸ªè¿ç»­å…ƒç´ æ¥æ„é€ å‡ ä½•å›¾å…ƒã€‚ å¯ä»¥é€šè¿‡è°ƒç”¨æ–¹æ³•æ¥åˆ›å»ºå®ƒå¹¶å°†å…¶é™„åŠ åˆ°å‡ ä½•ã€‚ <br><br><pre> <code class="cpp hljs">geom-&gt;addPrimitiveSet(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::DrawArrays(mode, first, count));</code> </pre><br> ç¬¬ä¸€ä¸ªå‚æ•°æ¨¡å¼å°†åŸºæœ¬ç±»å‹è®¾ç½®ä¸ºç›¸åº”çš„OpenGLåŸºæœ¬ç±»å‹ï¼šGL_POINTSï¼ŒGL_LINE_STRIPï¼ŒGL_LINE_LOOPï¼ŒGL_LINESï¼ŒGL_TRIANGLE_STRIPï¼ŒGL_TRIANGLE_FANï¼ŒGL_TRIANGLESï¼ŒGL_QUAD_STRIPï¼ŒGL_QUADSå’ŒGL_POLYã€‚ <br><br> ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šé¡¶ç‚¹æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªç´¢å¼•ä»¥åŠåº”ä»ä¸­ç”Ÿæˆå‡ ä½•å›¾å½¢çš„é¡¶ç‚¹æ•°ã€‚  <strong>æ­¤å¤–ï¼ŒOSGä¸ä¼šæ£€æŸ¥æŒ‡å®šçš„é¡¶ç‚¹æ•°æ˜¯å¦è¶³ä»¥æ„å»ºè¯¥æ¨¡å¼æŒ‡å®šçš„å‡ ä½•ï¼Œè¿™å¯èƒ½å¯¼è‡´åº”ç”¨ç¨‹åºå´©æºƒï¼</strong> <br><br><h1>  6.ç¤ºä¾‹-ç»˜åˆ¶ä¸€ä¸ªæ¶‚æ¼†çš„æ­£æ–¹å½¢ </h1><br> æˆ‘ä»¬å°†ä¸Šè¿°æ‰€æœ‰å†…å®¹ä½œä¸ºä¸€ä¸ªç®€å•ç¤ºä¾‹ <br><br><div class="spoiler">  <b class="spoiler_title">Quadç¤ºä¾‹çš„å®Œæ•´æºä»£ç </b> <div class="spoiler_text">  <strong>ä¸»æ–‡ä»¶</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg/Geometry&gt; #include &lt;osg/Geode&gt; #include &lt;osgViewer/Viewer&gt; #endif // MAIN_H</span></span></span></span></code> </pre><br>  <strong>main.cpp</strong> <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> int main(int argc, char *argv[]) { osg::ref_ptr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg::Vec3Array&gt; vertices = new osg::Vec3Array; vertices-&gt;push_back(osg::Vec3(0.0f, 0.0f, 0.0f)); vertices-&gt;push_back(osg::Vec3(1.0f, 0.0f, 0.0f)); vertices-&gt;push_back(osg::Vec3(1.0f, 0.0f, 1.0f)); vertices-&gt;push_back(osg::Vec3(0.0f, 0.0f, 1.0f)); osg::ref_ptr&lt;osg::Vec3Array&gt; normals = new osg::Vec3Array; normals-&gt;push_back(osg::Vec3(0.0f, -1.0f, 0.0f)); osg::ref_ptr&lt;osg::Vec4Array&gt; colors = new osg::Vec4Array; colors-&gt;push_back(osg::Vec4(1.0f, 0.0f, 0.0f, 1.0f)); colors-&gt;push_back(osg::Vec4(0.0f, 1.0f, 0.0f, 1.0f)); colors-&gt;push_back(osg::Vec4(0.0f, 0.0f, 1.0f, 1.0f)); colors-&gt;push_back(osg::Vec4(1.0f, 1.0f, 1.0f, 1.0f)); osg::ref_ptr&lt;osg::Geometry&gt; quad = new osg::Geometry; quad-&gt;setVertexArray(vertices.get()); quad-&gt;setNormalArray(normals.get()); quad-&gt;setNormalBinding(osg::Geometry::BIND_OVERALL); quad-&gt;setColorArray(colors.get()); quad-&gt;setColorBinding(osg::Geometry::BIND_PER_VERTEX); quad-&gt;addPrimitiveSet(new osg::DrawArrays(GL_QUADS, 0, 4)); osg::ref_ptr&lt;osg::Geode&gt; root = new osg::Geode; root-&gt;addDrawable(quad.get()); osgViewer::Viewer viewer; viewer.setSceneData(root.get()); return viewer.run(); }</span></span></span></span></code> </pre><br></div></div><br> ç¼–è¯‘æ‰§è¡Œåï¼Œæˆ‘ä»¬å¾—åˆ°çš„ç»“æœä¸æ­¤ç±»ä¼¼ <br><br><img src="https://habrastorage.org/webt/pz/1p/e4/pz1pe4inopylxd1vikvi4kzm8m0.png"><br><br> è¿™ä¸ªä¾‹å­éœ€è¦æ¾„æ¸…ã€‚ å› æ­¤ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ­£æ–¹å½¢çš„é¡¶ç‚¹æ•°ç»„ï¼Œåœ¨å…¶ä¸­å­˜å‚¨å…¶åæ ‡ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Vec3Array&gt; vertices = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Vec3Array; vertices-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>)); vertices-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>)); vertices-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); vertices-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>));</code> </pre><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¾ç½®æ³•çº¿æ•°ç»„ã€‚ åœ¨æˆ‘ä»¬çš„ç®€å•æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸ºæ¯ä¸ªé¡¶ç‚¹åˆ›å»ºä¸€ä¸ªæ³•çº¿-åªéœ€æè¿°ä¸€ä¸ªå‚ç›´äºæ­£æ–¹å½¢å¹³é¢çš„å•ä½çŸ¢é‡å³å¯ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Vec3Array&gt; normals = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Vec3Array; normals-&gt;push_back(osg::Vec3(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">-1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>));</code> </pre><br> ä¸ºæ¯ä¸ªé¡¶ç‚¹è®¾ç½®é¢œè‰² <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Vec4Array&gt; colors = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Vec4Array; colors-&gt;push_back(osg::Vec4(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); colors-&gt;push_back(osg::Vec4(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); colors-&gt;push_back(osg::Vec4(<span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>)); colors-&gt;push_back(osg::Vec4(<span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>));</code> </pre><br> ç°åœ¨åˆ›å»ºä¸€ä¸ªå‡ ä½•å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†å­˜å‚¨æ­£æ–¹å½¢çš„æè¿°ï¼Œç„¶åç”±æ¸²æŸ“å™¨å¤„ç†ã€‚ æˆ‘ä»¬å°†é¡¶ç‚¹æ•°ç»„ä¼ é€’ç»™æ­¤å‡ ä½• <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Geometry&gt; quad = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Geometry; quad-&gt;setVertexArray(vertices.get());</code> </pre><br> é€šè¿‡æŒ‡å®šä¸€ç»„æ³•çº¿ï¼Œæˆ‘ä»¬é€šè¿‡æŒ‡å®šæ³•çº¿BIND_OVAERALLçš„ç»‘å®šæ–¹æ³•ï¼ˆâ€œç»‘å®šâ€ï¼‰æ¥é€šçŸ¥å¼•æ“æ‰€æœ‰å•ä¸ªé¡¶ç‚¹å°†ä½¿ç”¨ä¸€ä¸ªæ³•çº¿ <br><br><pre> <code class="cpp hljs">quad-&gt;setNormalArray(normals.get()); quad-&gt;setNormalBinding(osg::Geometry::BIND_OVERALL);</code> </pre><br> ç›¸åï¼Œä¼ é€’é¡¶ç‚¹çš„é¢œè‰²è¡¨ç¤ºæ¯ä¸ªé¡¶ç‚¹å°†å…·æœ‰è‡ªå·±çš„é¢œè‰² <br><br><pre> <code class="cpp hljs">quad-&gt;setColorArray(colors.get()); quad-&gt;setColorBinding(osg::Geometry::BIND_PER_VERTEX);</code> </pre><br> ç°åœ¨ä¸ºå‡ ä½•åˆ›å»ºä¸€ç»„å›¾å…ƒã€‚ æˆ‘ä»¬æŒ‡ç¤ºåº”ä»é¡¶ç‚¹æ•°ç»„ç”Ÿæˆæ­£æ–¹å½¢ï¼ˆGL_QUADSï¼‰é¢ï¼Œå°†ç´¢å¼•ä¸º0çš„é¡¶ç‚¹ä½œä¸ºç¬¬ä¸€ä¸ªé¡¶ç‚¹ï¼Œå¹¶ä¸”é¡¶ç‚¹æ€»æ•°å°†ä¸º4 <br><br><pre> <code class="cpp hljs">quad-&gt;addPrimitiveSet(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::DrawArrays(GL_QUADS, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>));</code> </pre><br> å¥½å§ï¼Œæˆ‘è®¤ä¸ºæ²¡æœ‰å¿…è¦è§£é‡Šå‡ ä½•çš„è½¬ç§»å’Œæ¸²æŸ“çš„å¯åŠ¨ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Geode&gt; root = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Geode; root-&gt;addDrawable(quad.get()); osgViewer::Viewer viewer; viewer.setSceneData(root.get()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> viewer.run();</code> </pre><br> ä¸Šé¢çš„ä»£ç ç­‰æ•ˆäºçº¯OpenGLä¸­çš„ä»¥ä¸‹è®¾è®¡ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GLfloat vertices[][<span class="hljs-number"><span class="hljs-number">3</span></span>] = { â€¦ }; glEnableClientState( GL_VERTEX_ARRAY ); glVertexPointer( <span class="hljs-number"><span class="hljs-number">4</span></span>, GL_FLOAT, <span class="hljs-number"><span class="hljs-number">0</span></span>, vertices ); glDrawArrays( GL_QUADS, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> );</code> </pre><br><h1>  7.ç´¢å¼•å›¾å…ƒä¸­çš„é¡¶ç‚¹ </h1><br>  osg :: DrawArraysç±»åœ¨ç›´æ¥ä»æ•°ç»„ä¸­æ— é—´éš™åœ°è¯»å–é¡¶ç‚¹æ•°æ®æ—¶æ•ˆæœå¾ˆå¥½ã€‚ ä½†æ˜¯ï¼Œå½“åŒä¸€ä¸ªé¡¶ç‚¹å¯ä»¥å±äºä¸€ä¸ªå¯¹è±¡çš„å¤šä¸ªé¢æ—¶ï¼Œè¿™å¹¶ä¸æ˜¯é‚£ä¹ˆæœ‰æ•ˆã€‚ è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚ <br><br><img src="https://habrastorage.org/webt/yp/is/wm/ypiswmcxzm2uokv9xdreonovmf4.png"><br><br> ç«‹æ–¹ä½“æœ‰å…«ä¸ªé¡¶ç‚¹ã€‚ ä½†æ˜¯ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ˆæˆ‘ä»¬çœ‹ç«‹æ–¹ä½“åœ¨å¹³é¢ä¸Šçš„å±•å¼€ï¼‰ï¼ŒæŸäº›é¡¶ç‚¹å±äºå¤šä¸ªé¢ã€‚ å¦‚æœæ‚¨æ„å»ºä¸€ä¸ªç”±12ä¸ªä¸‰è§’å½¢é¢ç»„æˆçš„ç«‹æ–¹ä½“ï¼Œåˆ™è¿™äº›é¡¶ç‚¹å°†è¢«é‡å¤ï¼Œè€Œä¸æ˜¯ç”±8ä¸ªé¡¶ç‚¹ç»„æˆçš„æ•°ç»„ï¼Œè€Œæ˜¯ç”±36ä¸ªé¡¶ç‚¹ç»„æˆçš„æ•°ç»„ï¼Œå…¶ä¸­å¤§å¤šæ•°å®é™…ä¸Šæ˜¯ç›¸åŒçš„é¡¶ç‚¹ï¼ <br><br> åœ¨OSGä¸­ï¼Œæœ‰ç±»osg :: DrawElementsUIntï¼Œosg :: DrawElementsUByteå’Œosg :: DrawElementsUShortï¼Œå®ƒä»¬ä½¿ç”¨é¡¶ç‚¹ç´¢å¼•æ•°ç»„ä½œä¸ºæ•°æ®æ¥è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ ç´¢å¼•æ•°ç»„å­˜å‚¨æè¿°é¢å’Œå‡ ä½•å›¾å½¢å…¶ä»–å…ƒç´ çš„å›¾å…ƒé¡¶ç‚¹çš„ç´¢å¼•ã€‚ å°†è¿™äº›ç±»åº”ç”¨äºå¤šç»´æ•°æ®é›†æ—¶ï¼Œè¶³ä»¥å­˜å‚¨é€šè¿‡ç´¢å¼•æ•°ç»„ä¸é¢ç›¸å…³è”çš„å…«ä¸ªé¡¶ç‚¹çš„æ•°ç»„ã€‚ <br><br>  osg :: DrawElements *ç±»å‹çš„ç±»çš„æ„å»ºæ–¹å¼ä¸æ ‡å‡†ç±»std :: vectorç›¸åŒã€‚ æ­¤ç±»ä»£ç å¯ç”¨äºæ·»åŠ ç´¢å¼•ã€‚ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::DrawElementsUInt&gt; de = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::DrawElementsUInt(GL_TRIANGLES); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">0</span></span>); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">1</span></span>); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">2</span></span>); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">3</span></span>); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">0</span></span>); de-&gt;push_back(<span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre><br> è¯¥ä»£ç å®šä¹‰äº†å›¾ä¸­æ‰€ç¤ºç«‹æ–¹ä½“çš„æ­£é¢ã€‚ <br><br> è®©æˆ‘ä»¬è€ƒè™‘å¦ä¸€ä¸ªè¯´æ˜æ€§çš„ä¾‹å­-å…«é¢ä½“ <br><br><img src="https://habrastorage.org/webt/is/cg/3r/iscg3rdq59wftnoy7h1iulgoczk.png"><br><br> æœ‰è¶£çš„æ˜¯ï¼Œå®ƒä»…åŒ…å«å…­ä¸ªé¡¶ç‚¹ï¼Œä½†æ˜¯æ¯ä¸ªé¡¶ç‚¹æœ€å¤šå¯ä»¥è¾“å…¥å››ä¸ªä¸‰è§’å½¢é¢ï¼ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨osg :: DrawArraysåˆ›å»ºä¸€ä¸ªåŒ…å«24ä¸ªé¡¶ç‚¹çš„æ•°ç»„æ¥æ˜¾ç¤ºæ‰€æœ‰å…«ä¸ªé¢ã€‚ ä½†æ˜¯ï¼Œå¦åˆ™ï¼Œæˆ‘ä»¬å°†æ‰§è¡Œå…¶ä»–æ“ä½œ-å°†é¡¶ç‚¹å­˜å‚¨åœ¨å…­ä¸ªå…ƒç´ çš„æ•°ç»„ä¸­ï¼Œå¹¶ä½¿ç”¨osg :: DrawElementsUIntç±»ç”Ÿæˆé¢ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å…«é¢ä½“ç¤ºä¾‹çš„å®Œæ•´èµ„æ–™</b> <div class="spoiler_text">  <strong>ä¸»æ–‡ä»¶</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg/Geometry&gt; #include &lt;osg/Geode&gt; #include &lt;osgUtil/SmoothingVisitor&gt; #include &lt;osgViewer/Viewer&gt; #endif</span></span></span></span></code> </pre><br>  <strong>main.cpp</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> int main(int argc, char *argv[]) { osg::ref_ptr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg::Vec3Array&gt; vertices = new osg::Vec3Array(6); (*vertices)[0].set( 0.0f, 0.0f, 1.0f); (*vertices)[1].set(-0.5f, -0.5f, 0.0f); (*vertices)[2].set( 0.5f, -0.5f, 0.0f); (*vertices)[3].set( 0.5f, 0.5f, 0.0f); (*vertices)[4].set(-0.5f, 0.5f, 0.0f); (*vertices)[5].set( 0.0f, 0.0f, -1.0f); osg::ref_ptr&lt;osg::DrawElementsUInt&gt; indices = new osg::DrawElementsUInt(GL_TRIANGLES, 24); (*indices)[ 0] = 0; (*indices)[ 1] = 1; (*indices)[ 2] = 2; (*indices)[ 3] = 0; (*indices)[ 4] = 4; (*indices)[ 5] = 1; (*indices)[ 6] = 4; (*indices)[ 7] = 5; (*indices)[ 8] = 1; (*indices)[ 9] = 4; (*indices)[10] = 3; (*indices)[11] = 5; (*indices)[12] = 3; (*indices)[13] = 2; (*indices)[14] = 5; (*indices)[15] = 1; (*indices)[16] = 5; (*indices)[17] = 2; (*indices)[18] = 3; (*indices)[19] = 0; (*indices)[20] = 2; (*indices)[21] = 0; (*indices)[22] = 3; (*indices)[23] = 4; osg::ref_ptr&lt;osg::Geometry&gt; geom = new osg::Geometry; geom-&gt;setVertexArray(vertices.get()); geom-&gt;addPrimitiveSet(indices.get()); osgUtil::SmoothingVisitor::smooth(*geom); osg::ref_ptr&lt;osg::Geode&gt; root = new osg::Geode; root-&gt;addDrawable(geom.get()); osgViewer::Viewer viewer; viewer.setSceneData(root.get()); return viewer.run(); }</span></span></span></span></code> </pre><br></div></div><br> è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°åˆ†ææ­¤ä»£ç ã€‚ å½“ç„¶ï¼Œæˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åˆ›å»ºå…­ä¸ªé¡¶ç‚¹çš„æ•°ç»„ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::Vec3Array&gt; vertices = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::Vec3Array(<span class="hljs-number"><span class="hljs-number">6</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">0</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>( <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">1.0f</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">1</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>(<span class="hljs-number"><span class="hljs-number">-0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">-0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">2</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>( <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">-0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">3</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>( <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">4</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>(<span class="hljs-number"><span class="hljs-number">-0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.5f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>); (*vertices)[<span class="hljs-number"><span class="hljs-number">5</span></span>].<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>( <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">0.0f</span></span>, <span class="hljs-number"><span class="hljs-number">-1.0f</span></span>);</code> </pre><br> æˆ‘ä»¬é€šè¿‡ä½¿ç”¨æŒ‡é’ˆå’Œoperator []è¿ç®—ç¬¦çš„è§£å¼•ç”¨æ“ä½œè®¿é—®å…¶åæ ‡çš„å‘é‡æ¥ç›´æ¥åˆå§‹åŒ–æ¯ä¸ªé¡¶ç‚¹ï¼ˆæˆ‘ä»¬è®°å¾—osg :: Arrayåœ¨å…¶è®¾å¤‡ä¸Šä¸std :: vectorç›¸ä¼¼ï¼‰ã€‚ <br><br> ç°åœ¨åˆ›å»ºé¢ä½œä¸ºé¡¶ç‚¹ç´¢å¼•åˆ—è¡¨ <br><br><pre> <code class="cpp hljs">osg::ref_ptr&lt;osg::DrawElementsUInt&gt; indices = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> osg::DrawElementsUInt(GL_TRIANGLES, <span class="hljs-number"><span class="hljs-number">24</span></span>); (*indices)[ <span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; (*indices)[ <span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span>; (*indices)[ <span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  0 (*indices)[ 3] = 0; (*indices)[ 4] = 4; (*indices)[ 5] = 1; //  1 (*indices)[ 6] = 4; (*indices)[ 7] = 5; (*indices)[ 8] = 1; //  2 (*indices)[ 9] = 4; (*indices)[10] = 3; (*indices)[11] = 5; //  3 (*indices)[12] = 3; (*indices)[13] = 2; (*indices)[14] = 5; //  4 (*indices)[15] = 1; (*indices)[16] = 5; (*indices)[17] = 2; //  5 (*indices)[18] = 3; (*indices)[19] = 0; (*indices)[20] = 2; //  6 (*indices)[21] = 0; (*indices)[22] = 3; (*indices)[23] = 4; //  7</span></span></code> </pre><br> é¢å°†æ˜¯ä¸‰è§’å½¢ï¼Œå°†æœ‰8ä¸ªï¼Œè¿™æ„å‘³ç€ç´¢å¼•åˆ—è¡¨åº”åŒ…å«24ä¸ªå…ƒç´ ã€‚ é¢çš„ç´¢å¼•åœ¨æ­¤æ•°ç»„ä¸­é¡ºåºæ’åˆ—ï¼šä¾‹å¦‚ï¼Œé¢0ç”±é¡¶ç‚¹0ã€1å’Œ2å½¢æˆï¼› é¢1-é¡¶ç‚¹0ã€4å’Œ1ï¼› é¢2-é¡¶ç‚¹4ã€5å’Œ1ç­‰ã€‚ å¦‚æœæ‚¨æŸ¥çœ‹è„¸éƒ¨çš„è„¸éƒ¨ï¼Œåˆ™è¿™äº›é¡¶ç‚¹æŒ‰é€†æ—¶é’ˆé¡ºåºåˆ—å‡ºï¼ˆè¯·å‚è§ä¸Šå›¾ï¼‰ã€‚ <br><br> æˆ‘ä»¬åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­æ‰§è¡Œäº†åˆ›å»ºå‡ ä½•çš„å…¶ä»–æ­¥éª¤ã€‚ æˆ‘ä»¬å”¯ä¸€æ²¡æœ‰åšçš„æ˜¯è‡ªåŠ¨ç”Ÿæˆå¹³æ»‘çš„ï¼ˆå¹³å‡ï¼‰æ³•çº¿ï¼Œåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <br><br><pre> <code class="cpp hljs">osgUtil::SmoothingVisitor::smooth(*geom);</code> </pre><br> ç¡®å®ï¼Œå¦‚æœç»™å‡ºäº†ä¸€ä¸ªé¢çš„é¡¶ç‚¹ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“è®¡ç®—å‡ºå®ƒçš„æ³•çº¿ã€‚ åœ¨å‡ ä¸ªé¢ä¼šèšçš„é¡¶ç‚¹å¤„ï¼Œè®¡ç®—å‡ºä¸€å®šçš„å¹³å‡æ³•çº¿-å°†ä¼šèšé¢çš„æ³•çº¿ç›¸åŠ ï¼Œç„¶åå°†æ‰€å¾—æ€»å’Œå†æ¬¡å½’ä¸€åŒ–ã€‚ è¿™äº›æ“ä½œï¼ˆä»¥åŠæ›´å¤šæ“ä½œï¼ï¼‰å¯ä»¥ç”±å¼•æ“æœ¬èº«ä½¿ç”¨osgUtilåº“ä¸­çš„ç±»æ¥æ‰§è¡Œã€‚ å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†å‘é“¾æ¥å™¨æ·»åŠ ä¸€æ¡æŒ‡ä»¤ï¼Œä»¥ä½¿ç”¨* .proæ–‡ä»¶ä¸­çš„è¯¥åº“æ¥æ„å»ºç¨‹åºã€‚ <br><br>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…«é¢ä½“</a></strong> <br><br><pre> <code class="cmake hljs">CONFIG(debug, debug|release) { <span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span> = $$join(<span class="hljs-keyword"><span class="hljs-keyword">TARGET</span></span>,,,_d) . . . LIBS += -L$$OSG_LIB_DIRECTORY -losgUtild } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { . . . LIBS += -L$$OSG_LIB_DIRECTORY -losgUtil }</code> </pre><br> ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹ç»“æœ <br><br><img src="https://habrastorage.org/webt/sf/ia/yg/sfiayg-o7wqijwskwuw6276xx0y.png"><br><br> è¦äº†è§£å…¶å·¥ä½œåŸç†ï¼Œè¯·è€ƒè™‘OpenGLç®¡é“ <br><br><img src="https://habrastorage.org/webt/7w/f0/mq/7wf0mqmabsa1ltwbzsgt189jsmy.png"><br><br> é¡¶ç‚¹æ•°ç»„æœºåˆ¶å‡å°‘äº†OpenGLè°ƒç”¨çš„æ¬¡æ•°ã€‚ å®ƒå°†é¡¶ç‚¹æ•°æ®å­˜å‚¨åœ¨åº”ç”¨ç¨‹åºå†…å­˜ä¸­ï¼Œä¾›å®¢æˆ·ç«¯ä½¿ç”¨ã€‚ æœåŠ¡å™¨ç«¯çš„OpenGLç®¡é“å¯ä»¥è®¿é—®å„ç§é¡¶ç‚¹æ•°ç»„ã€‚ å¦‚å›¾æ‰€ç¤ºï¼ŒOpenGLä»å®¢æˆ·ç«¯çš„é¡¶ç‚¹ç¼“å†²åŒºæ¥æ”¶æ•°æ®ï¼Œå¹¶ä»¥æœ‰åºçš„æ–¹å¼æ‰§è¡Œå›¾å…ƒçš„ç»„è£…ã€‚ è¿™å°±æ˜¯ä½¿ç”¨osg :: Geometryç±»çš„set * Arrayï¼ˆï¼‰æ–¹æ³•å¤„ç†æ•°æ®çš„æ–¹å¼ã€‚  osg :: DrawArraysç±»ç›´æ¥éå†è¿™äº›æ•°ç»„å¹¶æ˜¾ç¤ºå®ƒä»¬ã€‚ <br><br> å½“ä½¿ç”¨osg :: DrawElements *æ—¶ï¼Œé¡¶ç‚¹æ•°ç»„çš„ç»´æ•°å‡å°ï¼Œå¹¶ä¸”è½¬ç§»åˆ°ç®¡é“çš„é¡¶ç‚¹æ•°å‡å°‘ã€‚ ç´¢å¼•æ•°ç»„ä½¿æ‚¨å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºé¡¶ç‚¹ç¼“å­˜ã€‚  OpenGLä»ç¼“å­˜è¯»å–é¡¶ç‚¹æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å®¢æˆ·ç«¯çš„é¡¶ç‚¹ç¼“å†²åŒºè¯»å–ã€‚ è¿™æ˜¾ç€æé«˜äº†æ•´ä½“æ¸²æŸ“æ€§èƒ½ã€‚ <br><br><h1>  8.å¤šè¾¹å½¢ç½‘æ ¼å¤„ç†æŠ€æœ¯ </h1><br>  OpenSceneGraphæ”¯æŒå„ç§æŠ€æœ¯æ¥å¤„ç†åœºæ™¯å‡ ä½•å¯¹è±¡çš„å¤šè¾¹å½¢ç½‘æ ¼ã€‚ è¿™äº›é¢„å¤„ç†æ–¹æ³•ï¼ˆä¾‹å¦‚å¤šè¾¹å½¢ç¼©å°å’Œç»†åˆ†ï¼‰é€šå¸¸ç”¨äºåˆ›å»ºå’Œä¼˜åŒ–å¤šè¾¹å½¢æ¨¡å‹ã€‚ å®ƒä»¬å…·æœ‰ä¸€ä¸ªç®€å•çš„ç•Œé¢ï¼Œä½†æ˜¯åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå®ƒä»¬æ‰§è¡Œè®¸å¤šå¤æ‚çš„è®¡ç®—ï¼Œå› æ­¤ä¸é€‚åˆå³æ—¶æ‰§è¡Œã€‚ <br><br> æè¿°çš„æŠ€æœ¯åŒ…æ‹¬ï¼š <br><br><ol><li>  osgUtil ::ç®€åŒ–å™¨-å‡å°‘å‡ ä½•ä¸­çš„ä¸‰è§’å½¢æ•°é‡ã€‚  simpleï¼ˆï¼‰å…¬å…±æ–¹æ³•ç”¨äºç®€åŒ–æ¨¡å‹å‡ ä½•ã€‚ <br></li><li>  osgUtil :: SmootingVisitor-æ³•çº¿çš„è®¡ç®—ã€‚  smoothï¼ˆï¼‰æ–¹æ³•å¯ç”¨äºä¸ºæ¨¡å‹ç”Ÿæˆå¹³æ»‘çš„æ³•çº¿ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹åœ°è®¡ç®—å®ƒä»¬å¹¶é€šè¿‡æ³•çº¿æ•°ç»„æ˜¾å¼è®¾ç½®å®ƒä»¬ã€‚ <br></li><li>  osgUtil :: TangentSpaceGenerator-ä¸ºæ¨¡å‹é¡¶ç‚¹ç”Ÿæˆåˆ‡çº¿åŸºç¡€å‘é‡ã€‚ å®ƒé€šè¿‡è°ƒç”¨generateï¼ˆï¼‰æ–¹æ³•å¯åŠ¨ï¼Œå¹¶ä¿å­˜getTangentArrayï¼ˆï¼‰ï¼ŒgetNormalArrayï¼ˆï¼‰å’ŒgetBinormalArrayï¼ˆï¼‰æ–¹æ³•è¿”å›çš„ç»“æœã€‚ åœ¨GLSLä¸­ç¼–å†™ç€è‰²å™¨æ—¶ï¼Œè¿™äº›ç»“æœå¯ç”¨äºå„ç§é¡¶ç‚¹å±æ€§ã€‚ <br></li><li>  osgUtil :: Tesselator-æ‰§è¡Œå¤šè¾¹å½¢ç½‘æ ¼çš„ç»†åˆ†-å°†å¤æ‚çš„å›¾å…ƒæ‹†åˆ†ä¸ºä¸€ç³»åˆ—ç®€å•çš„å›¾å…ƒï¼ˆretesselatePolygonsï¼ˆï¼‰æ–¹æ³•ï¼‰ <br></li><li>  osgUtil :: TriStripVisitor-å°†å‡ ä½•è¡¨é¢è½¬æ¢æˆä¸€ç»„ä¸‰è§’å½¢çš„é¢ï¼Œä»è€Œå¯ä»¥æœ‰æ•ˆåœ°æ¶ˆè€—å†…å­˜è¿›è¡Œæ¸²æŸ“ã€‚  stripifyï¼ˆï¼‰æ–¹æ³•åŸºäºGL_TRIANGLE_STRIPé›†å°†ä¸€ç»„æ¨¡å‹å›¾å…ƒè½¬æ¢ä¸ºå‡ ä½•ã€‚ <br></li></ol><br> æ‰€æœ‰æ–¹æ³•éƒ½å°†å¯¹è±¡çš„å‡ ä½•å›¾å½¢ä½œä¸ºosg :: Geometryï¼†linkä¼ é€’çš„å‚æ•°ï¼Œä¾‹å¦‚ <br><br><pre> <code class="cpp hljs">osgUtil::TriStripVisitor tsv; tsv.stripify(*geom);</code> </pre><br> å…¶ä¸­geomæŒ‡çš„æ˜¯æ™ºèƒ½æŒ‡é’ˆæè¿°çš„å‡ ä½•å®ä¾‹ã€‚ <br><br>  osg :: Simplifierï¼Œosg :: SmoothingVisitorå’Œosg :: TriStripVisitorç±»å¯ä»¥ç›´æ¥ä¸åœºæ™¯å›¾ä¸­çš„èŠ‚ç‚¹ä¸€èµ·ä½¿ç”¨ <br><br><pre> <code class="cpp hljs">osgUtil::TriStripVisitor tsv; node-&gt;accept(tsv);</code> </pre><br>  acceptï¼ˆï¼‰æ–¹æ³•å¤„ç†æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œç›´åˆ°å°†æŒ‡å®šçš„æ“ä½œåº”ç”¨äºå­˜å‚¨åœ¨osg :: Geodeç±»å‹çš„èŠ‚ç‚¹ä¸­çš„åœºæ™¯æ ‘æ­¤éƒ¨åˆ†çš„æ‰€æœ‰ç»ˆç«¯èŠ‚ç‚¹ä¸ºæ­¢ã€‚ <br><br> è®©æˆ‘ä»¬åœ¨å®è·µä¸­å°è¯•é•¶åµŒæŠ€æœ¯ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´çš„é•¶åµŒå™¨ç¤ºä¾‹ä»£ç </b> <div class="spoiler_text">  <strong>ä¸»æ–‡ä»¶</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MAIN_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg/Geometry&gt; #include &lt;osg/Geode&gt; #include &lt;osgUtil/Tessellator&gt; #include &lt;osgViewer/Viewer&gt; #endif</span></span></span></span></code> </pre><br>  <strong>main.cpp</strong> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> int main(int argc, char *argv[]) { </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/*    ----- | _| | |_ | | ----- */</span></span></span><span class="hljs-meta"> osg::ref_ptr</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;osg::Vec3Array&gt; vertices = new osg::Vec3Array; vertices-&gt;push_back( osg::Vec3(0.0f, 0.0f, 0.0f) ); // 0 vertices-&gt;push_back( osg::Vec3(2.0f, 0.0f, 0.0f) ); // 1 vertices-&gt;push_back( osg::Vec3(2.0f, 0.0f, 1.0f) ); // 2 vertices-&gt;push_back( osg::Vec3(1.0f, 0.0f, 1.0f) ); // 3 vertices-&gt;push_back( osg::Vec3(1.0f, 0.0f, 2.0f) ); // 4 vertices-&gt;push_back( osg::Vec3(2.0f, 0.0f, 2.0f) ); // 5 vertices-&gt;push_back( osg::Vec3(2.0f, 0.0f, 3.0f) ); // 6 vertices-&gt;push_back( osg::Vec3(0.0f, 0.0f, 3.0f) ); // 7 osg::ref_ptr&lt;osg::Vec3Array&gt; normals = new osg::Vec3Array; normals-&gt;push_back( osg::Vec3(0.0f, -1.0f, 0.0f) ); osg::ref_ptr&lt;osg::Geometry&gt; geom = new osg::Geometry; geom-&gt;setVertexArray(vertices.get()); geom-&gt;setNormalArray(normals.get()); geom-&gt;setNormalBinding(osg::Geometry::BIND_OVERALL); geom-&gt;addPrimitiveSet(new osg::DrawArrays(GL_POLYGON, 0, 8)); osg::ref_ptr&lt;osg::Geode&gt; root = new osg::Geode; root-&gt;addDrawable(geom.get()); osgViewer::Viewer viewer; viewer.setSceneData(root.get()); return viewer.run(); }</span></span></span></span></code> </pre><br></div></div><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼ŒåŸºäºé¡¶ç‚¹çš„ç©ºé—´ä½ç½®ï¼Œæˆ‘ä»¬çœ‹åˆ°æˆ‘ä»¬æ­£åœ¨å°è¯•ä½¿ç”¨GL_POLYGONç±»å‹çš„ä¸€ä¸ªé¢çš„ç”Ÿæˆæ¥åˆ›å»ºå…«ä¸ªé¡¶ç‚¹çš„éå‡¸å¤šè¾¹å½¢ã€‚ æ­¤ç¤ºä¾‹çš„ç»„è£…å’Œæ‰§è¡Œè¡¨æ˜ï¼Œæˆ‘ä»¬é¢„æœŸçš„ç»“æœä¸èµ·ä½œç”¨-è¯¥ç¤ºä¾‹æ˜¾ç¤ºä¸æ­£ç¡® <br><br><img src="https://habrastorage.org/webt/yb/d3/0f/ybd30fn9fa9duvxedfyb6igt3ui.png"><br><br> è¦è§£å†³æ­¤é—®é¢˜ï¼Œå¿…é¡»åœ¨å°†æ„é€ çš„å‡ ä½•ä½“ä¼ é€’ç»™æŸ¥çœ‹å™¨ä¹‹å‰å¯¹å…¶è¿›è¡Œç»†åˆ†ã€‚ <br><br><pre> <code class="cpp hljs">osgUtil::Tessellator ts; ts.retessellatePolygons(*geom);</code> </pre><br> ä¹‹åæˆ‘ä»¬å¾—åˆ°æ­£ç¡®çš„ç»“æœ <br><br><img src="https://habrastorage.org/webt/p7/wj/fa/p7wjfanogrvkbdxksemk5li_vdi.png"><br><br> å¦‚ä½•è¿ä½œï¼Ÿ å¦‚æœæœªä½¿ç”¨æ­£ç¡®çš„ç»†åˆ†ï¼Œåˆ™ä¸ä¼šæ˜¾ç¤ºéå‡¸å¤šè¾¹å½¢ï¼Œå› ä¸ºå¯»æ±‚ä¼˜åŒ–æ€§èƒ½çš„OpenGLä¼šå°†å…¶è§†ä¸ºç®€å•çš„å‡¸å¤šè¾¹å½¢ï¼Œæˆ–è€…å°†å…¶å¿½ç•¥ï¼Œè¿™å¯èƒ½ä¼šå¸¦æ¥å®Œå…¨å‡ºä¹æ„æ–™çš„ç»“æœã€‚ <br><br>  osgUtil :: Tessellatorç±»ä½¿ç”¨ç®—æ³•å°†å‡¸å¤šè¾¹å½¢è½¬æ¢ä¸ºä¸€ç³»åˆ—éå‡¸å¤šè¾¹å½¢-åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œå®ƒå°†å‡ ä½•è½¬æ¢ä¸ºGL_TRIANGLE_STRIPã€‚ <br><br><img src="https://habrastorage.org/webt/05/ho/do/05hodotfc4iltbsnlyevejuhvfw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤ç±»å¯ä»¥å¤„ç†å­”å¤šè¾¹å½¢å’Œè‡ªç›¸äº¤å¤šè¾¹å½¢ã€‚ä½¿ç”¨å…¬å…±setWindingTypeï¼ˆï¼‰æ–¹æ³•ï¼Œå¯ä»¥å®šä¹‰å„ç§å¤„ç†è§„åˆ™ï¼Œä¾‹å¦‚GLU_TESS_WINDING_ODDæˆ–GLU_TESS_WINDING_NONZEROï¼Œå®ƒä»¬æŒ‡å®šå¤æ‚å¤šè¾¹å½¢çš„å†…éƒ¨å’Œå¤–éƒ¨åŒºåŸŸã€‚</font></font><br><br><h1> ç»“è®º </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å¯¹OSGå¼•æ“ä¸­å¦‚ä½•å­˜å‚¨å’Œå¤„ç†ä¸‰ç»´å¯¹è±¡çš„å‡ ä½•æœ‰äº†åŸºæœ¬çš„äº†è§£ã€‚</font><font style="vertical-align: inherit;">ä¸è¦è®¤ä¸ºæœ¬æ–‡ä¸­è€ƒè™‘çš„é‚£äº›ç®€å•ä½†ä¸å¤ªä»¤äººå°è±¡æ·±åˆ»çš„ç¤ºä¾‹æ˜¯å¼•æ“åŠŸèƒ½çš„é™åˆ¶ã€‚</font><font style="vertical-align: inherit;">ä»…è¿™äº›ç¤ºä¾‹å°±å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜äº†è§£OpenSceneGraphçš„æœºåˆ¶ï¼Œå¦‚æœæ²¡æœ‰è¿™ç§äº†è§£ï¼Œå°±å¾ˆéš¾æƒ³è±¡æ›´å¤æ‚çš„äº‹ç‰©çš„å·¥ä½œã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æ–‡åŸºäºå¯¹</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenSceneGraph 3.0</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¹¦ä¸­ç›¸åº”ç« èŠ‚çš„æ–‡æœ¬çš„ç¿»è¯‘å’Œå¤„ç†</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">ã€‚</font></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">å…¥é—¨æŒ‡å—</font></a><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ‰€æœ‰ç¤ºä¾‹å‡ç”±æˆ‘äº²è‡ªæ£€æŸ¥ï¼Œå…¶æºä»£ç </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¯åœ¨æ­¤å¤„è·å–</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å¾…ç»­...</font></font></a></i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN430212/">https://habr.com/ru/post/zh-CN430212/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN430202/index.html">ä½¿ç”¨DirectX 11åœ¨C ++ä¸­ç¼–å†™æˆå¯¹ç›¸äº’ä½œç”¨çš„ç²’å­ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN430204/index.html">éº»çœç†å·¥å­¦é™¢çš„è¯¾ç¨‹â€œè®¡ç®—æœºç³»ç»Ÿå®‰å…¨â€ã€‚ è®²åº§18ï¼šâ€œç§äººäº’è”ç½‘æµè§ˆâ€ï¼Œç¬¬1éƒ¨åˆ†</a></li>
<li><a href="../zh-CN430206/index.html">éº»çœç†å·¥å­¦é™¢çš„è¯¾ç¨‹â€œè®¡ç®—æœºç³»ç»Ÿå®‰å…¨â€ã€‚ ç¬¬18è¯¾ï¼šç§äººæµè§ˆInternetï¼Œç¬¬2éƒ¨åˆ†</a></li>
<li><a href="../zh-CN430208/index.html">éº»çœç†å·¥å­¦é™¢çš„è¯¾ç¨‹â€œè®¡ç®—æœºç³»ç»Ÿå®‰å…¨â€ã€‚ è®²åº§18ï¼šâ€œç§äººäº’è”ç½‘æµè§ˆâ€ï¼Œç¬¬3éƒ¨åˆ†</a></li>
<li><a href="../zh-CN430210/index.html">Check Pointå®‰å…¨å­¦é™¢æµ‹è¯•æˆ‘çš„è€å¿ƒ</a></li>
<li><a href="../zh-CN430216/index.html">æ®æˆ‘äº†è§£ï¼Œæˆ‘åƒäº†å¾ˆå¤šç”œé£Ÿï¼Œæˆ–è€…æŒ‰ç”³è¯·ä¸­çš„æ”¯ç¥¨åˆ†ç±»å•†å“</a></li>
<li><a href="../zh-CN430218/index.html">èƒ½æºä¼˜åŒ–STM32ï¼šå®ç”¨æŒ‡å—</a></li>
<li><a href="../zh-CN430220/index.html">å¦‚ä½•å°†â€œç™¾å¹´çºªå¿µâ€ USBé›†çº¿å™¨å˜æˆæ™ºèƒ½æ‰˜ç®¡å¹¶èŠ‚çœ300ç¾å…ƒ</a></li>
<li><a href="../zh-CN430222/index.html">å¯»æ‰¾å·¥ä½œçš„é«˜çº§å·¥ç¨‹å¸ˆã€‚ æˆ‘å¦‚ä½•æ¥å—20æ¬¡äººåŠ›èµ„æºé‡‡è®¿ä»¥â€‹â€‹åŠå¯¹æ­¤çš„çœ‹æ³•</a></li>
<li><a href="../zh-CN430224/index.html">ç²¾ç¥åˆ†è£‚ç—‡ï¼šå†…åœ¨å¤–è§‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>