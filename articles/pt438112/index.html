<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí≤ üíπ ü¶é Encontrando uma bala de prata: atores + FRP em reagir üöµ üèÇüèø üéí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Atualmente, poucas pessoas escrevem em Perl, mas a famosa m√°xima de Larry Wall, "Mantenha as coisas simples, f√°ceis e dif√≠ceis poss√≠veis" se tornou a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Encontrando uma bala de prata: atores + FRP em reagir</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438112/"><p>  Atualmente, poucas pessoas escrevem em Perl, mas a famosa m√°xima de Larry Wall, "Mantenha as coisas simples, f√°ceis e dif√≠ceis poss√≠veis" se tornou a f√≥rmula geralmente aceita para uma tecnologia eficaz.  Ela pode ser interpretada no aspecto n√£o apenas da complexidade das tarefas, mas tamb√©m da abordagem: uma tecnologia ideal deve, por um lado, permitir o r√°pido desenvolvimento de aplicativos de m√©dio e pequeno porte (incluindo "somente grava√ß√£o"), por outro lado, fornecer ferramentas para um desenvolvimento criterioso aplica√ß√µes complexas, onde confiabilidade, manuten√ß√£o e estrutura s√£o fundamentais.  Ou ainda, traduzindo para o plano humano: estar acess√≠vel aos Jones e, ao mesmo tempo, satisfazer os pedidos dos Signat√°rios. </p><br><p>  Os editores agora populares podem ser criticados de ambos os lados - pelo menos o fato de que escrever funcionalidades elementares pode resultar em muitas linhas espa√ßadas em v√°rios arquivos - mas n√£o vamos nos aprofundar, porque muito j√° foi dito sobre isso. </p><br><blockquote> "Voc√™ deveria manter todas as mesas em uma sala e as cadeiras em outra" <br>  - Juha Paananen, criadora da biblioteca Bacon.js, sobre o Editor </blockquote><p>  A tecnologia que ser√° discutida hoje n√£o √© uma bala de prata, mas afirma ser mais consistente com esses crit√©rios. </p><a name="habracut"></a><br><p>  Mrr √© uma biblioteca reativa funcional que professa o princ√≠pio de "tudo √© fluxo".  As principais vantagens oferecidas pela abordagem funcional-reativa no mrr s√£o concis√£o, expressividade do c√≥digo, bem como uma abordagem unificada para transforma√ß√µes de dados s√≠ncronos e ass√≠ncronos. </p><br><p>  √Ä primeira vista, isso n√£o soa como uma tecnologia que ser√° facilmente acess√≠vel para iniciantes: o conceito de fluxo pode ser dif√≠cil de entender, n√£o √© t√£o difundido no front-end, associado principalmente a bibliotecas idiotas como Rx.  E o mais importante, n√£o est√° totalmente claro como explicar os fluxos com base no esquema b√°sico "DOM de a√ß√£o-rea√ß√£o-atualiza√ß√£o".  Mas ... n√£o falaremos abstratamente sobre fluxos!  Vamos falar de coisas mais compreens√≠veis: eventos, condi√ß√£o. </p><br><h3 id="gotovim-po-receptu">  Cozinhando de acordo com a receita </h3><br><p>  Sem entrar na natureza do FRP, seguiremos um esquema simples para formalizar a √°rea de assunto: </p><br><ul><li>  fa√ßa uma lista dos dados que descrevem o estado da p√°gina e ser√£o usados ‚Äã‚Äãna interface do usu√°rio, bem como seus tipos. </li><li>  fa√ßa uma lista dos eventos que ocorrem ou s√£o gerados pelo usu√°rio na p√°gina e os tipos de dados que ser√£o transmitidos com eles </li><li>  fa√ßa uma lista dos processos que ocorrer√£o na p√°gina </li><li>  determinar as interdepend√™ncias entre eles. </li><li>  Descreva interdepend√™ncias usando operadores apropriados. </li></ul><br><p>  Ao mesmo tempo, precisamos conhecer a biblioteca apenas no √∫ltimo est√°gio. </p><br><p>  Ent√£o, vamos dar um exemplo simplificado de uma loja virtual, na qual h√° uma lista de produtos com pagina√ß√£o e filtragem por categoria, al√©m de uma cesta. </p><br><ol><li><p>  Dados com base nos quais a interface ser√° constru√≠da: </p><br><ul><li>  lista de mercadorias (matriz) </li><li>  categoria selecionada (linha) </li><li>  n√∫mero de p√°ginas com mercadorias (n√∫mero) </li><li>  lista de produtos que est√£o na cesta (matriz) </li><li>  p√°gina atual (n√∫mero) </li><li>  o n√∫mero de produtos na cesta (n√∫mero) </li></ul><br></li><li><p>  Eventos (por "eventos", eles significam apenas eventos moment√¢neos. A√ß√µes que ocorrem por um tempo - processos - precisam ser decompostas em eventos separados): </p><br><ul><li>  p√°gina de abertura (nula) </li><li>  sele√ß√£o de categoria (string) </li><li>  adicionando mercadorias √† cesta (objeto "mercadorias") </li><li>  remo√ß√£o de mercadorias da cesta (identifica√ß√£o das mercadorias a serem exclu√≠das) </li><li>  v√° para a pr√≥xima p√°gina da lista de produtos (n√∫mero - n√∫mero da p√°gina) </li></ul><br></li><li><p>  Processos: s√£o a√ß√µes que come√ßam e podem terminar com diferentes eventos de uma s√≥ vez ou depois de algum tempo.  No nosso caso, esse ser√° o carregamento dos dados do produto do servidor, o que pode acarretar dois eventos: conclus√£o bem-sucedida e conclus√£o com erro. </p><br></li><li><p>  Interdepend√™ncias entre eventos e dados.  Por exemplo, a lista de produtos depender√° do evento: "carregamento bem-sucedido da lista de produtos".  E ‚Äúcomece a carregar a lista de mercadorias‚Äù - de ‚Äúabrir a p√°gina‚Äù, ‚Äúselecionar a p√°gina atual‚Äù, ‚Äúselecionar uma categoria‚Äù.  Fa√ßa uma lista do formul√°rio [elemento]: [... depend√™ncias]: </p><br><pre><code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [<span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>, <span class="hljs-string"><span class="hljs-string">'pageLoaded'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goodsInCart</span></span>: [<span class="hljs-string"><span class="hljs-string">'cart'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: [<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>] }</code> </pre> <br></li></ol><br><p>  Ah ... mas esse √© quase o c√≥digo para o sr. </p><br><p><img src="https://habrastorage.org/webt/_x/jg/s7/_xjgs7dbqnztuaffvtgm96auncm.png"></p><br><p>  Resta apenas adicionar fun√ß√µes que descrevam o relacionamento.  Voc√™ pode esperar que eventos, dados e processos sejam entidades diferentes no sr. - mas n√£o, tudo isso s√£o threads!  Nossa tarefa √© conect√°-los corretamente. </p><br><p>  Como voc√™ pode ver, temos dois tipos de depend√™ncias: "dados" do "evento" (por exemplo, p√°gina do goToPage) e "dados" dos "dados" (goodsInCart do carrinho).  Para cada um deles existem abordagens apropriadas. </p><br><p>  A maneira mais f√°cil √© com "dados de dados": aqui simplesmente adicionamos uma fun√ß√£o pura, a "f√≥rmula": </p><br><pre> <code class="javascript hljs">goodsInCart: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arr</span></span></span><span class="hljs-function"> =&gt;</span></span> arr.length, <span class="hljs-string"><span class="hljs-string">'cart'</span></span>],</code> </pre> <br><p>  Cada vez que a matriz do carrinho √© alterada, o valor de goodsInCart ser√° recalculado. </p><br><p>  Se nossos dados dependem de um evento, tudo tamb√©m √© bem simples: </p><br><pre> <code class="javascript hljs">category: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*     category: [a =&gt; a, 'selectCategory'], */</span></span> goods: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resp</span></span></span><span class="hljs-function"> =&gt;</span></span> resp.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resp</span></span></span><span class="hljs-function"> =&gt;</span></span> resp.totalPages, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>],</code> </pre> <br><p>  O design do formul√°rio [fun√ß√£o, ... argumentos de thread] √© a base do sr.  Para um entendimento intuitivo, tra√ßando uma analogia com o Excel, os fluxos em mrr tamb√©m s√£o chamados de c√©lulas e as fun√ß√µes pelas quais s√£o calculados s√£o chamadas de f√≥rmulas. </p><br><p>  Se nossos dados dependem de v√°rios eventos, devemos transformar seus valores individualmente e combin√°-los em um fluxo usando o operador de mesclagem: </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* ,  merge -  ,   */</span></span> page: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>] ], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ],</code> </pre> <br><p>  Nos dois casos, nos referimos ao valor anterior da c√©lula.  Para evitar um loop infinito, nos referimos √†s c√©lulas do carrinho e da p√°gina <em>passivamente</em> (o sinal de menos na frente do nome da c√©lula): seus valores ser√£o substitu√≠dos na f√≥rmula, mas se eles mudarem, o rec√°lculo n√£o ser√° iniciado. </p><br><p>  Todos os threads s√£o criados com base em outros threads ou emitidos a partir do DOM.  Mas e o fluxo da "p√°gina de abertura"?  Felizmente, voc√™ n√£o precisa usar o componentDidMount: no sr. H√° um fluxo especial $ start, que indica que o componente foi criado e montado. </p><br><p>  Os "processos" s√£o calculados de forma ass√≠ncrona, enquanto emitimos certos eventos a partir deles, o operador "aninhado" nos ajudar√° aqui: </p><br><pre> <code class="javascript hljs">requestGoods: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page, category) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">"..."</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)); }, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'category'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span>],</code> </pre> <br><p>  Ao usar o operador aninhado, o primeiro argumento nos passa uma fun√ß√£o de retorno de chamada para a emiss√£o de determinados eventos.  Nesse caso, do lado de fora eles estar√£o acess√≠veis atrav√©s do espa√ßo de nomes da c√©lula raiz, por exemplo, </p><br><pre> <code class="javascript hljs">cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)</code> </pre> <br><p>  dentro da f√≥rmula requestGoods, ocorrer√° a atualiza√ß√£o da c√©lula requestGoods.success. </p><br><p>  Para renderizar a p√°gina corretamente antes que nossos dados sejam calculados, voc√™ pode especificar seus valores iniciais: </p><br><pre> <code class="javascript hljs">{ <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], },</code> </pre> <br><p>  Adicione marca√ß√£o.  Criamos um componente React usando a fun√ß√£o withMrr, que aceita um diagrama de link reativo e a fun√ß√£o render.  Para "colocar" um valor em um fluxo, usamos a fun√ß√£o $, que cria (e armazena em cache) manipuladores de eventos.  Agora, nosso aplicativo totalmente funcional fica assim: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span>], <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>]], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total_pages, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ], }, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">&lt;section&gt; &lt;h2&gt;Shop&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h2&gt; &lt;div&gt; Category: &lt;select onChange={$('selectCategory')}&gt; &lt;option&gt;All&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">option&gt; &lt;option&gt;Electronics&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/option&gt; &lt;option&gt;Photo&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">option&gt; &lt;option&gt;Cars&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/option&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">select&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; &lt;ul className="goods"&gt; { state.goods.map((item, i) =&gt; { const cartI = state.cart.findIndex(a =&gt; a.id === item.id); return (&lt;li key={i}&gt; { item.name } &lt;div&gt; { cartI === -1 &amp;&amp; &lt;button onClick={$("addToCart", item)}&gt;Add to cart&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">button&gt; } { cartI !== </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span><span class="hljs-function"><span class="hljs-params"> &amp;&amp; &lt;button onClick={$(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"removeFromCart"</span></span></span></span><span class="hljs-function"><span class="hljs-params">, item.id</span></span></span><span class="hljs-function">)}&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Remove</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">from</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cart</span></span></span><span class="hljs-function">&lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">button</span></span></span><span class="hljs-function">&gt; } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">li</span></span></span><span class="hljs-function">&gt;); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">className</span></span></span><span class="hljs-function">="</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pages</span></span></span><span class="hljs-function">"&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">new</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Array</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state.totalPages</span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fill</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">true</span></span></span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_, p</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page = <span class="hljs-built_in"><span class="hljs-built_in">Number</span></span>(p) + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;li className=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"page"</span></span></span></span><span class="hljs-function"><span class="hljs-params"> onClick={$(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'goToPage'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, page</span></span></span><span class="hljs-function">)} </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function">={</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">}&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page</span></span></span><span class="hljs-function"> } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">li</span></span></span><span class="hljs-function">&gt; ); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">section</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">section</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h2</span></span></span><span class="hljs-function">&gt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Cart</span></span></span><span class="hljs-function">&lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">h2</span></span></span><span class="hljs-function">&gt; &lt;</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cart</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(item, i</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{i}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> { item.name } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{$(</span></span></span></span><span class="xml"><span class="hljs-tag">"</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">removeFromCart</span></span></span></span><span class="xml"><span class="hljs-tag">", </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">item.id</span></span></span></span><span class="xml"><span class="hljs-tag">)}&gt;</span></span></span><span class="xml">Remove from cart</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>); }) } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/ul&gt; &lt;/</span></span>section&gt;); }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre><br><p>  Constru√ß√£o civil </p><br><pre> <code class="javascript hljs">&lt;select onChange={$(<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>)}&gt;</code> </pre> <br><p>  significa que quando o campo for alterado, o valor ser√° "enviado" ao fluxo selectCategory.  Mas qual √© o significado?  Por padr√£o, este √© event.target.value, mas se precisarmos enviar outra coisa, especificamos com o segundo argumento, como aqui: </p><br><pre> <code class="javascript hljs">&lt;button onClick={$(<span class="hljs-string"><span class="hljs-string">"addToCart"</span></span>, item)}&gt;</code> </pre> <br><p>  Tudo aqui - eventos, dados e processos - s√£o fluxos.  O acionamento de um evento causa um rec√°lculo de dados ou eventos, dependendo dele, e assim por diante ao longo da cadeia.  O valor do fluxo dependente √© calculado usando uma f√≥rmula que pode retornar um valor ou uma promessa (ent√£o mrr aguardar√° sua resolu√ß√£o). </p><br><p>  A API do mrr √© muito concisa e concisa - na maioria dos casos, precisamos apenas de 3 a 4 operadores b√°sicos, e muitas coisas podem ser feitas sem eles.  Adicione uma mensagem de erro quando a lista de produtos n√£o for carregada com sucesso, que ser√° exibida por um segundo: </p><br><pre> <code class="javascript hljs">hideErrorMessage: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>], <span class="hljs-attr"><span class="hljs-attr">errorMessageShown</span></span>: [ <span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>], [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">'hideErrorMessage'</span></span>], ],</code> </pre> <br><h3 id="sol-perec-sahar---po-vkusu"><del>  Sal, pimenta </del>  a√ß√∫car a gosto </h3><br><p>  H√° tamb√©m a√ß√∫car sint√°tico no srr, que √© opcional para o desenvolvimento, mas pode acelerar.  Por exemplo, o operador de altern√¢ncia: </p><br><pre> <code class="javascript hljs">errorMessageShown: [<span class="hljs-string"><span class="hljs-string">'toggle'</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'showErrorMessage'</span></span>]],</code> </pre> <br><p>  Uma altera√ß√£o no primeiro argumento definir√° a c√©lula como true e no segundo como false. <br>  A abordagem para "decompor" os resultados de uma tarefa ass√≠ncrona em subc√©lulas de sucesso e erro tamb√©m √© t√£o difundida que voc√™ pode usar o operador de promessa especial (que elimina automaticamente a condi√ß√£o de corrida): </p><br><pre> <code class="javascript hljs"> requestGoods: [ <span class="hljs-string"><span class="hljs-string">'promise'</span></span>, (page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span> ],</code> </pre> <br><p>  Muita funcionalidade cabe em apenas algumas dezenas de linhas.  Nosso junho condicional est√° satisfeito - ele conseguiu escrever um c√≥digo funcional, que acabou sendo bastante compacto: toda a l√≥gica se encaixava em um arquivo e em uma tela.  Mas o signor olha com incredulidade: Eka √© invis√≠vel ... voc√™ pode escrever isso em ganchos / recompor / etc. </p><br><p>  Sim, de fato √©!  √â improv√°vel que o c√≥digo seja ainda mais compacto e estruturado, mas esse n√£o √© o ponto.  Vamos imaginar que o projeto esteja em desenvolvimento e precisamos dividir a funcionalidade em duas p√°ginas separadas: uma lista de produtos e uma cesta.  Al√©m disso, a cesta de dados, obviamente, deve ser armazenada globalmente nas duas p√°ginas. </p><br><h3 id="odin-podhod-odin-interfeys">  Uma abordagem, uma interface </h3><br><p>  Aqui chegamos a outro problema do desenvolvimento de rea√ß√µes: a exist√™ncia de abordagens heterog√™neas para gerenciar o estado localmente (dentro de um componente) e globalmente no n√≠vel de todo o aplicativo.  Muitos, tenho certeza, enfrentaram um dilema: implementar alguma l√≥gica local ou globalmente?  Ou outra situa√ß√£o: verificou-se que alguns dados locais precisam ser salvos globalmente, e voc√™ deve reescrever parte da funcionalidade, por exemplo, de recompor para editor ... </p><br><p>  O contraste √©, √© claro, artificial, e, no caso, o senhor n√£o √©: √© igualmente bom e, o mais importante - uniforme!  - Adequado para gerenciamento de estado local e global.  Em geral, n√£o precisamos de nenhum estado global, apenas temos a capacidade de trocar dados entre os componentes, para que o estado do componente raiz seja "global". </p><br><p>  O esquema de nossa aplica√ß√£o agora √© o seguinte: o componente raiz que cont√©m a lista de mercadorias na cesta e dois subcomponentes: as mercadorias e a cesta e o componente global "escutam" os fluxos "adicionar √† cesta" e "remover da cesta" dos componentes filhos. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">currentPage</span></span>: <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">cart</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> [...arr, item], <span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> arr.filter(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> item.id !== id), <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'-cart'</span></span>], ], }, (state, props, $, connectAs) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( &lt;div&gt; &lt;menu&gt; &lt;li onClick={$('currentPage', 'goods')}&gt;Goods&lt;/li&gt; &lt;li onClick={$('currentPage', 'cart')}&gt;Cart{ state.cart &amp;&amp; state.cart.length ? '(' + state.cart.length + ')' : '' }&lt;/li&gt; &lt;/menu&gt; &lt;div&gt; { state.currentPage === 'goods' &amp;&amp; &lt;Goods {...connectAs('goods', ['addToCart', 'removeFromCart'], ['cart'])}/&gt; } { state.currentPage === 'cart' &amp;&amp; &lt;Cart {...connectAs('cart', { 'removeFromCart': 'remove' }, ['cart'])}/&gt; } &lt;/div&gt; &lt;/div&gt; ); })</code> </pre> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">goods</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">requestGoods</span></span>: [ <span class="hljs-string"><span class="hljs-string">'promise'</span></span>, (page = <span class="hljs-number"><span class="hljs-number">1</span></span>, category = <span class="hljs-string"><span class="hljs-string">'all'</span></span>) =&gt; fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page, category).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-string"><span class="hljs-string">'$start'</span></span> ], <span class="hljs-attr"><span class="hljs-attr">page</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, <span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, <span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>, <span class="hljs-string"><span class="hljs-string">'-page'</span></span>]], <span class="hljs-attr"><span class="hljs-attr">totalPages</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, <span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>], <span class="hljs-attr"><span class="hljs-attr">category</span></span>: <span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>, <span class="hljs-attr"><span class="hljs-attr">errorShown</span></span>: [<span class="hljs-string"><span class="hljs-string">'toggle'</span></span>, <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), <span class="hljs-string"><span class="hljs-string">'requestGoods.error'</span></span>]], }, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>); });</code> </pre><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Cart = withMrr({}, (state, props, $) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">&lt;div&gt; &lt;h2&gt;Cart&lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/h2&gt; &lt;ul&gt; { state.cart.map((item, i) =&gt; { return (&lt;div&gt; { item.name } &lt;div&gt; &lt;button onClick={$('remove', item.id)}&gt;Remove from cart&lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">button&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; &lt;/</span></span></span></span><span class="hljs-function"><span class="hljs-params">div&gt;</span></span></span><span class="hljs-function">); }) } &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ul</span></span></span><span class="hljs-function">&gt; &lt;/</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">div</span></span></span><span class="hljs-function">&gt;); });</span></span></code> </pre><br><p>  √â incr√≠vel como pouco mudou!  Simplesmente colocamos os fluxos nos componentes correspondentes e colocamos "pontes" entre eles!  Ao conectar os componentes usando a fun√ß√£o mrrConnect, especificamos o mapeamento para fluxos a jusante e a montante: </p><br><pre> <code class="javascript hljs">connectAs( <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> [<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>, <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>], <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> [<span class="hljs-string"><span class="hljs-string">'cart'</span></span>] )</code> </pre> <br><p>  Aqui, os fluxos addToCart e removeFromCart do componente filho ir√£o para o pai e o fluxo do carrinho voltar√°.  N√£o somos obrigados a usar os mesmos nomes de stream - se eles n√£o corresponderem, usamos o mapeamento: </p><br><pre> <code class="javascript hljs">connectAs(<span class="hljs-string"><span class="hljs-string">'cart'</span></span>, { <span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>: <span class="hljs-string"><span class="hljs-string">'remove'</span></span> })</code> </pre> <br><p>  O fluxo de remo√ß√£o do componente filho ser√° a fonte do fluxo removeFromCart no pai. </p><br><p>  Como voc√™ pode ver, o problema de escolher um local de armazenamento de dados no caso de mrr √© completamente removido: voc√™ armazena dados onde eles s√£o determinados logicamente. </p><br><p>  Aqui, novamente, n√£o se pode deixar de notar a desvantagem do Editor: nele voc√™ deve salvar todos os dados em um √∫nico reposit√≥rio central.  At√© os dados que podem ser solicitados e usados ‚Äã‚Äãpor apenas um componente separado ou sua sub√°rvore!  Se escrev√™ssemos no "estilo editorial", tamb√©m levar√≠amos o carregamento e a pagina√ß√£o de mercadorias para o n√≠vel global (para ser justo - essa abordagem, gra√ßas √† flexibilidade do srr, tamb√©m √© poss√≠vel e tem direito √† vida, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo fonte</a> ). </p><br><p>  No entanto, isso n√£o √© necess√°rio.  As mercadorias carregadas s√£o usadas apenas no componente de mercadorias, portanto, levando-as ao n√≠vel global, apenas entupimos e inflamos o estado global.  Al√©m disso, teremos que limpar dados desatualizados (por exemplo, uma p√°gina de pagina√ß√£o) quando o usu√°rio retornar √† p√°gina do produto novamente.  Escolhendo o n√≠vel certo de armazenamento de dados, evitamos automaticamente esses problemas. </p><br><p>  Outra vantagem dessa abordagem √© que a l√≥gica do aplicativo √© combinada com a apresenta√ß√£o, o que nos permite reutilizar componentes individuais do React como widgets totalmente funcionais, em vez de modelos "burros".  Al√©m disso, mantendo um m√≠nimo de informa√ß√µes em n√≠vel global (idealmente, s√£o apenas dados da sess√£o) e retirando a maior parte da l√≥gica em componentes de p√°gina separados, reduzimos bastante a coer√™ncia do c√≥digo.  Obviamente, essa abordagem nem sempre √© aplic√°vel, mas h√° um grande n√∫mero de tarefas em que o estado global √© extremamente pequeno e as ‚Äútelas‚Äù individuais s√£o quase completamente independentes uma da outra: por exemplo, v√°rios tipos de administradores, etc.  Ao contr√°rio do Editor, que nos leva a levar tudo o que √© necess√°rio e n√£o necess√°rio para o n√≠vel global, o srr permite armazenar dados em sub√°rvores separadas, incentivando e possibilitando o encapsulamento, de modo que nosso aplicativo passa de um "bolo" monol√≠tico para um "bolo" em camadas. </p><br><p>  Vale ressaltar: √© claro que n√£o h√° nada de novo e revolucion√°rio na abordagem proposta!  Componentes, widgets independentes, t√™m sido uma das abordagens b√°sicas usadas desde o advento das estruturas js.  A √∫nica diferen√ßa significativa √© que o srr segue o princ√≠pio declarativo: os componentes s√≥ podem ouvir os fluxos de outros componentes, mas n√£o podem influenci√°-los (o que √© necess√°rio fazer a partir da dire√ß√£o de baixo para cima ou da dire√ß√£o de cima para baixo, que difere do fluxo abordagem).  Componentes inteligentes que s√≥ podem trocar mensagens com os componentes subjacente e pai correspondem ao modelo de ator popular, por√©m pouco conhecido, no desenvolvimento do front-end (o t√≥pico sobre o uso de atores e encadeamentos no front-end √© bem abordado no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Introdu√ß√£o √† programa√ß√£o reativa</a> ). <br>  Obviamente, isso est√° longe de ser a implementa√ß√£o can√¥nica dos atores, mas a ess√™ncia √© exatamente isso: o papel dos atores √© desempenhado pelos componentes que trocam mensagens atrav√©s dos fluxos MPP;  um componente pode (declarativamente!) criar e excluir atores componentes filhos, gra√ßas ao DOM virtual e React: a fun√ß√£o render, em ess√™ncia, determina a estrutura dos atores filhos. </p><br><p>  Em vez da situa√ß√£o padr√£o para o React, quando "soltamos" o componente pai em um determinado retorno de chamada por meio de adere√ßos, devemos ouvir o fluxo do componente filho do pai.  A mesma coisa est√° na dire√ß√£o oposta, de pai para filho.  Por exemplo, voc√™ pode perguntar: por que transferir os dados do carrinho de compras para o componente Carrinho como um fluxo, se podemos, sem mais delongas, simplesmente pass√°-los como acess√≥rios?  Qual a diferen√ßa?  De fato, essa abordagem tamb√©m pode ser usada, mas apenas at√© que haja uma necessidade de responder a altera√ß√µes nos adere√ßos.  Se voc√™ j√° usou o m√©todo componentWillReceiveProps, sabe do que se trata.  Esse √© um tipo de "reatividade para os pobres": voc√™ ouve absolutamente todas as altera√ß√µes de adere√ßos, determina o que mudou e reage.  Mas esse m√©todo logo desaparecer√° do React, e a necessidade de uma rea√ß√£o aos "sinais de cima" pode surgir. </p><br><p>  Em mrr, os fluxos ‚Äúfluem‚Äù n√£o apenas para cima, mas tamb√©m para baixo na hierarquia de componentes, para que os componentes possam responder independentemente √†s mudan√ßas de estado.  Ao fazer isso, voc√™ pode usar todo o poder das ferramentas reativas de mrr. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Cart = withMrr({ <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">items</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">// -  }, 'cart'], }, (state, props, $) =&gt; { ... })</span></span></code> </pre> <br><h3 id="dobavlyaem-nemnozhko-byurokratii">  Adicione um pouco de burocracia </h3><br><p>  O projeto est√° crescendo, fica dif√≠cil acompanhar os nomes dos fluxos, que s√£o - ah, horror!  - s√£o armazenados em linhas.  Bem, podemos usar constantes para nomes de fluxos, bem como para instru√ß√µes mrr.  Agora, a quebra de um aplicativo com pequenos erros de digita√ß√£o se torna mais dif√≠cil. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { merge, toggle, promise } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/operators'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { cell, nested, $start$, passive } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/cell'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> goods$ = cell(<span class="hljs-string"><span class="hljs-string">'goods'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> page$ = cell(<span class="hljs-string"><span class="hljs-string">'page'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> totalPages$ = cell(<span class="hljs-string"><span class="hljs-string">'totalPages'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> category$ = cell(<span class="hljs-string"><span class="hljs-string">'category'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> errorShown$ = cell(<span class="hljs-string"><span class="hljs-string">'errorShown'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addToCart$ = cell(<span class="hljs-string"><span class="hljs-string">'addToCart'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> removeFromCart$ = cell(<span class="hljs-string"><span class="hljs-string">'removeFromCart'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectCategory$ = cell(<span class="hljs-string"><span class="hljs-string">'selectCategory'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> goToPage$ = cell(<span class="hljs-string"><span class="hljs-string">'goToPage'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr({ <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { [goods$]: [], [page$]: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, [goods$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.data, requestGoods$.success], [requestGoods$]: promise(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">page, category</span></span></span><span class="hljs-function">) =&gt;</span></span> fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()), page$, category$, $start$), [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, totalPages$, passive(page$)]), [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [category$]: selectCategory$, [errorShown$]: toggle(requestGoods$.error, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> setTimeout(res, <span class="hljs-number"><span class="hljs-number">1000</span></span>)), requestGoods$.error]), }, ...);</code> </pre><br><h3 id="chto-v-chernom-yaschike">  O que h√° na caixa preta? </h3><br><p>  E quanto a testes?  A l√≥gica descrita no componente mrr √© f√°cil de separar do modelo e depois testar. </p><br><p>  Vamos criar a estrutura do srr separadamente do nosso arquivo. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GoodsStruct = { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { [goods$]: [], [page$]: <span class="hljs-number"><span class="hljs-number">1</span></span>, }, ... } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Goods = withMrr(GoodsStruct, (state, props, $) =&gt; { ... }); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> { GoodsStruct }</code> </pre><br><p>  e depois a importamos em nossos testes.  Com um inv√≥lucro simples, podemos <br>  coloque o valor no fluxo (como se tivesse sido feito no DOM) e verifique os valores de outros segmentos dependentes dele. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { simpleWrapper} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { GoodsStruct } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../src/components/Goods'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'Testing Goods component'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'should update page if it\'s out of limit '</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = simpleWrapper(GoodsStruct); a.set(<span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">10</span></span>); a.set(<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>}); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>); a.set(<span class="hljs-string"><span class="hljs-string">'requestGoods.success'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">data</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">total</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>}); assert.equal(a.get(<span class="hljs-string"><span class="hljs-string">'page'</span></span>), <span class="hljs-number"><span class="hljs-number">5</span></span>); }) })</code> </pre> <br><h3 id="blesk-i-nischeta-reaktivnosti">  Brilho e pobreza de reatividade </h3><br><p>  Vale ressaltar que a reatividade √© uma abstra√ß√£o de um n√≠vel mais alto em compara√ß√£o com a forma√ß√£o ‚Äúmanual‚Äù de um estado com base em eventos no Editor.  Facilitar o desenvolvimento, por um lado, cria oportunidades para dar um tiro no pr√≥prio p√©.  Considere este cen√°rio: o usu√°rio acessa a p√°gina n√∫mero 5 e depois muda o filtro "categoria".  √â necess√°rio carregar a lista de produtos da categoria selecionada na quinta p√°gina, mas pode ser que os produtos dessa categoria tenham apenas tr√™s p√°ginas.  No caso do back-end "est√∫pido", o algoritmo de nossas a√ß√µes √© o seguinte: </p><br><ul><li>  p√°gina de dados da solicita√ß√£o = 5 &amp; category =% category% </li><li>  retire da resposta o valor do n√∫mero de p√°ginas </li><li>  se retornou um n√∫mero zero de registros, solicite a maior p√°gina dispon√≠vel </li></ul><br><p>  Se implement√°ssemos isso no Editor, ter√≠amos que criar uma grande a√ß√£o ass√≠ncrona com a l√≥gica descrita.  No caso de reatividade em mrr, n√£o h√° necessidade de descrever esse cen√°rio separadamente.  Tudo j√° est√° contido nestas linhas: </p><br><pre> <code class="javascript hljs"> [requestGoods$]: [<span class="hljs-string"><span class="hljs-string">'nested'</span></span>, (cb, page, category) =&gt; { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, page$, category$, $start$], [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : prev, totalPages$, passive(page$)]),</code> </pre> <br><p>  Se o novo valor totalPages for menor que a p√°gina atual, atualizaremos o valor da p√°gina e, assim, iniciaremos uma segunda solicita√ß√£o para o servidor. <br>  Por√©m, se nossa fun√ß√£o retornar o mesmo valor, ainda ser√° percebida como uma altera√ß√£o no fluxo de p√°ginas, seguida pela reculca√ß√£o de todos os fluxos dependentes.  Para evitar isso, o sr. Tem um significado especial - pular.  Retornando, sinalizamos: nenhuma altera√ß√£o ocorreu, nada precisa ser atualizado. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { withMrr, skip } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr'</span></span>; [requestGoods$]: nested(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb, page, category</span></span></span><span class="hljs-function">) =&gt;</span></span> { fetch(<span class="hljs-string"><span class="hljs-string">'https://reqres.in/api/products?page='</span></span>, page).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">r</span></span></span><span class="hljs-function"> =&gt;</span></span> r.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'success'</span></span>, res)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function"> =&gt;</span></span> cb(<span class="hljs-string"><span class="hljs-string">'error'</span></span>, e)) }, page$, category$, $start$), [totalPages$]: [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> res.total, requestGoods$.success], [page$]: merge(goToPage$, [<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, prev</span></span></span><span class="hljs-function">) =&gt;</span></span> a &lt; prev ? a : skip, totalPages$, passive(page$)]),</code> </pre> <br><p>  Assim, um pequeno erro pode nos levar a um loop infinito: se retornarmos n√£o "pular", mas "prev", a c√©lula da p√°gina mudar√° e uma segunda solicita√ß√£o ocorrer√°, e assim por diante em um c√≠rculo.  A pr√≥pria possibilidade de tal situa√ß√£o, √© claro, n√£o √© uma ‚Äúdesvantagem defeituosa‚Äù do FRP ou mrr, pois a possibilidade de recurs√£o infinita ou um loop n√£o indica as id√©ias defeituosas da programa√ß√£o estrutural.  No entanto, deve-se entender que o srr ainda requer alguma compreens√£o do mecanismo de reatividade.  Voltando √† conhecida met√°fora das facas, o sr. √â uma faca muito afiada que melhora a efici√™ncia do trabalho, mas tamb√©m pode ferir um trabalhador inepto. </p><br><p>  A prop√≥sito, debitar mrr √© muito f√°cil sem instalar nenhuma extens√£o: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GoodsStruct = { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { ... }, <span class="hljs-attr"><span class="hljs-attr">$log</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, ... }</code> </pre> <br><p>  Basta adicionar $ log: true √† estrutura mrr e todas as altera√ß√µes nas c√©lulas ser√£o exibidas no console, para que voc√™ possa ver quais altera√ß√µes e como. </p><br><p>  Conceitos como escuta passiva ou o significado de pular n√£o s√£o ‚Äúmuletas‚Äù espec√≠ficas: eles expandem as possibilidades de reatividade para que ele possa descrever facilmente toda a l√≥gica do aplicativo sem recorrer a abordagens imperativas.  Mecanismos semelhantes est√£o, por exemplo, no Rx.js, mas sua interface √© menos conveniente.            : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mrr:  FRP  </a> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   .</a> </p><br><h3 id="itogi">  Sum√°rio </h3><br><ul><li>   FRP,     mrr          ,      </li><li>           :    ,         </li><li>     ,        ,            </li><li>         ,    ,         - (   - !) </li><li>            </li><li>  mrr : "  ,   !"            </li><li>      ,       </li><li>   ,          ,    (        ).     ! </li><li>     : ,   ,  ,    TMTOWTDI:          , -              . </li></ul><br><h3 id="ps">  PS </h3><br><p>        .  ,  mrr      ,    ,    : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> useMrr <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'mrr/hooks'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Foo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">props</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [state, $, connectAs] = useMrr(props, { <span class="hljs-attr"><span class="hljs-attr">$init</span></span>: { <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, }, <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: [<span class="hljs-string"><span class="hljs-string">'merge'</span></span>, [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'-counter'</span></span>, <span class="hljs-string"><span class="hljs-string">'incr'</span></span>], [<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function"> =&gt;</span></span> a - <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'-counter'</span></span>, <span class="hljs-string"><span class="hljs-string">'decr'</span></span>] ], }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Counter: { state.counter } </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> $('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">incr</span></span></span></span><span class="xml"><span class="hljs-tag">') }&gt;</span></span></span><span class="xml">increment</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{</span></span></span></span><span class="xml"><span class="hljs-tag"> $('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">decr</span></span></span></span><span class="xml"><span class="hljs-tag">') }&gt;</span></span></span><span class="xml">decrement</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Bar</span></span></span></span><span class="xml"><span class="hljs-tag"> {</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">...connectAs</span></span></span></span><span class="xml"><span class="hljs-tag">('</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">bar</span></span></span></span><span class="xml"><span class="hljs-tag">')} /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt438112/">https://habr.com/ru/post/pt438112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt438100/index.html">Para onde v√£o os dados: 12 ataques, hacks e vazamentos</a></li>
<li><a href="../pt438104/index.html">N√£o √© uma blockchain</a></li>
<li><a href="../pt438106/index.html">Piscando com LEDs antigos ou quando avisamos sobre ‚Äúinc√™ndios‚Äù no projeto</a></li>
<li><a href="../pt438108/index.html">SEO e contexto: o que escolher e se deve escolher?</a></li>
<li><a href="../pt438110/index.html">Rails + Postgres + liga√ß√µes</a></li>
<li><a href="../pt438116/index.html">An√°lise de impacto ambiental da m√≠dia musical: m√∫sica digital, grava√ß√µes anal√≥gicas e CDs</a></li>
<li><a href="../pt438118/index.html">O Dex-Net 4.0 permite que os rob√¥s Ambidextro escolham o melhor</a></li>
<li><a href="../pt438120/index.html">Resumo de eventos para profissionais de RH na √°rea de TI em fevereiro de 2019</a></li>
<li><a href="../pt438122/index.html">Numerologia no MS SQL - um experimento divertido</a></li>
<li><a href="../pt438124/index.html">Piter GraphQL: v√≠deos de mitap no Wrike</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>