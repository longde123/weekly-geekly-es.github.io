<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈹 💅🏾 👩🏻‍🚀 Éclaboussures de texture de terrain avancées 👩🏻‍🤝‍👨🏾 😗 🧛🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, j'expliquerai un algorithme de répartition de texture qui vous permet de créer un terrain plus naturel. Cet algorithme peut être uti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Éclaboussures de texture de terrain avancées</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442924/"><p><img src="https://habrastorage.org/storage2/b6f/b62/881/b6fb628815315bfeff081eaa87005316.png" alt="image"></p><br><p>  Dans cet article, j'expliquerai un algorithme de répartition de texture qui vous permet de créer un terrain plus naturel.  Cet algorithme peut être utilisé dans les shaders de jeux 3D ainsi que dans les jeux 2D. </p><a name="habracut"></a><br><p>  L'un des moyens les plus courants de texturer le terrain consiste à mélanger plusieurs couches de tuiles.  Chaque couche a une carte d'opacité qui définit l'étendue de la présence de texture sur le terrain.  La méthode fonctionne en appliquant une carte d'opacité aux niveaux supérieurs, révélant les couches sous lesquelles la carte d'opacité est partiellement ou complètement transparente.  La carte d'opacité est mesurée en pourcentage.  Bien sûr, sur chaque point d'un terrain, la somme des opacités de toutes les couches fait cent pour cent car le terrain ne peut pas être transparent.  Au lieu de textures de tuiles, la carte d'opacité s'étend entièrement sur tous les terrains et a donc un niveau de détail assez faible. </p><br><p> Passons maintenant à la partie la plus intéressante - les algorithmes de mélange de textures.  Pour plus de simplicité et d'évidence, notre terrain sera composé de sable et de gros pavés. </p><br><p><img src="https://habrastorage.org/storage2/5b0/c19/132/5b0c191329d7745ed66ac379e9c9ac33.jpg" alt="image"></p><br><p>  Le moyen le plus simple de mélanger consiste à multiplier la couleur de la texture par l'opacité, puis à additionner les résultats. </p><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.rgb * a1 + texture2.rgb * a2; }</code> </pre> <br><p>  Une telle technique est utilisée dans Unity3D dans l'éditeur de terrain standard.  Comme vous pouvez le voir, la transition est douce mais non naturelle.  Les pierres semblent souillées uniformément par le sable, mais dans le monde réel, cela ne se passe pas comme ça.  Le sable ne colle pas aux pierres, au lieu de cela, il tombe et remplit les fissures entre elles, laissant le sommet des pierres pur. </p><br><p>  Essayons de simuler ce comportement dans les tracés Excel.  Comme nous voulons que le sable soit «tombé» entre les pavés, nous avons besoin pour chaque texture de la carte de profondeur.  Dans cet exemple, nous considérons que la carte de profondeur est générée à partir d'une image en niveaux de gris et stockée dans le canal alpha d'une texture.  Dans Unity3D, cela peut être fait dans l'inspecteur de texture en définissant le drapeau "Alpha From Grayscale". </p><br><p>  Tout d'abord, nous considérerons le modèle simplifié de carte en profondeur du sable et des pierres. </p><br><p><img src="https://habrastorage.org/storage2/af1/c47/aa1/af1c47aa1f596fcba486980109cd05d7.png" alt="image"></p><br><p>  La ligne bleue sur l'intrigue symbolise la carte de profondeur du sable et le rouge est des galets.  Notez que les sommets des pierres se trouvent plus haut que le niveau du sable.  Compte tenu de ce fait, nous allons essayer de dessiner des pixels de cette texture qui est au-dessus. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.a &gt; texture2.a ? texture1.rgb : texture2.rgb; }</code> </pre> <br><p><img src="https://habrastorage.org/storage2/4cd/945/25e/4cd94525e9b523807684c68092d42cc0.jpg" alt="image"></p><br><p>  Excellent!  Les sommets de pavés restent purs tandis que le sable se trouve entre les fissures.  Mais nous n'avons pas encore considéré l'opacité des calques.  Pour l'utiliser, nous additionnons simplement la carte de profondeur-profondeur et la carte d'opacité. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> texture1.a + a1 &gt; texture2.a + a2 ? texture1.rgb : texture2.rgb; }</code> </pre> <br><p>  Au détriment de la sommation, une texture moins transparente sera plus élevée que d'habitude. </p><br><p><img src="https://habrastorage.org/storage2/2cf/8e7/7b9/2cf8e77b9022d75336888982f6b7306a.png" alt="image"></p><br><p><img src="https://habrastorage.org/storage2/a67/e3f/e07/a67e3fe07d4a7cf50fe6e9c847288c62.jpg" alt="image"></p><br><p>  Nous avons donc une transition plus naturelle du sable aux pierres.  Comme vous pouvez le voir, des grains de sable commencent à remplir les fissures entre les pavés, les cachant progressivement.  Mais au fur et à mesure des calculs, pixel par pixel, des artefacts commencent à apparaître à la frontière entre les textures.  Pour obtenir un résultat fluide, nous prendrons plusieurs pixels en profondeur au lieu d'un et les mélangerons. </p><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">float3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">blend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(float4 texture1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a1, float4 texture2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> depth = <span class="hljs-number"><span class="hljs-number">0.2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ma = max(texture1.a + a1, texture2.a + a2) - depth; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b1 = max(texture1.a + a1 - ma, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b2 = max(texture2.a + a2 - ma, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (texture1.rgb * b1 + texture2.rgb * b2) / (b1 + b2); }</code> </pre> <br><p>  Dans le code ci-dessus, nous obtenons d'abord une partie d'un sol vu à une certaine profondeur. </p><br><p><img src="https://habrastorage.org/storage2/647/ecf/d8f/647ecfd8f18aa92a5a204caf7727870d.png" alt="image"></p><br><p>  Et puis nous le normalisons pour obtenir de nouvelles opacités. </p><br><p><img src="https://habrastorage.org/storage2/f27/9a6/7c1/f279a67c188a58864db4536a68642529.png" alt="image"></p><br><p><img src="https://habrastorage.org/storage2/6cf/9fd/03c/6cf9fd03c46bbe439fdc38eeedfc5335.jpg" alt="image"></p><br><p>  En conséquence, nous avons trouvé l'algorithme de mélange de textures, ce qui nous permet d'atteindre près d'une image de terrain naturel. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442924/">https://habr.com/ru/post/fr442924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442914/index.html">Battle royale: concevez les secrets du genre de jeu le plus populaire</a></li>
<li><a href="../fr442916/index.html">Les stations de radio FM piratées sont-elles pertinentes aujourd'hui?</a></li>
<li><a href="../fr442918/index.html">Guide de déploiement de modèles d'apprentissage automatique dans un environnement de production en tant qu'API à l'aide de Flask</a></li>
<li><a href="../fr442920/index.html">Coroutines :: expérience pratique</a></li>
<li><a href="../fr442922/index.html">Mission lunaire "Bereshit" - caractéristiques de l'appareil, une série de manœuvres et le plus long chemin vers la lune</a></li>
<li><a href="../fr442926/index.html">"Souris de souris" dans la lumière infrarouge: l'introduction de nanoparticules dans la région sous-rétinienne de l'œil de la souris</a></li>
<li><a href="../fr442928/index.html">Écrire un code flexible à l'aide de SOLID</a></li>
<li><a href="../fr442934/index.html">Comment embaucher des gens dans une grande entreprise avec une pile impopulaire. Conversation avec Wrike</a></li>
<li><a href="../fr442936/index.html">C'est un must: la technologie 3D a aidé à créer des lunettes intelligentes pour les ingénieurs</a></li>
<li><a href="../fr442938/index.html">Travail à distance avec un employeur sain (?)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>