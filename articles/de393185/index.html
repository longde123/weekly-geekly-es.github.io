<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏻 🙆🏻 🧑🏿‍🤝‍🧑🏾 Neues nooLite MR1132 Empfängermodul für Arduino ☝🏾 🧝🏿 🚵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In diesem Artikel wird das neue nooLite-Signalempfängermodul für Arduino und Mikrocontroller erläutert. Was ist an diesem Modul bemerkenswert? Bisher ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Neues nooLite MR1132 Empfängermodul für Arduino</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393185/"><img src="https://habrastorage.org/files/24c/ab6/dab/24cab6dab74e4e778cd238d261be0b69.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel wird das neue nooLite-Signalempfängermodul für Arduino und Mikrocontroller erläutert. Was ist an diesem Modul bemerkenswert? Bisher gab es keine Möglichkeit, Informationen von Sensoren zu empfangen und die Übertragung von Signalen von den Fernbedienungen des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nooLite-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Systems </font><font style="vertical-align: inherit;">auf Mikrocontrollern und Arduino </font><font style="vertical-align: inherit;">zu steuern. </font><font style="vertical-align: inherit;">Diese Möglichkeit bestand nur für Computer, die spezielle USB-Adapter verwenden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit der Veröffentlichung des MR1132-Moduls ist es jetzt möglich, Daten zu Temperatur, Luftfeuchtigkeit, Beleuchtung und Anwesenheit von Personen im Raum von den drahtlosen Sensoren des nooLite-Systems in Ihren Skizzen auf Arduino zu empfangen, die Möglichkeit, Befehle zu verfolgen, die über Fernbedienungsschalter an nooLite-Netzteile ausgegeben wurden, und vieles mehr das war vorher nicht verfügbar.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Artikel werde ich Sie über die Funktionsweise dieses Moduls informieren und eine Arbeitsskizze geben, auf deren Grundlage Sie Ihre Geräte einfach auf dem MR1132 erstellen können. </font><font style="vertical-align: inherit;">In den folgenden Artikeln werde ich über die Integration dieses Moduls in das beliebte </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server-System</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und über die wunderbaren Funktionen </font><font style="vertical-align: inherit;">sprechen </font><font style="vertical-align: inherit;">, die im Zusammenhang mit dieser Integration auftreten werden.</font></font><br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Modul</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das MR1132-Modul ist seinem Bruder, dem MT1132-Modul, sehr ähnlich (über das es bereits einen Artikelzyklus </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zu</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> den Gimetays </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">eins</font></a><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zwei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">drei gegeben hat</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Der Unterschied besteht darin, dass das MT1132-Modul ein Sender und das MR1132-Modul ein Empfänger ist und der größte Effekt erzielt werden kann, wenn sie zusammen verwendet werden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein weiterer wichtiger Punkt ist, dass der MT1132-Sender universell ist und sowohl mit 3,3 V als auch mit 5 V (dh mit 3,3-Volt-Controllern und mit 5 Volt) und dem Empfänger arbeitet nur ab 5 V. Dies muss beim Entwurf Ihrer Geräte berücksichtigt werden und ggf. logische Ebenenkoordinatoren verwenden.</font></font><br>
<br>
<img src="https://habrastorage.org/files/36e/50c/816/36e50c816d1b4859b7a56eb2ae4f4996.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Anschluss ist so einfach wie beim MT1132-Modul - Versorgungsspannung, Masse und zwei Kontakte RX und TX. </font><font style="vertical-align: inherit;">RTS kann auf die Versorgungsspannung hochgezogen werden, aber alles hat bei mir funktioniert, auch ohne diesen Ausgang anzuschließen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Modul arbeitet über eine serielle Schnittstelle mit einer Geschwindigkeit von 9600. Das Modul empfängt Befehle von der Steuerung und gibt wiederum Daten aus der Luft aus (von Sensoren und nooLite-Fernbedienungen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Schauen wir uns diesen Punkt genauer an, damit Sie ein klares Verständnis für die Funktionsweise dieses Moduls haben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alle Befehle, die der Controller über die serielle Schnittstelle an das Modul senden kann, beziehen sich auf das „Binden“ oder „Lösen“ von nooLite-Geräten, von denen das Modul dann Daten empfängt. Für dieses Modul sind keine Steuerbefehle mehr vorhanden. Sie haben beispielsweise den Temperatursensor nooLite PT112 an den Nullkanal gebunden (insgesamt 32 Kanäle, was sich im Modulnamen widerspiegelt). Danach empfängt das Modul Daten von diesem Sensor und gibt sie an die serielle Schnittstelle aus (wo unsere Aufgabe darin besteht, sie zu „fangen“ und für unsere zu verwenden Ziele). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir keine Daten mehr von einem Sensor empfangen müssen, können wir einen Entkopplungsbefehl senden (in diesem Fall auf Kanal Null), und der Empfänger gibt dem Controller keine Informationen mehr von diesem Sensor.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für die Informationen, die das MR1132-Modul von nooLite-Geräten empfängt, gibt es ein separates </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dokument</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , das das Format aller möglichen Befehle beschreibt. </font><font style="vertical-align: inherit;">Wir werden uns im Rahmen dieser Erzählung aus dieser umfangreichen Liste für die Teams von Temperatur-, Feuchtigkeits- und Bewegungssensoren interessieren. </font><font style="vertical-align: inherit;">Diese Befehle werden im Folgenden anhand der Skizze als Beispiel ausführlich erläutert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensoren</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In unseren Experimenten werden drei Sensoren verwendet. </font></font><br>
<br>
<img src="https://habrastorage.org/files/3f9/ca8/0d4/3f9ca80d49e04e228406018485a56439.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Temperatursensor PT112 und Temperatur- und Feuchtigkeitssensor PT111. </font><font style="vertical-align: inherit;">Sie sehen gleich aus und arbeiten genauso, der Unterschied besteht darin, dass PT112 nur Informationen über die Temperatur und PT111 Informationen über Temperatur und Luftfeuchtigkeit liefert. </font><font style="vertical-align: inherit;">Diese Sensoren können entweder in einem einfachen Sensormodus oder in einem Thermostat- und Hygrostat-Modus arbeiten, aber wir werden an einem einfachen Sensormodus interessiert sein. </font></font><br>
<br>
<img src="https://habrastorage.org/files/faa/396/a15/faa396a152b5477b9bdfd91d722c9ca3.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der dritte Sensor ist PM111. </font><font style="vertical-align: inherit;">Dies ist ein Bewegungssensor, der nooLite-Aggregate direkt steuern kann. Wir sind jedoch nur an uns als Informationsquelle über die Bewegung und Anwesenheit von Personen im Raum interessiert.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controller</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Arduino Mega 2560 wird als Steuerungscontroller und seine zwei seriellen Schnittstellen verwendet - Seriell (zur visuellen Informationssteuerung) Seriell2 (zur Kommunikation mit dem Empfängermodul). </font><font style="vertical-align: inherit;">Serial1 ist für das Sendermodul MT1132 reserviert.</font></font><br>
<br>
<img src="https://habrastorage.org/files/464/661/a69/464661a69db6436da29c14c265c92996.jpg" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skizze</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Abschnitt setup () werden zwei Schnittstellen gestartet, eine Informationsmeldung zum Start der Skizze angezeigt und ein Befehl zum Binden der nooLite-Geräte an den Nullkanal ausgegeben. </font><font style="vertical-align: inherit;">Dies ist ein Testbefehl, und Sie können ihn auskommentieren oder durch einen anderen Befehl ersetzen (z. B. Bindungen auf einem anderen Kanal oder Aufheben der Bindung).</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  Serial2.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  Serial.println(<span class="hljs-string"><span class="hljs-string">"*** Start sketch ***"</span></span>);<font></font>
  mrBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);
  <span class="hljs-comment"><span class="hljs-comment">//mrUnbind(0);</span></span><font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bevor Sie mit einer Skizze arbeiten, müssen Sie einige vorbereitende Schritte ausführen, nämlich Ihre Sensoren wie folgt an das Modul binden: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT112</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Kanal Null </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PT111</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Kanal Eins </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PM111</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Kanal Zwei </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dazu müssen Sie die Skizze dreimal ausführen und den Bindungsbefehl ändern</font></font><br>
<br>
<pre><code class="java hljs">mrBind(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
mrBind(<span class="hljs-number"><span class="hljs-number">1</span></span>);<font></font>
mrBind(<span class="hljs-number"><span class="hljs-number">2</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
und jedes Mal die Taste am entsprechenden Sensor drücken. </font><font style="vertical-align: inherit;">Dies muss nur einmal durchgeführt werden, dann kann der Bindungsbefehl auskommentiert werden. </font><font style="vertical-align: inherit;">Oder setzen Sie stattdessen den Befehl zum Auflösen und lösen Sie einen der angeschlossenen Sensoren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Abschnitt loop () gibt es nur eine mrCheck () -Funktion, die für das "Abfangen" von Nachrichten vom MR1132-Modul von der seriellen Schnittstelle Serial2 verantwortlich ist.</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mrCheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Serial2.available() == <span class="hljs-number"><span class="hljs-number">8</span></span>) {<font></font>
    mrBuf[<span class="hljs-number"><span class="hljs-number">0</span></span>] = Serial2.read();<font></font>
    mrBuf[<span class="hljs-number"><span class="hljs-number">1</span></span>] = Serial2.read();<font></font>
    mrBuf[<span class="hljs-number"><span class="hljs-number">2</span></span>] = Serial2.read();<font></font>
    mrBuf[<span class="hljs-number"><span class="hljs-number">3</span></span>] = Serial2.read();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mrBuf[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">79</span></span> &amp;&amp; mrBuf[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">75</span></span> &amp;&amp; mrBuf[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">13</span></span> &amp;&amp; mrBuf[<span class="hljs-number"><span class="hljs-number">3</span></span>] == <span class="hljs-number"><span class="hljs-number">10</span></span>) {<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"OK"</span></span>);<font></font>
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
        mrBuf[<span class="hljs-number"><span class="hljs-number">4</span></span>] = Serial2.read();<font></font>
        mrBuf[<span class="hljs-number"><span class="hljs-number">5</span></span>] = Serial2.read();<font></font>
        mrBuf[<span class="hljs-number"><span class="hljs-number">6</span></span>] = Serial2.read();<font></font>
        mrBuf[<span class="hljs-number"><span class="hljs-number">7</span></span>] = Serial2.read();<font></font>
        mrNewData();<font></font>
      }<font></font>
  }<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Diese Funktion füllt das Array mrBuf [8] mit Daten, die vom Modul stammen, oder sendet sie an die vom MR1132-Modul ausgegebene serielle Nachricht „OK“. Ferner wird der Inhalt des Arrays mrBuf [8] gemäß dem Datenformat der nooLite-Systembefehle analysiert, und die entsprechenden Skizzenfunktionen sind daran beteiligt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Funktion mrNewData () extrahiert die Hauptdaten aus dem mrBuf-Array [8] und gibt abhängig vom eingehenden Befehl die erforderlichen Informationen an Serial aus (Kanal, Befehl, Temperatur, Luftfeuchtigkeit, Sensorbatteriestatus usw.).</font></font><br>
<br>
<pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mrNewData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  mrClearData();<font></font>
  mrPrintHeader();<font></font>
  <font></font>
  mrSetBindState();<font></font>
  mrPrintBindState();<font></font>
  mrSetChannel();<font></font>
  mrPrintChannel();<font></font>
<font></font>
  mrSetCommand();<font></font>
  mrSetDatas();<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (mrCommand) {
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>:<font></font>
      Serial.print(<span class="hljs-string"><span class="hljs-string">"PIR command: "</span></span>);Serial.println(<span class="hljs-string"><span class="hljs-string">"OFF"</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>:<font></font>
      Serial.print(<span class="hljs-string"><span class="hljs-string">"PIR command: "</span></span>); Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<font></font>
      mrSetDeviceType();<font></font>
      mrPrintDeviceType();<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mrDeviceType == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
        mrSetTemperature();<font></font>
        mrPrintTemperature();<font></font>
      }<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mrDeviceType == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
        mrSetTemperature();<font></font>
        mrPrintTemperature();<font></font>
        mrSetHumidity();<font></font>
        mrPrintHumidity();<font></font>
      }<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <font></font>
      ;<font></font>
  } <span class="hljs-comment"><span class="hljs-comment">// switch</span></span><font></font>
  mrSetBatteryState();<font></font>
} <span class="hljs-comment"><span class="hljs-comment">// newData()</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Funktionen, deren Name das Wort Drucken enthält, geben Informationen zur visuellen Steuerung an die serielle Schnittstelle aus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die folgenden Funktionen entschlüsseln die Daten im mrBuf-Array [8] gemäß dem Datenformat der Befehle des nooLite-Systems: </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetTogl ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Wert des Zählers der eingehenden Befehle </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetBindState ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Modulstatus (Bindung / Norm) </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetReceiveBit ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Empfangsbit steuern neuer Befehl </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetChannel ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Kanalnummer </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetCommand ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Befehl </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetFormat ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Datenformat </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetDeviceType ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Sensortyp </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetDatas ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Füllen Sie vier Datenbytes </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mrSetTemperature ()</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen des</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Temperaturwerts </font><strong><font style="vertical-align: inherit;">mrSetHumidity ()</font></strong><font style="vertical-align: inherit;"> - </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen des</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Feuchtigkeitswerts </font><strong><font style="vertical-align: inherit;">mrSetBrightness ()</font></strong><font style="vertical-align: inherit;"> - </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Abrufen des</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beleuchtungswerts </font><strong><font style="vertical-align: inherit;">mrSetBatteryState ()</font></strong><font style="vertical-align: inherit;"> - Status der </font><strong><font style="vertical-align: inherit;">Sensorbatterie</font></strong></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Einzelheiten zur Implementierung dieser Funktionen finden Sie im vollständigen Skizzencode unten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist die vollständige Skizze.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vollständiger Skizzencode</font></font></b><div class="spoiler_text">// TX2 16<br>
// RX2 17<br>
// TX1 18<br>
// RX1 19<br>
<br>
// nooLite MR1132 data<br>
byte mrBuf[8];<br>
int mrTogl = -1;<br>
int mrBindState = -1;<br>
int mrReceiveBit = -1;<br>
int mrChannel = -1;<br>
int mrCommand = -1;<br>
int mrFormat = -1;<br>
int mrData0 = -1;<br>
int mrData1 = -1;<br>
int mrData2 = -1;<br>
int mrData3 = -1;<br>
int mrDeviceType = -1;<br>
int mrBatteryState = -1;<br>
int mrHumidity = -1;<br>
int mrBrightness = -1;<br>
float mrTemp = -1.0;<br>
<br>
// nooLite MR1132 bind/unbind<br>
<br>
void mrSerialChannel(byte ch) {<br>
 switch (ch) {<br>
 case 0: Serial.println («0»); break;<br>
 case 1: Serial.println («1»); break;<br>
 case 2: Serial.println («2»); break;<br>
 case 3: Serial.println («3»); break;<br>
 case 4: Serial.println («4»); break;<br>
 case 5: Serial.println («5»); break;<br>
 case 6: Serial.println («6»); break;<br>
 case 7: Serial.println («7»); break;<br>
 case 8: Serial.println («8»); break;<br>
 case 9: Serial.println («9»); break;<br>
 case 10: Serial.println(«10»); break;<br>
 case 11: Serial.println(«11»); break;<br>
 case 12: Serial.println(«12»); break;<br>
 case 13: Serial.println(«13»); break;<br>
 case 14: Serial.println(«14»); break;<br>
 case 15: Serial.println(«15»); break;<br>
 case 16: Serial.println(«16»); break;<br>
 case 17: Serial.println(«17»); break;<br>
 case 18: Serial.println(«18»); break;<br>
 case 19: Serial.println(«19»); break;<br>
 case 20: Serial.println(«20»); break;<br>
 case 21: Serial.println(«21»); break;<br>
 case 22: Serial.println(«22»); break;<br>
 case 23: Serial.println(«23»); break;<br>
 case 24: Serial.println(«24»); break;<br>
 case 25: Serial.println(«25»); break;<br>
 case 26: Serial.println(«26»); break;<br>
 case 27: Serial.println(«27»); break;<br>
 case 28: Serial.println(«28»); break;<br>
 case 29: Serial.println(«29»); break;<br>
 case 30: Serial.println(«30»); break;<br>
 case 31: Serial.println(«31»); break;<br>
 } // switch<br>
} // mrSerialChannel( )<br>
<br>
void mrSerial2Channel(byte ch) {<br>
 switch (ch) {<br>
 case 0: Serial2.print(«00»); break;<br>
 case 1: Serial2.print(«01»); break;<br>
 case 2: Serial2.print(«02»); break;<br>
 case 3: Serial2.print(«03»); break;<br>
 case 4: Serial2.print(«04»); break;<br>
 case 5: Serial2.print(«05»); break;<br>
 case 6: Serial2.print(«06»); break;<br>
 case 7: Serial2.print(«07»); break;<br>
 case 8: Serial2.print(«08»); break;<br>
 case 9: Serial2.print(«09»); break;<br>
 case 10: Serial2.print(«10»); break;<br>
 case 11: Serial2.print(«11»); break;<br>
 case 12: Serial2.print(«12»); break;<br>
 case 13: Serial2.print(«13»); break;<br>
 case 14: Serial2.print(«14»); break;<br>
 case 15: Serial2.print(«15»); break;<br>
 case 16: Serial2.print(«16»); break;<br>
 case 17: Serial2.print(«17»); break;<br>
 case 18: Serial2.print(«18»); break;<br>
 case 19: Serial2.print(«19»); break;<br>
 case 20: Serial2.print(«20»); break;<br>
 case 21: Serial2.print(«21»); break;<br>
 case 22: Serial2.print(«22»); break;<br>
 case 23: Serial2.print(«23»); break;<br>
 case 24: Serial2.print(«24»); break;<br>
 case 25: Serial2.print(«25»); break;<br>
 case 26: Serial2.print(«26»); break;<br>
 case 27: Serial2.print(«27»); break;<br>
 case 28: Serial2.print(«28»); break;<br>
 case 29: Serial2.print(«29»); break;<br>
 case 30: Serial2.print(«30»); break;<br>
 case 31: Serial2.print(«31»); break;<br>
 } // switch<br>
} // mrSerial2Channel( )<br>
<br>
void mrPrintBind(byte ch) {<br>
 Serial.print(«Bind on channel „);<br>
 mrSerialChannel(ch);<br>
}<br>
<br>
void mrBind(byte ch) {<br>
 mrPrintBind(ch);<br>
 Serial2.print(“bind_mode_cell_»);<br>
 mrSerial2Channel(ch);<br>
 Serial2.write(3); // End of Text — B00000011(BIN)<br>
}<br>
<br>
void mrPrintUnbind(byte ch) {<br>
 Serial.println(«Unbind on channel „);<br>
 mrSerialChannel(ch);<br>
}<br>
<br>
void mrUnbind(byte ch) {<br>
 mrPrintUnbind(ch);<br>
 Serial2.print(“clear_one_cell_»);<br>
 mrSerial2Channel(ch);<br>
 Serial2.write(3);<br>
}<br>
<br>
void mrBindStop() {<br>
 Serial.println(«Bind mode off»);<br>
 Serial2.print(«bind_mode_off»);<br>
 Serial2.write(3);<br>
}<br>
<br>
void mrClearAll() {<br>
 Serial.println(«Clear all cell»);<br>
 Serial2.print(«clear_all_cell»);<br>
 Serial2.write(3);<br>
}<br>
<br>
// nooLite MR1132 print works<br>
<br>
void mrPrintHeader() {<br>
 Serial.println();<br>
}<br>
<br>
void mrPrintDeviceType() {<br>
 Serial.print(«Device: „); <br>
 if (mrDeviceType == 1) {<br>
 Serial.println(“PT112»);<br>
 }<br>
 if (mrDeviceType == 2) {<br>
 Serial.println(«PT111»);<br>
 }<br>
}<br>
<br>
void mrPrintBindState() {<br>
 if (mrBindState == 1) {<br>
 Serial.print(«Bind State: „);<br>
 Serial.println(“ON»);<br>
 }<br>
}<br>
<br>
void mrPrintBatteryState() {<br>
 if (mrBatteryState == 1) {<br>
 Serial.print(«Battery State: „);<br>
 Serial.println(“LOW!»);<br>
 }<br>
}<br>
<br>
void mrPrintChannel() {<br>
 Serial.print(«Channel: „);<br>
 Serial.println(mrChannel);<br>
}<br>
<br>
void mrPrintTemperature() {<br>
 Serial.print(“Temp: „);<br>
 Serial.println(mrTemp);<br>
}<br>
<br>
void mrPrintHumidity() {<br>
 Serial.print(“Humidity: „);<br>
 Serial.println(mrHumidity);<br>
}<br>
<br>
// nooLite MR1132 data works<br>
<br>
void mrClearData() {<br>
 mrTogl = -1;<br>
 mrBindState = -1;<br>
 mrReceiveBit = -1;<br>
 mrChannel = -1;<br>
 mrCommand = -1;<br>
 mrFormat = -1;<br>
 mrData0 = -1;<br>
 mrData1 = -1;<br>
 mrData2 = -1;<br>
 mrData3 = -1;<br>
 mrDeviceType = -1;<br>
 mrBatteryState = -1;<br>
 mrHumidity = -1;<br>
 mrBrightness = -1;<br>
 mrTemp = -1.0;<br>
}<br>
<br>
void mrSetTogl() {<br>
 byte b0 = bitRead(mrBuf[0], 0);<br>
 byte b1 = bitRead(mrBuf[0], 1);<br>
 byte b2 = bitRead(mrBuf[0], 2);<br>
 byte b3 = bitRead(mrBuf[0], 3);<br>
 byte b4 = bitRead(mrBuf[0], 4);<br>
 byte b5 = bitRead(mrBuf[0], 5);<br>
 mrTogl = 32*b5 + 16*b4 + 8*b3 + 4*b2 + 2*b1 + b0;<br>
}<br>
<br>
void mrSetBindState() {<br>
 mrBindState = bitRead(mrBuf[0], 6);<br>
}<br>
<br>
void mrSetReceiveBit() {<br>
 mrReceiveBit = bitRead(mrBuf[0], 7);<br>
}<br>
<br>
void mrSetChannel() {<br>
 mrChannel = mrBuf[1];<br>
}<br>
<br>
void mrSetCommand() {<br>
 mrCommand = mrBuf[2];<br>
}<br>
<br>
void mrSetFormat() {<br>
 mrFormat = mrBuf[3];<br>
}<br>
<br>
void mrSetDeviceType() {<br>
 byte tp1 = bitRead(mrBuf[5], 4);<br>
 byte tp2 = bitRead(mrBuf[5], 5);<br>
 byte tp3 = bitRead(mrBuf[5], 6);<br>
 mrDeviceType = 4*tp3 + 2*tp2 + tp1;<br>
}<br>
<br>
void mrSetDatas() {<br>
 mrData0 = mrBuf[4];<br>
 mrData1 = mrBuf[5];<br>
 mrData2 = mrBuf[6];<br>
 mrData3 = mrBuf[7];<br>
}<br>
<br>
void mrSetTemperature() {<br>
 byte t8 = bitRead(mrData1, 0);<br>
 byte t9 = bitRead(mrData1, 1);<br>
 byte t10= bitRead(mrData1, 2);<br>
 int temp2 = 1024*t10 + 512*t9 + 256*t8;<br>
<br>
int temp = mrData0 + temp2;<br>
<br>
byte t11 = bitRead(mrData1, 3);<br>
 if (t11 == 1) {<br>
 temp = (4096 — temp) * -1;<br>
 }<br>
 mrTemp = (float)temp / 10.0;<br>
}<br>
<br>
void mrSetBatteryState() {<br>
 mrBatteryState = bitRead(mrBuf[5], 7);<br>
}<br>
<br>
void mrSetHumidity() {<br>
 mrHumidity = mrData2;<br>
}<br>
<br>
void mrSetBrightness() {<br>
 mrBrightness = mrData3;<br>
}<br>
<br>
void mrNewData() {<br>
 mrClearData();<br>
 mrPrintHeader();<br>
 <br>
 mrSetBindState();<br>
 mrPrintBindState();<br>
 mrSetChannel();<br>
 mrPrintChannel();<br>
<br>
mrSetCommand();<br>
 mrSetDatas();<br>
<br>
switch (mrCommand) {<br>
 case 0:<br>
 Serial.print(“PIR command: „); Serial.println(“OFF»);<br>
 break;<br>
 case 2:<br>
 Serial.print(«PIR command: „); Serial.println(“ON»);<br>
 break;<br>
 case 21:<br>
 mrSetDeviceType();<br>
 mrPrintDeviceType();<br>
 if (mrDeviceType == 1) {<br>
 mrSetTemperature();<br>
 mrPrintTemperature();<br>
 }<br>
 if (mrDeviceType == 2) {<br>
 mrSetTemperature();<br>
 mrPrintTemperature();<br>
 mrSetHumidity();<br>
 mrPrintHumidity();<br>
 }<br>
 break;<br>
 default: <br>
;<br>
 } // switch<br>
 mrSetBatteryState();<br>
} // newData()<br>
<br>
void mrCheck() {<br>
 if (Serial2.available() == 8) {<br>
 mrBuf[0] = Serial2.read();<br>
 mrBuf[1] = Serial2.read();<br>
 mrBuf[2] = Serial2.read();<br>
 mrBuf[3] = Serial2.read();<br>
 if (mrBuf[0] == 79 &amp;&amp; mrBuf[1] == 75 &amp;&amp; mrBuf[2] == 13 &amp;&amp; mrBuf[3] == 10) {<br>
 Serial.println(«OK»);<br>
 } else {<br>
 mrBuf[4] = Serial2.read();<br>
 mrBuf[5] = Serial2.read();<br>
 mrBuf[6] = Serial2.read();<br>
 mrBuf[7] = Serial2.read();<br>
 mrNewData();<br>
 }<br>
 }<br>
}<br>
<br>
void setup() {<br>
 Serial.begin(9600);<br>
 Serial2.begin(9600);<br>
 Serial.println("*** Start sketch ***");<br>
 mrBind(0);<br>
 //mrUnbind(0);<br>
}<br>
<br>
void loop() {<br>
 mrCheck();<br>
} // loop()<br>
<br>
</div></div><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das ist in der Tat alles, was Sie brauchen, um mit dem MR1132-Modul zu arbeiten und es in Ihren Skizzen und Projekten zu verwenden. </font><font style="vertical-align: inherit;">Dieses Modul kann auch zur Steuerung von Signalen von an der Wand montierten nooLite-Konsolen verwendet werden. Ihr System kann jetzt wissen, wo und welche Konsole funktioniert hat und welchen Befehl es an die Netzteile gesendet hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In Kürze wird eine neue 0.15-Version des beliebten </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Systems veröffentlicht. </font><font style="vertical-align: inherit;">In dieser Version werden MR1132-Module und eine komfortable Verwaltung direkt von der Webseite aus unterstützt und vieles mehr.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de393185/">https://habr.com/ru/post/de393185/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de393171/index.html">Laut dem Bericht von Vilnius: Wie Litauen Kryptowährungen und Blockchains hilft, die Welt zu verändern</a></li>
<li><a href="../de393175/index.html">Neue Microsoft OpenT2T-Initiative: „Die Schnittstelle von allem“</a></li>
<li><a href="../de393177/index.html">Сорок две секунды</a></li>
<li><a href="../de393179/index.html">Intel Compute Stick hat Intel Core Prozessoren und Realsense Kameras</a></li>
<li><a href="../de393181/index.html">Es wurde ein Funkchip erstellt, der gleichzeitig mit einer einzigen Antenne sendet und empfängt</a></li>
<li><a href="../de393187/index.html">Rogosin: Wir brauchen eine kollektive Softwareentwicklung nach dem Vorbild Chinas unter Beteiligung des Staates</a></li>
<li><a href="../de393189/index.html">Oscar, modularer Körper</a></li>
<li><a href="../de393191/index.html">Wie viel kostet die Rüstung von Darth Vader?</a></li>
<li><a href="../de393193/index.html">"Ein beispielloser Versuch, die Unverletzlichkeit des persönlichen Lebens der Bürger zu verbessern"</a></li>
<li><a href="../de393195/index.html">MPAA möchte, dass Anbieter wiederholte Piraten vom Internet trennen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>