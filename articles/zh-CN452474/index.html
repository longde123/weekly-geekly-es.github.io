<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎓 🛀🏻 🥠 小波分析。 第二部分 🥟 👩🏽‍🤝‍👨🏻 🎯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="引言 
 该出版物讨论了时间序列的小波分析。 小波变换的主要思想与许多时间序列的细节相对应，这些细节证明了其主要特征随时间的演变-谐波分量的平均值，方差，周期，幅度和相位。 在各个知识领域研究的绝大多数过程都具有上述特征。 

 该出版物的目的是描述使用PyWavelets库对时间序列进行连续小波变...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>小波分析。 第二部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452474/"><h3> 引言 </h3><br> 该出版物讨论了时间序列的小波分析。 小波变换的主要思想与许多时间序列的细节相对应，这些细节证明了其主要特征随时间的演变-谐波分量的平均值，方差，周期，幅度和相位。 在各个知识领域研究的绝大多数过程都具有上述特征。 <br><br>  <b>该出版物的目的</b>是描述使用PyWavelets库对时间序列进行连续小波变换的方法。 <br><br>  <b>一点历史</b> <br><br> 二十世纪70年代后期的地球物理学家D. Morlaix。 我遇到了分析来自地震传感器的信号的问题，这些信号在短时间内包含高频成分（地震活动），在很长一段时间内包含低频成分（地壳的平静状态）。 窗口傅立叶变换允许您分析高频分量或低频分量，但不能一次分析两个分量。 <br><br> 因此，提出了一种分析方法，其中低频的窗函数的宽度增加，而高频的窗函数的宽度减小。 作为一个生成函数（所谓的缩放函数-缩放函数，scalet）的拉伸（压缩）和时间偏移的结果，获得了新的窗口变换。  D. Morlaix将此生成函数称为小波。 <br><br><div class="spoiler">  <b class="spoiler_title">小波D.Morlaix</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg axes = scg.plot_wav(<span class="hljs-string"><span class="hljs-string">'cmor1-1.5'</span></span>, figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>)) show()</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/eb/hm/9j/ebhm9jmmchoo9xvsmxahdslwflk.png"><br><a name="habracut"></a><br><h3> 连续小波变换（CWT） </h3><br> 单级小波变换： <br><br>  <b>系数，频率= pywt.cwt（数据，标度，小波）</b> <br><br> 其中： <br><br>  <b>数据：</b> <i>（array_like）</i> -输入信号; <br><br>  <b>scales</b> <i>（array_like）</i> ：-要使用的小波尺度。 您可以使用比率f = scale2frequency（比例，小波）/ sample_period来确定物理频率f是多少。 此处，f以秒为单位时的samples_period为赫兹； <br><br>  <b>小波</b> <i>（小波对象或名称）</i> ：-要使用的小波； <br><br>  <b>采样</b>周期（浮点）：-输出频率的采样周期（可选参数）。 为系数计算的值与sample_period无关（即，比例未通过周期采样进行缩放）。 <br><br>  <b>coefs</b> <i>（array_like）</i> ：-连续小波-给定尺度和小波的输入信号变换； <br><br>  <b>频率</b> <i>（array_like）</i> ：-如果采样周期的单位是秒并已设置，则频率以赫兹显示。 否则，假定采样周期为1。 <br><br>  <b>注意：</b>系数数组的大小取决于输入数组的长度和给定比例的长度。 <br><br> 获取可用的cwt兼容小波名称列表： <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt &gt;&gt;&gt; wavlist = pywt.wavelist(kind=<span class="hljs-string"><span class="hljs-string">'continuous'</span></span>) &gt;&gt;&gt; wavlist</code> </pre> <br>  ['cgau1'，'cgau2'，'cgau3'，'cgau4'，'cgau5'，'cgau6'，'cgau7'，'cgau8'，'cmor'，'fbsp'，'gaus1'，'gaus2'，' gaus3'，'gaus4'，'gaus5'，'gaus6'，'gaus7'，'gaus8'，'mexh'，'morl'，'shan']] <br><br> 对于小波分析，选择母小波是关键任务之一。 因此，在每次选择小波之前，只需使用以下程序即可确定小波的动态属性： <br><br><div class="spoiler">  <b class="spoiler_title">清单1</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt vav=<span class="hljs-string"><span class="hljs-string">'cmor1.5-1.0'</span></span> wav = pywt.ContinuousWavelet(vav) <span class="hljs-comment"><span class="hljs-comment">#  ,      print("       [{}, {}]".format( wav.lower_bound, wav.upper_bound)) width = wav.upper_bound - wav.lower_bound scales = [1, 2, 3, 4, 10, 15] max_len = int(np.max(scales)*width + 1) t = np.arange(max_len) fig, axes = plt.subplots(len(scales), 2, figsize=(12, 6)) for n, scale in enumerate(scales): #       cwt int_psi, x = pywt.integrate_wavelet(wav, precision=10) step = x[1] - x[0] j = np.floor( np.arange(scale * width + 1) / (scale * step)) if np.max(j) &gt;= np.size(int_psi): j = np.delete(j, np.where((j &gt;= np.size(int_psi)))[0]) j = j.astype(np.int) # normalize int_psi     int_psi /= np.abs(int_psi).max() #     filt = int_psi[j][::-1] # CWT          #          . nt = len(filt) t = np.linspace(-nt//2, nt//2, nt) axes[n, 0].plot(t, filt.real, t, filt.imag) axes[n, 0].set_xlim([-max_len//2, max_len//2]) axes[n, 0].set_ylim([-1, 1]) axes[n, 0].text(50, 0.35, 'scale = {}'.format(scale)) f = np.linspace(-np.pi, np.pi, max_len) filt_fft = np.fft.fftshift(np.fft.fft(filt, n=max_len)) filt_fft /= np.abs(filt_fft).max() axes[n, 1].plot(f, np.abs(filt_fft)**2) axes[n, 1].set_xlim([-np.pi, np.pi]) axes[n, 1].set_ylim([0, 1]) axes[n, 1].set_xticks([-np.pi, 0, np.pi]) axes[n, 1].set_xticklabels([r'$-\pi$', '0', r'$\pi$']) axes[n, 1].grid(True, axis='x') axes[n, 1].text(np.pi/2, 0.5, 'scale = {}'.format(scale)) axes[n, 0].set_xlabel('time (samples)') axes[n, 1].set_xlabel('frequency (radians)') axes[0, 0].legend(['real', 'imaginary'], loc='upper left') axes[0, 1].legend(['Power'], loc='upper left') axes[0, 0].set_title('filter: wavelet - %s'%vav) axes[0, 1].set_title(r'|FFT(filter)|$^2$') plt.show()</span></span></code> </pre> </div></div><br> 接下来，我们将使用上述程序考虑小波函数及其属性： <br><br>  <b>墨西哥帽小波混合：</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">i</span><span class="MJXp-mtext" id="MJXp-Span-9" style="color: red;">\左</span><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">t</span><span class="MJXp-mtext" id="MJXp-Span-13" style="color: red;">\右</span><span class="MJXp-mrow" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">c</span><span class="MJXp-mrow" id="MJXp-Span-22"><span class="MJXp-mn" id="MJXp-Span-23">2</span></span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mtext" id="MJXp-Span-25">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">t</span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mn" id="MJXp-Span-31">3</span></span><span class="MJXp-mtext" id="MJXp-Span-32">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">t</span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-38">4</span><span class="MJXp-mo" id="MJXp-Span-39" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mrow" id="MJXp-Span-40"><span class="MJXp-mtext" id="MJXp-Span-41">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-44">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">x</span><span class="MJXp-msubsup" id="MJXp-Span-51"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-53" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-54">−</span><span class="MJXp-mtext" id="MJXp-Span-55">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">c</span><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-63" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-64">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-65"><span class="MJXp-mn" id="MJXp-Span-66">2</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-67">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">t</span><span class="MJXp-mtext" id="MJXp-Span-72">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">t</span><span class="MJXp-mrow" id="MJXp-Span-77"><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-79">1</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-83" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-84">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-85">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">t</span><span class="MJXp-mrow" id="MJXp-Span-91"><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-1"> \ varphi \左（t \右）= \ frac {2} {\ sqrt {3} \ sqrt [4] {\ pi}} \ cdot exp ^ {-\ frac {t ^ {2}} {2} } \ cdot \ left（1-t ^ {2} \ right）</script><br><br><img src="https://habrastorage.org/webt/ss/_i/fd/ss_ifd7tm-rexprzs3yy-yqsqei.png"><br><br>  <b>小波“ morl” Morlaix：</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-93"><span class="MJXp-mtext" id="MJXp-Span-94">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">i</span><span class="MJXp-mtext" id="MJXp-Span-101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">t</span><span class="MJXp-mrow" id="MJXp-Span-106"><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">t</span><span class="MJXp-mtext" id="MJXp-Span-109">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">t</span><span class="MJXp-mrow" id="MJXp-Span-115"><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">x</span><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-122" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-123">−</span><span class="MJXp-mtext" id="MJXp-Span-124">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">c</span><span class="MJXp-mrow" id="MJXp-Span-129"><span class="MJXp-msubsup" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-132" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-133">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-134"><span class="MJXp-mn" id="MJXp-Span-135">2</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">s</span><span class="MJXp-mrow" id="MJXp-Span-144"><span class="MJXp-mo" id="MJXp-Span-145" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mn" id="MJXp-Span-146">5</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">t</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-2"> \ varphi \ left（t \ right）= exp ^ {-\ frac {t ^ {2}} {2}} \ cdot cos（5t）</script><br><br>  <b>复Morlet小波“ cmorB-C”</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-150"><span class="MJXp-mtext" id="MJXp-Span-151">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">i</span><span class="MJXp-mtext" id="MJXp-Span-158">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">t</span><span class="MJXp-mrow" id="MJXp-Span-163"><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">t</span><span class="MJXp-mtext" id="MJXp-Span-166">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">t</span><span class="MJXp-mrow" id="MJXp-Span-172"><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">c</span><span class="MJXp-mrow" id="MJXp-Span-180"><span class="MJXp-mn" id="MJXp-Span-181">1</span></span><span class="MJXp-mrow" id="MJXp-Span-182"><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">t</span><span class="MJXp-mrow" id="MJXp-Span-188"><span class="MJXp-mtext" id="MJXp-Span-189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">B</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">x</span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-197" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-198">−</span><span class="MJXp-mtext" id="MJXp-Span-199">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">c</span><span class="MJXp-mrow" id="MJXp-Span-204"><span class="MJXp-msubsup" id="MJXp-Span-205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-207" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-208">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">B</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">x</span><span class="MJXp-msubsup" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-220" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">j</span><span class="MJXp-mn" id="MJXp-Span-222">2</span><span class="MJXp-mtext" id="MJXp-Span-223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-3"> \ varphi \ left（t \ right）= \ frac {1} {\ sqrt {\ pi} B} exp ^ {-\ frac {t ^ {2}} {B}} \ cdot exp ^ {j2 \ pi C t} </script><br><br> 其中B是带宽；  C是中心频率。 <br><br> 在下文中（无特殊说明），B，C的值设置为浮点数。 <br><br><img src="https://habrastorage.org/webt/ma/2m/89/ma2m89junpkx2utom3msc6nsavs.png"><br><br>  <b>高斯小波“ gausP”</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mtext" id="MJXp-Span-229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">i</span><span class="MJXp-mtext" id="MJXp-Span-236" style="color: red;">\左</span><span class="MJXp-mrow" id="MJXp-Span-237"><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">t</span><span class="MJXp-mtext" id="MJXp-Span-240" style="color: red;">\右</span><span class="MJXp-mrow" id="MJXp-Span-241"><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-243" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">C</span><span class="MJXp-mtext" id="MJXp-Span-245">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">x</span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-254" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-255">−</span><span class="MJXp-msubsup" id="MJXp-Span-256"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-258" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-259">2</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-4"> \ varphi \左（t \右）= C \ cdot exp ^ {-t ^ {2}} </script><br><br> 其中：P-小波名称中插入1到8的整数，例如“ gaus8”；  C-内置标准化常数。 <br><br><img src="https://habrastorage.org/webt/dz/rw/oq/dzrwoqu5djmnsn6fo3n3j7sy4v8.png"><br><br>  <b>集成高斯小波“ cgauP”</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-260"><span class="MJXp-mtext" id="MJXp-Span-261">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">i</span><span class="MJXp-mtext" id="MJXp-Span-268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">t</span><span class="MJXp-mrow" id="MJXp-Span-273"><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">t</span><span class="MJXp-mtext" id="MJXp-Span-276">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">t</span><span class="MJXp-mrow" id="MJXp-Span-282"><span class="MJXp-mo" id="MJXp-Span-283" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">C</span><span class="MJXp-mtext" id="MJXp-Span-286">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">x</span><span class="MJXp-msubsup" id="MJXp-Span-293"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-295" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-296">−</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-299" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-300">2</span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">x</span><span class="MJXp-msubsup" id="MJXp-Span-308"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-310" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-311">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> \ varphi \ left（t \ right）= C \ cdot exp ^ {-t ^ {2}} \ cdot exp ^ {-jt} </script><br><br> 其中：P-小波名称中插入1到8的整数，例如“gaus8”，它对应于小波函数的导数的阶数；  C-内置标准化常数。 <br><br><img src="https://habrastorage.org/webt/sa/yg/q7/saygq7ffl5k0zjy0sbmtxmgng1u.png"><br><br>  <b>香农小波“ shanB-C”</b> <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mtext" id="MJXp-Span-315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">i</span><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">t</span><span class="MJXp-mrow" id="MJXp-Span-327"><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">t</span><span class="MJXp-mtext" id="MJXp-Span-330">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">t</span><span class="MJXp-mrow" id="MJXp-Span-336"><span class="MJXp-mo" id="MJXp-Span-337" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-338" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-339">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">t</span><span class="MJXp-mrow" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">B</span></span><span class="MJXp-mtext" id="MJXp-Span-346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">t</span><span class="MJXp-mtext" id="MJXp-Span-351">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">c</span><span class="MJXp-mrow" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">n</span><span class="MJXp-mrow" id="MJXp-Span-360"><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mtext" id="MJXp-Span-362">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">t</span><span class="MJXp-mrow" id="MJXp-Span-367"><span class="MJXp-mo" id="MJXp-Span-368" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span></span><span class="MJXp-mrow" id="MJXp-Span-369"><span class="MJXp-mtext" id="MJXp-Span-370">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">T</span></span><span class="MJXp-mtext" id="MJXp-Span-375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">x</span><span class="MJXp-msubsup" id="MJXp-Span-382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-384" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">j</span><span class="MJXp-mn" id="MJXp-Span-386">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> \ varphi \ left（t \ right）= \ sqrt {B} \ cdot \ frac {sin（\ pi B t）} {\ pi B T} \ cdot exp ^ {j 2 pi C t} </script><br><br> 其中：B是带宽；  C是中心频率。 <br><br><img src="https://habrastorage.org/webt/oj/dv/hp/ojdvhpcre9palpzqglt2nkuokk8.png"><br><br>  PyWavelets中的CWT适用于离散数据-具有小波积分样本的卷积。 如果比例尺太小，那么我们将得到一个采样不足的离散滤波器，从而导致平滑，如小波“ cmor1.5-1.0”的图形所示。 <br><br> 在左列中，图表显示了在卷积中使用的各种比例的离散滤波器。 右列是每个滤波器的相应傅立叶功率谱。 对于图“ cmor1.5-1.0”，使用比例1和2可以看出，由于违反了奈奎斯特约束，因此发生了平滑。 当选择C和B时，指示的现象可能在其他小波中发生，因此，在使用小波时，必须使用程序-清单1。 <br><br> 要将给定的标度与特定的信号频率相关联，必须知道信号采样周期。 使用<b>pywt.scale2frequency（）</b>函数，可以将刻度列表转换为相应的频率。 比例尺的正确选择取决于所选的小波，因此应使用pywt.scale2frequency（）来了解信号的相应频率范围。 <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt &gt;&gt;&gt; dt = <span class="hljs-number"><span class="hljs-number">0.01</span></span> <span class="hljs-comment"><span class="hljs-comment"># 100 Hz sampling &gt;&gt;&gt; frequencies = pywt.scale2frequency('cmor1.5-1.0', [1, 2, 3, 4]) / dt &gt;&gt;&gt; frequencies</span></span></code> </pre> <br> 数组（[100.，50.，33.33333333，25.]） <br><br><h3> 小波-使用CWT PyWavelet进行时间序列分析 </h3><br>  el-Nino数据集是用于跟踪El Nino的时间序列数据集，包含从1871年到1997年的每季度海表温度测量值。 为了了解比例尺图表的功能，让我们将其可视化为el-Nino数据集以及原始时间序列数据及其傅里叶变换。 <br><br> 对于时间序列的小波分析，必须执行以下步骤： <br><br>  1.选择母小波：选择复数Morlet小波“ cmorB-C”： <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mtext" id="MJXp-Span-392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">i</span><span class="MJXp-mtext" id="MJXp-Span-399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">t</span><span class="MJXp-mrow" id="MJXp-Span-404"><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0.278em; margin-right: 0.278em;">（</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">t</span><span class="MJXp-mtext" id="MJXp-Span-407">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">t</span><span class="MJXp-mrow" id="MJXp-Span-413"><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.278em; margin-right: 0.278em;">）</span></span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">c</span><span class="MJXp-mrow" id="MJXp-Span-421"><span class="MJXp-mn" id="MJXp-Span-422">1</span></span><span class="MJXp-mrow" id="MJXp-Span-423"><span class="MJXp-mtext" id="MJXp-Span-424">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">t</span><span class="MJXp-mrow" id="MJXp-Span-429"><span class="MJXp-mtext" id="MJXp-Span-430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">B</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">x</span><span class="MJXp-msubsup" id="MJXp-Span-436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-438" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-439">−</span><span class="MJXp-mtext" id="MJXp-Span-440">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">c</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-448" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-449">2</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">B</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-452">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">x</span><span class="MJXp-msubsup" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-461" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">j</span><span class="MJXp-mn" id="MJXp-Span-463">2</span><span class="MJXp-mtext" id="MJXp-Span-464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ varphi \ left（t \ right）= \ frac {1} {\ sqrt {\ pi} B} exp ^ {-\ frac {t ^ {2}} {B}} \ cdot exp ^ {j2 \ pi C t} </script><br><br> 带宽-B和中心频率-下一步将确定带宽。 <br><br>  2.通过使我们的时间序列的dt = 0.25来确定中心频率： <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt dt = <span class="hljs-number"><span class="hljs-number">0.25</span></span> <span class="hljs-comment"><span class="hljs-comment"># 4 Hz sampling scale=range(1,4) frequencies = pywt.scale2frequency('cmor1.0-0.5', scale) / dt print(frequencies)</span></span></code> </pre> <br>  [2。  1. 0.66666667] <br><br>  3.我们找到了母波cmor1.0-0.5的傅立叶变换（我们使用清单1）： <br> 连续小波将在整个范围内进行评估[-8.0，8.0] <br><br><img src="https://habrastorage.org/webt/ma/2m/89/ma2m89junpkx2utom3msc6nsavs.png"><br><br>  4.选择时间序列的数据： <br><br><pre> <code class="python hljs">pd.read_csv(<span class="hljs-string"><span class="hljs-string">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></span>, sep = <span class="hljs-string"><span class="hljs-string">"|"</span></span>)</code> </pre> <br> 数据是1871年至1997年的季度海表温度测量值。 对于此数据：t0 = 1871 dt = 0.25 <br><br>  5.我们在一个图表上建立一个信号及其移动平均值的时间序列： <br><br><div class="spoiler">  <b class="spoiler_title">清单2</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ave_values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xvalues, yvalues, n = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> signal_length = len(xvalues) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> signal_length % n == <span class="hljs-number"><span class="hljs-number">0</span></span>: padding_length = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: padding_length = n - signal_length//n % n xarr = array(xvalues) yarr = array(yvalues) xarr.resize(signal_length//n, n) yarr.resize(signal_length//n, n) xarr_reshaped = xarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) yarr_reshaped = yarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) x_ave = xarr_reshaped[:,<span class="hljs-number"><span class="hljs-number">0</span></span>] y_ave = nanmean(yarr_reshaped, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x_ave, y_ave <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_signal_plus_average</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(time, signal, average_over = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)) time_ave, signal_ave = get_ave_values(time, signal, average_over) ax.plot(time, signal, label=<span class="hljs-string"><span class="hljs-string">''</span></span>) ax.plot(time_ave, signal_ave, label = <span class="hljs-string"><span class="hljs-string">'   (n={})'</span></span>.format(<span class="hljs-number"><span class="hljs-number">5</span></span>)) ax.set_xlim([time[<span class="hljs-number"><span class="hljs-number">0</span></span>], time[<span class="hljs-number"><span class="hljs-number">-1</span></span>]]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">' '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">18</span></span>) ax.set_title(<span class="hljs-string"><span class="hljs-string">' +   '</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">18</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">''</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">18</span></span>) ax.legend() show() df_nino = pd.read_csv(<span class="hljs-string"><span class="hljs-string">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></span>, sep = <span class="hljs-string"><span class="hljs-string">"|"</span></span>) N = df_nino.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] t0=<span class="hljs-number"><span class="hljs-number">1871</span></span> dt=<span class="hljs-number"><span class="hljs-number">0.25</span></span> time = arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, N) * dt + t0 signal = df_nino.values.squeeze() scales = arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>) plot_signal_plus_average(time, signal)</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/jn/aq/xd/jnaqxdldji2emwikid0bcjme9qq.png"><br><br>  6.我们从时间序列中进行傅立叶变换和频谱模态： <br><br><div class="spoiler">  <b class="spoiler_title">清单3</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ave_values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(xvalues, yvalues, n = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">5</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> signal_length = len(xvalues) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> signal_length % n == <span class="hljs-number"><span class="hljs-number">0</span></span>: padding_length = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: padding_length = n - signal_length//n % n xarr = array(xvalues) yarr = array(yvalues) xarr.resize(signal_length//n, n) yarr.resize(signal_length//n, n) xarr_reshaped = xarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) yarr_reshaped = yarr.reshape((<span class="hljs-number"><span class="hljs-number">-1</span></span>,n)) x_ave = xarr_reshaped[:,<span class="hljs-number"><span class="hljs-number">0</span></span>] y_ave = nanmean(yarr_reshaped, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x_ave, y_ave <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_fft_values</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(y_values, T, N, f_s)</span></span></span><span class="hljs-function">:</span></span> f_values = linspace(<span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>/(<span class="hljs-number"><span class="hljs-number">2.0</span></span>*T), N//<span class="hljs-number"><span class="hljs-number">2</span></span>) fft_values_ = fft(y_values) fft_values = <span class="hljs-number"><span class="hljs-number">2.0</span></span>/N * abs(fft_values_[<span class="hljs-number"><span class="hljs-number">0</span></span>:N//<span class="hljs-number"><span class="hljs-number">2</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f_values, fft_values <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_fft_plus_power</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(time, signal)</span></span></span><span class="hljs-function">:</span></span> dt = time[<span class="hljs-number"><span class="hljs-number">1</span></span>] - time[<span class="hljs-number"><span class="hljs-number">0</span></span>] N = len(signal) fs = <span class="hljs-number"><span class="hljs-number">1</span></span>/dt fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)) variance = std(signal)**<span class="hljs-number"><span class="hljs-number">2</span></span> f_values, fft_values = get_fft_values(signal, dt, N, fs) fft_power = variance * abs(fft_values) ** <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment"># FFT power spectrum ax.plot(f_values, fft_values, 'r-', label='FFT ') ax.plot(f_values, fft_power, 'k--', linewidth=1, label=' ') ax.set_xlabel('[ / ]', fontsize=18) ax.set_ylabel('', fontsize=18) ax.legend() show() df_nino = pd.read_csv("http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat", sep = "|") N = df_nino.shape[0] t0=1871 dt=0.25 time = arange(0, N) * dt + t0 signal = df_nino.values.squeeze() scales = arange(1, 128) plot_fft_plus_power(time, signal)</span></span></code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/3t/dl/4u/3tdl4ucxxzqjpyro_t1saro7v5g.png"><br><br>  7.我们确定尺度：尺度=范围（1，128）; 级别= [2 **-4，4 **-3，2 **-2，2 **-1，2 ** 0，2 ** 1，2 ** 2，2 ** 3]。 <br><br>  8.建立一个比例表： <br><br><div class="spoiler">  <b class="spoiler_title">清单4</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_wavelet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(time, signal, scales, waveletname = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'cmor1.0-0.4'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, cmap = plt.cm.seismic, title = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'-( ) '</span></span></span></span><span class="hljs-function"><span class="hljs-params">, ylabel = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' ()'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, xlabel = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> dt = time[<span class="hljs-number"><span class="hljs-number">1</span></span>] - time[<span class="hljs-number"><span class="hljs-number">0</span></span>] [coefficients, frequencies] = pywt.cwt(signal, scales, waveletname, dt) power = (abs(coefficients)) ** <span class="hljs-number"><span class="hljs-number">2</span></span> period = <span class="hljs-number"><span class="hljs-number">1.</span></span> / frequencies levels = [<span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">-4</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">-3</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">-2</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">-1</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">2</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span>**<span class="hljs-number"><span class="hljs-number">3</span></span>] contourlevels = log2(levels) fig, ax = subplots(figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) im = ax.contourf(time, log2(period), log2(power), contourlevels, extend=<span class="hljs-string"><span class="hljs-string">'both'</span></span>,cmap=cmap) ax.set_title(title, fontsize=<span class="hljs-number"><span class="hljs-number">20</span></span>) ax.set_ylabel(ylabel, fontsize=<span class="hljs-number"><span class="hljs-number">18</span></span>) ax.set_xlabel(xlabel, fontsize=<span class="hljs-number"><span class="hljs-number">18</span></span>) yticks = <span class="hljs-number"><span class="hljs-number">2</span></span>**arange(np.ceil(log2(period.min())), ceil(log2(period.max()))) ax.set_yticks(log2(yticks)) ax.set_yticklabels(yticks) ax.invert_yaxis() ylim = ax.get_ylim() ax.set_ylim(ylim[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-number"><span class="hljs-number">-1</span></span>) cbar_ax = fig.add_axes([<span class="hljs-number"><span class="hljs-number">0.95</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.25</span></span>]) fig.colorbar(im, cax=cbar_ax, orientation=<span class="hljs-string"><span class="hljs-string">"vertical"</span></span>) show() df_nino = pd.read_csv(<span class="hljs-string"><span class="hljs-string">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></span>, sep = <span class="hljs-string"><span class="hljs-string">"|"</span></span>) N = df_nino.shape[<span class="hljs-number"><span class="hljs-number">0</span></span>] t0=<span class="hljs-number"><span class="hljs-number">1871</span></span> dt=<span class="hljs-number"><span class="hljs-number">0.25</span></span> time = arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, N) * dt + t0 signal = df_nino.values.squeeze() scales = arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>) plot_wavelet(time, signal, scales)</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/4r/f2/fx/4rf2fxln9cshvvit-9vzndcfo9i.png"><br><br> 比例表显示，大多数频谱功率集中在2-8年内，这对应于0.125-0.5 Hz的频率。 在傅立叶频谱中，时尚也集中在这些频率值上。 但是，小波变换也提供了临时信息，而傅立叶变换则没有。 <br><br> 例如，在比例图上，我们看到1920年之前波动很大，而1960年至1990年之间波动很小。 我们还可以看到，随着时间的流逝，从较短的时期向较长的时期转变。 <br><br><h3> 使用比例尺模块 </h3><br>  Scaleogram是基于PyWavelets库通过连续小波变换分析一维数据的便捷工具。 该模块旨在为快速数据分析提供可靠的工具。 <br><br> 比例图具有以下功能： <br><br><ul><li> 简单的初学者通话签名 </li><li> 可读轴和纯matplotlib集成 </li><li> 缩放，频谱过滤器，颜色条实现等许多选项... </li><li> 根据标记支持频率和频率单位 </li><li> 速度，使用N * log（N）算法进行转换 </li><li> 可移植性：已通过python2.7和python3.7测试 </li><li> 详细的错误消息和文档以及示例 </li></ul><br> 但是，在使用示例中，数据访问未正确记录： <br><br><pre> <code class="python hljs">nino3 = <span class="hljs-string"><span class="hljs-string">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></span></code> </pre> <br> 出现以下警告： <br><br>  nino3 = pd.read_table（nino3） <br> 导致警告： <br> 警告（来自警告模块）： <br> 文件“ C：/Users/User/Desktop/wavelet/pr.py”，第7行 <br>  nino3 = pd.read_table（nino3） <br>  FutureWarning：不建议使用read_table，请改用read_csv，并传递sep ='\ t' <br><br> 数据访问应这样写： <br><br><pre> <code class="python hljs">url=<span class="hljs-string"><span class="hljs-string">"http://paos.colorado.edu/research/wavelets/wave_idl/sst_nino3.dat"</span></span> nino3 = pd.read_csv(url, sep = <span class="hljs-string"><span class="hljs-string">"|"</span></span>)</code> </pre> <br> 为了显示比例尺的使用并将结果与​​上一个示例的结果进行比较，我们使用相同的数据-对1871年至1997年的海面温度进行季度测量。 对于此数据：t0 = 1871 dt = 0.25 <br><br><div class="spoiler">  <b class="spoiler_title">清单4</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywt <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scaleogram <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> scg <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pylab <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>* url=<span class="hljs-string"><span class="hljs-string">"sst_nino3.dat"</span></span> nino3 = pd.read_csv(url, sep = <span class="hljs-string"><span class="hljs-string">"|"</span></span>) data = nino3.values.squeeze() N = data.size t0 = <span class="hljs-number"><span class="hljs-number">1871</span></span>; dt = <span class="hljs-number"><span class="hljs-number">0.25</span></span> time = t0 + arange(len(data))*dt wavelet = <span class="hljs-string"><span class="hljs-string">'cmor1-0.5'</span></span> ax = scg.cws(time, data, scales=arange(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>), wavelet=wavelet, figsize=(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), cmap=<span class="hljs-string"><span class="hljs-string">"jet"</span></span>, cbar=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">' ()'</span></span>, xlabel=<span class="hljs-string"><span class="hljs-string">" []"</span></span>, yscale=<span class="hljs-string"><span class="hljs-string">"log"</span></span>, title=<span class="hljs-string"><span class="hljs-string">'-  \n( )'</span></span>) ticks = ax.set_yticks([<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>]) ticks = ax.set_yticklabels([<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">32</span></span>]) show()</code> </pre> <br></div></div><br><img src="https://habrastorage.org/webt/xh/zz/_s/xhzz_s0xumdowfyqjrymgmz2-3k.png"><br> 如果我们将比例尺图表与获得的扫描结果进行比较，则除了调色板外，它们是相同的，因此在时间序列中显示出相同的动态。 <br> 清单4比清单3更简单，并且具有更好的性能。 <br><br> 当根据傅立叶的频谱和功率谱不允许获得有关时间序列动态的附加信息时，则最好使用比例图。 <br><br><h3> 结论 </h3><br> 给出了通过PyWavelets库对时间序列进行小波分析的示例。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN452474/">https://habr.com/ru/post/zh-CN452474/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN452460/index.html">Windows终端介绍</a></li>
<li><a href="../zh-CN452462/index.html">关于OOP</a></li>
<li><a href="../zh-CN452464/index.html">如果您的项目是“剧院”，那么请使用演员</a></li>
<li><a href="../zh-CN452466/index.html">盲文键盘</a></li>
<li><a href="../zh-CN452468/index.html">“如果您需要杀死某人，那么您来到了地址”</a></li>
<li><a href="../zh-CN452478/index.html">在Figma设计系统中创建表并在Storybook中实现（反应）</a></li>
<li><a href="../zh-CN452480/index.html">Phoenix LiveView：不再需要JavaScript时*</a></li>
<li><a href="../zh-CN452486/index.html">共识是谎言</a></li>
<li><a href="../zh-CN452490/index.html">VRRP的工作原理</a></li>
<li><a href="../zh-CN452492/index.html">拆卸蛇</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>