<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè¶ ü§≤üèΩ üë©üèø‚ÄçüöÄ A temperatura ideal em casa ou como instalar um termostato na sala dos fundos sem fio üíç üêò üïå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Para muitos, est√° longe de ser um segredo que dispositivos como termostatos semanais ajudam a garantir a temperatura ambiente ideal em uma casa e a ec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>A temperatura ideal em casa ou como instalar um termostato na sala dos fundos sem fio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/431272/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ad/gn/6s/adgn6si6fr0kfmywagyjs1h9_nq.png"></div><br>  Para muitos, est√° longe de ser um segredo que dispositivos como termostatos semanais ajudam a garantir a temperatura ambiente ideal em uma casa e a economizar recursos energ√©ticos gastos no aquecimento.  Para o correto funcionamento do dispositivo, ele geralmente √© colocado na sala mais distante, onde a temperatura mais baixa.  Por√©m, a maioria dos termostatos exige uma conex√£o com fio √† caldeira para controle e nem sempre √© poss√≠vel colocar esses fios.  Uma solu√ß√£o para esse problema ser√° discutida neste artigo.  Qualquer pessoa interessada em pedir um gato ... <br><a name="habracut"></a><br>  Eu tive que enfrentar uma tarefa semelhante.  A constru√ß√£o da minha casa √© bastante extensa e, para a correta instala√ß√£o do termostato, eu precisava esticar mais de 50 m de cabo pelos c√¥modos com os reparos j√° feitos, a alternativa estava na fachada, mas eu imediatamente o descartei.  Al√©m disso, levar um cabo da rua at√© a caldeira tamb√©m era problem√°tico, e eu n√£o queria estragar a vista da fachada com outro fio, sem que houvesse extra suficiente.  A pr√≥pria caldeira foi instalada na cozinha e colocar o termostato ao lado da torneira foi uma m√° ideia.  Como resultado, cheguei √† conclus√£o de que o termostato ainda deve ser movido para a sala mais distante e o sinal deve ser transmitido pelo ar.  O processo de desenvolvimento do meu pr√≥ximo of√≠cio come√ßou como de costume com a declara√ß√£o do problema.  Ent√£o, vamos come√ßar ... <br><br><h3>  TK </h3><br>  Defina os requisitos para o dispositivo resolver o problema. <br><ul><li>  O design dos dispositivos deve ser pequeno e ser colocado em uma caixa est√©tica em branco ou preto. </li><li>  O m√≥dulo receptor e transmissor deve ser alimentado por um par de pilhas AA. </li><li>  A vida √∫til dos m√≥dulos de um conjunto de baterias deve ser de pelo menos um ano. </li><li>  A conex√£o ao termostato e √† caldeira a g√°s deve ser realizada usando interfaces padr√£o sem fazer altera√ß√µes no projeto. </li><li>  Os dispositivos devem ser montados em uma base de hardware acess√≠vel por fornecedores locais. </li></ul><br><br><h3>  Hardware </h3><br>  Quando decidirmos sobre os requisitos b√°sicos, passemos ao design.  Vamos come√ßar com o hardware. <br>  Com base nas especifica√ß√µes t√©cnicas, os requisitos b√°sicos para a base do elemento ser√£o: a capacidade de trabalhar na faixa de tens√£o de 1,8 a 3 volts.  Bem como a capacidade de alternar para o modo de suspens√£o ou desligar a periferia quando n√£o for necess√°rio.  Decidi iniciar meu caminho de escolha com a sele√ß√£o de um transceptor.  Eu considerei as solu√ß√µes mais simples na forma dos m√≥dulos MX-FS-03V e MX-05V, o pre√ßo √© obviamente muito atraente, mas a qualidade das avalia√ß√µes √© horr√≠vel e o alcance da comunica√ß√£o n√£o √© t√£o bom.  E no meu caso, foi necess√°rio transmitir um sinal atrav√©s de 4 paredes.  Al√©m disso, ele pretendia originalmente confirmar o despacho, de modo que a conex√£o era necess√°ria nos dois sentidos, o que exigiria dois conjuntos.  Os m√≥dulos LoRa e v√°rios m√≥dulos da s√©rie HC tamb√©m foram considerados.  O alcance ainda era limitado ao que √© vendido localmente.  Como resultado, tendo considerado todas as op√ß√µes dispon√≠veis, decidi optar pelos m√≥dulos SI4432 prontos.  Em termos de rela√ß√£o pre√ßo-desempenho, na minha opini√£o, eles eram os melhores. <br>  Este m√≥dulo possui amplos recursos t√©cnicos e tamb√©m √© muito econ√¥mico com as configura√ß√µes selecionadas corretamente.  A capacidade de controlar a pot√™ncia de sa√≠da tamb√©m √© muito √∫til, porque  voc√™ pode escolher o melhor, reduzindo assim o consumo de energia da bateria.  Aqui est√° uma tabela com especifica√ß√µes da documenta√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yl/fz/ty/ylfztyrtiksrge8ealkwocx2kca.png"></div><br>  Vamos considerar com mais detalhes os indicadores de consumo de energia em v√°rios modos da tabela.  Mais tarde, precisaremos desses dados para calcular a vida √∫til da bateria dos dispositivos. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jb/eb/ur/jbeburjt5z686syc-ihxve3-u-c.png"></div><br>  No nosso caso, j√° √© aceit√°vel usar o modo de suspens√£o, sem mencionar o desligamento completo pela fun√ß√£o Shutdown. <br>  Inicialmente, eu deveria usar o ATMega 8 como um processador central, mas depois de estudar a documenta√ß√£o com mais detalhes, percebi que ela n√£o se enquadrava na minha faixa de tens√£o de alimenta√ß√£o.  Como resultado, escolhi o ATMega 328P, pois  Ela atendeu plenamente a todos os meus requisitos.  Olhando para o futuro, direi que o fato de ter encontrado um gerenciador de inicializa√ß√£o pronto para ela, mas mais sobre isso depois, tamb√©m foi a favor dela. <br>  Considere o controlador com mais detalhes em termos de consumo de energia e clock do n√∫cleo. <br>  Vamos lidar com o tempo primeiro.  Porque  temos uma faixa de tens√£o de trabalho de at√© 3 volts, ent√£o a escolha de um ressonador de quartzo tamb√©m √© limitada, e o gr√°fico a seguir nos fala sobre isso <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7o/1d/pj/7o1dpjppnnpuc67ozj9baher7gw.png"></div><br>  Como vemos em 8 MHz, n√£o podemos obter uma opera√ß√£o est√°vel; portanto, usaremos quartzo em 4 MHz. <br>  Agora vamos ver o consumo de energia em v√°rios modos de opera√ß√£o.  Aqui est√° uma tabela da documenta√ß√£o que descreve as caracter√≠sticas de consumo de energia. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/py/1y/pj/py1ypjle8u-jprje_ciw1iosjou.png"></div><br>  Portanto, se voc√™ transferir o controlador para o modo de desligamento, o consumo do microcontrolador cair√° para 44 uA com determinadas reservas, √© claro. <br>  Al√©m dos elementos j√° selecionados, adicionaremos um LED vermelho com uma corrente de trabalho de 1 mA. <br>  Isso completa os componentes comuns para o receptor e o transmissor. <br>  Considere os componentes adicionais para o receptor. <br>  Na sa√≠da de um termostato de sala convencional, h√° um contato de rel√© com boa capacidade de comuta√ß√£o (250 V 5 A), portanto, n√£o importa o que ele controla, portanto, de acordo com os termos de refer√™ncia, nosso receptor deve ter a mesma sa√≠da de rel√©.  Mas como garantir um baixo consumo de energia do rel√© no modo ligado, porque a bobina at√© do rel√© menor consome dezenas de miliamperes e o termostato de f√°brica trabalha com um conjunto de baterias normais sem exagero por pelo menos duas temporadas de aquecimento.  Pensei nessa tarefa por alguns dias e, de repente, durante o reparo de um dos dispositivos que me ocorreu, fica apenas um rel√© biest√°vel.  E por que durante o reparo, mas porque eles s√£o usados ‚Äã‚Äãno dispositivo que est√° sendo reparado.  Este tipo de rel√© √© capaz de manter seu estado por tempo infinito sem consumo de energia.  Para que o rel√© mude de estado, basta aplicar um pulso √† bobina necess√°ria, no caso de dois rel√©s de enrolamento, ou um pulso com polaridade reversa, no caso de um rel√© com um enrolamento.  Assim, decidimos o tipo de rel√©, mas o que fazer com um modelo espec√≠fico?  Tendo pesquisado um pouco na Internet, cheguei √† conclus√£o de que obter um rel√© de baixa tens√£o seria um problema para mim, pois tive que me concentrar no meu rel√© de 24V Takamisawa ALD24W-K.  Mas essa solu√ß√£o apresentou um novo problema - onde obter 24 V? <br>  A resposta foi encontrada rapidamente, talvez n√£o seja a mais correta, mas ainda assim.  Decidi instalar um conversor de impulso e aumentar a tens√£o para 20 V, √© o suficiente para uma comuta√ß√£o de rel√© confi√°vel.  O conversor foi retirado de um m√≥dulo bastante comum baseado no MT3608.  Esta √© uma solu√ß√£o funcional que testei mais de uma vez, incluindo o design de uma chave de fenda el√©trica (voc√™ pode ler sobre isso aqui em Habr√©).  A sa√≠da EN permite controlar a opera√ß√£o do conversor, o que reduz significativamente o consumo de energia.  Na verdade, aqui est√£o os dados da documenta√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ag/jm/gy/agjmgyo9j9iowc2a2cqnlyzivbi.png"></div><br>  Depois de reunir todas as informa√ß√µes recebidas, desenhei diagramas de ambos os dispositivos: <br>  Transmissor <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wm/sj/rr/wmsjrre0rwczx3qnq7jzqeum7co.png"></div><br>  Receptor <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sp/fr/mf/spfrmflw92ubxja9893shieqpwy.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wx/0v/on/wx0vonbxdcyls8xmnb0p763le2a.png"></div><br>  Tendo terminado o hardware do projeto, passemos aos algoritmos e sua implementa√ß√£o de software. <br><br><h3>  Algoritmo </h3><br>  Vamos come√ßar desenvolvendo um conceito e algoritmo de trabalho comum para nossos dispositivos.  A figura abaixo mostra um diagrama de sequ√™ncia geral para todos os dispositivos envolvidos no processo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/_n/rg/8d/_nrg8dd4kqpt8tm19zqqgt2hgko.png"></div><br>  Como voc√™ pode ver, o algoritmo n√£o √© complicado, farei uma apresenta√ß√£o narrativa (bem, estou com pregui√ßa de desenhar um fluxograma, com licen√ßa).  Vamos come√ßar com o transmissor, como  √© o mais simples do ponto de vista do algoritmo.  O microcontrolador transmissor executa a seguinte sequ√™ncia: <br>  - Verifica o estado da carga das baterias; se a carga estiver baixa, a descarga ser√° indicada pelo LED embutido. <br>  - Interroga o status de entrada. <br>  - Transmite esse estado pelo ar. <br>  - coloca o transmissor no modo de suspens√£o e adormece por 1 minuto. <br>  - o ciclo se repete desde o in√≠cio. <br><br>  Com o receptor, as coisas s√£o um pouco mais complicadas.  O microcontrolador funciona de acordo com o seguinte algoritmo: <br>  - verifica o estado da carga das baterias; se a carga estiver baixa, indicamos uma descarga pelo LED embutido. <br>  - estamos aguardando o pacote do transmissor; se em 2 minutos o sinal n√£o tiver sido recebido, adormecemos por 59 segundos, ap√≥s os quais o ciclo come√ßa desde o in√≠cio. <br>  - se um pacote chegar, obteremos um novo estado de retransmiss√£o. <br>  - se o novo estado do rel√© for diferente do que foi salvo anteriormente, ligue o conversor auxiliar e mude o rel√© para o estado desejado. <br>  - adorme√ßa por 59 segundos <br>  - repita o ciclo primeiro <br>  Assim, quando voc√™ liga o receptor pela primeira vez, ele espera um sinal do transmissor, assim que recebe, faz uma altera√ß√£o no estado do rel√© e adormece 1 segundo a menos que o transmissor.  Como resultado, no momento de um novo envio, o destinat√°rio j√° est√° em opera√ß√£o e aguardando um novo envio, ou seja,  √© como se estivesse sincronizado por um transmissor.  Como resultado, foi poss√≠vel economizar bem o consumo de energia.  Se o sinal do transmissor n√£o for recebido, esperamos um m√°ximo de 2 minutos, para que esse intervalo seja escolhido para garantir que o sinal seja capturado, independentemente da hora em que o transmissor for ligado.  Mas √© extremamente antiecon√¥mico e destina-se exclusivamente √† sincroniza√ß√£o de dispositivos. <br><br><h3>  Tempo de vida </h3><br>  Quando ficou claro com o algoritmo, vamos tentar calcular a vida √∫til da bateria. <br>  Vamos nos concentrar um pouco na teoria necess√°ria para obter n√∫meros precisos ao calcular o tempo de opera√ß√£o dos sensores a partir de um conjunto de baterias. <br>  Ent√£o, primeiro veremos quando e em que energia √© gasta. <br>  Considere o procedimento de envio com mais detalhes. <br>  Para transmitir o estado do rel√©, precisamos formar um pacote e envi√°-lo ao ar.  Em geral, a estrutura desse pacote √© a seguinte: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mm/lc/rs/mmlcrsv4rdwkusd31uc1riy2mli.png"></div><br>  Eu usei os par√¢metros padr√£o do transmissor, ou seja,  FSK, No Manchester, Rb = 2,4kbs, Fd = 36kHz.  A quantidade de dados transmitidos no pacote √© de 3 bytes.  O pre√¢mbulo ter√° 40 bits de tamanho da tabela: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q_/0n/dx/q_0ndxy2vopxc8r3ejrdw_mrap8.png"></div><br>  Para n√£o nos aprofundarmos na configura√ß√£o dos m√≥dulos e na opera√ß√£o da biblioteca, aceitaremos os par√¢metros restantes como o m√°ximo permitido.  Como resultado, obtemos o tamanho total do pacote de 5 bytes + 4 bytes + 4 bytes + 1 byte + 3 bytes + 2 bytes = 19 bytes, ou seja,  152 bits.  Que a uma velocidade de 2400 bps, o tempo de transmiss√£o ser√° de aproximadamente 64 ms. <br>  Passamos para a tabela de consumo de energia do m√≥dulo no in√≠cio do artigo e extra√≠mos o valor da corrente durante a transmiss√£o com uma pot√™ncia de sa√≠da de 13 dBm.  Assim, ao enviar dados, o m√≥dulo gasta 30 mA. <br>  No modo de recebimento, o m√≥dulo consumir√° estaticamente 18,5 mA com base na mesma tabela. <br>  Ainda n√£o consegui traduzir o m√≥dulo para o modo Shutdown, por algum motivo n√£o consegui tir√°-lo do coma. Como resultado, me limitei ao modo Sleep, no qual o m√≥dulo consome 1 uA. <br>  Al√©m disso, ao receber e transmitir o pacote, acendo o LED vermelho conectado atrav√©s de um resistor de 1 kŒ© a 3,3 volts, que consome cerca de 1 mA. <br>  O microcontrolador no modo wake consome 2,4 mA e no modo sleep com o WDT ligado - 44 uA.  Dados obtidos da tabela acima. <br>  O receptor tamb√©m possui uma fuga parasita de corrente quando o termostato √© fechado atrav√©s de um resistor de tra√ß√£o ao solo (consulte o diagrama do transmissor), de modo que 3,3 V / 10 kOhm = 33 uA fluem atrav√©s dele.  Pareceu-me uma grande quantidade, ent√£o, no circuito, mudei o valor do resistor para 100 kOhm, mas no ferro ele ainda √© montado com 10 kOhm, ent√£o vamos aceit√°-lo como est√°. <br>  O receptor tem mais consumidores.  Em primeiro lugar, √© um conversor de impulso de 20 volts.  No modo de suspens√£o, consome 1 uA.  Em opera√ß√£o ociosa, o consumo ser√° de 2,2 mA. No programa, aguardo 100 ms para iniciar o conversor.  A bobina do rel√© atua como uma carga para n√≥s, sua caracter√≠stica √© indicada abaixo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hy/tg/h6/hytgh6qhze5izs8qrkojy7mmcig.png"></div><br>  Assim, verifica-se que a bobina, quando alimentada por 20 volts, consumir√° 20 V / 1920 Ohms = 11 mA.  Agora, passamos ao gr√°fico da depend√™ncia da efici√™ncia do consumo atual de carga para avaliar o consumo total do conversor com uma bobina de rel√© conectada. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zd/wo/b8/zdwob8xv2awfkss3igwqsta8bfw.png"></div><br>  Como voc√™ pode ver, com esse consumo, o gr√°fico n√£o reflete a efici√™ncia, mas suponha que ele tamb√©m se mova linearmente para baixo e, na pior das hip√≥teses, a efici√™ncia ser√° de aproximadamente 85%.  Como resultado, o consumo atual ser√° de 11 mA / 0,85 = 13 mA.  Vale a pena reconhecer que, de fato, o pico de corrente na inicializa√ß√£o do conversor ser√° pelo menos 1A, e os processos de opera√ß√£o e inicializa√ß√£o s√£o complexos, e eu n√£o sou a pessoa capaz de defini-los corretamente, portanto sentirei falta deles e simplificarei um pouco o processo. <br>  O tempo de pulso gerado pelo rel√© de comuta√ß√£o √© de 20 ms. <br>  Agora que descobrimos quem consome energia e quanto, calcularemos a vida √∫til te√≥rica das baterias AA.  Mais uma vez, considere o receptor e o transmissor separadamente. <br>  Vamos come√ßar como sempre com o transmissor.  Vamos tomar como base o algoritmo de trabalho dado acima.  O tempo de ativa√ß√£o do controlador ser√° um pouco maior que o tempo de transmiss√£o e, levando em considera√ß√£o os custos de configura√ß√£o do m√≥dulo, o polling de entrada e a medi√ß√£o da tens√£o da bateria ser√£o de 70 ms; o controlador ser√° colocado no modo de suspens√£o por um minuto.  Assim, em um ciclo de opera√ß√£o, o controlador consumir√° 0,07 s * (transmissor 30 mA + LED 1 mA + 2,4 mA MK) + 60 s * (transmissor 44 uA MK + 1 uA + resistor de entrada 33 uA) = 2,338 mA * s + 4,68 mA * s = 7,018 mA * s.  Dividindo o valor obtido por 60,07 s, obtemos o valor m√©dio atual por um segundo - 0,111 mA.  A capacidade m√©dia de uma bateria tamanho AA √© de 2800 mA * h (quando conectada em s√©rie, a capacidade total das baterias n√£o aumenta, se de repente algu√©m n√£o souber) - isso √© 2800 * 3600 = 10080000 mA * s.  Como resultado, o tempo de opera√ß√£o te√≥rico do transmissor de um conjunto de baterias √© de 10080000 mA * s / 0,111 mA / 3600 s / 24 h = 997 dias. <br><br>  Agora sobre o receptor.  Tamb√©m tomaremos como base o algoritmo de opera√ß√£o descrito acima, mas com uma ressalva, ligamos o receptor e o transmissor quase simultaneamente e, portanto, o receptor sincronizou imediatamente com o transmissor. <br>  Para isso, o tempo m√°ximo de ativa√ß√£o do controlador ser√° a soma do tempo de espera do pacote (a recep√ß√£o tamb√©m entrar√° nele, pois a interrup√ß√£o pelo m√≥dulo ser√° gerada somente ap√≥s o pacote ter sido completamente recebido), removendo-o do m√≥dulo, iniciando o conversor e definindo um novo estado de rel√©, al√©m de medir voltagem da bateria.  Depois de resumir todos os dados, obtemos - 1,126 s, e o controlador ser√° colocado no modo de suspens√£o por 59 segundos.  Mas desde  Como o ciclo de trabalho √© mais complicado do que no receptor, o c√°lculo consistir√° em mais estados.  Para um ciclo de opera√ß√£o, o controlador consumir√° 1,006 s * (receptor de 18,5 mA + 2,4 mA MK) + 0,1 * (0,1 s * (receptor de 18,5 mA + LED de 1 mA + 2,4 mA MK + conversor de 2,2 mA + conversor de 2,2 mA em XX) + 0,02 s * (18,5 receptor mA + 1 mA LED + 2,4 mA MK + conversor de 13 mA)) + 59 s * (44 uA MK + 1 receptor de uA + 1 conversor de uA) = 21,0254 mA + 0,1 * (2,41 mA + 0,698 mA) + 2,714 mA = 24,0502 mA * s.  O coeficiente 0.1 reflete o fato de que em apenas um dos 10 ciclos trocamos o rel√©.  Dividindo o valor obtido por 60,126 s, obtemos o valor atual m√©dio por um segundo - 0,4 mA.  Vamos calcular a vida √∫til da bateria.  Como resultado, o tempo de opera√ß√£o te√≥rico do receptor de um conjunto de baterias √© de 10080000 mA * s / 0,4 mA / 3600 s / 24 h = 291 dias, desde que alteremos o estado do rel√© a cada 10 minutos. <br>  √â √≥bvio que nesses c√°lculos o tempo todo por mais de dois anos n√£o √© realizado devido √†s caracter√≠sticas qu√≠micas do dispositivo da bateria.  As baterias AA n√£o s√£o capazes de funcionar por mais de dois anos com uma fonte de alimenta√ß√£o constante do dispositivo, mesmo com uma corrente desprez√≠vel, apesar do fato de que a capacidade deve ser suficiente.  Mas tudo que tem menos de dois anos j√° se tornar√° uma limita√ß√£o de capacidade.  Infelizmente, os resultados do c√°lculo da vida √∫til do receptor n√£o se encaixam totalmente nas especifica√ß√µes t√©cnicas, mas nesta situa√ß√£o, eu me culpei. <br><br><h3>  Implementa√ß√£o de c√≥digo </h3><br>  Honestamente, sou c√©tico em rela√ß√£o ao Arduino e seus IDEs similares.  Comecei a entender microcontroladores de programa√ß√£o em C e trabalhar com registradores √© mais compreens√≠vel e previs√≠vel para mim do que chamadas veladas para fun√ß√µes de alto n√≠vel.  Embora, em geral, estudei a plataforma em si e alguns pequenos projetos, ainda o fa√ßo.  Ent√£o, desta vez, a pregui√ßa prevaleceu sobre mim.  Fui subornado pela disponibilidade de uma biblioteca pronta para m√≥dulos SI4432 para o Arduino e realmente n√£o queria perder tempo tentando port√°-lo para o CVAVR.  E o restante do c√≥digo √© extremamente simples.  Depois de passar v√°rias noites estudando as bibliotecas para trabalhar com o m√≥dulo, bem como o modo de suspens√£o do microcontrolador, as primeiras vers√µes dos esbo√ßos do receptor e do transmissor ficaram prontas rapidamente.  Em seguida, foi necess√°rio montar o hardware e j√° continuar o desenvolvimento com hardware real. <br><br><h3>  Est√° vivo ... </h3><br>  O servi√ßo online EasyEDA desenvolveu um projeto com um circuito e placas de circuito impresso.  Eu n√£o me incomodei com placas de dupla face, ent√£o coloquei jumpers na parte de tr√°s. <br>  Aqui est√° uma foto das placas transmissoras prontas ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ka/fp/t3/kafpt3ylwzfbat7rt-dsiv_lgjc.jpeg"></div><br>  ... e o receptor. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7c/j3/g3/7cj3g3e6jzdczljdenhmmxaet4w.jpeg"></div><br>  Para baterias, comprei suportes e tamb√©m comprei estojos.  Honestamente, eu queria em branco, mas n√£o t√≠nhamos um em estoque, ent√£o tive que colet√°-lo em preto. <br>  A montagem das placas foi realizada primeiro sem m√≥dulos, porque  voc√™ precisa preencher o primeiro programador do carregador de inicializa√ß√£o do controlador.  E como o m√≥dulo √© de 3,3 volts e o programador √© de 5 volts e eles usam o mesmo barramento, √© melhor soldar o m√≥dulo ap√≥s o firmware.  Verificado o poder, programado o gerenciador de inicializa√ß√£o.  Como n√£o h√° m√°scara de solda na placa, colei um peda√ßo de Kapton sob os m√≥dulos.  Soldou os m√≥dulos e come√ßou a depurar o firmware.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Imediatamente pisou em um ancinho na forma de congelamento de m√≥dulos, tudo acabou sendo trivial simples, o estabilizador de 3 volts que eu usei n√£o forneceu a corrente necess√°ria, depois de conectar o LBP ao receptor e as baterias ao transmissor, tudo funcionou de maneira est√°vel. Al√©m disso, instalei um capacitor eletrol√≠tico nas proximidades do conversor no circuito de pot√™ncia para inici√°-lo normalmente. Eu apenas tive que adicionar a l√≥gica restante descrita acima. Nas antenas padr√£o, a conex√£o acabou sendo muito est√°vel. Estruturalmente, o receptor e o transmissor se encaixam totalmente na caixa adquirida. As placas foram fixadas nas prateleiras padr√£o usando parafusos na parte inferior do estojo, e eu prendi os suportes da bateria a fita dupla face na parte superior. O gabinete est√° bem fechado, ent√£o eu n√£o o prendi adicionalmente com parafusos,e √© mais conveniente trocar as pilhas. Como resultado de mais algumas noites passadas em refinamentos e testes, obtive o resultado final.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/ft/om/wnftomqo54bb4zb_6feqwizz_qs.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qu/1g/oc/qu1goc6rx0xjwghyqirlkc2qdn0.jpeg"></div><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Carregador de inicializa√ß√£o </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algumas palavras devem ser ditas separadamente √†s custas do gerenciador de inicializa√ß√£o. </font><font style="vertical-align: inherit;">Para o Arduino, n√£o h√° carregadores padr√£o para quartzo de 4MHz, eles precisam ser montados separadamente, mas tive sorte, em busca de informa√ß√µes antes de iniciar o design, me deparei com um artigo de uma pessoa, ele estava fazendo uma esta√ß√£o meteorol√≥gica nos mesmos m√≥dulos e enfrentava os mesmos problemas. </font><font style="vertical-align: inherit;">Vou deixar um link para o artigo no final. </font><font style="vertical-align: inherit;">By the way, eu recomendo a leitura, a pessoa tamb√©m trabalhou duro. </font><font style="vertical-align: inherit;">Como resultado, ele tinha um gerenciador de inicializa√ß√£o pronto em seu reposit√≥rio e, como ele era de dom√≠nio p√∫blico, eu o usei.</font></font><br><br><h3>  Conclus√£o </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como resultado de mais de uma noite passada, foi constru√≠da uma estrutura completamente funcional com as caracter√≠sticas necess√°rias. </font><font style="vertical-align: inherit;">Agora, o dispositivo est√° funcionando h√° mais de tr√™s semanas, at√© agora n√£o houve reclama√ß√µes sobre sua opera√ß√£o, mas o tempo dir√° qu√£o verdadeiros foram meus c√°lculos. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para quem disser que foi poss√≠vel colocar um rel√© em 3 volts e n√£o se incomodar com o conversor, responderei que concordo totalmente com eles. </font><font style="vertical-align: inherit;">Mas para quem decide repetir o design, haver√° uma oportunidade de escolher sua solu√ß√£o. </font><font style="vertical-align: inherit;">No final, o engenheiro deve criar, e n√£o apenas copiar as constru√ß√µes conclu√≠das ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obrigado a todos que dominaram este artigo at√© o final, espero que tenha sido interessante. </font><font style="vertical-align: inherit;">Para todas as suas perguntas, sugest√µes e coment√°rios, por favor, comente.</font></font><br><br><h3>  Refer√™ncias: </h3><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artigo da esta√ß√£o meteorol√≥gica</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reposit√≥rio do GitHub</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esquemas e placas. </font><font style="vertical-align: inherit;">Receptor</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esquemas e placas. </font><font style="vertical-align: inherit;">Transmissor</font></font></a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt431272/">https://habr.com/ru/post/pt431272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt431260/index.html">Como funciona: o trabalho de uma equipe de analistas usando o exemplo do desenvolvimento de um servi√ßo digital</a></li>
<li><a href="../pt431262/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 19: ‚ÄúRedes An√¥nimas‚Äù, parte 1 (palestra do criador da rede Tor)</a></li>
<li><a href="../pt431264/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 19: ‚ÄúRedes An√¥nimas‚Äù, parte 2 (palestra do criador da rede Tor)</a></li>
<li><a href="../pt431266/index.html">Curso MIT "Seguran√ßa de sistemas de computadores". Palestra 19: ‚ÄúRedes An√¥nimas‚Äù, parte 3 (palestra do criador da rede Tor)</a></li>
<li><a href="../pt431270/index.html">Como montar o Apple 1 e escrever um jogo para ele</a></li>
<li><a href="../pt431274/index.html">Papai Noel para si mesmo: como um desenvolvedor de aplicativos pode ganhar o m√°ximo durante o per√≠odo de f√©rias?</a></li>
<li><a href="../pt431276/index.html">Por que os processadores Intel consomem mais do que o esperado: requisitos de dissipador de calor e modo turbo</a></li>
<li><a href="../pt431278/index.html">Voc√™ pode ser envolvido em um robom√≥vel - mas h√° uma solu√ß√£o para esse problema</a></li>
<li><a href="../pt431280/index.html">Vis√£o noturna: como os telefones Pixel v√™em no escuro</a></li>
<li><a href="../pt431282/index.html">Software lento</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>