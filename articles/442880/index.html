<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öïÔ∏è ü§π ü§∞üèø Puntos de verificaci√≥n virtuales: lista de verificaci√≥n de configuraci√≥n üíõ üë§ üéå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muchos clientes que alquilan recursos en la nube de nosotros usan Check Points virtuales. Con su ayuda, los clientes resuelven varios problemas: algui...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Puntos de verificaci√≥n virtuales: lista de verificaci√≥n de configuraci√≥n</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/442880/"><img src="https://habrastorage.org/webt/o2/xl/gk/o2xlgke6hdhz3btlzb10ynfm5r4.png"><br><br>  Muchos clientes que alquilan recursos en la nube de nosotros usan Check Points virtuales.  Con su ayuda, los clientes resuelven varios problemas: alguien controla el acceso del segmento del servidor a Internet o publica sus servicios para nuestro equipo.  Alguien necesita ejecutar todo el tr√°fico a trav√©s del blade IPS, mientras que alguien necesita Check Point como una puerta de enlace VPN para acceder a los recursos internos en el centro de datos desde las sucursales.  Hay quienes necesitan proteger su infraestructura en la nube para aprobar la certificaci√≥n de acuerdo con FZ-152, pero les contar√© esto por separado. <br><br>  De servicio, participo en el apoyo y la administraci√≥n de Check Points.  Hoy les dir√© qu√© considerar al implementar un cl√∫ster de puntos de control en un entorno virtual.  Me referir√© a momentos del nivel de virtualizaci√≥n, red, configuraci√≥n de Check Point y monitoreo. <br>  No prometo descubrir Am√©rica: hay mucho en las recomendaciones y mejores pr√°cticas del vendedor.  Pero nadie los lee), as√≠ que condujeron. <br><a name="habracut"></a><br><h3>  Modo de cl√∫ster </h3><br>  Tenemos Check Points en vivo en grupos.  La instalaci√≥n m√°s com√∫n es un grupo de dos nodos en modo de espera activa.  Si algo le sucede al nodo activo, se vuelve inactivo y el nodo en espera se enciende.  El cambio a un nodo "de repuesto" generalmente ocurre debido a problemas de sincronizaci√≥n entre los miembros del cl√∫ster, el estado de las interfaces, la pol√≠tica de seguridad establecida, simplemente debido a la gran carga en el equipo. <br><br>  En un cl√∫ster de dos nodos, no utilizamos el modo activo-activo. <br><br>  Si uno de los nodos cae, es posible que el nodo superviviente simplemente no pueda soportar la doble carga, y luego lo perderemos todo.  Si realmente quiere activo-activo, entonces el cl√∫ster debe tener al menos 3 nodos. <br><br><h3>  Configuraci√≥n de red y virtualizaci√≥n </h3><br>  <b>El tr√°fico de multidifusi√≥n entre las interfaces SYNC de los miembros del cl√∫ster est√° permitido en los equipos de red.</b>  <b>Si el tr√°fico de multidifusi√≥n no es posible, se utiliza el protocolo de sincronizaci√≥n (CCP).</b>  Los nodos en el cl√∫ster de Check Point se sincronizan entre s√≠.  Los mensajes sobre cambios se transmiten de nodo a nodo a trav√©s de multidifusi√≥n.  Check Point utiliza una implementaci√≥n de multidifusi√≥n no est√°ndar (se utiliza una direcci√≥n IP sin multidifusi√≥n).  Debido a esto, algunos equipos, como el switch Cisco Nexus, no entienden estos mensajes y, por lo tanto, los bloquean.  En este caso, cambie a transmisi√≥n. <br><br><img src="https://habrastorage.org/webt/od/yo/cz/odyoczg_ya75ovj4zfpquljfkdw.png"><br>  <i>Descripci√≥n del problema con Cisco Nexus y sus soluciones en el portal del proveedor.</i> <br><br>  En el nivel de virtualizaci√≥n, tambi√©n permitimos el paso del tr√°fico de multidifusi√≥n.  Si la multidifusi√≥n est√° prohibida para la sincronizaci√≥n de cl√∫ster (CCP), utilice la transmisi√≥n. <br><br>  En la consola de Check Point, con el comando cphaprob -a if, puede ver la configuraci√≥n de CPP y su modo de funcionamiento (multidifusi√≥n o difusi√≥n).  Para cambiar el modo operativo, use el comando de transmisi√≥n cphaconf set_ccp. <br><br><img src="https://habrastorage.org/webt/e6/ki/7j/e6ki7jzhw6py2bo9rf3v5wbz3wy.png"><br><br>  <b>Los nodos del cl√∫ster deben estar en diferentes hosts ESXi.</b>  Aqu√≠ todo est√° claro: cuando el host f√≠sico cae, el segundo nodo contin√∫a funcionando.  Esto se puede lograr utilizando las reglas anti-afinidad de DRS. <br><br>  <b>Dimensiones de la m√°quina virtual en la que se ejecutar√° Check Point.</b>  Las recomendaciones del proveedor son 2 vCPU y 6 GB, pero esto es para una configuraci√≥n m√≠nima, por ejemplo, si tiene un firewall con un ancho de banda m√≠nimo.  En nuestra experiencia de implementaci√≥n, cuando se usan m√∫ltiples blades de software, es aconsejable usar al menos 4 vCPU, 8 GB de RAM. <br>  En un nodo, asignamos un promedio de 150 GB de disco.  Al implementar un punto de control virtual, el disco se divide y podemos ajustar la cantidad de espacio asignado para el intercambio del sistema, la ra√≠z del sistema, los registros, la copia de seguridad y la actualizaci√≥n. <br><br>  Cuando aumenta la ra√≠z del sistema, tambi√©n es necesario aumentar la partici√≥n de copia de seguridad y actualizaci√≥n para mantener la proporci√≥n entre ellas.  Si no se respeta la proporci√≥n, es posible que la siguiente copia de seguridad no se ajuste al disco. <br><br>  <b>Aprovisionamiento de disco: aprovisionamiento grueso Lazy Zeroed.</b>  Check Point genera muchos eventos y registros, cada segundo aparecen 1000 entradas.  Debajo de ellos, es mejor reservar un lugar de inmediato.  Para hacer esto, al crear una m√°quina virtual, le asignamos un disco utilizando la tecnolog√≠a Thick Provisioning, es decir.  Reservamos espacio en el almacenamiento f√≠sico en el momento de la creaci√≥n del disco. <br><br>  Reserva de recursos configurada al 100% para Check Point durante la migraci√≥n entre hosts ESXi.  Recomendamos que reserve el 100% de los recursos para que la m√°quina virtual en la que se implementa Check Point no compita por los recursos con otras m√°quinas virtuales en el host. <br><br>  <b>Miscel√°neos</b>  Usamos la versi√≥n Check Point de R77.30.  Para ello, se recomienda utilizar RedHat Enterprise Linux versi√≥n 5 (64 bits) como sistema operativo invitado en una m√°quina virtual.  Desde controladores de red: VMXNET3 o Intel E1000. <br><br><h3>  Configuraci√≥n de punto de verificaci√≥n </h3><br>  <b>Las √∫ltimas actualizaciones de Check Point se instalan en las puertas de enlace y el servidor de administraci√≥n.</b>  Busque actualizaciones a trav√©s de CPUSE. <br><br><img src="https://habrastorage.org/webt/of/o_/dw/ofo_dw7xmv7s_ot1qgpz6svmkd0.png"><br><br>  Con Verifier, verificamos que el paquete de servicio que estamos a punto de instalar no entre en conflicto con el sistema. <br><br><img src="https://habrastorage.org/webt/f-/6z/cn/f-6zcnlkxh8vpat2cam5ciszoyi.png"><br><br><img src="https://habrastorage.org/webt/dr/y-/kp/dry-kpzjts8ky_7v-z-eonatnha.png"><br><br>  Verificador, por supuesto, es algo bueno, pero hay matices.  Algunas actualizaciones no son compatibles con el complemento, pero Verifier no mostrar√° estos conflictos y permitir√° la actualizaci√≥n.  Al final de la actualizaci√≥n, obtendr√° un error, y solo de √©l descubrir√° qu√© impide la actualizaci√≥n.  Por ejemplo, esta situaci√≥n se produjo con el paquete de servicio MABDA_001 (Mobile Access Blade Deployment Agent), que resuelve el problema de iniciar Java Plugin en navegadores que no sean IE. <br><br>  <b>Configuramos actualizaciones autom√°ticas diarias de firmas para IPS y otros blades de software.</b>  Check Point lanza firmas que pueden usarse para detectar o bloquear nuevas vulnerabilidades.  A las vulnerabilidades se les asigna autom√°ticamente un nivel de criticidad.  De acuerdo con este nivel y el filtro establecido, el sistema decide si detectar o bloquear la firma.  Aqu√≠ es importante no exagerar con los filtros, verificar peri√≥dicamente y hacer ajustes para que el tr√°fico leg√≠timo no se bloquee. <br><br><img src="https://habrastorage.org/webt/0p/hh/p-/0phhp-2og69lvtrtq8mfnrcwbf4.png"><br>  <i>Perfil IPS, donde seleccionamos la acci√≥n con respecto a la firma de acuerdo con sus par√°metros.</i> <br><br><img src="https://habrastorage.org/webt/n1/si/jb/n1sijbwodxv-p_ubudt8h_rqzne.png"><br>  <i>Configuraci√≥n de pol√≠ticas para este perfil IPS de acuerdo con la configuraci√≥n de la firma: nivel de gravedad, impacto en el rendimiento, etc.</i> <br><br>  <b>El hardware Check Point est√° configurado con el protocolo de sincronizaci√≥n horaria NTP.</b>  Seg√∫n las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">recomendaciones</a> , Check Point debe usar un servidor NTP externo para sincronizar la hora en el equipo.  Esto se puede hacer a trav√©s del portal web gaia. <br><br>  El tiempo configurado incorrectamente puede hacer que el cl√∫ster no est√© sincronizado.  Si no es el momento adecuado, es extremadamente inconveniente buscar la entrada de registro que nos interesa.  Cada entrada en los registros de eventos est√° marcada con una llamada marca de tiempo. <br><br><img src="https://habrastorage.org/webt/ce/ve/2x/ceve2x6z2nfrpuvablszwwjmnmk.jpeg"><br><br><img src="https://habrastorage.org/webt/rd/dm/gj/rddmgjxuih_jftgacbqp96nzaja.png"><br><br>  <b>Evento inteligente configurado para alertas sobre IPS, Control de aplicaciones, Anti-Bot, etc.</b> Este es un m√≥dulo separado con su propia licencia.  Si tiene uno, su uso es conveniente para visualizar informaci√≥n sobre el funcionamiento de todos los blades y dispositivos de software.  Por ejemplo, los ataques, la cantidad de operaciones de IPS, el nivel de criticidad de las amenazas, qu√© aplicaciones prohibidas son utilizadas por los usuarios, etc. <br><br><img src="https://habrastorage.org/webt/sm/ep/hi/smephijff9iy11roy-gkad-he7y.png"><br><br><img src="https://habrastorage.org/webt/px/ey/q8/pxeyq8x3j3uvpegh2vovripqtxi.png"><br>  <i>Estas son estad√≠sticas de 30 d√≠as seg√∫n el n√∫mero de firmas y el grado de su criticidad.</i> <br><br><img src="https://habrastorage.org/webt/qa/if/-y/qaif-yr2di_vhaskm2runvouki8.jpeg"><br>  <i>Informaci√≥n m√°s detallada sobre las firmas detectadas en cada blade de software.</i> <br><br><h3>  Monitoreo </h3><br>  Es importante monitorear al menos los siguientes par√°metros: <br><br><ul><li>  estado de cl√∫ster; </li><li>  disponibilidad de componentes de Check Point; </li><li>  Carga de la CPU </li><li>  espacio restante en disco; </li><li>  memoria libre </li></ul><br>  Check Point tiene una hoja de software separada: Smart Monitoring (licencia separada).  En √©l, tambi√©n puede monitorear la disponibilidad de componentes de Check Point, cargas en blades individuales y estados de licencia. <br><br><img src="https://habrastorage.org/webt/ql/oi/gz/qloigzwdx53cfz5blmpp8pugqnk.png"><br><br><img src="https://habrastorage.org/webt/om/su/2e/omsu2enoalcopmgatfhmmvchasc.png"><br>  <i>Gr√°fico de carga Chek Point.</i>  <i>Splash: este es el cliente que envi√≥ notificaciones push a 800 mil clientes.</i> <br><br><img src="https://habrastorage.org/webt/o4/dx/gf/o4dxgfya60iv0mj5hbfzwtqedxe.png"><br>  <i>El gr√°fico de la carga en el blade de Firewall en la misma situaci√≥n.</i> <br><br>  El monitoreo tambi√©n se puede configurar a trav√©s de servicios de terceros.  Por ejemplo, tambi√©n usamos Nagios, donde monitoreamos: <br><br><ul><li>  disponibilidad de red de equipos; </li><li>  Disponibilidad de direcci√≥n de cl√∫ster </li><li>  Carga de CPU por n√∫cleos.  Al descargar m√°s del 70%, llega una alerta por correo electr√≥nico.  Una carga tan alta puede indicar tr√°fico espec√≠fico (vpn, por ejemplo).  Si esto se repite con frecuencia, entonces quiz√°s no haya suficientes recursos y valga la pena expandir el grupo. </li><li>  RAM libre.  Si queda menos del 80%, lo descubriremos. </li><li>  carga de disco en ciertas particiones, por ejemplo var / log.  Si pronto se obstruye, entonces es necesario expandirse. </li><li>  Split Brain (a nivel de cl√∫ster).  Monitoreamos el estado cuando ambos nodos se activan y la sincronizaci√≥n entre ellos desaparece. </li><li>  Modo de alta disponibilidad: supervisamos que el cl√∫ster est√© en modo de espera activo.  Observamos los estados de los nodos: activo, en espera, inactivo. </li></ul><br><img src="https://habrastorage.org/webt/sa/6i/h6/sa6ih63oph6qaclqiwstgzclq2u.png"><br>  <i>Opciones de monitoreo en Nagios.</i> <br><br>  Tambi√©n vale la pena monitorear el estado de los servidores f√≠sicos en los que se implementan los hosts ESXi. <br><br><h3>  Copia de seguridad </h3><br>  El propio vendedor recomienda tomar una instant√°nea inmediatamente despu√©s de instalar la actualizaci√≥n (Hotfixies). <br><br>  Dependiendo de la frecuencia de los cambios, se configura una copia de seguridad completa una vez a la semana o al mes.  En nuestra pr√°ctica, hacemos copias incrementales diarias de los archivos de Check Point y una copia de seguridad completa una vez por semana. <br><br>  Eso es todo.  Estos fueron los puntos m√°s b√°sicos a tener en cuenta al implementar puntos de control virtuales.  Pero incluso cumplir con este m√≠nimo ayudar√° a evitar problemas con su trabajo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/442880/">https://habr.com/ru/post/442880/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442866/index.html">La IA entrenada durante d√©cadas de experimentaci√≥n culinaria crea nuevos platos.</a></li>
<li><a href="../442868/index.html">Una breve excursi√≥n a los sistemas de enfriamiento del centro de datos. Pros y contras</a></li>
<li><a href="../442870/index.html">Lo mejor del mundo de Angular para la semana - Digest No. 2 (26 de enero - 7 de marzo)</a></li>
<li><a href="../442872/index.html">C√≥mo encontr√© el huevo de Pascua en la protecci√≥n de Android y no consegu√≠ un trabajo en Google</a></li>
<li><a href="../442876/index.html">Mapeo de ruido con KSQL, Raspberry Pi y radio</a></li>
<li><a href="../442882/index.html">[Video] "No se necesitan piems" y tres ideas m√°s de gesti√≥n de proyectos</a></li>
<li><a href="../442884/index.html">La tecnolog√≠a ya le permite hablar con el autom√≥vil como persona.</a></li>
<li><a href="../442886/index.html">Sketch + Node.js: genera iconos para muchas plataformas y marcas. Parte 2</a></li>
<li><a href="../442888/index.html">Personalizar select en css puro</a></li>
<li><a href="../442890/index.html">CYOD? COPE? BYOD?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>