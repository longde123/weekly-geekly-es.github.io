<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úãüèΩ üõ£Ô∏è ‚õ∞Ô∏è PHP ass√≠ncrono. Porque üì∞ üé± üèê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Atualmente, a programa√ß√£o ass√≠ncrona est√° em demanda, especialmente no desenvolvimento da Web, onde a capacidade de resposta do aplicativo √© especialm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP ass√≠ncrono. Porque</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skyeng/blog/448968/"><img src="https://habrastorage.org/webt/vr/yd/zc/vrydzcqx0ogo5vfy-a2uzf0wmgs.jpeg" alt="imagem"><br><br>  Atualmente, a programa√ß√£o ass√≠ncrona est√° em demanda, especialmente no desenvolvimento da Web, onde a capacidade de resposta do aplicativo √© especialmente importante.  Ningu√©m quer esperar at√© que o aplicativo "afunde", mesmo que nesse momento execute uma consulta ao banco de dados, envie um email ou trabalhe em outras tarefas que podem levar muito tempo.  O cliente quer uma resposta para sua a√ß√£o, o melhor de tudo - imediatamente.  Se seu aplicativo for lento, voc√™ estar√° perdendo clientes.  Diante de um aplicativo flutuante, na maioria das vezes o usu√°rio simplesmente o fecha e nunca retorna.  Do ponto de vista do usu√°rio, o aplicativo travou, ele n√£o consegue entender por que isso aconteceu: ele executa uma opera√ß√£o complexa ou deixou de funcionar em princ√≠pio. <br><br>  <i>Apresentando a tradu√ß√£o de um artigo do desenvolvedor de back-end da Skyeng, Sergey Zhuk.</i> <br><a name="habracut"></a><br><h3>  Capacidade de resposta do aplicativo </h3><br>  Os aplicativos modernos geralmente respondem, mas algumas tarefas ou opera√ß√µes, como a troca de dados em uma rede, a E / S de arquivos ou a consulta de um banco de dados, podem consumir tempo e retardar significativamente o aplicativo.  Para impedir que essas opera√ß√µes bloqueiem o aplicativo, voc√™ pode execut√°-las em segundo plano, ocultando o atraso que elas causam.  Ao mesmo tempo, o aplicativo permanece responsivo porque pode continuar executando outras tarefas, por exemplo, retornar o fluxo de controle para a interface com o usu√°rio ou responder a outros eventos. <br><br><h3>  Concorr√™ncia e assincronia </h3><br>  Quando as pessoas veem c√≥digo ass√≠ncrono, na maioria das vezes pensam imediatamente: ‚Äú√ìtimo, eu posso paralelizar os processos!‚Äù.  Posso desapont√°-lo, mas na verdade n√£o √©.  Assincronia e simultaneidade n√£o s√£o a mesma coisa.  Pode ser dif√≠cil perceber essa diferen√ßa, ent√£o vamos tentar descobrir. <br><br>  Se as tarefas s√£o executadas de forma ass√≠ncrona, elas n√£o se bloqueiam e a execu√ß√£o de uma tarefa n√£o depende da conclus√£o de outra.  A simultaneidade, por sua vez, implica o lan√ßamento de v√°rias tarefas separadas simultaneamente como unidades de trabalho independentes. <br><br>  Assincronia: <br><blockquote>  V√° e complete a tarefa <b>voc√™ mesmo</b> .  Avise-me quando terminar e me mostre o resultado.  Neste momento, posso continuar fazendo meu trabalho. </blockquote><br>  C√≥digo ass√≠ncrono requer o processamento de depend√™ncias que surgem durante a execu√ß√£o de tarefas, e isso √© implementado usando retornos de chamada.  Quando uma tarefa √© conclu√≠da, o c√≥digo notifica outra tarefa.  O c√≥digo ass√≠ncrono √© basicamente o tempo que a tarefa leva para ser conclu√≠da (ordem dos eventos). <br><img src="https://habrastorage.org/webt/zu/np/3h/zunp3hgp9rim8pbath4tidi_icu.png" alt="imagem"><br>  Concorr√™ncia: <br><blockquote>  <b>Contrate quantos trabalhadores voc√™ desejar</b> e compartilhe a tarefa entre eles para conclu√≠-la mais rapidamente e me avise quando terminar.  Posso continuar fazendo outras coisas ou, se a tarefa for urgente, ficarei e esperarei at√© voc√™ retornar com os resultados.  Ent√£o eu posso compor o resultado final de todos os funcion√°rios.  A execu√ß√£o paralela geralmente requer mais recursos, ent√£o aqui depende basicamente do hardware. </blockquote><br><img src="https://habrastorage.org/webt/o9/ty/fp/o9tyfphmymspkaemitwjnhrikx0.png" alt="imagem"><br>  Para entender a diferen√ßa entre execu√ß√£o ass√≠ncrona e paralela usando um exemplo da vida real, comparamos dois servidores Web populares: Apache e Nginx.  Eles ilustram perfeitamente essa diferen√ßa.  O Nginx usa um modelo ass√≠ncrono baseado em evento, enquanto o Apache usa threads paralelos.  O Apache cria novos threads para cada conex√£o adicional; portanto, aqui o n√∫mero m√°ximo de conex√µes permitidas depende da quantidade de mem√≥ria dispon√≠vel no sistema.  Quando o limite de conex√£o √© atingido, o Apache para de criar conex√µes adicionais.  O fator limitante ao configurar o Apache √© a mem√≥ria (lembre-se de que a execu√ß√£o paralela geralmente depende do hardware).  Se o encadeamento parar, o cliente aguardar√° uma resposta at√© que o encadeamento esteja livre e possa enviar uma resposta. <br><br>  O Nginx n√£o funciona como o Apache - ele n√£o cria novos threads para cada solicita√ß√£o recebida.  O Nginx possui um fluxo de trabalho principal (ou v√°rios trabalhadores, geralmente para um processador, existe um fluxo de trabalho), que √© de thread √∫nico.  Este trabalhador pode processar milhares de conex√µes "simultaneamente" e faz de forma ass√≠ncrona, em um thread, e n√£o em paralelo em v√°rios threads. <br><br>  Assim, "assincronia" √© como constru√≠mos o sistema, √© uma composi√ß√£o de processos independentes um do outro.  Por "execu√ß√£o paralela" entende-se a execu√ß√£o de v√°rios processos no mesmo momento, enquanto eles podem ou n√£o estar relacionados.  Na execu√ß√£o ass√≠ncrona, processamos v√°rias tarefas ao mesmo tempo e, na execu√ß√£o paralela, iniciamos v√°rios processos ao mesmo tempo.  Pode parecer a mesma coisa, mas n√£o √©.  Assincronia descreve uma estrutura, paralelismo descreve uma maneira de faz√™-lo. <br><br>  A execu√ß√£o ass√≠ncrona pode ser comparada aos dispositivos de E / S no seu computador (mouse, teclado, tela).  Todos eles s√£o gerenciados pelo sistema operacional, mas cada um deles √© uma parte independente do kernel.  Esses processos s√£o ass√≠ncronos, podem ser paralelos, mas isso n√£o √© necess√°rio.  Portanto, para garantir consist√™ncia, voc√™ deve criar um link entre essas partes independentes para coorden√°-las. <br><br><h3>  E esse backend? </h3><br>  Voc√™ pode dizer que a capacidade de resposta n√£o √© t√£o importante no back-end.  Todas essas coisas ass√≠ncronas e legais com JavaScript acontecem em um freeend, e seu servidor apenas responde √†s solicita√ß√µes; portanto, um freeend deve responder pela capacidade de resposta do aplicativo, mas n√£o voc√™.  Sim, isso √© verdade, mas a tarefa do servidor n√£o se limita √†s respostas da API.  √Äs vezes, voc√™ precisa gerenciar tarefas complexas, por exemplo, baixar um v√≠deo.  Nesse caso, a capacidade de resposta pode n√£o ser um fator-chave, mas sua falta de recursos √© desperdi√ßada porque o aplicativo precisa ficar inativo.  Pode aguardar a conclus√£o das opera√ß√µes do sistema de arquivos, intera√ß√µes de rede, consultas ao banco de dados e similares.  Geralmente, essas opera√ß√µes de E / S s√£o muito lentas em compara√ß√£o com os c√°lculos do processador, por exemplo, quando convertemos arquivos de v√≠deo.  E enquanto salvamos ou lemos lentamente o arquivo, o processador √© for√ßado a aguardar, em vez de realizar um trabalho √∫til.  Como j√° descobrimos, em vez de esperar, podemos executar essas tarefas em segundo plano.  Como  V√° em frente. <br><br><h3>  PHP ass√≠ncrono </h3><br>  Em JavaScript, pronto para uso, est√£o dispon√≠veis suporte e solu√ß√µes integrados para escrever c√≥digo ass√≠ncrono.  H√° tamb√©m o Node.js, que permite gravar aplicativos de servidor ass√≠ncronos.  Em JavaScript, podemos usar a fun√ß√£o setTimeout () para demonstrar um exemplo de c√≥digo ass√≠ncrono: <br><img src="https://habrastorage.org/webt/j-/tx/mt/j-txmtg4lym_eu5fwk2qakt_s08.png" alt="imagem"><br><br>  Quando executamos esse c√≥digo, veremos o seguinte: <br><img src="https://habrastorage.org/webt/bk/fk/2r/bkfk2r_onqq6_yhyqzqbzsuqod8.png" alt="imagem"><br><br>  A fun√ß√£o setTimeout () envia o c√≥digo para a fila e o executa no final da pilha de chamadas atual.  Isso significa que interrompemos o fluxo s√≠ncrono de c√≥digo e atrasamos a execu√ß√£o.  A segunda chamada para console.log () √© realizada antes da chamada para a fila dentro da chamada setTimeout (). <br><br>  E o PHP?  No PHP, n√£o temos ferramentas adaptadas adequadas para escrever c√≥digo verdadeiramente ass√≠ncrono.  N√£o h√° equivalente a setTimeout () e n√£o podemos simplesmente atrasar ou enfileirar qualquer c√≥digo.  √â por isso que estruturas e bibliotecas como Amp e ReactPHP come√ßaram a aparecer.  A id√©ia deles √© ocultar os detalhes de baixo n√≠vel da linguagem e fornecer ao usu√°rio ferramentas de alto n√≠vel que permitem escrever c√≥digo ass√≠ncrono e gerenciar a execu√ß√£o competitiva de processos como JavaScript e Node.js. <br><br><h3>  Por que devo usar o PHP se houver Node.js e Go? </h3><br>  Essa pergunta geralmente surge quando se trata de PHP ass√≠ncrono.  Por alguma raz√£o, muitos s√£o contra o uso do PHP para escrever c√≥digo ass√≠ncrono.  Algu√©m sempre sugere usar Go ou Node.js. em vez de PHP. <br><br>  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tweet</a> assertchris descreve perfeitamente essas situa√ß√µes: <br><br><img src="https://habrastorage.org/webt/hz/gd/gs/hzgdgsarcixle4sahqsvummqkvs.png" alt="imagem"><br><br>  Obviamente, quando o PHP estava sendo criado, n√£o havia nenhum objetivo em torn√°-lo uma linguagem de programa√ß√£o que pode ser usada para criar aplicativos grandes e complexos.  Naquele momento, ningu√©m pensava em JavaScript ou assincronia.  Mas agora temos um PHP completamente diferente que j√° possui suas pr√≥prias fun√ß√µes para escrever c√≥digo ass√≠ncrono (por exemplo, a fun√ß√£o stream_select ()). <br><br>  Sim, voc√™ pode usar Go ou Node.js para criar aplicativos de servidor ass√≠ncronos, mas isso nem sempre resolve o problema.  Se voc√™ j√° possui uma vasta experi√™ncia com PHP, ser√° muito mais f√°cil aprender as bibliotecas e ferramentas apropriadas para sua situa√ß√£o do que aprender um novo idioma e um novo ecossistema.  Ferramentas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ReactPHP</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Amp</a> permitem que voc√™ escreva c√≥digo ass√≠ncrono da mesma forma que em Node.js.  Essas ferramentas s√£o bastante desenvolvidas e t√™m vers√µes est√°veis, para que voc√™ possa us√°-las com seguran√ßa na produ√ß√£o. <br><br><h3>  N√£o apenas CLI </h3><br><blockquote>  N√£o vou escrever um bate-papo, servidor ou algo assim.  Eu s√≥ quero acelerar o site. </blockquote><br>  √â geralmente aceito que o c√≥digo ass√≠ncrono pode ser usado apenas em scripts da CLI.  √â absolutamente normal integrar alguns componentes ass√≠ncronos em um ambiente s√≠ncrono tradicional, mesmo em um aplicativo Web tradicional.  Por exemplo, voc√™ pode receber uma solicita√ß√£o e, em seguida, chamar v√°rios recursos diferentes de forma ass√≠ncrona. Quando essas chamadas s√£o conclu√≠das, voc√™ pode continuar o ciclo de vida da resposta √† solicita√ß√£o e, como resultado, a p√°gina ser√° exibida mais rapidamente. <br><br>  Ou voc√™ precisa fazer algumas chamadas externas √† API - por exemplo, quando um usu√°rio conclui um pagamento, voc√™ deseja enviar um email ou uma notifica√ß√£o por push.  Voc√™ pode fazer essas chamadas de API de forma ass√≠ncrona e continuar seu fluxo de c√≥digo s√≠ncrono tradicional.  N√£o h√° necessidade de reescrever completamente o aplicativo e excluir tudo o que diminui a velocidade.  Basta identificar gargalos que interferem no desempenho e √© poss√≠vel que eles possam ser corrigidos usando c√≥digo ass√≠ncrono. <br><br>  Sim, na maioria dos casos, o c√≥digo ass√≠ncrono ainda √© usado nos scripts da CLI, mas n√£o est√° limitado a bate-papos e servidores em tempo real.  Se voc√™ deseja apenas acelerar o site, n√£o precisa abrir m√£o da estrutura do Symfony ou do Laravel e criar seu pr√≥prio servidor de aplicativos completamente ass√≠ncrono. <br><br><h3>  Conclus√£o </h3><br>  N√£o tenha medo de aprender um novo paradigma.  O PHP √© muito mais do que "executar um script, executar c√≥digo e morrer".  Voc√™ ficar√° surpreso ao perceber que pode usar o PHP familiar de uma maneira completamente nova, como se nunca o tivesse usado!  O c√≥digo ass√≠ncrono e a programa√ß√£o orientada a eventos expandir√£o sua compreens√£o do PHP e as possibilidades de uso dessa linguagem.  Voc√™ n√£o precisa aprender um novo idioma para escrever aplicativos ass√≠ncronos apenas porque "PHP √© uma ferramenta inadequada" ou "Eu sempre fiz isso, n√£o pode ser aprimorado".  Apenas tente! <br><br>  Bem, lembramos tamb√©m que sempre temos muitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vagas interessantes</a> para desenvolvedores! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt448968/">https://habr.com/ru/post/pt448968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt448958/index.html">Como a Amazon escolhe suas ofertas aparentemente aleat√≥rias do dia. E por que os vendedores est√£o t√£o atr√°s deles</a></li>
<li><a href="../pt448960/index.html">Tecnologia XR ilimitada na era da computa√ß√£o distribu√≠da</a></li>
<li><a href="../pt448962/index.html">A efic√°cia do funil de marketing AARRR</a></li>
<li><a href="../pt448964/index.html">A torradeira oferece aos usu√°rios mais direitos</a></li>
<li><a href="../pt448966/index.html">Aplicativo para Android na mem√≥ria. Relat√≥rio de otimiza√ß√£o para Yandex.Luncher</a></li>
<li><a href="../pt448970/index.html">Autentica√ß√£o de dois fatores para SSH</a></li>
<li><a href="../pt448974/index.html">Abordagem sem servidor para o r√°pido desenvolvimento de um servi√ßo de v√≠deo em funcionamento</a></li>
<li><a href="../pt448976/index.html">Eventos de primavera Gamedev em HSE</a></li>
<li><a href="../pt448980/index.html">Nosso primeiro almo√ßo juntos: por que e como passamos o dia do teste</a></li>
<li><a href="../pt448982/index.html">CMS sem cabe√ßa. Por que estou escrevendo o meu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>