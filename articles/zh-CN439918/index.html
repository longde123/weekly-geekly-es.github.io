<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ’’ ğŸ‘¨ğŸ¿â€ğŸ« ğŸ™† åœ¨å±±ä¸Šstandsç«‹ç€Spring Boot ... ğŸŒ ğŸ—“ï¸ ğŸ’¹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="...ä»–çš„å››ä¸ªæ­£åœ¨è°ƒè¯•ã€‚ 


å—Vladimir Plizgiçš„ä¸€ä»½æŠ¥å‘Šï¼ˆ Spring Boot 2ï¼šä»–ä»¬åœ¨å‘è¡Œè¯´æ˜ä¸­æœªå†™çš„å†…å®¹ ï¼‰çš„å¯å‘ï¼Œæˆ‘å†³å®šè°ˆè®ºä¸€ä¸‹æˆ‘åœ¨Spring Boothä¸Šçš„ç»å†ï¼Œå…¶åŠŸèƒ½å’Œé‡åˆ°çš„é™·é˜±ã€‚ 
 æ˜¥å­£æ•°æ®JPA 


 å¼—æ‹‰åŸºç±³å°”ï¼ˆVladimirï¼‰çš„æŠ¥å‘Šè‡´åŠ›äºè¿ç§»åˆ°Spr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨å±±ä¸Šstandsç«‹ç€Spring Boot ...</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439918/"><p>  ...ä»–çš„å››ä¸ªæ­£åœ¨è°ƒè¯•ã€‚ </p><br><p>å—Vladimir Plizgiçš„ä¸€ä»½æŠ¥å‘Šï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Spring Boot 2ï¼šä»–ä»¬åœ¨å‘è¡Œè¯´æ˜ä¸­æœªå†™çš„å†…å®¹</a> ï¼‰çš„å¯å‘ï¼Œæˆ‘å†³å®šè°ˆè®ºä¸€ä¸‹æˆ‘åœ¨Spring Boothä¸Šçš„ç»å†ï¼Œå…¶åŠŸèƒ½å’Œé‡åˆ°çš„é™·é˜±ã€‚ </p><a name="habracut"></a><br><h4 id="spring-data-jpa"> æ˜¥å­£æ•°æ®JPA </h4><br><p> å¼—æ‹‰åŸºç±³å°”ï¼ˆVladimirï¼‰çš„æŠ¥å‘Šè‡´åŠ›äºè¿ç§»åˆ°Spring Booth 2ä»¥åŠç”±æ­¤å¸¦æ¥çš„å›°éš¾ã€‚ åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œä»–æè¿°äº†ç¼–è¯‘é”™è¯¯ï¼Œå› æ­¤æˆ‘ä¹Ÿå°†ä»å®ƒä»¬å¼€å§‹ã€‚ </p><br><p>æˆ‘è®¤ä¸ºè®¸å¤šäººéƒ½ç†Ÿæ‚‰Spring Dataæ¡†æ¶åŠå…¶ç”¨äºå„ç§æ•°æ®ä»“åº“çš„æ´¾ç”Ÿå·¥å…·ã€‚ æˆ‘åªä½¿ç”¨å…¶ä¸­ä¹‹ä¸€-Spring Data JPAã€‚ æ­¤æ¡†æ¶ä¸­ä½¿ç”¨çš„ä¸»è¦æ¥å£<code>JpaRepository</code>åœ¨ç‰ˆæœ¬2ä¸­è¿›è¡Œäº†é‡å¤§æ›´æ”¹ã€‚ </p><br><p> è€ƒè™‘æœ€å¸¸ç”¨çš„æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// interface JpaRepository&lt;T, ID&gt; { T findOne(ID id); List&lt;T&gt; findAll(Iterable&lt;ID&gt; ids); &lt;S extends T&gt; Iterable&lt;S&gt; save(Iterable&lt;S&gt; entities); } // interface JpaRepository&lt;T, ID&gt; { Optional&lt;T&gt; findById(ID id); List&lt;T&gt; findAllById(Iterable&lt;ID&gt; ids); &lt;S extends T&gt; Iterable&lt;S&gt; saveAll(Iterable&lt;S&gt; entities); }</span></span></code> </pre> <br><p> å®é™…ä¸Šï¼Œè¿˜æœ‰æ›´å¤šæ›´æ”¹ï¼Œå¹¶ä¸”ç§»è‡³ç‰ˆæœ¬2ä¹‹åã€‚*æ‰€æœ‰è¿™äº›éƒ½å°†å˜æˆç¼–è¯‘é”™è¯¯ã€‚ </p><br><p> å½“æˆ‘ä»¬çš„ä¸€ä¸ªé¡¹ç›®æå‡ºäº†è¿ç§»åˆ°Spring Booth 2çš„é—®é¢˜å¹¶é‡‡å–äº†ç¬¬ä¸€æ­¥ï¼ˆæ›¿æ¢pom.xmlä¸­çš„ç‰ˆæœ¬ï¼‰æ—¶ï¼Œæ•´ä¸ªé¡¹ç›®å®é™…ä¸Šå˜æˆäº†çº¢è‰²ï¼šæ•°åä¸ªå­˜å‚¨åº“å’Œå¯¹å…¶æ–¹æ³•çš„æ•°ç™¾æ¬¡è°ƒç”¨å¯¼è‡´äº†è¿ç§»â€œï¼ˆä½¿ç”¨æ–°æ–¹æ³•ï¼‰å°†æ¯éš”ä¸€ä¸ªé’©æ–‡ä»¶ã€‚ æƒ³è±¡ä¸€ä¸‹æœ€ç®€å•çš„ä»£ç ï¼š </p><br><pre> <code class="java hljs">SomeEntity something = someRepository.findOne(someId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (something == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { something = someRepository.save(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SomeEntity()); } useSomething(something);</code> </pre> <br><p> ä¸ºäº†ä½¿é¡¹ç›®é¡ºåˆ©è¿›è¡Œï¼Œæ‚¨éœ€è¦ï¼š </p><br><ul><li> è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³• </li><li> å°†å˜é‡çš„ç±»å‹æ›´æ”¹ä¸º<code>Optional&lt;SomeEntity&gt;</code> </li><li> ç”¨<code>Optional::isPresent</code>æˆ–<code>Optional::orElse</code> / <code>Optional::orElseGet</code>æ›¿æ¢æ£€æŸ¥ç©ºå¼•ç”¨ </li><li> ä¿®å¤æµ‹è¯• </li></ul><br><p> å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œå› ä¸ºSpring Dateä¸ºç”¨æˆ·æä¾›äº†å‰æ‰€æœªæœ‰çš„æœºä¼šï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å®šåˆ¶å­˜å‚¨åº“ã€‚ æˆ‘ä»¬éœ€è¦å®šä¹‰ï¼ˆå¦‚æœå°šæœªå®šä¹‰ï¼‰æ¥å£å’Œç±»ï¼Œè¿™äº›æ¥å£å’Œç±»å°†æ„æˆæˆ‘ä»¬é¡¹ç›®çš„æ‰€æœ‰å­˜å‚¨åº“çš„åŸºç¡€ã€‚ è¿™æ ·åšæ˜¯è¿™æ ·çš„ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    @NoRepositoryBean public interface BaseJpaRepository&lt;T, ID extends Serializable&gt; extends JpaRepository&lt;T, ID&gt; { //   findOne,     1.* @Deprecated T findOne(ID id); //    findAll @Deprecated //         List&lt;T&gt; findAll(Iterable&lt;ID&gt; ids); }</span></span></code> </pre> <br><p> æˆ‘ä»¬æ‰€æœ‰çš„å­˜å‚¨åº“éƒ½å°†ä»è¯¥æ¥å£ç»§æ‰¿ã€‚ ç°åœ¨æ‰§è¡Œï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseJpaRepositoryImpl</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ID</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleJpaRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ID</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseJpaRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ID</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> JpaEntityInformation&lt;T, ?&gt; entityInfo; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> EntityManager entityManager; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BaseJpaRepositoryImpl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JpaEntityInformation&lt;T, ?&gt; entityInfo, EntityManager entityManager)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(entityInfo, entityManager); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.entityInfo = entityInfo; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.entityManager = entityManager; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findOne</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ID id)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> findById(id).orElse(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    1.* } @Override public List&lt;T&gt; findAll(Iterable&lt;ID&gt; ids) { return findAllById(ids); //      } }</span></span></code> </pre> <br><p> å‰©ä¸‹çš„å°±æ˜¯å½¢è±¡å’Œè‚–åƒã€‚ æ‰€æœ‰çš„ç¼–è¯‘é”™è¯¯éƒ½æ¶ˆå¤±äº†ï¼Œä»£ç åƒä»¥å‰ä¸€æ ·å·¥ä½œï¼Œåªæ›´æ”¹äº†2ä¸ªç±»ï¼Œè€Œä¸æ˜¯200ä¸ªç±»ã€‚ç°åœ¨ï¼Œéšç€å¼€å‘çš„è¿›è¡Œï¼Œæ‚¨å¯ä»¥æ…¢æ…¢åœ°ç”¨æ–°çš„APIæ›¿æ¢è¿‡æ—¶çš„APIï¼Œå› ä¸ºIdeaä¼šå°å¿ƒåœ°å°†@Deprecatedæ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨æŸ“æˆé»„è‰²ã€‚ </p><br><p> æœ€åä¸€æ‹›-æˆ‘ä»¬é€šçŸ¥Springä»ç°åœ¨å¼€å§‹ï¼Œå­˜å‚¨åº“åº”è¯¥å»ºç«‹åœ¨æˆ‘ä»¬çš„ç±»ä¹‹ä¸Šï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@EnableJpaRepositories</span></span>(repositoryBaseClass = BaseJpaRepositoryImpl.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeConfig</span></span></span></span>{ }</code> </pre> <br><h4 id="v-tihom-omute-biny-vodyatsya"> åœ¨ä¸€ä¸ªå¹³é™çš„æ¸¸æ³³æ± ä¸­ï¼Œå¯ä»¥æ‰¾åˆ°åƒåœ¾ç®± </h4><br><p>  Spring BoothåŸºäºä¸¤ä¸ªæ¦‚å¿µ-å¯åŠ¨å™¨å’Œè‡ªåŠ¨é…ç½®ã€‚ åœ¨ç”Ÿæ´»ä¸­ï¼Œè¿™çš„ç»“æœæ˜¯ä¸€ä¸ªé‡è¦çš„å±æ€§-è¿›å…¥åº”ç”¨ç¨‹åºç±»è·¯å¾„çš„åº“å°†ç”±SBæ‰«æï¼Œå¦‚æœåœ¨å…¶ä¸­æ‰¾åˆ°åŒ…å«æŸä¸ªè®¾ç½®çš„ç±»ï¼Œåˆ™è¯¥ç±»å°†åœ¨æ‚¨ä¸çŸ¥æƒ…å’Œæ˜ç¡®æŒ‡ç¤ºçš„æƒ…å†µä¸‹æ‰“å¼€ã€‚ æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­è¯´æ˜è¿™ä¸€ç‚¹ã€‚ </p><br><p> è®¸å¤šäººä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gson</a>åº“å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼Œåä¹‹äº¦ç„¶ã€‚ æ‚¨é€šå¸¸å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä»£ç ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T obj)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Gson().toJson(obj); } }</code> </pre> <br><p> é¢‘ç¹è®¿é—®æ—¶ï¼Œæ­¤ä»£ç å°†å¦å¤–åŠ è½½åƒåœ¾å›æ”¶å™¨ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›çš„ã€‚ ç‰¹åˆ«èªæ˜çš„äººä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶ä½¿ç”¨å®ƒï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeConfig</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Gson </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Gson(); } } <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequiredArgsConstructor</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Gson gson; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T obj)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gson.toJson(obj); } }</code> </pre> <br><p>  ...ç”šè‡³æ²¡æœ‰æ„è¯†åˆ°Spring Boothå¯ä»¥è‡ªå·±åšæ‰€æœ‰äº‹æƒ…ã€‚ ç¼ºçœæƒ…å†µä¸‹ï¼ŒSBå¸¦æœ‰<code>org.springframework.boot:spring-boot-autoconfigure</code>ä¾èµ–é¡¹ï¼Œå…¶ä¸­åŒ…æ‹¬è®¸å¤šåä¸º<code>*AutoConfiguration</code>ç±»ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnClass</span></span>(Gson.class) <span class="hljs-meta"><span class="hljs-meta">@EnableConfigurationProperties</span></span>(GsonProperties.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GsonAutoConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnMissingBean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> GsonBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gsonBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;GsonBuilderCustomizer&gt; customizers)</span></span></span><span class="hljs-function"> </span></span>{ GsonBuilder builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GsonBuilder(); customizers.forEach((c) -&gt; c.customize(builder)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> builder; } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnMissingBean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Gson </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GsonBuilder gsonBuilder)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gsonBuilder.create(); } }</code> </pre> <br><p> è®¾ç½®å¾ˆç®€å•ï¼šå¦‚æœåº”ç”¨ç¨‹åºä¸­æœ‰<code>Gson</code>ç±»ï¼Œå¹¶ä¸”æ²¡æœ‰è¿™ç§ç±»å‹çš„æ‰‹åŠ¨å®šä¹‰çš„beanï¼Œé‚£ä¹ˆå°†åˆ›å»ºä¸€ä¸ªé»˜è®¤å®ç°ã€‚ è¿™æ˜¯ä¸€ç§å·¨å¤§çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸ä¸€ä¸ªä¾èµ–é¡¹å’Œå‡ ä¸ªæ³¨é‡Šæ¥å¼•å‘ä¸€ä¸ªå®Œæ•´çš„é…ç½®ï¼Œè¯¥é…ç½®çš„æè¿°è¿‡å»é€šå¸¸é‡‡ç”¨XMLå·¥ä½œè¡¨å’Œè®¸å¤šæ‰‹å†™çš„binã€‚ </p><br><p> ä½†è¿™æ˜¯å®‰å…¨ç†äº‹ä¼šçš„æå¤§é˜´é™©ã€‚ é˜´é™©åœ¨äºä¿å¯†ï¼Œå› ä¸ºæ ¹æ®é¢„å…ˆç¼–å†™çš„è„šæœ¬ï¼Œå¾ˆå¤šå·¥ä½œåœ¨åå°è¿›è¡Œã€‚ è¿™å¯¹äºå…¸å‹çš„åº”ç”¨ç¨‹åºæ˜¯å¾ˆå¥½çš„ï¼Œä½†æ˜¯ç¦»å¼€äººè¿¹ç½•è‡³çš„è½¨é“å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜-è½¦é˜Ÿå°„å‡»æ—¶æ²¡æœ‰è­¦å‘Šã€‚ åœ¨æˆ‘ä»¬ä¸äº†è§£çš„æƒ…å†µä¸‹åˆ›å»ºäº†è®¸å¤šbeanï¼ŒGsonçš„ç¤ºä¾‹å¾ˆå¥½åœ°è¯´æ˜äº†è¿™ä¸€ç‚¹ã€‚ å°å¿ƒç±»å’Œæ‚¨çš„ä¾èµ–é¡¹ï¼Œå› ä¸º... </p><br><h4 id="vsyo-chto-popadyot-v-vash-classpath-mozhet-byt-ispolzovano-protiv-vas"> ä»»ä½•è¿›å…¥æ‚¨çš„ç±»è·¯å¾„çš„ä¸œè¥¿éƒ½å¯ä»¥ç”¨æ¥å¯¹ä»˜æ‚¨ã€‚ </h4><br><p> äººç”Ÿæ¡ˆä¾‹ã€‚ æœ‰ä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼šä¸€ä¸ªä½¿ç”¨<code>LdapTemplate</code> ï¼Œå¦ä¸€ä¸ªä½¿ç”¨ä¸€æ¬¡ã€‚ è¿™ä¸¤ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¾èµ–äº<code>core</code>é¡¹ç›®ï¼Œåœ¨è¯¥é¡¹ç›®ä¸­å–å‡ºäº†ä¸€äº›é€šç”¨çš„ç±»ï¼Œå¹¶ä¸”å°†è¿™ä¸¤ä¸ªåº”ç”¨ç¨‹åºçš„é€šç”¨åº“ä»”ç»†æŠ˜å åœ¨pom.xmlä¸­ã€‚ </p><br><p> ä¸€æ®µæ—¶é—´åï¼Œåœ¨ç¬¬äºŒä¸ªé¡¹ç›®ä¸­ï¼Œä¸å¿…è¦åœ°<code>LdapTemplate</code>å¯¹<code>LdapTemplate</code>æ‰€æœ‰ä½¿ç”¨ã€‚ ä½†æ˜¯<code>org.springramework:spring-ldap</code>åº“ä»ç„¶å¤„äº<code>core</code> ã€‚ ç„¶åSBç½¢å·¥äº†ï¼Œ <code>org.springramework.ldap:ldap-core</code>å˜æˆäº†<code>org.springramework.boot:spring-boot-starter-data-ldap</code> ã€‚ </p><br><p> å› æ­¤ï¼Œæœ‰è¶£çš„æ¶ˆæ¯å‡ºç°åœ¨æ—¥å¿—ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">Multiple Spring Data modules found, entering strict repository configuration mode! Spring Data LDAP - Could not safely identify store assignment for repository candidate interface ....</code> </pre> <br><p> å¯¹<code>core</code>é¢†å¯¼çš„<code>org.springramework.boot:spring-boot-starter-data-ldap</code>ä¾èµ–<code>org.springramework.boot:spring-boot-starter-data-ldap</code>é€‚ç”¨äºå®Œå…¨ä¸ä½¿ç”¨LDAPçš„é¡¹ç›®ã€‚ çŠ¹è±«æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ æ‰“classpath :)ã€‚ è¿›ä¸€æ­¥çš„åœæ­¢ï¼š </p><br><ul><li>  Spring Bootæ³¨æ„åˆ°<code>org.springramework.boot:spring-boot-starter-data-ldap</code> classpathä¸­çš„<code>org.springramework.boot:spring-boot-starter-data-ldap</code> </li><li> ç°åœ¨æ£€æŸ¥æ¯ä¸ªå­˜å‚¨åº“ï¼Œä»¥æŸ¥çœ‹å®ƒæ˜¯å¦é€‚åˆä¸Spring Data JPAæˆ–Spring Data LDAPä¸€èµ·ä½¿ç”¨ </li><li> é‡ç»„ä¾èµ–å…³ç³»å¹¶<code>org.springramework.boot:spring-boot-starter-data-ldap</code>ä¸å¿…è¦çš„<code>org.springramework.boot:spring-boot-starter-data-ldap</code>å°†åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶é—´å¹³å‡ç¼©çŸ­äº†20ï¼ˆï¼ï¼‰ç§’ï¼Œæ€»å…±40-50ç§’ </li></ul><br><p> ç»†å¿ƒä¸”æŒ‘å‰”çš„è¯»è€…å¯èƒ½ä¼šé—®ï¼šå¦‚æœä¸ä½¿ç”¨Spring Data LDAPï¼Œä½†ä»…ä½¿ç”¨ä¸€ä¸ªï¼Œä¸ºä»€ä¹ˆéœ€è¦å°†<code>org.springramework.ldap:ldap-core</code>æ›´æ”¹ä¸º<code>org.springramework.boot:spring-boot-starter-data-ldap</code>ç±»<code>org.springframework.ldap.LdapTempate</code>å—ï¼Ÿ </p><br><p> ç­”ï¼šè¿™æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ äº‹å®æ˜¯ï¼Œåœ¨2.1.0.M1ç‰ˆæœ¬ä¹‹å‰ï¼ŒLDAPçš„è‡ªåŠ¨è°ƒæ•´çœ‹èµ·æ¥åƒè¿™æ · </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnClass</span></span>({ContextSource.class}) <span class="hljs-meta"><span class="hljs-meta">@EnableConfigurationProperties</span></span>({LdapProperties.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LdapAutoConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> LdapProperties properties; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Environment environment; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LdapAutoConfiguration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LdapProperties properties, Environment environment)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties = properties; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.environment = environment; } <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnMissingBean</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ContextSource </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ldapContextSource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ LdapContextSource source = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LdapContextSource(); source.setUserDn(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties.getUsername()); source.setPassword(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties.getPassword()); source.setBase(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties.getBase()); source.setUrls(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties.determineUrls(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.environment)); source.setBaseEnvironmentProperties(Collections.unmodifiableMap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.properties.getBaseEnvironment())); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> source; } }</code> </pre> <br><p>  <code>LdapTemplate</code>åœ¨å“ªé‡Œï¼Ÿ ä½†æ˜¯ä»–ä¸æ˜¯:)ã€‚ æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå®ƒåœ¨ä½†ä½äºå…¶ä»–åœ°æ–¹ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Configuration</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnClass</span></span>({LdapContext.class, LdapRepository.class}) <span class="hljs-meta"><span class="hljs-meta">@AutoConfigureAfter</span></span>({LdapAutoConfiguration.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LdapDataAutoConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Bean</span></span> <span class="hljs-meta"><span class="hljs-meta">@ConditionalOnMissingBean</span></span>({LdapOperations.class}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> LdapTemplate </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ldapTemplate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ContextSource contextSource)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LdapTemplate(contextSource); } }</code> </pre> <br><p> å› æ­¤ï¼Œå‡è®¾æ‚¨<code>LdapTemplate</code>é€šè¿‡æ»¡è¶³<code>@ConditionalOnClass({LdapContext.class, LdapRepository.class})</code> <code>LdapTemplate</code>åœ¨åº”ç”¨ç¨‹åºä¸­è·å–<code>LdapTemplate</code> ï¼Œè¿™æ˜¯åœ¨å°†<code>spring-boot-starter-data-ldap</code>ä¾èµ–é¡¹æ·»åŠ åˆ°ç±»è·¯å¾„ä¸­æ—¶å®ç°çš„ã€‚ </p><br><p> å¦ä¸€ç§å¯èƒ½æ€§ï¼šç”¨æ‚¨çš„åŒæ‰‹ç¡®å®šè¿™ä¸ªbeanï¼Œè¿™æ˜¯æ‚¨ä¸æƒ³è¦çš„ï¼ˆå› ä¸ºä¸ºä»€ä¹ˆæˆ‘ä»¬é‚£æ—¶éœ€è¦SBï¼‰ã€‚  <code>org.springramework.boot:spring-boot-starter-data-ldap</code>åœ¨ç”¨<code>org.springramework.ldap:ldap-core</code>æ›¿æ¢äº†<code>org.springramework.boot:spring-boot-starter-data-ldap</code>ä¹‹åæå‡ºäº†è¿™ä¸ªå»ºè®®ã€‚ </p><br><p> é—®é¢˜å·²åœ¨æ­¤å¤„è§£å†³ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//github.com/spring-projects/spring-boot/pull/13136</a> ã€‚ ä¸»è¦æ›´æ”¹ï¼š <code>LdapTemplate</code> bean <code>LdapTemplate</code>ç§»è‡³<code>LdapAutoConfiguration</code> ã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨LDAPï¼Œè€Œæ— éœ€ç»‘å®šåˆ°<code>spring-boot-starter-data-ldap</code>å¹¶æ‰‹åŠ¨å®šä¹‰<code>LdapTemplate</code> binã€‚ </p><br><h4 id="podkapotnaya-voznya"> èƒ¡å¾·å¤§æƒŠå°æ€ª </h4><br><p> å¦‚æœæ‚¨ä½¿ç”¨Hibernateï¼Œåˆ™æ‚¨å¯èƒ½ç†Ÿæ‚‰â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰“å¼€è§†å›¾â€</a>åæ¨¡å¼ã€‚ æˆ‘ä»¬å°†ä¸å»èµ˜è¿°å®ƒçš„æè¿°ï¼Œé€šè¿‡å¼•ç”¨å¯¹å…¶è¿›è¡Œè¶³å¤Ÿè¯¦ç»†çš„æè¿°ï¼Œå¹¶ä¸”åœ¨å…¶ä»–æ¥æºä¸­å°†å¯¹å…¶æœ‰å®³ä½œç”¨è¿›è¡Œéå¸¸è¯¦ç»†çš„æè¿°ã€‚ </p><br><p> ç‰¹æ®Šæ ‡å¿—è´Ÿè´£æ‰“å¼€/å…³é—­æ­¤æ¨¡å¼ï¼š </p><br><pre> <code class="plaintext hljs">spring: jpa: open-in-view: true</code> </pre> <br><p> åœ¨SBç‰ˆæœ¬1ä¸­ã€‚*é»˜è®¤æƒ…å†µä¸‹å¯ç”¨æ­¤åŠŸèƒ½ï¼Œè€Œç”¨æˆ·æœªè·æ‚‰ã€‚ åœ¨ç‰ˆæœ¬2ä¸­ã€‚*ä»å¤„äºå¯ç”¨çŠ¶æ€ï¼Œä½†æ˜¯ç°åœ¨å°†è­¦å‘Šå†™å…¥æ—¥å¿—ï¼š </p><br><pre> <code class="plaintext hljs">WARN spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning.</code> </pre> <br><p> æœ€åˆï¼Œæœ‰ä¸€ä¸ªç¦ç”¨æ­¤æ¨¡å¼çš„è¯·æ±‚ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ‰å…³è¯¥ä¸»é¢˜</a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å²è¯—çº§å†…å®¹</a>åŒ…å«æ•°åä¸ªï¼ˆï¼ï¼‰è¯¦ç»†æ³¨é‡Šï¼ŒåŒ…æ‹¬ æ¥è‡ªOliverGÃ¶rkeï¼ˆSpring Dateå¼€å‘äººå‘˜ï¼‰ï¼ŒVlad Michalceï¼ˆä¼‘çœ å¼€å‘äººå‘˜ï¼‰ï¼ŒPhil Webå’ŒVedran Pavicï¼ˆSpringå¼€å‘äººå‘˜ï¼‰çš„ä¼˜ç¼ºç‚¹ã€‚ </p><br><p> ä»–ä»¬åŒæ„è¡Œä¸ºä¸ä¼šæ”¹å˜ï¼Œä½†æ˜¯ä¼šæ˜¾ç¤ºè­¦å‘Šï¼ˆå·²è§‚å¯Ÿåˆ°ï¼‰ã€‚ è¿˜æœ‰ä¸€ä¸ªç›¸å½“æ™®éçš„æŠ€å·§æ¥ç¦ç”¨æ­¤æ¨¡å¼ï¼š </p><br><pre> <code class="plaintext hljs">spring: jpa: open-in-view: false</code> </pre> <br><p> ä»…æ­¤è€Œå·²ï¼Œè¯·å†™ä¸‹æ‚¨çš„ä¸¾æ­¢å’Œå®‰å…¨ç†äº‹ä¼šçš„æœ‰è¶£ç‰¹å¾-è¿™ç¡®å®æ˜¯ä¸€ä¸ªå–ä¹‹ä¸å°½çš„è¯é¢˜ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439918/">https://habr.com/ru/post/zh-CN439918/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439908/index.html">ç§‘å°”ï¼Œæ»šå¼€...åŒè½´</a></li>
<li><a href="../zh-CN439910/index.html">æ•°å­—ç‰ˆæƒä¸­å¿ƒé‚€è¯·å‚åŠ 2019å¹´éšç§æ—¥</a></li>
<li><a href="../zh-CN439912/index.html">æœªè§£ä¹‹è°œ</a></li>
<li><a href="../zh-CN439914/index.html">å‡é€Ÿå™¨ç»„ç»‡-è¿›ä¸€æ­¥</a></li>
<li><a href="../zh-CN439916/index.html">å¼€ç®±ï¼šDridexå¼•å¯¼ç¨‹åº</a></li>
<li><a href="../zh-CN439920/index.html">ä»Gitè‡ªåŠ¨éƒ¨ç½²æ— æœåŠ¡å™¨åŠŸèƒ½</a></li>
<li><a href="../zh-CN439922/index.html">å“ˆè¨å…‹æ–¯å¦çš„çŸ¥è¯†äº§æƒç¨ï¼šå¦‚ä½•æˆä¸ºè‡ªç”±èŒä¸šè€…ï¼Ÿ</a></li>
<li><a href="../zh-CN439924/index.html">å›½å¤–åœ¨çº¿å•†åº—çš„åŒ…è£¹æ•°é‡å¢é•¿äº†25ï¼…</a></li>
<li><a href="../zh-CN439926/index.html">ä¿ç•™å†…éƒ¨å’Œå¤–éƒ¨ViewModel</a></li>
<li><a href="../zh-CN439928/index.html">ä½¿ç”¨OpenCVå’ŒTensorflowè¿›è¡Œè‡ªåŠ¨äººè¡Œé“é©¾é©¶</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>