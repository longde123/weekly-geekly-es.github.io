<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äç‚úàÔ∏è üññüèΩ ‚Ü™Ô∏è Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 11 üìô üöµüèª üë®üèΩ‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comando e Controle 
 Links para todas as partes: 
 Parte 1. Obtendo Acesso Inicial (Acesso Inicial) 
 Parte 2. Execu√ß√£o 
 Parte 3. Fixa√ß√£o (Persist√™nc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 11</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449654/"><h2>  Comando e Controle </h2><br>  <b>Links para todas as partes:</b> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1. Obtendo Acesso Inicial (Acesso Inicial)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Execu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3. Fixa√ß√£o (Persist√™ncia)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4. Escalonamento de Privil√©gios</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Evas√£o de Defesa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 6. Obtendo credenciais (acesso a credenciais)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 7. Descoberta</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 8. Movimento Lateral</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 9. Coleta de Dados (Cole√ß√£o)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 10. Exfiltra√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 11. Comando e Controle</a> <br><br>  A se√ß√£o "Comando e controle" ( <i>abrevia√ß√£o - C2, C &amp; C</i> ) √© o est√°gio final da cadeia de ataques introduzida no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ATT &amp; CK Matrix for Enterprise</a> . <br><br>  Comando e controle inclui t√©cnicas pelas quais o advers√°rio se comunica com sistemas conectados e sob o controle da rede atacada.  Dependendo da configura√ß√£o dos sistemas e da topologia da rede de destino, existem v√°rias maneiras de organizar o canal secreto C2.  As t√©cnicas mais comuns s√£o descritas em gato.  Recomenda√ß√µes gerais sobre a organiza√ß√£o de medidas para prevenir e detectar C2 s√£o destacadas em um bloco separado e colocadas no final da se√ß√£o. <br><br><a name="habracut"></a><br>  <i>O autor n√£o √© respons√°vel pelas poss√≠veis consequ√™ncias da aplica√ß√£o das informa√ß√µes contidas no artigo e tamb√©m se desculpa por poss√≠veis imprecis√µes feitas em algumas formula√ß√µes e termos.</i>  <i>As informa√ß√µes publicadas s√£o uma recontagem gratuita do conte√∫do do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MITRE ATT &amp; CK</a> .</i> <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Portas comuns</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> para ignorar firewalls e misturar tr√°fego malicioso com atividade normal da rede, um advers√°rio pode manter contato com o sistema atacado por meio de portas padr√£o comumente usadas por aplicativos regulares: <br> <code>TCP: 80 (HTTP) <br> TCP: 443 (HTTPS) <br> TCP: 25 (SMTP) <br> TCP/UDP: 53 (DNS)</code> <br> <br>  Exemplos de portas para organizar conex√µes de rede em um enclave inimigo, por exemplo, entre um servidor proxy e outros n√≥s) s√£o: <br> <code>TCP/UDP: 135 (RPC) <br> TCP/UDP: 22 <br> TCP/UDP: 3389</code> <br> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Comunica√ß√£o atrav√©s de m√≠dia remov√≠vel</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: um</i> advers√°rio pode organizar uma infraestrutura C2 entre n√≥s fisicamente isolados usando m√≠dia de armazenamento remov√≠vel para transferir comandos de sistema para sistema.  Ambos os sistemas devem estar comprometidos.  √â prov√°vel que um sistema com conex√£o √† Internet seja comprometido pelo primeiro, e o segundo sistema seja comprometido durante o movimento lateral, replicando o malware por meio de m√≠dia remov√≠vel (consulte a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 8</a> ).  Comandos e arquivos ser√£o retransmitidos de um sistema isolado para um sistema com conex√£o √† Internet, ao qual o advers√°rio tenha acesso direto. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> desative a execu√ß√£o autom√°tica de dispositivos remov√≠veis.  Proibir ou restringir o uso de m√≠dia remov√≠vel no n√≠vel da pol√≠tica organizacional.  Organize uma auditoria dos processos que s√£o executados ao conectar a m√≠dia remov√≠vel. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conex√£o atrav√©s de um proxy (Proxy de Conex√£o)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> um servidor proxy pode ser usado por um invasor para redirecionar o tr√°fego de rede entre sistemas ou como intermedi√°rio para comunica√ß√µes em rede.  Muitas ferramentas (como HTRAN, ZXProxy e ZXPortMap) permitem redirecionar o tr√°fego ou encaminhar portas. <br><br>  O conceito de proxies tamb√©m pode incluir rela√ß√µes de confian√ßa em redes ponto a ponto (p2p), em malha ou em conex√µes confi√°veis ‚Äã‚Äãentre redes.  Uma rede pode estar dentro de uma organiza√ß√£o ou entre organiza√ß√µes com rela√ß√µes de confian√ßa.  Um advers√°rio pode usar rela√ß√µes de confian√ßa de rede para controlar o canal C2, reduzir o n√∫mero de conex√µes de rede de sa√≠da simult√¢neas, fornecer toler√¢ncia a falhas ou usar conex√µes confi√°veis ‚Äã‚Äãpara evitar suspeitas. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo de comando e controle personalizado</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: um</i> invasor pode organizar um canal C2 usando seu pr√≥prio protocolo de rede em vez de encapsular comandos / dados em um protocolo de camada de aplicativo padr√£o existente.  A implementa√ß√£o do protocolo C2 inimigo pode imitar protocolos conhecidos ou protocolos de usu√°rio (incluindo soquetes brutos) sobre os protocolos b√°sicos apresentados no TCP / IP ou em outra pilha de rede padr√£o. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo criptogr√°fico personalizado</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> para ocultar o tr√°fego transmitido pelo canal C2, o advers√°rio pode usar seu pr√≥prio protocolo criptogr√°fico ou algoritmo de criptografia.  Um esquema simples, como a criptografia XOR de texto sem formata√ß√£o com uma chave fixa, fornecer√° texto cifrado (embora muito fraco). <br><br>  Os esquemas de criptografia propriet√°rios podem variar em complexidade.  A an√°lise e a engenharia reversa de amostras de malware podem ser usadas para detectar com √™xito o algoritmo usado e a chave de criptografia.  Alguns atacantes podem tentar implementar sua pr√≥pria vers√£o de um algoritmo criptogr√°fico conhecido em vez de usar uma biblioteca conhecida, o que pode levar a erros n√£o intencionais na opera√ß√£o do software inimigo. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> se o malware usa sua pr√≥pria criptografia com chaves sim√©tricas, √© poss√≠vel obter um algoritmo e uma chave a partir de amostras de software para us√°-los para decodificar o tr√°fego de rede e identificar assinaturas de malware. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Codifica√ß√£o de Dados</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: as</i> informa√ß√µes transmitidas pelo canal C2 s√£o codificadas usando sistemas de codifica√ß√£o de dados padr√£o.  O uso da codifica√ß√£o de dados deve estar em conformidade com as especifica√ß√µes de protocolo existentes e inclui o uso de ASCII, Unicode, Base64, MIME, UTF-8 ou outras codifica√ß√µes bin√°rias de texto e caracteres.  Alguns sistemas de codifica√ß√£o, como o gzip, tamb√©m podem compactar dados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ofusca√ß√£o de dados</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> dados no canal C2 podem ser ocultados (mas n√£o necessariamente usando criptografia) para dificultar a detec√ß√£o e descriptografia do conte√∫do transmitido, al√©m de tornar o processo de comunica√ß√£o menos percept√≠vel e ocultar os comandos transmitidos.  Existem muitos m√©todos de ofusca√ß√£o, como adicionar dados desnecess√°rios ao tr√°fego de protocolo, usar esteganografia, combinar tr√°fego leg√≠timo com tr√°fego C2 ou usar um sistema de codifica√ß√£o de dados n√£o padr√£o, por exemplo, um Base64 modificado no corpo de uma mensagem de solicita√ß√£o HTTP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ocultando o endere√ßo final de uma conex√£o</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">(frente de dom√≠nio)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> a ess√™ncia do Domain Fronting √© a capacidade de ocultar o endere√ßo de destino real do pacote HTTPs nas redes CDNs (Netwoks de entrega de conte√∫do). <br><br>  <i>Exemplo: H√° o dom√≠nio X e o dom√≠nio Y, que s√£o clientes das mesmas CDNs.</i>  <i>Um pacote com o endere√ßo X do dom√≠nio no cabe√ßalho TLS e o endere√ßo Y do dom√≠nio no cabe√ßalho HTTP provavelmente ser√° entregue ao endere√ßo Y do dom√≠nio, mesmo se a comunica√ß√£o de rede entre os endere√ßos de origem e de destino for proibida.</i> <br><br>  Um pacote HTTPs cont√©m dois conjuntos de cabe√ßalhos: o primeiro, TLS, est√° na parte aberta do pacote, o segundo, HTTP - refere-se √† parte criptografada do pacote.  Al√©m disso, cada cabe√ßalho possui seu pr√≥prio campo para especificar o endere√ßo IP de destino.  A ess√™ncia do Fronting de Dom√≠nio √© o uso deliberado de diferentes nomes de dom√≠nio no campo "SNI" do cabe√ßalho TLS e no campo "Host" do cabe√ßalho HTTP.  Assim, o endere√ßo de destino permitido √© indicado no campo "SNI" e o endere√ßo de destino de entrega √© indicado no campo "Host".  Se os dois endere√ßos pertencerem aos mesmos CDNs, ap√≥s o recebimento desse pacote, o n√≥ de roteamento poder√° retransmitir a solicita√ß√£o para o endere√ßo de destino. <br><br>  H√° outra varia√ß√£o dessa t√©cnica chamada fronting sem dom√≠nio.  Nesse caso, o campo "SNI" (cabe√ßalho TLS) √© intencionalmente deixado em branco, o que permite que o pacote alcance seu objetivo, mesmo que o CDN verifique a coincid√™ncia dos campos "SNI" e "HOST" (se campos SNI vazios forem ignorados). <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Se for poss√≠vel inspecionar o tr√°fego HTTPS, as conex√µes semelhantes ao Domain Fronting podem ser capturadas e analisadas.  Se a inspe√ß√£o SSL for realizada ou o tr√°fego n√£o estiver criptografado, o campo "HOST" poder√° ser verificado quanto √† coincid√™ncia com o campo "SNI" ou a presen√ßa do endere√ßo especificado nas listas brancas ou negras.  Para implementar o Domain Fronting, um advers√°rio provavelmente precisar√° implantar ferramentas adicionais em um sistema comprometido, cuja instala√ß√£o pode ser impedida pela instala√ß√£o de ferramentas locais de prote√ß√£o de host. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Canais de fallback</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> para garantir a confiabilidade do canal de controle e evitar exceder os valores limite dos dados transmitidos, os atacantes podem usar canais de backup ou de comunica√ß√£o alternativos se o canal principal C2 estiver comprometido ou indispon√≠vel. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Canais de v√°rios est√°gios</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> invasores podem criar canais C2 de v√°rios est√°gios que s√£o usados ‚Äã‚Äãem v√°rias condi√ß√µes ou para fun√ß√µes espec√≠ficas.  O uso de v√°rias etapas pode confundir e ofuscar o canal C2, dificultando a detec√ß√£o. <br><br>  Os RATs em execu√ß√£o no host de destino iniciam uma conex√£o com o servidor C2 de primeira camada.  A primeira etapa pode ter recursos automatizados para coletar informa√ß√µes b√°sicas sobre o host, executar ferramentas de atualiza√ß√£o e baixar arquivos adicionais.  Em seguida, uma segunda ferramenta RAT pode ser iniciada para redirecionar o host para o servidor de segunda camada C2.  O segundo est√°gio do C2, provavelmente, ser√° totalmente funcional e permitir√° que o inimigo interaja com o sistema de destino atrav√©s do shell reverso e fun√ß√µes adicionais do RAT. <br><br>  As etapas C2, provavelmente, ser√£o colocadas separadamente uma da outra sem cruzar sua infraestrutura.  O carregador de inicializa√ß√£o tamb√©m pode ter feedback redundante no primeiro est√°gio ou canais sobressalentes, caso o canal original do primeiro est√°gio seja detectado e bloqueado. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: a</i> infraestrutura C2 usada para organizar canais de v√°rios est√°gios pode ser bloqueada se for conhecida com anteced√™ncia.  Se assinaturas exclusivas estiverem presentes no tr√°fego C2, elas poder√£o ser usadas para identificar e bloquear o canal. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Proxy m√∫ltiplo (Proxy Multi-hop)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  Descri√ß√£o: para disfar√ßar a origem do tr√°fego malicioso, um advers√°rio pode usar uma cadeia de v√°rios servidores proxy.  Como regra, o defensor poder√° determinar apenas o √∫ltimo proxy.  O uso de multiproxing torna a identifica√ß√£o da fonte de tr√°fego malicioso mais dif√≠cil, exigindo que a parte defensora monitore o tr√°fego malicioso por meio de v√°rios servidores proxy. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o: O</i> tr√°fego para redes an√¥nimas conhecidas (como Tor) e infra-estruturas C2 pode ser bloqueado pela organiza√ß√£o de listas negras e brancas.  No entanto, voc√™ deve prestar aten√ß√£o para que esse m√©todo de bloqueio possa ser contornado usando t√©cnicas semelhantes ao Fronting de Dom√≠nio. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Comunica√ß√£o multibanda</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> Alguns oponentes podem dividir o canal de dados C2 entre diferentes protocolos.  Os comandos de entrada podem ser transmitidos por um protocolo e os dados de sa√≠da de uma maneira diferente, o que permite ignorar certas restri√ß√µes de firewall.  A separa√ß√£o tamb√©m pode ser acidental, a fim de evitar avisos sobre exceder os valores limite para qualquer mensagem √∫nica. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> analise o conte√∫do dos pacotes para encontrar conex√µes que n√£o correspondem ao comportamento esperado do protocolo para a porta usada.  A correspond√™ncia de alertas entre v√°rios canais de comunica√ß√£o tamb√©m pode ajudar na detec√ß√£o de C2. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criptografia multicamada</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: um</i> advers√°rio pode aplicar v√°rios n√≠veis de criptografia de tr√°fego C2.  Como regra (mas outras op√ß√µes n√£o s√£o exclu√≠das), o encapsulamento adicional usando seu pr√≥prio esquema de criptografia √© usado como parte da criptografia HTTPS ou SMTPS. <br><br>  <i>Dicas de seguran√ßa: o</i> uso de protocolos de criptografia pode complicar a descoberta t√≠pica do C2 com base na an√°lise de tr√°fego baseada em assinaturas.  Se o malware usar um protocolo criptogr√°fico padr√£o, a inspe√ß√£o SSL / TLS poder√° ser usada para detectar o tr√°fego C2 em alguns canais criptografados.  A verifica√ß√£o SSL / TLS envolve certos riscos que devem ser considerados antes da implementa√ß√£o para evitar poss√≠veis problemas de seguran√ßa, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verifica√ß√£o incompleta de certificados</a> .  Ap√≥s a verifica√ß√£o SSL / TLS, an√°lises criptogr√°ficas adicionais podem ser necess√°rias para a criptografia de segundo n√≠vel. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Porto batendo</a> </h3><br>  <i>Sistema:</i> Linux, macOS <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar os m√©todos de Port Knocking para ocultar portas abertas que eles usam para se conectar ao sistema. <br><br>  Dicas de <i>seguran√ßa: O</i> uso de firewalls com estado pode impedir que algumas op√ß√µes de Port Knocking sejam implementadas. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ferramentas de acesso remoto</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> para estabelecer um modo interativo de comando e controle, um invasor pode usar software leg√≠timo projetado para eles.  suporte √† esta√ß√£o de trabalho e software para acesso remoto, por exemplo, TeamViewer, Go2Assist, LogMain, AmmyAdmin etc., que geralmente s√£o usados ‚Äã‚Äãpelos servi√ßos de suporte t√©cnico e podem ser inclu√≠dos na lista de permiss√µes.  Ferramentas de acesso remoto, como VNC, Ammy e Teamview, s√£o mais comumente usadas por engenheiros de suporte t√©cnico e comumente usadas por criminosos cibern√©ticos. <br><br>  As ferramentas de acesso remoto podem ser instaladas ap√≥s o comprometimento do sistema para uso como um canal C2 alternativo.  Eles tamb√©m podem ser usados ‚Äã‚Äãcomo um componente de malware para estabelecer uma conex√£o reversa com um servidor ou sistema controlado por um advers√°rio. <br><br>  Ferramentas de administra√ß√£o, como o TeamViewer, foram usadas por v√°rios grupos focados em ag√™ncias governamentais em pa√≠ses de interesse do estado russo e de empresas criminosas. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> As ferramentas de acesso remoto podem ser usadas em conjunto com as t√©cnicas de Fronting de Dom√≠nio; portanto, √© aconselh√°vel impedir que o advers√°rio instale as ferramentas RAT usando ferramentas de seguran√ßa do host. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C√≥pia remota de arquivo</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> arquivos podem ser copiados de um sistema para outro para implantar ferramentas inimigas ou outros arquivos.  Os arquivos podem ser copiados de um sistema externo controlado por um invasor, atrav√©s do canal C&amp;C ou usando outras ferramentas usando protocolos alternativos, como FTP.  Os arquivos tamb√©m podem ser copiados para Mac e Linux usando ferramentas internas como scp, rsync, sftp. <br><br>  Os inimigos tamb√©m podem copiar arquivos lateralmente entre os sistemas internos de v√≠timas para suportar o movimento da rede e a execu√ß√£o remota de comandos.  Isso pode ser feito usando protocolos de compartilhamento de arquivos, conectando recursos de rede via SMB ou usando conex√µes autenticadas com compartilhamentos de administrador do Windows ou RDP. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Como meio de detec√ß√£o, √© recomend√°vel monitorar a cria√ß√£o e a transfer√™ncia de arquivos pela rede por meio do protocolo SMB.  Processos incomuns com conex√µes de rede externas que criam arquivos no sistema tamb√©m devem ser suspeitos.  O uso at√≠pico de utilit√°rios como FTP tamb√©m pode ser suspeito. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo de camada de aplicativo padr√£o</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o:</i> para evitar detectar e misturar o tr√°fego C2 com o tr√°fego de rede existente, os invasores podem usar protocolos padr√£o no n√≠vel do aplicativo, como HTTP, HTTPS, SMTP ou DNS.  Para conex√µes dentro do canal C2 (enclave), por exemplo, entre o servidor proxy e o n√≥ mestre e outros n√≥s, os protocolos RPC, SSH ou RDP s√£o geralmente usados. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo criptogr√°fico padr√£o</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> oponentes podem usar algoritmos de criptografia conhecidos para ocultar o tr√°fego C2.  Apesar de usar um algoritmo robusto, se as chaves secretas s√£o criptografadas e geradas por malware e / ou armazenadas em arquivos de configura√ß√£o, o tr√°fego C2 pode ser revelado usando engenharia reversa. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Protocolo padr√£o da camada sem aplica√ß√£o</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> protocolos da camada n√£o de aplicativo do modelo OSI podem ser usados ‚Äã‚Äãpara comunica√ß√£o entre o host e o servidor infectados ou para a intera√ß√£o dos hosts infectados na rede.  Em implementa√ß√µes conhecidas, foram utilizados o protocolo da camada de rede - ICMP, a camada de transporte - UDP, a camada de sess√£o - SOCKS e protocolos como redirecionados / encapsulados, como Serial over LAN (SOL). <br><br>  O ICMP √© frequentemente usado por criminosos cibern√©ticos para ocultar a comunica√ß√£o entre hosts.  Como o ICMP faz parte do Internet Protocol Suite e deve ser implementado por todos os dispositivos compat√≠veis com IP, ele n√£o √© t√£o freq√ºentemente monitorado quanto outros protocolos, como TCP ou UDP. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Portas sofisticadas (porta incomumente usada)</a> </h3><br>  <i>Sistema:</i> Windows, Linux, macOS <br>  <i>Descri√ß√£o: os</i> advers√°rios podem se comunicar via C2 atrav√©s de uma porta n√£o padr√£o para ignorar servidores proxy e firewalls que n√£o foram configurados corretamente. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Servi√ßo Web</a> </h3><br>  <i>Sistema:</i> Windows <br>  <i>Direitos:</i> Usu√°rio <br>  <i>Descri√ß√£o: os</i> invasores podem usar um servi√ßo da Web externo leg√≠timo em execu√ß√£o como forma de enviar comandos para controlar um sistema infectado.  Os servidores de gerenciamento s√£o chamados de Comando e controle (C&amp;C ou C2).  Sites e redes sociais populares podem atuar como um mecanismo para o C2, e v√°rios servi√ßos p√∫blicos, como Google ou Twitter, tamb√©m podem ser usados.  Tudo isso ajuda a ocultar atividades maliciosas no fluxo geral de tr√°fego.  Os servi√ßos da Web geralmente usam SSL / TLS, para que os advers√°rios obtenham uma camada extra de prote√ß√£o. <br><br>  <i>Recomenda√ß√µes de prote√ß√£o:</i> Firewalls e proxies da Web podem ser usados ‚Äã‚Äãpara implementar pol√≠ticas para restringir as comunica√ß√µes de rede externas. <br><br><h3>  Recomenda√ß√µes gerais sobre a organiza√ß√£o de medidas para a preven√ß√£o e detec√ß√£o de C2 </h3><br><br>  ‚Ä¢ Os sistemas IDS / DLP que usam an√°lise de tr√°fego baseada em assinatura podem ser usados ‚Äã‚Äãpara detectar e bloquear ferramentas C2 espec√≠ficas conhecidas e programas maliciosos, de modo que o advers√°rio provavelmente alterar√° as ferramentas usadas ao longo do tempo ou configurar√° o protocolo de transfer√™ncia de dados para evitar a detec√ß√£o por meios conhecidos por ele. prote√ß√£o; <br><br>  ‚Ä¢ Use ferramentas de prote√ß√£o de ponto de extremidade antiv√≠rus para bloquear ferramentas C2 espec√≠ficas conhecidas e malware; <br><br>  ‚Ä¢ Verifique se os hosts na rede interna est√£o acess√≠veis apenas atrav√©s de interfaces autorizadas; <br><br>  ‚Ä¢ Limite o tr√°fego de sa√≠da, permitindo apenas as portas necess√°rias nos firewalls e proxies atrav√©s dos gateways de rede apropriados; <br><br>  ‚Ä¢ Bloquear dom√≠nios e endere√ßos IP de infraestruturas C2 conhecidas.  No entanto, deve-se notar que essa n√£o √© uma solu√ß√£o eficaz e de longo prazo, pois      C2; <br><br> ‚Ä¢      ,       ; <br><br> ‚Ä¢    ,    -       ,      (TeamViewer, Go2Assist, LogMain, AmmyAdmin  ..); <br><br> ‚Ä¢         ,    -                 ; <br><br> ‚Ä¢    API-,        ; <br><br> ‚Ä¢       ICMP   ,                ; <br><br> ‚Ä¢        , ,      ,       ,     ,   ; <br><br> ‚Ä¢       ,         . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449654/">https://habr.com/ru/post/pt449654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449644/index.html">Estudo da VW mostra o Golf-E ecol√≥gico ap√≥s 100.000 km</a></li>
<li><a href="../pt449646/index.html">An√°lise wavelet. O b√°sico</a></li>
<li><a href="../pt449648/index.html">Micr√≥bios ind√≠genas no auge da moda</a></li>
<li><a href="../pt449650/index.html">Do f√≥rum ao v√≠deo - o caminho de um grafo-man√≠aco</a></li>
<li><a href="../pt449652/index.html">Convidamos os desenvolvedores a participar da hackathon no PHDays 9</a></li>
<li><a href="../pt449656/index.html">Como se divertir com vk api</a></li>
<li><a href="../pt449658/index.html">Ovo de P√°scoa novo do Google - Thanos e a luva do infinito x resultados de pesquisa do Google</a></li>
<li><a href="../pt449662/index.html">Bem-vindo a falar na PyCon R√∫ssia 2019</a></li>
<li><a href="../pt449664/index.html">Configurando o GitLab CI para carregar um projeto java no maven central</a></li>
<li><a href="../pt449666/index.html">DevOpsForum 2019. Implantar DevOps n√£o pode esperar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>