<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💦 👆🏾 ✏️ 使用Postman和Excel测试API 👨🏻‍🚒 📭 🛌🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="大家好，我是测试部门的负责人，最近出现了一项测试API的任务。 为了解决这个问题，我为我掌握了新的Postman和JavaScript工具。 

 最初，对于每个API，我都以JSON格式编写了集合并准备了测试数据。 这非常方便，但是通过大量测试和收集，维护变得无利可图。 而且，在JSON中验证数据...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用Postman和Excel测试API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467127/"> 大家好，我是测试部门的负责人，最近出现了一项测试API的任务。 为了解决这个问题，我为我掌握了新的Postman和JavaScript工具。 <br><br> 最初，对于每个API，我都以JSON格式编写了集合并准备了测试数据。 这非常方便，但是通过大量测试和收集，维护变得无利可图。 而且，在JSON中验证数据并不方便。 <br><br> 为了解决这些问题，我为Excel编写了一个宏，并在Postman中编写了一个集合。 现在在Postman中，我有一个用于所有API的集合，以及一组标准函数，用于处理传入数据和验证返回的结果。 我设法将测试数据管理和查询执行顺序转移到Excel。 <br><br><h4> 那是什么 </h4><br>  1. JSON和数据 <br><br><img src="https://habrastorage.org/webt/be/l-/78/bel-78hyknqwqra9c8qovryx9fm.png"><br>  <i>以前，测试套件以这种形式存储</i> <br><a name="habracut"></a><br>  2. 2.使用JS处理程序执行查询的顺序存储在Postman集合中。 <br><br><img src="https://habrastorage.org/webt/gi/tw/4j/gitw4j_h_todey0pzbyvou9sinc.png"><br><br><h4> 变成了什么 </h4><br>  1.测试套件移至Excel <br><br><img src="https://habrastorage.org/webt/j5/0e/fv/j50efvyvp-dspfoobtcpjgjbemg.png"><br><br> 所有数据都输入到Excel（控制键字符：R，H，I等，我将在下面编写），然后使用宏将它们转换为json格式： <br><br><img src="https://habrastorage.org/webt/y9/dp/5q/y9dp5q9c_fdj7_zbxun6-ebl1tk.png"><br><br>  2.在邮递员中 <br><br><img src="https://habrastorage.org/webt/ry/mq/jl/rymqjl-zkqsqakx6fxuqkxpy110.png"><br><br> 实验是在一组标准的CRUD操作上进行的，可以进一步扩展。 <br><br> 由于在Postman中所有操作仅在请求的框架内执行，因此我必须输入一个空的get请求，并在该末尾确定序列中的下一个请求。 在请求之前运行JS代码，并确定第一个没有空失败的请求。 <br><br> 在所有请求中，“预请求脚本”和“测试”部分为空，所有代码针对请求是统一的，并存储在“预请求脚本”和“ API集合”文件夹的“测试”的常规部分中。 <br><br><img src="https://habrastorage.org/webt/dz/jc/ao/dzjcaoa2elumolbw2wbp_d1dhe0.png"><br><br> 在所有请求中，请务必注意POST和PUT请求中的url和Body部分，它们的值由变量确定，变量的值与数据一起从JSON输入。 <br><br><img src="https://habrastorage.org/webt/gj/yu/y0/gjyuy08umwwocw2aayfgd0legtm.png"><br><br><h4> 现在介绍一下测试本身 </h4><br><img src="https://habrastorage.org/webt/zg/as/ah/zgasahcnnfy4uv3w2cijha956kq.png"><br><br>  <b>如何阅读excel</b> 。 第一个非空行是测试用例的编号，即测试用例是垂直存储的，在此页面上有9个测试用例。 在当前集中，在每个测试用例中，将首先执行POST请求，然后执行Delete。 <br><br>  <b>如何从Excel启动Json生成</b> 。 在Excel中，按F11并转到“ EtaBook”，然后运行宏。 <br><br><h4> 关键词 </h4><br>  <b>R-</b>请求，表示新请求的开始，在存储请求类型的行的第二个单元格中，第三个是您需要联系的地址。 请注意，您可以在url中指定Postman变量 <br><br><img src="https://habrastorage.org/webt/9o/ex/nq/9oexnqprk9duapwq6zcxoe5hsae.png"><br>  <i>来自变量的值将被拉出</i> <br><br>  <b>H-</b>标头中用于验证的数据，到目前为止仅输入了响应代码，邮递员仅在邮递员中检查它。 在Excel中，名称必须与“响应代码”相同，或在Postman中更正，这一点很重要 <br><br><img src="https://habrastorage.org/webt/74/26/if/7426ifzzmp0fljuy6t0tgzww5oo.png"><br><br>  <b>I，I2 ...-</b>输入数据部分支持任何嵌套的数据模型的存储，I右边的数字负责嵌套级别。 下一个数据集像这样包装在JSON中。 如果存储数据的变量为空，则不会添加。 也就是说，如果inn变量中没有值，则将不会添加它，而将添加main变量，因为它存储了模型。 而且，如果整个模型为空，则也不会添加。 <br><br><img src="https://habrastorage.org/webt/x-/ku/bg/x-kubguayoz-z57pewwztbltnsq.png"><br>  <i>本节中的数据将在请求正文中提交。</i> <br><br><img src="https://habrastorage.org/webt/mu/og/ne/muognet9_l6pj_l5gbc9ugici6q.png"><br><br>  <b>O，O2 ...-</b>输出参数的一部分，它们将与响应返回的参数进行比较。 像“输入”部分一样，它支持模型存储。 <br><br><img src="https://habrastorage.org/webt/i8/yz/xm/i8yzxm_jo-3bd5fgdvyfraz_g_u.png"><br>  <i>比较时，数据被转换为字符串，我还额外限制了递归级别，可以将其删除</i> <br><br>  <b>PO-</b>邮递员输出，此部分中的值将通过变量名称从请求的响应正文中获取，并写入邮递员变量中。 <br><br><img src="https://habrastorage.org/webt/vx/ho/fz/vxhofzpxvogjohpodrnu0zl9vvc.png"><br>  <i>在Excel中，可以放置任何字符，将来自响应的值（不是excel）写入变量</i> <br><br><img src="https://habrastorage.org/webt/-j/e9/qg/-je9qgf4r93uv3nhj69fksobm0c.png"><br>  <i>需要此部分来存储脚本之间的数据，例如，删除具有上一个请求中创建的ID的对象</i> <br><br>  <b>PC-</b>邮递员命令，仅引入了一个“终止”命令，用于在执行当前请求后强制终止。 对于否定测试很有用，以免导致步骤删除创建的对象。 <br><br><img src="https://habrastorage.org/webt/b4/c-/a-/b4c-a-z_r2b4t_icmwb2fpsaerq.png"><br>  <i>输入此命令允许将阳性和阴性测试同时存储在一张纸上</i> <br><br><img src="https://habrastorage.org/webt/18/w3/o-/18w3o-70cys7nv7dulrifg5ja7s.png"><br><br>  <b>PI-</b>邮递员输入，本节中的值将在URL定义之前写入邮递员变量 <br><br><img src="https://habrastorage.org/webt/kh/rc/vz/khrcvzvphiglyotfonirlen-hr8.png"><br> 如果您需要覆盖请求url中指定的变量，它会很有用。 <br><br> 顺便说一下，您可以使用提供的数据中的Postman变量中的数据，为此，您需要使用特殊的设计 <br><br><img src="https://habrastorage.org/webt/v6/bv/8r/v6bv8r4dsxo3sslgpfnmqjk7cuy.png"><br><br> 在情况1中，我们将获得的值输入一个变量，在情况2中，我们使用了它。 它不仅可以在下一种情况下使用，还可以在下一个请求的当前情况下使用。 例如，如果更改对象的定义不是遵循URL，而是根据请求中变量的值，则可能有必要。 <br><br><h4> 准备运行 </h4><br> 现在，运行，运行Postman运行程序，在其中选择所需的集合，然后上传包含测试数据的文件： <br><br><img src="https://habrastorage.org/webt/qz/j7/v7/qzj7v7qfatkjb5qs9uanx8pj1gg.png"><br><br> 我们将提供以下服务： <br><br><img src="https://habrastorage.org/webt/yr/rl/e0/yrrle0uje4xycw_yfhtnkuel9io.png"><br><br> 这里描述了15个测试，其中步骤1-11、13、15为正，结果为POST请求为200；步骤12、14为否，结果为400。信息不会输入数据库，因此输出部分为空，并指示命令终止。 该命令将中断序列的执行，并且不会发送删除“ Delete”的请求。 <br><br> 在案例1-11、13、15之后，我们会记住分配给新对象的ID，然后将其删除。 <br><br><h4> 我们启动 </h4><br><img src="https://habrastorage.org/webt/lv/i-/lp/lvi-lpm3jj-12nmimyar_tulyxu.png"><br>  <i>所有15个测试均成功，图片显示测试14，其中在POST之后未调用Delete</i> <br><br> 在POST之后的测试1-11、13、15中，删除创建的对象称为： <br><br><img src="https://habrastorage.org/webt/vz/i9/e3/vzi9e3bm7n2xyadpllytq-s1czm.png"><br><br><h4> 总结 </h4><br><ul><li> 测试API的请求顺序在Excel中进行，并在Postman中进行处理。 </li><li> 所有测试数据也都在Excel中呈现，便于管理和验证它们。 至少比JSON格式更方便。 </li><li>  Postman集合是标准化的，在测试类似的API时不需要改进。 </li></ul><br><h4> 参考文献 </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub存储库，有Excel和Postman集合</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在开发中，使用了由Tim Hall创作的VBA-JSON工具。</a> </li></ol><br><br>  <b>从10/15/2019更新</b> <br><br>  1.改进了无需运行excel即可生成json文件的功能，将其放入GenerateAll.cmd git中，该git运行vb脚本GenerateJsonFiles.vbs。 被调用的脚本将遍历当前文件夹和所有子文件夹并生成json文件 <br>  2.运行RunAll.cmd来运行所有生成的json数据文件，还将运行当前文件夹和所有子文件夹。 在它们每个旁边，将放置output-report.log及其运行结果。 <br><br> 现在，拧紧CI不再是问题。 您还可以固定json生成，以git部署并比较excel中的数据以获取json文件中的更改。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN467127/">https://habr.com/ru/post/zh-CN467127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN467113/index.html">如何使用户留在网站上？ 可用性秘密</a></li>
<li><a href="../zh-CN467115/index.html">非典型“ ls”-哈伯版</a></li>
<li><a href="../zh-CN467117/index.html">手稿不燃烧：死海长寿之谜的历史可以追溯到公元前250年</a></li>
<li><a href="../zh-CN467119/index.html">与Badoo工程师一起玩IT别名</a></li>
<li><a href="../zh-CN467125/index.html">用类似Lisp语言编写的现代NES游戏</a></li>
<li><a href="../zh-CN467129/index.html">认知矫正2：学习错觉和失真</a></li>
<li><a href="../zh-CN467131/index.html">CLRium＃6：关于无锁的报告，很多理论和实践知识</a></li>
<li><a href="../zh-CN467135/index.html">USB踏板可在电脑之间切换</a></li>
<li><a href="../zh-CN467137/index.html">确保Zextras Team在复杂的公司网络中的可靠运行</a></li>
<li><a href="../zh-CN467141/index.html">Mitapa Saint Team带领Conf参加更深入的话题</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>