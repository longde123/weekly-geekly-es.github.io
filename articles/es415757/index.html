<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö£üèΩ ü§Ø üòâ C√≥mo funciona BitSignature en Bitcoin üë®üèº‚Äçüíº üòó üßëüèø‚Äçü§ù‚Äçüßëüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, veremos c√≥mo funciona la firma m√∫ltiple en el protocolo Bitcoin. Tenga en cuenta que en otras criptomonedas y monedas digitales, est...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo funciona BitSignature en Bitcoin</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/distributedlab/blog/415757/">  En este art√≠culo, veremos c√≥mo funciona la firma m√∫ltiple en el protocolo Bitcoin.  Tenga en cuenta que en otras criptomonedas y monedas digitales, estos mecanismos se pueden implementar de manera diferente: depende del modelo de transacci√≥n.  Le daremos una definici√≥n de firma m√∫ltiple, analizaremos esquem√°ticamente su estructura utilizando un ejemplo de una transacci√≥n, consideraremos las opciones para su uso y las precauciones cuando trabaje con ella.  Intentaremos revelar abiertamente el tema de las mejoras propuestas, P2SH, y tambi√©n en el diagrama analizaremos el mecanismo para enviar un pago a una direcci√≥n con una firma m√∫ltiple.  Creemos que el material presentado ser√° de inter√©s para los lectores cuya actividad o √°rea de inter√©s se relacione con las monedas digitales. <br><a name="habracut"></a><br><h2>  Direcci√≥n de firma m√∫ltiple </h2><br>  La direcci√≥n de firma m√∫ltiple (direcci√≥n de firma m√∫ltiple, para abreviar) es una direcci√≥n de Bitcoin a la que se adjuntan varios pares de claves ECDSA a la vez.  Cada par consta de claves privadas y p√∫blicas.  Los patrones de combinaci√≥n seg√∫n los cuales se pueden usar estas teclas pueden ser diferentes.  Adem√°s, es posible establecer condiciones bajo las cuales ser√° necesario proporcionar varias firmas para gastar monedas de la direcci√≥n. <br><br><h2>  Transacci√≥n de Bitcoin que usa firma m√∫ltiple </h2><br>  Con m√°s detalle se puede mostrar esquem√°ticamente.  Por ahora, ser√° suficiente imaginar en sentido figurado que una direcci√≥n de m√∫ltiples firmas se forma al mezclar varias claves p√∫blicas concatenadas a la vez.  Consideraremos esto con m√°s detalle un poco m√°s.  El diagrama muestra una transacci√≥n que se gasta con una direcci√≥n de firma m√∫ltiple. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/024/757/d7b/024757d7bbb5989ec70c59030efbea9e.png" alt="imagen"><br><br>  El gris indica el √°rea del t√≠tulo.  Contiene dos campos.  Dos entradas se indican en azul y dos salidas en verde.  La primera entrada contiene los campos rellenos: se escribe el valor hash de la transacci√≥n anterior, que gasta los datos de la moneda, el n√∫mero de salida, etc. El campo scriptSig contiene la clave p√∫blica y la firma, que es t√≠pico de una transacci√≥n normal. <br><br>  Presta atenci√≥n a la segunda entrada de la transacci√≥n.  El campo scriptSig contiene otra combinaci√≥n de datos: se enumeran dos claves p√∫blicas y dos firmas.  Deben ser verificados por estas claves p√∫blicas, respectivamente.  Esta es la entrada de transacci√≥n que gasta monedas con una direcci√≥n de firma m√∫ltiple.  As√≠ es como se ver√° la prueba de propiedad de las monedas. <br><br><h2>  Opciones de combinaci√≥n de teclas </h2><br>  Existen varias combinaciones de teclas cuando se usa la direcci√≥n de m√∫ltiples firmas.  Las opciones m√°s utilizadas son 2 de 2, 2 de 3 y 3 de 3.  La opci√≥n m√°xima posible es 15 de 15. <br><br>  La combinaci√≥n m√°s simple es 2 de 2.  Implica que hay una direcci√≥n de m√∫ltiples firmas a la que se unen dos pares de claves, de hecho, dos claves p√∫blicas se combinan en una fila y se recibe alguna direcci√≥n.  Para gastar monedas de esta direcci√≥n, debe proporcionar dos firmas que ser√°n verificadas por dos claves p√∫blicas disponibles, cuya concatenaci√≥n y hash en el orden correcto debe dar el mismo valor de la direcci√≥n.  Resumiendo, hay dos claves preinstaladas y necesita dos firmas, que ser√°n verificadas por estas claves, respectivamente. <br><br>  El uso de la direcci√≥n de firma m√∫ltiple 2 de 3 implica que se deben usar dos de las tres claves predefinidas para verificar las dos firmas presentadas como prueba de propiedad de las monedas.  En otras palabras, para gastar monedas, debe proporcionar dos firmas que ser√°n verificadas por dos claves p√∫blicas de las tres predefinidas. <br><br>  La combinaci√≥n de 3 de 3, como ya entendi√≥, requiere tres firmas, que ser√°n verificadas por tres claves preinstaladas.  El m√°ximo en t√©rminos de la cantidad de firmas y claves p√∫blicas requeridas ser√° el esquema de 15 de 15. <br><br>  Veamos las opciones para usar estas combinaciones. <br><br><h3>  2 de 2 </h3><br>  Imagine que un esposo y una esposa quisieran mantener un presupuesto com√∫n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c2/5d3/5e3/6c25d35e327e97eefbac833083f76481.png" alt="imagen"><br><br>  Acuerdan que solo con el consentimiento de cada uno de ellos, los fondos del presupuesto se gastar√°n en ciertas necesidades.  Con Bitcoin, esto se puede implementar de manera bastante simple.  Crean una direcci√≥n de m√∫ltiples firmas de acuerdo con este esquema, donde la esposa controla una clave y el esposo controla la segunda.  Entonces la familia recibir√° todos los ingresos en esas direcciones, y el dinero solo se puede gastar de com√∫n acuerdo. <br><br>  Al predecir su pregunta sobre el escenario cuando el esposo y la esposa no est√°n de acuerdo, imagine que la esposa considera que es necesario comprar una lavadora, porque est√° cansada de lavarse con las manos, y el esposo cree que no es un trabajo tan dif√≠cil, y ser√° m√°s conveniente gastar todas las monedas en el √∫ltimo modelo de PlayStation y pase su tiempo libre de esta manera.  La esposa se ofende con su esposo y come un trozo de papel con su clave privada, lo que hace imposible gastar en esta direcci√≥n. <br><br>  ¬øC√≥mo evitar tal situaci√≥n y proteger las monedas de la p√©rdida final de monedas? <br><br>  Es posible crear una transacci√≥n que gastar√° todos los fondos de la direcci√≥n deseada, a pesar de que el monto no se conoce de antemano.  La entrada no es la cantidad, sino un enlace a la transacci√≥n, desde donde se pueden gastar estas monedas.  Existe un <b>tipo de hash</b> , que es una forma de cubrir con una firma de transacci√≥n.  Le permite crear una firma por adelantado, y algunos datos de transacciones, como la entrada, se pueden sustituir m√°s tarde.  Por lo tanto, puede crear una transacci√≥n que gastar√° monedas de una transacci√≥n que a√∫n no existe, y aplicarla m√°s tarde, es decir, cuando sea necesario. <br><br>  Adem√°s, puede poner una restricci√≥n de LockTime en esta transacci√≥n.  Le permite no confirmar la transacci√≥n inmediatamente, sino posponerla por alg√∫n tiempo.  Entonces, el esposo y la esposa inmediatamente despu√©s de crear una direcci√≥n de m√∫ltiples firmas, incluso antes de recibir cualquier pago, pueden crear dos transacciones LockTime en las que todas las monedas futuras ser√°n redirigidas a las direcciones habituales del esposo y la esposa, que controlan de forma independiente.  Al mismo tiempo, las transacciones ser√°n diferidas y solo podr√°n confirmarse, por ejemplo, despu√©s de dos meses.  Estas transacciones pueden imprimirse en papel y almacenarse individualmente en una caja fuerte.  Si surge una situaci√≥n cuando las monedas est√°n en el saldo de la direcci√≥n de m√∫ltiples firmas, y las claves se pierden (una o ambas), entonces las monedas se congelan.  Pero hay una transacci√≥n LockTime.  Cualquiera que publique dicha transacci√≥n podr√° retirar estos fondos a una direcci√≥n externa v√°lida.  Se guardar√°n las monedas.  Este fue un ejemplo simplificado, pero son posibles mecanismos m√°s complejos. <br><br><h3>  2 de 3 </h3><br>  Supongamos que hay un grupo de personas que tienen un presupuesto com√∫n. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/841/bf6/ef4/841bf6ef4bc002b52cd87954139542fc.png" alt="imagen"><br><br>  Crean una direcci√≥n de firma m√∫ltiple en la que hay tres claves, pero dos firmas son suficientes para firmar la transacci√≥n.  Con el consentimiento de los participantes que conforman la mayor√≠a del grupo, estos fondos pueden gastarse.  En otras palabras, dos de cada tres participantes pueden gastar monedas.  Para hacer esto, es suficiente difundir la transacci√≥n a la red. <br><br><h3>  Ejemplo de servicio de billetera </h3><br>  Hay una forma m√°s interesante de usar la combinaci√≥n 2 de 3 y se usa en los llamados servicios de billetera.  El servicio de billetera en este contexto no debe confundirse con la billetera Bitcoin habitual, que el usuario controla de forma independiente.  El servicio no proporciona un almacenamiento completo para las monedas y no las posee, sino que solo brinda servicios para un trabajo conveniente. <br><br>  Si imagina esta situaci√≥n esquem√°ticamente, entonces una clave pertenece directamente al servicio, la segunda es generada solo por el usuario (y solo √©l lo sabe), la tercera clave tambi√©n es generada y almacenada por el usuario, pero por separado.  Despu√©s de eso, se calculan las claves p√∫blicas correspondientes a estas claves personales y se compila una direcci√≥n de m√∫ltiples firmas.  Las monedas llegan all√≠ y ahora las condiciones de gasto son limitadas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d8a/e30/d30/d8ae30d30c32d7a204d6c2cd0452a8ac.png" alt="imagen"><br><br>  Imagine que estamos tratando con un determinado servicio web y usted puede ingresar su recurso a trav√©s de un navegador.  El navegador descarga el c√≥digo de billetera Bitcoin, que en esta direcci√≥n recibe una lista de monedas no gastadas, calcula su saldo y est√° listo para gastar.  Si el usuario quiere gastar monedas, entonces realiza una transacci√≥n directamente en el navegador y la firma con su firma (una de las necesarias). <br><br>  Tenga en cuenta que el usuario puede recibir la clave privada ya sea desde su contrase√±a, o la clave puede generarse aleatoriamente, cifrarse con la contrase√±a del usuario y almacenarse en el servicio.  Luego, el usuario env√≠a una solicitud al servicio, recibe un contenedor con una clave cifrada, la descifra con su contrase√±a y ya tiene acceso a su clave privada. <br><br>  Cuando un usuario firma una transacci√≥n, se env√≠a al lado del servicio para que coloque la segunda firma necesaria y env√≠e la transacci√≥n.  El servicio aclara el hecho de la necesidad de firmar la transacci√≥n a trav√©s del segundo canal de autenticaci√≥n, es decir, a trav√©s de un canal diferente configurado de antemano, que puede ser una llamada a un tel√©fono m√≥vil, SMS, mensaje de correo electr√≥nico y otros m√©todos de comunicaci√≥n alternativos (hasta una visita personal, si el nivel de seguridad lo requiere) .  Cuando el servicio se ha asegurado de que el usuario registrado realmente inicie la solicitud de firma de transacci√≥n, coloca la firma faltante utilizando su clave.  Despu√©s de eso, la transacci√≥n se vuelve v√°lida y se puede distribuir a la red para su confirmaci√≥n. <br><br>  La tercera clave se usa cuando se niega el servicio.  El software genera esta clave y ofrece guardarla de una manera conveniente para usted.  El usuario generalmente lo almacena en un lugar seguro.  Si se niega el servicio, el usuario puede firmar la transacci√≥n con sus propias claves (segunda y tercera).  Si la segunda clave se almacen√≥ en el lado del servicio, se enviar√° al usuario un contenedor protegido con esta clave por adelantado a trav√©s de un canal de datos alternativo, por ejemplo, por correo electr√≥nico.  El usuario descifra el contenedor con la clave utilizando su contrase√±a. <br><br>  El usuario recibe dos claves privadas necesarias y entra en el software especial que el servicio proporcion√≥ por adelantado.  Adem√°s, este software se ejecuta de forma aut√≥noma en la computadora del usuario, sin la participaci√≥n del servicio.  Vale la pena se√±alar que este software debe usarse solo en casos extremos, cuando el servicio lo niega (es decir, fue pirateado, da√±ado o dej√≥ de existir).  Luego, el usuario firma la transacci√≥n con sus llaves y transfiere las monedas cuando sea necesario. <br><br><h2>  Beneficios de los servicios de billetera 2 de 3 </h2><br>  Nos detendremos en las ventajas de dichos servicios de Wallet con m√°s detalle.  Esta es una forma segura de almacenar, porque el servicio no posee todo el conjunto de claves necesario: posee solo una parte, que no es suficiente para tomar posesi√≥n de los fondos.  Adem√°s, ni el servicio en s√≠ ni el hacker que puede descifrarlo tienen acceso a fondos. <br><br>  La conveniencia de este enfoque es que el usuario no tiene que tener acceso seguro a este servicio.  Puede tener un dispositivo normal que pueda estar infectado con virus o controlado por estafadores, y los datos pueden verse comprometidos o reemplazados.  Pero no es suficiente que un atacante posea solo este dispositivo, porque solo se puede obtener una de las dos firmas. <br><br>  Otra ventaja es que si el servicio lo niega, el usuario no pierde el acceso a sus monedas.  Estos fueron solo algunos de los posibles esquemas para usar direcciones de m√∫ltiples firmas, que son suficientes para las citas. <br><br><h2>  <b>Precauciones de firma m√∫ltiple</b> </h2><br>  Y ahora vale la pena hablar sobre precauciones con respecto a la firma m√∫ltiple.  En el caso de 2 de 2, debe crear transacciones LockTime que puedan transferir fondos bloqueados a una direcci√≥n espec√≠fica.  Esto es cierto cuando se produce la p√©rdida de clave. <br><br>  Si est√° utilizando la direcci√≥n de firma m√∫ltiple 2 de 3, es muy importante que guarde las claves en un lugar seguro.  En caso de p√©rdida de una de las tres claves, debe transferir fondos de inmediato y no esperar hasta el momento en que se pierdan 2 de las 3 claves necesarias. <br><br><h2>  C√≥mo funciona Bitcoin Script (por ejemplo) </h2><br>  Para comprender con m√°s detalle c√≥mo funciona la firma m√∫ltiple, necesitamos hablar un poco sobre c√≥mo funciona Bitcoin Script: c√≥mo se establecen las reglas para gastar monedas, c√≥mo satisfacerlas, cu√°les son las operaciones para describir las reglas, qu√© es Bitcoin Script y c√≥mo se ejecuta. <br><br>  Considere un ejemplo de un caso simple de gastar monedas, donde hay una direcci√≥n regular a la que se asocia un hash de una clave p√∫blica, un gui√≥n correspondiente que establece las condiciones para gastar y un gui√≥n que cumple estas condiciones. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d3/d70/de7/4d3d70de77efa70bb73849ee4ee58b7d.png" alt="imagen"><br><br>  En el diagrama a la izquierda vemos la pila de datos, y a la derecha el script en s√≠.  Las dos primeras partes de la l√≠nea de script son la firma y la clave p√∫blica, el llamado script de desbloqueo, es decir, el script que se indica en la entrada de la transacci√≥n que gasta monedas.  Esto es seguido por el conjunto de datos que se indica en la salida de la transacci√≥n; esto se denomina script de bloqueo.  En otras palabras, aqu√≠ se presenta la concatenaci√≥n de dos guiones: un gui√≥n que desbloquea monedas y un gui√≥n que bloquea monedas.  En el caso en que el nodo de red ya valide la transacci√≥n, estos dos scripts se combinan para verificar las condiciones de gasto de monedas.  Por lo tanto, el script de desbloqueo viene primero, seguido del script de bloqueo. <br><br>  Despu√©s de esto es la ejecuci√≥n secuencial de un conjunto completo de operandos y datos.  El punto de ejecuci√≥n se ejecuta secuencialmente para cada operando y cada pieza de datos.  Si el punto de ejecuci√≥n golpea una pieza de datos, entonces se empuja a la pila.  Como vemos en el diagrama, el cursor de ejecuci√≥n del script en la parte superior indica los datos de la firma, que luego se introducen en la pila. <br><br>  Adem√°s, el cursor de ejecuci√≥n apunta a la clave p√∫blica: tambi√©n se inserta en la pila. <br><br>  El tercer paso es realizar la operaci√≥n de duplicaci√≥n, lo que significa copiar la parte superior de la pila y volver a colocar estos datos en la pila. <br><br>  Despu√©s de eso, el hash se realiza utilizando la funci√≥n hash Hash-160.  Esto significa que la parte superior de la pila se codifica primero con el algoritmo SHA-2 con una longitud de 256 bits y luego con la funci√≥n RIPEMD-160 con una longitud de 160 bits.  La operaci√≥n es exactamente la misma que cuando se codifica la clave p√∫blica y se obtiene la direcci√≥n.  De hecho, esto es todo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aaf/912/e9c/aaf912e9cf2b416fe8c7874ba64869cc.png" alt="imagen"><br><br>  Tenemos una pila, firma, clave p√∫blica y valor hash de la clave p√∫blica.  El cursor de ejecuci√≥n del script apunta a la direcci√≥n que se especific√≥ en la salida de la transacci√≥n, es decir, el valor hash de la clave p√∫blica, que se indic√≥ cuando se le enviaron las monedas.  Este dato tambi√©n se pone en la pila. <br><br>  La siguiente operaci√≥n es igual verificar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/1ae/2a7/d6b1ae2a7cfe776aa117493830f7dd30.png" alt="imagen"><br><br>  Se comparan los dos elementos superiores de la pila.  Si son exactamente el mismo byte, estos datos se eliminan de la pila y se cree que la verificaci√≥n fue exitosa.  Despu√©s de eso, la firma y la clave p√∫blica permanecen en la pila.  En consecuencia, la operaci√≥n de verificaci√≥n de firma toma estos dos operandos y verifica la firma con la clave p√∫blica.  Si la firma es correcta con respecto a la transacci√≥n, que actualmente se est√° verificando, porque la firma cubre parte de la transacci√≥n, por lo tanto, debe tomar el valor hash de ciertos campos de esta transacci√≥n.  Esto se establece mediante un byte separado de la estructura de tipo hash, es decir, se toma un valor hash y se alimenta a la entrada de verificaci√≥n de firma junto con la firma misma y la clave p√∫blica.  Si la verificaci√≥n se realiza correctamente, entonces el resultado de la verificaci√≥n es verdadero, este valor se transfiere a la pila.  Esto completa la ejecuci√≥n del script.  Los datos se pasan a la funci√≥n de llamada y se verifican all√≠.  Si la pila es verdadera, entonces la verificaci√≥n de esta entrada de transacci√≥n fue correcta.  Si todas las entradas de transacciones se han verificado correctamente, la transacci√≥n completa se considera correcta. <br><br>  Aprendimos c√≥mo funciona Bitcoin Script para verificar las entradas y salidas simples de una transacci√≥n.  Ahora hablaremos sobre c√≥mo se organiza la firma m√∫ltiple y c√≥mo funciona cuando se utiliza Bitcoin Script. <br><br><h2>  P2SH </h2><br>  Una vez se propuso BIP16, que define un nuevo concepto en el protocolo de Bitcoin: el llamado hash de pago a script (P2SH).  Esta es una oportunidad para establecer las reglas para gastar monedas que no est√°n en un script abierto, donde escribe operandos y algunos datos en una fila, que luego se ejecutan de la manera que examinamos, pero en forma de un valor hash del script que necesita, es decir, una suma de comprobaci√≥n de estos operandos.  Esto permiti√≥ que la salida de la transacci√≥n estableciera condiciones grandes y complejas para gastar monedas, pero la salida en s√≠ permaneci√≥ corta. <br><br>  Para gastar estas monedas en tales condiciones, a la entrada de la transacci√≥n debe especificar los datos que satisfacen este script, y el script completo para demostrar que sabe qu√© condiciones se establecieron al enviar monedas, de modo que el valor hash del script de origen coincida con las direcciones a las que Se enviaron monedas.  En otras palabras, demuestre que conoce las condiciones y las cumple. <br><br>  Esta propuesta para mejorar Bitcoin fue aceptada el 3 de enero de 2012.  De hecho, el cumplea√±os de Bitcoin.  Ahora se usa activamente para implementar direcciones de m√∫ltiples firmas. <br><br><h2>  ¬øC√≥mo funciona P2SH? </h2><br>  Veamos un ejemplo de c√≥mo funciona esto.  Para construir una transacci√≥n, necesitamos comprender conceptos como Canjear gui√≥n, Bloquear gui√≥n y Desbloquear gui√≥n. <br><br>  Canjear secuencia de comandos contiene las claves p√∫blicas a las que se vincular√° la direcci√≥n de m√∫ltiples firmas.  En este caso, estamos considerando una combinaci√≥n de teclas "2-de-5".  Primero viene el valor 2, es decir, indicamos que ser√°n necesarias 2 firmas, que ser√°n verificadas por las claves p√∫blicas correspondientes.  Esto es seguido por las claves p√∫blicas, en nuestro caso hay 5. Luego, indicamos el valor 5, ya que especificamos 5 claves p√∫blicas, y cuando los datos se leen en orden inverso, este valor es necesario para comprender cu√°ntas claves necesita leer.  Despu√©s de esto, se indica la operaci√≥n de verificaci√≥n de firma m√∫ltiple. <br><br>  Secuencia de comandos de bloqueo: una secuencia de comandos que se indica en la salida de una transacci√≥n que paga por una direcci√≥n de m√∫ltiples firmas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠ se realizar√° la operaci√≥n de obtener un valor hash, con el que ya nos hemos familiarizado en detalle. </font><font style="vertical-align: inherit;">El siguiente es el valor de hash Redeem Script, que ocupa 20 bytes. </font><font style="vertical-align: inherit;">Despu√©s de eso, se realiza una operaci√≥n para verificar que los datos coincidan con el valor hash real. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desbloquear script es una concatenaci√≥n de scripts en la entrada de la transacci√≥n con scripts en la salida de la transacci√≥n que pag√≥ a esta direcci√≥n. </font><font style="vertical-align: inherit;">Hay dos firmas necesarias para gastar monedas, y el Script de canje completo, que luego se codificar√° y se comprobar√° para verificar el cumplimiento de la direcci√≥n a la que se enviaron las monedas. </font><font style="vertical-align: inherit;">Despu√©s de eso, el script se ejecutar√° en su totalidad, incluso para verificar la firma m√∫ltiple.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es importante que haya restricciones en el tama√±o m√°ximo para cada uno de los scripts enumerados y esto es 520 bytes. Este n√∫mero se calcul√≥ sobre la base de que Desbloquear script puede caber en un m√°ximo de 15 firmas y 15 claves p√∫blicas correspondientes, as√≠ como varias operaciones para verificar estos valores. As√≠ es como se obtuvo un cierto n√∫mero, que, al redondear, dio 520 bytes. Debe decirse que este n√∫mero se obtuvo con la expectativa de que la direcci√≥n de m√∫ltiples firmas del tipo "15 de 15" es un l√≠mite lo suficientemente razonable para el uso pr√°ctico. Canjear script cuando se utiliza un gran n√∫mero de firmas se vuelve muy grande en volumen. El usuario que usa la direcci√≥n de m√∫ltiples firmas u otras direcciones P2SH, cuando gasta monedas de ellas, tiene transacciones muy grandes. Significaque para confirmar sus transacciones tendr√° que pagar grandes comisiones.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beneficios de P2SH </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consideraremos por separado las ventajas de P2SH. </font><font style="vertical-align: inherit;">La primera es que tales direcciones pueden codificarse en la forma familiar utilizando Base58, en la que su longitud es de 34 caracteres. </font><font style="vertical-align: inherit;">De acuerdo con BIP13, que define las reglas para establecer el byte de versi√≥n para las direcciones de Bitcoin codificadas por Base58Check, la direcci√≥n comenzar√° con un triple, es decir, se inserta all√≠ un byte de versi√≥n espec√≠fico. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como ejemplo, puede ver la direcci√≥n P2SH. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3P14159f73E4gFr7JterCCQh9QjiTjiZrG</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esto puede no ser una direcci√≥n de m√∫ltiples firmas. </font><font style="vertical-align: inherit;">Canjear script puede describir no solo una direcci√≥n de m√∫ltiples firmas, sino tambi√©n otras reglas complejas para gastar monedas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregamos que esta no es la √∫nica forma de organizar la firma m√∫ltiple en Bitcoin. No puede usar P2SH, pero en el resultado que pagar√° la direcci√≥n de m√∫ltiples firmas, no el valor hash del script, sino el script en s√≠ mismo, es decir, enumere todas las claves p√∫blicas directamente en el resultado y establezca la operaci√≥n en multisignatura. Sin embargo, cuando env√≠a monedas a esta direcci√≥n, divulga inmediatamente las claves p√∫blicas, ya que estar√°n en el dominio p√∫blico y en ese momento las monedas se almacenar√°n en ellas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Y otro inconveniente es que el remitente de las monedas en la direcci√≥n de m√∫ltiples firmas tiene una gran transacci√≥n, por lo que tendr√° que pagar una gran comisi√≥n. Es poco probable que el remitente quiera pagar de m√°s por el hecho de que el destinatario quiera usar la firma m√∫ltiple. P2SH le permite transferir los costos de comisi√≥n al destinatario. Si el destinatario quiere aceptar monedas en la direcci√≥n de m√∫ltiples firmas, √©l mismo pagar√° las grandes transacciones, lo cual es un enfoque m√°s justo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agregamos que P2SH le permite implementar diferentes combinaciones de dicha firma m√∫ltiple (2 de 2, 2 de 3 y otras). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considere esquem√°ticamente el env√≠o a una direcci√≥n de firma m√∫ltiple.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a7/34a/285/7a734a285e901f5710c15b2b9e365354.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Supongamos que Alice quiere pagarle a Bob, que usa solo direcciones de m√∫ltiples firmas. Para hacer esto, Bob localmente en su computadora (por cierto, puede haber alg√∫n tipo de organizaci√≥n en lugar de Bob) genera varias claves privadas, recibe de ellas las claves p√∫blicas correspondientes, que se concatenan de cierta manera. Muy a menudo, las claves p√∫blicas se codifican primero con Base58Check, y luego se ordenan alfab√©ticamente y luego se concatenan.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este enfoque vale la pena cuando se requiere el rec√°lculo de claves p√∫blicas a partir de claves personales. Deben ser concatenados exactamente en el mismo orden, porque el siguiente paso es crear un Script de canje y hash. Si exactamente las mismas claves entran en Canjear script, pero en un orden diferente, obtendremos un valor hash diferente y una direcci√≥n diferente. Esto implicar√° ciertos malentendidos. Por lo tanto, antes de la concatenaci√≥n, las claves p√∫blicas deben clasificarse de acuerdo con alguna regla. Y con mayor frecuencia utilizan la clasificaci√≥n alfab√©tica en el sistema de n√∫meros Base58.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entonces Bob calcul√≥ el valor hash de Canjear script. √âl puede representarlo como 20 bytes y enviarlo a Alice, diciendo que esta es una direcci√≥n de m√∫ltiples firmas usando P2SH. Sin embargo, Bob puede codificarlo con un byte de versi√≥n, como una direcci√≥n normal, y simplemente enviarlo a Alice. Alice entender√° por el byte de la versi√≥n que esta es una direcci√≥n de m√∫ltiples firmas, compondr√° una transacci√≥n y completar√° su salida en consecuencia para que Bob reciba sus monedas. Luego propaga la transacci√≥n a la red. Est√°n esperando confirmaci√≥n y Bob acepta el pago de Alice. Bob de reemplazo, por ejemplo, proporciona un servicio o transfiere bienes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Llega un momento en que Bob quiere gastar estas monedas. Debe entenderse que el script de canje completo no se divulg√≥ p√∫blicamente mientras las monedas estaban en su direcci√≥n de firma m√∫ltiple. E incluso Alice no vio exactamente qu√© claves p√∫blicas usaba Bob, cu√°ntas de ellas hab√≠a, etc. Ella no sabe en absoluto por qu√© reglas se compone esta direcci√≥n P2SH, direcci√≥n de m√∫ltiples firmas o no, etc. Por consiguiente, ataques a dispositivos electr√≥nicos. Todav√≠a no es posible una firma digital (en una curva el√≠ptica). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digamos que Bob quiere enviar un pago a Eve.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c20/432/91c/c2043291cb2bb81e317e418b47c98645.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ella genera una nueva direcci√≥n y se la da a Bob. Crea una transacci√≥n en blanco en la entrada de la cual indica la transacci√≥n en la que recibi√≥ monedas de Alice, y la salida es la direcci√≥n de Eva. Ahora debe proporcionar evidencia de la propiedad de las monedas que gasta. Para hacer esto, toma dos de sus claves privadas (mencionamos anteriormente que su direcci√≥n de m√∫ltiples firmas implica la opci√≥n ‚Äú2 de 5‚Äù), a partir de la cual calcula dos firmas para esta transacci√≥n. A continuaci√≥n, toma el Script de canje completo y lo agrega a la entrada de la transacci√≥n.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenga en cuenta que este Redeem Script debe almacenarse en la computadora de Bob por completo o debe recordar el orden en que us√≥ las claves p√∫blicas para componer este script. Si aplic√≥ ciertas reglas de clasificaci√≥n, entonces debe recordarlas. Tambi√©n debe recordar que una direcci√≥n de m√∫ltiples firmas est√° vinculada a ciertas claves privadas. Sin este conocimiento, Bob no habr√≠a sabido en cu√°l de sus claves privadas operar y en qu√© orden deber√≠an ser procesadas para obtener la direcci√≥n deseada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, tiene dos firmas y un script de canje completo. La transacci√≥n se considera correcta y Bob la distribuye a la red, y luego espera la confirmaci√≥n. Esto es lo principal de gastar con una direcci√≥n de m√∫ltiples firmas.</font></font><br><br><h2>  Preguntas </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora llegamos a sus preguntas. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øEs posible ejecutar la misma billetera simult√°neamente en tres computadoras diferentes e iniciar la sincronizaci√≥n?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lo m√°s probable es que estemos hablando de alg√∫n tipo de nodo de red: un nodo SPV o un nodo completo. Se usaron varias computadoras diferentes y la misma billetera. Y una billetera significa llaves privadas. Hay varios nodos completos que implementan la funcionalidad de billetera. En estos nodos, insertamos las mismas claves privadas y comenzamos la sincronizaci√≥n. Lo m√°s probable es que, con la sincronizaci√≥n completa con la red, veamos el mismo saldo en cada billetera que usa su propio nodo. Si ve cambios en un nodo, luego de la sincronizaci√≥n con la red ver√° exactamente los mismos cambios en todos los dem√°s nodos. La transacci√≥n no se mantiene en secreto, se distribuye a todos los nodos que la verifican y muestran los cambios correspondientes, si se trata de sus direcciones. De hecho, s√≠, puede usar las mismas teclas en varios nodos,pero todas las transacciones tambi√©n se sincronizar√°n autom√°ticamente. Bitcoins ciertamente no se duplicar√° con esto y, adem√°s, no se triplicar√°.</font></font><br><br> <i>‚Äî  P2SH   Segregated Witness?</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Testigo segregado es una estructura de transacci√≥n en la que la evidencia de la propiedad de las monedas se transfiere a una estructura separada, no caen en la cadena de bloques, pero al validar las transacciones, se distribuyen juntas, es decir, todos los validadores verifican la correcci√≥n de las transacciones en una estructura separada con prueba. Despu√©s de que se confirma la transacci√≥n, la evidencia no se guarda, ya que no tiene sentido. Tambi√©n hay ventajas en la construcci√≥n de tales cadenas de transacciones en las que ciertas monedas sin confirmaci√≥n real en la transacci√≥n actual ya se gastan en la pr√≥xima construida sobre la base de esta, pero no se distribuyen a la red. Por lo tanto, se forman cadenas de transacciones que no revelan evidencia de propiedad de monedas. Esto facilita la transferencia de datos y agrega privacidad. Se utiliz√≥ un tipo diferente de direcci√≥n para Testigo segregado,Contiene operandos ligeramente diferentes. Es posible enviar monedas almacenadas en direcciones regulares, incluidas las direcciones P2SH, a las direcciones Witness P2SH.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øLas direcciones de los tres primeros comienzan en Lighting Network?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BIP13 define las reglas mediante las cuales se selecciona un byte de versi√≥n para las direcciones de Bitcoin en la red de prueba, otras monedas, etc. S√≠, Lighting Network usa direcciones de m√∫ltiples firmas, que tambi√©n usan el m√©todo P2SH para establecer condiciones. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øPor qu√© es imposible personalizar una billetera, es decir, vincularla a una persona espec√≠fica?</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bitcoin como protocolo de un sistema de pago no requiere la identificaci√≥n de la identidad de una billetera, porque funciona de acuerdo con las leyes de las matem√°ticas, y las matem√°ticas no permiten describir a una persona como persona. Adem√°s, este no es un requisito previo para verificar las transacciones. Hay suficiente firma digital. Quien pueda generar tales firmas es su propietario; esto no se aplica al protocolo de Bitcoin. Por lo tanto, una firma puede ser propiedad de una persona, un grupo de varias personas, un robot, etc. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cuanto a la personalizaci√≥n, si establece una conexi√≥n entre una direcci√≥n espec√≠fica y una persona espec√≠fica, viola la privacidad y puede desanonizar parte de la red con un cierto grado de probabilidad. En general, la base de datos est√° abierta, pero no contiene datos de identidad.</font></font><br><br> <i>‚Äî    ,    70-80%,    ?</i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Est√° bien escrito que esta es una moneda, no una criptomoneda, porque la criptomoneda funciona con los mismos principios que Bitcoin, es decir, todos los procesos est√°n m√°ximamente descentralizados: emisi√≥n, verificaci√≥n de transacciones, almacenamiento de datos, aceptaci√≥n de cambios, etc. Pero existen tales monedas. , los llamaremos monedas digitales, en las que no todos los procesos enumerados est√°n descentralizados. Una de las opciones puede ser un problema centralizado, es decir, no existe la miner√≠a, la miner√≠a, es decir, no hay soluci√≥n para un problema complejo. De acuerdo con este principio, Ripple, Stellar, moneda digital NXT, Cardano funcionan. All√≠ se aplicaron otros principios de distribuci√≥n de monedas entre los usuarios, por ejemplo, a trav√©s de ICO, prueba de identidad, etc. Debido al hecho de que no todos los procesos pueden ser descentralizados e independientes, no se puede nombrar ninguna moneda digital</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criptomoneda</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Adem√°s, la cuesti√≥n de la confianza en una moneda en particular es de naturaleza personal. </font><font style="vertical-align: inherit;">Usted decide el monto de este fideicomiso. </font><font style="vertical-align: inherit;">Es necesario tener en cuenta los fines para los que se utiliza la moneda, as√≠ como sus riesgos y limitaciones.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es415757/">https://habr.com/ru/post/es415757/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es415745/index.html">De subastas a canciones de cuna: c√≥mo y d√≥nde "funciona" la voz humana</a></li>
<li><a href="../es415747/index.html">Arist√≥teles ten√≠a raz√≥n. Las personas no necesitan vida eterna ni felicidad absoluta.</a></li>
<li><a href="../es415749/index.html">C√≥mo aprender un idioma extranjero sin un maestro. Parte 2. "Estrategia por turnos"</a></li>
<li><a href="../es415753/index.html">Brave browser se integra con Tor</a></li>
<li><a href="../es415755/index.html">Derivados de blockchain: resolviendo el problema por $ 500 billones y ganando el hackat√≥n Consensus 2018</a></li>
<li><a href="../es415759/index.html">La NSA ha comenzado a eliminar metadatos que se registraron debido a un "error t√©cnico"</a></li>
<li><a href="../es415761/index.html">Qu√©, c√≥mo y por qu√© en los anuncios jugables</a></li>
<li><a href="../es415763/index.html">El gobierno de los Estados Unidos est√° discutiendo la posibilidad de recuperar el control sobre la IANA [pero esto es poco probable]</a></li>
<li><a href="../es415765/index.html">¬øPor qu√© VMware decidi√≥ crear una plataforma para desarrollar blockchains empresariales?</a></li>
<li><a href="../es415767/index.html">Tesla Inc ha abierto la posibilidad de pedir un Tesla Model 3 para residentes de Canad√° y Estados Unidos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>