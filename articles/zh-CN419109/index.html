<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘‚ğŸ» ğŸš¼ ğŸš› è§£é‡Šä¸€ä¸‹Android Pä¸­çš„åˆ˜æµ·ã€‚å¦‚ä½•ä½¿ç”¨Android Cutoutï¼Ÿ ğŸ–±ï¸ ğŸ’ ğŸ—ƒï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2007å¹´9æœˆçƒ§æ¯ã€‚ 2017å¹´9æœˆï¼Œè‹¹æœå°†æ—¶å°šé‡æ–°æµè¡Œï¼Œæ¨å‡ºäº†iPhone X.æˆ‘ä»¬çš„ä¸­å›½æœ‹å‹æ¯«ä¸çŠ¹è±«åœ°ä»è‹¹æœå¤åˆ¶äº†è¿™ç§è®¾è®¡ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ï¼ˆå°½ç®¡ç¬¬ä¸€ä¸ªè¿·ä½ æ¡çº¹ä»ç„¶åœ¨Essential Phoneä¸­ï¼Œä½†å¹¶æ²¡æœ‰èµ·é£ï¼‰ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ åä¸ºP20ï¼Œåç¡•Zenfone 5ï¼Œä¸€åŠ 6ï¼Œæ‘©æ‰˜ç½—æ‹‰O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>è§£é‡Šä¸€ä¸‹Android Pä¸­çš„åˆ˜æµ·ã€‚å¦‚ä½•ä½¿ç”¨Android Cutoutï¼Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/419109/"> <s>2007å¹´9æœˆçƒ§æ¯ã€‚</s>  2017å¹´9æœˆï¼Œè‹¹æœå°†æ—¶å°šé‡æ–°æµè¡Œï¼Œæ¨å‡ºäº†iPhone X.æˆ‘ä»¬çš„ä¸­å›½æœ‹å‹æ¯«ä¸çŠ¹è±«åœ°ä»è‹¹æœå¤åˆ¶äº†è¿™ç§è®¾è®¡ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ï¼ˆå°½ç®¡ç¬¬ä¸€ä¸ªè¿·ä½ æ¡çº¹ä»ç„¶åœ¨Essential Phoneä¸­ï¼Œä½†å¹¶æ²¡æœ‰èµ·é£ï¼‰ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨çœ‹åˆ°äº†ä»€ä¹ˆï¼Ÿ åä¸ºP20ï¼Œåç¡•Zenfone 5ï¼Œä¸€åŠ 6ï¼Œæ‘©æ‰˜ç½—æ‹‰One Powerï¼Œå°ç±³Redmi 6å’Œå…¶ä»–æˆ–å¤šæˆ–å°‘çš„çŸ¥ååˆ¶é€ å•†å·²ç»ç”Ÿäº§æˆ–å®£å¸ƒäº†åˆ˜æµ·æ‰‹æœºã€‚ ä¸‰æ˜Ÿå’Œè°·æ­Œæ˜¯è¿™åœº<s>äº‰å¤º</s>æ— æ¡†æŠ€æœ¯çš„äº‰å¤ºæˆ˜çš„æœ€åæ®ç‚¹ã€‚ è¿˜æ˜¯ä¸è¡Œ æ®ä¼ è¨€ï¼Œè°·æ­ŒPixel 3 XLä¹Ÿå°†<s>å¸¦æœ‰</s>ä¼˜é›…çš„é¢†å£ã€‚ å¥½å§ï¼Œä½œä¸ºå¼€å‘äººå‘˜ï¼Œæˆ‘ä»¬åªèƒ½ä¸ºæ­¤å‰ªè£ä¼˜åŒ–å…¶åº”ç”¨ç¨‹åºï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥ç»§ç»­èˆ’é€‚åœ°ä½¿ç”¨å®ƒä»¬ã€‚ æˆ‘è¦æ±‚çŒ«ä¸‹æä¾›è¯¦ç»†ä¿¡æ¯ã€‚ <br><br><img src="https://habrastorage.org/webt/vc/za/ep/vczaephxhgg4entua42pcfj4rxa.png"><br><a name="habracut"></a><br> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šåº”ç”¨ç¨‹åºæ˜¯å¦éœ€è¦ä»»ä½•ä¼˜åŒ–ï¼Ÿ <br> å¦‚æœæ‚¨æœ‰ä¸€ä¸ªå…¨å±åº”ç”¨ç¨‹åºæˆ–ä¸»é¢˜ä¸­åŒ…å«<code>windowActionBarOverlay = true</code> ï¼Œåˆ™å¾ˆå¯èƒ½éœ€è¦å®ƒã€‚ <br><br> å‡ ä¹æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½ç¦»ä¸€ä¸ªå±å¹•å¾ˆè¿œï¼Œå¹¶ä¸”æ‚¨å¯èƒ½ä¸ä¼šæ³¨æ„åˆ°å…¶ä¸­ä¸€ä¸ªå¸ƒå±€çš„å¸ƒå±€ã€‚ ç‰¹åˆ«æ˜¯åœ¨åº”ç”¨ç¨‹åºå…·æœ‰å¤§é‡é—ç•™ä»£ç çš„æƒ…å†µä¸‹ã€‚ å› æ­¤ï¼Œæ‚¨ä»åº”æµè§ˆæ‰€æœ‰ä¸»å±å¹•å¹¶ä»”ç»†æ£€æŸ¥ã€‚ è®©æˆ‘ä»¬æ‰¾å‡ºä¸ºæ­¤éœ€è¦åšçš„äº‹æƒ…ã€‚ <br><br><h4>  1.å‡†å¤‡æµ‹è¯•è®¾å¤‡/ä»¿çœŸå™¨ </h4><br> ä¸ºäº†ä½¿ç”¨åˆ˜æµ·æµ‹è¯•æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œæ‚¨éœ€è¦ï¼ˆè°¢è°¢ï¼ŒåŠ æ²¹ï¼ï¼‰AndroidPã€‚å½“å‰ï¼ŒAndroid P Preview 5å¯ç”¨äºä»¥ä¸‹è®¾å¤‡ï¼ˆæ„Ÿè°¢Project Trebleï¼‰ï¼š <br> åŸºæœ¬ç”µè¯ <br>  Google Pixel 2ï¼› <br>  Google Pixel 2 XLï¼› <br>  Google Pixel <br>  Google Pixel XL <br> è¯ºåŸºäºš7 plusï¼› <br> ä¸€åŠ 6; <br>  Oppo R15 Pro; <br> ç´¢å°¼Xperia XZ2; <br> ä½“å†…X21UD; <br>  Vivo X21; <br> å°ç±³Mi Mix 2Sã€‚ <br><br> è¦åœ¨æ‚¨çš„è®¾å¤‡ä¸Šå®‰è£…Android Pï¼Œåªéœ€è½¬åˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a> ï¼Œç„¶åä¸ºæ‚¨çš„è®¾å¤‡å•å‡»â€œè·å–Betaâ€ã€‚ ç©ºä¸­é£è¡Œæˆ–è‡ªå·±æ»šåŠ¨-é€‰æ‹©æ˜¯æ‚¨çš„ã€‚ ç½‘ç«™ä¸Šçš„è¯´æ˜é™„åã€‚ <br> ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸èƒ½æˆ–ä¸æƒ³åœ¨è®¾å¤‡ä¸Šå®‰è£…Android Pï¼Œåˆ™æ²¡æœ‰äººå–æ¶ˆæ¨¡æ‹Ÿå™¨ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„çš„</a>è®¾ç½®è¯´æ˜ã€‚ <br><br><h4>  2.ä»¥ç¼–ç¨‹æ–¹å¼æ‰“å¼€çˆ†ç‚¸æœ¬èº«ï¼ˆå¦‚æœæ²¡æœ‰ç¡¬ä»¶ï¼‰ </h4><br> ä¸€åˆ‡éƒ½å¾ˆç®€å•ï¼šè½¬åˆ°ç³»ç»Ÿ-&gt;å¼€å‘äººå‘˜é€‰é¡¹-&gt;æ¨¡æ‹Ÿå¸¦æœ‰åˆ‡å£çš„æ˜¾ç¤ºã€‚ <br> æœ‰3ç§é€‰é¡¹å¯ä¾›é€‰æ‹©ï¼š <br><ul><li> è½¬è§’ </li><li> åŒå€ </li><li> é«˜å¤§ </li></ul><br><img src="https://habrastorage.org/webt/cz/oo/pw/czoopw-4xddmw5l5f9k9-obslpa.png" width="300"><br> å®ƒä»¬çœ‹èµ·æ¥å¦‚ä¸‹ï¼š <br><table><tbody><tr><th> è½¬è§’ </th><th> åŒå€ </th><th> é«˜å¤§ </th></tr><tr><td><img src="https://habrastorage.org/webt/hs/x2/4b/hsx24b9mdq9bf3i1wl50vycxpru.png"></td><td><img src="https://habrastorage.org/webt/pq/ta/hj/pqtahjumpjjnulq24ir5deudl0m.png"></td><td><img src="https://habrastorage.org/webt/i0/he/f9/i0hef98an6wlx95vlg71evri_9s.png"></td></tr></tbody></table><br><h4>  3.æµè§ˆä¸»å±å¹• </h4><br> å½“ç„¶ï¼Œæ¯ä¸ªäººçš„æƒ…å†µéƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ æœ‰äººæœ‰ç®€å•çš„é€»è¾‘ï¼Œæœ‰äººæ²¡æœ‰ã€‚ æˆ‘å°†ç»™å‡ºä¸€äº›ç¤ºä¾‹ï¼Œè¿™äº›ç¤ºä¾‹åœ¨æˆ‘çš„åº”ç”¨ç¨‹åºä¸­éƒ½å…·æœ‰ç»è¿‡å¸ƒå±€çš„å±å¹•ã€‚ <br><table><tbody><tr><th> æ¢ç´¢ </th><th> ä¸ªäººèµ„æ–™ </th></tr><tr><td><img src="https://habrastorage.org/webt/br/8w/nb/br8wnbapotdaxbd9gwevvq7gqgq.png" width="300"></td><td><img src="https://habrastorage.org/webt/lq/th/bm/lqthbm55j1rexitpvdjhbwmtvla.png" width="300"></td></tr></tbody></table><br> ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ¶ˆé™¤å¸ƒå±€ç¼ºé™·çš„æ–¹æ³•æ˜¯ä»€ä¹ˆã€‚ <br><br><h4> ä¸æé«˜compileSdkVersion </h4> ä»20 APIå¼€å§‹ï¼Œå‡ºç°äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WindowInsets</a>ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rect</a>å¯¹è±¡ï¼Œå®ƒæè¿°å±å¹•çš„å¯è®¿é—®éƒ¨åˆ†å’Œä¸å¯è®¿é—®éƒ¨åˆ†ã€‚ è¿™äº›æ–¹æ³•ä¸å®ƒä»¬ä¸€èµ·å‡ºç°åœ¨Viewä¸­ï¼Œå¯ç”¨äºå¤„ç†å±å¹•æ— æ³•è®¿é—®éƒ¨åˆ†çš„åæ ‡ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">WindowInsets </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispatchApplyWindowInsets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WindowInsets)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">WindowInsets </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onApplyWindowInsets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WindowInsets)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">requestApplyInsets</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setOnApplyWindowInsetsListener</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(OnApplyWindowInsetsListener)</span></span></span></span>;</code> </pre> <br> æœ‰å…³å¦‚ä½•ä½¿ç”¨å®ƒä»¬çš„è¯¦ç»†ä¿¡æ¯åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a> ã€‚ <br><br> æœ‰ä¸¤ç§ä½¿ç”¨è¿™äº›æ–¹æ³•çš„æ–¹æ³•ï¼š <br>  aï¼‰åœ¨å¸ƒå±€æˆ–è§†å›¾çš„å¸ƒå±€ä¸­æ”¾ç½®æ ‡è®°<code>android:fitsSystemWindows="true"</code> ï¼› <br>  bï¼‰ä»ä»£ç ä¸­æ‰§è¡Œï¼š <br><br><pre> <code class="java hljs">layout.setFitsSystemWindows(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); layout.requestApplyInsets();</code> </pre> <br><table><tbody><tr><th> æ˜¯ </th><th> å·²æˆä¸º </th></tr><tr><td><img src="https://habrastorage.org/webt/fw/8e/ne/fw8ene_z6sxphxdncb9yzcxjdu4.png" width="300"></td><td><img src="https://habrastorage.org/webt/hv/ml/jm/hvmljmblq51npqv32f7o_lcjnj8.png" width="300"></td></tr></tbody></table><br><h4> å°†compileSdkVersionå‡çº§åˆ°ç‰ˆæœ¬28 </h4> åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œæ‚¨å°†ä¸å¾—ä¸åˆ‡æ¢åˆ°è¯¥ç‰ˆæœ¬ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸ç°åœ¨å°±ä¸ºæ­¤åšå‡†å¤‡å‘¢ï¼Ÿ ä½†æ˜¯è¦å°å¿ƒï¼Œå¦‚æœæ‚¨çš„é¡¹ç›®ä¸­æœ‰å•å…ƒæµ‹è¯•ï¼ˆæˆ‘å¸Œæœ›æ‚¨æœ‰å®ƒä»¬ï¼‰ï¼Œé‚£ä¹ˆJUnitè½¯ä»¶åŒ…å·²ç»ç§»å¼€äº†ã€‚ åœ¨æ­¤è¯´æ˜å¦‚ä½•è¿æ¥ã€‚ <br><br> é‚£ä¹ˆï¼ŒAndroid Pç°åœ¨ä¸ºæˆ‘ä»¬æä¾›äº†å“ªäº›é€‰æ‹©ï¼Ÿ <br><br> ç­”ï¼šWindowManager.LayoutParamså…·æœ‰3ä¸ªæ–°æ ‡å¿—ï¼š <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LAYOUT_IN_DISPLAY_CUTOUT_MODE_DEFAULT-</a>å¸¦æœ‰æ­¤æ ‡å¿—ï¼Œä»…åœ¨çºµå‘æ¨¡å¼ä¸‹ï¼Œåˆ˜æµ·æ‰ä¼šæ˜¾ç¤ºåœ¨åº”ç”¨ç¨‹åºå±å¹•çš„é¡¶éƒ¨ï¼Œåœ¨æ¨ªå‘æ¨¡å¼ä¸‹ï¼Œé»‘æ¡åªä¼šå‡ºç°ï¼› <br><img src="https://habrastorage.org/webt/lq/th/bm/lqthbm55j1rexitpvdjhbwmtvla.png" width="300"><br><img src="https://habrastorage.org/webt/6r/uc/ne/6rucneby85bjrq9wt5uc9n6rpbw.png" height="300"></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LAYOUT_IN_DISPLAY_CUTOUT_MODE_NEVER-</a>å®Œå…¨æ²¡æœ‰å¸¦æœ‰æ­¤æ ‡å¿—çš„æ—¶å°š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¡çº¹</a> ï¼Œå®ƒå°†ä¸é»‘è‰²æ¡çº¹åˆå¹¶ï¼› <br><img src="https://habrastorage.org/webt/qh/1s/nb/qh1snbun-pzldcfc9hotrbwfsms.png" width="300"><br><img src="https://habrastorage.org/webt/-d/at/s2/-dats2qzjrvzs-nhyxgwcngaf7q.png" height="300"></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LAYOUT_IN_DISPLAY_CUTOUT_MODE_SHORT_EDGES-</a>ä½¿ç”¨æ­¤æ ‡å¿—æ—¶ï¼Œåˆ˜æµ·å§‹ç»ˆå¤„äºä»»ä½•æ–¹å‘ã€‚ <br><img src="https://habrastorage.org/webt/ow/7w/my/ow7wmyne6fan2tkiu9skhw-fhqg.png" width="300"><br><img src="https://habrastorage.org/webt/--/us/i2/--usi2coxgmmtdja8wzb8lapbqe.png" height="300"></li></ul><br> å¦‚ä½•ç”³è¯·ï¼Ÿ <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.attributes.layoutInDisplayCutoutMode = WindowManager.LayoutParams.LAYOUT_IN_DISPLAY_CUTOUT_MODE_SHORT_EDGES</code> </pre> <br>  B.å¦‚æœé€‰é¡¹Aä¸é€‚åˆæ‚¨ï¼Œå¹¶ä¸”æ‚¨éœ€è¦è€ƒè™‘åˆ°ä¸å¹¸çš„ä¿é™©å¼€å…³çš„ä½ç½®ï¼ˆä¾‹å¦‚ï¼ŒçŠ¶æ€æ ä¸­ä¼šæ˜¾ç¤ºæŸäº›å†…å®¹ï¼Œä¾‹å¦‚Telegramä¸­çš„è¿æ¥æ¶ˆæ¯ï¼‰ï¼Œé‚£ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ–°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DisplayCutout</a>ç±»å°†æœ‰æ‰€å¸®åŠ©ã€‚ <br> è€ƒè™‘å…¶æ–¹æ³•ï¼š <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">getBoundingRectsï¼ˆï¼‰</a>è¿”å›Rectå¯¹è±¡çš„åˆ—è¡¨ï¼Œæ¯ä¸ªå¯¹è±¡æŒ‡ç¤ºå±å¹•çš„ä¸å¯è®¿é—®åŒºåŸŸï¼› </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">getSafeInsetLeftï¼ˆï¼‰</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">getSafeInsetRightï¼ˆï¼‰</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">getSafeInsetTopï¼ˆï¼‰</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">getSafeInsetBottomï¼ˆï¼‰åˆ†åˆ«</a>è¿”å›å·¦ï¼Œå³ï¼Œä¸Šå’Œä¸‹ç¼©è¿›ï¼Œè€Œä¸ä¼šå‡å°‘åƒç´ ã€‚ </li></ul><br> æœ‰äº†ä»–ä»¬ï¼Œæ‚¨å·²ç»å¯ä»¥åšæ‰€æœ‰æƒ³åƒå¾—åˆ°çš„äº‹æƒ…ã€‚ æ˜¯å¦è¦-åœ¨å…¶ä»£ç ä¸­ç§»åŠ¨<code>margin</code> ã€‚  <code>OnApplyWindowInsetsListener</code>éœ€è¦ï¼Œè¯·åœ¨<code>OnApplyWindowInsetsListener</code>å¤„ç†å®ƒï¼Œå¹¶è¿›è¡Œ<code>consumeDisplayCutout()</code> ã€‚ ä¹Ÿè®¸æ‚¨éœ€è¦æ›´å¤æ‚çš„æ“ä½œã€‚ æˆ‘å°†ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜çˆ†ç‚¸ã€‚ <br><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SampleFragment</span></span></span><span class="hljs-class">() : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fragment</span></span></span><span class="hljs-class">() { private lateinit var root: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewGroup</span></span></span><span class="hljs-class"> override fun onCreateView(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">inflater</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LayoutInflater</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewGroup</span></span></span><span class="hljs-class">?, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">savedInstanceState</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bundle</span></span></span><span class="hljs-class">?): </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">? { return inflater.inflate(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">layout</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sample_fragment</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">false</span></span></span><span class="hljs-class">) } override fun onViewCreated(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">view</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">savedInstanceState</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Bundle</span></span></span><span class="hljs-class">?) { super.onViewCreated(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">view</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">savedInstanceState</span></span></span><span class="hljs-class">) root = view.findViewById(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">id</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">root</span></span></span><span class="hljs-class">) addArrowsToCutout() } private fun addArrowsToCutout() { // ,      attach  window,    null' val cutoutList = root.rootWindowInsets?.displayCutout?.boundingRects cutoutList?.forEach { addArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">!!.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getDrawable</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drawable</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">left</span></span></span><span class="hljs-class">), it.left.toFloat(), it.top + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bottom</span></span></span><span class="hljs-class"> - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">top</span></span></span><span class="hljs-class">).toFloat() / 2, ::calculateLeftArrow) addArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">!!.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getDrawable</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drawable</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class">), it.right.toFloat(), it.top + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bottom</span></span></span><span class="hljs-class"> - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">top</span></span></span><span class="hljs-class">).toFloat() / 2, ::calculateRightArrow) addArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">!!.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getDrawable</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drawable</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">top</span></span></span><span class="hljs-class">), it.left + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class"> - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">left</span></span></span><span class="hljs-class">).toFloat() / 2, it.top.toFloat(), ::calculateTopArrow) addArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">!!.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">getDrawable</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">drawable</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bottom</span></span></span><span class="hljs-class">), it.left + (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">right</span></span></span><span class="hljs-class"> - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">it</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">left</span></span></span><span class="hljs-class">).toFloat() / 2, it.bottom.toFloat(), ::calculateBottomArrow) } } private fun addArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowIcon</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Drawable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">calculation</span></span></span><span class="hljs-class">: (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">) -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Unit</span></span></span><span class="hljs-class">) { val arrowView = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImageView</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">context</span></span></span><span class="hljs-class">) arrowView.setImageDrawable(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowIcon</span></span></span><span class="hljs-class">) arrowView.layoutParams = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewGroup</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LayoutParams</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewGroup</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LayoutParams</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WRAP_CONTENT</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ViewGroup</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LayoutParams</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WRAP_CONTENT</span></span></span><span class="hljs-class">) root.addView(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">) arrowView.post { calculation(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">) } } private fun calculateLeftArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">) { arrowView.x = x - arrowView.width arrowView.y = y - arrowView.height / 2 } private fun calculateRightArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">) { arrowView.x = x arrowView.y = y - arrowView.height / 2 } private fun calculateTopArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">) { arrowView.x = x - arrowView.width / 2 arrowView.y = y - arrowView.height } private fun calculateBottomArrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrowView</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Float</span></span></span><span class="hljs-class">) { arrowView.x = x - arrowView.width / 2 arrowView.y = y } }</span></span></code> </pre> <br><h4> äººåƒ </h4><br><table><tbody><tr><th> è½¬è§’ </th><th> åŒå€ </th><th> é«˜å¤§ </th></tr><tr><td><img src="https://habrastorage.org/webt/l2/kn/kr/l2knkrhjztwt4-gol5kv3lhl9fc.png"></td><td><img src="https://habrastorage.org/webt/ok/wd/9z/okwd9zs9neutlmyxurbsg2dggzc.png"></td><td><img src="https://habrastorage.org/webt/zy/d8/z-/zyd8z-0amk-izvnypdvyyhqbpkc.png"></td></tr></tbody></table><br><br><h4> é£æ™¯ </h4><br><table><tbody><tr><th> è½¬è§’ </th></tr><tr><td><img src="https://habrastorage.org/webt/bw/ex/ii/bwexii25tezwsfe6zv98rai8xrw.png" height="300"></td></tr><tr><th> åŒå€ </th></tr><tr><td><img src="https://habrastorage.org/webt/a9/dp/qo/a9dpqomfrbf7tp8tuv4oqaii8ac.png" height="300"></td></tr><tr><th> é«˜å¤§ </th></tr><tr><td><img src="https://habrastorage.org/webt/tc/cp/qj/tccpqj2m8eh2kshlsu_o-q2-kda.png" height="300"></td></tr></tbody></table><br> å› æ­¤ï¼Œå¦‚æˆ‘ä»¬æ‰€è§ï¼Œè¾¹ç¼˜å°†ç»™æˆ‘ä»¬å¸¦æ¥ä¸€äº›ä¸ä¾¿ï¼Œå¹¶ä½¿æˆ‘ä»¬åšå‡ºé¢å¤–çš„æ‰‹åŠ¿/é¢å¤–çš„æ“ä½œã€‚ åŸåˆ™ä¸Šï¼Œä¸€åˆ‡éƒ½è§£å†³äº†ã€‚ æœ€ä¸»è¦çš„æ˜¯è¦å°½å¿«æ¶ˆé™¤å¸ƒå±€ç¼ºé™·ï¼Œä»¥ä¾¿æœ‰è¶³å¤Ÿçš„å‡†å¤‡æ—¶é—´ã€‚ æˆåŠŸå¤„ç†æ‚¨çš„ä¿®æ”¹ã€‚ å¸Œæœ›Googleä¸ä¼šç ´åå…¶Playï¼ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419109/">https://habr.com/ru/post/zh-CN419109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419099/index.html">Angularä¸­çš„WebSocketsã€‚ ç¬¬2éƒ¨åˆ†ã€‚äº§å“è§£å†³æ–¹æ¡ˆ</a></li>
<li><a href="../zh-CN419101/index.html">åœ¨å¤œé—´é»‘å®¢é©¬æ‹‰æ¾ä¸Šåˆ›å»ºæ¸¸æˆ</a></li>
<li><a href="../zh-CN419103/index.html">ç”¨Lispå†™ä¸€ä¸ªç®€å•çš„ç¿»è¯‘å™¨-I</a></li>
<li><a href="../zh-CN419105/index.html">é“¾æ¥åˆ°Slurmå¹¿æ’­ï¼ˆKuberneteså¼ºåŒ–è¯¾ç¨‹ï¼‰</a></li>
<li><a href="../zh-CN419107/index.html">Dell EMC Unityæ–‡ä»¶éƒ¨ä»¶æ¦‚è¿°å’Œé…ç½®ç¤ºä¾‹</a></li>
<li><a href="../zh-CN419111/index.html">é£Ÿå“è®¾è®¡æ–‡æ‘˜2018å¹´7æœˆ</a></li>
<li><a href="../zh-CN419115/index.html">ä¸€é¸£å«å¯å¯åŠ¨CDå’Œå¤å¤æ¸¸æˆ</a></li>
<li><a href="../zh-CN419117/index.html">â€œæˆ‘å¾ˆéš¾ç†è§£æ²¡æœ‰çœ‹åˆ°æ•°å­¦ä¹‹ç¾çš„æ•°æ®ç§‘å­¦å®¶çš„åŠ¨æœºâ€-æ•°æ®ç§‘å­¦å®¶Kirill Danilyuk</a></li>
<li><a href="../zh-CN419119/index.html">ä¸‡å®é¾™é«˜çº§æ™ºèƒ½ç¬”æ˜¯è¿„ä»Šä¸ºæ­¢æœ€æ˜‚è´µçš„æ™ºèƒ½ç¬”</a></li>
<li><a href="../zh-CN419123/index.html">è‡ªç”±èŒä¸šè€…çš„å¼Šç«¯ã€‚ ä¸ªäººç»å†</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>