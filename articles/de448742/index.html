<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéä ü§úüèø üñãÔ∏è B√ºchse der Pandora: Wir analysieren die Ausnutzung der WinRAR-Sicherheitsanf√§lligkeit am Beispiel des Jobs NeoQUEST-2019 ü•Å ‚ú® üë©üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie oft kommt uns der gute alte WinRAR zu Hilfe! Von Zeit zu Zeit packt er unsere Archive sorgf√§ltig und selbstlos aus und packt sie zur√ºck. Aber wir ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>B√ºchse der Pandora: Wir analysieren die Ausnutzung der WinRAR-Sicherheitsanf√§lligkeit am Beispiel des Jobs NeoQUEST-2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/448742/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/qu/bn/xg/qubnxgfwaq7yovzl4iv997lmb4o.jpeg"></div><br>  Wie oft kommt uns der gute alte WinRAR zu Hilfe!  Von Zeit zu Zeit packt er unsere Archive sorgf√§ltig und selbstlos aus und packt sie zur√ºck.  Aber wir sind √§lter geworden und jetzt m√∂chte ich etwas Interessanteres ausprobieren, oder?  In diesem Moment fanden sie eine 19 Jahre alte Sicherheitsl√ºcke, mit der aus dem Archiv extrahierte Malware an einem beliebigen Ort gespeichert werden kann.  Lassen Sie uns am Beispiel der Aufgabe Nr. 9 aus der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Online-Phase von NeoQUEST-2019</a> sehen, wie dies getan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden kann</a> . <br><a name="habracut"></a><br>  Der Legende nach haben wir zwei Server.  Mit dem ersten Server (http://213.170.100.213:800/) k√∂nnen Sie ein Geschenk an Pandora senden, die es liebt, alle nicht identifizierten Objekte auszupacken, die ihr aufgefallen sind.  Das "Geschenk" -Format ist bekannt: Der Server l√§dt nur seltene Archive herunter.  Laden Sie ein beliebiges rar-Archiv herunter.  Als Antwort sehen wir Folgendes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qi/ym/w3/qiymw3i5kq5_ctj0syemqmd5zdo.png"></div><cut></cut><br>  Es ist nicht sehr wahrscheinlich, dass Pandora an unserem Archiv interessiert war.  Versuchen wir, mit nmap etwas mehr √ºber den Server zu erfahren: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/e1/vb/8h/e1vb8hxyos7bn9ek3wvwsujcan4.png"></div><br>  Jetzt wissen wir, dass der erste Server: <br><br><ul><li>  erm√∂glicht das Laden von rar-Archiven; </li><li>  unter Windows ausgel√∂st. </li></ul><br>  Win + rar = WinRar!  Wahrscheinlich werden Archive von diesem Archivierer verarbeitet, in dem sie (genauer gesagt - in der UNACEV2.DLL-Bibliothek) eine Sicherheitsl√ºcke gefunden haben, die seit 19 Jahren besteht.  Mit dieser "L√ºcke" k√∂nnen Sie den Inhalt des Archivs in ein beliebiges Verzeichnis entpacken, unabh√§ngig davon, wo der Benutzer Dateien extrahiert.  Eine detaillierte Beschreibung des Mechanismus zur Ausnutzung von Sicherheitsl√ºcken finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Wir fahren mit der Erstellung des Archivs fort, das <s>von selbst geht und selbst</s> entscheidet, wo es ausgepackt werden soll. <br><br>  Holen Sie sich zun√§chst das Dienstprogramm WinAceArchiver.  Gem√§√ü den Anweisungen unter dem obigen Link erstellen wir ein primitives Archiv, das die Datei hello.txt enth√§lt.  Klicken Sie in WinAceArchiver auf die Schaltfl√§che Erstellen, setzen Sie auf der Registerkarte Optionen die Option Komprimierung auf Speichern, kehren Sie dann zur Registerkarte Auswahl zur√ºck, w√§hlen Sie die Datei hello.txt aus, geben Sie den Pfad zum Speichern unseres Archivs an und vor allem!  - Setzen Sie die Option "Vollst√§ndigen Pfad speichern": <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1g/nd/j-/1gndj-8msl8xmuzc1r0fzh-cgwa.png"></div><br>  Klicken Sie anschlie√üend auf die Schaltfl√§che "Hinzuf√ºgen" und rufen Sie das Hello.ace-Archiv auf.  Es bleibt, den Pfad leicht anzupassen und die Pr√ºfsumme zu korrigieren.  Jeder bin√§re Editor und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jedes acefile.py-</a> Skript helfen uns dabei, die tats√§chlichen Werte selbst zu berechnen. <br><br>  Um die Sicherheitsanf√§lligkeit auszunutzen, m√ºssen Sie vor dem absoluten Pfad der Datei eine Datentr√§gerbezeichnung hinzuf√ºgen, die vom Archivierer gel√∂scht wird.  Dann wird der Rest des Pfades als "sicherer" Verwandter angesehen.  √ñffnen Sie also den Editor und √§ndern Sie den Pfad so, dass er mit <b>C: \ C: \</b> beginnt. <br><br>  Es war: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fn/2x/vq/fn2xvqtmdamayxr_nitrtt_nrdu.png"></div><br>  Es wurde: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lu/a0/qm/lua0qmuxalmey-s7jglopgqzuk8.png"></div><br>  √úberpr√ºfen Sie nun die Pr√ºfsummen mit dem Skript acefile.py: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l8/xi/g2/l8xig2pzzgidr4uuor76tlwyera.png"></div><br>  Korrigieren Sie den Wert auf den aktuellen Wert: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qr/gz/5d/qrgz5dhz3lo5bnfb52mwq0fyj2m.png"></div><br>  Es bleibt nur, unser Archiv in Hello.rar umzubenennen.  Fertig.  √úberpr√ºfen Sie, wie Pandore so ein Geschenk? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p_/xc/em/p_xcem5xsxrdng0r7xg9sahapiw.png"></div><br>  Gro√üartig!  Die Erwartungen stimmten mit der Realit√§t √ºberein, und WinRar verarbeitete das Archiv genau so, wie wir es brauchten.  Es bleibt eine Sache herauszufinden: Welchen Weg brauchen wir? <br><br>  Der Legende nach wissen wir, dass Sch√§tze auf dem zweiten Server "angezeigt" werden k√∂nnen (http://213.170.100.213:900/).  Wie ist das am einfachsten?  Nat√ºrlich, indem Sie Ihr PHP-Skript ausf√ºhren, das beispielsweise das Server-Stammverzeichnis auflistet.  Wir best√§tigen unsere Vermutung: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kt/vg/hq/ktvghquulflkpex7tukpzr0s6-0.png"></div><br>  Gro√üartig, der Server ist bereit, unser PHP-Skript auszuf√ºhren!  Es ist Zeit, genau herauszufinden, wo dieses Skript abgelegt werden soll.  Bisher wissen wir, dass der Server unter Windows aktiv ist. Daher beginnt der Pfad h√∂chstwahrscheinlich mit <b>C: \</b> .  Und weiter?  Erfahren Sie etwas mehr √ºber den Schatzserver. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/og/go/2g/oggo2gsso6jknykjwqoccccbm-m.png"></div><br>  Auf dem Server wird Nginx aufgehoben.  Sicherlich folgt die Umgebung von Pandora dem letzten Wort des technologischen Fortschritts (in allem, was keine Archivierer betrifft) und verwendet die neueste Version von nginx, n√§mlich 1.15.9 (Sie k√∂nnen dies <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> √ºberpr√ºfen).  Es bleibt das Stammverzeichnis des Servers hinzuzuf√ºgen, das in der Standard-Nginx-Konfigurationsdatei angegeben ist: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/z7/ls/2e/z7ls2ezqjeqbe-bev0zjypkc8la.png"></div><br>  Das Ergebnis lautet wie folgt: <b>C: \ nginx-1.15.9 \ html</b> .  Was wird Pandora diesmal beantworten? <br><br>  Der Zugriff auf das Verzeichnis ist verboten ... Aber wir konnten uns nicht irren!  Wir sind definitiv auf dem richtigen Weg, da der Zugriff verweigert wird, aber das Verzeichnis existiert.  Es gibt wahrscheinlich etwas, von dem wir noch nichts wissen.  Wir sammeln weiterhin Informationen √ºber den Server mithilfe des Verzeichnisscanners: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/54/-1/ky/54-1kyzwef-cl2sgxrpgh4dqlfy.png"></div><br>  Ja, da ist es.  Das admin / Verzeichnis klingt vielversprechend.  Versuchen wir, Pandore ein Ass-Archiv zu senden, in dem <b>C: \ nginx-1.15.9 \ html \ admin</b> als absoluter Pfad fungiert: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rp/rh/ib/rprhibojzmdln-5gjuxri62s64y.png"></div><br>  Erfolg!  Schlie√ülich f√ºhren wir unser Skript aus, in dem das Server-Stammverzeichnis aufgef√ºhrt ist: <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">213.170.100.213</a> : 800 / admin / test34852ED2-8996-4F81-A919-30B6FE9F03AB.php</b> .  Das Skript k√∂nnte ungef√§hr so ‚Äã‚Äãaussehen: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($handle = opendir(<span class="hljs-string"><span class="hljs-string">'C:\nginx-1.15.9\html'</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> !== ($entry = readdir($handle))) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($entry != <span class="hljs-string"><span class="hljs-string">"."</span></span> &amp;&amp; $entry != <span class="hljs-string"><span class="hljs-string">".."</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"$entry &lt;br&gt;"</span></span>; } } closedir($handle); } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Das Ergebnis ist wie folgt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/-y/mo/ft-ymohxr9ufjozlokf3hykcsto.png"></div><br>  <s>Eureka!</s>  Pandorica!  Lassen Sie uns in √§hnlicher Weise sehen, mit welcher Art von ‚ÄûSchatz‚Äú <b>-Pandorica / sie</b> gef√ºllt <b>ist</b> , und die lang erwartete <b>key.txt sehen</b> , die nicht mehr <b>schwer</b> zu lesen ist.  Fertig! <br><br>  In naher Zukunft werden Artikel mit einer Analyse der verbleibenden verschiedenen Aufgaben ver√∂ffentlicht.  Und bald findet NeoQUEST 2019 statt!  Alle Neuigkeiten - auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der</a> Event- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Website</a> nicht verpassen! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de448742/">https://habr.com/ru/post/de448742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de448730/index.html">√úberwachen Sie das √úbertakten</a></li>
<li><a href="../de448732/index.html">Zwischenwirbelhernie? Arbeite an ihr</a></li>
<li><a href="../de448734/index.html">Drohnen und Roboter helfen, die Kathedrale Notre Dame in Paris zu retten</a></li>
<li><a href="../de448738/index.html">Wer jagt Startups?</a></li>
<li><a href="../de448740/index.html">Wir h√∂ren SID-Musik (Commodore 64) √ºber OPL3 auf modernen PCs</a></li>
<li><a href="../de448744/index.html">Wie √ºbertrage ich eine Variable vom Fragment zur Aktivit√§t in Android?</a></li>
<li><a href="../de448746/index.html">Indizes in PostgreSQL - 7 (GIN)</a></li>
<li><a href="../de448748/index.html">√úberlegungen zu Sch√∂nheit und Code</a></li>
<li><a href="../de448750/index.html">√úber eine Schwachstelle ist das nicht</a></li>
<li><a href="../de448754/index.html">Wer ist wer in Open Source: Geek-Biografien</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>