<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõå üßëüèæ‚Äçü§ù‚Äçüßëüèæ ‚úçüèΩ Crash Response: cluster √©tendu sur le site DR üì± üê´ üíù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons deux approches de la r√©cup√©ration apr√®s sinistre: un cluster ¬´√©tir√©¬ª (installation active-active) et une plate-forme avec des machines virt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Crash Response: cluster √©tendu sur le site DR</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/technoserv/blog/420971/"><img src="https://habrastorage.org/webt/vq/4b/8b/vq4b8bziie3zsdalswgid3zjmd8.jpeg"><br><br>  Nous avons deux approches de la r√©cup√©ration apr√®s sinistre: un cluster ¬´√©tir√©¬ª (installation active-active) et une plate-forme avec des machines virtuelles (r√©pliques) d√©sactiv√©es.  Ils ont plusieurs points pour enregistrer des instantan√©s. <br><br>  Il y a une demande de tol√©rance aux catastrophes, et beaucoup de nos clients en ont vraiment besoin.  Par cons√©quent, nous avons commenc√© √† √©laborer les deux sch√©mas dans le cadre de notre production. <br><br>  Les m√©thodes ont des avantages et des inconv√©nients, maintenant je vais vous en parler. <br><a name="habracut"></a><br><h3>  Cluster √©tir√© </h3><br><img src="https://habrastorage.org/webt/oe/au/pz/oeaupzuepknnmkaax9h1gsssvso.png"><br><br>  Comme vous pouvez le voir, il s'agit d'une histoire de cluster de m√©tro standard.  Chez les pros - temps d'arr√™t quasi nul, une pause uniquement au moment du d√©marrage des machines virtuelles.  Cette fonctionnalit√© fonctionne - VMware High Availability (HA).  Elle voit que les h√¥tes sont perdus et red√©marre imm√©diatement la machine virtuelle sur le site distant. <br><br>  Le lancement se fait imm√©diatement √† partir du stockage, qui se trouve dans le cluster. <br><br>  Le stockage avec un cluster g√©o-distribu√© est une fonctionnalit√© marketing de NetApp.  D'autres fabricants ont quelque chose avec un nom similaire.  Il s'agit essentiellement d'une r√©plication asynchrone r√©fl√©chie d'un c√¥t√© √† l'autre.  Nous √©crivons sur un n≈ìud du r√©seau local et nous synchronisons via des canaux de communication sp√©cialis√©s avec un autre. <br><br>  En cas de panne de l'un des syst√®mes de stockage, le reste (sur un autre site) pr√©sente le chemin d'acc√®s aux disques vers les h√¥tes restants.  Les machines virtuelles mortes sont red√©marr√©es sur elles.  Tout se passe automatiquement - le centre de donn√©es est tomb√© en panne, tout a red√©marr√©, le stockage a fonctionn√©, VMware a fonctionn√©.  Le client a vu que tout clignait des yeux et recommen√ßait. <br><br>  Le seul cache de la RAM de la VM peut √™tre perdu.  Mais si la base de donn√©es l'a supprim√©e, la perte est nulle dans le temps. <br><br>  Si nous perdons la communication entre les sites, alors tout continue √† fonctionner √† sa place et, d√®s que la connexion est r√©tablie, elle commence √† se synchroniser. <br><br>  L'inconv√©nient est le prix √©lev√©.  Parce que vous avez r√©ellement besoin d'un double SHD (de plus, de type, de vitesse et de volume de disques du premier SHD similaire sur le site principal), qui ne peut pas √™tre utilis√© d'une mani√®re ou d'une autre, sauf comme r√©serve.  De plus, la liaison au stockage pour le cluster de m√©tro, ce sont les ponts FC, le r√©seau FC et plus encore. <br><br>  Nous avons deux DPC, entre eux un faisceau FC le long de deux faisceaux (quatre lignes optiques sombres et DWDM).  Ce sont deux morceaux de fer, chacun fournit une bande passante de 200 Gbit / s pour FC et Ethernet. <br><br><h3>  Alternative avec DR </h3><br><img src="https://habrastorage.org/webt/90/zb/pk/90zbpkhak2hyp6hfmmt4afea1mo.png"><br><br>  Il existe un logiciel avec un nom intuitivement m√©morable - VMware vCloud Availability for Cloud-to-Cloud DR. <br><br>  Il s'agit d'un syst√®me permettant de cr√©er une VM identique sur un site distant une fois, relativement parlant, en 15 minutes.  Un syst√®me permettant de pr√©senter tout cela correctement aux m√©canismes de contr√¥le du cloud lui est attach√© sur du ruban √©lectrique. <br><br>  Autrement dit, la technologie de r√©plication VMware est dans le backend.  En cas d'√©chec, nous lan√ßons manuellement le plan DR sur le deuxi√®me site, il arr√™te automatiquement d'essayer de r√©pliquer, puis enregistre la machine virtuelle dans vCloud Director, personnalise les adresses IP (afin qu'il ne doive pas √™tre chang√© en machine virtuelle) et d√©marre la machine virtuelle dans l'ordre n√©cessaire.  Dans notre solution, il n'est pas n√©cessaire de modifier l'adressage, nous √©tendons les r√©seaux aux deux centres de donn√©es. <br><br>  Les machines sont constamment r√©pliqu√©es, mais pas l'int√©gralit√© du centre de donn√©es, mais seules celles s√©lectionn√©es sont des processus critiques.  Il est r√©pliqu√© de temps en temps, l'intervalle minimum est de 15 minutes (c'est un cas id√©al lorsque tout vole et qu'il y a un serveur de r√©plication d√©di√© et un minimum de changements sur la VM).  En pratique, vous en avez une copie il y a une demi-heure ou une heure.  En cas de probl√®me, les donn√©es tomb√©es dans l'intervalle √©taient perdues.  15 minutes est la question de l'agent qui collecte la nouvelle r√©plication.  Veeam dit qu'ils peuvent prendre moins de 15 minutes, mais en fait, c'est aussi plus long en pratique s'ils n'utilisent pas les fonctionnalit√©s de stockage.  Je n'ai pas vu sur une machine industrielle (pas sur un test) qu'il en serait autrement. <br><br>  Pendant longtemps, NetApp, comme de nombreux autres fabricants de syst√®mes de stockage, dispose de la technologie SnapMirror, qui vous permet de d√©placer le travail de r√©plication des hyperviseurs vers les syst√®mes de stockage, et VMware Replication peut l'utiliser. <br><br>  Alors que le service de r√©plication fonctionne, le train va loin.  Mais c'est bon march√©. <br><br>  Pourquoi est-il toujours bon march√© - parce que vous pouvez utiliser n'importe quel stockage de n'importe quel c√¥t√© (de diff√©rents fabricants, de diff√©rentes classes), vous n'avez pas besoin d'allouer un grand volume de disques √† l'avance. <br><br>  Pas besoin d'allouer un grand groupe de disques, √† l'int√©rieur duquel les lunes sont coup√©es.  Il prend juste une place sur le stockage local et est appliqu√© sur le fait de la disponibilit√© de l'enregistrement √† partir de la machine virtuelle.  Pour cette raison, la place sur le syst√®me de stockage est occup√©e de mani√®re optimale, si elle est utilis√©e pour d'autres t√¢ches.  Et il est utilis√©, car nous ne proposons pas un tel service √† tous les clients. <br><br>  Moins - vous devez configurer la r√©plication au niveau de la machine virtuelle, c'est-√†-dire contr√¥ler que tout est correctement configur√©, qu'il s'agit de la machine, assurez-vous que la r√©plication r√©ussit, qu'il n'y a pas d'erreur.  Cr√©ez des plans DR pour chaque client, effectuez leurs tests. <br><br>  Dans le premier cas, le stockage est pris, conditionnellement, infrastructurellement, presque par secteurs (plus pr√©cis√©ment, par objets).  Et puis une machine peut tomber en raison d'une t√¢che qui tombe pour des raisons logicielles li√©es √† un bogue √† des niveaux √©lev√©s ou √† des probl√®mes d'accessibilit√©.  Cela se produit un peu plus souvent que si vous ne prenez que des niveaux faibles. <br><br>  En plus - DR enregistre plusieurs points.  Vous pouvez restaurer quelques instantan√©s. <br><br>  En dehors du syst√®me d'exploitation invit√©, vous avez besoin de logiciels suppl√©mentaires. <br><br>  Afin d'obtenir tous les r√©seaux n√©cessaires √† Vcloud Director, nous avons besoin du travail de notre administrateur.  En g√©n√©ral, toute la connectivit√© r√©seau dans cette version reste avec notre administrateur.  Pour un client cloud, cela signifie une application, ce qui prend √©galement du temps. <br><br>  La r√©plication est √©galement configur√©e via l'application.  VM ajout√©e - vous devez envoyer une demande dont vous avez besoin pour la r√©pliquer.  Il ne tombe pas automatiquement dans les t√¢ches de r√©plication.  Il faut faire attention √† l'administrateur. <br><br><h3>  La diff√©rence </h3><br>  Par cons√©quent, le prix peut diff√©rer de plus de deux fois.  La r√©plication multipliera le co√ªt de l'espace disque par deux ou plus (deux copies compl√®tes + historique des modifications), plus quelque chose pour le service et la r√©servation des ressources informatiques.  Dans le cas du cluster de m√©tro, le co√ªt de l'espace sera multipli√© par deux, mais l'espace lui-m√™me co√ªtera beaucoup plus, et vous devrez r√©server fermement des n≈ìuds sur un site distant.  Autrement dit, les ressources informatiques doivent √™tre multipli√©es par deux, nous ne pouvons pas les utiliser pour autre chose. <br><br>  Dans le cas du cluster metro, nous ne pouvons utiliser que les m√™mes types de disques pour qu'il y ait un miroir complet.  Si sur le centre de donn√©es principal certains des disques sont rapides, certains lents √† 10 000 tours par minute, alors une configuration identique est n√©cessaire.  Dans le cas d'une r√©plique, des disques plus lents sur le site de sauvegarde sont possibles, ce qui est moins cher en raison du stockage.  Mais lors du passage √† une r√©serve, ses performances seront moindres.  Autrement dit, s'il stocke quelque chose sur le SSD dans le cluster principal et est r√©pliqu√© sur des disques ordinaires, le stockage sera beaucoup moins cher au prix d'un ralentissement de l'infrastructure de r√©serve. <br><br>  En ce moment, nous choisissons ce qui sera inclus dans une version ant√©rieure, nous voulons donc consulter: pouvez-vous nous dire bri√®vement comment vous organisez vos sites de DR et que souhaiteriez-vous qu'ils fassent en g√©n√©ral? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420971/">https://habr.com/ru/post/fr420971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420959/index.html">Les syst√®mes d'IA optimisent le refroidissement du datacenter</a></li>
<li><a href="../fr420963/index.html">Analyse commerciale: comment abandonner Excel sans l'abandonner</a></li>
<li><a href="../fr420965/index.html">Les six rapports les plus utiles avec Frontend Conf 2018</a></li>
<li><a href="../fr420967/index.html">Aider √† nager: comment initier les nouveaux arrivants √† un projet complexe</a></li>
<li><a href="../fr420969/index.html">Le magazine Cosmonautics News cesse d'exister</a></li>
<li><a href="../fr420973/index.html">Configurer UFW sur Ubuntu Server 16.04 avec l'exemple BigBlueButton</a></li>
<li><a href="../fr420975/index.html">Ne le faites pas en production</a></li>
<li><a href="../fr420977/index.html">QComboBox + QTreeView Tricks</a></li>
<li><a href="../fr420979/index.html">Redux Basics (manuel, 2e √©dition)</a></li>
<li><a href="../fr420981/index.html">¬´Je peux vous parler de la douleur commune √† tous les d√©veloppeurs iOS¬ª - 10 questions pour le programmeur, num√©ro 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>