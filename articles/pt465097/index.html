<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚰 ❓ ⚔️ Implementação de tipos de união em Java 👩🏼‍🏫 🤣 🙄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ao desenvolver código, às vezes é necessário que um objeto contenha valores de um tipo ou valores de outro tipo em algum momento. As linguagens de pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementação de tipos de união em Java</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465097/"> Ao desenvolver código, às vezes é necessário que um objeto contenha valores de um tipo ou valores de outro tipo em algum momento.  As linguagens de programação que suportam o conceito de união permitem, em um determinado momento, salvar o valor atual em uma área de memória. <br><a name="habracut"></a><br>  Por exemplo, em C / C ++, você pode escrever assim. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">union</span></span> value { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f; }; <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> value v; vi = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* vf - undefined behaivor */</span></span></code> </pre> <br>  Além disso, se definirmos o valor para um campo, a leitura do valor de outro campo terá um comportamento indefinido. <br><br>  Para simplificar o trabalho com tipos de união em C ++ 17, a classe std :: variant foi adicionada. <br><br><pre> <code class="cpp hljs"> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::variant&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>&gt; v { <span class="hljs-number"><span class="hljs-number">5</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"int value: "</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::get&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;(v) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>;</code> </pre><br>  A linguagem Java não suporta tipos de união.  Como alternativa, você pode implementar uma classe de dados com dois campos de certos tipos com setters e getters.  Mas eu queria que o valor fosse armazenado em um campo, e não em dois. <br><br>  Como você sabe, o tipo de objeto pode salvar o valor de um tipo e reatribuir os valores de outro tipo.  E isso pode ser usado para implementar uma classe, como a classe std :: variant. <br><br>  Como em Java, você não pode especificar um número variável de tipos em um genérico, para um certo número de tipos, você precisa de uma especialização da classe (Union2, Union3, etc.).  Vamos escrever a classe principal Union e suas operações básicas. <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Union</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Union</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T value)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">Class&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br>  Para criar objetos de classe, usaremos métodos de fábrica.  Dependendo do número de tipos, a especialização específica da classe será retornada. <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;T1, T2&gt; <span class="hljs-function"><span class="hljs-function">Union2&lt;T1, T2&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T1&gt; firstClass, Class&lt;T2&gt; secondClass)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Union2&lt;&gt;(firstClass, secondClass); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;T1, T2, T3&gt; <span class="hljs-function"><span class="hljs-function">Union3&lt;T1, T2, T3&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">of</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T1&gt; firstClass, Class&lt;T2&gt; secondClass, Class&lt;T3&gt; thirdClass)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Union3&lt;&gt;(firstClass, secondClass, thirdClass); }</code> </pre><br>  A especialização concreta da classe union armazenará um certo número de tipos e um campo Object.  Se indicarmos um tipo incorreto, obteremos um erro. <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Union2</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T2</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Union</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Class&lt;T1&gt; firstClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Class&lt;T2&gt; secondClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Object value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Union2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T1&gt; firstClass, Class&lt;T2&gt; secondClass)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstClass = firstClass; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondClass = secondClass; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value.getClass() == firstClass || value.getClass() == secondClass) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnionException(<span class="hljs-string"><span class="hljs-string">"Incorrect type: "</span></span> + value.getClass().getName() + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"Union two types: ["</span></span> + firstClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + secondClass.getName() + <span class="hljs-string"><span class="hljs-string">"]"</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz == firstClass || clazz == secondClass) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (T) value; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnionException(<span class="hljs-string"><span class="hljs-string">"Incorrect type: "</span></span> + value.getClass().getName() + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"Union two types: ["</span></span> + firstClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + secondClass.getName() + <span class="hljs-string"><span class="hljs-string">"]"</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value.getClass() == clazz; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">Class&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (Class&lt;T&gt;) value.getClass(); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Union3</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T2</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T3</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Union</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Class&lt;T1&gt; firstClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Class&lt;T2&gt; secondClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Class&lt;T3&gt; thirdClass; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Object value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Union3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T1&gt; firstClass, Class&lt;T2&gt; secondClass, Class&lt;T3&gt; thirdClass)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstClass = firstClass; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.secondClass = secondClass; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.thirdClass = thirdClass; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value.getClass() == firstClass || value.getClass() == secondClass || value.getClass() == thirdClass) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnionException(<span class="hljs-string"><span class="hljs-string">"Incorrect type: "</span></span> + value.getClass().getName() + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"Union three types: ["</span></span> + firstClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + secondClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + thirdClass.getName() + <span class="hljs-string"><span class="hljs-string">"]"</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (clazz == firstClass || clazz == secondClass || value.getClass() == thirdClass) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (T) value; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnionException(<span class="hljs-string"><span class="hljs-string">"Incorrect type: "</span></span> + value.getClass().getName() + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">"Union three types: ["</span></span> + firstClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + secondClass.getName() + <span class="hljs-string"><span class="hljs-string">", "</span></span> + thirdClass.getName() + <span class="hljs-string"><span class="hljs-string">"]"</span></span>); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;T&gt; clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value.getClass() == clazz; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> &lt;T&gt; <span class="hljs-function"><span class="hljs-function">Class&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getActive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (Class&lt;T&gt;) value.getClass(); } }</code> </pre><br>  Agora vamos ver um exemplo de como usar essa classe.  Como você pode ver, o Union não funciona com especializações específicas, o que simplifica o código. <br><br><pre> <code class="java hljs"> Union triUnion = Union.of(Integer.class, String.class, Float.class); triUnion.set(<span class="hljs-number"><span class="hljs-number">15f</span></span>); assertEquals(triUnion.getActive(), Float.class); assertTrue(triUnion.isActive(Float.class)); triUnion.set(<span class="hljs-string"><span class="hljs-string">"Dot"</span></span>); assertEquals(triUnion.getActive(), String.class); assertTrue(triUnion.isActive(String.class)); triUnion.set(<span class="hljs-number"><span class="hljs-number">10</span></span>); assertEquals(triUnion.getActive(), Integer.class); assertTrue(triUnion.isActive(Integer.class));</code> </pre><br>  Você também pode escrever um visitante simples para verificar o valor atual. <br><br><pre> <code class="java hljs"> Union biUnion = Union.of(Integer.class, String.class); biUnion.set(<span class="hljs-string"><span class="hljs-string">"Line"</span></span>); Union triUnion = Union.of(Integer.class, String.class, Float.class); triUnion.set(<span class="hljs-number"><span class="hljs-number">15f</span></span>); matches(biUnion, Integer.class, i -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"bi-union number: "</span></span> + i), String.class, s -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"bi-union string: "</span></span> + s) ); matches(triUnion, Integer.class, i -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"tri-union int: "</span></span> + i), String.class, s -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"tri-union string: "</span></span> + s), Float.class, f -&gt; System.out.println(<span class="hljs-string"><span class="hljs-string">"tri-union float: "</span></span> + f) );</code> </pre><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;V, T1, T2&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matches</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(V value, Class&lt;T1&gt; firstClazz, Consumer&lt;T1&gt; firstConsumer, Class&lt;T2&gt; secondClazz, Consumer&lt;T2&gt; secondConsumer)</span></span></span><span class="hljs-function"> </span></span>{ Class&lt;?&gt; valueClass = value.getClass(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (firstClazz == valueClass) { firstConsumer.accept((T1) value); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secondClazz == valueClass) { secondConsumer.accept((T2) value); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> &lt;T1, T2, T3&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">matches</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Union value, Class&lt;T1&gt; firstClazz, Purchaser&lt;T1&gt; firstConsumer, Class&lt;T2&gt; secondClazz, Purchaser&lt;T2&gt; secondConsumer, Class&lt;T3&gt; thirdClazz, Purchaser&lt;T3&gt; thirdConsumer)</span></span></span><span class="hljs-function"> </span></span>{ Class&lt;?&gt; valueClass = value.getActive(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (firstClazz == valueClass) { firstConsumer.obtain(value.get(firstClazz)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secondClazz == valueClass) { secondConsumer.obtain(value.get(secondClazz)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (thirdClazz == valueClass) { thirdConsumer.obtain(value.get(thirdClazz)); } }</code> </pre><br>  Resumindo, podemos dizer que na linguagem Java, o suporte para tipos de união pode ser implementado no nível da biblioteca.  Mas como uma desvantagem, para cada número de tipos, você precisa de sua própria especialização de classe union e, além disso, salva todos os tipos. <br><br>  O código fonte completo da classe pode ser visualizado no github: <a href="">code</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465097/">https://habr.com/ru/post/pt465097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465087/index.html">Como a NASA contratou Snoopy e pegou as roupas da Barbie</a></li>
<li><a href="../pt465089/index.html">Como o acaso pode ajudar os matemáticos</a></li>
<li><a href="../pt465091/index.html">Vazamento de dados pessoais de supostos funcionários da Russian Railways</a></li>
<li><a href="../pt465093/index.html">Truques de aprendizado de máquina - Trabalhando com vários modelos no Keras</a></li>
<li><a href="../pt465095/index.html">Education Show: palestras e concursos para iniciantes em profissões digitais</a></li>
<li><a href="../pt465101/index.html">Seu testador perfeito</a></li>
<li><a href="../pt465103/index.html">Como se tornar um advogado cibernético</a></li>
<li><a href="../pt465107/index.html">Engenharia do Caos: a arte da destruição intencional. Parte 2</a></li>
<li><a href="../pt465109/index.html">Lições de casa: kits de ferramentas para crianças da Pebaro</a></li>
<li><a href="../pt465111/index.html">Anonimato completo: protegemos o roteador doméstico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>