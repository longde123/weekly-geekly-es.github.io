<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😈 🧗🏿 💂🏼 Korrekte Farbwiedergabe von Retroconsolen in Emulatoren 👩‍🎓 🧒🏼 📢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fast alle Spiel-Retro-Konsolen erzeugen Farben in einigen der RGB-Codierungsoptionen. 

 Diese Pixelfarben werden jedoch häufig für Bildschirme entwic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Korrekte Farbwiedergabe von Retroconsolen in Emulatoren</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467581/"><img src="https://habrastorage.org/getpro/habr/post_images/a50/ed8/a83/a50ed8a83a28c98d8625247f217ed292.png"><img src="https://habrastorage.org/getpro/habr/post_images/e1c/933/712/e1c933712fe6735b68512ecf77081982.png"><br><br>  Fast alle Spiel-Retro-Konsolen erzeugen Farben in einigen der RGB-Codierungsoptionen. <br><br>  Diese Pixelfarben werden jedoch häufig für Bildschirme entwickelt, die sich grundlegend von denen unterscheiden, auf denen Emulatoren normalerweise arbeiten.  In diesem Artikel werde ich über die Bedeutung der Farbemulation sprechen und einige Codebeispiele und Screenshots geben. <br><br>  Die heute am häufigsten verwendeten Arten von Displays sind LCD-Panels.  Sie sind dafür bekannt, sehr schlechte Schwarzwerte zu haben.  Die Unterschiede zwischen TN, PVA und IPS wirken sich nicht allzu stark darauf aus. <br><br>  Einige Fans spielen auf CRT-Monitoren, und OLED-Bildschirme werden immer beliebter, insbesondere auf Telefonen und Tablets.  In diesem Artikel werden jedoch hauptsächlich LCD-Bildschirme betrachtet, obwohl diese Technik für Displays jeglicher Art wichtig ist. <br><br><h3>  Farbgenauigkeit </h3><br>  Das erste wichtige Detail: Die meisten Computer arbeiten im 24-Bit-Farbmodus und bieten 8-Bit-Farbdetails für die Kanäle Rot, Grün und Blau.  In den meisten älteren Spielesystemen werden die Farben jedoch nicht so präzise eingestellt. <br><br>  Zum Beispiel codiert Sega Genesis 9-Bit-Farben, was 3 Bit pro Kanal ergibt. <br><br>  Die naivste Lösung wäre, 3 Bits in die höchsten 3 Bits der Ausgabe zu setzen und die unteren 5 Bits leer zu lassen, aber die weiße Farbe wird ein wenig grau. <br><a name="habracut"></a><br>  Ein Beispiel: <br><br><pre>  000 000 000 -&gt; 000'00000 000'00000 000'00000
 111 111 111 -&gt; 111'00000 111'00000 111'00000 </pre><br><img src="https://habrastorage.org/webt/5n/9t/nz/5n9tnzpukvkthsfmonioxjbdgpo.png"><br><br>  Wenn Sie sie mit Einheiten füllen, wird Schwarz zu hell. <br><br>  Ein Beispiel: <br><br><pre>  000 000 000 -&gt; 000'11111 000'11111 000'11111
 111 111 111 -&gt; 111'11111 111'11111 111'11111 </pre><br><img src="https://habrastorage.org/webt/5i/wi/a-/5iwia-xuz4urlefzodwa7ynboc8.png"><br><br>  Die Lösung besteht darin, die ursprünglichen Bits so zu wiederholen, dass sie alle Ausgangsbits füllen. <br><br>  Ein Beispiel: <br><br><pre>  000 -&gt; 000 000 00 ...
 010 -&gt; 010 010 01 ...
 011 -&gt; 011 011 01 ...
 111 -&gt; 111 111 11 ... </pre><br>  In Form von Code: <br><br><pre>  uint8 rot = r &lt;&lt; 5 |  r &lt;&lt; 2 |  r &gt;&gt; 1
 // rrr00000 |  000rrr00 |  000000rr -&gt; rrrrrrrr </pre><br><h3>  Bildschirmemulation </h3><br>  Spiel-Retro-Systeme wurden nicht für moderne LCD-Computermonitore entwickelt.  In der Regel wurden Heimkonsolen für CRT-Bildschirme entwickelt, und tragbare Konsolen verwendeten viel ältere und weniger genaue LCD-Panels. <br><br>  In diesem Artikel werden Bildschirmartefakte wie Bildschirmkrümmung, Scanlinien, chromatische Aberration, Interframe-Überblendung, Aperturgitter usw. nicht berücksichtigt. Im Moment konzentrieren wir uns nur auf die Farben einzelner Pixel. <br><br><h3>  PC-Monitore </h3><br>  Monitore haben eine ziemlich große Auswahl an Farben, da nur einige von ihnen professionell nach Standards wie SRGB kalibriert sind. Im Allgemeinen können wir jedoch versuchen, Farben so zu emulieren, als ob wir einen korrekt kalibrierten SRGB-Monitor verwenden. <br><br><h3>  CRT-Emulation: Super Nintendo </h3><br>  Der Hauptunterschied zwischen CRT-Bildschirmen und LCD-Monitoren von Computern besteht in den deutlich reduzierten Schwarzwerten, die durch die Gammakorrekturkurve nur geringfügig kompensiert werden können: <br><br><pre>  // SNES-Farben sind im RGB555-Format, daher gibt es 32 Pegel für jeden Kanal
 statische Konstante 8 gammaRamp [32] = {
   0x00,0x01,0x03,0x06,0x0a 0x0f 0x15,0x1c
   0x24, 0x2d, 0x37, 0x42, 0x4e, 0x5b, 0x69, 0x78,
   0x88,0x90,0x98,0xa0,0xa8,0xb0,0xb8,0xc0
   0xc8,0xd0,0xd8,0xe0,0xe8,0xf0,0xf8,0xff
 }; </pre><br>  Diese Tabelle wurde von Overload of Super Sleuth / Kindred ausgeliehen.  Es verdeckt die untere Hälfte der Farbpalette und lässt den oberen Teil unverändert. <br><br>  Dies hat einen erstaunlichen Effekt auf das Bild während der Emulation: Das Original wird links angezeigt, das Bild mit der Gammakorrektur rechts: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe8/0f2/ebb/fe80f2ebb4748595bee64fb8b7c1c3e1.png"><img src="https://habrastorage.org/getpro/habr/post_images/224/ce9/07d/224ce907d78c7dc7f2d0dc309950ecd1.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a50/ed8/a83/a50ed8a83a28c98d8625247f217ed292.png"><img src="https://habrastorage.org/getpro/habr/post_images/e1c/933/712/e1c933712fe6735b68512ecf77081982.png"><br><br><h3>  LCD-Emulation: Game Boy Advance </h3><br>  Game Boy Advance hatte einen der schlechtesten LCD-Bildschirme mit vollständig verblassten Farben.  Die schlauen Entwickler erkannten, dass man durch deutliches Übertreiben der Farben auf realen Geräten angenehmere Ergebnisse erzielen kann. <br><br>  Wenn Sie diese Farben auf einem Standard-LCD-Monitor verwenden, ist das Ergebnis natürlich ein bunter Albtraum.  Glücklicherweise können wir dies kompensieren, indem wir ziemlich natürliche Farben erzeugen: <br><br><pre>  doppeltes lcdGamma = 4,0, outGamma = 2,2;
 doppeltes lb = pow (B / 31,0, lcdGamma);
 doppeltes lg = pow (G / 31,0, lcdGamma);
 doppeltes lr = pow (R / 31,0, lcdGamma);
 r = pow ((0 * lb + 50 * log + 255 * lr) / 255, 1 / outGamma) * (0xffff * 255/280);
 g = pow ((30 · lb + 230 · lg + 10 · lr) / 255, 1 / outGamma) * (0 · ffff · 255/280);
 b = pow ((220 * lb + 10 * log + 50 * lr) / 255, 1 / outGamma) * (0xffff * 255/280); </pre><br>  Dieser Code wurde von Talarubi geschrieben. <br><br>  Ein viel auffälligerer Kontrast im Vergleich zu einer CRT - die Oberseite ist das Original, die Unterseite ist die Version mit Farbkorrektur: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a63/6e8/f86/a636e8f865a184f2e7fc3cf8c2fc78c7.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ac7/ebb/795/ac7ebb795888106b5fb6025b1dc98db5.png"><br><br><h3>  LCD-Emulation: Game Boy Color </h3><br>  Der Game Boy-Farbbildschirm war überraschend besser in der Farbwiedergabe, und im endgültigen Bild ist möglicherweise nur eine leichte Farbunschärfe vorhanden. <br><br>  Der folgende Algorithmus ist in Game Boy Color-Emulatoren sehr beliebt: <br><br><pre>  R = (r * 26 + g * 4 + b * 2);
 G = (g · 24 + b · 8);
 B = (r · 6 + g · 4 + b · 22);
 R = min (960, R) &gt;&gt; 2;
 G = min (960, G) &gt;&gt; 2;
 B = min (960, B) &gt;&gt; 2; </pre><br>  Leider weiß ich nicht, wer den Algorithmus geschrieben hat.  Wenn Sie es wissen, lassen Sie es mich wissen, damit ich die Urheberschaft angeben kann! <br><br>  Nach wie vor das Original links, die Version mit Farbkorrektur - rechts: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ab/f8b/5dc/9abf8b5dceab6103fed68d73ab410aa6.png"><img src="https://habrastorage.org/getpro/habr/post_images/8a9/4ca/896/8a94ca896d3a10ea1b700e29033104a1.png"><br><br>  Dieses Beispiel wurde speziell ausgewählt: Obwohl das Original lebendiger und vorzuziehen ist, können Sie bei genauem Hinsehen das Schachmuster um die Figur herum erkennen, das heller als der Hintergrund ist. <br><br>  Höchstwahrscheinlich war es ein Versehen seitens der Entwickler, denn im realen Spiel <br>  Boy Color-Weißtöne verschwimmen und zwei verschiedene Farbtöne verschmelzen nahezu fehlerfrei miteinander. <br><br><h3>  Abschließend </h3><br>  Es gibt viel mehr Systeme, denen noch gute Farbemulationsfilter fehlen. <br>  Sie sind sehr schwer zu konfigurieren.  Zu den wichtigsten Beispielen gehören WonderSwan und Neo Geo Pocket, die zum Zeitpunkt dieses Schreibens keine guten Filter zur Approximation von Farben hatten. <br><br>  Tragbare Konsolen sind immer noch komplizierter, da ihnen häufig die Hintergrundbeleuchtung (und manchmal auch die Frontbeleuchtung!) Fehlen. Es gibt Möglichkeiten, den Kontrast zu ändern, sodass für einen bestimmten RGB-Wert kein echter Farbwert vorhanden ist. <br><br>  Ein besonders interessanter Grenzfall ist WonderSwan Color, das über ein Software-Set-Flag verfügt, um den Kontrast des angezeigten Bildes zu erhöhen. <br>  Wir wissen noch nicht, wie wir ein solches Verhalten zuverlässig nachahmen können, und es ist unklar, ob wir es überhaupt schaffen können. <br><br>  Die Farbemulation ist ein Bereich, der mehr Aufmerksamkeit erfordert. Wenn Sie also Spezialist für Mathematik und Farbanalyse sind, ist Ihre Hilfe für die Emulationsszene sehr nützlich! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467581/">https://habr.com/ru/post/de467581/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467563/index.html">Ein Tag von der PVS-Studio-Benutzerunterstützung</a></li>
<li><a href="../de467567/index.html">Unterstützung für 24-Bit-Farben im Terminal in einer Reihe von ssh + tmux + neovim</a></li>
<li><a href="../de467573/index.html">Top 8 nützliche Analytics-Filter</a></li>
<li><a href="../de467575/index.html">Eine Möglichkeit, das Workload-Profil abzurufen und den Verlauf in PostgreSQL zu warten</a></li>
<li><a href="../de467577/index.html">Mono-Test: Das beste Playme P600SG-Combo-Gerät</a></li>
<li><a href="../de467583/index.html">LMTOOLS Lizenzmanager. Auflisten von Lizenzen für Autodesk-Produktbenutzer</a></li>
<li><a href="../de467587/index.html">Alle nützlichen Wi-Fi-Inhalte an einem Ort</a></li>
<li><a href="../de467589/index.html">Was Sie über die DSGVO im Jahr 2019 wissen müssen</a></li>
<li><a href="../de467591/index.html">Der neue Beweis löst die Approximation von Zahlen wie pi</a></li>
<li><a href="../de467593/index.html">(Nicht relevant, repariert) Hinweis. Wie Tele2 den Zugriff auf das persönliche Konto neuer Abonnenten teilt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>