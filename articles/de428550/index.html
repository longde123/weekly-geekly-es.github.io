<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöñ üåÉ üë©‚Äçüë©‚Äçüëß‚Äçüëß Ein Wechselrichter mit reinem Sinus in 15 Minuten oder "Leistungselektronik - f√ºr alle" üë©üèª‚Äçüíª üé® üñ•Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Was ist Leistungselektronik? Ohne Zweifel - das ist die ganze Welt! Modern und voller Komfort. Viele Menschen stellen sich Leistungselektronik als etw...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ein Wechselrichter mit reinem Sinus in 15 Minuten oder "Leistungselektronik - f√ºr alle"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428550/">  Was ist Leistungselektronik?  Ohne Zweifel - das ist die ganze Welt!  Modern und voller Komfort.  Viele Menschen stellen sich Leistungselektronik als etwas ‚ÄûMagisches‚Äú und Fernes vor, aber schauen Sie sich um - fast alles, was uns umgibt, enth√§lt einen Stromrichter: ein Laptop-Netzteil, eine LED-Lampe, eine USV, verschiedene Regler, Spannungsstabilisatoren und Frequenzmesser (IF) ) in der L√ºftung oder im Aufzug und vieles mehr.  Die meisten dieser Ger√§te machen unser Leben komfortabel und sicher. <br><br>  Aus mehreren Gr√ºnden ist die Entwicklung der Leistungselektronik einer der schwierigsten Bereiche der Elektronik - der Fehlerpreis ist sehr hoch, w√§hrend die Entwicklung von Stromrichtern immer Liebhaber, Heimwerker und nicht nur angezogen hat.  Sicherlich wollten Sie ein leistungsstarkes Netzteil f√ºr Ihr Projekt bauen?  Oder vielleicht Online-USV f√ºr ein paar kW und nicht pleite gehen?  Oder vielleicht ein Chastotnik in der Werkstatt? <br><br>  Heute werde ich √ºber mein kleines offenes Projekt oder vielmehr √ºber seinen Teil sprechen, der es jedem erm√∂glicht, in die Welt der Leistungselektronikentwicklung einzusteigen und gleichzeitig am Leben zu bleiben.  Als Demonstration der M√∂glichkeiten werde ich zeigen, wie ein Spannungsinverter von 12 V DC auf 230 V AC mit einem Sinusausgang in 15 Minuten zusammengebaut wird.  Fasziniert?  Lass uns gehen! <br><br><img src="https://habrastorage.org/webt/na/rx/gk/narxgkn5e_6tiuqmfysesuukoug.jpeg"><br><a name="habracut"></a><br><br><h2>  Projektgr√ºnde </h2><br>  In den letzten Jahren machte die Entwicklung von Stromrichtern etwa 90% meiner Bestellungen aus. Die Hauptarbeitskosten entfallen haupts√§chlich auf die Softwareentwicklung und das Prototyping. Das Schaltungsdesign und die R√ºckverfolgung der Gesamtplatine der Gesamtkosten betragen normalerweise nicht mehr als 10-15%.  Hier kommt das Verst√§ndnis, dass der Prototyping-Prozess, der die Softwareentwicklung umfasst, irgendwie reduziert und optimiert werden muss. <br><br>  Wie immer gibt es mindestens zwei Auswege: Kaufen Sie fertiges Debugging, beispielsweise bei Texas Instrumets oder Infineon. Sie sind jedoch in der Regel auf eine bestimmte Aufgabe zugeschnitten und kosten zwischen 500 und 5.000 US-Dollar. Es gibt jedoch keine Garantie daf√ºr, dass es einen √§hnlichen Auftrag gibt, und diese Investition mit hoher Wahrscheinlichkeit ist einfach wird sich nicht auszahlen. <br>  Die zweite M√∂glichkeit besteht darin, es selbst zu tun, aber es ist fast dasselbe wie das Starten von "+1 Revision von Eisen", was zu zus√§tzlichen Kosten f√ºr den Kunden f√ºhrt.  Wenn dies nicht gr√ºndlich durchgef√ºhrt wird, ist wie √ºblich alles auf Rotz und irgendwo f√§llt etwas ab und bis zum Layout, den Komponenten und dem Timing. <br>  Nach einiger Zeit machte ich auf die naheliegendste L√∂sung aufmerksam.  Es ist so einfach und offensichtlich, dass ich mich lange gefragt habe, warum derselbe TI oder Infineon dies noch nicht getan hat.  Jetzt werde ich √ºber meine "Erleuchtung" erz√§hlen. <br><br>  Schauen wir uns einige der beliebtesten Stromrichtertopologien an: <br><br><img src="https://habrastorage.org/webt/d8/_c/0v/d8_c0v8ih8ydkihocalqkrqc2xw.png"><br><img src="https://habrastorage.org/webt/gt/hy/fn/gthyfnx_nnsjohhak7ls4xjszny.png"><br><img src="https://habrastorage.org/webt/bk/ag/qq/bkagqqyzbrqjntnfuxsrrvuxpyy.png"><br><img src="https://habrastorage.org/webt/0y/w0/xp/0yw0xpwofk5jjf47usbdrwglyfy.png"><br><img src="https://habrastorage.org/webt/-c/mz/z_/-cmzz_9skvlq8ux30pjluy0zkvi.png"><br><br>  Schauen Sie jetzt noch einmal genau hin.  Ich habe speziell ohne Umreifung gemalt, nur die Schl√ºsselkomponenten, um es klarer zu machen.  Was haben diese Topologien gemeinsam?  Das erste, was auff√§llt, ist eine Reihe gemeinsamer Punkte: <br><ul><li>  Alle Topologien umfassen die Hauptkomponenten - Kondensatoren, Transistoren und Induktivit√§t (Induktor oder Transformator).  Dies sind 3 Wale der Leistungselektronik; </li><li>  Transistoren werden √ºberall gleich eingeschaltet und bilden die sogenannte "Halbbr√ºcke".  Fast alle Konvertertopologien werden daraus erstellt. </li><li>  Die Option zum Einschalten des Halbbr√ºcken + Kondensatorkopplers √§ndert sich nicht bei allen Topologien.  Die Art der Induktivit√§t und die M√∂glichkeiten zum Einschalten von Halbbr√ºcken √§ndern sich. </li></ul><br><br>  Daraus k√∂nnen wir schlie√üen, dass Sie mit einem bestimmten Standardmodul in Form einer Halbbr√ºcke + Kondensator jeden Konverter bauen k√∂nnen, indem Sie nur den erforderlichen Induktor oder Transformator hinzuf√ºgen.  Die naheliegende L√∂sung zur Vereinfachung des Prototyping war daher die Erstellung eines solchen Moduls: <br><img src="https://habrastorage.org/webt/vx/d6/ec/vxd6ec8swnwqef7v6uhkljsysek.png"><br><br><h2>  Der Kampf zwischen Gut und B√∂se </h2><br>  Leider bestimmen eine begrenzte Anzahl von Stunden pro Tag und banale Faulheit ihre Bedingungen.  Ich bin vor einem Jahr auf die Notwendigkeit gekommen, dieses Modul zu entwickeln, aber die Implementierung wurde st√§ndig unter dem Motto <i>"Ich werde es definitiv n√§chstes Wochenende tun!"</i> √úbertragen.  . <br><br>  Vielleicht w√§re die Idee im Regal geblieben, wenn nicht zwei Veranstaltungen stattgefunden h√§tten.  Erstens kamen innerhalb eines Monats zwei Kunden zu mir, und alle wollten einen Konverter, der komplex und interessant zu implementieren war, und vor allem waren sie bereit, sehr gut zu zahlen.  Obwohl er aus Europa stammt, hat es sich f√ºr sie vielleicht als billig herausgestellt.)) Beide Projekte waren f√ºr mich interessant, zum Beispiel war eines davon ein ‚Äûdreiphasiger Spannungsregler mit galvanischer Trennung (sic!)‚Äú, Das hei√üt ein dreiphasiger PFC + 3 Br√ºckenwandler (phasenverschoben) + Synchrongleichrichter + 3-Phasen-Wechselrichter.  All dies auf SiC und sehr kompakt.  Im Allgemeinen nahm ich 2 Gro√üauftr√§ge auf, von denen jeder ~ 800 Mannstunden und einen Zeitraum von 6 Monaten hatte.  Infolgedessen war ich ‚Äûgezwungen‚Äú, nach Optimierungsm√∂glichkeiten zu suchen. <br><br>  Zweitens haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mir</a> Leute von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PCBway-</a> Firma unerwartet geschrieben, viele haben wahrscheinlich Boards bei ihnen bestellt und angeboten, zusammenzuarbeiten.  Sie unterst√ºtzen sehr aktiv Open-Hardware-Projekte, dh die Initiative von CERN - Open Source Hardware.  Die Zusammenarbeit ist f√ºr beide Seiten einfach und verst√§ndlich - sie stellen mir kostenlose Geb√ºhren f√ºr meine Projekte zur Verf√ºgung, und ich √∂ffne sie und stelle sie auf Anfrage an anderen Stellen auf ihre Website.  F√ºr mich wurde es eine zus√§tzliche Motivation, und vor allem ist mein Gewissen klar, weil  Ich bestelle seit mehreren Jahren Boards f√ºr Prototypen und f√ºr die Massenproduktion erz√§hle ich Freunden und Partnern davon.  Jetzt habe ich auch ein Br√∂tchen in Form von kostenlosen Boards f√ºr kleine Projekte, die man oft auf dem Hub schreiben kann. <br><br>  Und dann brach das Eis, es wurde beschlossen, nicht nur das zuvor beschriebene Modul, sondern eine ganze Reihe von Entwicklern der Leistungselektronik zu erstellen und es f√ºr alle offen und zug√§nglich zu machen. <br><br><h2>  Projektstruktur </h2><br>  Am Anfang des Artikels habe ich erw√§hnt, dass ich Ihnen heute nur einen Teil erz√§hlen werde - dies <b>ist das Halbbr√ºcken-Leistungsmodul</b> .  Sie k√∂nnen damit allein einen Konverter erstellen, indem Sie einfach einen Steuerkreis einschrauben, z. B. STM32-Discovery, Arduino, TMS320, TL494 oder was auch immer Sie dort besitzen.  Es gibt √ºberhaupt keine Bindung an eine Plattform oder MK. <br><br>  Nur ist dies nicht das ganze Projekt, sondern ein Teil)) Woraus besteht der fertige Stromrichter?  Zuallererst ben√∂tigt das Netzteil ein bestimmtes Steuermodul, um zu verstehen, was passiert, Sie ben√∂tigen eine Anzeige und um zu verstehen, was aus sicherer Entfernung passiert, ben√∂tigen Sie auch eine Schnittstelle, zum Beispiel Modbus RTU oder CAN. <br><br>  Infolgedessen sieht die allgemeine Struktur des Projekts folgenderma√üen aus: <br><br> <a href=""><img src="https://habrastorage.org/webt/oh/tj/ix/ohtjixc8dimubg0tr7mbjym_aqc.png"></a> <br><br>  Wahrscheinlich werde ich in Zukunft auch ein Programm zur Berechnung von konventionellen und planaren Transformatoren und Drosseln schreiben.  So weit so.  Die verschiedenen Teile des Diagramms in Entwurfsform wurden bereits implementiert und in zwei Projekten ausgef√ºhrt. Nach geringf√ºgigen Verbesserungen werden auch Artikel dar√ºber geschrieben und der Quellcode wird verf√ºgbar sein. <br><br><h2>  Halbbr√ºcken-Leistungsmodul </h2><br>  Jetzt ist es Zeit, sich den heutigen Helden genauer anzusehen.  Das Modul ist universell und erm√∂glicht die Arbeit mit Mosfet- und IGBT-Transistoren, sowohl Niederspannungs- als auch Hochspannungsschaltern bis zu 1200 V. <br><br>  <u>Modulfunktionen:</u> <br><ul><li>  Galvanische Trennung der Steuerseite (digital) der Stromversorgung.  Durchschlagspannung der Isolierung 3 kV; </li><li>  Die oberen und unteren Tasten sind unabh√§ngig voneinander. Jeder hat seinen eigenen galvanisch getrennten Treiber und einen galvanisch getrennten Gleichstrom / Gleichstrom. </li><li>  Der moderne Treiber von Infineon - 1EDC60I12AHXUMA1 wird angewendet.  Der Impuls√∂ffnungs- / Schlie√üstrom betr√§gt 6A / 10A.  Maximale Frequenz - 1 MHz (bis 1,5 MHz stabil getestet); </li><li>  Hardware-Stromschutz: Shunt + Operationsverst√§rker + Komparator + Optokoppler; </li><li>  Der maximale Strom betr√§gt 20A.  Es ist nicht durch Schl√ºssel begrenzt, sondern durch die Gr√∂√üe des K√ºhlers und die Dicke der Kupferpolygone. </li></ul><br><br>  Die erste Revision des Moduls erscheint im Artikel, es ist voll funktionsf√§hig, aber es wird eine zweite Revision geben, bei der rein konstruktive Fehler beseitigt und die Steckverbinder durch bequemere ersetzt werden.  Nachdem er die Dokumentation ausgef√ºllt hatte, warf er den Gerber in PCBway und nach 6 Tagen klopfte der Kurier an meine T√ºr und gab mir einen solchen Zauber: <br><br> <a href=""><img src="https://habrastorage.org/webt/bj/dw/lt/bjdwlt-ijg3_gdxfx0wfkwggk18.jpeg"></a> <br><br>  Eine Woche sp√§ter brachten die <s>Hunde</s> endlich Komponenten aus einem sch√∂nen Haushaltsgesch√§ft.  Als Ergebnis wurde alles montiert: <br><br> <a href=""><img src="https://habrastorage.org/webt/kw/mv/cg/kwmvcghxvdiimkk9ili2zqfnorg.jpeg"></a> <br><br> <a href=""><img src="https://habrastorage.org/webt/ea/dg/cz/eadgczqqlkscl5n89r7ynnvyivm.jpeg"></a> <br><br>  Bevor wir fortfahren, schauen wir uns den Schaltplan des Moduls an.  Sie k√∂nnen es hier herunterladen - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> . <br><br>  Es gibt nichts Kompliziertes oder Magisches.  Die √ºbliche Halbbr√ºcke: 2 Schl√ºssel unten, 2 oben, Sie k√∂nnen jeweils einen l√∂ten.  Der Fahrer, wie oben aus der 1ED-Familie geschrieben, ist sehr b√∂se und unsterblich.  √úberall an der Stromversorgung gibt es eine Anzeige, einschlie√ülich +12 V am DC / DC-Ausgang.  Das UND-Logikelement ist gesch√ºtzt. Wenn der Strom √ºberschritten wird, gibt der Komparator +3,3 V aus, beleuchtet den Optokoppler und zieht einen der UND-Eing√§nge auf Masse, was bedeutet, dass die Einrichtung von log.0 und das PWM-Signal von den Treibern verschwinden.  UND mit 3 Eing√§ngen wurde speziell verwendet, in der n√§chsten Revision plane ich, Schutz vor √úberhitzung durch den K√ºhler zu schaffen und das Fehlersignal auch dort zu starten.  Alle Quellen finden Sie am Ende des Artikels. <br><br><h2>  Wir bauen das Wechselrichter-Layout zusammen </h2><br>  Ich habe lange dar√ºber nachgedacht, wie man die Funktionsweise des Moduls demonstriert, damit es nicht sehr langweilig, n√ºtzlich und nicht sehr schwierig wird, sodass jeder es wiederholen kann.  Deshalb habe ich an einem Spannungswechselrichter angehalten. Sie werden verwendet, um mit Sonnenkollektoren zu arbeiten. Wenn etwas auf der Niederspannungsseite riecht, ist es nicht be√§ngstigend, aber auf der Hochspannungsseite, wenn Sie es einschalten, legen Sie Ihre H√§nde nicht hinein. <br><br>  Der Wechselrichter selbst ist sch√§ndlich einfach, √ºbrigens ist MAP Energy einfach so genietet, hier ein Beispiel f√ºr die kommerzielle Umsetzung dieser Idee.  Die Aufgabe des Wechselrichters besteht darin, aus einer 12-V-Gleichspannung eine sinusf√∂rmige Variable mit einer Frequenz von 50 Hz zu bilden, da damit ein herk√∂mmlicher Transformator mit 50 Hz an die Arbeit gew√∂hnt ist.  Ich benutze eine Art Sowjet, wie OSM, 220V Fabrikwicklung und wird als sekund√§re verwendet, und die prim√§re ~ 8V wird mit einem Kupferbus gewickelt.  Es sieht so aus: <br><br> <a href=""><img src="https://habrastorage.org/webt/xf/6c/js/xf6cjsweiig-ter1invjtnfslci.jpeg"></a> <br><br>  Und dieses Monster ist nur 400 Watt!  Das Gewicht des Transformators betr√§gt nach den Empfindungen etwa 5 bis 7 kg. Wenn Sie ihn auf Ihr Bein fallen lassen, werden sie definitiv nicht in die Armee aufgenommen.  Tats√§chlich ist dies das Minus von Wechselrichtern mit "Eisen" -Transformatoren, sie sind riesig und schwer.  Ihr Plus ist, dass diese Wechselrichter sooooooo einfach sind, keine Erfahrung erfordern und nat√ºrlich billig sind. <br><br>  Verbinden wir nun die Module und den Transformator.  Tats√§chlich sollte das Modul f√ºr den Entwickler einfach als ‚ÄûBlack Box‚Äú dargestellt werden, die einen Eingang von 2 PWMs und 3 Leistungsausg√§ngen hat: VCC, GND und den Halbbr√ºckenausgang selbst. <br><br><img src="https://habrastorage.org/webt/yt/4f/l5/yt4fl55ueuuzkxi2ytlanqt_z58.png"><br><br>  Ziehen wir nun aus diesen "Black Boxes" unseren Wechselrichter: <br><br><img src="https://habrastorage.org/webt/ht/ar/pu/htarpuz2ma1w3bduxmbpculsxia.png"><br><br>  Ja, es wurden nur 3 externe Elemente ben√∂tigt: ein Transformator + LC-Filter.  F√ºr letzteres habe ich einfach eine Drossel hergestellt, indem ich den Draht vom Modul zum Transformator auf einen Ring aus Kool Mu-Material der Gr√∂√üe R32 mit einer Permeabilit√§t von 60 und einer Induktivit√§t von etwa 10 ŒºH gewickelt habe.  Nat√ºrlich sollte die Drossel berechnet werden, aber wir brauchen 15 Minuten.)) Wenn Sie so etwas mit 400 W fahren, ben√∂tigen Sie im Allgemeinen einen Ring der Gr√∂√üe R46 (dies ist der Au√üendurchmesser).  Kapazit√§t - 1-10 uF Film, das ist genug.  Tats√§chlich k√∂nnen Sie den Kondensator nicht als Wirtschaftlichkeit einstellen, da die Wicklungskapazit√§t des Transformators fehlerfrei ist. Im Allgemeinen haben die Chinesen und MAP genau das getan.)) Der Induktor sieht folgenderma√üen aus: <br><br><img src="https://habrastorage.org/webt/b0/wl/zy/b0wlzyrj0gxbmarg2rz5kuppdoc.jpeg"><br><br>  Es bleibt eine Testlast auf den Ausgang zu werfen, ich habe ein paar 20 W LED-Lampen (nichts anderes war direkt zur Hand), sie selbst essen 24 W, aber die Effizienz.  Der Leerlaufstrom des Transformators betr√§gt ebenfalls etwa 1A.  Mit Batterie werden ca. 5A gegessen.  Als Ergebnis haben wir einen solchen Stand: <br><br> <a href=""><img src="https://habrastorage.org/webt/3s/w2/q2/3sw2q2qvocpryrps6vj4ynvwavo.jpeg"></a> <br><br>  Das Layout verwendet auch die Delta HR12-17-Batterie bei 12 V und einer Kapazit√§t von 17 A * h.  Wir werden den Konverter von der STM32F469-Discovery-Debug-Karte aus steuern. <br><br><h2>  Code </h2><br>  Urspr√ºnglich war geplant, meine STM32VL-Disco, die 2010 auf der Ausstellung eingegangen war, zur Kontrolle zu verwenden. In diesem Layout war es jedoch so, dass sie sterben musste, als der gesamte Code geschrieben und das Layout gestartet wurde.  Ich habe die Oszilloskopsonden vergessen und 2 Erden kombiniert, Amen.  Infolgedessen wurde alles auf STM32F469NIH6 neu geschrieben. Es war dieses Debugging, das zur Hand war, sodass es zwei Projekte geben wird: F√ºr den F100 und f√ºr den F469 werden beide √ºberpr√ºft.  Das Projekt wurde f√ºr TrueSTUDIO erstellt, die Eclipse-Version von ST. <br><br><div class="spoiler">  <b class="spoiler_title">Fu√ütuch-Code</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"main.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/********************************************* Sinus table **********************************************************/</span></span></span><span class="hljs-meta"> uint16_t sinData[240] = {0,13,26,39,52,65,78,91,104,117,130,143,156,169,182,195,207,220,233,246,258,271,284,296,309,321,333,346,358,370, 382,394,406,418,430,442,453,465,477,488,500,511,522,533,544,555,566,577,587,598,608,619,629,639,649,659,669,678,688,697, 707,716,725,734,743,751,760,768,777,785,793,801,809,816,824,831,838,845,852,859,866,872,878,884,891,896,902,908,913,918, 923,928,933,938,942,946,951,955,958,962,965,969,972,975,978,980,983,985,987,989,991,993,994,995,996,997,998,999,999,999, 999,999,999,998,997,996,995,994,993,991,989,987,985,983,980,978,975,972,969,965,962,958,955,951,946,942,938,933,928,923, 918,913,908,902,896,891,884,878,872,866,859,852,845,838,831,824,816,809,801,793,785,777,768,760,751,743,734,725,716,707, 697,688,678,669,659,649,639,629,619,608,598,587,577,566,555,544,533,522,511,500,488,477,465,453,442,430,418,406,394,382, 370,358,346,333,321,309,296,284,271,258,246,233,220,207,195,182,169,156,143,130,117,104,91,78,65,52,39,26,13,0}; uint16_t sinStep; uint8_t sinStatus; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/******************************************** Used functions ********************************************************/</span></span></span><span class="hljs-meta"> void StartInitClock (void) { RCC-&gt;CR |= RCC_CR_HSEON; </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// Enable HSE while (!(RCC-&gt;CR &amp; RCC_CR_HSERDY)); FLASH-&gt;ACR |= FLASH_ACR_LATENCY_5WS; RCC-&gt;PLLCFGR = 0x00; RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLM_3; // Div for HSE = 8 RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLN_4 | RCC_PLLCFGR_PLLN_5 | RCC_PLLCFGR_PLLN_6 | RCC_PLLCFGR_PLLN_7; // PLL mult x240 RCC-&gt;PLLCFGR |= RCC_PLLCFGR_PLLSRC; // Source HSE RCC-&gt;CR |= RCC_CR_PLLON; while((RCC-&gt;CR &amp; RCC_CR_PLLRDY) == 0){} RCC-&gt;CFGR &amp;= ~RCC_CFGR_SW; RCC-&gt;CFGR |= RCC_CFGR_SW_PLL; // Select source SYSCLK = PLL while((RCC-&gt;CFGR &amp; RCC_CFGR_SWS) != RCC_CFGR_SWS_1) {} // Wait till PLL is used RCC-&gt;CR |= RCC_CR_PLLSAION; while ((RCC-&gt;CR &amp; RCC_CR_PLLSAIRDY) == 0) {} } void EnableOutputMCO (void) { RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOAEN; // Enable clock port A GPIOA-&gt;MODER &amp;= ~GPIO_MODER_MODER8; GPIOA-&gt;MODER |= GPIO_MODER_MODER8_1; // Alternative PP GPIOA-&gt;OSPEEDR |= GPIO_OSPEEDER_OSPEEDR8; // Very high speed RCC-&gt;CFGR |= RCC_CFGR_MCO1; // Source PLL RCC-&gt;CFGR &amp;= ~RCC_CFGR_MCO1PRE; // Div = 1 } void InitIndicatorLED (void) { /* * LED1 - PG6 * LED2 - PD4 * LED3 - PD5 * LED4 - PK3 */ RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOGEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIODEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOKEN; GPIOG-&gt;MODER &amp;= ~GPIO_MODER_MODER6; GPIOG-&gt;MODER |= GPIO_MODER_MODER6_0; // Output PP GPIOD-&gt;MODER &amp;= ~GPIO_MODER_MODER4; GPIOD-&gt;MODER |= GPIO_MODER_MODER4_0; // Output PP GPIOD-&gt;MODER &amp;= ~GPIO_MODER_MODER5; GPIOD-&gt;MODER |= GPIO_MODER_MODER5_0; // Output PP GPIOK-&gt;MODER &amp;= ~GPIO_MODER_MODER3; GPIOK-&gt;MODER |= GPIO_MODER_MODER3_0; // Output PP } void EnableIndicatorLED (void) { GPIOG-&gt;BSRR |= GPIO_BSRR_BR_6; GPIOD-&gt;BSRR |= GPIO_BSRR_BR_4; GPIOD-&gt;BSRR |= GPIO_BSRR_BR_5; GPIOK-&gt;BSRR |= GPIO_BSRR_BR_3; } void InitLowPWM (void) { /* * TIM1-CH1 - PA8 * TIM1-CH1N - PB13 */ RCC-&gt;APB2ENR |= RCC_APB2ENR_TIM1EN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOAEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOBEN; /*********** GPIO **********/ GPIOA-&gt;MODER &amp;= ~GPIO_MODER_MODER8; GPIOA-&gt;MODER |= GPIO_MODER_MODER8_1; // Alternative output PP GPIOA-&gt;AFR[1] |= GPIO_AFRH_AFRH0_0; // Select TIM1-CH1 GPIOB-&gt;MODER &amp;= ~GPIO_MODER_MODER13; GPIOB-&gt;MODER |= GPIO_MODER_MODER13_1; // Alternative output PP GPIOB-&gt;AFR[1] |= GPIO_AFRH_AFRH5_0; // Select TIM1-CH1N /*********** Timer *********/ TIM1-&gt;PSC = 2400-1; // div for clock: F = SYSCLK / [PSC + 1] TIM1-&gt;ARR = 1000; // count to 1000 TIM1-&gt;CR1 &amp;= ~TIM_CR1_CKD; // div for dead-time: Tdts = 1/Fosc = 41.6 ns TIM1-&gt;CCR1 = 500; // duty cycle 50% TIM1-&gt;CCER |= TIM_CCER_CC1E | TIM_CCER_CC1NE; // enable PWM complementary out to PB15 and to PA10 TIM1-&gt;CCER &amp;= ~TIM_CCER_CC1NP; // active high level: 0 - high, 1 - low TIM1-&gt;CCMR1 &amp;= ~TIM_CCMR1_OC1M; TIM1-&gt;CCMR1 |= TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1; // positiv PWM1_CH3 and PWM1_CH3N TIM1-&gt;BDTR &amp;= ~TIM_BDTR_DTG; // clear register TIM1-&gt;BDTR |= TIM_BDTR_DTG_2 | TIM_BDTR_DTG_1 | TIM_BDTR_DTG_0; // value dead-time: = 31*Tdts = 32*41,6ns = 1.29us TIM1-&gt;BDTR |= TIM_BDTR_MOE | TIM_BDTR_AOE; // enable generation output and dead-time TIM1-&gt;CR1 &amp;= ~TIM_CR1_DIR; // count up: 0 - up, 1 - down TIM1-&gt;CR1 &amp;= ~TIM_CR1_CMS; // aligned on the front signal: 00 - front; 01, 10, 11 - center TIM1-&gt;CR1 |= TIM_CR1_CEN; // start count } void InitSinusPWM (void) { /* * TIM3-CH1 - PB4 * TIM3-CH2 - PC7 */ RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM3EN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOBEN; RCC-&gt;AHB1ENR |= RCC_AHB1ENR_GPIOCEN; /*********** GPIO **********/ GPIOB-&gt;MODER &amp;= ~GPIO_MODER_MODER4; GPIOB-&gt;MODER |= GPIO_MODER_MODER4_1; // Alternative output PP GPIOB-&gt;AFR[0] |= GPIO_AFRL_AFRL4_1; // Select TIM3-CH1 GPIOC-&gt;MODER &amp;= ~GPIO_MODER_MODER7; GPIOC-&gt;MODER |= GPIO_MODER_MODER7_1; // Alternative output PP GPIOC-&gt;AFR[0] |= GPIO_AFRL_AFRL7_1; // Select TIM3-CH2 /*********** Timer *********/ TIM3-&gt;PSC = 5-1; // div for clock: F = SYSCLK / [PSC + 1] TIM3-&gt;ARR = 1000; // count to 1000 TIM3-&gt;CCR1 = 0; // duty cycle 0% TIM3-&gt;CCR2 = 0; // duty cycle 0% TIM3-&gt;CCER |= TIM_CCER_CC1E; // enable PWM out to PA8 TIM3-&gt;CCER &amp;= ~TIM_CCER_CC1P; // active high level: 0 - high, 1 - low TIM3-&gt;CCER |= TIM_CCER_CC2E; // enable PWM complementary out to PA9 TIM3-&gt;CCER &amp;= ~TIM_CCER_CC1P; // active high level: 0 - high, 1 - low TIM3-&gt;CCMR1 &amp;= ~(TIM_CCMR1_OC1M | TIM_CCMR1_OC2M); TIM3-&gt;CCMR1 |= TIM_CCMR1_OC1M_2 | TIM_CCMR1_OC1M_1 | TIM_CCMR1_OC2M_2 | TIM_CCMR1_OC2M_1; // positiv PWM1_CH1 and PWM1_CH2 TIM3-&gt;CR1 &amp;= ~TIM_CR1_DIR; // count up: 0 - up, 1 - down TIM3-&gt;CR1 &amp;= ~TIM_CR1_CMS; // aligned on the front signal: 00 - front; 01, 10, 11 - center TIM3-&gt;CR1 |= TIM_CR1_CEN; // start count } void InitStepSinus (void) { RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM6EN; // enable clock for basic TIM6 TIM6-&gt;PSC = 5-1; // div, frequency 24 kHz TIM6-&gt;ARR = 1000; // count to 1000 TIM6-&gt;DIER |= TIM_DIER_UIE; // enable interrupt for timer TIM6-&gt;CR1 |= TIM_CR1_CEN; // start count NVIC_EnableIRQ(TIM6_DAC_IRQn); // enable interrupt TIM6_DAC_IRQn } /************************************* Main code *********************************************/ int main (void) { StartInitClock(); // EnableOutputMCO(); InitIndicatorLED(); InitLowPWM(); InitSinusPWM(); InitStepSinus(); EnableIndicatorLED(); while(1) { } } /****************************** Interrupts ******************************************************/ void TIM6_DAC_IRQHandler (void) { TIM6-&gt;SR &amp;= ~TIM_SR_UIF; if (sinStatus == 0) {TIM3-&gt;CCR1 = sinData[sinStep];} if (sinStatus == 1) {TIM3-&gt;CCR2 = sinData[sinStep];} sinStep++; if (sinStep &gt;= 240) { sinStep = 0; sinStatus = sinStatus ? 0 : 1; } }</span></span></span></span></code> </pre> <br></div></div><br>  Im Allgemeinen beschrieb er in einem anderen Artikel ausf√ºhrlich und klar, wie man ein sinusf√∂rmiges Signal erzeugt, wie man Code schreibt und so weiter.  Sie k√∂nnen es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> lesen. <br><br>  Hast du gelesen  Willst du sammeln?  Behalte das Projekt: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt f√ºr F469</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Projekt f√ºr F100</a> </li></ul><br>  Wir f√ºhren den Code aus, bewaffnen uns mit einem Oszilloskop und gehen weiter.  Zun√§chst √ºberpr√ºfen wir das Vorhandensein eines Signals am Eingang der Treiber. Es sollte folgenderma√üen aussehen: <br><br><img src="https://habrastorage.org/webt/nd/gc/5f/ndgc5fcjhtwnxk_oxdwnanbwtkq.png"><br><br>  Es ist erw√§hnenswert, dass ich 2 Signale gebe, die einen Sinus auf einer Halbbr√ºcke (Modul) und 50 Hz auf 2 Signalen zeichnen.  Dar√ºber hinaus ist eine Diagonale "rot + gelb" und die andere "blau + gr√ºn".  In dem Artikel, den ich oben gegeben habe, wird dies ausf√ºhrlich geschrieben, wenn Sie es pl√∂tzlich nicht mehr verstehen.  Jetzt, als die Signale kamen, schalteten wir sowohl Halbbr√ºcke + 12V als auch GND von der Labornetzversorgung ein.  Sofort r√§t der Akku nicht, wenn Sie irgendwo einen Fehler machen, kann etwas durchbrennen.  Der Schutz auf der Platine sch√ºtzt vor √úberstrom, aber nicht vor offensichtlichen Pfosten, wenn Plus und Minus verwechselt werden, aber der Labortechniker spart.  12V und 1A reichen f√ºr Tests aus.  Wir nehmen die Sonde des Oszilloskops, ihren Erdungsdraht zum Ausgang der ersten Halbbr√ºcke und die Sonde selbst zum Ausgang der anderen Halbbr√ºcke, und es sollte ein solches Bild geben: <br><br><img src="https://habrastorage.org/webt/px/6j/fk/px6jfknnkrrf4y_l09t-_h9csfk.png"><br><br>  Wo ist der Sinus, den du fragst?  Tatsache ist, dass der Eingangswiderstand des Oszilloskops gro√ü ist und keine Last darstellt, sodass der Strom nicht flie√üt und es keinen Ort gibt, an dem der Sinus gewonnen werden kann.  F√ºgen Sie eine Last hinzu, ich habe eine 90-Ohm-Last aus 10-Ohm-Widerst√§nden hergestellt, indem ich einfach 9 Teile in Reihe geschaltet habe.  Wir schlie√üen die Last an die Ausg√§nge der Halbbr√ºcken an und sehen das folgende Bild: <br><br><img src="https://habrastorage.org/webt/a1/ro/7b/a1ro7ba6mmxhagnpiyau1mjstqo.png"><br><br>  Hast du das gleiche  Es ist also Zeit, Induktor, Transformator und Last anzuschlie√üen und zu starten.  <b>Achtung!</b>  <b>Sie k√∂nnen dieses Modell nicht ohne Last einschalten, da der Ausgang im Leerlauf bis zu 350 ... 380 V betragen kann.</b>  <b>Damit dies keine Last oder Betriebssystem ben√∂tigt.</b>  Wir werden nicht den letzten haben, dies ist das Thema eines separaten Artikels, Sie k√∂nnen als Wahlfach den einfachsten P-Controller befestigen, Sie haben bereits eine Projektvorlage. <br><br><h2>  Einbeziehung </h2><br>  Nach dem Einschalten erhalten wir ungef√§hr 230 V am Ausgang, der Ausgang ist sicherlich nicht stabilisiert und wird 230 V + -30 V schweben. F√ºr Tests wird es gehen. In einem anderen Artikel werden wir das Layout fertigstellen, wenn ich mich entscheide, √ºber P- und PI-Regler und deren Implementierung zu sprechen. <br><br>  Jetzt k√∂nnen Sie das Ergebnis der Arbeit genie√üen und bei Bedarf alles in eine Schachtel packen und sogar auf dem Bauernhof oder auf dem Land anwenden, um sich mit Licht und anderen Annehmlichkeiten zu versorgen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Te0OhTMt0Tk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Sie haben wahrscheinlich eine Verz√∂gerung zwischen dem ‚ÄûKlicken‚Äú bemerkt, dh dem Einschalten des Discovery und dem Einschalten der Lampen - dies ist die Zeit, die der MK f√ºr die Initialisierung aufgewendet hat.  Diese Verz√∂gerung kann verringert werden, indem eine einzelne Ziffer gleichzeitig in das Register geschrieben wird, anstatt den Registereintrag in mehrere Zeilen aufzuteilen.  Ich habe es nur zur Veranschaulichung zerquetscht.  Obwohl dies nicht be√§ngstigend ist, ist die Verz√∂gerung mit dem HAL-Code dreimal l√§nger und die Leute leben irgendwie damit)) <br><br>  Bis ich verga√ü, die Quelle des Projekts: <br><br><ul><li>  Schematische Darstellung - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PDF</a> </li><li>  St√ºckliste - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Excel</a> </li><li>  Gerber-Dateien - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RAR</a> </li></ul><br><br>  Es bleibt abzuwarten, wie es mit den Temperaturen auf dem Brett ist, wenn es besonders hei√üe Stellen gibt.  5-6A ist sicherlich nicht genug, aber wenn es einen Durchgangsstrom oder einen schwerwiegenden Fehler gibt, reicht dies aus, um das Board in einen Wasserkocher zu verwandeln: <br><br><img src="https://habrastorage.org/webt/xz/fp/ln/xzfplnlxfklygc-vjabjtpws1em.png"><br><br>  Wie Sie sehen k√∂nnen, ist das hei√üeste Element das DC / DC-Modul f√ºr die galvanische Trennung, das 2 Watt betr√§gt, es erw√§rmt sich auf 34 Grad, also auch ein Shunt.  Die Transistoren und der K√ºhler selbst haben nach 30 Minuten Betrieb des Wandlers eine Umgebungstemperatur. <br><br><h2>  Danke und Pl√§ne </h2><br>  In naher Zukunft habe ich vor, √ºber das DSP-Board zu schreiben und es nicht √ºber die Debugging-Erkennung, sondern √ºber das "spezialisierte" Modul zu verwalten.  Boards der 2. Revision kamen von derselben PCBway zu ihm, ich warte auf die Komponenten und schreibe sofort. <br><br>  Ich hoffe, Ihnen hat der Artikel und die Idee selbst gefallen.  In Zukunft werde ich auf denselben Modulen zeigen, wie man einen Chastotnik, einen MPPT-Controller oder vielleicht etwas anderes Interessantes zusammenbaut.  Wenn Sie Fragen haben, z√∂gern Sie nicht, diese in den Kommentaren oder in der PM zu stellen. Wenn Sie pl√∂tzlich keinen vollst√§ndigen Account mehr haben, werde ich versuchen, alle Fragen zu beantworten. <br><br>  Nun ein paar dank <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PCBway</a> , es ist eigentlich sehr gut, dass sie die Open Source Engine unterst√ºtzen.  Bald k√∂nnten die Hardware-Hersteller sogar Software-Autoren hinsichtlich der Anzahl und Qualit√§t von Open-Source-Projekten einholen. <br><br><img src="https://habrastorage.org/webt/hm/pu/px/hmpupxkj9ov6-oum1vvnqmi0oqu.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428550/">https://habr.com/ru/post/de428550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428540/index.html">Klinische Studien haben gezeigt, dass das Fortschreiten der Alzheimer-Krankheit um mehr als die H√§lfte abnimmt</a></li>
<li><a href="../de428542/index.html">Touristen in der Europ√§ischen Union werden mit AI √ºberpr√ºft</a></li>
<li><a href="../de428544/index.html">Die Sicherheitsanf√§lligkeit in Bluetooth er√∂ffnet M√∂glichkeiten f√ºr Angriffe auf drahtlose Zugangspunkte</a></li>
<li><a href="../de428546/index.html">Drei Jahre Technik. Support, 152 Gesundheitseinrichtungen, 3740 Stk</a></li>
<li><a href="../de428548/index.html">Aspektorientierte Programmierung, Spring AOP</a></li>
<li><a href="../de428552/index.html">Algorithmus: So finden Sie die n√§chste lexikografische Permutation</a></li>
<li><a href="../de428556/index.html">‚ÄûDie Produktionsumgebung liegt au√üerhalb Ihrer Kontrolle‚Äú: Rian Lewis beim Testen von Blockchain-Projekten</a></li>
<li><a href="../de428558/index.html">Wie ich aus meiner tiefen Faulheit einen Assistenten f√ºr WordPress erstellt habe</a></li>
<li><a href="../de428560/index.html">Au√üerplanm√§√üige Ank√ºndigung am Freitag</a></li>
<li><a href="../de428562/index.html">Droidcon London. Wie war es</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>