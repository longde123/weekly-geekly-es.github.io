<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍🤝‍👨🏿 👨🏻‍🔬 📳 Docker-Container zur Verwaltung von HP Servern über ILO 🌦️ 💝 🙏🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sie fragen sich vielleicht - warum ist Docker hier? Was ist das Problem, wenn Sie zur ILO-Weboberfläche gehen und Ihren Server so einrichten, wie er s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Docker-Container zur Verwaltung von HP Servern über ILO</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449080/">  Sie fragen sich vielleicht - warum ist Docker hier?  Was ist das Problem, wenn Sie zur ILO-Weboberfläche gehen und Ihren Server so einrichten, wie er sollte? <br><br>  Also dachte ich, als sie mir ein paar alte unnötige Server gaben, die ich neu installieren musste (was als Reprovision bezeichnet wird).  Der Server selbst befindet sich auf der anderen Seite des Ozeans. Das einzige, was verfügbar ist, ist das Webinterface.  Nun, dementsprechend musste ich in die virtuelle Konsole gehen, um einige Befehle auszuführen.  Hier hat es angefangen. <br><br>  Wie Sie wissen, wird für verschiedene Arten von virtuellen Konsolen normalerweise Java verwendet, und zwar bei HP und bei Dell.  In jedem Fall war es früher so genau (und die Systeme sind sehr alt).  Firefox und Chrome unterstützen diese Applets jedoch seit langem nicht mehr, und das neue IcedTea funktioniert mit diesen Systemen nicht.  Daher wurden mehrere Optionen identifiziert: <br><a name="habracut"></a><br><ol><li>  Um einen Zoo aus Browsern und Java-Versionen auf Ihrem Computer zu erstellen, wurde diese Option sofort ausgeblendet.  Es besteht keine Lust, das System für ein paar Teams zu verspotten. </li><li> Führen Sie etwas ziemlich Altes auf der virtuellen Maschine aus (es wurde experimentell herausgefunden, dass Java 6 benötigt wird) und konfigurieren Sie alles, was Sie benötigen. </li><li>  Das Gleiche wie Punkt 2, nur im Container, da mehrere Kollegen auf dasselbe Problem gestoßen sind und es viel einfacher ist, ihnen einen Link zum Container auf Dockerhub zu übergeben, als ein Image einer virtuellen Maschine mit allen Passwörtern usw. </li></ol><br>  (Eigentlich habe ich Punkt 3 erst erreicht, nachdem ich Punkt 2 gemacht habe) <br><br>  Punkt 3 werden wir heute tun. <br><br>  Ich wurde hauptsächlich von zwei Projekten inspiriert: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Basisbild-GUI</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Firefox-Java</a> </li></ol><br>  Im Prinzip enthält das erste <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Baseimage-GUI-</a> Projekt bereits Dienstprogramme und Konfigurationen zum Starten von Desktop-Anwendungen in Docker.  Normalerweise müssen Sie Standardvariablen definieren, und auf Ihre Anwendung kann über einen Browser (Websocket) oder VNC zugegriffen werden.  In unserem Fall werden wir Firefox und VNC durchlaufen, über den Websocket hat es nicht funktioniert. <br><br>  Installieren Sie zunächst die erforderlichen Pakete - Java 6 und IcedTea: <br><br><pre><code class="plaintext hljs">RUN echo "deb http://archive.ubuntu.com/ubuntu precise main universe" &gt; /etc/apt/sources.list &amp;&amp; \ apt-get update &amp;&amp; \ apt-get -y upgrade &amp;&amp; \ apt-get -y install firefox \ nano curl \ icedtea-6-plugin \ icedtea-netx \ openjdk-6-jre \ openjdk-6-jre-headless \ tzdata-java</code> </pre> <br>  Jetzt müssen Sie nur noch zur ILO-Schnittstellenseite gehen und Ihren Benutzernamen und Ihr Passwort eingeben.  Wir starten Firefox im Autostart: <br><br><pre> <code class="plaintext hljs">RUN bash -c 'echo "exec openbox-session &amp;" &gt;&gt; ~/.xinitrc' &amp;&amp; \ bash -c 'echo "firefox \${HILO_HOST}"&gt;&gt; ~/.xinitrc' &amp;&amp; \ bash -c 'chmod 755 ~/.xinitrc'</code> </pre> <br>  Die Umgebungsvariable HILO_HOST enthält die Webadresse unserer ILO-Schnittstelle, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">myhp.example.com</a> . <br><br>  Um die Eingabe zu automatisieren, schrauben wir die Autorisierung.  Die Anmeldung bei ILO erfolgt durch eine reguläre POST-Anforderung, wodurch Sie einen JSON-Sitzungsschlüssel erhalten, den Sie dann in einer GET-Anforderung übergeben. <br><br>  Berechnen Sie session_key via curl, wenn die Umgebungsvariablen HILO_USER und HILO_PASS definiert sind: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> HOME=/config <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> HILO_HOST=<span class="hljs-variable"><span class="hljs-variable">${HILO_HOST%%/}</span></span> SESSION_KEY=<span class="hljs-string"><span class="hljs-string">""</span></span> data=<span class="hljs-string"><span class="hljs-string">"{\"method\":\"login\",\"user_login\":\"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HILO_USER}</span></span></span><span class="hljs-string">\",\"password\":\"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HILO_PASS}</span></span></span><span class="hljs-string">\"}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [[ -n <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HILO_USER}</span></span></span><span class="hljs-string">"</span></span> &amp;&amp; -n <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HILO_PASS}</span></span></span><span class="hljs-string">"</span></span> ]]; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> SESSION_KEY=$(curl -k -X POST <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${HILO_HOST}</span></span></span><span class="hljs-string">/json/login_session"</span></span> -d <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$data</span></span></span><span class="hljs-string">"</span></span> 2&gt;/dev/null | grep -Eo <span class="hljs-string"><span class="hljs-string">'"session_key":"[^"]+'</span></span> | sed <span class="hljs-string"><span class="hljs-string">'s/"session_key":"//'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"SESSION_KEY=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$SESSION_KEY</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$SESSION_KEY</span></span> &gt; /session_key</code> </pre><br>  Nachdem wir session_key im Docker aufgezeichnet haben, können wir VNC starten: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> x11vnc -forever -create</code> </pre><br>  Stellen Sie jetzt einfach über VNC eine Verbindung zu Port 5900 (oder einem anderen Ihrer Wahl) auf localhost her und rufen Sie die virtuelle Konsole auf. <br><br>  Der gesamte Code befindet sich im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker-Ilo-Client-</a> Repository. <br><br>  Vollständiger Befehl zum Herstellen einer Verbindung zur IAO: <br><br><pre> <code class="plaintext hljs">docker run -d --rm --name ilo-client -p 5900:5900 -e HILO_HOST=https://ADDRESS_OF_YOUR_HOST -e HILO_USER=SOME_USERNAME -e HILO_PASS=SOME_PASSWORD sshnaidm/docker-ilo-client</code> </pre> <br>  Dabei ist ADDRESS_OF_YOUR_HOST der ILO-Hostname, SOME_USERNAME der Benutzername und SOME_PASSWORD das ILO-Kennwort. <br><br>  Starten Sie danach einfach einen beliebigen VNC-Client unter der Adresse: <code>vnc://localhost:5900</code> <br>  Ergänzungen und Pull-Anfragen sind natürlich willkommen. <br><br>  Ein ähnliches Projekt existiert für die Verbindung mit IDRAC-Schnittstellen von DELL-Maschinen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">docker-idrac6</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de449080/">https://habr.com/ru/post/de449080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de449070/index.html">Superman gegen Programmierer</a></li>
<li><a href="../de449072/index.html">Unterwasser-GPS auf einem Unterwasserroboter: Erfahrung</a></li>
<li><a href="../de449074/index.html">Timothy Subbotin: „Die Franzosen haben das Geld gezählt und festgestellt: Es ist besser, einmal in OSM zu investieren, als jeden Monat jemanden zu bezahlen.“</a></li>
<li><a href="../de449076/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 456 (04/09/2019 - 04/04/2019)</a></li>
<li><a href="../de449078/index.html">10 Möglichkeiten, wie Sie beim Austausch von Kryptowährungen getäuscht werden können</a></li>
<li><a href="../de449082/index.html">Qualität liegt in der Verantwortung des Teams. Unsere QS-Erfahrung</a></li>
<li><a href="../de449086/index.html">In der Flamme: Eine neue Methode zur Untersuchung von reaktiven Hochtemperatursystemen</a></li>
<li><a href="../de449088/index.html">Es ist Zeit für Investoren und Unternehmer, das Problem der psychischen Gesundheit in Startups zu lösen.</a></li>
<li><a href="../de449090/index.html">Ändern Sie das JSON-Schema in Go with gob dynamisch</a></li>
<li><a href="../de449092/index.html">Drei Paradigmen der asynchronen Programmierung in Vertx</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>