<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎅🏿 🔆 🍜 Plugin Rainbow CSV comme alternative à Excel 🤑 🏂🏾 👨‍🏭</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Cet article concerne le plugin Rainbow CSV que j'ai écrit pour 5 éditeurs de texte: 


 VS Code , Vim , Sublime Text 3 , Atom , Gedit 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Plugin Rainbow CSV comme alternative à Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429548/"><p>  Bonjour, Habr!  Cet article concerne le plugin Rainbow CSV que j'ai écrit pour 5 éditeurs de texte: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VS Code</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vim</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sublime Text 3</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Atom</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gedit</a> </p><br><p>  Je pense que de nombreux lecteurs de cet article rencontrent périodiquement des fichiers CSV (séparés par des virgules), TSV (séparés par des tabulations) et similaires.  Si vous essayez de les ouvrir dans un éditeur de texte (mais comment savoir ce qu'il y a d'autre à l'intérieur?), Une image complètement simple s'ouvrira comme sur le côté gauche de l'image.  En le regardant, il est difficile de dire combien de colonnes se trouvent dans le tableau.  Sur le côté droit de l'image se trouve le même fichier avec RainbowCSV activé, la lisibilité est considérablement améliorée en raison de la coloration syntaxique. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c66/3f3/956/c663f3956de322003c5b926fd21693a6.png" alt="image"></p><a name="habracut"></a><br><p>  Curieusement, la syntaxe de cette mise en évidence est définie à l'aide d'une seule ligne d'expression régulière (quoique longue): </p><br><pre><code class="hljs powershell">((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?</code> </pre> <br><p>  La règle de surbrillance peut être trouvée entièrement, par exemple, <a href="">ici</a> (version pour VS Code), mais, à part l'expression régulière elle-même, il n'y a absolument rien à regarder. </p><br><p>  Par comparaison, les fichiers de syntaxe sont destinés aux langages à usage général tels que Python, JS, C ++, etc.  Reprennent généralement plusieurs centaines de lignes d'un code très ésotérique. </p><br><p>  Afin de ne pas charger l'article en détail, de deviner de quelles parties de base il s'agit et comment fonctionne cette expression régulière est offerte aux lecteurs. </p><br><p>  Astuce: Voici une expression simple <code>([^,]*,)?([^,]*,)?</code>  - Mettez en surbrillance le fichier CSV en 2 couleurs alternées différentes, mais ne fonctionnera pas correctement sur les virgules à l'intérieur des champs échappés par des guillemets. </p><br><p>  Soit dit en passant, ci-après la version Rainbow CSV pour Visual Studio Code est décrite, car  Il s'agit de la version du plugin qui est actuellement la plus avancée et la plus populaire sur le plan technique (plus de 500 000 téléchargements). </p><br><p>  Ainsi, outre le fait que Rainbow CSV met en évidence les colonnes, il peut également: </p><br><ul><li>  Indiquez sur quelle colonne le curseur pointe actuellement: numéro de colonne + nom de la première ligne de titre.  S'il n'y a pas de ligne d'en-tête au début du fichier (les données disparaissent immédiatement), l'utilisateur peut définir son en-tête "virtuel". </li><li>  Vérifiez automatiquement le fichier pour un nombre différent d'entrées par ligne ou pour une utilisation incorrecte des caractères d'échappement - "CSV Lint". </li><li>  Exécutez une requête de type SQL à l'aide de l'interpréteur RBQL intégré, qui vous permet d'appliquer une classe très large de transformations de texte à la table d'entrée. <br>  RBQL prend en charge presque toutes les instructions SQL (SELECT, UPDATE, WHERE, ORDER BY, TOP / LIMIT, JOIN, GROUP BY) ainsi que toutes les fonctions et instructions standard de JavaScript et Python. <br>  RBQL est une technologie distincte, mais elle correspond très bien au concept de Rainbow CSV, et donc cette intégration offre de nombreux avantages. </li></ul><br><p>  L'une des caractéristiques les plus importantes des plugins Rainbow CSV est la détection automatique des fichiers CSV par leur contenu.  Cette fonctionnalité est essentielle car  Les fichiers CSV (ou TSV) ont souvent une extension de fichier autre que .csv (.tsv).  Vous pouvez également trouver des fichiers avec l'extension .csv dans lesquels un point-virgule est réellement utilisé comme séparateur <code>;</code>  .  L'algorithme de détermination d'un fichier de table par contenu est très simple - il suffit de vérifier que le nombre de cellules de chaque ligne lorsque split'e pour ce séparateur est constant&gt; 1. </p><br><h3 id="sravnenie-rainbow-csv-s-graficheskim-vyravnivaniem">  Comparaison de Rainbow CSV avec l'alignement graphique </h3><br><p>  En général, la manière traditionnelle d'afficher les données CSV consiste à les importer dans un éditeur graphique tel qu'Excel. <br>  Par rapport à cette méthode, Rainbow CSV présente à la fois des avantages et des inconvénients: </p><br><h4 id="preimuschestva">  Avantages: </h4><br><ul><li>  Ce que vous voyez est ce que vous obtenez - vous pouvez être sûr que ce qui est visible à l'écran est le contenu réel du fichier. </li><li>  Environnement familier de votre éditeur de texte préféré </li><li>  Abstraction à coût nul: la mise en évidence de la syntaxe est très «bon marché» d'un point de vue informatique par rapport à l'alignement graphique. </li><li>  Densité d'information plus élevée: plus de données tiennent sur un seul écran - l'alignement graphique «consomme» beaucoup d'espace en raison des espaces d'alignement. </li><li>  La possibilité de lier visuellement une colonne (mise en évidence dans la même couleur) à partir de différentes fenêtres </li></ul><br><h4 id="nedostatki">  Inconvénients: </h4><br><ul><li>  L'implémentation standard utilise 10 couleurs différentes. Ainsi, lorsque le nombre de colonnes est supérieur à 10, les couleurs commencent à se répéter et l'efficacité du codage couleur des colonnes diminue. </li><li>  Il n'y a pas de prise en charge pour encapsuler des lignes dans des cellules échappées par des guillemets doubles.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ici,</a> vous pouvez lire les détails de ce problème.  Cependant, je crois que le CSV avec coupure de ligne à l'intérieur des cellules est un format extrêmement peu pratique. </li></ul><br><h3 id="sravnenie-s-tekstovym-vyravnivaniem">  Comparaison avec l'alignement du texte </h3><br><p>  Une autre façon d'augmenter la lisibilité des fichiers CSV est de les aligner avec des espaces, mais cette méthode modifie le contenu du fichier, et donc son applicabilité est très limitée. </p><br><p>  De plus, à mon avis, la lisibilité d'un fichier après la mise en évidence syntaxique Rainbow est meilleure que celle d'un fichier qui a été aligné avec des espaces. </p><br><h2 id="nemnogo-o-proekte">  Un peu sur le projet </h2><br><p>  La première version de Rainbow CSV a été écrite il y a 5 ans pour Vim basée sur le plugin <a href="">rainbow_parentheses</a> . Comme vous pouvez le voir, de ce projet, j'ai emprunté non seulement une partie du code, mais aussi la moitié du nom =) <br>  Les versions pour VSCode, Atom et Sublime Text 3 sont apparues il y a un an. </p><br><p>  De nombreuses fonctionnalités et améliorations critiques ont été proposées par les utilisateurs du plugin. </p><br><h2 id="sravnenie-processa-razrabotki-plagina-dlya-raznyh-redaktorov">  Comparaison du processus de développement de plug-in pour différents éditeurs </h2><br><p>  En conclusion, je peux faire une petite comparaison des API des éditeurs de texte populaires. <br>  Les API des plugins pour VSCode, Atom et Sublime Text 3 sont assez similaires, la principale différence est que les extensions pour VS Code et Atom sont écrites en JavaScript et pour Sublime Text 3 en Python. </p><br><p>  Les 3 éditeurs utilisent le même moteur d'expression régulière pour la coloration syntaxique, donc déplacer le Rainbow CSV entre ces éditeurs ne nécessitait qu'une adaptation minimale des habitués. </p><br><p>  En général, je peux dire que le processus de développement de plug-in le plus agréable et le plus pratique est fourni par VS Code.  D'un autre côté, c'est pour une raison quelconque qu'il manquait initialement certaines des fonctionnalités nécessaires au fonctionnement complet de Rainbow CSV, mais l'équipe VS Code a volontiers accepté et amélioré mon RP, ce qui a ajouté la méthode dont j'avais besoin. </p><br><p>  L'écriture de plugins pour Vim est très différente de ces 3 nouveaux éditeurs.  Vim utilise son propre langage VimScript, ainsi qu'une variété de commandes pour manipuler le contenu des fichiers ouverts.  Le modèle de syntaxe que Vim utilise pour la mise en évidence est également très différent de ce que VSCode, Atom et Sublime fournissent. </p><br><h3 id="ssylki">  Références: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rainbow CSV dans VS Code</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rainbow CSV à Vim</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rainbow CSV dans Sublime Text 3</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rainbow CSV dans Atom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rainbow CSV à Gedit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rbql.org</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr429548/">https://habr.com/ru/post/fr429548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr429536/index.html">PHP Digest n ° 143 (du 1er au 12 novembre 2018)</a></li>
<li><a href="../fr429540/index.html">Nous restaurons la géométrie détaillée des objets pour une validation plus précise de l'assortiment</a></li>
<li><a href="../fr429542/index.html">Des messages privés de 81 000 comptes Facebook mis en vente</a></li>
<li><a href="../fr429544/index.html">Grande conférence NIXMultiConf (Kharkov)</a></li>
<li><a href="../fr429546/index.html">«Les cours se sont déroulés non seulement dans un souci de connaissances, beaucoup avaient des ambitions de carrière et des tâches de développement professionnel»</a></li>
<li><a href="../fr429550/index.html">Histoire de 33 extensions pour VS Code, de leur développement et comment les gérer</a></li>
<li><a href="../fr429552/index.html">Guide JavaScript, partie 1: premier programme, fonctionnalités linguistiques, normes</a></li>
<li><a href="../fr429554/index.html">Coûts Tesla</a></li>
<li><a href="../fr429556/index.html">Guide JavaScript Partie 2: Style de code et structure du programme</a></li>
<li><a href="../fr429560/index.html">SamsPcbGuide: Sortie de la première version du livre</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>