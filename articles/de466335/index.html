<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåï ü§üüèæ üèÇüèΩ Erstellen einer Slack-Anwendung mit 8base-Funktionen üë©üèª‚Äç‚öñÔ∏è ‚ôâÔ∏è ‚¨ÜÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Slack ist eine gro√üartige Anwendung f√ºr die interne Kommunikation zwischen Teams. Eine der Funktionen, die wir einfach erweitern k√∂nnen, indem wir Cha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen einer Slack-Anwendung mit 8base-Funktionen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466335/"><img src="https://habrastorage.org/getpro/habr/post_images/ee8/574/873/ee8574873908032aed87f5703682d618.png" alt="Bild"><br><br>  Slack ist eine gro√üartige Anwendung f√ºr die interne Kommunikation zwischen Teams.  Eine der Funktionen, die wir einfach erweitern k√∂nnen, indem wir Chat-Bots und Slash-Chat-Befehle erstellen und integrieren, mit denen Benutzer mit externen Diensten interagieren k√∂nnen.  Ein ausgezeichneter Slack-Bot, sehr beliebt und n√ºtzlich, ist der GitHub-Bot, der Updates zu Pull-Anfragen, Commits und ish auf dem Kanal ver√∂ffentlicht. <br><br>  In diesem Artikel erstellen wir einen Slack-Bot, der Aktualisierungen ver√∂ffentlicht, wenn eine Bestellung auf der von uns verwalteten erfundenen E-Commerce-Plattform erstellt wird. <br><br>  Die E-Commerce-Plattform ist eine serverlose Anwendung, die mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">8base erstellt wurde</a> .  In diesem Artikel verwenden wir 8base-Funktionen, um mithilfe von Triggern auf Create-Ereignisse in einem Datenmodell zu warten. <br><br>  Ein Trigger ist eine Art von Funktion, die als Reaktion auf ein Datenmutationsereignis ausgel√∂st wird: <i>Erstellen</i> , <i>Aktualisieren</i> oder L√∂schen eines Objekts.  8base bietet zwei Arten von Triggern, je nachdem, ob der Entwickler die Funktion vor oder nach dem √Ñndern der Daten ausf√ºhren m√∂chte: trigger.before und trigger.after. <br><br><h4>  Du wirst brauchen </h4><br><ul><li>  Grundlegendes Verst√§ndnis von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">React</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Node.js.</a>  Bevor Sie beginnen, stellen Sie sicher, dass Node und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">npm</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Garn installiert sind</a> . </li><li>  Wir werden einige GraphQL-Abfragen im Projekt verwenden, daher ist die Vertrautheit mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GraphQL hilfreich</a> . </li><li>  Erstellen Sie ein 8base-Konto (falls Sie dies noch nicht getan haben), indem Sie deren <a href="http://">Website</a> besuchen. </li></ul><br><h3>  8base-Umgebung vorbereiten </h3><br>  Erstellen Sie ein Konto oder melden Sie sich bei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://auth.8base.com/login%3Fstate%3Dg6Fo2SBpTkZiUGl6QXJ5VFVkZS16U09yanNQU3dxNlJlQlV2NqN0aWTZIC04bGxiaENJU05ha0MzVUduT2ZuU19senhlbE5VN1l1o2NpZNkgcUdIWlZ1NUN4WTVrbGl2bTI4T1BMam9wdnNZcDBiYUQ%26client%3DqGHZVu5CxY5klivm28OPLjopvsYp0baD%26protocol%3Doauth2%26response_type%3Dtoken%2520id_token%26redirect_uri%3D">8base an</a> .  F√ºr neue Konten bietet 8base einen kostenlosen 30-Tage-Zugang. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/064/449/5e8/0644495e868a6e3b11bf27df93d61080.png" alt="Bild"><br>  ‚Äç2.  Gehen Sie nach dem Anmelden zur Datenseite und klicken Sie auf "Neue Tabelle", um die Konfiguration des Backends zu starten. <br><img src="https://habrastorage.org/getpro/habr/post_images/011/8e4/ce6/0118e4ce63f1da4bc98b872b1e76a260.png" alt="Bild"><br>  ‚Äç3.  Nach dem Laden einer neuen Tabelle sehen Sie ein Diagramm und k√∂nnen mit der Definition der Felder beginnen.  Erstellen Sie als N√§chstes eine Tabelle mit dem Namen Bestellungen, die aus den folgenden Feldern besteht: <br>  - <b>Benutzer</b> : Feldtyp ist Tabelle.  W√§hlen Sie im rechten Abschnitt die Tabelle Benutzer aus und geben Sie im Feld Name des Beziehungsfelds "Bestellungen" an.  Aktivieren Sie dann das Kontrollk√§stchen "Mehrere <b>Bestellungen</b> pro <b>Benutzer</b> zulassen". <br><img src="https://habrastorage.org/getpro/habr/post_images/64f/24f/8d0/64f24f8d0f5f626c397708980ef822ea.png" alt="Bild"><br>  - Elemente: Feldtyp ist JSON.  Dieses Feld enth√§lt Informationen zu den Produkten, die der Benutzer kauft, z. B. Preis, Name und Bild. <br>  Unser Schema ist recht einfach und sollte die notwendigen Funktionen abdecken.  Als n√§chstes richten wir die Slack App ein und installieren sie. <br><br><h3>  Erstellen Sie eine Slack-Anwendung </h3><br>  Melden Sie sich zun√§chst bei Ihrem Slack an oder erstellen Sie einen neuen f√ºr diesen Leitfaden.  Besuchen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Slack API Console</a> , um eine neue Slack-App zu erstellen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/870/fb8/956/870fb8956f2b3b4dabceadf602df6d0d.png" alt="Bild"><br><br>  Rufen Sie diese Slack-App nach unserer fiktiven E-Commerce-Plattform namens <b>Shop Quick auf</b> . <br><br>  Nachdem wir die Anwendung in unserem Workshop erstellt haben, k√∂nnen wir die Slack-Anwendung vor√ºbergehend verschieben und an der Erstellung der 8base-Funktion arbeiten, die die Ereignisse beim Erstellen neuer Bestellungen auf der <b>Shop Quick-</b> Plattform abh√∂rt. <br><br><h4>  Erstellen Sie eine 8base-Funktion </h4><br>  Die 8base-Plattform bietet Funktionen, die die Erstellung von Anwendungen ohne Server erleichtern.  F√ºr diese Slack-Anwendung ben√∂tigen wir benutzerdefinierte Logik und Integrationen, die nicht nur mit CRUD implementiert werden k√∂nnen.  In unserem Fall m√∂chten wir beim Erstellen einer neuen Bestellung Nachrichten an Slack senden.  Wir k√∂nnen dies erreichen, indem wir die 8base-Funktionen verwenden und die Ereignisse "Erstellen", "Aktualisieren" und "L√∂schen" abh√∂ren. Wir werden Trigger verwenden. <br><br>  Ein Trigger ist eine Funktion, die als Reaktion auf ein Datenmutationsereignis ausgel√∂st wird: wenn ein Objekt erstellt, aktualisiert oder gel√∂scht wird.  Es gibt zwei Arten von Triggern, je nachdem, ob sie vor oder nach Daten√§nderungen ausgef√ºhrt werden: trigger.before und trigger.after. <br><br>  In unserem Fall rufen wir unsere Funktion nach dem Anlegen der Bestellung auf.  Daher m√ºssen wir Orders.create angeben.  M√∂gliche Werte f√ºr das Datenereignis sind Erstellen, Aktualisieren und L√∂schen. <br><br><h4>  8base CLI </h4><br>  Mit CLI 8base k√∂nnen Sie benutzerdefiniertes JavaScript oder TypeScript schreiben, um effektiv Logik hinzuzuf√ºgen, wobei Sie sich nur auf das konzentrieren, was f√ºr Ihre Anwendung einzigartig ist, und gleichzeitig Boilerplate-Code vermeiden. <br><br>  Die 8base Command Line Interface (CLI) erleichtert das Hinzuf√ºgen einer benutzerdefinierten Serverlogik zu Ihren Anwendungen direkt vom Terminal aus.  Installieren Sie die CLI, indem Sie den folgenden Befehl in einem Terminal ausf√ºhren: <br><br><pre><code class="javascript hljs">npm install -g <span class="hljs-number"><span class="hljs-number">8</span></span>base</code> </pre> <br>  Nach der globalen Installation der CLI m√ºssen Sie angemeldet sein, um der CLI Zugriff auf Ihr 8base-Konto zu gew√§hren.  F√ºhren Sie den folgenden Befehl aus, um sich anzumelden: <br>  ‚Äç <br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base login</code> </pre><br>  Wenn Sie diesen Befehl ausf√ºhren, wird ein Browserfenster f√ºr die CLI-Autorisierung angezeigt.  Durch die Anmeldung erh√§lt die CLI Zugriff auf Ihr 8base-Konto.  Sie k√∂nnen andere von der CLI angebotene Befehle finden, indem Sie den Hilfebefehl ausf√ºhren: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base help</code> </pre><br>  Als N√§chstes initialisieren wir das 8base-Projekt mithilfe der CLI, indem wir den folgenden Befehl in Ihrem Terminal ausf√ºhren: <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">8</span></span>base init shop-quick-functions</code> </pre><br>  Nachdem der Befehl ausgef√ºhrt wurde, wird ein neuer Ordner erstellt.  Die Ordnerstruktur sollte folgenderma√üen aussehen: <br><br><pre> <code class="javascript hljs">‚îú‚îÄ‚îÄ src/ | ‚îú‚îÄ‚îÄ function1.ts | ‚îî‚îÄ‚îÄ function2.js ‚îú‚îÄ‚îÄ <span class="hljs-number"><span class="hljs-number">8</span></span>base.yml ‚îî‚îÄ‚îÄ package.json</code> </pre> <br>  Die CLI l√§dt ein regul√§res Knotenprojekt, mit dem Sie Abh√§ngigkeiten mit npm oder Garn installieren k√∂nnen.  Dar√ºber hinaus sind in der 8base-CLI Webpack und TypeScript standardm√§√üig vorkonfiguriert, sodass Sie JavaScript- oder TypeScript-Code schreiben k√∂nnen. <br><br>  Wir haben benutzerdefinierte Funktionen und Berechtigungen in 8base.yml eingerichtet.  Wir √§ndern die aktuelle Einstellung der Datei 8base.yml entsprechend unseren Anforderungen.  √ñffnen Sie die Datei und nehmen Sie die folgenden √Ñnderungen vor: <br><br><pre> <code class="javascript hljs">functions: notifySlack: handler: code: src/notifySlack.js type: trigger.after operation: Orders.create</code> </pre> <br>  Die Dateistruktur √§hnelt jeder YAML-Datei.  Der erste Block, den wir betrachten werden, ist ein Funktionsblock;  Wir werden alle Funktionsdefinitionen, die wir erstellen, in diesen Block einf√ºgen.  Zum Beispiel die von uns erstellte notifySlack-Funktion.  Die Funktion hat folgende Eigenschaften: <br><br><ul><li>  <b>Handler</b> : Relativer Dateipfad zum NotifySlack-Funktionshandler. </li><li>  <b>Operation</b> : Der Parameter bestimmt, welchen Datentyp und welches Ereignis der Trigger abh√∂ren soll. </li><li>  <b>Typ</b> : Gibt an, ob sie vor oder nach Daten√§nderungen gestartet werden.  Es gibt zwei Arten: trigger.before und trigger.after. </li></ul><br>  Der n√§chste Schritt besteht darin, eine Handlerdatei zu erstellen, um Ereignisse nach dem Trigger zu empfangen.  Um Updates an Slack zu senden, verwenden wir die Methode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">chat.postMessage</a> .  Nachrichten werden mit der HTTP-Post-Methode gesendet. Jede Anfrage an die chat.postMessage-Methode wird vom OAuth-Zugriffstoken Ihres Bots signiert.  Besuchen Sie die Detailseite Ihrer Anwendung und klicken Sie in der Seitenleisten-Navigation auf den Link OAuth &amp; Berechtigungen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/180/c54/94d/180c5494dcf0df2c5de56fcefbc65c2a.png" alt="Bild"><br><br>  ‚Äç Kopieren Sie das Token und wechseln Sie auf der Seite mit den 8base-Einstellungen zur Registerkarte Umgebungsvariablen.  Ihre Funktionen haben Zugriff auf alle erstellten Umgebungsvariablen.  Speichern Sie Ihre vertraulichen Werte und Anmeldeinformationen immer hier und platzieren Sie sie nicht direkt in der Quellcodedatenbank.  Erstellen Sie eine neue Variable mit dem Namen SLACK_ACCESS_TOKEN, f√ºgen Sie das kopierte Token ein und speichern Sie es. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/b45/96b/84ab4596bc04520f2ae6da4675274dc4.png" alt="Bild"><br><br>  F√ºgen wir nun den Code zum Editor hinzu.  Erstellen Sie eine Datei mit dem Namen utils.js im Verzeichnis src.  √ñffnen Sie die Datei in Ihrem bevorzugten Editor und kopieren Sie Folgendes in die Datei: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> message = <span class="hljs-string"><span class="hljs-string">`A new order was just created`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> messageBody = dataBuilder(order); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> body = { <span class="hljs-attr"><span class="hljs-attr">channel</span></span>: <span class="hljs-string"><span class="hljs-string">'general'</span></span>, <span class="hljs-attr"><span class="hljs-attr">attachments</span></span>: messageBody, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: message }; ‚Äç <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Message body'</span></span>, { body }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Sending message request'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> makeRequest(body); };‚Äç</code> </pre> <br>  Daher akzeptiert die Funktion sendMessage eine Bestellung mit einem Argument. Dies ist ein Objekt, das die Felder enth√§lt, die wir f√ºr das Bestellmodell erstellt haben.  Jetzt m√ºssen wir mit dem Bestellobjekt eine neue Nachricht erstellen, damit wir das Objekt an eine Funktion namens dataBuilder √ºbergeben k√∂nnen.  Die dataBuilder-Funktion gibt ein Objekt im Format von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Slack-Anh√§ngen zur√ºck</a> . <br><br>  Anschlie√üend erstellen wir einen Anforderungshauptteil, der den Arbeitsbereichskanal enth√§lt, in dem wir die Nachricht ver√∂ffentlichen, die von dataBuilder zur√ºckgegebenen Anh√§nge und schlie√ülich den Text.  Als n√§chstes wird die Anforderung zum Ver√∂ffentlichen der Nachricht von der Funktion makeRequest gesendet. <br><br>  Lassen Sie uns die dataBuilder-Funktion erstellen, das folgende Fragment kopieren und die Datei utils.js aktualisieren: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ...}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dataBuilder = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { items } = order; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> itemSections = items.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'section'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: item.name, <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-string"><span class="hljs-string">'#3AA3E3'</span></span>, <span class="hljs-attr"><span class="hljs-attr">accessory</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'image'</span></span>, <span class="hljs-attr"><span class="hljs-attr">image_url</span></span>: item.image, <span class="hljs-attr"><span class="hljs-attr">alt_text</span></span>: item.name, }, }; }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = [ { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'section'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'mrkdwn'</span></span>, <span class="hljs-attr"><span class="hljs-attr">text</span></span>: <span class="hljs-string"><span class="hljs-string">`*There are </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${items.length}</span></span></span><span class="hljs-string"> items in the order*`</span></span>, }, }, ...itemSections, ]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data; };</code> </pre> <br>  Die dataBuilder-Funktion akzeptiert ein Bestellobjekt und erstellt f√ºr jeden Artikel in der Bestellung einen Abschnitt mit dem Namen und dem Bild des Artikels.  Mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Message Builder k√∂nnen Sie</a> eine Vorschau der Formatierung von Nachrichten und Anh√§ngen in Echtzeit anzeigen. <br><br>  Als n√§chstes f√ºgen wir die Funktion makeRequest hinzu, die den Nachrichtentext an den Slack-Workshop sendet. <br><br>  Kopieren Sie das folgende Snippet in die Datei utils.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/utils.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fetch <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'node-fetch'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sendMessage = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ... }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dataBuilder = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">order</span></span></span><span class="hljs-function">) =&gt;</span></span> { ... }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeRequest = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://slack.com/api/chat.postMessage'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> headers = { <span class="hljs-attr"><span class="hljs-attr">Authorization</span></span>: <span class="hljs-string"><span class="hljs-string">`Bearer </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${process.env.SLACK_ACCESS_TOKEN}</span></span></span><span class="hljs-string">`</span></span>, <span class="hljs-string"><span class="hljs-string">'Content-type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span>, }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fetch(url, { <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'post'</span></span>, <span class="hljs-attr"><span class="hljs-attr">body</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(data), headers, }); };</code> </pre> <br>  Installieren Sie zuerst das Node-Fetch-Paket, indem Sie den folgenden Befehl ausf√ºhren: <br><br><pre> <code class="javascript hljs">npm install node-fetch</code> </pre><br>  Wir importieren das Paket und verwenden es in der Funktion makeRequest.  Im Rahmen der Funktion f√ºgen wir der Anforderung alle erforderlichen Header hinzu.  Die Anforderung muss mit dem Header der Inhaberautorisierung signiert sein.  Das Token wird von der zuvor erstellten Umgebungsvariablen abgerufen.  Schlie√ülich geben wir die POST-Anforderung mithilfe der Abruf-API zur√ºck. <br><br>  Jetzt haben wir alles, was Sie brauchen, um mit einem Bot eine Nachricht an den Slack Warspace zu senden.  Erstellen wir einen Funktionshandler, auf den wir in der obigen Datei 8base.yml verwiesen haben. <br><br>  Erstellen Sie eine Datei mit dem Namen notifySlack.js im Verzeichnis src, √∂ffnen Sie die Datei und kopieren Sie den Code hinein: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* src/notifySlack.js */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { sendMessage } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./utils'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (event) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Sending notification to slack'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> res = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sendMessage(event.data); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Notification sent successfully'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: event.data, }; };</code> </pre> <br>  In der Datei verwenden wir die von uns erstellte Dienstprogrammfunktion sendMessage.  Der 8base-Funktionshandler √ºbergibt zwei Argumente: ein Ereignis und einen Kontext.  Die Struktur des Ereignisobjekts h√§ngt von der Art der Funktion ab, und das Kontextobjekt enth√§lt n√ºtzliche Eigenschaften und Methoden, √ºber die Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> lesen k√∂nnen. <br>  In unserem Fall enth√§lt das Ereignisobjekt die erstellte Bestellung, die aus zwei Benutzer- und Elementfeldern besteht.  Das Order-Objekt ist eine Eigenschaft der Ereignisobjektdaten, und wir √ºbergeben dieses Objekt an die sendMessage-Funktion, um Slack zu benachrichtigen. <br><br>  Der Funktionsaufruf wird in try / catch eingeschlossen, da keine Fehler das Beenden der Funktion verursachen sollen.  Schlie√ülich geben wir die Ereignisdaten am Ende der Funktion zur√ºck. <br>  Mit diesen Daten k√∂nnen wir den Betreff und den Text der Nachricht angeben und dann mit dem von uns erstellten Transporter E-Mails senden.  Speichern Sie die Datei und stellen Sie die Funktion mithilfe der 8base-CLI bereit, indem Sie den folgenden Befehl ausf√ºhren: <br><br>  ‚Äç <pre> <code class="javascript hljs"># deploy <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> project root directory <span class="hljs-number"><span class="hljs-number">8</span></span>base deploy</code> </pre> <br>  Nach erfolgreichem Layout der Funktion sollte die folgende Ausgabe vom Terminal angezeigt werden: <br>  ‚Äç <br><pre> <code class="javascript hljs">‚ûú <span class="hljs-number"><span class="hljs-number">8</span></span>base deploy deploy done. Time: <span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">553</span></span> ms.</code> </pre> <br><h4>  Debugging-Funktionen </h4><br>  Es ist wichtig, Protokolle in Ihren Funktionen zu haben, damit Sie Funktionen problemlos debuggen und verfolgen k√∂nnen, was dort vor sich geht.  8base verf√ºgt √ºber eine Seite zum Anzeigen aller an Ihr Profil angeh√§ngten Funktionen.  Sie k√∂nnen problemlos alle Protokolle anzeigen, die von jeder Funktion stammen. <br><br>  Gehen Sie zu 8base <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dashboard</a> und klicken Sie im Seitenmen√º auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Logik</a> .  Auf der Logikseite k√∂nnen Sie alle √ºbersichtlichen Funktionen anzeigen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a2/c20/38a/1a2c2038afb3be1b65769a05cda9482b.png" alt="Bild"><br>  Klicken Sie f√ºr eine bestimmte Funktion auf <b>Protokolle anzeigen</b> , um alle Protokolle anzuzeigen.  Als n√§chstes installieren wir die Slack-Anwendung und testen sie. <br><br><h3>  Installieren und Testen der Slack-App </h3><br>  Lassen Sie uns den letzten Schritt abschlie√üen und die Slack-Anwendung im Arbeitsbereich installieren.  Kehren Sie dazu zur Slack-App-Konsole zur√ºck und klicken <b>Sie</b> in der seitlichen Navigationsleiste auf <b>App installieren</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/76e/212/b74/76e212b74709411272256b422a77f653.png" alt="Bild"><br><br>  Auf der Seite wird eine Warnung zum Hinzuf√ºgen einer Funktion oder Berechtigung zum Installieren der Anwendung angezeigt.  Klicken Sie darauf und f√ºgen Sie die Berechtigung hinzu. <br><br>  Nach erfolgreicher Installation der Anwendung k√∂nnen wir die Funktion und die Anwendung testen.  Gehen Sie zur Seite 8base <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Data</a> und klicken Sie in der Seitenleiste auf die Tabelle Orders.  Klicken Sie in der <b>Bestell-</b> Tabellenanzeige auf die Registerkarte DATEN. Hier k√∂nnen Sie der Tabelle neue Zeilen hinzuf√ºgen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c0/fab/84c/7c0fab84c009f1f3620ab57e41086a55.png" alt="Bild"><br><br>  Dr√ºcken Sie in der Datentabelle die Taste {+} und erstellen Sie eine neue Zeile. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1a/015/2bf/b1a0152bf7dad2951b3ef2d1e0a07310.png" alt="Bild"><br><br>  Sie k√∂nnen das Produktfeld mit folgenden Daten ausf√ºllen: <br><br><pre> <code class="javascript hljs">[{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Food product"</span></span>, <span class="hljs-string"><span class="hljs-string">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://static.pexels.com/photos/368893/pexels-photo-368893.jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span> }, { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"The real fruit"</span></span>, <span class="hljs-string"><span class="hljs-string">"image"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://static.pexels.com/photos/368893/pexels-photo-368883.jpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"price"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }]</code> </pre> <br>  Klicken <b>Sie auf Zeile hinzuf√ºgen</b> , um eine neue Bestellung zu erstellen.  Gehen Sie dann zu dem Workshop, in dem Sie die Slack App installiert haben, klicken Sie auf den # allgemeinen Kanal und Sie sehen eine neue Nachricht vom Bot. <br><br>  Es sollte so aussehen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/739/025/ef1/739025ef157a8879e5a1aa63595036de.png" alt="Bild"><br><br>  Neue Benachrichtigung von 8base Bot auf Slack Channel <br><br><h3>  Letzte Worte </h3><br>  Das Erstellen einer Slack-Anwendung ist eine gute Idee.  Slack ist f√ºr die meisten Teams das wichtigste Kommunikationsmittel und bietet Ihnen alle Informationen, die Sie f√ºr die t√§gliche Arbeit ben√∂tigen. <br><br>  F√ºr diesen Artikel haben wir mithilfe der 8base-Funktionalit√§t eine einfache Slack-Anwendung erstellt, die Nachrichten √ºber neue Bestellungen im System sendet.  Gesendete Nachrichten waren ziemlich einfach.  Slack verf√ºgt √ºber eine umfangreiche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Formatierung</a> f√ºr seine Nachrichten, und Sie k√∂nnen sie komplizieren, damit sie mehr Informationen enthalten.  Lesen Sie hier mehr √ºber 8base-Funktionen.  Siehe den Code in diesem Artikel auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> . <br><br>  Danke f√ºrs Lesen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de466335/">https://habr.com/ru/post/de466335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de466317/index.html">Tipps und Tricks von meinem Telegramm-Kanal @pythonetc, August 2019</a></li>
<li><a href="../de466319/index.html">Deal: VMware kauft Cloud-basierten Start</a></li>
<li><a href="../de466323/index.html">Wir erstellen ein tragbares Plattformspiel auf dem Cortex M0 + Mikrocontroller</a></li>
<li><a href="../de466329/index.html">Elektronische Karte der Weinherstellung in Russland. Design und Inhalt</a></li>
<li><a href="../de466333/index.html">So arrangieren Sie einen Arbeitsplatz f√ºr sich</a></li>
<li><a href="../de466337/index.html">Welche Farbe hat deine Funktion?</a></li>
<li><a href="../de466339/index.html">Wie in Microsoft SQL Server Daten von Google Analytics mit R abrufen</a></li>
<li><a href="../de466341/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 33. Vorbereitung auf die ICND1-Pr√ºfung</a></li>
<li><a href="../de466347/index.html">Schulung Cisco 200-125 CCNA v3.0. Tag 34. Erweitertes VLAN-Konzept</a></li>
<li><a href="../de466349/index.html">So f√ºhren Sie A / B-Tests in 15.000 Offline-Stores durch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>