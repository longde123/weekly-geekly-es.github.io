<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôé ‚öæÔ∏è üéß Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 3: Desbordamientos del b√∫fer: exploits y protecci√≥n, Parte 3 üë©üèº‚Äçüíº üåë üí∫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnolog√≠a de Massachusetts. Conferencia Curso # 6.858. "Seguridad de los sistemas inform√°ticos". Nikolai Zeldovich, James Mickens. A√±o 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 3: Desbordamientos del b√∫fer: exploits y protecci√≥n, Parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418099/"><h3>  Instituto de Tecnolog√≠a de Massachusetts.  Conferencia Curso # 6.858.  "Seguridad de los sistemas inform√°ticos".  Nikolai Zeldovich, James Mickens.  A√±o 2014 </h3><br>  Computer Systems Security es un curso sobre el desarrollo e implementaci√≥n de sistemas inform√°ticos seguros.  Las conferencias cubren modelos de amenazas, ataques que comprometen la seguridad y t√©cnicas de seguridad basadas en trabajos cient√≠ficos recientes.  Los temas incluyen seguridad del sistema operativo (SO), caracter√≠sticas, gesti√≥n del flujo de informaci√≥n, seguridad del idioma, protocolos de red, seguridad de hardware y seguridad de aplicaciones web. <br><br>  Lecci√≥n 1: "Introducci√≥n: modelos de amenaza" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 2: "Control de ataques de hackers" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 3: ‚ÄúDesbordamientos del b√∫fer: exploits y protecci√≥n‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  Puede utilizar la t√©cnica de adivinar el "canario" para sus propios fines con el fin de descubrir la presencia de "d√©biles", en t√©rminos de selecci√≥n, bits.  Es decir, si adivin√≥ correctamente, el servidor se reiniciar√°, y esto le servir√° como una se√±al de que el valor establecido es bastante f√°cil de adivinar.  Por lo tanto, es posible derrotar a los "canarios" aleatorizados, suponiendo que despu√©s del reinicio del servidor, su valor no cambiar√°.  Tambi√©n puede usar gadgets para implementar una secuencia relacionada de varios ataques. <br><br>  A continuaci√≥n, veremos una forma m√°s productiva en la que puede utilizar todos estos m√©todos para derrotar la prevenci√≥n de ejecuci√≥n de datos, espacios de direcciones aleatorias y "canarios". <br><br>  Dirijamos nuestra atenci√≥n a las arquitecturas de 64 bits en lugar de las arquitecturas de 32 bits.  Los primeros son m√°s adecuados para la aleatorizaci√≥n, por lo que te dan muchas m√°s "posibilidades" de defenderte de un hacker.  Y estos sistemas se ven mucho m√°s interesantes en t√©rminos de formaci√≥n de ataques. <br><br>  Este tipo de arquitectura de 64 bits tambi√©n se consider√≥ desde el punto de vista de <b>BROP</b> , la programaci√≥n "ciega" orientada hacia atr√°s.  Por simplicidad, suponemos que la √∫nica diferencia entre las m√°quinas de 64 bits y 32 bits es que en una m√°quina de 64 bits, los argumentos se pasan a los registros, y para una m√°quina de 32 bits, a la pila. <br><br><img src="https://habrastorage.org/webt/hg/z1/jc/hgz1jcij9zzqbaqc3fiztx1ctze.jpeg"><br><br>  Cuando una funci√≥n comienza a ejecutarse, se toma para "mirar" en ciertos registros para encontrar d√≥nde est√°n los argumentos. <br><br>  Ahora vayamos a la esencia de la conferencia de hoy: qu√© es la programaci√≥n orientada al retorno ciego, o <b>BROP</b> .  Lo primero que haremos es encontrar un dispositivo de parada.  Recuerde que cuando decimos "gadget", nos referimos esencialmente a las direcciones de retorno.  El gadget se identifica con la direcci√≥n de retorno, la direcci√≥n de inicio de la secuencia de instrucciones a la que queremos ir.  Entonces, ¬øqu√© es un dispositivo de parada? <br><br>  Esencialmente, es la direcci√≥n de retorno a alg√∫n lugar en el c√≥digo, sin embargo, si salta all√≠, simplemente pause el programa, pero no haga que el programa se bloquee.  Es por eso que esto se llama un dispositivo de parada. <br><br>  Podr√≠a saltar a alg√∫n lugar del c√≥digo, que luego inicia una llamada al sistema inactivo, o hace una pausa, o algo as√≠.  Es posible que el programa de alguna manera se "atasque" en un bucle sin fin si saltas a este lugar.  Realmente no importa por qu√© ocurre la parada, pero puede imaginar algunos escenarios que lo llevar√≠an a ello. <br><br>  ¬øPara qu√© sirve un gadget de parada? <br><br>  Tan pronto como el atacante logr√≥ derrotar al "canario" utilizando la t√©cnica interactiva de adivinar bits, puede comenzar a reescribir esta direcci√≥n de retorno, <b>ret direcci√≥n,</b> y comienza a "tocar" el dispositivo de parada.  Tenga en cuenta que es probable que la mayor√≠a de las direcciones aleatorias que puede colocar en la pila simplemente hagan que el servidor se bloquee.  Nuevamente, este mensaje es para usted, el atacante, esto es una indicaci√≥n de que lo que encontr√≥ no es un dispositivo de detenci√≥n.  Porque cuando el servidor falla, su socket se cierra y usted, como atacante, comprende que no entr√≥ en el dispositivo de detenci√≥n.  Pero si adivin√≥ algo y el enchufe despu√©s de eso permanece abierto por un tiempo, piensa: "¬°S√≠, encontr√© este dispositivo de parada!"  Entonces, la idea b√°sica del primer paso es encontrar este gadget de parada. <br><br><img src="https://habrastorage.org/webt/xb/af/zx/xbafzxirvhgep_31ahp8fuzpey4.jpeg"><br><br>  El segundo paso es que desea encontrar gadgets que eliminen las entradas de la pila utilizando el comando <b>pop</b> .  Por lo tanto, debe usar esta secuencia de instrucciones cuidadosamente dise√±adas para averiguar cu√°ndo tomar uno de estos gadgets de pila.  Esta secuencia consistir√° en la <b>direcci√≥n de la sonda</b> de la <b>direcci√≥n de la sonda</b> , la <b>direcci√≥n de detenci√≥n de la direcci√≥n de detenci√≥n</b> y la <b>direcci√≥n de</b> falla del sistema de la <b>direcci√≥n de bloqueo</b> . <br><br>  Por lo tanto, la <b>direcci√≥n de la sonda</b> es lo que vamos a poner en la pila.  Esta ser√° la direcci√≥n del gadget potencial para borrar la pila, la <b>direcci√≥n de detenci√≥n</b> : esto es lo que consideramos en el primer paso, esta es la direcci√≥n del gadget de detenci√≥n.  Entonces la <b>direcci√≥n de bloqueo</b> simplemente ser√° la direcci√≥n del c√≥digo no ejecutable.  Aqu√≠ puede simplemente poner la direcci√≥n cero (0 x 0), y si aplica la funci√≥n <b>ret</b> a esta direcci√≥n e intenta ejecutar el c√≥digo all√≠, esto conducir√° a un bloqueo del programa. <br><br><img src="https://habrastorage.org/webt/38/fa/ba/38fabavrj2kahtqh0_ruuxiigaa.jpeg"><br><br>  Por lo tanto, podemos usar este tipo de direcciones para averiguar d√≥nde limpian estos gadgets la <b>pila emergente de la pila</b> . <br><br>  Dar√© un ejemplo simple.  Supongamos que tenemos dos ejemplos de <b>sonda</b> diferentes, la trampa <b>trampa</b> y la <b>trampa</b> <b>stop</b> .  Supongamos que, con la ayuda de la <b>sonda,</b> vamos a "sondear" alguna direcci√≥n, supongamos que comienza con 4 y termina con ocho: 0x4 ... 8, y detr√°s est√° la siguiente direcci√≥n de la forma 0x4 ... C.  Hipot√©ticamente, podemos suponer que una de estas dos direcciones es la direcci√≥n del gadget <b>emergente</b> de la <b>pila</b> . <br><br>  La <b>trampa trampa</b> obtendr√° cero direcciones 0x0 y 0x0, y dejar√° que el gadget <b>stop</b> se <b>detenga</b> con direcciones arbitrarias como 0xS ... 0xS ..., no importa.  Este dispositivo de detenci√≥n apunta al c√≥digo de suspensi√≥n (10), lo que hace que el programa se detenga. <br><br>  Comencemos con la operaci√≥n de la <b>sonda</b> , que borra algunos registros y regresa en la siguiente secuencia: <b>pop rax;</b>  <b>ret</b> .  Que va a pasar  Cuando el sistema salta a esta direcci√≥n, el puntero de la pila se mover√° a la mitad de nuestro gadget.  ¬øQu√© va a hacer el gadget aqu√≠?  Derecha, realice <b>la</b> operaci√≥n <b>pop rax</b> . <br><br><img src="https://habrastorage.org/webt/i2/eu/zr/i2euzrwlujsohfb4dl-szdeasac.jpeg"><br><br>  Y luego sigue <b>ret</b> , que mover√° la funci√≥n a la l√≠nea superior del gadget, es decir, para <b>detener</b> , y la funci√≥n se detendr√° sin bloquear todo el programa.  Entonces, usando este gadget, un atacante puede decir que la direcci√≥n de la <b>sonda</b> pertenece a una de estas funciones, que borra la pila, porque la conexi√≥n del cliente del servidor est√° abierta. <br><br>  Ahora supongamos que la segunda direcci√≥n de la <b>sonda</b> apunta a algo como <b>xor rax, rax, ret</b> para alg√∫n registro. <br><br><img src="https://habrastorage.org/webt/kw/5t/r3/kw5tr3vdtrqedphe0onl6ec-wa0.jpeg"><br><br>  Entonces, ¬øqu√© sucede si intentamos saltar a este gadget?  Tenga en cuenta que no borra nada en la pila, solo cambia el contenido de los registros.  Entonces, vamos a regresar a la direcci√≥n 0x0 ubicada arriba.  Y esto har√° que el sistema se bloquee.  La conexi√≥n del cliente con el servidor se interrumpir√°, y el hacker comprender√° que este no es un gadget para borrar la pila de la <b>pila</b> . <br><br>  De esta manera, puede usar una serie m√°s extra√±a de trampas y detener dispositivos, por ejemplo, puede borrar dos elementos en la pila.  Para hacer esto, solo necesita colocar otra instrucci√≥n de <b>captura</b> aqu√≠, y si este gadget no borra dos elementos, se encontrar√° en una de estas trampas, y el c√≥digo dejar√° de ejecutarse.  Los materiales para la conferencia describen una cosa llamada <b>dispositivo BROP,</b> que es √∫til si no le gusta volver a la programaci√≥n.  Pero hoy tambi√©n te dir√© c√≥mo puedes usar estos simples gadgets <b>pop</b> para lanzar un ataque similar.  Una vez que comprenda esto, tratar con un <b>gadget BROP</b> ser√° mucho m√°s f√°cil. <br><br>  Pero, ¬øentienden c√≥mo podemos usar la funci√≥n de <b>sonda</b> para estos dispositivos?  Suponga que encuentra la ubicaci√≥n de los fragmentos de c√≥digo que le permite borrar la pila con la funci√≥n <b>pop</b> , eliminar un elemento, pero realmente no sabe en qu√© registro funcionar√° esta funci√≥n <b>pop</b> .  Solo sabes que ella ya est√° lista para la ejecuci√≥n.  Pero necesita saber en qu√© registro funcionar√°n estos gadgets <b>pop</b> , porque en una arquitectura de 64 bits, los registros controlan d√≥nde se encuentran los argumentos de la funci√≥n que desea llamar. <br><br>  Por lo tanto, nuestro objetivo es poder crear gadgets que nos permitan eliminar los valores que ponemos en ciertos registros de la pila y, en √∫ltima instancia, iniciar una llamada al <b>sistema</b> , lo que nos permite hacer algo malo. <br>  As√≠ que ahora tenemos que determinar qu√© registros usan <b>los</b> gadgets <b>pop</b> . <br><br><img src="https://habrastorage.org/webt/xp/w-/hw/xpw-hw9rdgd2argq0yx6xgi3ece.jpeg"><br><br>  Para hacer esto, podemos aprovechar la llamada al sistema de pausa.  Si la llamada del sistema est√° en pausa, la ejecuci√≥n del programa se suspende y no acepta ning√∫n argumento.  Y esto significa que el sistema ignora todo en los registros. <br><br>  De hecho, para encontrar la instrucci√≥n de pausa que estamos ejecutando, puede vincular todos estos gadgets <b>pop</b> para que podamos ponerlos todos en la pila, y entre cada uno de ellos <b>inserte un n√∫mero de syscall</b> para pausar.  Luego veremos si podemos "suspender" el programa de esta manera.  D√©jame darte un ejemplo concreto. <br><br>  Aqu√≠, colocamos un gadget en la barra de direcci√≥n de retorno que borra los registros <b>RDI</b> y les aplica la funci√≥n <b>ret</b> .  Arriba pondremos un <b>n√∫mero de syscall</b> para pausar. <br><br>  Supongamos que tenemos un dispositivo m√°s ubicado arriba que implementa la funci√≥n <b>pop</b> en otro registro, digamos <b>RSI</b> , y luego <b>ret</b> .  Y luego ponemos el <b>n√∫mero de syscall</b> nuevamente para hacer una pausa.  Y hacemos esto para todos los dispositivos que encontramos, y luego terminamos en la parte superior de la pila con la direcci√≥n supuesta para <b>syscall</b> . <br><br><img src="https://habrastorage.org/webt/qd/yx/3v/qdyx3vymmlc13o-sceyeimho_ro.jpeg"><br><br>  Recuerde nuevamente c√≥mo utiliza estas llamadas al sistema.  Debe poner el <b>n√∫mero de syscall</b> en el registro <b>RAX</b> , luego llamar a la <b>funci√≥n libc syscall</b> , que est√° a punto de realizar la llamada al sistema solicitada. <br><br>  Entonces, ¬øqu√© sucede cuando ejecutamos este c√≥digo?  Llegaremos aqu√≠, a la l√≠nea de <b>direcci√≥n de ret</b> , saltaremos a la direcci√≥n de este gadget, debe tenerse en cuenta que el atacante sabe que este gadget, ubicado a la derecha, elimina algo de la pila, pero a√∫n no sabe en qu√© registro se encuentra. <br><br>  Entonces, si <b>saltamos a la direcci√≥n ret</b> , ¬øqu√© sucede?  √âl usar√° la funci√≥n <b>pop</b> para pausar <b>syscall</b> , en alg√∫n registro que el atacante no conoce, y luego continuaremos escalando esta cadena de operaciones en la pila. <br><br>  Al hacerlo, esperamos que uno de estos dispositivos realice la funci√≥n <b>emergente</b> para el <b>n√∫mero de syscall</b> en el registro <b>RAX</b> correspondiente.  Entonces, para cuando lleguemos aqu√≠, en la parte superior de la pila, en el camino "estropeando" todos los registros que tienen un <b>n√∫mero de syscall</b> para pausar, esperamos que todav√≠a tengamos un registro, que deber√≠a ser correcto.  Porque si uno de nuestros dispositivos hace esto, y luego, al hacer <b>ret</b> , despu√©s de un tiempo volveremos aqu√≠, en la parte superior de la pila, entonces tendremos una pausa.  Una vez m√°s, la pausa act√∫a como una se√±al para el atacante.  Porque si esta direcci√≥n asumida para <b>syscall</b> era incorrecta, entonces el programa fallar√°. <br><br>  Entonces, ¬øqu√© nos permite hacer esta fase de ataque?  Todav√≠a no sabemos en qu√© registros se encuentran los gadgets <b>pop</b> , pero sabemos que uno de ellos liberar√° el <b>RAX</b> que queremos controlar.  Y probablemente conocemos la direcci√≥n de <b>syscall</b> , porque logramos detener el sistema. <br><br>  Una vez que hacemos esto, podemos verificar estos dispositivos uno por uno y descubrir cu√°l pone el sistema en pausa.  En otras palabras, cortamos todo entre la l√≠nea de <b>direcci√≥n de ret</b> y la parte superior de la pila para ir directamente a <b>syscall</b> .  Verificaremos si se produjo una pausa o una falla del sistema.  Si ocurre una falla, identificamos el dispositivo que lo caus√≥, por ejemplo, est√° en la l√≠nea inferior a la derecha, esto es <b>pop rdi</b> .  Deshazte de √©l y prueba el siguiente.  Ponga aqu√≠ en la l√≠nea arriba de la <b>direcci√≥n ret la direcci√≥n</b> real para <b>syscall</b> .  ¬øPodr√≠amos pausar el programa?  S√≠, eso significa que aprendimos que este gadget <b>pop</b> deber√≠a liberar <b>RAX</b> .  ¬øEso est√° claro? <br><br>  <b>P√∫blico:</b> Entonces, ¬øuna forma de adivinar la direcci√≥n de una llamada al sistema es solo una transferencia ciega de gadgets? <br><br>  <b>Profesor:</b> s√≠, lo es, y hay formas de optimizar este proceso en los materiales de lectura cuando usa la extensi√≥n de archivo <b>PLT</b> y cosas similares.  Con el simple ataque que describ√≠, realmente solo pega la direcci√≥n aqu√≠ y se asegura de que haya causado una pausa o no.  Como resultado de la prueba, descubrimos la ubicaci√≥n de <b>syscall</b> .  Descubriremos d√≥nde se encuentra la instrucci√≥n que ejecuta <b>pop RAX</b> .  Tambi√©n necesitamos gadgets que ejecuten <b>pop</b> en algunos otros registros tambi√©n.  Puedes hacer pruebas similares para ellos.  Por lo tanto, en lugar de pausar el <b>n√∫mero de syscall</b> , use <b>push</b> para alg√∫n otro comando que, por ejemplo, use los argumentos <b>RAX</b> y <b>RDI</b> . <br><br>  Por lo tanto, puede usar el hecho de que para cualquier conjunto particular de registros que desee controlar, hay alg√∫n tipo de <b>syscall</b> que le dar√° a un atacante una se√±al para saber si lo rompi√≥ con √©xito o no.  Por lo tanto, al final de esta fase, tendr√° la direcci√≥n <b>syscall</b> y la direcci√≥n del mont√≥n de gadgets, que le permiten <b>ingresar</b> registros arbitrarios. <br><br>  Y ahora pasemos al cuarto paso, que se llamar√° grabaci√≥n - grabaci√≥n.  El cuarto paso es grabar una llamada al sistema.  Para llamar a <b>escribir</b> , necesitamos tener los siguientes gadgets: <br><br>  <b>pop rdi, ret;</b> <b><br></b>  <b>pop rsi, ret;</b> <b><br></b>  <b>pop rdx, ret;</b> <b><br></b>  <b>pop rax, ret;</b> <b><br></b>  <b>syscall</b> <br><br><img src="https://habrastorage.org/webt/kj/1h/ds/kj1hdsjhh1509eliv3vjxte7nw4.jpeg"><br><br>  ¬øC√≥mo utilizan estos registros una llamada al sistema?  El primero es el socket o, m√°s generalmente, el descriptor de archivo que va a transferir para escribir.  El segundo es el b√∫fer, el tercero es la longitud de este b√∫fer, el cuarto es el n√∫mero de llamada del sistema y el quinto es la llamada al sistema. <br><br>  Entonces, si encontramos todos estos gadgets, entonces podemos controlar los valores que est√°n incrustados en los argumentos, que, a su vez, se colocan en estos registros, porque simplemente los "empujamos" en la pila. <br><br>  ¬øQu√© deber√≠a ser un z√≥calo?  Aqu√≠ tenemos que adivinar un poco.  Puede aprovechar el hecho de que Linux limita el n√∫mero de conexiones abiertas simult√°neas para un archivo que alcanza un valor de 2024. Y tambi√©n que deber√≠a ser el m√≠nimo de todos los disponibles. <br><br>  Me pregunto qu√© vamos a insertar en el puntero del b√∫fer.  As√≠ es, tenemos la intenci√≥n de usar el fragmento de texto del programa aqu√≠, lo vamos a poner en un puntero en alg√∫n lugar del c√≥digo del programa.  Esto nos permite leer el archivo binario de la memoria utilizando la llamada correcta del cliente desde el socket.  Luego, el atacante puede tomar este archivo binario, analizarlo sin conexi√≥n fuera de l√≠nea, usando <b>GDB</b> u otra herramienta para averiguar d√≥nde se encuentra todo esto.  El atacante sabe que ahora, cada vez que el servidor "falla", se almacenar√° en √©l el mismo conjunto aleatorio de cosas.  Entonces, ahora que un atacante puede encontrar las direcciones y las compensaciones para el contenido de la pila, puede atacar estos dispositivos directamente.  Puede atacar directamente otras vulnerabilidades, descubrir c√≥mo abrir el shell y similares.  En otras palabras, en el lugar donde proporcionaste el binario con el hacker, fuiste derrotado. <br><br>  As√≠ es como funciona el ataque <b>BROP</b> .  Como dije, en los materiales de la conferencia hay muchas formas de optimizar estos procesos, pero primero debe comprender el material principal, de lo contrario, la optimizaci√≥n pierde su significado.  Por lo tanto, puede hablarme sobre la optimizaci√≥n individualmente o despu√©s de la clase. <br><br>  Por ahora, basta con decir que estos son los conceptos b√°sicos de c√≥mo puede lanzar un ataque <b>BROP</b> .  Debe encontrar el dispositivo de <b>detenci√≥n</b> , los dispositivos que realizan la funci√≥n de <b>las</b> entradas de <b>la</b> pila <b>emergente</b> , averiguar en qu√© registros se encuentran, d√≥nde se encuentra <b>syscall</b> y luego iniciar la <b>escritura</b> , en funci√≥n de la informaci√≥n obtenida. <br><br><img src="https://habrastorage.org/webt/xb/-q/iq/xb-qiqqwytbciwpbxiow5i_fovi.jpeg"><br><br>  Entonces, <b>repase</b> r√°pidamente el tema, ¬øc√≥mo se defiende contra <b>BROP</b> ?  Entonces, lo m√°s obvio que tienes es la aleatorizaci√≥n.  Dado que el hecho de que los servidores "ca√≠dos" no reaparecen, no crean versiones aleatorias de s√≠ mismos, act√∫a como una se√±al que le da al atacante la oportunidad de probar varias hip√≥tesis sobre c√≥mo funcionan los programas. <br><br>  Una manera f√°cil de protegerte es asegurarte de que <b>ejecutas en</b> lugar de <b>fork</b> cuando revives tu proceso.  Porque cuando ejecuta el proceso, crea un espacio completamente nuevo ubicado al azar, al menos eso es lo que sucede en Linux.  En Linux, cuando compila usando <b>PIE</b> , <b>Position Independent Execution</b> , un ejecutable independiente de la ubicaci√≥n, cuando usa <b>exec,</b> solo obtiene un nuevo espacio de direcci√≥n aleatorio. <br><br>  La segunda forma es simplemente usar Windows, porque este sistema operativo b√°sicamente no tiene el equivalente de una funci√≥n <b>fork</b> .  Esto significa que cuando revivas un servidor en Windows, siempre tendr√° un nuevo espacio de direcciones aleatorias. <br><br>  Alguien aqu√≠ pregunt√≥ qu√© pasar√≠a si despu√©s de un mal funcionamiento del servidor no se desconectara.  Por lo tanto, si durante un bloqueo del servidor de alguna manera "detectamos" este error y mantenemos la conexi√≥n abierta por un tiempo, podemos confundir al atacante para que no reciba una se√±al sobre la falla y piense que ha encontrado la direcci√≥n correcta. <br><br>  En este caso, su ataque <b>BROP</b> se convertir√° en un ataque <b>DOS</b> .  Porque acabas de recibir todos los procesos potenciales de zombies que est√°n alrededor.  Son in√∫tiles, pero no puede dejarlos ir m√°s all√°, de lo contrario tendr√° que eliminar esta informaci√≥n. <br><br>  Otra cosa en la que podr√≠a pensar es en hacer el control de fronteras del que hablamos antes.  Los materiales de la conferencia dicen que este m√©todo no es productivo, ya que es 2 veces m√°s costoso, pero a√∫n podr√≠a usarlo. <br><br>  As√≠ es como funciona <b>BROP</b> .  En cuanto a la tarea, se hace una pregunta m√°s delicada: ¬øqu√© pasa si usa un hash de la hora actual?  Es decir, el per√≠odo de tiempo durante el que reinicia el programa.  ¬øEs esto suficiente para prevenir este tipo de ataque?  Tenga en cuenta que el hash no le proporciona m√°gicamente bits de entrop√≠a si los datos que ingresa en el hash son f√°cilmente predecibles.  Si su hash contiene miles de millones de bits, eso no importa.  Pero si solo tiene un par de significados all√≠, el atacante los adivinar√°.  Por supuesto, usar un hash de tiempo aleatorio es mejor que no usar nada para protegerse contra un pirata inform√°tico, pero esto no le proporcionar√° la seguridad con la que debe contar. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xSQxaie_h1o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  La versi√≥n completa del curso est√° disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  <b>Ap√≥yenos</b> haciendo un pedido o recomend√°ndolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un an√°logo √∫nico de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  ¬°Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Pa√≠ses Bajos y los Estados Unidos!</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418099/">https://habr.com/ru/post/es418099/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418087/index.html">El 80% de los pagos de autoservicio est√°n en riesgo</a></li>
<li><a href="../es418089/index.html">Descripci√≥n general de la fresadora CNC SolidCraft</a></li>
<li><a href="../es418091/index.html">Lista de art√≠culos y literatura sobre NAS</a></li>
<li><a href="../es418093/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 3: Desbordamientos del b√∫fer: exploits y protecci√≥n, parte 2</a></li>
<li><a href="../es418095/index.html">Acerca del dispositivo de funcionalidad de prueba incorporada en Rust (traducci√≥n)</a></li>
<li><a href="../es418101/index.html">Etimolog√≠a de los t√©rminos de TI</a></li>
<li><a href="../es418103/index.html">El jefe de Roscosmos record√≥ su primer cohete y comparti√≥ planes para el futuro.</a></li>
<li><a href="../es418105/index.html">¬øPor qu√© abrir YouTube en Firefox o Edge puede tardar 5 veces m√°s que en Google Chrome?</a></li>
<li><a href="../es418107/index.html">Establecer un prefijo para el esc√°ner MINDEO CS2190 para trabajar con 1C en modo de interrupci√≥n de teclado</a></li>
<li><a href="../es418111/index.html">Aprendizaje moderno en l√≠nea: desaf√≠os y tendencias</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>