<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò∞ üßôüèΩ üë©üèª‚Äç‚öñÔ∏è Alamat saya bukan rumah atau jalan, alamat saya adalah Uni Soviet? üëèüèº üò¨ üïú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="microBIGDATA atau FIAS di saku Anda 


 Peter Brueghel the Younger, Tax Payment , 1640 

 Entri terakhir pada pencukur pada benda-benda pergi. Kami ak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Alamat saya bukan rumah atau jalan, alamat saya adalah Uni Soviet?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438062/"> <b>microBIGDATA atau FIAS di saku Anda</b> <br><br><img src="https://habrastorage.org/webt/gq/le/vh/gqlevhij14f0jkubb4pmbjwvb5u.jpeg"><br>  <i>Peter Brueghel the Younger, <b>Tax Payment</b> , 1640</i> <br><br>  Entri terakhir pada pencukur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pada benda-benda</a> pergi.  Kami akan melanjutkan pengintaian dalam pertempuran.  Hari ini kita akan berbicara tentang yang sulit.  Ini bukan tentang DATA BESAR, tetapi sudah tidak nyaman untuk bekerja - data dalam jumlah yang cukup besar.  Tidak semua orang akan masuk ke dalam seluruh RAM, tetapi beberapa bahkan tidak akan muat pada disk (tidak ada cukup ruang, tetapi banyak sampah).  Nama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">basis data</a> kepercayaan kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FIAS</a> adalah basis data sistem informasi alamat federal.  Arsip 5,5 GB.  Dan itu dikompresi menjadi arsip XML.  Setelah membongkar, akan ada 53 GB penuh (menyimpan 110 GB untuk membongkar).  Dan ketika Anda mulai menguraikannya dan mengubahnya, maka 110 GB tidak akan cukup.  Tentang jumlah RAM yang diperlukan juga akan. <br><a name="habracut"></a><br>  Semuanya akan baik-baik saja, tetapi Anda dapat menggali lebih jauh.  Ada proyek pengumpulan data dan sistematisasi sumber terbuka internasional - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">OpenAddresses</a> .  Jadi akan ada lebih banyak database.  Cakupan planet saat ini memiliki banyak bintik-bintik putih, misalnya, Rusia hampir tidak ada.  Ukuran arsip adalah 10 GB. <br><br>  Atau database <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">proyek OpenStreetMaps yang</a> cukup terkenal.  Itu dibangun oleh sukarelawan berdasarkan Wikipedia.  Cukup detail dan multibahasa.  Sekarang arsip lengkap XML terkompresi dengan ukuran 74 GB. <br><blockquote>  Jika mereka mulai berbicara tentang alamat, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berita</a> tak terduga <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tiba pada waktunya dari DuckDuckGo</a> , mesin pencari aman terbaik untuk hari ini, tentang peralihannya ke kartu Apple.  Lebih tepatnya di Apple MapKit JS.  Fitur yang paling menarik dalam konteks kami adalah "pencarian alamat yang ditingkatkan".  Apakah Apple yang terbaik mengumpulkan dan melindungi data kami dengan susah payah?  Ini akan diperlukan untuk melacak ... </blockquote>  Jadi tantangannya.  Cara memasukkan semua kekayaan alamat ini ke dalam repositori yang menyenangkan untuk digunakan, agar Anda dapat bermimpi tentang API gratis (tentu saja dengan Python) dan tidak membiarkan besi tersumbat tersumbat pada beban yang belum dibaca.  Sebut saja MicroBigData - mcBD atau ŒºBG dalam bahasa Inggris :-) <br><br>  Dalam ekonomi pengembang setiap detik (atau bahkan yang pertama), hal ini adalah direktori alamat, itu juga merupakan direktori toponim, hal yang sangat diperlukan.  Dan ketika itu juga normatif, dipersiapkan, dibersihkan dan didokumentasikan dengan baik oleh tubuh yang tepat, itu hanya dongeng.  Kita harus membayar upeti, layanan pajak Rusia melakukan produksi digitalnya dengan baik.  Sejauh mungkin.  Mungkin ada beberapa kelemahan di dalam dan pembersihan data berlanjut.  Bagaimana mengatasi masalah ini, biarkan kepala negara berpikir.  Mereka memutuskan untuk diri kita sendiri dan untuk kepentingan kita semua.  Ngomong-ngomong, satu kesalahan ketik dari FIAS ditemukan pada contoh di bawah ini.  Hasilnya tidak terpengaruh.  Saya tidak memperbaikinya.  Anda akan menemukan <br><br>  Saya tidak tahu seberapa spesifik data alamat itu relevan dalam proyek Anda - ini semua adalah wilayah, kota, jalan.  Tetapi tampaknya tidak ada satu proyek pun yang dapat dilakukan tanpa mereka.  Itu adalah alamat tempat mencari seseorang atau tempat mengirim paket kepadanya.  Rincian paspor atau dokumen lain apa pun harus disimpan.  Atau mungkin alamat kantor atau objek wisata yang direkomendasikan untuk dikunjungi.  Dan apa yang harus dilakukan?  Dari mana mendapatkan <br><br>  Solusi paling sederhana, tanpa memperhatikan kesalahan dan duplikat, adalah objek primitif yang mengandung string string literal (mereka adalah konstanta string, mereka juga string).  Biarkan pengguna memasukkan entri yang diterima berikutnya ke dalamnya.  Dan benda-benda dapat menyelamatkan diri - kita telah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">melewati ini</a> . <br><br>  Objek seperti itu, misalnya, seperti dijelaskan dalam kelas di bawah ini.  <a href="">Langsung dari buku teks</a> , meskipun Amerika, tetapi disesuaikan dengan realitas Rusia kami - alih-alih ZIP mereka, akan ada kode pos kami.  Saya juga akan mengganti kode pos dengan angka, tetapi demi monoton saya meninggalkan string.  Siapa pun yang segera mengenali suatu bahasa, dan ini adalah ObjectScript, berhak mendapat suka. <br><br><pre><code class="plaintext hljs">Class Soviet.Address Extends %Persistent { Property streetName As %String; Property cityName As %String; Property areaName As %String; Property postalCode As %String; }</code> </pre> <br>  Tentu saja, banyak yang akan marah, mereka mengatakan semuanya mencuat dari kantong benda (literal).  Di mana itu telah dilihat, sehingga objek bersinar bidangnya secara publik?!  Mari kita biarkan seperti ini, itu menyakitkan contoh yang fasih dan dapat dimengerti oleh siswa mana pun. <br><br>  Ini sebenarnya yang dibutuhkan.  Diisi bidang.  Taruh di penyimpanan.  Ditransfer ke objek lain untuk bekerja.  Diwarisi lebih jauh kepada seseorang.  Semuanya berfungsi.  Dan disimpan! <br><blockquote>  Tetapi beberapa kata mengapa ini tidak layak dilakukan, harus dikatakan.  Apa Alamat objek kami?  Mengapa tidak bisa hanya sekelompok string teks?  Keberatan paling jelas yang muncul dalam pikiran datang dari konteks - siapa yang menggunakan Alamat ini, dalam bentuk apa dan untuk tujuan apa?  Cobalah untuk mengesampingkan pemikiran pemrograman Anda dan bayangkan bagaimana seorang "turis asing", "sejarawan", "inspektur pajak", "pengacara" dan sebagainya. <br><br>  Saya percaya bahwa segera sejumlah pertanyaan dan klarifikasi tambahan muncul: bahasa apa yang digunakan, di mana pengkodean untuk menyimpan dan memberikan, ke era mana untuk mengklasifikasikan, dokumen apa yang diberlakukan, legal atau pos?  Apakah sebuah kota bernama pemukiman atau apa?  Bahkan jalan bisa berubah menjadi bulevar, jalan samping, jalan atau yang lainnya.  Apa yang harus dilakukan dengan semua detail implementasi penting ini? <br><br>  Ambil contoh hidup.  Google sekarang dijalankan oleh Sundar Pichai.  Dia sendiri berasal dari India.  Lahir di kota Chennai (alias Chennai).  Atau di Madras?  Pada tahun 1996, orang-orang India memutuskan bahwa nama kota itu sangat Portugis dan berganti nama menjadi ibu kota Tamil Nadu dari Madras ke Chennai.  Dan apa yang harus ditulis Sundar dan 72 juta rekan senegaranya dalam dokumen elektroniknya? <br><br>  Secara umum, seluruh ilmu pengetahuan berurusan dengan ini - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menerapkan toponimi</a> . </blockquote>  Jadi pertanyaan memohon.  Bagaimana cara menangani <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">waktu dan tanggal</a> ?  Apakah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">uang</a> begitu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">jelas</a> ?  Apakah koordinat geografis begitu sederhana?  Dan bagaimana ini diterapkan dalam kode Anda?  Bisakah Anda mentransfer ke DBMS yang dipilih tanpa menurunkan tingkat abstraksi?  Bagaimana tidak menyelinap ke dalam jenis data mesin atom dan terus-menerus memikirkan rekonstruksi mereka?  Di sini ada baiknya mencari sumber API yang primitif atau, sebaliknya, suara.  Pikirkan tentang hal itu di waktu luang Anda. <br><br>  Singkatnya, konteks adalah yang paling penting.  Dan model objek memungkinkan kita untuk menggunakannya secara langsung melalui enkapsulasi "data mesin" dan penerapan perilaku "langsung" yang peka konteks.  Sama sekali tidak tuple tingkat rendah yang ditata dalam tabel ;-) <br><br>  Sementara itu, mari kita kembali ke implementasi "primitif" dan mempersulit hidup kita.  Untuk memulai, hilangkan kesalahan dan duplikat.  Artinya, kami akan mencari cara untuk menulis alamat segera.  Pada saat yang sama, kami akan membantu pengembang antarmuka pengguna untuk mengatur kiat bagi pengguna saat mengisi bidang entri data. <br><blockquote>  Ketika dua orang berkumpul di satu tempat - teks dan platform data IRIS InterSystems, pengembang memiliki peluang nyata untuk menggunakan sepenuhnya tanpa meninggalkan mesin.  Misalnya, menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">komponen objek bawaan iKnow dan iFind</a> .  Ini adalah komponen untuk bekerja dengan data tidak terstruktur dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pencarian teks lengkap</a> , masing-masing.  Rusia didukung "di luar kotak". </blockquote>  Hal pertama yang pertama, kami akan mengajarkan Alamat untuk membaca data yang diperlukan dari sumber aslinya.  Untungnya, kumpulan data dari layanan pajak federal memiliki deskripsi siap pakai tentang struktur dokumen XML.  Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">uraian yang</a> terlampir pada data <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dari situs web FIAS</a> , kita memerlukan kumpulan data ADDROBJ, yang, dalam kasus saya, sesuai dengan file AS_ADDROBJ_2_250_01_04_01_01.xsd <br><br>  Selanjutnya, kita akan menggunakan sistem converter XSD template ke struktur bidang yang sesuai dari kelas% XML.Adaptor, silakan disiapkan untuk kita oleh pengembang IRIS.  Tanda persen di awal hanya berarti bahwa ini adalah kelas dari pustaka sistem.  <a href="">Rincian penggunaan ada dalam dokumentasi</a> .  Kami akan melakukan operasi di terminal. <br><br><pre> <code class="plaintext hljs">set xmlScheme = ##class(%XML.Utils.SchemaReader).%New() do xmlScheme.Process("http://localhost/AS_ADDROBJ_2_250_01_04_01_01.xsd")</code> </pre> <br>  Hal yang sama dapat diperoleh di <a href="">Atelier IDE</a> (di Tools&gt; Add-Ins&gt; XML Schema Wizard menu) atau dengan permintaan serupa ke objek langsung dari kode program. <br><br><img src="https://habrastorage.org/webt/ed/3k/8c/ed3k8cfd9t_jc8gklg_euthhihy.png"><br><br>  Karena kami menggunakan konstruktor tanpa menentukan parameter, yaitu nama paket untuk menempatkan kelas yang dihasilkan, mereka berakhir di paket Tes.  Seperti yang Anda lihat dari perintah kedua, saya memberikan file skema melalui server web lokal saya di Python: <br><br><pre> <code class="bash hljs">python3 -m http.server 80</code> </pre> <br>  Anda dapat menggunakan http-server lain yang Anda suka.  Atau unggah file ke server IRIS Anda dan tunjukkan jalur langsung ke sana. <br><br>  Sebagai hasilnya, kami memiliki dua kelas yang sepenuhnya mencerminkan struktur XML beralamat kami: <br><br><div class="spoiler">  <b class="spoiler_title">Test.AddressObjects</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">///            Class Test.AddressObjects Extends (%Persistent, %XML.Adaptor) [ ProcedureBlock ] { Parameter XMLNAME = "AddressObjects"; Parameter XMLSEQUENCE = 1; ///    Relationship Object As Test.Object(XMLNAME = "Object", XMLPROJECTION = "ELEMENT") [ Cardinality = many, Inverse = AddressObjects ]; }</code> </pre> <br></div></div><div class="spoiler">  <b class="spoiler_title">Test.object</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">///  : http://localhost:28869/AS_ADDROBJ_2_250_01_04_01_01.xsd Class Test.Object Extends (%Persistent, %XML.Adaptor) [ ProcedureBlock ] { Parameter XMLNAME = "Object"; Parameter XMLSEQUENCE = 1; ///      Property AOGUID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "AOGUID", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property FORMALNAME As %String(MAXLEN = 120, MINLEN = 1, XMLNAME = "FORMALNAME", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property REGIONCODE As %String(MAXLEN = 2, MINLEN = 2, XMLNAME = "REGIONCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property AUTOCODE As %String(MAXLEN = 1, MINLEN = 1, XMLNAME = "AUTOCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property AREACODE As %String(MAXLEN = 3, MINLEN = 3, XMLNAME = "AREACODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property CITYCODE As %String(MAXLEN = 3, MINLEN = 3, XMLNAME = "CITYCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///    Property CTARCODE As %String(MAXLEN = 3, MINLEN = 3, XMLNAME = "CTARCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///    Property PLACECODE As %String(MAXLEN = 3, MINLEN = 3, XMLNAME = "PLACECODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///     Property PLANCODE As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "PLANCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property STREETCODE As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "STREETCODE", XMLPROJECTION = "ATTRIBUTE"); ///     Property EXTRCODE As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "EXTRCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///      Property SEXTCODE As %String(MAXLEN = 3, MINLEN = 3, XMLNAME = "SEXTCODE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property OFFNAME As %String(MAXLEN = 120, MINLEN = 1, XMLNAME = "OFFNAME", XMLPROJECTION = "ATTRIBUTE"); ///   Property POSTALCODE As %String(MAXLEN = 6, MINLEN = 6, XMLNAME = "POSTALCODE", XMLPROJECTION = "ATTRIBUTE"); ///    Property IFNSFL As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "IFNSFL", XMLPROJECTION = "ATTRIBUTE"); ///      Property TERRIFNSFL As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "TERRIFNSFL", XMLPROJECTION = "ATTRIBUTE"); ///    Property IFNSUL As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "IFNSUL", XMLPROJECTION = "ATTRIBUTE"); ///      Property TERRIFNSUL As %String(MAXLEN = 4, MINLEN = 4, XMLNAME = "TERRIFNSUL", XMLPROJECTION = "ATTRIBUTE"); /// OKATO Property OKATO As %String(MAXLEN = 11, MINLEN = 11, XMLNAME = "OKATO", XMLPROJECTION = "ATTRIBUTE"); /// OKTMO Property OKTMO As %String(MAXLEN = 11, MINLEN = 8, XMLNAME = "OKTMO", XMLPROJECTION = "ATTRIBUTE"); ///    Property UPDATEDATE As %Date(XMLNAME = "UPDATEDATE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///     Property SHORTNAME As %String(MAXLEN = 10, MINLEN = 1, XMLNAME = "SHORTNAME", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///    Property AOLEVEL As %Integer(XMLNAME = "AOLEVEL", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///     Property PARENTGUID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "PARENTGUID", XMLPROJECTION = "ATTRIBUTE"); ///   .  . Property AOID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "AOID", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///        Property PREVID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "PREVID", XMLPROJECTION = "ATTRIBUTE"); ///        Property NEXTID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "NEXTID", XMLPROJECTION = "ATTRIBUTE"); ///           4.0. Property CODE As %String(MAXLEN = 17, MINLEN = 0, XMLNAME = "CODE", XMLPROJECTION = "ATTRIBUTE"); ///      4.0      (  ) Property PLAINCODE As %String(MAXLEN = 15, MINLEN = 0, XMLNAME = "PLAINCODE", XMLPROJECTION = "ATTRIBUTE"); ///     .     .      . /// 0 ‚Äì   /// 1 -  Property ACTSTATUS As %Integer(XMLNAME = "ACTSTATUS", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///   Property CENTSTATUS As %Integer(XMLNAME = "CENTSTATUS", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///     ‚Äì    (.   OperationStatus): /// 01 ‚Äì ; /// 10 ‚Äì ; /// 20 ‚Äì ; /// 21 ‚Äì  ; /// 30 ‚Äì ; /// 31 -     ; /// 40 ‚Äì    (); /// 41 ‚Äì     ; /// 42 -        ; /// 43 -         ; /// 50 ‚Äì ; /// 51 ‚Äì     ; /// 60 ‚Äì    ; /// 61 ‚Äì        Property OPERSTATUS As %Integer(XMLNAME = "OPERSTATUS", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///    4 (    ) Property CURRSTATUS As %Integer(XMLNAME = "CURRSTATUS", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///    Property STARTDATE As %Date(XMLNAME = "STARTDATE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///    Property ENDDATE As %Date(XMLNAME = "ENDDATE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///      Property NORMDOC As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "NORMDOC", XMLPROJECTION = "ATTRIBUTE"); ///     Property LIVESTATUS As %xsd.byte(VALUELIST = ",0,1", XMLNAME = "LIVESTATUS", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///  : /// 0 -   /// 1 - ; /// 2 - - Property DIVTYPE As %xsd.int(VALUELIST = ",0,1,2", XMLNAME = "DIVTYPE", XMLPROJECTION = "ATTRIBUTE") [ Required ]; Relationship AddressObjects As Test.AddressObjects(XMLPROJECTION = "NONE") [ Cardinality = one, Inverse = Object ]; }</code> </pre> <br></div></div><br>  Dari seluruh daftar file xml di FIAS kami hanya akan menggunakan file dengan nama wilayah, kota, dan jalan.  Pada saat mempersiapkan publikasi, saya memiliki ini: <br>  AS_ADDROBJ_20190106_90809714-fe22-45b2-929c-52bd950963e0.XML <br><br>  Ukuran file tidak besar atau kecil, tetapi hampir 3 GB.  Anda tidak akan membukanya dengan alat teks biasa - mereka tidak mencerna ukuran ini. <br><blockquote>  By the way, panjang maksimum string literal (tipe String) di InterSystems IRIS tidak lebih dari 3.641.144 karakter.  Artinya, mengunduh file secara langsung atau URL ke dalamnya akan gagal.  Pembatasan lain dapat ditemukan <a href="">dalam dokumentasi</a> .  Untuk bekerja dengan volume data yang besar, Anda dapat menggunakan aliran data (stream) yang tidak memiliki batas panjang. </blockquote>  Mari kita lihat apa yang kita dapat? <br><br>  Memasak boneka lada FIAS.  Ini hanya persiapan untuk masa depan yang indah.  Pertama kita mendapatkan set minimum awal.  Kami hanya membutuhkan bahan-bahan ini: <br><br><pre> <code class="plaintext hljs">Class FIAS.AddressObject Extends (%Persistent, %XML.Adaptor) [ ProcedureBlock ] { Parameter XMLNAME = "Object"; Parameter XMLSEQUENCE = 1; ///      Property AOGUID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "AOGUID", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///   Property OFFNAME As %String(MAXLEN = 120, MINLEN = 1, XMLNAME = "OFFNAME", XMLPROJECTION = "ATTRIBUTE"); ///   Property POSTALCODE As %String(MAXLEN = 6, MINLEN = 6, XMLNAME = "POSTALCODE", XMLPROJECTION = "ATTRIBUTE"); ///     Property SHORTNAME As %String(MAXLEN = 10, MINLEN = 1, XMLNAME = "SHORTNAME", XMLPROJECTION = "ATTRIBUTE") [ Required ]; ///    Property AOLEVEL As %Integer(XMLNAME = "AOLEVEL", XMLPROJECTION = "ATTRIBUTE", XMLTotalDigits = 10) [ Required ]; ///     Property PARENTGUID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "PARENTGUID", XMLPROJECTION = "ATTRIBUTE"); ///   .  . Property AOID As %String(MAXLEN = 36, MINLEN = 36, XMLNAME = "AOID", XMLPROJECTION = "ATTRIBUTE") [ Required ];</code> </pre><br>  Selanjutnya, lakukan <a href="https://docs.intersystems.com/irislatest/csp/docbook/DocBook.UI.Page.cls?KEY=GXML_import#GXML_import_">penulisan</a> .  Kami membuat objek yang memahami XML sebagai asli - kami menggunakan kelas dari pustaka sistem% XML.Reader: <br><br><pre> <code class="plaintext hljs">set reader = ##class(%XML.Reader).%New()</code> </pre> <br>  Dan kami memberinya instruksi, siapa yang harus mengambil, dan mengabaikan sisanya.  Kami akan menerima satu porsi: <br><br><pre> <code class="plaintext hljs">do reader.Correlate("Object","FIAS.AddressObject")</code> </pre> <br>  Lalu ada variasi tentang cara mendapatkan file microbd asli.  Jika nyaman, Anda bisa meletakkannya di sebelah repositori - secara lokal di sistem file server IRIS.  Atau, seperti dalam contoh saya, minta kirim via HTTP.  Ada opsi yang bahkan lebih universal, yang akan ada beberapa kata di bawah ini. <br><br><pre> <code class="plaintext hljs">set url="http://localhost/AS_ADDROBJ_20190106_90809714-fe22-45b2-929c-52bd950963e0.XML" write reader.OpenUrl(url)</code> </pre> <br><blockquote>  Penting!  Pada saat ini, mayoritas yang akan memberikan contoh ini pada diri mereka sendiri akan memiliki hal yang mengerikan.  Sistem akan kembali sebagai ganti ‚Äú1‚Äù (semuanya beres), sesuatu yang dimulai dengan ‚Äú0 ¬∏ STORE ...‚Äù.  Dan itu tidak akan menyenangkan.  Artinya, file dengan microbase tampaknya tidak cukup mikro dan tidak cocok dengan objek kita.  Memori yang dialokasikan untuknya tidak cukup.  Dipecahkan?  Tentu saja  Platform data IRIS memungkinkan Anda membuat objek hingga 4 TB dalam RAM.  Lalu apa yang salah?  Secara default, pengaturan sistem diatur ke 256 MB per objek.  Dan kita akan membutuhkan lebih banyak lagi.  Dan ingat, ini adalah persyaratan RAM.  Apakah ada cukup stok di komputer / server Anda? </blockquote>  Berapa ukuran memori yang kita perlukan untuk menginstal raksasa ini yang telah kita instal secara empiris - hampir 10 GB.  Apa yang perlu Anda tentukan dalam pengaturan (Menu&gt; Konfigurasi memori&gt; Memori maksimum per proses (KB)) atau melalui <a href="">variabel sistem $ ZSTORAGE</a> (dalam kilobyte): <br><br><pre> <code class="plaintext hljs">set $ZSTORAGE=10000000</code> </pre> <br>  Meluncurkan proses baru dengan pengaturan memori yang diperlukan?  Kemudian semuanya menjadi lebih sederhana - kita membaca dan menyimpan. <br><br>  Ada opsi alternatif (dan mungkin lebih disukai) - <a href="">gunakan properti UsePPGHandler</a> dari kelas% XML.Reader yang memungkinkan Anda untuk tidak menyimpan XML dalam memori dan bekerja dengan pengaturan memori standar. <br><br><pre> <code class="plaintext hljs">set reader = ##class(%XML.Reader).%New() set reader.UsePPGHandler = 1</code> </pre> <br>  lebih lanjut ... Korelasi / Baca, dll.  ... <br><br><pre> <code class="plaintext hljs">do reader.Next(.object) do object.%Save()</code> </pre> <br>  Jadi 3.722.548 kali untuk setiap operasi :-) <br><br>  Ini melelahkan.  Oleh karena itu, kami menambah kelas FIAS.AddressObject kami dengan metode untuk impor, berdasarkan perintah yang baru saja ditampilkan: <br><br><pre> <code class="plaintext hljs">ClassMethod Import() { //     XML Set reader = ##class(%XML.Reader).%New() //   XML   Set status = reader.OpenURL("http://localhost/AS_ADDROBJ_20190106_90809714-fe22-45b2-929c-52bd950963e0.XML") If $$$ISERR(status) {Do $System.Status.DisplayError(status)} //       Do reader.Correlate("Object","FIAS.AddressObject") //       While (reader.Next(.object,.status)) { Set status = object.%Save() If $$$ISERR(status) {do $System.Status.DisplayError(status)} } //      ,   If $$$ISERR(status) {Do $System.Status.DisplayError(status)} }</code> </pre> <br>  Mari kita gunakan kekuatan exocortex komputer kita - hanya satu perintah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di terminal</a> : <br><br><pre> <code class="plaintext hljs">do ##class(FIAS.AddressObject).Import()</code> </pre> <br><img src="https://habrastorage.org/webt/bd/mh/t7/bdmht7k0urpyo07qcdcmkj5_nym.gif"><br><br>  Saya meminta semua orang ke meja.  Ada MCD, dan sekarang hidangan jadi dalam bentuk global dengan nama kota-kota Rusia yang terverifikasi dan bobot siap. <br><br><img src="https://habrastorage.org/webt/1u/he/a6/1uhea6bdexgrpwlfpmtn2b2gdyy.png"><br><br>  Dan akhirnya beberapa kata tentang kapan 4TB tidak cukup.  Dalam hal ini, <a href="">kami mengikuti aliran</a> (atau aliran jika Anda mau).  Dokumentasi diletakkan di rak.  Anda bisa biner, Anda bisa simbolis.  Toko di global juga tidak dilarang.  Resepnya adalah ini: kita mengambil aliran air, memotongnya menjadi beberapa bagian dan memberikannya kepada benda-benda yang kita butuhkan untuk konsumsi. <br><br>  Lebih lanjut, tentang objek ObjectScript yang indah dan API dialamatkan dengan Python tidak cocok.  Akan ada cerita tersendiri. <br><blockquote>  Menyenangkan: Gartner baru saja menyelesaikan koleksi tahunan penilaian dan ulasan pengguna nyata dalam kategori DBMS dan atas dasar ini telah menerbitkan peringkatnya tentang DBMS terbaik 2019.  InterSystems Cach√© dan InterSystems IRIS Data Platform produk telah menerima peringkat pilihan konsumen tertinggi.  Dari siapa yang Anda pilih dan cara Anda memberi peringkat, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Anda dapat melihatnya sendiri</a> . </blockquote>  Perangkat Lunak Sistem Manajemen Basis Data Operasional Terbaik 2019 yang diulas oleh Pelanggan <br><br><img src="https://habrastorage.org/webt/gw/jg/dd/gwjgdd1segqlvnnpfzgo9buww4y.png"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438062/">https://habr.com/ru/post/id438062/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438034/index.html">Android, Rx, dan Kotlin, atau cara membuat cakar Lego menyusut. Bagian 1</a></li>
<li><a href="../id438046/index.html">Bagaimana cara geocode sejuta poin pada Spark dengan cara cepat?</a></li>
<li><a href="../id438050/index.html">Filter Kalman untuk meminimalkan nilai entropi dari kesalahan acak dengan distribusi non-Gaussian</a></li>
<li><a href="../id438058/index.html">"Analisis Data dengan Python" dalam dua bagian</a></li>
<li><a href="../id438060/index.html">Estimasi orientasi spasial, atau Bagaimana tidak perlu takut dengan filter Mahoney dan Majwik</a></li>
<li><a href="../id438064/index.html">Daftar periksa: apa yang harus dilakukan sebelum menjalankan layanan microser di prod</a></li>
<li><a href="../id438066/index.html">10 saluran YouTube pendidikan dalam bahasa Inggris yang belum pernah Anda dengar</a></li>
<li><a href="../id438070/index.html">Bagaimana generasi Y berubah menjadi generasi yang terbakar?</a></li>
<li><a href="../id438074/index.html">[Pengumuman untuk Yekaterinburg, Novosibirsk, St. Petersburg] Sesi Tes Otomasi: Kami akan membahas tes dari Neva hingga Ob</a></li>
<li><a href="../id438078/index.html">Facebook membayar $ 20 per bulan untuk pengaturan pseudo-VPN-nya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>