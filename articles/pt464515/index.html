<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÇüèº üë©üèΩ üëó Como criar e-mails e n√£o bagun√ßar: dicas pr√°ticas ‚õπüèæ üàöÔ∏è üï§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Um desenvolvedor, que encontrou a gera√ß√£o de emails pela primeira vez, quase n√£o tem chance de escrever um aplicativo, que o far√° corretamente. Cerca ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como criar e-mails e n√£o bagun√ßar: dicas pr√°ticas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/464515/"><img src="https://habrastorage.org/webt/s8/cx/7x/s8cx7xzo0rsuk0xw3z25hbfcjke.png"><br><br>  Um desenvolvedor, que encontrou a gera√ß√£o de emails pela primeira vez, quase n√£o tem chance de escrever um aplicativo, que o far√° corretamente.  Cerca de 40% dos e-mails, gerados por aplicativos corporativos, est√£o violando alguma forma de padr√£o e, devido a isso, h√° problemas com a entrega e a exibi√ß√£o.  Existem raz√µes para isso: os e-mails s√£o tecnicamente mais dif√≠ceis que a Web, e os e-mails em opera√ß√£o s√£o regulados por algumas centenas de padr√µes, al√©m de um n√∫mero incont√°vel de pr√°ticas geralmente aceitas (e n√£o tanto), enquanto os clientes de e-mail s√£o mais variados. e imprevis√≠vel que navegadores.  Os testes podem melhorar significativamente a situa√ß√£o, mas os materiais dedicados ao teste do sistema de e-mail s√£o praticamente inexistentes. <br><br>  O Mail.ru interage regularmente com seus usu√°rios por email.  Em nossos projetos, todos os componentes respons√°veis ‚Äã‚Äãpor gerar emails e at√© correspond√™ncias individuais est√£o sujeitos a testes obrigat√≥rios.  Neste artigo, compartilharemos nossa experi√™ncia (aprendendo com nossos erros). <br><a name="habracut"></a><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Que tipo de e-mails existem?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Quem est√° envolvido no processo de teste e controle?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Correio e transporte de correio</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A interface da infraestrutura de email e os limites do aplicativo testado</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Defini√ß√£o dos par√¢metros de teste</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura t√≠pica de um aplicativo de gera√ß√£o</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O que e quando testar</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Infraestrutura de entrega</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerando aplicativo</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Modelos de email estruturais e tipogr√°ficos</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos b√°sicos para verificar a infraestrutura</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos de autentica√ß√£o</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Verifica√ß√£o do aplicativo de gera√ß√£o</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos para endere√ßos de email</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Endere√ßos de envelope</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Endere√ßos de cabe√ßalho de email</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos para cabe√ßalhos</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos para a estrutura do email</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos de URI</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Requisitos de layout de email</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Realiza√ß√£o de testes divididos</a> <br></li></ul><br><a name="1"></a><h2>  Que tipo de e-mails existem? </h2><br>  O aplicativo pode gerar v√°rios tipos de e-mails.  Eles podem ser classificados em v√°rias categorias.  Pelo m√©todo de sele√ß√£o de destinat√°rios - pessoal / acionado - grupo seletivo.  Com hora marcada: transa√ß√µes, marketing, servi√ßo.  Voc√™ pode definir requisitos diferentes para diferentes tipos de email e aplicar v√°rios cen√°rios de teste. <br><br>  Os emails pessoais acionados s√£o gerados em resposta a qualquer evento, por exemplo, a√ß√µes do usu√°rio ou altera√ß√µes de status dos objetos do sistema.  Eles s√£o gerados pelo aplicativo e, portanto, s√£o os mais interessantes em rela√ß√£o aos testes.  Os emails acionados podem ser transacionais, de marketing e para uso do servi√ßo.  Os emails seletivos s√£o enviados para uma sele√ß√£o din√¢mica de usu√°rios, que atendem a alguma forma de crit√©rio.  Os emails de grupo s√£o enviados para um grupo permanente de destinat√°rios, por exemplo, todos os usu√°rios ou parceiros.  Os e-mails seletivos e de grupo geralmente s√£o para uso em marketing, e o envio desses e-mails √© iniciado manualmente ou de acordo com a programa√ß√£o. <br><br>  Os emails transacionais s√£o gerados no processo de um usu√°rio concluir alguma forma de a√ß√£o.  Esses e-mails incluem, por exemplo, faturas, tickets ou notifica√ß√µes de status de entrega.  Os emails transacionais s√£o sempre acionados e destinam-se a transportar informa√ß√µes importantes.  Eles devem ser t√£o simples e compat√≠veis quanto poss√≠vel, e test√°-los em um grande n√∫mero de clientes de email. <br><br>  Os e-mails de marketing incentivam o usu√°rio a executar uma a√ß√£o, por exemplo, isso pode ser uma oferta para um desconto pessoal com base em compras anteriores.  Os dados transacionais podem ser utilizados nesses emails e podem ser disparados por email ou em massa, peri√≥dicamente ou uma vez.  Para esses e-mails, a efici√™ncia √© mais importante e os resultados do teste de divis√£o geralmente a determinam.  Alguns aspectos da compatibilidade podem ser sacrificados por efici√™ncia. <br><br>  Os e-mails de marketing de grupo, por exemplo, mensagens sobre ofertas sazonais, promo√ß√µes e vendas, geralmente s√£o enviados 'manualmente' e n√£o fazem parte do seu aplicativo, mas voc√™ pode (e deve) tamb√©m aplicar princ√≠pios gerais de teste a eles. <br><br>  Al√©m disso, pode haver e-mails de servi√ßo: notifica√ß√µes geradas para a equipe, para sistemas automatizados de CRM, registro no di√°rio, auditoria ou DWH.  Esses e-mails geralmente s√£o acionados, o que significa que eles tamb√©m fazem parte do aplicativo e devem ser testados. <br><br><a name="2"></a><h2>  Quem est√° envolvido no processo de teste e controle? </h2><br><ol><li> Engenheiro de controle de qualidade - participa de todas as etapas do processo. <br></li><li>  Engenheiro de rede - respons√°vel por configurar a infraestrutura de rede e a infraestrutura de entrega de mensagens.  O engenheiro de rede deve estar envolvido no planejamento e nos testes de infraestrutura. <br></li><li>  Especialista em entrega - pessoa que monitora a capacidade de entrega de emails, que tamb√©m participa do monitoramento dos par√¢metros t√©cnicos e administrativos de todos os emails enviados e monitora o andamento do processo de correspond√™ncia.  Ele √© respons√°vel por garantir que os emails enviados atinjam a maior porcentagem de usu√°rios e n√£o acabem em spam.  Para esse fim, o especialista deve ter conhecimentos e contatos espec√≠ficos.  Se houver algum problema com a entrega de emails, √© ele quem deve entender a causa prov√°vel e elimin√°-la;  seja eliminando obst√°culos t√©cnicos;  ou alterar algo no conte√∫do dos e-mails;  ou tente resolver o problema com o servi√ßo de suporte do provedor de email, ao qual os emails n√£o chegam.  Esse especialista (se houver) tamb√©m deve estar envolvido na elabora√ß√£o da lista de verifica√ß√£o e no teste de infraestrutura que gera aplicativos e e-mails.  No entanto, o pr√≥prio processo de teste deve estar sob o controle do servi√ßo de controle de qualidade. <br></li><li>  Email-marketer - determina a efic√°cia dos boletins de marketing.  Sob seu controle, ocorre o teste dividido para a distribui√ß√£o do marketing ao p√∫blico.  O profissional de marketing por email tamb√©m controla a segmenta√ß√£o da base de usu√°rios, a composi√ß√£o e a frequ√™ncia dos emails enviados, a 'apresenta√ß√£o' visual do email ao usu√°rio. <br></li></ol><br>  Todas essas fun√ß√µes n√£o s√£o necessariamente desempenhadas por um funcion√°rio dedicado;  o papel do profissional de marketing pode ser desempenhado por um dos gerentes de produto, e o papel do especialista em entregas, por exemplo, pode ser desempenhado por um funcion√°rio de suporte ou por um engenheiro de rede.  Nas empresas iniciantes, √© altamente prov√°vel que tudo isso tenha que ser tratado por uma pessoa, e eles podem se tornar um especialista em qualidade. <br><br><a name="3"></a><h2>  Correio e transporte de correio </h2><br>  A estrutura de email √© como um enorme iceberg, e existem dois n√≠veis nela.  Existem mais de uma centena de padr√µes diferentes que regem os emails, mas quase todos pertencem a um desses dois n√≠veis: <br><br>  <b>A parte subaqu√°tica de um</b> servi√ßo de rede de <b>iceberg</b> , cujo protocolo b√°sico √© o protocolo de aplicativo SMTP definido pela RFC 5321. √â respons√°vel pela entrega de emails.  Um chamado envelope SMTP √© formado para a entrega do email, que inclui os endere√ßos do remetente e do destinat√°rio do n√≠vel SMTP.  Outros servi√ßos de rede, como DNS, tamb√©m s√£o respons√°veis ‚Äã‚Äãpela entrega do email.  O principal componente da infraestrutura de rede √© o Mail Transfer Agent (MTA).  O MTA √© respons√°vel por entregar a fila de entrega de mensagens e o pr√≥prio processo de entrega aos servidores destinat√°rios.  Exemplos de MTA incluem Postfix, Sendmail, Exim, servi√ßo SMTP da Microsoft. <br><br>  Nesta parte subaqu√°tica do iceberg, que inclui os par√¢metros MTA, DNS e outros par√¢metros de rede, chamaremos a infraestrutura de email ou a infraestrutura de entrega de mensagens. <br><br>  <b>A ponta do iceberg</b> - o pr√≥prio email.  A estrutura b√°sica do email √© definida pelo padr√£o RFC 5322. O email consiste em cabe√ßalhos de servi√ßo e uma ou mais partes de dados.  Os dados podem estar em formato de texto sem formata√ß√£o e / ou HTML ou mesmo AMP, com imagens ou anexos embutidos de quase qualquer tipo. <br><br><a name="4"></a><h2>  A interface da infraestrutura de email e os limites do aplicativo testado </h2><br>  A infraestrutura de email, como regra, possui uma ou v√°rias interfaces pelas quais um email √© enviado (quando entra na fila de entrega do MTA).  Por exemplo, o servi√ßo SMTP Submission, a fun√ß√£o <code>mail()</code> em PHP, transfer√™ncia de dados para um aplicativo de email ou sendmail externo, API para servi√ßo interno ou externo (como GetResponse, SendPulse ou Amazon SES).  Vamos considerar essas interfaces como parte da infraestrutura.  Muitas vezes acontece que o Aplicativo A prepara dados para um email e uma lista de destinat√°rios e os envia para o Aplicativo B por meio de sua API (para mala direta em massa, isso pode ser feito manualmente via interface do usu√°rio), e o aplicativo B gera uma mensagem de email no RFC 5322 e a entrega ao MTA.  Para o aplicativo A (e ao test√°-lo), o aplicativo B far√° parte da infraestrutura de email.  A API ou interface do usu√°rio do aplicativo B ser√° para a interface do aplicativo A da infraestrutura de email.  Embora para o Aplicativo B, a situa√ß√£o seja diferente e a infraestrutura de correio para ele seja aplicativos ou protocolos de rede de n√≠vel inferior. <br><br><a name="5"></a><h2>  Defini√ß√£o dos par√¢metros de teste </h2><br>  Ao testar cada aplicativo, √© importante selecionar todas as infraestruturas de correio usadas por ele (pode haver v√°rias) e para cada infraestrutura destacar as interfaces usadas (tamb√©m pode haver v√°rias delas para cada infraestrutura).  Para cada interface, a composi√ß√£o e o formato dos dados transmitidos s√£o determinados com a maior precis√£o poss√≠vel, por exemplo, texto de email em TEXT / HTML, texto de email em TEXT / PLAIN, assunto do email, nome do destinat√°rio, endere√ßo do destinat√°rio, nome do remetente, endere√ßo do remetente (RFC5321.From), o endere√ßo do remetente do convector SMTP (RFC5322.mailfrom).  Em seguida, um conjunto de requisitos √© desenvolvido para cada par√¢metro (representa√ß√µes, codifica√ß√µes, valores-limite etc.), s√£o determinados m√©todos para monitorar cada um dos par√¢metros (como comparar o resultado real com o esperado). <br><br><a name="6"></a><h2>  Estrutura t√≠pica de um aplicativo de gera√ß√£o </h2><br>  Como regra, o mesmo produto que estamos testando √© respons√°vel pela gera√ß√£o de e-mails e dados nele.  Geralmente, esse √© um aplicativo de servidor (mas √†s vezes cliente).  Ele define a estrutura do email, parte dos cabe√ßalhos de servi√ßo, formatos de encapsulamento de dados, representa√ß√µes de string e codifica√ß√£o de texto.  Um exemplo simples desse aplicativo √© o script que forma o email e chama a fun√ß√£o <code>mail()</code> .  Os principais elementos do aplicativo que devem ser controlados s√£o: <br><br><ul><li>  o c√≥digo respons√°vel pela gera√ß√£o de cabe√ßalhos e / ou estrutura de email, se a estrutura de email for gerada dinamicamente, e / ou modelos de email est√°ticos descrevendo sua estrutura; <br></li><li>  Layout HTML do email (idealmente, √© uma entidade ou parte separada do modelo / layout do email, mas pode ser incorporado no c√≥digo do aplicativo); <br></li><li>  substitui√ß√£o de dados do aplicativo em um email (ou em um modelo de email); <br></li><li>  integra√ß√£o do aplicativo com a infraestrutura de entrega de email, a corre√ß√£o dos par√¢metros passados ‚Äã‚Äãpara a interface da infraestrutura. <br></li></ul><br><a name="7"></a><h2>  O que e quando testar </h2><br>  Quer gostemos ou n√£o, todo o iceberg deve ser testado.  Existem v√°rios componentes principais que requerem testes: <br><br><a name="8"></a><h4>  Infraestrutura de entrega </h4><br>  A √™nfase no teste deve ser feita em: capacidade de entrega do email;  registros DNS corretos, incluindo registros PTR / FCrDNS, MX e A;  Par√¢metros de protocolo SMTP (HELO, use TLS);  autoriza√ß√£o de email (SPF / DKIM / DMARC);  Endere√ßos de envelope SMTP (se o aplicativo n√£o os gerenciar);  corre√ß√£o do processamento dos par√¢metros de entrada da interface de infraestrutura;  rastreamento, grava√ß√£o e processamento de e-mails n√£o entregues. <br><br>  √â necess√°rio testar a infraestrutura durante a implementa√ß√£o inicial e sempre que forem feitas altera√ß√µes na pr√≥pria infraestrutura (a configura√ß√£o do MTA, DNS ou altera√ß√µes na rede) ou na interface para enviar um email;  usando um novo dom√≠nio, rede ou API;  testes adicionais s√£o necess√°rios se as caracter√≠sticas dos e-mails enviados, como idioma, tamanho ou n√∫mero forem alteradas significativamente.  Segundo a experi√™ncia, a infraestrutura tende a mudar "por si mesma", portanto testes b√°sicos devem ser realizados periodicamente, mesmo se n√£o houver informa√ß√µes sobre altera√ß√µes. <br><br>  √â poss√≠vel e necess√°rio envolver o engenheiro de rede e o especialista em entregabilidade na elabora√ß√£o do plano e nas listas de verifica√ß√£o para testar a infraestrutura. <br><br><a name="9"></a><h4>  Gerando aplicativo </h4><br>  Os endere√ßos do envelope SMTP devem ser monitorados (se o aplicativo os controlar, ou seja, eles s√£o transferidos para a interface - envelope de, envelope para), os valores dos cabe√ßalhos de servi√ßo do email (Data, Mensagem -ID, Cancelar inscri√ß√£o em lista, Submetido automaticamente etc.).  Cl√°usula), autoriza√ß√£o de email (DKIM / DMARC), codifica√ß√£o MIME (base64, impress√£o entre aspas), corre√ß√£o geral do formato do email, por exemplo, aus√™ncia de caracteres n√£o ASCII nos cabe√ßalhos, composi√ß√£o dos dados injetados , o acionamento correto de acionadores, mecanismos de cancelamento de inscri√ß√£o, mecanismos de rastreamento para grava√ß√£o e coleta de estat√≠sticas (cabe√ßalhos do postmaster, por exemplo, ID do Feedback ou X-Mailru-Msgtype, al√©m de pixels de rastreamento). <br><br>  √â necess√°rio testar um aplicativo durante seu desenvolvimento, quando todos os seus componentes relacionados s√£o respons√°veis ‚Äã‚Äãpor gerar e armazenar altera√ß√µes de dados, com altera√ß√µes significativas nos modelos de email, ao alterar a infraestrutura ou interface usada, bem como dentro da estrutura do regress√µes gerais. <br><br><a name="10"></a><h4>  Modelos de email estruturais e tipogr√°ficos (podem fazer parte de um aplicativo de gera√ß√£o ou s√£o desenvolvidos separadamente) </h4><br>  A estrutura do email √© verificada (Tipo de Conte√∫do, Disposi√ß√£o de Conte√∫do, aninhamento de partes com v√°rias partes do email, codifica√ß√£o de texto, par√¢metros de sequ√™ncia), o valor do destino e os cabe√ßalhos exibidos (De, Para, Responder a, Assunto ), a maneira como o email √© exibido na lista de emails e ao ler em v√°rias interfaces, microformatos (por exemplo, que um evento do calend√°rio √© reconhecido como um evento do calend√°rio ou um bilhete a√©reo como um bilhete a√©reo), marca. <br><br>  Os modelos de email devem ser testados toda vez que voc√™ fizer pelo menos as menores altera√ß√µes, bem como separadamente, por exemplo, em uma situa√ß√£o em que os emails entram no aplicativo antes que a parte do servidor esteja pronta. <br><br>  √â recomend√°vel envolver um especialista em marketing por email e um especialista em entregabilidade para compilar uma lista de verifica√ß√£o para testar um modelo de email. <br><br><a name="11"></a><h4>  Requisitos b√°sicos para verificar a infraestrutura </h4><br>  O endere√ßo IP selecionado para o servidor de email deve estar o mais pr√≥ximo poss√≠vel do endere√ßo IP do servidor de email.  √â recomend√°vel verificar usando o utilit√°rio whois.  Em particular, o endere√ßo do remetente n√£o deve pertencer √† rede, que pode ser percebida como din√¢mica;  a rede selecionada deve ter contatos ativos para os quais as reclama√ß√µes podem ser enviadas;  a rede deve ser usada (com o status ASSIGNED in RIPE) O endere√ßo IP deve ter um registro PTR configurado corretamente.  Ele pode ser configurado de forma independente atrav√©s do painel de controle de hospedagem ou com a ajuda do provedor de servi√ßos.  Um registro PTR deve apontar para o nome do host real e ainda ser significativo, resolvido de volta para o mesmo endere√ßo IP (chamada verifica√ß√£o FCrDNS), n√£o lembrar o nome do host din√¢mico e n√£o incluir um grande grupo de n√∫meros ou caracteres.  Um bom exemplo √© mailserver.example.com. <br><br>  Cada dom√≠nio usado em endere√ßos de envelope ou cabe√ßalhos de email deve ter um registro MX v√°lido apontando para um registro do host A, que, no m√≠nimo, pode lidar com mensagens n√£o entregues.  MX n√£o tem permiss√£o para se referir diretamente a um endere√ßo IP. <br><br>  Controlar a passagem de SPF, DKIM, DMARC.  O SPF permite que o propriet√°rio do dom√≠nio especifique nos registros TXT uma lista de servidores autorizados a enviar e-mails com endere√ßos de retorno nesse dom√≠nio.  Ele est√° configurado para o endere√ßo usado no envelope de (envelope SMTP) na se√ß√£o de gerenciamento de zonas DNS do dom√≠nio.  O DKIM fornece a verifica√ß√£o da autoria de uma mensagem ou de seu originador para um dom√≠nio espec√≠fico usando tecnologias de assinatura digital, que s√£o adicionadas ao pr√≥prio email (no cabe√ßalho DKIM-Signature).  Normalmente, uma assinatura DKIM √© configurada no n√≠vel MTA (infraestrutura).  O DMARC define a pol√≠tica de verificar emails recebidos em um dom√≠nio espec√≠fico e a√ß√µes em emails que n√£o passam na autentica√ß√£o SPF ou DKIM.  Ao tentar violar essa pol√≠tica, um relat√≥rio estruturado √© fornecido com informa√ß√µes sobre essa tentativa.  O DMARC, assim como o SPF, √© publicado como um registro TXT na zona do dom√≠nio. <br><br>  Verifique a capacidade de entrega de e-mails para os principais servi√ßos postais - para R√∫ssia Mail.Ru, Yandex, Gmail, Microsoft (Hotmail / Outlook.com / Office365), Rambler, nic.ru.  Nos e-mails recebidos, voc√™ precisa verificar a exatid√£o do HELO;  a presen√ßa e aprova√ß√£o de cheques PTR / FCrDNS, SPF, DKIM e DMARC;  a validade dos cabe√ßalhos e dados neles, em particular, o sincronismo do rel√≥gio nas datas e a exatid√£o dos fusos hor√°rios. <br><br><img src="https://habrastorage.org/webt/dg/kr/ml/dgkrmlpmq_rsds5zu40kwxuqz1o.png"><br>  (O correio de registro quebrou a autentica√ß√£o devido ao endere√ßo de correio livre usado) <br><br>  A forma√ß√£o de alguns par√¢metros, por exemplo, autoriza√ß√£o, capacidade de entrega e spam, √© integralmente influenciada por todos os componentes, mas, para seu controle, geralmente existem ferramentas operacionais separadas - relat√≥rios DMARC e FBL, API de servi√ßos de postmaster, ferramentas de rastreamento de e-mail, estat√≠sticas de entrega.  Os testes devem levar em considera√ß√£o o n√≠vel de implementa√ß√£o das ferramentas de monitoramento operacional na empresa - por exemplo, na aus√™ncia de controle operacional dos relat√≥rios DMARC, a autoriza√ß√£o de e-mails deve ser testada regularmente, enquanto na aus√™ncia de controle operacional da entregabilidade, onde e como os emails v√£o, mesmo se n√£o houver desenvolvimento relacionado ao envio de emails. <br><br>  Para testar a infraestrutura, voc√™ pode usar servi√ßos especializados, por exemplo, mail-tester.com, mxtoolbox.com.  Requisitos detalhados de infraestrutura podem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ser encontrados neste artigo</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dab/868/c01/dab868c01fb1de36df5259aba785e92f.png"><br>  (um exemplo do registro SPF quebrado) <br><br><a name="12"></a><h2>  Requisitos de autentica√ß√£o </h2><br>  A verifica√ß√£o da passagem de SPF, DKIM, DMARC geralmente √© poss√≠vel usando o cabe√ßalho Resultados da autentica√ß√£o no servidor do destinat√°rio. <br><br>  Verifique a validade do registro SPF quanto √† sintaxe, o limite para consultas DNS (por exemplo, usando mxtoolbox.com).  Ao formar um SPF, todas as fontes de correspond√™ncia devem ser levadas em considera√ß√£o (n√£o se esque√ßa dos sistemas de CRM, todas as infraestruturas de entrega atualmente utilizadas, incluindo aquelas atrav√©s das quais s√£o realizadas campanhas de marketing √∫nicas).  √â recomend√°vel definir servidores permitidos para o dom√≠nio atrav√©s da lista de redes ('ip4' / 'ip6').  O SPF √© verificado quanto ao endere√ßo do remetente no envelope SMTP.  Verifique se o dom√≠nio do envelope SMTP (envelope-de) corresponde ao dom√≠nio do cabe√ßalho De.  Erros comuns de SPF est√£o listados neste artigo (https://medium.com/hackernoon/myths-and-legends-of-spf-d17919a9e817). <br><br>  Verifique o registro DNS do DKIM, a validade e a composi√ß√£o da assinatura DKIM.  Verifique se voc√™ est√° usando uma chave DKIM de pelo menos 1024 bits.  Modo hash recomendado de assinatura DKIM: relaxado / relaxado.  Verifique se todos os cabe√ßalhos importantes est√£o assinados (de, at√©, assunto, data, ID da mensagem, vers√£o MIME, tipo de conte√∫do), se os cabe√ßalhos de rastreamento (Recebido, Entregue a, Caminho de Retorno) n√£o est√£o assinados e DKIM √© validado para servi√ßos b√°sicos de correio.  Configure o encaminhamento para um dos servi√ßos de correio para outro;  O DKIM n√£o deve "bater" nos emails encaminhados.  Verifique se o dom√≠nio de assinatura DKIM corresponde ao dom√≠nio do remetente no cabe√ßalho 'De'. <br><br>  Verifique o DMARC para obter servi√ßos b√°sicos de email.  Verifique se h√° relat√≥rios DMARC, identifique e solucione problemas de SPF e DKIM para todos os endere√ßos IP da sua infraestrutura. <br><br>  Verifique se as mensagens s√£o entregues aos servidores externos usando criptografia (TLS).  √Äs vezes, voc√™ pode procurar TLS pelo cabe√ßalho Recebido no servidor do destinat√°rio: por exemplo, especificando o protocolo ESMTPS ou tendo par√¢metros do formul√°rio (vers√£o = cifra TLS1_2 = bits ECDHE-RSA-AES128-GCM-SHA256 = 128/128);  indica a presen√ßa de TLS. <br><br><a name="13"></a><h2>  Verifica√ß√£o do aplicativo de gera√ß√£o </h2><br><a name="14"></a><h3>  Requisitos de endere√ßo de email </h3><br><a name="15"></a><h4>  Endere√ßos de envelope </h4><br>  Iniciamos a verifica√ß√£o do aplicativo de gera√ß√£o com os endere√ßos no envelope SMTP. <br>  Endere√ßos de envelope s√£o endere√ßos do n√≠vel de infraestrutura de email.  Eles n√£o s√£o vis√≠veis para o usu√°rio, mas s√£o importantes para entrega porque o endere√ßo do envelope determina em qual caixa de correio o email entra. <br><br>  <i>O endere√ßo do destinat√°rio no envelope</i> ( <code>envelope-to</code> , tamb√©m conhecido como <code>RCPT TO:</code> √© o endere√ßo para o qual o email ser√° realmente entregue. <br><br><ul><li>  para todos os emails, exceto o registro, o endere√ßo deve ser legalmente assinado e validado para envio, de acordo com os requisitos administrativos. <br></li><li>  para boletins informativos, o endere√ßo deve ser "ativo", os endere√ßos para os quais o email n√£o pode ser entregue regularmente devem ser marcados como inativos; as correspond√™ncias para eles n√£o devem ser feitas.  Mas algumas categorias de e-mails (por exemplo, recupera√ß√£o de acesso) tamb√©m podem precisar ser enviadas para endere√ßos marcados anteriormente como inativos. <br></li></ul><br>  <i>Endere√ßo do remetente em um envelope SMTP</i> (geralmente chamado <code>envelope-from</code> , <code>smtp.mailfrom</code> , <code>MAIL FROM:</code> ou <code>Return-Path</code> ) - as mensagens ser√£o entregues neste endere√ßo sobre a incapacidade de enviar um email e respostas autom√°ticas.  Este endere√ßo n√£o √© vis√≠vel para o usu√°rio.  Este endere√ßo tamb√©m √© usado para autoriza√ß√£o do SPF.  Verificamos que: <br><br><ul><li>  O endere√ßo est√° dispon√≠vel; <br></li><li>  N√£o √© o endere√ßo do funcion√°rio e n√£o √© redirecionado a ele para excluir respostas autom√°ticas, mensagens sobre inacessibilidade, etc; <br></li><li>  √â processado por um script que marcar√° os endere√ßos de usu√°rios inacess√≠veis como inativos; <br></li><li>  O endere√ßo pode ser gerado automaticamente, ou seja, exclusivo para cada email; <br></li><li>  Um email para esse endere√ßo n√£o deve levar √† gera√ß√£o de nenhum email de resposta, por exemplo, uma mensagem sobre um estouro de caixa de correio. <br></li></ul><br><a name="16"></a><h4>  Endere√ßos de cabe√ßalho de email </h4><br>  Esses endere√ßos s√£o diretamente vis√≠veis ao usu√°rio ou s√£o usados ‚Äã‚Äãao responder a um email. <br>  Endere√ßo do remetente (o cabe√ßalho <code>From:</code> √© o endere√ßo e o nome do remetente exibidos na lista de emails e ao ler um email.  Verificamos que: <br><br><ul><li>  Este √© um endere√ßo amig√°vel leg√≠vel por humanos que identifica a empresa. <br></li><li>  Ele cont√©m n√£o apenas um endere√ßo de email, mas tamb√©m o nome do remetente. <br></li><li>  Noreply @ √© poss√≠vel, mas somente se quisermos enfatizar que n√£o esperamos receber uma resposta ao email e ele n√£o ser√° lido.  √â melhor duplicar essa ideia no texto do email. <br></li><li>  Na presen√ßa de caracteres n√£o ASCII (por exemplo, cir√≠lico), o nome do remetente deve ser codificado de acordo com MIME, o dom√≠nio na presen√ßa de caracteres n√£o ASCII deve ser codificado no Punycode <br></li><li>  E-mails da mesma categoria devem ter o mesmo endere√ßo;  o uso de endere√ßos gerados automaticamente deve ser evitado.  Isso se deve ao fato de que 'De:' √© mais frequentemente usado pelas pessoas para classificar emails por pastas usando filtros. <br></li><li>  O endere√ßo deve ser diferente (de prefer√™ncia em subdom√≠nios diferentes) para emails transacionais, de marketing e urgentes (como emails do servi√ßo de suporte).  Isso tamb√©m se deve ao fato de o usu√°rio poder marcar e-mails de marketing como spam ou filtr√°-los em uma pasta ileg√≠vel. <br></li><li>  O endere√ßo <code>From:</code> e o endere√ßo do envelope SMTP devem estar no mesmo dom√≠nio ou subdom√≠nios do mesmo dom√≠nio organizacional para transmitir o SPF no DMARC. <br></li><li>  O endere√ßo deve ser do dom√≠nio da organiza√ß√£o.  √â inaceit√°vel usar servi√ßos de correio gratuitos e outros dom√≠nios p√∫blicos em <code>From:</code> pois essas correspond√™ncias n√£o passam na autentica√ß√£o SPF e DKIM na estrutura do DMARC. <br></li></ul><br>  O endere√ßo <code>Reply-to</code> - respostas 'manuais' ser√° enviado para este endere√ßo quando um usu√°rio responder a um email.  √â opcional  Se estiver ausente, o endere√ßo de 'De:' √© usado para a resposta.  Verifique se 'Responder para': <br><br><ul><li>  Pode ser gerado automaticamente, ou seja, exclusivo para o email (permite descobrir em qual email a resposta veio). <br></li><li>  N√£o deve cair na caixa de correio do funcion√°rio para evitar a resposta autom√°tica, mas, idealmente, deve ser "empacotado" no CRM. <br></li><li>  Ele pode gerar uma resposta autom√°tica padr√£o do CRM, mas n√£o deve gerar nada sup√©rfluo, por exemplo, estouro de caixa de correio ou mensagens "sob voca√ß√£o".  Ao gerar respostas autom√°ticas, devem ser tomadas medidas para evitar loop, elas s√£o listadas na RFC 3834. <br></li><li>  Pode ser de qualquer dom√≠nio que n√£o necessariamente coincida com 'De:', mas √†s vezes isso assusta os usu√°rios ao responder. <br></li><li>  Pode estar ausente, o endere√ßo <code>From:</code> executa suas fun√ß√µes. <br></li><li>  Al√©m do endere√ßo, o nome do remetente √© indicado. <br></li></ul><br>  O endere√ßo <code>To:</code> <br><br><ul><li>  Deve conter o email do destinat√°rio (caso contr√°rio, assusta o destinat√°rio da mensagem e incomoda o anti-spam). <br></li><li>  Idealmente, deve conter o nome do destinat√°rio.  Mas se o nome for desconhecido ou duvidoso (por exemplo, o endere√ßo ainda n√£o foi confirmado), √© melhor n√£o indic√°-lo (algu√©m pode inserir o endere√ßo de outra pessoa com um nome ruim e o destinat√°rio pode ficar ofendido). <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/aab/7da/212/aab7da2120c8351588fcd4ea0e126a6c.png"><br><br><a name="17"></a><h3>  Requisitos de cabe√ßalho de email </h3><br>  A codifica√ß√£o real do texto deve corresponder √† indicada no cabe√ßalho.  √â aconselh√°vel usar uma codifica√ß√£o em todos os cabe√ßalhos e partes do email.  √â recomend√°vel que voc√™ use o UTF-8 como um amplamente suportado.  A codifica√ß√£o √© indicada nos cabe√ßalhos do tipo de conte√∫do e na tag da parte HTML. <br><br>  Os cabe√ßalhos De:, Message-ID: e Date: devem ser formados diretamente no script para enviar o email (e por padr√µes - junto com o texto do email) e sempre no formato correto.  Se eles estiverem ausentes ou incorretamente formados, um dos servidores de tr√¢nsito poder√° adicionar esses cabe√ßalhos, o que levar√° a uma viola√ß√£o da integridade da assinatura DKIM. <br><br>  Caracteres de 8 bits nos cabe√ßalhos, incluindo a linha de assunto (Assunto) e os nomes dos arquivos anexados (Tipo de conte√∫do e Disposi√ß√£o de conte√∫do), devem estar ausentes;  Todos os caracteres n√£o ASCII, incluindo cir√≠lico, devem ser codificados em citado-imprim√≠vel ou base64. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e25/bc4/a54/e25bc4a54a84fffce6f28d01cf3542f9.png"><br>  (confirma√ß√£o de registro em codifica√ß√£o estranha) <br><br><a name="18"></a><h3>  Requisitos para a estrutura do email </h3><br>  Para a parte HTML do email, √© desej√°vel formar uma parte alternativa - texto (sem formata√ß√£o).  Tamb√©m √© necess√°rio verificar a conformidade e a legibilidade da parte do texto sem formata√ß√£o do email (se houver) e a estrutura geral do email. <br><br>  De acordo com a RFC 5322, o comprimento de uma linha em um email n√£o deve exceder 998 caracteres de 8 bits.  Observe que em UTF-8, um personagem pode ocupar v√°rios octetos.  O terminador de linhas em um email √© um par de CRLF (ascii 13, ascii 10), que leva 2 octetos.  Voc√™ precisa verificar a exatid√£o do terminador de strings, j√° que os e-mails geralmente s√£o enviados usando um script Unix e, no Unix, o terminador de strings √© um caractere √∫nico - √© um erro para o e-mail.  Voc√™ tamb√©m deve verificar se os terminadores de string quebram caracteres codificados em UTF-8: n√£o √© poss√≠vel permitir a presen√ßa de um terminador de string entre dois octetos do mesmo caractere, por exemplo, s√≠mbolo cir√≠lico.  Para evitar tais situa√ß√µes, √© necess√°rio interromper o texto antes de formar o email ou codificar o texto em base64, base64 geralmente possui comprimento de linha fixo. <br><br>  √â necess√°rio verificar a marca√ß√£o correta de anexos e inline - ou seja, a corre√ß√£o da forma√ß√£o dos cabe√ßalhos "Content-Disposition: inline", se for uma imagem exibida dentro do email, ou "Content-Disposition: attachment" se o arquivo anexado se destina ao download. <br><br>  A estrutura do email deve ser a mais simples poss√≠vel: em particular, n√£o deve haver mais de uma parte com v√°rias partes de cada tipo (mista, alternativa, relacionada), e a multipart / mista ser√° usada apenas se o email contiver anexos de arquivo, multipartes / related - se o HTML vier com imagens embutidas, multipart / alternativo - na presen√ßa de texto sem formata√ß√£o e partes HTML.  Em geral, a estrutura do email, na aus√™ncia de anexos e imagens embutidas, deve ficar assim: <br><br>  multipart / alternativa <br>  - texto / simples <br>  - texto / html <br><br>  A ordem das partes √© importante, o texto / plan√≠cie deve ir ANTES do texto / html ou multipart / relacionado.  Isso √© necess√°rio para que a parte HTML seja exibida por padr√£o e somente se sua exibi√ß√£o estiver indispon√≠vel por algum motivo, a parte simples ser√° exibida. <br><br>  Se houver imagens embutidas no email, sua estrutura deve ficar assim: <br><br>  multipart / alternativa <br>  - texto / simples <br>  - multipart / relacionado <br>  - texto / html <br>  ‚Äî‚Äî imagem / ... (imagem embutida) <br>  ‚Äî‚Äî imagem / ... (imagem embutida) <br><br>  As imagens embutidas devem ter Disposi√ß√£o de Conte√∫do: embutida e estar estritamente dentro da parte multipart / relacionada. <br>  No caso mais dif√≠cil, quando h√° imagens embutidas e arquivos anexados, o email tem a seguinte estrutura: <br><br>  multipart / misto <br>  - multipart / alternativa <br>  - texto / simples <br>  - multipart / relacionado <br>  Texto / html <br>  ‚Äî‚Äî‚Äî image / png <br>  ‚Äî‚Äî‚Äî image / png <br>  ... <br>  - application / octet-string (disposi√ß√£o do conte√∫do: anexo) <br>  - application / octet-string (disposi√ß√£o do conte√∫do: anexo) <br>  ... <br>  as pe√ßas relacionadas e multipartes e multipartes / alternativas devem ser fechadas antes dos anexos; os anexos pertencem √† pe√ßa multipart / mista externa <br><br><img src="https://habrastorage.org/getpro/habr/post_images/944/23a/506/94423a506f8f81b02314ff4dc8d76385.png"><br>  (mensagem de registro com estrutura de pe√ßas incorreta) <br><br><a name="19"></a><h2>  Requisitos de URI </h2><br><br>  Quaisquer URIs (em src, atributos href, estilos etc.) devem conter o protocolo e o nome do host (https://example.com/somepath).  Erros t√≠picos s√£o o uso de links relativos (/ somepath) e a falta de um protocolo (//example.com/somepath), o que √© inaceit√°vel para emails, porque neles, o protocolo padr√£o pode ser <code>file://</code> . <br><br><ul><li>  Qualquer servi√ßo e caracteres n√£o ASCII (em particular, cir√≠lico) no URI devem ser codificados usando a porcentagem de codifica√ß√£o. <br></li><li>  Um link inserido como texto (ou seja, vis√≠vel para o usu√°rio como um URL e n√£o como um peda√ßo de texto) ainda deve ser marcado com a tag <code>&lt;&gt;</code> , caso contr√°rio, o usu√°rio n√£o poder√° clicar nele.  Alguns webmails marcam esses links por conta pr√≥pria, mas esse n√£o √© um comportamento padr√£o.  Nesse caso, o endere√ßo href dentro de A deve corresponder ao texto do link; caso contr√°rio, o filtro de conte√∫do pode reagir a um link como uma tentativa de enganar o usu√°rio.  Isso vale especialmente a pena prestar aten√ß√£o quando h√° "clickers" que rastreiam as transi√ß√µes do usu√°rio a partir do email. <br></li><li>  √â melhor limitar-se ao uso dos protocolos <code>http://</code> , <code>https://</code> e <code>mailto:</code> <br></li><li>  Com requisitos de alta seguran√ßa, voc√™ deve abandonar completamente o uso de <code>http://</code> em favor de <code>https://</code> . <br></li><li>  Portas n√£o padr√£o n√£o devem ser usadas (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">example.com</a> : 8080 / somepath), pois podem n√£o estar acess√≠veis ao usu√°rio. <br></li><li>  Clicar no link dentro da parte HTML n√£o deve levar a altera√ß√µes no estado do aplicativo (assinatura, cancelamento de inscri√ß√£o, cancelamento do pedido etc.) sem confirma√ß√£o adicional do usu√°rio na p√°gina, porque alguns sistemas de filtragem de conte√∫do podem independentemente verifique a seguran√ßa de uma transi√ß√£o solicitando uma p√°gina por refer√™ncia;  o aplicativo de email pode mostrar a visualiza√ß√£o da p√°gina pelo link ao passar o mouse e os navegadores modernos podem carregar a p√°gina antes que o usu√°rio clique no link para reduzir o tempo de carregamento (no aplicativo da Web geralmente n√£o √© recomend√°vel executar a√ß√µes de modifica√ß√£o no Solicita√ß√£o GET, todas as solicita√ß√µes de modifica√ß√£o devem passar por POST ou PUT). <br></li><li>  Clicar no link no cabe√ßalho List-Unsubscribe, pelo contr√°rio, n√£o deve exigir nenhuma a√ß√£o adicional do usu√°rio, porque o cancelamento da inscri√ß√£o por esse link geralmente √© feito por programa de email ou webmail em nome do usu√°rio.  Al√©m disso, h√° um novo cabe√ßalho List-Unsubscribe-Post introduzido pelo RFC 8058. <br></li><li>  Voc√™ n√£o deve esperar que o usu√°rio leia o email e siga o link no mesmo navegador em que inicia a a√ß√£o que leva ao envio do email (por exemplo, registra uma conta).  O link deve funcionar em qualquer outro navegador ou dispositivo m√≥vel.  Em particular, o usu√°rio pode abrir o link sem ser autorizado ou autorizado em uma conta diferente daquela para a qual o email foi enviado. <br></li><li>  Porque o comprimento do URI pode ser limitado;  voc√™ n√£o deve usar URIs do tipo 'data:' para objetos grandes.  Pelo mesmo motivo, n√£o use URIs muito longos em hiperlinks. <br></li><li>  Voc√™ n√£o deve usar encurtadores de links externos, isso afeta negativamente a entrega de emails.  √â melhor que todos os links apontem para seu dom√≠nio, pois isso reduzir√° o potencial impacto negativo da reputa√ß√£o de outra pessoa na entrega de emails. <br></li><li>  N√£o coloque imagens externas em alguns servi√ßos p√∫blicos ou hospedagem gratuita, use um servi√ßo de hospedagem confi√°vel ou CDN com bom desempenho e reputa√ß√£o. <br></li></ul><br><br><img src="https://habrastorage.org/getpro/habr/post_images/05a/afd/4b3/05aafd4b3ef1a07a9654a92fc0419b32.png"><br>  (URI de imagem e √¢ncora inv√°lido devido √† falta de especifica√ß√£o de protocolo) <br><br><a name="20"></a><h2>  Requisitos de layout de email </h2><br>  Por que √© t√£o dif√≠cil criar e-mails? <br><br>  Os clientes de email, de uma maneira ou de outra, exibem o conte√∫do do usu√°rio em sua interface.  Potencialmente, isso pode levar a v√°rios problemas de seguran√ßa - script entre sites (XSS, script Crossite), falsifica√ß√£o de interface, oscila√ß√£o de DOM, desanoniza√ß√£o do usu√°rio / vazamento de informa√ß√µes (por exemplo, endere√ßo IP ou cookies do usu√°rio atrav√©s de solicita√ß√µes externas), etc.  ., portanto, qualquer servi√ßo de correio e aplicativo de correio possui alguma forma de prote√ß√£o contra cada classe de ataques.  Infelizmente, n√£o existe uma abordagem √∫nica para organizar essa prote√ß√£o.  Pode ser organizado atrav√©s de: <br><br><ul><li>  quadros limitados isolados, <br></li><li>  filtragem de tags e / ou atributos, <br></li><li>  restri√ß√µes ao posicionamento absoluto, <br></li><li>  proibi√ß√£o ou restri√ß√£o do uso de estilos de bloco (que √© fundamental para o layout adapt√°vel), <br></li><li>  banir elementos externos por padr√£o (ou seja, baixar imagens externas requer permiss√£o do usu√°rio) ou usar um proxy para acess√°-los, <br></li><li>  converter emails em HTML em outro formato intermedi√°rio (por exemplo, o Microsoft Exchange / Outlook usa RTF, o que pode tornar extremamente dif√≠cil exibir elementos corretamente no Outlook usando m√©todos convencionais), <br></li><li>  proibi√ß√£o ou restri√ß√£o do uso de formul√°rios ou de seus elementos individuais. <br></li></ul><br>  Os emails tamb√©m usam elementos espec√≠ficos, como imagens embutidas e URI <code>cid://</code> , cujo suporte pode ser limitado.  Por exemplo, o Mozilla Thunderbird n√£o suporta <code>cid://</code> para imagens de fundo. <br><br>  Mesmo um email corretamente formado pode ser exibido de maneira diferente em diferentes interfaces devido √†s peculiaridades de sua implementa√ß√£o e filtragem do conte√∫do do email. <br><br>  Se houver erros no formato do email, o comportamento se tornar√° completamente imprevis√≠vel.  Por exemplo, os clientes de email podem ter um comportamento diferente com URIs incorretos ou a formata√ß√£o incorreta do cabe√ßalho √© tratada de maneira diferente.  Al√©m disso, a detec√ß√£o autom√°tica de codifica√ß√£o de texto funciona de maneira diferente se n√£o for especificada ou especificada incorretamente.  Portanto, o email deve ser visualizado em diferentes interfaces: a exibi√ß√£o correta do email em uma interface n√£o significa que ele foi composto corretamente (na verdade, mesmo a exibi√ß√£o correta do email em todas as interfaces n√£o garante que n√£o haja problemas com a tela no futuro). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b5/127/114/9b512711407c1cac545a57fd629d6b1a.png"><br><br>  √â necess√°rio prestar aten√ß√£o aos seguintes pontos: <br><br><ul><li>  Verifique o texto do email quanto ao conte√∫do sem√¢ntico, exibi√ß√£o, aus√™ncia de erros de digita√ß√£o, sintaxe, ortografia e erros lexicais. <br></li><li>  Verifique a corre√ß√£o da substitui√ß√£o dos dados do aplicativo no modelo ou layout do email. <br></li><li>  Verifique a corre√ß√£o dos valores, datas, n√∫meros, itens de mercadorias e outras informa√ß√µes, levando em considera√ß√£o as condi√ß√µes permitidas dos limites.  As datas devem ter um ano (alguns usu√°rios entram na caixa muito raramente).  Um fuso hor√°rio deve estar presente no tempo.  O endere√ßo deve conter uma cidade e, em alguns casos, √© necess√°rio indicar o pa√≠s. <br></li><li>  Verifique o status operacional de todos os links no email, se houver. <br></li><li>  Nos e-mails enviados antes da confirma√ß√£o do endere√ßo, incl.  e-mails com um link de confirma√ß√£o, n√£o deve haver nenhum texto controlado externamente, nem mesmo o nome de usu√°rio; caso contr√°rio, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">eles podem ser usados ‚Äã‚Äãpara spam</a> (no campo exibido no e-mail, por exemplo, no nome, o texto de spam √© inserido e o endere√ßo √© o endere√ßo indicado da v√≠tima).  Por exemplo, se voc√™ pode enviar um texto obsceno no endere√ßo do desenvolvedor em nome do seu servi√ßo, existe um problema. <br></li><li>  Verifique a aus√™ncia de imagens externas em servi√ßos de terceiros.  Isso pode afetar a entrega e vazar informa√ß√µes sobre seus clientes. <br></li><li>  Verifique a disponibilidade dos contadores para envio, entrega, leitura de email e transi√ß√µes.  Alguns deles est√£o localizados no pr√≥prio email (por exemplo, o contra-pixel da leitura do email), outros s√£o rastreados pelo remetente, mas, como regra, todos est√£o dispon√≠veis no painel de administra√ß√£o do remetente. <br></li><li>  Verifique a exatid√£o da categoria de assinatura e a desinscri√ß√£o do usu√°rio para esta categoria atrav√©s do link no email. <br></li><li>  Verifique a apar√™ncia do email: <br><ul><li>  Vers√µes populares da web do correio para um pa√≠s de destino: os "tr√™s grandes" da R√∫ssia s√£o Mail.Ru, Yandex, Gmail.  Voc√™ tamb√©m pode adicionar o Rambler e o Outlook.com; <br></li><li>  Aplicativos m√≥veis dos provedores de e-mail acima; <br></li><li>  Aplicativos m√≥veis padr√£o usando IMAP, levando em conta plataformas m√≥veis populares, para pelo menos o iPhone, Pixel (plataforma de refer√™ncia Android), Samsung (a mais comum para Android), MIUI (ocupa o segundo lugar na R√∫ssia para plataformas Android); <br></li><li>  V√°rios navegadores de desktop: Chrome, Firefox, Edge, Internet Explorer, Opera, etc .; <br></li><li>  Aplicativos de desktop (programas de email), especialmente Thunderbird, Outlook e Apple Mail, opcionalmente The Bat!  e Opera Mail; <br></li><li>  Solu√ß√µes corporativas populares com uma interface da web (Exchange, talvez Roundcube, Communigate, Zimbra, SquirrelMail) - para solu√ß√µes B2B; <br></li><li>  N√£o se esque√ßa de verificar o layout nos monitores Retina e nos de baixa resolu√ß√£o. <br></li></ul></li><li>  Durante a verifica√ß√£o em cada caso, voc√™ deve prestar aten√ß√£o a: <br><ul><li>  Passando os cabe√ßalhos de autoriza√ß√£o, SPF / DKIM / DMARC. <br></li><li>  Velocidade de download de e-mails: ele deve carregar rapidamente e n√£o levar tempo. <br></li><li>  Exibindo um email na lista de emails: avatar, nome do remetente e assunto que se enquadra no snippet da mensagem, se sua categoria foi definida corretamente (por exemplo, se o pedido n√£o se enquadra na categoria "redes sociais"). <br></li><li>  O layout do email como um todo: se o layout permanecesse consistente, houve quebra de palavras incorretas etc., inclusive ao dimensionar e redimensionar a janela. <br></li><li>  As fontes n√£o devem ser pequenas ou dif√≠ceis de ler. <br></li><li>  Imagens de fundo e cores de fundo. <br></li><li>  Combinando o livro da marca. <br></li><li>  Facilidade de executar as a√ß√µes impl√≠citas no email.  Por exemplo, se o email contiver um c√≥digo de confirma√ß√£o ou outras informa√ß√µes que talvez precisem ser armazenadas em algum lugar, ele deve n√£o apenas ser bem lido, mas tamb√©m conveniente selecion√°-lo e copi√°-lo, mesmo na interface m√≥vel. <br></li></ul><br></li><li>  Acompanhe o tamanho geral do email (incluindo imagens externas) e se ele n√£o excede os valores razo√°veis.  Quanto mais pesado o tempo de carregamento, maior a probabilidade de uma pessoa ter uma rea√ß√£o negativa a ele. <br></li><li>  Mesmo os emails que n√£o foram alterados devem ser verificados periodicamente, pois podem ocorrer altera√ß√µes no lado do servi√ßo postal e, por exemplo, "revelam" um problema anteriormente invis√≠vel. <br></li><li>  Alguns par√¢metros devem ser controlados em todos os testes.  Por exemplo, problemas na aprova√ß√£o da autentica√ß√£o DKIM podem ser causados ‚Äã‚Äãpor problemas na infraestrutura (problemas com o DNS ou a forma√ß√£o de uma assinatura DKIM, erros de sincroniza√ß√£o de hor√°rio), devido a erros no programa de gera√ß√£o (o endere√ßo do remetente √© formado incorretamente, caracteres incorretos em os cabe√ßalhos est√£o ausentes ou s√£o obrigat√≥rios, os cabe√ßalhos From, Date ou Message-ID foram duplicados) e devido a erros de conte√∫do (terminadores de linha incorretos, linhas muito longas, endere√ßos incorretos).  Ao mesmo tempo, o email pode n√£o "bater" e o problema pode n√£o aparecer em nenhum servi√ßo. <br></li></ul><br><a name="21"></a><h2>  Realiza√ß√£o de testes divididos </h2><br>  A pesquisa de marketing est√° al√©m do escopo deste artigo, mas alguns pontos-chave que afetam significativamente a qualidade dos emails devem ser mencionados. <br><br> The newsletter has a purpose, so it should entail through its quality, not quantity (which is the opposite for spammers). The newsletter must be segmented. When conducting an advertising campaign, you need to know exactly who gets into the segment sample, why they need the offered product and what they want to convey. <br><br> For each mailing list, it is necessary to calculate the CTR of the list of emails ‚Äî this is the ratio of the number of emails read to the total number that has been sent out. In postmaster.mail.ru, you can see indicators for unique users. If the measurement goes through the counter in the email (pixel), then the absolute number of openings is estimated. CTR &lt;10% is a very low indicator, it is undesirable to carry out such mailing. It should strive for a CTR&gt; 30%. For marketing emails, the clickthrough rate of clickthroughs and the percentage of completed actions (¬´sales¬ª) on these links are also of great importance. Be sure to monitor complaints (marking the email as spam). Typically, for one-time mailings, a tenth of a percent is a good indicator, for regular ones, a hundredth of a percent. The critical values, after which the mailing is always interpreted as spam, are indicated here: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://help.mail.ru/developers/mailing_rules/technical</a> . <br><br> It is necessary to conduct split testing of various distribution options to obtain optimal performance. Just changing the name of the sender and the subject of the email can increase the CTR by several times and significantly reduce the number of complaints. The number of emails should be statistically significant for evaluating the results (for large projects, usually a few thousand). The final version of the email is sent in several stages for additional measurement of indicators and ¬´warming up¬ª ‚Äî starting with about 10,000 recipients, with an increase of about an order of the day. <br><br> The main idea: emails are part of your application, perhaps one of the most complex and problematic. At the same time, this is often a ¬´blind spot¬ª in terms of testing. I hope that I was able to draw your attention to this issue. <br><br> I would like to thank Vladimir Dubrovin ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">z3apa3a</a> ) and Alena Likhacheva ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">s4ever</a> ) for helping me with this article. As well as that, the article utilised sources of Eduard Tyantov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">edT</a> ) and Alexander Purtov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">4Alexander</a> ). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt464515/">https://habr.com/ru/post/pt464515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt464499/index.html">"Mat. Modelo de Wall Street "ou uma tentativa de otimizar o custo da infraestrutura de TI na nuvem</a></li>
<li><a href="../pt464503/index.html">Correspond√™ncia de senha Wi-Fi com aircrack-ng</a></li>
<li><a href="../pt464509/index.html">O livro "Grok deep learning"</a></li>
<li><a href="../pt464511/index.html">Como coletar coortes de usu√°rios na forma de gr√°ficos no Grafana [+ imagem do docker com um exemplo]</a></li>
<li><a href="../pt464513/index.html">Duffle: Transformador de XD Design</a></li>
<li><a href="../pt464517/index.html">Novos cart√µes CUBA</a></li>
<li><a href="../pt464523/index.html">Sistemas de Pagamento (PSP) para empresas de TI: jogamos muito</a></li>
<li><a href="../pt464525/index.html">Seu pr√≥prio conversor JSON ou um pouco mais sobre o ExpressionTrees</a></li>
<li><a href="../pt464529/index.html">Agora, a publicidade contextual com os nomes dos concorrentes pode ser multada em 500.000 rublos</a></li>
<li><a href="../pt464535/index.html">Detalhes sobre o dispositivo e as fun√ß√µes da scooter el√©trica KickScooter T60</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>