<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•™ üöÜ üõãÔ∏è OK, ai-je vraiment besoin de Kubernetes? üîä üíÇüèº üåª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans une grande entreprise, il est souvent tr√®s difficile de coordonner l'allocation des ressources pour les t√¢ches de travail. Tout Agile croque cont...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OK, ai-je vraiment besoin de Kubernetes?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croccloudteam/blog/472750/"><img src="https://habrastorage.org/webt/hy/2c/vl/hy2cvliq-ytpomgzdyw0qwnm7uk.png"><br><br>  Dans une grande entreprise, il est souvent tr√®s difficile de coordonner l'allocation des ressources pour les t√¢ches de travail.  Tout Agile croque contre le mur d'un accord de trois semaines avec le SI d'une nouvelle infrastructure.  Par cons√©quent, nous recevons souvent des demandes de transfert de l'infrastructure vers des conteneurs afin de d√©ployer les modifications non pas tous les trois mois et lorsque l'entreprise en a besoin.  En m√™me temps, ils demandent de configurer / impl√©menter Kubernetes comme l'instrument d'orchestration le plus populaire, bien que, comme le montre la pratique, sur 10 projets, un maximum de trois soit n√©cessaire.  Mais en fait, cela vaut la peine d'utiliser Kubernetes, mais OpenShift, ou de travailler avec lui non pas dans votre infrastructure, mais dans un cloud public, par exemple.  Je vais essayer de parler des cas r√©els que nous avons d√©cid√©s, je vais d√©crire les principales diff√©rences entre Kubernetes et OpenShift.  Et aussi sur la fa√ßon dont nous avons r√©duit la coordination de la s√©curit√© de l'information √† 30 minutes, et tout est rest√© en vie. <br><br>  Nous avons eu plusieurs impl√©mentations int√©ressantes dans lesquelles nous avons ratiss√© les probl√®mes accumul√©s du client.  Par exemple, une entreprise de vente au d√©tail est venue vers nous qui avait besoin de d√©ployer de nouvelles puces en continu.  La comp√©tition est folle!  Et ils ne disposent que de l'infrastructure de d√©veloppement chaque fois que cela prend de six √† dix jours, ce qui entra√Æne des temps d'arr√™t.  R√©soudre le probl√®me en achetant du nouveau mat√©riel pour les tests et le d√©veloppement co√ªte cher et ne m√®ne nulle part.  En cons√©quence, nous avons transf√©r√© l'infrastructure informatique vers la virtualisation de conteneurs.  En cons√©quence, gr√¢ce aux conteneurs, la charge a √©t√© r√©duite de 40%, et l'infrastructure pour le nouveau d√©veloppement est maintenant pr√©par√©e de une √† quatre heures.  Le bonus est une √©conomie, car tous les processus pourraient continuer √† √™tre men√©s sur la base des capacit√©s existantes sans en acheter de nouvelles. <a name="habracut"></a><br><br><h3>  Qu'allons-nous faire de la s√©curit√© de l'information? </h3><br>  IB sont des personnes tr√®s n√©cessaires.  Ils vont souvent un peu trop loin dans leurs exigences internes pour les projets, mais c'est bien mieux que de voir une fois que vos pirates roumains ont entour√© votre serveur SFTP externe. <br><br>  Mais il y a un probl√®me avec eux.  Si nous consid√©rons le processus commercial comme un convoyeur, leur division devient souvent le goulot d'√©tranglement sur lequel tout le monde repose.  D'une part, ils sont responsables de tous les risques li√©s √† la s√©curit√©, d'autre part, ils n'arrivent tout simplement pas √† visualiser manuellement le code et tous les d√©tails de l'architecture du nouveau produit. <br><br>  La situation est tr√®s similaire √† celle des services de s√©curit√© dans les zones √† forte affluence.  Nous pouvons organiser une inspection totale de chaque passager dans le m√©tro, le faire briller sur des scanners, tordre les poches et inspecter le t√©l√©phone.  Par cons√©quent, au lieu de la s√©curit√©, vous obtiendrez un effondrement complet du transport et une paralysie du syst√®me.  La seule option dans cette situation est l'organisation de syst√®mes automatis√©s qui r√©pondront, par exemple, aux individus, identifieront les personnes recherch√©es ou r√©agiront √† un comportement anormal. <br><br>  Dans notre contexte, de tels syst√®mes automatis√©s sont des processus CI / CD correctement organis√©s avec des analyseurs de code √† des √©tapes interm√©diaires, telles que des solutions JFrog Xray pour Artifactory, et des √©crous Kubernetes / OpenShift correctement serr√©s, qui ne permettent pas d'approches dangereuses comme le lancement d'un conteneur √† partir de l'utilisateur root.  Nous pr√©parons maintenant une solution en bo√Æte qui fournira tout cela. <br><br>  L'objectif est de passer du concept de "n'entrera pas dans la vente tant que nous ne chercherons pas" √† "s'il n'y a pas d'objection, il sera d√©ploy√© automatiquement".  Il n'y a aucun int√©r√™t √† l'automatisation si les processus organisationnels restent les m√™mes. <br><br>  Dans l'un des projets, nous avons r√©ussi √† r√©duire le temps de d√©faillance du SI √† 30 minutes.  En d'autres termes, si, dans une demi-heure, le ¬´gardien de s√©curit√©¬ª ne rejette pas l'action, elle est automatiquement approuv√©e et les modifications sont mises en production.  Maintenant, nous essayons d'atteindre un d√©lai de 60 minutes pour tous les coordinateurs du projet sans compromettre la s√©curit√©. <br><br><h3>  Quelle est la diff√©rence entre les syst√®mes de gestion de conteneurs? </h3><br>  Kubernetes et OpenShift sont les principales solutions pour l'orchestration de conteneurs.  Analysons les principales diff√©rences et avantages pour l'entreprise. <br><br>  <b>Ouverture</b> <br><br>  Kubernetes est un produit enti√®rement ouvert qui peut √™tre d√©ploy√© ind√©pendamment et entretenu seul ou avec un support externe.  La situation sur le march√© du travail s'est d√©j√† plus ou moins stabilis√©e et trouver des experts sur ce sujet n'est plus un probl√®me. <br><br>  OpenShift est un produit semi-ferm√© avec un syst√®me de licence sophistiqu√© de RedHat.  En fait, il contient Kubernetes, mais il a un tas de liaisons suppl√©mentaires qui simplifie de nombreuses t√¢ches.  Le fournisseur fournit un support payant complet pour son produit. <br><br>  Ici, le choix d√©pend de ce qui vous convient le mieux - le soutien des forces de vos sp√©cialistes ou de votre fournisseur. <br><br>  <b>Plateformes</b> <br><br>  Kubernetes fonctionne sur presque toutes les plateformes Linux et la plupart des fournisseurs de cloud. <br><br>  OpenShift ne fonctionne nulle part sauf sur RHEL, Red Hat Atomic, Red Hat CoreOS.  Il existe une version communautaire - OKD, mais elle est √©troitement li√©e aux distributions.  La seule exception est qu'il peut √™tre install√© sur CentOS.  Et gardez √† l'esprit qu'officiellement Red Hat ne garantit pas un support payant. <br><br>  <b>Politiques de s√©curit√©</b> <br><br>  OpenShift pr√™t √† l'emploi a des param√®tres de s√©curit√© plus stricts.  C'est un plus lors du d√©ploiement de l'infrastructure √† partir de z√©ro, mais cela peut √™tre un probl√®me en raison de l'incompatibilit√© de certaines images avec les politiciens.  Par exemple, dans OpenShift, il est interdit d'ex√©cuter le conteneur √† partir de root, ce qui rompt la compatibilit√© avec les anciennes images.  D'un autre c√¥t√©, cette approche, combin√©e √† une int√©gration pratique avec AD, une journalisation pratique sur la base de la pile EFK (ElasticSearch, Fluentd, Kibana) nous donne la s√©curit√© m√™me pr√™te √† l'emploi pour d√©charger l'unit√© IS. <br><br>  Kubernetes peut √©galement √™tre termin√© √† ce niveau, mais cela n√©cessitera beaucoup d'efforts et de temps de la part des ing√©nieurs. <br><br>  <b>Patterns</b> <br><br>  Les mod√®les OpenShift sont moins flexibles que les graphiques Kubernetes Helm.  En raison de politiques de s√©curit√© plus strictes, Red Hat ne peut pas fournir la flexibilit√© des graphiques Helm pour le moment.  Cependant, dans OpenShift 4, la situation s'est stabilis√©e gr√¢ce √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OperatorHub</a> int√©gr√©. <br><br>  Avoir des mod√®les bien con√ßus pr√™ts √† l'emploi facilite la vie.  En fait, il s'agit d'une telle option de gestionnaire de packages pour cr√©er et configurer divers services. <br><br>  Une commande conditionnelle ¬´helm install prometheus-operator¬ª d√©ploie un syst√®me assez complexe, qui met tr√®s longtemps √† se d√©ployer.  Kubernetes ouvre la voie. <br><br>  <b>Conclusions g√©n√©rales</b> <br><br>  Comme la plupart des produits, Red Hat OpenShift est une solution plus encadr√©e, mais plus r√©sistante sur le plan architectural.  Il faut du personnel moins aux yeux rouges et plus exp√©riment√© pour travailler.  Sc√©narios de d√©ploiement plus pratiques, excellente int√©gration avec les solutions CI / CD, en particulier avec Jenkins.  OpenShift est id√©al pour les entreprises qui sont plus faciles √† payer pour prendre en charge un produit fini que pour embaucher leurs propres sp√©cialistes. <br><br>  Pour les entreprises poss√©dant de solides sp√©cialistes dans ce domaine, Kubernetes peut √™tre une solution plus flexible et int√©ressante.  Il peut √©galement convenir √† une entreprise relativement petite qui souhaite √©conomiser sur les licences Red Hat, mais n'a pas de t√¢ches complexes qui n√©cessitent des experts hautement qualifi√©s. <br><br><h2>  Cas r√©els </h2><br>  J'essaierai de montrer comment les technologies de conteneurisation ont aid√© √† r√©soudre les probl√®mes commerciaux, enregistr√© les licences et assur√© le lissage des pics de charge lors des raids de masse des utilisateurs. <br><br><h4>  √âtude de cas: commerce √©lectronique </h4><br>  <b>Le probl√®me</b> <br><br>  Le client disposait de plus de 100 services actifs ex√©cutant la fondation cloud de VMware.  Et tout ce parc a eu plusieurs probl√®mes diff√©rents: <br><br><ol><li>  12 services exigeants en ressources et sans marge ont √©t√© lanc√©s sur VMware, consommant un budget d'environ 408 000 $ par an. </li><li>  Trois services (un portail et deux applications mobiles) ont commenc√© √† se d√©velopper activement: en sept mois, les ressources n√©cessaires au travail ont augment√© de 4,5 fois et continuent de cro√Ætre. </li><li>  Plusieurs services clients connaissent des pics de charge, au cours desquels les ressources sont n√©cessaires six √† sept fois plus qu'en temps normal.  En cons√©quence, du mat√©riel a √©t√© allou√© pour leur bon fonctionnement, qui la plupart du temps a √©t√© utilis√© par moins de 15%. </li></ol><br>  En plus de tout cela, le client souhaite ne plus se lier √† un seul fournisseur de virtualisation. <br><br>  <b>Notre d√©cision</b> <br><br>  La premi√®re et la plus simple solution: nous transf√©rons des services avec des pics vers le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cloud CROC public</a> .  Avec facturation des ressources consomm√©es.  Tout est aussi simple et ennuyeux que possible.  Passer du VMware de quelqu'un √† notre KVM est l'un des cas les plus fr√©quents pour les ing√©nieurs cloud. <br><br>  √âtant donn√© que le mat√©riel de mise √† l'√©chelle a d√©j√† √©t√© achet√© par le client, nous n'avons eu qu'√† calculer les licences.  Pour les nouveaux h√¥tes de VMware, ils ont co√ªt√© environ 2 100 000 $, ce qui ne convenait pas beaucoup au client.  Nous avons propos√© de transf√©rer certains des services vers KVM ex√©cutant OpenStack.  Et pour ne pas se perdre, int√©grez la gestion des deux infrastructures par CloudForms (et en m√™me temps OpenShift). <br><br>  En cons√©quence, le client a re√ßu la deuxi√®me √©paule d'un cloud priv√© bas√© sur OpenStack, ce qui a clos la question du fournisseur.  En d√©pla√ßant certains des services gourmands en ressources vers une nouvelle √©paule, il s'est av√©r√© r√©duire le co√ªt des licences VMware (la prise en charge 24h / 24 et 7j / 7 du CROC s'est av√©r√©e moins co√ªteuse). <br><br><h4>  Cas: Retail </h4><br>  <b>Le probl√®me</b> <br><br>  Au cours de l'audit, il s'est av√©r√© que quelque chose de terrible se passait avec le client concernant l'allocation des infrastructures.  Projets - plus de 250, √©quipes de d√©veloppement - plus de 150, demi-conteneurs sur Kubernetes.  Les ressources pour chaque nouveau projet sont achet√©es et y restent affect√©es sans possibilit√© de s√©lection, m√™me si elles ne sont pas utilis√©es.  Il n'y a aucune facturation, il n'y a pas de portail unique.  Co√ªts √©normes pour les environnements de test et de pr√©-production, car ils tournent √©galement sur VMware. <br><br>  Dans le m√™me temps, le client ne veut pas passer compl√®tement √† une nouvelle plateforme et veut tout assembler sous un portail de gestion unique.  De plus, ¬´tout¬ª n'est pas seulement VMware, mais aussi PaaS, des conteneurs et une facturation unique. <br><br>  <b>Notre d√©cision</b> <br><br>  En cons√©quence, √† l'int√©rieur de la solution s'est av√©r√©e plut√¥t entass√©e, mais √† l'ext√©rieur pour le client, tout semble extr√™mement simple. <br><br>  Le r√©pertoire dans lequel l'utilisateur s√©lectionne les param√®tres de la machine virtuelle et le circuit n√©cessaire: DevTest, PreProd, Prod.  Et puis CloudForms choisit o√π d√©ployer la ressource demand√©e: sur VMware ou sur OpenShift.  Nous travaillons toujours sur la facturation unique, car la solution hybride VMware + OpenShift est assez difficile √† mettre en place. <br><br>  En fait, de cette fa√ßon, nous mettons les choses en ordre dans l'infrastructure, en triant les d√©combres que le client a entass√©s. <br><br><h4>  Cas: Industrie </h4><br>  <b>Le probl√®me</b> <br><br>  La copie de VM dans diff√©rents environnements (Test, Dev, Prod, Preprod) prend plus de trois jours et n√©cessite l'ex√©cution manuelle de 15 op√©rations diff√©rentes, chacune prenant jusqu'√† 30 minutes.  Un audit approfondi a montr√© qu'auparavant, il avait fallu deux semaines pour allouer des ressources √† un nouveau projet, et qu'il y avait 10 √† 20 demandes par mois.  Il y a maintenant plus de dix demandes de ressources par jour, ce qui, sans automatisation, a entra√Æn√© un effondrement. <br><br>  <b>Notre d√©cision</b> <br><br>  En fait, le client devait transf√©rer l'infrastructure informatique vers un mod√®le de service, reconstruire et automatiser le processus de modification de l'infrastructure, cr√©er un portail libre-service, le remplir avec un catalogue de services et mettre en ≈ìuvre un environnement pour g√©rer les applications conteneuris√©es.  Nous avons automatis√© le processus de copie des VM, mais cela a quand m√™me pris beaucoup de temps: 40 √† 60 minutes, cela ne convenait pas au client.  En cons√©quence, nous avons propos√© de passer aux conteneurs, ce qui a r√©duit le temps de copie √† trois √† cinq minutes. <br><br><h3>  Conclusions </h3><br>  La conteneurisation et les microservices ne sont pas des indulgences pour un mauvais code qui sera √©crit avec le pied gauche et volera imm√©diatement en production.  Au contraire, il s'agit d'un concept global, impliquant un tas d'am√©liorations dues √† l'automatisation profonde de tous les processus: <br><br><ul><li>  Le code devient plus propre: linter, analyseurs de code, tests automatis√©s. </li><li>  Le code et l'architecture deviennent de plus en plus s√ªrs: des outils de s√©curit√© aux capacit√©s √©tendues, jusqu'au blocage automatique du d√©ploiement de code non s√©curis√©. </li><li>  Les services deviennent de plus en plus flexibles et mobiles: les cycles de d√©veloppement sont d√©sormais extr√™mement courts et r√©pondent rapidement aux changements. </li><li>  Mise √† l'√©chelle automatique sous charge: votre ressource ne s'affaisse plus aux heures de pointe, perdant des ventes et des clients. </li><li>  Allocation simple des ressources pour les nouveaux projets, r√©duction du temps consacr√© √† la coordination. </li><li>  Souvent, la conteneurisation peut r√©duire consid√©rablement le d√©lai de mise sur le march√©. </li></ul><br>  Et parfois, la conteneurisation n'est pas du tout n√©cessaire, et le probl√®me peut √™tre r√©solu par la migration vers un cloud externe.  Mais pour prendre une d√©cision, dans tous les cas, nous avons besoin d'un bon audit externe et d'une bonne analyse de ce qui se passe.  En bref, les conteneurs ne sont que l'un des outils pour r√©soudre les probl√®mes commerciaux, bien que tr√®s cool. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472750/">https://habr.com/ru/post/fr472750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472736/index.html">Webinaire ouvert "Introduction √† l'automatisation des tests d'applications mobiles sur S√©l√©nium et Appium"</a></li>
<li><a href="../fr472738/index.html">Comment mettre √† niveau un projet existant d'ASP.NET MVC vers ASP.NET Core. Guide pratique</a></li>
<li><a href="../fr472744/index.html">Le MRP ne fonctionne pas ... Quelle est l'alternative?</a></li>
<li><a href="../fr472746/index.html">Serveur de terminal pour administrateur; Pas un seul √©cart SSH</a></li>
<li><a href="../fr472748/index.html">Navigateur s√©mantique ou vie sans sites</a></li>
<li><a href="../fr472752/index.html">CSE: Kubernetes pour n'importe qui dans vCloud</a></li>
<li><a href="../fr472754/index.html">Comment parler anglais en un mois. 9 √©tapes simples et √©prouv√©es</a></li>
<li><a href="../fr472758/index.html">Proposition: essayer - fonction int√©gr√©e de v√©rification des erreurs</a></li>
<li><a href="../fr472760/index.html">R√©duisez le temps de calcul de quelques ann√©es √† quelques minutes. Comprendre l'apprentissage automatique quantique</a></li>
<li><a href="../fr472762/index.html">Analyse technique de l'exploit checkm8</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>