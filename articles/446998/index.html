<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍝 😳 🚴🏾 Inicio de SAP GUI desde un navegador 🦋 ⛽️ 💇🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Primero escribí este artículo en mi blog , para que luego no volviera a mirar y recordar, pero como nadie lee el blog, quería compartir esta informaci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inicio de SAP GUI desde un navegador</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446998/"> <i>Primero escribí este artículo en mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">blog</a> , para que luego no volviera a mirar y recordar, pero como nadie lee el blog, quería compartir esta información con todos, de repente pude usarlo.</i> <br><br>  Mientras trabajaba en la idea de un servicio de restablecimiento de contraseña en los sistemas SAP R / 3, surgió la pregunta: ¿cómo iniciar la GUI de SAP con los parámetros necesarios desde el navegador?  Dado que esta idea implicaba el uso de un servicio web que primero cumple una solicitud SOAP de la GUI de SAP y envía un correo electrónico con un enlace a una página web con un script de restablecimiento de contraseña al inicial, y luego muestra un mensaje al usuario sobre el restablecimiento exitoso de la contraseña y muestra esta contraseña muy inicial , me gustaría que en esta página también hubiera un enlace para iniciar la GUI de SAP.  Además, para que este enlace abra el sistema deseado, e incluso, preferiblemente, inmediatamente con los campos de inicio de sesión y contraseña completados: el usuario solo tendría que completar una contraseña productiva dos veces. <br><br>  Iniciar SAP Logon no fue interesante para nuestro propósito, y al iniciar sapgui.exe fue imposible especificar el cliente y el nombre de usuario, pero fue posible iniciar el sistema no definido en SAP Logon.  Por otro lado, iniciar la GUI de SAP con parámetros arbitrarios del servidor no fue particularmente relevante: si estamos resolviendo la tarea de restablecer la contraseña del usuario, entonces lo más probable es que ya tenga la línea correcta en SAP Logon, con la configuración que necesita y no tiene que molestarse con la suya.  Por otro lado, la tecnología de acceso directo de la GUI de SAP y el programa sapshcut.exe en sí mismo, que permitieron iniciar la GUI de SAP usando un cierto "acceso directo", cumplieron los requisitos especificados. <br><a name="habracut"></a><br>  Resolviendo el problema en la frente: ejecutando sapshcut.exe directamente desde el navegador usando el objeto ActiveX: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sid, client, user, password</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shell = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveXObject(<span class="hljs-string"><span class="hljs-string">"WScript.Shell"</span></span>); shell.run(<span class="hljs-string"><span class="hljs-string">'sapshcut.exe -system="'</span></span>+sid+<span class="hljs-string"><span class="hljs-string">'" -client='</span></span>+client+<span class="hljs-string"><span class="hljs-string">' -user="'</span></span>+user+<span class="hljs-string"><span class="hljs-string">'" -pw="'</span></span>+password+<span class="hljs-string"><span class="hljs-string">'" -language=RU'</span></span>); }</code> </pre> <br>  La solución es mala: en primer lugar, funciona solo en Internet Explorer y, en segundo lugar, requiere una configuración de seguridad adecuada en el navegador, que puede prohibirse a nivel de dominio en la organización, e incluso si está habilitado, el navegador le da al usuario una ventana con una advertencia alarmante: <br><br><img src="https://habrastorage.org/webt/ta/wg/i0/tawgi0nixqmmuxehbtyeqpmmabw.png"><br><br>  Busqué la solución n. ° 2 en Internet: <a href="">crear mi propio protocolo web</a> .  Le permite ejecutar la aplicación que necesitamos usando el enlace que indica el protocolo que nosotros mismos registramos en Windows en el registro en la sección HKEY_CLASSES_ROOT.  Dado que el acceso directo de la GUI de SAP en esta sección tiene su propia subsección, puede agregar el parámetro de cadena del Protocolo URL con un valor vacío: <br><br><img src="https://habrastorage.org/webt/cp/gn/rs/cpgnrseqoua-yjn_cuoazf9ili4.png"><br><br>  Este protocolo inicia <b>sapgui.exe</b> con el parámetro <b>/ SHORTCUT</b> , que es lo que necesitamos: <br><br><img src="https://habrastorage.org/webt/cu/63/th/cu63thnkw3vqtjrokx1xhpckkom.png"><br><br>  Bueno, o si queremos hacer un protocolo arbitrario en general (por ejemplo, <b>sapshcut</b> ), puede registrarlo usando el siguiente archivo de registro: <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CLASSES_ROOT\sapshcut] <br> @="sapshcut Handler" <br> "URL Protocol"="" <br> [HKEY_CLASSES_ROOT\sapshcut\DefaultIcon] <br> @="sapshcut.exe" <br> [HKEY_CLASSES_ROOT\sapshcut\shell] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open] <br> [HKEY_CLASSES_ROOT\sapshcut\shell\open\command] <br> @="sapshcut.exe \"%1\"" <br></code> <br>  Ahora, si hacemos un enlace en la página web que indique el protocolo <b>Sapgui.Shortcut.File de</b> manera similar: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>SID200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  deberíamos ver una ventana como: <br><br><img src="https://habrastorage.org/webt/cc/xn/d6/ccxnd6jigmmqx7ydiaiei0qeh18.png"><br><br>  Y todo parece estar bien, pero cuando haces clic en el botón "Permitir", vemos: <br><br><img src="https://habrastorage.org/webt/3a/lm/hc/3almhctej9kj3haxogtmrajza-i.png"><br><br>  Vaya, el navegador convirtió el espacio en% 20.  Bueno, otros caracteres también se codificarán en su código numérico con un símbolo de porcentaje.  Y lo más desagradable es que aquí no se puede hacer nada a nivel del navegador (todo se hace de acuerdo con el estándar): al navegador no le gustan esos caracteres y el shell de Windows no funciona con dichos valores codificados.  Y una desventaja más: toda la cadena se pasa como parámetro, incluido el nombre del protocolo e incluso los dos puntos ( <i>sapgui.shortcut.file :)</i> .  Además, aunque el mismo <b>sapshcut.exe</b> puede descartar todo lo que no sea un parámetro para ello (comienza con el símbolo "-", luego el nombre, "=" y el valor), es decir  una línea de la forma " <i>sapgui.shortcut.file: -system = SID</i> " todavía se enrolla, luego sin un espacio " <i>sapgui.shortcut.file: -system = SID</i> " ya no funciona. <br><br>  Resulta que, en principio, hay dos opciones para usar el protocolo URI: <br><br><ol><li>  Uso sin parámetros: creamos un montón de protocolos para todos nuestros sistemas del tipo <i>SIDMANDT</i> , como <i>AAA200</i> , <i>BBB200</i> , etc.  Si solo necesita iniciar el sistema deseado, entonces la opción está funcionando bastante bien, pero en nuestro caso no funciona, porque al menos también desea transferir el inicio de sesión del usuario, pero no puede hacerlo de esta manera. <br></li><li>  Usar un contenedor para llamar a <b>sapshcut.exe</b> o <b>sapgui.exe</b> .  La esencia de este programa es simple: debe tomar la línea que el navegador le transmitirá a través del protocolo web y convertirla en la representación que Windows acepta, es decir.  back convierte todos los códigos de caracteres en caracteres (tal vez incluso analiza la cadena por parámetros) y ya llama a la GUI de SAP garantizada por el comando correcto.  En nuestro caso, tampoco encaja del todo (por lo tanto, ni siquiera lo escribí), porque no es suficiente para nosotros agregar un protocolo en todas las PC de los usuarios (dentro del dominio, esto todavía no fue a ninguna parte, aunque es mejor evitar esta práctica), pero aquí será necesario adicionalmente coloque el programa en una PC e incluso monitoree constantemente para que no desaparezca al reinstalar el software en una PC. <br></li></ol><br>  Es decir  Esta opción también se descarta como no apta para nosotros. <br><br>  Luego comencé a pensar que tendría que despedirme de la idea de iniciar la GUI de SAP con los parámetros necesarios desde el navegador, pero luego tuve la idea de que puede hacer un acceso directo en SAP Logon y copiarlo en el escritorio.  Utilicé este método una vez, pero antes no miraba el archivo de acceso directo específicamente.  Y resultó que este acceso directo es un archivo de texto sin formato con la extensión <b>.sap</b> .  Y si lo ejecuta en Windows, la GUI de SAP se inicia con los parámetros que se especifican en este archivo.  "¡Bingo!" <br><br>  El formato de este archivo es aproximadamente el siguiente (puede que todavía se inicie una transacción al inicio, pero la omití): <br><br> <code>[System] <br> Name=SID <br> Client=200 <br> [User] <br> Name= <br> Language=RU <br> Password= <br> [Function] <br> Title= <br> [Configuration] <br> GuiSize=Maximized <br> [Options] <br> Reuse=0 <br></code> <br>  Parece ser todo lo que se necesita: un identificador del sistema, un cliente, un nombre de usuario e incluso una contraseña.  E incluso parámetros adicionales: <i>Título</i> : el título de la ventana, <i>GuiSize</i> , el tamaño de la ventana iniciada (pantalla completa o no) y <i>Reutilizar</i> , ya sea para abrir una nueva ventana o usar una ya abierta con el mismo sistema.  Pero de inmediato salió un matiz: resultó que era imposible establecer una contraseña en SAP Logon, la línea estaba bloqueada.  Resultó que esto se hizo por razones de seguridad: almacena todos los accesos directos creados en SAP Logon en el archivo <b>sapshortcut.ini</b> (junto a <b>saplogon.ini</b> en el perfil de usuario de Windows) y aunque están encriptados allí, pueden encriptarse demasiado y si lo desea. decodificar  Pero también puede resolver esto cambiando el valor de un parámetro en el registro (el valor predeterminado es <b>0</b> ): <br><br> <code>Windows Registry Editor Version 5.00 <br> [HKEY_CURRENT_USER\Software\SAP\SAPShortcut\Security] <br> "EnablePassword"="1" <br></code> <br>  Esto desbloquea el campo Contraseña en el formulario de acceso directo en SAP Logon para ingresar: <br><br><img src="https://habrastorage.org/webt/bo/p1/jf/bop1jfux8jdbqbkdedhzsodor9s.png"><br><br>  Y al ingresar una contraseña en este campo, se colocará en la línea correspondiente <br>  <b>sapshortcut.ini</b> , pero cuando arrastra un acceso directo al escritorio, no aparece allí, pero puede agregarlo allí manualmente.  La contraseña está encriptada, para 111111 tendrá la siguiente forma: PW_49B02219D1F6, para 222222 - PW_4AB3211AD2F5.  Pero estamos más interesados ​​en el hecho de que esta contraseña está encriptada de una manera que es independiente de la PC específica, y si restablecemos la contraseña a la inicial, podemos usar un valor previamente conocido en este campo.  Bueno, si queremos usar una contraseña generada aleatoriamente, tendremos que entender el algoritmo de este cifrado.  Pero a juzgar por los ejemplos anteriores, esto no será difícil.  Por cierto, en SAP GUI 7.40 este campo generalmente desapareció del formulario, pero percibe correctamente el archivo con la contraseña completa. <br><br>  Es decir, resulta que en el navegador es suficiente hacer clic en el enlace al archivo con la extensión .sap y con el formato deseado, y se ofrecerá a abrirlo como un archivo del tipo de acceso directo de la GUI de SAP (naturalmente en una PC con la GUI de SAP instalada) y abrirá la ventana de la GUI de SAP con la especificada parámetros (si el par SID y el cliente están en la lista de inicio de sesión de SAP en esta PC). <br><br>  Pero está claro que nadie creará y almacenará archivos en el sitio simplemente de antemano; deben generarse en función de los parámetros necesarios.  Por ejemplo, puede crear un script en PHP para generar accesos directos ( <b>sapshcut.php</b> ): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $Size = $queries[<span class="hljs-string"><span class="hljs-string">'Size'</span></span>]; $SID = $queries[<span class="hljs-string"><span class="hljs-string">'SID'</span></span>]; $Client = $queries[<span class="hljs-string"><span class="hljs-string">'Client'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Client == <span class="hljs-string"><span class="hljs-string">''</span></span>) { $Client=<span class="hljs-number"><span class="hljs-number">200</span></span>; }; $Lang = $queries[<span class="hljs-string"><span class="hljs-string">'Language'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Lang==<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Lang = <span class="hljs-string"><span class="hljs-string">'RU'</span></span>; }; $User = $queries[<span class="hljs-string"><span class="hljs-string">'Username'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($User&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) { $Password = $queries[<span class="hljs-string"><span class="hljs-string">'Password'</span></span>]; }; $filename = $SID.$Client.<span class="hljs-string"><span class="hljs-string">'.sap'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/sap'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[System]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$SID.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Client="</span></span>.$Client.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[User]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Name="</span></span>.$Username.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Language="</span></span>.$Lang.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Password&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Password="</span></span>.$Password.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Function]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Title&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title="</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Title=  \r\n"</span></span>;}; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Configuration]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($Size==<span class="hljs-string"><span class="hljs-string">'max'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"GuiSize=Maximized\r\n"</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"[Options]\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Reuse=0\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  Si no especifica un nombre de usuario y contraseña, obtenemos la siguiente ventana de los mensajes de inicio de sesión y contraseña: <br><br><img src="https://habrastorage.org/webt/4v/tz/_-/4vtz_-d9nva1ivhohfdtrxlfv7q.png"><br><br>  Si transfiere solo el inicio de sesión, el campo de inicio de sesión se completará y el campo de contraseña estará vacío.  Si le damos al usuario el nombre de usuario y la contraseña, pero la clave EnablePassword del usuario en la sección [HKEY_CURRENT_USER \ Software \ SAP \ SAPShortcut \ Security] se establece en 0 en la PC del usuario, obtendremos lo mismo.  Y solo si esta clave se establece en 1 y transferimos tanto el nombre como la contraseña inicial, el sistema le pedirá inmediatamente que ingrese la nueva contraseña permanente dos veces.  Lo que se requería para recibir. <br><br>  Como resultado, tenemos el siguiente conjunto de opciones consideradas como una ilustración de todo lo anterior: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="actionscript"><span class="hljs-function"><span class="hljs-title">openSAPGui</span></span></span></span><span class="hljs-params"><span class="actionscript"><span class="hljs-function"><span class="hljs-params">(sid, client, user, password)</span></span></span></span><span class="actionscript"><span class="hljs-function"> </span></span></span><span class="actionscript">{ </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> shell = </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">new</span></span></span><span class="actionscript"> ActiveXObject(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">"WScript.Shell"</span></span></span><span class="actionscript">); shell.run(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'sapshcut.exe -system="'</span></span></span><span class="actionscript">+sid+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -client='</span></span></span><span class="actionscript">+client+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">' -user="'</span></span></span><span class="actionscript">+user+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -pw="'</span></span></span><span class="actionscript">+password+</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'" -language=RU'</span></span></span><span class="actionscript">); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">''</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:openSAPGui('SID', '200', 'test', '');"</span></span></span><span class="hljs-tag">/&gt;</span></span>Example 1: Execute sapshcut.exe (ActiveX)<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'Sapgui.Shortcut.File: -system=SID -client=200'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 2: Open sapshcut.exe (URI)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'sapshcut.php?SID=SID&amp;Client=200&amp;User=test'</span></span></span><span class="hljs-tag">&gt;</span></span>Example 3: Open file .sap (SAP GUI Shortcut)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  La última opción se me ocurrió.  Pero en lugar de generar accesos directos de SAP, también puede usar, por ejemplo, la generación de archivos CMD, que, cuando se abren desde un navegador, también abrirán la ventana de la GUI de SAP.  El siguiente es un ejemplo ( <b>sapguicmd.php</b> ) de iniciar directamente la GUI de SAP con la cadena de conexión completa, sin tener que configurar SAP Logon: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $queries = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); parse_str($_SERVER[<span class="hljs-string"><span class="hljs-string">'QUERY_STRING'</span></span>], $queries); $Title = $queries[<span class="hljs-string"><span class="hljs-string">'Title'</span></span>]; $ROUTER = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTER'</span></span>]; $ROUTERPORT = $queries[<span class="hljs-string"><span class="hljs-string">'ROUTERPORT'</span></span>]; $HOST = $queries[<span class="hljs-string"><span class="hljs-string">'HOST'</span></span>]; $PORT = $queries[<span class="hljs-string"><span class="hljs-string">'PORT'</span></span>]; $MESS = $queries[<span class="hljs-string"><span class="hljs-string">'MESS'</span></span>]; $LG = $queries[<span class="hljs-string"><span class="hljs-string">'LG'</span></span>]; $filename = <span class="hljs-string"><span class="hljs-string">'SAPGUI_'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) $filename = $filename.<span class="hljs-string"><span class="hljs-string">'_'</span></span>.$PORT; $filename = $filename.<span class="hljs-string"><span class="hljs-string">'.cmd'</span></span>; header(<span class="hljs-string"><span class="hljs-string">'Content-disposition: attachment; filename='</span></span>.$filename); header(<span class="hljs-string"><span class="hljs-string">'Content-type: application/cmd'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"@echo off\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"chcp 1251\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"echo   "</span></span>.$Title.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set SAP_CODEPAGE=1504\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles(x86)%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'if exist "%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe" set gui=%ProgramFiles%\SAP\FrontEnd\SapGui\sapgui.exe'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"set logon="</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTER&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$ROUTER; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($ROUTERPORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$ROUTERPORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($MESS&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/M/"</span></span>.$MESS; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($HOST&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/H/"</span></span>.$HOST; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($PORT&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/S/"</span></span>.$PORT; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($LG&lt;&gt;<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"/G/"</span></span>.$LG; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'"%gui%" %logon%'</span></span>.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/446998/">https://habr.com/ru/post/446998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446988/index.html">Cómo enseñé Scala</a></li>
<li><a href="../446990/index.html">Retraso de entrada en consolas y emuladores retro</a></li>
<li><a href="../446992/index.html">John Maeda: "En realidad, el diseño no es tan importante"</a></li>
<li><a href="../446994/index.html">El espacio como un recuerdo vago</a></li>
<li><a href="../446996/index.html">El método Pomodoro no es tan genial como podría ser</a></li>
<li><a href="../447000/index.html">Guerras de formato de audio: 10 materiales en medios digitales y analógicos</a></li>
<li><a href="../447002/index.html">Tour de coworking fotográfico de Cabinet Lounge</a></li>
<li><a href="../447004/index.html">Universal Watchdog en ATtiny13</a></li>
<li><a href="../447006/index.html">Guía: cómo hacer un bot simple para JS Telegram para un principiante en programación</a></li>
<li><a href="../447008/index.html">Cómo tomar el control de su infraestructura de red. Tabla de contenidos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>