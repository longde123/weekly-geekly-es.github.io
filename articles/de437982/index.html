<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëºüèª üåßÔ∏è ü§∑üèø Der neue Verschl√ºsselungsangriff von Shade richtet sich an russische Gesch√§ftsanwender üöµüèΩ üéÖüèæ üè¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Januar 2019 verzeichneten wir einen starken Anstieg der Anzahl b√∂sartiger JavaScript-E-Mail-Anh√§nge (im Jahr 2018 wurde dieser Angriffsvektor nur m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Der neue Verschl√ºsselungsangriff von Shade richtet sich an russische Gesch√§ftsanwender</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/437982/"> Im Januar 2019 verzeichneten wir einen starken Anstieg der Anzahl b√∂sartiger JavaScript-E-Mail-Anh√§nge (im Jahr 2018 wurde dieser Angriffsvektor nur minimal verwendet).  In der ‚ÄûNeujahrsausgabe‚Äú kann man den russischsprachigen Newsletter herausgreifen, der f√ºr den Vertrieb des Shade-Encoders (auch bekannt als Troldesh) bestimmt ist und von ESET-Produkten als Win32 / Filecoder.Shade erkannt wird. <br><br>  Dieser Angriff scheint die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Oktober 2018</a> entdeckte Shade-Verschl√ºsselungs-Spam-Kampagne fortzusetzen. <br><br><img src="https://habrastorage.org/webt/gj/qd/le/gjqdlenhek1d4dftrqbviwdivyw.jpeg"><br><br><a name="habracut"></a><h3>  Neue Schattenkampagne </h3><br>  Nach unseren Telemetriedaten war die Oktober-Kampagne bis zur zweiten Dezemberh√§lfte 2018 in einem konstanten Tempo.  Es folgte eine Weihnachtspause, und Mitte Januar 2019 verdoppelte sich die Kampagnenaktivit√§t (siehe Grafik unten).  Wochenendst√ºrze in der Tabelle deuten darauf hin, dass Angreifer Unternehmens-E-Mail-Adressen bevorzugen. <br><br><img src="https://habrastorage.org/webt/qs/rm/tr/qsrmtrxwcgdagqx89m0wk__2r0o.png"><br>  <i>Abbildung 1. Erkennen b√∂sartiger JavaScript-Anh√§nge, die Win32 / Filecoder.Shade seit Oktober 2018 verbreiten</i> <br><br>  Wie bereits erw√§hnt, zeigt die Kampagne den Trend, den wir seit Anfang 2019 beobachten - die R√ºckgabe b√∂swilliger JavaScript-Anh√§nge als Angriffsvektor.  Die Dynamik ist in der folgenden Grafik dargestellt. <br><br><img src="https://habrastorage.org/webt/wo/yu/zi/woyuzi5gee0wlpcxkh4n40z7hv0.png"><br>  <i>Abbildung 2. Erkennung von sch√§dlichem JavaScript, das seit 2018 in E-Mail-Anh√§ngen verbreitet wird.</i>  <i>Anh√§nge werden von ESET als JS / Danger.ScriptAttachment erkannt</i> <br><br>  Es ist erw√§hnenswert, dass die Shade-Encoder-Vertriebskampagne in Russland am aktivsten ist, was 52% der Gesamtzahl der Erkennungen b√∂sartiger JavaScript-Anh√§nge ausmacht.  Weitere Opfer sind die Ukraine, Frankreich, Deutschland und Japan (siehe unten). <br><br><img src="https://habrastorage.org/webt/bm/jk/sv/bmjksv9vbijmwhnouha-qiwgjoo.png"><br>  <i>Abbildung 3. Die Anzahl der Erkennungen von sch√§dlichen JavaScript-Anh√§ngen, die Win32 / Filecoder.Shade verteilen.</i>  <i>Daten vom 1. bis 24. Januar 2019</i> <br><br>  Nach unserer Analyse beginnt ein typischer Angriff der Januar-Kampagne damit, dass das Opfer einen Brief in russischer Sprache mit dem ZIP-Archiv info.zip oder inf.zip im Anhang erh√§lt. <br><br>  Briefe werden als offizielle Anfragen legitimer russischer Unternehmen getarnt.  Wir haben den Newsletter im Auftrag der Binbank (seit 2019 mit der Otkritie Bank fusioniert) und der Einzelhandelskette Magnit gesehen.  Der Text im Bild unten. <br><br><img src="https://habrastorage.org/webt/eb/oa/-6/eboa-6ajfij5emkswmuleyvzv6o.png"><br>  <i>Abbildung 4. Beispiel f√ºr ein Spam-Mailing, das in der Januar-Kampagne verwendet wurde</i> <br><br>  Das Zip-Archiv enth√§lt eine Javascript-Datei namens Information.js.  Nach dem Extrahieren und Ausf√ºhren wird die Datei von einem b√∂swilligen Bootloader heruntergeladen, der von ESET-Produkten als Win32 / Injector erkannt wurde.  Der Bootloader entschl√ºsselt und startet die endg√ºltige Nutzlast - den Shade-Encoder. <br><br>  Der b√∂swillige Downloader wird von der URL kompromittierter legitimer WordPress-Sites heruntergeladen und dort als Bild getarnt.  Um WordPress-Seiten zu gef√§hrden, verwenden Angreifer einen massiven automatisierten Brute-Force-Angriff mit Bots.  Unsere Telemetrie erfasst Hunderte von URLs, die vom b√∂swilligen Bootloader gehostet werden. Alle Adressen enden mit der Zeichenfolge ssj.jpg. <br><br>  Der Bootloader ist mit einer ung√ºltigen digitalen Signatur signiert, die angeblich von Comodo ausgestellt wurde.  Der Wert des Signer-Informationsfelds und des Zeitstempels sind f√ºr jede Probe eindeutig. <br><br><img src="https://habrastorage.org/webt/3i/ym/vd/3iymvdxpiz5r98h4uxmbdzeeumm.png"><br>  <i>Abbildung 5. Gef√§lschte digitale Signatur, die vom b√∂swilligen Bootloader verwendet wird</i> <br><br>  Dar√ºber hinaus versucht der Bootloader, sich zu tarnen, indem er sich als legitimer Systemprozess f√ºr den Client Server-Laufzeitprozess (csrss.exe) ausgibt.  Es kopiert sich selbst nach C: \ ProgramData \ Windows \ csrss.ex, wobei Windows der vom Bootloader erstellte versteckte Ordner ist.  Normalerweise ist dieser Ordner in ProgramData nicht vorhanden. <br><br><img src="https://habrastorage.org/webt/9x/j_/kg/9xj_kginwpcjo9is6qwfi1wopk0.png"><br>  <i>Abbildung 6. Sch√§dliche Software, die ein Systemprozess ist und Versionsinformationen verwendet, die aus einer legitimen Bin√§rdatei in Windows Server 2012 R2 kopiert wurden</i> <br><br><h3>  Schattencodierer </h3><br>  Die letzte Nutzlast ist der Shade (Troldesh) Encoder.  Es wurde erstmals Ende 2014 in freier Wildbahn entdeckt und seitdem wiederholt aktualisiert.  Shade verschl√ºsselt eine Vielzahl von Dateien auf lokalen Laufwerken.  In der neuen Kampagne f√ºgt er verschl√ºsselten Dateien die Erweiterung .crypted000007 hinzu. <br><br>  Das Opfer erh√§lt Zahlungsanweisungen in russischer und englischer Sprache in einer TXT-Datei, die auf dem infizierten Computer gespeichert ist.  Der Text ist der gleiche wie in der letzten Kampagne im Oktober 2018. <br><br><img src="https://habrastorage.org/webt/ya/nb/-7/yanb-7sxftal1iok1hpyaoyvows.png"><br>  <i>Abbildung 7. Schattenr√ºckkaufanforderungen, Januar 2019</i> <br><br><h3>  Kompromissindikatoren </h3><br>  <b>Beispiele f√ºr Hashes b√∂sartiger ZIP-Anh√§nge</b> <br> <code>0A76B1761EFB5AE9B70AF7850EFB77C740C26F82 <br> D072C6C25FEDB2DDF5582FA705255834D9BC9955 <br> 80FDB89B5293C4426AD4D6C32CDC7E5AE32E969A <br> 5DD83A36DDA8C12AE77F8F65A1BEA804A1DF8E8B <br> 6EA6A1F6CA1B0573C139239C41B8820AED24F6AC <br> 43FD3999FB78C1C3ED9DE4BD41BCF206B74D2C76</code> <br> <br>  ESET-Erkennung: JS / Danger.ScriptAttachment <br><br>  <b>JavaScript Loader Hash-Beispiele</b> <br> <code>37A70B19934A71DC3E44201A451C89E8FF485009 <br> 08C8649E0B7ED2F393A3A9E3ECED89581E0F9C9E <br> E6A7DAF3B1348AB376A6840FF12F36A137D74202 <br> 1F1D2EEC68BBEC77AFAE4631419E900C30E09C2F <br> CC4BD14B5C6085CFF623A6244E0CAEE2F0EBAF8C</code> <br> <br>  ESET-Erkennung: Win32 / Injector <br><br>  <b>Beispiele f√ºr Shade Encryptor Hashes</b> <br> <code>FEB458152108F81B3525B9AED2F6EB0F22AF0866 <br> 7AB40CD49B54427C607327FFF7AD879F926F685F <br> 441CFA1600E771AA8A78482963EBF278C297F81A <br> 9023B108989B61223C9DC23A8FB1EF7CD82EA66B <br> D8418DF846E93DA657312ACD64A671887E8D0FA7</code> <br> <br>  ESET-Erkennung: Win32 / Filecoder.Shade <br><br>  <b>Kennzeichenfolge in den URLs, in denen sich der Shade-Encoder befindet</b> <br> <code>hxxp://[redacted]/ssj.jpg</code> </div> </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de437982/">https://habr.com/ru/post/de437982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de437972/index.html">PHP f√ºr Anf√§nger. Die Sitzung</a></li>
<li><a href="../de437974/index.html">Wie gewinne ich digitale WorldSkills? An einem praktischen Beispiel</a></li>
<li><a href="../de437976/index.html">"Vkontakte" darf einzelne Unterlagen vor der Polizei verbergen</a></li>
<li><a href="../de437978/index.html">Willkommen beim SphinxSearch-Meetup SuperJob</a></li>
<li><a href="../de437980/index.html">Offenes Webinar ‚ÄûPaarweise Testmethode beim Black-Box-Testen‚Äú</a></li>
<li><a href="../de437984/index.html">Threading in Node.js: Modul worker_threads</a></li>
<li><a href="../de437986/index.html">Warum ist TypeScript das Herzst√ºck jeder neuen PayPal-Webanwendung?</a></li>
<li><a href="../de437988/index.html">React Tutorial, Teil 12: Workshop, Phase 3 TODO-Anwendung</a></li>
<li><a href="../de437990/index.html">React Tutorial Teil 13: Klassenbasierte Komponenten</a></li>
<li><a href="../de437992/index.html">Microservices. Versionierung in kontinuierlichen Integrations- und Bereitstellungssystemen CI / CD-Fallstudie mit TFS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>