<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤦🏿 🥢 🤟🏻 JVM Internals, Teil 1 - Klassenlader 🍊 💆🏽 ☦️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine Übersetzung des Artikels wurde speziell für Studenten des Java Developer- Kurses erstellt. 



 In dieser Artikelserie werde ich darüber sprechen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JVM Internals, Teil 1 - Klassenlader</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/468193/">  <i>Eine Übersetzung des Artikels wurde speziell für Studenten des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Java Developer-</a> Kurses erstellt.</i> <br><br><img src="https://habrastorage.org/webt/77/f2/h9/77f2h9u5_t1kz85hy6tnqkhak8k.png"><br><hr><br>  In dieser Artikelserie werde ich darüber sprechen, wie die Java Virtual Machine funktioniert.  Heute schauen wir uns den Mechanismus zum Laden von Klassen in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JVM an</a> . <a name="habracut"></a><br><br>  Die Java Virtual Machine ist das Herzstück des Java-Technologie-Ökosystems.  Es ermöglicht Java-Programmen, das Prinzip „Einmal überall ausführen“ zu implementieren.  Wie andere virtuelle Maschinen ist die JVM ein abstrakter Computer.  Die Hauptaufgabe der JVM besteht darin, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klassendateien</a> zu laden und den darin enthaltenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bytecode</a> auszuführen. <br><br>  Die JVM enthält verschiedene Komponenten, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Klassenlader</a> , einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Garbage Collector</a> (automatische Speicherverwaltung), einen Interpreter, einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JIT-</a> Compiler und Flusssteuerungskomponenten.  In diesem Artikel werden wir uns den Klassenlader ansehen. <br><br>  Der Klassenladeprogramm lädt Klassendateien sowohl für Ihre Anwendung als auch für die Java-API.  In die virtuelle Maschine werden nur die Java API-Klassendateien geladen, die beim Ausführen des Programms wirklich erforderlich sind. <br><br>  Der Bytecode wird von der Ausführungsmaschine ausgeführt. <br><br><img src="https://habrastorage.org/webt/eu/ju/xj/eujuxjvw92kl2ul2uoydeyioici.jpeg"><br><br><h3>  Was ist Klassenladen? </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Das</a> Laden von Klassen ist das dynamische Suchen und Laden von Typen (Klassen und Schnittstellen) während der Programmausführung.  Typdaten befinden sich in binären Klassendateien. <br><br><h3>  Schritte zum Laden von Klassen </h3><br>  Das Klassenladeprogramm-Subsystem ist nicht nur für das Suchen und Importieren von binären Klassendaten verantwortlich.  Es führt auch die Validierung importierter Klassen durch, weist Speicher für Klassenvariablen zu und initialisiert ihn und hilft beim Auflösen symbolischer Verknüpfungen.  Diese Aktionen werden in der folgenden Reihenfolge ausgeführt: <br><br><ul><li>  <b>Laden</b> - Suchen und Importieren von Binärdaten nach einem Typ anhand seines Namens, Erstellen einer Klasse oder Schnittstelle aus dieser Binärdarstellung. </li><li>  <b>Verknüpfen (Verknüpfen)</b> - Überprüfung, Vorbereitung und optional Erlaubnis: <br><ul><li>  <b>Überprüfung</b> - Überprüfung der Richtigkeit des importierten Typs. </li><li>  <b>Vorbereitung</b> - Zuweisen von Speicher für statische Klassenvariablen und Initialisieren des Speichers mit Standardwerten. </li><li>  <b>Lösung</b> - Konvertieren Sie symbolische Links in direkte Links. </li></ul></li><li>  <b>Die Initialisierung</b> ist ein Aufruf von Java-Code, der Klassenvariablen mit ihren korrekten Anfangswerten initialisiert. </li></ul><br><blockquote>  Hinweis - Der Klassenlader ist neben dem Laden von Klassen auch für das Auffinden von Ressourcen verantwortlich.  Eine Ressource sind einige Daten (z. B. eine ".class" -Datei, Konfigurationsdaten, Bilder), die mithilfe eines abstrakten Pfads identifiziert werden, der durch ein "/" -Zeichen getrennt ist.  Ressourcen werden normalerweise mit einer Anwendung oder Bibliothek gepackt, damit sie in Anwendungs- oder Bibliothekscode verwendet werden können. </blockquote><h3>  Klassenlademechanismus in Java </h3><br>  <i>Anmerkung des Übersetzers - In diesem Abschnitt wird das Verhalten für Java &lt;9 beschrieben. In Java 9+ wurden kleine Änderungen vorgenommen, die im Folgenden beschrieben werden.</i> <br><br>  Java verwendet das Delegierungsmodell zum Laden von Klassen.  Die Grundidee ist, dass jeder Klassenlader einen "übergeordneten" Lader hat.  Wenn eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse geladen wird</a> , „delegiert“ der Loader die Klassensuche an sein übergeordnetes Element, bevor er selbst nach der Klasse sucht. <br><br>  Das Class Loader-Delegierungsmodell ist ein Diagramm von Loadern, die Ladeanforderungen aneinander weiterleiten.  Die Wurzel dieses Diagramms ist der Bootstrap-Bootloader.  Klassenlader werden mit einem übergeordneten Element erstellt, an das sie das Laden delegieren und an folgenden Stellen nach der Klasse suchen können: <br><br><ul><li>  Cache </li><li>  Der Elternteil </li><li>  Bootloader selbst </li></ul><br>  Der Klassenladeprogramm überprüft zunächst, ob die Klasse zuvor geladen wurde.  Wenn ja, wird dieselbe Klasse zurückgegeben, die beim letzten Mal zurückgegeben wurde (die im Cache gespeicherte Klasse).  Wenn nicht, hat der Elternteil die Möglichkeit, die Klasse zu laden.  Diese beiden Schritte werden in der Tiefe rekursiv wiederholt.  Wenn das übergeordnete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Element</a> null zurückgibt (oder eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ClassNotFoundException auslöst</a> ), sucht der Loader selbst nach der Klasse. <br><br>  Die Klasse wird von dem Loader geladen, der dem Stamm am nächsten liegt, da das Recht zum ersten Laden der Klasse immer dem übergeordneten Loader gewährt wird.  Auf diese Weise kann der Loader nur Klassen sehen, die unabhängig von seinen Eltern oder Vorfahren geladen wurden.  Klassen, die von untergeordneten Ladern geladen wurden, können nicht angezeigt werden. <br><br>  Die Java SE Platform API hat in der Vergangenheit zwei Klassenlader definiert: <br><br>  <b>Bootstrap-Klassenladeprogramm (Basis-, Primärladeprogramm)</b> - Lädt Klassen aus dem Bootstrap-Klassenpfad. <br><br>  <b>Systemklassenlader (</b> übergeordneter <b>Lader)</b> - die übergeordnete Klasse für die neuen Klassenlader und in der Regel der Klassenlader, mit dem die Anwendung geladen und ausgeführt wird. <br><br><h3>  Lader der Klasse JDK 9+ </h3><br>  <b>Application Class Loader</b> - Wird häufig zum Laden von Anwendungsklassen aus einem Klassenpfad verwendet.  Es ist auch der Standard-Bootloader für einige JDK-Module, die Dienstprogramme enthalten oder die Dienstprogramm-API exportieren.  ( <i>Anmerkung des Übersetzers: zum Beispiel <code>jdk.jconsole</code> , <code>jdk.jshell</code> usw.</i> ) <br><br>  <b>Platform Class Loader</b> - Lädt ausgewählte (basierend auf Sicherheit / Berechtigungen) Java SE- und JDK-Module.  Zum Beispiel java.sql. <br><br>  <b>Bootstrap Class Loader</b> - Lädt die Java SE- und JDK-Kernmodule. <br><br>  Diese drei integrierten Klassenlader arbeiten wie folgt zusammen: <br><br><ul><li>  <i>Der Loader der Anwendungsklasse</i> sucht zuerst nach benannten Modulen, die für alle integrierten Loader definiert sind.  Wenn für einen dieser Loader ein geeignetes Modul definiert ist, lädt dieser Loader die Klasse.  Wenn die Klasse nicht in dem für einen dieser Loader definierten benannten Modul gefunden wird, delegiert der Loader der Anwendungsklasse sie an das übergeordnete Modul.  Wenn die Klasse vom übergeordneten Element nicht gefunden wird, sucht der Anwendungsklassenlader im Klassenpfad danach.  Im Klassenpfad gefundene Klassen werden als Mitglieder des unbenannten Moduls dieses Loaders geladen. </li><li>  <i>Der Plattformklassenlader</i> sucht nach benannten Modulen, die für alle integrierten Lader definiert sind.  Wenn für einen dieser Loader ein geeignetes Modul definiert ist, lädt dieser Loader die Klasse.  Wenn die Klasse nicht in dem für einen dieser Loader definierten benannten Modul gefunden wird, delegiert der Plattformklassenlader sie an das übergeordnete Modul. </li><li>  <i>Der Bootstrap-Klassenlader</i> sucht nach benannten Modulen, die für sich selbst definiert sind.  Wenn die Klasse nicht in dem für den Bootstrap-Bootloader definierten benannten Modul gefunden wird, sucht der Bootstrap-Loader mit dem Parameter -Xbootclasspath / a nach Dateien und Verzeichnissen, die dem Bootstrap-Klassenpfad hinzugefügt wurden (ermöglicht das Hinzufügen von Dateien und Verzeichnissen zum Bootstrap-Klassenpfad).  Im Bootstrap-Klassenpfad gefundene Klassen werden als Mitglieder des unbenannten Moduls dieses Loaders geladen. </li></ul><br>  Zum Anzeigen der integrierten Klassenlader können Sie den folgenden Code verwenden: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> ru.deft.homework; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.Date; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BuiltInClassLoadersDemo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ BuiltInClassLoadersDemo demoObject = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BuiltInClassLoadersDemo(); ClassLoader applicationClassLoader = demoObject.getClass().getClassLoader(); printClassLoaderDetails(applicationClassLoader); <span class="hljs-comment"><span class="hljs-comment">// java.sql classes are loaded by platform classloader java.sql.Date now = new Date(System.currentTimeMillis()); ClassLoader platformClassLoder = now.getClass().getClassLoader(); printClassLoaderDetails(platformClassLoder); // java.lang classes are loaded by bootstrap classloader ClassLoader bootstrapClassLoder = args.getClass().getClassLoader(); printClassLoaderDetails(bootstrapClassLoder); } private static void printClassLoaderDetails(ClassLoader classLoader) { // bootstrap classloader is represented by null in JVM if (classLoader != null) { System.out.println("ClassLoader name : " + classLoader.getName()); System.out.println("ClassLoader class : " + classLoader.getClass().getName()); } else { System.out.println("Bootstrap classloader"); } } }</span></span></code> </pre> <br>  Wenn Sie diesen Code auf Amazon Corretto 11.0.3 ausführen, das auf mir installiert ist, erhalten Sie das folgende Ergebnis: <br><br><pre> <code class="java hljs">ClassLoader name : app ClassLoader <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jdk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">internal</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoaders</span></span></span><span class="hljs-class">$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">platform</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jdk</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">internal</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loader</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoaders</span></span></span><span class="hljs-class">$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PlatformClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bootstrap</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">classloader</span></span></span></span></code> </pre> <br>  Weitere Informationen zur ClassLoader-API finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier (JDK 11)</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de468193/">https://habr.com/ru/post/de468193/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de468179/index.html">Analyse: Wie die Infrastruktur des russischen Wertpapiermarktes funktioniert</a></li>
<li><a href="../de468181/index.html">Silent Trinity: Erkundung einer neuen Version des Post-Exploitation-Frameworks</a></li>
<li><a href="../de468185/index.html">AWS EC2 Service und arbeiten damit</a></li>
<li><a href="../de468189/index.html">Verbessern Sie die JavaScript-Debugging-Fähigkeiten mithilfe von Konsolentricks</a></li>
<li><a href="../de468191/index.html">RubyRussia 2019: Nikolay Sverchkov über Serverless</a></li>
<li><a href="../de468195/index.html">Warum sind meine Finanzen von Beeline abhängig?</a></li>
<li><a href="../de468197/index.html">Wie wir ein großes Legacy-Netzwerk automatisieren</a></li>
<li><a href="../de468203/index.html">Rätsel auf der Suche nach der perfekten Chance</a></li>
<li><a href="../de468205/index.html">GIT von innen: Einführung (Übersetzung)</a></li>
<li><a href="../de468207/index.html">Wie wir Zabbix aktualisiert haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>