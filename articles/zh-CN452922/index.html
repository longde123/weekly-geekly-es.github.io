<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤹🏾 🦑 🐷 灵活的CSS网格表 ✉️ 🤜🏽 ✊🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="查看线索列表（冷接触） 

 自从我们开始以来，我终于可以谈谈过去两年来我一直在从事的一个秘密项目。 团队合作CRM的有趣功能之一是列表视图。 

 这是一个功能强大的组件，在应用程序中发生了七次。 实际上，有一张关于类固醇的表格。 我可以说很多，但我不想让您感到无聊。 我将重点介绍如何仅用几行CS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>灵活的CSS网格表</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452922/"><a href=""><img src="https://habrastorage.org/webt/id/sg/ye/idsgyex13y6jxpp3ylbvnqrvsxs.png"></a> <br>  <i><font color="gray">查看线索列表（冷接触）</font></i> <br><br> 自从我们开始以来，我终于可以谈谈过去两年来我一直在从事的一个秘密项目。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">团队合作CRM</a>的有趣功能之一是列表视图。 <br><br> 这是一个功能强大的组件，在应用程序中发生了七次。 实际上，有一张关于类固醇的表格。 我可以说很多，但我不想让您感到无聊。 我将重点介绍如何仅用几行CSS（网格）来实现这种灵活性。 即，我们如何布置大量数据表，如何支持列大小调整等等。 <br><br> 首先，需要从这些表的目的和设计任务入手说明上下文。 如果不感兴趣，请立即立即进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">技术实施</a> 。 <br><a name="habracut"></a><br> 首先，我们的解决方案使客户能够快速查看列表（例如，线索或联系人）并注意重要的细节。 它看起来不像是Excel电子表格-如果其中有很多，我们最好处理数据布局。 <br><br> 绝对一切都可以在自适应灵活设计中进行。 我们从最窄的选项开始，然后根据内容，设计和用例（我们没有面向设备的断点）自定义布局。 <br><br> 在最小屏幕宽度下，列垂直堆叠，占据整个屏幕宽度。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c72/5a1/2d8/c725a12d8eab7988110693b9616428a2.png"></div><br>  <i><font color="gray">列表在狭窄的屏幕上看起来像什么</font></i> <br><br> 灵活的表格并不容易做到。 您可以从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">几个现有模板中</a>进行选择。 考虑用户正在寻找什么信息并明智地选择。 <br><br> 一旦我们在屏幕上有足够的像素，我们就会切换到更典型的布局，以使列...成为列。 然后，布局没有重大变化，但我们仍然希望为客户显示尽可能方便的列。 <br><br> 假设我们有很多列（稍后我们将介绍用户如何自定义它们）。 首先，桌子至少应填满屏幕宽度。 其次，列的宽度应由其内容和值的类型确定。 例如，短/长文本，日期，数字，URL等。带有日期的列应比长文本的列占用更少的空间。 <br><br> 列必须具有最小宽度。 结果通常是一个可以垂直和水平滚动的表格。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f3/29d/eae/4f329deae55f9b04370786801d217e92.gif"><br>  <i><font color="gray">布局如何取决于窗口的宽度。</font></i>  <i><font color="gray">抱歉，GIF抽搐了，稍后我将给您一些交互式示例。</font></i> <br><br> 首先，最大程度地使用表格的旧式常规CSS。 然后，我们使用CSS Grid对其进行改进。 然后，我将展示用户如何使用Grid工具来调整列的大小，而这对于常规CSS而言不便得多。 <br><br><a name="1"></a><h1> 好了，已经展示了CSS Grid </h1><br> 我不是CSS Grid专家，但我喜欢它。 这是一个非常强大且简单的工具，它以最少的代码实现了复杂的布局。 在这里，我将跳过技术介绍。 您可以阅读Rachel Andrew <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">撰写的The New CSS Layouts</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">The Complete Grid Guide</a> 。 当您结束思考此工具一生的用途时，请回到我身边。 <br><br> 首先，将<code>display:grid</code>应用于<code>&lt;table&gt;</code>以将表转换为网格。 这不会破坏任何内容：如果浏览器不支持Grid，则它将使用<code>display:table</code> 。 子元素<code>&lt;thead&gt;</code>和<code>&lt;tbody&gt;</code>成为网格元素。 我们不需要考虑<code>&lt;thead&gt;</code> ， <code>&lt;tbody&gt;</code>甚至<code>&lt;tr&gt;</code> 。 我们想通过对每个栅格应用<code>display:grid</code> （即，栅格内部的栅格）在此栅格上布置<code>&lt;th&gt;</code>和<code>&lt;td&gt;</code> ，但这并不理想。 每个<code>&lt;tr&gt;</code>网格都将独立于其他网格，这并不好（稍后您将看到Flexbox同样的问题）。 <br><br> 解决方法是使用<code>display:contents</code> <code>&lt;thead&gt;</code> ， <code>&lt;tbody&gt;</code>和<code>&lt;tr&gt;</code> 。 这基本上将它们从网格布局中删除，从而推动子元素（ <code>&lt;th&gt;</code>和<code>&lt;td&gt;</code> ）。 <br><br> 然后，我们使用魔术规则<code>grid-template-columns</code>控制网格元素。 是的，只有一行CSS。 例如，如果我们有一个日期列和一个URL列，它将看起来像这样： <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">grid-template-columns</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">minmax</span></span>(150<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span>, 1<span class="hljs-selector-class"><span class="hljs-selector-class">.33fr</span></span>) <span class="hljs-selector-tag"><span class="hljs-selector-tag">minmax</span></span>(150<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span>, 2<span class="hljs-selector-class"><span class="hljs-selector-class">.33fr</span></span>);</code> </pre> <br> 我们对所有列使用相同的最小大小，但是最大值（ <code>fr</code> ）由列的数据类型确定。 我尝试了<code>auto</code>和<code>max-content</code> ，但是我们想出了一个更好的选择。 这是一个简化的示例： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">带有code的交互式表</a> 。 尝试调整窗口大小。 <br><br><h1> 使用网格更改列宽 </h1><br> 此外，在我们的表格中，您可以交换，更改宽度并隐藏列。 后者之所以重要，是因为它支持许多具有不同类型数据的列：这些是元素本身的属性（例如，线索），相关元素的属性（例如，与线索相关的公司）和自定义字段。 <br><br> 例如，用户可以为称为“出生日期”的联系人创建自定义字段（日期），系统将为每个联系人对其进行跟踪。 <br><br> 由于创建自定义字段时，选择了“日期”类型，因此系统将考虑该类型来处理该字段。 首先，我将解释宽度如何变化。 <br><br><ol><li> 当用户将光标移到列标题上方时，将在右侧显示调整大小标记。 我们在调整大小滑块上监听<code>mousedown</code>事件。 <br></li><li> 当用户单击滑块时，我们将绑定其他方法来侦听<code>mousemove</code>和<code>mousedown</code>事件（到<code>window</code> ）。 在这一阶段，我们还添加了一些装饰类。 <br></li><li> 当用户移动鼠标时，我们将考虑光标位置，表格滚动位置和设置的最小值来计算新的列宽。 然后我们重新设置<code>&lt;table&gt;</code>的<code>grid-template-columns</code>规则（通过<code>style</code>属性），这次用一个像素替换最大值（ <code>fr</code> ）。 例如， <code>grid-template-columns: minmax(150px, 1.33fr) 296px;</code>  。 这是使用<code>requestAnimationFrame</code>完成的，以提供尽可能平滑的动画。 <br></li><li> 当<code>mouseup</code>到达时，我们取消事件侦听器并删除类。 </li></ol><br> 尝试<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这个简化的示例</a> 。 <br><br> 值得注意的是，仅更新DOM中的一个元素，而不更新每个单元就足够了。 <br><br> 我们总是根据触摸输入来开发UI，但是在这种情况下，不支持它是很正常的。 这太准确了。 即使我想在触摸屏上调整列的大小，也可能希望进行其他交互，例如通过多点触摸手势。 <br><br><h1> 固定宽度列 </h1><br> 您可能已经注意到您对某些事情保持沉默。 实际上，不仅一列的宽度改变，而且所有列的宽度改变。 也许您甚至没有注意到这一点，因为这就是它的工作方式。 <br><br> 最初，我以为用户会喜欢它：拉伸或压缩列时，其他人也会进行调整。 如果这些列恰好填满了屏幕的宽度，并且您将其中的一列缩小了，那么如果其中的内容不适合一行，则其他列可以扩大。 试试<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这个例子</a> 。 <br><br> 但是经过一些用户测试，事实证明，对于人们来说，这是一种意外的行为。 当用户的动作引起不可预测的副作用时，用户会感到一定程度的失控。 <br><br> 我们不应该基于哪些列交互而哪些不交互来进行假设。 在调整一列的大小时，用户已经可以隐式地确定其余列的宽度是完美的。 <br><br> 因此，如果您是第一次打开该应用程序，则以最佳方式对列进行布局。 如果更改屏幕大小，则列也将根据相同原理更改。 触摸滑块以调整任何列的大小后，所有可见列的宽度就会固定。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/516/c6d/d4f/516c6dd4f7ebed8a02774eedf20081cc.gif"><br>  <i><font color="gray">更改列宽之前，期间和之后。</font></i>  <i><font color="gray">再次抱歉，GIF抽搐了一下</font></i> <br><br> 每次调整列大小或固定列大小时，我们都会创建一个独立的localStorage记录，该记录将列标识符与像素值匹配以保留用户首选项。 <br><br> 我不记得为什么我们决定设置一个固定的像素值，而不是自适应选项。 也许是为了简单起见。 或因为在不支持Grid和<code>display:contents</code>回滚到了一种更古老的方法来调整列宽。 <br><br> 在任何情况下，自适应选项都可能与用户的意图不符。 我们不能认为对他来说最重要的事情是使所有列变小，以便它们都保留在屏幕上。 如果某人更改了列的宽度，则他想在此列中看到一定数量的内容。 如果我们有一个自适应块，然后它在一个较小的窗口中变窄，那么我们将忽略该人的选择。 他将不得不再次更改列宽才能看到相同的内容。 用户不太可能会想：“嗯，我希望此列占据窗口的20％，即使我更改了它也是如此。” 但是，我过于深入地研究了边界问题：实际上，用户很少调整窗口的大小。 <br><br><h1> 移动和删除列 </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/35a/e5f/5c2/35ae5f5c24401049b45f65802202708c.png"><br>  <i><font color="gray">自定义显示列的界面</font></i> <br><br> 假设用户通过此界面更改了一组列。 如果先前未更改任何选定列，则将使用默认值<code>grid-template-column</code>来显示它们，具体取决于数据类型。 例如， <code>minmax(150px, 3.33fr)</code> 。 <br><br> 如果在localStorage中列的宽度是固定的，我们将固定<i>所有</i>选定列的宽度，并将这些值存储在localStorage中。 <br><br> 随着时间的流逝，越来越多的列保持固定的宽度。 对于用户而言，返回到响应式设计的唯一方法是重置列。 <br><br> 我们还将列标识符数组存储在localStorage中，与宽度条目分开。 <br><br><h1>  “为什么不只使用{{libraryName}}？” </h1><br> 使用JavaScript库，该解决方案将变得笨拙，棘手，不会提供交互性，甚至可能根本不支持&lt;table&gt;。 我也不想写这样的东西。 我以为：“一定有更好的办法。” <br><br><h1>  “为什么不只使用Flexbox？” </h1><br> 每行将独立评估/显示。 由于内容量不同，该列可能无法与上面的列对齐。 <br><br> 对于内部具有垂直分组单元的列，我可以切换到&lt;div&gt;。 但是不想这样做。 我想使用&lt;table&gt;。 另外，我们很容易遇到其他问题：例如，列之间的单元格高度不匹配。 <br><br><h1>  “为什么不只使用<code>&lt;colgroup&gt;</code> ？” </h1><br> 实际上， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">&lt;colgroup&gt;</a>是一个方便的旧元素。 在使用&lt;col&gt;定义列之后，应用于一个的样式将有效地应用于该列中的所有单元格。 <br><br> 但是，事实证明，这种解决方案太有限了。 我们尝试过，但很快就拒绝了。 太快了，我不记得确切的问题了。 我几乎可以肯定，不可能达到理想的适应性水平，并且它不适用于Flexbox和Grid。 <br><br><h1>  “为什么不只使用表格布局：固定？” </h1><br> 我可以在<code>&lt;table&gt;</code>上应用<code>table-layout: fixed</code>规则，并将列宽设置为百分比。 但是查看示例并遵循此规则，我得到的印象是它仅适用于100％宽的桌子。 此外，调整一列的大小会更改其他列的大小，以达到100％的总宽度。 <br><br><h1>  “但是您可以通过简单的桌子来度过！” </h1><br> 是的，开箱即用的表格可以处理许多聪明的事情，但是它们不能有效地支持我想要实现的所有功能。 不同意吗？ 好吧，向导，教我。 <br><br><h1> 不要对显示内容走得太远 </h1><br>  <code>display: contents</code>值允许保存表布局。 仅在确实需要时使用它。 一些浏览器在可访问性和屏幕阅读器上存在或至少存在问题。 <br><br> 我们发现了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">奇怪的</a> <code>display: contents</code>在Firefox中通过本机拖放操作导致<code>display: contents</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">错误</a> 。 <br><br> 幸运的是，将很快释放一个子网格功能，该功能将允许子元素正确集成到网格中。 在我们的应用程序中，我们只想简化标记，但是子网将为通向多维网格的狂欢敞开大门。 请参阅<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“为什么显示：内容不是CSS网格布局”</a> 。 <br><br><h1> 我想我忘记了什么 </h1><br> 调整列大小时似乎仍然存在文本溢出的问题，但我记不清了。 <br><br> 为了在向下滚动时保存表头，我们使用<code>position: sticky</code> 。 这是一个很大的增强，并且在较旧的浏览器中会降级得很好。 但是，对于IE11用户，我们有备用JavaScript。 实际上，我不推荐<code>position: sticky</code>由于水平滚动的困难而发<code>position: sticky</code> 。 <br><br> 我什至没有提到我们列表视图的某些功能。 例如，用户可以应用，保存和交换自定义过滤器（例如，与欧洲的潜在客户展示500美元以上的销售线索）。 在这些过滤器中，您可以记住一组列，以始终显示特定工作流程的特定列。 <br><br> 很快，我们将在列表视图中实现批量编辑，并将自定义视图导出到CSV。 <br><br> 无论如何，感谢您的阅读。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN452922/">https://habr.com/ru/post/zh-CN452922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN452906/index.html">JavaScript引擎：它们如何工作？ 从调用堆栈到承诺，（几乎）您需要了解的所有内容</a></li>
<li><a href="../zh-CN452908/index.html">Selenium WebDriver-使用Grafana和InfluxDB的实时测试指标</a></li>
<li><a href="../zh-CN452910/index.html">哈Ha！ 你好特康</a></li>
<li><a href="../zh-CN452914/index.html">面向微笑不怕实验的人，Scala上的ML面带微笑</a></li>
<li><a href="../zh-CN452916/index.html">起来吧 脊柱外科：什么时候做，有什么危险</a></li>
<li><a href="../zh-CN452924/index.html">您需要采取什么措施来防止您的Google帐户被盗</a></li>
<li><a href="../zh-CN452926/index.html">静态测试或保存Private Ryan</a></li>
<li><a href="../zh-CN452928/index.html">我们从错误初始化的数据存储中还原虚拟机。 一个胡说八道的结局</a></li>
<li><a href="../zh-CN452938/index.html">3D打印机的喷枪又回来了，现在它们不再能停下来了</a></li>
<li><a href="../zh-CN452942/index.html">GeekBrains与编程专家举行12次免费在线会议</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>