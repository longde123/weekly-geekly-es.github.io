<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❣️ 👃🏽 👩🏿‍🍳 ACS meines LCD - Sicherheit an zwei Schrauben 🏕️ 🏂🏼 🌑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich beeile mich, die Leser zu warnen: Dieser Artikel dient nur zu Informationszwecken und fordert in keinem Fall illegale Handlungen. Der Autor ist ni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ACS meines LCD - Sicherheit an zwei Schrauben</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439278/"> Ich beeile mich, die Leser zu warnen: Dieser Artikel dient nur zu Informationszwecken und fordert in keinem Fall illegale Handlungen.  Der Autor ist nicht verantwortlich für illegale Handlungen von Personen, die die Informationen in diesem Artikel verwenden. <br><br><img src="https://habrastorage.org/webt/yk/fs/p-/ykfsp-giznlsydndwjjukl8hzyw.png"><br><br>  Grüße an den Leser.  Heute möchte ich über die Sicherheit von Zugangskontroll- und -verwaltungssystemen (ACS) im Allgemeinen und das Beispiel meines LCD sprechen.  Die wichtigsten Sicherheitslücken werden untersucht sowie ein erfolgreicher Versuch, Schlüssel zu kopieren.  Alle Manipulationen sind hauptsächlich Hardware-Natur. <br><a name="habracut"></a><br>  In meiner Wohnanlage ist das Türsprechsystem Sinthesi S2 sowie der von der Urmet Group hergestellte Zugangssystem Innenhof / Eingang / Boden installiert.  So cool sah das Street Panel aus. <br><br><img src="https://habrastorage.org/webt/fm/mr/b1/fmmrb1xbkfetetbxhurozddrtfi.png"><br><br>  bis ich eines Tages so aussah: <br><br><img src="https://habrastorage.org/webt/fv/7q/hq/fv7qhqsdztc7j5h9la_ww4k38sw.png"><br><br>  Sie blieb ein paar Tage so und wanderte dann in einen Müllcontainer in der Nähe.  Es hatte nur einen Leser und eine Tastatur.  Da einer der Bereiche in meinem Unternehmen die Entwicklung von HF-Lesegeräten ist, konnte ich nicht widerstehen und entschied mich, dieses RFID-Lesegerät genauer zu untersuchen.  Aus der Dokumentation habe ich nur einen riesigen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Katalog gefunden,</a> aus dem geschlossen werden kann, dass es sich um FD-020-017 handelt - einen 13,56-MHz-Leser mit der Wiegand26-Schnittstelle.  Im Inneren befand sich ein Sandwich aus den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lesetafeln</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MFRC531</a> ) und MK mit BLE ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CC2541</a> ), das mit Schmelzkleber auf das Gehäuse geklebt war und eindeutig nicht für diese Platine entwickelt wurde. <br><br><img src="https://habrastorage.org/webt/-l/qq/yt/-lqqyti00ujmciyzmppzpkzcbn8.png"><br><br>  Das MK-Board ist anscheinend mit einer weichen Mischung geflutet, um das Radioteil vor Feuchtigkeit zu schützen.  Ich drehte das Brett in meinen Händen und verschob es. <br><br>  Bis vor kurzem interessierte mich das System nicht, da es teilweise gestartet wurde (nur Zugriffssperren funktionierten, aber sie hatten einen Zugangscode, den ich kannte und der keinen Schlüssel verwendete).  Nachdem das System vollständig gestartet und die Zugangscodes gelöscht worden waren, begann ich, es genauer zu untersuchen.  Es begann eine der Nächte, als ich nach Hause zurückkehrte und feststellte, dass die Tür des Vorraums bereits funktionierte und meine Frau bereits schlief.  Ich hatte nur Taschenartikel dabei, aber wie sich herausstellte, reichte dies aus, um die gesamte Elite-Sicherheit zu umgehen (wie Urmet versichert). <br><br><img src="https://habrastorage.org/webt/ip/9o/av/ip9oavphdqdmspjusi-wbwkvlsy.png"><br><br>  Alles, was ich brauchte, war, die 2 Schrauben, mit denen der Paneelrahmen befestigt war, mit dem Autoschlüssel zu lösen, die 2 Blöcke zu entfernen und mit demselben Schlüssel den Relaiskanal zu schließen, der zum Türschloss des Vorraums führt.  Alle ... <br>  Wenn ich nach diesem Vorfall einen anderen Hollywood-Film („Passengers“ (2016) auf KDPV) anschaue und sehe, wie die Super-Secret-Türen geöffnet werden, indem ich das Code-Panel entferne und Stifte auf die Tafel stecke (unbedingt mit Funken und einer spektakulären Türöffnung), sehe ich reale Situation. <br><br>  In meinem Gedächtnis haben die meisten ACS, die ich gesehen habe, Zugriff auf die Sperre direkt über das Codefeld, und dies ist die Hauptschwachstelle.  Alle Sicherheit wird durch ein paar Schrauben gewährleistet, die dieses Panel halten, und in der Überzeugung, dass dieses System zuverlässig ist.  Gleichzeitig ist es jedoch möglich, die Eintrittsschwelle (nennen wir es Schutz gegen eine Person mit einem Schraubenzieher) erheblich zu erhöhen, indem Schlösser mit Gehirnen verwendet werden, die über eine Schnittstelle gesteuert werden - auch wenn dies die einfachste ist.  Diese Maßnahme verringert die Wahrscheinlichkeit eines spontanen Eintritts drastisch. <br><br><h3>  Ausgangsdaten </h3><br>  ACS LCD als Ganzes, seine Funktionsweise, Reaktion auf andere Tasten sowie eine Möglichkeit, Tasten hinzuzufügen: <br><br><ul><li>  Ein kostenloser Schlüssel für die Wohnung wird ausgestellt, jeder nächste kostet 300 Rubel und ist im persönlichen Konto von ACS registriert.  Sie können nur aus Großbritannien kaufen.  Der LCD-Chat schrieb, dass Marktkopierer kein Duplikat erstellen könnten - das heißt, das System ist cooler als nur das Lesen der UID. </li><li>  Wenn der Leser eine andere Mifare-Karte vorlegt, zeigt er nicht einmal, dass er sie sieht. </li><li>  Wenn Sie den Schlüssel zu einer anderen Treppe / Etage bringen, nimmt der Leser eine Lesung auf, aber es passiert nichts. </li><li>  Beim Lesen des Inhalts der Schlüsselanhänger 8 und 12 werden die Blöcke ausgeblendet und haben einen anderen Zugriffsschlüssel als die bekannten Mifare-Schlüssel.  Das Geheimnis ist also irgendwo da draußen. </li></ul><br><img src="https://habrastorage.org/webt/nr/1k/xl/nr1kxljcz-vzxdgknnfcmyz0jh0.png"><br><br><h3>  Arbeitsbeginn </h3><br>  Zuerst habe ich Block0 (der UID- und Herstellerinformationen enthält) auf die Mifare Zero-Disc kopiert und überprüft, ob dies nicht ausreicht - der Schlüsselanhänger hat nicht funktioniert.  Der Leser reagierte nicht einmal auf die Präsentation eines solchen Klons.  Es wurde klar, dass Sie nach dem Schlüssel zu den Sektoren 8 und 12 suchen müssen. Nachdem ich alle verfügbaren Schmuckstücke gelesen hatte, sah ich, dass nur einer von ihnen 12 Blöcke gesperrt hat, der Rest ist Null, so dass es offensichtlich ist, dass die Magie in Block 8 enthalten ist. <br><br>  Es ist Zeit, einen begabten Leser zu finden und genauer zu untersuchen.  Wir haben also FD-020-017 - 13,56 MHz, Wiegand26-Schnittstelle.  Der MFRC531 und der CC2541 sind durch einen 10-poligen Kamm verbunden.  Und er hat perfekt am Tisch gearbeitet - ohne den Rest des Systems.  Reagierte auf die Tasten genauso wie die anderen Leser.  Lassen Sie uns zuerst sehen, was herausgeht: <br><br><img src="https://habrastorage.org/webt/kf/sy/wm/kfsywm6pgxzqcggydxffit8-nnw.png"><br><br>  Stille genau vor der Vorlage eines gültigen Schlüsselbunds.  Nach dem Lesen der Schnittstelle wird die Nachricht in voller Übereinstimmung mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wiegand26 hinterlassen</a> .  Also habe ich das Paket entschlüsselt, das mein Schlüssel sendet.  Mit Hilfe eines Multimeters habe ich die Pinbelegung wiederhergestellt. Es stellte sich heraus, dass die Chips über SPI kommunizieren.  Wir schließen den Analysator an, <br><br><img src="https://habrastorage.org/webt/2s/z6/pu/2sz6pu-h8fykc157m8vbc3xgfyy.png"><br><br>  Wir bringen einen gültigen Schlüsselbund mit und beobachten den Austausch per SPI: <br><br><img src="https://habrastorage.org/webt/j3/gd/ui/j3gduiwafbqwrjznhpjmvlq3p2u.png"><br><br>  Als nächstes begann ich, die Dokumentation für den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MFRC531-</a> Chip zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lesen</a> und ließ fast meine Hände fallen, als ich sah, dass er ein spezielles EEPROM zum Speichern von Schlüsseln hat.  Ich habe die Befehle zum Laden des Schlüssels gefunden: <br><br><img src="https://habrastorage.org/webt/gm/zb/x6/gmzbx6c4cu4de6ut89jbkfxkwbe.png"><br><br>  Der Befehl 0x0B wird aus dem EEPROM geladen, der Befehl 0x19 aus dem FIFO, der seinerseits den Schlüssel über SPI empfängt.  Es scheint, dass wenn Sie einen Schlüssel aus dem EEPROM laden, ich keine Chance habe, diesen Weg umzukehren, ABER zu meiner Überraschung gibt es keinen Austauschbefehl 0x0B, aber einen Befehl 0x19 <br><br><img src="https://habrastorage.org/webt/qj/wi/zk/qjwizk-mxiizgq5kgafox6puguu.png"><br><br>  Es bleibt nur, den Schlüssel entsprechend dem Format zu sammeln <br><br><img src="https://habrastorage.org/webt/rh/ef/ak/rhefak-ucxfeotu8c5_aps6xm0k.png"><br><br>  Und zum Schlüsselblatt hinzufügen. <br><br><img src="https://habrastorage.org/webt/tt/ga/nz/ttganzuuekb2ntx4xwjeucldgbm.png"><br><br>  Bingo !!!  Es stellte sich heraus, dass Block 8 mit 3 Bytes ungleich Null beginnt, die nur an Wiegand gehen, wenn Schlüsselanhänger und Lesegerät übereinstimmen.  Diese Daten haben nichts mit der UID zu tun - höchstwahrscheinlich handelt es sich nur um eine Seriennummer, wenn sie im Strafgesetzbuch veröffentlicht wird.  Meine Schlüsselringe hatten 3 Nummern hintereinander + eine sehr unterschiedliche.  Die Aufzeichnung des Rohlings war erfolgreich. Ich kombinierte den Schlüssel zum LCD mit dem Schlüssel zum Büro, das über UID funktioniert. <br><br><h3>  Fazit </h3><br>  Für ein erfolgreiches Hacken des Systems muss ich mich bei dem Programmierer der Urmet Group bedanken, der beim Schreiben von Software für den Leser offen getäuscht hat, denn wenn es Hardware gibt, die eine solche Hacking-Methode eliminieren kann (im Allgemeinen recht einfach), können Sie dies nicht tun, Sie können nur Hack nennen. <br><br>  Die meisten, die mit RFID-Technologie arbeiten, wissen, dass der in Mifare (Classic) -Karten verwendete <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Crypto-1-</a> Verschlüsselungsalgorithmus schon lange geknackt wurde und es möglich war, den Schlüssel für den Block „sauberer“ zu erhalten, aber ich ging direkt voran. <br><br>  In unseren eigenen Projekten verwenden wir programmierbare Lesegeräte mit Einmalkennwortwörterbüchern zur Verschlüsselung.  Auf diese Weise können Sie sich vor dem Klonen schützen, wenn die Originalkarte vor dem Klonen am Lesegerät angebracht wurde. Andernfalls werden Duplikate erkannt (die Originalkarte funktioniert nicht mehr). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439278/">https://habr.com/ru/post/de439278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439264/index.html">So verwalten Sie komplexe technische Projekte, ohne PMs einzustellen: DataLine-Erfahrung</a></li>
<li><a href="../de439266/index.html">Die Erfahrung, ein Spiel für Android von Grund auf neu zu erstellen und wie es Google Play gutgeschrieben wurde</a></li>
<li><a href="../de439268/index.html">Wie VR-, AR- und 3D-Druck zusammenarbeiten: VR Concept-Erfahrung</a></li>
<li><a href="../de439270/index.html">Ein Beispiel für das Parsen von C ++ - Code mit libclang in Python</a></li>
<li><a href="../de439272/index.html">Jupyter Notebook auf Netflix</a></li>
<li><a href="../de439280/index.html">Trautonium: die deutsche Welle in der Geschichte der Synthesizer</a></li>
<li><a href="../de439282/index.html">SVG-Filtereffekte. Teil 1. SVG-Filter 101</a></li>
<li><a href="../de439286/index.html">Über statische Analyse in aller Ehrlichkeit</a></li>
<li><a href="../de439288/index.html">SciPy, Optimierung</a></li>
<li><a href="../de439290/index.html">Beschleunigen Sie die Kompilierung in Xcode schnell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>