<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘´ğŸ» ğŸŒ ğŸˆ Autosampler - Kehidupan Setelah Kehidupan ğŸ¤˜ğŸ¿ â™¨ï¸ ğŸ¤³ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dia hidup bahagia selamanya ... dan kemudian putus. 

 Prolog 
 Selama setahun, tampaknya pada tahun 2009, alat analisis air dibeli untuk satu proyek....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Autosampler - Kehidupan Setelah Kehidupan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474564/">  <i>Dia hidup bahagia selamanya ... dan kemudian putus.</i> <br><br><h3>  Prolog </h3><br>  Selama setahun, tampaknya pada tahun 2009, alat analisis air dibeli untuk satu proyek.  Karena fakta bahwa itu seharusnya digunakan untuk memastikan pengoperasian peralatan teknologi, perangkat dibeli lengkap dengan autosampler. <br><br><img src="https://habrastorage.org/webt/vl/ru/s0/vlrus0joyo1eagedi_nr2vq-kqg.jpeg"><br><br>  Ini pada dasarnya adalah manipulator CNC dengan empat derajat kebebasan bergerak untuk secara otomatis memasukkan sampel ke penganalisa. <br><br>  Dia bekerja selama sekitar 10 tahun dan mengajukan lebih dari tiga puluh ribu sampel dengan beberapa masalah kecil, yang, bagaimanapun, diatasi dengan "sedikit darah." <br><br>  Pada awal tahun ini dia lelah - sumbu Z gagal, gerakan vertikal. <br><a name="habracut"></a><br>  Artinya, manipulator hanya berhenti "melihatnya".  Mengingat sejumlah keadaan pemeliharaan resmi, kompleks pengukuran tidak pernah memiliki masalah kecil (perbaikan PSU, berkedip setelah kegagalan FLASH) diselesaikan secara independen.  Di sini saya sudah harus mencari pejabat, dari siapa ternyata ... Beberapa fitur: <br><br><ul><li>  ternyata si manipulator bukan hanya tua, tapi juga sangat tua </li><li>  dia sudah tua dan tidak melanjutkan pembelian </li><li>  tidak ada dokumentasi untuk itu </li><li>  semua elektronik harus diubah </li><li>  bagian tersedia tetapi biaya lebih dari yang baru </li><li>  tidak ada jaminan seratus persen bahwa dengan penggantian itu akan berfungsi </li></ul><br>  Beberapa fitur yang saya kenal: <br><br><ul><li>  firmware pabrikan tidak berfungsi dengan penganalisis (ada baiknya cadangan dibuat), </li><li>  bootloader juga tampaknya berubah, karena firmware pabrik "sebagaimana adanya" tidak diterima </li><li>  tidak ada cara untuk "merombak" bootloader, jadi membeli barang elektronik seharga $ 6k tidak berguna </li><li>  mekanik berada dalam kondisi sangat baik, karena saya secara berkala dilayani </li><li>  Sensor Zero (Hall) hidup </li></ul><br>  Jadi, dua opsi ternyata: <br><br><ul><li>  membeli analisa baru dari produsen seharga $ 17k dan waktu pengiriman yang tidak bisa dipahami </li><li>  membuat ulang semua program elektronik dan penulisan </li></ul><br><h3>  Bagian Satu, perangkat keras </h3><br>  Untuk memulainya, saya memutuskan untuk memastikan bahwa mekaniknya bekerja pada tegangan 12v (dibandingkan 37 pada aslinya).  Memutuskan untuk menurunkan karena fakta bahwa kekuatan setengah-kontrol drive kontrol gigi lumayan hangat.  Oleh karena itu, driver A4988, papan nama CNC dan Arduino NANO ditarik keluar dari nakas.  semua ini merapat, diingat oleh proyek GRBL yang terkenal dan diinterogasi dengan bias.  Frekuensi loncatan maksimum diperoleh untuk setiap drive, koefisien pembagian langkah, arus driver disesuaikan. <br><br>  Ternyata XY tidak memanas sama sekali, dan mereka memberikan kecepatan yang sangat cocok.  Arus untuk drive Z - harus dikacaukan secara maksimal, karena pembagian dengan 8 dan konsumsi yang layak ketika mulai bergerak ke atas, karena menarik sejumlah besar dua drive motor dan isi perut, sementara chip driver menghangat hingga 50 derajat bahkan dengan radiator.  Saya harus menambahkan pendingin ke blower di depan drive ini dalam desain akhir. <br><br>  Pada akhirnya, sebagai gantinya <br><br><img src="https://habrastorage.org/webt/hv/uk/im/hvukimqjri3xmvuirghyqxdy85k.jpeg"><br><br>  ternyata <br><br><img src="https://habrastorage.org/webt/jn/kh/7o/jnkh7ojbzppodwqniscy5pzkdvu.jpeg"><br><br>  Arduino Pro Micro akan menjadi lagu yang terpisah.  Di latar belakang adalah panel dengan sakelar sakelar untuk memilih mode operasi, mulai dan reset tombol. <br><br>  Sekarang tentang babat.  Seperti yang saya katakan, semua sensor Hall selamat.  Dari jumlah tersebut, XY hanya menarik untuk logika pemicu yang berbeda.  Jika pada Y sensor membuka OK ketika mendekati magnet, maka pada X magnet secara konstan berlawanan dengan sensor, dan di Zero-X dan lebih jauh di antara mereka ada rana lembut magnetis yang melindungi sensor dari magnet, sementara itu menutup OK.  Mengingat heterogenitas ini, ada kebutuhan untuk memahami ke mana harus pergi ketika mencari nol.  Untuk melakukan ini, desain asli menyediakan posisi parkir di akhir pekerjaan.  Namun, itu tidak diterapkan sama sekali: ketika daya dimatikan, saya harus menangkap kepala saya pada sumbu Z dengan tangan saya dan secara manual meneruskannya ke posisi parkir. <br><br>  Tentang Z adalah cerita utama.  Di sana, dalam kasus Z, drive pendorong jarum suntik masih hidup, tanpa sensor nol, tetapi dengan sensor putaran ganda - hampir merupakan enkoder.  Dan ada juga sensor untuk menekan vial dengan kerusakan, diimplementasikan oleh heliks gear dan juga sensor Hall.  Kedua sensor rotasi ini adalah gigi kuningan yang lewat dengan gigi melewati sensor Hall dengan magnetisasi. <br><br>  Mengapa saya memerlukan encoder magnetik (sebagai bagian dari tugas pribadi saya) saya tidak mengerti, dan karenanya menggantinya dengan sensor nol untuk drive pendorong, karena Aula ada di sana, di nakas, serta magnet neodymium kecil dari drive lensa DVD. <br><br>  Sebaliknya <br><br><img src="https://habrastorage.org/webt/uz/tj/xb/uztjxbqffeieifu4nhx1wshhxma.jpeg"><br><br>  Itu menjadi <br><br><img src="https://habrastorage.org/webt/ev/mt/x3/evmtx3f6xbe4big2vl4efoxffvy.jpeg"><br><br>  Masalah utama dari mematung besi adalah menjejalkan, yah, Anda sendiri mengerti.  Saya benar-benar tidak ingin menyimpan sesuatu di kotak yang terpisah, sebagai hasilnya, semuanya sesuai dengan tempat yang dimaksudkan untuk ini, tetapi sekarang saya akan melakukannya sedikit berbeda. <br><br>  <b>Bagian dua, perangkat lunak</b> <br><br>  Tes pada papan nama CNC menunjukkan kecepatan yang layak.  TAPI!  Jika Anda mencoba untuk menawarkan SD segera frekuensi LANGKAH yang sesuai dengan kecepatan ini, maka Anda tidak akan mendapatkan apa-apa selain menggeram.  Untuk mencapai kecepatan gerakan yang baik, motor stepper harus dipercepat, sama seperti jika Anda menghargai roda gigi dan menggerakkan rel (baik, atau gerobak, atau sabuk) kemudian memperlambatnya dengan lancar.  Karena kode sepele telah berkembang sedikit. <br><br>  Karena hampir tidak senonoh untuk datang ke bagian "Robotika" dengan artikel tanpa kode, misalnya, kendalikan kontrol Z (untuk disalahkan).  Saat mengeluarkan frekuensi ke LANGKAH, digitalWrite tidak punya waktu, Anda harus menarik port secara langsung.  Itu mungkin ditunda, dan ditunda, tetapi kode berasal dari kontrol XY, dan simultan diperlukan di sana. <br><br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//*****************  Z ************************* void movement_z (unsigned int tz, int spd) { long interval_z; long spd_z = 2000; unsigned long cur_micros; unsigned long prev_micros_z =0; int half_z; byte full_mask = mask_z; int dz = tz - z; z=z+dz; if (dz &lt;0) digitalWrite(pin_dir_z, HIGH); else digitalWrite(pin_dir_z, LOW); dz = abs(dz); half_z = int(dz/2); interval_z = spd; do { if (dz&gt;0){ cur_micros = micros(); if(cur_micros - prev_micros_z &gt; spd_z) { if ( dz&gt;half_z ) {if (spd_z &gt; interval_z) {spd_z = spd_z - 5;} else spd_z = interval_z;} if ( dz&lt;300 ) {if (spd_z &lt; 1000) spd_z = spd_z + 2; else spd_z = 3000;} prev_micros_z = cur_micros; if (dz&gt;0) {PORTB = PORTB | mask_z; dz--;} }} delayMicroseconds(5); PORTB = PORTB &amp; B11110000; } while( dz != 0); } //*************************************************************</span></span></code> </pre> <br>  Dalam set level fungsi: <br><br><ul><li>  rendah - bolak-balik, temukan sesuatu-tidak-tahu-apa </li><li>  kalibrasi sedang ke nol, buat jarum suntik, buat sampel </li><li>  diagram siklus tinggi dari bypass jumlah vial pada palet </li></ul><br>  Program dimulai dengan menginisialisasi port, membaca konfigurasi yang ditentukan dari sakelar pada panel belakang dan, setelah menekan MULAI, kerjakan diagram urutan sampai posisi pada palet ditemukan di mana tidak ada botol dengan sampel. <br><br>  Diagram urutan utama terlihat seperti ini: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frame_1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">6</span></span>; i++){ <span class="hljs-comment"><span class="hljs-comment">// 6 for (unsigned int j=0; j&lt;9; j++){ // 9 for (unsigned int k=1; k &lt; probe+1; k++){ for (unsigned int l=1; l &lt; inj+1; l++){ sound1(); delay(1000); if (inj == 2) {tone(tone_p,5000);delay(200);noTone(tone_p);delay(200);tone(tone_p,5000);delay(200);noTone(tone_p);} if (inj == 1) {tone(tone_p,5000);delay(200);noTone(tone_p);} Serial.print("going to x = ");Serial.print(j+1);Serial.print(" y = ");Serial.print(i+1); Serial.print(" probe = ");Serial.print(k); Serial.print(" inj = ");Serial.println(l); show_xyzp(); movement_z (0,450); movement_xy (prime_x-j*272, prime_y+i*372,500); movement_z(1800,300); if (z&gt;2500) ost(); fill(); while(sensor()); if (inj == 1) {click_mouse(); Serial.println("mouse CLICKED for FLUSH and inj=1");} if (inj == 2 &amp;&amp; l==1) {click_mouse(); Serial.println("mouse CLICKED for FLUSH and inj=2");} septa_pos(); while(sensor()); sound2(); inject(); } delay(3000); click_mouse(); Serial.println("mouse CLICKED for INJECT"); find_zero_xy(); movement_xy (3257, 1247,500); movement_z (6000,100); movement_z (0,100); } } } }</span></span></code> </pre> <br>  Atavisme dalam bentuk outputing informasi debugging ke Serial tetap dalam kode - kiri untuk perbaikan di masa depan.  satu sudah hampir matang, punya jarum suntik analitis untuk empat kali volume, Anda harus menambahkan pilihan lain di awal. <br><br><img src="https://habrastorage.org/webt/ug/mz/8e/ugmz8e1ty00fujj-gishy0o_yha.jpeg"><br><br>  Masalah utama dalam mengkompilasi program adalah bahwa dalam aslinya, alat analisa memberikan autosampler ke mana harus pergi dan apa yang harus dilakukan.  Semua ini terjadi melalui port COM dan protokol, yang tidak bisa diambil.  Karena saya harus keluar. <br><br>  Alat analisis ini memiliki mode manual untuk mereka yang belum membeli autosampler <s>tupai</s> .  Pada saat yang sama, tombol gelap "sampel siap" muncul pada layar penganalisa dan, ketika operator ditikam, ia harus menusuknya dengan mouse (pelacak pada panel penganalisa).  Ketika pengukuran selesai, tombol "mulai pembilasan" yang gelap muncul dan, jika operator memiliki sampel lain, ia menekannya dengan mouse untuk menyiapkan alat analisa untuk pengukuran selanjutnya.  Setelah klik mouse, tombol menghilang dan bidang putih (cerah) tetap ada.  Saya memutuskan untuk menangkap perbedaan kecerahan ini dengan sensor foto.  Saya memeriksa tampilan tombol gelap dengan photoresistor yang direkatkan ke dalam cangkir hisap.  Saya tidak menemukan cangkir hisap hitam, dan ketika matahari keluar jendela, saya harus menutupi sensor tombol dengan sesuatu. <br><br><img src="https://habrastorage.org/webt/i7/lm/zu/i7lmzujnaezp7vvoj_tzqkqyvzs.jpeg"><br><br>  Tetapi Anda harus mengklik sesuatu?  Untungnya, penganalisa memiliki port USB dan pembotolan RedHat yang tidak disunat dari awal tahun 2000 untuk menghubungkan secara otomatis ke port ini.  Ini untuk meniru mouse pada papan utama baru autosampler yang disandang Arduino Pro Micro.  itu menerima PIN dari NANO saat analisa perlu diklik.  Itu terlalu malas untuk menulis gerakan, karena sebelum mulai bekerja, mouse harus diatur pada tombol di muka. <br><br>  O KEBENARAN, yang dibebani dengan pengalaman, saya melepaskan bagian mouse dari galvanic manajerial lainnya, optron murah.  KARENA pada akhir hari kedua debugging in kind, ketika semuanya sudah bekerja dan saya mengatur pager untuk mengirimkan suara yang mirip dengan yang asli, salah satu driver merilis asap ajaib dan menghubungkan bagian daya 12v ke yang logis 5v.  Yah, tidak ada, setengah hari menggantinya dengan satu diekstraksi dari meja samping tempat tidur tanpa dasar bukanlah perbaikan analisa $ 100k.  Benar, kemudian ternyata bahwa PSU REXANT baru yang dibeli alih-alih rumah yang terlupakan di beberapa titik mulai menghasilkan hampir 50 bukannya 12v, yang menyebabkan penundaan yang disayangkan. <br><br>  <b>Bagian Tiga, Uji Kalibrasi dan Keandalan</b> <br><br>  Setelah perakitan dan debugging awal, masalah penghitungan posisi oleh lokasi botol yang sebenarnya muncul.  Saya harus membuat keyboard dan menulis antarmuka sederhana untuk seri ini.  Tidak ada port yang tersisa, tetapi untuk pin kasus yang paling ekstrim yang bertanggung jawab untuk i2c disimpan.  Mereka akan digantung pada PCF8574 fender extender dengan tombol mikro yang terselip di atas, yang dapat digunakan untuk memindahkan XY, memilih pengganda langkah untuk mempercepat proses dan mengubah XY ke ZP.  Setelah setiap klik dalam seri menampilkan posisi baru.  Berkat teknik sederhana ini, dimungkinkan untuk secara cepat dan akurat mendapatkan semua koordinat dan peningkatan saat ini.  Di luar prosedur kalibrasi, selektor mode berganti dan tombol untuk memicu cyclogram terhubung ke input expander.  Dalam video, kira-kira di tengah, kedua tombol dan sakelar sakelar terlihat. <br><br>  Jarum suntik untuk memberi makan sampel tidak murah - $ 100 masing-masing.  Kesalahan dalam penentuan posisi menyebabkan jarum bengkok dan jarum suntik yang tidak dapat ditarik kembali.  Oleh karena itu, jarum suntik yang rusak dimasukkan dengan jarum jahit yang direkatkan dan peralatan diirik selama hampir setengah hari pada empat titik pada selembar kertas untuk mengidentifikasi dugaan kegagalan posisi.  Tetapi mereka tidak ada di sana, saya bahkan terkejut.  Namun, karena ada cukup waktu antara sampel menusuk dan merekrut yang baru, saya menggunakannya untuk mencari nol, untuk berjaga-jaga.  Dalam video, momen ini terlihat lebih dekat ke akhir video. <br><br><h3>  Epilog </h3><br>  Secara umum, itu lebih cenderung berhasil.  Dua minggu berlalu dari pemahaman keputusasaan ke transfer ke produksi.  Dioperasikan sejak akhir Mei, menghasilkan hingga 200 pengukuran per hari.  Kolega yang bertanggung jawab atas pengambilan sampel dan pengukuran tidak mengeluh. <br><br>  Ceri untuk kue adalah fitur baru yang tidak ada dalam aslinya.  Kemampuan untuk menavigasi XY secara bersamaan  Kemampuan untuk menggandakan pin sampel, yang meningkatkan sensitivitas penganalisa pada konsentrasi yang sangat rendah dari bahan yang diukur dalam sampel.  Parkir otomatis setelah pengukuran. <br><br><h3>  PostScriptum </h3><br>  Atas permintaan mereka yang tertarik, video. <br><iframe width="560" height="315" src="https://www.youtube.com/embed/TE1aumgB2ok" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id474564/">https://habr.com/ru/post/id474564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id474554/index.html">Intel Tremont - Mikroarsitektur Baru untuk Efisiensi Energi</a></li>
<li><a href="../id474556/index.html">Cara membuat dukungan PCRE2 untuk Apache 2.4</a></li>
<li><a href="../id474558/index.html">Pemrograman Berorientasi Protokol, Bagian 2</a></li>
<li><a href="../id474560/index.html">4 langkah dari seorang ekonom ke manajer pengembangan kustom, atau TI sebagai cara untuk mengatasi kebosanan</a></li>
<li><a href="../id474562/index.html">LEGO MINDSTORMS Education EV3 + MicroPython: kami memprogram konstruktor anak-anak dalam bahasa dewasa</a></li>
<li><a href="../id474566/index.html">Kota ini membutuhkan pahlawan baru: ulasan tentang ransel tahan-bukti Bobby Hero</a></li>
<li><a href="../id474568/index.html">Susu dari gigi: perubahan profesi untuk sel</a></li>
<li><a href="../id474572/index.html">Apakah ini normal? Masalah norma dalam psikologi</a></li>
<li><a href="../id474574/index.html">Kami mengidentifikasi serangan virus enkripsi, mendapatkan akses ke pengontrol domain dan mencoba untuk melawan serangan ini.</a></li>
<li><a href="../id474576/index.html">Visi yang sehat Visi visi. Lihatlah keluar dari kegelapan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>