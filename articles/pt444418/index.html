<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë∂üèº ‚òùüèø üë®‚Äçüíº Milh√µes de bin√°rios depois. Como o Linux foi fortalecido üîÅ üèÇüèæ üîò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR . Neste artigo, exploramos esquemas de prote√ß√£o que funcionam imediatamente em cinco distribui√ß√µes populares do Linux. Para cada um, pegamos a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Milh√µes de bin√°rios depois. Como o Linux foi fortalecido</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444418/"><img src="https://habrastorage.org/getpro/habr/post_images/43f/b35/8ca/43fb358cac8e2bec978126698b7d2ece.png" align="left" width="340">  <b>TL; DR</b> .  Neste artigo, exploramos esquemas de prote√ß√£o que funcionam imediatamente em cinco distribui√ß√µes populares do Linux.  Para cada um, pegamos a configura√ß√£o padr√£o do kernel, baixamos todos os pacotes e analisamos os esquemas de prote√ß√£o nos arquivos bin√°rios anexados.  Consideramos as distribui√ß√µes do OpenSUSE 12.4, Debian 9, CentOS, RHEL 6.10 e 7, bem como do Ubuntu 14.04, 12.04 e 18.04 LTS. <br><br>  Os resultados confirmam que mesmo esquemas b√°sicos, como can√°rios de pilha e c√≥digo independente de posi√ß√£o, ainda n√£o s√£o usados ‚Äã‚Äãpor todos.  A situa√ß√£o √© ainda pior para os compiladores quando se trata de prote√ß√£o contra vulnerabilidades, como o confronto de pilhas, que entrou em cena em janeiro ap√≥s a publica√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">informa√ß√µes de vulnerabilidade no systemd</a> .  Mas nem tudo √© t√£o desesperador.  Em uma parte significativa dos bin√°rios, m√©todos b√°sicos de prote√ß√£o s√£o implementados e seu n√∫mero est√° aumentando de vers√£o para vers√£o. <br><br>  A verifica√ß√£o mostrou que o maior n√∫mero de m√©todos de prote√ß√£o √© implementado no Ubuntu 18.04 no sistema operacional e no n√≠vel do aplicativo, seguido pelo Debian 9. Por outro lado, no OpenSUSE 12.4, CentOS 7 e RHEL 7, esquemas b√°sicos de prote√ß√£o tamb√©m s√£o implementados e a prote√ß√£o contra colis√µes de pilhas √© aplicada ainda mais amplamente. com um conjunto de pacotes muito mais denso por padr√£o. <br><a name="habracut"></a><br><h1>  1. Introdu√ß√£o </h1><br>  √â dif√≠cil fornecer software de alta qualidade.  Apesar do grande n√∫mero de ferramentas avan√ßadas para an√°lise de c√≥digo est√°tico e an√°lise din√¢mica em tempo de execu√ß√£o, al√©m de progressos significativos no desenvolvimento de compiladores e linguagens de programa√ß√£o, o software moderno ainda sofre de vulnerabilidades que s√£o constantemente exploradas por criminosos cibern√©ticos.  A situa√ß√£o √© ainda pior em ecossistemas que incluem c√≥digo legado.  Nesses casos, n√£o somos apenas confrontados com o eterno problema de encontrar poss√≠veis erros explorados, mas tamb√©m somos limitados por estruturas r√≠gidas de compatibilidade com vers√µes anteriores, que geralmente exigem a manuten√ß√£o de c√≥digos limitados e, pior ainda, vulner√°veis ‚Äã‚Äãou com bugs. <br><br>  √â aqui que os m√©todos de prote√ß√£o entram em a√ß√£o.  N√£o podemos evitar alguns tipos de erros, mas podemos dificultar a vida de um invasor e resolver parcialmente o problema, impedindo ou impedindo a <i>opera√ß√£o</i> desses erros.  Essa prote√ß√£o √© usada em todos os sistemas operacionais modernos, no entanto, os m√©todos variam muito em complexidade, efici√™ncia e desempenho: de can√°rios de pilha e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ASLR</a> a prote√ß√µes completas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CFI</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ROP</a> .  Neste artigo, consideraremos quais m√©todos de prote√ß√£o s√£o usados ‚Äã‚Äãnas distribui√ß√µes Linux mais populares na configura√ß√£o padr√£o e tamb√©m estudaremos as propriedades dos bin√°rios distribu√≠dos pelos sistemas de gerenciamento de pacotes de cada distribui√ß√£o. <br><br><h3>  CVE e seguran√ßa </h3><br>  Todos n√≥s j√° vimos artigos com t√≠tulos como "Aplicativos Mais Vulner√°veis ‚Äã‚Äãdo Ano" ou "Sistemas Operacionais Mais Vulner√°veis".  Normalmente, eles fornecem estat√≠sticas sobre o n√∫mero total de registros de vulnerabilidade, como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CVE (Vulnerability and Exposures),</a> obtido do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">National Vulnerability Database (NVD)</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NIST</a> e de outras fontes.  Posteriormente, esses aplicativos ou sistemas operacionais s√£o classificados pelo n√∫mero de CVEs.  Infelizmente, embora os CVEs sejam muito √∫teis para rastrear problemas e informar fornecedores e usu√°rios, eles falam pouco sobre a real seguran√ßa do software. <br><br>  Como exemplo, considere o n√∫mero total de CVEs nos √∫ltimos quatro anos para o kernel Linux e as cinco distribui√ß√µes de servidores mais populares, como Ubuntu, Debian, Red Hat Enterprise Linux e OpenSUSE. <br><br><img src="https://habrastorage.org/webt/3_/pt/md/3_ptmdzx313ayxw3xpi0udnlbdq.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">1</font></i> <br><br>  O que esse gr√°fico nos diz?  Mais CVE significa que uma distribui√ß√£o √© mais vulner√°vel que outra?  N√£o h√° resposta.  Por exemplo, neste artigo, voc√™ ver√° que o Debian implementa mecanismos de seguran√ßa mais rigorosos em compara√ß√£o com, digamos, OpenSUSE ou RedHat Linux, e ainda assim o Debian tem mais CVE.  No entanto, eles n√£o significam necessariamente seguran√ßa enfraquecida: mesmo ter um CVE n√£o indica se a vulnerabilidade √© <i>explor√°vel</i> .  As pontua√ß√µes de gravidade d√£o uma id√©ia da <i>probabilidade de</i> explora√ß√£o da vulnerabilidade, mas, em √∫ltima an√°lise, a capacidade de explora√ß√£o depende em grande parte da prote√ß√£o presente nos sistemas afetados, bem como dos recursos e capacidades dos atacantes.  Al√©m disso, a falta de relat√≥rios do CVE n√£o diz nada sobre outras vulnerabilidades <i>n√£o registradas ou desconhecidas</i> .  A diferen√ßa no CVE pode ser explicada n√£o pela qualidade do software, mas por outros fatores, incluindo os recursos alocados para teste ou o tamanho da base de usu√°rios.  Em nosso exemplo, mais CVEs Debian podem simplesmente indicar que o Debian est√° entregando mais pacotes de software. <br><br>  Obviamente, o sistema CVE fornece informa√ß√µes √∫teis que permitem criar prote√ß√µes apropriadas.  Quanto melhor entendermos os motivos da falha do programa, mais f√°cil ser√° identificar poss√≠veis m√©todos de opera√ß√£o e desenvolver mecanismos apropriados de <i>detec√ß√£o e resposta</i> .  Na fig.  A Figura 2 mostra as categorias de vulnerabilidade para todas as distribui√ß√µes nos √∫ltimos quatro anos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fonte</a> ).  √â imediatamente √≥bvio que a maioria dos CVEs se enquadra nas seguintes categorias: nega√ß√£o de servi√ßo (DoS), execu√ß√£o de c√≥digo, estouro, corrup√ß√£o de mem√≥ria, vazamento de informa√ß√µes (exfiltra√ß√£o) e escalonamento de privil√©gios.  Embora muitos CVEs sejam abordados v√°rias vezes em diferentes categorias, em geral, os mesmos problemas persistem de ano para ano.  Na pr√≥xima parte do artigo, avaliaremos o uso de v√°rios esquemas de prote√ß√£o para impedir a explora√ß√£o dessas vulnerabilidades. <br><br><img src="https://habrastorage.org/webt/tr/92/pc/tr92pcngbl1y4qxt3shouu6wdi8.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">2</font></i> <br><br><h3>  As tarefas </h3><br>  Neste artigo, pretendemos responder √†s seguintes perguntas: <br><br><ul><li>  Qual √© a seguran√ßa de v√°rias distribui√ß√µes Linux?  Quais mecanismos de defesa existem nos aplicativos do kernel e do espa√ßo do usu√°rio? <br></li><li>  Como a ado√ß√£o de mecanismos de prote√ß√£o para v√°rias distribui√ß√µes mudou ao longo do tempo? <br></li><li>  Quais s√£o as depend√™ncias m√©dias de pacotes e bibliotecas para cada distribui√ß√£o? <br></li><li>  Quais prote√ß√µes s√£o implementadas para cada bin√°rio? </li></ul><br><h3>  Escolhendo distribui√ß√µes </h3><br>  Acontece que √© dif√≠cil encontrar estat√≠sticas precisas sobre as instala√ß√µes de distribui√ß√£o, pois na maioria dos casos o n√∫mero de downloads n√£o indica o n√∫mero de instala√ß√µes reais.  No entanto, as variantes do Unix comp√µem a maioria dos sistemas de servidores (69,2% nos servidores da Web, de acordo com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">estat√≠sticas da</a> W3techs e de outras fontes), e sua participa√ß√£o est√° aumentando constantemente.  Assim, em nosso estudo, nos concentramos em distribui√ß√µes dispon√≠veis imediatamente na plataforma do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google Cloud</a> .  Em particular, escolhemos o seguinte sistema operacional: <br><br><table><tbody><tr><th>  Distribui√ß√£o / vers√£o </th><th>  O n√∫cleo </th><th>  Construir </th></tr><tr><td>  OpenSUSE 12.4 </td><td>  4.12.14-95.3-default </td><td>  # 1 SMP Wed Dec 5 06:00:48 UTC de 2018 (63a8d29) </td></tr><tr><td>  Debian 9 (estiramento) </td><td>  4.9.0-8-amd64 </td><td>  # 1 SMP Debian 4.9.130-2 (27/10/2018) </td></tr><tr><td>  CentOS 6.10 </td><td>  2.6.32-754.10.1.el6.x86_64 </td><td>  Ter√ßa-feira 15 janeiro 17:07:28 UTC 2019 </td></tr><tr><td>  CentOS 7 </td><td>  3.10.0-957.5.1.el7.x86_64 </td><td>  # 1 SMP Fri Feb 1 14:54:57 UTC 2019 </td></tr><tr><td>  Servidor Red Hat Enterprise Linux 6.10 (Santiago) </td><td>  2.6.32-754.9.1.el6.x86_64 </td><td>  # 1 SMP Wed 21 de nov 15:08:21 EST 2018 </td></tr><tr><td>  Servidor 7.6 do Red Hat Enterprise Linux (Maipo) </td><td>  3.10.0-957.1.3.el7.x86_64 </td><td>  # 1 SMP Thu Nov 15 17:36:42 UTC de 2018 </td></tr><tr><td>  Ubuntu 14.04 (Trusty Tahr) </td><td>  4.4.0‚Äì140-gen√©rico </td><td><br>  # 166 ~ 04/14/1-Ubuntu SMP Sat Nov 17 01:52:43 UTC 20 ... </td></tr><tr><td>  Ubuntu 16.04 (Xenial Xerus) </td><td>  4.15.0-1026-gcp </td><td>  # 27 ~ 16.04.1-Ubuntu SMP Sex Dez 7 09:59:47 UTC de 2018 </td></tr><tr><td>  Ubuntu 18.04 (Castor bi√¥nico) </td><td>  4.15.0-1026-gcp </td><td>  # 27-Ubuntu SMP Thu Dec 6 18:27:01 UTC de 2018 </td></tr></tbody></table>  <i><font color="gray">Quadro 1</font></i> <br><br><h1>  An√°lise </h1><br>  Examinaremos a configura√ß√£o padr√£o do kernel, bem como as propriedades dos pacotes dispon√≠veis atrav√©s do gerenciador de pacotes de cada pacote de distribui√ß√£o imediatamente.  Portanto, consideramos apenas pacotes dos espelhos padr√£o de cada distribui√ß√£o, ignorando pacotes de reposit√≥rios inst√°veis ‚Äã‚Äã(por exemplo, testando espelhos no Debian) e pacotes de terceiros (por exemplo, pacotes Nvidia de espelhos padr√£o).  Al√©m disso, n√£o consideramos compila√ß√µes personalizadas do kernel ou configura√ß√µes avan√ßadas de seguran√ßa. <br><br><h3>  An√°lise de configura√ß√£o do kernel </h3><br>  Utilizamos um script de an√°lise baseado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">verificador kconfig gratuito</a> .  Consideramos as op√ß√µes de prote√ß√£o prontas para as distribui√ß√µes nomeadas e as comparamos com a lista do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Projeto de Autodefesa do Kernel</a> (KSPP).  Para cada par√¢metro de configura√ß√£o, a Tabela 2 descreve a configura√ß√£o desejada: uma marca de sele√ß√£o √© para distribui√ß√µes que cumprem as recomenda√ß√µes do KSSP (para obter uma explica√ß√£o dos termos, veja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ; em artigos futuros, descreveremos quantos desses m√©todos de prote√ß√£o apareceram e como invadir o sistema na aus√™ncia deles). <br><br> <a href=""><img src="https://habrastorage.org/webt/dx/oh/o0/dxoho0z-lifjcybajszqb-aiirq.png"></a> <br><br><img src="https://habrastorage.org/webt/rm/or/h1/rmorh1jx8aswaj98ts0-7jptjmk.png"><br><br>  Em geral, os kernels mais recentes t√™m configura√ß√µes mais rigorosas prontas para uso.  Por exemplo, o CentOS 6.10 e o RHEL 6.10 no kernel 2.6.32 n√£o possuem a maioria das fun√ß√µes cr√≠ticas implementadas nos novos kernels, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SMAP</a> , permiss√µes RWX fortes, randomiza√ß√£o de endere√ßos ou prote√ß√£o contra copy2usr.  Deve-se notar que muitas das op√ß√µes de configura√ß√£o da tabela est√£o ausentes nas vers√µes mais antigas do kernel e n√£o s√£o aplic√°veis ‚Äã‚Äãna realidade - isso ainda √© indicado na tabela como falta de prote√ß√£o adequada.  Da mesma forma, se o par√¢metro de configura√ß√£o n√£o estiver dispon√≠vel nesta vers√£o e, por seguran√ßa, esse par√¢metro dever√° ser desativado, isso ser√° considerado uma configura√ß√£o razo√°vel. <br><br>  Outro ponto ao interpretar os resultados: algumas configura√ß√µes do kernel que aumentam a superf√≠cie de ataque podem ser usadas simultaneamente para seguran√ßa.  Tais exemplos incluem uprobes e kprobes, m√≥dulos de kernel e BPF / eBPF.  Nossa recomenda√ß√£o √© usar os mecanismos acima para fornecer prote√ß√£o real, uma vez que eles n√£o s√£o triviais e sua opera√ß√£o pressup√µe que atores mal-intencionados j√° estejam entrincheirados no sistema.  Mas se essas op√ß√µes estiverem ativadas, o administrador do sistema dever√° monitorar ativamente o abuso. <br><br>  Estudando as entradas da Tabela 2, vemos que os kernels modernos oferecem v√°rias op√ß√µes para prote√ß√£o contra a explora√ß√£o de vulnerabilidades, como vazamento de informa√ß√µes e estouro de pilha / pilha.  No entanto, percebemos que mesmo as distribui√ß√µes populares mais recentes ainda n√£o implementaram prote√ß√£o mais sofisticada (por exemplo, com patches <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grsecurity</a> ) ou prote√ß√£o moderna contra ataques de reutiliza√ß√£o de c√≥digo (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combinando randomiza√ß√£o com esquemas como R ^ X para c√≥digo</a> ).  Pior ainda, mesmo essas defesas mais avan√ßadas n√£o protegem contra uma gama completa de ataques.  Portanto, √© crucial que os administradores de sistema complementem as configura√ß√µes inteligentes com solu√ß√µes que oferecem detec√ß√£o e preven√ß√£o de explora√ß√µes em tempo de execu√ß√£o. <br><br><h3>  An√°lise de aplica√ß√£o </h3><br>  N√£o √© surpreendente que diferentes distribui√ß√µes tenham caracter√≠sticas diferentes de pacotes, op√ß√µes de compila√ß√£o, depend√™ncias de bibliotecas, etc. Existem diferen√ßas mesmo para distribui√ß√µes e pacotes <a href="">relacionados</a> com um pequeno n√∫mero de depend√™ncias (por exemplo, coreutils no Ubuntu ou Debian).  Para avaliar as diferen√ßas, baixamos todos os pacotes dispon√≠veis, extra√≠mos seu conte√∫do e analisamos os arquivos bin√°rios e depend√™ncias.  Para cada pacote, rastreamos os outros pacotes dos quais depende, e para cada bin√°rio, rastreamos suas depend√™ncias.  Esta se√ß√£o resume as descobertas. <br><br><h4>  Distribui√ß√µes </h4><br>  No total, baixamos 361.556 pacotes para todas as distribui√ß√µes, extraindo apenas pacotes dos espelhos padr√£o.  Ignoramos pacotes sem arquivos execut√°veis ‚Äã‚ÄãELF, como c√≥digos-fonte, fontes, etc. Ap√≥s a filtragem, restaram 129 569 pacotes, contendo um total de 584 457 arquivos bin√°rios.  A distribui√ß√£o de pacotes e arquivos entre distribui√ß√µes √© mostrada na fig.  3) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9d/8fc/bbf/f9d8fcbbf2ac0887f4948e1e49446e9a.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">3</font></i> <br><br>  Voc√™ pode notar que, quanto mais moderna a distribui√ß√£o, mais pacotes e arquivos bin√°rios ela cont√©m, o que √© l√≥gico.  Ao mesmo tempo, os pacotes Ubuntu e Debian incluem muito mais arquivos bin√°rios (m√≥dulos e bibliotecas execut√°veis ‚Äã‚Äãe din√¢micos) do que o CentOS, SUSE e RHEL, o que potencialmente afeta a superf√≠cie de ataque do Ubuntu e Debian (observe que os n√∫meros refletem todos os bin√°rios de todas as vers√µes ou seja, alguns arquivos s√£o analisados ‚Äã‚Äãv√°rias vezes).  Isso √© especialmente importante ao considerar as depend√™ncias entre pacotes.  Portanto, uma vulnerabilidade no bin√°rio de um √∫nico pacote pode afetar muitas partes do ecossistema, assim como uma biblioteca vulner√°vel pode afetar todos os arquivos bin√°rios que o importam.  Como ponto de refer√™ncia, vejamos a distribui√ß√£o do n√∫mero de depend√™ncias entre pacotes em v√°rios sistemas operacionais: <br><br> <a href=""><img src="https://habrastorage.org/webt/ii/e3/e5/iie3e5-ei26ezg5yvcyvtzqzl80.png"></a> <br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">4</font></i> <br><br>  Em quase todas as distribui√ß√µes, 60% dos pacotes t√™m pelo menos 10 depend√™ncias.  Al√©m disso, alguns pacotes t√™m mais depend√™ncias (mais de 100).  O mesmo se aplica √†s depend√™ncias inversas de pacotes: como esperado, v√°rios pacotes s√£o usados ‚Äã‚Äãpor muitos outros pacotes na distribui√ß√£o; portanto, as vulnerabilidades nesses poucos favoritos t√™m um alto risco.  Como exemplo, a tabela a seguir lista os 20 pacotes com o n√∫mero m√°ximo de depend√™ncias inversas no SLES, Centos 7, Debian 9 e Ubuntu 18.04 (cada caixa indica o pacote e o n√∫mero de depend√™ncias inversas). <br><br><img src="https://habrastorage.org/webt/0g/hl/w0/0ghlw0dtmbb3vswp-xgtx1zs-lu.png"><br>  <i><font color="gray">Quadro 3</font></i> <br><br>  Um fato interessante.  Embora todos os SOs analisados ‚Äã‚Äãsejam criados para a arquitetura x86_64 e para a maioria dos pacotes a arquitetura seja definida como x86_64 e x86, os pacotes geralmente cont√™m bin√°rios para outras arquiteturas, como mostra a Fig.  5) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c4e/899/601/c4e899601e6fc711b224aba6b204c02a.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">5</font></i> <br><br>  Na pr√≥xima se√ß√£o, examinaremos as caracter√≠sticas dos bin√°rios analisados. <br><br><h4>  Estat√≠sticas de prote√ß√£o bin√°ria </h4><br>  Como um m√≠nimo absoluto, voc√™ precisa estudar o conjunto b√°sico de op√ß√µes de prote√ß√£o para arquivos bin√°rios existentes.  V√°rias distribui√ß√µes Linux v√™m com scripts que executam essas verifica√ß√µes.  Por exemplo, no Debian / Ubuntu existe um script desse tipo.  Aqui est√° um exemplo de seu trabalho: <br><br><pre><code class="bash hljs">$ hardening-check $(<span class="hljs-built_in"><span class="hljs-built_in">which</span></span> docker) /usr/bin/docker: Position Independent Executable: yes Stack protected: yes Fortify Source <span class="hljs-built_in"><span class="hljs-built_in">functions</span></span>: no, only unprotected <span class="hljs-built_in"><span class="hljs-built_in">functions</span></span> found! Read-only relocations: yes Immediate binding: yes</code> </pre> <br>  O script verifica cinco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fun√ß√µes de prote√ß√£o</a> : <br><br><ul><li>  PIE (Position Independent Executable): indica se a se√ß√£o de texto do programa pode ser movida na mem√≥ria para obter a randomiza√ß√£o se o ASLR estiver ativado no kernel. <br></li><li>  Pilha protegida: se os can√°rios da pilha est√£o inclu√≠dos para proteger contra ataques de colis√£o da pilha. <br></li><li>  Fonte Fortify: se as fun√ß√µes n√£o seguras (por exemplo, strcpy) s√£o substitu√≠das por suas contrapartes mais seguras e as chamadas verificadas em tempo de execu√ß√£o s√£o substitu√≠das por suas contrapartes n√£o verificadas (por exemplo, memcpy em vez de __memcpy_chk). <br></li><li>  Realoca√ß√µes somente leitura (RELRO): se as entradas na tabela de movimento s√£o marcadas como somente leitura se funcionaram antes do in√≠cio da execu√ß√£o. <br></li><li>  Liga√ß√£o imediata: se o vinculador de tempo de execu√ß√£o permite todos os movimentos antes de iniciar o programa (isso √© equivalente a RELRO completo). </li></ul><br>  Os mecanismos acima s√£o suficientes?  Infelizmente n√£o.  Existem maneiras conhecidas de contornar todas as defesas acima, mas quanto mais rigorosa a defesa, maior a barra para o atacante.  Por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">as solu√ß√µes alternativas do RELRO s√£o</a> mais dif√≠ceis de aplicar se o PIE e a liga√ß√£o imediata estiverem em vigor.  Da mesma forma, um ASLR completo requer trabalho adicional para criar uma explora√ß√£o em funcionamento.  No entanto, invasores sofisticados est√£o prontos para enfrentar essas defesas: sua aus√™ncia acelerar√° essencialmente o hacking.  Portanto, √© imperativo que essas medidas sejam consideradas o <i>m√≠nimo</i> necess√°rio. <br><br>  Quer√≠amos estudar quantos arquivos bin√°rios nas distribui√ß√µes em quest√£o est√£o protegidos por eles, al√©m de mais tr√™s m√©todos: <br><br><ul><li>  Um bit n√£o execut√°vel ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NX</a> ) impede a execu√ß√£o em qualquer regi√£o que n√£o deve ser execut√°vel, como um heap de pilha, etc. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RPATH / RUNPATH</a> indica o caminho de execu√ß√£o usado pelo carregador din√¢mico para localizar as bibliotecas apropriadas.  O primeiro √© <i>obrigat√≥rio</i> para qualquer sistema moderno: sua aus√™ncia permite que os atacantes gravem arbitrariamente a carga √∫til na mem√≥ria e a executem como est√£o.  Na segunda, configura√ß√µes incorretas do caminho de execu√ß√£o ajudam na introdu√ß√£o de c√≥digo n√£o confi√°vel, o que pode levar a v√°rios problemas (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">escala√ß√£o de privil√©gios</a> , al√©m de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">outros problemas</a> ). </li><li>  A prote√ß√£o contra colis√£o de pilha fornece prote√ß√£o contra ataques que fazem com que a pilha se sobreponha a outras √°reas da mem√≥ria (como uma pilha).  Dadas as explora√ß√µes recentes que abusam das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vulnerabilidades de colis√£o de heap no systemd</a> , achamos apropriado incluir esse mecanismo em nosso conjunto de dados. </li></ul><br>  Portanto, sem mais delongas, vamos para os n√∫meros.  As tabelas 4 e 5 cont√™m uma an√°lise minuciosa de arquivos execut√°veis ‚Äã‚Äãe bibliotecas de v√°rias distribui√ß√µes, respectivamente. <br><br><ul><li>  Como voc√™ pode ver, a prote√ß√£o do NX √© implementada em qualquer lugar, com raras exce√ß√µes.  Em particular, seu menor uso nas distribui√ß√µes Ubuntu e Debian pode ser observado em compara√ß√£o com o CentOS, RHEL e OpenSUSE. <br></li><li>  Can√°rios de pilha n√£o est√£o dispon√≠veis em muitos lugares, especialmente em distribui√ß√µes com kernels antigos.  Algum progresso foi visto nas recentes distribui√ß√µes de Centos, RHEL, Debian e Ubuntu. <br></li><li>  Com exce√ß√£o do Debian e do Ubuntu 18.04, a maioria das distribui√ß√µes tem suporte a PIE insuficiente. <br></li><li>  A prote√ß√£o contra colis√£o de pilha √© mal implementada no OpenSUSE, Centos 7 e RHEL 7 e est√° praticamente ausente do resto. <br></li><li>  Todas as distribui√ß√µes com kernels modernos t√™m algum suporte RELRO, com o Ubuntu 18.04 liderando o caminho, com o Debian em segundo lugar. </li></ul><br>  Como j√° mencionado, as m√©tricas nesta tabela s√£o m√©dias em todas as vers√µes do arquivo bin√°rio.  Se voc√™ olhar apenas para as vers√µes mais recentes dos arquivos, os n√∫meros ser√£o diferentes (por exemplo, veja o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">progresso do Debian com a implementa√ß√£o do PIE</a> ).  Al√©m disso, a maioria das distribui√ß√µes geralmente ao calcular estat√≠sticas verifica a prote√ß√£o de apenas algumas fun√ß√µes no c√≥digo bin√°rio e, em nossa an√°lise, a porcentagem real de fun√ß√µes refor√ßadas √© indicada.  Portanto, se 5 das 50 fun√ß√µes estiverem protegidas no bin√°rio, atribuiremos a ele uma classifica√ß√£o de 0,1, que corresponde a 10% das fun√ß√µes refor√ßadas. <br><br><img src="https://habrastorage.org/webt/m-/fn/1l/m-fn1l_i9vp3-gh8sicmbnkintc.png"><br>  <i><font color="gray">Tabela 4. Caracter√≠sticas de prote√ß√£o para arquivos execut√°veis ‚Äã‚Äãmostrados na fig.</font></i>  <i><font color="gray">3 (implementa√ß√£o das fun√ß√µes correspondentes como uma porcentagem do n√∫mero total de arquivos execut√°veis)</font></i> <br><br><img src="https://habrastorage.org/webt/yt/y1/sa/yty1saotef9aqmxkik36r8iijus.png"><br>  <i><font color="gray">Tabela 5. Caracter√≠sticas de prote√ß√£o para as bibliotecas mostradas na Fig.</font></i>  <i><font color="gray">3 (implementa√ß√£o das fun√ß√µes correspondentes como uma porcentagem do n√∫mero total de bibliotecas)</font></i> <br><br>  Ent√£o, h√° progresso?  Definitivamente: pode ser visto nas estat√≠sticas de distribui√ß√µes individuais (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Debian</a> ), bem como nas tabelas acima.  Como um exemplo na fig.  A Figura 6 mostra a implementa√ß√£o de mecanismos de defesa em tr√™s distribui√ß√µes consecutivas do Ubuntu LTS 5 (omitimos as estat√≠sticas de prote√ß√£o contra colis√£o de pilhas).  Percebemos que, de vers√£o para vers√£o, mais e mais arquivos suportam can√°rios empilhados, e tamb√©m seq√ºencialmente mais e mais arquivos bin√°rios v√™m com prote√ß√£o RELRO completa. <br><br> <a href=""><img src="https://habrastorage.org/webt/d1/ni/or/d1niordj1hmiklmg2-w5rsk6dla.png"></a> <br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">6</font></i> <br><br>  Infelizmente, v√°rios arquivos execut√°veis ‚Äã‚Äãem diferentes distribui√ß√µes ainda n√£o possuem nenhuma das prote√ß√µes acima.  Por exemplo, olhando o Ubuntu 18.04, voc√™ pode ver o ngetty binary (substitui√ß√£o getty), bem como os shells mksh e lksh, o interpretador picolisp, os pacotes nvidia-cuda-toolkit (um pacote popular para aplicativos acelerados por GPU, como estruturas de aprendizado de m√°quina) e klibc -utils.  Da mesma forma, o bin√°rio mandos-client (uma ferramenta administrativa que permite reiniciar automaticamente m√°quinas com sistemas de arquivos criptografados), bem como o rsh-redone-client (reimplementando o rsh e o rlogin) s√£o entregues sem a prote√ß√£o do NX, embora tenham direitos SUID :(. Al√©m disso, V√°rios bin√°rios suid n√£o t√™m prote√ß√£o b√°sica, como can√°rios de pilha (por exemplo, o bin√°rio Xorg.wrap do pacote Xorg). <br><br><h1>  Resumo e considera√ß√µes finais </h1><br>  Neste artigo, destacamos v√°rios recursos de seguran√ßa das distribui√ß√µes modernas do Linux.  A an√°lise mostrou que a distribui√ß√£o mais recente do Ubuntu LTS (18.04) implementou, em m√©dia, a prote√ß√£o mais forte de sistema operacional e aplicativos entre distribui√ß√µes com kernels relativamente novos, como Ubuntu 14.04, 12.04 e Debian 9. No entanto, as distribui√ß√µes CentOS, RHEL e OpenSUSE discutidas em nosso kit por padr√£o, √© emitido um conjunto mais denso de pacotes e as vers√µes mais recentes (CentOS e RHEL) t√™m uma porcentagem maior de prote√ß√£o contra colis√£o de pilhas em compara√ß√£o com os concorrentes baseados no Debian (Debian e Ubuntu).  Comparando as vers√µes do CentOS e RedHat, notamos grandes melhorias na implementa√ß√£o de can√°rios de pilha e RELRO das vers√µes 6 a 7, mas, em m√©dia, o CentOS possui mais recursos que o RHEL.  Em geral, todas as distribui√ß√µes devem prestar aten√ß√£o especial √† prote√ß√£o PIE, que, com exce√ß√£o do Debian 9 e Ubuntu 18.04, √© implementada em menos de 10% dos arquivos bin√°rios do nosso conjunto de dados. <br><br>  Por fim, deve-se notar: embora tenhamos feito a pesquisa manualmente, existem muitas ferramentas de seguran√ßa (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lynis</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tiger</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hubble</a> ) que executam an√°lises e ajudam a evitar configura√ß√µes inseguras.  Infelizmente, mesmo uma prote√ß√£o forte em configura√ß√µes razo√°veis ‚Äã‚Äãn√£o garante a aus√™ncia de explora√ß√µes.  √â por isso que estamos firmemente convencidos de que √© vital garantir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">monitoramento e preven√ß√£o confi√°veis ‚Äã‚Äãde ataques em tempo real</a> , focando nos modelos operacionais e prevenindo-os. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444418/">https://habr.com/ru/post/pt444418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444406/index.html">It√°lia digital. O que e como funciona</a></li>
<li><a href="../pt444408/index.html">A Apple lan√ßou novos iPads ontem e tem d√∫vidas.</a></li>
<li><a href="../pt444410/index.html">Mapas de rede. Uma breve vis√£o geral do software para constru√ß√£o de mapas de rede</a></li>
<li><a href="../pt444414/index.html">Snapdragon 8cx: plataforma para PC de 7 nm</a></li>
<li><a href="../pt444416/index.html">Liga HyperX CORE - quando a membrana pode jogar</a></li>
<li><a href="../pt444420/index.html">Como andar de duas rodas para trabalhar</a></li>
<li><a href="../pt444422/index.html">Como era em 2018: impress√£o industrial FDM na Top 3D Expo</a></li>
<li><a href="../pt444424/index.html">AMD Radeon VII: chip de √∫ltima gera√ß√£o (parte 2)</a></li>
<li><a href="../pt444426/index.html">Lyft e Uber fazem abertura de capital p√∫blica. Por que investir na Lyft?</a></li>
<li><a href="../pt444428/index.html">Carro de montanha: resolvendo o desafio cl√°ssico com treinamento de refor√ßo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>