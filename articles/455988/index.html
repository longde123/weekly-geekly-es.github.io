<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ö∞Ô∏è üëéüèº ‚òÑÔ∏è Las estructuras de datos del estado de Blockchain de plasma efectivo üï§ ‚è∏Ô∏è üç≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="¬°Hola, queridos usuarios de Habr! Este art√≠culo trata sobre la Web 3.0, Internet descentralizada. La Web 3.0 introduce el concepto de descentralizaci√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Las estructuras de datos del estado de Blockchain de plasma efectivo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455988/"><img src="https://habrastorage.org/webt/qd/nd/dv/qdnddvdk76wf5sy2ajwn38jp9w0.jpeg"><br><br>  ¬°Hola, queridos usuarios de Habr!  Este art√≠culo trata sobre la Web 3.0, Internet descentralizada.  La Web 3.0 introduce el concepto de descentralizaci√≥n como la base de la Internet moderna.  Muchos sistemas y redes de computadoras requieren caracter√≠sticas de seguridad y descentralizaci√≥n para satisfacer sus necesidades.  Un registro distribuido que utiliza la tecnolog√≠a blockchain proporciona soluciones eficientes para la descentralizaci√≥n. <br><a name="habracut"></a><br>  Blockchain es un registro distribuido.  Puede pensar en ella como una gran base de datos que vive para siempre, que nunca cambia a lo largo del tiempo.  La cadena de bloques proporciona la base para servicios y aplicaciones web descentralizadas. <br><br>  Sin embargo, la cadena de bloques es m√°s que una simple base de datos.  Sirve para aumentar la seguridad y la confianza entre los miembros de la red, mejorando las transacciones comerciales en l√≠nea. <br><br>  El consenso bizantino aumenta la fiabilidad de la red y resuelve el problema de la coherencia. <br><br>  La escalabilidad proporcionada por DLT cambia las redes comerciales existentes. <br><br>  Blockchain ofrece nuevos beneficios muy importantes: <br><br><ol><li>  Previene errores costosos. </li><li>  Garantiza transacciones transparentes. </li><li>  Digitaliza bienes reales. </li><li>  Aplica contratos inteligentes. </li><li>  Aumenta la velocidad y la seguridad de los pagos. </li></ol><br>  Hemos desarrollado un PoE especial para investigar protocolos criptogr√°ficos y mejorar las soluciones existentes de DLT y blockchain. <br><br>  La mayor√≠a de los sistemas de registro p√∫blico carecen de la propiedad de escalabilidad, lo que hace que su rendimiento sea bastante bajo.  Por ejemplo, Ethereum procesa solo ~ 20 tx / s. <br><br>  Se desarrollaron muchas soluciones para aumentar la escalabilidad mientras se mantiene la descentralizaci√≥n.  Sin embargo, solo 2 de cada 3 ventajas (escalabilidad, seguridad y descentralizaci√≥n) se pueden lograr simult√°neamente. <br><br>  El uso de cadenas laterales proporciona una de las soluciones m√°s efectivas. <br><br><h2>  El concepto de plasma </h2><br>  El concepto Plasma se reduce a la idea de que una cadena ra√≠z procesa un peque√±o n√∫mero de confirmaciones de cadenas secundarias, actuando as√≠ como la capa m√°s segura y final para almacenar todos los estados intermedios.  Cada cadena secundaria funciona como su propia cadena de bloques con su propio algoritmo de consenso, pero hay algunas advertencias importantes. <br><br><ul><li>  Los contratos inteligentes se crean en una cadena ra√≠z y act√∫an como puntos de control para las cadenas secundarias dentro de la cadena ra√≠z. </li><li>  Se crea una cadena secundaria y funciona como su propia cadena de bloques con su propio consenso.  Todos los estados de la cadena infantil est√°n protegidos por pruebas de fraude que garantizan que todas las transiciones entre estados sean v√°lidas y apliquen un protocolo de retiro. </li><li>  Los contratos inteligentes espec√≠ficos para DApp o la l√≥gica de aplicaci√≥n de la cadena secundaria se pueden implementar en la cadena secundaria. </li><li>  Los fondos se pueden transferir de la cadena ra√≠z a la cadena secundaria. </li></ul><br>  Los validadores reciben incentivos econ√≥micos para actuar honestamente y enviar compromisos a la cadena ra√≠z: la capa de liquidaci√≥n de la transacci√≥n final. <br><br>  Como resultado, los usuarios de DApp que trabajan en la cadena secundaria no tienen que interactuar con la cadena ra√≠z.  Adem√°s, pueden colocar su dinero en la cadena ra√≠z cuando lo deseen, incluso si la cadena secundaria est√° pirateada.  Estas salidas de la cadena infantil permiten a los usuarios almacenar de forma segura sus fondos con pruebas de Merkle, lo que confirma la propiedad de una cierta cantidad de fondos. <br><br>  Las principales ventajas del plasma est√°n relacionadas con su capacidad para facilitar significativamente los c√°lculos que sobrecargan la cadena principal.  Adem√°s, la cadena de bloques Ethereum puede manejar conjuntos de datos m√°s extensos y paralelos.  El tiempo eliminado de la cadena ra√≠z tambi√©n se transfiere a los nodos Ethereum, que tienen menores requisitos de procesamiento y almacenamiento. <br><br>  <b>Plasma Cash</b> asigna n√∫meros de serie √∫nicos a los tokens en l√≠nea.  Las ventajas de este esquema incluyen la no necesidad de confirmaciones, un soporte m√°s simple para todos los tipos de tokens (incluidos los tokens no fungibles) y la mitigaci√≥n contra las salidas masivas de una cadena secundaria. <br><br>  El concepto de "salidas masivas" de una cadena infantil es un problema que enfrenta Plasma.  En este escenario, los retiros simult√°neos coordinados de una cadena secundaria podr√≠an conducir a un poder inform√°tico insuficiente para retirar todos los fondos.  Como resultado, los usuarios pueden perder fondos. <br><br><h2>  Opciones para implementar Plasma </h2><br><img src="https://habrastorage.org/webt/vq/qg/hr/vqqghr_ucnoum3q8o1b215zgcic.png"><br><br>  Basic Plasma tiene muchas opciones de implementaci√≥n. <br><br>  Las principales diferencias se refieren a: <br><br><ul><li>  archivar informaci√≥n sobre almacenamiento de estado y m√©todos de presentaci√≥n; </li><li>  tipos de fichas (divisible, indivisible); </li><li>  seguridad de transacciones; </li><li>  tipo de algoritmo de consenso. </li></ul><br>  Las principales variaciones de Plasma incluyen: <br><br><ul><li>  Plasma basado en UTXO: cada transacci√≥n consta de entradas y salidas.  Se puede realizar y gastar una transacci√≥n.  La lista de transacciones no gastadas es el estado de una cadena secundaria en s√≠. </li><li>  Plasma basado en cuentas: esta estructura contiene el reflejo y el saldo de cada cuenta.  Se usa en Ethereum, ya que cada cuenta puede ser de dos tipos: una cuenta de usuario y una cuenta de contrato inteligente.  La simplicidad es una ventaja importante de Plasma basado en cuentas.  Al mismo tiempo, la falta de escalabilidad es una desventaja.  Se utiliza una propiedad especial, "nonce", para evitar la ejecuci√≥n de una transacci√≥n dos veces. </li></ul><br>  Para comprender las estructuras de datos utilizadas en la cadena de bloques de Plasma Cash y c√≥mo funcionan los compromisos, es necesario aclarar el concepto de Merkle Tree. <br><br><h2>  Merkle Trees y su uso en plasma </h2><br>  Merkle Tree es una estructura de datos extremadamente importante en el mundo blockchain.  Nos permite capturar un determinado conjunto de datos y ocultar los datos, sin embargo, demostrar que cierta informaci√≥n estaba en el conjunto.  Por ejemplo, si tenemos diez n√∫meros, podr√≠amos crear una prueba para estos n√∫meros y luego probar que alg√∫n n√∫mero en particular estaba en este conjunto.  Esta prueba tendr√≠a un tama√±o constante peque√±o, lo que hace que sea econ√≥mico publicar en Ethereum. <br><br>  Puede usar este principio para un conjunto de transacciones y demostrar que una transacci√≥n en particular est√° en este conjunto.  Esto es precisamente lo que hace un operador.  Cada bloque consta de un conjunto de transacciones que se convierte en un √°rbol Merkle.  La ra√≠z de este √°rbol es una prueba que se publica en Ethereum junto con cada bloque de plasma. <br><br>  Los usuarios deber√≠an poder retirar sus fondos de la cadena Plasma.  Para esto, env√≠an una transacci√≥n de "salida" a Ethereum. <br><br>  Plasma Cash utiliza un √°rbol Merkle especial que elimina la necesidad de validar un bloque completo.  Es suficiente para validar solo aquellas ramas que corresponden al token del usuario. <br><br>  Para transferir un token, es necesario analizar su historial y escanear solo aquellos que un determinado usuario necesita.  Al transferir un token, el usuario simplemente env√≠a el historial completo a otro usuario, que luego puede autenticar todo el historial y, lo m√°s importante, hacerlo muy r√°pidamente. <br><br><img src="https://habrastorage.org/webt/l7/tg/iw/l7tgiwwibxyks4m-tv6lmw3cs_a.png"><br><br><h2>  Estructuras de datos de Plasma Cash para almacenamiento de estado e historial </h2><br>  Es aconsejable utilizar solo √°rboles Merkle seleccionados, porque es necesario obtener pruebas de inclusi√≥n y no inclusi√≥n para una transacci√≥n en un bloque.  Por ejemplo: <br><br><ul><li>  Escaso √°rbol de merkle </li><li>  √Årbol patricia </li></ul><br>  Hemos desarrollado nuestras propias implementaciones de Sparse Merkle Tree y Patricia Tree para nuestro cliente. <br><br>  Un √°rbol de Merkle disperso es similar a un √°rbol de Merkle est√°ndar, excepto que sus datos est√°n indexados y cada punto de datos se coloca en una hoja que corresponde al √≠ndice de este punto de datos. <br><br>  Supongamos que tenemos un √°rbol Merkle de cuatro hojas.  Llenemos este √°rbol con las letras A y D, para demostraci√≥n.  La letra A es la primera letra del alfabeto, por lo que la colocaremos en la primera hoja.  Del mismo modo, colocaremos D en la cuarta hoja. <br><br>  Entonces, ¬øqu√© pasa en la segunda y tercera hojas?  Deben dejarse vac√≠os.  M√°s precisamente, se usa un valor especial (por ejemplo, cero) en lugar de una letra. <br><br>  El √°rbol finalmente se ve as√≠: <br><br><img src="https://habrastorage.org/webt/5g/9g/18/5g9g18uvkq5oizxi81z8pbeij48.png"><br><br>  La prueba de inclusi√≥n funciona de la misma manera que en un √°rbol Merkle normal.  ¬øQu√© sucede si queremos demostrar que C no es parte de este √°rbol de Merkle?  Elemental!  Sabemos que si C es parte de un √°rbol, estar√≠a en la tercera hoja.  Si C no es parte del √°rbol, entonces la tercera hoja deber√≠a ser cero. <br><br>  Todo lo que se necesita es una prueba est√°ndar de inclusi√≥n de Merkle que muestre que la tercera hoja es cero. <br><br>  ¬°La mejor caracter√≠stica de un Sparse Merkle Tree es que proporciona repositorios para valores clave dentro del Merkle Tree! <br><br>  Una parte del c√≥digo del protocolo PoE construye un √°rbol de Merkle disperso: <br><br><pre><code class="plaintext hljs">class SparseTree { //... buildTree() { if (Object.keys(this.leaves).length &gt; 0) { this.levels = [] this.levels.unshift(this.leaves) for (let level = 0; level &lt; this.depth; level++) { let currentLevel = this.levels[0] let nextLevel = {} Object.keys(currentLevel).forEach((leafKey) =&gt; { let leafHash = currentLevel[leafKey] let isEvenLeaf = this.isEvenLeaf(leafKey) let parentLeafKey = leafKey.slice(0, -1) let neighborLeafKey = parentLeafKey + (isEvenLeaf ? '1' : '0') let neighborLeafHash = currentLevel[neighborLeafKey] if (!neighborLeafHash) { neighborLeafHash = this.defaultHashes[level] } if (!nextLevel[parentLeafKey]) { let parentLeafHash = isEvenLeaf ? ethUtil.sha3(Buffer.concat([leafHash, neighborLeafHash])) : ethUtil.sha3(Buffer.concat([neighborLeafHash, leafHash])) if (level == this.depth - 1) { nextLevel['merkleRoot'] = parentLeafHash } else { nextLevel[parentLeafKey] = parentLeafHash } } }) this.levels.unshift(nextLevel) } } } }</code> </pre> <br>  Este c√≥digo es bastante trivial.  Tenemos un repositorio de valores clave con una prueba de inclusi√≥n / no inclusi√≥n. <br><br>  En cada iteraci√≥n, se llena un nivel espec√≠fico de un √°rbol final, comenzando con el √∫ltimo.  Dependiendo de si la clave de la hoja actual es par o impar, tomamos dos hojas adyacentes y contamos el hash del nivel actual.  Si llegamos al final, escribir√≠amos una sola ra√≠z de merkle, un hash com√∫n. <br><br>  Debe comprender que este √°rbol est√° lleno de valores inicialmente vac√≠os.  Si almacenamos una gran cantidad de ID de token, tendr√≠amos un gran tama√±o de √°rbol, ¬°y ser√≠a largo! <br><br>  Hay muchos remedios para esta no optimizaci√≥n, pero hemos decidido cambiar este √°rbol a un √°rbol Patricia. <br><br>  Un √°rbol Patricia es una combinaci√≥n de √°rbol Radix y √°rbol Merkle. <br><br>  Una clave de datos Radix Tree almacena la ruta a los datos en s√≠, lo que nos permite crear una estructura de datos optimizada para la memoria. <br><br><img src="https://habrastorage.org/webt/ox/cz/gc/oxczgcwvxvl2jas44sbtbqophda.png"><br><br>  Aqu√≠ hay una implementaci√≥n desarrollada para nuestro cliente: <br><br><pre> <code class="plaintext hljs">buildNode(childNodes, key = '', level = 0) { let node = {key} this.iterations++ if (childNodes.length == 1) { let nodeKey = level == 0 ? childNodes[0].key : childNodes[0].key.slice(level - 1) node.key = nodeKey let nodeHashes = Buffer.concat([Buffer.from(ethUtil.sha3(nodeKey)), childNodes[0].hash]) node.hash = ethUtil.sha3(nodeHashes) return node } let leftChilds = [] let rightChilds = [] childNodes.forEach((node) =&gt; { if (node.key[level] == '1') { rightChilds.push(node) } else { leftChilds.push(node) } }) if (leftChilds.length &amp;&amp; rightChilds.length) { node.leftChild = this.buildNode(leftChilds, '0', level + 1) node.rightChild = this.buildNode(rightChilds, '1', level + 1) let nodeHashes = Buffer.concat([Buffer.from(ethUtil.sha3(node.key)), node.leftChild.hash, node.rightChild.hash]) node.hash = ethUtil.sha3(nodeHashes) } else if (leftChilds.length &amp;&amp; !rightChilds.length) { node = this.buildNode(leftChilds, key + '0', level + 1) } else if (!leftChilds.length &amp;&amp; rightChilds.length) { node = this.buildNode(rightChilds, key + '1', level + 1) } else if (!leftChilds.length &amp;&amp; !rightChilds.length) { throw new Error('invalid tree') } return node }</code> </pre> <br>  Nos movimos recursivamente y construimos los sub√°rboles separados izquierdo y derecho.  Se construy√≥ una clave como camino en este √°rbol. <br><br>  Esta soluci√≥n es a√∫n m√°s trivial.  Est√° bien optimizado y funciona m√°s r√°pido.  De hecho, un √°rbol de Patricia puede optimizarse a√∫n m√°s mediante la introducci√≥n de nuevos tipos de nodo: nodo de extensi√≥n, nodo de rama, etc., como se hace en el protocolo Ethereum.  Pero la implementaci√≥n actual satisface todos nuestros requisitos: tenemos una estructura de datos r√°pida y con memoria optimizada. <br><br>  Al implementar estas estructuras de datos en el proyecto de nuestro cliente, hemos hecho posible el escalado de Plasma Cash.  Esto nos permite verificar el historial de un token y la inclusi√≥n / no inclusi√≥n del token en un √°rbol, acelerando en gran medida la validaci√≥n de los bloques y la propia cadena de plasma del ni√±o. <br><br><h3>  Enlaces: </h3><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Papel blanco plasma</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Git Hub</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Descripci√≥n de casos de uso y arquitectura</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Papel de red de rayos</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/455988/">https://habr.com/ru/post/455988/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../455978/index.html">Lambdas: de C ++ 11 a C ++ 20. Parte 2</a></li>
<li><a href="../455980/index.html">iOS Digest No. 7 (31 de mayo - 13 de junio)</a></li>
<li><a href="../455982/index.html">Es hora de reemplazar GIF con video AV1</a></li>
<li><a href="../455984/index.html">C√≥mo entender que los enlaces funcionan: m√©tricas y construcci√≥n de enlaces KPI</a></li>
<li><a href="../455986/index.html">¬øPor qu√© un t√©cnico de TI debe sacar un cerebro?</a></li>
<li><a href="../455990/index.html">CTT en soluciones de servidor: ¬øc√≥mo se ve?</a></li>
<li><a href="../455996/index.html">Transformaci√≥n digital de la publicidad en la red minorista. Siguiendo los pasos de Video Analytics en Retail</a></li>
<li><a href="../456000/index.html">Crear un juego Tic-Tac-Toe con TypeScript, React y Mocha</a></li>
<li><a href="../456002/index.html">Memoria de hogar dedicada e intervenci√≥n OOM Killer</a></li>
<li><a href="../456004/index.html">Te invitamos a una reuni√≥n de desarrollo front-end en servicios muy cargados</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>