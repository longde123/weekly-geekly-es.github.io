<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🌾 📜 👂🏻 Diarisierung basierend auf dem GMM-UBM-Modell und dem MAP-Anpassungsalgorithmus 📡 ⛔️ 🔇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. Ich möchte über einen der Ansätze zur Lösung des Problems der Sprecherdiarisierung sprechen und zeigen, wie diese Methode in Python implem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Diarisierung basierend auf dem GMM-UBM-Modell und dem MAP-Anpassungsalgorithmus</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420515/">  Hallo Habr.  Ich möchte über einen der Ansätze zur Lösung des Problems der Sprecherdiarisierung sprechen und zeigen, wie diese Methode in Python implementiert werden kann.  Um den Leser nicht abzuschrecken, werde ich keine komplexen mathematischen Formeln angeben (auch weil ich selbst „kein echter Schweißer“ bin), aber ich werde versuchen, alles in einfacher Sprache zu erklären und alles so zu erzählen, dass ein Entwickler, der noch nie auf maschinelles Lernen gestoßen ist, es verstanden hat. <br><a name="habracut"></a><br>  Bei der Vorbereitung dieses Artikels habe ich zwischen zwei Optionen gewählt: für diejenigen, die bereits mit Data Science vertraut sind, und für diejenigen, die einfach gut programmieren.  Am Ende entschied ich mich für die zweite Option und entschied, dass dies eine gute Demonstration der Fähigkeiten von DS sein würde. <br><br><h3>  Erklärung des Problems </h3><br>  Wie Wikipedia uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sagt</a> , ist Diarisierung der Prozess des Aufteilens eines eingehenden Audiostreams in homogene Segmente, je nachdem, ob der Audiostream dem einen oder anderen Sprecher gehört.  Mit anderen Worten, die Aufzeichnung muss in Teile geteilt und nummeriert werden: Eine Person spricht an diesen Orten und eine andere an diesen Orten.  Aus Sicht des maschinellen Lernens gehören Aufgaben dieser Art zur Klasse des Lernens ohne Lehrer und werden als Clustering bezeichnet.  Sie können <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> beispielsweise lesen, welche Clustering-Methoden existieren, aber ich werde nur diejenigen diskutieren, die für uns nützlich sind - dies ist ein Gaußsches Mischungsmodell und spektrales Clustering.  Aber etwas später über sie. <br>  Beginnen wir von vorne. <br><br><h3>  Umweltvorbereitung </h3><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Ich war mir nicht sicher, ob ich diesen Abschnitt verlassen sollte - ich wollte den Artikel nicht in ein Tutorial verwandeln.  Aber am Ende habe ich es verlassen.  Wer es nicht benötigt, überspringt es und für diejenigen, die alles von Grund auf neu machen, erleichtert dieser Schritt den Start. <br></div></div><br>  Im Allgemeinen ist Python neben R die Hauptsprache für die Lösung von Data Science-Problemen. Wenn Sie noch nicht versucht haben, darauf zu programmieren, empfehle ich dies dringend, da Sie mit Python viele Dinge elegant und buchstäblich in wenigen Zeilen ausführen können (übrigens gibt es solche) sogar so ein Mem). <br><br>  Es gibt zwei sich separat entwickelnde Zweige von Python - Version 2 und 3. In meinen Beispielen habe ich Version 3.6 verwendet, aber auf Wunsch können sie problemlos auf Version 2.7 portiert werden.  Es ist praktisch, einen dieser Zweige zusammen mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anaconda-</a> Installationsprogramm bereitzustellen. Durch die Installation erhalten Sie sofort eine interaktive Shell für die Entwicklung - IPython. <br><br>  Zusätzlich zur Entwicklungsumgebung selbst werden zusätzliche Bibliotheken benötigt: librosa (zum Arbeiten mit Audio und zum Extrahieren von Attributen), webrtcvad (zum Segmentieren) und pickle (zum Schreiben trainierter Modelle in eine Datei).  Alle von ihnen werden durch einen einfachen Befehl in Anaconda Prompt installiert. <br><br><pre><code class="hljs sql">pip <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">library</span></span>]</code> </pre> <br><h3>  Merkmalsextraktion </h3><br>  Beginnen wir mit der Extraktion von Features - Daten, mit denen Modelle für maschinelles Lernen arbeiten.  Im Prinzip besteht das Tonsignal selbst bereits aus Daten, nämlich einer geordneten Anordnung von Schallamplitudenwerten, zu denen ein Header hinzugefügt wird, der die Anzahl der Kanäle, die Abtastfrequenz und andere Informationen enthält.  Wir können diese Daten jedoch nicht direkt analysieren, da sie solche Dinge nicht enthalten. Unser Modell kann sagen: Ja, diese Teile gehören derselben Person. <br><br>  Bei Sprachverarbeitungsaufgaben gibt es verschiedene Ansätze zum Extrahieren von Merkmalen.  Eine davon ist das Erhalten von Mel-Frequenz-Cepstral-Koeffizienten.  Sie wurden hier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bereits</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">geschrieben</a> , daher werde ich Sie nur geringfügig daran erinnern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/dn/w-/fgdnw-m6jhpjb7b1wbj1xevahps.png" alt="Bild"></div><br>  Das ursprüngliche Signal wird in Frames mit einer Länge von 16-40 ms geschnitten.  Wenn sie dann ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hamming-</a> Fenster auf den Rahmen anwenden, führen sie eine schnelle Fourier-Transformation durch und erhalten die spektrale Leistungsdichte.  Dann wird mit einem speziellen „Kamm“ von Filtern, die gleichmäßig auf der Kreideskala angeordnet sind, ein Kreidespektrogramm erstellt, auf das eine diskrete Kosinustransformation (DCT) angewendet wird - ein weit verbreiteter Datenkomprimierungsalgorithmus.  Die so erhaltenen Koeffizienten sind eine Art komprimierte Charakteristik des Rahmens, und da sich die von uns verwendeten Filter in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kreideskala</a> befanden, tragen die Koeffizienten mehr Informationen im Wahrnehmungsbereich des menschlichen Ohrs.  Typischerweise werden 13 bis 25 MFCC pro Frame verwendet.  Da neben dem Spektrum selbst die Persönlichkeit der Stimme durch Geschwindigkeit und Beschleunigung gebildet wird, wird MFCC mit der ersten und zweiten Ableitung kombiniert. <br><br>  Im Allgemeinen ist MFCC die häufigste Option für die Arbeit mit Sprache. Zusätzlich zu diesen gibt es jedoch andere Zeichen - LPC (Linear Predictive Coding) und PLP (Perceptual Linear Prediction). Manchmal wird auch LFCC verwendet, bei dem anstelle der Kreideskala linear verwendet wird. <br><br>  Mal sehen, wie man MFCC in Python extrahiert. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> librosa mfcc=librosa.feature.mfcc(y=y, sr=sr, hop_length=int(hop_seconds*sr), n_fft=int(window_seconds*sr), n_mfcc=n_mfcc) mfcc_delta=librosa.feature.delta(mfcc) mfcc_delta2=librosa.feature.delta(mfcc, order=<span class="hljs-number"><span class="hljs-number">2</span></span>) stacked=np.vstack((mfcc, mfcc_delta, mfcc_delta2)) features=stacked.T <span class="hljs-comment"><span class="hljs-comment">#librosa   MFCC   ,       .</span></span></code> </pre><br>  Wie Sie sehen können, geschieht dies wirklich in nur wenigen Zeilen.  Fahren wir nun mit dem ersten Clustering-Algorithmus fort. <br><br><h3>  Gaußsches Mischungsmodell </h3><br>  Ein Modell einer Mischung von Gaußschen Verteilungen legt nahe, dass unsere Daten eine Mischung aus mehrdimensionalen Gaußschen Verteilungen mit bestimmten Parametern sind. <br><br>  Wenn Sie möchten, finden Sie leicht eine detaillierte Beschreibung des Modells und der Funktionsweise des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EM-Algorithmus</a> , mit dem dieses Modell trainiert wird. Ich habe jedoch versprochen, mich nicht mit komplexen Formeln zu ärgern, und werde daher schöne Beispiele aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem</a> Artikel zeigen. <br><br>  Wir werden vier Cluster generieren und sie zeichnen. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets.samples_generator <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_blobs X, y_true=make_blobs(n_samples=<span class="hljs-number"><span class="hljs-number">400</span></span>, centers=<span class="hljs-number"><span class="hljs-number">4</span></span>, cluster_std=<span class="hljs-number"><span class="hljs-number">0.60</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>]);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/px/my/d7/pxmyd7covni39hf8fq19684nrv0.png" alt="Bild"></div><br>  Wir werden ein Modell erstellen, unsere Daten trainieren und die Punkte erneut zeichnen, wobei wir jedoch das vorhergesagte Modell der Clustermitgliedschaft berücksichtigen. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.mixture <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianMixture gmm = GaussianMixture(n_components=<span class="hljs-number"><span class="hljs-number">4</span></span>) gmm.fit(X) labels=gmm.predict(X) plt.scatter(X[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=labels, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=<span class="hljs-string"><span class="hljs-string">'viridis'</span></span>);</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n0/2y/6n/n02y6nz_1nw3krhnatqj_qf5o9k.png" alt="Bild"></div><br>  Das Modell kam mit künstlichen Daten gut zurecht.  Im Prinzip können durch Regulierung der Anzahl der Mischungskomponenten und der Art der Kovarianzmatrix (der Anzahl der Freiheitsgrade der Gaußschen) ziemlich komplizierte Daten beschrieben werden. <br><br><img src="https://habrastorage.org/webt/ni/je/-m/nije-mrfqiykrrfykphnafbyr5w.png" alt="Bild"><br><br>  Wir wissen also, wie man Datenparametrisierung durchführt, und können ein Modell einer Mischung von Gaußschen Verteilungen trainieren.  Jetzt könnte man versuchen, Clustering auf der Stirn durchzuführen - GMM auf dem MFCC zu trainieren, das aus dem Dialog extrahiert wurde.  Und wahrscheinlich werden wir in einem idealen sphärischen Vakuumdialog, in dem jeder Sprecher in sein Gaußsches passt, ein gutes Ergebnis erzielen.  Es ist klar, dass dies in Wirklichkeit niemals passieren wird.  Tatsächlich modellieren sie mit Hilfe von GMM keinen Dialog, sondern jede Person in einem Dialog - das heißt, sie stellen sich vor, dass die Stimme jedes Sprechers in den extrahierten Zeichen durch eine eigene Gruppe von Gaußschen beschrieben wird. <br>  Zusammenfassend kommen wir langsam zum Hauptthema. <br><br><h3>  Segmentierung </h3><br>  Traditionell besteht der Diarisierungsprozess aus drei aufeinander folgenden Blöcken - Spracherkennung (Voice Activity Detection), Segmentierung und Clustering (es gibt Modelle, in denen die letzten beiden Schritte kombiniert werden, siehe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LIA E-HMM</a> ). <br><br>  Im ersten Schritt wird die Sprache von verschiedenen Arten von Rauschen getrennt.  Der VAD-Algorithmus bestimmt, ob es sich bei dem an ihn gesendeten Teil der Audiodatei um eine Rede handelt oder ob beispielsweise eine Sirene ertönt oder jemand niest.  Es ist klar, dass eine Ausbildung mit einem Lehrer erforderlich ist, damit ein solcher Algorithmus von hoher Qualität ist.  Dies bedeutet wiederum, dass Sie die Daten markieren müssen - mit anderen Worten, erstellen Sie eine Datenbank mit Sprachaufzeichnungen und allen Arten von Rauschen.  Wir werden es faul machen - nehmen Sie ein fertiges <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VAD</a> , das nicht perfekt funktioniert, aber für den Anfang haben wir genug. <br><br>  Der zweite Block schneidet die Sprachdaten mit einem aktiven Sprecher in Segmente.  Der klassische Ansatz in dieser Hinsicht ist der Algorithmus zur Bestimmung des Sprecherwechsels basierend auf dem Bayes'schen Informationskriterium - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BIC</a> .  Das Wesentliche dieser Methode ist wie folgt: Ein Schiebefenster geht durch die Audioaufnahmen und beantwortet an jedem Punkt der Passage die Frage: "Wie werden die Daten an diesem Ort besser beschrieben - eine oder zwei Verteilungen?"  Um diese Frage zu beantworten, wird der Parameter berechnet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">I</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.053ex" height="2.057ex" viewBox="0 -780.1 4759 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-42" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-49" x="3494" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-43" x="3998" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ Delta BIC </script>  , basierend auf dem Vorzeichen, von dem eine Entscheidung getroffen wird, den Sprecher zu wechseln.  Das Problem ist, dass diese Methode bei häufigen Lautsprecherwechseln und sogar bei Rauschen (die für die Aufzeichnung eines Telefongesprächs sehr charakteristisch sind) nicht sehr gut funktioniert. <br><br><div class="spoiler">  <b class="spoiler_title">Eine kleine Erklärung</b> <div class="spoiler_text">  Im Original habe ich mit Telefonaufzeichnungen eines Callcenters mit einer durchschnittlichen Dauer von ca. 4 Minuten gearbeitet.  Aus offensichtlichen Gründen kann ich diese Notizen nicht veröffentlichen. Für die Demonstration habe ich <a href="">ein</a> Interview von einem Radiosender geführt.  Im Falle eines langen Interviews würde diese Methode wahrscheinlich ein akzeptables Ergebnis liefern, aber sie funktionierte bei meinen Daten nicht. <br></div></div><br>  Unter den Bedingungen, unter denen sich die Ansager nicht gegenseitig unterbrechen und ihre Stimmen sich nicht überschneiden, wird die VAD, die wir verwenden werden, mehr oder weniger mit der Aufgabe der Segmentierung fertig, daher werden die ersten beiden Schritte so aussehen. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  y_, sr = librosa.load('data/2018-08-26-beseda-1616.mp3', sr=SR) #   pre-emphasis:    pre_emphasis = 0.97 y = np.append(y[0], y[1:] - pre_emphasis * y[:-1]) #       webrtcvad    vad = webrtcvad.Vad(2) #  VAD audio = np.int16(y/np.max(np.abs(y)) * 32767) frames = frame_generator(10, audio, sr) frames = list(frames) segments = vad_collector(sr, 50, 200, vad, frames) if not os.path.exists('data/chunks'): os.makedirs('data/chunks') for i, segment in enumerate(segments): chunk_name = 'data/chunks/chunk-%003d.wav' % (i,) # vad      ,     write_wave(chunk_name, segment[0: len(segment)-int(100*sr/1000)], sr)</span></span></code> </pre><br>  In Wirklichkeit werden die Menschen sicherlich gleichzeitig sprechen.  Darüber hinaus ist VAD an einigen Stellen fehlerhaft, da die Aufzeichnung nicht live ist, sondern ein Klebstoff, in dem Pausen herausgeschnitten werden.  Sie können versuchen, das Schneiden in Segmente zu wiederholen, um die Aggressivität des VAD von 2 auf 3 zu erhöhen. <br><br><h3>  GMM-UBM </h3><br>  Jetzt haben wir separate Segmente und wir haben beschlossen, jeden Lautsprecher mit GMM zu modellieren.  Wir extrahieren die Zeichen aus dem Segment und trainieren anhand dieser Daten das Modell.  Lassen Sie es uns für jedes Segment tun und die resultierenden Modelle miteinander vergleichen.  Es ist zu erwarten, dass Modelle, die in Segmenten derselben Person trainiert wurden, etwas ähnlich sind.  Hier sind wir jedoch mit dem folgenden Problem konfrontiert: Wenn wir Zeichen aus einer 1 Sekunde langen Audiodatei mit einer Abtastfrequenz von 8000 Hz und einer Fenstergröße von 10 ms extrahieren, erhalten wir einen Satz von 800 MFCC-Vektoren.  Unser Modell kann aus solchen Daten nicht lernen, da sie vernachlässigbar sind.  Selbst wenn es nicht eine Sekunde, sondern zehn sind, reichen die Daten immer noch nicht aus.  Und hier kommt das Universal Background Model (UBM) zur Rettung, es wird auch als sprecherunabhängig bezeichnet.  Die Idee ist wie folgt.  Wir werden GMM an einer großen Datenstichprobe trainieren (in unserem Fall ist dies eine vollständige Interviewaufzeichnung) und wir werden ein akustisches Modell eines verallgemeinerten Sprechers erhalten (dies wird unser UBM sein).  Und dann werden wir dieses Modell mithilfe eines speziellen Anpassungsalgorithmus (siehe unten) in die aus jedem Segment extrahierten Merkmale „einpassen“.  Dieser Ansatz wird nicht nur zur Diarisierung, sondern auch in Spracherkennungssystemen häufig verwendet.  Um eine Person anhand der Stimme zu erkennen, müssen Sie zunächst ein Modell darauf trainieren. Ohne UBM müssen Sie mehrere Stunden Zeit haben, um die Sprache dieser Person aufzuzeichnen. <br><br>  Aus jedem angepassten GMM extrahieren wir den Vektor der Scherkoeffizienten <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-11"><span class="MJXp-mtext" id="MJXp-Span-12">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.951ex" height="1.455ex" viewBox="0 -520.7 1701 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-75" x="1128" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ mu </script>  (es ist auch ein Median oder eine mat. Erwartung, wenn Sie möchten) und basierend auf den Daten dieser Vektoren aus allen Segmenten werden wir Clustering durchführen (unten wird klar sein, warum es der Verschiebungsvektor ist). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8o/v1/gc/8ov1gcun9ic5sqshic7fvlg09wo.png" alt="Bild"></div><br><h3>  Kartenanpassung </h3><br>  Die Methode, mit der wir UBM für jedes Segment anpassen, wird als maximale A-Posteriori-Anpassung bezeichnet.  Im Allgemeinen ist der Algorithmus wie folgt.  Zunächst wird die posteriore Wahrscheinlichkeit anhand der Anpassungsdaten und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ausreichender Statistiken</a> für das Gewicht, den Median und die Varianz jedes Gaußschen berechnet.  Dann werden die erhaltenen Statistiken mit den UBM-Parametern kombiniert und die Parameter des angepassten Modells werden erhalten.  In unserem Fall werden wir nur die Mediane anpassen, ohne den Rest der Parameter zu beeinflussen.  Trotz der Tatsache, dass ich versprochen habe, nicht tiefer in die Mathematik einzusteigen, werde ich immerhin drei Formeln zitieren, da die MAP-Anpassung der entscheidende Punkt in diesem Artikel ist. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-15"><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">c</span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mn" id="MJXp-Span-27">1</span></span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-msubsup" id="MJXp-Span-29"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-31" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">i</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-33">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">u</span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">t</span><span class="MJXp-mo" id="MJXp-Span-40">=</span><span class="MJXp-mn" id="MJXp-Span-41">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">r</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">i</span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-51" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-56" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">t</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.446ex" height="3.021ex" viewBox="0 -883.9 13969.9 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-3D" x="1360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-66" x="2666" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-72" x="3217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-61" x="3668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-63" x="4198" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-31" x="4631" y="0"></use><g transform="translate(5132,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="849" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-73" x="6327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-75" x="6796" y="0"></use><g transform="translate(7369,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-31" x="1140" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-50" x="9507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-72" x="10259" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-28" x="10710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="11100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-7C" x="11445" y="0"></use><g transform="translate(11724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-29" x="12652" y="0"></use><g transform="translate(13041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="809" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> E_ {i} = \ frac {1} {n_ {i}} \ sum_ {t = 1} ^ NPr (i | x_ {t}) x_ {t} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-58"><span class="MJXp-mtext" id="MJXp-Span-59">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">t</span><span class="MJXp-mtext" id="MJXp-Span-63">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">m</span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">t</span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-80" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-84">1</span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">t</span><span class="MJXp-msubsup" id="MJXp-Span-90"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-92" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">m</span><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-99" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">i</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.817ex" height="2.66ex" viewBox="0 -832 16713 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-68" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-61" x="826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="1356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6D" x="1967" y="0"></use><g transform="translate(2846,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-3D" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-62" x="5346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-65" x="5776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="6242" y="0"></use><g transform="translate(6604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="748" y="-213"></use></g><g transform="translate(7478,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="1044" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-2B" x="8783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-28" x="9783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-31" x="10173" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-2212" x="10896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-62" x="12146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-65" x="12576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-74" x="13042" y="0"></use><g transform="translate(13404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMAIN-29" x="14278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-6D" x="14917" y="0"></use><g transform="translate(15796,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/420515/&amp;usg=ALkJrhiDx8tl58f0iWDJBS8yUnUz3P8S-Q#MJMATHI-69" x="809" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ hat \ mu_ {i} = \ beta_ {i} E_ {i} + (1- \ beta_ {i}) \ mu_ {i} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-101"><span class="MJXp-mtext" id="MJXp-Span-102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">t</span><span class="MJXp-msubsup" id="MJXp-Span-106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-108" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-113" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">i</span></span></span><span class="MJXp-mrow" id="MJXp-Span-115"><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-120" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-125" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-126">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">a</span></span></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ beta_ {i} = n_ {i} / (n_ {i} + r ^ {\ beta}) </script></p><br>  Hier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">r</span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">i</span><span class="MJXp-mrow" id="MJXp-Span-137"><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-141" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> Pr (i | x_ {t}) </script>  - hintere Wahrscheinlichkeit, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-144"><span class="MJXp-msubsup" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> E_ {i} </script>  - ausreichende Statistiken für <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-149"><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ mu </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-153"><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">t</span><span class="MJXp-mtext" id="MJXp-Span-158">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">m</span><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-162" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ hat \ mu_ {i} </script>  - Median des angepassten Modells, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-164"><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">t</span><span class="MJXp-msubsup" id="MJXp-Span-169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-171" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">i</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> \ beta_ {i} </script>  - Anpassungskoeffizient, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-173"><span class="MJXp-msubsup" id="MJXp-Span-174"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-176" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">a</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> r ^ {\ beta} </script>  - Compliance-Faktor. <br>  Wenn all dies Unsinn erscheint und Verzweiflung verursacht - verzweifeln Sie nicht.  Um die Funktionsweise des Algorithmus zu verstehen, ist es nicht erforderlich, sich mit diesen Formeln zu befassen. Die Funktionsweise des Algorithmus kann anhand des folgenden Beispiels leicht demonstriert werden: <br><br><img src="https://habrastorage.org/webt/rj/fg/st/rjfgstiekke6cv1m8zc-d6s4kji.png" alt="Bild"><br><br>  Angenommen, wir haben einige Daten, die groß genug sind, und wir haben UBM darauf trainiert (linkes Bild, UBM ist eine Zweikomponentenmischung von Gaußschen Verteilungen).  Es erscheinen neue Daten, die nicht in unser Modell passen (Abbildung in der Mitte).  Mit diesem Algorithmus verschieben wir die Zentren der Gaußschen so, dass sie auf den neuen Daten liegen (Abbildung rechts).  Wenn wir diesen Algorithmus auf experimentelle Daten anwenden, erwarten wir, dass sich die Gaußschen auf Segmenten mit demselben Sprecher in eine Richtung verschieben und so Cluster bilden.  Aus diesem Grund werden wir Scherdaten verwenden, um Segmente zu gruppieren <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-182"><span class="MJXp-mtext" id="MJXp-Span-183">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \ mu </script>  . <br><br>  Nehmen wir also die MAP-Anpassung für jedes Segment vor.  (Als Referenz: Zusätzlich zur MAP-Anpassung werden häufig die MLLR-Methode - Maximum Likelihood Linear Regression und einige ihrer Modifikationen verwendet. Sie versuchen auch, diese beiden Methoden zu kombinieren.) <br><br><pre> <code class="python hljs">SV = [] <span class="hljs-comment"><span class="hljs-comment">#    chunk-000  chunk-100 for i in range(101): clear_output(wait=True) fname='data/chunks/chunk-%003d.wav' % (i,) print('UBM MAP adaptation for {0}'.format(fname)) y_, sr_ = librosa.load(fname, sr=None) f_ = extract_features(y_, sr_, window=N_FFT, hop=HOP_LENGTH, n_mfcc=N_MFCC) f_ = preprocessing.scale(f_) gmm = copy.deepcopy(ubm) gmm = map_adaptation(gmm, f_, max_iterations=1, relevance_factor=16) sv = gmm.means_.flatten() #   sv = preprocessing.scale(sv) SV.append(sv) SV = np.array(SV) clear_output() print(SV.shape)</span></span></code> </pre><br>  Nun, da wir für jedes Segment Daten haben <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-186"><span class="MJXp-mtext" id="MJXp-Span-187">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ mu </script>  Endlich kommen wir zum letzten Schritt. <br><br><h3>  Spektrale Clusterbildung </h3><br>  Spektrale Clusterbildung wird in dem Artikel kurz beschrieben, auf den ich gleich zu Beginn verwiesen habe.  Der Algorithmus erstellt einen vollständigen Graphen, in dem die Eckpunkte unsere Daten sind und die Kanten zwischen ihnen ein Maß für die Ähnlichkeit sind.  Bei Spracherkennungsaufgaben wird eine Kosinusmetrik als solches Maß verwendet, da sie den Winkel zwischen den Vektoren berücksichtigt und deren Größe ignoriert (die keine Informationen über den Sprecher enthält).  Durch Erstellen des Graphen werden die Eigenvektoren der Kirchhoff-Matrix berechnet (was im Wesentlichen eine Darstellung des resultierenden Graphen ist), und dann wird eine Standard-Clustering-Methode verwendet, beispielsweise die k-means-Methode.  Es passt alles in zwei Codezeilen <br><br><pre> <code class="python hljs">N_CLUSTERS = <span class="hljs-number"><span class="hljs-number">2</span></span> sc = SpectralClustering(n_clusters=N_CLUSTERS, affinity=<span class="hljs-string"><span class="hljs-string">'cosine'</span></span>) labels = sc.fit_predict(SV) <span class="hljs-comment"><span class="hljs-comment">#     , . [2,1,1,0,2] labels = rearrange(labels, N_CLUSTERS) #     [0,1,1,2,0] print(labels) #   , ,  1 -  .     print([i for i, x in enumerate(labels) if x == 1])</span></span></code> </pre><br><h3>  Schlussfolgerungen und Zukunftspläne </h3><br>  Der beschriebene Algorithmus wurde mit verschiedenen Parametern getestet: <br><br><ol><li>  MFCC-Nummer: 7, 13, 20 </li><li>  MFCC in Kombination mit LPC </li><li>  Art und Anzahl der Gemische in GMM: voll [8, 16, 32], diag [8, 16, 32, 64, 256] </li><li>  UBM-Anpassungsmethoden: MAP (mit covariance_type = 'full') und MLLR (mit covariance_type = 'diag') </li></ol><br>  Infolgedessen blieben die Parameter subjektiv optimal: MFCC 13, GMM covariance_type = 'full' n_components = 16. <br><br>  Leider hatte ich nicht die Geduld (ich habe vor mehr als einem Monat angefangen, diesen Artikel zu schreiben), um die empfangenen Segmente zu markieren und DER (Diariztion Error Rate) zu berechnen.  Subjektiv bewerte ich die Funktionsweise des Algorithmus als "im Prinzip nicht schlecht, aber alles andere als ideal".  Durch Clustering auf Vektoren aus den ersten hundert Segmenten (mit einem MAP-Durchgang) und anschließende Auswahl derjenigen, bei denen der Interviewer sagt (Mädchen, sie spricht viel weniger als der Gast dort), wird durch Clustering eine Liste erstellt <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-192">1</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-194">2</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-196">25</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-198">26</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-200">46</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-202">48</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-204">49</span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-206">61</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-208">85</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-210">86</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> [1, 2, 25, 26, 46, 48, 49, 61, 85, 86] </script>  das ist 100% getroffen.  Gleichzeitig fallen Segmente aus, in denen beide Lautsprecher vorhanden sind (z. B. 14). Dies kann jedoch bereits auf den VAD-Fehler zurückgeführt werden.  Darüber hinaus beginnen solche Segmente mit einer Zunahme der Anzahl von MAP-Durchgängen berücksichtigt zu werden.  Ein wichtiger Punkt.  Das Interview, mit dem wir gearbeitet haben, ist mehr oder weniger "sauber".  Wenn verschiedene musikalische Einfügungen, Geräusche und andere nonverbale Dinge hinzugefügt werden, beginnt das Clustering zu hinken.  Daher gibt es Pläne, unser eigenes VAD zu trainieren (weil webrtcvad beispielsweise Musik nicht von Sprache trennt). <br><br>  Aufgrund der Tatsache, dass ich anfangs mit einem Telefongespräch gearbeitet habe, musste ich die Anzahl der Sprecher nicht schätzen.  Die Anzahl der Sprecher ist jedoch nicht immer vorbestimmt, auch wenn es sich um ein Interview handelt.  Zum Beispiel gibt es in <a href="">diesem</a> Interview in der Mitte eine Ansage, die der Musik überlagert ist und von zwei weiteren Personen geäußert wird.  Daher wäre es interessant, die Methode zur Schätzung der Anzahl der Sprecher auszuprobieren, die im ersten Artikel im Abschnitt der Referenzliste angegeben wurde (basierend auf einer Analyse der Eigenwerte der normalisierten Laplace-Matrix). <br><br><h3>  Referenzliste </h3><br>  Zusätzlich zu den Materialien unter den Links im Text und den Jupyter-Laptops wurden die folgenden Quellen zur Erstellung dieses Artikels verwendet: <br><br><ol><li>  Lautsprecherdiarisierung mit GMM Supervector und Advanced Reduction Algorithms.  Nurit Spingarn </li><li>  Merkmalsextraktionsmethoden LPC, PLP und MFCC bei der Spracherkennung.  Namrata Dave </li><li>  MAP-Bewertung für mulivariate Gauß-Mischungsbeobachtungen von Markov-Ketten.  Jean-Luc Gauvain und Chin-Hui Lee </li><li>  Zur Spektralclusteranalyse und einem Algorithmus.  Andrew Y. Ng, Michael I. Jordan, Yair Weiss </li><li>  Sprechererkennung mit universellem Hintergrundmodell in der YOHO-Datenbank.  Alexandre Majetniak </li></ol><br>  Ich werde auch einige Tagebuchprojekte hinzufügen: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sidekit-</a> und s4d- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Diarisierungserweiterung</a> .  Eine Python-Bibliothek zum Arbeiten mit Sprache.  Leider ist die Dokumentation schlecht. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bob</a> und seine verschiedenen Teile wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bob.bio</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bob.learn.em</a> - eine Python-Bibliothek zur Signalverarbeitung und zum Arbeiten mit biometrischen Daten.  Windows wird nicht unterstützt. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LIUM</a> ist eine schlüsselfertige Lösung, die in Java geschrieben wurde. </li></ol><br>  Der gesamte Code wird auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github veröffentlicht</a> .  Der Einfachheit halber habe ich mehrere Jupyter-Laptops mit einer Demonstration bestimmter Dinge hergestellt - MFCC, GMM, MAP-Anpassung und Diarisierung.  Letzteres ist der Hauptprozess.  Ebenfalls im Repository befinden sich Pickle-Dateien mit einigen vorgefertigten Modellen und das Interview selbst. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420515/">https://habr.com/ru/post/de420515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420505/index.html">Wird OpenAI Five das professionelle Team von The International gewinnen?</a></li>
<li><a href="../de420507/index.html">Hintergrund: Das globale Internet für alle und seine Schöpfer</a></li>
<li><a href="../de420509/index.html">Ein offensichtliches Problem bei der Verwendung von assert</a></li>
<li><a href="../de420511/index.html">Arbeiten Sie als IT-Spezialist in der Region Fernost - Amur</a></li>
<li><a href="../de420513/index.html">Eine Raubkopie eines kostenpflichtigen Dienstes in 39 Zeilen Python-Code</a></li>
<li><a href="../de420517/index.html">FPGA Integer FFT-Implementierung</a></li>
<li><a href="../de420519/index.html">Popularisierung der Wissenschaft</a></li>
<li><a href="../de420521/index.html">Jetzt offiziell: TLS 1.3 als Standard anerkannt</a></li>
<li><a href="../de420523/index.html">Analyse von binären Optionsdiagrammen oder wie ich mir erneut bewiesen habe, dass es keine Werbegeschenke gibt</a></li>
<li><a href="../de420525/index.html">Netzwerke für die erfahrensten. Teil fünfzehn. QoS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>