<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍂 ✍🏻 👆🏿 SportIduino - Arduino Orientierungslauf Elektronisches Markierungssystem 💍 👩🏾‍🏫 🧑‍🤝‍🧑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es ist immer wunderbar, aufs Land zu gehen, aber mit einer Karte in der Hand und einem bewussten Ziel ist es immer interessanter. Es gibt Arten von Ou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SportIduino - Arduino Orientierungslauf Elektronisches Markierungssystem</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404565/"><img src="https://habrastorage.org/web/6e5/049/cd8/6e5049cd8c2c4ec6907532fd1ab6a8ac.JPG"><br><br>  Es ist immer wunderbar, aufs Land zu gehen, aber mit einer Karte in der Hand und einem bewussten Ziel ist es immer interessanter.  Es gibt Arten von Outdoor-Aktivitäten wie Orientierungslauf, Rogains, Multi-Rennen, an denen Sie eine gute Zeit haben können.  Die Aufgabe des Orientierers ist es, die auf der Karte angegebenen Kontrollpunkte in kürzester Zeit zu besuchen.  Um die Tatsache ihres Besuchs zu beweisen, werden sie als sogenannte verwendet  „Traditionelle“ Markierungssysteme: Buntstifte, Codesymbole, Komposter usw. sowie elektronische Systeme.  Trotz der Bequemlichkeit des letzteren sind traditionelle Methoden in Amateurwettbewerben immer noch weit verbreitet.  Dies ist auf die Kosten für die Ausrüstung (ab 3.500 Rubel pro Stationsmarke und ab 450 Rubel pro Chip) zurückzuführen, mit der Möglichkeit des Diebstahls von an öffentlichen Orten installierten Stationen und der Notwendigkeit, eine Kaution für den Chip zu hinterlegen.  Deshalb habe ich mir zum Ziel gesetzt, eine günstigere Alternative zu schaffen.  Die Implementierung in der Arduino-Umgebung wird unten beschrieben. <br><a name="habracut"></a><br>  Ein elektronisches Markierungssystem besteht normalerweise aus RFID-Chips und -Stationen - speziellen Geräten zum Aufzeichnen und Lesen.  Das System funktioniert wie folgt.  Zu Beginn erhält der Orientierungslaufsportler einen Chip, nimmt eine Karte und startet.  Er rennt zum CP, legt seinen Chip auf die Markierungsstation, sie zeichnet die aktuelle Zeit auf dem Chip auf und gibt ein Signal, nach dem der Athlet weitermachen kann.  An der Ziellinie übergibt der Athlet den Chip dem Richter, der die Informationen über die Gateway-Station liest und dem Athleten das Ergebnis mitteilt - seine Zeit in der Ferne, die Anzahl der besuchten CPs, die Einhaltung einer bestimmten Anweisung.  Er kann auch Teilungen drucken - Zeiträume, die auf dem Weg zwischen dem CP verbracht wurden, wodurch der Athlet seinen Weg analysieren und sich mit anderen auf einem bestimmten Streckenabschnitt vergleichen kann. <br><br>  Für die Arbeit mit RFID-Chips gibt es ein weit verbreitetes Modul RFID-RC522, für das es eine hervorragende Bibliothek für Arduino gibt. In vielerlei Hinsicht hat diese Tatsache seine Verwendung bestimmt.  Das Modul arbeitet mit einer Frequenz von 13,56 MHz und unterstützt die Norm ISO 14443, arbeitet mit verschiedenen Chips, das Lesen und Schreiben erfolgt aus einer Entfernung von mehreren Zentimetern, was für unsere Zwecke gut geeignet ist. <br><br><img src="https://habrastorage.org/web/1fa/1a4/186/1fa1a4186195442bba96b58d0405324e.JPG"><br><br>  <b>Chips</b> <br><br>  Um ein Markierungssystem zu erstellen, habe ich den Mifare Classic 1K (S50) -Chip verwendet, da er in verschiedenen Designs verfügbar und günstig ist (11 Rubel pro Chip in Form eines Schlüsselbunds).  Mit dem Chip können Sie Informationen schnell und zuverlässig lesen und schreiben.  Der Chipspeicher ist strukturell in 16 Sektoren unterteilt, von denen jeder 4 Blöcke mit 16 Bytes enthält.  Der 4. Block jedes Sektors enthält Schlüssel, mit denen Blöcke im Sektor geschrieben / gelesen werden können.  Darüber hinaus enthält der Nullblock im Nullbereich die UID und Informationen zum Hersteller.  Somit bleiben 3 Blöcke mit 16 Bytes zum Schreiben in Sektoren vom 1. bis zum 15. und zwei Blöcke im 0. Sektor übrig.  Die Aufzeichnungsstruktur ist in der folgenden Tabelle dargestellt. Alle Daten werden aus Gründen der Zuverlässigkeit dreifach aufgezeichnet. <br><br><img src="https://habrastorage.org/web/7db/d8d/587/7dbd8d5873ba4e6b9c729b9ba17dd39b.png"><br><br>  Mit diesem Aufzeichnungssystem können Sie 45 Markierungen im Speicher aufzeichnen, einschließlich Start und Ziel. Für die meisten Wettbewerbe ist dies völlig ausreichend.  Wenn Sie jedoch die Speichernutzung optimieren und etwas mehr Zeit investieren, kann die Kapazität erheblich erhöht werden. <br><br><img src="https://habrastorage.org/web/2dd/01a/6b6/2dd01a6b642c40639634811fa5f71e22.JPG"><br><br>  <b>Stationen Stationen</b> <br><br>  <i>Schema und Installation</i> <br><br>  Die Hauptkomponenten der Stationen der Marke: Mikrocontroller - Atmega328p-au, RF522-Modul, Uhr DS3231.  Angetrieben von 3 AA-Batterien über den Linearstabilisator MCP1700T-33. <br><br><img src="https://habrastorage.org/web/614/c46/d8e/614c46d8e4bf4617b6ba02a2b69e5106.jpg"><br><br>  Ich habe die Komponenten auf einer Leiterplatte installiert, alle SMD-Komponenten. Mit der RFID-Platine habe ich die Verbindung durch Löten über den Pin-Anschluss hergestellt.  Die Platten wurden unter Verwendung von Fotolack-Spuren von 0,5 mm hergestellt.  Während die Methode perfektioniert wurde, habe ich viel geheiratet, es ist wahrscheinlich zweckmäßiger, Gerber-Dateien zu erstellen und ihre Produktion nebenbei zu bestellen, da es nicht sehr teuer ist. <br><br><img src="https://habrastorage.org/web/887/6a0/176/8876a017695846c184bf5aaac77b5e55.JPG"><br><br>  Ich benutze den erschwinglichen g1020BF als Fall.  Ich bohrte ein Loch in die Box für die LED und schnitt überschüssiges Plastik ab, um in das Batteriefach zu gelangen.  Das Loch für die LED wurde mit Epoxid behandelt, dann wurde eine gelötete Leiterplatte eingesetzt.  Nachdem das Epoxidharz ausgehärtet war, injizierte es 30 Milliliter der PK-68-Verbindung, was gerade ausreichte, um die Platte zu bedecken.  Ich legte Batterien in das Batteriefach und schmierte alles mit Fett zum Abdichten.  Nach dem Festziehen des Deckels ist die Station betriebsbereit. <br><br><img src="https://habrastorage.org/web/dab/19f/14e/dab19f14e7fa4c5b9f56fce173c95b70.jpg"><br><br>  Die Kosten für Stationskomponenten und -materialien für die Herstellung betragen etwa 500 Rubel.  Ich brauche ungefähr 1,5 Stunden reine Zeit, um eine Station zu erstellen und einzurichten. <br><br>  <i>Stationsfirmware</i> <br><br>  Während des Betriebs der Station sind verschiedene Arten von Fehlfunktionen möglich. Es war erforderlich, die Arbeit von Watchdog zu implementieren. Daher müssen Sie einen kompatiblen Bootloader verwenden, damit er ordnungsgemäß funktioniert.  Eine gute Version des Bootloaders für Atmega328p und Anweisungen zur Installation finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  Sie sollten auch die Standard-Drahtbibliothek auf nicht blockierend ändern, damit die Station weiter funktioniert, wenn die i2c-Leitung unterbrochen wird und nicht in eine Endlosschleife gerät.  Ich habe den Bootloader mit einem anderen Arduino über das Arduino als ISP-Firmware geladen und die SPI-Kontakte über die Pins zum RFID-Modul verbunden, das ich nach einem erfolgreichen Start abgebissen habe.  Danach habe ich die Hauptfirmware installiert. <br><br>  Mit der Hauptfirmware liest die Station beim Einsetzen des Fachs einen Informationsblock, aus dem sie die Nummern des zuletzt aufgezeichneten Blocks und der Station lernt, an der die Markierung aufgetreten ist.  Wenn die Stationsnummer unterschiedlich ist, wird der Informationsblock aktualisiert und die Stationsnummer und die aktuelle Zeit werden im nächsten freien Block aufgezeichnet.  Die Zeit und die Stationsnummer können mit speziellen Chips und der Gateway-Station eingestellt werden. <br><br>  <i>Ernährung</i> <br><br>  Eines der wichtigsten Probleme, das es wert war, gelöst zu werden, war die Maximierung der Lebensdauer von Stationen mit einem Satz Batterien.  Dies ist besonders wichtig für die touristische Orientierung, wenn die Stationen lange vor dem Wettbewerb installiert werden und eine Funktionsfähigkeit von mehr als einem Monat gewährleistet sein muss. <br><br>  Um den Verbrauch zu reduzieren, werden sowohl für den Controller als auch für den RC522 Schlafmodi verwendet.  Im Ruhemodus verbraucht die Station im Betrieb nur 0,02 mA gegenüber 20 mA.  Um Energie sparsamer zu nutzen, wurden drei Stationsbetriebsarten mit unterschiedlichen Ruhezeitintervallen implementiert. <br><br>  Standardmäßig startet die Station im Standby-Modus.  Gleichzeitig wird der Chip jede Sekunde durchsucht, die Batteriekapazität reicht für 160 Tage.  Wenn der Chip eingelegt ist (dies erfolgt durch den Produktionsrichter oder den ersten Athleten, der zur Station gelaufen ist), wechselt die Station in den Betriebsmodus.  Im Betriebsmodus wird alle 250 ms eine Chipsuche durchgeführt.  Neue Batterien halten 45 Tage im Dauerbetrieb.  Nach 6 Stunden Inaktivität kehrt die Station in den Standby-Modus zurück. <br><br>  Wenn der Master-Sleep-Chip (spezieller Judge-Chip mit Stationseinstellungen) eingeschaltet wird, wechselt die Station in den Speichermodus (alle 25 Sekunden nach dem Chip suchen), wählt dreimal und startet neu.  Neue Batterien in diesem Modus halten 5 Jahre.  Wenn ein Fach auf einen Chip gelegt wird, wechselt die Station in den Standby-Modus und die verbleibende Batterieladung wird gemessen.  Wenn die Spannung unter 3,1 V fällt, was darauf hinweist, dass etwa 15% der Ladung verbleiben, signalisiert die Station dies. <br><br>  <b>Schnittstelle und Datenverarbeitung</b> <br><br>  Für die Arbeit mit Chips und Markierungsstationen ist eine Schnittstellenstation vorgesehen.  Mit der Gateway-Station können Sie die Zeit- und Stationsnummern mithilfe spezieller Master-Chips einstellen und anpassen.  Außerdem führt die Gateway-Station die Reinigung und Überprüfung der Chips vor dem Start durch und gibt sie mit anfänglichen Informationen und einer individuellen Nummer ein.  Nun, natürlich liest es die Chips und erhält die Ergebnisse. <br><br>  Der Schaltung habe ich außerdem ein SD-Modul zum Aufzeichnen von Splits und ein Bluetooth-Modul hinzugefügt, damit die Station mit einem Telefon oder Computer verbunden werden kann, um Daten zu empfangen oder zu senden. <br><br><img src="https://habrastorage.org/web/311/76a/72a/31176a72ae274e089e98e8f28b6caca1.PNG"><br><br>  Während die Schaltung und Firmware noch nicht genug optimiert und bisher von den Modulen implementiert sind, auf dem Knie.  In Zukunft ist eine Fertigstellung für eine bequemere Verwendung geplant. <br><br><img src="https://habrastorage.org/web/26b/aa9/e93/26baa9e935164e8f8bc0e44d5482856e.JPG"><br><br>  Derzeit erfolgt die Datenverarbeitung halbmanuell durch Sortieren der resultierenden CSV-Dateien.  Das System ist sehr flexibel und kann einfach für jeden Wettbewerb konfiguriert werden, um die Datenvorverarbeitung im Gateway in verschiedenen Fällen auf bequeme Weise zu implementieren.  Für die Zukunft ist geplant, Software zur Automatisierung der Datenverarbeitung zu schreiben. <br><br>  <b>Fazit</b> <br><br>  Ich bin neu in der Programmierung und Entwicklung elektronischer Geräte und mache dies seit weniger als einem Jahr.  Daher sind die Code- und Schaltungslösungen möglicherweise alles andere als optimal oder völlig falsch.  Ich werde mich sehr freuen zu kritisieren, das ganze Projekt ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf dem Github</a> frei verfügbar. <br><br>  Ich möchte mich auch bei denen bedanken, die bereits mit Tipps geholfen haben und an der Entwicklung interessiert sind. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de404565/">https://habr.com/ru/post/de404565/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de404555/index.html">Bewertung des Yealink SIP-T27G IP-Telefons</a></li>
<li><a href="../de404557/index.html">Welcher Fortschritt MS-06-Lkw wird am 16. Juni 2017 an die ISS liefern: Überprüfung von Ladungen, Experimenten und Aufgaben</a></li>
<li><a href="../de404559/index.html">Die Herausforderung für Fünfjährige, die "viral" geworden ist</a></li>
<li><a href="../de404561/index.html">Büro im Stil von Canon. Übersicht über Geräte und Lösungen für Unternehmen</a></li>
<li><a href="../de404563/index.html">Radius-Alternative für kleine Netzwerke</a></li>
<li><a href="../de404567/index.html">Herausgeber Peter. Sommerschlussverkauf</a></li>
<li><a href="../de404569/index.html">Teilchen, Antiteilchen und ihre Vernichtung</a></li>
<li><a href="../de404571/index.html">Soziale Netzwerke - eine neue ernsthafte Quelle für Cyber-Bedrohungen</a></li>
<li><a href="../de404573/index.html">Das "mathematische Monster" gewinnen: Es geht nicht um Zahlen, sondern darum zu lernen, zu denken</a></li>
<li><a href="../de404575/index.html">Microsofts KI hat den Rekord eines Mannes bei Frau gebrochen. Pac-Man</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>