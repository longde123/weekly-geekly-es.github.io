<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ๏ธ ๐ ๐ฆ ุชุฌุฑุจุชู ูู ุฅูุดุงุก ุชุทุจูู ูุชุนุฏุฏ ุงูุฎููุท ููุนูู ูุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ๐ฒ ๐พ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูููุช ุงูุญุงูู ุ ูู ุชูุงุฌุฆ ุฃู ุดุฎุต ุจุชุทุจููุงุช ูุชุนุฏุฏุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ููููู ุฃุนุชูุฏ ุฃูู ูู ูุฐู ุงูููุงูุฉ ููููู ุฃู ุชุฌุฏ ุจุนุถ ุงูุฃููุงุฑ ุงููุซูุฑุฉ ููุงูุชูุงู. ุจุฏุฃุช ุฏุฑุงุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุฌุฑุจุชู ูู ุฅูุดุงุก ุชุทุจูู ูุชุนุฏุฏ ุงูุฎููุท ููุนูู ูุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459478/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ุงูุญุงูู ุ ูู ุชูุงุฌุฆ ุฃู ุดุฎุต ุจุชุทุจููุงุช ูุชุนุฏุฏุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ููููู ุฃุนุชูุฏ ุฃูู ูู ูุฐู ุงูููุงูุฉ ููููู ุฃู ุชุฌุฏ ุจุนุถ ุงูุฃููุงุฑ ุงููุซูุฑุฉ ููุงูุชูุงู.  ุจุฏุฃุช ุฏุฑุงุณุชู ุนู Java ุจูุฐุง ุงููุดุฑูุน ุ ูุฐูู ุฑุจูุง ุฃููู ูุฎุทุฆูุง ุฌุฏูุง ูู ุจุนุถ ุงูุฃูุงูู ุฃู ุฃููู ุจุฅูุดุงุก ุฏุฑุงุฌุฉ ูุจูุฑุฉ ุ ููููู ุขูู ุฃู ููุชู ุฃุญุฏูู ุจุชุฌุฑุจุฉ ุฃุญุฏ ุงููุจุชุฏุฆูู ูู Java.  ุณุฃูุฏู ุงูุนุฏูุฏ ูู ููุฒุงุช ุงูุชุทุจูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ูุนูู ูุน ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุญุตุฑูุง ูู ุงูุฐุงูุฑุฉ ุ ุจุบุถ ุงููุธุฑ ุนู ุญุฌู ุงููุณุฎ ุงูุงุญุชูุงุทู </li><li style=";text-align:right;direction:rtl">  ูุง ูุชู ุชุญููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ุงููุณุฎ ุงูุงุญุชูุงุทู / ุงุณุชุนุงุฏุฉ ุงูุนูููุงุช ูููู ุฅูุบุงุคูุง </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุญุช ุฎูุถ ุณูุชู ุงููุธุฑ ูู ุจููุฉ ุงูุชุทุจูู ุ ููุฐูู ุงููุดุงูู ุงูุฑุฆูุณูุฉ ุงูุชู ูุงุฌูุชูุง ูุญููุง. </p><a name="habracut"></a><br><h2 id="obzor-prilozheniya" style=";text-align:right;direction:rtl">  ูุธุฑุฉ ุนุงูุฉ ุนูู ุงูุชุทุจูู </h2><br><p style=";text-align:right;direction:rtl">  ูุญุฏุซ ุงูุชูุงุตู ูุน ุงูุชุทุจูู ูู ุฎูุงู Web UI ุ ูููู ูู ุงููุณุชูุจู ุณูููู ูู ุงููููู ุฅุถุงูุฉ REST API ุฅุฐุง ูุฒู ุงูุฃูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ููุชุทุจูู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุณุฎ ุงุญุชูุงุทูุฉ ูุชุญููููุง ุนูู ูุงุญุฏ ุฃู ุฃูุซุฑ ูู ุงููุฎุงุฒู </li><li style=";text-align:right;direction:rtl">  ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุนู ุทุฑูู ุชุญููููุง ูู ุงูุชุฎุฒูู </li><li style=";text-align:right;direction:rtl">  ุญุฐู ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ูู ุฌููุน ุงููุฎุงุฒู </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุณุฎ ุงุญุชูุงุทูุฉ ุจุดูู ุฏูุฑู </li></ol><br><p style=";text-align:right;direction:rtl">  ุงููุณุชูุฏุนุงุช ุงููุฏุนููุฉ ุญุงูููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุธุงู ุงููููุงุช ุงููุญูู (ุบูุฑ ูุนุชูุฏ ูู Docker) </li><li style=";text-align:right;direction:rtl">  ุฏุฑูุจุจูุฅูุณ </li></ul><br><p style=";text-align:right;direction:rtl">  ููุงุนุฏ ุงูุจูุงูุงุช ุงููุฏุนููุฉ ุญุงููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุชุทุจูู ุฎุงุต ุ ูููููู ููุงุญุธุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุนูู ุงูุตุญูุญ ูู ุชูููู ูุชูุฉ </li><li style=";text-align:right;direction:rtl">  ูุง ูุชู ุชุญููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ ุ ุจุบุถ ุงููุธุฑ ุนู ุญุฌู ุงููุณุฎ ุงูุงุญุชูุงุทู.  ูุธุงู ุงููููุงุช ูุชุฎุฒูู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููุคูุช ุบูุฑ ูุดุชุฑู ุฃูุถูุง.  ูู ูู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุงุณุชุนุงุฏุฉ ุ ูุจุงูุชุงูู ุชุญููู / ุชูุฑูุบ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุ ุชุญุฏุซ ุญุตุฑุง ูู ุงูุฐุงูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ุนุจุฑ ููุตุฉ - ูุนูู ุนูู ูู ูู ูููุฏูุฒ ูููููุณ. </li><li style=";text-align:right;direction:rtl">  ูููููุง ูุฑุงูุจุฉ ุฌููุน ุงูููุงู ุงูุฌุงุฑูุฉ ูุฅูุบุงุกูุง ุฅุฐุง ูุฒู ุงูุฃูุฑ. </li></ol><br><p style=";text-align:right;direction:rtl">  ูููุง ููู ููุทุงุช ุดุงุดุฉ Web UI ุชุตู ููุฒุงุช ุงูุชุทุจูู ุจูุถูุญ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฏุงุฑุฉ ุงูุชุฎุฒูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/vl/qg/n5/vlqgn5f58ub5jhxixeeg2uq-oa8.png" title="ูุถููุง ุงูุชุฎุฒูู"></a> <br> <a href=""><img src="https://habrastorage.org/webt/oj/o5/uj/ojo5uj_raxkwd1btsjrktiowifo.png" title="ูุงุฆูุฉ ุงูุชุฎุฒูู"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฏุงุฑุฉ ููุงุนุฏ ุงูุจูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/wn/6p/bk/wn6pbkcqg4qu_9btgrvnqm3l7x0.png" title="ุฅุถุงูุฉ ูุงุนุฏุฉ ุจูุงูุงุช"></a> <br> <a href=""><img src="https://habrastorage.org/webt/wu/9a/4k/wu9a4ky7icuiyqdxeiii9xbu5d8.png" title="ูุงุฆูุฉ ููุงุนุฏ ุงูุจูุงูุงุช"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅูุดุงุก ุงููุณุฎ ุงูุงุญุชูุงุทู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/1d/zb/6s/1dzb6scvtua5v3m_3l11lch4rgm.png" title="ุฅูุดุงุก ุงููุณุฎ ุงูุงุญุชูุงุทู"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/gj/9f/w0/gj9fw0onqw7f0lf7ycw05aphinc.png" title="ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฏุงุฑุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/sy/jz/y6/syjzy68wqxgi8smgq74giqstgu0.png" title="ูุงุฆูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุณุฎ ุงูุงุญุชูุงุทู ุงูุฏูุฑู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/hk/pw/tg/hkpwtg3kf7c5ho3f7ae7_uos7v0.png" title="ุฅูุดุงุก ูููุฉ ุฏูุฑูุฉ"></a> </p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุชุจุน ุงูููุงู ุงูุฌุงุฑูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/al/dt/su/aldtsuel4amtjlvbbbusccxddh0.png" title="ูุงุฆูุฉ ุงูููุงู ููุฏ ุงูุชุดุบูู"></a> </p></div></div><br><hr><br><h2 id="arhitektura" style=";text-align:right;direction:rtl">  ููุฏุณุฉ ูุนูุงุฑูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุณูุชู ุงูุนูู ุงูุฑุฆูุณู ูู 3 ุฎุฏูุงุช - <em>DatabaseBackup</em> ุ <em>ุงููุนุงูุฌ</em> ุ <em>ุงูุชุฎุฒูู</em> ุ ูุณูููู ุจุฑุจุทูุง ูุนูุง ุจุงุณุชุฎุฏุงู <em>ููููู ุงูููุงู</em> .  ุญูู ูู ูุฐุง ุฃุจุนุฏ ูู ุฐูู. </p><br><h3 id="databasebackup" style=";text-align:right;direction:rtl">  DatabaseBackup </h3><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงูุฎุฏูุฉ ูุณุคููุฉ ุนู ุฅูุดุงุก ูุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ูููุต ุงูุนุงุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ุงูุฎุฏูุฉ: </p><br><pre style=";text-align:right;direction:rtl"><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DatabaseBackup</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">InputStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createBackup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DatabaseSettings databaseSettings, Integer id)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restoreBackup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream in, DatabaseSettings databaseSettings, Integer id)</span></span></span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุนูู ููุง ุฃุณุงููุจ ุงููุงุฌูุฉ ุนูู ูุซููุงุช <strong>InputStream</strong> ุ ุญูุซ ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุนุฏู ุชุญููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ ุ ููุง ูุนูู ุฃูู ูุฌุจ ูุฑุงุกุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ / ูุชุงุจุชูุง ูู ูุถุน ุงูุชุฏูู.  ูุชู ุฅูุดุงุก ููุงู <em>DatabaseSettings</em> ูุณุจููุง ูู Web UI ููููู ุจุชุฎุฒูู ุงูุฅุนุฏุงุฏุงุช ุงููุฎุชููุฉ ุงููุงุฒูุฉ ูููุตูู ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ูุง ูู ูุฐู ุงููุนููุฉ - <code>id</code> - ุณูุชู ุดุฑุญ ุฃูุซุฑ ููููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุชุทูุจุงุช ุงูุฎุฏูุฉ ูู ููุง ููู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุง ุงูุทุฑููุชูู ูุง ูุฌุจ ูุฑุงุกุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุทุฑููุฉ <code>restoreBackup()</code> ุจุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูู ูุนุงููุฉ ูุงุญุฏุฉ ุ ุจุญูุซ ูุง ุชุชุฑู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุญุงูุฉ ุบูุฑ ูุชุณูุฉ ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ. </li></ol><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุทุจูู PostgreSQL (ูุตู ุงููุต)</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุนูู ูุฌู ุงูุชุญุฏูุฏ ุ ูู ุชุทุจูู PostgreSQL ุ ูุชู ุชูููุฐ ุงูุฎุฏูุฉ ุนูู ุงููุญู ุงูุชุงูู: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>createBackup()</code> : ูุชู ุฅูุดุงุก ุนูููุฉ <em>pg_dump ูู</em> ุดุฃููุง ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููุชุงุจุชูุง ุฅูู ุฏูู ุงูุฅุฎุฑุงุฌ ุงูููุงุณู.  ูุชู ุฅุฑุฌุงุน ุฏูู ุฅุฎุฑุงุฌ ุงูุนูููุฉ ุงูููุงุณู ูู ุงูุทุฑููุฉ (ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://docs.oracle.com/javase/8/docs/api/java/lang/Process.html#getInputStream--</a> ).  ุชุณุชูุฏ ุชุฏููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ูู ุงููุธุงู ุฅูู ูุฎุฒู ูุคูุช ุจุญุฌู ูุนูู ุ ูุนูุฏูุง ุชูุชุจ ุนูููุฉ ูุง ุฅูู ุฏูู ุงูุฅุฎุฑุงุฌ ุ ูุฅููุง ุชูุชุจ ูุนูููุง ุฅูู ุงููุฎุฒู ุงููุคูุช ูู ุงูุฐุงูุฑุฉ.  ุงูุดูุก ุงูุฃูุซุฑ ุฃูููุฉ ููุง ูู ุฃู ูุคุดุฑ ุชุฑุงุจุท ุงูุนูููุฉ ูู ููุชุจ ุฅูู ุงููุฎุฒู ุงููุคูุช <em>ุงููุนุจุฃ</em> ุญุชู ุชุชู ูุฑุงุกุฉ ุงูุฃุฎูุฑ ูู ุงูุฌุงูุจ ุงูุขุฎุฑ ุ ููุง ูุนูู ุฃู ุงูุฎูุท ุณูููู ูู ุญุงูุฉ ููููุฉ ููู ูุชู ุชุญููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุจุงููุงูู ูู ุงูุฐุงูุฑุฉ.  ุฑุจูุง ุชููู ูุฏ ูุงุฌูุช ูููููุง ุญูุซ ูุตู ุจุฑูุงูุฌ Java ุฅูู ุทุฑูู ูุณุฏูุฏ ุฃุซูุงุก ุงูุนูู ูุน ุงูุนูููุงุช ูุธุฑูุง ูุญูููุฉ ุฃูู ูู ุชูุฑุฃ ุงูุญุงูุฉ ุฃู ุงูุนูููุฉ.  ูู ุงูููู ููุบุงูุฉ ูุฑุงูุจุฉ ุฐูู ุ ูุฃู ุงูุนูููุฉ ูุง ูููู ุฃู ุชุณุชูุฑ ุฅุฐุง ุชู ุญุธุฑูุง ุนูู ููุงููุฉ ุญุธุฑ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุนูุฏ ุงููุชุงุจุฉ ุฅูู ูุฎุฒู ูุคูุช ูุงูู ููุง ููุฑุฃ ุฃุญุฏ ูุฐุง ุงููุฎุฒู ุงููุคูุช. </li><li style=";text-align:right;direction:rtl">  <code>restoreBackup()</code> : ูุชู ุฅูุดุงุก ุนูููุฉ <em>psql</em> ุ ุชุชู ูุฑุงุกุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูู <code>restoreBackup()</code> ุชู ุชูุฑูุฑูุง ุฅูู ุงูุทุฑููุฉ ูุชุชู ูุชุงุจุชูุง ูู ููุณ ุงูููุช ุฅูู ุฏูู ุงูุฅุฏุฎุงู ุงูููุงุณู psql (ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://docs.oracle.com/javase/8/docs/api/java/lang/Process. ุฃุชุด ุชู ุฃู ุฃู # getOutputStream--</a> ).  ูุนูู ูุฐุง ูุฃู ุงููุณุฎ ุงูุงุญุชูุงุทู PostgreSQL ุจูุต ุนุงุฏู ูู ูุฌุฑุฏ ูุฌููุนุฉ ูู ุฃูุงูุฑ DDL ู DML ุงูุชู ูุณูู ููููุง psql. </li></ol><br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ุงููุซูุฑ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุฐูู ูู ุฃุนุทููุง ููุง ุ ูููู ููููู ูุดุงูุฏุชูุง ุนูู GitHub ุจุงุณุชุฎุฏุงู ุงูุฑุงุจุท ูู ููุงูุฉ ุงูููุงูุฉ. </p></div></div><br><h3 id="processor" style=";text-align:right;direction:rtl">  ุงููุนุงูุฌ </h3><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงูุฎุฏูุฉ ูุณุคููุฉ ุนู ุงุณุชุฎุฏุงู ุงููุนุงูุฌุงุช ูุฅุนุงุฏุฉ ูุนุงูุฌุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู.  ุชุณุชุฎุฏู ุงููุนุงูุฌุงุช ูุจู ุงูุชูุฒูู ููุชุฎุฒูู ุฃู ุจุนุฏ ุงูุชูุฑูุบ ูู ุงูุชุฎุฒูู.  ูุซุงู ุงููุนุงูุฌ: ุถุงุบุท ุ ุงูุชุดููุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ุงูุฎุฏูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Processor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">InputStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream in)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">InputStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deprocess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream in)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">ProcessorType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// ProcessorType -  Enum,     int getPrecedence(); //   }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุนุงูุฌ ูู ุงูุฃููููุฉ - ุฅุฐุง ุชู ุชุญุฏูุฏ ุนุฏุฉ ูุนุงูุฌุงุช ุ ูุณูุชู ุชุทุจูููุง ุจุชุฑุชูุจ ุชูุงุฒูู ููุฃููููุฉ.  ุนูุฏ ุชุทุจูู ุงููุธููุฉ ุงูุนูุณูุฉ ุจููุณ ุงูุชุฑุชูุจ ุงูุฐู ุชู ุจู ุชุทุจูู ุงููุนุงูุฌุงุช ุ ูุญุตู ุนูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุงูุฃุตููุฉ. </p><br><h3 id="storage" style=";text-align:right;direction:rtl">  ุชุฎุฒูู </h3><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงูุฎุฏูุฉ ูุณุคููุฉ ุนู ุชุญููู ูุชูุฑูุบ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุ ููุฐูู ุฅุฒุงูุชูุง ูู ุงูุชุฎุฒูู.  ุชุฎุฒูู ูุซุงู: Dropbox ุ ูุธุงู ุงููููุงุช ุงููุญูู. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฌูุฉ ุงูุฎุฏูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Storage</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uploadBackup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(InputStream in, StorageSettings storageSettings, String backupName, Integer id)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">InputStream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downloadBackup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(StorageSettings storageSettings, String backupName, Integer id)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteBackup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(StorageSettings storageSettings, String backupName, Integer id)</span></span></span></span>; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชู ุชุนููู ุงุณู ูุฑูุฏ ููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุชู ุฅูุดุงุคูุง - ุญุชู ูุชููู ูู ุงูุนุซูุฑ ุนูููุง ุนูู ุฃู ูู ุงููุฎุงุฒู ุงูุชู ุชู ุชูุฒูููุง ุฅูููุง.  ุฅู ุงูุทุฑููุฉ ุงูุชู ูุชู ุจูุง ุนุฑุถ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุนูู ูุญุฏุฉ ุงูุชุฎุฒูู ูู ูุณุฃูุฉ ุชูููุฐ ุงูุฎุฏูุฉ ุจุดูู ุญุตุฑู ุ ูููู ุนูุฏ ููู ุงุณู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุฅูู ุฅุญุฏู ุงููุธุงุฆู ุ ูุฌุจ ุฃู ูุชููุน ุงูุณููู ุงูุตุญูุญ.  ูุชู <em>ุฅูุดุงุก</em> ููุงู <em>StorageSettings</em> ูุณุจููุง ูู Web UI ููููู ุจุชุฎุฒูู ุงูุฅุนุฏุงุฏุงุช ุงููุงุฒูุฉ ูููุตูู ุฅูู ูุญุฏุฉ ุงูุชุฎุฒูู. </p><br><hr><br><h3 id="koncepciya-taskov" style=";text-align:right;direction:rtl">  ููููู ุงููููุฉ </h3><br><p style=";text-align:right;direction:rtl">  ููุฏ ุฃู ูููู ูุงุฏุฑูู ุนูู ุชุชุจุน ุญุงูุฉ ููุงููุง ุ ูุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก ุงููุญุชููุฉ ุญุณุจ ุชูุฏู ุงููููุฉ ุ ููุฐูู ุฅูุบุงุก ุงูููุงู.  ูุฐูู ุ ุณูู ูุณุชูุฑ ูู ุงูุนูู ููุท ูุน ุงูููุงู.  ุณูุชู ุชูุซูู ูู ูููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุณุฌู ูู ุงูุฌุฏูู ุ ูุจุฑูุฌูุงู ุจูุงุณุทุฉ ูุซูู <strong>Future</strong> (ุฑุงุฌุน Java <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Future</a> ).  ูุฑุชุจุท ูู ุณุฌู ูู ุงูุฌุฏูู ุจูุณุชูุจูู ุงูุฎุงุต (ุนูุงูุฉ ุนูู ุฐูู ุ ุฅุฐุง ูุงูุช ููุงู ุนุฏุฉ ุฎูุงุฏู ููุฏ ุงูุชุดุบูู ุ ููููู ุฃู ุชููู ูุซููุงุช ุงููุณุชูุจู ูู ุฐุงูุฑุฉ ุงูุฎูุงุฏู ุงููุฎุชููุฉ). </p><br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูุฐูุจ ุจุงูุชุชุงุจุน.  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุฎุฏูุฉ ูุจุฏุก ุงูููุงู - ุฅูุดุงุก ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ูุงุณุชุนุงุฏุชูุง ูุญุฐููุง. </p><br><h4 id="zapusk-zadach" style=";text-align:right;direction:rtl">  ุฅุทูุงู ุงููููุฉ </h4><br><p style=";text-align:right;direction:rtl">  <strong>ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ:</strong> </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startBackupTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull Task.RunType runType, @NotNull List&lt;String&gt; storageSettingsNameList, @Nullable List&lt;ProcessorType&gt; processors, @NotNull DatabaseSettings databaseSettings)</span></span></span><span class="hljs-function"> </span></span>{ Objects.requireNonNull(runType); Objects.requireNonNull(storageSettingsNameList); Objects.requireNonNull(processors); Objects.requireNonNull(databaseSettings); BackupProperties backupProperties = backupPropertiesManager.initNewBackupProperties(storageSettingsNameList, processors, databaseSettings.getName()); Task task = tasksManager.initNewTask(Task.Type.CREATE_BACKUP, runType, backupProperties.getId()); Integer taskId = task.getId(); Future future = tasksStarterExecutorService.submit(() -&gt; { tasksManager.updateTaskState(taskId, Task.State.CREATING); logger.info(<span class="hljs-string"><span class="hljs-string">"Creating backup..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream backupStream = databaseBackupManager.createBackup(databaseSettings, taskId)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.APPLYING_PROCESSORS); logger.info(<span class="hljs-string"><span class="hljs-string">"Applying processors on created backup. Processors: {}"</span></span>, processors); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream processedBackupStream = backupProcessorManager.process(backupStream, processors)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.UPLOADING); logger.info(<span class="hljs-string"><span class="hljs-string">"Uploading backup..."</span></span>); backupLoadManager.uploadBackup(processedBackupStream, backupProperties, taskId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.COMPLETED); logger.info(<span class="hljs-string"><span class="hljs-string">"Creating backup completed. Backup properties: {}"</span></span>, backupProperties); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException ex) { logger.error(<span class="hljs-string"><span class="hljs-string">"Error occurred while closing input stream of created backup"</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (RuntimeException ex) { logger.error(<span class="hljs-string"><span class="hljs-string">"Error occurred while creating backup. Backup properties: {}"</span></span>, backupProperties, ex); errorTasksManager.addErrorTask(taskId); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException ex) { tasksManager.setInterrupted(taskId); logger.error(<span class="hljs-string"><span class="hljs-string">"Backup creating task was interrupted. Task ID: {}"</span></span>, taskId); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { futures.remove(taskId); } }); futures.put(taskId, future); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> task; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฑ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจุซูุงุซ ุฎุทูุงุช ุฑุฆูุณูุฉ ุจุงูุชุฑุชูุจ ุงูุชุงูู: ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ -&gt; ุชุทุจูู ุงููุนุงูุฌุงุช -&gt; ุงูุชุญููู ุฅูู ุงูุชุฎุฒูู.  ูู ุฌููุน ุฃุณุงููุจ ุงูุฎุฏูุฉ ุชูุฑูุจูุง ุ ูุนูุฏ ุชูุฌูู ูุนุฑูู ุงููููุฉ ุงูุญุงููุฉ ุญุชู ุชุชููู ุงูุฎุฏูุฉ ูู ุงูุฅุจูุงุบ ุนู ุฎุทุฃ ูู ุณูุณูุฉ ุฑุณุงุฆู ุชุนูู ูู ุงูุฎูููุฉ.  ุญูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุ ููุงุฐุง ูุชู ููุงูุดุฉ <em>InterruptedException</em> ููุง ููุง ุณูุญุฏุซ ูุน ูุฌูุฏ ุฎุทุฃ ุจุนุฏ ุชููู <em>RuntimeException</em> ูุงุญููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฅููู ููููุฉ ุชุดุบูู ูููุฉ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">tasksStarterService.startBackupTask(Task.RunType.USER, storageSettingsNameList, processors, databaseSettings);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงููุนููุฉ ุงูุฃููู ุงูุชู ููุฑุฑูุง ุฅูู ุจุงุฏุฆ ุงููููุฉ: ุงููุณุชุฎุฏู ุฃู ูููุฉ ุงูุฎุงุฏู ุงูุฏุงุฎููุฉ (ูุซุงู ุนูู ูููุฉ ุฏุงุฎููุฉ ูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ).  ุชุชูุญ ููุง ูุนุฑูุฉ ุจุงุฏุฆ ุงููููุฉ ุฅุธูุงุฑ ุชูู ุงูููุงู ุงูุชู ุชู ุชุดุบูููุง ุจูุงุณุทุฉ ุงููุณุชุฎุฏู ูู Web UI ููุท.  ุงููุนููุงุช ุงููุชุจููุฉ ุถุฑูุฑูุฉ ูุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจุงุดุฑุฉ - ูุงุฆูุฉ ูู ุงููุฎุงุฒู ูุงููุนุงูุฌุงุช ูุงุณุชุฎุฏุงููุง ุ ููุงุนุฏุฉ ุจูุงูุงุช ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ููู ุชูุฑูุบ. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุ ูุชู ุฃูุถูุง ุฅูุดุงุก ุณุฌู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุณูู <strong>BackupProperties</strong> .  ุณูููู ูุฐุง ุงูููุงู ุจุชุฎุฒูู ุฎุตุงุฆุต ุงููุณุฎ ุงูุงุญุชูุงุทู ูุซู ุงูุงุณู ูุงููุนุงูุฌุงุช ุงููุณุชุฎุฏูุฉ ููุงุฆูุฉ ุงููุณุชูุฏุนุงุช ุงูุชู ุชู ุชูุฒูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุนูููุง.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุงุณุชุนุงุฏุฉ ุฃู ุญุฐู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุ ุณูุนูู ูุน ูุฐุง ุงูููุงู ุงููุญุฏุฏ. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุชุฎุฒูู ุงููููุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ุงููููุฐุฌ ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"backup_tasks"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Task</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Identifier of each backup task. Identifier is generated by PostgreSQL database after saving of entity. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(insertable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, updatable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.IDENTITY) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer id; <span class="hljs-comment"><span class="hljs-comment">/** * Backup task type. * &lt;p&gt; * Type is set at the very start of any task and can't be changed. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@see</span></span></span><span class="hljs-comment"> Type */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Enumerated</span></span>(EnumType.STRING) <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(updatable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Type type; <span class="hljs-comment"><span class="hljs-comment">/** * Who initiated a task: user or server. * &lt;p&gt; * We need to know it to show on front only these tasks that was started by user. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@see</span></span></span><span class="hljs-comment"> RunType */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Enumerated</span></span>(EnumType.STRING) <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(updatable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RunType runType; <span class="hljs-comment"><span class="hljs-comment">/** * Backup task state. * &lt;p&gt; * State is updated with every new step in task being executed. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@see</span></span></span><span class="hljs-comment"> Task.State */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Enumerated</span></span>(EnumType.STRING) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> State state; <span class="hljs-comment"><span class="hljs-comment">/** * Whether task has been interrupted or not. * &lt;p&gt; * Default is {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@literal</span></span></span><span class="hljs-comment"> false}. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(insertable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> interrupted; <span class="hljs-comment"><span class="hljs-comment">/** * Identifier of {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> BackupProperties}. * &lt;p&gt; * We need to know backup ID to be able to handle occurred errors. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(updatable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer backupPropertiesId; <span class="hljs-comment"><span class="hljs-comment">/** * Start time of the task. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(updatable = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> LocalDateTime date; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> RunType { USER, INTERNAL } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> State { PLANNED, CREATING, RESTORING, DELETING, APPLYING_PROCESSORS, APPLYING_DEPROCESSORS, DOWNLOADING, UPLOADING, COMPLETED, } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> Type { CREATE_BACKUP { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"CREATE BACKUP"</span></span>; } }, RESTORE_BACKUP { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"RESTORE BACKUP"</span></span>; } }, DELETE_BACKUP { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"DELETE BACKUP"</span></span>; } } } <span class="hljs-comment"><span class="hljs-comment">// getters &amp; setters... }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ููููู ูุตู ุนูููุฉ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุดูู ุฑุณู ุชุฎุทูุทู ุนูู ุงููุญู ุงูุชุงูู: <br><img src="https://habrastorage.org/webt/bm/um/cy/bmumcyhyapjg4ono73qo8kiquom.png" alt="ุนูููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู" title="ุนูููุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู"></p><br><hr><br><p style=";text-align:right;direction:rtl">  ูุชู ุฅุทูุงู ุฃููุงุน ุฃุฎุฑู ูู ุงูููุงู ุนู ุทุฑูู ุงูููุงุณ.  ููู ูุง ุชุดูุด ุงูููุงูุฉ ุจูููุฉ ูุงุฆูุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูุฃูู ูุถููู ุ ุณุฃูุฏู ูู ุฑูุฒูุง ูุจุฏุก ุงูููุงู ูุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูุญุฐููุง ุจุดูู ูููุตู ูู ุงูููุณุฏ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงุณุชุนุงุฏุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startRestoreTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull Task.RunType runType, @NotNull BackupProperties backupProperties, @NotNull String storageSettingsName, @NotNull DatabaseSettings databaseSettings)</span></span></span><span class="hljs-function"> </span></span>{ Objects.requireNonNull(runType); Objects.requireNonNull(backupProperties); Objects.requireNonNull(storageSettingsName); Objects.requireNonNull(databaseSettings); Task task = tasksManager.initNewTask(Task.Type.RESTORE_BACKUP, runType, backupProperties.getId()); Integer taskId = task.getId(); Future future = tasksStarterExecutorService.submit(() -&gt; { tasksManager.updateTaskState(taskId, Task.State.DOWNLOADING); logger.info(<span class="hljs-string"><span class="hljs-string">"Downloading backup..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream downloadedBackup = backupLoadManager.downloadBackup(backupProperties.getBackupName(), storageSettingsName, taskId)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted() || downloadedBackup == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.APPLYING_DEPROCESSORS); logger.info(<span class="hljs-string"><span class="hljs-string">"Deprocessing backup..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream deprocessedBackup = backupProcessorManager.deprocess(downloadedBackup, backupProperties.getProcessors())) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.RESTORING); logger.info(<span class="hljs-string"><span class="hljs-string">"Restoring backup..."</span></span>); databaseBackupManager.restoreBackup(deprocessedBackup, databaseSettings, taskId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.COMPLETED); logger.info(<span class="hljs-string"><span class="hljs-string">"Restoring backup completed. Backup properties: {}"</span></span>, backupProperties); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException ex) { logger.error(<span class="hljs-string"><span class="hljs-string">"Error occurred while closing input stream of downloaded backup"</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (RuntimeException ex) { logger.info(<span class="hljs-string"><span class="hljs-string">"Error occurred while restoring backup. Backup properties: {}"</span></span>, backupProperties, ex); errorTasksManager.addErrorTask(taskId); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException ex) { tasksManager.setInterrupted(taskId); logger.error(<span class="hljs-string"><span class="hljs-string">"Task was interrupted. Task ID: {}"</span></span>, taskId); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { futures.remove(taskId); } }); futures.put(taskId, future); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> task; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุชู ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูู ุฎูุงู 3 ุฎุทูุงุช ุฑุฆูุณูุฉ ุจุงูุชุฑุชูุจ ุงูุชุงูู: ุฅูุบุงุก ุชุญููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูุชุฎุฒูู -&gt; ุงุณุชุฎุฏุงู ูุญุฏุงุช deprocessors ููุญุตูู ุนูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ุงูุฃุตููุฉ ูููุต ุงูุนุงุฏู -&gt; ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุฏุก ุงูุงูุชุนุงุด ุนูู ุงููุญู ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">tasksStarterService.startRestoreTask(Task.RunType.USER, backupProperties, storageSettingsName, databaseSettings);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูููุฉ ุงุณุชุนุงุฏุฉ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุดูู ุฑุณู ุจูุงูู: <br><img src="https://habrastorage.org/webt/hr/_m/bk/hr_mbkvfkszhyhj6ebi1q_wa1nc.png" alt="  " title="ุนูููุฉ ุงุณุชุฑุฏุงุฏ ุงููุณุฎ ุงูุงุญุชูุงุทู"></p></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุญุฐู ุงููุณุฎ ุงูุงุญุชูุงุทู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startDeleteTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull Task.RunType runType, @NotNull BackupProperties backupProperties)</span></span></span><span class="hljs-function"> </span></span>{ Objects.requireNonNull(runType); Objects.requireNonNull(backupProperties); Task task = tasksManager.initNewTask(Task.Type.DELETE_BACKUP, runType, backupProperties.getId()); Integer taskId = task.getId(); Future future = tasksStarterExecutorService.submit(() -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { logger.info(<span class="hljs-string"><span class="hljs-string">"Deleting backup started. Backup properties: {}"</span></span>, backupProperties); tasksManager.updateTaskState(taskId, Task.State.DELETING); backupLoadManager.deleteBackup(backupProperties, taskId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); } tasksManager.updateTaskState(taskId, Task.State.COMPLETED); logger.info(<span class="hljs-string"><span class="hljs-string">"Deleting backup completed. Backup properties: {}"</span></span>, backupProperties); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (RuntimeException ex) { logger.error(<span class="hljs-string"><span class="hljs-string">"Error occurred while deleting backup. Backup properties: {}"</span></span>, backupProperties, ex); errorTasksManager.addErrorTask(taskId); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException ex) { tasksManager.setInterrupted(taskId); logger.error(<span class="hljs-string"><span class="hljs-string">"Task was interrupted. Task ID: {}"</span></span>, taskId); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { futures.remove(taskId); } }); futures.put(taskId, future); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> task; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูููุฉ ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุจุณูุทุฉ ููุบุงูุฉ: ูุชู ุจุจุณุงุทุฉ ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุฌููุน ุงููุฎุงุฒู ุงูุชู ุชู ุชูุฒูููุง ุฅูููุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุฅูุบุงุก ุงูุชุซุจูุช ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">tasksStarterService.startDeleteTask(Task.RunType.USER, backupProperties);</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูููุฉ ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุดูู ุฑุณู ุจูุงูู: <br><img src="https://habrastorage.org/webt/y4/ca/yp/y4cayp76w4v0tx8umvzcp6flzd4.png" alt="  " title="ุนูููุฉ ุฅุฒุงูุฉ ุงููุณุฎ ุงูุงุญุชูุงุทู"></p></div></div><br><hr><br><h3 id="otmena-taskov" style=";text-align:right;direction:rtl">  ุฅูุบุงุก ุงููููุฉ </h3><br><p style=";text-align:right;direction:rtl">  ูุง ูู ุฅูุบุงุก ุงููููุฉุ  ุจุงูุทุจุน ุ ูุฐุง ููุณ ุฃูุซุฑ ูู ุฅููุงุก ูุคุดุฑ ุชุฑุงุจุท.  ููููู ุฃู ุชุฑู ุฃู ุฌููุน ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุฑุฆูุณูุฉ ุงูุชู ูุชู ุชุดุบูููุง ูู Future ูุชู ุชุบููููุง ูู ุจููุฉ try-catch ุงูุชุงููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException ex) { ... tasksManager.setInterrupted(taskId); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃูุถูุง ุจุนุฏ ูู ุทุฑููุฉ ูููุฉ ูุชู ุงูุชุญูู ูู ุชูููุฐูุง ุ ูุชู ุชุซุจูุช ุงูุฅูุดุงุก ุงูุชุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InterruptedException(); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุงูุชูุงู ุ ูุฌุจ ุฅุนุทุงุก ูุธุฑูุฉ ูุฎุชุตุฑุฉ ุนู ุญุงูุงุช ุงููุทุงุน ุฎููุท JVM. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุฃู ุชุญุชูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ูู JVM ุนูู ุงูุญุงูุงุช ุงูุชุงููุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฌุฏูุฏ </li><li style=";text-align:right;direction:rtl">  Runnable </li><li style=";text-align:right;direction:rtl">  ุชูููุช ุงูุงูุชุธุงุฑ </li><li style=";text-align:right;direction:rtl">  ุงูุงูุชุธุงุฑ </li><li style=";text-align:right;direction:rtl">  ูุณุฏูุฏ </li><li style=";text-align:right;direction:rtl">  ุฅููุงุก </li></ol><br><p style=";text-align:right;direction:rtl">  ูุญู ููุชููู ููุท ูู ุญุงูุงุช ุงูุงูุชุธุงุฑ ูุชูููุช ุงูุงูุชุธุงุฑ.  <code>Object.wait()</code> ูู ุญุงูุฉ <em>ุงูุชุธุงุฑ</em> ุจูุงุณุทุฉ ุงูุฃุณุงููุจ <code>Object.wait()</code> ู <code>Thread.join()</code> ูุบูุฑูุง.  ูุชู ูุถุน ูุคุดุฑ ุงูุชุฑุงุจุท ูู ุญุงูุฉ <em>ุงูุชุธุงุฑ Timed</em> (ุฃู ูุชุฑุฉ ุงูุชุธุงุฑ ุชุฏูู ูุชุฑุฉ ุฒูููุฉ ูุนููุฉ) ุจุงุณุชุฎุฏุงู ุงูุฃุณุงููุจ <code>Object.wait(timeout)</code> ู <code>Thread.join(timeout)</code> ู <code>Thread.sleep(sleeping)</code> ูุบูุฑูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุดูุก ุงูุฃูุซุฑ ุฃูููุฉ ููุง ูู ุฃูู ุฅุฐุง ูุงุทุนุช ุณูุณูุฉ ุงูุฑุณุงุฆู <em>ูุจู ุงูุฏุฎูู ูู ุญุงูุฉ</em> ุงูุงูุชุธุงุฑ ุฃู ุงูุงูุชุธุงุฑ ุ ุฃู ุนูุฏูุง ูููู ุงูููุถูุน <em>ูู ูุฐู ุงูุญุงูุฉ</em> ุ ูุณุชููุธ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ููุฑูู <strong>ุฅุฌุงุจุฉ InterruptedException</strong> . </p><br><p style=";text-align:right;direction:rtl">  ููู ูุฐุง ููุณ ูู ุดูุก.  ููุณุช ุญูููุฉ ุฃู ูุคุดุฑ ุชุฑุงุจุท ุณููุชูู ุฅูู ุจูุงูุงุช ุงูุญุงูุฉ ูู ุฎูุงู ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฃู ุงุณุชุนุงุฏุชูุง ุฃู ุญุฐููุง.  ููู ุจุนุฏ ุฐูู ูุฅุจูุงุบ ุงูุฎูุท ุงูุฐู ุงููุทุนุ </p><br><p style=";text-align:right;direction:rtl">  ุชุชูุซู ุงูุทุฑููุฉ ุงูุฃููู ูู ุงูุชุญูู ูู ุนูุงูุฉ ุงูููุงุทุนุฉ ูุน ูุคุดุฑ ุงูุชุฑุงุจุท ุจุดูู ูุณุชูู ุจุงุณุชุฎุฏุงู ุงูุทุฑู Thread.interrupted <code>Thread.interrupted()</code> ุฃู <code>Thread.currentThread.isInterrupted()</code> .  ุงููุฑู ุจูู ุงูุงุซููู ูู ุฃู ุงูุฃูู ูุณุชุฏุนู ุงูุทุฑููุฉ ุงูุฃุตููุฉ ุงูุฎุงุตุฉ <code>currentThread.isInterrupted(boolean ClearInterrupted)</code> ุ ูููุฑุฑ ุฅูู ุฐูู ุ ููุง ูุดูุฑ ุฅูู ุฃูู ุณูุชู ูุณุญ ุฅุดุงุฑุฉ ุงูููุงุทุนุฉ ุ ูุงูุซุงูู ุชูุฑูุฑ <code>false</code> ุ ูุชุฑู ุนูุงูุฉ ุงูููุงุทุนุฉ ุฏูู ุชุบููุฑ.  ูุนุชูุฏ ุงูุงุฎุชูุงุฑ ุจูู ูุงุชูู ุงูุทุฑููุชูู ุชูุงููุง ุนูู ุงููููู.  ุนูุฏูุง ูุชู ุทุฑุญ InterruptedException ุ ูุชู ูุณุญ ุนูุงูุฉ ุงูููุงุทุนุฉ ุฃูุถูุง - ููุฐุง ูุณุชุญู ุงูุชุฐูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุฌุจ ุฃู ูููู ููุงู ุทุฑููุฉ ุฃุณูู - ููู ูุฐูู.  ูู ุงูุชุทุจูู ุ ููุงู ูุฏุฑ ูุจูุฑ ูู ุงูุนูู ูุน ุชุฏููุงุช I / O ุ ูุจุงูุชุงูู ูุน ุฃุณุงููุจ I / O.  ุชุชูุซู ูููุชูุง ูู ุงูุชุฃูุฏ ูู ุฃูู ุนูุฏ ุงุณุชุฏุนุงุก ุฃุณุงููุจ <code>read()</code> ุฃู <code>write(int b)</code> ุนูู ุฏูู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุ ูุชู ุฅููุงุก ุฎุทุฃ ุฃุซูุงุก ุงูููุงุทุนุฉ ุ ูุน ุงูุนูู ุจุฃูู ุชูุช ููุงุทุนุฉ ุงุณุชุฏุนุงุก ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงููุญุธูุฑ.  ูุญุณู ุงูุญุธ ุ ูุฏู Java ูุซู ูุฐุง ุงูุงุณุชุซูุงุก - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">InterruptedIOException</a> .  ููุน ุฐูู ุ ูุง ุชุฑุงูุจ ูู ุฃุณุงููุจ ุฏูู ุงููุฑุงุกุฉ / ุงููุชุงุจุฉ ููุงุทุนุฉ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ูุนูู ูุฌู ุงูุชุญุฏูุฏ ููุท <em>PipedInputStream ุชุฑุงูุจูุง</em> .  ูุฐูู ุ ูู ุชูู ุงูุฃูุงูู ุงูุชู ูุง ูุดุงุฑู ูููุง ูุฐุง ุงูุฏูู ุ ูุฌุจ ุฃู ููุณูุน ุทุฑููุฉ ุงููุฑุงุกุฉ / ุงููุชุงุจุฉ ุจุญูุซ ูุชู ุฅุจุทุงู ููุนูู ุงูููุงุทุนุฉ ุนูุฏูุง ูููู ููุงู ููุงุทุนุฉ.  ูู ุงููุงูุน ุ ูุงู ุงูุชุฏุงุฏ ุทุฑููุฉ read () ูุงููุงู ุจุงููุณุจุฉ ูู ูู ุงูุชุทุจูู ูู ููุงู ูุงุญุฏ ููุท - ุนูุฏูุง ุนุงุฏ InputStream ูู ุทุฑููุฉ ุงูุชุญููู ุงูุงุญุชูุงุทู.  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูููููุง ุจูุง ุงูุชุนุฑู ุนูู ุฃุตู ุงูููุงุทุนุฉ ุฏูู ุงูุงุถุทุฑุงุฑ ุฅูู ูุถุน ุงุฎุชุจุงุฑุงุช ุงููุงูุจ ุนูู ุงูุนูู ูู ูู ููุงู.  ููุน ุฐูู ุ ูู ุงูููู ุงูุชูุงุท ูุฐุง ุงูุงุณุชุซูุงุก ุจุดูู ูููุตู ุนู IOException ููุนุงูุฌุชู ุจุดูู ูููุตู.  ุจุงูุทุจุน ุ ูุง ููููู ุงูุงุณุชุบูุงุก ุนู ูุณุงุนุฏุฉ ูุงูุจ ุงูุชุญูู ูู ุงูุนูู ูู ุจุนุถ ุงูุฃูุงูู ุ ูููู ุฃุตุจุญ ุจุงููุนู ุฃูุถู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃูุถูุง ููุงุญุธุฉ ุฃูู ุฅุฐุง ุชู ูุณุญ ุงูุนูู ุฃุซูุงุก ูุนุงูุฌุฉ ุงูููุงุทุนุฉ ุ ููู ุงูุถุฑูุฑู ุฏุงุฆููุง ุชุนููู ุฅุดุงุฑุฉ ุงูููุงุทุนุฉ ูุฑุฉ ุฃุฎุฑู ุญุชู ุฃูู ุจุนุฏ ุงูุฑุฌูุน ูู ุงูุทุฑููุฉ ุ ูููููุง ูุนุฑูุฉ ุงูููุงุทุนุฉ ุงูุชู ุญุฏุซุช. </p><br><p style=";text-align:right;direction:rtl">  ุงุณูุญูุง ูู ุฃู ุฃุดุฑุญ ูุน ูุซุงู ููุงุฐุง ูุฐุง ููู.  ูููุชุฑุถ ุฃููุง ูููุง ุจุชุญููู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฅูู ุงูุณุนุฉ ุงูุชุฎุฒูููุฉ ูู ุทุฑููุฉ ุงูุฑูุน () ูุชุญุฏุซ ููุงุทุนุฉ.  ุชุชู ูุนุงูุฌุฉ ุงูููุงุทุนุฉ ูุชููู ุงูุนูู ูุฅุฑุฌุงุน ุงูุทุฑููุฉ.  ูุง ูุญุฏุซ ุงูุงููุทุงุน ูุน ุงูุฅุตุงุจุงุช - ููุฐุง ูุนูู ุฃู ุฃู ุฎุทุฃ ูุฏ ุญุฏุซ ูู ููุงู ูุง ุ ุฃู ุฃู ุงููุณุชุฎุฏู ุฃูุบู ุงููููุฉ.  ุจุบุถ ุงููุธุฑ ุนู ุงูุณุจุจ ุ ูุฌุจ ุฃู ูููู ูู ุงูุนูู ูู ูุฐุง ุงููุณุชูุจู.  ูููู ุฅุฐุง ูู ุชูู ุจุชุนููู ุฅุดุงุฑุฉ ุงูููุงุทุนุฉ ูุฑุฉ ุฃุฎุฑู ูุจู ุงูุนูุฏุฉ ูู ุทุฑููุฉ ุงูุชูููุฏ ุ ููู ูุนุฑู ุฃุจุฏูุง ูู ูุชูุฉ Future ุงูุฑุฆูุณูุฉ ุนู ุงูููุงุทุนุฉ ุงูุชู ุญุฏุซุช. <br>  ููุณ ุฑูุฒ ุงููุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">backupLoadManager.uploadBackup(processedBackupStream, backupProperties, taskId); &lt;-   ,       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Thread.interrupted()) { <span class="hljs-comment"><span class="hljs-comment">//      ,      - ,    throw new InterruptedException(); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูู ุงูููุงุฑุณุงุช ุงูุฌูุฏุฉ ุงูุชุนุงูู ูุน <strong>InterruptedException</strong> ุฃู <strong>InterruptedIOException</strong> ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (InterruptedException e) { <span class="hljs-comment"><span class="hljs-comment">//  InterruptedIOException ... // re-interrupt the thread Thread.currentThread().interrupt(); }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ูููููุง ุงูุชุนุงูู ูุน ุงูููุงุทุนุฉ ุ ููู ูู ุงูุฐู ุณููุงุทุน ุงูุฎููุท ุจุงููุนูุ <br>  ููููุงู ุจุฐูู ุ ุณูููู ุจุฅูุดุงุก ููุงู ุขุฎุฑ ูุณูู <em>CancelTask</em> ุ ูุงูุฐู ุณูููู ุจุชุฎุฒูู ูุนุฑู ุงููููุฉ ููุฅูุบุงุก ุ ูุฃูุถูุง ูุชุงุจุฉ ุณุงุนุฉ ุณุชุญุงูู ููุงุทุนุฉ ุงูููุงู.  ููุงุฐุง ุชุญุงููุ  ููุฃุณุจุงุจ ุงูุชุงููุฉ: </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุบูุฑ ูุงุฏุฑ ุนูู ุฅููุงุก ูุคุดุฑ ุงูุชุฑุงุจุท ูู ุฐุงูุฑุฉ ุฎุงุฏู ุขุฎุฑ.  ูููู ุฃู ุชุนูู ุนุฏุฉ ุฎูุงุฏู ููุง ุ ููุง ูุนูู ุฃู Future ูุจุนุซุฑุฉ ุนูู ุฎูุงุฏู ูุฎุชููุฉ.  ูุจุงูุชุงูู ุ ุนูุฏูุง ูุตู ุทูุจ ูุฅูุบุงุก ูููุฉ ูุง ุนูู ุฃุญุฏ ุงูุฎูุงุฏู ุ ูุฏ ูููู ุงููุณุชูุจู ุงููุฑุบูุจ ูู ุฐุงูุฑุฉ ุฎุงุฏู ุขุฎุฑ. </li><li style=";text-align:right;direction:rtl">  ูุง ูููู ุฅูุบุงุก ุงููููุฉ ููุฐ ููุฏ ุงููุณุชูุจู ุจุณุจุจ ุนุทู ูู ุงูุฎุงุฏู. </li></ol><br><p style=";text-align:right;direction:rtl">  ุตู ุจุฅูุฌุงุฒ ุฎูุงุฑุฒููุฉ ุงูุฅูุบุงุก ูู ุงููุณุงุก: <br>  ูููู ูุงุชุดุฑ ุจุฅุฎุฑุงุฌ ุฌููุน ุงูุณุฌูุงุช ูู ุฌุฏูู <em>Cancel_tasks</em> (ูู ูุชู ุถุจุท ุงูููู ูู ููุณ ุงูููุช) ุ ููุฑ ูู ูุงุญุฏ ููุญุงูู ุงูุญุตูู ุนูู ุงููุณุชูุจู ุงูููุงุจู ูู ุฐุงูุฑุชู.  ูู ุญุงูุฉ ุชููู Future ุจูุฌุงุญ ุ ุชุชู ููุงุทุนุฉ ุณูุณูุฉ ุงูุฑุณุงุฆู ุงูููุงุจูุฉ ุ ูุชุนูุฏ ุงููููุฉ ููุชู ุญุฐู ุงูุทูุจ ูู ุงูุฌุฏูู.  ุฅุฐุง ุชู ุชุฌุงูุฒ ุทูุจ ุงููููุฉ ูุฅูุบุงุก ุงููููุฉ (ููุง ูุนูู ุฃู ุงูุฎุงุฏู ุชุนุทู ูููุฏ ุงููุณุชูุจู) - ูุชู ุญุฐู ุงูุทูุจ ุจุจุณุงุทุฉ ูู ุงูุฌุฏูู.  ุฅุฐุง ูุงุญุธุช ุนุฏุฉ ุฎูุงุฏู ุงูุชูุงุก ูููุฉ ูุญุฐู ุงูุณุฌู ูู ุงูุฌุฏูู ุ ููู ูุญุฏุซ ุฃู ุดูุก ุณูุฆ ุ ูุฃู ุงูุญุฐู ูู PostgreSQL ูู ุฃูุฑ ุถุนูู. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุฑูุฒ ุฅูุบุงุก ุงูููุงู:</strong> </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุต ุงููุฎูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * This class scans for tasks to cancel and tries to cancel them. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CancelTasksWatcher</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger logger = LoggerFactory.getLogger(CancelTasksWatcher.class); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Duration cancelTimeout = Duration.ofMinutes(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CancelTasksManager cancelTasksManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TasksStarterService tasksStarterService; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TasksManager tasksManager; <span class="hljs-comment"><span class="hljs-comment">// spring setters... /** * This watcher wakes up every time 10 seconds passed from the last completion, checks if there are any tasks to cancel and tries to * cancel each task. * &lt;p&gt; * Since there are can be working more that one instance of the program, {@literal Future} instance of task can belong to different * servers. We can't get access to {@literal Future} if it's not in memory of the server where task cancellation request was accepted. * So the purpose of this watcher is to be able cancel tasks that works in the other instance of program. Each server has this watcher * checking for available cancellation requests and if any, the watcher tries to cancel corresponding {@literal Future}. * If cancellation is successful task will be also reverted. * &lt;p&gt; * If task cancellation request timeout exceeded, then it means a server that had requested {@literal Future} instances has been * shutdown, so all {@literal Future} instances lost and task can't be canceled. In such case task cancellation request will be ignored. * * @see TasksStarterService#getFuture(Integer) * @see TasksManager#revertTask(Task) */ @Scheduled(fixedDelay = 10 * 1000) @Transactional(isolation = Isolation.READ_COMMITTED, propagation = Propagation.REQUIRES_NEW) public void watchTasksToCancel() { Iterable&lt;CancelTask&gt; cancelTasks = cancelTasksManager.findAll(); Iterable&lt;Task&gt; tasks = tasksManager.findAllById(StreamSupport.stream(cancelTasks.spliterator(), false) .map(CancelTask::getTaskId).collect(Collectors.toList())); Map&lt;Integer, Task&gt; tasksAsMap = StreamSupport.stream(tasks.spliterator(), false) .collect(Collectors.toMap(Task::getId, Function.identity())); List&lt;Integer&gt; taskIdsForDeleting = new ArrayList&lt;&gt;(); for (CancelTask cancelTask : cancelTasks) { Integer taskId = cancelTask.getTaskId(); Task task = tasksAsMap.get(taskId); if (task == null) { logger.error("Can't cancel task: no such entity with ID {}", taskId); taskIdsForDeleting.add(taskId); continue; } // timeout exceeded, that is server shutdown and lost all Future instances, so task can't be canceled if (LocalDateTime.now(ZoneOffset.UTC).isAfter(cancelTask.getPutTime().plus(cancelTimeout))) { logger.error("Can't cancel task: timeout exceed. Task ID: {}", taskId); taskIdsForDeleting.add(taskId); continue; } tasksStarterService.getFuture(taskId).ifPresent(future -&gt; { logger.info("Canceling task with ID {}", taskId); boolean canceled = future.cancel(true); if (canceled) { try { // give time to properly handle interrupt Thread.sleep(10000); } catch (InterruptedException e) { // should not happen } tasksManager.revertTask(task); } taskIdsForDeleting.add(taskId); logger.info("Task canceled: {}. Task ID: {}", canceled, taskId); }); } cancelTasksManager.deleteByTaskIdIn(taskIdsForDeleting); } }</span></span></code> </pre> </div></div><br><hr><br><h4 id="obrabotka-oshibok" style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ุงูุชุนุงูู </h4><br><p style=";text-align:right;direction:rtl">    ,    ,   Future,    try-catch : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ... } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (RuntimeException e) { ... errorTasksManager.addErrorTask(taskId); }</code> </pre> <br><p style=";text-align:right;direction:rtl">     <em>RuntimeException</em>   ,     Future  ,         . </p><br><p style=";text-align:right;direction:rtl">  <code>addErrorTask(taskId)</code>        ,   ID ,    . <br>      ?       ,    ,        ,   . </p><br><p style=";text-align:right;direction:rtl">      : <br>                  ,        ,       .  โ  PostgreSQL <code>select for update</code> ,   select   <code>skip locked</code>      . ,  ,    <code>revertTask()</code> ,               . </p><br><p style=";text-align:right;direction:rtl"> <strong> ErrorTasksWatcher</strong> : </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"> </b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** * This class scans for erroneous tasks and handles them depending on their state. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Component</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ErrorTasksWatcher</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger logger = LoggerFactory.getLogger(ErrorTasksWatcher.class); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Integer nRows = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TasksManager tasksManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ErrorTasksManager errorTasksManager; <span class="hljs-comment"><span class="hljs-comment">// spring setters... /** * This watcher wakes up every time 1 minute passed from the last completion, checks backup states periodically and handles erroneous * tasks if any. * &lt;p&gt; * The watcher handles at most N tasks as described by {@link #nRows} constant and skips already locked tasks. * When retrieving error tasks from database pessimistic lock is set. It allows safely run more than one copy of program, as no other * watcher can pick up already being handled error tasks. * &lt;p&gt; * If the server shutdowns while rows was locked, transaction will be rolled back and lock released, so these entities can be picked * up by the other running server. */ @Scheduled(fixedDelay = 60 * 1000) @Transactional(isolation = Isolation.READ_COMMITTED, propagation = Propagation.REQUIRES_NEW) public void watchErrorTasks() { for (ErrorTask errorTask : errorTasksManager.findFirstNAndLock(nRows)) { if (!errorTask.isErrorHandled()) { Integer backupTaskId = errorTask.getTaskId(); Optional&lt;Task&gt; optionalTask = tasksManager.findById(backupTaskId); if (!optionalTask.isPresent()) { logger.info("Can't handle erroneous task: no corresponding backup task entity. Backup task ID: {}", backupTaskId); continue; } tasksManager.revertTask(optionalTask.get()); errorTask.setErrorHandled(true); } } } }</span></span></code> </pre> </div></div><br><p style=";text-align:right;direction:rtl"> <strong> <code>revertTask(Task)</code> :</strong> </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"> </b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">/** * This function reverts erroneous task by its entity. * &lt;p&gt; * Use this function only after canceling related {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@literal</span></span></span><span class="hljs-comment"> Future}. * &lt;p&gt; * If the task was of the type {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> Task.Type#CREATE_BACKUP} then related {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> BackupProperties} will be deleted. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> task the entity */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">revertTask</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull Task task)</span></span></span><span class="hljs-function"> </span></span>{ Objects.requireNonNull(task); Task.State state = task.getState(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> DOWNLOADING: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> APPLYING_DEPROCESSORS: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> RESTORING: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> DELETING: { logger.info(<span class="hljs-string"><span class="hljs-string">"Handling broken operation. Operation: {}. No extra actions required"</span></span>, state.toString()); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CREATING: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> APPLYING_PROCESSORS: { logger.info(<span class="hljs-string"><span class="hljs-string">"Handling broken operation. Operation: {}. Delete backup properties..."</span></span>, state.toString()); Integer backupPropertiesID = task.getBackupPropertiesId(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!backupPropertiesManager.existsById(backupPropertiesID)) { logger.error(<span class="hljs-string"><span class="hljs-string">"Can't revert task: no related backup properties. Task info: {}"</span></span>, task); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } backupPropertiesManager.deleteById(backupPropertiesID); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> UPLOADING: { logger.info(<span class="hljs-string"><span class="hljs-string">"Handling broken operation. Operation: {}. Deleting backup from storage..."</span></span>, state); Integer backupPropertiesId = task.getBackupPropertiesId(); Optional&lt;BackupProperties&gt; optionalBackupProperties = backupPropertiesManager.findById(backupPropertiesId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!optionalBackupProperties.isPresent()) { logger.error(<span class="hljs-string"><span class="hljs-string">"Can't revert task: no related backup properties. Task info: {}"</span></span>, task); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } tasksStarterService.startDeleteTask(Task.RunType.INTERNAL, optionalBackupProperties.get()); backupPropertiesManager.deleteById(backupPropertiesId); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: { logger.error(<span class="hljs-string"><span class="hljs-string">"Can't revert task: unknown state. Task info: {}"</span></span>, task); } } }</code> </pre> <br><p style=";text-align:right;direction:rtl">   : </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">     <em>DOWNLOADING</em> , <em>APPLYING_DEPROCESSORS</em> , <em>RESTORING</em> , <em>DELETING</em> โ    .      ,       . </li><li style=";text-align:right;direction:rtl">     <em>CREATING</em> , <em>APPLYING_PROCESSORS</em> โ  ,       .      BackupProperties  ,       ( BackupProperties   Web UI    ). </li><li style=";text-align:right;direction:rtl">     <em>UPLOADING</em> โ       .        BackupProperties   ,       .       . </li></ol></div></div><br><p style=";text-align:right;direction:rtl"> ,    .         ,    ? ,   ,    Future (  1),     ,          InputStream (  2). ,      2,   1            2    ? </p><br><p style=";text-align:right;direction:rtl">  ,     ,    ,       .      Future (    1)     : </p><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NotNull Throwable t, @NotNull Integer taskId)</span></span></span><span class="hljs-function"> </span></span>{ logger.error(<span class="hljs-string"><span class="hljs-string">"Exception caught. Task ID: {}"</span></span>, taskId, t); Optional&lt;Future&gt; optionalFuture = tasksStarterService.getFuture(taskId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!optionalFuture.isPresent()) { logger.error(<span class="hljs-string"><span class="hljs-string">"Can't cancel the Future of task with ID {}: no such Future instance"</span></span>, taskId); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> canceled = optionalFuture.get().cancel(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!canceled) { logger.error(<span class="hljs-string"><span class="hljs-string">"Error canceling the Future of task with ID {}"</span></span>, taskId); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { logger.info(<span class="hljs-string"><span class="hljs-string">"Task canceled. Task ID: {}"</span></span>, taskId); errorTasksManager.setError(taskId); } } }</code> </pre> <br><p style=";text-align:right;direction:rtl">   ,     ,      ID  ,   ,    Future   -  ,  ID     . </p><br><p style=";text-align:right;direction:rtl">    ,          ,     ,     ,         ,          . </p><br><p style=";text-align:right;direction:rtl"> <strong>  ,   :</strong> </p><br><p style=";text-align:right;direction:rtl"> ,   ,        ,    .       โ       Future. </p><br><p style=";text-align:right;direction:rtl">   ,      ,    ,      I/O ,          โ     /   .     ,      .       : </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ,  .     ,      โ     . </li><li style=";text-align:right;direction:rtl">     โ     Future   ,   .  , /   ,  ,     (  ,     โ    IOException  ,        ,   ). </li></ol><br><p style=";text-align:right;direction:rtl">  ,   โ            (   ID       ,  ,    ),        . </p><br><hr><br><p style=";text-align:right;direction:rtl">  ,    ,        .      ,    ,             . </p><br><h3 id="plany-na-buduschee" style=";text-align:right;direction:rtl">    </h3><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Web UI:   ,   .     ,      </li><li style=";text-align:right;direction:rtl">     </li><li style=";text-align:right;direction:rtl">      </li><li style=";text-align:right;direction:rtl">     </li><li style=";text-align:right;direction:rtl">     </li></ol><br><h3 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h3><br><p style=";text-align:right;direction:rtl">   : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>GitHub</strong></a> </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>Docker Hub</strong></a> </li></ul><br><p style=";text-align:right;direction:rtl">   ,   !           ,       GitHub! <br></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar459478/">https://habr.com/ru/post/ar459478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar459464/index.html">ููุง ูู ููุณูู 2019: ููุงุจูุฉ ูุน ุฑูุจุฑุชู ุงููุฏุณ</a></li>
<li><a href="../ar459466/index.html">ููุง ูู ููุณูู 2019: ููุงุจูุฉ ูุน ุฑูุจุฑุชู ุฅูุฑูุณุงูููุดู</a></li>
<li><a href="../ar459470/index.html">ุงูุฌุฒุก 4: ูุง ูุฒุงู ููุฏ ุงูุชุดุบูู Linux ุนูู RISC-V RISC-V</a></li>
<li><a href="../ar459472/index.html">Heroku + Docker + Spring Boot</a></li>
<li><a href="../ar459474/index.html">ููููุฉ ุฌุนู ุงููุต ุงูููุชูุจ ุจุดูู ูุซุงูู ูู ุงูุซุงููุฉ: ูุงูุฑู ูู Word ูุฃููุฆู ุงูุฐูู ููุชุจูู ุงููุซูุฑ</a></li>
<li><a href="../ar459480/index.html">ูููุงูุฏู: ููู ููุณุจ ุงููุชุตูุญ ุงููุงูุ</a></li>
<li><a href="../ar459482/index.html">ููู ูุฒููุง ุดุฌุฑุฉ ุงููุฆุฉ</a></li>
<li><a href="../ar459484/index.html">ุฌูู ุงุฑุฏูููู. ูุง ูุฎุชุฑุน ุงูุทูุงุจ ุงูุญุฏูุซูู</a></li>
<li><a href="../ar459488/index.html">ูุนุจุฉ ูุณุงุฆุท ุฎุงุตุฉ ูู ุณูุงู Roguelike</a></li>
<li><a href="../ar459490/index.html">ุญูู ูุฐุฑุฉ ูู ุจุงุฆุนู CRM: ูู ุณุชุดุชุฑู ุณูุงุฑุฉ ุจุฏูู ุนุฌูุงุชุ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>