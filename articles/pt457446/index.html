<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¦ğŸ» ğŸ›… ğŸš  Construindo e operando uma rede anycast tolerante a falhas ğŸ‘©ğŸ¼â€âœˆï¸ ğŸ‚ ğŸ©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="OlÃ¡ Habr! A seguir, Ã© apresentada uma transcriÃ§Ã£o do relatÃ³rio, por Evgeny error2407 Bogomazov (engenheiro de P&D da rede) e Dmitry h8r Shemonaev (che...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Construindo e operando uma rede anycast tolerante a falhas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/qrator/blog/457446/">  OlÃ¡ Habr!  A seguir, Ã© apresentada uma transcriÃ§Ã£o do relatÃ³rio, por Evgeny <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">error2407</a> Bogomazov (engenheiro de P&amp;D da rede) e Dmitry h8r Shemonaev (chefe do NOC) do UPTIMEDAY anterior.  VÃ­deo no final da postagem. <br><br><img src="https://habrastorage.org/webt/h2/kk/hf/h2kkhfbh4bzqqwtsh2x1_vsxjrk.png"><br><blockquote>  Hoje, gostarÃ­amos de falar sobre quais problemas surgem ao criar uma rede anycast.  Por que entramos nisso e o que estamos fazendo lÃ¡? </blockquote><a name="habracut"></a><br><img src="https://habrastorage.org/webt/_f/pb/lr/_fpblrppj9--llxvsztbw-nrzpy.png"><br>  No Qrator Labs, construÃ­mos nossa prÃ³pria rede anycast para resolver problemas especiais que diferem dos das operadoras de telecomunicaÃ§Ãµes "comuns".  Assim, temos pontos de presenÃ§a nessas regiÃµes - esquecemos de adicionar a RÃºssia aqui.  E isso significa que temos muitas histÃ³rias sobre como e nÃ£o devemos fazer.  Hoje vamos compartilhar com vocÃªs alguns deles. <br><br><img src="https://habrastorage.org/webt/ga/ai/xk/gaaixkdwusnkgwqc4h4wt_6kake.png"><br>  O que vamos contar, considerando que o tÃ³pico Ã© inicialmente volumoso?  No inÃ­cio, querÃ­amos apenas fazer perguntas e respostas (perguntas e respostas), mas ainda Ã©ramos solicitados a ler o relatÃ³rio.  Portanto, se nÃ£o contarmos algo, mas definitivamente nÃ£o tivermos tempo, nos pegue depois, Ã  margem. <br><br>  Como parte do planejado, tentaremos falar sobre a diferenÃ§a entre o balanceamento usando DNS e BGP.  Como escolher novos sites e o que vocÃª precisa prestar atenÃ§Ã£o para evitar dores subsequentes.  Como apoiar tudo isso e quanto essa difÃ­cil tarefa Dmitry dirÃ¡. <br><img src="https://habrastorage.org/webt/ai/so/3s/aiso3sgur0rj7nwml4w5zjzilhe.png"><br>  Para comeÃ§ar, vamos determinar o quanto vocÃª estÃ¡ familiarizado com o tÃ³pico. <br>  - Quantos sabem o que Ã© anycast e por que Ã© necessÃ¡rio?  (cerca de um terÃ§o das mÃ£os sobe no corredor) <br>  - E quem estÃ¡ familiarizado com o DNS e configurou o servidor?  (aproximadamente o mesmo nÃºmero de mÃ£os) <br>  - E BGP (duas mÃ£os na moldura) <br><br>  Ainda muito. <br><br>  - Bem, a Ãºltima pergunta - quem estÃ¡ familiarizado com o NOC?  Quem teve problemas com os fornecedores e quem tentou resolvÃª-los?  (a mÃ£o do administrador do sistema Habr estÃ¡ visÃ­vel no quadro) <br><br>  Ã“timo.  Nesse caso, espero que o que vamos lhe dizer venha Ã  tona. <br><img src="https://habrastorage.org/webt/ei/zh/dc/eizhdckf0att6kbopdgn49ngwji.png"><br>  Antes de passar para o anycast, vamos ver por que Ã© necessÃ¡rio.  VocÃª tem um aplicativo com o qual deseja processar solicitaÃ§Ãµes de clientes.  VocÃª estÃ¡ hospedado em algum lugar - enquanto nÃ£o estÃ¡ pensando particularmente sobre isso.  Compre o nome DNS, resolva-o e assim por diante.  Em seguida, assine o certificado, porque HTTPS.  Sua aplicaÃ§Ã£o estÃ¡ crescendo. <br><img src="https://habrastorage.org/webt/yx/z8/kt/yxz8ktime7shqpt5sesf60mtw5k.png"><br>  Primeiro, vocÃª tem que lidar com a carga.  Se seu aplicativo "dispara" ao mesmo tempo - ou seja, se torna bastante popular, muito mais usuÃ¡rios o procuram.  VocÃª deve comprar ferro e equilibrar a carga nele. <br><br>  AlÃ©m disso, clientes especialmente exigentes podem surgir com as palavras: "Pessoal, vocÃª deve estar disponÃ­vel sempre e em qualquer lugar por esse tipo de dinheiro!"  O que leva ao fato de vocÃª estar redundando os recursos de computaÃ§Ã£o nÃ£o apenas para o processamento de cargas de pico, mas simplesmente como uma reserva. <br><br>  AlÃ©m disso, hoje jÃ¡ foi mencionado em outras aparÃªncias, vocÃª nÃ£o pode colocar as glÃ¢ndulas em um data center - um desastre natural pode acontecer, o que significa que o aplicativo entrarÃ¡ em inatividade, o que causarÃ¡ perdas financeiras e outras.  Portanto, se seu aplicativo tiver crescido o suficiente, vocÃª jÃ¡ deverÃ¡ estar localizado em vÃ¡rios data centers; caso contrÃ¡rio, serÃ¡ ruim. <br><img src="https://habrastorage.org/webt/ak/ml/9l/akml9ljdopye_n4kf1u6lqrlq20.png"><br>  O problema tem um lado oposto - se seu aplicativo Ã© sensÃ­vel ao tempo, como em anÃ¡lises financeiras ou negociaÃ§Ãµes, Ã© importante que vocÃª envie solicitaÃ§Ãµes aos seus usuÃ¡rios o mais rÃ¡pido possÃ­vel.  A latÃªncia notÃ³ria com a qual dois pontos estÃ£o conectados.  A primeira - se vocÃª deseja fazer uma solicitaÃ§Ã£o o mais rÃ¡pido possÃ­vel, para isso, o nÃºmero de solicitaÃ§Ãµes e respostas a elas deve ser o menor possÃ­vel.  Novamente, o fato Ã© que, quando o usuÃ¡rio se conecta a vocÃª pela primeira vez - tudo nÃ£o funciona e ele Ã© forÃ§ado a passar por todos os cÃ­rculos do inferno.  O segundo ponto Ã© a velocidade da luz.  Um pacote da Europa Ocidental para a RÃºssia nÃ£o pode ir mais rÃ¡pido do que um certo nÃºmero de milissegundos, nÃ£o hÃ¡ nada a ser feito. <br><img src="https://habrastorage.org/webt/rv/8b/f0/rv8bf0jfbctzabai0cuqh6q18ni.png"><br>  Ã‰ necessÃ¡rio estar localizado em vÃ¡rios data centers, porque queremos redundÃ¢ncia e precisamos estar mais prÃ³ximos dos clientes em potencial.  Se, por exemplo, sua principal regiÃ£o de clientes Ã© a AmÃ©rica, vocÃª colocarÃ¡ seu equipamento lÃ¡ para que o trÃ¡fego nÃ£o passe por outros paÃ­ses e partes do mundo. <br><br>  Acontece que, a partir de algum ponto, vocÃª terÃ¡ que estar presente em todas as partes do mundo em diferentes locais.  E isso ainda nÃ£o Ã© anycast. <br><img src="https://habrastorage.org/webt/ko/uv/q2/kouvq2rg2extkysj5rffo8btofe.png"><br>  EntÃ£o vocÃª precisa de alguns sites.  De alguma forma, vocÃª precisa escolhÃª-los, ambos inicialmente novos, e entender sua capacidade de escalar - durante a sobrecarga, vocÃª terÃ¡ que comprar hardware adicional. <br><br>  Se vocÃª jÃ¡ possui vÃ¡rios sites, precisa aprender como distribuir usuÃ¡rios entre eles.  Existem duas cadeiras: BGP e DNS. <br><img src="https://habrastorage.org/webt/ve/zp/aj/vezpajk-xzaj4g0_rohgo3ouhqi.png"><br>  A partir de dois pontos, comeÃ§aremos com o Ãºltimo.  E novamente duas abordagens principais.  No primeiro, vocÃª tem sites diferentes, IPs diferentes e, portanto, quando um usuÃ¡rio solicita - ele obtÃ©m o IP de um site especÃ­fico e o mapeia. <br><br>  O que estamos decidindo aqui?  Queremos que um usuÃ¡rio de uma determinada regiÃ£o acesse um site localizado na mesma regiÃ£o.  A soluÃ§Ã£o mais simples e burra Ã© usar o GeoDNS.  VocÃª entende as regiÃµes nas quais os prefixos estÃ£o localizados - vocÃª pega esses dados, envia-os ao servidor DNS, mapeia os usuÃ¡rios de acordo, se o IP de origem vier do prefixo certo, para o site certo.  Mas hÃ¡ um problema - resolvedores.  E cerca de 15 a 20% das solicitaÃ§Ãµes vÃªm de resolvedores - ou seja, o IP de origem serÃ¡ 8.8.8.8.  Onde colocar isso? <br><br>  Para fazer isso, existe o EDNS, que permite, na estrutura da solicitaÃ§Ã£o, transferir a sub-rede original do cliente da qual ela veio.  Como vocÃª sabe, em 1 de fevereiro de 2019, o Dia da Bandeira do DNS aconteceu - a partir desse dia, todos os servidores DNS devem suportar esta extensÃ£o. <br><br>  Neste exemplo, vocÃª pode ter um ou vÃ¡rios sites nos quais estÃ£o localizados servidores DNS que mapeiam os usuÃ¡rios - e os prÃ³prios servidores podem ser distribuÃ­dos pelo mundo.  E jÃ¡ no Ã¢mbito do DNS hÃ¡ uma oportunidade de usar o anycast - falaremos sobre isso um pouco mais tarde. <br><br>  No esquema geral, vocÃª mapeia o usuÃ¡rio para o site mais prÃ³ximo dele, fornecendo o endereÃ§o desse site especÃ­fico.  Ã‰ usado com menos frequÃªncia. <br><br>  A terceira abordagem estÃ¡ relacionada ao fato de que, mesmo que o usuÃ¡rio tenha vindo da mesma regiÃ£o em que o site estÃ¡ localizado, isso nÃ£o significa que o problema de atrasos foi resolvido.  Pode ser ainda mais lucrativo transferir o usuÃ¡rio para outro site, pois a regiÃ£o pode ser sobrecarregada se rotas alternativas estiverem disponÃ­veis.  Seria bom usar isso?  Infelizmente, quase nÃ£o existem soluÃ§Ãµes atuais para fazer algo semelhante.  O Facebook de alguma forma mostrou um relatÃ³rio de que ele fez isso - mas nÃ£o hÃ¡ caixa, tudo terÃ¡ que ser feito com suas prÃ³prias mÃ£os. <br><img src="https://habrastorage.org/webt/6a/m1/qp/6am1qpmydhm7ztcbihnlxg9uxn4.png"><br>  O que temos com o DNS? <br><br>  As vantagens sÃ£o que usuÃ¡rios diferentes podem receber endereÃ§os diferentes e um usuÃ¡rio especÃ­fico pode ser enviado para um site estritamente definido - ou seja, vocÃª pode trabalhar com usuÃ¡rios individuais.  Bem, o DNS Ã© fÃ¡cil de configurar. <br><br>  Quais sÃ£o as desvantagens?  Se vocÃª fizer um ajuste granular, a configuraÃ§Ã£o aumentarÃ¡ rapidamente, o que Ã© impossÃ­vel de suportar com as mÃ£os.  Precisa de automaÃ§Ã£o.  E se a automaÃ§Ã£o for feita incorretamente, tudo irÃ¡ falhar - se o DNS estiver, o aplicativo nÃ£o estarÃ¡ disponÃ­vel. <br><br>  Por outro lado, se vocÃª fizer o balanceamento de DNS, o usuÃ¡rio mapearÃ¡ para um site especÃ­fico e seu IP ficarÃ¡ vulnerÃ¡vel.  Esta Ã© a razÃ£o pela qual nÃ£o usamos o balanceamento de DNS em casa, pois nesse caso todo o trÃ¡fego do ataque pode fluir exatamente em um ponto, desativando-o. <br><br>  E, como jÃ¡ mencionado, o DNS nÃ£o suporta o balanceamento de latÃªncia pronto para uso.  E fazer vocÃª mesmo Ã© muito difÃ­cil. <br><img src="https://habrastorage.org/webt/9k/on/ng/9konngtwrxyf4kmhqlj-gjytbnw.png"><br>  Finalmente vamos ao que interessa, nomeadamente o BGP anycast. <br><br>  Este Ã© exatamente o nosso caso.  Qual Ã© o objetivo?  Todos os sites tÃªm o mesmo IP, ou melhor, anunciam o mesmo prefixo.  O usuÃ¡rio mapeia para o site "mais prÃ³ximo" dele.  â€œMais prÃ³ximoâ€ do ponto de vista do BGP - esse prefixo Ã© anunciado usando vÃ¡rias rotas e, se o operador tiver vÃ¡rias rotas para o site anunciado, na maioria das vezes ele escolherÃ¡ a mais curta.  Novamente do ponto de vista do BGP.  Em breve explicaremos por que isso Ã© ruim. <br><br>  O BGP tambÃ©m trabalha com a disponibilidade de prefixos; portanto, vocÃª sempre opera em uma sub-rede e nÃ£o pode manipular IPs individuais. <br><br>  Como resultado, como o mesmo prefixo Ã© anunciado em todos os sites, todos os usuÃ¡rios da mesma regiÃ£o serÃ£o direcionados para o mesmo site.  O invasor nÃ£o tem como transferir a carga de uma regiÃ£o para outra, portanto, vocÃª precisa ganhar tanta energia em cada um dos lugares quanto o operador que escolheu essa rota quisesse.  Mesmo se vocÃª nÃ£o pontuar, ele ainda poderÃ¡ ser protegido. <br><br>  O mesmo prefixo Ã© anunciado - o que poderia ser mais fÃ¡cil?  Mas tambÃ©m hÃ¡ problemas. <br>  A primeira Ã© que, devido Ã  necessidade de anunciar o mesmo prefixo em todo o mundo, vocÃª Ã© obrigado a comprar endereÃ§os independentes de provedor, que sÃ£o vÃ¡rias vezes mais caros. <br><br>  A segunda se resume ao fato de que usuÃ¡rios de uma regiÃ£o nÃ£o podem ser simplesmente jogados em outra, se de repente alguns deles forem ilegÃ­timos ou para diversificar o trÃ¡fego de ataque usando outros sites, porque alguns deles machucam.  NÃ£o existem tais canetas. <br><br>  O terceiro problema Ã© que, dentro da estrutura do BGP, Ã© muito fÃ¡cil escolher o site "errado" e os fornecedores "errados".  Parece que vocÃª tem redundÃ¢ncia e disponibilidade, mas, na realidade, nÃ£o haverÃ¡ nem um nem outro. <br><img src="https://habrastorage.org/webt/mo/bq/tt/mobqttqpsg2o2yhh9yzydelt008.png"><br>  VocÃª tem vÃ¡rios sites entre os quais deseja dispersar os usuÃ¡rios.  Quais sÃ£o as formas de restringir uma determinada regiÃ£o, atraindo usuÃ¡rios para um site especÃ­fico? <br><br>  HÃ¡ comunidade geogrÃ¡fica.  Por que eles sÃ£o?  Deixe-me lembrÃ¡-lo - vocÃª escolhe a rota mais prÃ³xima do ponto de vista do BGP.  E vocÃª tem um operador de NÃ­vel 1, por exemplo, NÃ­vel3, que possui seu prÃ³prio tronco em todo o mundo.  O cliente Level3, se vocÃª estiver conectado diretamente a ele, estÃ¡ localizado em duas esperanÃ§as de vocÃª.  E algum operador local - em trÃªs.  Assim, um operador da AmÃ©rica estarÃ¡ mais perto de vocÃª do que um operador da RÃºssia ou da Europa, porque, do ponto de vista do BGP, Ã© assim. <br><br>  Usando a Comunidade GeogrÃ¡fica, vocÃª pode limitar a regiÃ£o na qual um operador tÃ£o grande e internacional anunciarÃ¡ sua rota.  O problema tambÃ©m Ã© que eles nem sempre estÃ£o disponÃ­veis (Comunidade GeogrÃ¡fica). <br><br>  Temos vÃ¡rios casos quando se tratava de nÃ³s mesmos.  Dim? <br><br>  (Dmitry Shemonaev toma a palavra) <br><img src="https://habrastorage.org/webt/no/w0/6i/now06iptknl3uf_utkuguxmotn0.png"><br><br>  Pronto, muitas operadoras nÃ£o fornecem isso e dizem que, dizem eles, nÃ£o restringiremos nada pela neutralidade, liberdade e assim por diante da rede.  Temos que explicar aos operadores por um longo tempo e quem somos, por que queremos e por que Ã© tÃ£o importante para nÃ³s, e tambÃ©m para educar por que isso nÃ£o se aplica Ã  neutralidade que eles tÃªm em mente.  Ã€s vezes isso funciona - e Ã s vezes nÃ£o, e simplesmente nos recusamos a cooperar com operadores potencialmente interessantes, porque essa cooperaÃ§Ã£o levarÃ¡ a mais problemas na operaÃ§Ã£o de nosso serviÃ§o. <br><br>  AlÃ©m disso, muitas vezes encontramos o fato de que Eugene jÃ¡ mencionou vÃ¡rios operadores - estes sÃ£o de nÃ­vel 1, que nÃ£o compram trÃ¡fego de ninguÃ©m e apenas trocam trÃ¡fego entre eles.  Mas, alÃ©m deles, existem pelo menos dezenas de operadores que nÃ£o sÃ£o de nÃ­vel 1 - eles compram trÃ¡fego, mas ao mesmo tempo tambÃ©m tÃªm redes implantadas em todo o mundo.  VocÃª nÃ£o precisa ir muito longe - do mais prÃ³ximo a nÃ³s Ã© Rostelecom ou ReTN, um pouco mais longe, existem maravilhosas telecomunicaÃ§Ãµes de Taipei, China Unicom, Singtel e assim por diante. <br><br>  E na Ãsia, muitas vezes enfrentamos uma situaÃ§Ã£o que, ao que parece, temos vÃ¡rios pontos de presenÃ§a na Ãsia, estamos conectados a vÃ¡rios operadores bastante grandes, do ponto de vista dessa regiÃ£o.  No entanto, somos constantemente confrontados com o fato de que o trÃ¡fego da Ãsia vai para o nosso site pela Europa ou faz uma viagem transatlÃ¢ntica.  Do ponto de vista do BGP, isso Ã© bastante normal para si, porque nÃ£o leva em consideraÃ§Ã£o a latÃªncia.  Mas o aplicativo sofre nessas condiÃ§Ãµes, tambÃ©m seus usuÃ¡rios - em geral, todo mundo sofre, mas do ponto de vista do BGP, estÃ¡ tudo bem. <br><br>  E vocÃª precisa fazer algumas alteraÃ§Ãµes com as mÃ£os, fazer engenharia reversa de como o encaminhamento deste ou daquele operador Ã© organizado, Ã s vezes negociar, perguntar, implorar, ajoelhar-se.  Em geral, faÃ§a qualquer coisa para resolver esses problemas.  Com isso, nosso NOC Ã© confrontado com regularidade invejÃ¡vel. <br><br>  Como regra, os operadores atendem Ã s suas necessidades e, em alguns casos, estÃ£o prontos para fornecer um determinado conjunto ... Mas, em geral, aqueles que trabalharam com o BGP no nÃ­vel da comunidade levantam as mÃ£os?  (Sorrisos) Ã“timo!  Ou seja, os operadores estÃ£o prontos para fornecer algum conjunto de gerentes da comunidade para, por exemplo, diminuir o pref local em uma determinada regiÃ£o ou adicionar prefpend ou nÃ£o anunciar bem ou qualquer outra coisa. <br><br>  Consequentemente, existem duas maneiras de equilibrar a carga no BGP.  O primeiro Ã© como estÃ¡ escrito no slide, o chamado  anexa.  Podemos imaginar o caminho para o BGP como uma pequena linha listando sistemas autÃ´nomos pelos quais o caminho do pacote do remetente ao destinatÃ¡rio passa.  VocÃª pode adicionar um enÃ©simo nÃºmero de sistemas autÃ´nomos a esse caminho e, como resultado, o caminho serÃ¡ estendido e se tornarÃ¡ nÃ£o muito prioritÃ¡rio.  Este Ã© um mÃ©todo frontal e nÃ£o funciona para tudo - se vocÃª adicionar prefpend, nÃ£o Ã© granular, ou seja, todos verÃ£o no cone do operador no qual vocÃª estÃ¡ fazendo essa manipulaÃ§Ã£o. <br><br>  Por outro lado, hÃ¡ tambÃ©m a comunidade BGP, que estÃ¡ marcando uma, para entender de onde vem esse ou aquele prefixo, de quem Ã© em relaÃ§Ã£o ao operador - ou seja, um banquete, cliente ou montante, e tambÃ©m em que lugar Ã© ocupado. assim por diante  E hÃ¡ gerentes de comunidade que vÃ£o ao roteador para o operador e ele executa determinadas aÃ§Ãµes com esse prefixo. <br><br>  A maioria dos operadores possui comunidades restritivas.  Tomemos, por exemplo, o operador russo abstrato, que estÃ¡ conectado a vÃ¡rios operadores russos no vÃ¡cuo.  Alguns deles tÃªm relacionamentos ponto a ponto, o que implica uma troca de paridade de trÃ¡fego, e alguns os compram.  Dessa forma, eles fornecem comunidade para fazer prepends nessa direÃ§Ã£o, estendendo o caminho do AS ou para nÃ£o anunciar ou alterar o pref local.  Se vocÃª estiver operando com o BGP - observe a comunidade e saiba o que o candidato pode fazer para se tornar seu fornecedor.  Ã€s vezes, as comunidades estÃ£o ocultas e vocÃª precisa se comunicar com os gerentes de operadores ou com especialistas tÃ©cnicos para nos mostrar um determinado conjunto suportado. <br><br>  Por padrÃ£o, a comunidade, no caso da regiÃ£o europeia, Ã© descrita no RIPE DB.  Ou seja, vocÃª solicita a quem sÃ£o os nÃºmeros do sistema autÃ´nomo e o campo ObservaÃ§Ãµes geralmente diz o que o operador possui em termos de marcaÃ§Ã£o e gerenciamento da comunidade.  Nem todo mundo tem isso, muitas vezes vocÃª tem que procurar lugares diferentes e interessantes. <br><br>  Assim que vocÃª comeÃ§a a operar o BGP, em essÃªncia, vocÃª diz que a rede faz parte do seu aplicativo e nÃ£o algo abstrato, portanto, vocÃª deve considerar os riscos. <br><br>  Por exemplo, tivemos um caso com uma instituiÃ§Ã£o financeira letÃ£, cujo prefixo, se incluÃ­do em nossa rede, ficou indisponÃ­vel em cerca da metade da LetÃ´nia.  Embora pareÃ§a que nada mudou - o mesmo prefixo que anunciamos nas operadoras de nÃ­vel 1, na Europa, parece que tudo estÃ¡ lÃ¡, incluindo redundÃ¢ncia.  Mas nÃ£o podÃ­amos nem imaginar que aproximadamente metade dos operadores letÃµes possuÃ­sse como dispositivos de fronteira que nÃ£o pudessem digerir o volume total da visualizaÃ§Ã£o completa (toda a tabela de roteamento BGP), que na Ã©poca era de cerca de 650 mil prefixos.  Eles ficaram lÃ¡, bem, se alguÃ©m sabe o que Ã© o Catalyst 3550, foi exatamente lÃ¡ que estava, ele poderia ter apenas 12.000 prefixos.  Bem, eles receberam uma certa quantidade de prefixos de IX'a, nos quais, Ã© claro, nÃ£o havia padrÃ£o.  Junto com isso, de outro operador - a televisÃ£o letÃ£, cujo prefixo no nono dia nÃ£o era / 24, mas / 22 no qual esse / 24 estava. <br><br>  Como resultado, ele foi para um lugar onde nÃ£o sabia para onde encaminhar e tudo voou para dentro do cano.  Para consertar isso, levamos cerca de dois dias e uma correspondÃªncia persistente com os operadores letÃµes atÃ© que eles nos mostrassem a saÃ­da do dispositivo de fronteira e apenas notÃ¡ssemos o nome do host lÃ¡.  OlÃ¡ pessoal, Ã s vezes Ã© tÃ£o divertido. <br><br>  Existem muitos operadores com ferro velho.  Existem muitos operadores com um entendimento estranho de como a rede deve funcionar.  E agora esse tambÃ©m Ã© seu problema se vocÃª estiver jogando com o BGP.  Bem, no final, muitos operadores sÃ£o unipodal (um fornecedor superior de conectividade), portanto, eles tÃªm seus prÃ³prios conjuntos de muletas. <br><img src="https://habrastorage.org/webt/89/zx/is/89zxisdottw3dfx4cxkca1o1xt4.png"><br><br>  (Evgeny Bogomazov continua) <br><br><img src="https://habrastorage.org/webt/l-/dd/wa/l-ddwaj2uwwteduh5wupbhygz1i.png"><br><br>  Como vocÃª pode ver, mesmo este tÃ³pico pode ser desenvolvido por um longo tempo e Ã© difÃ­cil mantÃª-lo em 40 minutos. <br><br>  EntÃ£o, vocÃª tem canetas com as quais deseja limitar a regiÃ£o.  Agora, vamos descobrir o que vocÃª precisa analisar e o que Ã© importante considerar quando vocÃª deseja se hospedar em um novo site. <br><br>  O melhor caso nÃ£o Ã© comprar seu hardware, mas concordar com uma nuvem de hospedagem.  EntÃ£o, jÃ¡ serÃ¡ possÃ­vel concordar com ele que vocÃª se conectarÃ¡ independentemente a determinados fornecedores. <br><br>  Por outro lado, se vocÃª seguiu esse caminho, deve entender aproximadamente qual regiÃ£o, com ou sem alÃ§as, serÃ¡ reunida neste site.  Para fazer isso, vocÃª precisa de modelagem, ou melhor, precisa entender que, se houver vÃ¡rias rotas de sites diferentes, qual serÃ¡ escolhido como o melhor.  Para fazer isso, vocÃª deve ter uma idÃ©ia de como o BGP funciona e como as rotas circulam na situaÃ§Ã£o atual. <br><br>  Dois pontos principais sÃ£o o comprimento do caminho, influenciado pelos prefixos e a preferÃªncia local, que afirma que as rotas dos clientes sÃ£o preferÃ­veis Ã s rotas de outros lugares.  Em princÃ­pio, esses dois pontos sÃ£o suficientes para entender qual regiÃ£o serÃ¡ reunida e onde subir. <br><br>  ,     ,   â€”     ,   ,        (Â« Â»)        Tier-1   ,       . <br><br>          ,    IPv4  IPv6  ,     . <br><img src="https://habrastorage.org/webt/5w/1o/mo/5w1omookjlxi8nlba_jya-k0p-g.png"><br>       .   : Â« ?Â»    .        â€”    IX          .   ,  ,  ,     ,   ,      ,    IX'      .       ,       IX' ,  ,         â€”      . <br><br>       â€”     ,      .  â€”  ,           ,              ,    IX'. <br><br>  ,    , , ? <br><br> (   ) <br><br> .  ,            .      -   ,     ,      ,  BGP anycast â€”   . <br><br> ,     ,        RTT   ,    . , ,         ,   , RTT ,  .  â€” . <br><br>        ,        ,       â€” . <br>  ,   â€”       Â«Â»,        . ,         ,      â€”             ,    IGP     ,  ,         .  ,    â€”    ,       ,         . <br><br>   ,   Â«Â»  ,    SDN      ,    .            .     ,   SDN-,          (CenturyLink)              . -   . NOC         . -  . <br><br>       â€”    . <br><br>  , ,  â€”            .  â€”  Â«Â»,   â€”  Â«Â» (  ).                  ,     ,     Â«Â».  ,             ,     .        ,     ,    ,  -,   ,       .       - . <br><br>       .     community,     NOC.    ,        ,  ,      -             -        - DE-CIX  .      blackhole community. <br><br>            , ,  .    ,     ,        , - ,  -           ,    .  , .      ,    â€” NOC    ,      NOC           ,     .      .   . <br><img src="https://habrastorage.org/webt/y9/tl/j7/y9tlj7bpbxs6ftkb8bq-d4vnvww.png"><br>   NOC'. Network Operations Center â€”   ,    ,    ,      .    ,   .    ?  -           .   .        . <br><img src="https://habrastorage.org/webt/kc/6y/vq/kc6yvqtrzauok7myxr58bvlyces.png"><br>      ,  Â« - Â»      ,       .    ,   â€”    , .        NOC'  ,       .   ,     ,    â€”    RIPE Atlas   .  ,   .    ,      . <br><br>         community             ,   .     : ,   . ,         ,        .   ,     ,  -   community,   .   ,    -  â€” community .      community,      . , , .    community   ,     .  O que isso significa?             latency      â€”     .      - ,      ,    . <br><br>      â€”   10   ,     ,  Ansible, Chef, Puppet,      .   ?     BGP      : Â«      BGP-,           Â».           . <br><br>     ,      ,      ,        .         â€” -         .        ,    .  ,   ,     â€”   ,     : Â«  -!Â»    â€”   ,      (   ) â€”    .       ,    ,        .  â€”      . <br><br>  , . <br><img src="https://habrastorage.org/webt/_d/0b/v6/_d0bv6jjg1dic2gjmj9rdbp-azw.png"><br> (  ) <br><br>       .   anycast'   ,      , , . <br><img src="https://habrastorage.org/webt/_n/ve/jn/_nvejncgp1tspvfwgu8nvozas8e.png"><br>  ,   .  ,       â€”    ,        .    ,        ,      ,    .   RTT   . <br><br>   ,        ,          â€”   .     ,   anycast ,       â€”    . <br><br>              -  â€”  -  ,      ,       .      .         anycast       ,           â€”   -   ,      . <br><br> ,     - ,                   ,   ,    . -   ,  - - ,  , ,  â€”       . <br><img src="https://habrastorage.org/webt/ec/lq/mf/eclqmf8bbilulb74g7y9cmrhajs.png"><br>     ,      â€”     .         â€”      ,  â€”   . ,      ,   BGP   .  , -   ,  ,    . <br><br>      ,          .     â€”     ,  DNS â€”   .   SDN'        -  ,   ,     ,    . <br><img src="https://habrastorage.org/webt/sc/nf/2g/scnf2gqwejhemq6z5xfdolrn1ki.png"><br>   â€”  DNS.   Dyn   â€”   ,  2016      ,                . DNS   ,        . DNS- , ,      IETF   ,      ,      DNS-. <br><br>   ,    DNS.   ,     ,      .        RTT,     ,     DNS-    ,           , -    .        â€”     DNS. <br><br>   anycast     DNS    ,          DNS-    . <br><img src="https://habrastorage.org/webt/cs/gk/dd/csgkddm43z94n7u_mbvf-cvqamu.png"><br>     ? , latency, , . <br>    ,   .   -      .    ,     . <br><br>      .      ,      .    -  â€”  ,        . <br><br>  90% .    10% â€”      .       .  Â«Â»    ?    ,         ,         . ,     ,    . <br><img src="https://habrastorage.org/webt/x9/ii/bx/x9iibxwaeelggpxuhoteepdhxhy.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portanto, Ã© melhor delegar do que comprar seu prÃ³prio hardware. </font><font style="vertical-align: inherit;">Mesmo parte da funcionalidade que descrevemos hoje na estrutura do anycast e os problemas que surgem sÃ£o fÃ¡ceis de resolver incorretamente. </font><font style="vertical-align: inherit;">Portanto, se houver uma oportunidade de nÃ£o resolver esses problemas e transferi-los para pessoas de fora, isso provavelmente vale a pena. </font><font style="vertical-align: inherit;">Caso contrÃ¡rio, vocÃª precisarÃ¡ responder com precisÃ£o Ã  pergunta de por que precisa implementar tudo isso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bem, no caso de um ataque, recorra Ã s nuvens especializadas em resolver esses problemas. </font><font style="vertical-align: inherit;">Bem, ou vocÃª ainda pode conversar conosco.</font></font><br><br>  Obrigada<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perguntas? </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/htUvHjaNwvA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt457446/">https://habr.com/ru/post/pt457446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt457436/index.html">Golang Meetup Vol. 4 - 27 de junho, NÃ­jni Novgorod</a></li>
<li><a href="../pt457438/index.html">FaÃ§a o download do Ã¡udio do VKontakte atravÃ©s do cliente js ou da extensÃ£o de arquivo .m3u8</a></li>
<li><a href="../pt457440/index.html">ServiceLoader: uma estrutura DI integrada da qual vocÃª talvez nunca tenha ouvido falar</a></li>
<li><a href="../pt457442/index.html">Projeto Salmon: Como resistir efetivamente Ã  censura na Internet com proxies com nÃ­veis de confianÃ§a do usuÃ¡rio</a></li>
<li><a href="../pt457444/index.html">Ã“culos de AR em aÃ§Ã£o. Casos reais de como a realidade aumentada encontrou aplicaÃ§Ã£o em uma ampla variedade de Ã¡reas de negÃ³cios</a></li>
<li><a href="../pt457450/index.html">As 10 principais tendÃªncias tecnolÃ³gicas em processamento e anÃ¡lise de dados em 2019, de acordo com o Gartner</a></li>
<li><a href="../pt457458/index.html">Suporte mÃ³vel para mÃ¡quinas-ferramentas chinesas. Ou como colocÃ¡-los em um apartamento</a></li>
<li><a href="../pt457460/index.html">Placa de SeguranÃ§a do Kernel Linux</a></li>
<li><a href="../pt457462/index.html">Uber: visÃ£o geral dos principais algoritmos de gerenciamento de plataforma</a></li>
<li><a href="../pt457464/index.html">DesduplicaÃ§Ã£o de anÃºncios no Yandex.Real Estate</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>