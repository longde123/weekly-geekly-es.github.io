<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìù ü§öüèΩ üôåüèª Voc√™ sempre precisa de Docker, microsservi√ßos e programa√ß√£o reativa? ‚≠êÔ∏è ü•ã üõÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Postado por Denis Tsyplakov , arquiteto de solu√ß√µes, DataArt 

 No DataArt, trabalho de duas maneiras. No primeiro, ajudo as pessoas a reparar sistema...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Voc√™ sempre precisa de Docker, microsservi√ßos e programa√ß√£o reativa?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataart/blog/436346/"><img src="https://habrastorage.org/webt/1i/fo/8q/1ifo8qsvpiw12dn-kv78tby-gue.jpeg"><br><br>  <i>Postado por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Denis Tsyplakov</a> , arquiteto de solu√ß√µes, DataArt</i> <br><br>  No DataArt, trabalho de duas maneiras.  No primeiro, ajudo as pessoas a reparar sistemas que est√£o danificados de uma maneira ou de outra e por v√°rias raz√µes.  No segundo, ajudo a projetar novos sistemas para que n√£o sejam quebrados no futuro ou, mais realista, quebr√°-los era mais dif√≠cil. <br><br>  Se voc√™ n√£o est√° fazendo algo fundamentalmente novo, por exemplo, o primeiro mecanismo de busca na Internet ou intelig√™ncia artificial do mundo a controlar o lan√ßamento de m√≠sseis nucleares, criar um bom design de sistema √© bastante simples.  Basta levar em considera√ß√£o todos os requisitos, analisar o design de sistemas similares e fazer o mesmo, sem cometer erros graves.  Parece uma simplifica√ß√£o excessiva do problema, mas lembremos que no quintal √© o ano de 2019, e existem ‚Äúreceitas padr√£o‚Äù para o design do sistema para quase tudo.  Uma empresa pode executar tarefas t√©cnicas complexas - digamos, processar um milh√£o de arquivos PDF heterog√™neos e remover tabelas de despesas deles - mas a arquitetura do sistema raramente √© muito original.  O principal aqui n√£o √© cometer um erro ao determinar qual sistema estamos construindo e n√£o perder a escolha das tecnologias. <br><br>  Erros t√≠picos ocorrem regularmente no √∫ltimo par√°grafo, alguns dos quais discutirei em um artigo. <a name="habracut"></a><br><br>  Qual √© a dificuldade de escolher uma pilha t√©cnica?  A adi√ß√£o de qualquer tecnologia ao projeto torna mais dif√≠cil e traz algum tipo de limita√ß√£o.  Consequentemente, a adi√ß√£o de uma nova ferramenta (estrutura, biblioteca) s√≥ deve ser feita quando essa ferramenta √© mais √∫til do que prejudicial.  Nas conversas com os membros da equipe sobre como adicionar bibliotecas e estruturas, eu frequentemente uso o seguinte truque: ‚ÄúSe voc√™ deseja adicionar uma nova depend√™ncia ao projeto, coloca uma caixa de cerveja para a equipe.  Se voc√™ acha que essa depend√™ncia de uma caixa de cerveja n√£o vale a pena, n√£o a adicione. ‚Äù <br><br>  Suponha que criemos um determinado aplicativo, digamos, em Java e adicionemos a biblioteca TimeMagus ao projeto para manipular datas (um exemplo √© fict√≠cio).  A biblioteca √© excelente, fornece muitos recursos que n√£o est√£o dispon√≠veis na biblioteca de classes padr√£o.  Como essa decis√£o pode ser prejudicial?  Vejamos os cen√°rios poss√≠veis: <br><br><ol><li>  Nem todos os desenvolvedores conhecem uma biblioteca n√£o padr√£o, o limite de entrada para novos desenvolvedores ser√° maior.  Aumenta a chance de um novo desenvolvedor cometer um erro ao manipular uma data usando uma biblioteca desconhecida. </li><li> O tamanho da distribui√ß√£o est√° aumentando.  Quando o tamanho m√©dio do aplicativo no Spring Boot pode facilmente chegar a 100 MB, isso n√£o √© de forma alguma um pouco.  Vi casos em que, por um √∫nico m√©todo, uma biblioteca de 30 MB foi inserida no kit de distribui√ß√£o.  Eles justificaram da seguinte maneira: "Eu usei essa biblioteca em um projeto anterior e existe um m√©todo conveniente l√°". </li><li>  Dependendo da biblioteca, a hora de in√≠cio pode aumentar significativamente. </li><li>  O desenvolvedor da biblioteca pode abandonar sua ideia, ent√£o a biblioteca come√ßar√° a entrar em conflito com a nova vers√£o do Java, ou um bug ser√° detectado nela (causado por, por exemplo, mudan√ßas de fuso hor√°rio) e nenhum patch ser√° lan√ßado. </li><li>  A licen√ßa da biblioteca em algum momento entrar√° em conflito com a licen√ßa do seu produto (voc√™ verifica as licen√ßas de todos os produtos que usa?). </li><li>  Jar hell - a biblioteca TimeMagus precisa da vers√£o mais recente da biblioteca SuperCollections, depois de alguns meses voc√™ precisa conectar a biblioteca para integra√ß√£o com uma API de terceiros, que n√£o funciona com a vers√£o mais recente do SuperCollections e funciona apenas com a vers√£o 2.x.  Voc√™ n√£o pode conectar uma API. N√£o h√° outra biblioteca para trabalhar com esta API. </li></ol><br>  Por outro lado, a biblioteca padr√£o fornece ferramentas convenientes para manipular datas, e se voc√™ n√£o precisar manter, por exemplo, um calend√°rio ex√≥tico ou calcular o n√∫mero de dias entre hoje e "o segundo dia da terceira lua nova no ano anterior da √°guia", pode valer a pena abster-se de usar uma biblioteca de terceiros.  Mesmo que seja completamente maravilhoso e em uma escala de projeto, voc√™ economizar√° at√© 50 linhas de c√≥digo. <br><br>  O exemplo considerado √© bastante simples e acho f√°cil tomar uma decis√£o.  Mas h√° v√°rias tecnologias difundidas pelos ouvidos de todos, e seu uso √© √≥bvio, o que dificulta a escolha - elas realmente oferecem s√©rias vantagens ao desenvolvedor.  Mas isso nem sempre precisa ser uma ocasi√£o para arrast√°-los para o seu projeto.  Vamos olhar para alguns deles. <br><br><h2>  Docker </h2><br>  Antes do surgimento dessa tecnologia realmente interessante, ao implantar sistemas, havia muitos problemas desagrad√°veis ‚Äã‚Äãe complexos relacionados ao conflito de vers√£o e depend√™ncias obscuras.  O Docker permite compactar um instant√¢neo do status do sistema, coloc√°-lo em produ√ß√£o e execut√°-lo l√°.  Isso permite que os conflitos mencionados sejam evitados, o que, √© claro, √© √≥timo. <br><br>  Anteriormente, isso era feito de uma maneira monstruosa e algumas tarefas n√£o eram resolvidas.  Por exemplo, voc√™ tem um aplicativo PHP que usa a biblioteca ImageMagick para trabalhar com imagens, seu aplicativo tamb√©m precisa de configura√ß√µes espec√≠ficas do php.ini e o pr√≥prio aplicativo √© hospedado usando o Apache httpd.  Mas h√° um problema: algumas rotinas regulares s√£o implementadas executando scripts Python a partir do cron, e a biblioteca usada por esses scripts entra em conflito com as vers√µes da biblioteca usadas no seu aplicativo.  O Docker permite que voc√™ empacote seu aplicativo inteiro, juntamente com configura√ß√µes, bibliotecas e um servidor HTTP, em um cont√™iner que atende solicita√ß√µes na porta 80 e rotinas em outro cont√™iner.  Todos juntos funcionar√£o perfeitamente, e voc√™ pode esquecer o conflito de bibliotecas. <br><br>  Devo usar o Docker para compactar cada aplicativo?  Minha opini√£o: n√£o, n√£o vale a pena.  A imagem mostra uma composi√ß√£o t√≠pica de um aplicativo dockerizado implantado na AWS.  Os ret√¢ngulos aqui indicam as camadas de isolamento que temos. <br><br><img src="https://habrastorage.org/webt/wg/l9/0_/wgl90_ho4o9feo2r7o7ktzhiy4a.png"><br><br>  O maior ret√¢ngulo √© a m√°quina f√≠sica.  Em seguida √© o sistema operacional da m√°quina f√≠sica.  Ent√£o - o virtualizador da Amaz√¥nia, o SO da m√°quina virtual, o cont√™iner do docker, seguido pelo SO do cont√™iner, JVM, o cont√™iner do Servlet (se for um aplicativo da web) e o c√≥digo do aplicativo j√° est√° nele.  Ou seja, j√° vemos algumas camadas de isolamento. <br><br>  A situa√ß√£o ficar√° ainda pior se olharmos para a sigla JVM.  A JVM √©, curiosamente, a Java Virtual Machine, ou seja, sempre temos pelo menos uma m√°quina virtual em Java.  Adicionar aqui um cont√™iner Docker adicional, em primeiro lugar, geralmente n√£o oferece uma vantagem t√£o percept√≠vel, porque a pr√≥pria JVM j√° nos isola muito bem do ambiente externo e, em segundo lugar, n√£o √© sem custo. <br><br>  Peguei n√∫meros de um estudo da IBM, se n√£o me engano, h√° dois anos.  Resumidamente, se estamos falando sobre opera√ß√µes de disco, uso do processador ou acesso √† mem√≥ria, o Docker quase n√£o adiciona uma sobrecarga (literalmente uma fra√ß√£o de um por cento), mas se estamos falando sobre a lat√™ncia da rede, os atrasos s√£o bastante vis√≠veis.  Eles n√£o s√£o gigantescos, mas, dependendo do aplicativo que voc√™ possui, podem surpreend√™-lo desagrad√°vel. <br><br><img src="https://habrastorage.org/webt/pb/om/j-/pbomj-5curelulxpmomito3jy7a.png"><br><br>  Al√©m disso, o Docker ocupa mais espa√ßo em disco, ocupa parte da mem√≥ria e aumenta o tempo de inicializa√ß√£o.  Todos os tr√™s pontos n√£o s√£o cr√≠ticos para a maioria dos sistemas - geralmente h√° muito espa√ßo em disco e mem√≥ria.  O tempo de inicializa√ß√£o, como regra, tamb√©m n√£o √© um problema cr√≠tico, o principal √© que o aplicativo seja iniciado.  Mas ainda existem situa√ß√µes em que a mem√≥ria pode acabar, e o tempo total de in√≠cio do sistema, composto por vinte servi√ßos dependentes, j√° √© bastante grande.  Al√©m disso, isso afeta o custo de hospedagem.  E se voc√™ estiver envolvido em alguma negocia√ß√£o de alta frequ√™ncia, o Docker categoricamente n√£o combina com voc√™.  Em geral, √© melhor n√£o encaixar qualquer aplicativo sens√≠vel a atrasos na rede de at√© 250 a 500 ms. <br><br>  Al√©m disso, com a janela de encaixe, a an√°lise de problemas nos protocolos de rede √© notavelmente complicada, n√£o apenas os atrasos aumentam, mas todos os tempos se tornam diferentes. <br><br><h3>  Quando o Docker √© realmente necess√°rio? </h3><br>  Quando temos vers√µes diferentes do JRE, e seria bom arrastar o JRE.  H√° momentos em que voc√™ precisa executar uma certa vers√£o do Java (n√£o "o Java 8 mais recente", mas algo mais espec√≠fico).  Nesse caso, √© bom compactar o JRE com o aplicativo e executar como um cont√™iner.  Em princ√≠pio, √© claro que vers√µes diferentes de Java podem ser colocadas no sistema de destino devido a JAVA_HOME etc. Mas, neste sentido, o Docker √© muito mais conveniente, porque voc√™ conhece a vers√£o exata do JRE, tudo √© empacotado e, com outro JRE, o aplicativo nem inicia por acidente. . <br><br>  O Docker tamb√©m √© necess√°rio se voc√™ tiver depend√™ncias em algumas bibliotecas bin√°rias, por exemplo, para processamento de imagem.  Nesse caso, pode ser uma boa ideia compactar todas as bibliotecas necess√°rias com o pr√≥prio aplicativo Java. <br><br>  O caso a seguir se refere a um sistema que √© um composto complexo de v√°rios servi√ßos escritos em v√°rios idiomas.  Voc√™ tem uma parte do Node.js, uma parte do Java, uma biblioteca do Go e, al√©m disso, algum tipo de Machine Learning no Python.  Todo esse zool√≥gico deve ser cuidadoso e cuidadosamente ajustado para ensinar seus elementos a se verem.  Depend√™ncias, caminhos, endere√ßos IP - tudo isso deve ser pintado e cuidadosamente aumentado na produ√ß√£o.  Obviamente, nesse caso, o Docker o ajudar√° muito.  Al√©m disso, faz√™-lo sem a ajuda dele √© simplesmente doloroso. <br><br>  O Docker pode oferecer alguma comodidade quando voc√™ precisar especificar muitos par√¢metros diferentes na linha de comandos para iniciar o aplicativo.  Por outro lado, os scripts do bash fazem isso muito bem, geralmente a partir de uma √∫nica linha.  Decida qual usar melhor. <br><br>  A √∫ltima coisa que vem √† mente de uma vez √© a situa√ß√£o em que voc√™ usa, digamos, o Kubernetes, e precisa orquestrar o sistema, ou seja, aumentar um certo n√∫mero de microsservi√ßos diferentes que escalam automaticamente de acordo com certas regras. <br><br>  Em todos os outros casos, o Spring Boot √© suficiente para compactar tudo em um √∫nico arquivo jar.  E, em princ√≠pio, o jarro de mola √© uma boa met√°fora para o cont√™iner do Docker.  Obviamente, isso n√£o √© a mesma coisa, mas em termos de facilidade de implanta√ß√£o, eles s√£o realmente semelhantes. <br><br><h2>  Kubernetes </h2><br>  E se usarmos o Kubernetes?  Para come√ßar, essa tecnologia permite implantar um grande n√∫mero de microsservi√ßos em diferentes m√°quinas, gerenci√°-las, fazer escalonamento autom√°tico etc. No entanto, existem muitos aplicativos que permitem gerenciar a orquestra√ß√£o, por exemplo, Puppet, mecanismo CF, SaltStack e outros.  O Kubernetes em si √© certamente bom, mas pode adicionar uma sobrecarga significativa, com a qual nem todo projeto est√° pronto para viver. <br><br>  Minha ferramenta favorita √© Ansible, combinada com Terraform onde voc√™ precisar.  Ansible √© uma ferramenta leve declarativa bastante simples.  Ele n√£o requer a instala√ß√£o de agentes especiais e possui a sintaxe compreens√≠vel dos arquivos de configura√ß√£o.  Se voc√™ estiver familiarizado com a composi√ß√£o do Docker, ver√° imediatamente as se√ß√µes sobrepostas.  E se voc√™ usa o Ansible, n√£o h√° necessidade de pr√©-rezerez - voc√™ pode implantar sistemas usando meios mais cl√°ssicos. <br><br>  √â claro que, mesmo assim, essas s√£o tecnologias diferentes, mas h√° um conjunto de tarefas nas quais elas s√£o intercambi√°veis.  E uma abordagem consciente do design requer uma an√°lise de qual tecnologia √© mais adequada para o sistema que est√° sendo desenvolvido.  E como ser√° melhor combinar isso daqui a alguns anos. <br><br>  Se o n√∫mero de servi√ßos diferentes em seu sistema for pequeno e a configura√ß√£o deles for relativamente simples, por exemplo, voc√™ ter√° apenas um arquivo jar e n√£o ver√° um crescimento repentino e explosivo na complexidade, provavelmente poder√° se dar bem com mecanismos de implanta√ß√£o cl√°ssicos. <br><br>  Isso levanta a quest√£o: "espere, como est√° um arquivo jar?".  O sistema deve consistir no maior n√∫mero poss√≠vel de microsservi√ßos at√¥micos!  Vamos ver quem e o que o sistema deve com microsservi√ßos. <br><br><h2>  Microsservi√ßos </h2><br>  Antes de tudo, os microsservi√ßos permitem obter maior flexibilidade e escalabilidade, al√©m de permitir vers√µes flex√≠veis de partes individuais do sistema.  Suponha que tenhamos algum tipo de aplicativo que esteja em produ√ß√£o h√° muitos anos.  A funcionalidade est√° crescendo, mas n√£o podemos desenvolv√™-la infinitamente de uma maneira extensa.  Por exemplo. <br><br>  Temos um aplicativo no Spring Boot 1 e Java 8. Uma combina√ß√£o maravilhosa e est√°vel.  Mas o ano √© 2019 e, gostemos ou n√£o, precisamos avan√ßar para o Spring Boot 2 e Java 12. Mesmo a transi√ß√£o relativamente simples de um sistema grande para a nova vers√£o do Spring Boot pode ser muito trabalhosa, mas √© preciso pular o abismo do Java 8 para o Java 12 eu n√£o quero conversar.  Ou seja, em teoria tudo √© simples: migramos, corrigimos os problemas que surgiram, testamos tudo e executamos na produ√ß√£o.  Na pr√°tica, isso pode significar v√°rios meses de trabalho que n√£o trazem novas funcionalidades aos neg√≥cios.  Uma pequena mudan√ßa para o Java 12, como voc√™ sabe, tamb√©m n√£o funciona.  Aqui a arquitetura de microsservi√ßo pode nos ajudar. <br><br>  Podemos alocar um grupo compacto de fun√ß√µes de nosso aplicativo em um servi√ßo separado, migrar esse grupo de fun√ß√µes para uma nova pilha t√©cnica e coloc√°-lo em produ√ß√£o em um tempo relativamente curto.  Repita o processo, pe√ßa por pe√ßa, at√© que as tecnologias antigas estejam completamente esgotadas. <br><br>  Al√©m disso, os microsservi√ßos podem fornecer isolamento de falhas quando um componente ca√≠do n√£o arruina todo o sistema. <br><br>  Os microsservi√ßos nos permitem ter uma pilha t√©cnica flex√≠vel, ou seja, n√£o escrever tudo monoliticamente em um idioma e uma vers√£o e, se necess√°rio, usar uma pilha t√©cnica diferente para componentes individuais.  Obviamente, √© melhor usar uma pilha t√©cnica uniforme, mas isso nem sempre √© poss√≠vel e, nesse caso, os microsservi√ßos podem ajudar. <br><br>  Os microsservi√ßos tamb√©m permitem uma maneira t√©cnica de resolver v√°rios problemas gerenciais.  Por exemplo, quando sua grande equipe consiste em grupos separados, trabalhando em empresas diferentes (sentados em fusos hor√°rios diferentes e falando idiomas diferentes).  Os microsservi√ßos ajudam a isolar essa diversidade organizacional por componentes que ser√£o desenvolvidos separadamente.  Os problemas de uma parte da equipe permanecer√£o dentro de um servi√ßo e n√£o se espalhar√£o por todo o aplicativo. <br><br>  Mas os microsservi√ßos n√£o s√£o a √∫nica maneira de resolver esses problemas.  Curiosamente, h√° algumas d√©cadas, para metade deles, as pessoas criaram classes e, um pouco mais tarde - componentes e o padr√£o de Invers√£o do controle. <br><br>  Se olharmos para o Spring, veremos que, de fato, √© uma arquitetura de microsservi√ßo dentro de um processo Java.  Podemos declarar um componente que, em ess√™ncia, √© um servi√ßo.  Temos a capacidade de fazer uma pesquisa atrav√©s do @Autowired, existem ferramentas para gerenciar o ciclo de vida dos componentes e a capacidade de configurar componentes separadamente a partir de uma d√∫zia de fontes diferentes.  Em princ√≠pio, obtemos quase tudo o que temos com microsservi√ßos - apenas dentro de um processo, o que reduz significativamente os custos.  Uma classe Java regular √© o mesmo contrato de API que tamb√©m permite isolar detalhes de implementa√ß√£o. <br><br>  Estritamente falando, no mundo Java, os microsservi√ßos s√£o mais parecidos com o OSGi - l√° temos uma c√≥pia quase exata de tudo o que existe nos microsservi√ßos, exceto, al√©m da possibilidade de usar diferentes linguagens de programa√ß√£o e execu√ß√£o de c√≥digo em diferentes servidores.  Mas, mesmo mantendo os recursos das classes Java, temos uma ferramenta bastante poderosa para resolver um grande n√∫mero de problemas de isolamento. <br><br>  Mesmo em um cen√°rio "gerencial" com isolamento de equipe, podemos criar um reposit√≥rio separado que cont√©m um m√≥dulo Java separado com um contrato externo claro e um conjunto de testes.  Isso reduzir√° significativamente a capacidade de uma equipe de complicar inadvertidamente a vida de outra equipe. <br><br><img src="https://habrastorage.org/webt/fq/kn/v8/fqknv8g8bzypbpunprhjeeru_is.png"><br><br>  Ouvi repetidamente que √© imposs√≠vel isolar detalhes de implementa√ß√£o sem microsservi√ßos.  Mas posso responder que toda a ind√∫stria de software est√° apenas isolando a implementa√ß√£o.  Para isso, a sub-rotina foi inventada (nos anos 50 do s√©culo passado), depois fun√ß√µes, procedimentos, classes e microsservi√ßos posteriores.  Mas o fato de os microsservi√ßos desta s√©rie aparecerem por √∫ltimo n√£o os torna o ponto mais alto de desenvolvimento e n√£o nos obriga a sempre recorrer √† ajuda deles. <br><br>  Ao usar microsservi√ßos, tamb√©m √© necess√°rio levar em considera√ß√£o que as chamadas entre eles levam algum tempo.  Isso geralmente n√£o √© importante, mas vi um caso em que o cliente precisava ajustar o tempo de resposta do sistema de 3 segundos.  Era uma obriga√ß√£o contratual conectar-se a um sistema de terceiros.  A cadeia de chamadas passou por v√°rias dezenas de microsservi√ßos at√¥micos e a sobrecarga de fazer chamadas HTTP n√£o tornou poss√≠vel diminuir em tr√™s segundos.  Em geral, voc√™ precisa entender que qualquer divis√£o do c√≥digo monol√≠tico em v√°rios servi√ßos afeta inevitavelmente o desempenho geral do sistema.  S√≥ porque os dados n√£o podem ser teleportados entre processos e servidores "de gra√ßa". <br><br><h3>  Quando s√£o necess√°rios os microsservi√ßos? </h3><br>  Em que casos um aplicativo monol√≠tico realmente precisa ser dividido em v√°rios microsservi√ßos?  Primeiro, quando h√° um uso desequilibrado de recursos em √°reas funcionais. <br><br>  Por exemplo, temos um grupo de chamadas de API que executam c√°lculos que exigem muito tempo do processador.  E h√° um grupo de chamadas de API que s√£o executadas muito rapidamente, mas exigem que uma estrutura de dados de 64 GB seja armazenada na mem√≥ria.  Para o primeiro grupo, precisamos de um grupo de m√°quinas com um total de 32 processadores, pois a segunda m√°quina √© suficiente (OK, que haja duas m√°quinas para toler√¢ncia a falhas) com 64 GB de mem√≥ria.  Se tivermos um aplicativo monol√≠tico, precisaremos de 64 GB de mem√≥ria em cada m√°quina, o que aumenta o custo de cada m√°quina.  Se essas fun√ß√µes forem divididas em dois servi√ßos separados, podemos economizar recursos otimizando o servidor para uma fun√ß√£o espec√≠fica.  A configura√ß√£o do servidor pode ser assim: <br><br><img src="https://habrastorage.org/webt/q3/2s/yo/q32syo6fpc3c3avb_wphdtwupp8.png"><br><br>  S√£o necess√°rios microsservi√ßos e, se precisarmos escalar seriamente alguma √°rea funcional estreita.  Por exemplo, cem m√©todos de API s√£o chamados 10 vezes por segundo e, digamos, quatro m√©todos de API s√£o chamados 10 mil vezes por segundo.  A amplia√ß√£o de todo o sistema geralmente n√£o √© necess√°ria, ou seja, √© claro que podemos multiplicar todos os 100 m√©todos em muitos servidores, mas isso, via de regra, √© visivelmente mais caro e mais complicado do que a amplia√ß√£o de um grupo restrito de m√©todos.  Podemos separar essas quatro chamadas em um servi√ßo separado e escal√°-lo apenas para um grande n√∫mero de servidores. <br><br>  Tamb√©m est√° claro que podemos precisar de um microsservi√ßo se tivermos escrito uma √°rea funcional separada, por exemplo, em Python.  Como algumas bibliotecas (por exemplo, para aprendizado de m√°quina) estavam dispon√≠veis apenas no Python, e queremos separ√°-las em um servi√ßo separado.  Tamb√©m faz sentido fazer um microsservi√ßo se alguma parte do sistema estiver propensa a falhas.  √â bom, √© claro, escrever c√≥digo para que n√£o haja falhas em princ√≠pio, mas os motivos podem ser externos.  E ningu√©m est√° a salvo de seus pr√≥prios erros.  Nesse caso, o bug pode ser isolado dentro de um processo separado. <br><br>  Se o seu aplicativo n√£o possui nenhuma das op√ß√µes acima e n√£o √© esperado em um futuro pr√≥ximo, provavelmente, um aplicativo monol√≠tico ser√° o mais adequado para voc√™.  A √∫nica coisa - eu recomendo escrever para que as √°reas funcionais que n√£o est√£o relacionadas uma √† outra n√£o dependam uma da outra no c√≥digo.  Para que, se necess√°rio, √°reas funcionais n√£o interconectadas possam ser separadas umas das outras.  No entanto, essa √© sempre uma boa recomenda√ß√£o, seguida pela qual aumenta a consist√™ncia interna e ensina a formular cuidadosamente contratos de m√≥dulos. <br><br><h2>  Arquitetura reativa e programa√ß√£o reativa </h2><br>  Uma abordagem reativa √© uma coisa relativamente nova.  O momento de seu aparecimento pode ser considerado no ano de 2014, quando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o Manifesto Reativo</a> foi publicado.  Dois anos ap√≥s a publica√ß√£o do manifesto, ele era bem conhecido por todos.  Essa √© uma abordagem verdadeiramente revolucion√°ria ao design do sistema.       ,      ,   ,     ,              . <br><br><img src="https://habrastorage.org/webt/5x/dh/zb/5xdhzbusskuvnn13ygva5cwu2wk.png"><br><br>  ,         .  ,      ,    : ¬´  ,      !?¬ª     , ,  ,            ,         ¬´¬ª.     ,   100%   ,      ,     . <br><br>      ‚Äî   ,      ‚Äî     .          . <br><br>     ?  ,     . <br><br>   - ,  - .     -  -, , HTTP-.     ,      .   ,       .     ,   ,     ,  . <br><br>          ?   ,  HTTP-            ,   ( callback)        (  )  .     ,  -   ( ,      HTTP-)   . <br><br>    ‚Äî   .            . . .      3 Ghz      ,   ,      . .    .  ,   Java-,    HTTP- ‚Äî     5-10%.  ,   , , ,    100   50 $/  ‚Äî    $500    .  ,  ,      . <br><br> ,   ?    . <br><br>        ,       .  ,        ,   ,   ,        ,       ,    .     ,   ,             .      . <br><br>     -   . , JDBC      (     . ADA, R2DBC,         ).   90 %      ,         .      ‚Äî  HTTP-    ,         .      ,          . <br><br><img src="https://habrastorage.org/webt/t-/om/uv/t-omuvjblahs0nbrkpmeomfh970.png"><br><br><h3>     ? </h3><br>  ,     , ,      (    )              .    ‚Äî         -    ,    .      ,      , ,  HTTP. <br><br>             ,       , ,        ,     , ,  . <br><br>              . ,  ¬´          ,       ¬ª       , ,     ,                 . ,        ,    ,    10  11 , ,         ,    . <br><br><h2>  Conclus√£o </h2><br>    ,         .              ,  ,        ,        . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436346/">https://habr.com/ru/post/pt436346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436334/index.html">Aprendendo conceitos atrav√©s da intera√ß√£o sens√≥rio-motora</a></li>
<li><a href="../pt436338/index.html">Como funciona o aeroporto de Vnukovo</a></li>
<li><a href="../pt436340/index.html">N√≠vel de log separado para cada solicita√ß√£o</a></li>
<li><a href="../pt436342/index.html">Uma introdu√ß√£o √† otimiza√ß√£o robusta [... e uma pequena lista de compras que eu esqueci ...]</a></li>
<li><a href="../pt436344/index.html">Fibaro Home Center 2 e termostato para aquecimento por piso radiante HeatIt. Como aumentar a temperatura</a></li>
<li><a href="../pt436348/index.html">Desenvolvendo uma equipe para solicitar dados de um banco de dados - parte 2</a></li>
<li><a href="../pt436350/index.html">Aprenda t√°ticas, t√©cnicas e conhecimentos comuns do advers√°rio (ATT @ CK). T√°ticas corporativas. Parte 7</a></li>
<li><a href="../pt436352/index.html">Resumo de not√≠cias do PostgreSQL. Edi√ß√£o 14</a></li>
<li><a href="../pt436354/index.html">Militares dos EUA negligenciam quest√µes de seguran√ßa cibern√©tica</a></li>
<li><a href="../pt436356/index.html">[Interessante por tr√°s da colina] Como paramos a depend√™ncia tecnol√≥gica?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>