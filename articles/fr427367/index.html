<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî§ üìä üë∂ Conf√©rence BLACK HAT USA. Comment un pirate hollywoodien utilise des cam√©ras de surveillance. Partie 1 üöπ üìá üì§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je suis Greg Heffner, et ceci est une conversation sur la fa√ßon dont un pirate hollywoodien utilise des cam√©ras de surveillance. Certains d'entre vous...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conf√©rence BLACK HAT USA. Comment un pirate hollywoodien utilise des cam√©ras de surveillance. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/427367/"> Je suis Greg Heffner, et ceci est une conversation sur la fa√ßon dont un pirate hollywoodien utilise des cam√©ras de surveillance.  Certains d'entre vous savent peut-√™tre que lorsque mon travail sur ce sujet a √©t√© publi√© pour la premi√®re fois, un article est apparu sur le portail Internet de Reuters. <br><br><img src="https://habrastorage.org/webt/i4/rf/hx/i4rfhxxkmocn8xisdvkdrguweii.jpeg"><br><br>  Pour moi, en tant que conf√©rencier, c'√©tait vraiment g√©nial.  Mais le probl√®me √©tait que l'article a d√©cid√© de souligner que je travaillais pour une institution sp√©cifique avec un nom √† trois lettres, sur laquelle il y avait tr√®s peu de notes dans la presse r√©cemment.  Et ils sont all√©s si loin qu'ils ont pr√©tendu que j'avais pr√©sent√© √† BlackHat mon travail fait pour cette agence de trois lettres.  Cette publication a donn√© lieu √† des appels t√©l√©phoniques tr√®s int√©ressants de mon ancien employeur. <br><br>  Heureusement, nous avons des gens qui r√©pondent √† mes appels, donc en gros ils leur ont cri√© dessus, pas √† moi, mais j'ai quand m√™me d√ª rassurer les gens et, finalement, j'ai r√©ussi √† convaincre l'ancien employeur que parfois les gens sur Internet aussi ont tort. <br><br>  Par cons√©quent, pour √™tre extr√™mement clair, je vais expliquer que le discours d'aujourd'hui ne porte pas sur un travail que j'ai jamais fait pour d'anciens employeurs, mais sur ce que je fais pour mon employeur actuel.  Je travaille en tant qu'analyseur de vuln√©rabilit√©s √† plein temps pour Tactical Network Solutions, j'enseigne √©galement des cours sur les op√©rations sur les appareils int√©gr√©s et je m'efforce parfois de pirater des appareils sans fil. <br><br>  Aujourd'hui, je vais parler de la s√©curit√© des cam√©ras de surveillance, ou plut√¥t de l'absence de cette s√©curit√©.  Au d√©but du pass√©, en 2011, j'ai commenc√© √† √©tudier la question de la s√©curit√© du firmware des cam√©ras connect√©es au r√©seau de surveillance, et j'ai d√©couvert beaucoup de choses int√©ressantes. <br><br>  Je mettrai de c√¥t√© la menace ¬´z√©ro jour¬ª, j'en parlerai quand j'y arriverai, je vais d'abord vous montrer comment, √† la mani√®re d'un v√©ritable hacker hollywoodien, je peux tirer parti des vuln√©rabilit√©s que j'ai d√©couvertes. <a name="habracut"></a><br><br>  Donc, quand j'ai commenc√© √† √©tudier les cam√©ras de surveillance, et je dois dire que j'ai √©tudi√© beaucoup d'appareils int√©gr√©s, mais pas de cam√©ras, j'ai voulu commencer par quelque chose de simple, qui me garantirait s√ªrement une victoire.  J'ai choisi D-Link car ils ne d√©√ßoivent jamais. <br><br><img src="https://habrastorage.org/webt/q7/3e/mg/q73emg7hxxrcxw-54gyva8_x7lm.jpeg"><br><br>  J'ai opt√© pour la DCS-7410, au prix d'environ 900 $, c'est l'une des cam√©ras de surveillance D-Link ext√©rieures les plus ch√®res fonctionnant en mode jour et nuit.  Comme les autres cam√©ras, dont nous parlerons aujourd'hui, elle poss√®de une interface administrative et prend en charge l'acc√®s au flux vid√©o via Internet √† un serveur Web, et est √©galement aliment√©e via un r√©seau (PoE).  Cela en fait une cible tr√®s attrayante pour un attaquant. <br><br>  Plus pr√©cis√©ment, cette cam√©ra utilise Lighttpd II, un serveur Web open source qui n'est pas souvent utilis√© avec des appareils int√©gr√©s.  Les d√©veloppeurs ont cr√©√© une configuration saine et des r√®gles restreignant l'acc√®s √† ce qui peut √™tre atteint via le serveur Web. <br><br>  Sur la diapositive suivante, vous voyez que si vous voulez obtenir quelque chose dans le r√©pertoire administratif cgi / admin, vous devez avoir des droits d'administrateur.  Si vous voulez obtenir quelque chose dans le r√©pertoire vid√©o, vous pouvez √™tre n'importe quel utilisateur, mais vous devez √™tre autoris√©.  Ils ont des entr√©es et des r√®gles de connexion pour chaque r√©pertoire individuel de l'interface Web, √† l'exception du r√©pertoire cgi-bin. <br><br><img src="https://habrastorage.org/webt/0s/9n/_m/0s9n_mc6kkwgmih0nvfh9wm6kau.jpeg"><br><br><img src="https://habrastorage.org/webt/kp/tn/3u/kptn3ugjtfshhp-mg_hxwl6kerk.jpeg"><br><br>  La plupart des scripts cgi de la cam√©ra se trouvent dans le r√©pertoire prot√©g√© cgi.  Un r√©pertoire cgi-bin non s√©curis√© contient un seul fichier, rtpd.cgi, qui est un script shell bash utilis√© pour d√©marrer et arr√™ter le protocole de transport de cam√©ra RTP en temps r√©el. <br><br><img src="https://habrastorage.org/webt/zz/by/o_/zzbyo_ebtddfagw6jpwuqilckky.jpeg"><br><br>  Cependant, le script rtpd.cgi a un s√©rieux d√©faut.  Il analyse les param√®tres de la requ√™te en rempla√ßant toutes les esperluettes et dans la cha√Æne $ QUERY_STRING par des espaces, puis obtient le r√©sultat √† l'aide de la fonction eval: <br><br><img src="https://habrastorage.org/webt/ck/ev/ox/ckevoxngnwan-_0hf6yyiyysab0.jpeg"><br><br>  Donc, si vous voulez simplement arr√™ter la cam√©ra, envoyez simplement une demande: rtpd.cgi? Action = stop.  Lorsqu'elle est utilis√©e comme pr√©vu, la requ√™te HTTP suivante changera le nom? Action, dont la valeur sera d√©finie sur la position "start": <br><br><pre><code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?action=start</code> </pre> <br>  Mais comme les donn√©es de $ query_string sont ex√©cut√©es √† l'aveugle par la m√©thode eval, un attaquant peut ex√©cuter n'importe quelle commande simplement en la sp√©cifiant dans le cadre des param√®tres http GET: <br><br><pre> <code class="hljs ruby">$ wget <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/cgi</span></span>-bin/rtpd.cgi?reboot</code> </pre> <br>  Ainsi, le pirate pourra red√©marrer la cam√©ra.  Il √©tait en fait difficile pour moi de cat√©goriser cette vuln√©rabilit√©, car il ne s'agit m√™me pas d'une injection de commandes, nous n'entrons rien, mais permettons simplement au programme d'√™tre ex√©cut√© avec d'autres param√®tres.  J'ai appel√© cette vuln√©rabilit√© ¬´Ron Burgundy¬ª, car elle fera litt√©ralement tout ce que vous entrez dans la cha√Æne de requ√™te. <br><br><img src="https://habrastorage.org/webt/ef/5_/yl/ef5_ylb-0jr20nngw8uqftcnjbo.jpeg"><br><br>  Un attaquant pourrait utiliser cette vuln√©rabilit√© pour obtenir un mot de passe d'administrateur de cam√©ra normal aupr√®s de NVRAM.  La commande suivante est ex√©cut√©e par le script de d√©marrage de la cam√©ra apr√®s le red√©marrage et envoie √† votre navigateur une r√©ponse de ce type: <br><br><img src="https://habrastorage.org/webt/wx/48/og/wx48ogrv2omgwfklhlt9ytd-9lu.jpeg"><br><br>  Maintenant, vous avez non seulement un acc√®s root, car apr√®s avoir re√ßu le mot de passe, vous devenez √©galement administrateur, vous pouvez donc tout faire avec l'appareil photo et les vid√©os. <br><br>  Il s'av√®re que D-link, comme de nombreux fabricants, aime vraiment r√©utiliser le code en installant le m√™me firmware, et c'est le cas dans beaucoup de leurs produits.  Mais cela n'affecte pas seulement les produits D-link, car une pratique similaire est utilis√©e par Trendnet et certains autres fabricants "sans marque" de ces appareils.  La r√©utilisation du code est d√©sormais r√©pandue, tant chez les fabricants d'une m√™me marque qu'entre diff√©rentes marques.  Cette vuln√©rabilit√© est contenue dans le micrologiciel de nombreux mod√®les de cam√©ras qui sont index√©s sur la ressource de collections de vuln√©rabilit√©s informatiques Shodan Dork. <br><br><img src="https://habrastorage.org/webt/yq/hr/x3/yqhrx3jj2aexfxgsfde9ggqsity.jpeg"><br><br>  Cette vuln√©rabilit√© peut sembler famili√®re √† certaines personnes, et c'est probablement parce qu'apr√®s mon discours √† ce sujet, Core Security a d√©fini l'indice de vuln√©rabilit√© CVE-2013-1599 pour ces produits, indiquant qu'il n'est pr√©sent que dans les appareils D-link, sans mentionner aucun d'un autre fabricant utilisant le m√™me firmware dans leurs appareils.  M√™me si l'un des fabricants corrige cette erreur dans la nouvelle version du firmware, la plupart des appareils resteront vuln√©rables pendant encore 3 ans, car g√©n√©ralement personne ne met √† jour le firmware √† temps, et certains ne savent pas ce que c'est.  Comme je l'ai dit, les produits D-link sont l'une des cibles d'attaque les plus abordables, alors regardons les cam√©ras de fabricants plus r√©put√©s, tels que Cisco avec le mod√®le PVC 2300. Il s'agit d'une cam√©ra IP de classe affaires de milieu de gamme d'une valeur de 500 $. <br><br><img src="https://habrastorage.org/webt/an/xc/gb/anxcgbta5vml8jvdwwrjkcj1bki.jpeg"><br><br>  Il dispose actuellement d'un serveur Web et fournit une authentification √† l'aide d'un fichier de mots de passe au format HTTP. <br><br><img src="https://habrastorage.org/webt/yo/oj/w4/yoojw4gf_hxahsfnot12iafr8yw.jpeg"><br><br>  La plupart des gens connaissent ce syst√®me - vous installez votre fichier de mot de passe HTTP, ou plus pr√©cis√©ment, un lien vers un fichier de mot de passe centralis√© dans n'importe quel r√©pertoire que vous souhaitez prot√©ger avec un mot de passe.  Par cons√©quent, si vous regardez le micrologiciel, l'interface Web de chaque r√©pertoire contenait un fichier de mot de passe .htpasswd, √† l'exception d'un r√©pertoire, oamp, situ√© dans / usr / local / www / oamp. <br><br><img src="https://habrastorage.org/webt/5y/9_/5t/5y9_5t4aajko9fpfqyrgo8rxukq.jpeg"><br><br>  Au lieu d'un fichier de mot de passe, il contenait un tas de fichiers XML qui servaient de liens vers le fichier binaire oamp.cgi.  Voyons ce que fait ce cgi.  Il s'av√®re qu'il impl√©mente une sorte de mini-API, qui est compl√®tement distincte de tout ce qui s'ex√©cute dans l'interface Web. <br><br><img src="https://habrastorage.org/webt/du/hp/ze/duhpze4khdkjnwkpxcq71egk1fa.jpeg"><br><br>  Il s'attend √† ce que l'on vous demande certaines actions, notamment le t√©l√©chargement du fichier de configuration, la mise √† jour du fichier de configuration, le t√©l√©chargement du fichier de mise √† jour du micrologiciel, la mise √† jour du micrologiciel, et bien plus encore.  Les d√©veloppeurs n'√©taient pas si stupides, donc avant d'ex√©cuter votre demande, oamp.cgi v√©rifie si vous avez le bon ID de session valide. <br><br><img src="https://habrastorage.org/webt/-y/w-/tc/-yw-tczrcu1suqe5m7nhkbckry0.jpeg"><br><br>  Si vous ne disposez pas d'un identifiant de session valide, la seule chose qu'il peut faire est d'entrer une connexion. <br><br><img src="https://habrastorage.org/webt/h4/-f/db/h4-fdbh_byljwbfst90cnc0fa1w.jpeg"><br><br>  Cela en soi est int√©ressant car ils ont impl√©ment√© une v√©rification d'authentification qui n'est utilis√©e nulle part ailleurs dans l'interface.  J'ai commenc√© √† comprendre comment ils contr√¥lent l'entr√©e, c'est-√†-dire la connexion.  Ils comptent sur votre nom d'utilisateur et votre mot de passe, et sans plus de surprises. <br><br><img src="https://habrastorage.org/webt/cc/of/dh/ccofdh7-rzwu3cslr4rzawektjm.jpeg"><br><br><img src="https://habrastorage.org/webt/xl/zw/ms/xlzwmsxf0zvnpzunpu4sgncnrc4.jpeg"><br><br>  Et puis ils font deux appels √† la fonction PRO_GetStr, et je n'ai aucune id√©e de ce qu'ils affectent.  Mais je sais que le premier appel √† cette fonction lui donne deux lignes - OAMP et le nom d'utilisateur L1_usr, et le deuxi√®me appel - deux autres lignes, OAMP et le mot de passe L1_pwd. <br><br><img src="https://habrastorage.org/webt/n1/ym/om/n1ymomdakif9vlzheuwya5mjfty.jpeg"><br><br><img src="https://habrastorage.org/webt/78/fy/t9/78fyt9djqavicl7cicsxnd-zrw4.jpeg"><br><br>  Ensuite, la premi√®re valeur est renvoy√©e pour l'utilisateur L1 et compar√©e avec le nom d'utilisateur utilisateur, L1_usr sp√©cifi√© lors de l'authentification, et la deuxi√®me valeur de la cha√Æne est √©galement renvoy√©e - mot de passe mot de passe, L1_usr, qui est compar√©e avec le mot de passe entr√© par l'utilisateur lors de la connexion. <br><br><img src="https://habrastorage.org/webt/jw/-p/jv/jw-pjvidwi9ol_sb5fiv1zxv6kc.jpeg"><br><br><img src="https://habrastorage.org/webt/zo/ah/py/zoahpyuevenlfpkgkozbbdc7nle.jpeg"><br><br>  Vraisemblablement, ce nom d'utilisateur et mot de passe L1, quelles que soient les valeurs qu'ils prennent, fournissent la connexion correcte pour cette interface OAMP.  Le seul autre endroit que j'ai pu trouver dans le firmware, et qui est vraiment associ√© au nom d'utilisateur et au mot de passe de l'utilisateur, est dans le fichier de configuration. <br><br><img src="https://habrastorage.org/webt/mm/pb/k5/mmpbk5f98z45lefbabw5x0l7jt8.jpeg"><br><br>  Et ces valeurs sont cod√©es en dur dans les p√©riph√©riques qui utilisent le fichier de configuration de la section OAMP pendant le fonctionnement.  Vous voyez que la valeur de connexion utilisateur L1 est d√©finie dans la ligne L1_admin et la valeur du mot de passe utilisateur est dans la ligne L1_51. <br><br>  Et c'est un vrai probl√®me, car toute cette interface OAMP et ces comptes cod√©s en dur sont compl√®tement non document√©s, donc personne ne sait qu'ils sont l√†, sauf pour les personnes qui ont pris la peine de regarder dans le firmware.  Bien s√ªr, l'administrateur ne le fera jamais. <br><br>  Mais m√™me s'il l'a d√©couvert, il n'a aucun moyen de modifier ces valeurs, car il n'y a pas d'interface administrateur dans cet appareil photo.  Le probl√®me avec les mots de passe secrets cod√©s en dur est que, gr√¢ce √† l'utilisation de portes d√©rob√©es, ils restent secrets pendant une courte p√©riode. <br><br>  Ainsi, nous pouvons utiliser ces comptes de porte d√©rob√©e pour vous connecter et obtenir un ID de session.  Maintenant que nous pouvons envoyer cet ID de session avec nos demandes, nous pouvons √©galement invoquer toute autre action prise en charge par oamp.cgi, y compris le t√©l√©chargement du fichier de configuration des param√®tres. <br><br><img src="https://habrastorage.org/webt/an/w3/i1/anw3i17pq_cvs9ojuxuxrizzcqe.jpeg"><br><br><img src="https://habrastorage.org/webt/9a/_a/lp/9a_alpxed7vbjf9v1qx4pc9arqu.jpeg"><br><br>  Le probl√®me est que si vous essayez de le d√©crypter en utilisant Base64, cela ne fonctionne pas, vous obtenez juste un tas de d√©chets.  C'est le cas lorsque Base64 n'est pas Base64. <br><br><img src="https://habrastorage.org/webt/g2/ty/mb/g2tymbmqw_ivhqvpxtvkzlnkr28.jpeg"><br><br>  La raison de cela devient √©vidente lorsque vous regardez le code final Base64 dans le fichier binaire du microprogramme PVC-2300 lui-m√™me - la base de l'encodage est cr√©√©e ici, mais il utilise une cha√Æne de cl√© Base64 non standard, qui a √©t√© d√©couverte lors de l'analyse du chiffrement et du d√©chiffrement du code 64. Heureusement, avec En utilisant Python, il est tr√®s facile de changer une cha√Æne de cl√© dans un module Python Base64 en une cha√Æne de cl√© personnalis√©e, comme indiqu√© dans la diapositive. <br><br><img src="https://habrastorage.org/webt/1j/lo/fb/1jlofb--8fxiriwhad4abpwuxju.jpeg"><br><br>  Ainsi, avec quelques cha√Ænes Python, nous pouvons facilement d√©crypter le fichier de configuration et le transformer en texte brut, ce qui nous donne des options de connexion sous la connexion de l'administrateur. <br><br><img src="https://habrastorage.org/webt/dd/a6/wm/dda6wmvvhgydwz8vxdu7utsslim.jpeg"><br><br>  Apr√®s avoir pris le contr√¥le de la cam√©ra, nous pouvons voir la salle des serveurs.  Le probl√®me est que la visualisation des salles de serveurs capture vraiment les 10 premi√®res secondes, mais cela devient alors une t√¢che plut√¥t ennuyeuse. <br><br><img src="https://habrastorage.org/webt/v9/sn/yq/v9snyqmqg0robtcbe86hp6iwe6o.jpeg"><br><br>  Par cons√©quent, je suis revenu sur le code et j'ai commenc√© √† √©tudier la possibilit√© de t√©l√©charger le firmware.  C'est en fait tr√®s int√©ressant, car au lieu de t√©l√©charger le fichier du firmware sur l'appareil √† partir du site officiel, vous pouvez sp√©cifier votre propre URL, l'appareil ira √† cette adresse et t√©l√©chargera ce qu'il consid√®re comme un firmware. <br><br><img src="https://habrastorage.org/webt/bs/u1/gj/bsu1gjoyhq5ieybllbrxcjsd4ig.jpeg"><br><br>  La fonction system2 g√©n√®re simplement une commande √† partir de la cha√Æne de format et de l'url avant d'appeler la fonction syst√®me libc, ce qui permet √† un attaquant d'entrer des commandes shell arbitraires via le param√®tre url.  La commande de l'attaquant sera ex√©cut√©e avec des droits de superutilisateur, et puisque la v√©rification est effectu√©e par la valeur url, il est tr√®s facile de la contourner √† l'aide de ce script: <br><br><pre> <code class="hljs ruby">$ wget --header=‚Äù<span class="hljs-symbol"><span class="hljs-symbol">sessionID:</span></span> <span class="hljs-number"><span class="hljs-number">57592414</span></span>‚Äù <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/192.168.1.101/oamp</span></span><span class="hljs-regexp"><span class="hljs-regexp">/System.xml?action=loadFirmware&amp;url=https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/127.0.0.1:6 5534/</span></span>;reboot;</code> </pre> <br>  Apr√®s cela, l'ordinateur situ√© √† cette URL red√©marre et vous pouvez ex√©cuter n'importe quelle commande de votre choix. <br><br><img src="https://habrastorage.org/webt/1r/wj/j5/1rwjj5ih0d0j1fybyteeg7mdnyw.jpeg"><br><br>  Cette vuln√©rabilit√© a √©t√© test√©e sur toutes les versions de micrologiciel de deux mod√®les de cam√©ras de surveillance Cisco - PVC-2300 et WVC-2300, une cam√©ra similaire avec deux antennes.  Au moment d'√©crire ces lignes, Shodan a montr√© plus de 500 cam√©ras IP publiques et potentiellement vuln√©rables d√©tenues par des h√¥tels, des salles de serveurs et des soci√©t√©s d'ing√©nierie d√©veloppant des √©quipements pour la Station spatiale internationale. <br><br>  Ainsi, D-link et Cisco ne prot√®gent pas correctement les cam√©ras de surveillance, m√™me si vous savez que ces cam√©ras ne sont pas leur produit principal.  Par cons√©quent, regardons les marques qui se sp√©cialisent sp√©cifiquement dans la conception et la fabrication de cam√©ras de surveillance.  J'ai choisi IQ Invision, qui produit des cam√©ras haute d√©finition co√ªteuses, telles que l'IQ 832n, co√ªtant plus de 1000 $ chacune, ce qui n'est pas bon march√© du tout. <br><br><img src="https://habrastorage.org/webt/od/4n/47/od4n470mrojtlam7vrbiqpaagcw.jpeg"><br><br>  La principale raison de mon int√©r√™t est que ce sont les gars qui font installer les cam√©ras dans le complexe commercial o√π je travaille, donc il y avait des raisons personnelles √† cela.  Alors, qu'obtenez-vous en utilisant une cam√©ra de surveillance professionnelle pour mille dollars? <br>  Par d√©faut, ces cam√©ras fournissent une image vid√©o non authentifi√©e, et aucune des √©tudes d√©taill√©es d'installation de cam√©ras n'a pu modifier ce param√®tre par d√©faut.  Bien que l'interface d'administration soit prot√©g√©e par mot de passe, l'interface utilisateur permet d'acc√©der √† toutes les ressources de la cam√©ra sans authentification, ce qui cr√©e un large champ d'attaque. <br><br><img src="https://habrastorage.org/webt/mn/gr/mn/mngrmndqcnufl90nrnj_lfhpvse.jpeg"><br><br>  Les param√®tres d'authentification de l'administrateur peuvent √™tre modifi√©s par l'administrateur, mais essayez de deviner combien d'administrateurs ont connect√© leurs cam√©ras √† Internet sans modifier les param√®tres par d√©faut - presque tout.  Cependant, la plupart des administrateurs de notre complexe √©taient assez intelligents pour modifier ces param√®tres, j'ai donc commenc√© √† regarder ce que je pouvais faire d'autre sans authentification.  Il s'est av√©r√© que je pouvais acc√©der librement √† la page. <br><br><img src="https://habrastorage.org/webt/qo/m2/xc/qom2xc4tfzyzncf5bienr4e4a5m.jpeg"><br><br>  Il contient tout un tas de param√®tres de l'appareil photo, tels que les param√®tres de mise au point, qui ne sont pas aussi int√©ressants que les noms d'utilisateur et les mots de passe.  Le code derri√®re cette page oidtable.cgi √©tait plus int√©ressant.  Si vous d√©montez ce binaire, vous pouvez voir que la page n'accepte qu'un seul param√®tre, grep, qui est utilis√© pour filtrer les r√©sultats renvoy√©s √† la page oidtable.cgi. <br><br><img src="https://habrastorage.org/webt/xq/xa/bw/xqxabwwpfodp1lbutwkjhnh0iws.jpeg"><br><br>  Apr√®s avoir v√©rifi√© que la valeur du param√®tre fourni est inf√©rieure √† 32 caract√®res, oidtable.cgi place cette valeur sur la ligne de commande et la transmet √† popen: <br><br><img src="https://habrastorage.org/webt/7o/6t/gx/7o6tgx98hkegmfygblszjdmtqbm.jpeg"><br><br><img src="https://habrastorage.org/webt/i6/0a/4s/i60a4smzvkzi1hsop0lam0rcv9i.jpeg"><br><br>  Ce que j'ai vu m'a fait d√©peindre le ¬´facepalm¬ª et m'a incit√© √† injecter quelques √©quipes. <br><br><img src="https://habrastorage.org/webt/k2/2g/c3/k22gc3orqjsproq9bgagtpbwntk.jpeg"><br><br>  Vous voyez qu'ici, tout comme dans le cas de D-Link, je peux ex√©cuter la commande PS et r√©cup√©rer la sortie sur mon navigateur.  Ainsi, sans authentification, je peux facilement entrer des commandes shell arbitraires qui seront ex√©cut√©es en tant que root.  Les listes de processus montrent que Netcat est d√©j√† install√© sur ces cam√©ras avec la possibilit√© de saisir des tirets dash-e, donc je suis s√ªr que la plupart des gens ici peuvent trouver des commandes plus int√©ressantes √† ex√©cuter que la liste de processus.  Cependant, mon objectif principal √©tait d'entrer dans le panneau d'administration, et j'ai compris comment le faire. <br><br>  16:30 min <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conf√©rence BLACK HAT USA.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment un pirate hollywoodien utilise des cam√©ras de surveillance.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2e partie</a> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/B8DjTcANBx0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Merci de rester avec nous.  Aimez-vous nos articles?  Vous voulez voir des mat√©riaux plus int√©ressants?  Soutenez-nous en passant une commande ou en le recommandant √† vos amis, une <b>r√©duction de 30% pour les utilisateurs Habr sur un analogue unique de serveurs d'entr√©e de gamme que nous avons invent√©s pour vous:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Toute la v√©rit√© sur VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbps √† partir de 20 $ ou comment diviser le serveur?</a>  (les options sont disponibles avec RAID1 et RAID10, jusqu'√† 24 c≈ìurs et jusqu'√† 40 Go de DDR4). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 c≈ìurs) 10 Go DDR4 240 Go SSD 1 Gbit / s jusqu'en d√©cembre gratuitement</b> en payant pour une p√©riode de six mois, vous pouvez commander <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  <b>Dell R730xd 2 fois moins cher?</b>  Nous avons seulement <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 Go DDR4 6x480 Go SSD 1 Gbps 100 TV √† partir de 249 $</a> aux Pays-Bas et aux √âtats-Unis!</b>  Pour en savoir plus sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cr√©ation d'un b√¢timent d'infrastructure.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe utilisant des serveurs Dell R730xd E5-2650 v4 co√ªtant 9 000 euros pour un sou?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr427367/">https://habr.com/ru/post/fr427367/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr427357/index.html">√âcriture de shaders dans Unity. GrabPass, PerRendererData</a></li>
<li><a href="../fr427359/index.html">Comment ECS, C # Job System et SRP changent d'architecture</a></li>
<li><a href="../fr427361/index.html">Caract√©ristiques du filtrage des fen√™tres sur FPGA</a></li>
<li><a href="../fr427363/index.html">Impl√©mentation de LoRaWAN dans une entreprise agricole. Tout sur la construction, le lancement et les solutions</a></li>
<li><a href="../fr427365/index.html">Rapport de RedSlerm sur la surveillance (Monit, Zabbix)</a></li>
<li><a href="../fr427369/index.html">Conf√©rence BLACK HAT USA. Comment un pirate hollywoodien utilise des cam√©ras de surveillance. 2e partie</a></li>
<li><a href="../fr427371/index.html">Cours vid√©o "Fondamentaux du travail avec les notations BPMN." Gratuit</a></li>
<li><a href="../fr427373/index.html">Firefox peut √™tre mon√©tis√© avec le module compl√©mentaire VPN payant int√©gr√©</a></li>
<li><a href="../fr427377/index.html">Administrateur syst√®me simple CI / CD</a></li>
<li><a href="../fr427379/index.html">Junior Senior: Revue du t√©l√©phone IP Snom D715</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>