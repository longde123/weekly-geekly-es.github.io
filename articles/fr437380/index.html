<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ¬ï¸ ğŸ’ ğŸŒ™ Tout le monde gronde les cadres de test auto-Ã©crits. Et nous sommes satisfaits de notre â– â›„ï¸ ğŸ“€</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je m'appelle Elena Rastorgueva, je suis responsable du produit Factor chez HFLabs . The Factor est une entreprise algorithmique extrÃªmement complexe q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tout le monde gronde les cadres de test auto-Ã©crits. Et nous sommes satisfaits de notre</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/437380/"><img src="https://habrastorage.org/webt/nt/p-/0f/ntp-0fxrjpsarus7awbwtsdgdhu.jpeg"><br><br>  Je m'appelle Elena Rastorgueva, je suis responsable du produit Factor chez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HFLabs</a> .  The Factor est une entreprise algorithmique extrÃªmement complexe qui traite des donnÃ©es Ã  l'Ã©chelle industrielle. <br><br>  Dans l'article, je vais vous expliquer comment nous avons commencÃ© Ã  tester le Â«FactorÂ», comment les autotests ont Ã©tÃ© dÃ©veloppÃ©s et pourquoi nous sommes arrivÃ©s aux frameworks auto-Ã©crits. <br><a name="habracut"></a><br><h2>  De quel type de produit s'agit-il - Â«FacteurÂ» </h2><br>  "Factor" nettoie les donnÃ©es dans des bases de donnÃ©es avec des millions de clients: supprime les fautes de frappe dans le nom, le tÃ©lÃ©phone et l'e-mail, vÃ©rifie les passeports, fait beaucoup plus.  Le plus difficile est de corriger les adresses postales. <br><br><img src="https://habrastorage.org/webt/sc/le/g8/scleg8hmrcclix90ouwukypheke.png"><br>  <sub>Les adresses sont Ã©crites de centaines de faÃ§ons, donc le Facteur a un puissant appareil algorithmique sous le capot</sub> <br><br>  "Factor" fonctionne comme un service: donnÃ©es d'entrÃ©e - donnÃ©es de sortie. <br><br>  Il s'agit d'un systÃ¨me sans Ã©tat oÃ¹ chaque appel est indÃ©pendant des prÃ©cÃ©dents.  L'apatridie simplifie considÃ©rablement la vie du testeur.  Il est beaucoup plus difficile de tester un systÃ¨me avec Ã©tat lorsqu'une sÃ©quence d'actions est importante. <br><br>  Le produit doit Ãªtre fiable comme l'ISS, car il est utilisÃ© par les banques, les opÃ©rateurs mobiles, les assurances et les dÃ©taillants de niveau Lenta.  Nous rÃ©pondons des erreurs de notre tÃªte dans la mesure oÃ¹ l'absence d'erreurs fait partie du SLA dans le contrat avec le client. <br><br>  En raison des exigences de fiabilitÃ© des autotests, nous avons Ã©crit dÃ¨s le dÃ©but du dÃ©veloppement.  L'un des critÃ¨res de prÃ©paration de la tÃ¢che est Â«Ajout d'autotestsÂ». <br><br><h2>  CommencÃ© par des vÃ©rifications manuelles et des autotests </h2><br>  Nous avons lancÃ© le Factor en 2005 et l'avons d'abord testÃ© avec nos mains.  Le matin, le testeur a effectuÃ© des autotests sur un fichier contenant des cas et a comparÃ© le rÃ©sultat du traitement des donnÃ©es avec le rÃ©sultat de la veille: ce qui a changÃ© aprÃ¨s la validation du code d'hier. <br><br>  Le processus pouvait prendre une demi-journÃ©e, cet alignement n'Ã©tait pas bon.  Par consÃ©quent, nous avons pris l'ensemble minimal de tests pour la fonctionnalitÃ© clÃ© et enveloppÃ© dans des tests unitaires.  Ces tests sont rapides et le dÃ©veloppeur lui-mÃªme les a exÃ©cutÃ©s avant de s'engager. <br><br>  Les tests unitaires sont si pratiques et si rapides que nous en avons ajoutÃ© des milliers.  Et puis nous sommes tombÃ©s dessus: lorsque les tests ressemblent Ã  une feuille de milliers de morceaux de code, il n'est mÃªme pas facile de faire dÃ©filer jusqu'au bon endroit.  Sans parler de l'ajout ou de la mise Ã  jour. <br><br><img src="https://habrastorage.org/webt/vd/a5/ua/vda5uatnzsl6du95r_x_jjbpsle.png"><br>  <sub>Test unitaire pour vÃ©rifier le format SNILS</sub> <br><br>  De plus, quelque chose d'inattendu apparaÃ®t soudain dans les donnÃ©es industrielles qui ne couvre pas les tests unitaires.  Par exemple, un nouveau client est venu avec de nouvelles fonctionnalitÃ©s dans les adresses, les tests unitaires ne couvrent pas ces fonctionnalitÃ©s.  Vous devez vous asseoir et voir quels tests ajouter pour de nouvelles donnÃ©es.  Nous l'avons toujours fait manuellement. <br><br><h2>  CrÃ©ez votre propre framework </h2><br>  Dans les tests unitaires traditionnels, les donnÃ©es et le code sont mÃ©langÃ©s; il est difficile de trouver les bonnes piÃ¨ces. <br><br>  Par consÃ©quent, nous avons essayÃ© les autotests dans le paradigme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DDT (Data Driven Testing)</a> .  DDT est lorsque les donnÃ©es de test sont stockÃ©es sÃ©parÃ©ment du code de test. <br><br>  Les cas ont Ã©tÃ© chargÃ©s Ã  partir d'un fichier Excel, ils se trouvaient dans les colonnes Â«DonnÃ©es brutesÂ» et Â«RÃ©sultat attenduÂ».  Le DDT a Ã©tÃ© une percÃ©e: la mise Ã  jour des cas dans "l'exelnik" est inexplicablement plus simple. <br><br>  Petit Ã  petit, nous avons dÃ©veloppÃ© une approche et dÃ©veloppÃ© notre propre framework de test.  Il reÃ§oit des fichiers texte en entrÃ©e, Ã  l'intÃ©rieur d'eux se trouvent les donnÃ©es source et le rÃ©sultat attendu. <br><br><img src="https://habrastorage.org/webt/4z/ux/b2/4zuxb2hzdkjzampel0ioln9qksa.png"><br>  <sub>Nous avons refusÃ© les fichiers Excel comme stockage: les fichiers texte s'ouvrent plus rapidement, ne modifient pas le contenu, il est plus facile de collecter des donnÃ©es Ã  partir d'eux</sub> <br><br>  Le cadre est aidÃ© par des outils standard: <br><br><ul><li>  TeamCity exÃ©cute automatiquement des tests tous les soirs; </li><li>  testNG compare les rÃ©sultats attendus et rÃ©els. </li></ul><br><img src="https://habrastorage.org/webt/js/3p/3x/js3p3xatz9q9u7qhd1hk7ahinfq.png"><br>  <sub>Si le rÃ©sultat est diffÃ©rent de celui attendu, dans TeamCity le test rougit.</sub>  <sub>Si tout est comme il se doit, le test est vert</sub> <br><br><h2>  Vous avez modifiÃ© le cadre pour vous-mÃªme </h2><br>  12 ans se sont Ã©coulÃ©s depuis.  Pendant ce temps, le cadre a envahi des capacitÃ©s qui ne sont pas dans les solutions standard. <br><br>  <b>Comptabilisation de l'Ã©tat des tÃ¢ches dans Jira.</b>  HFLabs adhÃ¨re au <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dÃ©veloppement pilotÃ© par les tests</a> : nous Ã©crivons d'abord un test ou ajoutons des cas de test pour de nouveaux comportements, puis nous modifions ensuite les fonctionnalitÃ©s. <br><br>  Nous avons dÃ©sactivÃ© de nouveaux cas en commentant la ligne.  Sinon, ils sont d'abord tombÃ©s et sont intervenus, car les cas ont ajoutÃ© des fonctionnalitÃ©s ou des corrections de bugs auparavant. <br><br>  Mais la tÃ¢che peut ne pas Ãªtre en mesure de terminer le cas de test correspondant: le bogue se rÃ©vÃ©lera extrÃªmement rare ou le client apportera quelque chose de plus important.  Certaines tÃ¢ches ont Ã©tÃ© suspendues pendant des mois avec une faible prioritÃ© et des cas dÃ©connectÃ©s se sont accumulÃ©s.  Dans le mÃªme temps, il n'est pas clair Ã  quelle tÃ¢che appartient chaque cas, si ce cas peut Ãªtre supprimÃ©. <br><br>  Par consÃ©quent, nous avons ajoutÃ© un numÃ©ro de tÃ¢che aux cas dÃ©connectÃ©s et gÃ¢chÃ© un peu d'automatisation.  Maintenant, tout fonctionne comme ceci: <br><br><ul><li>  le scÃ©nario de test est dÃ©sactivÃ© en le faisant correspondre Ã  une tÃ¢che ouverte dans Jira; <br><br><img src="https://habrastorage.org/webt/ny/xd/rb/nyxdrbvmz4np0kkgjgn5srct-cw.png"><br>  <sub>Pour joindre un cas Ã  une tÃ¢che, Ã©crivez devant celui-ci <i>#</i> et le numÃ©ro de tÃ¢che</sub> <br></li><li>  le framework exÃ©cute des tests mÃªme sur les cas dÃ©sactivÃ©s.  Mais ignore les plantages lorsque la tÃ¢che est ouverte dans Jira; </li><li>  dÃ¨s que la tÃ¢che est close, le test commence Ã  tomber sur les cas qui lui sont attachÃ©s.  C'est un signal: ils ont rÃ©ussi la tÃ¢che, mais ont oubliÃ© d'activer les boÃ®tiers; </li><li>  si tout Ã  coup le test du cas dÃ©connectÃ© a commencÃ© Ã  passer avec une tÃ¢che ouverte, le framework en informera Ã©galement.  Il est peut-Ãªtre temps d'activer le boÃ®tier ou de fermer la tÃ¢che qui lui est associÃ©e (ainsi que de mettre Ã  jour les notes de publication et d'informer les clients). <br><br><img src="https://habrastorage.org/webt/ah/eb/vt/ahebvthx1cfsge12a5ofyjms408.png"><br>  <sub>Le cadre dit que l'affaire dÃ©connectÃ©e est en cours.</sub>  <sub>Peut-Ãªtre que quelqu'un a corrigÃ© le code dans le cadre d'une autre tÃ¢che, et maintenant tout fonctionne</sub> <br></li></ul><br>  Nous avons donc sauvÃ© TDD et vaincu l'oubli lors de la gestion des cas de test. <br><br><img src="https://habrastorage.org/webt/8s/df/1w/8sdf1wf1xib-di08-upv-njfwd8.png"><br>  <sub>Nous avons documentÃ© toutes les options avec l'Ã©tat des cas de test et des tÃ¢ches associÃ©es, afin de ne pas oublier</sub> <br><br>  <b>Mise Ã  jour des cas de test en mode semi-automatique.</b>  Il semblerait que si le test se bloque, recherchez une erreur dans le code.  Mais pour nous, ce n'est pas toujours le cas.  Il arrive parfois que les cas de test doivent Ãªtre mis Ã  jour, car les exigences pour le rÃ©sultat ont changÃ©. <br><br>  Par exemple, avant que le client de l'adresse effacÃ©e ne souhaite "g.  Moscou Â»dans un domaine.  Maintenant qu'il a changÃ© l'architecture de la base de donnÃ©es, il veut la "ville" dans un domaine, "Moscou" dans un autre.  Il est temps de changer les cas de test. <br><br>  Pour le test tombÃ©, TeamCity montre la diffÃ©rence entre les rÃ©sultats attendus et rÃ©els.  Auparavant, nous avons copiÃ© cette diffÃ©rence et mis Ã  jour les cas de test avec nos mains.  Pour des changements massifs - un Ã©vÃ©nement trÃ¨s coÃ»teux. <br><br><img src="https://habrastorage.org/webt/2g/cv/iu/2gcviu56ac4pgtbtb3me4k5cc_0.png"><br>  <sub>Un exemple vivant: nous avons appris Â«FactorÂ» pour dÃ©terminer un pays par numÃ©ro de tÃ©lÃ©phone, les tests dans TeamCity sont tombÃ©s.</sub>  <sub>Un nouveau repÃ¨re peut Ãªtre tirÃ© du rÃ©sultat rÃ©el, mais cela prend beaucoup de temps</sub> <br><br>  Nous avons fait la mise Ã  jour du cadre de rÃ©fÃ©rence lui-mÃªme.  Pour ce faire, aprÃ¨s avoir exÃ©cutÃ© les tests, il remplace les rÃ©sultats de nettoyage attendus dans la norme par ceux rÃ©els oÃ¹ ils ne correspondaient pas.  Le rÃ©sultat est enregistrÃ© dans des artefacts en tant que fichier de mise Ã  jour de cas. <br><br><img src="https://habrastorage.org/webt/6e/ok/dp/6eokdpdk8hqlbsggw2e2zxsyxty.png"><br>  <sub>Le premier fichier est une nouvelle rÃ©fÃ©rence dans laquelle le cadre a mis Ã  jour les rÃ©sultats attendus.</sub>  <sub>Les fichiers restants sont les donnÃ©es d'entrÃ©e, l'ancienne norme et les donnÃ©es rÃ©elles pour les cas abandonnÃ©s.</sub> <br><br>  Avec la nouvelle rÃ©fÃ©rence, le testeur met Ã  jour les cas en trois Ã©tapes. <br><br><ol><li>  TÃ©lÃ©chargez le fichier gÃ©nÃ©rÃ©. </li><li>  VÃ©rifie Ã  travers n'importe quel outil de fusion quels changements sont dans le nouveau benchmark.  Ne laisse que le nÃ©cessaire. </li><li>  Valider </li></ol><br><img src="https://habrastorage.org/webt/wp/o8/xn/wpo8xnrbcyzdhqkbif0mafezhbs.png"><br>  <sub>Le testeur vÃ©rifie si les mises Ã  jour de la nouvelle norme sont correctes et les valide</sub> <br><br>  Oui, s'il est mis Ã  jour irrÃ©flÃ©chi, rien de bon n'en sortira.  Mais il existe un risque de mise Ã  jour irrÃ©flÃ©chie lorsque vous travaillez manuellement. <br><br>  <b>Stabilisation des donnÃ©es de test avec des talons.</b>  "Factor" renvoie les donnÃ©es traitÃ©es dans des dizaines de champs.  Il y a un tas de composants dans une seule adresse: index, rÃ©gion, type de rÃ©gion, type de ville, ville, type de rue, maison, bÃ¢timent, bÃ¢timent, appartement.  Pour eux, le Â«FacteurÂ» attrape IFTS, OKATO, OKTMO et mÃªme les petites choses.  Donc, Ã  partir d'une ligne Ã  l'entrÃ©e, des dizaines de valeurs sont obtenues. <br><br>  Tous les champs du rÃ©sultat ne doivent pas Ãªtre vÃ©rifiÃ©s avec des cas de test.  Par exemple, la reconnaissance de la mÃªme adresse dÃ©pend directement du rÃ©pertoire d'Ã©tat - FIAS.  Et en elle, les domaines changent rÃ©guliÃ¨rement, pour nos tÃ¢ches ils sont complÃ¨tement Ã©trangers.  La mise Ã  jour de certains codes CLADR pour les maisons a supprimÃ© des centaines de cas de test. <br><br>  Nous avons ajoutÃ© des talons au rÃ©sultat attendu lorsque nous avons rÃ©alisÃ© que nous perdions notre temps Ã  analyser des chutes sans importance. <br><br>  Lorsque le champ n'a pas du tout besoin d'Ãªtre vÃ©rifiÃ©, le testeur Ã©crit un symbole dans le rÃ©sultat attendu: <i>$$ DNV $$</i> .  Quand le champ doit Ãªtre rempli, mais la valeur elle-mÃªme n'est pas importante: <i>$$ NE $$</i> . <br><br><img src="https://habrastorage.org/webt/ol/v6/e_/olv6e_wixlpjexljoquxpcgo4l8.png"><br>  <sub>L'ID FIAS est toujours dans l'adresse, nous le vÃ©rifions donc lors de tous les tests.</sub>  <sub>Si le champ est vide, quelque chose ne va pas.</sub>  <sub>Mais l'index peut ne pas l'Ãªtre, par consÃ©quent, lors de la vÃ©rification de l'ID FIAS, nous ignorons l'index</sub> <br><br>  Vous pouvez aller dans l'autre sens et sÃ©parer les tests: chaque champ a le sien.  Mais c'est difficile, car tout ne peut pas Ãªtre isolÃ©.  Par exemple, Â«villeÂ» et Â«rueÂ» font partie d'une adresse et sans elles n'ont aucun sens. <br><br><h2>  Un cadre auto-Ã©crit est plus pratique </h2><br>  Par consÃ©quent, je ne considÃ¨re pas du tout la crÃ©ation de mon propre cadre comme une entreprise stupide.  Si nous n'avions pas crÃ©Ã© notre propre outil, nous n'aurions pas reÃ§u autant de nouvelles opportunitÃ©s et une telle flexibilitÃ©. <br><br>  DÃ©sactiver le casse de texte par statut de tÃ¢che, gÃ©nÃ©rer un nouveau test de rÃ©fÃ©rence et des talons pour le rÃ©sultat sont les choses que nos testeurs demandent maintenant dans d'autres cadres.  Si nous prenions des solutions standard, nous ne pourrions jamais le faire. <br><br>  <i>Si vous aimez faire des choses complexes en entreprise, venez chez nous.</i>  <i>Maintenant, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nous recherchons un dÃ©veloppeur Java</a> , salaire de 135 000 â‚½ sans impÃ´t sur le revenu des particuliers.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437380/">https://habr.com/ru/post/fr437380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437368/index.html">MOSDROID # 15 Phosphore</a></li>
<li><a href="../fr437372/index.html">Trois astuces simples pour rÃ©duire les images de docker</a></li>
<li><a href="../fr437374/index.html">Les utilisateurs de Facebook louent leurs comptes avec de l'argent et des ordinateurs portables gratuits</a></li>
<li><a href="../fr437376/index.html">Curieuses perversions du monde de l'informatique - 2</a></li>
<li><a href="../fr437378/index.html">Qu'est-ce que ARCore? Tout ce que vous devez savoir</a></li>
<li><a href="../fr437382/index.html">ThÃ©orie des feux d'artifice. Fantaisie cosmologique</a></li>
<li><a href="../fr437384/index.html">Le ministÃ¨re du Travail et Rostelecom ont divergÃ© dans l'Ã©valuation du nombre de fonctionnaires qui recevront des smartphones sur l'OS Sailfish national</a></li>
<li><a href="../fr437386/index.html">Entretiens - Interviewer Look</a></li>
<li><a href="../fr437390/index.html">DPAPI "Secrets". Regardez l'Ã¢ne</a></li>
<li><a href="../fr437396/index.html">Pourquoi CarPrice est-il pilotÃ© par l'intelligence artificielle?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>