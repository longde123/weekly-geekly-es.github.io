<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏾‍✈️ ✋🏿 😌 Raspberry Pi Simulation Erweiterungskarte 🧒🏻 🕤 🦍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Raspberry Pi-Mikrocomputer ist seit langem in das Leben von Geeks, Systemadministratoren, Programmierern und Elektronikingenieuren eingetreten. Es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Raspberry Pi Simulation Erweiterungskarte</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401089/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Raspberry Pi-Mikrocomputer ist seit langem in das Leben von Geeks, Systemadministratoren, Programmierern und Elektronikingenieuren eingetreten. </font><font style="vertical-align: inherit;">Es ist kostengünstig und für seine Klasse relativ leistungsfähig. Mit integrierten E / A-Ports kann es verschiedene Aufgaben bewältigen und die Benutzeranforderungen erfüllen. </font><font style="vertical-align: inherit;">Nachdem ich einen Raspberry Pi gekauft hatte, wollte ich etwas, um externe Geräte einzuschalten, zu messen und zu verwalten. </font><font style="vertical-align: inherit;">Derzeit wird eine große Anzahl von Erweiterungskarten verkauft, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie können Breadboards mit Drähten für Rapid Prototyping verwenden, aber ich bevorzuge es, Geräte für bestimmte Aufgaben selbst herzustellen. </font><font style="vertical-align: inherit;">Zum ersten Mal habe ich nicht für alle Ausgänge einen zweireihigen Kamm verwendet, sondern mich auf mehrere E / A-Ports, SPI, I2C und UART-Bus beschränkt. </font><font style="vertical-align: inherit;">Ich habe den Raspberry Pi mit den Zieldrähten für das Prototyping von "Mama-Mama" verbunden. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/eef/18f/ae2/eef18fae242d47dab3f10bb6a4cfb21b.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Zusammenhang wurde eine Reihe von drei Prototyping-Boards entwickelt, von denen eines das einfachste ist, das ich in diesem Artikel diskutieren werde.</font></font><a name="habracut"></a> <br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Also was ich brauchte:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arbeiten Sie mit GPIO mit Ein- und Ausgängen. </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lastmanagement; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anschluss von Temperatursensoren am 1-Draht-Bus; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spannungsmessung; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Echtzeituhr; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Überwachung und Steuerung eines externen Geräts über den RS485-Bus; </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Separate Stromversorgung für Erweiterungskarte; </font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gemäß der obigen Liste wurde eine elektrische Schaltung entwickelt: </font></font><br>
<img src="https://habrastorage.org/files/cc4/136/432/cc41364328f3449094dc0b05a940a987.jpg" alt="Bild"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
→ </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Schaltung aus einem hochauflösenden Speicher</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Die Schaltung verwendet eine Transformatorstromquelle mit zwei Ausgangswicklungen. Die erste Wicklung arbeitet mit einem linearen Spannungsregler mit einem 5-V-Ausgang, um den RS485-Treiberchip und die Echtzeituhr mit Strom zu versorgen. Die zweite Wicklung dient zur Stromversorgung elektromagnetischer Relais und zur Montage mit Darlington-Transistoren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der DS18B20-Temperatursensor wird mit +3,3 V von der Raspberry Pi-Karte gespeist. Die Karte verfügt über einen Anschluss zum Anschließen externer DS18B20-Sensoren. Die gleiche Spannung wird für den ADC angelegt und die Pegel mit einer Echtzeituhr abgeglichen. Die Schaltung verwendet vier Tasten S1-S4, um alle Aktionen zu steuern, die auf einem niedrigen Logikpegel arbeiten. Zur Steuerung der Lasten wird die Transistorbaugruppe DD1 ULN2003 mit eingebauten Schutzdioden verwendet. Die Relais K1 und K2 sind mit den Stiften 16, 15 der Transistoranordnung verbunden, die LEDs zur Anzeige sind mit den Stiften 14-12 verbunden, die Stifte 11, 10 sind zum Verbinden mit externen Geräten gemäß dem Schema mit einem gemeinsamen Kollektor oder zusätzlichen Relais mit einer Spannung von +12 V der Wicklung ausgelegt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zur Spannungsmessung werden zwei Kanäle eines 10-Bit-ADC DD3 MCP3008 mit SPI-Schnittstelle und Tiefpassfilter verwendet. Der analoge Knoten wird primitiv für akademische Zwecke oder zum schnellen Debuggen erstellt. Wenn sich die Frage nach der qualitativen Messung eines analogen Signals stellt, müssen Sie die digitale und analoge Masse entkoppeln und eine externe Spannungsreferenzquelle verwenden. Alternativ kann der analoge Teil wie folgt ausgeführt werden: </font></font><br>
<br>
<img src="https://habrastorage.org/files/d8d/148/dee/d8d148deee074957a46ab433620aea05.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es muss nur der TTL → LVTTL-Pegelwandler am SPI-Bus verwendet werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Echtzeit-Takt DD4 wird auf dem DS1307-Chip hergestellt, und der Quarzresonator Q1 bei 32,768 kHz wird zum Takten verwendet. Eine in die Platine eingelötete 3-Volt-Lithiumbatterie wird zur Stromversorgung des RAM-Chips der Uhr verwendet. Die Mikroschaltung wird über einen 5V-3,3V-Pegelwandler, der an den MOS-Transistoren VT2, VT3 hergestellt ist, über den I2C-Bus mit dem Raspberry Pi verbunden (CAD verwendet Verbindung zu Leitungen ohne explizite Verbindung). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als UART → RS485-Treiber wurde der DD2 ST485-Chip verwendet. Schaltungslösungen unter Verwendung des Transistors VT1 ermöglichten es, einen separaten Ausgang zur Steuerung des Transceivers aufzugeben. Es wechselt nur in den Sendemodus, wenn der UART Daten sendet, der Rest der Zeit befindet sich ST485 im Empfangsmodus. Der Transceiver-Steuerbefehl wird vom Kollektor des Transistors VT1 entfernt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusätzlich zur Konvertierung der Schnittstellen erfüllt dieses Schema auch die Funktion, die LVTTL-Pegel der UART Raspberry Pi-Schnittstelle mit den TTL-Pegeln des ST485-Treibers abzugleichen. </font><font style="vertical-align: inherit;">Das vom Kollektor des Transistors VT1 aufgenommene Signal zieht den Pegel am DI-Eingang auf 5 V, und der Widerstand R16 und die Zenerdiode VD8 begrenzen den Pegel vom Ausgang R0 auf 3,3 V. </font><font style="vertical-align: inherit;">Achten Sie nicht auf den Widerstand R11, er blieb während des Debuggens im Stromkreis. </font><font style="vertical-align: inherit;">RS485 wird mit dem ModBus RTU-Protokoll bei 115200 Baud getestet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dementsprechend wurde eine Leiterplatte weiterentwickelt:</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ca/501/7a8/2ca5017a8cba4f22b49cb6c8ea588855.png"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3D-Modelle der Leiterplatte</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/0d3/058/62d/0d305862d003420aa0dfaa41f5a57d78.png"><br>
<img src="https://habrastorage.org/files/cbc/3d6/3b3/cbc3d63b39b44d2aa22887874155660c.bmp"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto des fertigen Geräts und Arbeit mit der Erweiterungskarte:</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/e60/3b4/9d7/e603b49d769b4fc1888d7350b9dbe63f.jpg"><br>
<br>
<img src="https://habrastorage.org/files/2fb/710/6e3/2fb7106e3cec47ea9de5b947ebc091ed.jpg"><br>
<br>
<img src="https://habrastorage.org/files/132/e3e/4d0/132e3e4d025a47ebb5a982e69ed7c213.jpg"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eine Variante des Verbindungsschemas mit externen Geräten: </font></font><br>
<img src="https://habrastorage.org/files/4bb/b2f/c3c/4bbb2fc3c13849398f32165e87ce506f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Knoten der Erweiterungskarte zu überprüfen, habe ich einige Skripte in Python verwendet (ich kenne diese Sprache nicht, habe ich durch Ausprobieren geschrieben und dabei die Codes von Spezialisten parallel betrachtet). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Spannung von einem Potentiometer zu messen, das an die ADC-Kanäle angeschlossen ist, habe ich ein einfaches geschrieben Skript:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MCP3008 Python-Quelle</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment"># Example program to read data from MCP3008 10 bit ADC</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spidev
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Open SPI bus</span></span><font></font>
spi = spidev.SpiDev()<font></font>
spi.open(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to read SPI data from MCP3008 chip</span></span>
<span class="hljs-comment"><span class="hljs-comment"># Channel must be an integer 0-7</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadChannel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(channel)</span></span></span><span class="hljs-function">:</span></span>
  adc = spi.xfer2([<span class="hljs-number"><span class="hljs-number">1</span></span>,(<span class="hljs-number"><span class="hljs-number">8</span></span>+channel)&lt;&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>])<font></font>
  data = ((adc[<span class="hljs-number"><span class="hljs-number">1</span></span>]&amp;<span class="hljs-number"><span class="hljs-number">3</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + adc[<span class="hljs-number"><span class="hljs-number">2</span></span>]
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Function to convert data to voltage level,</span></span>
<span class="hljs-comment"><span class="hljs-comment"># rounded to specified number of decimal places.</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ConvertVolts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data,places)</span></span></span><span class="hljs-function">:</span></span>
  volts = (data * <span class="hljs-number"><span class="hljs-number">3.3</span></span>) / float(<span class="hljs-number"><span class="hljs-number">1023</span></span>)<font></font>
  volts = round(volts,places)<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> volts<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define sensor channels</span></span>
first_channel = <span class="hljs-number"><span class="hljs-number">0</span></span>
second_channel  = <span class="hljs-number"><span class="hljs-number">1</span></span><font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment"># Define delay between readings</span></span>
delay = <span class="hljs-number"><span class="hljs-number">5</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span><font></font>
 <font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the first channel data</span></span><font></font>
  first_level = ReadChannel(first_channel)<font></font>
  first_channel_volts = ConvertVolts(first_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Read the second channel data</span></span><font></font>
  second_level = ReadChannel(second_channel)<font></font>
  second_channel_volts = ConvertVolts(second_level,<span class="hljs-number"><span class="hljs-number">2</span></span>)<font></font>
  <font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Print out results</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-string"><span class="hljs-string">"------------------------------------------------------"</span></span>
  print(<span class="hljs-string"><span class="hljs-string">"First ADC channel: {} ({}V)"</span></span>.format(first_level,first_channel_volts))<font></font>
  print(<span class="hljs-string"><span class="hljs-string">"Second ADC channel : {} ({}V)"</span></span>.format(second_level,second_channel_volts))<font></font>
 <font></font>
  <span class="hljs-comment"><span class="hljs-comment"># Wait before repeating loop</span></span><font></font>
  time.sleep(delay)<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das folgende Skript wurde für die Arbeit mit DS18B20-Thermometern verwendet:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DS18B20 Python-Quelle</font></font></b><div class="spoiler_text">   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a><br>
<pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Example program to read data from DS18B20</span></span>
<span class="hljs-comment"><span class="hljs-comment"># This code taken from</span></span>
<span class="hljs-comment"><span class="hljs-comment"># https://kropochev.com/?go=all/raspberry-pi-and-onewire-sensor/</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> glob
<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time<font></font>
<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-gpio'</span></span>)<font></font>
os.system(<span class="hljs-string"><span class="hljs-string">'modprobe w1-therm'</span></span>)<font></font>
<font></font>
base_dir = <span class="hljs-string"><span class="hljs-string">'/sys/bus/w1/devices/'</span></span>
device_folder = glob.glob(base_dir + <span class="hljs-string"><span class="hljs-string">'10*'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]<font></font>
device_file = device_folder + <span class="hljs-string"><span class="hljs-string">'/w1_slave'</span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp_raw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span>
    f = open(device_file, <span class="hljs-string"><span class="hljs-string">'r'</span></span>)<font></font>
    lines = f.readlines()<font></font>
    f.close()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lines<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_temp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span><font></font>
    lines = read_temp_raw()<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> lines[<span class="hljs-number"><span class="hljs-number">0</span></span>].strip()[<span class="hljs-number"><span class="hljs-number">-3</span></span>:] != <span class="hljs-string"><span class="hljs-string">'YES'</span></span>:<font></font>
        time.sleep(<span class="hljs-number"><span class="hljs-number">0.2</span></span>)<font></font>
        lines = read_temp_raw()<font></font>
    equals_pos = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>].find(<span class="hljs-string"><span class="hljs-string">'t='</span></span>)
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> equals_pos != <span class="hljs-number"><span class="hljs-number">-1</span></span>:<font></font>
        temp_string = lines[<span class="hljs-number"><span class="hljs-number">1</span></span>][equals_pos+<span class="hljs-number"><span class="hljs-number">2</span></span>:]<font></font>
        temp_c = float(temp_string) / <span class="hljs-number"><span class="hljs-number">1000.0</span></span>
        temp_f = temp_c * <span class="hljs-number"><span class="hljs-number">9.0</span></span> / <span class="hljs-number"><span class="hljs-number">5.0</span></span> + <span class="hljs-number"><span class="hljs-number">32.0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> temp_c, temp_f<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>:<font></font>
    print(read_temp())<font></font>
    time.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe auch die Einstellungen in Raspbian dokumentiert:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Geräte konfigurieren</font></font></b><div class="spoiler_text"><blockquote> — 1 Wire settings:<br>
 — Raspbian wheezy<br>
<br>
Enter command in console:<br>
pi@raspberrypi~$ sudo modprobe w1-gpio<br>
pi@raspberrypi~$ sudo modprobe w1_therm<br>
<br>
Then check sensor in system:<br>
pi@raspberrypi ~ $ sudo ls /sys/bus/w1/devices/w1_bus_master1/<br>
<br>
You can see the tabel below entered comman and<br>
there you should find HEX like 28-000002da8328; <br>
This is DS18B20 address;<br>
<br>
Next read the data from DS18B20 sensor using command:<br>
pi@raspberrypi ~ $ cat /sys/bus/w1/devices/w1_bus_master1/28-000002da8328/w1_sla <br>
<br>
And you are going see temperature in console like:<br>
6f 01 4b 46 7f ff 01 10 67: crc=67 YES<br>
6f 01 4b 46 7f ff 01 10 67 t=22937<br>
<br>
t=22937 — you should divide this number on 1000 and you will have temperature in Celsius;<br>
<br>
 — Raspbian Jezzy<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /boot/config.txt<br>
<br>
On next step you should write in config file <br>
dtoverlay=w1-gpio,gpiopin=4 <br>
dtoverlay=w1-gpio-pullup<br>
<br>
Then you should reboot your raspberry Pi;<br>
<br>
 — I2C Real Time Clock settings:<br>
 — Update your system if it needed and install i2c-tools:<br>
pi@raspberrypi~$ sudo apt-get update<br>
pi@raspberrypi~$ sudo apt-get -y upgrade<br>
pi@raspberrypi~$ sudo apt-get i2c-tools:<br>
<br>
Enter command:<br>
pi@raspberrypi~$ sudo nano /etc/modules<br>
Add these lines:<br>
i2c-bcm2708<br>
i2c-dev<br>
rtc_ds1307<br>
 <br>
Comment one line in file:<br>
pi@raspberrypi~$ sudo nano /etc/modprobe.d/raspi-blacklist.conf<br>
Add # Symbol in beginning of line<br>
<br>
blacklist i2c-bcm2708<br>
________________________________________________________<br>
Reboot system;<br>
Enter command:<br>
pi@raspberrypi~$ sudo lsmod<br>
<br>
You will see lines like:<br>
rtc_ds1307 7715 0<br>
i2c_dev 5277 0 <br>
i2c_bcm2708 4719 0<br>
________________________________________________________<br>
<br>
Get DS1307 address:<br>
pi@raspberrypi~$ sudo i2cdetect -y 1<br>
<br>
You will see table in console:<br>
<br>
0 1 2 3 4 5 6 7 8 9 a b c d e f<br>
00: — -- — -- — -- — -- — -- — -- — 10: — -- — -- — -- — -- — -- — -- — -- — --<br>
20: — -- — -- — -- — -- — -- — -- — -- — --<br>
30: — -- — -- — -- — -- — -- — UU — -- — --<br>
40: — -- — -- — -- — -- — -- — -- — -- — --<br>
50: — -- — -- — -- — -- — -- — -- — -- — --<br>
60: — -- — -- — -- — -- 68 — -- — -- — -- — 70: — -- — -- — -- — --<br>
 <br>
In address 0x3b some device without driver and 0x68 perhaps DS1307 clock address. <br>
<br>
Enter command:<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
<br>
Read clock:<br>
pi@raspberrypi~$ sudo hwclock -r<br>
<br>
Set time:<br>
pi@raspberrypi~$ sudo hwclock -w<br>
Set system time from RTC:<br>
pi@raspberrypi~$ sudo hwclock -s<br>
<br>
Automatic RTC start;<br>
Add lines in /etc/rc.local file<br>
<br>
echo ds1307 0x68 &gt; /sys/class/i2c-adapter/i2c-1/new_device<br>
sudo hwclock -s<br>
Before last line in file looks like:<br>
<br>
exit 0<br>
 — Uart settings:<br>
 — Back up files:<br>
cp /boot/cmdline.txt /boot/cmdline.bak<br>
cp /etc/inittab /etc/inittab.bak<br>
<br>
Delete «console=ttyAMA0,115200»  «kgdboc=ttyAMA0,115200» lines from configuration file:<br>
pi@raspberrypi~$ nano /boot/cmdline.txt<br>
<br>
Comment last line looks like «T0:23:respawn:/sbin/getty -L ttyAMA0 115200 vt100: in /etc/inittab file: using # symbol:<br>
pi@raspberrypi~$ nano /etc/inittab<br>
</blockquote><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Leiterplatte wurde dringend benötigt, deshalb habe ich sie selbst mit LUT-Technologie und ein paar Stunden Freizeit hergestellt. </font><font style="vertical-align: inherit;">Um die Arbeit zu erleichtern und Zeit zu sparen, wurde die Leiterplatte einseitig mit Steckbrücken von MGShV 0.5 hergestellt. </font><font style="vertical-align: inherit;">DipTrace-Schaltungs- und Leiterplattendesign, Testquellcodes, Liste der Komponenten und Lernprogramm mit Befehlen zur Konfiguration im </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Repository</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Im Video unten wird das allererste Simulationsboard verwendet. Es wurde in 20 Minuten auf einem Steckbrett mit Tasten und LEDs zusammengebaut. Die folgenden Versionen wurden auf seiner Basis angezeigt:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/5uCV_gNWw2Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de401089/">https://habr.com/ru/post/de401089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de401077/index.html">China wird 168 Millionen Dollar in Wolken investieren, damit im Nordwesten des Landes mehr Regen fällt</a></li>
<li><a href="../de401079/index.html">Offensichtlich: automatische Steuerung der Badezimmerbeleuchtung</a></li>
<li><a href="../de401083/index.html">Retroclocking: Was passiert, wenn das alte Eisen mit flüssigem Stickstoff und Helium "geknackt" wird?</a></li>
<li><a href="../de401085/index.html">Lakhta Terra Incognita: Der Kampf um die Nachhaltigkeit eines Wolkenkratzers</a></li>
<li><a href="../de401087/index.html">KI: Bluffen, Geld von der Bevölkerung nehmen und Unsicherheit besiegen</a></li>
<li><a href="../de401091/index.html">Im Jahr 2017 platzten 7 digitale Desktop-Produkte</a></li>
<li><a href="../de401093/index.html">Sony Xperia Ear Xea10: Sprachassistenten krochen in die Ohren</a></li>
<li><a href="../de401095/index.html">Was soll ich dir geben, mein lieber Mann?</a></li>
<li><a href="../de401097/index.html">Lernen Sie das neue Spektrum kennen</a></li>
<li><a href="../de401101/index.html">Gelöschte Dateien kehrten in Dropbox-Ordner zurück. Fehler behoben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>