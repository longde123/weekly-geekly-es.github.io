<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÉ ü§∂ üöì Fazendo um simples barco aero RC üö± üì∏ ‚ò¶Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√Äs vezes, na Internet, vejo perguntas de iniciantes que desejam construir um quadrocopter do zero e escrevemos firmware para ele. Eu mesmo sou assim e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Fazendo um simples barco aero RC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/390429/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Äs vezes, na Internet, vejo perguntas de iniciantes que desejam construir um quadrocopter do zero e escrevemos firmware para ele. </font><font style="vertical-align: inherit;">Eu mesmo sou assim e, para praticar a cria√ß√£o de modelos de RC, decidi come√ßar com algo mais simples. </font></font><br>
<br>
<img src="https://habrastorage.org/files/7dd/6f2/46e/7dd6f246e98e47b8b5f3eda1ccdd14b0.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No artigo em detalhes, ele descreveu o algoritmo do barco, o painel de controle e a escolha dos componentes.</font></font><br>
<a name="habracut"></a><br>
<h2> ?</h2><br>
<ol>
<li>;</li>
<li>;</li>
<li>     ;</li>
<li>     ,  -.</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ve√≠culos voadores √© √≥timo, mas dif√≠cil. </font><font style="vertical-align: inherit;">Voc√™ n√£o pode simplesmente desligar os parafusos no ar se algo der errado. </font><font style="vertical-align: inherit;">Sim, √© necess√°rio um impulso espec√≠fico muito decente, mesmo para aeronaves, para n√£o mencionar o multicopter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plataformas como esta </font></font><br>
<br>
<img src="https://habrastorage.org/files/2ea/857/305/2ea8573051be4afcbe6aaf40c94a753d.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h√°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uma descri√ß√£o mais detalhada aqui). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
eles s√≥ podem se mover, na maioria dos casos, uma superf√≠cie lisa artificial e seu controle √© muito diferente. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas na √°gua podemos navegar para qualquer lugar, o que no futuro pode nos dar a oportunidade de fazer o piloto autom√°tico usando GPS. </font><font style="vertical-align: inherit;">O design cl√°ssico com uma h√©lice √© complicado para mim pela unidade de sa√≠da do eixo da carca√ßa - n√£o consigo imaginar como ved√°-la. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais vantagens de um sistema de propuls√£o a ar:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode ser colocado em diferentes plataformas: um barco, tren√≥, um peda√ßo de espuma ...</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o pega no fundo ou nas algas.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â necess√°rio que o dispositivo possa girar. </font><font style="vertical-align: inherit;">Existem 3 op√ß√µes:</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um parafuso + volante para voltas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um parafuso + seu sistema de torneamento</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dois parafusos fixos. </font><font style="vertical-align: inherit;">Transformar mudando seus desejos √© a maneira mais f√°cil. </font><font style="vertical-align: inherit;">Ele usou isso.</font></font></li>
</ol><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controle remoto</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Princ√≠pio de opera√ß√£o</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 joystick + v√°rios interruptores. </font><font style="vertical-align: inherit;">A tarefa do controle remoto √© enviar dados sobre a posi√ß√£o da alavanca do joystick e alternar v√°rias vezes por segundo.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que fazer</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, voc√™ precisa de um transmissor de r√°dio. A op√ß√£o mais barata √© NRF24L01 +, custa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,85</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em segundo lugar, voc√™ precisa de um joystick. Mais </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
V√°rios switches - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 0,12</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, tudo isso √© fixado em um peda√ßo de PCB por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,13</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J√° contava US $ 2,1, mas ainda precisava de MK e comida. Tudo n√£o est√° t√£o claro aqui. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Olhando para o futuro, direi que ATmega8 ou STM8S103F3P6 √© suficiente, mas desde que iniciei este projeto por um longo tempo e havia pouca experi√™ncia, coloquei-o no painel de controle do Arduino Pro Mini e no barco Arduino Nano (ATmega32P em todos os lugares). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No controle remoto ainda necess√°rio:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conversor de energia 0,9 - 5 V -&gt; 5 V para alimentar o Arduino por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,35</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (o conector USB, juntamente com um peda√ßo da placa, pode ser quebrado por compacidade);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O estabilizador AMS1117-3.3 de 3.3V para alimentar o m√≥dulo de r√°dio, custa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,03 por unidade</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compartimento da bateria para a bateria de um dedo por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,15</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ;</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Total mais US $ 0,53. </font><font style="vertical-align: inherit;">Al√©m do controlador, um par de capacitores e fios, o custo dos componentes do console √© de US $ 2,63.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enchimento do modelo RC</font></font></h2><br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componentes</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo vem dos motores. </font><font style="vertical-align: inherit;">Quais motores voc√™ compra, os eletr√¥nicos precisam ser instalados com essa pot√™ncia e a base (embarca√ß√£o, tren√≥) ser√° necess√°ria para a capacidade de carga correspondente. </font><font style="vertical-align: inherit;">E ideologicamente, tudo o mais √© necess√°rio apenas para girar os parafusos na velocidade certa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comprei esses motores com h√©lices </font></font><br>
<br>
<img src="https://habrastorage.org/files/02a/811/047/02a8110476e840e68848408e6fcc4872.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 2,88 por par</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Levei o L293D como motorista - outros </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,35</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E ent√£o h√° um problema</font></font></b><div class="spoiler_text"> L293D         .                             ,   .<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Alimento. </font><font style="vertical-align: inherit;">Vamos precisar de at√© tr√™s tens√µes de alimenta√ß√£o:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 V para todos os componentes eletr√¥nicos, exceto o m√≥dulo de r√°dio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3,3 V para o m√≥dulo de r√°dio;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para motores tanto quanto eles precisam (mina 4,2 V).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1 e 2, temos o mesmo que no painel de controle e, nos motores, colocamos o MT3608 por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">US $ 0,86</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora a parte divertida: o girosc√≥pio. </font><font style="vertical-align: inherit;">O m√≥dulo MPU-6050 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">custa US $ 1,53</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Havia o desejo de tamb√©m usar o aceler√¥metro, para que, quando o manche do joystick se mova para o lado, o navio se desdobre no lugar. </font><font style="vertical-align: inherit;">Mas, no final, ele abandonou a ideia: uma ligeira inclina√ß√£o, e o sistema come√ßa a pensar que est√° acelerando para frente ou para tr√°s. </font><font style="vertical-align: inherit;">Acabou sendo mais f√°cil colocar o navio no lugar apenas compensando o movimento de avan√ßo / retrocesso com o joystick. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione a isso US $ 0,4 para o compartimento da bateria para 2 c√©lulas AA e obtenha componentes de US $ 6,4 sem um controlador e fios.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O programa</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E, novamente, vamos partir dos motores. </font><font style="vertical-align: inherit;">Cada um dos dois motores acionados pelo L293D pode </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ou n√£o escavar</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gire para a frente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gire para tr√°s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o tor√ßa.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para facilitar a leitura do c√≥digo, escreva </font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 fun√ß√µes</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{    <font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motLeftBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS;<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motRightBackward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  PORTD &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS);<font></font>
  PORTD |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora queremos controlar a velocidade de rota√ß√£o dos parafusos. </font><font style="vertical-align: inherit;">Obviamente, faremos isso usando o PWM. </font><font style="vertical-align: inherit;">N√£o sei se esse PWM pode ser feito em hardware ... fiz-o programaticamente em interrup√ß√µes. </font><font style="vertical-align: inherit;">Declarar um par de vari√°veis ‚Äã‚Äãglobais</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int8_t</span></span> motLeft = <span class="hljs-number"><span class="hljs-number">0</span></span>, motRight = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permita que os valores dessas vari√°veis ‚Äã‚Äã&lt;0 signifiquem que voc√™ precisa recuar, os valores&gt; 0 - avan√ßar e, se forem 0, n√£o precisar√° torcer.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos escrever manipuladores de interrup√ß√£o de timer</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">ISR(TIMER2_OVF_vect)<font></font>
{<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motLeft &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motLeftBackward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightForward();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motRight &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
    motRightBackward();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPA_vect)<font></font>
{<font></font>
  motLeftStop();<font></font>
}<font></font>
<font></font>
ISR(TIMER2_COMPB_vect)<font></font>
{<font></font>
  motRightStop();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, para alterar a velocidade de rota√ß√£o da h√©lice, precisamos executar 2 a√ß√µes:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Escreva um valor positivo, negativo ou zero em motLeft / motRight (o m√≥dulo n√£o √© importante);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Registre a "velocidade de rota√ß√£o" em OCR2A / OCR2B.</font></font></li>
</ol><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos escrever mais algumas fun√ß√µes para isso</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotLeft</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motLeft = v;  <font></font>
  OCR2A = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int8_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">// -127..+127</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRight = v;<font></font>
  OCR2B = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) * <span class="hljs-number"><span class="hljs-number">2</span></span>;<font></font>
}<font></font>
</code></pre><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v) &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;
</code></pre><br>
            OCR2x   5 (      ).<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora resta configurar os pinos MK e o timer</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motInit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<font></font>
  DDRD |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_LEFT_MINUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_PLUS) | (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; MOT_RIGHT_MINUS);
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(1 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1024.   16 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (1 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(0 &lt;&lt; CS20); // set up timer with prescaler = 64.   1 </span></span>
  TCCR2B |= (<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS22)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; CS21)|(<span class="hljs-number"><span class="hljs-number">0</span></span> &lt;&lt; CS20); <span class="hljs-comment"><span class="hljs-comment">// set up timer with prescaler = 8.  128 </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//TCCR2B |= (0 &lt;&lt; CS22)|(0 &lt;&lt; CS21)|(1 &lt;&lt; CS20); // set up timer with prescaler = 1.  16 </span></span>
  TIMSK2 |= (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; TOIE2)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2A)|(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; OCIE2B); <span class="hljs-comment"><span class="hljs-comment">// enable overflow interrupt</span></span>
  TCCR2A &amp;= ~(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM20 = 0, WGM21 = 0</span></span>
  TCCR2B &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// set WGM22 = 0</span></span>
  setMotLeft(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  setMotRight(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  sei();<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E voc√™ pode controlar os motores simplesmente chamando as fun√ß√µes setMotLeft (int8_t v) e setMotRight (int8_t v). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mas queremos controlar o barco errado! </font><font style="vertical-align: inherit;">Queremos dar comandos como "frente / tr√°s" e "direita / esquerda"! </font><font style="vertical-align: inherit;">E deixe-a descobrir que h√©lices ela precisa torcer para isso. </font><font style="vertical-align: inherit;">Al√©m disso, quero que o pr√≥prio barco compense o efeito de giro do vento, correntes e ... h√©lices tortas! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos agora do outro lado. </font><font style="vertical-align: inherit;">Do controle remoto. </font><font style="vertical-align: inherit;">No caso mais simples, o algoritmo de sua opera√ß√£o √© o seguinte:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ao ligar a alimenta√ß√£o, lembre-se da posi√ß√£o inicial do joystick;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No ciclo, leia a posi√ß√£o do joystick, subtraia a posi√ß√£o zero e envie dados para o barco.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nosso m√≥dulo de r√°dio suporta pacotes de at√© 32 bytes. </font><font style="vertical-align: inherit;">Para n√£o lembrar dos deslocamentos, usaremos o registro</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ControlStatus</span></span></span><span class="hljs-class">{</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span> x,y;<font></font>
}  controlStatus;<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como segue</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> packet[MAX_BUFF]; 
    <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(packet, <span class="hljs-number"><span class="hljs-number">0</span></span>, MAX_BUFF);    <font></font>
    controlStatus.x = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">1</span></span>) - x0;<font></font>
    controlStatus.y = (<span class="hljs-keyword"><span class="hljs-keyword">int16_t</span></span>)analogRead(<span class="hljs-number"><span class="hljs-number">0</span></span>) - y0;
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(packet, &amp;controlStatus, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    Mirf.send(packet);<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(Mirf.isSending()){;};
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No lado do receptor, declararemos exatamente o mesmo registro e </font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n√≥s vamos preench√™-lo</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs">  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (Mirf.dataReady()) { 
    <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> data[MAX_BUFF];<font></font>
    Mirf.getData(data);<font></font>
    <span class="hljs-built_in"><span class="hljs-built_in">memcpy</span></span>(&amp;controlStatus, data, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(controlStatus));<font></font>
    setMotRot(-controlStatus.x);<font></font>
    setMotForward(controlStatus.y); <font></font>
  }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nas fun√ß√µes setMotRot e setMotForward</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">escreva os valores nas vari√°veis ‚Äã‚Äãglobais motRot e motForward</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotRot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motRot = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMotForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(v)&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>) v = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  motForward = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)v;<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E vamos para o mais interessante. </font><font style="vertical-align: inherit;">Para como converter "vire √† esquerda a uma velocidade de 5 graus por segundo e avance um pouco!" </font><font style="vertical-align: inherit;">para "motor esquerdo 10% para tr√°s, direito 20% para frente!". </font><font style="vertical-align: inherit;">Muito foi escrito </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
sobre o que </font><font style="vertical-align: inherit;">s√£o os </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controladores PID</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Eu usei apenas dois componentes para rota√ß√£o:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Proporcional;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Integral.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E para avan√ßar e recuar, o regulador n√£o o usou. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos dar um exemplo:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> iDeltaRot = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motTick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> rot = getRotAvg(); <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> deltaRot = rot - motRot * rotMaxSpeed / <span class="hljs-number"><span class="hljs-number">512</span></span>;<font></font>
  iDeltaRot += deltaRot;<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult - deltaRot * rotMult - iDeltaRot * iDeltaRotMult, <font></font>
          motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motForward * forwardMult + deltaRot * rotMult + iDeltaRot * iDeltaRotMult;  <font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span> motMax = max(<span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motRight), <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(motLeft));
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(motMax &gt; <span class="hljs-number"><span class="hljs-number">127</span></span>){<font></font>
    motRight = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motRight * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
    motLeft  = (<span class="hljs-keyword"><span class="hljs-keyword">int32_t</span></span>)motLeft  * <span class="hljs-number"><span class="hljs-number">127</span></span> / motMax;<font></font>
  }<font></font>
  <font></font>
  setMotRight(motRight);<font></font>
  setMotLeft(motLeft);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O c√≥digo foi simplificado para se concentrar em partes importantes; o arquivo ter√° a vers√£o completa. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O que estamos fazendo aqui?</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculamos a diferen√ßa entre a velocidade real de rota√ß√£o do barco (podrid√£o) e a desejada (motRot * rotMaxSpeed);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculamos as velocidades de rota√ß√£o desejadas dos parafusos motRight e motLeft;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se as velocidades de rota√ß√£o desejadas excederem o m√°ximo poss√≠vel, reduzimos-as enquanto mantemos a rela√ß√£o entre elas;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chamamos setMotRight / setMotLeft j√° familiares para n√≥s.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© tudo! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© o algoritmo de controle completo do barco! </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© dif√≠cil? </font><font style="vertical-align: inherit;">Eu acho que n√£o. </font><font style="vertical-align: inherit;">Mas, no entanto, no decorrer dos testes e ajustes, surgiram muitos problemas que levariam a v√°rios acidentes se fosse uma aeronave. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Existem 4 coeficientes na fun√ß√£o descrita:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">forwardMult - sensibilidade ao movimento do joystick para frente / tr√°s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMaxSpeed ‚Äã‚Äã- a velocidade de rota√ß√£o desejada ao inclinar o joystick totalmente para a direita / esquerda;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rotMult - coeficiente do componente proporcional (quanto o desvio da velocidade de rota√ß√£o atual do desejado afeta a rota√ß√£o);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iDeltaRotMult - coeficiente do componente integral (quanto o desvio do √¢ngulo de rota√ß√£o atual do desejado afeta a rota√ß√£o).</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Esses coeficientes s√£o ajustados experimentalmente, e a rea√ß√£o do barco ao joystick e √†s influ√™ncias externas que se desdobram depender√° deles.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indica√ß√£o de status</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ao depurar / ajustar, haver√° confus√µes da s√©rie "por que o barco reage ao joystick do jeito que eu quero?". </font><font style="vertical-align: inherit;">Alguns pontos podem ser depurados exibindo informa√ß√µes de depura√ß√£o em um PC, mas seria mais conveniente entender o que est√° acontecendo no local. </font><font style="vertical-align: inherit;">No come√ßo, considerei duas op√ß√µes:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Laptop;</font></font></li>
<li><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LCD Nokia 5110</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/a23/fc5/65d/a23fc565d564418bad9c2ad6a1144f0c.jpg"><br>
</div></div></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As desvantagens de ambos s√£o compreens√≠veis: o laptop √© grande e desconfort√°vel para carregar com voc√™, e o monitor Nokia 5110 n√£o permitir√° que voc√™ exiba simultaneamente um grande n√∫mero de par√¢metros de status do barco. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fiz um cruzamento entre eles: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion Enhanced NX4827K043 - Gen√©rico 4.3 '' HMI Touch Display</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Gra√ßas √† tela de toque, voc√™ pode ajustar r√°pida e convenientemente os par√¢metros do barco em movimento. </font><font style="vertical-align: inherit;">Este √© um tipo de computador que consiste em:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontrolador GD32F103R8T6;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SDRAM Winbond W9864G6KH-6 (8 MB);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mem√≥ria flash Winbond W25Q256FVFG (32 MB, 100.000 ciclos de reescrita, o que √© muito bom);</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FPGA Altera MAX II EPM570T144C5N.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo na montagem √© assim (clic√°vel): </font><font style="vertical-align: inherit;">
Este computador / monitor √© uma caixa preta e √© voltado para interagir com uma pessoa. At√© o GPIO existente √© aprimorado para conectar bot√µes e indicadores. O </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">Conselho de Expans√£o</font></a><font style="vertical-align: inherit;"> confirma isso. Portanto, o uso do controlador interno como controle remoto de um barco (leitura do joystick, troca de dados com o m√≥dulo de r√°dio NRF24L01 +) falhar√°. Para interagir com o microcontrolador, existe o UART e ... √© tudo. </font><font style="vertical-align: inherit;">
Sobre como e o que pode ser feito usando essa tela, est√° escrito um monte de + existem v√≠deos no Youtube. Veja, por exemplo, </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">este</font></a></font><br>
<br>
<a href=""><img src="https://habrastorage.org/files/b78/b67/ad2/b78b67ad2ffd4f00a0e82daae979dad8.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><br>
<br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- tudo √© mostrado claramente l√°. </font><font style="vertical-align: inherit;">Mas como essa tela √© mais cara do que todos os outros componentes do barco e do console combinados, descreverei mais detalhadamente minhas impress√µes sobre como trabalhar com ela. </font><font style="vertical-align: inherit;">Talvez isso ajude algu√©m a entender se essa op√ß√£o √© adequada para ele ou se o laptop / monitor Nokia 5110 ser√° prefer√≠vel. </font><font style="vertical-align: inherit;">Vantagens do Nextion Enhanced NX4827K043:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muito f√°cil de usar. </font><font style="vertical-align: inherit;">H√° documenta√ß√£o simples, exemplos, v√≠deos no Youtube, ... Em algumas horas voc√™ pode descobrir do zero. </font><font style="vertical-align: inherit;">Quase tudo o que voc√™ precisa saber sobre ele est√° em duas p√°ginas: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p√°gina wiki</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">conjunto de instru√ß√µes</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desenvolvimento muito r√°pido. </font><font style="vertical-align: inherit;">Um editor visual como o Visual Studio (apenas mais f√°cil). </font><font style="vertical-align: inherit;">Joguei componentes e tudo funciona.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Componentes de alta qualidade. </font><font style="vertical-align: inherit;">A mesma mem√≥ria flash para 100k ciclos de reescrita.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um depurador que pode simular uma exibi√ß√£o usando um PC e se comunicar com o seu MK atrav√©s de uma porta COM. </font><font style="vertical-align: inherit;">Permite que voc√™ desenvolva totalmente o dispositivo, depure e compre um monitor, apenas se tudo der certo.</font></font><div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Embora haja um problema com ele</font></font></b><div class="spoiler_text">            .    . ,         ,         .<br>
</div></div></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sensor Resistivo </font><font style="vertical-align: inherit;">Voc√™ pode criar controles bastante pequenos e cutuc√°-los com a unha ou com qualquer caneta.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desvantagens:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pre√ßo </font><font style="vertical-align: inherit;">$ 50 ainda √© muito para uma tela de 4,3 ''.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem poucos componentes existentes, poucas configura√ß√µes de componentes, como criar o seu pr√≥prio n√£o √© claro. </font><font style="vertical-align: inherit;">Isso √© parcialmente compensado pelas fun√ß√µes de desenhar primitivas (linhas, ret√¢ngulos, c√≠rculos, ...).</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O componente padr√£o do Gauge pisca quando atualizado.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o (pelo menos n√£o encontrei) transpar√™ncia.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Requisitos de energia: 4,75-7 V e corrente m√©dia 250 mA. </font><font style="vertical-align: inherit;">Quando a tens√£o cai, o visor come√ßa a piscar.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apenas UART. </font><font style="vertical-align: inherit;">Poderia se comunicar com ele no SPI e I¬≤C.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sa√≠da GPIO apenas para um loop (sem pente de 2,54 mm), sem ADC.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, a tela d√° a impress√£o de um produto de alta qualidade, f√°cil e agrad√°vel de trabalhar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A tela pode executar duas tarefas ao mesmo tempo:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indica√ß√£o de status. </font><font style="vertical-align: inherit;">Estou interessado principalmente em:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Velocidades de rota√ß√£o" dos parafusos;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O valor da vari√°vel iDeltaRot √© o quanto o √¢ngulo de viragem desejado difere do desejado;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Velocidade de rota√ß√£o do barco;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Çngulo de rota√ß√£o do barco;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frequ√™ncia de recebimento de pacotes do controle remoto;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A frequ√™ncia das chamadas para a fun√ß√£o motTick.</font></font></li>
</ul><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par√¢metros de configura√ß√£o, especificamente os descritos acima, forwardMult, rotMaxSpeed, rotMult, iDeltaRotMult.</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Foram feitas 2 p√°ginas (clic√°veis ‚Äã‚Äãpara avalia√ß√£o da qualidade):</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indica√ß√µes:</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/6f7/aaa/571/6f7aaa57152e48a5b92e6555d230d863.JPG"></a><br>
</li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configura√ß√µes dos par√¢metros: </font><font style="vertical-align: inherit;">
primeiras 4 colunas da esquerda para a direita: forwardMult, rotMult, iDeltaRotMult, rotMaxSpeed.</font></font><br>
 <br>
<a href=""><img src="https://habrastorage.org/files/256/9f6/22d/2569f622dc234426b0dc8d4352a8488e.JPG"></a><br>
<br><font style="vertical-align: inherit;"></font><br>
</li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Barco de teste de v√≠deo no ch√£o:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kwHMI4QUjIs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A rea√ß√£o do barco a um efeito de desdobramento externo em v√°rios iDeltaRotMult (coeficientes integrais):</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3numZhKZnic" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Demonstra√ß√£o da influ√™ncia dos par√¢metros na √°gua:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/QuOtIunGEME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o foi poss√≠vel capturar o v√≠deo em √°guas abertas. </font><font style="vertical-align: inherit;">Voc√™ pode acreditar que seu manuseio √© bom e a velocidade m√°xima n√£o √© muito.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caracter√≠sticas</font></font></h2><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haste 9 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Peso 115 g, das quais baterias pesam 52 g;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A acelera√ß√£o m√°xima √© de 0,77 m / s ^ 2. </font><font style="vertical-align: inherit;">Para humanos 5 km / h, se n√£o houvesse resist√™ncia √† √°gua, o barco aceleraria em 1,8 s;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O custo dos componentes √© de cerca de US $ 15 se voc√™ usar o Arduino Nano no controle remoto e no barco (sem tela e baterias).</font></font></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para aqueles que desejam coletar algo controlado por r√°dio, recomendo come√ßar com uma embarca√ß√£o com duas h√©lices fixas. </font><font style="vertical-align: inherit;">Na minha opini√£o, isso √© a coisa mais simples que pode ser feita nessa √°rea. </font></font><br>
<br>
<a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arquivar com projetos</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
E, finalmente, para ter algo pelo que se esfor√ßar, aqui est√° um v√≠deo de um dispositivo incr√≠vel:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/_iqqHAWJq_0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt390429/">https://habr.com/ru/post/pt390429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt390419/index.html">Conecte a matriz de LED ao Raspberry pi</a></li>
<li><a href="../pt390421/index.html">R√°dio stick DVB de US $ 8 - explorando SDR com GNURadio</a></li>
<li><a href="../pt390423/index.html">A cl√°usula de apocalipse zumbi da Amazon foi adicionada √†s pol√≠ticas de servi√ßos da Web da Amazon</a></li>
<li><a href="../pt390425/index.html">Rob√¥s aprenderam a cozinhar ramen, mudar sua cor e tamanho</a></li>
<li><a href="../pt390427/index.html">Depura√ß√£o de c√≥digo do Arduino (AVR). Parte 1. Depura√ß√£o Virtual</a></li>
<li><a href="../pt390431/index.html">Projetores dom√©sticos Epson EH-TW5210, EH-TW5300 e EH-TW5350 - melhores, mais r√°pidos, mais brilhantes</a></li>
<li><a href="../pt390435/index.html">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –∫–∞—Ä—Ç—É —Å–≤—è–∑–µ–π –≤–æ –≤—Å–µ–ª–µ–Ω–Ω–æ–π ¬´–ó–≤–µ–∑–¥–Ω—ã—Ö –≤–æ–π–Ω¬ª</a></li>
<li><a href="../pt390437/index.html">Alt√≠metro-vari√¥metro eletr√¥nico caseiro com sinais de aviso sonoro e luminoso</a></li>
<li><a href="../pt390439/index.html">Reflex√µes de Andreev entre bandas espelhadas sobre os contatos de van der Waals entre grafeno e seleneto de ni√≥bio</a></li>
<li><a href="../pt390441/index.html">Eclipse #include <Arduino.h></a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>