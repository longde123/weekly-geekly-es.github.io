<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÇ üí∞ üìû La patience et le travail vont extraire tout le texte üë©üèΩ‚Äçü§ù‚Äçüë®üèª ü§≠ ‚è∏Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendant la session de formation (mai-juin et d√©cembre-janvier), les utilisateurs nous demandent de v√©rifier les emprunts de 500 documents par minute. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La patience et le travail vont extraire tout le texte</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/458842/"><p>  Pendant la session de formation (mai-juin et d√©cembre-janvier), les utilisateurs nous demandent de v√©rifier les emprunts de 500 documents par minute.  Les documents sont pr√©sent√©s dans des fichiers de diff√©rents formats, la complexit√© de travailler avec chacun d'eux √©tant diff√©rente.  Pour v√©rifier l'emprunt d'un document, nous devons d'abord extraire son texte du fichier, et en m√™me temps g√©rer le formatage.  La t√¢che consiste √† mettre en ≈ìuvre une extraction de haute qualit√© d'un demi-millier de textes avec une mise en forme par minute, tout en tombant rarement (ou mieux ne tombant pas du tout), consommant peu de ressources et ne payant pas la moiti√© du budget galactique pour le d√©veloppement et le fonctionnement de l'id√©e finale. </p><br><p>  Oui, oui, bien s√ªr, nous savons que sur trois choses - rapidement, √† moindre co√ªt et efficacement - vous devez en choisir deux.  Mais le plus m√©chant, c'est que dans notre cas, nous ne pouvons rien supprimer.  La question est de savoir dans quelle mesure nous l'avons fait ... </p><br><p><img src="https://habrastorage.org/webt/us/nu/t4/usnut4dlt0wwlqzbkwhnmlud1uo.png"></p><br><p>  <sub><em>Source de l'image: <a href="">Wikipedia</a></em></sub> <br></p><p><a name="habracut"></a></p><br><p>  On nous dit souvent que le sort des gens d√©pend de la qualit√© de notre travail.  Par cons√©quent, vous devez √©duquer en vous les perfectionnistes.  Bien s√ªr, nous am√©liorons constamment la qualit√© du syst√®me (dans tous les aspects), car les auteurs sans scrupules trouvent de nouvelles fa√ßons de contourner le probl√®me.  Et j'esp√®re que le jour est proche o√π la complexit√© de la tromperie, d'une part, et le sentiment de satisfaction d'un travail bien fait, d'autre part, inciteront la grande majorit√© des √©tudiants √† abandonner leur d√©sir bien-aim√© de s'amuser.  Dans le m√™me temps, nous comprenons que le prix de l'erreur peut √™tre la souffrance possible de personnes innocentes si nous la simulons soudainement. </p><br><p>  Pourquoi suis-je?  Si nous √©tions perfectionnistes, nous aborderions avec attention la r√©daction d'une s√©rie d'articles sur le travail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du syst√®me anti-plagiat</a> .  Nous √©laborerions minutieusement un plan de publication pour √©noncer tout de la mani√®re la plus logique et attendue pour le lecteur: </p><br><ul><li>  Tout d'abord, nous parlerions de la structure de notre syst√®me (la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cinqui√®me publication</a> sur Habr√©) et d√©cririons les trois √©tapes principales du traitement d'un document lorsqu'il est v√©rifi√© pour l'emprunt: <br><ol><li>  Extraire le texte du document (vous √™tes ici!); </li><li>  Recherche de pr√™ts (des pi√®ces sont d√©j√† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans plusieurs de nos articles</a> ); </li><li>  Construire un rapport sur le document (en plans). </li></ol></li><li>  En outre, nous commencerions √† consacrer le lecteur au dispositif de m√©canismes auxiliaires int√©ressants, tels que la recherche d'emprunts transf√©rables ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premier article</a> ), la d√©finition de la paraphrase ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quatri√®me</a> ) et la classification th√©matique ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deuxi√®me</a> ). </li><li>  Et enfin, nous sommes arriv√©s au moteur de recherche - l'indice des bardeaux ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">septi√®me article</a> ). </li></ul><br><p> Un lecteur attentif doit avoir remarqu√© que nous ne souffrons toujours pas d'un perfectionnisme excessif, il est donc temps de passer √† la premi√®re √©tape - extraire du texte et formater des documents.  C'est ce que nous ferons aujourd'hui, en r√©fl√©chissant √† la mortalit√© de l'√™tre et √† la lumi√®re au bout du tunnel, √† la non-existence de quelque chose d'id√©al et √† la poursuite de l'excellence, √† avoir un plan et √† le suivre et aux compromis que la vie nous incline toujours. </p><br><h1>  Au d√©but √©tait le mot </h1><br><p>  Dans un premier temps, nous n'avons extrait des documents que les √©l√©ments les plus n√©cessaires √† leur v√©rification d'emprunt - le texte des documents eux-m√™mes.  Les principaux formats ont √©t√© pris en charge - docx, doc, txt, pdf, rtf, html.  Ensuite, les ppt, pptx, odt, epub, fb2, djvu les moins courants ont √©t√© ajout√©s, mais il √©tait <abbr title="La tr√®s faible demande ne justifiant pas les efforts consacr√©s √† la prise en charge de ces formats">n√©cessaire de refuser de</abbr> travailler avec la plupart d'entre eux <abbr title="La tr√®s faible demande ne justifiant pas les efforts consacr√©s √† la prise en charge de ces formats">√† l'avenir</abbr> .  Chacun d'eux a √©t√© trait√© √† sa mani√®re - quelque part dans une biblioth√®que s√©par√©e, quelque part dans son propre analyseur.  En moyenne, l'extraction de texte a dur√© environ des centaines de millisecondes.  Il semblerait que la principale et presque la seule difficult√© √† extraire du texte soit l '¬´analyse¬ª du format lui-m√™me, ce qui est particuli√®rement vrai pour les formats binaires pdf et doc (et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nature exclusive de ce</a> dernier rend son utilisation encore plus probl√©matique).  Cependant, d√©j√† √† ce stade, lorsque nos d√©sirs se limitaient √† l'extraction du texte, il devenait clair que toute fa√ßon de lire les formats dont nous avions besoin comportait un certain nombre de caract√©ristiques d√©sagr√©ables.  Les plus importants d'entre eux: </p><br><ul><li>  Les exceptions sont m√™me lors du traitement de certains documents valides, sans parler du traitement de documents ¬´cass√©s¬ª mal form√©s.  Ce qui cr√©e encore plus de probl√®mes, c'est que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le code natif</a> peut tomber et g√©rer de telles situations dans le code .net est difficile; </li><li>  Consommation de m√©moire insuffisamment √©lev√©e, ce qui peut nuire √† la fois aux processus voisins et √† l'actuel traitant le document ¬´probl√®me¬ª (m√©moire insuffisante dans le code manag√© ou non manag√©); </li><li>  Traitement trop long du document, qui est exacerb√© par le manque de m√©canismes d'annulation pour la plupart des biblioth√®ques, et parfois par la complexit√© (lire: presque impossible) d'annuler un appel de code non g√©r√© √† partir d'un appel g√©r√©; </li><li>  "Extraction de texte √† partir de documents."  G√©n√©rer le texte d'un document pdf (et ce format est la cl√© pour nous), dont l'analyse a d√©j√† √©t√© effectu√©e, contrairement aux attentes, est une t√¢che non triviale.  Le fait est que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le format pdf a</a> √©t√© initialement d√©velopp√© principalement pour la pr√©sentation √©lectronique des supports d'impression.  Le texte dans les fichiers PDF est un ensemble de blocs de texte situ√©s sur les pages d'un document.  De plus, le bloc peut √™tre un paragraphe de texte ou un seul caract√®re.  La t√¢che de restaurer le texte dans sa forme originale √† partir de cet ensemble de blocs incombe √† la biblioth√®que (code / programme) qui lit le document.  Oui, le format, √† partir d'une certaine version de celui-ci, permet de sp√©cifier l'ordre des blocs, mais, malheureusement, les documents avec une s√©quence marqu√©e de blocs de texte sont rares.  Par cons√©quent, les biblioth√®ques de lecture de texte pdf contiennent un certain nombre d'heuristiques (enfin, c'est standard ici: apprentissage automatique, <s>bigdata, blockchain</s> , ...) qui vous permettent de restaurer le texte sous la forme correcte avec un degr√© ou un autre, et, comme pr√©vu, le r√©sultat obtenu diff√®re d'une biblioth√®que √† l'autre. . </li></ul><br><p><img src="https://habrastorage.org/webt/nr/hu/jb/nrhujbad4ji9xkwm5qzajzmvq24.png"></p><br><p>  <sub><em>Source de l'image du bas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a></em></sub> </p><br><p>  <sub><em>Source de l'image sup√©rieure: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hmm ...</a></em></sub> </p><br><h1>  Besoin de plus de donn√©es! </h1><br><p>  Si, pour analyser un document √† emprunter, l'arri√®re-plan textuel du document nous a suffi, la mise en ≈ìuvre d'un certain nombre de nouvelles fonctionnalit√©s est impossible ou tr√®s difficile sans extraire des donn√©es suppl√©mentaires du document.  Aujourd'hui, en plus de l'arri√®re-plan du texte, nous extrayons √©galement la mise en forme des documents et le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rendu des</a> images de page.  Nous utilisons ce dernier pour la reconnaissance optique de texte ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OCR</a> ), ainsi que pour identifier certains types de contournements. </p><br><p>  Le formatage d'un document comprend la disposition g√©om√©trique de tous les mots et caract√®res des pages, ainsi que la taille de police de tous les caract√®res.  Ces informations nous permettent de: </p><br><ul><li>  Affichez magnifiquement le rapport de v√©rification du document, en dessinant les emprunts d√©tect√©s directement sur le document d'origine; <br><img src="https://habrastorage.org/webt/hk/uo/am/hkuoamt7hjscszy6lcgoc4vjeoy.png"><br></li><li>  D√©terminer avec plus de pr√©cision les blocs de documents (page de titre, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bibliographie</a> ) et r√©cup√©rer ses m√©tadonn√©es (auteurs, titre du poste, ann√©e et lieu de travail, etc.); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">D√©tectez les tentatives de contournement du syst√®me.</a> </li></ul><br><p>  Pour unifier le traitement des documents et un ensemble de donn√©es extraites, nous convertissons les documents de tous les formats pris en charge par nous en pdf.  Ainsi, la proc√©dure d'extraction des donn√©es du document se d√©roule en deux √©tapes: </p><br><ul><li>  Convertissez un document en pdf; </li><li>  Extraire les donn√©es du pdf. </li></ul><br><h1>  Convertissez en pdf.  S√©lection de la biblioth√®que </h1><br><p>  Puisqu'il n'est pas si facile de prendre et de convertir un document en pdf, nous avons d√©cid√© de ne pas r√©inventer la roue et d'explorer des solutions toutes faites, en choisissant la plus appropri√©e pour nous.  C'√©tait en 2017. </p><br><p>  Crit√®res de s√©lection des candidats: </p><br><ul><li>  Biblioth√®que sur .net, id√©alement .net core et multiplateforme <div class="spoiler">  <b class="spoiler_title">Spoiler!</b> <div class="spoiler_text">  En cons√©quence, √† ce moment-l√†, l'id√©al √©tait inaccessible </div></div></li><li>  Prise en charge des formats requis - doc, docx, rtf, odf, ppt, pptx </li><li>  La stabilit√© </li><li>  Performances </li><li>  Qualit√© du support technique </li><li>  Prix ‚Äã‚Äãd'√©mission </li></ul><br><p>  Nous avons analys√© les solutions disponibles, en s√©lectionnant parmi elles les 6 plus adapt√©es √† nos missions: </p><br><div class="scrollable-table"><table><tbody><tr><th>  La biblioth√®que </th><th>  Probl√®mes de surface </th></tr><tr><td>  MS Word.  Interop </td><td>  <b>Requiert:</b> MS Word.  Appelez Microsoft Word via COM.  La m√©thode pr√©sente de nombreux inconv√©nients: besoin de MS Word install√©, instabilit√©, performances m√©diocres.  Il existe des restrictions de licence. </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevExpress (17)</a> </td><td>  Ne prend pas en charge ppt, pptx </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Groupdocs</a> </td><td>  - </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Syncfusion</a> </td><td>  Ne prend pas en charge ppt, pptx, odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Neevia Document Converter Pro</a> </td><td>  Requiert: MS Word.  Ne prend pas en charge odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dynamicpdf</a> </td><td>  N√©cessite: MS Word, Internet Explorer.  Ne prend pas en charge odt </td></tr></tbody></table></div><br><p>  MS Word Interop, Neevia Document Converter Pro et DynamicPdf n√©cessitent l'installation de MS Office en production, ce qui pourrait enfin et irr√©vocablement nous lier √† Windows.  Par cons√©quent, nous n'avons plus envisag√© ces options. </p><br><p>  Ainsi, il nous reste trois candidats principaux, et un seul d'entre eux prend enti√®rement en charge tous les formats dont nous avons besoin.  Eh bien, il est temps de voir de quoi ils sont capables. </p><br><p>  Pour tester les biblioth√®ques, nous avons form√© un √©chantillon de 120 000 documents utilisateurs r√©els, le ratio des formats dans lequel correspond approximativement ce que nous voyons chaque jour en production. </p><br><p>  Donc, le premier tour.  Voyons quelle proportion de documents peut √™tre convertie avec succ√®s en biblioth√®ques pdf √† l'√©tude.  Avec succ√®s, dans notre cas, il ne s'agit pas de lever une exception, de respecter le d√©lai d'expiration de 3 minutes et de renvoyer un texte non vide. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertisseur </th><th rowspan="2">  R√©ussi (%) </th><th colspan="5">  Pas r√©ussi (%) </th></tr><tr><th>  Total </th><th>  Texte vierge </th><th>  Exception </th><th>  D√©lai d'attente (3 minutes) </th><th>  Chute de processus </th></tr><tr><td>  Groupdocs </td><td>  99.012 </td><td>  0,988 </td><td>  0,039 </td><td>  0,873 </td><td>  0,076 </td><td>  0 </td></tr><tr><td>  DevExpress </td><td>  99,819 </td><td>  0,181 </td><td>  0,123 </td><td>  0,019 </td><td>  0,039 </td><td>  0 </td></tr><tr><td>  Syncfusion </td><td>  98,358 </td><td>  1,632 </td><td>  0,039 </td><td>  0,848 </td><td>  0,745 </td><td>  0,01 </td></tr></tbody></table></div><br><p>  Syncfusion s'est imm√©diatement d√©marqu√©, qui a non seulement r√©ussi √† traiter le plus petit nombre de documents, mais a √©galement vid√© l'ensemble du processus sur certains documents (en g√©n√©rant des exceptions telles que OutOfMemoryException ou des exceptions du code natif qui n'ont pas √©t√© d√©tect√©es sans danser avec un tambourin). </p><br><p>  GroupDocs n'a pas r√©ussi √† traiter environ <b>5,5</b> fois plus de documents que DevExpress (tout peut √™tre vu sur la plaque ci-dessus).  Ceci malgr√© le fait qu'une licence de d√©veloppeur unique de GroupDocs co√ªte environ 9 fois plus cher qu'une licence de d√©veloppeur unique de DevExpress.  Il en est ainsi d'ailleurs. </p><br><p>  Le deuxi√®me test s√©rieux est le temps de conversion, les m√™mes 120 000 documents: </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertisseur </th><th>  Moyenne (sec.) </th><th>  M√©diane (sec.) </th><th>  Std (sec.) </th></tr><tr><td>  Groupdocs </td><td>  1.301966 </td><td>  0,328000 </td><td>  6.401197 </td></tr><tr><td>  DevExpress </td><td>  0,523453 </td><td>  0,252000 </td><td>  1,781898 </td></tr><tr><td>  Syncfusion </td><td>  8.922892 </td><td>  4.987000 </td><td>  12.929588 </td></tr></tbody></table></div><br><img src="https://habrastorage.org/webt/g5/2h/3k/g52h3klfh-leliffdwmrtmgapxy.png"><br><br><p>  Notez que DevExpress non seulement traite les documents plus rapidement en moyenne, mais affiche √©galement un temps de traitement beaucoup plus stable. </p><br><p>  Mais la stabilit√© et la vitesse de traitement ne signifient rien si la sortie est mauvaise pdf.  Peut-√™tre que DevExpress saute la moiti√© du texte?  Nous v√©rifions.  Ainsi, les m√™mes 120 000 documents, cette fois-ci, nous calculerons le volume total du texte extrait et la part moyenne des mots du dictionnaire (plus les mots extraits sont dictionnaire, moins les d√©chets / texte extrait incorrectement): </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertisseur </th><th>  La quantit√© totale de texte (en caract√®res) </th><th>  La proportion moyenne de mots de vocabulaire </th></tr><tr><td>  Groupdocs </td><td>  6 321 145 966 </td><td>  0,949172 </td></tr><tr><td>  DevExpress </td><td>  6 135 668 416 </td><td>  0,950629 </td></tr><tr><td>  Syncfusion </td><td>  5 995 008 572 </td><td>  0,938693 </td></tr></tbody></table></div><br><p>  En partie, l'hypoth√®se √©tait correcte.  Il s'est av√©r√© que GroupDocs, contrairement √† DevExpress, peut fonctionner avec des notes de bas de page.  DevExpress les ignore simplement lors de la conversion d'un document en pdf.  Par ailleurs, oui, le texte du pdf'ok re√ßu est extrait dans tous les cas √† l'aide de DevExpress'a. </p><br><p>  Ainsi, nous avons √©tudi√© la vitesse et la stabilit√© des biblioth√®ques en question, maintenant nous √©valuons soigneusement la qualit√© de la conversion des documents pdf.  Pour ce faire, nous analyserons non seulement le volume du texte √† extraire et la proportion de mots du dictionnaire, mais nous comparerons les textes extraits des pdfs re√ßus avec les textes pdf obtenus √† l'aide de MS Word.  Nous acceptons le r√©sultat de la conversion d'un document en utilisant MS Word comme <i>pdf de r√©f√©rence</i> .  Environ 4 500 paires de ¬´ <i>document, r√©f√©rence pdf'ka</i> ¬ª ont √©t√© pr√©par√©es pour ce test. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertisseur </th><th rowspan="2">  <abbr title="Pourcentage de documents que la biblioth√®que a pu extraire">Texte extrait (%)</abbr> </th><th colspan="3">  Proximit√© de la longueur du texte </th><th colspan="3">  Proximit√© par fr√©quence de mots </th></tr><tr><th>  Moyenne </th><th>  M√©diane </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SKO</a> </th><th>  Moyenne </th><th>  M√©diane </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SKO</a> </th></tr><tr><td>  Groupdocs </td><td>  99.131 </td><td>  0,985472 </td><td>  0,999756 </td><td>  0,095304 </td><td>  0,979952 </td><td>  1,000000 </td><td>  0,102316 </td></tr><tr><td>  DevExpress </td><td>  99,726 </td><td>  0,971326 </td><td>  0.996647 </td><td>  0,075951 </td><td>  0,965686 </td><td>  0.996101 </td><td>  0,082192 </td></tr><tr><td>  Syncfusion </td><td>  89,336 </td><td>  0,880229 </td><td>  0.996845 </td><td>  0,306920 </td><td>  0,815760 </td><td>  0.998206 </td><td>  0,3448621 </td></tr></tbody></table></div><br><p>  Pour chaque paire ¬´ <i>pdf de r√©f√©rence, r√©sultat de conversion</i> ¬ª, nous avons calcul√© la similitude dans la longueur du texte extrait et dans les fr√©quences des mots extraits.  Naturellement, ces mesures n'ont √©t√© obtenues que dans les cas o√π la conversion a r√©ussi.  Par cons√©quent, nous ne consid√©rons pas les r√©sultats de Syncfusion ici.  DevExpress et GroupDocs ont montr√© √† peu pr√®s les m√™mes performances.  Du c√¥t√© DevExpress, il y a un pourcentage significativement plus √©lev√© de conversions r√©ussies, du c√¥t√© GD, un travail correct avec les notes de bas de page. </p><br><p>  Compte tenu des r√©sultats, le choix √©tait √©vident.  √Ä ce jour, nous utilisons la solution de DevExpress et nous pr√©voyons bient√¥t de passer √† sa 19e version. </p><br><h1>  Il y a un pdf, extraire le texte avec mise en forme </h1><br><p>  Ainsi, nous pouvons convertir des documents en pdf.  Nous avons maintenant une autre t√¢che: utiliser DevExpress pour extraire le texte, conna√Ætre √† chaque mot toutes les informations dont nous avons besoin.  √Ä savoir: </p><br><ul><li>  Sur quelle page se trouve le mot; </li><li>  L'emplacement du mot sur la page (encadrement d'un rectangle); </li><li>  La taille de police du mot (caract√®res du mot). </li></ul><br><p>  L'image montre la r√©partition du texte en pages et montre √©galement la correspondance d'un mot de texte avec la zone de page. </p><br><p><img src="https://habrastorage.org/webt/sv/zy/ja/svzyjafy1nmstmlbblte4uhdpwg.png"></p><br><p>  <sub><em>Source de l'image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extraction des m√©tadonn√©es d'en-t√™te √† partir de documents scientifiques</a></em></sub> </p><br><p>  Il semblerait que tout devrait √™tre simple.  Nous regardons ce que l'API DevExpress nous fournit: </p><br><ul><li>  Nous avons une m√©thode qui retourne le texte de tout le document.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cha√Æne</a> simple; </li><li>  Nous avons la possibilit√© d'it√©rer selon le document.  Pour chaque mot, nous pouvons obtenir: <br><ul><li>  Texte du mot; </li><li>  La page sur laquelle se trouve le mot; </li><li>  Le rectangle de cadrage du mot; </li><li>  Informations sur les caract√®res individuels du mot (signification du caract√®re encadrant le rectangle, taille de police, ...). </li></ul><br></li></ul><br><p>  D'accord, tout semble √™tre l√†.  Voici seulement comment obtenir les donn√©es n√©cessaires pour chaque mot dans le texte du document renvoy√© par DevExpress?  Nous ne voulons pas vraiment collecter le texte du document √† partir des mots nous-m√™mes, car, par exemple, nous n'avons pas d'informations l√† o√π il y a juste un espace entre les mots et o√π se trouve le saut de ligne.  Nous devrons trouver une heuristique bas√©e sur l'emplacement des mots ... Le texte est - le voici, devant nous, d√©j√† assembl√©. </p><br><p><img src="https://habrastorage.org/webt/ti/d9/ru/tid9ruengnw06fe0krbvfqbpfle.jpeg"></p><br><p>  <sub><em>Source de l'image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Eureka!</a></em></sub> </p><br><p>  La solution √©vidente consiste √† faire correspondre les mots avec le texte du document.  Nous regardons - en effet, dans le texte du document les mots sont dispos√©s dans le m√™me ordre dans lequel ils sont renvoy√©s par l'it√©rateur selon les mots du document. </p><br><p>  Nous impl√©mentons rapidement un algorithme simple pour faire correspondre les mots avec le texte du document, ajoutons des v√©rifications que tout est correctement mis en correspondance, commen√ßons ... </p><br><p><img src="https://habrastorage.org/webt/uc/xw/ks/ucxwkst9qdybxsrwsgrxi4qncyk.png"></p><br><p>  En effet, tout fonctionne correctement sur la grande majorit√© des pages, mais malheureusement pas sur toutes les pages. </p><br><img src="https://habrastorage.org/webt/mm/sc/gb/mmscgb1gygbne-ail3tsccjs_ik.png"><br><p>  <sub><em>Source de l'image sup√©rieure: <a href="">√ätes-vous s√ªr?</a></em></sub> </p><br><p>  De la part des documents, nous voyons que les mots dans le texte ne sont pas dans l'ordre dans lequel ils vont lors de l'it√©ration sur les mots du document.  De plus, on peut voir que la parenth√®se ouvrante dans le texte de la liste de mots est repr√©sent√©e comme la parenth√®se fermante et se trouve dans un autre ¬´mot¬ª.  Un affichage correct de ce fragment de texte peut √™tre vu en ouvrant le document dans MS Word.  Plus int√©ressant, si vous ne convertissez pas le document en pdf, mais que vous extrayez directement le texte du document, nous obtenons alors la troisi√®me version du fragment de texte qui ne correspond ni √† l'ordre correct ni aux deux autres commandes re√ßues de la biblioth√®que.  Dans ce fragment, comme dans la plupart des autres, sur lesquels un probl√®me similaire se pose, le point est en caract√®res ¬´RTL¬ª invisibles, qui changent l'ordre des caract√®res / mots adjacents. </p><br><p>  Ici, il convient de rappeler que nous avons appel√© la qualit√© du support technique importante lors du choix d'une biblioth√®que.  Comme la pratique l'a montr√©, dans cet aspect, l'interaction avec DevExpress est assez efficace.  Le probl√®me avec le document soumis a √©t√© rapidement r√©solu apr√®s la cr√©ation du ticket correspondant.  Un certain nombre d'autres probl√®mes li√©s aux exceptions / consommation √©lev√©e de m√©moire / traitement de documents longs ont √©galement √©t√© corrig√©s. </p><br><p>  Cependant, bien que DevExpress ne fournisse pas un moyen direct d'obtenir le texte avec les informations n√©cessaires pour chaque mot, nous continuons √† comparer parfois incomparables.  Si nous ne pouvons pas √©tablir une correspondance exacte entre les mots et le texte, nous utilisons un certain nombre d'heuristiques qui permettent de petites permutations de mots.  Si rien n'y fait, le document reste sans mise en forme.  Rarement, mais cela arrive. </p><br><p>  Au revoir :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr458842/">https://habr.com/ru/post/fr458842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr458830/index.html">Webinaires sur les technologies Dell: tous les d√©tails de notre didacticiel</a></li>
<li><a href="../fr458832/index.html">Cinq √©tudiants et trois magasins de valeurs cl√©s distribu√©s</a></li>
<li><a href="../fr458834/index.html">C√¥t√© de la personnalit√© de Paul Allen, que peu de gens connaissaient comme je le souhaiterais</a></li>
<li><a href="../fr458836/index.html">Indice de Borsch. Une approche syst√©matique pour √©valuer, comparer, d√©terminer le rapport qualit√© / prix</a></li>
<li><a href="../fr458840/index.html">Comment nous avons perc√© le grand pare-feu chinois (partie 2)</a></li>
<li><a href="../fr458844/index.html">Destruction des silos gr√¢ce √† l'approche d'adaptation VeriSM ‚Ñ¢</a></li>
<li><a href="../fr458846/index.html">Comment d√©velopper un autre jeu de plateforme en utilisant Unity. Un autre tutoriel</a></li>
<li><a href="../fr458848/index.html">Version Rust 1.36.0: futur trait, stabilisation de l'allocation et MaybeUninit <T></a></li>
<li><a href="../fr458850/index.html">Apprenez l'anglais √† moindre co√ªt et efficacement. 2e partie</a></li>
<li><a href="../fr458854/index.html">MotionLayout: les animations sont meilleures, moins de code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>