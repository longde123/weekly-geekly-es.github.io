<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛂 💰 📞 La patience et le travail vont extraire tout le texte 👩🏽‍🤝‍👨🏻 🤭 ⏸️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendant la session de formation (mai-juin et décembre-janvier), les utilisateurs nous demandent de vérifier les emprunts de 500 documents par minute. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La patience et le travail vont extraire tout le texte</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/458842/"><p>  Pendant la session de formation (mai-juin et décembre-janvier), les utilisateurs nous demandent de vérifier les emprunts de 500 documents par minute.  Les documents sont présentés dans des fichiers de différents formats, la complexité de travailler avec chacun d'eux étant différente.  Pour vérifier l'emprunt d'un document, nous devons d'abord extraire son texte du fichier, et en même temps gérer le formatage.  La tâche consiste à mettre en œuvre une extraction de haute qualité d'un demi-millier de textes avec une mise en forme par minute, tout en tombant rarement (ou mieux ne tombant pas du tout), consommant peu de ressources et ne payant pas la moitié du budget galactique pour le développement et le fonctionnement de l'idée finale. </p><br><p>  Oui, oui, bien sûr, nous savons que sur trois choses - rapidement, à moindre coût et efficacement - vous devez en choisir deux.  Mais le plus méchant, c'est que dans notre cas, nous ne pouvons rien supprimer.  La question est de savoir dans quelle mesure nous l'avons fait ... </p><br><p><img src="https://habrastorage.org/webt/us/nu/t4/usnut4dlt0wwlqzbkwhnmlud1uo.png"></p><br><p>  <sub><em>Source de l'image: <a href="">Wikipedia</a></em></sub> <br></p><p><a name="habracut"></a></p><br><p>  On nous dit souvent que le sort des gens dépend de la qualité de notre travail.  Par conséquent, vous devez éduquer en vous les perfectionnistes.  Bien sûr, nous améliorons constamment la qualité du système (dans tous les aspects), car les auteurs sans scrupules trouvent de nouvelles façons de contourner le problème.  Et j'espère que le jour est proche où la complexité de la tromperie, d'une part, et le sentiment de satisfaction d'un travail bien fait, d'autre part, inciteront la grande majorité des étudiants à abandonner leur désir bien-aimé de s'amuser.  Dans le même temps, nous comprenons que le prix de l'erreur peut être la souffrance possible de personnes innocentes si nous la simulons soudainement. </p><br><p>  Pourquoi suis-je?  Si nous étions perfectionnistes, nous aborderions avec attention la rédaction d'une série d'articles sur le travail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">du système anti-plagiat</a> .  Nous élaborerions minutieusement un plan de publication pour énoncer tout de la manière la plus logique et attendue pour le lecteur: </p><br><ul><li>  Tout d'abord, nous parlerions de la structure de notre système (la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cinquième publication</a> sur Habré) et décririons les trois étapes principales du traitement d'un document lorsqu'il est vérifié pour l'emprunt: <br><ol><li>  Extraire le texte du document (vous êtes ici!); </li><li>  Recherche de prêts (des pièces sont déjà <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dans plusieurs de nos articles</a> ); </li><li>  Construire un rapport sur le document (en plans). </li></ol></li><li>  En outre, nous commencerions à consacrer le lecteur au dispositif de mécanismes auxiliaires intéressants, tels que la recherche d'emprunts transférables ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">premier article</a> ), la définition de la paraphrase ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quatrième</a> ) et la classification thématique ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deuxième</a> ). </li><li>  Et enfin, nous sommes arrivés au moteur de recherche - l'indice des bardeaux ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">septième article</a> ). </li></ul><br><p> Un lecteur attentif doit avoir remarqué que nous ne souffrons toujours pas d'un perfectionnisme excessif, il est donc temps de passer à la première étape - extraire du texte et formater des documents.  C'est ce que nous ferons aujourd'hui, en réfléchissant à la mortalité de l'être et à la lumière au bout du tunnel, à la non-existence de quelque chose d'idéal et à la poursuite de l'excellence, à avoir un plan et à le suivre et aux compromis que la vie nous incline toujours. </p><br><h1>  Au début était le mot </h1><br><p>  Dans un premier temps, nous n'avons extrait des documents que les éléments les plus nécessaires à leur vérification d'emprunt - le texte des documents eux-mêmes.  Les principaux formats ont été pris en charge - docx, doc, txt, pdf, rtf, html.  Ensuite, les ppt, pptx, odt, epub, fb2, djvu les moins courants ont été ajoutés, mais il était <abbr title="La très faible demande ne justifiant pas les efforts consacrés à la prise en charge de ces formats">nécessaire de refuser de</abbr> travailler avec la plupart d'entre eux <abbr title="La très faible demande ne justifiant pas les efforts consacrés à la prise en charge de ces formats">à l'avenir</abbr> .  Chacun d'eux a été traité à sa manière - quelque part dans une bibliothèque séparée, quelque part dans son propre analyseur.  En moyenne, l'extraction de texte a duré environ des centaines de millisecondes.  Il semblerait que la principale et presque la seule difficulté à extraire du texte soit l '«analyse» du format lui-même, ce qui est particulièrement vrai pour les formats binaires pdf et doc (et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nature exclusive de ce</a> dernier rend son utilisation encore plus problématique).  Cependant, déjà à ce stade, lorsque nos désirs se limitaient à l'extraction du texte, il devenait clair que toute façon de lire les formats dont nous avions besoin comportait un certain nombre de caractéristiques désagréables.  Les plus importants d'entre eux: </p><br><ul><li>  Les exceptions sont même lors du traitement de certains documents valides, sans parler du traitement de documents «cassés» mal formés.  Ce qui crée encore plus de problèmes, c'est que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le code natif</a> peut tomber et gérer de telles situations dans le code .net est difficile; </li><li>  Consommation de mémoire insuffisamment élevée, ce qui peut nuire à la fois aux processus voisins et à l'actuel traitant le document «problème» (mémoire insuffisante dans le code managé ou non managé); </li><li>  Traitement trop long du document, qui est exacerbé par le manque de mécanismes d'annulation pour la plupart des bibliothèques, et parfois par la complexité (lire: presque impossible) d'annuler un appel de code non géré à partir d'un appel géré; </li><li>  "Extraction de texte à partir de documents."  Générer le texte d'un document pdf (et ce format est la clé pour nous), dont l'analyse a déjà été effectuée, contrairement aux attentes, est une tâche non triviale.  Le fait est que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le format pdf a</a> été initialement développé principalement pour la présentation électronique des supports d'impression.  Le texte dans les fichiers PDF est un ensemble de blocs de texte situés sur les pages d'un document.  De plus, le bloc peut être un paragraphe de texte ou un seul caractère.  La tâche de restaurer le texte dans sa forme originale à partir de cet ensemble de blocs incombe à la bibliothèque (code / programme) qui lit le document.  Oui, le format, à partir d'une certaine version de celui-ci, permet de spécifier l'ordre des blocs, mais, malheureusement, les documents avec une séquence marquée de blocs de texte sont rares.  Par conséquent, les bibliothèques de lecture de texte pdf contiennent un certain nombre d'heuristiques (enfin, c'est standard ici: apprentissage automatique, <s>bigdata, blockchain</s> , ...) qui vous permettent de restaurer le texte sous la forme correcte avec un degré ou un autre, et, comme prévu, le résultat obtenu diffère d'une bibliothèque à l'autre. . </li></ul><br><p><img src="https://habrastorage.org/webt/nr/hu/jb/nrhujbad4ji9xkwm5qzajzmvq24.png"></p><br><p>  <sub><em>Source de l'image du bas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a></em></sub> </p><br><p>  <sub><em>Source de l'image supérieure: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Hmm ...</a></em></sub> </p><br><h1>  Besoin de plus de données! </h1><br><p>  Si, pour analyser un document à emprunter, l'arrière-plan textuel du document nous a suffi, la mise en œuvre d'un certain nombre de nouvelles fonctionnalités est impossible ou très difficile sans extraire des données supplémentaires du document.  Aujourd'hui, en plus de l'arrière-plan du texte, nous extrayons également la mise en forme des documents et le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rendu des</a> images de page.  Nous utilisons ce dernier pour la reconnaissance optique de texte ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">OCR</a> ), ainsi que pour identifier certains types de contournements. </p><br><p>  Le formatage d'un document comprend la disposition géométrique de tous les mots et caractères des pages, ainsi que la taille de police de tous les caractères.  Ces informations nous permettent de: </p><br><ul><li>  Affichez magnifiquement le rapport de vérification du document, en dessinant les emprunts détectés directement sur le document d'origine; <br><img src="https://habrastorage.org/webt/hk/uo/am/hkuoamt7hjscszy6lcgoc4vjeoy.png"><br></li><li>  Déterminer avec plus de précision les blocs de documents (page de titre, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bibliographie</a> ) et récupérer ses métadonnées (auteurs, titre du poste, année et lieu de travail, etc.); </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Détectez les tentatives de contournement du système.</a> </li></ul><br><p>  Pour unifier le traitement des documents et un ensemble de données extraites, nous convertissons les documents de tous les formats pris en charge par nous en pdf.  Ainsi, la procédure d'extraction des données du document se déroule en deux étapes: </p><br><ul><li>  Convertissez un document en pdf; </li><li>  Extraire les données du pdf. </li></ul><br><h1>  Convertissez en pdf.  Sélection de la bibliothèque </h1><br><p>  Puisqu'il n'est pas si facile de prendre et de convertir un document en pdf, nous avons décidé de ne pas réinventer la roue et d'explorer des solutions toutes faites, en choisissant la plus appropriée pour nous.  C'était en 2017. </p><br><p>  Critères de sélection des candidats: </p><br><ul><li>  Bibliothèque sur .net, idéalement .net core et multiplateforme <div class="spoiler">  <b class="spoiler_title">Spoiler!</b> <div class="spoiler_text">  En conséquence, à ce moment-là, l'idéal était inaccessible </div></div></li><li>  Prise en charge des formats requis - doc, docx, rtf, odf, ppt, pptx </li><li>  La stabilité </li><li>  Performances </li><li>  Qualité du support technique </li><li>  Prix ​​d'émission </li></ul><br><p>  Nous avons analysé les solutions disponibles, en sélectionnant parmi elles les 6 plus adaptées à nos missions: </p><br><div class="scrollable-table"><table><tbody><tr><th>  La bibliothèque </th><th>  Problèmes de surface </th></tr><tr><td>  MS Word.  Interop </td><td>  <b>Requiert:</b> MS Word.  Appelez Microsoft Word via COM.  La méthode présente de nombreux inconvénients: besoin de MS Word installé, instabilité, performances médiocres.  Il existe des restrictions de licence. </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DevExpress (17)</a> </td><td>  Ne prend pas en charge ppt, pptx </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Groupdocs</a> </td><td>  - </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Syncfusion</a> </td><td>  Ne prend pas en charge ppt, pptx, odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Neevia Document Converter Pro</a> </td><td>  Requiert: MS Word.  Ne prend pas en charge odt </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dynamicpdf</a> </td><td>  Nécessite: MS Word, Internet Explorer.  Ne prend pas en charge odt </td></tr></tbody></table></div><br><p>  MS Word Interop, Neevia Document Converter Pro et DynamicPdf nécessitent l'installation de MS Office en production, ce qui pourrait enfin et irrévocablement nous lier à Windows.  Par conséquent, nous n'avons plus envisagé ces options. </p><br><p>  Ainsi, il nous reste trois candidats principaux, et un seul d'entre eux prend entièrement en charge tous les formats dont nous avons besoin.  Eh bien, il est temps de voir de quoi ils sont capables. </p><br><p>  Pour tester les bibliothèques, nous avons formé un échantillon de 120 000 documents utilisateurs réels, le ratio des formats dans lequel correspond approximativement ce que nous voyons chaque jour en production. </p><br><p>  Donc, le premier tour.  Voyons quelle proportion de documents peut être convertie avec succès en bibliothèques pdf à l'étude.  Avec succès, dans notre cas, il ne s'agit pas de lever une exception, de respecter le délai d'expiration de 3 minutes et de renvoyer un texte non vide. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertisseur </th><th rowspan="2">  Réussi (%) </th><th colspan="5">  Pas réussi (%) </th></tr><tr><th>  Total </th><th>  Texte vierge </th><th>  Exception </th><th>  Délai d'attente (3 minutes) </th><th>  Chute de processus </th></tr><tr><td>  Groupdocs </td><td>  99.012 </td><td>  0,988 </td><td>  0,039 </td><td>  0,873 </td><td>  0,076 </td><td>  0 </td></tr><tr><td>  DevExpress </td><td>  99,819 </td><td>  0,181 </td><td>  0,123 </td><td>  0,019 </td><td>  0,039 </td><td>  0 </td></tr><tr><td>  Syncfusion </td><td>  98,358 </td><td>  1,632 </td><td>  0,039 </td><td>  0,848 </td><td>  0,745 </td><td>  0,01 </td></tr></tbody></table></div><br><p>  Syncfusion s'est immédiatement démarqué, qui a non seulement réussi à traiter le plus petit nombre de documents, mais a également vidé l'ensemble du processus sur certains documents (en générant des exceptions telles que OutOfMemoryException ou des exceptions du code natif qui n'ont pas été détectées sans danser avec un tambourin). </p><br><p>  GroupDocs n'a pas réussi à traiter environ <b>5,5</b> fois plus de documents que DevExpress (tout peut être vu sur la plaque ci-dessus).  Ceci malgré le fait qu'une licence de développeur unique de GroupDocs coûte environ 9 fois plus cher qu'une licence de développeur unique de DevExpress.  Il en est ainsi d'ailleurs. </p><br><p>  Le deuxième test sérieux est le temps de conversion, les mêmes 120 000 documents: </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertisseur </th><th>  Moyenne (sec.) </th><th>  Médiane (sec.) </th><th>  Std (sec.) </th></tr><tr><td>  Groupdocs </td><td>  1.301966 </td><td>  0,328000 </td><td>  6.401197 </td></tr><tr><td>  DevExpress </td><td>  0,523453 </td><td>  0,252000 </td><td>  1,781898 </td></tr><tr><td>  Syncfusion </td><td>  8.922892 </td><td>  4.987000 </td><td>  12.929588 </td></tr></tbody></table></div><br><img src="https://habrastorage.org/webt/g5/2h/3k/g52h3klfh-leliffdwmrtmgapxy.png"><br><br><p>  Notez que DevExpress non seulement traite les documents plus rapidement en moyenne, mais affiche également un temps de traitement beaucoup plus stable. </p><br><p>  Mais la stabilité et la vitesse de traitement ne signifient rien si la sortie est mauvaise pdf.  Peut-être que DevExpress saute la moitié du texte?  Nous vérifions.  Ainsi, les mêmes 120 000 documents, cette fois-ci, nous calculerons le volume total du texte extrait et la part moyenne des mots du dictionnaire (plus les mots extraits sont dictionnaire, moins les déchets / texte extrait incorrectement): </p><br><div class="scrollable-table"><table><tbody><tr><th>  Convertisseur </th><th>  La quantité totale de texte (en caractères) </th><th>  La proportion moyenne de mots de vocabulaire </th></tr><tr><td>  Groupdocs </td><td>  6 321 145 966 </td><td>  0,949172 </td></tr><tr><td>  DevExpress </td><td>  6 135 668 416 </td><td>  0,950629 </td></tr><tr><td>  Syncfusion </td><td>  5 995 008 572 </td><td>  0,938693 </td></tr></tbody></table></div><br><p>  En partie, l'hypothèse était correcte.  Il s'est avéré que GroupDocs, contrairement à DevExpress, peut fonctionner avec des notes de bas de page.  DevExpress les ignore simplement lors de la conversion d'un document en pdf.  Par ailleurs, oui, le texte du pdf'ok reçu est extrait dans tous les cas à l'aide de DevExpress'a. </p><br><p>  Ainsi, nous avons étudié la vitesse et la stabilité des bibliothèques en question, maintenant nous évaluons soigneusement la qualité de la conversion des documents pdf.  Pour ce faire, nous analyserons non seulement le volume du texte à extraire et la proportion de mots du dictionnaire, mais nous comparerons les textes extraits des pdfs reçus avec les textes pdf obtenus à l'aide de MS Word.  Nous acceptons le résultat de la conversion d'un document en utilisant MS Word comme <i>pdf de référence</i> .  Environ 4 500 paires de « <i>document, référence pdf'ka</i> » ont été préparées pour ce test. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Convertisseur </th><th rowspan="2">  <abbr title="Pourcentage de documents que la bibliothèque a pu extraire">Texte extrait (%)</abbr> </th><th colspan="3">  Proximité de la longueur du texte </th><th colspan="3">  Proximité par fréquence de mots </th></tr><tr><th>  Moyenne </th><th>  Médiane </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SKO</a> </th><th>  Moyenne </th><th>  Médiane </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SKO</a> </th></tr><tr><td>  Groupdocs </td><td>  99.131 </td><td>  0,985472 </td><td>  0,999756 </td><td>  0,095304 </td><td>  0,979952 </td><td>  1,000000 </td><td>  0,102316 </td></tr><tr><td>  DevExpress </td><td>  99,726 </td><td>  0,971326 </td><td>  0.996647 </td><td>  0,075951 </td><td>  0,965686 </td><td>  0.996101 </td><td>  0,082192 </td></tr><tr><td>  Syncfusion </td><td>  89,336 </td><td>  0,880229 </td><td>  0.996845 </td><td>  0,306920 </td><td>  0,815760 </td><td>  0.998206 </td><td>  0,3448621 </td></tr></tbody></table></div><br><p>  Pour chaque paire « <i>pdf de référence, résultat de conversion</i> », nous avons calculé la similitude dans la longueur du texte extrait et dans les fréquences des mots extraits.  Naturellement, ces mesures n'ont été obtenues que dans les cas où la conversion a réussi.  Par conséquent, nous ne considérons pas les résultats de Syncfusion ici.  DevExpress et GroupDocs ont montré à peu près les mêmes performances.  Du côté DevExpress, il y a un pourcentage significativement plus élevé de conversions réussies, du côté GD, un travail correct avec les notes de bas de page. </p><br><p>  Compte tenu des résultats, le choix était évident.  À ce jour, nous utilisons la solution de DevExpress et nous prévoyons bientôt de passer à sa 19e version. </p><br><h1>  Il y a un pdf, extraire le texte avec mise en forme </h1><br><p>  Ainsi, nous pouvons convertir des documents en pdf.  Nous avons maintenant une autre tâche: utiliser DevExpress pour extraire le texte, connaître à chaque mot toutes les informations dont nous avons besoin.  À savoir: </p><br><ul><li>  Sur quelle page se trouve le mot; </li><li>  L'emplacement du mot sur la page (encadrement d'un rectangle); </li><li>  La taille de police du mot (caractères du mot). </li></ul><br><p>  L'image montre la répartition du texte en pages et montre également la correspondance d'un mot de texte avec la zone de page. </p><br><p><img src="https://habrastorage.org/webt/sv/zy/ja/svzyjafy1nmstmlbblte4uhdpwg.png"></p><br><p>  <sub><em>Source de l'image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Extraction des métadonnées d'en-tête à partir de documents scientifiques</a></em></sub> </p><br><p>  Il semblerait que tout devrait être simple.  Nous regardons ce que l'API DevExpress nous fournit: </p><br><ul><li>  Nous avons une méthode qui retourne le texte de tout le document.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Chaîne</a> simple; </li><li>  Nous avons la possibilité d'itérer selon le document.  Pour chaque mot, nous pouvons obtenir: <br><ul><li>  Texte du mot; </li><li>  La page sur laquelle se trouve le mot; </li><li>  Le rectangle de cadrage du mot; </li><li>  Informations sur les caractères individuels du mot (signification du caractère encadrant le rectangle, taille de police, ...). </li></ul><br></li></ul><br><p>  D'accord, tout semble être là.  Voici seulement comment obtenir les données nécessaires pour chaque mot dans le texte du document renvoyé par DevExpress?  Nous ne voulons pas vraiment collecter le texte du document à partir des mots nous-mêmes, car, par exemple, nous n'avons pas d'informations là où il y a juste un espace entre les mots et où se trouve le saut de ligne.  Nous devrons trouver une heuristique basée sur l'emplacement des mots ... Le texte est - le voici, devant nous, déjà assemblé. </p><br><p><img src="https://habrastorage.org/webt/ti/d9/ru/tid9ruengnw06fe0krbvfqbpfle.jpeg"></p><br><p>  <sub><em>Source de l'image: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Eureka!</a></em></sub> </p><br><p>  La solution évidente consiste à faire correspondre les mots avec le texte du document.  Nous regardons - en effet, dans le texte du document les mots sont disposés dans le même ordre dans lequel ils sont renvoyés par l'itérateur selon les mots du document. </p><br><p>  Nous implémentons rapidement un algorithme simple pour faire correspondre les mots avec le texte du document, ajoutons des vérifications que tout est correctement mis en correspondance, commençons ... </p><br><p><img src="https://habrastorage.org/webt/uc/xw/ks/ucxwkst9qdybxsrwsgrxi4qncyk.png"></p><br><p>  En effet, tout fonctionne correctement sur la grande majorité des pages, mais malheureusement pas sur toutes les pages. </p><br><img src="https://habrastorage.org/webt/mm/sc/gb/mmscgb1gygbne-ail3tsccjs_ik.png"><br><p>  <sub><em>Source de l'image supérieure: <a href="">Êtes-vous sûr?</a></em></sub> </p><br><p>  De la part des documents, nous voyons que les mots dans le texte ne sont pas dans l'ordre dans lequel ils vont lors de l'itération sur les mots du document.  De plus, on peut voir que la parenthèse ouvrante dans le texte de la liste de mots est représentée comme la parenthèse fermante et se trouve dans un autre «mot».  Un affichage correct de ce fragment de texte peut être vu en ouvrant le document dans MS Word.  Plus intéressant, si vous ne convertissez pas le document en pdf, mais que vous extrayez directement le texte du document, nous obtenons alors la troisième version du fragment de texte qui ne correspond ni à l'ordre correct ni aux deux autres commandes reçues de la bibliothèque.  Dans ce fragment, comme dans la plupart des autres, sur lesquels un problème similaire se pose, le point est en caractères «RTL» invisibles, qui changent l'ordre des caractères / mots adjacents. </p><br><p>  Ici, il convient de rappeler que nous avons appelé la qualité du support technique importante lors du choix d'une bibliothèque.  Comme la pratique l'a montré, dans cet aspect, l'interaction avec DevExpress est assez efficace.  Le problème avec le document soumis a été rapidement résolu après la création du ticket correspondant.  Un certain nombre d'autres problèmes liés aux exceptions / consommation élevée de mémoire / traitement de documents longs ont également été corrigés. </p><br><p>  Cependant, bien que DevExpress ne fournisse pas un moyen direct d'obtenir le texte avec les informations nécessaires pour chaque mot, nous continuons à comparer parfois incomparables.  Si nous ne pouvons pas établir une correspondance exacte entre les mots et le texte, nous utilisons un certain nombre d'heuristiques qui permettent de petites permutations de mots.  Si rien n'y fait, le document reste sans mise en forme.  Rarement, mais cela arrive. </p><br><p>  Au revoir :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr458842/">https://habr.com/ru/post/fr458842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr458830/index.html">Webinaires sur les technologies Dell: tous les détails de notre didacticiel</a></li>
<li><a href="../fr458832/index.html">Cinq étudiants et trois magasins de valeurs clés distribués</a></li>
<li><a href="../fr458834/index.html">Côté de la personnalité de Paul Allen, que peu de gens connaissaient comme je le souhaiterais</a></li>
<li><a href="../fr458836/index.html">Indice de Borsch. Une approche systématique pour évaluer, comparer, déterminer le rapport qualité / prix</a></li>
<li><a href="../fr458840/index.html">Comment nous avons percé le grand pare-feu chinois (partie 2)</a></li>
<li><a href="../fr458844/index.html">Destruction des silos grâce à l'approche d'adaptation VeriSM ™</a></li>
<li><a href="../fr458846/index.html">Comment développer un autre jeu de plateforme en utilisant Unity. Un autre tutoriel</a></li>
<li><a href="../fr458848/index.html">Version Rust 1.36.0: futur trait, stabilisation de l'allocation et MaybeUninit <T></a></li>
<li><a href="../fr458850/index.html">Apprenez l'anglais à moindre coût et efficacement. 2e partie</a></li>
<li><a href="../fr458854/index.html">MotionLayout: les animations sont meilleures, moins de code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>