<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöµüèæ ‚úäüèΩ üêù C√≥mo el joven verde escribi√≥ su recarga caliente üë©üèª‚Äçüéì üë∑ üíö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Antecedentes 
 Un par de l√≠neas sobre m√≠ para una comprensi√≥n general del nivel del autor y el problema que se est√° resolviendo.  Mi nombre es Eugene ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo el joven verde escribi√≥ su recarga caliente</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466237/"><h3>  Antecedentes </h3><br><div class="spoiler"> <b class="spoiler_title">Un par de l√≠neas sobre m√≠ para una comprensi√≥n general del nivel del autor y el problema que se est√° resolviendo.</b> <div class="spoiler_text">  Mi nombre es Eugene y soy <s>desarrollador web y desarrollador</s> frontend junior verde. <br>  Hace alg√∫n otro a√±o, trabaj√© en un campo completamente diferente y solo en teor√≠a pens√© en cambiar mi profesi√≥n, pero alrededor de diciembre de 2018 encontr√© mi camino y comenc√© a actuar. <br>  Despu√©s de unos seis meses de capacitaci√≥n total, obtengo un trabajo como programador frontend.  He aprendido cosas fundamentales (quiero pensar as√≠), js, interacci√≥n con el DOM, react + redux.  HTML y CSS al menos + una comprensi√≥n general de bootstrap y ensamblaje, trabajando con git, la l√≠nea de comando. <br>  Adem√°s de la teor√≠a, se han realizado un par de proyectos de capacitaci√≥n, incluido un chat sobre react + redux, as√≠ como un par de intentos para implementar algunas de sus ideas. <br>  En general, un conjunto de caballeros moderno est√°ndar de este tipo para un frente principiante. <br>  La primera semana y media instal√© una m√°quina virtual, hay mucho de todo y todo me resulta desconocido e incomprensible. <br>  En el proceso, me familiarizo con nuevas herramientas y tecnolog√≠as: con bases de datos (y pongo otro marcador en la lista de "aprender"), masilla, wincsp, etc. <br>  Pase con √©xito esta carrera de obst√°culos e ir al frente. <br></div></div><br><h3>  Pr√≥logo </h3><br>  Despu√©s de haber escrito mi reloader y este art√≠culo, encontr√© an√°logos, incluidos los de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Habr√©</a> .  Sin embargo, decidi√≥ publicar su bicicleta. <br><br><h3>  Inicio </h3><br>  Tenemos un proyecto bastante grande, heredado, escrito en angularJS, con todos sus encantos.  Despu√©s de Reaccionar, me pareci√≥ un dinosaurio, pero nada, compro cursos de angularjs, entro r√°pidamente y empiezo a beneficiarme. <br><br>  Una impresi√≥n positiva es que el proyecto fue escrito bien, por personas con brazos claramente rectos.  Variables con excelente nomenclatura clara, la estructura es la misma en todas partes y, en general, toda la l√≥gica es muy accesible y simple. <br><br>  Pero hay suficientes inconvenientes. <br><a name="habracut"></a><br>  El primer problema: el proyecto est√° siendo construido por alg√∫n minimizador antiguo, y es imposible usar la sintaxis js moderna.  Ninguno () =&gt; {}, const res = [... datos, subRes], as√≠ncrono / espera ... <br><br>  El segundo problema: no hay webpack, ni siquiera al menos trago, y en consecuencia tampoco hay un servidor webpack-dev-familiar que me resulte familiar con su excelente recarga en caliente. <br><br>  Escribi√≥  Guardado  F5  Inconveniente  Dolor?  No es un dolor directo, pero muy inc√≥modo. <br><br>  El tercer problema: construir el archivo .bat del proyecto, en el que parte del proyecto simplemente se copia, parte de las bibliotecas se recopilan sin minimizaci√≥n, parte se minimiza en un archivo, el resto de los archivos del proyecto en otro.  Lista de bibliotecas en el tercer archivo.  Lista de archivos para construir en el cuarto.  Y as√≠ sucesivamente. <br><br>  El cuarto problema: todas las bibliotecas est√°n perfectamente en la carpeta libs y est√°n conectadas por un script en index.html.  All-all, excepto express y proxy para √©l (no est√°n involucrados en el ensamblaje, sino solo para el desarrollo). <br>  Y lejos de todas partes hay versiones o una indicaci√≥n de una biblioteca espec√≠fica. <br><br>  Viv√≠ entrenando en un hermoso mundo de programaci√≥n funcional, lleno de es6 +, webpack-dev-server, tdd, eslint, construcci√≥n autom√°tica, etc. <br><br>  Y aqu√≠ en el mundo de los adultos, todo es completamente diferente ... <br><br><h3>  Empate </h3><br>  Pero me gusta trabajar, considero los obst√°culos como oportunidades para el autodesarrollo, la empresa es buena, el ambiente es excelente, ¬°tengo los ojos en llamas! <br><br>  En las horas de trabajo realizo tareas de trabajo, en mi tiempo libre trato de mejorar algo. <br><br>  A mediados de junio, comienzo con un intento de ajustar el paquete web, pero el primer enfoque espera un fracaso completo.  He estado atormentado durante una semana, estoy muy cansado de eso, temporalmente pospuesto. <br><br>  Decido comenzar con algo peque√±o: conecto la nueva sintaxis a trav√©s de babel.  Agrego el procesamiento inicial de babel a nuestro build.bat m√°gico, pero algo rompe el idilio y nuestro viejo minificador tropieza.  Estoy buscando un problema <br><br>  Se tropieza con una de las bibliotecas de las ordenadas librer√≠as de pap√°.  Miro los archivos de la biblioteca: ya est√°n minificados en la sintaxis anterior. <br><br>  Digo babel: "no vayas aqu√≠ ... la cabeza obtendr√° el c√≥digo, ser√° realmente malo".  Lo compruebo: ¬°todo funciona!  ¬°Hurra!  ¬°Ahora tengo acceso a todas esas nuevas y agradables cosas de moda para j√≥venes!  Primera victoria  Agradable  Creo en esta ocasi√≥n cambiar el nombre del script en e.bat (e-Evgen), pero no puedo decidir. <br><br>  La nueva sintaxis es tan familiar y agradable, pero la idea de una construcci√≥n torcida no me deja. <br><br>  Finales de junio y principios de julio.  Estoy haciendo el segundo enfoque, m√°s exhaustivo, pero nuevamente me encuentro con errores entre webpack y angularjs.  Nuevamente una semana de investigaci√≥n. <br><br>  Una vez que paso varios d√≠as y en parte noches buscando una soluci√≥n, me encuentro con discursos extremadamente interesantes de la conferencia HolyJS, donde los muchachos ya est√°n cavando bastante en el paquete web.  Estoy avanzando en su comprensi√≥n, pero todav√≠a no entiendo el material hasta el final. <br><br>  El inter√©s se fortalece. <br><br>  Un colega dice: olv√≠dalo, para entregar el proyecto en un par de meses, ya no es necesario que lo hagas. <br>  No martillo, pero lo pospuse: mucho trabajo, me exprime todo, no queda tiempo para actividades extracurriculares. <br><br>  A mediados de julio, me pongo en mis manos de forma similar a nuestro proyecto con una construcci√≥n personalizada.  Voy con √©l al tercer enfoque y pr√°cticamente estoy configurando un paquete web con nosotros, pero al final encuentro nuevos errores que no tengo tiempo suficiente para resolver, el trabajo avanza con nueva intensidad + me devasta mentalmente, pospongo este negocio nuevamente. <br><br><h3>  Cuerpo principal </h3><br>  Mediados de agosto.  Como resultado, un amigo habla sobre el aprendizaje de node.js y su deseo de escribir su propio Hot-Reloader.  Los pensamientos sobre nuestra asamblea estallan con renovado vigor. <br><br>  Tarea: vuelva a cargar la p√°gina actual al actualizar archivos en el proyecto. <br>  Caracter√≠sticas: todas las bibliotecas est√°n conectadas en index.html, no puede requerir, por no mencionar la importaci√≥n.  El ensamblaje antes de la recarga a√∫n no es necesario, solo recargue.  En un servidor de desarrollo que env√≠a solicitudes de nuestro respaldo, puedo usar paquetes, ¬°y tambi√©n puedo solicitarlos! <br><br>  Todo esto sucede el viernes y decido que en una versi√≥n simplificada para nuestro proyecto, soy bastante capaz de implementar una tecnolog√≠a que nos salvar√° a m√≠ y a mis colegas de F5. <br><br>  El proceso de pensamiento contin√∫a y se forma una visi√≥n de la soluci√≥n en la cabeza. <br>  El servidor m√°s simple (como el nuestro), en √©l recorrer√© toda la carpeta y subcarpetas y formar√© un √°rbol con las fechas de modificaci√≥n de cada archivo. <br><br>  Luego, despu√©s de cada n milisegundos, omitir√© una y otra vez y comparar√© los valores del tiempo de cambio.  Cambiado - recargar.  Un amigo te dice: "no reinventes la rueda, hay un reloj en node.js".  Genial, lo usar√©.  En server.js, configurar√© watch detr√°s de la carpeta del proyecto y llamar√© a location.reload () para cambiar algo dentro. <br><br>  Primera iteraci√≥n: <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre><code class="plaintext hljs">var express = require('express'); var app = express(); var server = require('http').Server(app); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); location.reload().</code> </pre> <br></div></div><br>  El primer problema es la ubicaci√≥n: esta no es una variable node.js (en este momento entiendo por qu√© mis intentos de acceder a process.env en el frente tampoco tuvieron √©xito))). <br><br>  El segundo problema es c√≥mo hacer que el frente entienda qu√© debe hacer la recarga. <br><br>  Salir - websocket!  La idea es tentadora + Trabaj√© con ellos "conos medios" cuando escrib√≠ un chat, tengo una idea general.  Al mismo tiempo, hago un contador de reinicio por sesi√≥n, agrego una variable y proceso la solicitud que me da. <br><br>  Lo intento <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var express = require('express'); //  express var app = express(); var server = require('http').Server(app); //  http  app var io = require('socket.io')(server); //  socket.io     var fs = require('fs'); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); let count = 0; app.get('/data', (req, res) =&gt; { res.data = count; res.send(`${count}`); }) const dir = './src'; fs.watch(dir, () =&gt; { io.emit('change', {data: count}); count += 1; })</code> </pre><br></div></div><br>  En el frente estoy haciendo la aplicaci√≥n m√°s simple en angularjs <br><br><div class="spoiler">  <b class="spoiler_title">app.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">angular.module('App', []) .controller('myAppCtrl',['$scope', '$timeout','$http', ($scope, $timeout, $http) =&gt; { $scope.title = '       '; $scope.count = 0; $scope.todo = [ '  ,  ', '   node.js watch   ', '     ,         ', ' , codeclimate  travis   ' ] $scope.marks = [ 'watcher      ' ] // var socket = io(); // socket.on('change', (data) =&gt; { // console.log(data.data); // $scope.count = data.data; // console.log('scope.count: ', $scope.count); // $scope.$digest();// // location.reload();//agfr // }) $http({method: 'GET',url: 'data'}) .then(response =&gt; { $scope.count = response.data;// }); }])</code> </pre><br></div></div><br>  Y un m√≥dulo separado que lo recarga.  Separar, para que el proyecto no se vuelva demasiado. <br><br><div class="spoiler">  <b class="spoiler_title">watch.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var socket = io(); socket.on('change', () =&gt; { location.reload(); })</code> </pre><br></div></div><br>  Funciona!  Tambi√©n supervisa archivos que no sean js (¬°nunca se sabe!): Marcado .json, .css. <br>  Compruebo las subcarpetas, no funciona. <br><br>  Creo que est√° bien, ahora lo reducir√© recursivamente.  Por si acaso, google y - voila - est√° listo <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La decisi√≥n.</a> <br><br>  Agrega este paquete. <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var express = require('express'); //  express var app = express(); var server = require('http').Server(app); //  http  app var io = require('socket.io')(server); //  socket.io     var fs = require('fs'); var watch = require('node-watch'); const port = 9080; server.listen(port); app.use(express.static(__dirname + '/src')); let count = 0; let changed = []; app.get('/data', (req, res) =&gt; { res.data = count; res.send({count, changed}); }) const translate = { remove: "", update: "" } watch('./', { recursive: true }, function(evt, name) { io.emit('change', {data: count}); count += 1; changed = [{name, evt}, ...changed]; });</code> </pre><br></div></div><br>  ¬°Hurra, funciona! <br><br>  Recuerdo eslint, codeclimate y travis. <br>  Instale el primero, agregue el resto. <br>  Limpio el c√≥digo, todo es var en constante y as√≠ sucesivamente. <br><br>  Linter jura que angular no est√° definido, pero mis caracter√≠sticas de conexi√≥n de bibliotecas en el proyecto dictan este comportamiento, lo apago.  Al mismo tiempo, atornillo un poco las variables de la l√≠nea de comando, lo ejecuto, ¬°todo funciona! <br><br>  Lleg√≥ a trabajar el lunes y sujet√≥ toda la granja a un proyecto de trabajo.  Tuve que cambiar un poco, al mismo tiempo hacer cambios para que fuera posible cambiar algunos par√°metros de inicio desde la l√≠nea de comandos y excepciones, para que no lo leyera todo. <br><br>  Como resultado, result√≥ as√≠: <br><br><div class="spoiler">  <b class="spoiler_title">server.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">const express = require('express'), http = require('http'), watch = require('node-watch'), proxy = require('http-proxy-middleware'), app = express(), server = http.createServer(app), io = require('socket.io').listen(server), exeptions = ['git', 'js_babeled', 'node_modules', 'build', 'hotreload'], // ,   ,    backPortObj = { /*  ,   back*/ }, address = process.argv[2] || /*    back*/, localHostPort = process.argv[3] || 9080, backMachinePort = backPortObj[address] || /*   back */, isHotReload = process.argv[4] || "y", // "n" || "y" target = `http://192.168.${address}:${backMachinePort}`, str = `Connected to machine: ${target}, hot reload: ${isHotReload === 'y' ? 'enabled' : 'disabled'}.`, link = `http://localhost:${localHostPort}/`; server.listen(localHostPort); app .use('/bg-portal', proxy({ target, changeOrigin: true, ws: true })) .use(express.static('.')); if (isHotReload === 'y') { watch('./', { recursive: true }, (evt, name) =&gt; { let include = false; exeptions.forEach(item =&gt; { if (`${name}`.includes(item)) include = true; }) if (!include) { console.log(name); io.emit('change', { evt, name, exeptions }); }; }); }; console.log(str); console.log(link);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">app.js</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">var socket = io.connect(); socket.on('change', ({ evt, name, exeptions }) =&gt; { location.reload(); });</code> </pre><br></div></div><br>  el script en ejecuci√≥n en package.json solo llama a server.js desde debajo del nodo y comienza as√≠: <br><br><pre> <code class="plaintext hljs">npm start 1.100 8080</code> </pre><br>  Escribi√≥  Guardado  <s>F5</s> <br><br>  En conclusi√≥n, quiero agradecer a Vanya, mi amigo, en algunos lugares, al autor intelectual y al pateador principal, as√≠ como a Sasha, ¬°el hombre a quien considero mi mentor! <br><br><h3>  En lugar de un ep√≠logo </h3><br>  Y despu√©s de 2 semanas, en el √∫ltimo d√≠a de mi per√≠odo de prueba, todav√≠a atornill√© webpack y webpack-dev-server en nuestro proyecto, enviando mi cargador caliente al polvo en el estante de la historia. <br><br>  Sin embargo, estas 2 semanas lo usamos todos los d√≠as y ¬°√©l hizo su trabajo regularmente! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/466237/">https://habr.com/ru/post/466237/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466223/index.html">Descomposici√≥n limpia</a></li>
<li><a href="../466227/index.html">Programaci√≥n Orientada a Nodos</a></li>
<li><a href="../466229/index.html">C√≥mo comprar diez cajas de algod√≥n y no equivocarse</a></li>
<li><a href="../466231/index.html">ShIoTiny y el mundo circundante: conectar sensores a entradas binarias, rebote de contactos y otros problemas</a></li>
<li><a href="../466235/index.html">Munch en una exploraci√≥n equidistante y Meyerhold, que destruy√≥ la Plaza Roja - Denis Semenov sobre arte VR</a></li>
<li><a href="../466247/index.html">Entrevista introvertida</a></li>
<li><a href="../466249/index.html">Escribir una serpiente para Android en Kivy, Python</a></li>
<li><a href="../466251/index.html">Impulsando el proyecto de Soft Launch a $ 1 mill√≥n en ingresos por mes</a></li>
<li><a href="../466253/index.html">C√≥mo reconstru√≠ los sitios de aterrizaje de ALS Luna-9 y Luna-13</a></li>
<li><a href="../466257/index.html">Conquistando los mares: almacenes de datos flotantes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>