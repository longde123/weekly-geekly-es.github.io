<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚å®Ô∏è üññüèª üíè M√≥dulos Laurent e Casa Inteligente (Parte 1). Mordomo ü§¶üèª üöî üôÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quero chamar sua aten√ß√£o para uma s√©rie de artigos sobre os m√≥dulos de controle Laurent da KernelChip . Nesta s√©rie, mostrarei como integrar esses m√≥d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√≥dulos Laurent e Casa Inteligente (Parte 1). Mordomo</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384485/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quero chamar sua aten√ß√£o para uma s√©rie de artigos sobre </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">os</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√≥dulos de controle Laurent </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">da KernelChip</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Nesta s√©rie, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mostrarei</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> como integrar esses m√≥dulos √† sua Smart Home, como aprender a gerenci√°-los no popular </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">sistema de</font></a><font style="vertical-align: inherit;"> automa√ß√£o residencial </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">MajorDoMo</font></a><font style="vertical-align: inherit;"> , nos esbo√ßos do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino, no sistema Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e at√© mesmo como aplicar esses m√≥dulos para uma finalidade completamente inesperada - por ensinando seus filhos a programar em Processing. </font></font><br>
<br>
<img src="https://habrastorage.org/files/915/0cb/0cb/9150cb0cbde940e588d1badce05af5bb.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em geral, os m√≥dulos que s√£o bastante interessantes por si s√≥ podem inesperadamente ser muito √∫teis nas fam√≠lias, se voc√™ os abordar com uma certa quantidade de imagina√ß√£o e criatividade.</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que Laurent?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como esses m√≥dulos trabalham com sucesso no meu sistema Smart Home h√° muito tempo (mais de tr√™s anos) e adquiri alguma experi√™ncia no uso deles e tenho algo a dizer sobre eles. </font><font style="vertical-align: inherit;">E tamb√©m tenho alguma experi√™ncia e c√≥digo testado e pronto para gerenciar esses m√≥dulos, que quero compartilhar com voc√™. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E voc√™ poder√° desenvolver suas solu√ß√µes de software com base nesse c√≥digo, ser√° bastante simples, porque eu j√° fiz a maior parte do trabalho. </font><font style="vertical-align: inherit;">Al√©m disso, o c√≥digo ser√° explicado em detalhes, o que certamente contribui para o seu entendimento de como ele funciona, aprendendo a programar e criando sistemas dom√©sticos inteligentes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√≥dulos em si</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando escolhi uma solu√ß√£o pronta para gerenciar cargas el√©tricas por meio da rede, Laurent me subornou com a integridade e simplicidade da solu√ß√£o. Para come√ßar a controlar a rede, ligar e desligar dispositivos e ilumina√ß√£o, quase nada era necess√°rio. N√£o era necess√°rio aprender a linguagem de programa√ß√£o, n√£o era necess√°rio soldar nada, bastava conectar o m√≥dulo √† rede local, conectar a carga aos terminais do rel√© (e n√£o se esque√ßa de aplicar energia ao pr√≥prio m√≥dulo) e isso foi tudo. Depois disso, foi poss√≠vel enviar comandos diretamente do computador (a partir do programa do terminal). O m√≥dulo imediatamente come√ßou a obedecer e apagar a luz de acordo com meus comandos. Naquela √©poca, eu n√£o precisava de mais.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Posso dizer sobre os pr√≥prios m√≥dulos que, durante todo o per√≠odo de opera√ß√£o, n√£o houve falhas e congela, tudo funcionou e funciona "como um rel√≥gio", o que, de fato, √© necess√°rio a partir desses m√≥dulos para funcionar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Design e qualidade de constru√ß√£o</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Basta apenas olhar para o m√≥dulo para deixar claro que ele foi desenvolvido por uma raz√£o, "se ao menos", mas tentou fazer uma coisa realmente digna. </font><font style="vertical-align: inherit;">Eu tamb√©m n√£o tenho queixas sobre a qualidade da constru√ß√£o, tudo √© feito de maneira ordenada e como deveria ser: sem pe√ßas tortas, manchas de solda ou qualquer coisa assim, tudo √© claro e limpo. </font><font style="vertical-align: inherit;">Em geral, a qualidade da constru√ß√£o n√£o difere dos componentes do computador "de marca" e do Arduino "de f√°brica". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A √∫nica coisa que eu faria se eu mesmo lan√ßasse esses m√≥dulos era instalar terminais multicoloridos para conectar os fios em vez de terminais de uma cor, pelo menos destacar os terminais de conex√£o de energia, mas √© assim, uma pequena escolha de nitidez (tudo, √© claro, est√° bem assinado).</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qual √© o primeiro artigo da s√©rie?</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as informa√ß√µes s√£o divididas em tr√™s artigos logicamente finalizados. O primeiro artigo focar√° na integra√ß√£o dos m√≥dulos Laurent com o MajorDoMo, uma popular plataforma de automa√ß√£o residencial de c√≥digo aberto. Exemplos espec√≠ficos e c√≥digo PHP ser√£o fornecidos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O segundo artigo √© sobre integra√ß√£o com o ecossistema do Arduino. Voc√™ pode gerenciar os m√≥dulos de seus esbo√ßos individuais ou integrar o Laurent ao </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">Arduino</font></a><font style="vertical-align: inherit;"> (que tamb√©m √© baseado no c√≥digo do Arduino) e gerenciar o Laurents a partir de uma interface conveniente ou automaticamente, de acordo com o programa. Solu√ß√µes prontas e c√≥digo testado tamb√©m ser√£o fornecidos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E na terceira - sobre o gerenciamento de m√≥dulos Laurent a partir de esbo√ßos sobre processamento. Ou seja, diretamente da √°rea de trabalho do seu computador dom√©stico. O mesmo artigo descrever√° como aumentar o interesse das crian√ßas em aprender programa√ß√£o e qual o papel que esses m√≥dulos podem desempenhar nesse assunto. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A s√©rie √© dedicada √† integra√ß√£o dos m√≥dulos Laurent aos sistemas de automa√ß√£o residencial e n√£o considera a arquitetura e a opera√ß√£o dos pr√≥prios m√≥dulos. Isso foi descrito em outros artigos com os quais voc√™ pode ler </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e ser√° discutido mais adiante. Aqui nos concentramos apenas na integra√ß√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No processo de reda√ß√£o dos artigos, foi utilizado o m√≥dulo Laurent com firmware La01 e a vers√£o da interface da Web LW1.0, ou seja, o pr√≥prio m√≥dulo de ‚Äúcombate‚Äù que trabalha h√° tr√™s anos. </font><font style="vertical-align: inherit;">Nas novas vers√µes dos m√≥dulos, os detalhes de implementa√ß√£o podem diferir um pouco, mas a compatibilidade com as equipes de controle √© preservada; portanto, tudo o que foi dito aqui tamb√©m √© v√°lido para modifica√ß√µes mais recentes.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como o gerenciamento de m√≥dulos funciona</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as trocas de informa√ß√µes com os m√≥dulos s√£o realizadas na rede e, para come√ßar a trabalhar com eles, √© necess√°rio estabelecer uma conex√£o TCP / IP na porta 2424. </font><font style="vertical-align: inherit;">Uma vez estabelecida a conex√£o, voc√™ pode enviar comandos de texto (os chamados comandos KE) que controlam o m√≥dulo. </font><font style="vertical-align: inherit;">O </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">site do KernelChip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> possui documenta√ß√£o detalhada, incluindo uma descri√ß√£o acess√≠vel dos comandos KE. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O KernelChip cuidou dos usu√°rios e forneceu aos seus m√≥dulos uma interface da web conveniente, mas esse √© um "controle manual", e a conveni√™ncia, o valor e a utilidade da solu√ß√£o aumentar√£o em um pedido se aprendermos a gerenciar o m√≥dulo em nossa Smart Home. </font></font><br>
<br>
<img src="https://habrastorage.org/files/0ad/e7b/6e3/0ade7b6e3ff2446e969b922121a3c87d.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A interface da web √© protegida por senha por padr√£o e, para visualizar o conte√∫do da p√°gina, √© necess√°rio inserir o nome de usu√°rio ‚Äúadmin‚Äù e a senha ‚ÄúLaurent‚Äù.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mordomo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O sistema </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MajorDoMo √©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bastante popular e n√£o vou me deter aqui em detalhes. </font><font style="vertical-align: inherit;">Sup√µe-se que voc√™ j√° instalou este sistema e trabalhou com ele por algum tempo. </font><font style="vertical-align: inherit;">Para aqueles que n√£o est√£o atualizados, explicarei que essa √© uma plataforma de automa√ß√£o residencial aberta que roda em Windows e Linux e √© baseada em um servidor da web e √© um tipo de CMS (sistema de gerenciamento de conte√∫do) especializado com amplos recursos e "agu√ßado" para automa√ß√£o residencial. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As possibilidades do MajorDoMo s√£o verdadeiramente infinitas e o gerenciamento dos m√≥dulos Laurent √© apenas um dos talentos deste sistema.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Detalhes t√©cnicos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
MajorDoMo incorpora o arquivo laurent.class.php, localizado no diret√≥rio</font></font><br>
<br>
<pre><code class="dos hljs">\htdocs\lib\<font></font>
<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C√≥digo completo laurent.class.php</font></font></b><div class="spoiler_text">&lt;?<br>
<br>
function laurent_command($host, $command, $password='Laurent') {<br>
<br>
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);<br>
 if ($socket === false) {<br>
 echo ¬´socket_create() failed: reason: ¬ª. socket_strerror(socket_last_error()). "\n";<br>
 return 0;<br>
 }<br>
<br>
$result = socket_connect($socket, $host, 2424);<br>
 if ($result === false) {<br>
 echo ¬´socket_connect( $socket, $host, 2424) failed.\nReason: ($result) ¬ª. socket_strerror(socket_last_error($socket)). "\n";<br>
 return 0;<br>
 }<br>
<br>
$in='$KE'."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "\n"))) {<br>
 break;<br>
 }<br>
 }<br>
<br>
$in='$KE,PSW,SET,'.$password."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "\n"))) {<br>
 break;<br>
 }<br>
 }<br>
<br>
$in=$command."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "\n"))) {<br>
 break;<br>
 }<br>
 }<br>
<br>
socket_close($socket);<br>
 return trim($res);<br>
 <br>
 }<br>
<br>
function laurent_getStat($host, $password='Laurent') {<br>
<br>
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);<br>
 if ($socket === false) {<br>
 echo ¬´socket_create() failed: reason: ¬ª. socket_strerror(socket_last_error()). "\n";<br>
 return 0;<br>
 }<br>
<br>
$result = socket_connect($socket, $host, 2424);<br>
 if ($result === false) {<br>
 echo ¬´socket_connect( $socket, $host, 2424) failed.\nReason: ($result) ¬ª. socket_strerror(socket_last_error($socket)). "\n";<br>
 return 0;<br>
 }<br>
<br>
$in='$KE'."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "\n"))) {<br>
 break;<br>
 }<br>
 }<br>
<br>
$in='$KE,PSW,SET,'.$password."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "\n"))) {<br>
 break;<br>
 }<br>
 }<br>
<br>
$command='$KE,DAT,ON';<br>
 $in=$command."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
$res='';<br>
 $started=0;<br>
 while ($out = socket_read($socket, 2048, PHP_NORMAL_READ)) {<br>
 $res.=$out;<br>
 if (is_integer(strpos($out, "#TIME,"))) {<br>
 if (!$started) {<br>
 $started=1;<br>
 } else {<br>
 break;<br>
 }<br>
 }<br>
 }<br>
<br>
$command='$KE,DAT,OFF';<br>
 $in=$command."\r\n";<br>
 socket_write($socket, $in, strlen($in));<br>
 sleep(1);<br>
 socket_write($socket, $in, strlen($in));<br>
 socket_write($socket, $in, strlen($in));<br>
<br>
socket_close($socket);<br>
 return trim($res);<br>
 <br>
 }<br>
<br>
?&gt;<br>
<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
e cont√©m tudo o que voc√™ precisa para trabalhar com os m√≥dulos Laurent. </font><font style="vertical-align: inherit;">Este arquivo cont√©m fun√ß√µes na linguagem de programa√ß√£o PHP e, provavelmente, na forma pronta ou com altera√ß√µes m√≠nimas, pode ser transferido para qualquer sistema usando essa linguagem de programa√ß√£o. </font><font style="vertical-align: inherit;">Portanto, se voc√™ tiver um projeto do Smart Home em uma plataforma diferente, poder√° tentar integrar o Laurent ao seu sistema usando esse arquivo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A principal fun√ß√£o usada para controlar o m√≥dulo √©</font></font><br>
<br>
<pre><code class="php hljs">laurent_command(<span class="hljs-string">'&lt; &gt;'</span>, <span class="hljs-string">'&lt;&gt;'</span>, <span class="hljs-string">'&lt;  &gt;'</span>);<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
por exemplo,</font></font><br>
<br>
<pre><code class="php hljs">$result = laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,INF'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
, onde '192.168.2.19' √© o endere√ßo IP do m√≥dulo, '$ KE, INF' √© o pr√≥prio comando, 'Laurent' √© a senha (padr√£o). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O resultado do trabalho da fun√ß√£o entra na vari√°vel $ result, ou seja, a resposta do m√≥dulo, que voc√™ pode analisar e interpretar usando ferramentas PHP padr√£o. A senha √© especificada como √© por padr√£o. Caso voc√™ tenha alterado a senha de acesso ao seu m√≥dulo, ser√° necess√°rio substitu√≠-la por uma nova e na chamada de fun√ß√£o. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo deve ficar claro com a equipe; voc√™ pode pegar qualquer comando do diret√≥rio e gerenciar o m√≥dulo como desejar. O endere√ßo IP tamb√©m n√£o deve causar problemas. Basta especificar o endere√ßo IP que o seu m√≥dulo Laurent realmente possui.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voc√™ pode encerrar a teoria com isso e agora mostrarei um exemplo pr√°tico de como fazer com que a luz (ou um dispositivo) controle diretamente no menu MajorDoMo.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo pr√°tico</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como exemplo pr√°tico, vejamos a cria√ß√£o de dois bot√µes "Ligar" e "Desligar" no menu principal do sistema MajorDoMo. Com esses bot√µes, voc√™ pode ligar ou desligar a luz ou qualquer outro aparelho el√©trico (basta lembrar que os rel√©s instalados no m√≥dulo n√£o s√£o capazes de controlar diretamente uma carga poderosa como um fog√£o el√©trico ou um aquecedor de √°gua). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, criamos o bot√£o "Ativar", para isso, vamos ao painel de administra√ß√£o do MajorDoMo e inserimos o nome de usu√°rio e a senha (admin / admin por padr√£o) e clicamos em "OBJETOS / Menu de Controle" e, em seguida, no grande bot√£o verde "Adicionar uma nova se√ß√£o". </font></font><br>
<br>
<img src="https://habrastorage.org/files/fb3/4af/d8b/fb34afd8babe4df5a78392f9b6025857.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, encontramos a lista suspensa ‚ÄúTipo‚Äù e selecionamos ‚ÄúBot√£o‚Äù de toda a variedade de tipos apresentados e clique em ‚ÄúSalvar‚Äù.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2de/95f/137/2de95f13747c4887b12cc1a6b51315ae.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, selecione "Item do menu principal" √© o local onde nosso bot√£o "engancha". </font><font style="vertical-align: inherit;">Eu tenho Laurent, e voc√™ pode ter qualquer item de menu conveniente. </font><font style="vertical-align: inherit;">Por padr√£o, existe "ROOT", o que significa que o bot√£o ficar√° vis√≠vel imediatamente, sem clicar em nenhum item do menu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No campo de entrada "T√≠tulo", escreva o que deseja que seja escrito no bot√£o. </font><font style="vertical-align: inherit;">E, finalmente, no campo C√≥digo, escreva o c√≥digo da fun√ß√£o laurent_command j√° familiar para n√≥s:</font></font><br>
<br>
<pre><code class="php hljs">laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,REL,2,1'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui √© o mesmo que no exemplo te√≥rico, apenas a vari√°vel $ result est√° ausente (n√£o precisamos dela) e o comando √© substitu√≠do por '$ KE, REL, 2,1', o que significa ativar o rel√© n¬∫ 2. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fazemos o mesmo no bot√£o "Desligar", mas n√£o esque√ßa de alterar o nome do bot√£o e, em vez de '$ KE, REL, 2.1' escreva '$ KE, REL, 2.0', o que significa desativar o rel√© n¬∫ 2:</font></font><br>
<br>
<pre><code class="php hljs">laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,REL,2,0'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Isso √© tudo. </font><font style="vertical-align: inherit;">Recarregamos a p√°gina com a interface MajorDoMo. Aparecem dois novos bot√µes que ligam e apagam as luzes (ou o appliance) diretamente da interface MajorDoMo, de forma bonita e quase sem demora. </font><font style="vertical-align: inherit;">O que quer√≠amos alcan√ßar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controle autom√°tico</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos tentar controlar o m√≥dulo automaticamente, sem interven√ß√£o humana. </font><font style="vertical-align: inherit;">Agora voc√™ ver√° que √© ainda mais f√°cil do que usar os bot√µes para controlar o m√≥dulo. </font></font><br>
<br>
<img src="https://habrastorage.org/files/13a/34b/f74/13a34bf74e8943b5a0613e972ef09b85.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontramos no menu principal do painel de administra√ß√£o do MajorDoMo o item "Objetos", clique nele e, em seguida, encontramos o objeto "ClockChime" e seu m√©todo "onNewMinute". </font><font style="vertical-align: inherit;">N√≥s precisamos dele. </font><font style="vertical-align: inherit;">Para quem n√£o conhece, esse √© o m√©todo "central" MajorDoMo, chamado a cada minuto e muito popular. </font><font style="vertical-align: inherit;">√â nesse m√©todo que existem muitas fun√ß√µes e chamadas de script que fornecem a funcionalidade do usu√°rio do sistema.</font></font><br>
<br>
<img src="https://habrastorage.org/files/1c6/88b/2ea/1c688b2ead4642b4934a67a00b19d9d2.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E tudo o que precisamos fazer √© adicionar nosso c√≥digo a esse m√©todo. </font><font style="vertical-align: inherit;">Por exemplo, considere esta situa√ß√£o. </font><font style="vertical-align: inherit;">Seu m√≥dulo Laurent controla a ilumina√ß√£o noturna no p√°tio da sua casa. </font><font style="vertical-align: inherit;">E voc√™, por exemplo, deseja que a luz acenda √†s 21h00 e apague √†s 7h30 da manh√£. </font><font style="vertical-align: inherit;">Nada √© mais simples, eis o c√≥digo que voc√™ deve adicionar ao m√©todo onNewMinute:</font></font><br>
<br>
<pre><code class="php hljs"><span class="hljs-keyword">if</span> (timeIs(<span class="hljs-string">'21:00'</span>)) {<font></font>
  laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,REL,2,1'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword">if</span> (timeIs(<span class="hljs-string">'7:30'</span>)) {<font></font>
  laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,REL,2,0'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
}<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E √© isso! </font><font style="vertical-align: inherit;">Concordo, n√£o √© nada dif√≠cil. </font><font style="vertical-align: inherit;">Este √© apenas um exemplo, a l√≥gica do trabalho pode ser absolutamente toda e muito sofisticada. </font><font style="vertical-align: inherit;">E o talento dos m√≥dulos Laurent n√£o termina com a ativa√ß√£o e desativa√ß√£o de cargas, sua funcionalidade √© muito mais ampla, mas esse n√£o √© o t√≥pico deste artigo; aqui, consideramos apenas os problemas de integra√ß√£o com exemplos simples.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recebendo e emitindo dados do m√≥dulo</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o √∫ltimo exemplo ser√° como obter e exibir informa√ß√µes recebidas do m√≥dulo Laurent na p√°gina da web do MajorDoMo. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O MajorDoMo √© um sistema orientado a objetos e todo o trabalho ocorre atrav√©s da cria√ß√£o de objetos e do uso de seus dados (vari√°veis) e m√©todos (c√≥digo do programa). Um pouco dif√≠cil? Na verdade, est√° tudo bem e agora voc√™ ver√° por si mesmo. </font></font><br>
<br>
<img src="https://habrastorage.org/files/adc/f9a/1c0/adcf9a1c0940400798e8392da8690c52.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, por exemplo, usaremos o objeto "ThisComputer" j√° existente e adicionaremos a ele uma nova propriedade "test". Para fazer isso, clique no item de menu "Objetos" que j√° nos √© familiar na √°rea administrativa do MajorDoMo, localize o objeto "ThisComputer" e clique no item "Propriedades", role para baixo e localize o campo de entrada "Adicionar nova propriedade", insira "teste" e clique em "Atualizar" (deixe o valor em branco).</font></font><br>
<br>
<img src="https://habrastorage.org/files/81a/bd8/8f8/81abd88f8596487ca7415eb6526d6d40.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Com isso, as opera√ß√µes preparat√≥rias podem ser consideradas conclu√≠das, adicionamos uma nova propriedade "test" ao objeto "ThisComputer", que usaremos em nossos experimentos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora, nossa tarefa √© solicitar as informa√ß√µes necess√°rias do m√≥dulo Laurent e coloc√°-las na propriedade (vari√°vel) do "teste" do objeto "ThisComputer". </font><font style="vertical-align: inherit;">Como fazer isso? </font><font style="vertical-align: inherit;">Muito simples. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicione este c√≥digo ao m√©todo onNewMinute que j√° sabemos:</font></font><br>
<br>
<pre><code class="php hljs">$result = laurent_command(<span class="hljs-string">'192.168.2.19'</span>, <span class="hljs-string">'$KE,INF'</span>, <span class="hljs-string">'Laurent'</span>);<font></font>
setGlobal(<span class="hljs-string">'ThisComputer.test'</span>, $result); <font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E a cada minuto, o MajorDoMo solicita ao m√≥dulo as informa√ß√µes necess√°rias e atualiza a vari√°vel "test", que podemos usar conforme necess√°rio. </font><font style="vertical-align: inherit;">Por exemplo, exibir em uma p√°gina da web. </font><font style="vertical-align: inherit;">Para fazer isso, colocamos o seguinte c√≥digo em qualquer lugar da p√°gina que precisamos:</font></font><br>
<br>
<pre><code class="php hljs">%ThisComputer.test%<font></font>
<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Este √© o chamado. </font><font style="vertical-align: inherit;">uma macro que, ao carregar uma p√°gina, substitui o valor da vari√°vel em vez de si mesmo, armazenada na propriedade "test" do objeto "ThisComputer". </font><font style="vertical-align: inherit;">E, como resultado, voc√™ v√™ as informa√ß√µes transmitidas pelo m√≥dulo Laurent em resposta √† sua solicita√ß√£o na p√°gina da web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como adicionar uma macro √† p√°gina? </font><font style="vertical-align: inherit;">Vamos ao menu do administrador e selecionamos o item "P√°ginas iniciais" e selecionamos qualquer p√°gina que voc√™ deseja ou cria uma nova usando o grande bot√£o verde "Nova p√°gina". </font><font style="vertical-align: inherit;">E adicione a macro a qualquer local desejado na p√°gina.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Subtotal</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o √© s√≥ isso. </font><font style="vertical-align: inherit;">Armado com as informa√ß√µes deste artigo, voc√™ pode se sentir um verdadeiro mestre dos Laurents e integrar esses m√≥dulos ao seu sistema Smart Home. </font><font style="vertical-align: inherit;">E no pr√≥ximo artigo da s√©rie, voc√™ aprender√° como gerenciar m√≥dulos a partir de seus esbo√ßos no Arduino e no sistema </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arduino Mega Server</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt384485/">https://habr.com/ru/post/pt384485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt384475/index.html">A revis√£o n√£o √© um gadget. Escolhendo o melhor estojo de treinamento e outros acess√≥rios para smartphones: curativos Adidas, bolsas e bolso de silicone</a></li>
<li><a href="../pt384477/index.html">NASA testar√° a tecnologia de desenvolvimento de aster√≥ides usando luz solar</a></li>
<li><a href="../pt384479/index.html">Desenvolvimento de jogos em Processing com controle via placa Arduino Uno</a></li>
<li><a href="../pt384481/index.html">A guerra for√ßou os cientistas s√≠rios a reabastecer os estoques de sementes do "Cofre do Dia do Ju√≠zo Final"</a></li>
<li><a href="../pt384483/index.html">–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω —Å –∑–∞—Ä—è–¥–∫–æ–π –æ—Ç —Å–æ–ª–Ω–µ—á–Ω—ã—Ö –±–∞—Ç–∞—Ä–µ–π. RC 1.0</a></li>
<li><a href="../pt384487/index.html">Can√ß√£o "Parab√©ns pra voc√™" por ordem judicial anunciada publicamente</a></li>
<li><a href="../pt384489/index.html">–ù–æ–≤—ã–π —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Ç–≤–µ—Ä–¥–æ—Ç–µ–ª—å–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å –æ—Ç –∫–æ—Ä–µ–π—Å–∫–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è ‚Äî Samsung 950 Pro</a></li>
<li><a href="../pt384491/index.html">Rob√¥s estacionam melhor que humanos</a></li>
<li><a href="../pt384493/index.html">Rel√≥gio eletr√¥nico Qlocktwo-style</a></li>
<li><a href="../pt384499/index.html">Acer Revo One: –º–∏–Ω–∏–∞—Ç—é—Ä–Ω—ã–π –∫–æ–º–ø—å—é—Ç–µ—Ä —à–∏—Ä–æ–∫–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞ –¥–µ–π—Å—Ç–≤–∏—è</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>