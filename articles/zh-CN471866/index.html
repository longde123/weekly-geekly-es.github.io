<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💇🏽 🌾 🤘🏻 PEG解析器可视化 🤱🏻 🍑 💨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="上一次，我们获得了一个简单的PEG解析器生成器。 现在，我将展示在解析程序时生成的解析器实际执行的操作。 我深入研究了ASCII艺术的复古世界，特别是一个名为“ curses”的库，该库可在Linux和Mac的标准Python发行版中找到，以及Windows的附加组件。 
 Python PEG解析...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PEG解析器可视化</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471866/"><p> 上一次，我们获得了一个简单的PEG解析器生成器。 现在，我将展示在解析程序时生成的解析器实际执行的操作。 我深入研究了ASCII艺术的复古世界，特别是一个名为“ curses”的库，该库可在Linux和Mac的标准Python发行版中找到，以及Windows的附加组件。 </p><br><div class="spoiler">  <b class="spoiler_title">Python PEG解析器系列内容</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">钉解析器</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PEG解析器实现</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PEG解析器生成</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PEG解析器可视化</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">左递归PEG语法</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向PEG语法添加动作</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PEG解析器的元语法</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">实施PEG的其余功能</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">核心开发者Sprint上的PEG</a> </li></ul></div></div><br><p><img src="https://habrastorage.org/webt/fr/cj/o-/frcjo-fmvrqbs0ddzsesm--dg2w.png"></p><br><p>  &lt;在文章的结尾，在扰流板下面给出了一个gif。 在我看来，比静态图片更容易理解&gt; </p><a name="habracut"></a><br><p>让我们看一下可视化。 屏幕按照连字符形式分为三部分（按ASCII惯例）： </p><br><ul><li> 上部显示了解析器的调用堆栈，您还记得，它是具有无限返回的递归下降分析器。 下面我将更详细地解释。 </li><li> 中间的单行部分显示了令牌缓冲区的内容，其中光标指向下一步将要分析的令牌。 </li><li> 下面我们可视化packrat解析器算法使用的缓存。 记录其元素有点类似于解析器堆栈的某些元素（带有结果）。 </li></ul><br><p> 为了理解此可视化，您需要了解的主要内容是上部和下部中的线的缩进对应于令牌缓冲区。 </p><br><ul><li>前两行（以<code>statement</code>和<code>assignment</code>开头）显示了对当前正在执行分析的相应解析器方法的调用。 当令牌生成器指针位于第一个令牌（ <code>'aap'</code> ）之前时，将调用它们。 </li><li> 接下来的两行（以<code>expr</code>和<code>term</code>开头）与<code>'cat'</code>令牌的开头对齐，在该令牌中调用了相应的解析器方法。 </li><li> 堆栈渲染的第五行也是最后一行显示了对<code>expect('/')</code>的调用，该调用返回<code>None</code> 。 他自愿担任<code>'+'</code>币职位。 </li></ul><br><p> 高速缓存中项目的缩进还对应于令牌缓冲区中的位置。 例如，在高速缓存的底部有否定条目，它们是在令牌缓冲区的开头查找<code>'if'</code>令牌和<code>if_statement</code>规则时获得的。 我们还找到了与其他输入位置相对应的令牌<code>'='</code>和<code>NAME</code> （尤其是<code>'cat'</code> ）成功的缓存条目。 </p><br><p> 在分析器堆栈块和缓存块中，返回的调用都显示为<code>function(args) -&gt; result</code> 。 有时，解析器堆栈上会显示几个返回的方法-我这样做是为了减少频繁更改内容引起的文本抖动。 </p><br><p>  （谈到抖动，当将调用添加到堆栈中时，分析器堆栈的顶行向上移动，而从堆栈中删除时则下降至少对我来说，看屏幕的这一部分不是问题，也许我们大脑的很大一部分都专用于跟踪运动对象。 </p><br><p> 高速缓存呈现为LRU，常用项目位于顶部； 屏幕上会出现更多稀有商品。  （我在之前的文章中展示的原型packrat解析器没有使用LRU，但是优化内存消耗可能是一个好主意。） </p><br><p> 让我们看一下渲染解析栈时的一些细节。 前四个条目与仍在处理的解析器方法相对应，每行是语法中的一行。 突出显示的项目是产生下一个挑战的项目。 </p><br><p> 即 从屏幕截图来看，我们可以使用第二种<code>statement</code> ，即<code>assignment</code> 。 在此规则中，我们处于第三点，即<code>expr</code> 。 在<code>expr</code>规则中，我们仅位于第一个替代方案的第一段（ <code>term '+' expr</code> ）； 在<code>term</code>规则中，我们处于最后一个替代方案（ <code>atom</code> ）中。 </p><br><p> 在下面，我们看到导致第二种选择（ <code>atom '/' term</code> ）失败的结果： <code>expect('/') -&gt; None</code>与令牌<code>'+'</code>缩进。 在下一步中，我们将看到它如何进入缓存。 </p><br><p> 但可以肯定的是，您希望自己看到整个动画！ </p><br><div class="spoiler">  <b class="spoiler_title">我记录了对示例程序的完整分析</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xi/vm/5g/xivm5g5d640s54ni3urif6qsbl8.gif"></p></div></div><br><p> 您也可以使用现成的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">代码</a> ，但是请记住，这不是运动。 </p><br><p> 当您查看<a href="">记录的GIF时</a> ，有时不显示下一个标记似乎有些奇怪（例如，在检测到<code>'aap'</code>标记之前，堆栈一开始就增长了几条记录）。 这正是分析器所看到的：令牌缓冲区被延迟填充。 在解析器通过调用<code>expect()</code>函数请求令牌之前，不会对令牌进行扫描。 令牌一旦进入缓冲区，它将立即保留在该缓冲区中，即使分析器将令牌序列后退。 反向跟踪显示在令牌缓冲区中，并且光标向左跳转； 记录中有很多这样的情况。 当分析器未进行其他递归调用时，您还可以观察缓存填充。  （我必须突出显示发生这种情况的时间，但是我没有足够的时间。） </p><br><p> 下周，我将开发一个解析器，也许会增加我对递归语法左规则的看法。  （他们很棒！） </p><br><p> 致谢：为了记录，我使用<code>ttygif</code>来自Ilya Choli的ttygif和来自Matthew Jording的ttyrec。 </p><br><p> 本文和引用代码的许可： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CC BY-NC-SA 4.0</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN471866/">https://habr.com/ru/post/zh-CN471866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN471856/index.html">我们解决了所有42个版本的哈利波特魔药</a></li>
<li><a href="../zh-CN471858/index.html">RabbitMQ与Kafka：群集中的故障转移和高可用性</a></li>
<li><a href="../zh-CN471860/index.html">钉解析器</a></li>
<li><a href="../zh-CN471862/index.html">PEG解析器实现</a></li>
<li><a href="../zh-CN471864/index.html">PEG解析器生成</a></li>
<li><a href="../zh-CN471872/index.html">C＃8中的接口：默认实现中的危险假设</a></li>
<li><a href="../zh-CN471874/index.html">我们如何绕过审核指南并在电话上启动服务器</a></li>
<li><a href="../zh-CN471876/index.html">PDU和所有所有功能：机架配电</a></li>
<li><a href="../zh-CN471878/index.html">如何在本体网络上为WebAssembly编写智能合约？ 第1部分：铁锈</a></li>
<li><a href="../zh-CN471882/index.html">GitHub上的PHP事件，发言人和组织者的开放列表</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>