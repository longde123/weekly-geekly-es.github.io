<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❎ 👨🏽‍💼 👩🏽‍🚒 STM8S Slow Start lernen. Teil 0 👩‍👧‍👧 👵🏻 🖐🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die MK- Familie STM8S verfügt im Vergleich zum STM8L / 32 über ein kleineres Arsenal an Peripheriegeräten, ermöglicht es Ihnen jedoch, die Grundlagen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>STM8S Slow Start lernen. Teil 0</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465597/"> <abbr title="Mikrocontroller">Die MK-</abbr> Familie STM8S verfügt im Vergleich zum STM8L / 32 über ein kleineres Arsenal an Peripheriegeräten, ermöglicht es Ihnen jedoch, die Grundlagen leicht zu verstehen und die erforderlichen Fähigkeiten für die Arbeit mit seinen älteren Brüdern zu erwerben. <br><br><h2>  0. An wen richtet sich das Material, warum und warum </h2><br>  Beim Schreiben dieses Artikels gehe ich davon aus, dass der Leser: <br><br><ul><li>  Lesen Sie sorgfältig (was selten ist) </li><li>  Ein wenig Arbeit mit englischsprachiger Fachliteratur (na ja, oder die Motivation zum Lernen, denn die Muttersprache des Programmierers ist Englisch) </li><li>  Löten (zumindest minimale Fähigkeiten) </li><li>  Programmieren in C (wieder ist nicht alles so kompliziert) </li><li>  Google (ohne es irgendwo) </li><li>  Verwenden Sie ein Multimeter und verfügen Sie über andere grundlegende Fähigkeiten (z. B. „Stecken Sie Ihre Finger nicht in die Steckdose“). </li></ul><br>  Ich betrachte die Ziele des Artikels: <br><br><ul><li>  Übersicht für alle Phasen der Entwicklung eines Systems auf Basis eines Mikrocontrollers </li><li>  Geben Sie die notwendigen einleitenden Anmerkungen für eine Person, die praktisch nicht engagiert ist </li><li>  Wenn möglich, hat der Leser ein Verständnis dafür, wo, was und wie zu finden ist </li></ul><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">(Nicht signifikant)</b> <div class="spoiler_text">  Warum und warum? <br><br>  Ich denke, es ist sinnvoll, einen detaillierten MK-Programmierkurs zu machen. <br><br>  Ich werde eine Gelegenheit sein, die gesamte Peripherie genauer zu studieren und dabei anderen zu helfen. <br>  Ich weiß, dass es bereits eine große Anzahl von Artikeln und sogar Schulungen gibt, aber ich habe einen etwas anderen Ansatz.  (Vielleicht werde ich angemessene Kritik bekommen, meine Meinung ändern und mich den MX Cube-Jungs anschließen). <br><br>  Es ist traurig zu sehen, wie sich stm-Controller in Arduino verwandeln. <br><br>  In Bezug auf Arduino: <br><br>  Es gibt 3 (mir bekannt, MB, ich bin einfach nicht gewachsen) Ansätze zur <abbr title="Software">Softwareentwicklung</abbr> auf MK: <br><br><ol><li>  Assembler-Entwicklung </li><li>  Entwicklung für ein bestimmtes MK-Modell </li><li>  Entwicklung mit HAL und ähnlichen Bibliotheken </li></ol><br>  1) Ich bin ein Befürworter der Meinung, dass Sie, wenn Sie ein Haus bauen, nicht jeden Lehmziegel mit Ihren eigenen Händen verbrennen sollten, da der Monteur verschwindet (obwohl dies damit begann).  Entwicklungsgeschwindigkeit zu niedrig. <br><br>  2) HAL-Bibliotheken usw.  Für einen Anfänger sind zu viele Momente „schreibe einfach so“ undurchsichtig.  Weil - auch im Müll. <br><br>  3) Ich halte den Prozess der Erstellung von Software für einen bestimmten MK für die gesündeste Option für Anfänger. Die erworbenen Fähigkeiten ermöglichen den Umgang mit 8L- und 32-Serien (obwohl es laut Dokumentation weh tut, dies alleine zu tun). <br><br>  Sie haben wahrscheinlich bemerkt, dass Arduino nicht in dieser Liste aufgeführt ist, da es sich um eine <u>Bildungsplattform handelt</u> und nicht für die Entwicklung kompakter Geräte auf dieser Basis vorgesehen ist.  Aber der Ansatz, es aus irgendeinem Grund zu programmieren (ich weiß es nicht), wird übertragen und verbreitet sich über das Internet.  Und sogar in echten kommerziellen Projekten eingesetzt.  (steht für "Ich habe die Bibliothek im Forum heruntergeladen, verbunden, es hat funktioniert, ich weiß nicht, wie es funktioniert"). <br><br>  Ich schlage aus meiner Sicht einen akademisch und methodisch sinnvolleren Ansatz vor. <br></div></div><br><h2>  1. Die Wahl des Mikrocontrollers </h2><br>  Ich habe mehrere STM8S105K6 im LQFP32-Paket, es ist aus dieser Familie, also wähle ich es. <br><br>  Sie können jeden MK innerhalb der Serie auswählen. <br><br>  Es gibt fertige Discovery-Boards von ST, die Sie bei den Chinesen kaufen oder bei anderen Anbietern bestellen können.  Es gibt fertige Boards für den STM8S103F3P6 und dergleichen von den Chinesen. <br><br>  Es ist jedoch zu beachten, dass vorgefertigte Boards für das Training ausgelegt sind. <br><br>  Auf der Website des Herstellers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">st.com</a> finden wir unseren MK und laden Dokumente herunter: <br><br>  Referenzhandbuch: RM0016 - ein gemeinsames Dokument für alle MK-Familien STM8S und STM8AF.  Als nächstes kommt RM. <br>  Datenblatt: Ich habe ein DS5855-Dokument für STM8S105C4 / 6, STM8S105K4 / 6 und STM8S105S4 / 6.  Als nächstes kommt DS. <br><br>  Von den köstlichen Dingen, die er (oberflächlich) hat: <br><br><ul><li>  16 MHz Unterstützung </li><li>  32 KB Flash, 1 KB EEPROM und 2 KB RAM </li><li>  Stromversorgung 2,95-5,5 V. </li><li>  8-Bit- und 16-Bit-Timer </li><li>  UART, SPI, I2C </li><li>  10-Bit- <abbr title="Analog-Digital-Wandler">ADC</abbr> </li><li>  Bis zu 38 diskrete Ein- / Ausgänge </li></ul><br><h2>  2. Erforderliche Ausrüstung </h2><br>  Ich sehe zwei Möglichkeiten für die Arbeit mit MK: <br><br><ol><li><div class="spoiler">  <b class="spoiler_title">Zusammenstellen eines Layouts aus einzelnen Komponenten</b> <div class="spoiler_text">  Großartig, cool, ich mag es.  So viele Leute tun es. <br><br>  In diesem Fall benötigt der MK das sogenannte Strapping.  Der Plan ist einfach: <br><br><ol><li>  Wir nehmen ein Steckbrett, in meinem Fall TQFP (32-64PIN) 0,8 MM, und löten MK darauf </li><li>  Wir nehmen ein zweireihiges Kamm-PLS-2x40-Lot in die Löcher, die zu den Schlussfolgerungen von MK führen </li><li>  Wir nehmen ein bedrucktes Steckbrett (ich habe 9x15 cm) und löten das letzte Sandwich darauf </li><li>  Wir betrachten RM Punkt 7. Stromversorgung, <u>lesen wir</u> .  Es steht geschrieben, dass Sie einen Kondensator benötigen, der den VCAP-Pin und unser 0-V-Netzteil verbindet.  Es wird auch geschrieben, dass Sie in DS detaillierter auf einen bestimmten MK im Abschnitt über die elektrischen Eigenschaften eingehen müssen.  Für mich ist dies Abschnitt 10.3.1 des externen VCAP-Kondensators unter Bezugnahme auf Tabelle 18, in der der Nennwert 470 - 3300 nF beträgt.  Ich nahm 1 mF (in Schaltung C3).  (warum du es brauchst, ich hoffe du liest es selbst in RM) </li><li>  Ebenda. In DS in Abschnitt 10.3.8.  Pin-Eigenschaften zurücksetzen Wir finden die Kondensatorleistung 0,1 mF (auf der Schaltung C4).  Der Widerstand R4 mit einem Nennwert von 10 kOhm wird in Debug-Boards und verschiedenen Anwendungshinweisen verwendet, obwohl im MK bereits ein Pull-up-Widerstand mit einem Nennwert von 30 bis 80 kOhm vorhanden ist (wenn Sie den gleichen DS glauben).  Parallel zum Kondensator C4 setzen wir unseren Reset-Knopf.  Ein solches Rücksetzmuster ist beispielsweise in der Desighn-Notiz DN0005 zu sehen. </li><li>  Außerdem fügt ST den Debug-Boards gerne 100-nF-Leistungskondensatoren hinzu, und zwar in der Anzahl der N-Pins, die an +1 Leistung angeschlossen sind.  Das Diagramm zeigt nur C1, C2 und C5 3 Teile, und ich habe sie nicht auf die Platine gelötet, aber Sie haben die Bedeutung verstanden.  Ohne sie wird es auf dem Tisch funktionieren, aber in der realen kommerziellen Entwicklung ist es besser, sich um diese Angelegenheit zu kümmern, wenn die Geräteplatine gezüchtet wird. </li><li>  Lösen Sie den SWIM-Programmieranschluss (ich mache aus PLS-1x40) </li></ol><br>  Ich habe so ein Wunder: <br><br><img src="https://habrastorage.org/webt/oh/ll/d5/ohlld5z9iiuxmlnc6djwgbqe_-w.png"><br></div></div></li><li><div class="spoiler">  <b class="spoiler_title">Kauf einer fertigen Platine (was Sie nicht vor der Arbeit mit einem Lötkolben bewahrt)</b> <div class="spoiler_text">  Großartig, cool, ich mag es.  So viele Leute tun es. <br><br>  Es lohnt sich, sich mit der Konfiguration der Karte vertraut zu machen. Wenn es sich um eine Karte von ST handelt, ist sie sofort beim Programmierer und wird mit einem USB-Kabel vom Typ B angeschlossen.  Die ST-Site enthält ein Diagramm auf der Produktseite.  Auf dem Brett befinden sich Tasten, LEDs, Hochtöner, kapazitive Tasten und andere Charms, mit denen Sie spielen können. <br><br>  Wenn das Board chinesisch ist, benötigen Sie häufig einen Programmierer. <br><br>  Siebdrucke der Namen der Schlussfolgerungen sind besser nicht zu glauben und im Vergleich zu DS zu überprüfen. <br></div></div></li></ol><br>  Ich denke nicht daran, mit Kontakt-Steckbrettern zu arbeiten, weil ich sie nicht benutze. <br><br>  Außerdem brauche ich einen Programmierer, ich habe einen chinesischen ST-Link V2.  Kann programmieren und STM8 und STM32. <br><br><h2>  3. Auswählen einer IDE </h2><br>  Für mich ist die Frage der Wahl noch nicht relevant, ich arbeite im IAR für STM8, weil es ein Projekt gemacht hat, an dem ich gerade arbeite, aus dem gleichen Grund die alte Version. <br><br>  Wir gehen auf die Seite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">iar.com</a> , bei der Suche geben wir das Modell unseres MK ein. <br>  Laden Sie die IAR Embedded Workbench für STM8 herunter, wählen Sie bei der Installation die größenbeschränkte Auswertung aus und legen Sie ein Limit von 8 KB Code fest.  Oder kaufen.  Es gibt gehackte Versionen von Ressourcen, die auf dem Territorium der Russischen Föderation verboten sind, aber sie sind nicht für kommerzielle Projekte geeignet. <br><br>  Installationsanweisungen finden Sie im Installationsprogramm oder in Google. <br>  Ich verwende Version 6.5.3.2581. <br>  Installieren Sie die Umgebung und den Treiber für den Programmierer. <br><br><h2>  4. Erstellen eines Projekts </h2><br>  Gehen Sie zur IDE, gehen Sie zu Projekt -&gt; Neues Projekt erstellen -&gt; C ++ <br><br>  Klicken Sie auf OK, wählen Sie das Verzeichnis aus (vorzugsweise ohne Kyrillisch und Leerzeichen) und wählen Sie den Namen (ohne Leerzeichen und Kyrillisch). <br><br>  Wir gehen zum Stammordner unserer IDE und suchen den inc-Ordner, für mich den Pfad: <br><br><pre><code class="plaintext hljs">C:\Program Files (x86)\IAR Systems\Embedded Workbench 6.5\stm8\inc</code> </pre> <br><br>  Unter den iostm8-Header-Dateien finden wir für mich unser MK-Modell: <br><br><pre> <code class="plaintext hljs">iostm8s105k6.h</code> </pre> <br>  Wir verbinden es ganz am Anfang und fügen eine Endlosschleife hinzu. <br><br><div class="spoiler">  <b class="spoiler_title">Ergebnis:</b> <div class="spoiler_text"><pre> <code class="cmake hljs"><span class="hljs-comment"><span class="hljs-comment">#include&lt;iostm8s105k6.h&gt; //  int main() { while(1){ //  } return 0; }</span></span></code> </pre><br></div></div><br>  Wählen Sie im Menü Projekt -&gt; Optionen -&gt; Allgemeine Optionen in der Spalte Gerät Ihren MK aus. <br><br>  Wählen Sie unter Projekt -&gt; Optionen -&gt; Debugger in der Spalte Treiber die Option ST-LINK. <br><br>  Suchen Sie die Schaltfläche Herunterladen und Debuggen in der Symbolleiste. <br>  Bei der ersten Kompilierung werden Sie von der Umgebung aufgefordert, den Namen der .eww-Datei auszuwählen.  (Ich nenne das gleiche wie das Projekt.) <br><br>  Am unteren Rand des Debug-Protokoll-Fensters sollten folgende Meldungen angezeigt werden: <br><br><ul><li>  Präprozessor für STM8 - Präprozessor gestartet </li><li>  Debugger für STM8 - Debugger gestartet </li><li>  Verbunden mit dem STM8 SWIM Debugging System - verbunden mit MK </li><li>  Geladener Debugee - Firmware-Download ist aufgetreten </li><li>  Ziel-Reset - Ein Reset ist aufgetreten </li></ul><br>  Wir sind im Debug-Modus, aber das Programm ist angehalten. <br>  An derselben Stelle in der Symbolleiste finden wir die Schaltfläche Los und drücken sie. <br>  Wir haben MK im Debug-Modus gestartet. <br><br>  Klicken Sie auf Debugging beenden, Debugging stoppt, aber der MK wird vom Programmierer betrieben und führt dann das Programm aus, dh er dreht eine Endlosschleife und tut nichts. <br><br><h2>  Zusammenfassung </h2><br>  Das Ergebnis war ein kurzer Überblick und eine Einführung in die Programmierung der STM8S-MK-Serie ohne Programmierung.  Es stellte sich heraus, dass dies nur die Grundlage für die Arbeit war. Von hier aus beginnt normalerweise alles - mit der Zusammenstellung des Layouts. <br><br>  Ich sehe den Punkt nicht genauer. <br><br>  In vielen Artikeln blinken nach der Einführung buchstäblich nach ein paar Zeilen die LEDs, was ich nicht verstehe. <br><br>  Wie erreicht die Ziele sind, kann daran gemessen werden, ob der Anfänger es geschafft hat, anhand der von mir vorgeschlagenen Informationen selbst etwas zu tun.  (Anzeigefenster Debug-Protokoll) <br><br>  Vielen Dank für Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de465597/">https://habr.com/ru/post/de465597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de465585/index.html">So verwalten Sie React Data Grid über Redux</a></li>
<li><a href="../de465587/index.html">Analyse: Was ist der OTC-Markt und welche Transaktionen werden dort durchgeführt?</a></li>
<li><a href="../de465589/index.html">Pilot- und PoC-Kurzanleitung</a></li>
<li><a href="../de465591/index.html">Die PHP Central Europe-Konferenz wurde abgesagt, da keine Frauen unter den Rednern waren</a></li>
<li><a href="../de465595/index.html">5G kommt zu uns?</a></li>
<li><a href="../de465599/index.html">IPFS ohne Schmerzen (aber das ist nicht genau)</a></li>
<li><a href="../de465601/index.html">Warum brauchen Sie DevOps und wer sind DevOps-Spezialisten?</a></li>
<li><a href="../de465603/index.html">Kurse gegen Praktikum. Wie unterrichten wir Midbells bei SimbirSoft?</a></li>
<li><a href="../de465605/index.html">Das Buch „Deep Reinforcement Learning in Python. OpenAI Gym und TensorFlow für Profis »</a></li>
<li><a href="../de465607/index.html">Lean und Agile in der Softwareentwicklung verstehen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>