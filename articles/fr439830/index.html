<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüöí üòà üë• Inside Quake: Toujours envisager des alternatives üßùüèº üìø üì≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le programmeur Michael Abrash, qui a √©t√© invit√© par John Carmack √† travailler sur le moteur du premier tremblement de terre au milieu des ann√©es 90, a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Inside Quake: Toujours envisager des alternatives</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439830/"><div style="text-align:center;"><img src="https://steemitimages.com/p/USgKopgPmA7SYpFB96Gheb9tK3fTW7Ck3gsGQ8tb7V8UbQnEKC6SXDMMhx5idgb5LV6sCECsXeG3Sjto2AXKzN" alt="image"></div><br>  <i>Le programmeur Michael Abrash, qui a √©t√© invit√© par John Carmack √† travailler sur le moteur du premier tremblement de terre au milieu des ann√©es 90, a √©crit une s√©rie d'articles pendant le processus de d√©veloppement.</i>  <i>Ceci est la deuxi√®me colonne de cette s√©rie.</i>  <i>La traduction du premier est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .</i> <br><br>  Je dois avouer: je me suis lass√© du rock classique.  La derni√®re fois, j'√©tais heureux d'√©couter quelque chose de Cars ou de Boston depuis longtemps, il y a environ 20 ans.  De plus, je n'ai jamais √©t√© particuli√®rement attir√© par Bob Seager et Queen, sans parler d'Elvis, donc peu de choses ont chang√©.  Mais j'ai r√©alis√© que quelque chose a chang√© quand j'ai voulu changer de radio quand j'ai entendu Allman Brothers, ou Steely Dan, ou Pink Floyd, ou, Dieu, pardonnez-moi, les Beatles (mais seulement sur des choses comme "Bonjour au revoir" et "Je vais Pleurez plut√¥t, pas Ticket to Ride ou A Day in the Life; je ne suis pas encore all√© <u>si</u> loin).  Il n'a pas fallu longtemps pour en trouver les raisons;  J'ai √©cout√© les m√™mes chansons pendant un quart de si√®cle et je m'en lasse. <br><br>  Je raconte tout cela parce que lorsque ma fille et moi sommes sortis du caf√© un soir, la station de radio ¬´Il n'y a pas d'alternative¬ª a √©t√© allum√©e pour la premi√®re fois dans la voiture. <br><br>  Nous parlons d'une fillette de dix ans qui a grandi avec un r√©gime constant de vieux tubes.  Elle aime les m√©lodies, les chansons entra√Ænantes et les bons chanteurs.  Vous ne trouverez rien de tout cela en √©coutant une station de rock alternative.  Par cons√©quent, il n'est pas surprenant que lorsque j'ai allum√© la radio, elle ait d'abord dit: "Fu!" <br><br>  Mais voici ce qui m'a surpris: apr√®s avoir √©cout√© pendant un moment, elle a dit: "Tu sais, papa, mais c'est vraiment int√©ressant." <br><br>  Cela ne m'a pas seulement laiss√© entendre quel genre de musique grondait dans la maison quand elle √©tait adolescente.  Son adoption rapide du rock alternatif (par rapport √† ma fascination pour la musique de ma propre jeunesse pendant dix ans) m'a rappel√© quelque chose qui est facilement oubli√© quand on vieillit et que le style de vie s'installe.  Cela m'a rappel√© qu'il √©tait n√©cessaire de garder l'esprit ouvert et de se pr√©parer - en plus, de s'efforcer - pour essayer de nouvelles choses. <a name="habracut"></a>  Les programmeurs ont tendance √† √™tre attach√©s √† des approches famili√®res et sont enclins √† les utiliser s‚Äôils s‚Äôacquittent correctement des t√¢ches.  Mais il y a toujours des alternatives √† la programmation, et je trouve qu'elles valent souvent la peine d'√™tre explor√©es. <br><br>  Mais √©tant donn√© la nature en constante √©volution de <u>Quake</u> , je ne devrais vraiment pas avoir besoin d'un tel rappel. <br><br><h2>  Flux cr√©atif </h2><br>  En janvier, j'ai d√©crit un flux cr√©atif qui a conduit John Carmack √† d√©cider d'utiliser des polygones d'ensemble potentiellement visible (PVS) pr√©calcul√©s pour chaque point de vue possible dans <u>Quake</u> (un jeu que nous d√©veloppons conjointement dans id Software).  Le calcul pr√©liminaire de PVS signifie qu'au lieu de passer beaucoup de temps √† rechercher dans la base de donn√©es des polygones visibles du point de vue actuel dans la base de donn√©es mondiale, nous pouvons simplement dessiner tous les polygones dans le PVS en arri√®re (en prenant l'ordre de l'arbre BSP du monde; discussion sur BSP- voir les arbres dans nos colonnes pour mai, juillet et novembre 1995), et obtenir le rendu de la sc√®ne correctement sans recherche, permettant un rendu en arri√®re pour effectuer la derni√®re √©tape de suppression de la surface cach√©e (HSR).  C'√©tait une id√©e g√©niale, mais pour l'architecture Quake, le chemin n'est pas encore termin√©. <br><br><h2>  Dessin d'objets en mouvement </h2><br>  Par exemple, il y a toujours eu une question sur la fa√ßon de trier et de dessiner correctement les objets en mouvement;  en fait, cette question apr√®s la chronique de janvier a √©t√© pos√©e avant tout, je vais donc lui donner du temps.  Le probl√®me principal est qu'un mod√®le en mouvement peut tomber dans plusieurs feuilles BSP, et lorsque le mod√®le se d√©place, ces feuilles changent;  avec la possibilit√© de trouver plusieurs mod√®les dans une feuille, cela signifie qu'il n'y a pas de moyen facile d'utiliser l'ordre BSP pour dessiner des mod√®les dans un ordre correctement tri√©.  Lorsque j'ai √©crit la colonne de janvier, nous avons dessin√© des sprites (comme des explosions), des mod√®les BSP mobiles (comme des portes) et des mod√®les polygonaux (comme des monstres), tronquant chacun d'eux avec les feuilles qu'ils touchent, puis dessinant les pi√®ces correspondantes lorsque chaque feuille BSP atteignait votre tour lorsque vous vous d√©placez de l'arri√®re vers l'avant.  Cependant, cela n'a pas r√©solu le probl√®me du tri de plusieurs mod√®les mobiles dans une feuille les uns par rapport aux autres, et a √©galement laiss√© des probl√®mes d√©sagr√©ables avec les mod√®les polygonaux complexes. <br><br>  John a r√©solu le probl√®me de tri des sprites et des mod√®les de polygones de mani√®re √©tonnamment low-tech: nous les √©crivons maintenant dans le z-buffer.  (C'est-√†-dire qu'avant de dessiner chaque pixel, nous comparons la distance √† celui-ci, ou z, avec la valeur z du pixel d√©j√† sur l'√©cran. Un nouveau pixel n'est dessin√© que s'il est plus proche que celui existant.) Premi√®rement, nous dessinons le monde principal - murs, plafonds, etc. comme √ßa.  A ce stade, aucun <u>test du</u> z-buffer n'est utilis√© (comme nous le verrons bient√¥t, la d√©finition des surfaces visibles du monde est effectu√©e d'une autre mani√®re);  cependant, nous <u>remplissons le</u> z-buffer <u>avec des</u> valeurs z (en fait 1 / z, comme d√©crit ci-dessous) pour tous les pixels dans le monde.  Remplir un tampon Z est un processus beaucoup plus rapide que ne le ferait le tampon Z dans le monde entier, car il n'y a pas de lecture, pas de comparaison, il suffit d'√©crire des valeurs z.  Apr√®s avoir termin√© le dessin et rempli le z-buffer du monde, nous pouvons simplement dessiner des sprites et des mod√®les polygonaux en utilisant le z-buffer et obtenir le tri parfait. <br><br>  Lorsque vous utilisez le z-buffer, des questions se posent in√©vitablement: comment cela affecte-t-il la m√©moire occup√©e et les performances?  √Ä une r√©solution de 320x200, il n√©cessite 128 Ko de m√©moire, ce qui n'est pas anodin, mais pas tant pour un jeu qui n√©cessite 8 Mo pour fonctionner.  Impact sur les performances: environ 10% lors du remplissage du z-buffer du monde, et environ 20% (les indicateurs varient consid√©rablement) lors du rendu des sprites et des mod√®les polygonaux.  En retour, nous obtenons un monde parfaitement tri√©, ainsi que la possibilit√© de cr√©er des effets suppl√©mentaires, par exemple, des explosions et de la fum√©e de particules, car le z-buffer vous permet de trier facilement ces effets dans le monde.  En g√©n√©ral, l'utilisation du z-buffer a consid√©rablement augment√© la qualit√© visuelle et la flexibilit√© du moteur Quake, ainsi que consid√©rablement simplifi√© le code, au prix de co√ªts de m√©moire et de performances tout √† fait raisonnables. <br><br><h2>  Nivellement et augmentation de la productivit√© </h2><br>  Comme je l'ai dit ci-dessus, l'architecture <u>Quake</u> dessine d'abord le monde lui-m√™me, sans lire ni comparer le z-buffer, remplissant simplement le z-buffer avec les valeurs des polygones du monde en z.  Apr√®s cela, les objets en mouvement sont dessin√©s au-dessus du monde √† l'aide de la mise en m√©moire tampon z compl√®te.  Jusqu'√† pr√©sent, je n'ai parl√© que de la fa√ßon de dessiner des objets en mouvement.  Dans le reste de la colonne, je vais parler d'une autre partie de l'√©quation de rendu - dessiner le monde lui-m√™me, lorsque le monde entier est stock√© dans un seul arbre BSP et ne bouge jamais. <br><br>  Comme vous vous en souvenez de la colonne de janvier, nous √©tions inquiets √† la fois des performances brutes et de sa moyenne.  Autrement dit, nous voulions que le code de rendu soit ex√©cut√© le plus rapidement possible, mais en m√™me temps, afin que la diff√©rence entre la vitesse de rendu de la sc√®ne du milieu et la plus lente dans le rendu de la sc√®ne soit aussi petite que possible.  Il n'y a rien de bon dans les 30 images par seconde en moyenne si 10% des sc√®nes sont dessin√©es √† 5 ips, car les secousses dans ces sc√®nes seront extr√™mement visibles par rapport √† la sc√®ne moyenne.  Il est pr√©f√©rable de faire la moyenne de la fr√©quence avec 15 images par seconde dans 100% des cas, m√™me si la vitesse de rendu moyenne sera deux fois moins √©lev√©e. <br><br>  Les PVS pr√©-calcul√©s √©taient une √©tape importante vers des performances plus √©lev√©es et plus √©quilibr√©es, car ils √©liminaient la n√©cessit√© de d√©terminer des polygones visibles - une √©tape plut√¥t lente qui se manifestait le plus mal dans les sc√®nes les plus complexes.  N√©anmoins, dans certains endroits o√π les niveaux de jeu sont r√©els, les PVS pr√©-calcul√©s contiennent cinq fois plus de polygones qu'on ne le voit r√©ellement;  en conjonction avec le retrait de la surface de masquage vers l'arri√®re (HSR), cela a cr√©√© des ¬´zones chaudes¬ª dans lesquelles la fr√©quence d'images a √©t√© sensiblement r√©duite.  Des centaines de polygones ont √©t√© dessin√©s vers l'avant et la plupart d'entre eux ont √©t√© imm√©diatement redessin√©s par des polygones plus proches.  Les performances brutes dans leur ensemble ont √©galement diminu√© en moyenne de 50% du redessin caus√© par le rendu de tout dans le PVS.  Par cons√©quent, bien que le rendu des ensembles PVS en arri√®re ait fonctionn√© comme la derni√®re √©tape du HSR et √©tait une am√©lioration par rapport √† l'architecture pr√©c√©dente, il n'√©tait pas id√©al.  John pensait qu'il y avait probablement une meilleure fa√ßon d'utiliser PVS que de dessiner d'avant en arri√®re. <br><br>  Et il a en fait √©t√© retrouv√©. <br><br><h2>  Intervalles tri√©s </h2><br>  La derni√®re √©tape HSR id√©ale pour Quake √©tait de supprimer tous les polygones du PVS qui se sont r√©v√©l√©s √™tre invisibles et de dessiner uniquement les pixels visibles des polygones restants sans redessiner.  Autrement dit, chaque pixel serait dessin√© exactement une fois et sans perte de performances, bien s√ªr.  Une solution (n√©cessitant toutefois des co√ªts) consiste √† dessiner d'avant en arri√®re, enregistrer la zone qui d√©crit les parties de l'√©cran qui se chevauchent actuellement et tronquer chaque polygone avec les bordures de cette zone avant le rendu.  Cela semble prometteur, mais en fait, cela rappelle √† peu pr√®s la solution d'arbre de bundle que j'ai d√©crite dans la colonne de janvier.  Comme nous l'avons d√©couvert, cette approche n√©cessite un gaspillage de ressources suppl√©mentaires et pr√©sente de graves probl√®mes d'√©quilibrage de charge. <br><br>  Vous pouvez faire beaucoup mieux si vous d√©placez la derni√®re √©tape HSR du niveau du polygone au niveau de l'intervalle et utilisez la solution avec des intervalles tri√©s.  Essentiellement, cette approche consiste √† transformer chaque polygone en un ensemble d'intervalles, comme le montre la figure 1, puis √† trier et √† tronquer les intervalles les uns par rapport aux autres, jusqu'√† ce que seules les parties visibles des intervalles visibles restent pour le rendu, comme le montre la figure 2. Cela peut sembler tr√®s similaire √† la mise en m√©moire tampon z (qui, comme je l'ai dit ci-dessus, est trop lente pour √™tre utilis√©e dans le rendu du monde, bien qu'elle convienne aux petits objets en mouvement), mais il existe des diff√©rences importantes.  Contrairement √† la mise en m√©moire tampon z, seules les parties visibles des intervalles visibles sont balay√©es pixel par pixel (bien que toutes les ar√™tes des polygones doivent encore √™tre pixellis√©es).  Encore mieux, le tri effectu√© par mise en m√©moire tampon z pour chaque pixel devient une op√©ration d'intervalle avec des intervalles tri√©s, et comme une propri√©t√© int√©grale de la liste d'intervalles est la connectivit√©, chaque bord est tri√© uniquement par rapport √† certains intervalles de la m√™me ligne, et n'est tronqu√© que par quelques intervalles lorsque superposition horizontale.  Bien que les sc√®nes complexes aient pris plus de temps √† traiter que les sc√®nes simples, les pires cas n'√©taient pas aussi mauvais que lors de l'utilisation d'arborescences de faisceaux ou lors du tri d'arri√®re en avant, car il n'y a pas de redessin et de balayage pour les pixels cach√©s, la complexit√© est limit√©e par la r√©solution en pixels et la connectivit√© par intervalles limite le tri des pires cas dans n'importe quelle zone de l'√©cran.  En prime, la sortie des intervalles tri√©s est exactement sous la forme dont un rasteriseur de bas niveau a besoin: sous la forme d'un ensemble de descripteurs d'intervalle, dont chacun consiste en une coordonn√©e de d√©but et de longueur. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig1.gif"><br><br>  <i>G√©n√©ration d'intervalle</i> <br><br>  Bref, la solution √† intervalles tri√©s est assez proche de nos crit√®res d'origine;  bien que cela n'√©conomise pas les co√ªts, ils ne sont pas encore enti√®rement terribles.  Il √©limine compl√®tement le redessin et le balayage des pixels des parties superpos√©es des polygones et est susceptible d'√©galiser les performances dans les pires cas.  Nous ne nous baserions pas uniquement sur des intervalles tri√©s comme m√©canisme pour √©liminer les surfaces cach√©es, mais les PVS pr√©-calcul√©s r√©duisent le nombre de polygones √† un niveau que les intervalles tri√©s g√®rent suffisamment bien. <br><br>  Nous avons donc trouv√© l'approche dont nous avons besoin;  il ne reste plus qu'√† √©crire le code et c'est fini, non?  Oui et non.  L'approche conceptuelle avec des intervalles tri√©s est simple, mais √©tonnamment difficile √† mettre en ≈ìuvre: vous devez prendre quelques d√©cisions de conception importantes, cela prend un peu de calcul et il y a des pi√®ges rus√©s.  Examinons d'abord les solutions de conception. <br><br><h2>  C√¥tes vs intervalles </h2><br>  La premi√®re d√©cision est de choisir quoi trier: intervalles ou ar√™tes (ces deux concepts appartiennent √† la cat√©gorie g√©n√©rale des ¬´intervalles tri√©s¬ª).  Bien que les r√©sultats dans les deux cas soient les m√™mes (une liste d'intervalles √† dessiner sans redessiner), les impl√©mentations et les implications en termes de performances sont tr√®s diff√©rentes, car le tri et la troncature sont effectu√©s par des structures de donn√©es tr√®s diff√©rentes. <br><br>  Lors du tri des intervalles, ces intervalles sont stock√©s dans des segments de m√©moire tri√©s par x listes li√©es, g√©n√©ralement un segment par ligne raster.  Chaque polygone, √† son tour, est pixellis√© en intervalles, comme le montre la figure 1. Chaque intervalle est tri√© et tronqu√© dans le segment de m√©moire de la ligne raster dans laquelle l'intervalle est situ√©, comme le montre la figure 2, de sorte qu'√† tout moment, chaque segment contient les intervalles les plus proches rencontr√©s , toujours sans superpositions.  Avec cette approche, il est n√©cessaire de g√©n√©rer √† tour de r√¥le tous les intervalles pour chaque polygone, et chaque intervalle est imm√©diatement tri√©, tronqu√© et ajout√© au segment de m√©moire correspondant. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig2.gif"><br><br>  <i>Figure 2: les intervalles du polygone A de la figure 1 sont tri√©s et tronqu√©s √† intervalles du polygone B, tandis que le polygone A est √† une distance constante de 100 le long de l'axe Z, et le polygone B est √† une distance constante de 50 le long de l'axe Z (le polygone B est plus proche de la cam√©ra). )</i> <br><br>  Lors du tri des bords, ces bords sont stock√©s dans des segments de m√©moire tri√©s par x listes li√©es en fonction de leur ligne raster initiale.  Chaque polygone, √† son tour, est divis√© en ar√™tes, cr√©ant ensemble une liste de toutes les ar√™tes de la sc√®ne.  Lorsque tous les bords de tous les polygones de la pyramide de visibilit√© sont ajout√©s √† la liste des bords, la liste enti√®re est num√©ris√©e en une seule passe de haut en bas, de gauche √† droite.  Une liste de la liste des bords actifs (AEL) est enregistr√©e.  √Ä chaque √©tape vers une nouvelle ligne raster, les bords qui apparaissent sur cette ligne raster sont supprim√©s de l'AEL, les bords actifs vont √† leurs nouvelles coordonn√©es x, les bords commen√ßant √† partir de la nouvelle ligne raster sont ajout√©s √† l'AEL et les bords sont tri√©s par la coordonn√©e x actuelle. <br><br>  Pour chaque ligne raster, une liste de polygones active (APL) tri√©e par z est stock√©e.  Il va dans l'ordre tri√© par x AEL.  Lors de la rencontre avec chaque nouvelle ar√™te (c'est-√†-dire lorsque chaque polygone commence ou se termine lors du d√©placement de gauche √† droite), le polygone qui lui est associ√© est activ√© et tri√© en APL (dans le cas d'une ar√™te de d√©part), comme illustr√© √† la figure 3, ou d√©sactiv√© et supprim√© d'APL ( dans le cas d'un bord de fuite), comme le montre la figure 4. Si le polygone le plus proche a chang√© (c'est-√†-dire le plus proche est un nouveau polygone ou le polygone le plus proche s'est termin√©), pour le polygone qui vient de cesser d'√™tre le plus proche, un intervalle est cr√©√© √† partir du point o√π le polygone n'est pas  vym parce qu'il est le plus proche et la fin coordonn√©e x des bords actuels et les x coordonn√©es actuelles sont enregistr√©es dans la d√©charge, qui est maintenant le plus proche.  Cette coordonn√©e stock√©e est ensuite utilis√©e comme d√©but de l'intervalle cr√©√© lorsque le nouveau polygone le plus proche cesse d'√™tre devant. <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig3.gif"><br><br>  <i>Figure 3: activation d'un polygone lorsqu'un bord de d√©part est d√©tect√© dans AEL.</i> <br><br><img src="https://www.bluesnews.com/abrash/images/66_fig4.gif"><br><br>  <i>Figure 4: d√©sactivation du polygone lorsqu'un bord de fuite est d√©tect√© dans AEL.</i> <br><br>  Ne vous inqui√©tez pas si vous ne comprenez pas compl√®tement ce qui pr√©c√®de;  ce n'est qu'un aper√ßu rapide des tris de tri afin que le reste de la colonne soit plus clair.  Une explication d√©taill√©e figurera dans la colonne suivante. <br><br>  Les intervalles g√©n√©r√©s par le tri des bords semblent √™tre exactement les m√™mes intervalles qui r√©sulteraient du tri des intervalles;  la diff√©rence r√©side dans les structures de donn√©es interm√©diaires utilis√©es pour trier les intervalles dans la sc√®ne.  Lors du tri des ar√™tes, les intervalles sont stock√©s √† l'int√©rieur des ar√™tes jusqu'√† ce que l'ensemble final d'intervalles visibles soit g√©n√©r√©, de sorte que le tri, le rognage et la cr√©ation d'intervalles sont effectu√©s lorsque chaque ar√™te ajoute ou supprime un polygone, en fonction de l'√©tat de l'intervalle d√©fini par l'ar√™te et de l'ensemble de polygones actifs.  Lors du tri des intervalles, les intervalles deviennent instantan√©ment apparents lorsque chaque polygone est pixellis√©, et ces intervalles interm√©diaires sont ensuite tri√©s et tronqu√©s par rapport aux intervalles de la ligne de trame pour cr√©er les intervalles finaux;  par cons√©quent, les √©tats des intervalles sont constamment d√©finis de mani√®re explicite et tout le travail est effectu√© directement √† intervalles. <br><br>  Le tri par intervalles et le tri par bord fonctionnent bien; ils ont √©t√© utilis√©s avec succ√®s dans des projets commerciaux.  Pour Quake, nous avons choisi le tri par bord, en partie parce qu'il semble √™tre plus efficace et dispose d'une excellente connectivit√© horizontale qui fournit le temps de tri minimum, contrairement au tri potentiellement co√ªteux en listes li√©es, qui peut √™tre n√©cessaire lors du tri des intervalles.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, une raison plus importante √©tait que lors du tri des bords, nous pouvons diviser les bords entre des polygones adjacents, ce qui r√©duit le tri, le rognage et la pixellisation des bords d'environ la moiti√©, et r√©duit √©galement consid√©rablement la base de donn√©es mondiale du fait que les bords deviennent communs. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Et le dernier avantage du tri des ar√™tes est qu'il ne fait pas de distinction entre les polygones convexes et concaves. Pour la plupart des moteurs graphiques, ce n'est pas un aspect tr√®s important, mais dans Quake, le rognage, la transformation, la projection et le tri des bords sont devenus le principal goulot d'√©tranglement, nous faisons donc tout notre possible pour r√©duire le nombre de polygones et de bords, et les polygones concaves sont tr√®s utiles √† cet √©gard. Bien que les polygones concaves puissent √©galement √™tre trait√©s par intervalles de tri, cela entra√Æne une baisse significative des performances.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, il n'y a pas de r√©ponse d√©finitive sur la meilleure approche. </font><font style="vertical-align: inherit;">En fin de compte, les intervalles de tri et les bords de tri remplissent une fonction, et le choix entre eux est une question de convivialit√©. </font><font style="vertical-align: inherit;">Dans la colonne suivante, je parlerai davantage du tri des bords avec son impl√©mentation compl√®te. </font><font style="vertical-align: inherit;">Dans le reste de cette colonne, je poserai les bases de la prochaine en parlant des cl√©s de tri et du calcul de 1 / z. </font><font style="vertical-align: inherit;">Dans le processus, je ferai plusieurs r√©f√©rences aux aspects du tri des bords, qui n'ont pas encore √©t√© discut√©s en d√©tail; </font><font style="vertical-align: inherit;">Je m'excuse, mais c'est in√©vitable, et tout ne deviendra clair qu'√† la fin de la colonne suivante.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cl√©s de tri des c√¥tes </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant que nous savons que nous allons s√©lectionner le tri des ar√™tes et l'utiliser pour cr√©er les intervalles des polygones les plus proches du spectateur, la question se pose: comment savoir si ces polygones sont les plus proches? Id√©alement, nous devrions simplement stocker la cl√© de tri de chaque polygone, et lorsqu'une nouvelle ar√™te appara√Æt, nous comparerions la cl√© de sa surface avec les cl√©s des autres polygones actifs actuels afin de d√©terminer facilement lequel des polygones est le plus proche.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela semble trop beau, mais c'est possible. Si, par exemple, votre base de donn√©es mondiale est stock√©e sous forme d'arbre BSP et que tous les polygones sont tronqu√©s en feuilles BSP, alors l'ordre de parcours BSP sera l'ordre de rendu correct. Par cons√©quent, par exemple, si vous contournez BSP d'avant en arri√®re, en attribuant √† chaque polygone une valeur de cl√© incr√©mentielle plus grande lorsqu'il l'atteint, les polygones avec des valeurs de cl√© plus √©lev√©es seraient garantis devant des polygones avec des cl√©s plus petites. Cette approche est utilis√©e dans Quake depuis un certain temps, mais maintenant une solution diff√©rente est appliqu√©e pour des raisons que je vais expliquer bri√®vement.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous n'avez pas de BSP ou une structure de donn√©es similaire, ou si vous avez de nombreux polygones en mouvement (le BSP ne traite pas les polygones en mouvement de mani√®re tr√®s efficace), alors une autre fa√ßon d'atteindre les objectifs est de trier tous les polygones les uns par rapport aux autres avant de rendre la sc√®ne et d'attribuer les cl√©s correspondantes en fonction de leur espace relations dans la fen√™tre. Malheureusement, dans le cas g√©n√©ral, c'est une t√¢che extr√™mement lente, car chaque polygone doit √™tre compar√© les uns aux autres. Il existe des techniques pour am√©liorer les performances de tri des polygones, mais je ne connais personne qui effectuerait un tri g√©n√©ral des polygones sur un PC en temps r√©el.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une alternative consiste √† trier par distance z du spectateur dans l'espace √©cran; cette solution correspond bien √† la connectivit√© spatiale sup√©rieure des bords de tri. Lorsque vous rencontrez chaque nouvelle ar√™te sur la ligne raster, vous pouvez calculer la distance z du polygone correspondant et comparer avec les distances des autres polygones, apr√®s quoi le polygone peut √™tre enregistr√© dans APL.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, obtenir des distances le long de z peut √™tre une t√¢che difficile. N'oubliez pas que nous devons √™tre capables de calculer z √† n'importe quel point arbitraire du polygone, car une ar√™te peut se produire et entra√Æner le tri du polygone dans l'APL n'importe o√π sur l'√©cran. Nous pouvons calculer z directement √† partir des coordonn√©es d'√©cran x et y et des √©quations du plan du polygone, mais, malheureusement, cela ne peut pas √™tre fait tr√®s rapidement, car z pour le plan ne change pas lin√©airement dans l'espace d'√©cran; cependant, 1 / z </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">varie</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lin√©airement, nous utilisons donc cette valeur. (Pour une discussion sur la lin√©arit√© dans l'espace d'√©cran et les gradients pour 1 / z, voir la s√©rie de Chris Hecker sur la cartographie de texture dans le magazine </font><u><font style="vertical-align: inherit;">Game Developer</font></u><font style="vertical-align: inherit;"> l'ann√©e derni√®re</font></font><u><font style="vertical-align: inherit;"></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.) Un autre avantage de l'utilisation de 1 / z est que la r√©solution augmente avec une distance d√©croissante, c'est-√†-dire qu'avec 1 / z, nous aurons toujours la meilleure r√©solution de profondeur pour les objets proches les plus importants. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une fa√ßon √©vidente d'obtenir la valeur 1 / z √† n'importe quel point arbitraire du polygone consiste √† calculer 1 / z aux sommets, √† les interpoler sur les deux bords du polygone et √† interpoler entre les bords pour obtenir la valeur au point souhait√©. Malheureusement, cela n√©cessite beaucoup de travail √† faire le long de chaque c√¥te; pire, cela n√©cessite une division pour calculer le pas 1 / z par pixel dans chaque intervalle. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il serait pr√©f√©rable de calculer 1 / z directement √† partir de l'√©quation du plan et de l'√©cran x et y du pixel qui nous int√©resse. L'√©quation a la forme suivante:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2212;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo stretchy=&quot;false&quot;>)</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo>+</mo><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.04ex" height="2.78ex" viewBox="0 -883.9 12933.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="1747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-28" x="2803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-61" x="3193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="3722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="4223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-29" x="4746" y="0"></use><g transform="translate(5136,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2212" x="6225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-28" x="7226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-62" x="7615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="8045" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="8545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-29" x="9069" y="0"></use><g transform="translate(9458,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2B" x="10475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-63" x="11476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="11909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="12410" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo stretchy="false">)</mo><msup><mi>x</mi><mo>‚Ä≤</mo></msup><mo>‚àí</mo><mo stretchy="false">(</mo><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo stretchy="false">)</mo><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mo>+</mo><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">1/z = (a/d)x' - (b/d)y' + c/d</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o√π z est la coordonn√©e dans l'espace z du point sur le plan qui est projet√© dans les coordonn√©es d'√©cran (x ', y') (l'origine des coordonn√©es pour ces calculs est le centre de projection, le point sur l'√©cran juste en face du point de vue), [abc] est normale au plan dans la fen√™tre, et d est la distance entre l'origine de la fen√™tre et le plan le long de la normale. </font><font style="vertical-align: inherit;">La division n'est effectu√©e qu'une seule fois pour chaque plan, car a, b, c et d sont des constantes pour les plans.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un calcul 1 / z complet n√©cessite deux multiplications et deux ajouts, et chaque op√©ration doit √™tre effectu√©e avec une virgule flottante pour √©viter les erreurs de plage. </font><font style="vertical-align: inherit;">Un tel volume de calculs en virgule flottante semble co√ªteux, mais en fait il ne l'est pas, en particulier sur les processeurs Pentium, o√π la valeur du plan 1 / z √† tout moment peut √™tre calcul√©e en langage d'assemblage en seulement six cycles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous √™tes int√©ress√©, voici une d√©rivation rapide de l'√©quation 1 / z. </font><font style="vertical-align: inherit;">L'√©quation de l'avion pour l'avion a la forme suivante:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mi>z</mi><mo>&amp;#x2212;</mo><mi>d</mi><mo>=</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.805ex" height="2.419ex" viewBox="0 -780.1 8957.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2B" x="1324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-62" x="2324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="2754" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2B" x="3474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-63" x="4474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="4908" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2212" x="5599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="6599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="7401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-30" x="8457" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>+</mo><mi>c</mi><mi>z</mi><mo>‚àí</mo><mi>d</mi><mo>=</mo><mn>0</mn></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-2">ax + by + cz - d = 0</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o√π x et y sont les coordonn√©es de l'espace de vue, a, b, c, d et z sont d√©finis ci-dessus. </font><font style="vertical-align: inherit;">Si nous faisons la substitution</font></font><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.531ex" height="2.178ex" viewBox="0 -832 3242.4 937.7" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="850" y="0"></use><g transform="translate(1906,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="809" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="2773" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><msup><mi>x</mi><mo>‚Ä≤</mo></msup><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">x=x'z</script> </math>  et <math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mo>&amp;#x2212;</mo><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.995ex" height="2.539ex" viewBox="0 -832 3873 1093.4" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2212" x="1831" y="0"></use><g transform="translate(2610,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="706" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="3404" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mo>‚àí</mo><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">y=-y'z</script> </math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(√† partir de la d√©finition de la projection en perspective; y change de signe car il augmente dans la fen√™tre, mais vers le bas dans l'espace √©cran). </font><font style="vertical-align: inherit;">En effectuant une permutation, on obtient:</font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>z</mi><mo>=</mo><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2212;</mo><mi>b</mi><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mo>+</mo><mi>c</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.149ex" height="2.78ex" viewBox="0 -883.9 9105.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="1802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="2326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-28" x="2826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-61" x="3216" y="0"></use><g transform="translate(3745,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2212" x="4835" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-62" x="5835" y="0"></use><g transform="translate(6265,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2B" x="7281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-63" x="8282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-29" x="8716" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>z</mi><mo>=</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mi>a</mi><msup><mi>x</mi><mo>‚Ä≤</mo></msup><mo>‚àí</mo><mi>b</mi><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mo>+</mo><mi>c</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">z = d / (ax' - by' + c)</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En inversant et en d√©veloppant l'√©quation, nous obtenons: </font></font><br><br><p><math> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mn>1</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo>&amp;#x2212;</mo><mi>b</mi><msup><mi>y</mi><mo>&amp;#x2032;</mo></msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi><mo>+</mo><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mi>d</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.421ex" height="2.78ex" viewBox="0 -883.9 11375.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-7A" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-3D" x="1747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-61" x="2803" y="0"></use><g transform="translate(3333,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="809" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="4200" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="4700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2212" x="5446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-62" x="6447" y="0"></use><g transform="translate(6876,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-79" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2032" x="706" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="7671" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="8171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2B" x="8917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-63" x="9918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMAIN-2F" x="10351" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/439830/&amp;usg=ALkJrhgvurs8HihVsrPFMVBPJui5vXM7hQ#MJMATHI-64" x="10852" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>1</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>z</mi><mo>=</mo><mi>a</mi><msup><mi>x</mi><mo>‚Ä≤</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo>‚àí</mo><mi>b</mi><msup><mi>y</mi><mo>‚Ä≤</mo></msup><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi><mo>+</mo><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mi>d</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6">1/z = ax'/d - by'/d + c/d</script> </math></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Plus tard, je montrerai le tri 1 / z en action. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> S√©isme et tri par z </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai mentionn√© ci-dessus que Quake n'utilise plus l'ordre BSP comme cl√© de tri; en fait, 1 / z est maintenant appliqu√© comme cl√©. Malgr√© l'√©l√©gance des d√©grad√©s, le calcul de 1 / z d'entre eux est √©videmment plus lent que la simple comparaison avec la cl√© de commande BSP, alors pourquoi avons-nous d√©cid√© d'utiliser 1 / z dans Quake?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La raison principale est la diminution du nombre de polygones. Pour le rendu dans l'ordre BSP, il est n√©cessaire de suivre certaines r√®gles, y compris les polygones lorsque l'intersection avec les plans BSP doit √™tre divis√©e. Cette s√©paration augmente consid√©rablement le nombre de polygones et d'ar√™tes. Gr√¢ce au tri par 1 / z, nous pouvons laisser les polygones indivis, mais toujours obtenir l'ordre de dessin correct, nous devons donc traiter beaucoup moins d'ar√™tes; tandis que le rendu est g√©n√©ralement acc√©l√©r√©, malgr√© le surco√ªt de tri par 1 / z.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre avantage du tri 1 / z est qu'il r√©sout les probl√®mes de tri mentionn√©s au d√©but de cet article: les mod√®les en mouvement, qui sont eux-m√™mes de petits arbres BSP. Le tri dans l'ordre mondial BSP ne fonctionnera pas ici car ces mod√®les sont des BSP distincts et il n'y a pas de moyen facile de les incorporer dans l'ordre s√©quentiel du monde BSP. Nous ne voulons pas utiliser la mise en m√©moire tampon z pour ces mod√®les car ce sont souvent de gros objets (par exemple, des portes), et nous ne voulons pas perdre les avantages de r√©duire le redessin que les portes ferm√©es fournissent lors du rendu dans la liste des bords. Lorsque vous utilisez des intervalles tri√©s, les ar√™tes des mod√®les BSP en mouvement sont simplement plac√©es sur la liste des ar√™tes (tronquant d'abord les polygones afin qu'ils ne se croisent pas avec les surfaces solides du monde pour √©viter la complexit√©,li√©s √† la p√©n√©tration mutuelle) au lieu de tous les bords du monde, et le reste est tri√© par 1 / z.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aller de l'avant </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'article, sans aucun doute, contient une √©norme quantit√© d'informations, et beaucoup n'a pas encore √©t√© mis dans votre t√™te. </font><font style="vertical-align: inherit;">Le code et l'explication du prochain article vous aideront; </font><font style="vertical-align: inherit;">si vous voulez jeter un coup d'≈ìil √† l'avance, au moment o√π vous lisez cet article, le code devrait √™tre disponible sur ftp.idsoftware.com/mikeab/ddjsort.zip. </font><font style="vertical-align: inherit;">Il vaut √©galement la peine de jeter un ≈ìil √† </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Computer Graphics</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Foley et Van Dam ou √† </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Elements de proc√©dure pour Computer Graphics</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rogers. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On ne sait pas pour l'instant comment le r√©sultat de </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quake</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit trier les bords - dans l'ordre BSP ou 1 / z. </font><font style="vertical-align: inherit;">En fait, rien ne garantit que les intervalles tri√©s sous quelque forme que ce soit seront la solution finale. </font><font style="vertical-align: inherit;">Parfois, il semble que nous changeons les moteurs graphiques aussi souvent qu'ils mettent Elvis sur les stations de radio d√©di√©es aux tubes des ann√©es 50 (mais, esp√©rons-le, avec des r√©sultats beaucoup plus esth√©tiques!), Et nous envisagerons sans aucun doute des alternatives jusqu'√† la date de sortie les jeux.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439830/">https://habr.com/ru/post/fr439830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439812/index.html">Approches Kaggle pour CV en prod: vous ne pouvez pas impl√©menter pour couper</a></li>
<li><a href="../fr439818/index.html">Caract√©ristiques des approches de conception dans le secteur manufacturier r√©el</a></li>
<li><a href="../fr439822/index.html">Cr√©ation d'un affichage alternatif pour le synth√©tiseur / √©chantillonneur Ensoniq EPS16 + et ASR10</a></li>
<li><a href="../fr439824/index.html">Quand les frameworks JavaScript vont-ils dispara√Ætre?</a></li>
<li><a href="../fr439826/index.html">D√©sactiver l'analogique. Qu'arrivera-t-il √† la t√©l√©vision?</a></li>
<li><a href="../fr439834/index.html">Pr√©sentation de la technologie IPMI</a></li>
<li><a href="../fr439838/index.html">Arithm√©tique du miel: addition et soustraction par les abeilles</a></li>
<li><a href="../fr439840/index.html">Conf√©rence DUMP-2019: nous vous invitons √† prendre la parole dans les sections Conception, Gestion et Tests</a></li>
<li><a href="../fr439844/index.html">Pourquoi les d√©veloppeurs de Dodo Pizza 250?</a></li>
<li><a href="../fr439848/index.html">Pas un seul VPN. Aide-m√©moire sur la fa√ßon de vous prot√©ger et de prot√©ger vos donn√©es</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>